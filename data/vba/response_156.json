[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515024828, "post_id": 48086842, "comment_id": 83148870, "body": "Changing <code>.Copy.Range.ActiveCell</code> to <code>.Copy  ActiveCell</code> will fix the problem"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515024881, "post_id": 48086842, "comment_id": 83148884, "body": "And, based on your comment to an answer, use <code>.Copy  ActiveCell.EntireRow.Range(&quot;A1&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "edited": false, "score": 0, "creation_date": 1515024818, "post_id": 48086926, "comment_id": 83148869, "body": "Great! Does almost exactly what I need to do. The issue is that I need the paste to align to Column A, no matter where the active cell is on the row. Suggestions?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1515025013, "post_id": 48086926, "comment_id": 83148924, "body": "To paste starting in column A, a simple change would be to change <code>Selection</code> to <code>Selection.EntireRow.Range(&quot;A1&quot;)</code> (or you could use <code>Cells(Selection.Row, &quot;A&quot;)</code> if you like)"}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "edited": false, "score": 0, "creation_date": 1515025348, "post_id": 48086926, "comment_id": 83149012, "body": "Solved it with YowE3K and K.Davis"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1515024316, "creation_date": 1515024316, "answer_id": 48086926, "question_id": 48086842, "link": "https://stackoverflow.com/questions/48086842/copying-range-to-active-cell-range/48086926#48086926", "title": "Copying range to active cell range", "body": "<p>I would set your range that you are wanting to copy to a variable first, then perform the procedure with your selection. This can possibly assist you with debugging down the road (and ensure that you are working with the correct objects).</p>\n\n<p>Try this</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim rngToCopy As Range\n    Set rngToCopy = ThisWorkbook.Worksheets(\"The Hidden Works\").Range(\"A2:U13\")\n\n    rngToCopy.Copy\n    Selection.Insert Shift:=xlDown\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515024316, "creation_date": 1515023831, "question_id": 48086842, "link": "https://stackoverflow.com/questions/48086842/copying-range-to-active-cell-range", "title": "Copying range to active cell range", "body": "<p>I have a code that inserts 12 lines above the user's active cell. I am trying to get the code to copy a specific range from another sheet and paste it into the newly created rows. I keep getting a runtime error of 424. How can I solve this?</p>\n\n<p>Code below</p>\n\n<pre><code>With ActiveSheet\n\n    For i = 1 To 12\n        ActiveCell.Rows.EntireRow.Insert Shift:=xlDown\n    Next i\n\n    Sheets(\"The Hidden Works\").Range(\"A2:U13\").Copy.Range.ActiveCell\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9168352, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154458872294567/picture?type=large", "display_name": "Penny", "link": "https://stackoverflow.com/users/9168352/penny"}, "edited": false, "score": 0, "creation_date": 1515024737, "post_id": 48086910, "comment_id": 83148851, "body": "I end up with #REF! in all of the empty cells.  Any blank cells in columns other than A and B need to remain blank."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 9168352, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154458872294567/picture?type=large", "display_name": "Penny", "link": "https://stackoverflow.com/users/9168352/penny"}, "edited": false, "score": 0, "creation_date": 1515025004, "post_id": 48086910, "comment_id": 83148921, "body": "Then only choose the cells in the columns you want.  You stated you do not want to use ranges.  So only choose the cells on which you want to run the code.  The only way you will end up with #Ref is if you choose the first row and it is empty.  Again only choose those areas that need the values.  You need to start with the first actual value.  We are not here to give you the code or rewrite your code to do more than it does, but to help overcome a specific problem."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 9168352, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154458872294567/picture?type=large", "display_name": "Penny", "link": "https://stackoverflow.com/users/9168352/penny"}, "edited": false, "score": 0, "creation_date": 1515025714, "post_id": 48086910, "comment_id": 83149096, "body": "Just an FYI, you show your thanks by marking it as correct clicking the check mark by the answer.  This marks the answer as the correct answer and removes the question from the unanswered queue.  i am glad you were able to get an answer to your question."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1515024205, "creation_date": 1515024205, "answer_id": 48086910, "question_id": 48086823, "link": "https://stackoverflow.com/questions/48086823/filling-in-blank-cells-with-cells-above/48086910#48086910", "title": "filling in blank cells with cells above", "body": "<p>Pulling out the <code>.value = .Value</code> from the <code>SpecialCells()</code> makes it work.</p>\n\n<pre><code>With Selection\n    With .SpecialCells(xlCellTypeBlanks)\n        .FormulaR1C1 = \"=R[-1]C\"\n    End With\n  .Value = .Value\nEnd With\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RgXXi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RgXXi.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nm9n9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nm9n9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1515032618, "creation_date": 1515032618, "answer_id": 48087833, "question_id": 48086823, "link": "https://stackoverflow.com/questions/48086823/filling-in-blank-cells-with-cells-above/48087833#48087833", "title": "filling in blank cells with cells above", "body": "<p>I generally object to using VBA to write formulas. Therefore I created a solution which writes the results instead. Unfortunately, I appear to be late in posting. You already accepted an answer. However, since I wrote the code I might as well share it. Here it is.</p>\n\n<pre><code>Option Explicit\n\nSub FillMissing()\n    ' 04 Jan 2018\n\n    Dim Rng As Range\n    Dim Service As Variant\n    Dim Rl As Long                              ' last row\n    Dim R As Long                               ' row counter\n\n    Application.ScreenUpdating = False\n    With ActiveSheet\n        Rl = Application.Max(.Cells(.Rows.Count, \"C\").End(xlUp).Row, _\n                             .Cells(.Rows.Count, \"D\").End(xlUp).Row)\n        For R = 2 To Rl                         ' start in row 2\n            Set Rng = Range(.Cells(R, \"A\"), .Cells(R, \"B\"))\n            With Rng\n                If Application.CountA(Rng) Then\n                    Service = .Value\n                Else\n                    .Value = Service\n                End If\n            End With\n        Next R\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9168352, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154458872294567/picture?type=large", "display_name": "Penny", "link": "https://stackoverflow.com/users/9168352/penny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 48086910, "answer_count": 2, "score": 0, "last_activity_date": 1515033983, "creation_date": 1515023627, "last_edit_date": 1531164843, "question_id": 48086823, "link": "https://stackoverflow.com/questions/48086823/filling-in-blank-cells-with-cells-above", "title": "filling in blank cells with cells above", "body": "<p>I have a worksheet that looks like this:</p>\n\n<pre><code>BusABC     Florida     Rush Street     15\nblank      blank       Landon Street   29\nblank      blank       Naples Street   34\nBus123     Georgia     Rush Street     15\nblank      blank       Marietta Street 29234\nblank      blank       Duluth Street   321\nblank      blank       Augusta Avenue  12\n</code></pre>\n\n<p>I want to use code to have a result where the blanks match the data above. So A2, A3 would have \"BusABC\" and B2, B3 would have \"Florida.\"</p>\n\n<p>Then A5, A6, and A7 would have \"Bus123\" and B5, B6, and B7 would have \"Georgia.\"</p>\n\n<p>I need to not use specific cell numbers as I have thousands of group set ups like this and my code cannot reference a specific cell.</p>\n\n<p>Additionally, there may be blank cells in columns C and D (in my example) and I need those to stay blank</p>\n\n<p>I tried this (below)...... I end up with cells that have 0s and #N/A</p>\n\n<pre><code>On Error Resume Next\nWith Selection.SpecialCells(xlCellTypeBlanks)\n  .FormulaR1C1 = \"=R[-1]C\"\n  .Value = .Value\nEnd With\n</code></pre>\n\n<p>I have also tried this and nothing happens:</p>\n\n<pre><code>Sub split()\n    Dim columnValues  As Range, i As Long\n\n    Set columnValues = Selection\n\n    For i = 1 To columnValues.Rows.Count\n        If columnValues.Cells(i, 1).Value = \"\" Then\n            columnValues.Cells(i, 1).Value = columnValues.Cells(i - 1, 1).Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "warnings"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1515023274, "post_id": 48086640, "comment_id": 83148472, "body": "Yes it can, you would want vba in a Worksheet_Change or Worksheet_Calulate event."}, {"owner": {"reputation": 5785, "user_id": 7306999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9dNzL.jpg?s=128&g=1", "display_name": "Xukrao", "link": "https://stackoverflow.com/users/7306999/xukrao"}, "edited": false, "score": 0, "creation_date": 1515023338, "post_id": 48086640, "comment_id": 83148485, "body": "This is beyond the capabilities of Excel cell formulas. You&#39;ll need to write a VBA script."}], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "is_accepted": false, "score": 0, "last_activity_date": 1515045786, "creation_date": 1515045786, "answer_id": 48089542, "question_id": 48086640, "link": "https://stackoverflow.com/questions/48086640/excel-warning-system-idea/48089542#48089542", "title": "Excel warning system idea", "body": "<p>At first, set a name for the specified cell number which you want to system alerts when it's value is more than 5:</p>\n\n<ol>\n<li>Click on the cell to be selected.</li>\n<li>In the <code>Name Box</code> (At Up-Left side of the Excel window, Left side of the formula bar) Type a desired name, for example <code>Alert</code></li>\n</ol>\n\n<hr>\n\n<p>In your Workbook window Press <kbd>Alt</kbd> + <kbd>F11</kbd></p>\n\n<p>Microsoft Visual Basic For Application window will opens.</p>\n\n<p>At left-up side, in the project explorer box, choose your specified worksheet. (For example: Sheet1)</p>\n\n<p>Enter code below (Here also warns you with the status bar)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If ActiveSheet.Name = Me.Name Then\n        If IsNumeric(Range(\"Alert\").Value) Then\n            If Range(\"Alert\").Value &gt; 5 Then\n                MsgBox \"The value is larger than 5\", vbCritical + vbOKOnly, \"Alert\"\n                Application.StatusBar = \"Warning: the sensitive cells value is larger than 5\"\n            Else\n                Application.StatusBar = \"The sensitive cell is approved\"\n            End If\n        Else\n            Application.StatusBar = \"\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8807130, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154735334095194/picture?type=large", "display_name": "Goh Yang Xu", "link": "https://stackoverflow.com/users/8807130/goh-yang-xu"}, "edited": false, "score": 0, "creation_date": 1515478740, "post_id": 48089637, "comment_id": 83304095, "body": "hi. this is genius. fantastic that i don&#39;t have to use VBA"}, {"owner": {"reputation": 1, "user_id": 8807130, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154735334095194/picture?type=large", "display_name": "Goh Yang Xu", "link": "https://stackoverflow.com/users/8807130/goh-yang-xu"}, "edited": false, "score": 0, "creation_date": 1515478815, "post_id": 48089637, "comment_id": 83304116, "body": "however, when im testing this, it doesnt really work when cell A1 and B1 are formulas. for example, both cell uses sum formula. any idea how so?"}], "tags": [], "owner": {"reputation": 600, "user_id": 6777125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wgsOB.jpg?s=128&g=1", "display_name": "Krunal Shah", "link": "https://stackoverflow.com/users/6777125/krunal-shah"}, "is_accepted": false, "score": 1, "last_activity_date": 1515046363, "creation_date": 1515046363, "answer_id": 48089637, "question_id": 48086640, "link": "https://stackoverflow.com/questions/48086640/excel-warning-system-idea/48089637#48089637", "title": "Excel warning system idea", "body": "<p>Try Data Validation Lists.</p>\n\n<p>For instance, if your Purchase Date is in Cell A1 and your return date is in cell B1 then do the following for cell B1:</p>\n\n<p>(Steps Assume you use Excel 2007)</p>\n\n<ol>\n<li>Select Cell B1</li>\n<li>Go to the Data toolbar</li>\n<li>Select Data Validation</li>\n<li>For \"Settings\" tab, select \"Custom\"</li>\n<li>In the formula Bar, type the formula \"=B1>A1\"</li>\n<li>On the \"Error Alert\" tab, select Warning (Allows entry but shows a message box when condition isn't met)</li>\n<li>For Title, type \"Error\"</li>\n<li>For Error Message, type \"Return Date cannot be before Purchase Date\"</li>\n</ol>\n\n<p>Should do exactly what you want...no code!!!! Same type of logic can be applied to do your advanced messaging, just need to update the formula in step 5 with some AND or maybe OR functions and you'll be on your way.</p>\n"}], "owner": {"reputation": 1, "user_id": 8807130, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154735334095194/picture?type=large", "display_name": "Goh Yang Xu", "link": "https://stackoverflow.com/users/8807130/goh-yang-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515049013, "creation_date": 1515022449, "last_edit_date": 1592644375, "question_id": 48086640, "link": "https://stackoverflow.com/questions/48086640/excel-warning-system-idea", "title": "Excel warning system idea", "body": "<p>I am trying to create a warning system in Excel but I have no idea which function could be of aid.</p>\n<p>say for example, I want a system that alerts me when the cell number is more than 5. and the signal stays on <strong>even after</strong> it went below 5.</p>\n<p>cell A1 is RTD and it is a number that changes frequently.</p>\n<blockquote>\n<p>At 9AM, the number is 5.</p>\n<p>At 10AM, it changes to 10.</p>\n<p>At 11AM, it is back to 5.</p>\n</blockquote>\n<p>How can I have a warning system that stays on, even at 11am, to notify me that this number has been more than 5. the &quot;Warning&quot; will remain on until I turn it off.</p>\n<p>And even ideally, can Excel do a pop up or some sort to alert me on this warning.</p>\n<p>thanks and regards</p>\n<p>gyx</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515022538, "post_id": 48086595, "comment_id": 83148301, "body": "there&#39;s may be some issues with your code depending on how you enter data, but please explain the issue more clearly as it works for me as described in your problem statement. Also, have you debugged the code (stepped through line-by-line) to observe the actual behavior versus what is expected."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515022688, "post_id": 48086595, "comment_id": 83148346, "body": "This will not work if you are changing more than one cell at a time.  You will need to iterate through the Target.rows"}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515022993, "post_id": 48086595, "comment_id": 83148413, "body": "Yes, the code works if for example I am in row1 and insert the values in the following order: A1 = i.e. 12, C1 = i.e. 10 and D1 = i.e. 3. As C1+D1 is not equal A1 I will receive the error. However, if I copy-paste the values from A1, C1 and D1 and paste them in row2, row3 and row4, the error will show only in row2, but not in row3 and row4. I want them to show also in those rose. Thanks @Scott Holtzman"}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1515023542, "post_id": 48086595, "comment_id": 83148540, "body": "Might want to add a way to suppress the <code>Msgbox</code>s when its dealing with a multi-row change."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1515022877, "creation_date": 1515022877, "answer_id": 48086709, "question_id": 48086595, "link": "https://stackoverflow.com/questions/48086595/if-condition-range-doesnt-work/48086709#48086709", "title": "If condition range doesn&#39;t work", "body": "<p>You need to iterate the rows in the target range:</p>\n\n<pre><code>Target.Row\n</code></pre>\n\n<p>Will only return the first row and not all of them:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rng As Range\nDim rngrow As Range\nSet rng = Intersect(Range(\"C1:d10\"), Target)\nIf Not rng Is Nothing Then\n    For Each rngrow In rng.Rows\n        LogicalPart rngrow.Row\n    Next rngrow\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 48086709, "answer_count": 1, "score": 0, "last_activity_date": 1515022877, "creation_date": 1515022037, "question_id": 48086595, "link": "https://stackoverflow.com/questions/48086595/if-condition-range-doesnt-work", "title": "If condition range doesn&#39;t work", "body": "<p>I am not able to make the code below to work when you copy-paste values in columns A, C and D. If for example I am in row2 and I insert data in cell A2, C2 and D2, the code does its job. But if I copy-paste data in row 3, 4, 5 the code doesn't check anymore the condition. I would really appreciate if anyone can help me to fix this matter. Thanks!</p>\n\n<pre><code>Sub LogicalPart(i As Long)\n\n    If (Cells(i, \"C\") + Cells(i, \"D\")) &lt;&gt; Cells(i, \"A\") Then\n        MsgBox \"C\" &amp; i &amp; \" + D\" &amp; i &amp; \" must equal cell A\" &amp; i &amp; \" which is: \" &amp; Range(\"A\" &amp; i).Value\n        MsgBox (\"Please insert again the data in cell C\" &amp; i &amp; \" or D \" &amp; i &amp; \"!\")\n        Cells(i, \"C\").Interior.Color = RGB(255, 0, 0)\n        Cells(i, \"D\").Interior.Color = RGB(255, 0, 0)\n\nElse\n       Range(Cells(i, \"C\"), Cells(i, \"D\")).Interior.Color = RGB(1000, 1000, 1000)\n    End If\n\nEnd Sub\n\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Application.Intersect(Range(\"C1:d10\"), Target) Is Nothing Then\n   LogicalPart Target.row\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "is_accepted": false, "score": 0, "last_activity_date": 1515022665, "creation_date": 1515022665, "answer_id": 48086677, "question_id": 48086521, "link": "https://stackoverflow.com/questions/48086521/disable-vba-script-creation-or-modification-in-ms-office-apps/48086677#48086677", "title": "Disable VBA script creation or modification in MS Office apps", "body": "<p>You can always protect the existing VBA project: </p>\n\n<p>From the VBA Editor, select Tools > VBA project properties > Security > Lock project for viewing, enter a password and save.</p>\n\n<p>Additionally, Modern versions of MS Access provide a method to save your database as a compiled executable format (*.accde) which you can then publish to your users without fear of them modifying or inserting VBA code.</p>\n"}], "owner": {"reputation": 1, "user_id": 9170259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbf2b78dc8aa6a0185cb3a37678fbc?s=128&d=identicon&r=PG&f=1", "display_name": "Spyder", "link": "https://stackoverflow.com/users/9170259/spyder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594638495, "creation_date": 1515021508, "last_edit_date": 1594638495, "question_id": 48086521, "link": "https://stackoverflow.com/questions/48086521/disable-vba-script-creation-or-modification-in-ms-office-apps", "title": "Disable VBA script creation or modification in MS Office apps", "body": "<p>as the title suggests.  Allow execution of previously created scripts but disallow creation of new ones or modification of existing script.  Blocking of VB doesn't work since the editor spawns as the parent process.</p>\n"}, {"tags": ["forms", "ms-access", "vba", "dataprovider"], "answers": [{"comments": [{"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1515022495, "post_id": 48086562, "comment_id": 83148292, "body": "Hi Chris. Let me give that a try. Will report shortly."}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1515023458, "post_id": 48086562, "comment_id": 83148517, "body": "I tried the changes and it resulted in the same error. Now, the version of the sub routine I first pasted was a smaller version. I did not wanted to include the entire code, but I see that might also interfere with the help I need. I have pasted the original vba code for the Find function."}, {"owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "reply_to_user": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1515024120, "post_id": 48086562, "comment_id": 83148691, "body": "Have you tried a DAO connection instead? See this article here: <a href=\"https://blogs.msdn.microsoft.com/cristib/2014/08/28/vba-access-2013-programmatically-assigning-a-forms-dao-recordset-record-source-to-the-result-of-stored-procedure-ado-recordset-executed-on-a-remote-sql-server-triggers-run-time-error-3/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/cristib/2014/08/28/&hellip;</a>"}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1515097570, "post_id": 48086562, "comment_id": 83181462, "body": "I ended up creating a view with the query that I was using in the stored procedure in sql server, then from access I created a link to the sql view. That way I did not have to create an additional connection to sql server and losing the local access state. This was an easy work around...for now. Thank you for your help on this issue."}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 1, "creation_date": 1515097618, "post_id": 48086562, "comment_id": 83181485, "body": "I marked your post as the solution, because I read the article you included and it seems like that would have been also a valid solution, just a bit more involved. Thanks."}], "tags": [], "owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "is_accepted": true, "score": 1, "last_activity_date": 1515088875, "last_edit_date": 1515088875, "creation_date": 1515021822, "answer_id": 48086562, "question_id": 48086209, "link": "https://stackoverflow.com/questions/48086209/access-vba-data-provider-could-not-be-initialized/48086562#48086562", "title": "Access VBA : Data provider could not be initialized", "body": "<p>Try importing your data from the ADO connection into a local temporary table, and then setting the recordsource property to that data. As noted in this <a href=\"https://blogs.msdn.microsoft.com/cristib/2014/08/28/vba-access-2013-programmatically-assigning-a-forms-dao-recordset-record-source-to-the-result-of-stored-procedure-ado-recordset-executed-on-a-remote-sql-server-triggers-run-time-error-3/\" rel=\"nofollow noreferrer\">older blog post</a> </p>\n\n<p>Something like this may be helpful:</p>\n\n<pre><code>dim t as tabledef, i as integer\nfor each t in currentdb.tabledefs\nselect case t.name\n    case \"myTempTable\"\n        currentdb.tabledefs.delete \"mytemptable\"\nend select\nnext t\n\ncurrentdb.execute \"CREATE TABLE ...\"\n\nADORS.MoveFirst\nfor i = 0 to ADORS.RecordCount -1\n    currentdb.execute \"INSERT INTO myTempTable \" &amp; _\n        ADORS(i).Fields(\"FieldName1\").Value &amp; \" as [FieldName1], \" &amp; _\n        etc.\nnext i\n...\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 48086562, "answer_count": 1, "score": 1, "last_activity_date": 1594638487, "creation_date": 1515019224, "last_edit_date": 1594638487, "question_id": 48086209, "link": "https://stackoverflow.com/questions/48086209/access-vba-data-provider-could-not-be-initialized", "title": "Access VBA : Data provider could not be initialized", "body": "<p>I get this error when coming from a \"find\" form to a \"main form\".</p>\n\n<p>Steps are</p>\n\n<ol>\n<li>Open the main form</li>\n<li>Click on \"Find\" button on mani form, which opens another form named \"Find\"</li>\n<li>Click \"Find\" button on \"Find\" form</li>\n<li>Load record on main form</li>\n</ol>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Private Sub cmdFind_Click()\n\n    Dim SQLString As String\n    Dim TitleString As String\n    Dim con         As ADODB.Connection\n    Dim cmd         As ADODB.Command\n\n    If production_batch_find.Form.RecordsetClone.RecordCount &gt; 0 Then        \n\n        SQLString = \"sku IN (SELECT sku FROM production_batch WHERE [user] = '\" &amp; getUsr &amp; \"')\"    \n\n    Else        \n\n        If IsNull(txtSKU.Value) = False Then            \n\n            If Len(txtSKU.Value) &lt; 9 Then                \n\n                If IsNumeric(txtSKU.Value) Then                    \n                    txtSKU.Value = \"MN\" &amp; String(7 - Len(txtSKU.Value), \"0\") &amp; txtSKU.Value                    \n                Else                    \n                    MsgBox \"The SKU you entered isn't a valid product number.\", vbCritical, \"Invalid SKU\"                    \n                    Exit Sub                \n                End If            \n\n            End If\n\n            SQLString = \"sku = '\" &amp; txtSKU.Value &amp; \"'\"\n\n        Else\n\n            If IsNull(txtTitle.Value) = False Then                \n\n                TitleString = txtTitle.Value                \n\n                Do\n                    If InStr(TitleString, \"  \") &gt; 0 Then\n                        TitleString = Replace(TitleString, \"  \", \" \")\n                    Else\n                        Exit Do\n                    End If\n                Loop\n\n                If Left(TitleString, 6) = \"like '\" Or Left(TitleString, 6) = \"like \" &amp; Chr(34) Then                    \n\n                TitleString = Mid(TitleString, 7)                    \n\n                    If Right(TitleString, 1) = Chr(34) Or Right(TitleString, 1) = Chr(39) Then\n                        TitleString = Left(TitleString, Len(TitleString) - 1)\n                    End If\n\n                    SQLString = \"title LIKE '\" &amp; InsertChr39(TitleString) &amp; \"' OR ID IN (SELECT ID FROM Variants WHERE Variant LIKE '\" &amp; InsertChr39(TitleString) &amp; \"')\"\n\n                Else\n\n                    SQLString = \"title = '\" &amp; InsertChr39(TitleString) &amp; \"' OR ID IN (SELECT ID FROM TitleVariants WHERE VariantTitle = '\" &amp; InsertChr39(TitleString) &amp; \"')\"\n\n                End If\n\n            Else\n\n                If IsNull(txtSongID.Value) = False Then\n                    SQLString = \"(ID = \" &amp; txtSongID.Value &amp; \")\"\n                End If\n\n            End If\n\n            If IsNull(cmbName.Value) = False Then\n                SQLString = SQLString &amp; IIf(SQLString &gt; \"\", \" AND \", \"\") &amp; \"(songid IN (SELECT ID FROM Names WHERE Nameno  = \" &amp; cmbName.Value &amp; \"))\"\n            Else\n                If IsNull(cmbPrimary.Value) = False Then\n                    SQLString = SQLString &amp; IIf(SQLString &gt; \"\", \" AND \", \"\") &amp; \"Primary = \" &amp; cmbPrimary.Value\n                End If\n            End If\n\n            If IsNull(cmbStatusID.Value) = False Then\n                SQLString = SQLString &amp; IIf(SQLString &gt; \"\", \" AND \", \"\") &amp; \"StatusID = \" &amp; cmbStatusID.Value\n            End If\n\n            If IsNull(cmbPublisher.Value) = False Then\n                SQLString = SQLString &amp; IIf(SQLString &gt; \"\", \" AND \", \"\") &amp; \"PublisherID = \" &amp; cmbPublisher.Value\n            End If\n\n        End If\n\n    End If\n\n    If SQLString = \"\" Then        \n        MsgBox \"You haven't entered any search criteria\", vbInformation, \"No Search\"\n        Exit Sub    \n    End If\n\n    SQLString = \"SELECT * FROM Production WHERE \" &amp; SQLString\n\n    Forms(\"Production\").RecordSource = SQLString\n\n    DoCmd.Close acForm, \"ProductionFind\"\n\nEnd Sub\n</code></pre>\n\n<p>Once the record is loaded on the main form, a user can select an option from a combo-box \"auto-search\", this option will then execute a stored procedure that resides on a sql server, and use its output as its form RecordSource.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Private Sub cmbAutoSearch_Click()\n\n    Dim ADOCon As ADODB.Connection\n    Dim ADOQD As ADODB.Command\n    Dim ADORS As ADODB.Recordset\n    Dim SearchSQL As String\n\n    SearchSQL = \"\"\n\n    Set ADOCon = New ADODB.Connection\n    With ADOCon\n        .ConnectionString = GetConnectionString(\"MNCatalog\")\n        .Open\n    End With\n\n    If cmbAutoSearch.Value = 101 Then    \n\n        Set ADOQD = New ADODB.Command\n        With ADOQD\n            .ActiveConnection = ADOCon\n            .ActiveConnection.CursorLocation = adUseClient\n            .CommandType = adCmdStoredProc\n            .CommandText = \"[dbo].[mn_Production_Derived_Products_Hierarchy]\"\n            .Parameters.Append .CreateParameter(\"@sku\", adVarChar, adParamInput, 10, SKU.Value)\n        End With\n\n        Set ADORS = New ADODB.Recordset\n        With ADORS\n            .CursorType = adOpenKeyset\n            .CursorLocation = adUseClient\n            Set ADORS = ADOQD.Execute()\n            Set Me.Recordset = ADORS.Clone\n        End With    \n\n    End If\n\n    Set ADOQD = Nothing\n    Set ADORS = Nothing    \n    ADOCon.Close: Set ADOCon = Nothing\n\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>The output from the stored procedure gets assigned in this line:</p>\n\n<pre><code>Set Me.Recordset = ADORS.Clone\n</code></pre>\n\n<p>The record(s) get loaded, everything so far seems to be working fine, if there are more than one record(s), the user can navigate back and forth on that result set. </p>\n\n<p>The problem occurs when the user tries to use the \"Find\" form after having used the combo-box option/ functionality. </p>\n\n<p>Steps:</p>\n\n<ol>\n<li>Click on \"Find\" button on mani form, which opens another form named \"Find\"</li>\n<li>Click \"Find\" button on \"Find\" form</li>\n</ol>\n\n<p>Then Run-time error '31' shows up.</p>\n\n<p>\"Data provider could not be initialized.\"</p>\n\n<p>When I run the debugger, I see that the error happens in this line in the \"Find\" form code:</p>\n\n<pre><code>Forms(\"Production\").RecordSource = SQLString\n</code></pre>\n\n<p>I could see that the previous call to the stored procedure was still as the record source value.</p>\n\n<p>So I tried this:</p>\n\n<pre><code>Forms(\"Production\").RecordSource = \"\"\nForms(\"Production\").RecordSource = SQLString\n</code></pre>\n\n<p>Even though that \"clears\" the value of {call stored procedure ?} (something like that), still returns the same error. </p>\n\n<p>I am at a lost, I do not know how to correct this error. Any advice would be great. Perhaps is I am thinking too much, and this is fixed with something simple.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515019622, "post_id": 48086090, "comment_id": 83147456, "body": "Shouldn&#39;t <code>Evaluate(colary)</code> just be <code>colary</code>"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515019849, "post_id": 48086090, "comment_id": 83147528, "body": "I found a solution here at the end answered by Osuchov: <a href=\"https://stackoverflow.com/questions/28834596/assign-array-to-removeduplicates-columns\" title=\"assign array to removeduplicates columns\">stackoverflow.com/questions/28834596/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1515023537, "last_edit_date": 1515023537, "creation_date": 1515023176, "answer_id": 48086761, "question_id": 48086090, "link": "https://stackoverflow.com/questions/48086090/function-to-remove-duplicates-from-entire-sheet-vba/48086761#48086761", "title": "Function to remove duplicates from entire sheet vba", "body": "<p>Since you were wanting to create a function, here is a method</p>\n\n<pre><code>Sub RemoveDupes(ByVal entireRng As Range, ByVal col As Integer, Optional ByVal containsHeaders As Boolean = True)\n    Dim retVal As Integer\n    If containsHeaders = True Then\n        retVal = xlYes\n    Else\n        retVal = xlNo\n    End If\n    entireRng.RemoveDuplicates Columns:=col, Header:=retVal\nEnd Sub\n</code></pre>\n\n<p>The routine isn't really less work than just typing it out, but you can use it however you desire.</p>\n\n<p>If you want to check multiple columns, then for the <code>col</code> variable you can pass an array.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 13604080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gjtf3l-_9a6tSIpr6QGcgY1-pf_ksAHsHG6Fhhx3Q=k-s128", "display_name": "GERMAN RODRIGUEZ", "link": "https://stackoverflow.com/users/13604080/german-rodriguez"}, "is_accepted": false, "score": 0, "last_activity_date": 1609705894, "creation_date": 1609705894, "answer_id": 65554624, "question_id": 48086090, "link": "https://stackoverflow.com/questions/48086090/function-to-remove-duplicates-from-entire-sheet-vba/65554624#65554624", "title": "Function to remove duplicates from entire sheet vba", "body": "<p>This function remove duplicates from all columns in current worksheet</p>\n<pre><code>Sub RemDupCol() 'remove duplicates from all columns\nDim rng As Range\nDim cols As Variant\nDim i As Integer\n\nSet rng = [A1].CurrentRegion 'range bounded by any combination of blank rows and blank columns\nReDim cols(0 To rng.Columns.Count - 1) 'resize a dynamic array already declared\nFor i = 0 To UBound(cols) 'Loop for all columns\ncols(i) = i + 1\nNext i\nrng.RemoveDuplicates Columns:=(cols), Header:=xlYes 'Removes duplicate values from a range of values.\n'Array of indexes of the columns that contain the duplicate information. first row contains header information.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 48086761, "answer_count": 2, "score": 1, "last_activity_date": 1609705894, "creation_date": 1515018447, "last_edit_date": 1531164843, "question_id": 48086090, "link": "https://stackoverflow.com/questions/48086090/function-to-remove-duplicates-from-entire-sheet-vba", "title": "Function to remove duplicates from entire sheet vba", "body": "<p>I cannot get the function below to work. Ideally I would like to create a function that will automatically identify how many used columns are in the sheet then pass that as an array to the delete duplicates. I cannot understand why it is not working. I can confirm that these sheets have headers and multiple rows. I keep on getting error 5 when I try to remove duplicates using the array. </p>\n\n<pre><code>        ReDim colary(1 To wbDestination.Sheets(1).Range(\"XX1\").End(xlToLeft).Column)\n        For i = 1 To UBound(colary)\n            colary(i) = i\n        Next i\n\n        wbDestination.Sheets(1).Range(\"$A$1:\" &amp; wbDestination.Sheets(1).Range(\"A1\").SpecialCells(xlCellTypeLastCell).Address).RemoveDuplicates Columns:=Evaluate(colary), Header:=xlYes\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "slicers", "vba"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1515023730, "post_id": 48085642, "comment_id": 83148588, "body": "<a href=\"https://stackoverflow.com/q/47018410/212869\">stackoverflow.com/q/47018410/212869</a> - doesn&#39;t look like it"}], "owner": {"reputation": 191, "user_id": 7133644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5028a4aa35bb0c91fd84ad89d7514e1b?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun Arun", "link": "https://stackoverflow.com/users/7133644/arjun-arun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 961, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515016286, "creation_date": 1515016286, "last_edit_date": 1531161705, "question_id": 48085642, "link": "https://stackoverflow.com/questions/48085642/excel-slicer-multi-select-functionality-turns-off-when-workbook-is-closed", "title": "Excel slicer multi-select functionality turns off when workbook is closed?", "body": "<p>I have a workbook that contains a report with tables and slicers. </p>\n\n<p>Currently, when the user opens the workbook, they must manually click the \"multi-select\" option on the slicer. Is there a way to keep this permanently selected (even when the workbook is closed and re-opened)? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "ms-access", "ms-word", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1515016265, "post_id": 48085508, "comment_id": 83146202, "body": "I found this 2 articles that if maybe don&#39;t solve your question, can be interesting for you: <a href=\"https://www.wizdoh.com/how-to-communicate-with-other-applications-using-vba/\" rel=\"nofollow noreferrer\">wizdoh.com/how-to-communicate-with-other-applications-using-&zwnj;&#8203;vba</a> - <a href=\"https://wellsr.com/vba/2015/excel/appactivate-activate-folder-or-application-if-already-open/\" rel=\"nofollow noreferrer\">wellsr.com/vba/2015/excel/&hellip;</a>"}, {"owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "edited": false, "score": 1, "creation_date": 1515016405, "post_id": 48085508, "comment_id": 83146260, "body": "Have you looked into the <code>Application.Name</code> property? I can&#39;t confirm it works outside of office products, but it seems to be consistent with MS stuff.."}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "reply_to_user": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "edited": false, "score": 0, "creation_date": 1515016735, "post_id": 48085508, "comment_id": 83146410, "body": "@Chris Meurer, post that as an answer."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1515017917, "post_id": 48085508, "comment_id": 83146857, "body": "Chris Meurer, that nailed it. Solution right under my nose. As Gordon says, post that as an answer..! I&#39;ll vote for it as my solution."}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1515018394, "post_id": 48085508, "comment_id": 83147060, "body": "@David G. I&#39;m a bit familiar with inter-product communication; I&#39;ve got about a dozen references in my main project file. One of them is for a nicer version of the Access-to-Excel exporter which outputs a query to a spreadsheet, and because it&#39;s VBA allows the full environment of Excel formatting, instead of the lame built-in widget that Access provides. =-)"}], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1515071273, "post_id": 48086306, "comment_id": 83166607, "body": "Right under my nose, lol..!! Yes, that works with Access, Excel, and Word."}], "tags": [], "owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "is_accepted": true, "score": 2, "last_activity_date": 1515019922, "creation_date": 1515019922, "answer_id": 48086306, "question_id": 48085508, "link": "https://stackoverflow.com/questions/48085508/how-can-vba-determine-which-software-product-its-currently-running-within/48086306#48086306", "title": "How can VBA determine which software product it&#39;s currently running within..?", "body": "<p>I believe your best bet will be the <code>Application.Name</code> property. I can't confirm it works for all VBA implementations, but it appears to be consistent with MS products.\nFrom the MSDN reference: <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221371(v=office.11).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa221371(v=office.11).aspx</a></p>\n"}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 48086306, "answer_count": 1, "score": 3, "last_activity_date": 1594638491, "creation_date": 1515015584, "last_edit_date": 1594638491, "question_id": 48085508, "link": "https://stackoverflow.com/questions/48085508/how-can-vba-determine-which-software-product-its-currently-running-within", "title": "How can VBA determine which software product it&#39;s currently running within..?", "body": "<p>Many software products have VBA incorporated into them. This includes Microsoft Office of course, but there are many 3rd-party products which have chosen to include VBA as well. A quick Google search turned up names like AutoCad, WordPerfect, PowerTerm, and ScriptWorx. </p>\n\n<p>If one wishes to use #If/#EndIf directives to design a Sub or Function to work in multiple environments, how can VBA detect which one it's currently running in..??</p>\n\n<p>This is a bit different than detecting if a product is installed, in which case CreateObject() and an ErrorHandler could be used. Also, checking the References collection would not be definitive, since a VBA project might have multiple references to products other than the current one. For instance, an Access project might have a reference to Excel, and vice-versa (as many of mine do).</p>\n\n<p>Say, I want to write a function that returns the name of the current file. Here's some pseudo-code using Access and Excel as examples.</p>\n\n<pre><code>Public Function CurrentFilename() As String\n    #If EnvironmentName=\"Access\" Then\n        CurrentFilename = Access.Application.CurrentProject.Fullname\n    #ElseIf EnvironmentName=\"Excel\" Then\n        CurrentFilename = Excel.Application.ActiveWorkbook.Fullname\n    #Else\n        MsgBox \"Current VBA software environment is not recognized.\"\n    #End If\nEnd Function\n</code></pre>\n\n<p>Is this possible..? If so, what's the magic constant or function to replace 'EnvironmentName'..?</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1515014664, "post_id": 48085239, "comment_id": 83145527, "body": "Why filter? Just apply a Vlookup with an error catch, so only the found ones get filled in."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515015609, "post_id": 48085239, "comment_id": 83145932, "body": "So you want to so this in place?  Then filter on <code>Vague</code> you do that with the filter on the data tab.  once filtered put in the VLOOKUP and fill down.  Then remove the filter.  The formula will only be put in the visible cells.  Not sure what the problem is."}, {"owner": {"reputation": 3, "user_id": 9170024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yYcQvQ7nBhc/AAAAAAAAAAI/AAAAAAAAAHU/Vi6NTU-vwjs/photo.jpg?sz=128", "display_name": "Zak", "link": "https://stackoverflow.com/users/9170024/zak"}, "edited": false, "score": 0, "creation_date": 1515015910, "post_id": 48085239, "comment_id": 83146062, "body": "Manual filtering and pasting a formula isn&#39;t an option, as noted in my question -- this needs to be done using VBA, (it is applicable to multiple identical worksheets with thousands of orders)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515016106, "post_id": 48085239, "comment_id": 83146140, "body": "Well then you will need to write that vba, and come here for specific help with code that is not working.  Stack Overflow is not a code for me site."}, {"owner": {"reputation": 3, "user_id": 9170024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yYcQvQ7nBhc/AAAAAAAAAAI/AAAAAAAAAHU/Vi6NTU-vwjs/photo.jpg?sz=128", "display_name": "Zak", "link": "https://stackoverflow.com/users/9170024/zak"}, "edited": false, "score": 0, "creation_date": 1515016390, "post_id": 48085239, "comment_id": 83146255, "body": "Copy that, just need to be pointed in the right direction here for what to begin researching. (Was hoping the solution was simple)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515016436, "post_id": 48085239, "comment_id": 83146281, "body": "please put the code in the original post and not the comments.  comments can not be formatted."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9170024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yYcQvQ7nBhc/AAAAAAAAAAI/AAAAAAAAAHU/Vi6NTU-vwjs/photo.jpg?sz=128", "display_name": "Zak", "link": "https://stackoverflow.com/users/9170024/zak"}, "edited": false, "score": 0, "creation_date": 1515015352, "post_id": 48085344, "comment_id": 83145823, "body": "Unfortunately, need to be able to maintain the original order status is it&#39;s not &quot;vague.&quot;   ie., besides &quot;good&quot; there could be &quot;great&quot;, &quot;awesome&quot;, etc.  sorry for not mentioning that in the original post!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 3, "user_id": 9170024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yYcQvQ7nBhc/AAAAAAAAAAI/AAAAAAAAAHU/Vi6NTU-vwjs/photo.jpg?sz=128", "display_name": "Zak", "link": "https://stackoverflow.com/users/9170024/zak"}, "edited": false, "score": 0, "creation_date": 1515042722, "post_id": 48085344, "comment_id": 83152554, "body": "That does not matter. My point is that you can use a Vlookup on the whole list, not just a filtered list. Use conditions in a wrapped error catch to apply the vlookup only on rows you want."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1515014752, "creation_date": 1515014752, "answer_id": 48085344, "question_id": 48085239, "link": "https://stackoverflow.com/questions/48085239/how-to-filldown-vlookup-on-a-filtered-range-excel-vba/48085344#48085344", "title": "How to Filldown Vlookup on a Filtered Range | Excel VBA", "body": "<p>Why filter? Just apply a Vlookup with an error catch.</p>\n\n<pre><code>=iferror(Vlookup(bla),\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9170024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yYcQvQ7nBhc/AAAAAAAAAAI/AAAAAAAAAHU/Vi6NTU-vwjs/photo.jpg?sz=128", "display_name": "Zak", "link": "https://stackoverflow.com/users/9170024/zak"}, "edited": false, "score": 0, "creation_date": 1515092825, "post_id": 48085945, "comment_id": 83179062, "body": "Perfect! You are amazing"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1515018512, "last_edit_date": 1515018512, "creation_date": 1515017641, "answer_id": 48085945, "question_id": 48085239, "link": "https://stackoverflow.com/questions/48085239/how-to-filldown-vlookup-on-a-filtered-range-excel-vba/48085945#48085945", "title": "How to Filldown Vlookup on a Filtered Range | Excel VBA", "body": "<p>Use SpecialCells</p>\n\n<pre><code>Sub Test_macro()\n\nSheet1.Range(\"A1:B6\").AutoFilter Field:=2, Criteria1:=\"Vague\"\nSheet1.Range(\"B2:B\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).SpecialCells(xlCellTypeVisible).FormulaR1C1 = \"=VLOOKUP(RC[-1],StatusTable!C1:C2,2,FALSE)\"\nSheet1.ShowAllData\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9170024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yYcQvQ7nBhc/AAAAAAAAAAI/AAAAAAAAAHU/Vi6NTU-vwjs/photo.jpg?sz=128", "display_name": "Zak", "link": "https://stackoverflow.com/users/9170024/zak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2642, "favorite_count": 0, "accepted_answer_id": 48085945, "answer_count": 2, "score": -3, "last_activity_date": 1515051005, "creation_date": 1515014185, "last_edit_date": 1515051005, "question_id": 48085239, "link": "https://stackoverflow.com/questions/48085239/how-to-filldown-vlookup-on-a-filtered-range-excel-vba", "title": "How to Filldown Vlookup on a Filtered Range | Excel VBA", "body": "<p>Thanks for your help! Need assistance in the vba for writing a macro that filters my data, and then applies a vlookup to only the filtered range.</p>\n\n<p>ex)</p>\n\n<p><strong>OrderTable</strong> - List of Orders and their corresponding Statuses, (Some simple, some vague)</p>\n\n<p><strong>StatusTable</strong> - Contains a list of all the vague Orders, but with more more detailed information</p>\n\n<p>Each table is contained on a separate tab within the same worksheet. I need assistance in <strong>writing the VBA</strong> for filtering the OrderTable to <em>only</em> the vague status orders, followed by a vlookup filldown, so that we might reference the StatusDetails table to retrieve the more accurate statuses. We need to be abel to retain the original status if not \"vague\", so an =iferror wont' help out here</p>\n\n<p><em>(Essentially, we're making an excel left join on \"vague\" orders)</em></p>\n\n<p>This all occurs on a worksheet with thousands of orders, (with much more complex descriptions being pulled in), multiple times a day. </p>\n\n<p>Order table</p>\n\n<p><img src=\"https://i.stack.imgur.com/Fj2ne.png\" alt=\"OrderTable\"></p>\n\n<p>status table</p>\n\n<p><img src=\"https://i.stack.imgur.com/X9mAO.png\" alt=\"StatusTable\"></p>\n\n<p>The problem I'm encountering is that this is a dynamic range, after filtering... the order in cell B3 is not always \"vague\", the first \"vague\" cell in the range may sometimes be B2 or B5, depending on which orders are yet to be fulfilled</p>\n\n<pre><code>Sub Test_macro()\n\n    Range(\"$A$1:$B$6\").AutoFilter Field:=2, Criteria1:=\"Vague\"\n    ActiveCell.FormulaR1C1 = \"=VLOOKUP(B3),StatusTable!A:B,2,0)\"\n    Sheet1.Range(\"B3\", \"B\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).FillDown\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for your patience here</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515014055, "post_id": 48085180, "comment_id": 83145320, "body": "@ScottCraner This might make a good dup-target if you put that as an answer.  (It&#39;s a well-written question focussed solely on the one issue.)"}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1515015130, "post_id": 48085254, "comment_id": 83145729, "body": "I was hoping it would translate but I had no way of verifying without reinstalling my Excel. Thank you mr. Craner."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1515015251, "post_id": 48085254, "comment_id": 83145779, "body": "good question and as @YowE3k stated, this will be a good dup-target for this type of question in the future.  There are many &quot;Why won&#39;t my formula work&quot; that is because they try to put the local version of the formula and use <code>.Formula</code>."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 9, "last_activity_date": 1515014297, "creation_date": 1515014297, "answer_id": 48085254, "question_id": 48085180, "link": "https://stackoverflow.com/questions/48085180/does-range-formula-property-translate-to-other-locale/48085254#48085254", "title": "Does Range.Formula property translate to other locale", "body": "<p>In Excel vba the <code>.Formula</code> requires that the formula to be inserted be in EN-USA format.  This is regardless of the local settings.</p>\n\n<p>Excel will then translate it into the local vernacular when putting it in the sheet.</p>\n\n<p>So no matter what the local settings it will work cross languages.</p>\n\n<p>VBA also has the <code>.FormulaLocal</code> which allows the entry of the formula in the native language.  But (as far as I know) it will not work cross different local settings.</p>\n"}], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 48085254, "answer_count": 1, "score": 6, "last_activity_date": 1515014844, "creation_date": 1515013853, "last_edit_date": 1531161705, "question_id": 48085180, "link": "https://stackoverflow.com/questions/48085180/does-range-formula-property-translate-to-other-locale", "title": "Does Range.Formula property translate to other locale", "body": "<p>When a user manually enters formula in a sheet in the English version of Excel and sends this document to another user who has Excel in another version, the formula is automatically translated to the language in which the document is opened.</p>\n\n<pre><code>'Formula entered in Sheet1!B1 in the English Excel version\n=VLOOKUP(A1,Sheet2!$A$1:$C$150,3,FALSE)\n'Formula as shown in a Dutch Excel version\n=VERT.ZOEKEN(A1;Sheet2!$A$1:$C$150;3;ONWAAR)\n</code></pre>\n\n<p>When I programmatically add a formula, in my English version, it would look like this:</p>\n\n<pre><code>Sub AddFormula()\n    ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 2).Formula = \"=VLOOKUP(A1,Sheet2!$A$1:$C$150,3,FALSE)\"\nEnd Sub\n</code></pre>\n\n<p>If I were to run this procedure on my English Version, then save the document and send it over to a user with another language, it would be fine as the formula is in the cell and thus translated to whatever language and locale the 2nd user uses.</p>\n\n<p>My question is what happens when the 2nd user runs the procedure, in the Dutch (or other language for that matter) Excel with the formula in the code written in the EN-US format. Will it be translated or will it throw an error and in case of the latter, how would I solve that and make the formula insertion language proof?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515015362, "post_id": 48084794, "comment_id": 83145828, "body": "Do you have to actually FIND the cell first, say the one below a specific table header?  You can use the Cell address as shown below once you find it, if you already know it then all the merrier.  In your example above: Dim onerow As double // onerow = ThisWorkbook.Worksheets(&quot;worksheetname&quot;).Range(&quot;K1&quot;).Row // same for column except .column // easier if you dim a worksheet and assign the worksheet once ex. with Set fossWS =  ThisWorkbook.Worksheets(&quot;worksheetname&quot;) // then its onecol = fossWS.Range(&quot;K1&quot;).Column  It&#39;s all down below using address and getting the row/col"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515015667, "post_id": 48084794, "comment_id": 83145966, "body": "I suppose my comment above it do you have to find the location of &quot;ID&quot; or &quot;value&quot; to target the left corner of your data range and then find the data table boundary lower right corner?  Are the tables always the same size and in the same location?  Those are trickier asks for multiple tables, multiple worksheets, multiple workbooks . . . ."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515019544, "post_id": 48084794, "comment_id": 83147430, "body": "@Wookies-Will-Code We (Scott and I) interpreted the question as the OP knows the <b>name</b> of the table (e.g. &quot;tbl&quot;) and which worksheet it is on, but doesn&#39;t know where that table is located within the worksheet.  So, given just a table name (and the knowledge that it is on the active worksheet), how can specific rows of data from that table be extracted?"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515019750, "post_id": 48084794, "comment_id": 83147504, "body": "gotcha, you 2 are always one step ahead of me . . . . Cheers"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515012649, "post_id": 48084882, "comment_id": 83144683, "body": "I was about to ask why you deleted your answer.  It works. @YowE3K"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515012717, "post_id": 48084882, "comment_id": 83144714, "body": "I deleted my answer because it is effectively the same as yours - and I was only posting because I had missed the <code>rng.Cells</code> part of your answer, so was thinking you were just getting the raw sheet cells :D  (Plus I was thinking the question asked how to get the first two rows, not the 3rd and 4th row.)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515012786, "post_id": 48084882, "comment_id": 83144755, "body": "Well, undelete yours as it is a viable alternative.  I prefer cells as it works better in my head, but the OP may prefer your method."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515015420, "post_id": 48084882, "comment_id": 83145846, "body": "I like Cells, .address, and .row / .column"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 7, "last_activity_date": 1515012391, "creation_date": 1515012391, "answer_id": 48084882, "question_id": 48084794, "link": "https://stackoverflow.com/questions/48084794/location-of-first-cell-in-an-excel-table/48084882#48084882", "title": "Location of first cell in an excel table", "body": "<p>Use Cells():</p>\n\n<pre><code>Sub test()\nDim rng As Range\nDim arr() As Variant\nSet rng = ActiveSheet.ListObjects(\"tbl\").DataBodyRange\narr = ActiveSheet.Range(rng.Cells(3, 1), rng.Cells(4, 2)).Value    \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515013553, "post_id": 48084905, "comment_id": 83145102, "body": "As stated in my comments,  The fact that you can use A1 reference in a table that does not start in the actual A1 cell, just makes my brain hurt.  But I can wrap my feeble mind around a grid location, and as such the use of cells makes sense."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515013853, "post_id": 48084905, "comment_id": 83145246, "body": "@ScottCraner To be perfectly honest, I prefer <code>Cells</code> myself so, although my <code>Rows(&quot;3:4&quot;)</code> makes sense to me, my <code>Range(&quot;A3:B4&quot;)</code> makes my brain hurt too - it is too confusing to me to think in terms of worksheet A1 notation when it isn&#39;t a worksheet :D"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515015526, "post_id": 48084905, "comment_id": 83145892, "body": "I like Cells, .address, and .row / .column"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1515013208, "last_edit_date": 1515013208, "creation_date": 1515012491, "answer_id": 48084905, "question_id": 48084794, "link": "https://stackoverflow.com/questions/48084794/location-of-first-cell-in-an-excel-table/48084905#48084905", "title": "Location of first cell in an excel table", "body": "<p>If you just want the third and fourth data rows (i.e. fourth and fifth rows if you count the heading row), you could use</p>\n\n<pre><code>Sub test()\n    Dim rng As Range\n    Dim arr() As Variant\n    Set rng = ActiveSheet.ListObjects(\"tbl\").DataBodyRange\n    arr = rng.Rows(\"3:4\").Value\n    'or\n    arr = rng.Range(\"A3:B4\").Value\nEnd Sub\n</code></pre>\n\n<p>Because the <code>Rows</code> and <code>Range</code> properties are being applied to the <code>rng</code> object, the references (<code>\"3:4\"</code> and <code>\"A3:B4\"</code>) are relative to the start of the <code>rng</code> object.</p>\n\n<p>So you could also get the worksheet address of the first cell in <code>rng</code> by using <code>rng.Range(\"A1\").Address</code> (or <code>rng.Cells(1, 1).Address</code>), or you can get the first cell's worksheet row and column by just using <code>rng.Row</code> and <code>rng.Column</code> respectively (they both default to returning the value for the first cell).</p>\n"}, {"comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515015776, "post_id": 48084922, "comment_id": 83146007, "body": "branx is looking for the corner of the table.  Not clear from OP whether they know the table positions or must find them, whether the size of the table may change (defining the lower right cell to complete the range).  Good thinking concept for today."}], "tags": [], "owner": {"reputation": 43, "user_id": 7541810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf937b4e2620c9d3c9798ccd648078?s=128&d=identicon&r=PG&f=1", "display_name": "branx", "link": "https://stackoverflow.com/users/7541810/branx"}, "is_accepted": false, "score": 1, "last_activity_date": 1515012569, "creation_date": 1515012569, "answer_id": 48084922, "question_id": 48084794, "link": "https://stackoverflow.com/questions/48084794/location-of-first-cell-in-an-excel-table/48084922#48084922", "title": "Location of first cell in an excel table", "body": "<p>The first cell in a table has some unique properties:</p>\n\n<p>-It is not empty</p>\n\n<p>-The cell above it is null</p>\n\n<p>-The cell to the left of it is null</p>\n\n<p>-The cell below it is not null</p>\n\n<p>Using these properties you can do something like:</p>\n\n<p>1) Loop over every cell</p>\n\n<p>2) If that cell has the above properties, then it is a \"top left\" cell</p>\n\n<p>3) Do whatever with that table</p>\n"}], "owner": {"reputation": 491, "user_id": 5608122, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9663280a11ad10efec26c4fa646484f5?s=128&d=identicon&r=PG&f=1", "display_name": "fossekall", "link": "https://stackoverflow.com/users/5608122/fossekall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4607, "favorite_count": 0, "accepted_answer_id": 48084882, "answer_count": 3, "score": 2, "last_activity_date": 1515014387, "creation_date": 1515011969, "last_edit_date": 1515014387, "question_id": 48084794, "link": "https://stackoverflow.com/questions/48084794/location-of-first-cell-in-an-excel-table", "title": "Location of first cell in an excel table", "body": "<p>I use Excel tables a lot. It makes it possible to have multiple tables in one worksheet. But I have got into a problem in VBA which I do not know how to solve.</p>\n\n<p>Let us say that I have a table called \"tbl\" in my spreadsheet. It contains the following data:</p>\n\n<pre><code>id value\n1  1000\n1  2000\n2  3000\n2  4000\n</code></pre>\n\n<p>I have the following code which works:</p>\n\n<pre><code>Sub test()\n    Dim rng As Range\n    Dim arr() As Variant\n    Set rng = ActiveSheet.ListObjects(\"tbl\").DataBodyRange\n    arr = rng.Value\nEnd Sub\n</code></pre>\n\n<p>This code will put the whole table into <code>arr</code>. But there are situations where I only want some rows in the table. Let us say that I want row 4 and 5 i.e:</p>\n\n<pre><code>2  3000\n2  4000\n</code></pre>\n\n<p>The following code will do the trick:</p>\n\n<pre><code>arr = Range(\"A4:B5\")\n</code></pre>\n\n<p>But there are cases where I have many tables located in different places in my spreadsheet. Therefore I need to work out where the first cell in the table is located (upper left). If it is located in K1, I need to get both the column and the row (K and 1).</p>\n\n<p>Is there an easy way to do this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1515014331, "creation_date": 1515014331, "answer_id": 48085261, "question_id": 48084759, "link": "https://stackoverflow.com/questions/48084759/in-excel-find-cut-and-paste-an-entire-row-to-another-sheet/48085261#48085261", "title": "In Excel find, cut and paste an entire row to another sheet", "body": "<p>This should do what you need. Pay attention to comments I made.</p>\n\n<pre><code>Sub Allocate()\n\n    Application.ScreenUpdating = False\n\n    Dim checkSheet As Worksheet\n    Set checkSheet = ThisWorkbook.Worksheets(\"mySheet\") 'change to needed name\n\n    Dim loanNumber As String\n    loanNumber = Worksheets(\"AMode\").Range(\"C2\").Value\n\n    If Not checkSheet.UsedRange.Columns(1).Find(loanNumber, lookat:=xlWhole) Is Nothing Then\n\n        Dim usdRows As Long\n        usdRows = checkSheet.Range(\"A1\").CurrentRegion.Rows.Count\n\n        Dim allocDev As Workbook\n        Set allocDev = Application.Workbooks(\"allocations developments\") 'assumes it's already open\n\n        Dim i As Long\n        For i = UsdRws To 2 Step -1\n\n            If checkSheet.Range(\"A\" &amp; i).Value = loanNumber Then\n                checkSheet.Rows(i).Copy allocDev.Sheets(\"AL\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n                checkSheet.Rows(i).Delete\n            End If\n\n        Next\n\n    Else\n\n        MsgBox \"Loan Number Not Found\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9169907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/401d970999476fd0f60acaa0e6a78465?s=128&d=identicon&r=PG&f=1", "display_name": "Nielsen", "link": "https://stackoverflow.com/users/9169907/nielsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 486, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515014331, "creation_date": 1515011804, "last_edit_date": 1531164843, "question_id": 48084759, "link": "https://stackoverflow.com/questions/48084759/in-excel-find-cut-and-paste-an-entire-row-to-another-sheet", "title": "In Excel find, cut and paste an entire row to another sheet", "body": "<p>I am trying to find, cut and paste an entire row from one Excel sheet to another sheet, then delete the blank row in the first sheet.  Additionally, if the conditional value cannot be found I need a message box.  I have two problems with the code shown below:</p>\n\n<ol>\n<li>if the value is found in column A, then before the copy and paste happens, the code tries to open a new workbook which I have to hit cancel  </li>\n<li>If the value is not found in column A then the code creates the message box multiple times.  Any help is much appreciated.</li>\n</ol>\n\n<p>Code is Here:</p>\n\n<pre><code>Sub Allocate()\n\n    Dim UsdRws As Long\n    Dim i As Long\n\n    Application.ScreenUpdating = False\n\n    UsdRws = Range(\"A1\").CurrentRegion.Rows.Count\n\n    For i = UsdRws To 2 Step -1\n\n        If Range(\"A\" &amp; i).Value = Sheets(\"AMode\").Range(\"C2\") Then\n            Rows(i).Copy Workbooks(\"allocations development\").Sheets(\"AL\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n            Rows(i).Delete\n\n        Else: MsgBox \"Loan Number Not Found\"\n\n        End If\n\n    Next i\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 1, "creation_date": 1515011186, "post_id": 48084499, "comment_id": 83144045, "body": "<i>I can&#39;t parse it</i>, why? Are you getting an error? Describe what&#39;s happening."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1515011385, "post_id": 48084499, "comment_id": 83144139, "body": "<a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a> is the tool most frequently recommended here for parsing JSON in VBA.  Your JSON object in this case is an array though, so you can&#39;t enumerate its &quot;keys&quot;"}, {"owner": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "reply_to_user": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1515012507, "post_id": 48084499, "comment_id": 83144618, "body": "@RacilHilan Runtime error 424 object required is the error I get"}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 1, "creation_date": 1515012610, "post_id": 48084499, "comment_id": 83144665, "body": "You need to edit your question and add the error there, not in a comment. And also mention which line you&#39;re getting the error at."}, {"owner": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "reply_to_user": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1515016581, "post_id": 48084499, "comment_id": 83146339, "body": "@RacilHilan I edited my post. Any idea ?"}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1515031907, "post_id": 48084499, "comment_id": 83150391, "body": "The problem is that you said <i>I&#39;m using the JSON Parser from here</i> and then you linked to another question on SO. I don&#39;t know what parser you&#39;re using. I followed that link and it even linked to another question, which in turns had two links. I tried the first one <a href=\"https://code.google.com/archive/p/vba-json/\" rel=\"nofollow noreferrer\">vba-json</a> and both the download and wiki pages are down, so I cannot download it to test, and cannot check the docs. Provide the correct link to the parser that you&#39;re using."}, {"owner": {"reputation": 22589, "user_id": 542251, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c6a0ac3e18f1cd8d0f1be4c2e3a4cfbd?s=128&d=identicon&r=PG", "display_name": "Liam", "link": "https://stackoverflow.com/users/542251/liam"}, "edited": false, "score": 0, "creation_date": 1531152347, "post_id": 48084499, "comment_id": 89478373, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6627652/parsing-json-in-excel-vba\">Parsing JSON in Excel VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "edited": false, "score": 0, "creation_date": 1515016400, "post_id": 48084960, "comment_id": 83146258, "body": "Thanks for your detailed reply. I appreciate it ! However I prefer to parse the data manually myself using a json parser so that I have more control over the data."}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "reply_to_user": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "edited": false, "score": 0, "creation_date": 1515016927, "post_id": 48084960, "comment_id": 83146487, "body": "Oh I understand, have you ever used python? I like it more instead of VBA."}, {"owner": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "edited": false, "score": 0, "creation_date": 1515017004, "post_id": 48084960, "comment_id": 83146518, "body": "Yeah, me too :D But unfortunatly I need to use VBA for my project"}], "tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 2, "last_activity_date": 1515012748, "creation_date": 1515012748, "answer_id": 48084960, "question_id": 48084499, "link": "https://stackoverflow.com/questions/48084499/vba-parse-json-data/48084960#48084960", "title": "VBA Parse JSON Data", "body": "<p>Since Excel 2010 version you can download the add-in \"Power Query\" or if you have 2016 version it comes by default in Excel as \"Get &amp; Transform\". you can extract data easily, in your case it will be:</p>\n\n<ol>\n<li>Go Data</li>\n<li>Select \"From Web\"</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/WnHeX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WnHeX.png\" alt=\"\"></a></p>\n\n<ol start=\"3\">\n<li>Add the JSON url </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/NKVm0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NKVm0.png\" alt=\"\"></a></p>\n\n<p>It will open the ETL excel tools (Query Editor):</p>\n\n<ol start=\"4\">\n<li><p>Go \"Transform\"</p></li>\n<li><p>Select \"To Table\"</p></li>\n<li><p>I didn't change any parameter > OK</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/B2io4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B2io4.png\" alt=\"\"></a></p>\n\n<p>7.Click in the corner with two arrows and select the fields what you want.</p>\n\n<p><a href=\"https://i.stack.imgur.com/W0eGQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W0eGQ.png\" alt=\"\"></a></p>\n\n<ol start=\"8\">\n<li>There is a lot of tools to play with the data. Then Go \"Home\" and select \"close and load\" it will create a new sheet with your data.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/6VMPD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6VMPD.png\" alt=\"\"></a></p>\n\n<p>This is the \"advance editor\" code if you want just to copy and paste:</p>\n\n<pre><code>let\n    Source = Json.Document(Web.Contents(\"https://api.coinmarketcap.com/v1/ticker/\")),\n    #\"Converted to Table\" = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\n    #\"Expanded Column1\" = Table.ExpandRecordColumn(#\"Converted to Table\", \"Column1\", {\"id\", \"name\", \"symbol\", \"rank\", \"price_usd\", \"price_btc\", \"24h_volume_usd\", \"market_cap_usd\", \"available_supply\", \"total_supply\", \"max_supply\", \"percent_change_1h\", \"percent_change_24h\", \"percent_change_7d\", \"last_updated\"}, {\"Column1.id\", \"Column1.name\", \"Column1.symbol\", \"Column1.rank\", \"Column1.price_usd\", \"Column1.price_btc\", \"Column1.24h_volume_usd\", \"Column1.market_cap_usd\", \"Column1.available_supply\", \"Column1.total_supply\", \"Column1.max_supply\", \"Column1.percent_change_1h\", \"Column1.percent_change_24h\", \"Column1.percent_change_7d\", \"Column1.last_updated\"})\nin\n    #\"Expanded Column1\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "edited": false, "score": 0, "creation_date": 1515016353, "post_id": 48085445, "comment_id": 83146231, "body": "Thanks, yur solution works, but is there also a way to use the json parser I linked? I think using the parser might be more reliable, especially if some of the attributes change, the splitting method might not work anymore."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "edited": false, "score": 0, "creation_date": 1515016750, "post_id": 48085445, "comment_id": 83146416, "body": "I&#39;m not a great fan of <code>vba-json parser</code>, so I&#39;m sorry that I can&#39;t help you on that."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 3, "last_activity_date": 1515047982, "last_edit_date": 1515047982, "creation_date": 1515015297, "answer_id": 48085445, "question_id": 48084499, "link": "https://stackoverflow.com/questions/48084499/vba-parse-json-data/48085445#48085445", "title": "VBA Parse JSON Data", "body": "<p>Try the below script. It will fetch you all the data you have mentioned. No external parser is required to achieve this:</p>\n\n<pre><code>Sub coinmarketcap_data()\n    Dim http As New XMLHTTP60, res As Variant\n\n    With http\n        .Open \"GET\", \"https://api.coinmarketcap.com/v1/ticker/\", False\n        .send\n        res = .responseText\n    End With\n\n    For r = 1 To UBound(Split(res, \"id\"\": \"\"\"))\n        Cells(r, 1) = Split(Split(Split(res, \"name\"\": \"\"\")(r), \"\"\"symbol\")(0), \"\"\"\")(0)\n        Cells(r, 2) = Split(Split(Split(res, \"price_usd\"\": \"\"\")(r), \"\"\"price_btc\")(0), \"\"\"\")(0)\n    Next r\nEnd Sub\n</code></pre>\n\n<p>Reference to add to the library:</p>\n\n<pre><code>Microsoft XML, v6.0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1515027993, "creation_date": 1515027993, "answer_id": 48087339, "question_id": 48084499, "link": "https://stackoverflow.com/questions/48084499/vba-parse-json-data/48087339#48087339", "title": "VBA Parse JSON Data", "body": "<p>Simple example using <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-JSON</a></p>\n\n<pre><code>Public Sub LoadCryptocoins()\n\n    Dim Path As String\n    Dim Data As String\n    Dim jo As Object, o\n    Dim i As Long\n\n    Path = \"https://api.coinmarketcap.com/v1/ticker/\"\n    Data = DownloadDataFromURL(Path)\n\n    Set jo = json.parse(Data)\n\n    For i = 1 To jo.Count\n        Set o = jo(i)\n        Debug.Print o(\"id\")\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>The return value from <code>json.parse</code> will be a Collection if the JSON response represents an array, or a Scripting Dictionary if it's an object. </p>\n"}, {"tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": false, "score": 1, "last_activity_date": 1515034846, "creation_date": 1515034846, "answer_id": 48088073, "question_id": 48084499, "link": "https://stackoverflow.com/questions/48084499/vba-parse-json-data/48088073#48088073", "title": "VBA Parse JSON Data", "body": "<p>The exception that you get is because your parsed JSON object <code>jo</code> is a collection, so you have to loop through the collection items first before you can access each item's keys and values.</p>\n\n<p>I don't know what parser you're using, so I will answer using <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">VBA-JSON</a>:</p>\n\n<pre><code>Public Sub LoadCryptocoins()\n    Dim Path As String\n    Dim Data As String\n    Dim json As Object\n\n    Path = \"https://api.coinmarketcap.com/v1/ticker/\"\n    Data = DownloadDataFromURL(Path)\n\n    Set json = JsonConverter.ParseJson(Data)\n    For Each Item In json\n        MsgBox (Item(\"name\") &amp; \" $\" &amp; Item(\"price_usd\"))\n    Next\nEnd Sub\n</code></pre>\n\n<p>Now, using your parser, I imagine it should be something like this:</p>\n\n<pre><code>Public Sub LoadCryptocoins()\n    Dim Path As String\n    Dim Data As String\n    Dim json As Object\n\n    Path = \"https://api.coinmarketcap.com/v1/ticker/\"\n    Data = DownloadDataFromURL(Path)\n\n    Set jp = New JsonParser\n    Set jo = jp.Decode(Data)\n\n    For Each Item In jo\n        MsgBox (Item.GetValue(jo, \"name\") &amp; \" $\" &amp; Item.GetValue(jo, \"price_usd\"))\n    Next\nEnd Sub\n</code></pre>\n\n<p>But this is a complete blind shot in the dark. Once you post a link to the parser that you're using, I can update my answer.</p>\n"}], "owner": {"reputation": 217, "user_id": 4042470, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f809fc3fff2c712341154f7a52858d54?s=128&d=identicon&r=PG&f=1", "display_name": "n00b.exe", "link": "https://stackoverflow.com/users/4042470/n00b-exe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9033, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1515047982, "creation_date": 1515010469, "last_edit_date": 1515019907, "question_id": 48084499, "link": "https://stackoverflow.com/questions/48084499/vba-parse-json-data", "title": "VBA Parse JSON Data", "body": "<p>I am trying to parse the JSON data from a website. I successfully get the JSON string, but I can't parse it. An exception is thrown in the code below:</p>\n\n<blockquote>\n  <p>Runtime Error 424. Object Required</p>\n</blockquote>\n\n<p>This is my code:</p>\n\n<pre><code>' Download string from URL\nPublic Function DownloadDataFromURL(url As String) As String\n    Set Myrequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    Myrequest.Open \"GET\", url\n    Myrequest.send\n    Dim WebResponse As String\n    WebResponse = Myrequest.responseText\n    Cells(1, 1).Value = WebResponse\n    DownloadDataFromURL = WebResponse\nEnd Function\n\n' Download all cryptocoins in\nPublic Sub LoadCryptocoins()\n    Dim Path As String\n    Dim Data As String\n    Dim json As Object\n\n    Path = \"https://api.coinmarketcap.com/v1/ticker/\"\n    Data = DownloadDataFromURL(Path)\n\n    Set jp = New JsonParser\n    Set jo = jp.Decode(Data)\n\n    For Each Item In jp.EnumKeys(jo)\n        MsgBox (Item.GetValue(jo, \"id\")) 'The exception is thrown here\n    Next\nEnd Sub\n</code></pre>\n\n<p>I'm using the JSON Parser from here: <a href=\"https://stackoverflow.com/questions/6627652/parsing-json-in-excel-vba\">Parsing JSON in Excel VBA</a></p>\n\n<p>The raw JSON data I a processing can be found here: <a href=\"https://api.coinmarketcap.com/v1/ticker/\" rel=\"nofollow noreferrer\">https://api.coinmarketcap.com/v1/ticker/</a></p>\n\n<p>How can I get every coin name and the price in USD?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1143, "user_id": 8759952, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d8e784fa5cd3e5a2dfe13b405fc1de1?s=128&d=identicon&r=PG&f=1", "display_name": "Liora Haydont", "link": "https://stackoverflow.com/users/8759952/liora-haydont"}, "edited": false, "score": 0, "creation_date": 1515010588, "post_id": 48084493, "comment_id": 83143829, "body": "Is there an error message?"}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "reply_to_user": {"reputation": 1143, "user_id": 8759952, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d8e784fa5cd3e5a2dfe13b405fc1de1?s=128&d=identicon&r=PG&f=1", "display_name": "Liora Haydont", "link": "https://stackoverflow.com/users/8759952/liora-haydont"}, "edited": false, "score": 0, "creation_date": 1515010803, "post_id": 48084493, "comment_id": 83143914, "body": "It says Error 1004"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1515011258, "post_id": 48084493, "comment_id": 83144084, "body": "try this ActiveSheet.Protect contents:=True, userinterfaceonly:=True"}, {"owner": {"reputation": 512, "user_id": 8993210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4689867b8ad2b9a6444ecb3f65967e1c?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/8993210/lisa"}, "edited": false, "score": 3, "creation_date": 1515011804, "post_id": 48084493, "comment_id": 83144300, "body": "You can&#39;t protect an already protected sheet. You could try adding <code>ActiveSheet.Unprotect</code> before <code>ActiveSheet.Protect</code>."}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1515051940, "post_id": 48084493, "comment_id": 83155838, "body": "@Lisa11: Good idea. But it does not help. I now got an error on the new Line &#39;ActiveSheet.Unprotect&#39;"}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1515052020, "post_id": 48084493, "comment_id": 83155872, "body": "@pokemon_Man Does not help as well :-("}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1515052069, "post_id": 48084493, "comment_id": 83155895, "body": "The error occurs whenever I select a protected cell twice in a row."}], "answers": [{"comments": [{"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1515187146, "post_id": 48098069, "comment_id": 83219485, "body": "Thanks. That seems to be much more stable. I&#39;ll monitor the performance over the next days."}], "tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": true, "score": 1, "last_activity_date": 1515078383, "creation_date": 1515078383, "answer_id": 48098069, "question_id": 48084493, "link": "https://stackoverflow.com/questions/48084493/excel-allow-user-to-delete-a-row-containing-protected-cells-crashes/48098069#48098069", "title": "Excel: Allow user to delete a row containing protected cells \u2013 crashes", "body": "<p>I didn't have any issues with your code snippet, but you could only protect the sheet when it is not protected like so:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address Like \"$\" &amp; Target.Row &amp; \":$\" &amp; Target.Row Then\n        ActiveSheet.Unprotect\n    Else\n        If Not ActiveSheet.ProtectContents Then\n            ActiveSheet.Protect\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>This just wraps the protect statement in an if statement that checks to see if the sheet is not protected before it tries to protect the sheet.  </p>\n"}], "owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 48098069, "answer_count": 1, "score": 0, "last_activity_date": 1515078383, "creation_date": 1515010454, "last_edit_date": 1515052088, "question_id": 48084493, "link": "https://stackoverflow.com/questions/48084493/excel-allow-user-to-delete-a-row-containing-protected-cells-crashes", "title": "Excel: Allow user to delete a row containing protected cells \u2013 crashes", "body": "<p>I ve added this VBA do my document. But the code keeps crashing at this line:</p>\n\n<pre><code>ActiveSheet.Protect\n</code></pre>\n\n<p>I have no idea where to start?1</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31982783/excel-allow-user-to-delete-a-row-containing-protected-cells\">Excel: allow user to delete a row containing protected cells</a></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Address Like \"$\" &amp; Target.Row &amp; \":$\" &amp; Target.Row Then\nActiveSheet.Unprotect\nElse\nActiveSheet.Protect\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Update:</strong> \nThe error occurs whenever I select a protected cell twice in a row.</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515010258, "post_id": 48084368, "comment_id": 83143693, "body": "You&#39;ve told us what you are trying to do and gave us a code dump, which is not much of a meaningful question. Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or take a <a href=\"https://stackoverflow.com/tour\">tour</a> to understand how we can better help you."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1515010403, "post_id": 48084368, "comment_id": 83143756, "body": "You&#39;re pretty close to resolve your issue. Instead of adding hyperlinks, inside a loop open workbook, copy the data you want to insert into &quot;master sheet&quot;, then close workbook. Please, check <a href=\"https://www.codeproject.com/Tips/1187802/Copy-Data-Between-Excel-Sheets-using-VBA\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9169837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa59cf5747835433a3e876ac46eb99d2?s=128&d=identicon&r=PG&f=1", "display_name": "Troy B.", "link": "https://stackoverflow.com/users/9169837/troy-b"}, "edited": false, "score": 0, "creation_date": 1515699687, "post_id": 48180582, "comment_id": 83411070, "body": "I needed to have all the links located in a list to easily access the worksheets in addition to the macro itself. I forgot to post back on this thread bc i figured out how the code i needed to accomplish this. Thanks for the help though"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1515560460, "creation_date": 1515560460, "answer_id": 48180582, "question_id": 48084368, "link": "https://stackoverflow.com/questions/48084368/vba-opening-hyperlinks-from-a-list-to-copy-specific-data-into-a-master-sheet/48180582#48180582", "title": "VBA- Opening hyperlinks from a List to copy specific data into a master sheet", "body": "<p>Exactly!  Why are you messing around with Hyperlinks?  Just open a file, grab the data you need, close the file, and move on to the next one to do the same.  </p>\n\n<pre><code>Sub Basic_Example_1()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\Users\\Ron\\test\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win008.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win008.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9169837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa59cf5747835433a3e876ac46eb99d2?s=128&d=identicon&r=PG&f=1", "display_name": "Troy B.", "link": "https://stackoverflow.com/users/9169837/troy-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1064, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515560460, "creation_date": 1515009787, "last_edit_date": 1515015050, "question_id": 48084368, "link": "https://stackoverflow.com/questions/48084368/vba-opening-hyperlinks-from-a-list-to-copy-specific-data-into-a-master-sheet", "title": "VBA- Opening hyperlinks from a List to copy specific data into a master sheet", "body": "<p>I currently am using the below code to generate a list of hyperlinks from a specific folder. I am trying to figure out how to access each of those hyperlinks to copy and paste certain data into a master spreadsheet then close the document in a loop. The data is located on the same tab for each file but In each file the number of Columns are always the same but not always the number of rows. Im trying to figure out how to capture all of that info into a master sheet without blanks and without overwriting data from the file before.</p>\n\n<pre><code>Option Compare Text\nOption Explicit\n\nFunction Excludes(Ext As String) As Boolean\n     'Function purpose:  To exclude listed file extensions from hyperlink listing\n\n    Dim x, NumPos As Long\n\n     'Enter/adjust file extensions to EXCLUDE from listing here:\n    x = Array(\"exe\", \"xlsm\", \"xml\")\n\n    On Error Resume Next\n    NumPos = Application.WorksheetFunction.Match(Ext, x, 0)\n    If NumPos &gt; 0 Then\n        Excludes = True\n    Else\n        Excludes = False\n    End If\n    On Error GoTo 0\n\nEnd Function\n\nSub HyperlinkFileList()\n     'Macro purpose:  To create a hyperlinked list of all files in a user\n     'specified directory, including file size and date last modified\n     'NOTE:  The 'TextToDisplay' property (of the Hyperlink object) was added\n     'in Excel 2000.  This code tests the Excel version and does not use the\n     'Texttodisplay property if using XL 97.\n\n    Dim fso As Object, _\n    ShellApp As Object, _\n    File As Object, _\n    SubFolder As Object, _\n    Directory As String, _\n    Problem As Boolean, _\n    ExcelVer As Integer, _\n    TotalD As String, _\n    Wb As Workbook, _\n    Ws As Worksheet\n\n\n     'Turn off screen flashing\n    Application.ScreenUpdating = False\n\n     ' Clear sheet\n    Cells.Delete Shift:=xlUp\n    'Useless : Range(\"A1\").Select\n\n     'Create objects to get a listing of all files in the directory\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n     'Prompt user to select a directory\n    Do\n        Problem = False\n        Set ShellApp = CreateObject(\"Shell.Application\"). _\n        Browseforfolder(0, \"Please choose a folder\", 0, \"D:\\JBOSS\\Testdossier\")\n        'Browseforfolder(0, \"Please choose a folder\", 0, \"D:\\JBOSS\\Testdossier\")\n\n        On Error Resume Next\n         'Evaluate if directory is valid\n        Directory = ShellApp.self.Path\n        Set SubFolder = fso.GetFolder(Directory).Files\n        If Err.Number &lt;&gt; 0 Then\n            If MsgBox(\"You did not choose a valid directory!\" &amp; vbCrLf &amp; _\n            \"Would you like to try again?\", vbYesNoCancel, _\n            \"Directory Required\") &lt;&gt; vbYes Then Exit Sub\n            Problem = True\n        End If\n        On Error GoTo 0\n    Loop Until Problem = False\n\n     'Set up the headers on the worksheet\n    With ActiveSheet\n        With .Range(\"A1\")\n            .Value = \"Listing of all files in:\"\n            .ColumnWidth = 40\n             'If Excel 2000 or greater, add hyperlink with file name\n             'displayed.  If earlier, add hyperlink with full path displayed\n            If Val(Application.Version) &gt; 8 Then 'Using XL2000+\n                .Parent.Hyperlinks.Add _\n                Anchor:=.Offset(0, 1), _\n                Address:=Directory, _\n                TextToDisplay:=Directory\n            Else 'Using XL97\n                .Parent.Hyperlinks.Add _\n                Anchor:=.Offset(0, 1), _\n                Address:=Directory\n            End If\n        End With\n\n        With .Range(\"A2\")\n            .Value = \"File Name\"\n            .Interior.ColorIndex = 15\n            .ColumnWidth = 50\n            With .Offset(0, 1)\n                .ColumnWidth = 15\n                .Value = \"Date Modified\"\n                .Interior.ColorIndex = 15\n                .HorizontalAlignment = xlCenter\n            End With\n            With .Offset(0, 2)\n                .ColumnWidth = 12\n                .Value = \"File Size (Kb)\"\n                .Interior.ColorIndex = 15\n                .HorizontalAlignment = xlCenter\n            End With\n\n        End With\n    End With\n\n     'Adds each file, details and hyperlinks to the list\n    For Each File In SubFolder\n            If Not Excludes(Right(File.Path, 3)) = True Then\n                With ActiveSheet\n                     'If Excel 2000 or greater, add hyperlink with file name\n                     'displayed.  If earlier, add hyperlink with full path displayed\n                    If Val(Application.Version) &gt; 8 Then 'Using XL2000+\n                        .Hyperlinks.Add _\n                        Anchor:=ActiveSheet.Range(\"A65536\").End(xlUp).Offset(1, 0), _\n                        Address:=File.Path, _\n                        TextToDisplay:=File.Name\n                    Else 'Using XL97\n                        .Hyperlinks.Add _\n                        Anchor:=ActiveSheet.Range(\"A65536\").End(xlUp).Offset(1, 0), _\n                        Address:=File.Path\n                    End If\n                    'Add date last modified, and size in KB\n                    With .Range(\"A65536\").End(xlUp)\n                        .Offset(0, 1) = File.datelastModified\n                        With .Offset(0, 2)\n                            .Value = WorksheetFunction.Round(File.Size / 1024, 1)\n                            .NumberFormat = \"#,##0.0\"\n                        End With\n                    End With\n                    'Add Total From this file to current workbook\n                    Set Wb = Workbooks.Open(File)\n                    Set Ws = Wb.Sheets(\"Summary\")\n                On Error Resume Next\n\n\n                    Wb.Close\n                    Set Wb = Nothing\n                    Set Ws = Nothing\n                End With\n            End If\n    Next File\n\n     'Turn back on screen updating\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "excel", "vba", "stored-procedures", "out-parameters"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515012472, "post_id": 48084213, "comment_id": 83144604, "body": "I fail to see how this MCVE could ever return <code>True</code> for <code>p1</code>, but it&#39;s an interesting question regardless."}, {"owner": {"reputation": 135520, "user_id": 1715579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/4B4y1.png?s=128&g=1", "display_name": "p.s.w.g", "link": "https://stackoverflow.com/users/1715579/p-s-w-g"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515012655, "post_id": 48084213, "comment_id": 83144687, "body": "@Mat&#39;sMug Agreed, that is odd. My working hypothesis on that is that somewhere along the line, it ends up trying to do a type conversion."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515012914, "post_id": 48084213, "comment_id": 83144822, "body": "I&#39;m not very familiar with MySQL, but I presume <code>Set isAvailable = false</code> is setting it to <code>0</code> (assuming <code>false</code> is defined as such somewhere). Does explicitly making it <code>0</code> change the outcome? Making the stored procedure return a constant / explicit <code>0</code> would rule out the possibility of the SQL being the problem (...although, assuming all users connect to the same server, that should already be ruled out)"}, {"owner": {"reputation": 14652, "user_id": 1316440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc933e1580f57849b74cbde6d5bfb94?s=128&d=identicon&r=PG&f=1", "display_name": "wchiquito", "link": "https://stackoverflow.com/users/1316440/wchiquito"}, "edited": false, "score": 2, "creation_date": 1515013523, "post_id": 48084213, "comment_id": 83145089, "body": "Check <a href=\"https://bugs.mysql.com/bug.php?id=83698\" rel=\"nofollow noreferrer\">Bug #83698</a>."}, {"owner": {"reputation": 135520, "user_id": 1715579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/4B4y1.png?s=128&g=1", "display_name": "p.s.w.g", "link": "https://stackoverflow.com/users/1715579/p-s-w-g"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515013926, "post_id": 48084213, "comment_id": 83145273, "body": "@Mat&#39;sMug That doesn&#39;t change the results. However, when I changed the parameter to an <code>INT</code>, I got much more interesting results. See my updated question. To my eye, it looks like it could be returning a <i>pointer</i> rather than the actual value."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515014039, "post_id": 48084213, "comment_id": 83145313, "body": "ok now <i>that</i> is even more interesting. and... I&#39;ve no clue lol"}, {"owner": {"reputation": 135520, "user_id": 1715579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/4B4y1.png?s=128&g=1", "display_name": "p.s.w.g", "link": "https://stackoverflow.com/users/1715579/p-s-w-g"}, "reply_to_user": {"reputation": 14652, "user_id": 1316440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc933e1580f57849b74cbde6d5bfb94?s=128&d=identicon&r=PG&f=1", "display_name": "wchiquito", "link": "https://stackoverflow.com/users/1316440/wchiquito"}, "edited": false, "score": 0, "creation_date": 1515014459, "post_id": 48084213, "comment_id": 83145459, "body": "@wchiquito We are using MySQL 5.7.17 so this could indeed be affecting us. The proof I guess would be downgrading the connector to 5.03.04 as  Remco Kuijer suggests, and see if that resolves it."}], "answers": [{"tags": [], "owner": {"reputation": 135520, "user_id": 1715579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/4B4y1.png?s=128&g=1", "display_name": "p.s.w.g", "link": "https://stackoverflow.com/users/1715579/p-s-w-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1516381299, "creation_date": 1516381299, "answer_id": 48346044, "question_id": 48084213, "link": "https://stackoverflow.com/questions/48084213/out-parameters-dont-work-for-some-users/48346044#48346044", "title": "OUT parameters don&#39;t work for some users", "body": "<p><a href=\"https://stackoverflow.com/questions/48084213/out-parameters-dont-work-for-some-users#comment83145089_48084213\"><em>@wchiquito</em></a> pointed out that this is likely related to MySQL <a href=\"https://bugs.mysql.com/bug.php?id=83698\" rel=\"nofollow noreferrer\">Bug #83698</a>, and even though I've been unable to replicate the precise behavior elsewhere (due to my company's peculiar network set up and security restrictions) I agree that this is most likely the culprit. </p>\n\n<p>Since asking this question, I've re-written the stored procedure and associated spreadsheet to return data <em>only</em> via a Recordset. It's not nearly as 'clean', IMO, but at least it works on all users' machines. Still, if anyone can find a way to get <code>OUT</code> params to work (or if MySQL ever decides to fix this bug) please let me know.</p>\n"}], "owner": {"reputation": 135520, "user_id": 1715579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/4B4y1.png?s=128&g=1", "display_name": "p.s.w.g", "link": "https://stackoverflow.com/users/1715579/p-s-w-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48346044, "answer_count": 1, "score": 2, "last_activity_date": 1516381299, "creation_date": 1515009089, "last_edit_date": 1515013825, "question_id": 48084213, "link": "https://stackoverflow.com/questions/48084213/out-parameters-dont-work-for-some-users", "title": "OUT parameters don&#39;t work for some users", "body": "<p>I have an Excel worksheet that needs to make a number of calls out to a MySQL server. Here's the VBA code, simplified to illustrate this issue:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function Connect() As ADODB.Connection\n    Dim cn As New ADODB.Connection\n    With cn\n        .ConnectionString = \"&lt;Server&gt;\"\n        .Properties(\"Initial Catalog\").Value = \"&lt;DB&gt;\"\n        .Properties(\"User ID\").Value = \"&lt;User&gt;\"\n        .Properties(\"Password\").Value = \"&lt;Password&gt;\"\n        .CommandTimeout = 1500\n    End With\n    Set Connect = cn\nEnd Function\n\nPublic Sub TestSProc()\n    Dim cxn As ADODB.Connection\n    Dim cmd As New ADODB.Command\n    Dim p1 As ADODB.Parameter\n    Dim p2 As ADODB.Parameter\n    Set cxn = Connect()\n    cxn.Open\n    Set cmd.ActiveConnection = cxn\n    cmd.CommandType = adCmdStoredProc\n    cmd.CommandText = \"OutParamTest\"\n    Set p1 = cmd.CreateParameter(, adBoolean, adParamOutput)\n    Set p2 = cmd.CreateParameter(, adVarChar, adParamOutput, 255)\n    cmd.Parameters.Append p1\n    cmd.Parameters.Append p2\n    cmd.Execute\n    MsgBox \"Result: \" &amp; p1.Value &amp; \" / \" &amp; p2.Value\nEnd Sub\n</code></pre>\n\n<p>This executes the following stored procedure:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE PROCEDURE `OutParamTest`(\n    OUT `isAvailable` BIT,\n    OUT `remarks` VARCHAR(255)\n)\nLANGUAGE SQL\nDETERMINISTIC\nCONTAINS SQL\nSQL SECURITY DEFINER\nCOMMENT ''\nBEGIN\n  SET isAvailable = false;\n  SET remarks = 'The quick brown fox jumps over the lazy dog.';\nEND\n</code></pre>\n\n<p>On my machine, and for <em>almost all</em> users, this returns:</p>\n\n<blockquote>\n  <p>Result: False / The quick brown fox jumps over the lazy dog.</p>\n</blockquote>\n\n<p>But for <em>one</em> user, it returns:</p>\n\n<blockquote>\n  <p>Result: True /</p>\n</blockquote>\n\n<p>The only difference I can find between my machine, and the user's is the MySQL ODBC 5.3 ANSI and Unicode Driver versions. I have version <strong>5.03.02.00</strong>, and originally this user had an older version. I asked him to upgrade, and he now has version <strong>5.03.09.00</strong> (newer than mine), but the problem still exists.</p>\n\n<p>Is there something I'm missing? Is there some kind of machine-level configuration variable that could cause <code>OUT</code> parameters to stop working? Or do <code>OUT</code> parameters only work in some select driver versions?</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong> I modified the SP as follows:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE PROCEDURE `OutParamTest`(\n    OUT `num` INT,\n    OUT `remarks` VARCHAR(255)\n)\nBEGIN\n  SET num = 12345;\n  SET remarks = 'The quick brown fox jumps over the lazy dog.';\nEND\n</code></pre>\n\n<p>And made the corresponding changes in VBA. Now on my machine it returns:</p>\n\n<blockquote>\n  <p>Result: 12345 / The quick brown fox jumps over the lazy dog.</p>\n</blockquote>\n\n<p>And on this user's machine it returns:</p>\n\n<blockquote>\n  <p>Result: 232718680 /</p>\n</blockquote>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1515027201, "post_id": 48084187, "comment_id": 83149392, "body": "It would help to show more of your code.  It&#39;s difficult to make suggestions without any access to (or screenshot of) the relevant HTML source."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515076016, "post_id": 48084187, "comment_id": 83169607, "body": "Hi @TimWilliams, I added the complete program, the real action happens within my &quot;for counter = 0...&quot; loop. Thanks again"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1515081052, "post_id": 48084187, "comment_id": 83172628, "body": "If any action causes a navigation then you need to reset your <code>doc</code> reference, otherwise it still points to a previous document, not to the currently-loaded one."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515082166, "post_id": 48084187, "comment_id": 83173320, "body": "@TimWilliams Thank you for the insight"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 0, "creation_date": 1517751264, "post_id": 48084187, "comment_id": 84213538, "body": "Are trying to read ClearQuest data? If yes, then you can chose a better approach, like programmatically downloading the data as XML and importing the XML file in Excel."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1517752526, "post_id": 48084187, "comment_id": 84213947, "body": "@M.R. That sounds really interesting! Could you expand on that idea or provide an example?"}], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515076109, "creation_date": 1515008949, "last_edit_date": 1515076109, "question_id": 48084187, "link": "https://stackoverflow.com/questions/48084187/vba-not-seeing-html-element", "title": "VBA Not Seeing HTML Element", "body": "<p>Currently, I have a successful excel-based web-scraper program that goes through my company's project tracking system and grabs information I need (Project Manager, Release Date, etc.) My problem is that I am trying to add a new functionality that checks a secondary tab on each open ticket panel which results in the program not seeing the href/button (only after first ticket) and crashing.</p>\n\n<p>Also:</p>\n\n<ul>\n<li>For the first ticket, the program runs smoothly and clicks on the tab, it messes up when on the second tab</li>\n<li>The id is correct as I checked after the crash, and I even added a 5 second application.wait but still no luck.</li>\n<li>After the crash, when I hover over my object that was intended to be the \"button\", it says impactObj = Nothing</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/CniGE.png\" rel=\"nofollow noreferrer\">The secondary tab I am accessing on each ticket: \"Impact Analysis\"</a></p>\n\n<p>Clicking Impact Analysis Tab (counter is my iterator since Ids change between tickets):</p>\n\n<pre><code>    identification3 = \"dijit_layout_TabContainer_1_tablist_dijit_layout_ContentPane_\" &amp; CStr(5 + (counter * 18))\n    Set impactObj = doc.getElementById(identification3)\n    impactObj.Click\n</code></pre>\n\n<p>Error appears on this line:</p>\n\n<blockquote>\n  <p>impactObj.Click</p>\n</blockquote>\n\n<p>Note: Website is internal intranet only</p>\n\n<p>Thanks</p>\n\n<p>EDIT: Are there any common problems or errors that occur when switching between pages that could be responsible for this?</p>\n\n<p>EDIT: Adding code:</p>\n\n<pre><code>Sub CQscrub()\n\nDim i As Long\nDim objElement As Object\nDim objCollection As Object\nDim objCollection2 As Object\nDim ie As InternetExplorer\nDim numbers() As String\nDim size As Integer\nDim row As Integer\nDim objLead As Object\nDim lead As String\nDim state As String\nDim releasedate As String\nDim inv As String\nDim counter As Integer\nDim identification As String\nDim identification2 As String\nDim identification3 As String\nDim identification4 As String\nDim closeObj As Object\nDim existingTab As Boolean\nDim searchStringObj As Object\n\n' Creating dynamic array\nsize = WorksheetFunction.CountA(Worksheets(1).Columns(1)) - 4\nReDim numbers(size)\nFor row = 0 To size\n    numbers(row) = Cells(row + 10, 1).Value\nNext row ' Check : Cells(row, 2) = numbers(row - 10)\n\n' Creating IE instance\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Height = 1000\nie.Width = 1000\nie.Visible = True\nie.navigate \"http://clearquest/cqweb/\"\nApplication.StatusBar = \"Loading http://clearquest/cqweb\"\nDo While ie.Busy Or Not ie.readyState = READYSTATE_COMPLETE\n    DoEvents\nLoop\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\nApplication.StatusBar = \"Please wait...\"\n\n' Second declaration zone\nDim doc As HTMLDocument, yourObj As Object, stateObj As Object, dateObj As Object, invObj As Object, impactObj As Object, tabObj As Object\nSet doc = ie.document\n' First searching for \"search\" bar and inputting WR\nSet objCollection = ie.document.getElementsByTagName(\"input\")\ni = 0\nWhile i &lt; objCollection.Length\n    If objCollection(i).Name = \"cqFindRecordString\" Then\n        Set searchStringObj = objCollection(i)\n        'objCollection(i).Value = numbers(counter)\n    End If\n    i = i + 1\nWend\nSet objElement = ie.document.getElementById(\"cqFindRecordButton\")\n\n' Starting main loop\nFor counter = 0 To size - 1\n    ' Clicking search button\n    searchStringObj.Value = numbers(counter)\n    objElement.Click\n    Do While ie.Busy Or Not ie.readyState = READYSTATE_COMPLETE\n        DoEvents\n    Loop\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    ' Section scraping the webpage\n    ' Finding the IT Lead\n    identification = \"cq_widget_CqFilteringSelect_\" &amp; CStr(9 + (counter * 46))\n    Range(\"D\" &amp; (10 + counter)).Value = identification ' Test prompt\n    Set yourObj = doc.getElementById(identification)\n    lead = yourObj.Value\n    Range(\"B\" &amp; (10 + counter)).Value = lead\n    ' Finding WR State\n    identification2 = \"cq_widget_CqTextBox_\" &amp; CStr(2 + (counter * 3))\n    Range(\"E\" &amp; (10 + counter)).Value = identification2 ' Test prompt\n    Set stateObj = doc.getElementById(identification2)\n    state = stateObj.Value\n    Range(\"C\" &amp; (10 + counter)).Value = state\n    ' Clicking Impact Analysis Tab\n    ' Application.Wait (Now + TimeValue(\"0:00:05\"))\n    '''''''''''''''''''''''''' Problem Area '''''''''''''''''''''''''''''''''''''''''''\n    identification3 = \"dijit_layout_TabContainer_1_tablist_dijit_layout_ContentPane_\" &amp; CStr(5 + (counter * 18))\n     Range(\"F\" &amp; (10 + counter)).Value = identification3 ' Test prompt\n     Set impactObj = doc.getElementById(identification3)\n     impactObj.Click\n     Do While ie.Busy Or Not ie.readyState = READYSTATE_COMPLETE\n         DoEvents\n     Loop\n     Application.Wait (Now + TimeValue(\"0:00:01\"))\n     ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' Finding UAT Involvement\n    ' Set yourObj = doc.getElementsByClassName(\"dijitReset dijitInputField dijitInputContainer\")(0).getElementsByTagName(\"input\")(1)\n    ' cqTable dojoDndContainer\n    'identification = \"cq_widget_CqTable_\" &amp; CStr(7 + (counter * 9))\n    'Set invObj = doc.getElementsByClassName(\"cqListBox cqReadonlyControl cqListControl cqListBoxReadOnly dijitReadOnly\")(7)\n    'inv = invObj.innerText\n    'Range(\"E\" &amp; (10 + counter)).Value = inv\n    ' Closing tab\n    Set closeObj = doc.getElementsByClassName(\"dijitInline dijitTabCloseButton dijitTabCloseIcon\")(0)\n    closeObj.Click\n    Do While ie.Busy Or Not ie.readyState = READYSTATE_COMPLETE\n        DoEvents\n    Loop\nNext counter\n' Closing final open tab\nDo While ie.Busy Or Not ie.readyState = READYSTATE_COMPLETE\n    DoEvents\nLoop\nSet closeObj = doc.getElementsByClassName(\"dijitInline dijitTabCloseButton dijitTabCloseIcon\")(0)\ncloseObj.Click\nDo While ie.Busy Or Not ie.readyState = READYSTATE_COMPLETE\n    DoEvents\nLoop\n' Click logout, enter password in login, click login?\n' Closing down program\nSet objElement = Nothing\nSet objCollection = Nothing\nApplication.StatusBar = \"\"\nMsgBox \"Done!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 2, "creation_date": 1515009018, "post_id": 48084157, "comment_id": 83143132, "body": "Array is type of Variant. Please, check <a href=\"https://msdn.microsoft.com/en-us/library/aa262675(v=vs.60).aspx\" rel=\"nofollow noreferrer\">MSDN documentation</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515009530, "post_id": 48084157, "comment_id": 83143400, "body": "A <code>Variant</code> can very well hold a pointer to an array. That makes <code>Variant()</code> pretty much redundant."}], "answers": [{"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1515009245, "post_id": 48084215, "comment_id": 83143245, "body": "Your update answered my question with the note. Thank you!"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1515009328, "post_id": 48084215, "comment_id": 83143300, "body": "You&#39;re very welcome. If it fixes your issue, please, accept my answer as a solution."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1515009370, "post_id": 48084215, "comment_id": 83143316, "body": "I certainly will, but it said I had to wait 7 minutes. :) +1 for now."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1515009481, "post_id": 48084215, "comment_id": 83143373, "body": "OK. I&#39;m not in rush ;)"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 1, "last_activity_date": 1515009266, "last_edit_date": 1515009266, "creation_date": 1515009095, "answer_id": 48084215, "question_id": 48084157, "link": "https://stackoverflow.com/questions/48084157/excel-vba-array-function/48084215#48084215", "title": "Excel VBA Array Function", "body": "<p>Well, <code>Array</code> function returns Variant data type containing an array. Check <a href=\"https://msdn.microsoft.com/en-us/library/aa262675(v=vs.60).aspx\" rel=\"nofollow noreferrer\">MSDN documentation</a>.</p>\n\n<blockquote>\n  <p><strong>Note</strong>   A <code>Variant</code> that is not declared as an array can still contain an\n  array. A Variant variable can contain an array of any type, except\n  fixed-length strings and user-defined types. Although a Variant\n  containing an array is conceptually different from an array whose\n  elements are of type Variant, the array elements are accessed in the\n  same way.</p>\n</blockquote>\n"}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 48084215, "answer_count": 1, "score": 0, "last_activity_date": 1515009266, "creation_date": 1515008818, "question_id": 48084157, "link": "https://stackoverflow.com/questions/48084157/excel-vba-array-function", "title": "Excel VBA Array Function", "body": "<p>I'm trying to understand arrays more thoroughly. Can someone please explain to me why this does not compile:</p>\n\n<pre><code>Public Sub Test()\n    Dim Names As String\n    Names = Array(\"Brian\", \"Steve\", \"Andrea\")\n    Debug.Print Names(2) 'Compile error: Expected array\nEnd Sub\n</code></pre>\n\n<p>and why this compiles but does not run:</p>\n\n<pre><code>Public Sub Test()\n    Dim Names() As String\n    Names = Array(\"Brian\", \"Steve\", \"Andrea\") 'Run-time error '13': Type mismatch\n    Debug.Print Names(2)\nEnd Sub\n</code></pre>\n\n<p>but this works, even though I didn't add <code>()</code> (unless declaring it as type <code>Variant</code> makes it an array?):</p>\n\n<pre><code>Public Sub Test()\n    Dim Names As Variant\n    Names = Array(\"Brian\", \"Steve\", \"Andrea\")\n    Debug.Print Names(2)\nEnd Sub\n</code></pre>\n\n<p>and so does this, as expected:</p>\n\n<pre><code>Public Sub Test()\n    Dim Names() As Variant\n    Names = Array(\"Brian\", \"Steve\", \"Andrea\")\n    Debug.Print Names(2)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515007982, "post_id": 48083853, "comment_id": 83142637, "body": "FWIW - if <code>myString</code> was <code>&quot;some random string&quot;</code> and <code>somePosition</code> was <code>2</code> then you are modifying <code>myString</code> to be <code>&quot;song&quot;</code>, i.e. taking the left 2 positions and right 2 positions - is that really what you intended?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515009766, "post_id": 48084106, "comment_id": 83143494, "body": "I bet <a href=\"https://codereview.stackexchange.com/q/67596/23788\">this StringBuilder class</a> performs much better than that SO link, and quite possibly better than the .net one, given it eliminates the need for .NET/COM interop overhead."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515010271, "post_id": 48084106, "comment_id": 83143697, "body": "That might certainly be true, it looks like really good code :)"}, {"owner": {"reputation": 29, "user_id": 3187193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/p3h52.jpg?s=128&g=1", "display_name": "UbuntuDude", "link": "https://stackoverflow.com/users/3187193/ubuntudude"}, "edited": false, "score": 0, "creation_date": 1515090264, "post_id": 48084106, "comment_id": 83177863, "body": "I tried the stringbuilder but now the code, although working as it should, is even slower. Probably I did not use the stringbuilder well. By the way the function I am building is supposed to take a csv file previously converted into a string and remove columns not required. See above in the original question the full code with the string builder."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1515008923, "last_edit_date": 1515008923, "creation_date": 1515008597, "answer_id": 48084106, "question_id": 48083853, "link": "https://stackoverflow.com/questions/48083853/ms-access-vba-string-manipulation/48084106#48084106", "title": "MS Access - VBA - String manipulation", "body": "<p>You can use <code>CreateObject</code> to create the .Net stringbuilder class. Note that you will have to have the relevant .Net library installed, and VBA does not support overloading, so it will handle a little differently than in VB.Net.</p>\n\n<p>Sample code:</p>\n\n<pre><code>Public Sub TestSB()\n    Dim sb As Object\n    Set sb = CreateObject(\"System.Text.StringBuilder\")\n    sb.Append_3 \"Hello\"\n    sb.Append_3 \" \"\n    sb.Append_3 \"World\"\n    sb.Append_3 \"!\"\n    Debug.Print sb.ToString\nEnd Sub\n</code></pre>\n\n<p>Alternatively, you can build your own stringbuilder. <a href=\"https://stackoverflow.com/a/1338833/7296893\">This answer</a> provides a stringbuilder class, and <a href=\"https://stackoverflow.com/q/31787570/7296893\">this question</a> also shows some sample code.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1515058770, "creation_date": 1515058770, "answer_id": 48092436, "question_id": 48083853, "link": "https://stackoverflow.com/questions/48083853/ms-access-vba-string-manipulation/48092436#48092436", "title": "MS Access - VBA - String manipulation", "body": "<p>You can - for an extremely simple implementation - use <strong>Mid</strong>.</p>\n\n<p>For example, this code runs in about 0.1 ms for the quite large strings entered:</p>\n\n<pre><code>Public Function ChopString() As String\n\n    Dim Source      As String\n    Dim LeftPart    As Long\n    Dim RightPart   As Long\n    Dim Result      As String\n\n    Source = String(100000, \"x\")\n    LeftPart = 30000\n    RightPart = 40000\n\n    Result = Space(LeftPart + RightPart)\n    Mid(Result, 1) = Left(Source, LeftPart)\n    Mid(Result, 1 + LeftPart) = Right(Source, RightPart)\n\n    ChopString = Result\n\nEnd Function\n</code></pre>\n\n<p>For smaller strings of a few K, it runs way faster.</p>\n"}], "owner": {"reputation": 29, "user_id": 3187193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/p3h52.jpg?s=128&g=1", "display_name": "UbuntuDude", "link": "https://stackoverflow.com/users/3187193/ubuntudude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594650844, "creation_date": 1515007364, "last_edit_date": 1594650844, "question_id": 48083853, "link": "https://stackoverflow.com/questions/48083853/ms-access-vba-string-manipulation", "title": "MS Access - VBA - String manipulation", "body": "<p>I developed some code for an Access Database that manipulates a string with a statement like:</p>\n\n<pre><code>myString = Left(myString, somePosition) &amp; Right(myString, someOtherPosition)\n</code></pre>\n\n<p>the above is part of a loop that has thousands of iterations and the variable myString is thousand of characters long.</p>\n\n<p>I know the above code is bad practice in Java and a StringBuffer should be used instead of a string.</p>\n\n<p>My code is taking a lot of time to run (about 7 minutes) and I suspect the problem might be related to the heavy string manipulation that is going on. Can you please confirm if there is anything similar to StringBuffer in VBA that could improve the efficiency of my code?</p>\n\n<p>Update: full code with StringBuilder</p>\n\n<pre><code>Function SelectColumns2(str As String, columns As String, separator As String) As String\n\n'column_number is the number of the column we are reading when we loop through a line\n'z is the counter of the field (a portion of str between two separators)\n'i is the counter of the str (the position of the modified string)\nDim column_number As Integer, i As Double, z As Integer, leftPosition As Double\n'stringbuilder that stores the string that will represent the final file\nDim sb As StringBuilder, leftStr As StringBuilder, rightStr As StringBuilder\n\nSet sb = New StringBuilder\nSet leftStr = New StringBuilder\nSet rightStr = New StringBuilder\nsb.Append str\ncolumn_number = 1\ni = 1 ' full str\nz = 0 ' full field\n\nWhile sb.Length &gt;= i\n        z = z + 1\n        If Mid(sb.Text, i, 1) = separator Then\n            If InStr(1, columns, \"/\" &amp; column_number &amp; \"/\") = 0 Then\n                leftStr.Append left(sb.Text, i - z)\n                rightStr.Append right(sb.Text, sb.Length - i)\n                sb.Clear\n                sb.Append leftStr.Text\n                sb.Append rightStr.Text\n                leftStr.Clear\n                rightStr.Clear\n                i = i - z\n            End If\n            column_number = column_number + 1\n            z = 0\n        ElseIf Mid(sb.Text, i, 1) = Chr(10) Then\n            If InStr(1, columns, \"/\" &amp; column_number &amp; \"/\") = 0 Then\n                leftPosition = max((i - z - 1), 0)\n                If leftPosition = 0 Then\n                    leftStr.Append left(sb.Text, leftPosition)\n                    rightStr.Append right(sb.Text, sb.Length - i)\n                    sb.Clear\n                    sb.Append leftStr.Text\n                    sb.Append rightStr.Text\n                Else\n                    leftStr.Append left(sb.Text, leftPosition)\n                    rightStr.Append right(sb.Text, sb.Length - i + 1)\n                    sb.Clear\n                    sb.Append leftStr.Text\n                    sb.Append rightStr.Text\n                End If\n                leftStr.Clear\n                rightStr.Clear\n                i = i - z\n            End If\n            column_number = 1\n            z = 0\n        End If\n        i = i + 1\nWend\n\nSelectColumns2 = left(sb.Text, sb.Length - 1)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "arraylist"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1515006927, "post_id": 48083719, "comment_id": 83142165, "body": "Please provide the error."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515008713, "post_id": 48083719, "comment_id": 83142972, "body": "You may need to install the DLLs for that object again."}, {"owner": {"reputation": 1, "user_id": 6472162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74d3c0e28578b0e67065577ac41856b?s=128&d=identicon&r=PG&f=1", "display_name": "luddite20", "link": "https://stackoverflow.com/users/6472162/luddite20"}, "edited": false, "score": 0, "creation_date": 1515013732, "post_id": 48083719, "comment_id": 83145188, "body": "ERik, it is a Runt-time error &#39;-214623576 (80131700)&#39;:  Automation Error."}, {"owner": {"reputation": 1, "user_id": 6472162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74d3c0e28578b0e67065577ac41856b?s=128&d=identicon&r=PG&f=1", "display_name": "luddite20", "link": "https://stackoverflow.com/users/6472162/luddite20"}, "edited": false, "score": 0, "creation_date": 1515013775, "post_id": 48083719, "comment_id": 83145213, "body": "Scott, what should I search for online in order to do that?  I am unfamiliar with the process."}, {"owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "edited": false, "score": 0, "creation_date": 1520014626, "post_id": 48083719, "comment_id": 85156016, "body": "That line of code produces no errors on my Office 2016 implementation. We won&#39;t be able to help you without more information -- it isn&#39;t an error with the statement."}], "answers": [{"tags": [], "owner": {"reputation": 988, "user_id": 9601310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/816a9f66af24735cab02c6d8ef2310d7?s=128&d=identicon&r=PG&f=1", "display_name": "user9601310", "link": "https://stackoverflow.com/users/9601310/user9601310"}, "is_accepted": false, "score": 0, "last_activity_date": 1600340353, "creation_date": 1600340353, "answer_id": 63936594, "question_id": 48083719, "link": "https://stackoverflow.com/questions/48083719/vba-script-error-after-updating-to-office-2016-createobjectsystem-collections/63936594#63936594", "title": "VBA Script Error After Updating to Office 2016 (CreateObject(&quot;System.Collections.ArrayList&quot;))", "body": "<p>On the assumption of &quot;better late than never&quot; for an answer, it appears System.Collections support is not available in .NET versions after 3.5.  You specifically need the .NET 3.5 version installed to use System.Collections.ArrayList.</p>\n"}], "owner": {"reputation": 1, "user_id": 6472162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74d3c0e28578b0e67065577ac41856b?s=128&d=identicon&r=PG&f=1", "display_name": "luddite20", "link": "https://stackoverflow.com/users/6472162/luddite20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 970, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1600340353, "creation_date": 1515006771, "last_edit_date": 1593955974, "question_id": 48083719, "link": "https://stackoverflow.com/questions/48083719/vba-script-error-after-updating-to-office-2016-createobjectsystem-collections", "title": "VBA Script Error After Updating to Office 2016 (CreateObject(&quot;System.Collections.ArrayList&quot;))", "body": "<p>I wrote a script that was working fine when using an older version of Office, but since I upgraded to 2016, I get a runtime error.  The debugging leads me to the line:</p>\n\n<pre><code>Set chemicals = CreateObject(\"System.Collections.ArrayList\")\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1515007130, "post_id": 48083704, "comment_id": 83142254, "body": "In the function <code>createarray1()</code> you&#39;re missing a variable after <code>Next</code> for both <code>i</code> and <code>j</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1515007368, "post_id": 48083704, "comment_id": 83142375, "body": "Why not just use an INDEX/MATCH formula?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1515008806, "last_edit_date": 1515008806, "creation_date": 1515007978, "answer_id": 48083990, "question_id": 48083704, "link": "https://stackoverflow.com/questions/48083704/vba-excel-compare-columns-and-bring-over-the-value/48083990#48083990", "title": "VBA EXCEL Compare Columns and bring over the value", "body": "<p>Use variant arrays, that way you limit the number of calls to the sheet to only 3.</p>\n\n<p>When your positive is found you need to exit the inner loop.</p>\n\n<pre><code>Sub createarray1()\n\n    Dim i As Long\n    Dim j As Long\n    Dim masterarray As Variant\n    Dim sourcearray As Variant\n    With ThisWorkbook.Worksheets(\"Sheet1\") ' change to your sheet\n        masterarray = .Range(\"D3:G12\")\n        sourcearray = .Range(\"H3:K26\")\n\n        For i = LBound(masterarray, 1) To UBound(masterarray, 1)\n            masterarray(i, 3) = \"\"\n            For j = LBound(sourcearray, 1) To UBound(sourcearray, 1)\n                If masterarray(i, 4) = sourcearray(j, 4) Then\n                    masterarray(i, 3) = sourcearray(j, 3)\n                    Exit For\n                End If\n            Next j\n        Next i\n        .Range(\"D3:G12\") = masterarray\n    End With\nEnd Sub\n</code></pre>\n\n<p>But this can all be done with the following formula:</p>\n\n<pre><code>=INDEX(J:J,MATCH(G3,K:K,0))\n</code></pre>\n\n<p>Put it in F3 and copy/drag down.</p>\n"}], "owner": {"reputation": 11, "user_id": 9164948, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a2fe8cfd0b94b8818ef2ec6b22670c89?s=128&d=identicon&r=PG&f=1", "display_name": "dannylee", "link": "https://stackoverflow.com/users/9164948/dannylee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515008806, "creation_date": 1515006721, "last_edit_date": 1515008210, "question_id": 48083704, "link": "https://stackoverflow.com/questions/48083704/vba-excel-compare-columns-and-bring-over-the-value", "title": "VBA EXCEL Compare Columns and bring over the value", "body": "<p><a href=\"https://i.stack.imgur.com/xuUn4.png\" rel=\"nofollow noreferrer\">Image1</a></p>\n\n<p>Hi, Referring to the image, I am trying to compare column G and Column K, if the value is the same then copy the value in column J to column F. However, my code doesn't copy the value from Column J to F.</p>\n\n<pre><code>Sub createarray1()\n\n    Dim i As Integer\n    Dim j As Integer\n    Dim masterarray As Range\n    Set masterarray = Range(\"D3:G12\")\n    Dim sourcearray As Range\n\n    Set sourcearray = Range(\"H3:K26\")\n\n    For i = 1 To 10\n        For j = 1 To 25\n            If masterarray(i, 4).Value = sourcearray(j, 4).Value Then\n                masterarray(i, 3) = sourcearray(j, 3).Value\n            Else\n                masterarray(i, 3).Value = \"\"\n            End If\n        Next\n    Next\n\nEnd Sub\n\nFunction concatenate()\n\n    Dim nlastrow As Long\n\n    For i = 2 To Cells(Rows.Count, \"D\").End(xlUp).Row\n        Cells(i, \"G\").Value = Cells(i, \"D\").Value &amp; \"_\" &amp; Cells(i, \"E\").Value\n    Next i\n\n    Dim nnlastrow As Long\n\n    For i = 2 To Cells(Rows.Count, \"H\").End(xlUp).Row\n        Cells(i, \"K\").Value = Cells(i, \"H\").Value &amp; \"_\" &amp; Cells(i, \"I\").Value\n    Next i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515008145, "post_id": 48083645, "comment_id": 83142719, "body": "Try commenting out all those lines, then uncomment one at a time.  Do the images always get that &quot;error&quot; on loading, or is it perhaps one line in particular that triggers it? Are there any other macros at all in the workbook?"}, {"owner": {"reputation": 38, "user_id": 9169471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cecb8dda71233746d0f64bdcd55f9779?s=128&d=identicon&r=PG&f=1", "display_name": "mcflame", "link": "https://stackoverflow.com/users/9169471/mcflame"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515008959, "post_id": 48083645, "comment_id": 83143099, "body": "There are other macros in the workbook, but this problem did not begin until I added the Private Sub. The problem occurs even if all of the lines are commented out. The problem is also triggered if I add ANY private sub code. I have tried to add BeforeClose and BeforeOpen events. Even adding shortcut keys as Workbook Events for the other macros will trigger the problem. I have also tried them as Public events."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515010585, "post_id": 48083645, "comment_id": 83143826, "body": "To really test it, when you say &quot;...if I add ANY private sub code&quot;, even if you <i>only</i> have a single private sub of this: <code>Private Sub testing() &#47;&#47; debug.print &quot;hi&quot; &#47;&#47; End Sub</code> the error still occurs?"}, {"owner": {"reputation": 38, "user_id": 9169471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cecb8dda71233746d0f64bdcd55f9779?s=128&d=identicon&r=PG&f=1", "display_name": "mcflame", "link": "https://stackoverflow.com/users/9169471/mcflame"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515011179, "post_id": 48083645, "comment_id": 83144043, "body": "I deleted my old Private Sub macro and added in the one you provided. The error did still occur."}], "owner": {"reputation": 38, "user_id": 9169471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cecb8dda71233746d0f64bdcd55f9779?s=128&d=identicon&r=PG&f=1", "display_name": "mcflame", "link": "https://stackoverflow.com/users/9169471/mcflame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593675530, "creation_date": 1515006406, "last_edit_date": 1593675530, "question_id": 48083645, "link": "https://stackoverflow.com/questions/48083645/excel-vba-pictures-do-not-display-when-i-add-private-sub-macro", "title": "Excel VBA - Pictures do not display when I add Private Sub macro", "body": "<p>I have images pasted (not linked) into my excel workbook. When I try to add any Private Sub macro code, the next time I open my workbook, the images come up with the message \"This image can not be displayed\". However, images on other sheets display correctly, and if I save the workbook on a different sheet, when it re-opens to the different sheet, only images on that sheet will not display, and images on the other sheet now display correctly. I am running Excel 2016 for Mac.</p>\n\n<p>To be clear, I am not using the macros to display the images. The images have already been added into the document and are meant to always be displayed. I am simply trying to add a few lines of Private Sub code, so that my end user doesn't have to worry about a few settings before closing the workbook. This is a large workbook (which might be adding to the issues) and I want the workbook to always save in \"manual\" calculation mode, with calculate before save turned off.</p>\n\n<p>I have tried adding \"Application.ScreenUpdating = False\" terms to the Private Sub, and I have tried re-inserting the pictures, as answers to other questions have suggested, but it will not fix the problem. Here is my code currently.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As  \nBoolean)\nApplication.ScreenUpdating = False\nApplication.Calculation = xlManual\nApplication.CalculateBeforeSave = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I understand that I could force the workbook to save and therefore open to a sheet with no pictures to start. However I am sending this to an end user and would prefer that it look more clean than that. And mostly I am just endlessly perplexed by this issue and would love to find a more direct solution!</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1515006015, "post_id": 48083483, "comment_id": 83141747, "body": "Is there any reason you&#39;re doing this via VBA instead of using Conditional Formatting?"}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1515006444, "post_id": 48083483, "comment_id": 83141935, "body": "I didn&#39;t use conditional formatting because i didn&#39;t know how to make the cell i.e. O2 white when a value was inserted into it."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1515006635, "post_id": 48083483, "comment_id": 83142031, "body": "Conditional format formula, apply to desired range (in this case O2:O10): <code>=AND($A2=&quot;Spain&quot;,$O2=&quot;&quot;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1515006652, "post_id": 48083483, "comment_id": 83142033, "body": "@tigeravatar that would make a voteworthy answer :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515006701, "post_id": 48083483, "comment_id": 83142057, "body": "^^ better than my one!"}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1515006950, "post_id": 48083483, "comment_id": 83142173, "body": "Must appreciated, tigeravatar. I will use this one. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1515006008, "creation_date": 1515006008, "answer_id": 48083548, "question_id": 48083483, "link": "https://stackoverflow.com/questions/48083483/color-doesnt-show-when-pasting-multiple-times/48083548#48083548", "title": "Color doesn&#39;t show when pasting multiple times", "body": "<p>Change your <code>Change</code> event to loop through all rows in <code>Target</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim r As Range\n    If Not Application.Intersect(Range(\"A5:O10\"), Target) Is Nothing Then\n        For Each r In Application.Intersect(Range(\"A5:O10\"), Target).Rows\n           columnO r.Row\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1515008978, "post_id": 48083720, "comment_id": 83143108, "body": "I just checked something now. Why cell O2 doesn&#39;t change from red to white when a value is inserted in it? @tigeravatar  Thanks"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 1, "creation_date": 1515009247, "post_id": 48083720, "comment_id": 83143246, "body": "@alex2002 You probably have hard-coded some of the colours already to be red.  Just change the entire column back to not have any colouring, and it should be fine.  (The conditional formatting will still be applied to make them red, even though you have cleared the manual formatting.)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1515009248, "post_id": 48083720, "comment_id": 83143248, "body": "@alex2002 It does change for me.  You&#39;ll want to make sure the conditional format rule is applied properly.  Here is a <a href=\"https://exceljet.net/lessons/how-to-use-a-formula-with-conditional-formatting\" rel=\"nofollow noreferrer\">link</a> with a quick tutorial on how to use formulas with conditional formatting."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515009301, "post_id": 48083720, "comment_id": 83143287, "body": "@tigeravatar The bad ones will be the ones that had the red colouring applied using the existing macro."}, {"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1515009739, "post_id": 48083720, "comment_id": 83143481, "body": "yes, fix that. Thanks again for all your help! @tigeravatar"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 4, "last_activity_date": 1515006771, "creation_date": 1515006771, "answer_id": 48083720, "question_id": 48083483, "link": "https://stackoverflow.com/questions/48083483/color-doesnt-show-when-pasting-multiple-times/48083720#48083720", "title": "Color doesn&#39;t show when pasting multiple times", "body": "<p>As an alternative, this can be done without any VBA by utilizing Conditional Formatting.  Create a new conditional format rule using a formula and apply to the desired range (in this case $O$2:$O$10): </p>\n\n<pre><code>=AND($A2=\"Spain\",$O2=\"\")\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 48083720, "answer_count": 2, "score": 1, "last_activity_date": 1515006771, "creation_date": 1515005700, "question_id": 48083483, "link": "https://stackoverflow.com/questions/48083483/color-doesnt-show-when-pasting-multiple-times", "title": "Color doesn&#39;t show when pasting multiple times", "body": "<p>I would really appreciate if someone can help me to identify the problem with this code. The code is suppose to turn column O into red every time when \"Spain\" is inserted in column A. I.e. if A2 is \"Spain\" then O2 turns red. The code below does this job when I am writing \"Spain\" in A2. However, if I copy-paste \"Spain\" from A2 to A10, then only cell that will turn red in column O will be cell O2.</p>\n\n<p>Why cells O3 to O10 don't turn red as well? How can I do that?  Must appreciated. </p>\n\n<pre><code>Sub columnO(d As Long)\n\n    If Cells(d, \"A\") = \"Spain\" And Cells(d, \"O\") = \"\" Then\n    Cells(d, \"O\").Interior.Color = RGB(255, 0, 0)\n    Else\n    Cells(d, \"O\").Interior.Color = RGB(1000, 1000, 1000)\n    End If\n\n    End Sub\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Application.Intersect(Range(\"A5:O10\"), Target) Is Nothing Then\n       columnO Target.row\n    End If\n</code></pre>\n"}, {"tags": ["excel", "ie-automation", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1515005032, "post_id": 48083283, "comment_id": 83141207, "body": "If you&#39;re searching the href for a <i>specific</i> URL, why not just <code>IE.Navigate &quot;https:&#47;&#47;csp.stocko-contact.com&#47;portal&#47;authenticate.php&quot;</code>?"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1515005199, "post_id": 48083283, "comment_id": 83141284, "body": "Why not, instead of <code>l.Click</code>, put in <code>IE.navigate l.href</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515027446, "post_id": 48083283, "comment_id": 83149466, "body": "Your <code>Exit For</code> should be inside the <code>If</code> block after <code>l.Click</code>: as it stands your loop will always exit after the first link is checked."}, {"owner": {"reputation": 1, "user_id": 9161402, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779247745461035/picture?type=large", "display_name": "Ma\u0142gorzata Rewekant", "link": "https://stackoverflow.com/users/9161402/ma%c5%82gorzata-rewekant"}, "edited": false, "score": 0, "creation_date": 1515434400, "post_id": 48083283, "comment_id": 83290252, "body": "You were right, IE.Navigate was the simplest solution. Thank you for your comment."}], "owner": {"reputation": 1, "user_id": 9161402, "user_type": "registered", "profile_image": "https://graph.facebook.com/1779247745461035/picture?type=large", "display_name": "Ma\u0142gorzata Rewekant", "link": "https://stackoverflow.com/users/9161402/ma%c5%82gorzata-rewekant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 649, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515004738, "creation_date": 1515004738, "last_edit_date": 1531164843, "question_id": 48083283, "link": "https://stackoverflow.com/questions/48083283/vba-ie-click-on-html-element-with-only-a-href-attribute", "title": "VBA-IE: Click on HTML element with only a href attribute", "body": "<p>I need to go to the next page by clicking \"Anmelden\".\n<a href=\"https://i.stack.imgur.com/WknJy.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>This elements are described in html code as:</p>\n\n<pre><code>&lt;nav id=\"main-menu\" role=\"navigation\"&gt;\n\n          &lt;a href=\"https://csp.stocko-contact.com/portal/\"&gt;Startseite&lt;/a&gt;\n          &lt;a href=\"https://csp.stocko-contact.com/portal/authenticate.php\"&gt;Anmelden&lt;/a&gt;  &lt;/nav&gt;\n</code></pre>\n\n<p>In my VBA code I try to pick this links with code: </p>\n\n<pre><code>Option Explicit\nDim IE As InternetExplorer\nDim l As Object\nDim link As HTMLAnchorElement\n</code></pre>\n\n<p>(...)</p>\n\n<pre><code>For Each l In IE.Document.getElementsByTagName(\"a\")\n    If l.href = \"https://csp.stocko-contact.com/portal/authenticate.php\" Then\n    l.Click\n    End If\nExit For\nNext\n</code></pre>\n\n<p>I work with IE8. Any advice? \nThanks in advance.</p>\n"}, {"tags": ["vba", "excel", "email", "lotus-notes"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515004004, "post_id": 48083094, "comment_id": 83140675, "body": "do you have outlook installed at all?"}, {"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515006060, "post_id": 48083094, "comment_id": 83141765, "body": "I do have Outlook installed but, since I have allot of archive past emails I would hate to change email client at this point.                                                           any thoughts?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515006467, "post_id": 48083094, "comment_id": 83141945, "body": "This is very simple with Outlook. If you can use outlook to only send this mails that would be a lot easier and there&#39;s loads of examples online how to do that."}, {"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515007547, "post_id": 48083094, "comment_id": 83142447, "body": "Agreed on the simplicity of using Outlook but, would there be a way under references in Excel a Object library option that could help use a default email client?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1515007970, "post_id": 48083094, "comment_id": 83142627, "body": "Use Word mail merge with the Excel data as the source. Merge to email. Done."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1515007979, "post_id": 48083094, "comment_id": 83142633, "body": "Does <a href=\"https://www.mrexcel.com/forum/excel-questions/73766-create-email-but-dont-send-lotus-notes.html\" rel=\"nofollow noreferrer\">this page</a> help? I use Lotus also and have a macro that takes Excel data and puts into an email, based off of that page."}, {"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1515010433, "post_id": 48083094, "comment_id": 83143762, "body": "@teylyn , I&#39;ve tried mail merge but, since I work off a excel workbook. It would be easy to just click a button for a macro since everything auto populating into would I would need to send out.In addition I don&#39;t believe mail merge could attache a pdf,excel or zip file to send with any email.     Thank you though."}, {"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515010515, "post_id": 48083094, "comment_id": 83143802, "body": "@BruceWayne , Thank you for that much appreciated but, it seems to be unique to a specific email address ,subject and specific directory path.  would it be easy to just change those fields?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515010644, "post_id": 48083094, "comment_id": 83143850, "body": "What do you mean it&#39;s unique to a specific email?  You can set up variables to store the data from your Excel sheet and go from there, no?"}, {"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "edited": false, "score": 0, "creation_date": 1515010739, "post_id": 48083094, "comment_id": 83143888, "body": "under MailDoc.SendTo = &quot;email@web.com&quot; and would it be possible to have call out a cell?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1515014443, "post_id": 48083094, "comment_id": 83145455, "body": "Word has it all built-in. If you want to re-invent the wheel, suit yourself."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1515020693, "post_id": 48083094, "comment_id": 83147795, "body": "@teylyn - Some of us are stuck in Lotus :(  I&#39;ve reinvented at least three wheels because of it.  Must say, it helps my VBA learning!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "edited": false, "score": 0, "creation_date": 1515013984, "post_id": 48084773, "comment_id": 83145296, "body": ".Great , I got it to work but, it clears my signature and the body formats is weird.?any thoughts?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "edited": false, "score": 0, "creation_date": 1515014490, "post_id": 48084773, "comment_id": 83145472, "body": "@Boomer - The body formatting will depend on how you set it up in that <code>For</code> loop.  Note you can add in some <code>vbCrLf</code> to get a line break, like <code>emailBody = &quot;Hello John,&quot; &amp; vbCrLf &amp; vbCrLf &amp; &quot;This is an email.&quot;</code>.  Give me a second and I&#39;ll edit the code so it keeps your signature."}, {"owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "edited": false, "score": 0, "creation_date": 1515019666, "post_id": 48084773, "comment_id": 83147476, "body": "I got it to work with attaching &quot;2&quot; attachments and without clearing out my signature. Thanks !"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1515014537, "last_edit_date": 1515014537, "creation_date": 1515011872, "answer_id": 48084773, "question_id": 48083094, "link": "https://stackoverflow.com/questions/48083094/generate-email-from-excel-data-with-lotus-notes-social-edition-home/48084773#48084773", "title": "Generate Email from Excel Data with Lotus Notes Social Edition Home", "body": "<p>This is a more bare-bones way to send an email. It works for me, I have Lotus Notes 9 so hopefully it also works for your version.</p>\n\n<pre><code>Sub Send_Email_via_Lotus()\n'Send an e-mail &amp; attachment using Lotus Not(s)\n'Original Code by Nate Oliver (NateO)\n'Declare Variables for file and macro setup\n'Dim AVal As Variant\nDim UserName As String, MailDbName As String, ccRecipient As String, Recipient As String\nDim Maildb As Object, MailDoc As Object, Session As Object\nDim email As String, bodyText As String, clientRef As String, bodyRng As Range, emailBody As String\nDim notesUIDoc As Object\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\n\n    ' Open and locate current LOTUS NOTES User\n    Set Session = CreateObject(\"Notes.NotesSession\")\n    UserName = Session.UserName\n    MailDbName = Left$(UserName, 1) &amp; Right$(UserName, (Len(UserName) - InStr(1, UserName, \" \"))) &amp; \".nsf\"\n    Set Maildb = Session.GETDATABASE(\"\", MailDbName)\n    If Maildb.IsOpen = True Then\n    Else\n        Call Maildb.OPENMAIL\n    End If\n\n    Recipient = Sheets(\"Sheet1\").Range(\"A1\").Value\n    ccRecipient = Sheets(\"Sheet1\").Range(\"A2\").Value\n    Set bodyRng = Sheets(\"Sheet2\").Range(\"A1:B24\")\n\n    Dim cel As Range\n    For Each cel In bodyRng\n        emailBody = emailBody &amp; \" \" &amp; cel.Value\n    Next cel\n\n    ' Create New Mail and Address Title Handlers\n    Set MailDoc = Maildb.CreateDocument\n    MailDoc.Form = \"Memo\"\n    MailDoc.sendTo = Recipient\n    MailDoc.CopyTo = ccRecipient\n    MailDoc.Subject = \"SUBJECT HERE\"\n\n    'Displays email message without sending; user needs to click Send\n    Set workspace = CreateObject(\"Notes.NotesUIWorkspace\")\n    Set notesUIDoc = workspace.EditDocument(True, MailDoc)\n    'Call notesUIDoc.FieldClear(\"Body\") '' This line will clear the ENTIRE body, including signature.\n    Call notesUIDoc.gotofield(\"Body\") 'This should just Go to the body, keeping your signature.\n    Call notesUIDoc.FieldAppendText(\"Body\", emailBody)\n\n    Set Maildb = Nothing\n    Set MailDoc = Nothing\n    Set AttachME = Nothing\n    Set Session = Nothing\n    Set EmbedObj1 = Nothing\n\n    .ScreenUpdating = True\n    .DisplayAlerts = True\n    .EnableEvents = True\nEnd With\n\n'End If\nExit Sub\n\nerrorhandler1:\nSet Maildb = Nothing\nSet MailDoc = Nothing\nSet AttachME = Nothing\nSet Session = Nothing\nSet EmbedObj1 = Nothing\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Note that the Attachment part is lacking, I'll keep searching for that but this should get you started, and see how you can use the variables to set the body, recipients, etc.  (There may be unnecessary variables too, I didn't quite check those).</p>\n\n<p>NOTE: Please review the <code>For Each cel in bodyRng</code> loop, as I don't quite know how you want the body set up.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "is_accepted": false, "score": 1, "last_activity_date": 1515019508, "creation_date": 1515019508, "answer_id": 48086255, "question_id": 48083094, "link": "https://stackoverflow.com/questions/48083094/generate-email-from-excel-data-with-lotus-notes-social-edition-home/48086255#48086255", "title": "Generate Email from Excel Data with Lotus Notes Social Edition Home", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub NotesEmailrun()\r\n\r\nDim UserName As String, MailDbName As String, ccRecipient As String, attachment1 As String\r\nDim Maildb As Object, MailDoc As Object, AttachME As Object, Session As Object\r\nDim EmbedObj1 As Object\r\n\r\n\r\nWith Application\r\n.ScreenUpdating = False\r\n.DisplayAlerts = False\r\n\r\n\r\nSet Session = CreateObject(\"Notes.NotesSession\")\r\nUserName = Session.UserName\r\nMailDbName = _\r\nLeft$(UserName, 1) &amp; Right$(UserName, (Len(UserName) - InStr(1, UserName, \" \"))) &amp; \".nsf\"\r\nSet Maildb = Session.GETDATABASE(\"\", \"\")\r\nIf Maildb.IsOpen = True Then\r\nElse\r\nMaildb.OpenMail\r\nEnd If\r\n\r\n\r\nSet MailDoc = Maildb.CreateDocument\r\nMailDoc.Form = \"Memo\"\r\n\r\nMailDoc.Sendto = Sheets(\"Sheet1\").Range(\"A1\").Value\r\nMailDoc.CopyTo = Sheets(\"Sheet1\").Range(\"A2\").Value\r\n\r\nMailDoc.Subject = Sheets(\"Sheet1\").Range(\"A5\").Value\r\nMailDoc.body = Sheets(\"Sheet2\").Range(\"A1:H24\")\r\n\r\n\r\nMailDoc.SaveMessageOnSend = True\r\n\r\nattachment1 = \"C:\\Users\\Username\\Desktop\\folder1\\time.txt\"\r\nIf attachment1 &lt;&gt; \"\" Then\r\nOn Error Resume Next\r\nSet AttachME = MailDoc.CREATERICHTEXTITEM(\"attachment1\")\r\nSet EmbedObj1 = AttachME.EmbedObject(1454, \"\", attachment1)\r\nOn Error Resume Next\r\nEnd If\r\n\r\nattachment2 = \"C:\\Users\\username\\Desktop\\folder2\\time2.txt\"\r\nIf attachment2 &lt;&gt; \"\" Then\r\nOn Error Resume Next\r\nSet AttachME = MailDoc.CREATERICHTEXTITEM(\"attachment2\")\r\nSet EmbedObj1 = AttachME.EmbedObject(1454, \"\", attachment2)\r\nOn Error Resume Next\r\nEnd If\r\n\r\n\r\nSet workspace = CreateObject(\"Notes.NotesUIWorkspace\")\r\nCall workspace.EditDocument(True, MailDoc).GOTOFIELD(\"Body\")\r\n\r\n\r\nSet Maildb = Nothing\r\nSet MailDoc = Nothing\r\nSet AttachME = Nothing\r\nSet Session = Nothing\r\nSet EmbedObj1 = Nothing\r\n\r\n.ScreenUpdating = True\r\n.DisplayAlerts = True\r\nEnd With\r\n\r\nerrorhandler1:\r\n\r\nSet Maildb = Nothing\r\nSet MailDoc = Nothing\r\nSet AttachME = Nothing\r\nSet Session = Nothing\r\nSet EmbedObj1 = Nothing\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 43, "user_id": 8028427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76651603660a3cbf95037dc04086d5be?s=128&d=identicon&r=PG&f=1", "display_name": "Boomer", "link": "https://stackoverflow.com/users/8028427/boomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1692, "favorite_count": 1, "closed_date": 1515029035, "accepted_answer_id": 48084773, "answer_count": 2, "score": 3, "last_activity_date": 1515019508, "creation_date": 1515003911, "last_edit_date": 1515011261, "question_id": 48083094, "link": "https://stackoverflow.com/questions/48083094/generate-email-from-excel-data-with-lotus-notes-social-edition-home", "closed_reason": "Needs more focus", "title": "Generate Email from Excel Data with Lotus Notes Social Edition Home", "body": "<p>So I've been trying to come up with a macro to send a emails with a attachment through a spread sheet.</p>\n\n<p>For example:</p>\n\n<p><code>mailto:emailadress@email.com?subject=Sample12345</code></p>\n\n<p>If I use the above string in excel it will prompt my default email client to create the email with the example email address and sample subject line.\nI've used it for a while and it might be simple string but, its super helpful when I can manipulate it in excel.</p>\n\n<p>Example of string manipulating in a cell  : <code>=HYPERLINK(A1&amp;A2&amp;A3&amp;A4&amp;A5&amp;A6)</code></p>\n\n<p>I would like to morph the same concept but ,in a macro so I can send it to multiple people with a different email address.</p>\n\n<p>The problems :</p>\n\n<p>I have Lotus Notes Social Edition Home as default email client - Release 9.0.1 </p>\n\n<p>Example of what I would like to accomplish :</p>\n\n<pre><code>Mailto: sampleemailadress@email.com (from a specific cell value in excel \"=Sheet1!A1\")\nCC:( from a specific cell value in excel \"=Sheet1!A2\" )\nBody: ( from a specific Range in excel \"=Sheet2!A1:B24\" )\nAttachment : (from a specific cell value in excel \"=Sheet1!A1\") ....Value in Cell - \" C:\\Users\\User1\\Downloads\\sampleexcelsheet.xlsm \"\n</code></pre>\n\n<p>Let me know your thoughts.</p>\n\n<p>Thank you!.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1515003064, "post_id": 48082796, "comment_id": 83140199, "body": "<a href=\"https://stackoverflow.com/a/11169920/5936117\">This is a very helpful answer</a>. The rest of your question is too vague."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1515005745, "post_id": 48082891, "comment_id": 83141617, "body": "This only answer partially the question."}, {"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "edited": false, "score": 0, "creation_date": 1515054727, "post_id": 48082891, "comment_id": 83157040, "body": "it does? I believe that the formula part works, the OP was just having problems identifying the last row, which does seem to be clarified in his edit"}, {"owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "edited": false, "score": 0, "creation_date": 1515168252, "post_id": 48082891, "comment_id": 83210564, "body": "Jpad-When I tried using your code above I encountered an error. Can&#39;t recall what it was at this time. Thanks for the help though!"}], "tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": false, "score": 0, "last_activity_date": 1515003054, "creation_date": 1515003054, "answer_id": 48082891, "question_id": 48082796, "link": "https://stackoverflow.com/questions/48082796/determining-last-cell-used-and-inserting-formula-in-different-column/48082891#48082891", "title": "Determining Last Cell Used and Inserting Formula in Different Column", "body": "<p>You can use the rows.count property of the sheet, which will give you the maximum row used (in any column) then go up from that in Column A, some pseudo code below</p>\n\n<pre><code>lastRow = range(\"A\" &amp; sheet.rows.count).end(xlup).row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "is_accepted": true, "score": 0, "last_activity_date": 1515168135, "creation_date": 1515168135, "answer_id": 48117140, "question_id": 48082796, "link": "https://stackoverflow.com/questions/48082796/determining-last-cell-used-and-inserting-formula-in-different-column/48117140#48117140", "title": "Determining Last Cell Used and Inserting Formula in Different Column", "body": "<p>Identified last row using</p>\n\n<pre><code>Dim lastrow As Long\nlastrow = Range(\"A1\").End(xlDown).Row\n</code></pre>\n\n<p>Then modified my formulas to this:</p>\n\n<pre><code>Range(\"AC2:AC\" &amp; lastrow).Formula = \"=IF($S2=\"\"\"\",\"\"Discard\"\",$T2-8)\"\n</code></pre>\n\n<p>And it works perfectly!</p>\n"}], "owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 48117140, "answer_count": 2, "score": 0, "last_activity_date": 1515168135, "creation_date": 1515002607, "last_edit_date": 1515008527, "question_id": 48082796, "link": "https://stackoverflow.com/questions/48082796/determining-last-cell-used-and-inserting-formula-in-different-column", "title": "Determining Last Cell Used and Inserting Formula in Different Column", "body": "<p>Trying to get a vba code that determines the last row used in column A then inserting the following formulas in the stated columns until the last row.</p>\n\n<pre><code>Range(\"AC2:AC\" &amp; lastrow).FormulaR1C1 = \"=IF($S2=\"\"\"\",\"\"Discard\"\",$T2-8)\"\nRange(\"AD2:AD\" &amp; lastrow).FormulaR1C1 = \"=IF($S2=\"\"\"\",\"\"Discard\"\",($S2*1000000000000)/($AC2*10000000))\"\n</code></pre>\n\n<p>Hoping to do this without referencing the worksheet name.\nThanks for any help!</p>\n\n<p>Edit: What I am trying to figure out is the last row used in Column A. Then have the above formulas inserted in columns AC and AD from row 2 to the determined last row. I hope this clarifies what I am asking.</p>\n"}, {"tags": ["xml", "vba", "soap"], "comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1515048479, "post_id": 48082552, "comment_id": 83154442, "body": "Did you try the below script? What&#39;s your feedback?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8184181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbd3769f18b4aeb70bf697d8c4f007?s=128&d=identicon&r=PG&f=1", "display_name": "TGChris", "link": "https://stackoverflow.com/users/8184181/tgchris"}, "edited": false, "score": 0, "creation_date": 1515067114, "post_id": 48083338, "comment_id": 83164119, "body": "This has worked great, much simpler than my previous solution!"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1515005015, "creation_date": 1515005015, "answer_id": 48083338, "question_id": 48082552, "link": "https://stackoverflow.com/questions/48082552/xml-soap-parse-vba/48083338#48083338", "title": "XML SOAP Parse VBA", "body": "<p>Try this. It should work. I just tested locally.</p>\n\n<pre><code>Sub TestXML2()\n    Dim http As New XMLHTTP60\n    Dim xmldoc As Object, post As Object\n\n    With http\n        .Open \"GET\", \"place_url_here\", False\n        .send\n        Set xmldoc = CreateObject(\"MSXML2.DOMDocument\")\n        xmldoc.LoadXML .responseXML.XML\n    End With\n\n    For Each post In xmldoc.SelectNodes(\"//FullConsignmentDetails\")\n        r = r + 1: Cells(r, 1) = post.SelectNodes(\".//ConsignmentNumber\")(0).Text\n        Cells(r, 2) = post.SelectNodes(\".//StatusCode\")(0).Text\n        Cells(r, 3) = post.SelectNodes(\".//StatusDescription\")(0).Text\n    Next post\n\n    Set xmldoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>Reference to add to the library:</p>\n\n<pre><code>Microsoft XML, v6.0\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8184181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdbd3769f18b4aeb70bf697d8c4f007?s=128&d=identicon&r=PG&f=1", "display_name": "TGChris", "link": "https://stackoverflow.com/users/8184181/tgchris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 48083338, "answer_count": 1, "score": 0, "last_activity_date": 1612717228, "creation_date": 1515001701, "last_edit_date": 1612717228, "question_id": 48082552, "link": "https://stackoverflow.com/questions/48082552/xml-soap-parse-vba", "title": "XML SOAP Parse VBA", "body": "<p>I have an XML API response which I am trying to parse in VBA. I am trying to use</p>\n<p><code>objXML.selectNodes(&quot;//soap:Envelope/soap:Body/ConsignmentTrackingGetFullDetailsV3Response/ConsignmentTrackingGetFullDetailsV3Result/FullConsignmentDetails/ConsignmentStatuses&quot;)</code></p>\n<p>but this doesn't appear to find any nodes.</p>\n<p>I have also looked at the <code>objXML.getElementsByTagName</code> but this doesn't work either</p>\n<p>I am able to access these nodes by using a number of childnodes but this doesn't seem very efficient.\nI am new to SOAP but have tried to add namespaces.</p>\n<p>The XML response is below.</p>\n<pre><code>&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;\n   &lt;soap:Body&gt;\n      &lt;ConsignmentTrackingGetFullDetailsV3Response xmlns=&quot;http://webapp-cl.internet-delivery.com/ThirdPartyIntegrationService&quot;&gt;\n         &lt;ConsignmentTrackingGetFullDetailsV3Result&gt;\n            &lt;ResultState&gt;Successful&lt;/ResultState&gt;\n            &lt;FullConsignmentDetails&gt;\n               &lt;ConsignmentNumber&gt;31487490001622&lt;/ConsignmentNumber&gt;\n               &lt;ConsignmentStatuses&gt;\n                  &lt;GetConsignmentDetailsStatus&gt;\n                     &lt;StatusCode&gt;2&lt;/StatusCode&gt;\n                     &lt;StatusDescription&gt;Collected&lt;/StatusDescription&gt;\n                  &lt;/GetConsignmentDetailsStatus&gt;\n                  &lt;GetConsignmentDetailsStatus&gt;\n                     &lt;StatusCode&gt;4&lt;/StatusCode&gt;\n                     &lt;StatusDescription&gt;Out For Delivery&lt;/StatusDescription&gt;\n                  &lt;/GetConsignmentDetailsStatus&gt;\n               &lt;/ConsignmentStatuses&gt;\n            &lt;/FullConsignmentDetails&gt;\n         &lt;/ConsignmentTrackingGetFullDetailsV3Result&gt;\n      &lt;/ConsignmentTrackingGetFullDetailsV3Response&gt;\n   &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;\n</code></pre>\n<p>Any suggestions on how to efficiently parse the required nodes would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1515001264, "post_id": 48082380, "comment_id": 83139320, "body": "<i>The formula works fine on a spreadsheet but I can&#39;t get it to work in VBA.</i> - record a macro of yourself entering the formula on a worksheet. The macro will record the correct syntax for you."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515001595, "post_id": 48082380, "comment_id": 83139475, "body": "Hi Scott, I have tried but still can&#39;t figure it out.  This is the result I get, I think the roblem is when I change ActiveCell and then assigning it to another variable.   <code>ActiveCell.FormulaR1C1 =  &quot;=LOOKUP(2,1&#47;(R[-13]C:R[-1]C&lt;&gt;&quot;&quot; &quot;&quot;),(R[-13]C[-1]:R[-1]C[-1]))&quot;</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1515001761, "post_id": 48082380, "comment_id": 83139543, "body": "what is <code>TaxCode4.Address</code> when it errors?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515001812, "post_id": 48082380, "comment_id": 83139571, "body": "your comment is not clear and inconsistent with your question. And now that i re-read it there&#39;s no variable being used in the formula at all. Is the issue with the formula or <code>TaxCode4.Address</code>?"}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1515002132, "post_id": 48082380, "comment_id": 83139726, "body": "Apologies, still very new to this, but I have just found that when I change the code to <code>Range(TaxCode4.Address).FormulaR1C1 = &quot;=LOOKUP(2,1&#47;(R[-12]C:R[-1]C&lt;&gt;&quot;&quot; &quot;&quot;),(R[-12]C[-1]:R[-1]C[-1]))&quot;</code> I get the correct result placed in the cell address of TaxCode4. I suppose the question I&#39;m asking is how to I assign that cell address that the value was found in during the lookup to a variable to further manipulate. Hope that makes sense"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515002980, "post_id": 48082380, "comment_id": 83140164, "body": "If you want to write to <code>TaxCode4</code> (a <code>Range</code> object), then write to <code>TaxCode4</code> - don&#39;t use its <code>Address</code> to fetch yet another reference to the very same object! <code>TaxCode4.FormulaR1C1 = ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1515007419, "creation_date": 1515007419, "answer_id": 48083872, "question_id": 48082380, "link": "https://stackoverflow.com/questions/48082380/using-a-variable-within-a-formula/48083872#48083872", "title": "Using a variable within a formula", "body": "<p>The last line of your code is of the format</p>\n\n<pre><code>variable = logical_expression\n</code></pre>\n\n<p>and is setting a variable (<code>TaxCode5</code>) to be either <code>True</code> or <code>False</code> depending on whether or not the formula in the cell referred to by <code>TaxCode4</code> is the same as the one in the code.</p>\n\n<p>It does <strong>not</strong> modify the formula in the cell referred to by <code>TaxCode4</code>.</p>\n\n<p>It appears you want:</p>\n\n<pre><code>Private Sub NewTaxCode()\n    Dim TaxCode2 As Long\n    Dim B As Range\n    Dim TaxCode3 As Range\n    Dim TaxCode4 As Range\n    Dim TaxCode5 As Variant\n\n    Set B = Worksheets(\"P11Combined\").Range(\"A:A\")\n\n    Worksheets(\"E'ee Details\").Range(\"U1\").FormulaR1C1 = \"=Match(RC[-4],P11Combined!C[-18],0)\"\n    TaxCode2 = Worksheets(\"E'ee Details\").Range(\"U1\").Value\n\n    Set TaxCode3 = B.Find(What:=\"TAX:\", After:=B(TaxCode2))\n\n    Set TaxCode4 = TaxCode3.End(xlDown).Offset(1, 2)\n\n    TaxCode4.FormulaR1C1 = \"=LOOKUP(2,1/(R[-12]C:R[-1]C&lt;&gt;\"\" \"\"),(R[-12]C[-1]:R[-1]C[-1]))\"\n    TaxCode5 = TaxCode4.Value\n    '...\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515011038, "creation_date": 1515001019, "last_edit_date": 1515011038, "question_id": 48082380, "link": "https://stackoverflow.com/questions/48082380/using-a-variable-within-a-formula", "title": "Using a variable within a formula", "body": "<p>I'm trying to use a variable within a formula but the result I am getting is FALSE, when it should be returning a Lookup value, starting from the bottom of a table and going up.</p>\n\n<pre><code>Private Sub NewTaxCode()\nDim TaxCode2 As Long\nDim B As Range\nDim TaxCode3 As Range\nDim TaxCode4 As Range\n\nWorksheets(\"P11Combined\").Activate\n\nSet B = Range(\"A:A\")\n\nWorksheets(\"E'ee Details\").Range(\"U1\").Value = \"=Match(RC[-4],P11Combined!C[-18],0)\"\nTaxCode2 = Worksheets(\"E'ee Details\").Range(\"U1\").Value\n\nSet TaxCode3 = Range(\"A:A\").Find(What:=\"TAX:\", After:=B(TaxCode2))\n\nSet TaxCode4 = Range(TaxCode3.Address).End(xlDown).Offset(1, 2)\n\nTaxCode5 = Range(TaxCode4.Address).FormulaR1C1 = \"=LOOKUP(2,1/(R[-12]C:R[-1]C&lt;&gt;\"\" \"\"),(R[-12]C[-1]:R[-1]C[-1]))\"\n</code></pre>\n\n<p>The last line is where I am having the issues. The formula works fine on a spreadsheet but I can't get it to work in VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515000938, "post_id": 48082125, "comment_id": 83139138, "body": "The code cannot work as expected if it has a problem adding the names in sheet A which are not in sheet B. Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and explain what about adding the names to sheet B from Sheet A that is causing you trouble. I know you probably didn&#39;t do this intentionally, but in effect, you are asking us to write your code for you, as you have not shown the attempt to do what needs done."}], "owner": {"reputation": 11, "user_id": 9169216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a5d822f6521f41f97131b8d7718472?s=128&d=identicon&r=PG&f=1", "display_name": "Adventador", "link": "https://stackoverflow.com/users/9169216/adventador"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1515036762, "creation_date": 1514999962, "last_edit_date": 1515036762, "question_id": 48082125, "link": "https://stackoverflow.com/questions/48082125/how-can-i-compare-and-change-cells-in-excel", "title": "How can I compare and change cells in Excel", "body": "<p>I have two sheets. In both sheets I have a column (B) where each row is a different name:</p>\n\n<p><img src=\"https://i.stack.imgur.com/16oxw.png\" alt=\"Example\"></p>\n\n<p>Sheet 'A' has names in the column, these names are 'leading'. \nSheet 'B' also has names in this column, these names CAN BE outdated. </p>\n\n<p>What I want: A macro which can check the names.</p>\n\n<ul>\n<li>delete the names in Sheet B which are not (anymore) in Sheet A (delete entire affecting row)</li>\n<li>Add the names from sheet A which are not (yet) in sheet B in new rows</li>\n</ul>\n\n<p>What I have so far:</p>\n\n<pre><code>Sub DeleteRowsThatDoNotMatch()\n\nDim rng As Range\nDim Rng1 As Range, Rng2 As Range\nDim thisRow As Long\nDim arr1 As Variant\nDim arr2 As Variant\nDim dic2 As Variant\nDim OutArr As Variant\n\nxTitleId = \"Test\"\nSet Rng1 = Application.Selection\nSet Rng1 = Application.InputBox(\"Welke data moet gewijzigd worden? :\", xTitleId, Rng1.Address, Type:=8)\nSet Rng2 = Application.InputBox(\"Selecteer de nieuwe waardes:\", xTitleId, Type:=8)\nSet Rng1 = Rng1.Columns(1)\nSet dic2 = CreateObject(\"Scripting.Dictionary\")\narr2 = Rng2.Value\n\nFor i = 1 To UBound(arr2, 1)\n    xKey = arr2(i, 1)\n    dic2(xKey) = \"\"\nNext\nthisRow = Rng1.Rows.Count\nDo While thisRow &gt; 0\n    If Not dic2.Exists(Rng1.Cells(thisRow, 1).Value) Then\n        Rng1.Cells(thisRow, 1).EntireRow.Delete\n    End If\n\n    thisRow = thisRow - 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>This works as expected; the problem is adding the names which ARE in Sheet A but not (yet) in Sheet B.</p>\n"}, {"tags": ["excel", "shell", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1545, "user_id": 3657206, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76ec2024a0cee7d1bcf3a3980f54568e?s=128&d=identicon&r=PG&f=1", "display_name": "LThode", "link": "https://stackoverflow.com/users/3657206/lthode"}, "edited": false, "score": 0, "creation_date": 1515000759, "post_id": 48082101, "comment_id": 83139034, "body": "Can you provide the error it&#39;s generating?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 3, "last_activity_date": 1514999965, "creation_date": 1514999965, "answer_id": 48082127, "question_id": 48082101, "link": "https://stackoverflow.com/questions/48082101/vba-switching-from-xls-to-xlsx-file-format/48082127#48082127", "title": "VBA: Switching from .xls to .xlsx file format", "body": "<p>Replace constant <code>acSpreadsheetTypeExcel9</code> with <code>acSpreadsheetTypeExcel12XML</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": false, "score": 0, "last_activity_date": 1515000011, "creation_date": 1515000011, "answer_id": 48082132, "question_id": 48082101, "link": "https://stackoverflow.com/questions/48082101/vba-switching-from-xls-to-xlsx-file-format/48082132#48082132", "title": "VBA: Switching from .xls to .xlsx file format", "body": "<p>Try changing acSpreadsheetTypeExcel9 to acSpreadsheetTypeExcel12Xml</p>\n"}], "owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 48082127, "answer_count": 2, "score": 3, "last_activity_date": 1594638504, "creation_date": 1514999842, "last_edit_date": 1594638504, "question_id": 48082101, "link": "https://stackoverflow.com/questions/48082101/vba-switching-from-xls-to-xlsx-file-format", "title": "VBA: Switching from .xls to .xlsx file format", "body": "<p>I'm working on a database that was originally coded to output a .xls Excel file.  We need to change it to .xlsx, but I can't figure it out.  I tried simply changing \".xls\" to \".xlsx\" but that didn't work.  It generated an error on the <code>Set wbk= XLapp.Workbooks.Open(SavePath).Sheets(1)</code> line--at least that's what the debugger highlighted.   Here's the current code section:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub ExcelFeederReview_Click()\nDim SavePath As String\nSavePath = fGetMyDocsPath &amp; \"\\FeederReview_\" &amp; Format(Now, \"YYYYMMDD_hhnn\") &amp; \".xls\"\n'Run Query and export to Savepath\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"qFeederExport\", SavePath, False, \"FeederReview\"\n\n'Open query in excel shell\nSet XLapp = New Excel.Application\nSet wbk = XLapp.Workbooks.Open(SavePath).Sheets(1)\n\n'Format excel doc with excel shell\n    With XLapp\n            .Application.DisplayAlerts = False\n            .Application.Rows(\"1:1\").Select\n            .Application.Selection.Font.Bold = True\n            .Application.Selection.Orientation = 90\n            .Application.Selection.Interior.ColorIndex = 15\n            .Application.Range(\"A2\").Select\n            .Application.ActiveWindow.FreezePanes = True\n            .Application.Range(\"A1\").Select\n            .Application.Selection.RowHeight = 86\n            .Application.Columns(\"D:D\").Select\n            .Application.Selection.NumberFormat = \"###0.00\"\n            .Application.Cells.Select\n            .Application.Selection.Font.Name = \"Arial\"\n            .Application.Selection.Columns.AutoFit\n            .Application.Range(\"A1\").Select\n            .Application.ActiveWorkbook.SaveAs FileName:=SavePath\n            .Application.ActiveWorkbook.Close\n            .Quit\n    End With\n\n'Allows user to view and open file\n    OpenFileDiag = MsgBox(\"Feeder review file saved to the the following location:\" &amp; vbCrLf &amp; vbCrLf &amp; SavePath &amp; vbCrLf &amp; vbCrLf &amp; \"Would you like to view Saved File?\", vbYesNo, \"View Saved File?\")\n\n'Yes selection opens saved formated excel file\n    If OpenFileDiag = vbYes Then\n\n        Set XLAppOpenToView = New Excel.Application\n            XLAppOpenToView.Visible = True\n            XLAppOpenToView.Workbooks.Open SavePath\n\n'No selection unloads excel shell\n    ElseIf OpenFileDiag = vbNo Then\n\n            XLapp.Quit\n            Set XLapp = Nothing\n            Set XLsheet = Nothing\n\n        Exit Sub\n\n    End If\n'Unloading of excel shell to prevent multiple open excel instances\n    XLapp.Quit\n    Set XLapp = Nothing\n    Set XLsheet = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "email-attachments"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1514999668, "post_id": 48082004, "comment_id": 83138429, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/aa265015(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa265015(v=vs.60).aspx</a>"}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515002844, "post_id": 48082004, "comment_id": 83140097, "body": "Thank you Tim!  I was looking at the wrong method."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1515831740, "creation_date": 1515831740, "answer_id": 48238161, "question_id": 48082004, "link": "https://stackoverflow.com/questions/48082004/save-a-copy-of-the-current-attachment-before-sending/48238161#48238161", "title": "Save a copy of the current attachment before sending", "body": "<p><em>Simply use <code>For Each \u2026 In \u2026 Next Loop</code> to save current <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/attachments-object-outlook\" rel=\"nofollow noreferrer\">MItem.Attachments</a></em></p>\n\n<pre><code>With MItem\n    .To = \"email1@gmail.com\"\n    '.cc = \"email2@gmail.com\"\n    .Subject = \" Test Subject\"\n    .Body = \" test text in body of email\" &amp; Me.EvalID_T1.value\n    .Attachments.Add (ActiveWorkbook.Worksheets(\"BrowseFile\").Cells(4, 3).value)\n\n     Dim Atmt As Object\n     For Each Atmt In MItem.Attachments\n         Debug.Print Atmt.DisplayName\n         Atmt.SaveAsFile \"C:\\Temp\\\" &amp; Atmt.DisplayName\n     Next\n\n    .Display\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 48238161, "answer_count": 1, "score": 1, "last_activity_date": 1593169932, "creation_date": 1514999415, "last_edit_date": 1593169932, "question_id": 48082004, "link": "https://stackoverflow.com/questions/48082004/save-a-copy-of-the-current-attachment-before-sending", "title": "Save a copy of the current attachment before sending", "body": "<p>How do I save a copy of attachment I just attached before I send as a backup. </p>\n\n<p>Any help would be great! Thank you.</p>\n\n<pre><code>    Dim outlookOBJ As Object\n    Dim MItem As Object\n\n   Set outlookOBJ = CreateObject(\"Outlook.Application\")\n   Set MItem = outlookOBJ.CreateItem(olMailItem)\n   With MItem\n   .To = \"email1@gmail.com\"\n  '.cc = \"email2@gmail.com\"\n   .Subject = \" Test Subject\"\n   .body = \" test text in body of email\" &amp; Me.EvalID_T1.Value\n   .Attachments.Add (ActiveWorkbook.Worksheets(\"BrowseFile\").Cells(4,3).Value)\n   'want to add some kind of save current attachment feature here right before I send\n\n    .send\n</code></pre>\n"}, {"tags": ["excel", "vba", "templates", "window", "activation"], "owner": {"reputation": 21, "user_id": 9169092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99b83f2a45c693818be0d6a88b2e567c?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/9169092/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1514999366, "creation_date": 1514999366, "question_id": 48081990, "link": "https://stackoverflow.com/questions/48081990/excel-vba-activate-window-without-file-name-yet-cause-from-xltm-template", "title": "Excel VBA activate window without file name yet, cause from xltm template", "body": "<p>I want to use an Excel template XLTM. I want to insert some information that I copied from another Excel file. \nOpening the other file and copying the information is easy, but then re-activating the first Excel document is where I have trouble. </p>\n\n<p>If I store the template as xlsm, I can use that filename in the macro and it works fine. But I would like to use an XLTM, in order that people wouldn't accidentally overwrite the template. </p>\n\n<p>Therefore at the moment of returning to the file, it's not yet saved and has therefore no definite file name. \nIs there a way to re-activate the window that is based on my xlmt file?</p>\n\n<p>Below macro works fine, as long as my template is <em>Template.xlsm</em>. But I would like to use an actualy xltm file as a template.\nIs this even possible?</p>\n\n<pre><code>Sub Update()\n'\n' Kampagnen Updaten\n'\n    Workbooks.Open Filename:= _\n        \"M:\\Client\\0001Jobs\\2018\\V11857Test\\Special_campaigns.xlsx\" _\n        , UpdateLinks:=0\n    Range(\"A3:A90\").Select\n    Selection.Copy\n    Windows(\"Template.xlsm\").Activate\n    Sheets(\"Dropdown\").Visible = True\n    Sheets(\"Dropdown\").Select\n    Range(\"E2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"E1\").Select\n    Sheets(\"Dropdown\").Select\n    ActiveWindow.SelectedSheets.Visible = False\n    Sheets(\"Template\").Select\n\n    Windows(\"Special_campaigns.xlsx\").Activate\n    ActiveWindow.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1515074457, "post_id": 48081645, "comment_id": 83168644, "body": "What error are you getting in the edited code and on what line? Also where are you using <code>criZFrom</code> and <code>criZTo</code>? I don&#39;t see them in the edited code other than where they&#39;re defined. Are all the variables <code>Dim</code>&#39;d as ranges?"}, {"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "reply_to_user": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1515080932, "post_id": 48081645, "comment_id": 83172563, "body": "Argh I copied it after I tried it using the 1 and 2 hard coded. I&#39;ve edited it now. The error is <code>run-tim error 13: type mismatch</code> THe error is on the <code>rng = Application.AverageIfs(</code> if i use the variables. If i hard code the 1 or 2 in place (coming from columns G and H) the error goes away and the formula works. The problem variables are <code>Dim</code>d as ranges yes. Columns G and H in the first sheet need to accord with Columns A and B in the second sheet. I only get the error if i have the <code>&#47; 3</code> after the main formula. if I remove this, the formula calculates correctly"}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "edited": false, "score": 0, "creation_date": 1515083567, "post_id": 48081645, "comment_id": 83174194, "body": "Ahh, I think I see the problem now. I edited my answer."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1514999089, "post_id": 48081856, "comment_id": 83138115, "body": "ah sorry, the <code>....</code> was there because the full formula is so long I thought I would shorten it for readability. The full code does use <code>_</code> as you suggest. If I add the parenthesis as suggested it gives <code>compile error: expected: end of statement</code>."}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "reply_to_user": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1515003713, "post_id": 48081856, "comment_id": 83140543, "body": "No worries. I added a potential solution as an edit."}, {"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1515056883, "post_id": 48081856, "comment_id": 83158072, "body": "ok thanks, I&#39;ll try that. So should just adding <code>&#47; 3</code> after the main formula work then?"}, {"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1515065326, "post_id": 48081856, "comment_id": 83163016, "body": "I have narrowed the problem down and edited my original question following your helpful suggestions, and added some sample data."}, {"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1515087002, "post_id": 48081856, "comment_id": 83176226, "body": "Unfortunately I&#39;m still getting a type mismatch error after the Edit 2 suggestion. Even though when you hover over <code>criZFrom.Value</code> and it shows <code>1</code>. It just doesn&#39;t like the ` / 3` after as it works without. I wondered if it was to do with <code>Dim</code>ing the <code>rng</code> variable (currently as range) to handle decimals (i.e. as double) but after some tests it seems not."}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "reply_to_user": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1515088498, "post_id": 48081856, "comment_id": 83176970, "body": "That&#39;s crazy! I can&#39;t imagine why the / 3 would make it not work. I just made another edit (essentially defining a <code>Variant</code> and assigning the value there), see how that works."}, {"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 0, "creation_date": 1515147410, "post_id": 48081856, "comment_id": 83198494, "body": "Yes this works! thanks for your help. what is the <code>CDbl</code> bit, is this like assigning a variable to the answer on the fly?"}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "reply_to_user": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 1, "creation_date": 1515158231, "post_id": 48081856, "comment_id": 83204619, "body": "I&#39;m glad that worked! <code>CDbl</code> is probably not even necessary here but I didn&#39;t want to take any chances. The <code>CDbl</code> just ensures that the results of <code>t &#47; 3</code> are stored in <code>t</code> as a Double variable type to preserve decimal values. I wouldn&#39;t <i>think</i> that it would store as something without a decimal since it&#39;s <code>Dim</code>&#39;d as <code>Variant</code> but you never know."}], "tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": true, "score": 1, "last_activity_date": 1515088455, "last_edit_date": 1515088455, "creation_date": 1514998844, "answer_id": 48081856, "question_id": 48081645, "link": "https://stackoverflow.com/questions/48081645/vba-alternative-to-application-quotient-that-includes-decimals/48081856#48081856", "title": "VBA alternative to Application.Quotient that includes decimals", "body": "<p>Looks like you're missing a closing parenthesis after <code>\"OGV\")</code> to close out the <code>AverageIfs</code> function, i.e.:</p>\n\n<pre><code>Range(\"C1:C676\") = Application.IfError(Application.AverageIfs(Sheets(modelName).Range(\"R:R\", Sheets(modelName).Range(\"U:U\"), \"OGV\")), 0) / 3\n</code></pre>\n\n<p>Also, not sure if <code>....</code> was just for on here or in your code, but you'd want to use <code>_</code> instead, as in:</p>\n\n<pre><code>Range(\"C1:C676\") = _ \nApplication.IfError(Application.AverageIfs(Sheets(modelName).Range(\"R:R\", _\nSheets(modelName).Range(\"U:U\"), \"OGV\")), 0) / 3\n</code></pre>\n\n<p><strong>Edit:</strong> If you're still getting an error, I suggest breaking up your formula into component parts and assigning each part to a variable so you can troubleshoot exactly where the issue is, like so:</p>\n\n<pre><code>Sub test()\nDim rng As Range, col1 As Range, col2 As Range, str As String, modelName As String\n\nmodelName = \"Sheet1\"\n\nSet rng = Range(\"C1:C676\")\nSet col1 = Sheets(modelName).Columns(18)\nSet col2 = Sheets(modelName).Columns(21)\nstr = \"OGV\"\n\nrng = Application.IfError(Application.AverageIfs(col1, col2, str), 0) / 3\n\nEnd Sub\n</code></pre>\n\n<p>Can we see some sample data? It might be an issue of what order the arguments are being passed for the <code>AverageIfs</code> function.</p>\n\n<p><strong>Edit 2:</strong> I think I might see what the problem is. You're using the <code>AverageIfs</code> function with the intention of validating each line separately based on the specific criteria for each line by using a range for Arg3 and Arg5 instead of single values, which <code>AverageIfs</code> doesn't like. Criteria for <code>Ifs</code> functions will always need to be a single value instead of a range of values. Instead, I think you would need to iterate each line separately using a loop, like this:</p>\n\n<pre><code>Set avgCol = Sheets(modelName).Range(\"M:M\")\nSet colZFrom = Sheets(modelName).Range(\"G:G\")\nSet colZTo = Sheets(modelName).Range(\"H:H\")\nSet colTime = Sheets(modelName).Range(\"V:V\")\nSet colVType = Sheets(modelName).Range(\"U:U\")\n\ncriVType = \"OGV\"\ncriAM = \"AM\"\n\nRange(\"A1:A676\").Formula = \"=roundup(row()/26,0)\"\nRange(\"B1:B676\").Formula = \"=if(mod(row(),26)=0,26,mod(row(),26))\"\n\nDim x as Long\nDim t as Variant\n\nFor x = 1 To 676\n    Set criZFrom = Sheets(wsName).Range(\"A\" &amp; x)\n    Set criZTo = Sheets(wsName).Range(\"B\" &amp; x)\n    Set Rng = Sheets(wsName).Range(\"C\" &amp; x)\n\n    t = Application.WorksheetFunction.AverageIfs(avgCol, colZFrom, criZFrom.Value, colZTo, criZTo.Value, colTime, criAM, colVType, criVType)\n    t = CDbl(t / 3)\n    Rng.Value = t\nNext x\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 48081856, "answer_count": 1, "score": 1, "last_activity_date": 1515088455, "creation_date": 1514998042, "last_edit_date": 1515080587, "question_id": 48081645, "link": "https://stackoverflow.com/questions/48081645/vba-alternative-to-application-quotient-that-includes-decimals", "title": "VBA alternative to Application.Quotient that includes decimals", "body": "<p>I am trying to use <code>Application.AverageIfs</code> and I need to divide the answer by 3. I tried this way: </p>\n\n<pre><code>Range(\"C1:C676\") = (Application.IfError(Application.AverageIfs(Sheets(modelName).Range(\"R:R\"....\n                    Sheets(modelName).Range(\"U:U\"), \"OGV\"), \"0\") / 3)\n</code></pre>\n\n<p>and also without the brackets round the first <code>application</code> and the final <code>3</code> but this gives a type mismatch error.</p>\n\n<p>Nesting it within <code>Application.Quotient</code> works but it only gives the integer part of the answer and I need the decimal as well. Is there a decimal-friendly alternative? I would prefer to continue to use the <code>application</code> syntax rather than putting <code>range().formula = \"=averageifs(</code> if its possible. </p>\n\n<p><strong>Edit:</strong> after J.Fox's suggestion I have broken the formula parts into variables. The problem seems to be the <code>criZFrom</code> and <code>criZTo</code> variables which use a range in a separate sheet as criteria. The formula works fine if I replace these variables with <code>\"1\"</code> and <code>\"2\"</code> respectively. The code is now:</p>\n\n<pre><code>Set rng = Sheets(wsName).Range(\"C1:C676\")\n    Set avgCol = Sheets(modelName).Range(\"M:M\")\n    Set colZFrom = Sheets(modelName).Range(\"G:G\")\n    Set criZFrom = Sheets(wsName).Range(\"A1:A676\")\n    Set colZTo = Sheets(modelName).Range(\"H:H\")\n    Set criZTo = Sheets(wsName).Range(\"B1:B676\")\n    Set colTime = Sheets(modelName).Range(\"V:V\")\n    Set colVType = Sheets(modelName).Range(\"U:U\")\n\n    criVType = \"OGV\"\n    criAM = \"AM\"\n\n        Range(\"A1:A676\").Formula = \"=roundup(row()/26,0)\"\n\n        Range(\"B1:B676\").Formula = \"=if(mod(row(),26)=0,26,mod(row(),26))\"\n\n            rng = Application.AverageIfs(avgCol, colZFrom, criZFrom, colZTo, criZTo, colTime, criAM, colVType, criVType) / 3\n</code></pre>\n\n<p>Here is some sample data:</p>\n\n<p>from <code>sheets(modelName)</code>, this has the data that I am trying to average and most of the criteria ranges: <a href=\"https://i.stack.imgur.com/MzsoT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MzsoT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>From <code>sheets(wsName)</code>, this has the criteria for the problem variables and is where I want the result to appear (in column C): <a href=\"https://i.stack.imgur.com/w1em0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w1em0.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 1, "creation_date": 1514998524, "post_id": 48081634, "comment_id": 83137811, "body": "I would not recommend it, but you could use a public variable and insert different values into as an array. then save that information a sheet somewhere."}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "edited": false, "score": 1, "creation_date": 1514998526, "post_id": 48081634, "comment_id": 83137812, "body": "As far as I know nothing like this exists in VBA and might be a little messy to do in Excel.  With Access I&#39;ve done similar-ish things by creating a log table that gets populated by another subroutine that you&#39;ve placed inside of all the other subroutines.  Once all that is done you could call a main subroutine that contains all your other subroutines with your intended If Then logic referencing the log table."}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1514998726, "post_id": 48081634, "comment_id": 83137928, "body": "Thank you both for your comments, it was a stab in the dark. I was trying to save myself time from recreating userforms and the just direct them to a new based upon previous choice. But thank you for confirming my theroy though :)"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1514998880, "post_id": 48081634, "comment_id": 83138007, "body": "If you want to track which subroutine has been finished and what results has been returned, you have to change subs 2-5 into fuctions."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1514999156, "post_id": 48081634, "comment_id": 83138162, "body": "&quot;track what Sub have been run, and then use this information within an if statement&quot; sounds like a recipe for a massive spaghetti disaster. At first I thought you were looking for some logging framework (<a href=\"https://codereview.stackexchange.com/q/64109/23788\">solutions exist</a>), but it appears you&#39;re looking for something no language I know has ever implemented, for obvious anti-spaghettification reasons. You need to separate your application logic from your logs, not intertwine them."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514999383, "post_id": 48081634, "comment_id": 83138265, "body": "@Mat&#39;sMug <i>no language I know has ever implemented</i> <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.runtime.compilerservices.callermembernameattribute\" rel=\"nofollow noreferrer\">CallerMemberName</a>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514999465, "post_id": 48081634, "comment_id": 83138306, "body": "@JohnyL <code>CallerMemberName</code> tells you the name of the procedure that called the one you&#39;re in, it doesn&#39;t <i>track what procedures have been run</i>, and if you&#39;re using <code>CallerMemberName</code> for branching logic, I&#39;m not touching your code base with a 10-foot pole."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514999656, "post_id": 48081634, "comment_id": 83138424, "body": "@Mat&#39;sMug I ain&#39;t use it (except for <code>INotifyPropertyChanged</code> interface). The question was to get the name of the caller. You insist no language has implemented such feature. So, am I wrong? :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514999700, "post_id": 48081634, "comment_id": 83138452, "body": "@JohnyL looks like you and I aren&#39;t reading the same question. OP doesn&#39;t need to know whether <code>DoSomething</code> has been called, they need to know whether some <code>IsFoo</code> flag is set. This is rather obviously a massive X-Y problem."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514999899, "post_id": 48081634, "comment_id": 83138543, "body": "@Mat&#39;sMug Uh... My bad! OP needs a <i>chain</i> of callers to construct one&#39;s logic. Yes, CallerMemberName doesn&#39;t fit (but, anyway, I can&#39;t understand why OP needs such logic... Eeek!)."}, {"owner": {"reputation": 12398, "user_id": 1310566, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5qiMO.jpg?s=128&g=1", "display_name": "Simon Forsberg", "link": "https://stackoverflow.com/users/1310566/simon-forsberg"}, "edited": false, "score": 3, "creation_date": 1514999945, "post_id": 48081634, "comment_id": 83138567, "body": "It&#39;s not Sub5&#39;s responsibility to know it was called by Sub3 or not, it is up to Sub3 to tell Sub5 &quot;Hey, it is me calling you!&quot;. Golden rule: <i>TELL, don&#39;t ask!</i>"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1515053078, "post_id": 48081634, "comment_id": 83156340, "body": "Thank you all for your comments. By the sounds of it, it sounds as its possible to do but requires some clever solution. Looks like today and so on may be re writting the code :) Thanks for all of your feedback, much appricated."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1515096045, "post_id": 48081634, "comment_id": 83180693, "body": "Added a fully workable solution based on tracking the relevant subs (sub1 to sub4) by a <code>track</code> procedure (includes strict order check or alternative check for any order). You can easily adapt the wanted sequence of subs (up to 9) by defining a constant string code."}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1515053618, "last_edit_date": 1515053618, "creation_date": 1514999332, "answer_id": 48081976, "question_id": 48081634, "link": "https://stackoverflow.com/questions/48081634/is-there-a-way-to-track-which-sub-have-been-run/48081976#48081976", "title": "Is there a way to track which Sub have been run", "body": "<p>Yes, you can do it! Follow these steps:</p>\n\n<ol>\n<li>create one procedure (subroutine)</li>\n<li>create 4 functions which returns true/false values (depednding on what result you want to get)</li>\n<li>inside a procedure you can use function like a variable</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code> Sub TrackSubroutines\n     If Function1(parameters) Then\n        If Functions2(parameters) Then\n    '... and so on\n        End If\n     End If\n End Sub\n\nFunction1(parameters) As Boolean\n    Function1 = True/False\nEnd Function\n\nFunction2(parameters) As Boolean\n    Function1 = True/False\nEnd Function\n</code></pre>\n\n<p>More you'll find at MSDN: <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/calling-sub-and-function-procedures\" rel=\"nofollow noreferrer\">Calling Sub and Function Procedures</a></p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1515056021, "post_id": 48087355, "comment_id": 83157634, "body": "A state engine being another Function/Sub etc. with loads of different If Then rules to satistfy what i need? Have i understood that right?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1515095200, "post_id": 48087355, "comment_id": 83180266, "body": "My initial concept is global variables (or perhaps a single variable or class/structure) to contain the state information and event handlers to change these global variables. So, the short answer is that the state engine is not another function/sub. A function/sub would be &quot;blocking&quot; or interrupting your normal flow of code, and I don&#39;t think you want this. How you set up the global variables/structure/class will depend on what state information you want to keep. But choose the most efficient way for you to store, modify and access that information when required."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 3, "last_activity_date": 1515028126, "creation_date": 1515028126, "answer_id": 48087355, "question_id": 48081634, "link": "https://stackoverflow.com/questions/48081634/is-there-a-way-to-track-which-sub-have-been-run/48087355#48087355", "title": "Is there a way to track which Sub have been run", "body": "<p>You basically want to create a state engine in your module/project. This state engine would be at the global level, and each function/sub-routine would change the state when run. </p>\n\n<p>I would consider that each function/routine should fire an event when entering and leaving. Your state machine would listen for each event and modify the state accordingly.</p>\n\n<p>If you have functions/routines that are dependent on particular states before proceeding, then add additional code to query the current state. Another way to tackle this is to have the state query occur before trying to fire the function/sub-routine. Depends on what you want you code to do and how you want it to respond when trying to do invalid code branches.</p>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1515141870, "post_id": 48102460, "comment_id": 83195197, "body": "Thank you for this. I shall have a look through this and try to makes heads and tails of it. I may pop back up and ask Q&#39;s if that is ok?"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 1, "creation_date": 1515142821, "post_id": 48102460, "comment_id": 83195634, "body": "Having read throuigh this in more detial, this has to be one of the most comprenshive and detailed answers I&#39;ve ever seen. Its just incrediable"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1515148362, "post_id": 48102460, "comment_id": 83199017, "body": "When i try and call this module <code>Sub LogTest (ByVal i as Integer, Optional bStrictOrder as Boolean = true)</code> i get a Argument Not Optional error. I am right in thinking this is down to <code>Optiional bStrictOrder as Boolean</code>? or not? Thanks"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1515172779, "post_id": 48102460, "comment_id": 83213036, "body": "Suppose this to refer to the 1st argument as only the 2nd is optional. Possibly you called your test procedure without any argument like <code>LogTest</code> only instead of e.g. <code>LogTest 1</code> or <code>LogTest 1, True</code> (cf. <code>track {n}</code> in my answer)."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1515101239, "last_edit_date": 1515101239, "creation_date": 1515095052, "answer_id": 48102460, "question_id": 48081634, "link": "https://stackoverflow.com/questions/48081634/is-there-a-way-to-track-which-sub-have-been-run/48102460#48102460", "title": "Is there a way to track which Sub have been run", "body": "<p><strong>Approach via log variable <code>State</code></strong></p>\n\n<p>Just showing you a workable approach using a <code>Type</code> variable to store a tracking code in a log variable. I'd suggest to declare it as public type pattern \"TLog\" in an extra code module, e.g. \"modGlobals\". </p>\n\n<p><strong>Declaration head in extra module with global variables</strong></p>\n\n<pre><code>   Option Explicit\n   Public Type TLog                   ' &lt;~~  declare Public Type TLog e.g. in module 'modGlobals'\n          nTimes As Integer\n          State  As String\n   End Type\n</code></pre>\n\n<p><strong>Declaration head in code module</strong></p>\n\n<p>Here you can define your own log book, e.g. <code>log1</code> based on the <code>TLog</code> Type.\nFurthermore you add a constant code string \"124\" defining the subsequent subs (sub1 + sub2 + sub4) that trigger sub5.</p>\n\n<pre><code>Option Explicit                         ' declaration head in your code module\nDim log1 As TLog                        ' module log book comprising state code and times executed\nConst MYCOND As String = \"124\"          ' code string for condition: sub1 + sub2 +  sub4\n</code></pre>\n\n<p><strong>Method</strong></p>\n\n<p>Any procedure call runs a user defined track procedure with three main tasks:</p>\n\n<ul>\n<li>(1) add a procedure code to the log variable (e.g. <code>log1.State</code>)</li>\n<li>(2) check the Subs condition \"124\" (sub1 + sub2 + sub4)</li>\n<li>(3) run sub5 if the procedure order sub1+sub2+sub4 is observed.</li>\n</ul>\n\n<p>(Caveat: <em>if you want to log more than 9 subsequent subs you'd have to adapt the logging method joining only single digits for each sub</em>)</p>\n\n<p><strong>Note</strong></p>\n\n<p>I abstained from using (preferrable) <strong>class methods</strong> in order to show you the way. Sure you can find some ideas at SO.</p>\n\n<p><strong>How to use a track procedure in the relevant subs</strong></p>\n\n<p>Just call <code>Track 1</code>, <code>Track 2</code> and so on in any relevant procedure (tracking subs and checking for a strict order by default). I offered, however, the possibility to choose ANY order by setting its second argument to <code>False</code> . </p>\n\n<pre><code>Sub sub1()\n    track 1\n    ' ...\nEnd Sub\nSub sub2()\n    track 2\n    ' ...\nEnd Sub\nSub sub3()\n    track 3\n    ' ...\nEnd Sub\nSub sub4()\n    track 4\n    ' ...\nEnd Sub\nSub sub5()\n    ' Purpose: run code only after sub1 + sub2 + sub4\n    ' ...\n    Beep\nEnd Sub\n</code></pre>\n\n<p><strong>Example call</strong></p>\n\n<pre><code>Sub test()\n' Purpose: Testing wanted series of procedures\nsub1\nsub2\nsub4        ' &lt;&lt; if modified to sub3, there will be no execution\nEnd Sub\n</code></pre>\n\n<p><strong>Code example of a track procedure</strong></p>\n\n<p>Wrote explanations into code comments:</p>\n\n<pre><code>Sub track(ByVal i As Integer, Optional bStrictOrder As Boolean = True)\n' Purpose: track procedures sub1 to sub4 and run sub5 if the logged state string has a defined order (without sub3)\n' Method:  the state code is logged in a declared TYPE variable, e.g. log1\n' Extra:   an additional execution counter nTimes\n' Note:    the constant string MYCOND \"124\" codes the sequence sub1 + sub2 + sub4\nDim bExecProc As Boolean            ' flag to procede in code\nDim yn        As VbMsgBoxResult     ' yes/no answer to messagebox question\n\n  ' (0) log only first 4 procedures as precondition to execute sub5\n    If i &gt;= 5 Then Exit Sub             ' just in case of additional track statements in higher subs\n\n\n  ' -------------------------------------------------------\n  ' (1) track procedures by adding digit code to log1.State\n  '     (reinitiate log1 after procedure sub1)\n  ' -------------------------------------------------------\n    log1.State = IIf(i = 1 And bStrictOrder, \"\", log1.State) &amp; Format(i, \"0\")\n  ' note: might demand further code to avoid subsequent calls of the same procedure \n  ' \n  ' -------------------------------------------\n  '  (2) Check defined condition code\n  ' -------------------------------------------\n  If bStrictOrder Then\n  '  (2a) sub1 + sub2 + sub4 have run before in defined ORDER\n          If log1.State = MYCOND Then bExecProc = True\n  Else\n  '  (2b) alternative: sub1, sub2 and sub4 have run in ANY order\n          If Arrange(log1.State) = MYCOND Then bExecProc = True\n  End If\n\n  ' -------------------------------------------\n  '  (3) Execute procedure sub5\n  ' -------------------------------------------\n    If bExecProc Then\n    ' optional security message if sub5 has been already executed before\n      If log1.nTimes = 0 Then\n       yn = vbYes\n      Else\n       yn = MsgBox(\"Sub5 has been executed already \" &amp; log1.nTimes &amp; \" time(s). \" &amp; _\n            \"Do you want to procede?\", vbQuestion + vbYesNo + vbDefaultButton2, \"Attention\")\n      End If\n      If yn = vbYes Then\n      ' do it and reset state and execution counter\n        MsgBox \"I'm calling sub5 now\" &amp; vbNewLine &amp; \" because \" &amp; vbNewLine &amp; _\n             \" log1.State code shows \"\"\" &amp; log1.State &amp; \"\"\"\" &amp; vbNewLine &amp; vbNewLine &amp; _\n             \" (log1.nTimes = \" &amp; log1.nTimes &amp; \" time(s) up till now)\", vbInformation, \"Just before running Sub5\"\n      ' ~~~~~~\n        sub5                             ' &lt;~~ execute procedure sub5\n      ' ~~~~~~\n        log1.State = \"\"                  ' reset state\n        log1.nTimes = log1.nTimes + 1    ' increment execution counter\n      End If\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>Helper Function in case of ANY order of procedures</strong></p>\n\n<p>The helper function <code>Arrange()</code> is only used if you would set the 2nd (optional) argument of all your <code>Track</code> calls to <code>False</code>, e.g. <code>Track 1, False</code>.</p>\n\n<pre><code>Function Arrange(ByVal s As String) As String\n' Purpose: Helper function to rearrange State code for logging (e.g. log1.State)\n' caveat:  limited to 9 subsequent subs with single digits\n' Note:    (admittedly code could be refined)\n  Dim i As Integer       ' counter\n  ReDim v(1 To Len(s))\n  Dim d As Integer       ' each digit in code s\n' loop through State code characters so far\n  For i = 1 To Len(s)\n      v(i) = Val(Mid(s, i, 1))\n  Next i\n  SortAr v\n' return rearranged code string\n  Arrange = Join(v, \"\")\nEnd Function\n\nSub SortAr(arr())\n' Purpose:  sort one based 1-dim array\n' cf: https://stackoverflow.com/questions/20721489/how-can-i-sort-dates-in-an-array-in-vba\nDim Temp\nDim i As Long, j As Long\n\nFor j = 1 To UBound(arr)\n    Temp = arr(j)\n    For i = j - 1 To 1 Step -1\n        If (arr(i) &lt;= Temp) Then GoTo 10\n            arr(i + 1) = arr(i)\n    Next i\n    i = 0\n10:     arr(i + 1) = Temp\nNext j\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 48102460, "answer_count": 3, "score": 1, "last_activity_date": 1515101239, "creation_date": 1514998021, "last_edit_date": 1514998452, "question_id": 48081634, "link": "https://stackoverflow.com/questions/48081634/is-there-a-way-to-track-which-sub-have-been-run", "title": "Is there a way to track which Sub have been run", "body": "<p>This is more of a theoretical question than anything else, which if possible I may have a use for. </p>\n\n<p>I was looking on the internet and found  nothing about this. </p>\n\n<p>Is there a way for excel to track what Sub have been run, and then use this information within an <code>if</code> statement?</p>\n\n<p>I.e. </p>\n\n<p>Lets say we have Sub 1, Sub 2, Sub 3, Sub 4 &amp; Sub 5</p>\n\n<p>The sub calls next sub dependant on results. I need many subs as the use will involve UserForms as well as modules. </p>\n\n<p>If </p>\n\n<p>Sub 1 -> Sub 2 -> Sub 3 -> Sub 5 </p>\n\n<p>But Sub 5 wont run if Sub 3 has been called. </p>\n\n<p>So </p>\n\n<p>Sub 1 -> Sub 2 -> Sub 4 -> Sub 5 - but now sub 5 runs. </p>\n\n<p>Does that make sense/ is that possible (Do I need a more powerful language?)? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": true, "score": 2, "last_activity_date": 1514998512, "creation_date": 1514998512, "answer_id": 48081755, "question_id": 48081611, "link": "https://stackoverflow.com/questions/48081611/vba-opening-files-which-have-a-specific-keyword-in-them/48081755#48081755", "title": "VBA opening files which have a specific keyword in them", "body": "<p>I think that you want the Instr function.</p>\n\n<pre><code>If Instr(wb.Name, \"CITIES\") &gt; 0 then .....\n</code></pre>\n\n<p>You might want to use \"CITIES \" or \" CITIES \" to exclude any unintentional uses of those letters, depending on how the filename is setup</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1514999158, "creation_date": 1514999158, "answer_id": 48081935, "question_id": 48081611, "link": "https://stackoverflow.com/questions/48081611/vba-opening-files-which-have-a-specific-keyword-in-them/48081935#48081935", "title": "VBA opening files which have a specific keyword in them", "body": "<p>Use the wildcard to identify the missing letters: <code>*CITIES*.xls</code> or <code>*CITIES*.xls*</code> if you're expecting xlsx, xlsm, etc.</p>\n\n<pre><code>Sub Test()\n\n    Dim colFiles As Collection\n    Dim vItem As Variant\n    Dim wrkBk As Workbook\n    Dim sPath As String\n\n    Set colFiles = New Collection\n\n    sPath = \"C:\\Users\\Morpheus\\Documents\\Projects\\Files\\\"\n    'you could use:\n    'sPath = Environ(\"UserProfile\") &amp; \"\\Documents\\Projects\\Files\\\"\n\n    EnumerateFiles sPath, \"*CITIES*.xls\", colFiles\n\n    For Each vItem In colFiles\n        Set wrkBk = Workbooks.Open(vItem)\n        wrkBk.Worksheets(\"Sheet1\").Range(\"A1\") = wrkBk.Name\n    Next vItem\n\nEnd Sub\n\nSub EnumerateFiles(ByVal sDirectory As String, _\n    ByVal sFileSpec As String, _\n    ByRef cCollection As Collection)\n\n    Dim sTemp As String\n\n    sTemp = Dir$(sDirectory &amp; sFileSpec)\n    Do While Len(sTemp) &gt; 0\n        cCollection.Add sDirectory &amp; sTemp\n        sTemp = Dir$\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2695, "user_id": 886357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d0e09de07d348483088b599fc27eff3a?s=128&d=identicon&r=PG", "display_name": "Morpheus", "link": "https://stackoverflow.com/users/886357/morpheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 48081755, "answer_count": 2, "score": 0, "last_activity_date": 1514999403, "creation_date": 1514997937, "last_edit_date": 1514999403, "question_id": 48081611, "link": "https://stackoverflow.com/questions/48081611/vba-opening-files-which-have-a-specific-keyword-in-them", "title": "VBA opening files which have a specific keyword in them", "body": "<p>I have a folder which has a bunch of <code>.xls</code> files, of which only those which have the KEY Word \" CITIES \" are of interest to me. I need to open those files and collect some information and I am facing some issues.</p>\n\n<pre><code>Sub getTheExecSummary()\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n\nmyPath = \"C:\\Users\\Morpheus\\Documents\\Projects\\Files\"\n\n\n\nmyExtension = \"*.xls\"  'How to add the keyword?'\n\nmyFile = Dir(myPath &amp; myExtension)\n\n\nDo While Len(myFile) &gt; 0\n    'Set variable equal to opened workbook\n    Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n    Debug.Print (myFile)\n    Debug.Print (wb.Name)\n    ActiveSheet.Range(\"A1\").Value = wb.Name\n    'Get next file name\n      myFile = Dir\nLoop\n\nEnd Sub \n</code></pre>\n\n<p>I did write a few <code>Debug.Print</code> statements none of which seem to work. I want to for now print only those workbooks which have the keyword ' CITIES ' in their name.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1514997965, "post_id": 48081507, "comment_id": 83137507, "body": "Try with .PaperSize = xlPaperSize.xlPaperLedger"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1514998986, "post_id": 48081507, "comment_id": 83138058, "body": "Can you include the error message?   The error codes are harder to follow.  Try using the <a href=\"http://www.excel-easy.com/vba/examples/macro-recorder.html\" rel=\"nofollow noreferrer\">macro recorder</a>, to print manually.  Then you can compare the VBA Excel writes with your own."}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "edited": false, "score": 0, "creation_date": 1515011754, "post_id": 48081507, "comment_id": 83144276, "body": "Error message was 1004 Unable to set the PaperSize Property of class Page Setup."}], "answers": [{"comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1514998146, "post_id": 48081614, "comment_id": 83137617, "body": "Although I didn&#39;t downvote this answer I can guess why others did.  Link only answers are frowned upon.  Why?  What happens if the link breaks?  Also is <i>suggest trying the drivers</i> really an anwser?"}, {"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1514998299, "post_id": 48081614, "comment_id": 83137693, "body": "Well, I think your point about the link is valid.   However, the link details what to do with the drivers, and I thought it would be easier for the OP to read it, rather than me retype it for the sake of pedantry.  I also am trying to help the OP, by pointing him to a place with a person who has experienced exactly the same issue. Not sure why this attracts criticism."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1514998491, "post_id": 48081614, "comment_id": 83137795, "body": "The argument against that is; what happens when someone else encounters the same issue a year from now.  They find this page.  Will the link still work?  If they have to visit another site is this <i>really</i> an answer?  Or is it just internet clutter?  I only point this out because often fixing an answer results in downvoters removing their downvote (and therefore restoring your lost rep)."}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "edited": false, "score": 0, "creation_date": 1515011830, "post_id": 48081614, "comment_id": 83144311, "body": "I tried the drivers, and it did not work. I ended up just going through and setting the page as a Ledger and removed the line of code entirely. The printer detects it as 11x17 and prints accordingly, with no issues."}], "tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": false, "score": -2, "last_activity_date": 1514998714, "last_edit_date": 1514998714, "creation_date": 1514997949, "answer_id": 48081614, "question_id": 48081507, "link": "https://stackoverflow.com/questions/48081507/cannot-set-the-paper-size/48081614#48081614", "title": "Cannot set the paper size", "body": "<p>Even though you can print manually, this could still be a printer driver issue. You could try installing the 32/64 bit version of the printer driver (dependent on which you currently have) to see if that makes a difference</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5507234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea3416dd932c704c3d2495036e16059?s=128&d=identicon&r=PG&f=1", "display_name": "powdermnky007", "link": "https://stackoverflow.com/users/5507234/powdermnky007"}, "is_accepted": false, "score": 0, "last_activity_date": 1527184389, "last_edit_date": 1527184389, "creation_date": 1527175712, "answer_id": 50513081, "question_id": 48081507, "link": "https://stackoverflow.com/questions/48081507/cannot-set-the-paper-size/50513081#50513081", "title": "Cannot set the paper size", "body": "<p>Depends on the print driver.  Each print driver calls the paper size something different.  Printing to Adobe PDF printer for example calls it <code>xlPaperLedger</code>.  </p>\n\n<p>But when printing to an HP printer using an HP universal print driver you need the following code:</p>\n\n<pre><code>Worksheets(\"Sheet1\").PageSetup.PaperSize = 120\n</code></pre>\n\n<p>You can find out what your printer calls it by recording a macro and manually setting the papersize within Excel.</p>\n\n<p><strong>TL;DR:</strong>\nSome print drivers like it called different names.</p>\n"}], "owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1158, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527184389, "creation_date": 1514997503, "last_edit_date": 1514999704, "question_id": 48081507, "link": "https://stackoverflow.com/questions/48081507/cannot-set-the-paper-size", "title": "Cannot set the paper size", "body": "<p>Below is the code tied to an activeX button. </p>\n\n<pre><code>With Worksheets(\"SUMMARY\").PageSetup\n    .HeaderMargin = Application.InchesToPoints(0.25)\n    .FooterMargin = Application.InchesToPoints(0.1)\n    .LeftMargin = Application.InchesToPoints(1)\n    .TopMargin = Application.InchesToPoints(0.5)\n    .BottomMargin = Application.InchesToPoints(0.5)\n    .RightMargin = Application.InchesToPoints(1)\n    .CenterFooter = \"Page &amp;P of &amp;N\"\n    .PrintTitleRows = Rows(\"1:7\").Address\n    .RightFooter = \"\"\n    .Orientation = xlLandscape\n    .PaperSize = xlPaperLedger 'Error 1004\nWorksheets(\"SUMMARY\").PrintOut\nEnd With\n</code></pre>\n\n<p>For some reason, I keep getting a <code>1004 error</code> at the <code>.PaperSize = xlPaperLedger</code> line. The printer supports the Ledger paper, and I can print it manually, but for some reason it won't print when I click the button.</p>\n\n<p>There are a lot of password protected sheets and the like, but I don't think this is the issue. I have printed before with this code, and it worked fine.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1515030409, "post_id": 48081453, "comment_id": 83150087, "body": "You might have the result you describe if the properties of the shapes don&#39;t allow overlapping."}, {"owner": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1516184644, "post_id": 48081453, "comment_id": 83581906, "body": "I set Selection.ShapeRange.WrapFormat.AllowOverlap = False, but actually it hasn&#39;t solved the problem. The issue persists."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "edited": false, "score": 0, "creation_date": 1516186332, "post_id": 48212891, "comment_id": 83583071, "body": "Thank you for the response. I think it&#39;s true, if I would realize it as a part of Loop. I created my macro just as a single separate program.  Each time I manually select 1 (one) definite paragraph, insert a picture (shape) and then try to precisely position it using this small single macro. So, each time I definitely select a different paragraph and I do change my selection of paragraph by hand. I think that it cannot be the same paragraph each time. Instead of wdRelativeVerticalPositionParagraph I tried to use wdRelativeVerticalPositionLine. And it works fine now, it solved the problem."}, {"owner": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "edited": false, "score": 0, "creation_date": 1516186537, "post_id": 48212891, "comment_id": 83583204, "body": "Sorry, I don&#39;t know how to insert code here correctly"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "edited": false, "score": 0, "creation_date": 1516196497, "post_id": 48212891, "comment_id": 83589673, "body": "Click the EDIT link at the very end of your question. That will let you make changes and add (readable!) code :-)"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "edited": false, "score": 0, "creation_date": 1516959270, "post_id": 48212891, "comment_id": 83910189, "body": "@Dmytro If my answer did help you solve your problem you should mark it as &quot;the answer&quot; by clicking the checkmark. This will hlep others with similar questions recognize the contribution as helpful."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1515692120, "creation_date": 1515692120, "answer_id": 48212891, "question_id": 48081453, "link": "https://stackoverflow.com/questions/48081453/wrong-positioning-of-the-shape-in-ms-word-using-vba/48212891#48212891", "title": "Wrong positioning of the shape in MS Word using vba", "body": "<p>Note the use of <code>SELECTION</code> in the code you show us. If you don't change the paragraph selection, then the shapes will always be anchored to the same paragraph. Working with a Selection in Word is tricky; it's much better to work with a more tangible object, such as a specific paragraph. </p>\n\n<p>The following code sample illustrates using paragraph objects to anchor and position successively added Shapes.</p>\n\n<pre><code>Sub insertShapesProgressively()\n  Dim shp As word.Shape\n  Dim shpRng As word.ShapeRange\n  Dim rng As word.Range\n  Dim iParaCounter As Long\n\n  'We want to insert the Shape anchored to three different paragraphs\n  ' on the same page\n  For i = 7 To 9\n    Set rng = ActiveDocument.Paragraphs(i).Range\n    Set shp = ActiveDocument.shapes.AddShape(msoShapeWave, 0, 0, 10, 10, rng)\n    Set shpRng = rng.ShapeRange\n    shpRng.RelativeHorizontalPosition = wdRelativeHorizontalPositionColumn\n    shpRng.Left = MillimetersToPoints(0)\n    shpRng.RelativeVerticalPosition = wdRelativeVerticalPositionParagraph\n    shpRng.Top = MillimetersToPoints(7)\n    shpRng.WrapFormat.Type = wdWrapTopBottom\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5530910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bbaa192fb900e8d1106844972a96a82?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro", "link": "https://stackoverflow.com/users/5530910/dmytro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516228769, "creation_date": 1514997312, "last_edit_date": 1516228769, "question_id": 48081453, "link": "https://stackoverflow.com/questions/48081453/wrong-positioning-of-the-shape-in-ms-word-using-vba", "title": "Wrong positioning of the shape in MS Word using vba", "body": "<p>I'm writing a simple code to position my shapes (which are actually pictures) in the document. I want them to be positioned:</p>\n\n<ul>\n<li><p>horizontally to exactly 0 mm. from the left side of the printable area</p></li>\n<li><p>vertically to 7 mm. below the paragraph (to which the shape is anchored)</p></li>\n</ul>\n\n<p>I wrote a simple code:</p>\n\n<hr>\n\n<pre><code>Selection.ShapeRange.RelativeHorizontalPosition = wdRelativeHorizontalPositionColumn\nSelection.ShapeRange.Left = MillimetersToPoints(0)\nSelection.ShapeRange.RelativeVerticalPosition = wdRelativeVerticalPositionParagraph\nSelection.ShapeRange.Top = MillimetersToPoints(7)\n\nSelection.ShapeRange.WrapFormat.Type = wdWrapTopBottom\n</code></pre>\n\n<hr>\n\n<p>For 1 shape on the page it works fine. But if there are more then 1 shape, it somehow \"throws\" the 2nd shape to the top of the page. It looks like Word anchors it to the 1st paragraph on the page. but it shouldn't. At the same time horizontal positioning is ok.</p>\n\n<p>I would appreciate any help to fix this issue.</p>\n\n<p>My possible solution for this issue will look as follows:</p>\n\n<pre><code>Sub PositShape_3()\nDim I As Integer\n\nIf Selection.InlineShapes.Count &lt;&gt; 0 Then\n  For I = Selection.InlineShapes.Count To 1 Step -1\n    Selection.InlineShapes(I).ConvertToShape\n  Next I\nEnd If\n\nSelection.ShapeRange.RelativeHorizontalPosition = wdRelativeHorizontalPositionColumn\nSelection.ShapeRange.Left = MillimetersToPoints(0)\nSelection.ShapeRange.RelativeVerticalPosition = wdRelativeVerticalPositionLine\nSelection.ShapeRange.Top = MillimetersToPoints(7)\n\nSelection.ShapeRange.WrapFormat.Type = wdWrapTopBottom\n\nEnd Sub    \n</code></pre>\n\n<p>In spite of the fact that the use of wdRelativeVerticalPositionLine solved the problem, it is still interesting why the use of wdRelativeVerticalPositionParagraph has such unexpected unwanted consequences.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1514996936, "post_id": 48081268, "comment_id": 83136879, "body": "You already have code that finds the last column, using End(xlToRight), use similar code in the other worksheets, or store the column index if the sheets are identical in layout."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9168941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd8795bb294de990a3bc5e68d8be8f?s=128&d=identicon&r=PG&f=1", "display_name": "AIMEE", "link": "https://stackoverflow.com/users/9168941/aimee"}, "edited": false, "score": 0, "creation_date": 1515054911, "post_id": 48081337, "comment_id": 83157114, "body": "Thanks so much!  Both work great and now I&#39;ve got a few different solutions I can use again in the future :)"}], "tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": false, "score": 0, "last_activity_date": 1514997222, "last_edit_date": 1514997222, "creation_date": 1514996896, "answer_id": 48081337, "question_id": 48081268, "link": "https://stackoverflow.com/questions/48081268/adding-a-cell-value-into-multiple-sheets-with-input-box/48081337#48081337", "title": "Adding a cell value into multiple sheets with input box", "body": "<p>If you change the if statement to this, it will work:</p>\n\n<pre><code>If ws.Name &lt;&gt; \"SheetList\" And ws.Name &lt;&gt; \"Blank Sheet\" And ws.Name &lt;&gt; \n\"Dashboard\" And ws.Name &lt;&gt; \"Combined\" And ws.Name &lt;&gt; \"MasterCheck\" Then\n\n        ws.Range(rng.Address).Value = rng.Value\n\n    End If\n</code></pre>\n\n<p>and some slightly modified code for you to look at:</p>\n\n<pre><code>    Sub AddNewColumns()\n    Dim strHeadingToInsert As String\n    Dim wks As Worksheet\n\n        strHeadingToInsert = InputBox(\"Please enter a name for the new column\")\n\n\n        For Each wks In ThisWorkbook.Worksheets\n\n            If wks.Name &lt;&gt; \"SheetList\" And wks.Name &lt;&gt; \"Blank Sheet\" And wks.Name &lt;&gt; \"Dashboard\" And wks.Name &lt;&gt; \"Combined\" And wks.Name &lt;&gt; \"MasterCheck\" Then\n\n                wks.Range(\"A8\").End(xlToRight).Offset(0, 1) = strHeadingToInsert\n\n            End If\n\n        Next wks\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1514996970, "creation_date": 1514996970, "answer_id": 48081364, "question_id": 48081268, "link": "https://stackoverflow.com/questions/48081268/adding-a-cell-value-into-multiple-sheets-with-input-box/48081364#48081364", "title": "Adding a cell value into multiple sheets with input box", "body": "<p>Give this a shot. Should be simple enough to understand on its own:</p>\n\n<pre><code>Option Explicit\n\nSub AddNewColumns()\n\n    Dim newColumn As String\n    newColumn = InputBox(\"Please enter a name for the new column\")\n\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n\n        If ws.Name &lt;&gt; \"SheetList\" And ws.Name &lt;&gt; \"Blank Sheet\" And ws.Name &lt;&gt; \"Dashboard\" And ws.Name &lt;&gt; \"Combined\" And ws.Name &lt;&gt; \"MasterCheck\" Then\n\n            ws.Range(\"A8\").End(xlToRight).Offset(,1).Value = newColumn\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 9168941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd8795bb294de990a3bc5e68d8be8f?s=128&d=identicon&r=PG&f=1", "display_name": "AIMEE", "link": "https://stackoverflow.com/users/9168941/aimee"}, "is_accepted": false, "score": 0, "last_activity_date": 1515055506, "creation_date": 1515055506, "answer_id": 48091591, "question_id": 48081268, "link": "https://stackoverflow.com/questions/48081268/adding-a-cell-value-into-multiple-sheets-with-input-box/48091591#48091591", "title": "Adding a cell value into multiple sheets with input box", "body": "<p>Thanks for all answers given, they all work great and there's a few options I can keep for future use :)</p>\n\n<p>I went with the first option although all answers did the job</p>\n\n<pre><code>Option Explicit\n\nSub AddNewColumns()\n\nDim newColumn As String\nnewColumn = InputBox(\"Please enter a name for the new column\")\n\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n\n    If ws.Name &lt;&gt; \"SheetList\" And ws.Name &lt;&gt; \"Blank Sheet\" And ws.Name &lt;&gt; \"Dashboard\" And ws.Name &lt;&gt; \"Combined\" And ws.Name &lt;&gt; \"MasterCheck\" Then\n\n        ws.Range(\"A8\").End(xlToRight).Offset(,1).Value = newColumn\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9168941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd8795bb294de990a3bc5e68d8be8f?s=128&d=identicon&r=PG&f=1", "display_name": "AIMEE", "link": "https://stackoverflow.com/users/9168941/aimee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 48081364, "answer_count": 3, "score": 0, "last_activity_date": 1515055506, "creation_date": 1514996669, "last_edit_date": 1515044287, "question_id": 48081268, "link": "https://stackoverflow.com/questions/48081268/adding-a-cell-value-into-multiple-sheets-with-input-box", "title": "Adding a cell value into multiple sheets with input box", "body": "<p>My workbook contains multiple sheets, in each sheet row 8 contains column headers.  Each sheet has identical columns to the other sheets but the amount of columns will vary from job to job. I need to write a macro so that when a new column header is added to the end of one sheet, it adds it to all the other sheets (with a few exceptions which can be seen in my code).  The column name is controlled by an input box but as the number of columns can vary I can't fix the cell range when trying to use this value.</p>\n\n<p>Here is the code I have at the moment.  I had no luck trying to add just the additional column name so I tried copying all the column names in row 8 but haven't been able to get it to work.  I'm quite new to VBA, any help would be appreciated!  </p>\n\n<pre><code>Sub AddNewColumns()\n\nDim NewColumn As String\nDim rng As Range\n\nNewColumn = InputBox(\"Please enter a name for the new column\")\n\n    Range(\"A8\").Select\n    ActiveCell.End(xlToRight).Select\n    ActiveCell.Offset(0, 1).Select\n\n    ActiveCell.Value = NewColumn\n\n    Range(\"A8\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n\n    Set rng = Selection\n\n    Selection.Copy\n\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n\n    If ws.Name &lt;&gt; \"SheetList\" And ws.Name &lt;&gt; \"Blank Sheet\" And ws.Name &lt;&gt; \"Dashboard\" And ws.Name &lt;&gt; \"Combined\" And ws.Name &lt;&gt; \"MasterCheck\" Then\n\n    ws.Range(\"A8\").Value = rng.Value\n\n    End If\n\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "ado", "recordset"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514996728, "post_id": 48081217, "comment_id": 83136745, "body": "Does the Access database know about the Oracle table? A recordset is nothing but the result of a query, the link between Access and Oracle isn&#39;t in the recordset, it needs to be in the database you&#39;re querying. Also, what kind of recordset? I&#39;m assuming you mean a forward-only, &quot;query results&quot; recordset, but ADO has much and more features. Your question is currently too vague to be answerable, and note that yes/no answers aren&#39;t happening on this site."}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514997591, "post_id": 48081217, "comment_id": 83137286, "body": "Hi Mat&#39;s, i actually meant &quot;how to do it&quot;, not &quot;if it was possible&quot;. so i think my quesiton is still legitimate. Access doesn&#39;t know about the Oracle table. this is the my question anyway. how i can i let access  know abotu oracle or the vice versa? i&#39;m gonna put a sample code now above as an edit"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514997690, "post_id": 48081217, "comment_id": 83137340, "body": "&quot;how to do it&quot; means you&#39;re expecting someone to come here and write you a tutorial about &quot;how to do it&quot;, which isn&#39;t how this site works, at all, so no, your question is not going to fly. Do your research/homework, <i>then</i> ask here when you hit a <i>specific</i> roadblock."}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514998030, "post_id": 48081217, "comment_id": 83137551, "body": "of course i&#39;m not expecting someone to write code for me, i just need someone tell me the way, give me the hint. i can do the rest"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1514998869, "post_id": 48081217, "comment_id": 83137999, "body": "<a href=\"https://stackoverflow.com/q/25249340/1188513\">stackoverflow.com/q/25249340/1188513</a>"}, {"owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514999290, "post_id": 48081217, "comment_id": 83138222, "body": "Thanks, but i need a solution with ADO, so both i can generalize this with other DB&#39;s in which importing/linking is not possible and i can do the other stuff with VBA. Sometimes i wiill need to connect DB2 and Oracle and SQL Server tables as well."}], "owner": {"reputation": 267, "user_id": 5288729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-ttn0pNKxj8g/AAAAAAAAAAI/AAAAAAAAAC4/aV78-eTWllU/photo.jpg?sz=128", "display_name": "ExcelinEfendisi", "link": "https://stackoverflow.com/users/5288729/excelinefendisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514997960, "creation_date": 1514996488, "last_edit_date": 1514997960, "question_id": 48081217, "link": "https://stackoverflow.com/questions/48081217/how-to-combine-two-different-database-table-with-ado", "title": "how to combine two different database table with ADO?", "body": "<p>Is it possible to combine an Oracle table and Access table in one recordset with ADO?</p>\n\n<p>I can do it with two Access table but not able to do with one Oracle and one Access.\nany help would be appreciated.</p>\n\n<p><strong>EDIT</strong>\nWorking code with two access</p>\n\n<pre><code>Sub twoDB()\nDim con As ADODB.Connection\nDim strDB1 As String\nDim strDB2 As String\nDim rs As ADODB.Recordset\n\nSet con = New ADODB.Connection\nstrDB1 = \".......\\daotest.accdb\"\nstrDB2 = \".......\\daotest2.accdb\"\n\nmysql = \"select * from [\" &amp; strDB1 &amp; \"].\u015fubeler inner join [\" &amp; strDB2 &amp; \"].\u015fb on (\u015fb.\u015fb=\u015fubeler.SubeKodu)\"\n\nWith con\n    .ConnectionString = \"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDB2 'oledb, odbc i\u00e7in: con.ConnectionString = \"Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=\" &amp; strDB 'odbc\n    .Mode = adModeWrite\n    .Open\nEnd With\n\nSet rs = New ADODB.Recordset\nrs.Open mysql, con, adOpenDynamic, adLockReadOnly\n\nActiveCell.CopyFromRecordset rs\n\nEnd Sub\n</code></pre>\n\n<p>Non-Working code with one access and one oracle</p>\n\n<pre><code>Sub twoDBOneOracleOneAccess()\nDim con As ADODB.Connection\nDim strDB2 As String\nDim rs As ADODB.Recordset\n\nSet con = New ADODB.Connection\n\nstrDB2 = \"....\\daotest2.accdb\"\n\nmysql = \"select MUSTERI_ID,MUSTERI_BAGLI_OLDUGU_SUBE_ID from OracleTable a inner join [\" &amp; strDB2 &amp; \"].\u015fb on (\u015fb.\u015fb=a.MUSTERI_BAGLI_OLDUGU_SUBE_ID) where A.MESLEK_KODU=2041\"\n\nWith con\n    .ConnectionString = \"Provider=OraOLEDB.Oracle;Data Source........;\"\n    .Open\nEnd With\n\nSet rs = New ADODB.Recordset\nrs.Open mysql, con, adOpenKeyset, adLockOptimistic\n\nActiveCell.CopyFromRecordset rs\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514996659, "post_id": 48081086, "comment_id": 83136715, "body": "Just apply the formatting to <code>E3</code> (select only E3 then add conditional formatting rule with just the first formula above) then paste formats down all 500 rows"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1514996762, "post_id": 48081086, "comment_id": 83136767, "body": "or highlight all 500 rows and enter the formula. it will apply to the whole range. (keeping $ signs where ensure each row of cells has formula applied)."}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1514997213, "post_id": 48081086, "comment_id": 83137044, "body": "I tried that. I feel like I am missing a step"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515003525, "post_id": 48081422, "comment_id": 83140453, "body": "Thank you. How do I apply formula to differet sheets rather than rewriting the entire thing again"}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515004990, "post_id": 48081422, "comment_id": 83141195, "body": "So I used that formula: <code>=$E3&lt;&gt;$H3</code> and I applied it to <code>=$H$3:$J$498</code>. The method only works when all three columns (H,I,J) are not equal to (E,F,G). Any way to do it so the formula would work for just one column to have a different value"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "reply_to_user": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515005936, "post_id": 48081422, "comment_id": 83141712, "body": "The answer to the first question is that you should be able to use the Format Painter (paintbrush symbol) to copy the formats across onto another sheet."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "reply_to_user": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515006358, "post_id": 48081422, "comment_id": 83141898, "body": "If you use =$E3&lt;&gt;$H3 what will happen is that it will only compare columns E &amp; H - the dollar sign locks it to those columns. If you leave out the dollar signs and try it again it will use relative addressing on columns so it will get modified to =F3&lt;&gt;I3 and =G3&lt;&gt;J3 - this will do a separate compare on pairs of columns E&amp;H, F&amp;I and G&amp;J. If you wanted to highlight <i>all</i> columns if <i>any</i> pair were different, you would be back to using an or formula like =or($E3&lt;&gt;$H3,$F3&lt;&gt;$I3,$G3&lt;&gt;$J3). Tip: try entering the formulas directly into the sheet and check what happens as you pull down and across."}], "tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": true, "score": 1, "last_activity_date": 1514997868, "last_edit_date": 1514997868, "creation_date": 1514997195, "answer_id": 48081422, "question_id": 48081086, "link": "https://stackoverflow.com/questions/48081086/excel-conditional-formatting-for-multiple-entries/48081422#48081422", "title": "Excel Conditional Formatting for Multiple Entries", "body": "<p>I know it will be unwise to contradict my learned colleagues but IMHO you need to get rid of the dollar signs</p>\n\n<pre><code>=OR(E3&gt;H3,E3&lt;H3)\n</code></pre>\n\n<p>But saying E3 is greater than H3 or E3 is less than H3 is the same as saying E3 is not equal to H3 so your formula will just boil down to</p>\n\n<pre><code>=E3&lt;&gt;H3\n</code></pre>\n\n<p>If you apply this to a whole range starting at E3, conditional formatting will automatically use relative addressing so in effect you get</p>\n\n<pre><code>=E4&lt;&gt;H4\n</code></pre>\n\n<p>in the next row and so on.</p>\n\n<p>You only need to use a dollar sign if you are pulling it across more than one column and need to anchor it to particular columns, so in this case the formula would be</p>\n\n<pre><code>=$E3&lt;&gt;$H3\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uJQsO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uJQsO.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 48081422, "answer_count": 1, "score": 0, "last_activity_date": 1514997868, "creation_date": 1514995974, "last_edit_date": 1531161705, "question_id": 48081086, "link": "https://stackoverflow.com/questions/48081086/excel-conditional-formatting-for-multiple-entries", "title": "Excel Conditional Formatting for Multiple Entries", "body": "<p>I am having trouble applying a formula to multiple cells on excel using conditional formatting. This is my formula: <code>=OR($E$3&gt;$H$3,$E$3&lt;$H$3)</code>\nIt only does it for one cell, I am trying to do it for the entire column, is there any way to do this. \nMy end goal is something like this:</p>\n\n<pre><code>=OR($E$3&gt;$H$3,$E$3&lt;$H$3)\n=OR($E$4&gt;$H$4,$E$4&lt;$H$4)\n=OR($E$5&gt;$H$5,$E$5&lt;$H$5)\n</code></pre>\n\n<p>and so on and so forth. About 500 cells. I don't want to write it all out like that. Any way to just write it once. Thank you</p>\n"}, {"tags": ["vba", "excel", "visio"], "comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1514995535, "post_id": 48080924, "comment_id": 83136042, "body": "Does your code work? If not, at what point does it seem to break? Please be specific when asking for help with existing code!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1514997642, "post_id": 48080924, "comment_id": 83137314, "body": "Looks like you&#39;re 99% there. Make the copy and paste operations two distinct instructions (i.e. remove that line continuation), and that could possibly work. If not, <a href=\"https://stackoverflow.com/posts/48080924/edit\">edit</a> your question to describe how it&#39;s failing, what error you&#39;re getting."}], "owner": {"reputation": 11, "user_id": 8507415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf93212066d5c2845a594f17c6a38b8?s=128&d=identicon&r=PG&f=1", "display_name": " Shadowcast", "link": "https://stackoverflow.com/users/8507415/shadowcast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514995453, "creation_date": 1514995418, "last_edit_date": 1514995453, "question_id": 48080924, "link": "https://stackoverflow.com/questions/48080924/copy-range-of-cells-to-visio-2013-using-vba-code", "title": "Copy Range of cells to Visio (2013) using VBA code", "body": "<p>I have an Excel range of cells (let's call it \"Table A\") and I would like to copy that Range/Table into Visio using VBA. </p>\n\n<p>Without VBA - I can copy the range in Excel, go to Visio - Insert - Chart - go to Sheet1 tab - Paste</p>\n\n<p>Using VBA - I am a novice so this is what I think it should look something like:</p>\n\n<pre><code>Set AppVisio = CreateObject(\"visio.Application\")\nAppVisio.Visible = True\n\nAppVisio.Documents.AddEx \"basicd_u.vst\", 0, 0\n        Worksheets(\"Sheet1\").Range(\"TABLEA\").Copy _\n        AppVisio.ActiveWindow.Page.Add.Paste\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1514994873, "post_id": 48080533, "comment_id": 83135679, "body": "Thank you @Jpad Limited the modified one worked perfectly, will you guide me how the FUNCTION part is exactly working here ?"}, {"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "reply_to_user": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 1, "creation_date": 1514994994, "post_id": 48080533, "comment_id": 83135751, "body": "Sure. You are taking the start row you want to put data in (should also be a constant) in this case 3. You are then running the function, and telling it what row to start on, and to put 4 country names in from that row. Then you increase the row start number by 5, then check the next checkbox. You are basically just storing the last row you wrote to, for next time"}, {"owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1515000162, "post_id": 48080533, "comment_id": 83138702, "body": "Thank you @ Jpad Limited . how to accomodate merge into this fields after performing this code ?  do we have to set the rage ? while performing each loop ? And or if i want to skip 1 or 2 Fields/rows before filling next values ?"}], "tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": true, "score": 3, "last_activity_date": 1515000474, "last_edit_date": 1515000474, "creation_date": 1514993928, "answer_id": 48080533, "question_id": 48080388, "link": "https://stackoverflow.com/questions/48080388/vba-seeking-help-in-code-modification/48080533#48080533", "title": "VBA: Seeking help in code modification", "body": "<p>I think that you want something more like the code below. This code could be further improved to be a function, into which you pass the name of the country and the current row, thus eliminating the duplicated code</p>\n\n<pre><code> Sub PopulateSheet()\n Dim lngCurrentRow As Long\n\n'start row\nlngCurrentRow = 3\n\nIf chkIndia Then\n\n    Sheet.Range(\"B\" &amp; lngCurrentRow &amp; \":B\" &amp; lngCurrentRow + 4) = \"India\"\n\n    lngCurrentRow = lngCurrentRow + 5\n\nEnd If\n\n If chkGermany Then\n\n    Sheet.Range(\"B\" &amp; lngCurrentRow &amp; \":B\" &amp; lngCurrentRow + 4) = \"Germany\"\n\n    lngCurrentRow = lngCurrentRow + 5\n\nEnd If\n\n\nIf chkHK Then\n\n    Sheet.Range(\"B\" &amp; lngCurrentRow &amp; \":B\" &amp; lngCurrentRow + 4) = \"Hong Kong\"\n\n    lngCurrentRow = lngCurrentRow + 5\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>UPDATED WITH FUNCTION:</p>\n\n<pre><code>Sub PopulateSheet()\nDim lngCurrentRow As Long\n\n'start row\nlngCurrentRow = 3\n\nIf chkIndia Then Call WriteOutput(\"India\", lngCurrentRow)\nIf chkGermany Then Call WriteOutput(\"Germany\", lngCurrentRow)\nIf chkHK Then Call WriteOutput(\"Hong Kong\", lngCurrentRow)\n\nEnd Sub\n\nFunction WriteOutput(strCountry As String, ByRef lngRowToWriteTo As Long)\n\nActiveSheet.Range(\"B\" &amp; lngRowToWriteTo &amp; \":B\" &amp; lngRowToWriteTo + 4) = strCountry\n\nlngRowToWriteTo = lngRowToWriteTo + 5\n\nEnd Function\n</code></pre>\n\n<p>You can then set the 4 to be a constant (number of times you want the country to appear in the sheet) and the 5 to be constant + 1</p>\n\n<p>UPDATED WITH CONSTANTS, this gives maximum flexibility:</p>\n\n<pre><code>    Private Const START_ROW As Long = 3\n    Private Const NUM_COUNTRY_ROWS As Long = 4\n    Private Const COLUMN_TO_WRITE_TO As String = \"B\"\n\n    Sub PopulateSheet()\n    Dim lngCurrentRow As Long\n\n        'start row\n        lngCurrentRow = START_ROW\n\n        If True Then Call WriteOutput(\"India\", lngCurrentRow)\n        If True Then Call WriteOutput(\"Germany\", lngCurrentRow)\n        If True Then Call WriteOutput(\"Hong Kong\", lngCurrentRow)\n\n    End Sub\n\n    Function WriteOutput(strCountry As String, ByRef lngRowToWriteTo As Long)\n\n        ActiveSheet.Range(COLUMN_TO_WRITE_TO &amp; lngRowToWriteTo &amp; \":\" &amp; COLUMN_TO_WRITE_TO &amp; lngRowToWriteTo + NUM_COUNTRY_ROWS) = strCountry\n\n        lngRowToWriteTo = lngRowToWriteTo + NUM_COUNTRY_ROWS + 1\n\n    End Function\n</code></pre>\n\n<p>UPDATED TO INCLUDE MERGE (note you now only need to write the country in once)</p>\n\n<pre><code>Private Const START_ROW As Long = 3\nPrivate Const NUM_COUNTRY_ROWS As Long = 4\nPrivate Const COLUMN_TO_WRITE_TO As String = \"B\"\n\nSub PopulateSheet()\nDim lngCurrentRow As Long\n\n    'start row\n    lngCurrentRow = START_ROW\n\n    If chkIndia Then Call WriteOutput(\"India\", lngCurrentRow)\n    If chkGermany Then Call WriteOutput(\"Germany\", lngCurrentRow)\n    If chkHK Then Call WriteOutput(\"Hong Kong\", lngCurrentRow)\n\nEnd Sub\n\nFunction WriteOutput(strCountry As String, ByRef lngRowToWriteTo As Long)\n\n    With ActiveSheet\n\n        .Range(COLUMN_TO_WRITE_TO &amp; lngRowToWriteTo) = strCountry\n\n        .Range(.Range(COLUMN_TO_WRITE_TO &amp; lngRowToWriteTo), .Range(COLUMN_TO_WRITE_TO &amp; lngRowToWriteTo + NUM_COUNTRY_ROWS)).Cells.Merge\n\n    End With\n\n    lngRowToWriteTo = lngRowToWriteTo + NUM_COUNTRY_ROWS + 1\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 1, "creation_date": 1514994764, "post_id": 48080582, "comment_id": 83135614, "body": "Thank you @David G."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 2, "last_activity_date": 1514994143, "creation_date": 1514994143, "answer_id": 48080582, "question_id": 48080388, "link": "https://stackoverflow.com/questions/48080388/vba-seeking-help-in-code-modification/48080582#48080582", "title": "VBA: Seeking help in code modification", "body": "<p>Instead of using <code>Do</code> use an <code>If</code> statement</p>\n\n<pre><code>Dim i As Integer\ni = 3\nIf UF1_Location_and_Role.CheckBox6.Value = True Then\n  Do While i &lt; 8\n    Cells(i, 2).Value = \"India\"\n    i = i + 1\n  Loop\nEnd If\n\nIf UF1_Location_and_Role.CheckBox7.Value = True Then\n  Do While i &lt; 13\n    Cells(i, 2).Value = \"Germany\"\n    i = i + 1\n  Loop\nEnd If \n\nIf UF1_Location_and_Role.CheckBox7.Value = True Then\n  Do While i &lt; 18\n    Cells(i, 2).Value = \"Hongkong\"\n    i = i + 1\n  Loop\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "edited": false, "score": 0, "creation_date": 1514995873, "post_id": 48080845, "comment_id": 83136257, "body": "...as long as there is no data in Column B underneath the data you are trying to put in.."}, {"owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1514998992, "post_id": 48080845, "comment_id": 83138066, "body": "Thank you @Dy.Lee. what should i do, if i want to merge those fields after performing this code ?"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1515000256, "last_edit_date": 1515000256, "creation_date": 1514995159, "answer_id": 48080845, "question_id": 48080388, "link": "https://stackoverflow.com/questions/48080388/vba-seeking-help-in-code-modification/48080845#48080845", "title": "VBA: Seeking help in code modification", "body": "<p>this is another method.</p>\n\n<pre><code>Sub test()\n    Dim rngT As Range\n    Dim rngDB() As Range, n As Integer, i As Integer\n\n    If UF1_Location_and_Role.CheckBox6.Value Then\n        Set rngT = Range(\"b\" &amp; Rows.Count).End(xlUp)(2)\n        rngT.Resize(5) = \"India\"\n        n = n + 1\n        ReDim Preserve rngDB(1 To n)\n        Set rngDB(n) = rngT.Resize(5)\n    End If\n    If UF1_Location_and_Role.CheckBox7.Value Then\n        Set rngT = Range(\"b\" &amp; Rows.Count).End(xlUp)(2)\n        rngT.Resize(5) = \"Germany\"\n        n = n + 1\n        ReDim Preserve rngDB(1 To n)\n        Set rngDB(n) = rngT.Resize(5)\n    End If\n    If UF1_Location_and_Role.CheckBox8.Value Then\n        Set rngT = Range(\"b\" &amp; Rows.Count).End(xlUp)(2)\n        rngT.Resize(5) = \"Hongkong\"\n        n = n + 1\n        ReDim Preserve rngDB(1 To n)\n        Set rngDB(n) = rngT.Resize(5)\n    End If\n    Application.DisplayAlerts = False\n    For i = 1 To n\n        rngDB(i).Merge\n    Next i\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 48080533, "answer_count": 3, "score": 1, "last_activity_date": 1515021226, "creation_date": 1514993352, "last_edit_date": 1515021226, "question_id": 48080388, "link": "https://stackoverflow.com/questions/48080388/vba-seeking-help-in-code-modification", "title": "VBA: Seeking help in code modification", "body": "<p>I am a VBA learner, and I am trying to build a VBA project for improving my knowledge. There is a slight confusion on how to populate different data(based on some condition) to a set of same field.</p>\n\n<p>I have 3 scenarios:</p>\n\n<p>Scenario 1: User select all the checkbox<br>\nScenario 2: User select only 1 or 2 checkbox<br>\nScenario 3: User not selecting anything  </p>\n\n<p>My code will work perfectly with scenarios 1 and 3 but not able to figure it out how to accomplish scenario 2.</p>\n\n<p>My expectation is to populate the values from Cell B3 to B17 based on what user selects when Userform pop up to him. If he selects only 1 field corresponding values should be populated from B3 \u2013 B8, if he selects 2 checkboxes then the 1st corresponding value will be populated from B3 \u2013 B8 and 2nd set from B9 \u2013 B14 and so on.  Please find the images below for better understanding </p>\n\n<p><strong>Userform</strong><br>\n<a href=\"https://i.stack.imgur.com/ogSc5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ogSc5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Example of Scenario 1</strong><br>\n<a href=\"https://i.stack.imgur.com/SuO3n.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SuO3n.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Example of Scenario 3</strong><br>\n<a href=\"https://i.stack.imgur.com/IuK9i.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IuK9i.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>VBA Code</strong>  </p>\n\n<pre><code>Dim i As Integer\ni = 3\nDo While i &lt; 8 And UF1_Location_and_Role.CheckBox6.Value = True\n    Cells(i, 2).Value = \"India\"\n    i = i + 1\nLoop\n\nDo While i &lt; 13 And UF1_Location_and_Role.CheckBox7.Value = True\n    Cells(i, 2).Value = \"Germany\"\n    i = i + 1\nLoop\n\nDo While i &lt; 18 And UF1_Location_and_Role.CheckBox7.Value = True\n    Cells(i, 2).Value = \"Hongkong\"\n    i = i + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 3, "creation_date": 1514993253, "post_id": 48080290, "comment_id": 83134713, "body": "What does <code>, 31, False</code> in the <code>.Range</code> means?"}, {"owner": {"reputation": 25, "user_id": 9168335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155941763222068/picture?type=large", "display_name": "Antonio", "link": "https://stackoverflow.com/users/9168335/antonio"}, "edited": false, "score": 0, "creation_date": 1514993928, "post_id": 48080290, "comment_id": 83135121, "body": "It&#39;s outside the <code>.Range</code> part, the final two arguments for the <code>Vlookup</code>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1514994449, "post_id": 48080290, "comment_id": 83135442, "body": "<code>Workbooks(&quot;combine zslb and zpdi.xlsm.xlsm&quot;)</code> You have <code>.xlsm</code> written twice on here, will this cause an issue too? Also, on what line is there error occuring?"}, {"owner": {"reputation": 25, "user_id": 9168335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155941763222068/picture?type=large", "display_name": "Antonio", "link": "https://stackoverflow.com/users/9168335/antonio"}, "edited": false, "score": 0, "creation_date": 1514994880, "post_id": 48080290, "comment_id": 83135683, "body": "Oops, sorry about that, it&#39;s well written on the actual code, so that wasn&#39;t a problem. The error is on the <code>val=apllication.vlookup</code>... line"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1514995007, "post_id": 48080290, "comment_id": 83135756, "body": "Your unqualified Cells() calls will point to the activesheet, whatever that happens to be: if that&#39;s the wrong sheet you&#39;ll get an error.  Also, you should <code>Dim Val as Variant</code> to allow for the case where VLookup returns an error because there was no match."}, {"owner": {"reputation": 25, "user_id": 9168335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155941763222068/picture?type=large", "display_name": "Antonio", "link": "https://stackoverflow.com/users/9168335/antonio"}, "edited": false, "score": 0, "creation_date": 1514995362, "post_id": 48080290, "comment_id": 83135955, "body": "Okay, and could you tell me how can I make them point to the other workbook? That&#39;s precisely the part I&#39;m struggling with. Thanks."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1515000164, "post_id": 48080290, "comment_id": 83138705, "body": "You will find accessing worksheets much easier if you Dim references to each worksheet/workbook you&#39;re going to use. Also you could consider using Index/Match or Find/Offset functions rather than VLookups"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9168335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155941763222068/picture?type=large", "display_name": "Antonio", "link": "https://stackoverflow.com/users/9168335/antonio"}, "edited": false, "score": 0, "creation_date": 1515070817, "post_id": 48083826, "comment_id": 83166328, "body": "After a few tweaks, it Works! Thank you very much!  However, I do have a small question, it only works if the other Workbook is not open. How can I modify it so it works regardless of the &quot;openness&quot; of the other book? Thank you anyways!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1515088324, "last_edit_date": 1515088324, "creation_date": 1515007225, "answer_id": 48083826, "question_id": 48080290, "link": "https://stackoverflow.com/questions/48080290/cant-get-a-vlookup-to-reference-another-workbook/48083826#48083826", "title": "Can&#39;t get a VLookup to reference another workbook", "body": "<p>Untested but compiled:</p>\n\n<pre><code>Sub Add_Dates()\n\n    Const WB_PATH As String = \"C:\\(%)\\\"\n\n    Application.CutCopyMode = False\n\n    Dim LastZipRow As Long, LastCombRow As Long, col As Long, v\n    Dim wbComb As Workbook, wbZipe As Workbook, i As Long\n    Dim shtComb As Workbook, shtZipe As Workbook, rngLookup As Range\n\n    Set wbComb = GetWorkbook(WB_PATH, \"combine zslb and zpdi.xlsm\")\n    Set wbZipe = GetWorkbook(WB_PATH, \"zipe zpdi zslb.xlsx\")\n\n    Set shtComb = wbComb.Sheets(\"ZSLB\")\n    Set shtZipe = wbZipe.Sheets(\"ZSLB\")\n\n    LastCombRow = shtComb.Range(\"A1\").End(xlDown).Row\n    LastZipRow = shtZipe.SpecialCells(xlLastCell).Row\n    col = shtComb.Range(\"A2\").End(xlToRight).Column\n\n    Set rngLookup = shtZipe.Range(shtZipe.Cells(2, 1), _\n                                  shtZipe.Cells(LastZipRow, 31))\n\n    For i = 2 To LastCombRow\n        v = Application.VLookup(shtComb.Cells(i, 1), rngLookup, 31, False)\n        shtComb.Cells(i, col).Value = IIf(IsError(v), \"???\", v)\n    Next i\n\nEnd Sub\n\n'return a reference to an already-open file, or if not open then open it\nFunction GetWorkbook(wbPath, wbName) As Workbook\n    Dim rv As Workbook\n    If Right(wbPath, 1) &lt;&gt; \"\\\" Then wbPath = wbPath &amp; \"\\\"\n    On Error Resume Next '&lt;&lt; ignore error if file not open\n    Set rv = Workbooks(wbName)\n    On Error GoTo 0\n    'note there's no error handling here to account for \"file not found\"\n    If rv Is Nothing Then Set rv = Workbooks.Open(wbPath &amp; wbName)\n    Set GetWorkbook = rv\nEnd Function\n</code></pre>\n\n<p>Note - in your constants you're using a \"1\" and not \"l\" - e.g. <code>x1Down</code>.  </p>\n"}], "owner": {"reputation": 25, "user_id": 9168335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155941763222068/picture?type=large", "display_name": "Antonio", "link": "https://stackoverflow.com/users/9168335/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 1, "accepted_answer_id": 48083826, "answer_count": 1, "score": 1, "last_activity_date": 1515088324, "creation_date": 1514992976, "last_edit_date": 1531164843, "question_id": 48080290, "link": "https://stackoverflow.com/questions/48080290/cant-get-a-vlookup-to-reference-another-workbook", "title": "Can&#39;t get a VLookup to reference another workbook", "body": "<p>So I'm relatively new to VBA and I'm trying to get a Vlookup to return a value searching on another workbook. The thing is, i keep getting the classic </p>\n\n<blockquote>\n  <p>1004 error</p>\n</blockquote>\n\n<p>on the line of the Vlookup. I'm just trying to search for a number on the current workbook and find it on another one, returning the date associated to it, but it doesn't give me anything</p>\n\n<p>I've seen many people asking stuff like this, but haven't seen the answer to my specififc problema, which I guess is common among beginners. So, any help on how to make a better code, besides the actual solution to my problema is appreciated.</p>\n\n<pre><code>Sub Add_Dates()\n\n    Application.CutCopyMode = False\n\n    Dim Lastzip As Integer, Val As Integer\n\n    'Open this workbook just in case it's not yet selected\n    Workbooks.Open (\"C:\\(%)\\combine zslb and zpdi.xlsm\")\n    LastRow = Range(\"A1\").End(x1Down).Row \n    'get the value for the last row\n\n    Workbooks.Open (\"C:\\(%)\\zipe zpdi zslb.xlsx\")\n    Sheets(\"ZSLB\").Activate\n    ActiveCell.SpecialCells(x1LastCell).Select\n    Lastzip = ActiveCell.Row\n    'Same, get the value of the last row of this wbk, \n    'which changes everyday, so can't be a fix value\n\n    Workbooks(\"combine zslb and zpdi.xlsm\").Sheets(\"zslb\").Activate\n    Range(\"A2\").End(x1ToRight).Select\n    col = Selection.Offset(0,1).Column\n\n    For i = 2 to LastRow\n        Val = Application.VLookup(Cells(i, 1), Workbooks(\"zipe zpdi zslb.xlsx\"). _\n            Sheets(\"ZSLB\").Range(Cells(2, 1), Cells(Lastzip, 31)), 31, False)\n        Cells(i, col).Value = Val\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "matrix"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1514995204, "post_id": 48080273, "comment_id": 83135855, "body": "Try using conditional formatting"}, {"owner": {"reputation": 45, "user_id": 6563155, "user_type": "registered", "profile_image": "https://graph.facebook.com/1754291824842417/picture?type=large", "display_name": "Julio Moreno", "link": "https://stackoverflow.com/users/6563155/julio-moreno"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515000746, "post_id": 48080273, "comment_id": 83139027, "body": "@TimWilliams yep this is what I want but my question is if it is possible by ussing vba"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515005341, "post_id": 48080273, "comment_id": 83141369, "body": "Yes it is - you can record a macro while adding the CF and use the resulting code"}], "owner": {"reputation": 45, "user_id": 6563155, "user_type": "registered", "profile_image": "https://graph.facebook.com/1754291824842417/picture?type=large", "display_name": "Julio Moreno", "link": "https://stackoverflow.com/users/6563155/julio-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1515000808, "creation_date": 1514992928, "last_edit_date": 1515000808, "question_id": 48080273, "link": "https://stackoverflow.com/questions/48080273/heat-correlation-matrix-vba", "title": "Heat correlation matrix VBA", "body": "<p>I have created a functon to return matrix correlation of a data set, but I want this matrix to have colors like the one you can do using R o Python</p>\n\n<p><a href=\"https://i.stack.imgur.com/GgTJe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GgTJe.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Function MCORRELATION(Rango As Range) As Variant\n Dim x As Variant, y As Variant, s As Integer, T As Integer, C() As Variant\n ReDim C(Rango.Columns.Count, Rango.Columns.Count)\n For i = 1 To Rango.Columns.Count Step 1\n  For j = 1 To i Step 1\n  C(i, j) = Application.Correl(Application.Index(Rango, , i), \n   Application.Index(Rango, , j))\n Next j\nNext i\n MCORRELATION = C\nEnd Function\n</code></pre>\n\n<p>How can I achieve that <strong>using conditional formating with VBA</strong>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 719, "user_id": 6194785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/9N6BG.png?s=128&g=1", "display_name": "j.seashell", "link": "https://stackoverflow.com/users/6194785/j-seashell"}, "edited": false, "score": 1, "creation_date": 1514992833, "post_id": 48080219, "comment_id": 83134465, "body": "See if your online questionaire can export to a file format called CSV"}], "answers": [{"tags": [], "owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "is_accepted": false, "score": 0, "last_activity_date": 1514994556, "last_edit_date": 1514994556, "creation_date": 1514994016, "answer_id": 48080557, "question_id": 48080219, "link": "https://stackoverflow.com/questions/48080219/assigning-ranks-to-items-that-vary-in-order/48080557#48080557", "title": "Assigning ranks to items that vary in order", "body": "<p>Assuming 1st column starts at A2 and second column at B2 use this formula in C2 copied down</p>\n\n<p><code>=MATCH(A2,OFFSET(B$2,6*INT((ROWS(C$2:C2)-1)/6),0,6),0)</code></p>\n\n<p><code>OFFSET</code> returns the 6 cell range required and <code>MATCH</code> finds the position of the relevant item within that</p>\n\n<p>See screenshot below</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pc4yP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pc4yP.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9168660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_siBaXCdcEA/AAAAAAAAAAI/AAAAAAAAIA4/tUSCl-gFKJM/photo.jpg?sz=128", "display_name": "Juan Arroyo Flores", "link": "https://stackoverflow.com/users/9168660/juan-arroyo-flores"}, "edited": false, "score": 0, "creation_date": 1514999977, "post_id": 48080640, "comment_id": 83138590, "body": "Awesome! Thank you so much, this works. My partner and I were trying different formulas all night using vlookup mod and other stuff to no avail. :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1514994359, "creation_date": 1514994359, "answer_id": 48080640, "question_id": 48080219, "link": "https://stackoverflow.com/questions/48080219/assigning-ranks-to-items-that-vary-in-order/48080640#48080640", "title": "Assigning ranks to items that vary in order", "body": "<p>You can use this non volatile function:</p>\n\n<pre><code>=MATCH(A2,INDEX(B:B,INT((ROW(1:1)-1)/6)*6+2):INDEX(B:B,INT((ROW(1:1)-1)/6)*6+7),0)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OCBja.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OCBja.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9168660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_siBaXCdcEA/AAAAAAAAAAI/AAAAAAAAIA4/tUSCl-gFKJM/photo.jpg?sz=128", "display_name": "Juan Arroyo Flores", "link": "https://stackoverflow.com/users/9168660/juan-arroyo-flores"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 48080640, "answer_count": 2, "score": 0, "last_activity_date": 1514994556, "creation_date": 1514992747, "last_edit_date": 1531161705, "question_id": 48080219, "link": "https://stackoverflow.com/questions/48080219/assigning-ranks-to-items-that-vary-in-order", "title": "Assigning ranks to items that vary in order", "body": "<p>I am trying to build a dataset from an online questionnaire. In this questionnaire, participants were asked to name 6 items. These items are represented with numbers from 1 to 6 (order of mention does not matter). Afterwards, participants were asked to rank those items from most important to least important (order here matters). Right now I have three columns \"Named items\", \"Item ranked\" and \"Rank.\" The last column represents the position at which each case was ranked at. Thus, the idea would be to look at the number in the first column \"Named item\" and search for its position on the second column \"Items Ranked\" and return its position to the third column corresponding row. </p>\n\n<p>Since the numbers go from 1 to 6, every six rows the process has to start again on the 7th row. I have a total of 186 participants, which means there's a total of 1116 items. What would be the most efficient way of doing this and preventing human error? </p>\n\n<p>Here is an example of how the sheet looks like done manually:</p>\n\n<pre><code>+----------------------+-----------------------------+------+\n| Order of named items | Items ranked (# = Identity) | Rank |\n+----------------------+-----------------------------+------+\n|                    1 |                           2 |    4 |\n|                    2 |                           5 |    1 |\n|                    3 |                           6 |    6 |\n|                    4 |                           1 |    5 |\n|                    5 |                           4 |    2 |\n|                    6 |                           3 |    3 |\n|                    1 |                           1 |    1 |\n|                    2 |                           2 |    2 |\n|                    3 |                           3 |    3 |\n|                    4 |                           4 |    4 |\n|                    5 |                           5 |    5 |\n|                    6 |                           6 |    6 |\n|                    1 |                           1 |    1 |\n|                    2 |                           2 |    2 |\n|                    3 |                           3 |    3 |\n|                    4 |                           4 |    4 |\n|                    5 |                           5 |    5 |\n|                    6 |                           6 |    6 |\n|                    1 |                           5 |    3 |\n|                    2 |                           6 |    4 |\n|                    3 |                           1 |    5 |\n|                    4 |                           2 |    6 |\n|                    5 |                           3 |    1 |\n|                    6 |                           4 |    2 |\n|                    1 |                           2 |    2 |\n|                    2 |                           1 |    1 |\n|                    3 |                           6 |    4 |\n|                    4 |                           3 |    5 |\n|                    5 |                           4 |    6 |\n|                    6 |                           5 |    3 |\n+----------------------+-----------------------------+------+\n</code></pre>\n"}, {"tags": ["vba", "performance", "excel", "re-engineering"], "comments": [{"owner": {"reputation": 695, "user_id": 6888293, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4b8412d9152b2361fd0e05a87d8647ec?s=128&d=identicon&r=PG&f=1", "display_name": "TheOni", "link": "https://stackoverflow.com/users/6888293/theoni"}, "edited": false, "score": 1, "creation_date": 1514991708, "post_id": 48079894, "comment_id": 83133734, "body": "performance are not only limited by CPU, you could be limited by memory usage/availability or by disk IOWait"}, {"owner": {"reputation": 768, "user_id": 1195482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b87b51e4e584a8b990895aaa0361fe?s=128&d=identicon&r=PG", "display_name": "dwilliss", "link": "https://stackoverflow.com/users/1195482/dwilliss"}, "edited": false, "score": 4, "creation_date": 1514991717, "post_id": 48079894, "comment_id": 83133739, "body": "How many cores on your CPU?  If the function is not multi-threaded, then it can only utilize at most 100% of one core.  If there&#39;s IO involved (writing to disk), then the CPU will be idle while waiting for IO"}, {"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1514992247, "post_id": 48079894, "comment_id": 83134098, "body": "regards, How can I made my procedure multi-threaded to using 100% of overall CPU utilization in VBA? Point is seems the code is not IO involved. Please visit my code."}, {"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1514992320, "post_id": 48079894, "comment_id": 83134142, "body": "My CPU has 2 cores."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "reply_to_user": {"reputation": 768, "user_id": 1195482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b87b51e4e584a8b990895aaa0361fe?s=128&d=identicon&r=PG", "display_name": "dwilliss", "link": "https://stackoverflow.com/users/1195482/dwilliss"}, "edited": false, "score": 4, "creation_date": 1514994558, "post_id": 48079894, "comment_id": 83135498, "body": "Adding to @dwilliss observation - Pure VBA works in single-thread unless you use some com objects written in languages that can support multi-threading."}, {"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1514997088, "post_id": 48079894, "comment_id": 83136965, "body": "Related discussion: <a href=\"https://stackoverflow.com/q/5721564/9075944\">stackoverflow.com/q/</a>"}], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 1, "creation_date": 1515342890, "post_id": 48080952, "comment_id": 83255982, "body": "Your answer really is a comment."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "edited": false, "score": 0, "creation_date": 1515392779, "post_id": 48080952, "comment_id": 83268488, "body": "I find the difference between an answer and a comment isn&#39;t always that clear-cut. I posted this as an answer because there seemed to be discussion about whether or not VBA is mulit-threaded. IMO the thread needed a clear answer on that."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": -2, "last_activity_date": 1515037447, "last_edit_date": 1515037447, "creation_date": 1514995511, "answer_id": 48080952, "question_id": 48079894, "link": "https://stackoverflow.com/questions/48079894/relation-between-running-a-program-faster-and-cpu-usage/48080952#48080952", "title": "Relation between Running a program faster and CPU usage", "body": "<p>VBA is single-threaded, so it will always use only a single core.</p>\n"}], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515037447, "creation_date": 1514991530, "last_edit_date": 1531164843, "question_id": 48079894, "link": "https://stackoverflow.com/questions/48079894/relation-between-running-a-program-faster-and-cpu-usage", "title": "Relation between Running a program faster and CPU usage", "body": "<p>I'm using the code which indicated in the <a href=\"https://stackoverflow.com/a/48060961/9075944\">stackoverflow.com/a</a> reference.</p>\n\n<p>As I was commented, the above procedure included a <code>For Next</code> which needs more times repeat.</p>\n\n<p>The performance is low while:</p>\n\n<p>(I was monitored the Task Manager's, Performance tab (CPU utilization) and the processes tab together.)</p>\n\n<p>The overall CPU usage is -approximately- lower than 25%.</p>\n\n<p>Why the running procedure have not using more CPU resources to increase performance and running faster?</p>\n\n<p>Is it possible for us to perform consuming more CPU usage (100%) for increase the running software performance?</p>\n\n<p>Any guides are appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1514989017, "post_id": 48079098, "comment_id": 83132142, "body": "Can you screenshot what the sheet looks like? This should be relatively simple, but I would like to see what exactly you are expecting first. This actually sounds like you can  just use formulas."}, {"owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1514996322, "post_id": 48079098, "comment_id": 83136524, "body": "Here&#39;s the screenshot: <a href=\"https://i.stack.imgur.com/phMlC.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/phMlC.png</a> I&#39;ve edited the OP to contain a bit more info."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514990535, "post_id": 48079266, "comment_id": 83133004, "body": "Perhaps explain that this cryptic <code>[a1:c6]</code> notation is shorthand code for <code>Application.Evaluate(&quot;A1:C6&quot;)</code>, which is kind of a roundabout and inefficient way to refer to <code>ActiveSheet.Range(&quot;A1:C6&quot;)</code>?"}, {"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1514990726, "post_id": 48079266, "comment_id": 83133127, "body": "What I only know is It&#39;s an efficient way for me to type on a smartphone :) also if you read that it can be SET to a Range variable you&#39;ll know that the notation evaluates as a range object"}, {"owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "edited": false, "score": 0, "creation_date": 1514994033, "post_id": 48079266, "comment_id": 83135183, "body": "Thanks for the response! I haven&#39;t used a 2d array before, can the If Then Else get values/dates from this? I was also wondering if it were easier to just use an Autofilter to filter for the dates before today, that would exclude blank cells and I wouldn&#39;t need a 3rd column."}, {"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "edited": false, "score": 0, "creation_date": 1514995540, "post_id": 48079266, "comment_id": 83136048, "body": "Of course! After you put x/y indices to an array it would act like an ordinary variable. Try changing all &quot;cells&quot; collection reference to &quot;usedrange.cells&quot;, because &quot;cells&quot; means all cells of the sheet, but usedrange.cells doesn&#39;t include cells that are beyond the sheet&#39;s &quot;last cell&quot;, see if it&#39;s faster"}, {"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "edited": false, "score": 0, "creation_date": 1514995654, "post_id": 48079266, "comment_id": 83136117, "body": "Try to open a sheet with that 25000 rows, and try &quot;msgbox cells.count&quot; and &quot;msgbox usedrange.cells.count&quot;, you&#39;ll see what I mean"}, {"owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "edited": false, "score": 0, "creation_date": 1514996481, "post_id": 48079266, "comment_id": 83136616, "body": "Wow, it really is a lot faster, but unfortunately it&#39;s still slow. Manually filtering dates before today end writing Expired into the last column is still a lot faster. I&#39;ve also noticed that &quot;status&quot; does not update as the Macro goes. To be honest, I started looking into filtering as that seems to be an easier solution, I feel like I&#39;ve overcomplicated this a bit. I&#39;ve edited the OP, I think you&#39;ll see what I mean."}, {"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "edited": false, "score": 0, "creation_date": 1514997034, "post_id": 48079266, "comment_id": 83136922, "body": "Is it that your problem is you don&#39;t know how to programmatically do the auto filter? Use the macro recorder, you can get the corresponding VBA code"}, {"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "edited": false, "score": 0, "creation_date": 1514997431, "post_id": 48079266, "comment_id": 83137175, "body": "If your concern is the hardcoding of the cell address, try using the list object. Select the table including the column names and press CTRL-T, and check &quot;has column names&quot;, to create a list object. Then you can refer to entire columns using column names. I&#39;m not at my computer so I&#39;m not able to show you codings, unfortunately. I&#39;ll do so at a convenient time"}, {"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "edited": false, "score": 0, "creation_date": 1514998995, "post_id": 48079266, "comment_id": 83138067, "body": "You don&#39;t need to use activate () and select () and then read Selection, it&#39;s a performance killer for scalability (unless you only call it just a few times). You should use &quot;dim r as range : set r = .find(...)&quot; And then get the value you want using e.g. &quot;r.cells(n, 1)&quot;. Also, using &quot;application.screenupdating = false&quot; will make things a bit faster. Set it back to true when you&#39;re done"}, {"owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "edited": false, "score": 0, "creation_date": 1515002656, "post_id": 48079266, "comment_id": 83139991, "body": "Thanks for all these, I&#39;ll have a look at them tomorrow on my work computer. I realised that I originally used the IF function that is why I needed the &quot;status&quot; variable. However, now that I&#39;m using if-then-else I only need to change the entries in the Status text column to &quot;Expired&quot; if the date is before today and nothing else needs to be done with entries where the date is after today."}], "tags": [], "owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "is_accepted": false, "score": 1, "last_activity_date": 1514990810, "last_edit_date": 1514990810, "creation_date": 1514989484, "answer_id": 48079266, "question_id": 48079098, "link": "https://stackoverflow.com/questions/48079098/how-can-i-loop-2-or-more-changing-variables-without-selection-in-vba/48079266#48079266", "title": "How can I loop 2 or more changing variables without Selection in VBA?", "body": "<p>You can grab all the values of a range object to a 2d array variable, and you work on the array instead. It is WAY MUCH faster</p>\n\n<p>E.g. let's say you have many different values in the range a1:c6, you need to loop thru the values</p>\n\n<pre><code>Dim var2d As Variant, r As Range\nSet r = ActiveSheet.Range(\"A1:C6\")\nvar2d = r   ' var2d becomes a 6x3 array\nMsgbox var2d(2,1) ' print value of cell A2\nvar2d(3,2) = \"Expired\"\nvar2d(5,1) = 123\nr.Value = var2d  ' write the modified array back to a1:c6\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "edited": false, "score": 0, "creation_date": 1515051029, "post_id": 48079459, "comment_id": 83155468, "body": "I went with another solution, but thanks for the help, much appreciated!"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1514990106, "creation_date": 1514990106, "answer_id": 48079459, "question_id": 48079098, "link": "https://stackoverflow.com/questions/48079098/how-can-i-loop-2-or-more-changing-variables-without-selection-in-vba/48079459#48079459", "title": "How can I loop 2 or more changing variables without Selection in VBA?", "body": "<p>You could do something like this</p>\n\n<pre><code>Dim status As String\nDim exp As Date\nDim i As Integer\nDim n As Integer\nDim m As Integer\n\nDim c As Range, d As Range\n\ni = 0\nn = 1\nstatus = 1\nm = 1\n\nWith ActiveSheet\n    Set d = .Range(\"A1\")\n    Do While status &lt;&gt; \"\"\n        Set c = .Cells.Find(what:=\"A\", after:=d, LookIn:=xlFormulas _\n                , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                MatchCase:=False, SearchFormat:=False)\n        If Not c Is Nothing Then\n            exp = c.Offset(n, 0).Value2\n            Set d = .Cells.Find(what:=\"B\", after:=c.Offset(n, 0), LookIn:=xlFormulas _\n                    , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n            If Not d Is Nothing Then\n                With d.Offset(m + i, -1)\n                    .Select\n                    status = .Value2\n                    MsgBox status\n\n                    If exp &lt;&gt; 0 And exp &lt; Date Then\n                        .Value2 = \"Expired\"\n                    Else\n                        .Value2 = status\n                    End If\n                End With\n            End If\n        End If\n\n        i = i - 1\n        n = n + 1\n        m = m + 1\n    Loop\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "edited": false, "score": 0, "creation_date": 1515049112, "post_id": 48090038, "comment_id": 83154660, "body": "to write value back to the listobject (e.g. write to status text): lo.ListRows(1).Range.cells(POS_STATUSTEXT) = &quot;Expired&quot;"}, {"owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "edited": false, "score": 0, "creation_date": 1515051003, "post_id": 48090038, "comment_id": 83155450, "body": "Thank you very much, this seems to be it. I&#39;ll have to work with it a bit as it&#39;s a bit above my head right now, but the help is much appreciated!"}], "tags": [], "owner": {"reputation": 987, "user_id": 214728, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/goOaE.jpg?s=128&g=1", "display_name": "im_chc", "link": "https://stackoverflow.com/users/214728/im-chc"}, "is_accepted": true, "score": 0, "last_activity_date": 1515048436, "creation_date": 1515048436, "answer_id": 48090038, "question_id": 48079098, "link": "https://stackoverflow.com/questions/48079098/how-can-i-loop-2-or-more-changing-variables-without-selection-in-vba/48090038#48090038", "title": "How can I loop 2 or more changing variables without Selection in VBA?", "body": "<p>I've come up with some codings that is more suitable to the case you presented:</p>\n\n<p>It will set up some testing data on a new workbook, and no column address is hardcoded.</p>\n\n<p>It will also shows how to create a listobject and refer to its various elements in an object oriented way and without hard-coding address</p>\n\n<p>Finally it uses the filter capability of the listobject to perform the filtering (it is more or less the same as the sheet-based autofilter)</p>\n\n<p>Run the Main() sub to start the demo.</p>\n\n<pre><code>Const COL_FRUIT As String = \"Fruit\", COL_FRESHUNTIL As String = \"Fresh Until\", COL_STATUSTEXT = \"Status text\"\nDim POS_FRUIT As Integer, POS_FRESHUNTIL As Integer, POS_STATUSTEXT As Integer\n\n\nSub Main()\n    Dim lo As ListObject\n    SetupData lo\n    lo.ListColumns(COL_FRUIT).Range.Select\n    MsgBox \"Fruit column\"\n\n    lo.ListRows(2).Range.Select\n    MsgBox \"2nd row\"\n\n    lo.ListColumns(COL_FRUIT).DataBodyRange.Select\n    MsgBox \"Fruit data\"\n\n    lo.Range.AutoFilter Field:=POS_FRESHUNTIL, Criteria1:= _\n        \"&lt;4/1/2018\", Operator:=xlAnd\n    lo.Range.AutoFilter Field:=POS_STATUSTEXT, Criteria1:= _\n        \"=*exp*\", Operator:=xlAnd\n\n    MsgBox \"Filter applied: \" &amp; vbCrLf &amp; _\n    \"Row 1 matched: \" &amp; (lo.ListRows(1).Range.Height &lt;&gt; 0) &amp; vbCrLf &amp; _\n    \"Row 2 matched: \" &amp; (lo.ListRows(2).Range.Height &lt;&gt; 0) &amp; vbCrLf &amp; _\n    \"Row 3 matched: \" &amp; (lo.ListRows(3).Range.Height &lt;&gt; 0)\nEnd Sub\nSub SetupData(ByRef ref_lo As ListObject)\n    Dim newwb As Workbook, currsh As Worksheet, vData As Variant, rData As Range, lo As ListObject\n    Set newwb = Workbooks.Add\n    Set currsh = newwb.Worksheets(1)\n    Dim s As String\n    vData = [{\"Fruit\", \"Fresh Until\", \"Status text\"; \"Apple\",\"03-03-2018\",\"Fresh\";\"Apple\",\"03-12-2017\",\"Expired\";\"Apple\",\"03-12-2017\",\"Date over\"}]\n    POS_FRUIT = GetColPos(COL_FRUIT, vData)\n    POS_FRESHUNTIL = GetColPos(COL_FRESHUNTIL, vData)\n    POS_STATUSTEXT = GetColPos(COL_STATUSTEXT, vData)        \n\n    Set rData = currsh.Cells(1).Resize(UBound(vData, 1), UBound(vData, 2))\n    rData = vData\n    Set ref_lo = currsh.ListObjects.Add(xlSrcRange, rData, , xlYes)     ' or ListObjects(\"name_of_your_listobject\")        \n\nEnd Sub\n\nFunction GetColPos(sCol As String, data As Variant) As Integer\n    Dim ifr As Integer, ito As Integer, i As Integer\n    ito = UBound(data, 2)\n    ifr = LBound(data, 2)\n    For i = ifr To ito\n        If sCol = data(LBound(data, 1), i) Then\n            GetColPos = i\n            Exit Function\n        End If\n    Next\n\n     GetColPos = -1\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9168471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f703cdea059fb1cc3c5abb36760c030e?s=128&d=identicon&r=PG&f=1", "display_name": "rekesz", "link": "https://stackoverflow.com/users/9168471/rekesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48090038, "answer_count": 3, "score": 0, "last_activity_date": 1515048436, "creation_date": 1514988809, "last_edit_date": 1514994641, "question_id": 48079098, "link": "https://stackoverflow.com/questions/48079098/how-can-i-loop-2-or-more-changing-variables-without-selection-in-vba", "title": "How can I loop 2 or more changing variables without Selection in VBA?", "body": "<p>I'm having a hard time solving a problem. I've just recently started coding and I would like to create a macro that checks 3 variables (1 for date and 2 for position) without using the Selection function. </p>\n\n<p>What I'm trying to achieve is to have a cell that checks 1 cell with a date (A) to determine if the date is before today and if the cell is not blank. It would either write \"Expired\" (if the date is before today) or the text in the cell to the left. </p>\n\n<p>It would then move on to the below cells and do this again. Even though this works, it is very slow and I was wondering if there was any other method I could use to speed this up (at 8000 lines this is really not worth it). Maybe use a filter?</p>\n\n<p>Any help is much appreciated!</p>\n\n<pre><code>Dim status As String\nDim exp As Date\nDim i As Integer\nDim n As Integer\nDim m As Integer\n\n\ni = 0\nn = 1\nstatus = 1\nm = 1\n\nDo While status &lt;&gt; \"\"\n\n    Cells.Find(What:=\"A\", After:=ActiveCell, LookIn:=xlFormulas _\n        , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n    ActiveCell.Offset(n, 0).Select\n\n    exp = Selection\n\n    Cells.Find(What:=\"B\", After:=ActiveCell, LookIn:=xlFormulas _\n        , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n\n   ActiveCell.Offset(m, 0).Select\n\n\n\n    status = ActiveCell.Offset(i, -1).Value\n\n    MsgBox (status)\n\n    If exp &lt;&gt; 0 And exp &lt; Date Then\n        ActiveCell.FormulaR1C1 = \"Expired\"\n    Else\n        ActiveCell.FormulaR1C1 = status\n    End If\n\n    i = i - 1\n    n = n + 1\n    m = m + 1\n\nLoop\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/phMlC.png\" rel=\"nofollow noreferrer\">Example</a></p>\n\n<p>EDIT: I think this more or less shows what I would like to do in a simple way. The aim is to only change the Status text when the date is before today. However, there could be additional columns (like Amount) so I would like to avoid static ranges and in case of 25000 rows the selection method is VERRRY slow. I do feel like I've overcomplicated this a bit with the do while.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "edited": false, "score": 0, "creation_date": 1514989947, "post_id": 48079079, "comment_id": 83132652, "body": "Thank you for the quick and easy solution!"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 3, "last_activity_date": 1514988725, "creation_date": 1514988725, "answer_id": 48079079, "question_id": 48078964, "link": "https://stackoverflow.com/questions/48078964/how-can-i-format-the-week-as-a-2-digit-number-even-if-it-contains-a-0-01-02-et/48079079#48079079", "title": "How can I format the week as a 2 digit number even if it contains a 0 (01, 02 etc.)", "body": "<p>Format it once again.</p>\n\n<pre><code>Format(Format(Date, \"ww\"), \"0#\")\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48079079, "answer_count": 1, "score": 0, "last_activity_date": 1514989794, "creation_date": 1514988265, "last_edit_date": 1514989794, "question_id": 48078964, "link": "https://stackoverflow.com/questions/48078964/how-can-i-format-the-week-as-a-2-digit-number-even-if-it-contains-a-0-01-02-et", "title": "How can I format the week as a 2 digit number even if it contains a 0 (01, 02 etc.)", "body": "<p>This is the code I currently have:    </p>\n\n<pre><code>txtWeek = Format(Date, \"ww\")\n</code></pre>\n\n<p>What code can I add so that when I print \"txtweek\" it shows up as two digits so for the current date as Week 01.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1514988234, "post_id": 48078935, "comment_id": 83131711, "body": "You would need to create a new array, loop through the first and put the values where you want them."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1514988675, "post_id": 48078935, "comment_id": 83131929, "body": "Resizing the array will always happen at the end. There is no way to manipulate it from the middle unless you want to transfer the data into other array"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1514988482, "post_id": 48078992, "comment_id": 83131831, "body": "That&#39;s not strictly true."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1514988592, "post_id": 48078992, "comment_id": 83131887, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/redim-statement\" rel=\"nofollow noreferrer\"><code>ReDim</code></a>"}], "tags": [], "owner": {"reputation": 9, "user_id": 5815440, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XWrO7nVHud0/AAAAAAAAAAI/AAAAAAAAA4E/xNCrPzjHiEc/photo.jpg?sz=128", "display_name": "loki", "link": "https://stackoverflow.com/users/5815440/loki"}, "is_accepted": false, "score": 0, "last_activity_date": 1514988373, "creation_date": 1514988373, "answer_id": 48078992, "question_id": 48078935, "link": "https://stackoverflow.com/questions/48078935/how-to-add-a-column-in-between-an-array-in-vba/48078992#48078992", "title": "How to add a column in between an array in vba", "body": "<p>Sorry But you can't change the size of the array once created in VBA</p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 0, "last_activity_date": 1514997905, "creation_date": 1514997905, "answer_id": 48081598, "question_id": 48078935, "link": "https://stackoverflow.com/questions/48078935/how-to-add-a-column-in-between-an-array-in-vba/48081598#48081598", "title": "How to add a column in between an array in vba", "body": "<p>If you have used dynamic arrays, you can resize them.</p>\n\n<pre><code>Sub test()\n    Dim Myarray() '&lt;~~dynamic array :Dim Myarray(1 to 340, 1 to 50) &lt;~~static array\n\n    ReDim Myarray(1 To 340, 1 To 50)\n\n    Myarray(340, 50) = \"a\"\n\n    ReDim Preserve Myarray(1 To 340, 1 To 53)\n\n    MsgBox Myarray(340, 50)\n    MsgBox UBound(Myarray, 2)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9152933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09c3f72812e1482dab24c1b21777b347?s=128&d=identicon&r=PG", "display_name": "user9152933", "link": "https://stackoverflow.com/users/9152933/user9152933"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1040, "favorite_count": 0, "accepted_answer_id": 48081598, "answer_count": 2, "score": 0, "last_activity_date": 1514997905, "creation_date": 1514988152, "last_edit_date": 1531164843, "question_id": 48078935, "link": "https://stackoverflow.com/questions/48078935/how-to-add-a-column-in-between-an-array-in-vba", "title": "How to add a column in between an array in vba", "body": "<p>I've an 2d array named Myarray(1:340,1:50). I want to resize it to 1:340, 1:53. How can I add the column between the array and not at the end of it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1514988051, "post_id": 48078886, "comment_id": 83131615, "body": "What is wrong with your code? What happens or doesn&#39;t happen? Are there errors?"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1514988189, "post_id": 48078886, "comment_id": 83131683, "body": "You are also copying (the entire sheet(s)!) but never paste."}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1514988219, "post_id": 48078886, "comment_id": 83131699, "body": "You should avoid using <code>Activate</code> to switch between workbooks. Instead, refer to sheets on that workbook explicitly: <code>Set sourceSheet = wb.Worksheets(&quot;Sheet1&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514988621, "post_id": 48078927, "comment_id": 83131903, "body": "I&#39;ve downvoted because you haven&#39;t even told OP where to activate a workbook, let alone why they need to do that. Note that OP did already try to activate a workbook towards the end of their code but used the wrong syntax in their <code>Workbooks()</code> call -- something you haven&#39;t even touched upon"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514988662, "post_id": 48078927, "comment_id": 83131924, "body": "OP is calling Activate on the sheet object, not the workbook."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514988887, "post_id": 48078927, "comment_id": 83132047, "body": "With your advice above OP might change their code to <code>Workbooks(&quot;C:\\Users\\me\\Desktop\\folder\\sheet1.xls&quot;).Activate</code>. Also broken. You don&#39;t need to point anything out to me, I am more than capable of seeing what&#39;s wrong with OPs code, I&#39;m just telling you that this is not sufficient for OP. If you&#39;re here to help, you&#39;ll post more than two sentences as answers."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514988964, "post_id": 48078927, "comment_id": 83132098, "body": "Why don&#39;t you post an answer then?  Bizarre."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1514990117, "post_id": 48078927, "comment_id": 83132758, "body": "@CallumDA: <a href=\"http://i0.kym-cdn.com/photos/images/newsfeed/000/488/486/8c0.png\" rel=\"nofollow noreferrer\">i0.kym-cdn.com/photos/images/newsfeed/000/488/486/8c0.png</a>"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": -1, "last_activity_date": 1514988181, "last_edit_date": 1514988181, "creation_date": 1514988125, "answer_id": 48078927, "question_id": 48078886, "link": "https://stackoverflow.com/questions/48078886/how-to-switch-between-workbooks/48078927#48078927", "title": "How to switch between workbooks", "body": "<p>There is a Workbook.Activate method as well as Worksheet.  Try activating the workbook before activating sheets within that workbook.</p>\n"}], "owner": {"reputation": 108, "user_id": 8376430, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6c73440e80e4e16ab6ad1f9b3e62bca0?s=128&d=identicon&r=PG&f=1", "display_name": "RafMil", "link": "https://stackoverflow.com/users/8376430/rafmil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557377764, "creation_date": 1514987965, "last_edit_date": 1531164843, "question_id": 48078886, "link": "https://stackoverflow.com/questions/48078886/how-to-switch-between-workbooks", "title": "How to switch between workbooks", "body": "<p>I have problem with switching between workbooks. Could you take a look at code and say what is wrong with attitude to problem which i am trying? Or propose some other way to do this.</p>\n\n<pre><code>Sub copy_spreadsheets()\n\nDim wb As Workbook, wb_main As Workbook, path As String, sheet_name As String, x As Integer, i As Integer, source_sheet As Worksheet, ws As Worksheet\n\npath = \"C:\\Users\\me\\Desktop\\folder\\\"\nSet wb_main = ThisWorkbook\nFor x = 2 To 10\ni = 2\nsheet_name = (\"sheet\" &amp; i &amp; \".xlsx\")\nSet wb = Workbooks.Open(path &amp; sheet_name)\nSet sourceSheet = Worksheets(\"sheet1\")\nsourceSheet.Activate\nsourceSheet.Cells.Select\nSelection.Copy\nWorkbooks(\"C:\\Users\\me\\Desktop\\folder\\sheet1.xls\").Worksheets(\"Sheet1\").Activate\nSet ws = Sheets.Add\n\ni = i + 1\nNext x\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514986452, "post_id": 48078444, "comment_id": 83130723, "body": "Please show the code you have, it is hard to help without more specific information"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1514986462, "post_id": 48078444, "comment_id": 83130727, "body": "Please show your tries in the code that you are trying to build. Describe any problems that you have encountered in your efforts."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514987780, "post_id": 48078444, "comment_id": 83131473, "body": "the code needs to be put in the original post using <a href=\"https://stackoverflow.com/posts/48078444/edit\">edit</a>.  Do not put information that clarifies the problem in the comments."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1514988953, "post_id": 48078444, "comment_id": 83132094, "body": "Using copy/paste to transfer values is the wrong tool in VBA. Instead, just use something like <code>target.Value = source.Value</code>, where <code>source</code> and <code>target</code> are two range variables which have been set to the appropriate ranges. Among other things, this approach avoids having to use <code>Selection</code> and <code>Activate</code> (which are seldom needed in VBA)."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "edited": false, "score": 0, "creation_date": 1514989909, "post_id": 48079200, "comment_id": 83132626, "body": "Would you have any idea how to offset the paste every time the macro is run John? Thanks"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "edited": false, "score": 0, "creation_date": 1514990485, "post_id": 48079200, "comment_id": 83132966, "body": "By &quot;offset the paste&quot; do you mean to paste the data so that it is directly below the previous data? (so that e.g. the data is copied into <code>D21:J27</code> on one run and then into <code>D28:J34</code> the next? If so, is <code>D7:J13</code> always the source?"}, {"owner": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "edited": false, "score": 0, "creation_date": 1514998077, "post_id": 48079200, "comment_id": 83137582, "body": "That works perfectly. Thankyou so much for your support."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1514995917, "last_edit_date": 1514995917, "creation_date": 1514989249, "answer_id": 48079200, "question_id": 48078444, "link": "https://stackoverflow.com/questions/48078444/copy-and-paste-range-to-new-destination/48079200#48079200", "title": "Copy and paste range to new destination", "body": "<p>If all you want to do is copy the value in <code>D7:J13</code> to <code>D21:J27</code>, your entire sub can be replaced by:</p>\n\n<pre><code>Sub CopyPaste_Weeklys()\n    Sheets(\"MI Build\").Range(\"D21:J27\").Value = Sheets(\"MI Build\").Range(\"D7:J13\").Value\nEnd Sub\n</code></pre>\n\n<p>In VBA, copy/paste should be reserved for situations where you need to copy things like formulas and formats. For values it is better to just use the <code>Value</code> property of the respective ranges.</p>\n\n<p>Presumably the ranges are not always <code>D7:J13</code> and <code>D21:J27</code>, but your question provides no information as to how the ranges are to be determined. The fixed ranges above can be replaced by range variables that can be set at run time. Something on the following lines:</p>\n\n<pre><code>Sub CopyPaste_Weeklys()\n    Dim i As Long\n    Dim target As Range\n    With Sheets(\"MI Build\")\n        i = .Cells(.Rows.Count, \"D\").End(xlUp).Row + 1\n        Set target = Range(.Cells(i, \"D\"), .Cells(i + 6, \"J\"))\n        target.Value = .Range(\"D7:J13\").Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>The variable <code>i</code> is determined by a standard Excel VBA trick to determine the row number of the last row in a columns which contains data.</p>\n"}], "owner": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 48079200, "answer_count": 1, "score": 0, "last_activity_date": 1514995917, "creation_date": 1514986274, "last_edit_date": 1514988112, "question_id": 48078444, "link": "https://stackoverflow.com/questions/48078444/copy-and-paste-range-to-new-destination", "title": "Copy and paste range to new destination", "body": "<p>The function I'm trying to build into my spreadsheet is 'copy selected range and past to new range then every time I run the macro it will carry out the same copy.paste.range to new range but paste destination will follow on from previous pasted values. The function is collection stats on a weekly basis and the macro will automate the date collection. </p>\n\n<p>I had the initial step working but its pasting formulas instead of just the values. I\u2019ve added the paste special function but it\u2019s not working at all now. Once this has been pasted in I\u2019m looking for the next copy and paste to follow on from the data pasted into D21:J27 e.g. D28:J34 (Offset maybe?)</p>\n\n<pre><code>Sub CopyPaste_Weeklys()\nSheets(\"MI Build\").Range(\"D7:J13\").Copy\nSheets(\"MI Build\").Activate\nRange(\"D21:J27\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNoneActiveSheet.Paste\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated. </p>\n\n<p>Thanks</p>\n\n<p>Gary </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514986163, "post_id": 48078331, "comment_id": 83130570, "body": "Perhaps, when you requested <code>Apples</code>, there&#39;re only <code>Oranges</code> in 20-th field."}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514986394, "post_id": 48078331, "comment_id": 83130688, "body": "There are lots of different fruits, but Oranges have not all been filtered out. I think it is something to do with combining the filters into one statement, I&#39;m just not sure how to do it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1514987728, "post_id": 48078331, "comment_id": 83131450, "body": "Works for me. Taking note of @JonnyL&#39;s comment. You are filtering a later field first not that that makes a difference."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514988448, "post_id": 48078331, "comment_id": 83131818, "body": "Works for me too. You can&#39;t combine those into a single line as they are filtering different columns."}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "edited": false, "score": 0, "creation_date": 1515069102, "post_id": 48078331, "comment_id": 83165356, "body": "Ok I think I know why it might work for you and not for me, not that this solves my problem. It does not get rid of all the &quot;Oranges&quot;, but these &quot;Oranges&quot; are sometimes in the middle of phrases, not just by themselves. So what I am really trying to do is filter anything with &quot;Oranges&quot; in it out"}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "edited": false, "score": 0, "creation_date": 1515075025, "post_id": 48078331, "comment_id": 83168978, "body": "Hey QHarr - yes I think using the &quot;*&quot; sorted it out. I edited my code with the solution, is there something I should do to mark it as answered?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515075034, "post_id": 48078331, "comment_id": 83168990, "body": "Please post your solution EDIT as an answer to this question rather than as an edit into the question."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515075056, "post_id": 48078331, "comment_id": 83169005, "body": "Then in 2 days you can accept as answer."}], "owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515072754, "creation_date": 1514985894, "last_edit_date": 1531164843, "question_id": 48078331, "link": "https://stackoverflow.com/questions/48078331/combining-vba-filters", "title": "Combining vba filters", "body": "<p>Does anyone know how to combine these two lines so that when I run the code rows that contain Oranges do not appear. At the moment, only the first filter is working. So I get all of the Apples, but the second filter does not. </p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>ActiveSheet.Range(\"B4\", Range(\"BT4\").End(xlDown)).AutoFilter Field:=24, \nCriteria1:= \"Apples\"\n\nActiveSheet.Range(\"B4\", Range(\"BT4\").End(xlDown)).AutoFilter Field:=20, \nCriteria1:=\"&lt;&gt;Oranges\", Operator:=xlAnd\n</code></pre>\n\n<p>Edit: Solution - what I needed to do was to place \"*\" around oranges, because I wanted to filter out anything that contained the word \"Oranges\".</p>\n\n<pre><code>With ActiveSheet\n        .AutoFilterMode = False\n        .Range(\"B4\", Range(\"BT4\").End(xlDown)).AutoFilter\n        .Range(\"B4\", Range(\"BT4\").End(xlDown)).AutoFilter field:=24, \n        Criteria1:=\"Apples\"\n        .Range(\"B4\", Range(\"BT4\").End(xlDown)).AutoFilter field:=20, \n        Criteria1:=\"&lt;&gt;*Oranges*\"\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 2, "creation_date": 1514984686, "post_id": 48077911, "comment_id": 83129732, "body": "Anywhere you use <code>Range</code> or <code>Cells</code> add a full stop before. I.e. <code>.Range</code> and <code>.Cells</code>. This is how you attach those ranges and cells to the <code>With</code> statement"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514984780, "post_id": 48077911, "comment_id": 83129778, "body": "Also, whilst you&#39;re qualifying your references fully, also change <code>Worksheets(sheetName)</code> to <code>ThisWorkbook.Worksheets(sheetName)</code> to avoid any further strange behaviour in future"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1514984919, "post_id": 48077911, "comment_id": 83129861, "body": "And on Q2, <code>msgbox rowTwoHeadingKiloRange.Parent.Name</code> should do the trick. Not the best design though"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 1, "creation_date": 1514984940, "post_id": 48077911, "comment_id": 83129876, "body": "Off-topic; you can access ranges via their address.  I find this easier to read.  Example: both these statements return the same cells <code>Range(cells(2,4), cells(2, 8))</code> and <code>Range(&quot;$D$2:$H$2&quot;)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 0, "creation_date": 1514986127, "post_id": 48078085, "comment_id": 83130545, "body": "Thanks CallumDA for all the help, I did it and it worked. When it comes to the second question, I only wanted to know for when I do &quot;fault finding&quot;, and then work backwards as you say. I have no intention of using it to get data from, just to put you at ease   <code>:)</code>   Could you also just confirm for me if like my first block of code, there WILL be a sheet attached to the range, and you can not create a range without a sheet name attached?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 1, "creation_date": 1514987555, "post_id": 48078085, "comment_id": 83131342, "body": "@AlfaBravo if you just use the implicit <code>Range</code> call (unqualified) then VBA will interpret that as <code>Activesheet.Range</code> so it&#39;s whichever sheet was accessed last before the <code>Range</code> call. So yes there is always a worksheet attached to a range object but it&#39;s set automatically -- a recipe for disaster!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1514985057, "creation_date": 1514985057, "answer_id": 48078085, "question_id": 48077911, "link": "https://stackoverflow.com/questions/48077911/excel-vba-creating-a-range-without-referencing-a-sheet/48078085#48078085", "title": "excel vba: creating a range without referencing a sheet", "body": "<p>You were close. To attach your <code>Range</code> and <code>Cell</code> to the <code>With</code> statement you need to use a full-stop <code>.</code> before the keyword. Like this:</p>\n\n<pre><code>Public Function colmHeadingsAndSpacing(sheetName)\n    With ThisWorkbook.Worksheets(sheetName)\n        ...\n        Set rowTwoHeadingKiloRange = .Range(.Cells(2, 4), .Cells(2, 8)) \n        Set rowTwoHeadingUnitRange = .Range(.Cells(2, 10), .Cells(2, 14)) \n        ...\n    End with\nEnd Function\n</code></pre>\n\n<p>This is good practice to qualify every range reference with it's attached worksheet. I went one step further included a workbook reference (<code>ThisWorkbook</code>). Now it's fully qualified.</p>\n\n<p>For the second question -- try <code>MsgBox rowTwoHeadingKiloRange.Parent.Name</code> to get the name of the worksheet. It's usually better to start with the worksheet name rather than work back to it though. </p>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1514988126, "last_edit_date": 1514988126, "creation_date": 1514986623, "answer_id": 48078537, "question_id": 48077911, "link": "https://stackoverflow.com/questions/48077911/excel-vba-creating-a-range-without-referencing-a-sheet/48078537#48078537", "title": "excel vba: creating a range without referencing a sheet", "body": "<p>A range is a reference of a (mostly rectangular) area on a sheet. So referring to a range without defining a sheet like <code>Set r = Range (\"B2:F10\")</code> is exactly the same as <code>Set r = Activeworkbook.Activesheet.Range (\"B2:F10\")</code>. So for more professional purposes VBA offers you the flexibility in the following way: </p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\n\nSet wb = Workbooks.Add   ' open new xlsx file\nSet ws = Activesheet OR \nSet ws = wb.Activesheet OR \nSet ws = wb.Sheets(1)\n' do something else here and later when neither wb nor ws is active, you can\nSet r = wb.ws.Range(\"B5:G22\") OR \nSet r = ws.Range(\"B5:G22\")\n</code></pre>\n\n<p>An addition: for producing a number of sheets of the same format, you may consider using templates either. Then you need to fill in only the differences programatically. Less programming, easier maintenance :)</p>\n"}], "owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "accepted_answer_id": 48078085, "answer_count": 2, "score": 0, "last_activity_date": 1514988126, "creation_date": 1514984324, "last_edit_date": 1514984496, "question_id": 48077911, "link": "https://stackoverflow.com/questions/48077911/excel-vba-creating-a-range-without-referencing-a-sheet", "title": "excel vba: creating a range without referencing a sheet", "body": "<p>I would like to know if I can save a generic range, without it having a sheet name attached to it?</p>\n\n<p>Lets say that my program creates a sheet for every day of the week, and then makes headings for every sheet. I want to give it a few ranges, and it must merge and add different headings to those ranges in EVERY sheet. So the headings of every sheet looks the same. </p>\n\n<p>I have the following range for example:</p>\n\n<pre><code>...\nSet rowTwoHeadingKiloRange = Range(Cells(2, 4), Cells(2, 8)) \nSet rowTwoHeadingUnitRange = Range(Cells(2, 10), Cells(2, 14)) \n...\n</code></pre>\n\n<p>Now when I try to pass this range in a dictionary to every sheet that gets created, I find that I have undesired results as some of the headings gets created on sheets where they do not belong (And I think that is because when the range is created, it attaches to the active sheet at that moment - which may be different from time to time). </p>\n\n<p>So now I basically have a function that looks something like this...</p>\n\n<pre><code>Public Function colmHeadingsAndSpacing(sheetName)\n    With Worksheets(sheetName)\n        ...\n        Set rowTwoHeadingKiloRange = Range(Cells(2, 4), Cells(2, 8)) \n        Set rowTwoHeadingUnitRange = Range(Cells(2, 10), Cells(2, 14)) \n        ...\n    End with\nEnd Function\n</code></pre>\n\n<p>... and I run the function every time I create a sheet, with the name of the sheet that was just created given through. But this runs the function 7 times, when I use the same data (range) every time. Also I feel that it is not working properly as well (I still get strange reactions - ranges ending up in wrong sheets).</p>\n\n<p>Second question, is there a way to find out on a range, what sheet is \"attached\" to the range. Something like: <code>msgbox rowTwoHeadingKiloRange.worksheets.name</code> which will give the result of <code>Sunday</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514983532, "post_id": 48077616, "comment_id": 83129062, "body": "What in particular are you stuck on? Why are you calling another module?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514983826, "post_id": 48077616, "comment_id": 83129228, "body": "<i>character 2,3 and 4 written in A column</i> Where is it in your example?"}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1514983841, "post_id": 48077616, "comment_id": 83129240, "body": "When I&#180;m done with the file it will do much more so I was planning on separate each function do make it easier for me (I have not studied VBA so I google and tries to make it work). I understand that I need to check the cells in A and if not empty preform the left strip by 4 characters and then remove the first character after that and then place it in D column, same row and loop. But unfortunatly all I find after trimming using left isn&#180;t adding the trimmed string in another cell.  Character 2,3,4 is 185 in my example it will always be numbers but different number."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514984575, "post_id": 48077616, "comment_id": 83129667, "body": "Have a look at the MID formula."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1514984822, "post_id": 48077616, "comment_id": 83129801, "body": "I don&#39;t see any need for VBA. A simple formula like <code>=Mid(A2, 2, 3)</code> in the column would do."}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1514987900, "post_id": 48077616, "comment_id": 83131532, "body": "Yes I can use formula but since I am going to do so muck more using VBA I would like to manage to do this using script. The number of rows that will be used will be different each time and I would like the cells to be empty when not in use."}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1514992246, "post_id": 48077616, "comment_id": 83134097, "body": "Still working on the solution. I am using MID but in a VBA script although it doesn&#180;t clear the cell in D column when I delete the value on the same row in A Column. The weird thing is that if I delete some of the cell in A it clear the cell in D but not all rows are working?!"}], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515075842, "post_id": 48095605, "comment_id": 83169495, "body": "Worked like a sharm! Thanks for the help and the explanation."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1515069797, "creation_date": 1515069797, "answer_id": 48095605, "question_id": 48077616, "link": "https://stackoverflow.com/questions/48077616/excel-vba-strip-string-into-another-cell/48095605#48095605", "title": "Excel VBA strip string into another cell", "body": "<p>You can wrap this whole piece up in just the <code>Worksheet_Change</code> event if you use the following:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim columnAcell As Range\n\n    If Intersect(Target, Me.Range(\"A:A\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False\n\n    For Each columnAcell In Target.Cells\n        columnAcell.Offset(0, 3) = Mid(columnAcell, 2, 3)\n    Next\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Instead of specifically writing to column D, I've used a cell offset of 3 columns from <code>Target</code>. As this code only looks at column A currently, it will always offset to column D.</p>\n\n<p>Things to watch out for though -</p>\n\n<ul>\n<li>Altering cell(A1) which contains the header would result in cell(D1) being altered. You can prevent this by changing the <code>Intersect</code> range from <code>A:A</code> to something like <code>A2:Axxxx</code></li>\n<li>Deleting the entirety of column A would result in the loop running for a very long time, not to mention causing column D to move to column C. You may want to prevent users from being able to do this.</li>\n</ul>\n"}], "owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 48095605, "answer_count": 1, "score": 0, "last_activity_date": 1515069797, "creation_date": 1514983193, "last_edit_date": 1531164843, "question_id": 48077616, "link": "https://stackoverflow.com/questions/48077616/excel-vba-strip-string-into-another-cell", "title": "Excel VBA strip string into another cell", "body": "<p>I\u00b4m trying to create an Excelsheet that runs multiple VBA scripts after writing anything in A Column.</p>\n\n<p>One part I would like some help with is that the character 2,3 and 4 written in A column (any row) should be written i D column same row.\nI also would like to remove any information i D Column if I remove the text from A Column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GtG7h.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GtG7h.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have manage to create a script that calls modules after writing information i a cell in A Column</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Me.Range(\"A:A\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False 'to prevent endless loop\n    On Error GoTo Finalize 'to re-enable the events\n    Call Modul1.Module\nFinalize:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appriciated.</p>\n\n<hr>\n\n<p>This is what I have for now.\nIt doesn\u00b4t work to clear value on all rows only some of them?!</p>\n\n<pre><code>Sub Lokation()\n\nDim n As Long, i As Long, j As Long\nn = Cells(Rows.Count, \"A\").End(xlUp).Row\nj = 2\nFor i = 2 To n\n    If Cells(i, \"A\").Value = vbNullString Then\n\n    Cells(j, \"D\").Value = (\"\")\n\n    Else\n\n    Cells(j, \"D\").Value = Mid(Cells(j, \"A\").Value, 2, 3)\n\n    End If\n   j = j + 1\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "variables", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1514982513, "post_id": 48077366, "comment_id": 83128517, "body": "You are putting the value of <code>Gender</code> into your formula, as a cursory examination of the formula will tell you, which the sheet will not understand. You need to use the address property to return the cell reference."}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1514982693, "post_id": 48077366, "comment_id": 83128620, "body": "From your use of set, i&#39;m assuming you&#39;re doing this in VBA, why not just use an IF ELSE IF statement to set the value?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1514982729, "post_id": 48077366, "comment_id": 83128645, "body": "in the formula, change <code>Gender</code> to <code>Gender.address</code> and it should work fine."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1514983222, "post_id": 48077366, "comment_id": 83128898, "body": "Thanks SJR, I have done that by adding .Address after Gender but now it&#39;s returning a blank cell"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514983350, "post_id": 48077366, "comment_id": 83128956, "body": "That means the last character is neither &quot;M&quot; nor &quot;F&quot;."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1514983702, "post_id": 48077366, "comment_id": 83129162, "body": "I have changed the function to trim to see if it is pulling through the data <code>&quot;=trim(&quot; &amp; Gender.Address &amp; &quot;)&quot; </code> but this is also returning a blank cell. However when I use just <code>Gender</code> it returns the un-formatted data"}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1514984310, "post_id": 48077366, "comment_id": 83129519, "body": "However after using the following <code>MsgBox Gender.Address</code> it does bring back the correct cell"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514984611, "post_id": 48077366, "comment_id": 83129696, "body": "What is in the cell? Perhaps you have some hidden characters."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1514985721, "post_id": 48077366, "comment_id": 83130292, "body": "I have found the issue, as the variable is being set from another sheet, the .address however is pulling the data from the same sheet where the formula is located."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514986001, "post_id": 48077366, "comment_id": 83130472, "body": "So you&#39;ll need to add the sheet name into your formula string."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1514988185, "post_id": 48077366, "comment_id": 83131678, "body": "Thanks SJR, I&#39;ve got it working now"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1514988342, "post_id": 48077366, "comment_id": 83131754, "body": "I&#39;ve added an answer below as getting rather wordy down here."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1514985646, "creation_date": 1514985646, "answer_id": 48078251, "question_id": 48077366, "link": "https://stackoverflow.com/questions/48077366/use-excel-functions-on-a-variable/48078251#48078251", "title": "Use excel functions on a variable", "body": "<p>Your approach involves creating a worksheet equation and then using <code>Evaluate()</code> to calculate it.  Here is an alternative approach:</p>\n\n<pre><code>Sub jufg()\n    Dim Gender As Range, sexCode As String\n    Dim rFirst As Range\n    Set rFirst = Range(\"A1\")\n\n    Set Gender = rFirst.Offset(1, 5)\n    sexCode = Right(Gender.Value, 1)\n\n    With Worksheets(\"E'ee Details\").Range(\"E1\")\n        If sexCode = \"M\" Then\n            .Value = \"Male\"\n        ElseIf sexCode = \"F\" Then\n            .Value = \"Female\"\n        Else\n            .Value = \"\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 1, "creation_date": 1514990875, "post_id": 48078976, "comment_id": 83133228, "body": "Thanks SJR, this worked perfectly. Thanks everyone else for input"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1514988304, "creation_date": 1514988304, "answer_id": 48078976, "question_id": 48077366, "link": "https://stackoverflow.com/questions/48077366/use-excel-functions-on-a-variable/48078976#48078976", "title": "Use excel functions on a variable", "body": "<p>Amend as below</p>\n\n<pre><code>Worksheets(\"E'ee Details\").Range(\"E1\").Value = \"=if(right(EmployeeAll!\" &amp; gender.Address &amp; \",1)=\"\"M\"\",\"\"Male\"\",if(right(EmployeeAll!\" &amp; gender.Address &amp; \",1)=\"\"F\"\",\"\"Female\"\",\"\"\"\"))\"\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48078976, "answer_count": 2, "score": 0, "last_activity_date": 1514988304, "creation_date": 1514982294, "last_edit_date": 1531161705, "question_id": 48077366, "link": "https://stackoverflow.com/questions/48077366/use-excel-functions-on-a-variable", "title": "Use excel functions on a variable", "body": "<p>I'm trying to get the right most letter from a variable I have set and then assign either Male or Female to the result. Below is a snippet of the code I've tried.</p>\n\n<pre><code>Set Gender = rFirst.Offset(1, 5)\n\nWorksheets(\"E'ee Details\").Range(\"E1\").Value = \"=if(right(\" &amp; Gender &amp; \",1)=\"\"M\"\",\"\"Male\"\",if(right(\" &amp; Gender &amp; \",1)=\"\"F\"\",\"\"Female\"\",\"\"\"\"))\"\n</code></pre>\n\n<p>This is resulting in #NAME? being displayed. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1514980252, "creation_date": 1514980252, "answer_id": 48076830, "question_id": 48076618, "link": "https://stackoverflow.com/questions/48076618/amending-a-vba-so-that-it-works-between-two-workbooks-as-opposed-to-two-workshee/48076830#48076830", "title": "Amending a VBA so that it works between two workbooks as opposed to two worksheets", "body": "<p>You should refer to your worksheets and workbooks at the same time. So, instead of:</p>\n\n<pre><code>I = Worksheets(\"Demand Log\").UsedRange.Rows.Count\n</code></pre>\n\n<p>You should type:</p>\n\n<pre><code>I = Workbooks(\"Book1\").Worksheets(\"Demand Log\").UsedRange.Rows.Count\n</code></pre>\n\n<p>anywhere in your code. For simplicity, you may set object variable, like:</p>\n\n<pre><code>Dim wb1 as Workbook\nSet wb1 = Application.Workbooks(\"Book1\")\n</code></pre>\n\n<p>or, better, set your worksheets as variables, for example:</p>\n\n<pre><code>Dim wsDemand as Worksheet\nSet wsDemand = Workbooks(\"Book1\").Worksheets(\"Demand Log\")\n</code></pre>\n\n<p>and then you can use wsDemand instead of Worksheets(\"Demand Log\") anywhere in your code. \nBook1 is of course default workbook's name, your file has probably other name. </p>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "is_accepted": false, "score": 0, "last_activity_date": 1514981978, "last_edit_date": 1514981978, "creation_date": 1514980347, "answer_id": 48076861, "question_id": 48076618, "link": "https://stackoverflow.com/questions/48076618/amending-a-vba-so-that-it-works-between-two-workbooks-as-opposed-to-two-workshee/48076861#48076861", "title": "Amending a VBA so that it works between two workbooks as opposed to two worksheets", "body": "<p>If the workbook is open then you can refer to it like this:\n<code>Workbooks(\"mybook.xls\")[.method]</code></p>\n\n<p>If the workbook is closed you need to open it: <code>Workbooks.Open(\"C:\\path\\mybook.xls\")[.method]</code></p>\n\n<p>You can assign them to variables:</p>\n\n<pre><code>set wb = Workbooks(\"mybook.xls\")\nset wb = Workbooks.Open(\"C:\\path\\mybook.xls\")\n\nset ws = wb.Sheets(\"MySheet\")\n</code></pre>\n\n<p>You can also get to the worksheet and assign it to a variable: (useful if you're working with a single sheet)</p>\n\n<pre><code>set ws = Workbooks(\"mybook.xls\").Sheets(\"MySheet\")\nset ws = Workbooks.Open(\"C:\\path\\mybook.xls\").Sheets(\"MySheet\")\n</code></pre>\n\n<p>Untested, but give it a try:</p>\n\n<pre><code>Sub mysub()\n\n    Dim xRg As Range\n    Dim xCell As Range\n    Dim I As Long\n    Dim J As Long\n    Dim K As Long\n\n    Dim wbDem As Workbook\n    Dim wbChg As Workbook\n    Dim wsDem As Worksheet\n    Dim wsChg As Worksheet\n\n\n    'Open/Get Workbook\n    If Application.Workbooks(\"Demand.xls\") Is Nothing Then\n        Set wbDem = Application.Workbooks.Open(\"C:\\path\\Demand.xls\")\n    Else\n        Set wbDem = Application.Workbooks(\"Demand.xls\")\n    End If\n\n    'Open/Get Workbook\n    If Application.Workbooks(\"Change\") Is Nothing Then\n        Set wbChg = Application.Workbooks.Open(\"C:\\path\\Change.xls\")\n    Else\n        Set wbChg = Application.Workbooks(\"Change.xls\")\n    End If\n\n    'Set Sheet Variables\n    Set wsDem = wbDem.Worksheets(\"Demand Log\")\n    Set wsChg = wbChg.Worksheets(\"Change Log\")\n\n\n    I = wsDem.UsedRange.Rows.Count\n    J = wsChg.Cells(wbChg.Rows.Count, \"B\").End(xlUp).Row\n    If J = 1 Then\n       If Application.WorksheetFunction.CountA(wbChg.Range) = 0 Then J = 0\n    End If\n    Set xRg = wsDem.Range(\"O5:O\" &amp; I)\n\n    Application.ScreenUpdating = False\n    For K = xRg.Count To 1 Step -1\n        If CStr(xRg(K).value) = \"Change Team\" Then\n            J = J + 1\n            With wsDem\n                Intersect(.Rows(xRg(K).Row), .Range(\"A:Z\")).Copy Destination:=wsChg.Range(\"A\" &amp; J)\n                Intersect(.Rows(xRg(K).Row), .Range(\"A:Z\")).Delete xlShiftUp\n            End With\n        End If\n    Next\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8264163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3bdf17ba5a49e76a378a74b52660fd?s=128&d=identicon&r=PG&f=1", "display_name": "Adamlh77", "link": "https://stackoverflow.com/users/8264163/adamlh77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514981978, "creation_date": 1514979435, "question_id": 48076618, "link": "https://stackoverflow.com/questions/48076618/amending-a-vba-so-that-it-works-between-two-workbooks-as-opposed-to-two-workshee", "title": "Amending a VBA so that it works between two workbooks as opposed to two worksheets", "body": "<p>Hi all and thanks in advance. </p>\n\n<p>I currently have a VBA within my workbook to copy rows from \"Demand Log\" to \"Change Log\" when cells within column \"O\" have a specific value. </p>\n\n<p>The VBA is working great, however I am now looking to split the two worksheets apart and have a separate workbook for each. </p>\n\n<p>My question is - <strong>How can I change my VBA so that it copies and pastes between workbooks as opposed to between worksheets?</strong></p>\n\n<p>Please see my VBA code below:</p>\n\n<pre><code>Dim xRg As Range\nDim xCell As Range\nDim I As Long\nDim J As Long\nDim K As Long\nI = Worksheets(\"Demand Log\").UsedRange.Rows.Count\nJ = Worksheets(\"Change Log\").Cells(Worksheets(\"Change Log\").Rows.Count, \"B\").End(xlUp).Row\nIf J = 1 Then\n   If Application.WorksheetFunction.CountA(Worksheets(\"Change Log\").Range) = 0 Then J = 0\nEnd If\nSet xRg = Worksheets(\"Demand Log\").Range(\"O5:O\" &amp; I)\n\nApplication.ScreenUpdating = False\nFor K = xRg.Count To 1 Step -1\n    If CStr(xRg(K).Value) = \"Change Team\" Then\n        J = J + 1\n        With Worksheets(\"Demand Log\")\n            Intersect(.Rows(xRg(K).Row), .Range(\"A:Z\")).Copy Destination:=Worksheets(\"Change Log\").Range(\"A\" &amp; J)\n            Intersect(.Rows(xRg(K).Row), .Range(\"A:Z\")).Delete xlShiftUp\n        End With\n    End If\nNext\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "if-statement", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1514977403, "creation_date": 1514977403, "answer_id": 48076073, "question_id": 48075935, "link": "https://stackoverflow.com/questions/48075935/loop-inserting-hyperlinks-with-if-condition/48076073#48076073", "title": "Loop inserting hyperlinks with If-condition", "body": "<p>should be</p>\n\n<pre><code>Anchor:=cell\n</code></pre>\n\n<p>Now it works for me. </p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1514977609, "creation_date": 1514977609, "answer_id": 48076131, "question_id": 48075935, "link": "https://stackoverflow.com/questions/48075935/loop-inserting-hyperlinks-with-if-condition/48076131#48076131", "title": "Loop inserting hyperlinks with If-condition", "body": "<p>Please give this a try...</p>\n\n<pre><code>For Each cell In rng\n    If InStr(1, cell.Value, \"92/65/EEC\", vbTextCompare) &gt; 0 Then\n      ActiveSheet.Hyperlinks.Add Anchor:=cell, Address:=\"\", SubAddress:= _\n        \"'List of EU legislation '!A8\", TextToDisplay:=\"92/65/EEC\"\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9167708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97028487e1e69f73ac7221ae73b42367?s=128&d=identicon&r=PG&f=1", "display_name": "Cathy", "link": "https://stackoverflow.com/users/9167708/cathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514978869, "creation_date": 1514976839, "last_edit_date": 1514978869, "question_id": 48075935, "link": "https://stackoverflow.com/questions/48075935/loop-inserting-hyperlinks-with-if-condition", "title": "Loop inserting hyperlinks with If-condition", "body": "<p>I basically try to put a hyperlink to a cell in Sheet1 linking it to Sheet2 if the text matches \"92/65/EEC\". I don't understand where I went wrong here. \nCould you please help?</p>\n\n<pre><code>Sub Legislation()\n\n ' Define\n Dim lrow As Long, rng As Range, cell As Range\n lrow = Cells(Cells.Rows.Count, \"J\").End(xlUp).Row\n\n' Set the range where to apply the code\nSet rng = Range(\"J5:J\" &amp; lrow)\n\n' Define what to look for\n For Each cell In rng\n If InStr(1, cell.Value, \"92/65/EEC\", vbTextCompare) &gt; 0 Then\n With cell.Validation\n  ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    \"'List of EU legislation '!A8\", TextToDisplay:=\"92/65/EEC\"\n    End With\n End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514978051, "post_id": 48075696, "comment_id": 83126092, "body": "Detailing what you have tried will help others (e.g.  links to relevant documents) to help you."}, {"owner": {"reputation": 5, "user_id": 8163034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c92ad309c17e69b35279462beb3f55a?s=128&d=identicon&r=PG&f=1", "display_name": "elbruzo", "link": "https://stackoverflow.com/users/8163034/elbruzo"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514979446, "post_id": 48075696, "comment_id": 83126863, "body": "Here are some links to the work around&#39;s I tried <a href=\"https://www.slipstick.com/developer/working-vba-nondefault-outlook-folders/\" rel=\"nofollow noreferrer\">link</a>  <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/114997-adding-an-appointment-to-outlook-from-excel-with-vba\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514980585, "post_id": 48075696, "comment_id": 83127459, "body": "Please <a href=\"https://stackoverflow.com/posts/48075696/edit\">edit</a> links into your question"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8163034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c92ad309c17e69b35279462beb3f55a?s=128&d=identicon&r=PG&f=1", "display_name": "elbruzo", "link": "https://stackoverflow.com/users/8163034/elbruzo"}, "edited": false, "score": 0, "creation_date": 1514979639, "post_id": 48076435, "comment_id": 83126966, "body": "Hi GA. Unfortunately I tried the Slipstick method already. I didn&#39;t work for me. All appointments still go the default calendar."}], "tags": [], "owner": {"reputation": 126, "user_id": 6950968, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZfXrI.jpg?s=128&g=1", "display_name": "Gothic_Anatomist", "link": "https://stackoverflow.com/users/6950968/gothic-anatomist"}, "is_accepted": false, "score": 1, "last_activity_date": 1514978773, "creation_date": 1514978773, "answer_id": 48076435, "question_id": 48075696, "link": "https://stackoverflow.com/questions/48075696/adding-an-appointment-to-outlook-2010-from-excel/48076435#48076435", "title": "Adding an appointment to Outlook 2010 from Excel", "body": "<p>To get access to a subfolder in your default calendar folder you can use:</p>\n\n<pre><code>Set colItems = NS.GetDefaultFolder(olFolderCalendar).Folders(\"TypeNameOfCalendarHere\").Items\n</code></pre>\n\n<p>If it is on the same level as teh default folder you can use:</p>\n\n<pre><code>Set colItems = NS.GetDefaultFolder(olFolderCalendar).Parent.Folders(\"SharedCal\").Items\n</code></pre>\n\n<p>Good resource <a href=\"http://www.slipstick.com/developer/working-vba-nondefault-outlook-folders/\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/folders-item-method-outlook\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1515011625, "last_edit_date": 1515011625, "creation_date": 1514996726, "answer_id": 48081286, "question_id": 48075696, "link": "https://stackoverflow.com/questions/48075696/adding-an-appointment-to-outlook-2010-from-excel/48081286#48081286", "title": "Adding an appointment to Outlook 2010 from Excel", "body": "<p>As described in the <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/114997-adding-an-appointment-to-outlook-from-excel-with-vba\" rel=\"nofollow noreferrer\">Ozgrid</a> link, move the appointment created in the default calendar to the sub calendar.</p>\n\n<p>You can reference a calendar with the entry ID.</p>\n\n<pre><code>Set oFolder = oNameSpace.GetFolderFromID(\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\")   \n</code></pre>\n\n<p>You can reference a sub Calendar of the default folder:</p>\n\n<pre><code>Set oFolder = NS.GetDefaultFolder(olFolderCalendar).folders(\"Name of sub calendar\")\n</code></pre>\n\n<p>Once created in the default calendar move it to the non-default calendar</p>\n\n<pre><code>Set olApt = oApp.CreateItem(olAppointmentItem)\nWith olApt\n    ' ..\n    .Save\n    .Move oFolder\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1514996861, "creation_date": 1514996861, "answer_id": 48081325, "question_id": 48075696, "link": "https://stackoverflow.com/questions/48075696/adding-an-appointment-to-outlook-2010-from-excel/48081325#48081325", "title": "Adding an appointment to Outlook 2010 from Excel", "body": "<p>You may add to a non-default calendar.</p>\n\n<pre><code>Set subCalendar = NS.GetDefaultFolder(olFolderCalendar).folders(\"Name of sub calendar\")\nSet olAppt = subCalendar.items.Add\n\nWith olAppt\n     '...\n     .Save\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8163034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c92ad309c17e69b35279462beb3f55a?s=128&d=identicon&r=PG&f=1", "display_name": "elbruzo", "link": "https://stackoverflow.com/users/8163034/elbruzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 48081286, "answer_count": 3, "score": 0, "last_activity_date": 1593169908, "creation_date": 1514975883, "last_edit_date": 1593169908, "question_id": 48075696, "link": "https://stackoverflow.com/questions/48075696/adding-an-appointment-to-outlook-2010-from-excel", "title": "Adding an appointment to Outlook 2010 from Excel", "body": "<p>I am trying to use the code below to update my Outlook calendar from an Excel sheet.<br>\nThe code functions fine, but I need to save to a sub calendar rather than my default one.<br>\nI've tried a few work around's I found online,but none of them seem to work.  For example  <a href=\"http://www.slipstick.com/developer/working-vba-nondefault-outlook-folders/\" rel=\"nofollow noreferrer\">Slapstick</a> and also at the bottom of this page <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/114997-adding-an-appointment-to-outlook-from-excel-with-vba\" rel=\"nofollow noreferrer\">Ozgrid</a><br>\nAny help would be much appreciated. </p>\n\n<pre><code>Option Explicit\nSub AddToOutlook()\n\n\nDim OL As Outlook.Application\nDim olAppt As Outlook.AppointmentItem\nDim NS As Outlook.Namespace\nDim colItems As Outlook.Items\nDim olApptSearch As Outlook.AppointmentItem\nDim r As Long, sBody As String, sSubject As String, sLocation As String\nDim dStartTime As Date, dEndTime As Date, dReminder As String, dCatagory As Double\nDim sSearch As String, bOLOpen As Boolean\n\nOn Error Resume Next\nSet OL = GetObject(, \"Outlook.Application\")\nbOLOpen = True\nIf OL Is Nothing Then\n    Set OL = CreateObject(\"Outlook.Application\")\n    bOLOpen = False\nEnd If\nSet NS = OL.GetNamespace(\"MAPI\")\nSet colItems = NS.GetDefaultFolder(olFolderCalendar).Items\n\n\nFor r = 2 To 394\n\n    If Len(Sheet1.Cells(r, 1).Value + Sheet1.Cells(r, 5).Value) = 0 Then \n    GoTo NextRow\n    sBody = Sheet1.Cells(r, 7).Value\n    sSubject = Sheet1.Cells(r, 3).Value\n    dStartTime = Sheet1.Cells(r, 1).Value + Sheet1.Cells(r, 2).Value\n    dEndTime = Sheet1.Cells(r, 1).Value + Sheet1.Cells(r, 5).Value\n    sLocation = Sheet1.Cells(r, 6).Value\n    dReminder = Sheet1.Cells(r, 4).Value\n\n    sSearch = \"[Subject] = \" &amp; sQuote(sSubject)\n    Set olApptSearch = colItems.Find(sSearch)\n\n\n    If olApptSearch Is Nothing Then\n        Set olAppt = OL.CreateItem(olAppointmentItem)\n        olAppt.Body = sBody\n        olAppt.Subject = sSubject\n        olAppt.Start = dStartTime\n        olAppt.End = dEndTime\n        olAppt.Location = sLocation\n        olAppt.Catagory = dCatagory\n        olAppt.Close olSave\n    End If\n\n\nNextRow:\nNext r\n\n\nIf bOLOpen = False Then OL.Quit\n\n\nEnd Sub\n\n\nFunction sQuote(sTextToQuote)\nsQuote = Chr(34) &amp; sTextToQuote &amp; Chr(34)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1514976273, "post_id": 48075587, "comment_id": 83125117, "body": "I believe it isn&#39;t to do with the range, but rather that you define what the variable Search contains on the first IF statement, so on the second IF statement it doesn&#39;t find anything as Search doesn&#39;t contain anything, or it contains data from the first iteration of your code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514976685, "post_id": 48075587, "comment_id": 83125350, "body": "Please enter code into the question between code tags (highlight your code and then press Ctrl + K) rather than inserting as an image. Makes it easier for others to debug as can copy paste. Also, some people may not be able to view the images."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1514979509, "post_id": 48075587, "comment_id": 83126892, "body": "What is search at this point?  Does it find anything?  If nothing is found the range will be <code>nothing</code> so I&#39;d check this before trying to get the range&#39;s address."}, {"owner": {"reputation": 3, "user_id": 9167524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1ceb49575bdc70f902ba2b7802fc16?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/9167524/dman"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515028408, "post_id": 48075587, "comment_id": 83149644, "body": "@QHarr Thanks for the tip. I was having trouble using that (wasn&#39;t highlighting beforehand)  and was short on time. I&#39;ll make sure to use it correctly in the future!"}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1514985363, "post_id": 48078129, "comment_id": 83130103, "body": "It would be worth explaining why <code>Not Fnd Is Nothing</code> will prevent the error. While this is common syntax for most experienced VBA programmers, those newer to the language will have no clue what this is doing or why it works."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1514987010, "post_id": 48078129, "comment_id": 83131049, "body": ".Find() returns a range that actually points to one specific cell OR returns Nothing when not found. (N.B.: null value for objects in VBA is &#39;Nothing&#39;.) So you can have a chance to act differently if found or not."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1514987635, "post_id": 48078129, "comment_id": 83131400, "body": "I meant to add it to your answer :p. The value in SO is for all the people who later learn something new from your question. Adding that explanation to your answer (use the edit button) will help future users."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1514990800, "post_id": 48078129, "comment_id": 83133174, "body": "Good answer  :o)"}, {"owner": {"reputation": 3, "user_id": 9167524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1ceb49575bdc70f902ba2b7802fc16?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/9167524/dman"}, "edited": false, "score": 0, "creation_date": 1515028247, "post_id": 48078129, "comment_id": 83149620, "body": "Thank You! I turns out it .Find() was returning &#39;Nothing&#39; just like you said. I thought this was impossible because while debugging I could see the value of Search and it was clearly in the range when I was looking at the spreadsheet. However, in the range I was searching for all the cells were just references to another cell in the sheet. For some reason .Find() wont look at the actual value referenced. But these cells are static, so for now I will just change them from references to actual values! Thanks again!"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1515051563, "post_id": 48078129, "comment_id": 83155729, "body": "That&#39;s good. Would you then please click on the up arrow and then accept the answer so that I can finally cross the magic border of 50 reputations? :) Thank you."}, {"owner": {"reputation": 3, "user_id": 9167524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1ceb49575bdc70f902ba2b7802fc16?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/9167524/dman"}, "edited": false, "score": 0, "creation_date": 1515077286, "post_id": 48078129, "comment_id": 83170395, "body": "I hit the accept button ... but my votes don\u2019t count sadly -.-"}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1514988594, "last_edit_date": 1514988594, "creation_date": 1514985239, "answer_id": 48078129, "question_id": 48075587, "link": "https://stackoverflow.com/questions/48075587/vba-runtime-91-error/48078129#48078129", "title": "VBA Runtime 91 Error", "body": "<p>Find().Address breaks with exception (code 91) if not found. This is because .Find() returns a range that actually points to one specific cell OR returns Nothing when not found and 'Nothing'.Address is meaningless (n.b.: null value for objects in VBA is 'Nothing'). So I would replace that line with</p>\n\n<pre><code> Fnd = Worksheets(\"Pallet Check\").Range(\"AF3:AF30\").Find(Search)\n if Not Fnd Is Nothing then\n     strInput = Fnd.Address\n     ...\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9167524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1ceb49575bdc70f902ba2b7802fc16?s=128&d=identicon&r=PG&f=1", "display_name": "Dman", "link": "https://stackoverflow.com/users/9167524/dman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 48078129, "answer_count": 1, "score": -2, "last_activity_date": 1514988594, "creation_date": 1514975446, "last_edit_date": 1531164843, "question_id": 48075587, "link": "https://stackoverflow.com/questions/48075587/vba-runtime-91-error", "title": "VBA Runtime 91 Error", "body": "<p>Trying to automate a lengthy data entry process in excel.</p>\n\n<p>For some reason the second time I try to find a value in a given range I get a run time 91 error. I can't figure out why this is happening. If I change the range from \"AF3:AF30\" to the first time I set a range(\"B2:AD2\"), the program will continue through the line with no problem. But for some reason any range other than the first \"B2:AD2\" will give runtime!</p>\n\n<p>Code:</p>\n\n<pre><code>Sub AutoFill()\nRange(\"B8:AD57\").Select\nSelection.ClearContents\nRange(\"B8\").Select\n\nDim Rng As Range, cell As Range\n\nSet Rng = Worksheets(\"Avon Trailer List\").Range(\"E4:E38\")\n\nFor Each cell In Rng\n    Dim temp As String\n\n    temp = Replace(cell.Value(), \" \", \"\")\n    temp = Replace(temp, \"+\", \"\")\n    If temp = \"\" Then\n        Exit For\n    Else\n        col = \"\"\n        tempa = SplitMultiDelims(temp, \"/,\\)(\")\n        For i = 0 To UBound(tempa)\n            If InStr(tempa(i), \"A\") = 1 Then\n                strInput = Worksheets(\"Pallet Check\").Range(\"B2:AD2\").Find(tempa(i)).Address()\n                lnRow = Range(strInput).Row\n                strCol = Left(strInput, Len(strInput) - Len(CStr(lnRow)))\n                strCol = Replace(strCol, \"S\", \"\")\n                Search = tempa(i)\n            ElseIf InStr(tempa(i), \"A\") &gt; 1 Or InStr(tempa(i), \"B\") &gt; 1 Or InStr(tempa(i), \"a\") &gt; 1 Or InStr(tempa(i), \"b\") &gt; 1 Then\n                strInput = Worksheets(\"Pallet Check\").Range(\"AF3:AF30\").Find(Search).Address()\n                lnRow = Range(strInput).Row\n                Range(\"AH\" &amp; lnRow).Value() = \"(\" &amp; tempa(i) &amp; \")\"\n            ElseIf tempa(i) &lt;&gt; \"\" Then\n                Worksheets(\"Pallet Check\").Range(strCol &amp; tempa(i) + 7).Value() = Worksheets(\"Pallet Check\").Range(strCol &amp; tempa(i) + 7).Value() &amp; tempa(i)\n            End If\n        Next i\n    End If\nNext cell\nEnd Sub\n</code></pre>\n\n<p>Runtime Error 91 happens on the following line of code:</p>\n\n<pre><code>strInput = Worksheets(\"Pallet Check\").Range(\"AF3:AF30\").Find(Search).Address()\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8899579, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-j_k8PyFVxbI/AAAAAAAAAAI/AAAAAAAAAF0/dIHpvWPbBkQ/photo.jpg?sz=128", "display_name": "Creakush Coliko", "link": "https://stackoverflow.com/users/8899579/creakush-coliko"}, "edited": false, "score": 0, "creation_date": 1514977741, "post_id": 48075882, "comment_id": 83125912, "body": "Yes, that was the problem. Thank you"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1514977346, "last_edit_date": 1514977346, "creation_date": 1514976613, "answer_id": 48075882, "question_id": 48075440, "link": "https://stackoverflow.com/questions/48075440/exl-vba-range-sort-error/48075882#48075882", "title": "Exl vba - range sort error", "body": "<p>The problem with the second sort is excel allows <code>max three columns</code> to sort simultaneously through VBA. </p>\n\n<p>If you sort multiple columns <code>H</code>, <code>F</code>, <code>D</code> and <code>B</code> manually, the excel sorts them in the reverse order internally to complete the sort i.e. it sorts the columns in the sequence <code>B</code>, <code>D</code>, <code>F</code> and <code>H</code>.</p>\n\n<p>So you may use this concept to apply sort on more than three columns through VBA. All you need is to apply sort on the last column first separately and then apply sort on the remaining three columns as usual.</p>\n\n<p>Please give this a try...</p>\n\n<pre><code>With ws4\n    finalrow4 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    With .Range(.Cells(6, 1), .Cells(finalrow4, 8))\n     .Sort Key1:=.Cells(6, 2), order1:=xlDescending, Header:=xlGuess\n     .Sort Key1:=.Cells(6, 8), order1:=xlDescending, _\n           Key2:=.Cells(6, 6), order2:=xlDescending, _\n           Key3:=.Cells(6, 4), order3:=xlDescending, Header:=xlGuess\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8899579, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-j_k8PyFVxbI/AAAAAAAAAAI/AAAAAAAAAF0/dIHpvWPbBkQ/photo.jpg?sz=128", "display_name": "Creakush Coliko", "link": "https://stackoverflow.com/users/8899579/creakush-coliko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 48075882, "answer_count": 1, "score": 1, "last_activity_date": 1514977346, "creation_date": 1514974919, "question_id": 48075440, "link": "https://stackoverflow.com/questions/48075440/exl-vba-range-sort-error", "title": "Exl vba - range sort error", "body": "<p>I have two range-sort parts in my code:</p>\n\n<pre><code>With ws1 \n\n  finalrow1 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n   With .Range(.Cells(6, 1), .Cells(finalrow1, 9))\n    .Sort Key1:=.Cells(6, 8), Order1:=xlDescending, _\n          Key2:=.Cells(6, 6), order2:=xlDescending, _\n          Key3:=.Cells(6, 2), order3:=xlDescending, Header:=xlGuess\n   End With\n\nEnd With\n\nWith ws4\n\nfinalrow4 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n   With .Range(.Cells(6, 1), .Cells(finalrow4, 8))\n   .Sort Key1:=.Cells(6, 8), Order1:=xlDescending, _\n         Key2:=.Cells(6, 6), order2:=xlDescending, _\n         Key3:=.Cells(6, 4), order3:=xlDescending, _\n         Key4:=.Cells(6, 2), order4:=xlDescending, Header:=xlGuess\n   End With\n\nEnd With\n</code></pre>\n\n<p>Where <code>ws1</code> and <code>ws4</code> are:</p>\n\n<pre><code>Set ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet ws4 = ThisWorkbook.Sheets(\"Sheet4\")\n</code></pre>\n\n<p>On the second \"sort\" I get <code>Application-defined or object-defined error</code>. This is just a part of the code.\nI also have <code>ws2</code> and <code>ws3</code> that are in another excel file.\nIs the problem in range selection or in sheet selection?</p>\n"}, {"tags": ["vba", "image", "excel", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 810, "user_id": 4055021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LAQh8.jpg?s=128&g=1", "display_name": "abybaddi009", "link": "https://stackoverflow.com/users/4055021/abybaddi009"}, "is_accepted": false, "score": 2, "last_activity_date": 1514974652, "creation_date": 1514974652, "answer_id": 48075371, "question_id": 48075370, "link": "https://stackoverflow.com/questions/48075370/how-to-insert-multiple-hyperlinks-in-a-single-cell/48075371#48075371", "title": "How to insert multiple hyperlinks in a single cell?", "body": "<p>We can accomplish this by inserting small images in the cell and adjusting them appropriately.</p>\n\n<p>The user will be able to click on <img src=\"https://i.stack.imgur.com/Dz0dl.png\" width=\"10\" height=\"10\"> and open the corresponding file. The cell finally looks like below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cF6zW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cF6zW.png\" alt=\"The images in the cell\"></a></p>\n\n<p><img src=\"https://i.stack.imgur.com/Dz0dl.png\" width=\"10\" height=\"10\">  Download <a href=\"https://i.stack.imgur.com/Dz0dl.png\" rel=\"nofollow noreferrer\">link.png</a></p>\n\n<p>The function:</p>\n\n<pre><code>'Put this in your module\n\nSub PutLinksInACell()\n    Dim rangeAddress As String\n    Dim fileArray\n    fileArray = Array(\"144234\\SDFsdf0fghf10_144234.pdf\", \"144234\\ghfrg35bzb-20-1_R04.docx\", \"144234\\xcvbebeEN 113.pdf\")\n    'rangeAddress = Selection.Cells(1, 1).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n    insertPicture Application.ActiveWorkbook.Path &amp; \"\\link.png\", \"A1\", fileArray\nEnd Sub\n\nSub insertPicture(picpath As String, cellAddress As String, fileArray As Variant)\n    '----------------------------------------------------------------------------\n    ' \"THE BURGER-WARE LICENSE\" (Revision 42):\n    ' &lt;abybaddi009 gmail.com&gt; wrote this code. As long as you retain this notice you\n    ' can do whatever you want with this stuff. If we meet some day, and you think\n    ' this stuff is worth it, you can buy me a burger in return. ;-) -Abhishek Baddi\n    '----------------------------------------------------------------------------\n\n    Dim spacing As Long, size As Long\n\n    size = Range(cellAddress).Font.size\n    spacing = size * 0.2\n\n    x_coor = Range(cellAddress).Cells(1, 1).Left\n    y_coor = Range(cellAddress).Cells(1, 1).Top\n\n    For i = 1 To 3\n        ActiveSheet.Pictures.Insert(picpath).Select\n        With Selection\n            With .ShapeRange\n                .LockAspectRatio = msoTrue\n                .Height = size\n            End With\n            .Left = x_coor + 5\n            .Top = y_coor + size * (i - 1) + spacing * i\n            .Placement = 1\n            .PrintObject = True\n        End With\n\n        ActiveSheet.Hyperlinks.Add Anchor:=Selection.ShapeRange.Item(1), Address:= _\n            fileArray(i - 1)\n\n        Range(cellAddress).Select\n    Next\n    Range(cellAddress).HorizontalAlignment = xlLeft\n    Range(cellAddress).VerticalAlignment = xlTop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 810, "user_id": 4055021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LAQh8.jpg?s=128&g=1", "display_name": "abybaddi009", "link": "https://stackoverflow.com/users/4055021/abybaddi009"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4406, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1514974652, "creation_date": 1514974652, "question_id": 48075370, "link": "https://stackoverflow.com/questions/48075370/how-to-insert-multiple-hyperlinks-in-a-single-cell", "title": "How to insert multiple hyperlinks in a single cell?", "body": "<p>I need a way to have multiple links inside a single cell in Excel using VBA. I have an excel sheet will cells like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ep4T1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ep4T1.png\" alt=\"enter image description here\"></a></p>\n\n<p>And I need to have 3 links inside a single cell with each link pointing to a different file then how do I have multiple links a single cell?</p>\n"}, {"tags": ["excel", "vba", "merge"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1514974132, "post_id": 48075190, "comment_id": 83123964, "body": "Have you debugged this code? How do the intermediate variable values differ from what you expect? At what point do this happen?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9167511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6ceea5a1e4c85ca8175bfe1cb911fa?s=128&d=identicon&r=PG&f=1", "display_name": "stefkk", "link": "https://stackoverflow.com/users/9167511/stefkk"}, "edited": false, "score": 0, "creation_date": 1514994820, "post_id": 48076678, "comment_id": 83135646, "body": "Thanks - very helpful. Do you know if there is a way to link the data from t the consolidated sheet to the source sheets, as opposed to a paste special function?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 9167511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6ceea5a1e4c85ca8175bfe1cb911fa?s=128&d=identicon&r=PG&f=1", "display_name": "stefkk", "link": "https://stackoverflow.com/users/9167511/stefkk"}, "edited": false, "score": 0, "creation_date": 1514997908, "post_id": 48076678, "comment_id": 83137469, "body": "You can consolidate ranges into one in a variety of ways e.g. With pivottable wizard consolidating ranges, powerquery merging tables, VBA SQL joins..........think there are a few other ways including using formulas. Otherwise, what do you mean by link? I understood this as combine the data from the different sheets into one sheet as opposed to link them - though i may be misunderstanding what you mean by link!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1514980501, "last_edit_date": 1514980501, "creation_date": 1514979655, "answer_id": 48076678, "question_id": 48075190, "link": "https://stackoverflow.com/questions/48075190/excel-vba-macro-for-consolidating-data-from-multiple-sheets-based-on-sheet-names/48076678#48076678", "title": "Excel VBA macro for consolidating data from multiple sheets based on sheet names with specific text", "body": "<p>There are other changes i would make to this code but the basics are as follows; where you loop the array containing the worksheet names and do your copying.</p>\n\n<p>Note: </p>\n\n<p>1) You are picking up any worksheet name with <code>.A</code> in, not just those with it as a suffix.</p>\n\n<p>2) You might also want some error handling in case no sheets are found as then your array will end up throwing an out of bounds error.</p>\n\n<p>3) Your first paste will be to row 2 if you don't test if last row = 1.</p>\n\n<p>Looping of array:</p>\n\n<pre><code> For ws = LBound(ArrWks) To UBound(ArrWks)\n</code></pre>\n\n<p>A test for the suffix might better be </p>\n\n<pre><code>If Right$(wks.Name, 2) = \".A\" Then\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nSub compile()\n\n  SelectSheets \".A\", ThisWorkbook\n 'Some other bits and pieces here\n\nEnd Sub\n\n\nSub SelectSheets(sht As String, Optional wbk As Workbook)\n\nDim wks As Worksheet\nDim ArrWks() As String\nDim i As Long\n\nIf wbk Is Nothing Then Set wbk = ActiveWorkbook\n\nReDim ArrWks(0 To Worksheets.Count - 1)\n\nFor Each wks In Worksheets\n\n    If InStr(1, wks.Name, sht) &gt; 0 Then\n        ArrWks(i) = wks.Name\n        i = i + 1\n    End If\n\nNext wks\n\nReDim Preserve ArrWks(i - 1)\n\nDim ws As Long\n\nFor ws = LBound(ArrWks) To UBound(ArrWks)\n\n    Worksheets(ArrWks(ws)).Range(\"D36:CT46\").Copy\n    Worksheets(\"Summary\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n\nNext ws\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9167511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6ceea5a1e4c85ca8175bfe1cb911fa?s=128&d=identicon&r=PG&f=1", "display_name": "stefkk", "link": "https://stackoverflow.com/users/9167511/stefkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2378, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514980501, "creation_date": 1514973994, "last_edit_date": 1514974082, "question_id": 48075190, "link": "https://stackoverflow.com/questions/48075190/excel-vba-macro-for-consolidating-data-from-multiple-sheets-based-on-sheet-names", "title": "Excel VBA macro for consolidating data from multiple sheets based on sheet names with specific text", "body": "<p>I have an Excel workbook that has the potential for a large number of sheets to be added in or removed. Each of these will have a standard suffix, let's call this \".A\"</p>\n\n<p>What I would like is a macro that for each worksheet with this suffix, copies all data from a selected range on each worksheet (say:A1:X50), copies it to a new consolidated worksheet, moves to the next line on the consolidated sheet and repeats for each subsequent worksheet. So far, I have this... but it doesn't work.</p>\n\n<pre><code> Sub compile()\nSelectSheets \".A\", ThisWorkbook\n 'Some other bits and pieces here\nEnd Sub\n\n\nSub SelectSheets(sht As String, Optional wbk As Workbook)\n\nDim wks As Worksheet\nDim ArrWks() As String\nDim i As Long\n\nIf wbk Is Nothing Then Set wbk = ActiveWorkbook\n\nReDim ArrWks(0 To Worksheets.Count - 1)\nFor Each wks In Worksheets\n    If InStr(1, wks.Name, sht) &gt; 0 Then\n        ArrWks(i) = wks.Name\n        i = i + 1\n    End If\nNext wks\nReDim Preserve ArrWks(i - 1)\nSheets(ArrWks).Select\n\nFor Each ws In Sheets(ArrWks)\n\n            ws.Range(\"D36:CT46\").Copy\n            Worksheets(\"Summary\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteValues)\n            Next ws\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1167, "user_id": 7675683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dZE7OcdTDRU/AAAAAAAAAAI/AAAAAAAAACo/XOwRcFSsn8A/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/7675683/phil"}, "is_accepted": true, "score": 2, "last_activity_date": 1514979940, "last_edit_date": 1514979940, "creation_date": 1514979529, "answer_id": 48076645, "question_id": 48075156, "link": "https://stackoverflow.com/questions/48075156/cells-accept-only-specific-values-written/48076645#48076645", "title": "Cells accept only specific values written", "body": "<p>You could use RegEx to test the cell value. You could run the following macro to see how it works.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">here</a> for how to set up RegEx in Excel.  </p>\n\n<pre><code>Sub Test_Reg()\nDim regEx As New RegExp\nDim strPattern As String: strPattern = \"[0-9]{3}.[0-9]{3}.[0-9]{3}\"\n'Note: if you want to exact match 9 numbers with two dots, \n'      then use strPattern = \"^[0-9]{3}.[0-9]{3}.[0-9]{3}$\"\nstrInput1 = \"111.111.111\"\nstrInput2 = \"1234.1234.1234\"\nstrInput3 = \"12.12.12\"\nstrInput4 = \"12a.12a.12a\"\n\n\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n    MsgBox (regEx.Test(strInput1))\n    MsgBox (regEx.Test(strInput2))\n    MsgBox (regEx.Test(strInput3))\n    MsgBox (regEx.Test(strInput4))\n\nEnd Sub\n</code></pre>\n\n<p>Then your code could be modified like this:</p>\n\n<pre><code>Dim regEx As New RegExp\nDim strPattern As String: strPattern = \"[0-9]{3}.[0-9]{3}.[0-9]{3}\"\n'Note: if you want to exact match 9 numbers with two dots, \n'      then use strPattern = \"^[0-9]{3}.[0-9]{3}.[0-9]{3}$\"\nWith regEx\n    .Global = True\n    .MultiLine = True\n    .IgnoreCase = False\n    .Pattern = strPattern\nEnd With\nDim cell As Range\n     Application.EnableEvents = False\n     For Each cell In Target\n         If Not Application.Intersect(cell, Range(\"a1:a50\")) Is Nothing Then\n           If (NOT regEx.Test(cell.Value)) Then\n               cell.Interior.Color = RGB(0, 0, 255)\n\n       Else\n\n           cell.Interior.Color = RGB(1000, 1000, 1000)\n           End If\n        End If\n   Next cell\n   Application.EnableEvents = True\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 48076645, "answer_count": 1, "score": 1, "last_activity_date": 1514979940, "creation_date": 1514973872, "question_id": 48075156, "link": "https://stackoverflow.com/questions/48075156/cells-accept-only-specific-values-written", "title": "Cells accept only specific values written", "body": "<p>I just started using vba and I was wondering if I can get some guidance here. I am trying to set the range a1:a50 to accept only numbers written like this: i.e. 111.111.111 or 231.432.212. I set this by using %%%.%%%.%%% as I read that % is defined as a number in VBA.</p>\n\n<p>However, using this format %%%.%%%.%%% does not do the job. Can anyone guide me to fix this if it is possible? Must appreciated.</p>\n\n<pre><code>Dim cell As Range\n     Application.EnableEvents = False\n        For Each cell In Target\n         If Not Application.Intersect(cell, Range(\"a1:a50\")) Is Nothing Then\n           If Not cell.Value = %%%.%%%.%%% Then\n               cell.Interior.Color = RGB(0, 0, 255)\n\n       Else\n\n           cell.Interior.Color = RGB(1000, 1000, 1000)\n           End If\n        End If\n   Next cell\n    Application.EnableEvents = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "edited": false, "score": 0, "creation_date": 1514973577, "post_id": 48075031, "comment_id": 83123661, "body": "Share your code."}, {"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "reply_to_user": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "edited": false, "score": 0, "creation_date": 1514973962, "post_id": 48075031, "comment_id": 83123862, "body": "I have just tried using data validation: <a href=\"https://www.extendoffice.com/documents/excel/3843-excel-restrict-value-based-on-another-cell.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>  But it just restricts input, it doesn&#39;t blank the cells. And I don&#39;t know how to  make the drop down list only occur when the other cell is anything but &quot;Nothing&quot;."}, {"owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "edited": false, "score": 0, "creation_date": 1514974095, "post_id": 48075031, "comment_id": 83123939, "body": "You can use visible property ."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1514981171, "post_id": 48075568, "comment_id": 83127775, "body": "Have you tested this MarcinSzaleniec? When I choose &quot;Nothing&quot; the cell goes blank, but if I choose something else, it says #VALUE!, that is, no drop down list presents itself."}, {"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1514983713, "post_id": 48075568, "comment_id": 83129166, "body": "In my case my list contains 2 values. So I just mark those 2 cells and define their name - Correct?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1514984641, "post_id": 48075568, "comment_id": 83129712, "body": "just select them and type name in address box in left top corner"}, {"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1514986827, "post_id": 48075568, "comment_id": 83130942, "body": "I must be doing something wrong. The list appears when choose something other than &quot;Nothing&quot;. But when I choose &quot;Nothing&quot;, the latest input in the list is visible, however, the list is no longer active. In other words, it doesn&#39;t seem to go blank. I hope you have an answer. And thanks for your help!"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1514987958, "last_edit_date": 1514987958, "creation_date": 1514975386, "answer_id": 48075568, "question_id": 48075031, "link": "https://stackoverflow.com/questions/48075031/blank-cell-and-restrict-input-if-other-cell-is-nothing-otherwise-have-drop-do/48075568#48075568", "title": "Blank cell and restrict input if other cell is &quot;Nothing&quot;. Otherwise have drop down list", "body": "<p>Type your drop down list values in range and name it, let's say MyList. Then use name manager to create another name, let say RestrictIfNothing. In the RefersTo window type formula:</p>\n\n<pre><code>=IF(Sheet1!$A$1=\"Nothing\", \"\", MyList)\n</code></pre>\n\n<p>Remember, address must be with name of sheet. If you want to copy cell with validation, consider removing $$. For clarity, see picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VRjNL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VRjNL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then set validation on your cell, chose list and =RestrictIfNothing. Names are case sensitive, remember capitalisation. </p>\n\n<p>To clear B1 cell, paste following code to your worksheet (right click on tab and chose 'View Code')</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address &lt;&gt; \"$A$1\" Then Exit Sub\n    If UCase(Target) = \"NOTHING\" Then Target.Offset(, 1) = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1514976454, "creation_date": 1514976454, "answer_id": 48075851, "question_id": 48075031, "link": "https://stackoverflow.com/questions/48075031/blank-cell-and-restrict-input-if-other-cell-is-nothing-otherwise-have-drop-do/48075851#48075851", "title": "Blank cell and restrict input if other cell is &quot;Nothing&quot;. Otherwise have drop down list", "body": "<p>You might paste the code below into the code sheet of the worksheet on which you have your two dropdowns. It will take the following action.</p>\n\n<ol>\n<li>When A1 is set to \"Nothing\", B1 will be made blank</li>\n<li><p>When you select B1 while A1 is \"Nothing\" the selection will jump to A1</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Const ControlCell As String = \"A1\"          ' address of dropdown A\nConst TargetCell As String = \"B1\"           ' address of dropdown B\nConst KeyWord As String = \"nothing\"\n</code></pre>\n\n<p>Private Sub Worksheet_Change(ByVal Target As Range)\n    ' 03 Jan 2018</p>\n\n<pre><code>With Target\n    If .Address = Range(ControlCell).Address Then\n        If StrComp(.Value, KeyWord, vbTextCompare) = 0 Then\n            Application.EnableEvents = False\n            Range(TargetCell).ClearContents\n            Application.EnableEvents = True\n        End If\n    End If\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    ' 03 Jan 2018</p>\n\n<pre><code>With Target\n    If .Address = Range(TargetCell).Address Then\n        If StrComp(Range(ControlCell).Value, KeyWord, vbTextCompare) = 0 Then\n            Application.EnableEvents = False\n            Range(ControlCell).Select\n            Application.EnableEvents = True\n        End If\n    End If\nEnd With\n</code></pre>\n\n<p>End Sub</p></li>\n</ol>\n\n<p>So, in fact, the dropdown in B1 isn't deleted. It is just invisible and inaccessible.</p>\n"}], "owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514987958, "creation_date": 1514973482, "last_edit_date": 1531164843, "question_id": 48075031, "link": "https://stackoverflow.com/questions/48075031/blank-cell-and-restrict-input-if-other-cell-is-nothing-otherwise-have-drop-do", "title": "Blank cell and restrict input if other cell is &quot;Nothing&quot;. Otherwise have drop down list", "body": "<p>If fx A1 is a drop down list and you choose \"Nothing\", then B1 should become blank and input should be restricted. If A1 is anything but \"Nothing\", then B1 should contain a drop down list.</p>\n\n<p>I have tried using data validation, but I don't seem to be able to do it exactly how I want it.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "edited": false, "score": 0, "creation_date": 1514972279, "post_id": 48074425, "comment_id": 83122905, "body": "another option would be that I extract the filter from Highest and Second Highest Max to some cells in the PIVOT sheet and then filtering the pivot date column based on the values in these cells. Trying that now.."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "edited": false, "score": 0, "creation_date": 1515055836, "post_id": 48078355, "comment_id": 83157544, "body": "But why would the second variable (Second_Highest_Max) cause an error? The syntax is basically the same compared to Highest_Max, only that a COUNTIF and MAX function."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "edited": false, "score": 0, "creation_date": 1515071011, "post_id": 48078355, "comment_id": 83166448, "body": "Did you read my edit? The syntax is <b>almost</b> the same except for a very important thing that you are missing entirely. I explained it in my answer."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1514986287, "last_edit_date": 1514986287, "creation_date": 1514985970, "answer_id": 48078355, "question_id": 48074425, "link": "https://stackoverflow.com/questions/48074425/vba-filter-pivot-table-according-to-previously-defined-variable/48078355#48078355", "title": "VBA: filter pivot table according to previously defined variable", "body": "<p>I can't say if this is the issue for sure, but my suspicion is that you are unable to filter your pivot using 'Highest_Max' because it is a string representation of a date, and not a true <code>Date</code> (check your locals window and you should see it there). The <code>Format</code> function will return a formatted string, but if the pivot table recognizes these values as true dates, it won't know what you mean when you pass it a string.</p>\n\n<p>For what it is worth, you would likely be better off writing a function to return the two most recent dates (their value, not their string representation). For me at least, the use of <code>Application.WorksheetFunction</code> tends to be a code smell.</p>\n\n<p>You'll also want to make sure you <strong>declare your variables</strong>. You can force declaration by adding <code>Option Explicit</code> to the top of your module. This will force a compile-time error for undeclared variables (I can't tell you how many times this will squash an otherwise time sucking bug).</p>\n\n<p><strong>EDIT:</strong> Completely missed that your error is because of the <code>WorksheetFunction</code>. This seems to be the line causing the issue:</p>\n\n<pre><code>Second_Highest_Max = Format(WorksheetFunction.Large(.Range(\"A:A\"), WorksheetFunction.CountIf(.Range(\"A:A\"), WorksheetFunction.Max(.Range(\"A:A\"))) + 1), \"Short Date\")\n</code></pre>\n\n<p>Note that <code>.Range(\"\")</code> is not fully qualified (I assume you intended to use a <code>With</code> block, but that is missing from your code). This means that the variable being passed to the <code>array</code> argument of the <code>WorksheetFunction.Large</code> function will not be an array, and in turn you'll see the function return an error.</p>\n"}], "owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514986287, "creation_date": 1514971143, "last_edit_date": 1514971299, "question_id": 48074425, "link": "https://stackoverflow.com/questions/48074425/vba-filter-pivot-table-according-to-previously-defined-variable", "title": "VBA: filter pivot table according to previously defined variable", "body": "<p>I have the following situation: need an VBA formula which filters a raw data sheet (HISTORICALS) for the two newest dates (already done). Then, the respective pivot (called PivotTable1 located in PIVOT sheet) should be filtered on these two dates. The respective column where the dates are located is called \"ipg:date\". Here is my code:</p>\n\n<pre><code>Sub Select_Last_Two_Days()\n\n' select the PIVOT worksheet\n\nWith Worksheets(\"PIVOT\")    \n' select two highest dates\n    Highest_Max = Format(WorksheetFunction.Large(Worksheets(\"HISTORICALS\").Range(\"A:A\"), 1), \"Short Date\")\n    Second_Highest_Max = Format(WorksheetFunction.Large(.Range(\"A:A\"), WorksheetFunction.CountIf(.Range(\"A:A\"), WorksheetFunction.Max(.Range(\"A:A\"))) + 1), \"Short Date\")\n    Debug.Print Highest_Max, Second_Highest_Max\n\n    ' filter pivot table for two highest dates\n    Worksheets(\"PIVOT\").PivotTables(\"PivotTable1\").PivotFields(\"ipg:date\"). _\n        ClearAllFilters\n    Worksheets(\"PIVOT\").PivotTables(\"PivotTable1\").PivotFields(\"ipg:date\"). _\n        PivotFilters.Add Type:=xlValueEquals, Value1:=Highest_Max, Value2:=Second_Highest_Max\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The error I receive is:</p>\n\n<blockquote>\n  <p>Unable to get the Large property of the WorksheetFunction class</p>\n</blockquote>\n\n<p>I assume that <code>xlValueEquals</code> is not the right way to filter on my previously defined variables, but cannot find another filtering command which works. </p>\n\n<p>Can someone direct me into the right direction? </p>\n"}, {"tags": ["vba", "excel", "loops", "filesystemobject"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514971161, "post_id": 48074254, "comment_id": 83122347, "body": "You have assigned too many meanings to the word <code>subfolders</code> which is both a single subfolder and the subfolder collection. Try to avoid variable names which VBA is using."}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1514973542, "post_id": 48074914, "comment_id": 83123637, "body": "Same for <code>For Each CurrFile In CurrFile</code>"}], "tags": [], "owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "is_accepted": false, "score": 0, "last_activity_date": 1514973048, "creation_date": 1514973048, "answer_id": 48074914, "question_id": 48074254, "link": "https://stackoverflow.com/questions/48074254/why-wont-my-code-open-multiple-files-vba/48074914#48074914", "title": "Why wont my code open multiple files vba", "body": "<p>See your statement:</p>\n\n<pre><code>:\nFor Each subfolders In subfolders\n:\n</code></pre>\n\n<p>Obviously, there is one and only one object <code>subfolders</code> in <code>subfolders</code>.</p>\n\n<p>As Variatus suggest, try to exercise a better naming policy for your variables.</p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1514977610, "creation_date": 1514977610, "answer_id": 48076134, "question_id": 48074254, "link": "https://stackoverflow.com/questions/48074254/why-wont-my-code-open-multiple-files-vba/48076134#48076134", "title": "Why wont my code open multiple files vba", "body": "<p>There's lots of over-<code>Set</code>ting going on here, it makes for easier reading but is mostly unnecessary. For instance, as you don't use your <code>Folder</code> object other than to then get the Subfolders, instead of:</p>\n\n<pre><code>Set Folder = fso.GetFolder(\"\\\\My Documents\\Output files\\analysis-tool-development\")\nSet subfolders = Folder.subfolders\n</code></pre>\n\n<p>You could just:</p>\n\n<pre><code>Set subfolders = fso.GetFolder(\"\\\\My Documents\\Output files\\analysis-tool-development\").subfolders\n</code></pre>\n\n<p>But assuming you want to keep it easy to read etc., I've gone through the code and relabeled your objects etc. to a) differentiate between vba specific wording and b) identify parent/child like ownership:</p>\n\n<pre><code>Sub LoopSubfoldersAndFiles()\n    Dim fso As Object\n    Dim myTopFolder As Object\n    Dim mySubFolders As Object\n    Dim mySingleFolder As Object\n    Dim myFileCollection As Object\n    Dim mySingleFile As Object\n    Dim myFilePattern As String\n    Dim wb As Workbook\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set myTopFolder = fso.GetFolder(\"\\\\My Documents\\Output files\\analysis-tool-development\")\n    Set mySubFolders = myTopFolder.subfolders\n    myFilePattern = \"effect00*.dat\"\n\n    For Each mySingleFolder In mySubFolders\n\n    Set myFileCollection = mySingleFolder.Files\n\n        For Each mySingleFile In myFileCollection\n            If mySingleFile.Name Like myFilePattern Then\n                Set wb = Workbooks.Open(mySingleFolder.Path &amp; \"\\\" &amp; mySingleFile.Name)\n            End If\n        Next\n\n    Next\n\n    Set fso = Nothing\n    Set myTopFolder = Nothing\n    Set mySubFolders = Nothing\n    Set mySubFolders = Nothing\n    Set mySingleFolder = Nothing\n    Set myFileCollection = Nothing\n    Set mySingleFile = Nothing\n\n    With Application\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Lastly, I've left them in but there is a block of <code>Set xxx = Nothing</code> which many would argue is not necessary. It looks neat/tidy but I remember reading somewhere that <code>End Sub</code> will clear these out anyway.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 48076134, "answer_count": 2, "score": 0, "last_activity_date": 1514977610, "creation_date": 1514970508, "question_id": 48074254, "link": "https://stackoverflow.com/questions/48074254/why-wont-my-code-open-multiple-files-vba", "title": "Why wont my code open multiple files vba", "body": "<p>I have a code that is supposed to open all the files called \"effect00*\" in a file path however it only ever opens the first file it finds but I want it to open them all does anyone know why my code wont do this?</p>\n\n<p>My code is:  </p>\n\n<pre><code>Sub LoopSubfoldersAndFiles()\nDim fso As Object\nDim Folder As Object\nDim subfolders As Object\nDim MyFile As String\nDim wb As Workbook\nDim CurrFile As Object\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .Calculation = xlCalculationManual\nEnd With\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet Folder = fso.GetFolder(\"\\\\My Documents\\Output files\\analysis-tool-development\")\nSet subfolders = Folder.subfolders\nMyFile = \"effect00*.dat\"\n\nFor Each subfolders In subfolders\n\nSet CurrFile = subfolders.Files\n\n    For Each CurrFile In CurrFile\n        If CurrFile.Name Like MyFile Then\n            Set wb = Workbooks.Open(subfolders.Path &amp; \"\\\" &amp; MyFile)\n        End If\n    Next\n\nNext\n\nSet fso = Nothing\nSet Folder = Nothing\nSet subfolders = Nothing\n\nWith Application\n    .EnableEvents = True\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 14066, "user_id": 6426692, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KDZsR.jpg?s=128&g=1", "display_name": "Ilyes", "link": "https://stackoverflow.com/users/6426692/ilyes"}, "edited": false, "score": 2, "creation_date": 1514971300, "post_id": 48073871, "comment_id": 83122431, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42297866/error-macros-is-not-available-in-this-workbook-or-all-macro-may-be-disabled\">error &quot;Macros is not available in this workbook or all macro may be disabled</a>"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 14066, "user_id": 6426692, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KDZsR.jpg?s=128&g=1", "display_name": "Ilyes", "link": "https://stackoverflow.com/users/6426692/ilyes"}, "edited": false, "score": 0, "creation_date": 1514975364, "post_id": 48073871, "comment_id": 83124648, "body": "@Sami it is not a duplicate and please read (WITH UNDERSTANDING) what I have asked and done up to date and then compare against this alleged &quot;duplicate&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1514970573, "post_id": 48074137, "comment_id": 83122082, "body": "Unfortunately it&#39;s not working. There is even more errors now."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1514971276, "post_id": 48074137, "comment_id": 83122409, "body": "Now it tells me that &quot;Sorry, we couldn&#39;t find the file. Is it possible it was moved, renamed or deleted?&quot;"}, {"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1514971943, "post_id": 48074137, "comment_id": 83122750, "body": "You should modify the c:\\temp I used in the example. Where are your alpha and beta.xlsm files"}], "tags": [], "owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "is_accepted": false, "score": 0, "last_activity_date": 1514970015, "creation_date": 1514970015, "answer_id": 48074137, "question_id": 48073871, "link": "https://stackoverflow.com/questions/48073871/cannot-run-the-macro-the-macro-may-not-be-available-or-all-macros-may-be-disab/48074137#48074137", "title": "Cannot run the macro. &quot;The macro may not be available or all macros may be disabled&quot;", "body": "<p>Make sure you specify the full path to the .xlsm files (here in C:\\temp) otherwise current directory is used.</p>\n\n<p>To run the macro, remove the path (only xlsm file name)</p>\n\n<pre><code>Sub Execute()\n\n    Workbooks.Open Filename:=\"C:\\Temp\\Beta.xlsm\"\n    Application.Run \"Beta.xlsm!Macro\"\n\n    Workbooks.Open Filename:=\"C:\\Temp\\Alpha.xlsm\"\n    Application.Run \"Alpha.xlsm!Macro1\"\n\n    ThisWorkbook.SaveChanges = False\n\n    Application.Quit\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1514970246, "post_id": 48074149, "comment_id": 83121929, "body": "Macros are already enabled because the <code>execute()</code> macro is throwing the error."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1514970539, "post_id": 48074149, "comment_id": 83122067, "body": "I have already done it MarcinSzaleniec and it has been mentioned in my original question."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1514970089, "creation_date": 1514970089, "answer_id": 48074149, "question_id": 48073871, "link": "https://stackoverflow.com/questions/48073871/cannot-run-the-macro-the-macro-may-not-be-available-or-all-macros-may-be-disab/48074149#48074149", "title": "Cannot run the macro. &quot;The macro may not be available or all macros may be disabled&quot;", "body": "<p>on the ribbon click DEVELOPER --> Macro Security (yellow triangle with exclamation mark)--> Macro Setting --> Enable all macros.</p>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1517350143, "creation_date": 1517350143, "answer_id": 48531332, "question_id": 48073871, "link": "https://stackoverflow.com/questions/48073871/cannot-run-the-macro-the-macro-may-not-be-available-or-all-macros-may-be-disab/48531332#48531332", "title": "Cannot run the macro. &quot;The macro may not be available or all macros may be disabled&quot;", "body": "<p>I have reinstalled the entire MS Office package. Now it works. I have no idea what caused this issue. There was no other solution to it. I have applied everything that has been mentioned in this and other posts. Thanks for ur time tho. </p>\n"}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16313, "favorite_count": 0, "accepted_answer_id": 48531332, "answer_count": 3, "score": -1, "last_activity_date": 1517350143, "creation_date": 1514968902, "last_edit_date": 1516458030, "question_id": 48073871, "link": "https://stackoverflow.com/questions/48073871/cannot-run-the-macro-the-macro-may-not-be-available-or-all-macros-may-be-disab", "title": "Cannot run the macro. &quot;The macro may not be available or all macros may be disabled&quot;", "body": "<p>This topic has been already mentioned, however without a solution. I have a very simple Macro calling other workbooks and their macros to execute:</p>\n\n<pre><code>Sub Execute()\n\nWorkbooks.Open Filename:=\"C:Beta.xlsm\"\nApplication.Run \"C:Beta.xlsm!Macro\"\n\nWorkbooks.Open Filename:=\"C:Alpha.xlsm\"\nApplication.Run \"C:Alpha.xlsm!Macro1\"\n\nThisWorkbook.SaveChanges = False\n\nApplication.Quit\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that, now I receive an <code>error 1004</code> with a message: <code>Cannot run the macro The macro may not be available or all macros may be disabled.</code> </p>\n\n<p>PS. I have already enabled Macros and ticked the box in Trust Centre (still having error).</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1514968354, "post_id": 48073734, "comment_id": 83121058, "body": "This usually happens if a record is unchanged, or locked by another user. Can one of those be the case?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7867367"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1514978733, "post_id": 48073734, "comment_id": 83126463, "body": "@ErikvonAsmuth well, the DB is not shared so I am the only user that is working on it. The only &quot;interface&quot; with that DB is the form that I am using. So it should be locked for that reason. The &quot;funny&quot; thing is that now I am having the same error with <code>DoCmd.RunCommand acCmdCopy</code> ufffffff"}], "owner": {"user_type": "does_not_exist", "display_name": "user7867367"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1373, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1514978921, "creation_date": 1514968164, "last_edit_date": 1514978921, "question_id": 48073734, "link": "https://stackoverflow.com/questions/48073734/access-vba-the-command-or-action-saverecord-isnt-available-now", "title": "Access VBA: The Command or Action &#39;SaveRecord&#39; isn&#39;t available now", "body": "<p>In my Access form I have a <code>Save</code> button that executes the following command:</p>\n\n<pre><code>DoCmd.RunCommand acCmdSaveRecord\n</code></pre>\n\n<p>sometimes it happens that I get the error:</p>\n\n<pre><code>The Command or Action 'SaveRecord' isn't available now\n</code></pre>\n\n<p>I actually don't know why. In these cases, I use to close and reopen the Access file a couple of times and then it works.</p>\n\n<p>Can someone explain to me why this happens?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Well, now I have the same problem with the <code>Copy</code> command:</p>\n\n<pre><code>    DoCmd.RunCommand acCmdSelectRecord\n    DoCmd.RunCommand acCmdCopy\n    DoCmd.RunCommand acCmdRecordsGoToNew\n    DoCmd.RunCommand acCmdSelectRecord\n    DoCmd.RunCommand acCmdPaste\n</code></pre>\n\n<p>The same error message:</p>\n\n<pre><code>The Command or Action 'Copy' isn't available now\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514969689, "post_id": 48073513, "comment_id": 83121681, "body": "A comment that changes its value based on the selected item of the dropdown."}], "answers": [{"comments": [{"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514975583, "post_id": 48075069, "comment_id": 83124763, "body": "Thanks. Works for one cell. But I need this or a whole range (=column)."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1514978297, "last_edit_date": 1514978297, "creation_date": 1514973623, "answer_id": 48075069, "question_id": 48073513, "link": "https://stackoverflow.com/questions/48073513/how-to-add-dynamic-comment-to-column-with-validation-list/48075069#48075069", "title": "How to add dynamic comment to column with validation list?", "body": "<p>The code below presumes that you have two overlapping named ranges. I called one <code>DropList</code> and the other one <code>Comments</code>. The <code>Comments</code> range comprises two columns, the first of which is declared as <code>DropList</code>. For example,</p>\n\n<pre><code>DropList = M2:M10 (any sheet)\nCommments = M2:N10\n</code></pre>\n\n<p><code>DropList</code> has all the items in your data validation. Enter <code>=DropList</code> in place of an actual list of items. This is to ensure that the list in your dropdown is guaranteed to be the same as what the code needs to find the comments. Write the comments to be associated with each dropdown item in the second column of the <code>Comments</code> range. The best place for the list is on a dedicated sheet that you keep hidden. Avoid placing it in the invisible part of another sheet because that would slow down your workbook.</p>\n\n<p>Place the code below in the code sheet of the worksheet on which you have your dropdown. Observe that you can set any address for both the dropdown and the cell where you want the comment.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    ' 03 Jan 2018\n\n    Const DropColumn As String = \"J\"          ' location of drop-down\n    Const CommentColumn As String = \"K\"       ' location of comment\n\n    Dim DropVal As Variant\n    Dim Commt As String\n    Dim Test As Long\n\n    With Target\n        If .Column = Columns(DropColumn).Column Then\n            On Error Resume Next\n            Test = .Validation.Type\n            If Err Then\n                Err.Clear\n            Else\n                DropVal = .Value\n                If Len(Trim(DropVal)) Then\n                    Commt = Application.VLookup(DropVal, Range(\"Comments\"), 2, False)\n                    With Cells(.Row, Columns(CommentColumn).Column)\n                        .ClearComments\n                        .AddComment Commt\n                    End With\n                End If\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>The above code was modified to work on all cells with validation in the <code>DropColumn</code></p>\n"}, {"tags": [], "owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "is_accepted": false, "score": 0, "last_activity_date": 1514976031, "creation_date": 1514976031, "answer_id": 48075729, "question_id": 48073513, "link": "https://stackoverflow.com/questions/48073513/how-to-add-dynamic-comment-to-column-with-validation-list/48075729#48075729", "title": "How to add dynamic comment to column with validation list?", "body": "<p>Based on @Variatus answer this code works for a longer ranger. Not only one cell</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim DropVal As Variant\n    Dim Commt As String\n\n\n Set KeyCells = Range(\"E1:E1000\")\n\n    With Target\n\n\n        If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n            DropVal = .Value\n            If Len(Trim(DropVal)) Then\n                Commt = Application.VLookup(DropVal, Range(\"Comments\"), 2, False)\n                With Range(Target.Address)\n                    .ClearComments\n                    .AddComment Commt\n                End With\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1514978297, "creation_date": 1514967093, "last_edit_date": 1514967435, "question_id": 48073513, "link": "https://stackoverflow.com/questions/48073513/how-to-add-dynamic-comment-to-column-with-validation-list", "title": "How to add dynamic comment to column with validation list?", "body": "<p>Given an excel column with a validation list (dropdown).\nHow do I show a dynamic comment based on the selected option?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "is_accepted": false, "score": 0, "last_activity_date": 1514968630, "creation_date": 1514968630, "answer_id": 48073817, "question_id": 48073489, "link": "https://stackoverflow.com/questions/48073489/excel-vba-how-do-i-open-an-excel-file-without-running-macro-but-want-macros-to/48073817#48073817", "title": "Excel VBA: How do I open an Excel file without running macro but want macros to run when I activate workbook?", "body": "<p>Try adding this before <code>SubName</code> :</p>\n\n<pre><code>Do Until Application.Ready = True\nDoEvents: Loop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1514983703, "creation_date": 1514983703, "answer_id": 48077754, "question_id": 48073489, "link": "https://stackoverflow.com/questions/48073489/excel-vba-how-do-i-open-an-excel-file-without-running-macro-but-want-macros-to/48077754#48077754", "title": "Excel VBA: How do I open an Excel file without running macro but want macros to run when I activate workbook?", "body": "<p>Maybe you could try the following code</p>\n\n<pre><code>Option Explicit\nDim justOpened As Boolean\n\nPrivate Sub Workbook_Activate()\n    If justOpened Then\n        justOpened = False\n    Else\n        MsgBox \"Activate\"\n        ' Your Sub here\n    End If\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    justOpened = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 9167138, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8eecdcc1e1680ce71d6764a41846cb42?s=128&d=identicon&r=PG&f=1", "display_name": "Singapore 123", "link": "https://stackoverflow.com/users/9167138/singapore-123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1514983703, "creation_date": 1514966942, "last_edit_date": 1531164843, "question_id": 48073489, "link": "https://stackoverflow.com/questions/48073489/excel-vba-how-do-i-open-an-excel-file-without-running-macro-but-want-macros-to", "title": "Excel VBA: How do I open an Excel file without running macro but want macros to run when I activate workbook?", "body": "<p>I currently have the below sub in <code>ThisWorkbook</code>. I would like to run this sub \"SubName\" whenever I activate this workbook, but <strong>don't want</strong> the macro to run when I open the file (it currently runs the \"SubName\" which causes an error because data takes about 5 seconds to load before the macro functions properly)</p>\n\n<p>Thanks!</p>\n\n<pre><code>Private Sub Workbook_Activate()\n\nSubName\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "validation"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1514964374, "post_id": 48072896, "comment_id": 83119451, "body": "There are probably some <i>additions</i> in newer versions.. if you &quot;need to to be compatible with Excel 1997&quot;, use Excel 1997.. <i>shudder</i>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1514964488, "post_id": 48072896, "comment_id": 83119490, "body": "There are multiple compatibility issues between that big count of versions. And there is <a href=\"https://msdn.microsoft.com/en-us/library/office/gg132972%28v=office.14%29.aspx\" rel=\"nofollow noreferrer\">Compatibility Checker</a> to check for. But at the end it is up to you to check the functionality in all versions which shall be supported."}, {"owner": {"reputation": 323, "user_id": 4258272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ca6c509face342009cff01ba07e6491?s=128&d=identicon&r=PG&f=1", "display_name": "Pkr", "link": "https://stackoverflow.com/users/4258272/pkr"}, "edited": false, "score": 0, "creation_date": 1522067685, "post_id": 48072896, "comment_id": 85986377, "body": "Thanks for your response. I will test it in all versions."}], "owner": {"reputation": 323, "user_id": 4258272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ca6c509face342009cff01ba07e6491?s=128&d=identicon&r=PG&f=1", "display_name": "Pkr", "link": "https://stackoverflow.com/users/4258272/pkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514965050, "creation_date": 1514964094, "last_edit_date": 1514965050, "question_id": 48072896, "link": "https://stackoverflow.com/questions/48072896/is-there-a-compatibility-issue-between-macros-and-data-validation-written-for-ex", "title": "Is there a compatibility issue between macros and Data validation written for Excel 1997-2003, 2007, 2010 and 2013?", "body": "<p>I have to do the validation in cells and at the sheet level using Excel's Data Validation and VBA which need to be compatible for excel 1997-2003 and above. </p>\n\n<p>Some features which i need to include are disabling cells, adding a new field, deleting the cells, validation of entire sheet etc.</p>\n"}, {"tags": ["vba", "formula", "bloomberg"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "edited": false, "score": 0, "creation_date": 1514988379, "post_id": 48072969, "comment_id": 83131783, "body": "Thanks a lot! Learns from it"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1514964448, "creation_date": 1514964448, "answer_id": 48072969, "question_id": 48072811, "link": "https://stackoverflow.com/questions/48072811/using-excel-vba-to-enter-a-formula-in-an-equation/48072969#48072969", "title": "Using Excel VBA, to enter a formula in an equation", "body": "<p>Try</p>\n\n<pre><code>.FormulaR1C1 = \"=RC[1]/BDP(RC[2]&amp;\"\" CORP\"\",\"\"DS036\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514964448, "creation_date": 1514963599, "question_id": 48072811, "link": "https://stackoverflow.com/questions/48072811/using-excel-vba-to-enter-a-formula-in-an-equation", "title": "Using Excel VBA, to enter a formula in an equation", "body": "<p>Using Excel, Cell of A1 is a formula which is =B1/BDP(C1&amp;\" CORP\",\"DS036\")\nWhich BDP(DS036) is a function from Bloomberg.</p>\n\n<p>However, there are bunch of rows that why I want to use Excel VBA to run the data automatically. The ways I\u2019ve tried were like the code below. But, it does not work. Could you tell me how to fix it? Appreciate.</p>\n\n<pre><code>           b = Worksheets(\"ABC\").Cells(Rows.Count, 1).End(xlUp).Row\n           Worksheets(\"ABC\").Cells(b + 1, 1).Formula = \"=\" &amp; Worksheets(\"ABC\").Cells(b + 1,2) &amp; \"/\" &amp; \"BDP(\" &amp; Worksheets(\"ABC\").Cells(b + 1, 3) &amp;\"\" CORP\"\" ,\"\"DS036\"\")\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1514965464, "post_id": 48072786, "comment_id": 83119891, "body": "<a href=\"https://stackoverflow.com/questions/20011864/how-to-find-the-first-and-second-maximum-number#20011896\" title=\"how to find the first and second maximum number%2320011896\">stackoverflow.com/questions/20011864/&hellip;</a>"}, {"owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1514965610, "post_id": 48072786, "comment_id": 83119943, "body": "Hey Axel, this won&#39;t work since the column A has over 2000 entries, so selecting LARGE(Range, 2) will just give me the second highest value, which is still the 31st. I first need a formula to filter out the distinct dates in that column and then select the two highest. Basically like the SELECT DISTINCT function in SQL.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514965776, "post_id": 48072786, "comment_id": 83120014, "body": "Can you use an array?"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1514965993, "post_id": 48072786, "comment_id": 83120102, "body": "@calicationoflife You should take the second part from answer linked by Axel. Translate this formula <code>=LARGE(E4:E9;COUNTIF(E4:E9;MAX(E4:E9))+1)</code> into VBA and your case and you&#39;re good."}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 2, "last_activity_date": 1514966730, "creation_date": 1514966730, "answer_id": 48073452, "question_id": 48072786, "link": "https://stackoverflow.com/questions/48072786/vba-find-second-largest-value/48073452#48073452", "title": "VBA: find second largest value", "body": "<p>Simply translate Barry Houdinis answer from <a href=\"https://stackoverflow.com/questions/20011864/how-to-find-the-first-and-second-maximum-number#20011896\">How to find the first and second maximum number?</a> to VBA:</p>\n\n<pre><code>Sub Select_Last_Two_Days()\n\n    With Worksheets(\"HISTORICALS\")\n        Highest_Max = Format(WorksheetFunction.Max(.Range(\"A:A\")), \"Short Date\")\n        Second_Highest_Max = Format(WorksheetFunction.Large(.Range(\"A:A\"), WorksheetFunction.CountIf(.Range(\"A:A\"), WorksheetFunction.Max(.Range(\"A:A\"))) + 1), \"Short Date\")\n        Debug.Print Highest_Max, Second_Highest_Max\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1514966824, "creation_date": 1514966824, "answer_id": 48073470, "question_id": 48072786, "link": "https://stackoverflow.com/questions/48072786/vba-find-second-largest-value/48073470#48073470", "title": "VBA: find second largest value", "body": "<p>The recommendations given in the comments are probably the simplest and least amount of code way to do things but here is another sugggestion:</p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Worksheets(\"HISTORICALS\")\n\nDim lastRow As Long\n\nlastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\nDim loopArr()\n\nloopArr = ws.Range(\"A1:A\" &amp; lastRow).Value\n\nDim maxVal As Date\n\nmaxVal = Application.WorksheetFunction.Large(ws.Range(\"A1:A\" &amp; lastRow), 1)\n\nDim i As Long\nDim secondVal As Date\n\n   For i = UBound(loopArr, 1) To LBound(loopArr, 1) Step -1\n\n        If loopArr(i, 1) &lt; maxVal Then\n          secondVal = loopArr(i, 1)\n          Exit For\n        End If\n   Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 9166952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh3.googleusercontent.com/-AKf-ILbI90E/AAAAAAAAAAI/AAAAAAAAACk/8kbGaxesW3g/photo.jpg?sz=128", "display_name": "calicationoflife", "link": "https://stackoverflow.com/users/9166952/calicationoflife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3203, "favorite_count": 1, "accepted_answer_id": 48073452, "answer_count": 2, "score": 2, "last_activity_date": 1514966824, "creation_date": 1514963477, "last_edit_date": 1514965376, "question_id": 48072786, "link": "https://stackoverflow.com/questions/48072786/vba-find-second-largest-value", "title": "VBA: find second largest value", "body": "<p>I have the following problem: I try to filter a date column (A) in a worksheet (HISTORICALS) to return the highest and second highest date value. Currently, there is dates ranging from the 25th to the 31st of December in this column. Unfortunately, below formula (using the Large function) returns the 31st two times (and not the 30th and 31st as intended).</p>\n\n<pre><code>Sub Select_Last_Two_Days()\n\n    With Worksheets(\"HISTORICALS\")\n        Highest_Max = Format(WorksheetFunction.Large(Worksheets(\"HISTORICALS\").Range(\"A:A\"), 1), \"Short Date\")\n        Second_Highest_Max = Format(WorksheetFunction.Large(Worksheets(\"HISTORICALS\").Range(\"A:A\"), 2), \"Short Date\")\n        Debug.Print Highest_Max, Second_Highest_Max\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The column has approx. 2000 rows, with dates occuring multiple times. So ideally I would want to filter for distinct values and then return the two highest dates. Any idea how I can do that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1514962999, "post_id": 48072549, "comment_id": 83118891, "body": "Apart from <code>cell.EntireRow.Copy</code> giving an &quot;object required&quot; error (which is an obvious problem) what do you mean by &quot;is not responding as expected&quot;?"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514975456, "post_id": 48072549, "comment_id": 83124699, "body": "Whatever value I am getting in DynRange, It is being present in multiple times in workbook B but I am getting only first occurrence of that row, I want all the occurrences like finding all rows having that particular value."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1514968223, "post_id": 48073500, "comment_id": 83121004, "body": "Thanks but still not getting the desired output."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1514990201, "last_edit_date": 1514990201, "creation_date": 1514966986, "answer_id": 48073500, "question_id": 48072549, "link": "https://stackoverflow.com/questions/48072549/vba-issue-in-copying-rows-from-multiple-worksheets-based-on-searching-dynamic-va/48073500#48073500", "title": "Vba issue in copying rows from multiple worksheets based on searching dynamic value and paste it in another new workbook", "body": "<p>Use this for finding all matches: </p>\n\n<pre><code>If DynRange Is Nothing Then\n     MsgBox (\"No codes found\")\nEndif\nDo While Not DynRange Is Nothing\n     'process here the recent hit\n     Set Fnd = Selection.FindNext(DynRange)\nLoop\n</code></pre>\n\n<p>If I understand your needs correctly you want to process all worksheets in B.xlsx, but you only refer to Worksheet(1). \nI would avoid using .Selection. \nYou may also consider <code>Sheets.Add</code> instead of <code>Workbooks.Add</code>.</p>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514990201, "creation_date": 1514962221, "last_edit_date": 1514963123, "question_id": 48072549, "link": "https://stackoverflow.com/questions/48072549/vba-issue-in-copying-rows-from-multiple-worksheets-based-on-searching-dynamic-va", "title": "Vba issue in copying rows from multiple worksheets based on searching dynamic value and paste it in another new workbook", "body": "<pre><code>Sub multiple()\n\n    Workbooks(\"A.xlsx\").Activate\n    lastRow11 = Range(\"I\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = lastRow11 To 1 Step -1\n\n        If i &lt;&gt; \"\" Then\n\n            Value = Workbooks(\"A.xlsx\").Worksheets(1).Cells(i, \"I\").Value\n            Workbooks(\"B.xlsx\").Activate\n            Worksheets(1).Select\n\n            Set DynRange = Selection.Find(What:=Value, LookIn:=xlFormulas, _\n          LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n          MatchCase:=False, SearchFormat:=False)\n\n            If DynRange Is Nothing Then\n                 MsgBox (\"No codes found\")\n            Else\n                cell.EntireRow.Copy\n                Workbooks.Add\n                ActiveSheet.Paste\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>In the above-mentioned code, I am trying to search the <code>\"DynRange\"</code> value (that is dynamic every time) in workbook B. The purpose is to copy the rows for which particular column is having those values from all the worksheets of workbook B and paste it to a new workbook. \nIf worksheet B has 5 worksheets the new workbook should have 5 worksheets respectively. But data in those 5 worksheets must be filtered according to the <code>\"DynRange\"</code> value.</p>\n\n<p>Also, for the next <code>\"DynRange\"</code> value. The new workbook should be added and the rest of the process should be the same.</p>\n\n<p>How can i optimize performing this task? My code is not working as expected.</p>\n"}, {"tags": ["excel", "vba", "lookup"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6604759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-2L4wXduSrFA/AAAAAAAAAAI/AAAAAAAAABM/ACFfZNK8cu4/photo.jpg?sz=128", "display_name": "Melko", "link": "https://stackoverflow.com/users/6604759/melko"}, "edited": false, "score": 0, "creation_date": 1514971561, "post_id": 48073615, "comment_id": 83122570, "body": "I think I misled you with the title of the post...    The formatting problem is only relevant to field \u201cDescription\u201d which I am able to solve with this code. The primary objective is to match the Location rates (Location1_Rate to Location7_Rate) lookup with different locations based on the text in A16.   Suppose, in the OUTPUT Sheet, if I change the location in the dropdown menu of A16 to Location_2, the rate adopted should be of Location2_Rate from the MASTER sheet. So, the problem is as good as a lookup with multiple criteria."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 41, "user_id": 6604759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-2L4wXduSrFA/AAAAAAAAAAI/AAAAAAAAABM/ACFfZNK8cu4/photo.jpg?sz=128", "display_name": "Melko", "link": "https://stackoverflow.com/users/6604759/melko"}, "edited": false, "score": 0, "creation_date": 1514976941, "post_id": 48073615, "comment_id": 83125505, "body": "OK. So your objective is to fill in description and loc. rate next to item code when a field in column D fires the sub. You have one MASTER table with all item codes and loc. rates."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1515052906, "last_edit_date": 1515052906, "creation_date": 1514967623, "answer_id": 48073615, "question_id": 48072153, "link": "https://stackoverflow.com/questions/48072153/lookup-with-multiple-criteria-and-preserve-formatting/48073615#48073615", "title": "Lookup with multiple criteria and preserve formatting", "body": "<p>To preserve formatting you should apply formatting on the target like this: </p>\n\n<pre><code>With Target.Offset(, 2)\n      .Font.Size = 12\n      .Font.Bold = True\n     whatever\n</code></pre>\n\n<p>Unfortunately format painter is not available from VBA, so if you don't know the format (or want to keep your app flexible) then you need to copy the relevant settings from the source cell, like</p>\n\n<pre><code>With Target.Offset(, 2)\n      .Font.Size = Fnd.Offset(0, 1).Font.Size\n      .Font.Bold = Fnd.Offset(0, 1).Font.Bold\n     whatever\n</code></pre>\n\n<p>There are a hell a lot of properties for formatting, good luck for finding the relevant ones. </p>\n\n<p>EDIT: Give this a try: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Fnd As Range\nDim item_row As Long\n\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Target.Column = 4 Then Exit Sub\n\nSet Fnd = Sheets(\"MASTER\").Range(\"B:B\").Find(Target.Value, , , xlWhole, , , False, , False) ' item code\nIf Fnd Is Nothing Then\n    MsgBox \"Item not found\"\n    Exit Sub\nElse\n    Fnd.Offset(, 1).Copy Target.Offset(, 2) ' desc\n    item_row = Fnd.Row  ' row of item\n    Set Fnd = Sheets(\"MASTER\").Range(\"E1:K1\").Find(Cells(\"A16\").Value, , , xlWhole, , , False, , False) ' loc name\n    If Fnd Is Nothing Then\n        MsgBox \"Location not found\"\n    Else\n        Sheets(\"MASTER\").Cells(item_row, Fnd.Column).Copy Target.Offset(0, 5)\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Notes: 1. I would replace hardcoded range and sheetname references with variables to make the sub a bit more flexible \n2. I would develop the sub to support more than 1 cell changes with a something like this: </p>\n\n<pre><code>for each c in target\n      if c.column = 4 then debug.print c.value\nnext c\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6604759, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-2L4wXduSrFA/AAAAAAAAAAI/AAAAAAAAABM/ACFfZNK8cu4/photo.jpg?sz=128", "display_name": "Melko", "link": "https://stackoverflow.com/users/6604759/melko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515052906, "creation_date": 1514960282, "last_edit_date": 1514971390, "question_id": 48072153, "link": "https://stackoverflow.com/questions/48072153/lookup-with-multiple-criteria-and-preserve-formatting", "title": "Lookup with multiple criteria and preserve formatting", "body": "<p>I have a MASTER sheet with Item Code (Col. B), Description (Col. C), Unit (Col. D), Location1_Rate (Col. E), Location2_Rate (Col. F), Location3_Rate (Col. G), Location4_Rate (Col. H), Location5_Rate (Col. I), Location6_Rate (Col. J), Location7_Rate (Col. K)\n<br/><br/>\nI work with an OUTPUT sheet configured as follows<br/>\nLocation selection (Location_1 to Location_7) as dropdown menu: A16<br/>\nItem Code: Col. D (to be manually entered)<br/>\nDescription: Col. F<br/>\nQuantity: Col. G<br/>\nUnit: Col. H<br/>\nRate: Col. I<br/>\nAmount: Col. J<br/></p>\n\n<p>Whenever I enter the Item code (Col. D) in OUTPUT sheet, the description of the item as well as the rate for the corresponding location should appear automatically in corresponding cell of Col.F and Col. I respectively. The first Item Code starts with the cell D20.\n<br/> <br/> \nSince, my objective was to preserve the formatting in the OUTPUT sheet, I used VBA code for the description field. I am successful in the VBA code for returning the rate of a single location (Location1_Rate). But, I am unable to modify the code for getting the rate of a different location(based on  the location in Cell A16). Please peruse the code and suggest.</p>\n\n<p><strong>Note</strong>: <em>I have multiple MASTER sheets for looking up the Item code and hence the VBA I mentioned takes into account lookup across multiple sheets. But, the two-dimensional lookup as described above, is only needed for the MASTER Sheet1.</em>  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Fnd As Range\nDim NotFnd As Boolean\nDim Ws As Worksheet\nNotFnd = False\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Target.Column = 4 Then Exit Sub\nApplication.EnableEvents = False\nFor Each Ws In Worksheets\nIf Not Ws.Name = \"Output\" Then\nSet Fnd = Ws.Columns(2).Find(Target.Value, , , xlWhole, , , False, , False)\nIf Not Fnd Is Nothing Then\nNotFnd = True\nFnd.Offset(, 1).Copy Target.Offset(, 2)\nExit For\nEnd If\nEnd If\nNext Ws\nIf Not NotFnd Then MsgBox Target.Value &amp; \"not found\"\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514963676, "post_id": 48072097, "comment_id": 83119145, "body": "Is this a button on a form control you are using to determine the delete criteria?  Me.CboDelete"}, {"owner": {"reputation": 1, "user_id": 8926303, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hWQ3csAFOZY/AAAAAAAAAAI/AAAAAAAADHg/VQ0M4pUMj7k/photo.jpg?sz=128", "display_name": "Solomon Campbell Jr", "link": "https://stackoverflow.com/users/8926303/solomon-campbell-jr"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514990392, "post_id": 48072097, "comment_id": 83132912, "body": "QHarr- yes Me.CboDelete is a combo box. on  a  user form. The challenge is that each range has headers above and below but the auto filter only filters the name in the cboDelete combo box."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515011320, "post_id": 48072097, "comment_id": 83144114, "body": "And you can&#39;t set up a multiselect to remove the headers instead?"}, {"owner": {"reputation": 1, "user_id": 8926303, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hWQ3csAFOZY/AAAAAAAAAAI/AAAAAAAADHg/VQ0M4pUMj7k/photo.jpg?sz=128", "display_name": "Solomon Campbell Jr", "link": "https://stackoverflow.com/users/8926303/solomon-campbell-jr"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515299828, "post_id": 48072097, "comment_id": 83245976, "body": "QHarr--mutiselect wouldn&#39;t work in this scenario due to the autofilter being deployed. I was wondering if there was a way to automatically delete the next two rows after the autofilter deletes the filtered rows"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516006141, "post_id": 48072097, "comment_id": 83501663, "body": "If you have solved your problem please post as an answer rather than edit into question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8926303, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hWQ3csAFOZY/AAAAAAAAAAI/AAAAAAAADHg/VQ0M4pUMj7k/photo.jpg?sz=128", "display_name": "Solomon Campbell Jr", "link": "https://stackoverflow.com/users/8926303/solomon-campbell-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1516843292, "creation_date": 1516843292, "answer_id": 48434225, "question_id": 48072097, "link": "https://stackoverflow.com/questions/48072097/how-to-delete-rows-that-are-hidden-during-auto-filter/48434225#48434225", "title": "How to delete rows that are hidden during auto filter", "body": "<p>The  following code solved my problem.</p>\n\n<pre><code>If Not Me.CboDelete.value = \"IMGA_UNKNOWN\" Then\n\n i = 2 Do Until Sheets(\"test sheet\").Cells(i, 1) = Empty And Sheets(\"test sheet\").Cells(i, 9) = Empty\n\nIf Sheets(\"test sheet).Cells(i, 1) = Me.CboDelete Then\n\n    j = i\n\n    Do Until Sheets(\"test sheet\").Cells(j, 1) = Empty\n    j = j + 1\n    Loop\n   Sheets(\"test sheet\").Rows(i - 1 &amp; \":\" &amp; j + 1).Delete Shift:=xlUp\n\nEnd If\n\n  End If  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8926303, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hWQ3csAFOZY/AAAAAAAAAAI/AAAAAAAADHg/VQ0M4pUMj7k/photo.jpg?sz=128", "display_name": "Solomon Campbell Jr", "link": "https://stackoverflow.com/users/8926303/solomon-campbell-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516843292, "creation_date": 1514959967, "last_edit_date": 1531164843, "question_id": 48072097, "link": "https://stackoverflow.com/questions/48072097/how-to-delete-rows-that-are-hidden-during-auto-filter", "title": "How to delete rows that are hidden during auto filter", "body": "<p>I hope someone can help with this problem. I am trying to delete two rows after an autofilter delete. this is how the data is displayed on the worksheet:</p>\n\n<pre><code>col(A)   Col(B)   Col(C)   Col(D)  Col(E)  Col(F)  Col(G)\n\nhead1    head2     head3    head4   head5   head6  head7\n\ndata     data      data     data     data   data   data  data  data  data   data\n\n                                      total orders old   data sum\n                                      total orders new   data sum   \n</code></pre>\n\n<p>I need a way to delete the total orders old and total orders new. the problem is that the range of data varies. the following code is supposed to delete the active cells after the auto filter deletes the row of data. is there a way to delete the hidden rows (total orders old and total orders new) when the auto filter filters the data row?</p>\n\n<pre><code>    With Sheet18\n\n    'delete the header for the IMGA range\n     Dim find As String: find = Me.CboDelete.value\n     Dim rng1 As Range\n\n\n     Set rng1 = Sheets(\"Jeanette 2017 Monthly Data Sets\").Cells.find(What:=find, After:=Sheets(\"Jeanette 2017 Monthly Data Sets\").Cells(1, 1), LookIn:=xlValues, Lookat:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=True)\n\n  If Not rng1 Is Nothing Then\n     rng1.Offset(-1).EntireRow.Delete\n  End If\n\n'delete the IMGA from the Monthly data set\n\n        'Apply the filter\n        .Range(\"A84:I\" &amp; .Rows.count).AutoFilter Field:=1, Criteria1:=Me.CboDelete ', Operator:=xlOr, Criteria2:=\"=\"\n\n\n        With .AutoFilter.Range\n            'On Error Resume Next\n            Set rng = .Offset(1, 0).Resize(.Rows.count - 1, 2)\n                      .SpecialCells (xlCellTypeVisible)\n            On Error GoTo 0\n            If Not rng Is Nothing Then rng.EntireRow.Delete 'Shift:=xlUp\n\n           End With\n\n'delete the total order and total imc order rows\n\n'.Range(\"A84:A2000\" &amp; .Rows).Activate\nDo Until ActiveCell.Offset(1, 0).value &lt;&gt; \"IMGA\" 'And ActiveCell.value &lt;&gt; \"\"\n\n\nIf ActiveCell.Offset(2, 0).value = \"\" Then\n'Rows(ActiveCell.Row &amp; \":\" &amp; Rows.count).Delete\n\nActiveCell.Offset(rowOffset:=4, columnOffset:=0).Activate\n'MsgBox \"what is the position of the active cell\"\n\nActiveCell.Offset(1, 0).Resize(2, 1).EntireRow.Delete\n\nEnd If\n\nLoop\nExit Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514956707, "post_id": 48071562, "comment_id": 83116738, "body": "In the Immediate Window, type in <code>?Workbooks(&quot;A.xlsx&quot;).Worksheets(1).Name</code> and press Enter.  What does it say?  Is it the name of the worksheet that you think you are referring to?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1514956856, "post_id": 48071562, "comment_id": 83116780, "body": "Or change your <code>MsgBox (Value)</code> to say <code>MsgBox Value &amp; &quot;|&quot; &amp; Workbooks(&quot;A.xlsx&quot;).Worksheets(1).Cells(i, &quot;I&quot;).Address(External:=True)</code>"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514957148, "post_id": 48071562, "comment_id": 83116888, "body": "Thanks, I got the Issue there is some hidden worksheet that&#39;s why not getting the correct value."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514957217, "post_id": 48071562, "comment_id": 83116913, "body": "LOL - that&#39;s one of the problems you have when you use a numerical index with the <code>Worksheets</code> collection"}, {"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1514973941, "post_id": 48071562, "comment_id": 83123854, "body": "<code>If i &lt;&gt; &quot;&quot; Then</code> You compare an integer with a string (&quot;&quot;) which is not ok"}, {"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "reply_to_user": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1514979155, "post_id": 48071562, "comment_id": 83126687, "body": "Please specify what kind of data you have in column &quot;I&quot;. Right now you are comparing a integer with string which is not ok as @SBF mension. Do you use Option Explicit ?"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1514995753, "post_id": 48071562, "comment_id": 83136185, "body": "No, The value type is general."}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515000351, "creation_date": 1514956521, "last_edit_date": 1515000351, "question_id": 48071562, "link": "https://stackoverflow.com/questions/48071562/vba-unable-to-get-correct-value-of-a-cell", "title": "Vba unable to get correct value of a cell", "body": "<p>I am trying to get the value of column I from the A workbook. I have closed all other workbooks but not able to get correct values. It is displaying me the term \"Balancing\" every time which is not present in the workbook A. I am not getting where that word is coming from.</p>\n\n<pre><code>Sub newapproach()\n    Set ws1 = Workbooks(\"A.xlsx\").Worksheets(1)\n    Workbooks(\"A.xlsx\").Activate\n    lastRow11 = Range(\"I\" &amp; Rows.Count).End(xlUp).Row\n    For i = lastRow11 To 1 Step -1\n        If i &lt;&gt; \"\" Then\n            Value = Workbooks(\"A.xlsx\").Worksheets(1).Cells(i, \"I\").Value\n            MsgBox (Value)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "object", "runtime", "userform"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1514960896, "creation_date": 1514960896, "answer_id": 48072270, "question_id": 48071527, "link": "https://stackoverflow.com/questions/48071527/vba-userform-object-defining-runtime-created-label-as-a-common-name-to-use-in/48072270#48072270", "title": "VBA Userform Object - Defining runtime created Label as a common name to use in sub", "body": "<p>You can use a global variable declared using <code>WithEvents</code> and set that to the label corresponding to the user's listbox selection.</p>\n\n<p>Here's a simple example with just two labels - each one is \"set\" by a separate button: </p>\n\n<pre><code>Private WithEvents ActiveLabel As MSForms.Label '&lt;&lt; ######\nDim m_sngLeftPos, m_sngTopPos\n\n'activate label1\nPrivate Sub CommandButton1_Click()\n    Set ActiveLabel = Me.Label1\nEnd Sub\n\n'activate label2\nPrivate Sub CommandButton2_Click()\n    Set ActiveLabel = Me.Label2\nEnd Sub\n\nPrivate Sub ActiveLabel_MouseDown(ByVal Button As Integer, _\n            ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    If Button = 1 Then\n        m_sngLeftPos = X\n        m_sngTopPos = Y\n    End If\nEnd Sub\n\nPrivate Sub ActiveLabel_MouseMove(ByVal Button As Integer, _\n             ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n    Dim sngLeft As Single\n    Dim sngTop As Single\n\n    If Button = 1 Then\n        With ActiveLabel\n            sngLeft = .Left + X - m_sngLeftPos\n            If sngLeft &lt; SeriesImage.Left Then sngLeft = SeriesImage.Left\n            If (sngLeft + .Width) &gt; (SeriesImage.Left + SeriesImage.Width) Then\n                sngLeft = SeriesImage.Left + SeriesImage.Width - .Width\n            End If\n            sngTop = .Top + Y - m_sngTopPos\n            If sngTop &lt; SeriesImage.Top Then sngTop = SeriesImage.Top\n            If (sngTop + .Height) &gt; (SeriesImage.Top + SeriesImage.Height) Then\n                sngTop = SeriesImage.Top + SeriesImage.Height - .Height\n            End If\n            .Move sngLeft, sngTop\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9125502, "user_type": "registered", "profile_image": "https://graph.facebook.com/2008220695902906/picture?type=large", "display_name": "Adam", "link": "https://stackoverflow.com/users/9125502/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1514960896, "creation_date": 1514956289, "question_id": 48071527, "link": "https://stackoverflow.com/questions/48071527/vba-userform-object-defining-runtime-created-label-as-a-common-name-to-use-in", "title": "VBA Userform Object - Defining runtime created Label as a common name to use in sub", "body": "<p>I have a userform that creates 20-30 labels upon initalization. At the same time a listbox is filled with the name of all these labels. </p>\n\n<p>I want the user to select the label from the listbox which will 'activate' that label by defining it as ActiveTB. Then I will be able to run the following code to move that label around on the userform. </p>\n\n<p><a href=\"https://i.stack.imgur.com/dibhg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dibhg.png\" alt=\"enter image description here\"></a></p>\n\n<p>If i only had 3 labels: Label1, label2, label3 - I could just copy and paste this code below and have ActiveTB replaced with their names. However this is rediculous for 30 labels, and i also don't know what the names of these labels will be (there is a rename function in there). </p>\n\n<p>I'm sure this is a simple fix but i can't find a way to call an object via a commonly activated name. </p>\n\n<pre><code>Private Sub ActiveTB_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n    If Button = 1 Then\n        m_sngLeftPos = X\n        m_sngTopPos = Y\n    End If\n\nEnd Sub\n\nPrivate Sub ActiveTB_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n    Dim sngLeft As Single\n    Dim sngTop As Single\n\n    If Button = 1 Then\n        With ActiveTB\n            sngLeft = .Left + X - m_sngLeftPos\n            If sngLeft &lt; SeriesImage.Left Then sngLeft = SeriesImage.Left\n            If (sngLeft + .Width) &gt; (SeriesImage.Left + SeriesImage.Width) Then\n                sngLeft = SeriesImage.Left + SeriesImage.Width - .Width\n            End If\n            sngTop = .Top + Y - m_sngTopPos\n            If sngTop &lt; SeriesImage.Top Then sngTop = SeriesImage.Top\n            If (sngTop + .Height) &gt; (SeriesImage.Top + SeriesImage.Height) Then\n                sngTop = SeriesImage.Top + SeriesImage.Height - .Height\n            End If\n            .Move sngLeft, sngTop\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "edited": false, "score": 0, "creation_date": 1514959513, "post_id": 48071593, "comment_id": 83117566, "body": "Thank you very much, this is what I want"}, {"owner": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "edited": false, "score": 0, "creation_date": 1514959814, "post_id": 48071593, "comment_id": 83117664, "body": "but why <code>For each word in rng.words</code> is incorrect,  What is the difference between word and wrd"}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "reply_to_user": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "edited": false, "score": 1, "creation_date": 1514961015, "post_id": 48071593, "comment_id": 83118113, "body": "<code>Word</code> refers to the <code>Word Application</code>, so you can&#39;t use it."}], "tags": [], "owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "is_accepted": true, "score": 2, "last_activity_date": 1514956704, "creation_date": 1514956704, "answer_id": 48071593, "question_id": 48070934, "link": "https://stackoverflow.com/questions/48070934/traverse-each-word-in-a-paragraph-vba/48071593#48071593", "title": "Traverse each word in a paragraph VBA", "body": "<p>You can use <code>For...Each</code> to traverse through words in a paragraph. Below is a sample.</p>\n\n<pre><code>Sub TraverseWords()\nDim rng As Range\nSet rng = Selection.Paragraphs(1).Range\nFor Each wrd In rng.Words\n    If Trim(wrd) = \"and\" Then\n        wrd.Case = wdLowerCase\n        Exit For\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 48071593, "answer_count": 1, "score": 0, "last_activity_date": 1514956704, "creation_date": 1514951560, "question_id": 48070934, "link": "https://stackoverflow.com/questions/48070934/traverse-each-word-in-a-paragraph-vba", "title": "Traverse each word in a paragraph VBA", "body": "<p>I want to Traverse each word in a paragraph, I write my code:</p>\n\n<pre><code>sub search_word_in_paragraph()\nWith selection.Find\n            .Text = \"[A-Za-z]{2,}\"\n            .MatchWildcards = True\n            Do\n                .Execute\n                If .Found Then\n\n                            If selection.Range.Text = \"and\" Then\n                                selection.Range.Case = wdLowerCase\n                                Exit For\n                            End If\n\n                End If\n            Loop Until selection.Range.Previous &lt;&gt; \" \"\n            selection.Range.Case = wdTitleWord\n            selection.HomeKey unit:=wdLine\n        End With\nend sub\n</code></pre>\n\n<p>but, i feel can more Concise, are there any other better ways?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "reply_to_user": {"reputation": 4755, "user_id": 18665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HXnTw.gif?s=128&g=1", "display_name": "jwpfox", "link": "https://stackoverflow.com/users/18665/jwpfox"}, "edited": false, "score": 0, "creation_date": 1514951678, "post_id": 48070748, "comment_id": 83115507, "body": "Appreciate the edit @jwpfox , much clearer than my initial explanation."}], "answers": [{"comments": [{"owner": {"reputation": 5587, "user_id": 8202589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38422395dfead452885eafad3d5e5f84?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan86", "link": "https://stackoverflow.com/users/8202589/ivan86"}, "edited": false, "score": 0, "creation_date": 1514951322, "post_id": 48070857, "comment_id": 83115446, "body": "Consider posting an example of what you are proposing."}, {"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1514955902, "post_id": 48070857, "comment_id": 83116504, "body": "Can&#39;t use a Pivot Table because it doesn&#39;t show the raw value (e.g. Q1 2017)"}, {"owner": {"reputation": 1, "user_id": 9166387, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/434d0edc1502bde2aae51f784119fdb6?s=128&d=identicon&r=PG", "display_name": "user9166387", "link": "https://stackoverflow.com/users/9166387/user9166387"}, "edited": false, "score": 0, "creation_date": 1514960397, "post_id": 48070857, "comment_id": 83117893, "body": "Create a new &quot;Quarter&quot; field:  - add a new column with the heading &quot;Qtr&quot;. In this column, type a 1 for &quot;Q1 2017&quot; and 2 for Q2 2017.   - Do a pivot table.  - Right-click on one of the numbers in the Values Area - In the popup menu, click summarize by Max                                    Apply a Custom Number Format: - Right-click a Region value in the Values area in the pivot table. - In the popup menu, click Number Format. - In the Category list, click Custom. - In the Type box, enter [=1]&quot;Q1 2017&quot;;[=2]\u201cQ2 2017\u201d;General"}], "tags": [], "owner": {"reputation": 1, "user_id": 9166387, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/434d0edc1502bde2aae51f784119fdb6?s=128&d=identicon&r=PG", "display_name": "user9166387", "link": "https://stackoverflow.com/users/9166387/user9166387"}, "is_accepted": false, "score": -1, "last_activity_date": 1514950959, "creation_date": 1514950959, "answer_id": 48070857, "question_id": 48070748, "link": "https://stackoverflow.com/questions/48070748/excel-vba-if-two-variables-are-present-cell-this-particular-value-not-if/48070857#48070857", "title": "Excel VBA - If two variables are present, cell = this particular value (Not &quot;=IF(AND(&quot; function)", "body": "<p>A pivot table can achieve what you want?</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1514953361, "post_id": 48071038, "comment_id": 83115873, "body": "I&#39;m currently using Excel 2007. Column number is about 100, but row numbers can reach numbers from a 1000 onwards."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1514976912, "post_id": 48071038, "comment_id": 83125491, "body": "Please use the comments section to ask for more information, answers is for solutions only"}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1515000726, "post_id": 48071038, "comment_id": 83139013, "body": "Ben I updated my answer I hope that it gives you an idea for your report. @Richard Tompsett I am sorry as I said I am new here and I don&#39;t have enough points to comment yet."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1515000985, "post_id": 48071038, "comment_id": 83139171, "body": "No problem, down-vote removed now that the post constitutes an answer... Good luck nabbing the rep"}, {"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1515056963, "post_id": 48071038, "comment_id": 83158118, "body": "Hey there @virtualvid , thanks for the feedback but it seems that when I used the pivot table, some problems would occur. Maybe I&#39;m just not skilled enough at this point of time, but really appreciate the help once again!! I used Richard Tompsett&#39;s solution instead :)"}], "tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 1, "last_activity_date": 1515001359, "last_edit_date": 1515001359, "creation_date": 1514952585, "answer_id": 48071038, "question_id": 48070748, "link": "https://stackoverflow.com/questions/48070748/excel-vba-if-two-variables-are-present-cell-this-particular-value-not-if/48071038#48071038", "title": "Excel VBA - If two variables are present, cell = this particular value (Not &quot;=IF(AND(&quot; function)", "body": "<p>If the purpose is to have a dynamic report. I mean if you want to append more years and avoid operative process. Follow this steeps:</p>\n\n<ol>\n<li><p>Use \"Format as table\" for your data. This will allow you to append more data later and it will refresh the functions by itself.</p></li>\n<li><p>Create a field to extract just the quarter number in the field [Quarter] with <code>=MID([Quarter],1,1)</code></p></li>\n<li><p>Create a field to extract the year <code>=RIGHT([Quarter],4)</code> this will allow you to use this field as a filter for future years</p></li>\n<li><p>Create a pivot table using the new table then organize the data:</p>\n\n<p>*Filter([Year])</p>\n\n<p>*Rows([Fund Name], [Fund Id])</p>\n\n<p>*Columns([Inversor], [Inversor ID])</p>\n\n<p>*Values ([Quarter])</p></li>\n<li><p>You will see the numbers for the quarter. If you want to see the letter \"Q\" you can change the format with right click, and select \"Number Format...\". There in \"Custom\" change to <code>Q0</code></p></li>\n</ol>\n\n<p>Here is a <a href=\"https://youtu.be/RQFekY7RXEk\" rel=\"nofollow noreferrer\">Tutorial</a> about format as table and pivot tables that I made a few months ago. I am sorry it is in Spanish but I am using the Excel English version.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1515056831, "post_id": 48076146, "comment_id": 83158046, "body": "thanks for the reply. Took me some time to play with the configurations but your seems to work the best. Really appreciate the help mate, cheers!! :)"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1515057821, "post_id": 48076146, "comment_id": 83158584, "body": "@Ben No problem, always happy to help"}, {"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1515386176, "post_id": 48076146, "comment_id": 83266661, "body": "just wondering, is it possible to make the cell&#39;s range dynamic?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "reply_to_user": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1515422017, "post_id": 48076146, "comment_id": 83283224, "body": "@Ben It is possible using something like <code>INDIRECT()</code> or <code>OFFSET()</code> but these are volatile formulas (they recalculate every time any change is made in the spreadsheet) so they can really affect performance... There may be other methods but not off the top of my head... I usually move to VBA when I start to make dynamic formula."}], "tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": true, "score": 0, "last_activity_date": 1514977640, "creation_date": 1514977640, "answer_id": 48076146, "question_id": 48070748, "link": "https://stackoverflow.com/questions/48070748/excel-vba-if-two-variables-are-present-cell-this-particular-value-not-if/48076146#48076146", "title": "Excel VBA - If two variables are present, cell = this particular value (Not &quot;=IF(AND(&quot; function)", "body": "<p><code>=IFERROR(INDEX($E$3:$E$12,SMALL(IF($C$3:$C$12=L$5,IF($A$3:$A$12=$K7,ROW($A$3:$A$12)-ROW($A$2))),1)),\"\")</code></p>\n\n<p>Building an array of row numbers for INDEX and grabbing the first match (smallest row) based on the 2 if statements...</p>\n\n<p><a href=\"https://i.stack.imgur.com/DiEJk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DiEJk.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 48076146, "answer_count": 3, "score": 0, "last_activity_date": 1515001359, "creation_date": 1514950028, "last_edit_date": 1531161705, "question_id": 48070748, "link": "https://stackoverflow.com/questions/48070748/excel-vba-if-two-variables-are-present-cell-this-particular-value-not-if", "title": "Excel VBA - If two variables are present, cell = this particular value (Not &quot;=IF(AND(&quot; function)", "body": "<p>Currently I have a database that has 2 variables: </p>\n\n<ol>\n<li>Fund with an ID attached to it and</li>\n<li>Investor with an ID also attached to it. </li>\n</ol>\n\n<p>The example attached, has 4 funds and 4 investors. </p>\n\n<p>An investor can invest in 1 to 4 funds.</p>\n\n<p>I have a VBA function that transposes the data into an \"X &amp; Y axis\" format. </p>\n\n<p>If there is a name \"Ben &amp; Jerry Fund\" and \"Ben\" is present, it should show a quarter entry for that investor name but if the investor does not invest in the fund, it should just be blank. </p>\n\n<p><strong>Question:</strong> Is this possible? </p>\n\n<p>Using the <code>=IF(AND(</code> function would not be possible here since there's so many funds and investors in the database. </p>\n\n<p>Figure 1 shows the data reference (before transposing).</p>\n\n<p>Figure 2 is the desired result.</p>\n\n<p><img src=\"https://i.stack.imgur.com/X2cDl.png\" alt=\"Figure 1 and 2\"></p>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 334, "user_id": 3022514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a2302d9dd378cafecbeec0f2dd8474?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick O&#39;Connor", "link": "https://stackoverflow.com/users/3022514/patrick-oconnor"}, "edited": false, "score": 0, "creation_date": 1514949906, "post_id": 48070696, "comment_id": 83115155, "body": "Are you trying to write the formula into the cell or access the BDP function from VBA to write the response into A1?"}, {"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "reply_to_user": {"reputation": 334, "user_id": 3022514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a2302d9dd378cafecbeec0f2dd8474?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick O&#39;Connor", "link": "https://stackoverflow.com/users/3022514/patrick-oconnor"}, "edited": false, "score": 0, "creation_date": 1514950783, "post_id": 48070696, "comment_id": 83115328, "body": "If it can access directly to BDP function. That will be perfect!"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1514951761, "post_id": 48070696, "comment_id": 83115525, "body": "fix those smartquotes, they&#39;ll cause problem in Excel"}, {"owner": {"reputation": 334, "user_id": 3022514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41a2302d9dd378cafecbeec0f2dd8474?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick O&#39;Connor", "link": "https://stackoverflow.com/users/3022514/patrick-oconnor"}, "edited": false, "score": 0, "creation_date": 1514952095, "post_id": 48070696, "comment_id": 83115599, "body": "For direct access to the BDP function, see this existing answer: <a href=\"https://stackoverflow.com/questions/30871743/bloomberg-data-why-doesnt-application-worksheetfunction-bdh-work\">link</a>. You can use <code>Application.Evaluate</code> to execute your BDP function, or work with the Bloomberg add-in to directly call the functions natively in VBA. If you use <code>Application.Evaluate</code>, be sure to fix your issues with quotation marks as identified by other commenters."}, {"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "edited": false, "score": 0, "creation_date": 1514952836, "post_id": 48070696, "comment_id": 83115755, "body": "I\u2019m still confused about the second way I used. How to apply cells(i,2) in a looping of my question instead of using B1 and C11?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "edited": false, "score": 0, "creation_date": 1514953749, "post_id": 48070709, "comment_id": 83115959, "body": "Thank you! But one more question, How to apply cells(i,2) in a looping of my question instead of using B1 and C11?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1514949630, "creation_date": 1514949630, "answer_id": 48070709, "question_id": 48070696, "link": "https://stackoverflow.com/questions/48070696/using-excel-vba-how-to-write-a-formula-in-a-cell/48070709#48070709", "title": "Using excel vba, how to write a formula in a cell", "body": "<p>try:</p>\n\n<pre><code>Cells(1,1).Formula = \"=B1/ BDP(C11&amp;\"\"Corp\"\", \"\"ds036\"\")\"\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<ol>\n<li>I used a different flavor of double quote</li>\n<li>I doubled-up on the double quotes</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1514961763, "creation_date": 1514961763, "answer_id": 48072452, "question_id": 48070696, "link": "https://stackoverflow.com/questions/48070696/using-excel-vba-how-to-write-a-formula-in-a-cell/48072452#48072452", "title": "Using excel vba, how to write a formula in a cell", "body": "<p>Does this do what you want?</p>\n\n<pre><code>Range(\"A1:A10\").Formula = \"=B1/BDP(C3&amp;\"\"Corp\"\",\"\"ds036\"\")\"\n</code></pre>\n\n<p>If you assign a formula to a multi-cell range, I think Excel will automatically adjust relative cell references for subsequent rows/columns - similar to CTRL+D or dragging down.</p>\n\n<p>This means you don't need to loop through each row and re-construct the formula string for each loop iteration.</p>\n"}], "owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514961763, "creation_date": 1514949444, "last_edit_date": 1514951738, "question_id": 48070696, "link": "https://stackoverflow.com/questions/48070696/using-excel-vba-how-to-write-a-formula-in-a-cell", "title": "Using excel vba, how to write a formula in a cell", "body": "<p>In Excel, A1 is equal to <code>=B1/ BDP(C11&amp;\u201dCorp\u201d, \u201cds036\u201d)</code>\nWhich <code>BDP(Corp, ds036)</code> is a function and parameters from Bloomberg.</p>\n\n<p>How to use Excel VBA for this formula?</p>\n\n<p>I was trying different ways in VBA to solve my point. One of them is like the line below,</p>\n\n<pre><code>Cells(1,1)=\u201cB1/ BDP(C11&amp;\u201dCorp\u201d, \u201cds036\u201d)\u201d\n</code></pre>\n\n<p>An other way I tried, to simplify,</p>\n\n<pre><code>For i=1 to10\n    Cells(i,1)=\u201cCells(i,2)/ BDP(cells(i,3)&amp;\u201dCorp\u201d, \u201cds036\u201d)\u201d\nNext\n</code></pre>\n\n<p>Also, if it can access directly to BDP function. That will be perfect!</p>\n"}, {"tags": ["vba", "excel", "permutation"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1514952615, "post_id": 48070617, "comment_id": 83115705, "body": "Please fix your tags - is it VBA or VB6 that you are using?"}, {"owner": {"reputation": 3958, "user_id": 1311658, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/909aa52ce0850c5fd2135c8e9d6ea914?s=128&d=identicon&r=PG", "display_name": "Tom Collins", "link": "https://stackoverflow.com/users/1311658/tom-collins"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514998706, "post_id": 48070617, "comment_id": 83137917, "body": "Either. I can convert between the two easily."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515003519, "post_id": 48070617, "comment_id": 83140446, "body": "But a VBA solution which makes use of Excel&#39;s &quot;Remove Duplicates&quot; feature <b>can&#39;t</b> be easily implemented in VB6 so &quot;I can convert between the two easily&quot; is dependent on the removal of the [excel-vba] tag at least."}, {"owner": {"reputation": 3958, "user_id": 1311658, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/909aa52ce0850c5fd2135c8e9d6ea914?s=128&d=identicon&r=PG", "display_name": "Tom Collins", "link": "https://stackoverflow.com/users/1311658/tom-collins"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515009866, "post_id": 48070617, "comment_id": 83143530, "body": "OK, fair enough."}], "answers": [{"comments": [{"owner": {"reputation": 3958, "user_id": 1311658, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/909aa52ce0850c5fd2135c8e9d6ea914?s=128&d=identicon&r=PG", "display_name": "Tom Collins", "link": "https://stackoverflow.com/users/1311658/tom-collins"}, "edited": false, "score": 0, "creation_date": 1515002961, "post_id": 48071161, "comment_id": 83140153, "body": "Works great. I haven&#39;t worked with dictionary/keys before and will have look closer on what it does. Thanks."}, {"owner": {"reputation": 3958, "user_id": 1311658, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/909aa52ce0850c5fd2135c8e9d6ea914?s=128&d=identicon&r=PG", "display_name": "Tom Collins", "link": "https://stackoverflow.com/users/1311658/tom-collins"}, "edited": false, "score": 0, "creation_date": 1515012749, "post_id": 48071161, "comment_id": 83144737, "body": "OK, not the best way to get the permutations if you&#39;re dealing with larger strings, but I can apply the dictionary method to another permutations algorithm to get what I want."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1514953632, "creation_date": 1514953632, "answer_id": 48071161, "question_id": 48070617, "link": "https://stackoverflow.com/questions/48070617/all-unique-permutations/48071161#48071161", "title": "All UNIQUE permutations", "body": "<p>Enter the data from cell a2 down and run the macro.</p>\n\n<pre><code>Sub UniqueNumber()\n    Dim vDB, vR(), a\n    Dim i As Integer, j As Integer, n As Long, z As Integer\n    Dim k As Integer, p As Integer\n    Dim dic As Object\n    Dim s As String\n\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n    vDB = Range(\"a2\", Range(\"a\" &amp; Rows.Count).End(3))\n    z = UBound(vDB, 1)\n    ReDim Preserve vR(1 To 3)\n    For i = 1 To z: For j = 1 To z: For k = 1 To z\n\n        If i &lt;&gt; j And i &lt;&gt; k And j &lt;&gt; k Then\n            vR(1) = vDB(i, 1)\n            vR(2) = vDB(j, 1)\n            vR(3) = vDB(k, 1)\n            s = Join(vR, \"\")\n            If dic.Exists(s) Then\n            Else\n                n = n + 1\n                dic.Add s, s\n            End If\n        End If\n    Next k: Next j: Next i\n    a = dic.Keys\n    Range(\"d2\").CurrentRegion.Offset(1).Clear\n    Range(\"d2\").Resize(n) = WorksheetFunction.Transpose(a)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BNuBW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BNuBW.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3958, "user_id": 1311658, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/909aa52ce0850c5fd2135c8e9d6ea914?s=128&d=identicon&r=PG", "display_name": "Tom Collins", "link": "https://stackoverflow.com/users/1311658/tom-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 48071161, "answer_count": 1, "score": -2, "last_activity_date": 1516217078, "creation_date": 1514948624, "last_edit_date": 1531164843, "question_id": 48070617, "link": "https://stackoverflow.com/questions/48070617/all-unique-permutations", "title": "All UNIQUE permutations", "body": "<p>I'm finding lots of algorithms to get every permutation of digits in a set of numbers. What I can't find is one that gives a UNIQUE list of such permutations.</p>\n\n<p>For example, the digits <strong>123</strong> will produce:</p>\n\n<pre><code>123\n132\n213\n231\n312\n321\n</code></pre>\n\n<p>But the digits <strong>113</strong> should only produce (skipping the duplicates):</p>\n\n<pre><code>113\n131\n311\n</code></pre>\n\n<p>If it helps, I'll be using 8 digits in an array.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "loops", "match"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7168323, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/883f11bfbb15188bdb552562a0076d42?s=128&d=identicon&r=PG&f=1", "display_name": "marc cerone", "link": "https://stackoverflow.com/users/7168323/marc-cerone"}, "edited": false, "score": 0, "creation_date": 1514951980, "post_id": 48070718, "comment_id": 83115572, "body": "I edited the original post to include an example at the bottom.  Does that make sense to you?  Thanks for your help."}, {"owner": {"reputation": 71, "user_id": 9115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66721357489f5f145c111eb8ea81d555?s=128&d=identicon&r=PG&f=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/9115625/eugene"}, "reply_to_user": {"reputation": 17, "user_id": 7168323, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/883f11bfbb15188bdb552562a0076d42?s=128&d=identicon&r=PG&f=1", "display_name": "marc cerone", "link": "https://stackoverflow.com/users/7168323/marc-cerone"}, "edited": false, "score": 0, "creation_date": 1514952858, "post_id": 48070718, "comment_id": 83115761, "body": "so I did. just add the code above after the row cell.Offset(, 15) = &quot;Found&quot;"}, {"owner": {"reputation": 17, "user_id": 7168323, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/883f11bfbb15188bdb552562a0076d42?s=128&d=identicon&r=PG&f=1", "display_name": "marc cerone", "link": "https://stackoverflow.com/users/7168323/marc-cerone"}, "edited": false, "score": 0, "creation_date": 1515040481, "post_id": 48070718, "comment_id": 83152043, "body": "Thank you for your help! Works perfect"}], "tags": [], "owner": {"reputation": 71, "user_id": 9115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66721357489f5f145c111eb8ea81d555?s=128&d=identicon&r=PG&f=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/9115625/eugene"}, "is_accepted": true, "score": 0, "last_activity_date": 1514949747, "creation_date": 1514949747, "answer_id": 48070718, "question_id": 48070597, "link": "https://stackoverflow.com/questions/48070597/use-excel-vba-to-loop-items-in-one-sheet-match-to-another-and-copy-value/48070718#48070718", "title": "Use Excel VBA to loop items in one sheet, match to another and copy value", "body": "<p>Is it what you are trying to get?:</p>\n\n<pre><code>    ' If found I need the value from Sheet2 that is in Col B of the matching \nWith ThisWorkbook\n.Sheets(\"Sheet1\").Cells(cell.Row, 2).Value =.Sheets(\"Sheet2\").Cells(Application.Match(cell, r2, 0), 2).Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7168323, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/883f11bfbb15188bdb552562a0076d42?s=128&d=identicon&r=PG&f=1", "display_name": "marc cerone", "link": "https://stackoverflow.com/users/7168323/marc-cerone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 48070718, "answer_count": 1, "score": 0, "last_activity_date": 1514951935, "creation_date": 1514948383, "last_edit_date": 1514951935, "question_id": 48070597, "link": "https://stackoverflow.com/questions/48070597/use-excel-vba-to-loop-items-in-one-sheet-match-to-another-and-copy-value", "title": "Use Excel VBA to loop items in one sheet, match to another and copy value", "body": "<p>I have this 85% completed but am stuck with the last part. I have 2 sheets. One has line items with prices, descriptions, etc. The other sheet has a master list of the items with the unit price that is associated with it. My code below finds the match in from sheet1 to sheet2 correctly. I am trying to get the unit price from sheet2 which is in column B. So basically the items from sheet1 Column C match to a list in sheet2 Column A. When the match is found, I need the value that is in sheet2 Column B for the matching row. Please let me know if you can help or need any further explanation. This is driving me crazy. Kind of a newbie with VBA. Thanks!</p>\n\n<pre><code>Sub test2()\nDim r1 As Range\nDim r2 As Range\nDim cell As Range\nDim lastrow As Long\n\n\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n    lastrow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n    Set r1 = .Range(\"C2:C\" &amp; lastrow)\nEnd With\n\n\n\n\nWith ThisWorkbook.Worksheets(\"Sheet2\")\n    lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set r2 = .Range(\"A1:A\" &amp; lastrow)\nEnd With\n\n\nFor Each cell In r1\n    If IsError(Application.Match(cell, r2, 0)) Then\n        cell.Offset(, 15) = \"NotFound\"\n    Else\n        cell.Offset(, 15) = \"Found\"\n        ' If found I need the value from Sheet2 that is in Col B of the matching row.\n    End If\nNext cell\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Sheet 1<br>\nCol A<br>\nItem 1<br>\nItem 2<br>\nItem 3  </p>\n\n<p>Sheet 2<br>\nCol A  Col B<br>\nItem 1 1.99<br>\nItem 2 2.99<br>\nItem 3 3.99  </p>\n\n<p>I am trying to loop Col A in sheet one and match to the corresponding value in sheet2 and copy the price (ColB of sheet2) into sheet1</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9165964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898a5a7b3901fe20f2cdfbc736c09221?s=128&d=identicon&r=PG&f=1", "display_name": "CA Aman Ghotra", "link": "https://stackoverflow.com/users/9165964/ca-aman-ghotra"}, "edited": false, "score": 0, "creation_date": 1514941245, "post_id": 48069776, "comment_id": 83113538, "body": "@peter-Thanks for very quick reply.  , I just copy pasted your code to test i.e Unfortunately the code is still giving me the same wrong answer ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 9165964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898a5a7b3901fe20f2cdfbc736c09221?s=128&d=identicon&r=PG&f=1", "display_name": "CA Aman Ghotra", "link": "https://stackoverflow.com/users/9165964/ca-aman-ghotra"}, "edited": false, "score": 1, "creation_date": 1514942312, "post_id": 48069776, "comment_id": 83113772, "body": "@CAAmanGhotra If you are using these as UDFs (i.e. called from a cell in Excel), just updating the code is not sufficient to update the values in the cells - you need to force the cell to be recalculated so that it runs the new code.  Try editing the cells containing the formulas and just press enter (without making any changes) - that will recalculate it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1514943410, "post_id": 48069776, "comment_id": 83113978, "body": "...or press Ctrl+Shift+Alt+F9"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1514946916, "post_id": 48069776, "comment_id": 83114638, "body": "@TimWilliams I can never remember which F9 key combination does what :D"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 1, "user_id": 9165964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898a5a7b3901fe20f2cdfbc736c09221?s=128&d=identicon&r=PG&f=1", "display_name": "CA Aman Ghotra", "link": "https://stackoverflow.com/users/9165964/ca-aman-ghotra"}, "edited": false, "score": 0, "creation_date": 1522690660, "post_id": 48069776, "comment_id": 86238544, "body": "@CAAmanGhotra (Don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem... You get <b><code>+2</code></b> repuation, and the answer&#39;s author gets <b><code>+15</code></b> rep!  Once <i>you</i> reach 15 reputation, you can <i>also</i> <b><code>\u25b2 Upvote</code></b> any answers that are helpful, which also rewards the authors, <i>and benefits the Stack Overflow community as a whole!)</i>"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 2, "last_activity_date": 1514940169, "creation_date": 1514940169, "answer_id": 48069776, "question_id": 48069699, "link": "https://stackoverflow.com/questions/48069699/vba-function-returns-wrong-decimal-values/48069776#48069776", "title": "VBA function returns wrong decimal values", "body": "<p>You should define what the Function returns and change the the Input type to Double for the parameters. The answer to why, is that the function had the input rounded to Long before the calculation.</p>\n\n<pre><code>Function MPPemployer(EmployeeMPPportion As Double) As Double\n    Dim c As Double\n\n    c = Round((EmployeeMPPportion / (8.5 / 100) * (9.9 / 100)), 2)\n\n    MPPemployer = c\nEnd Function\n\nFunction Grossmppsalary(EmployerMPPportion As Double) As Double\n    Dim g As Double\n\n    g = Round((EmployerMPPportion / (9.9 / 100)), 2)\n\n    Grossmppsalary = g\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9165964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898a5a7b3901fe20f2cdfbc736c09221?s=128&d=identicon&r=PG&f=1", "display_name": "CA Aman Ghotra", "link": "https://stackoverflow.com/users/9165964/ca-aman-ghotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522690375, "creation_date": 1514939539, "last_edit_date": 1522690375, "question_id": 48069699, "link": "https://stackoverflow.com/questions/48069699/vba-function-returns-wrong-decimal-values", "title": "VBA function returns wrong decimal values", "body": "<p>Both of the function at the bottom return wrong values. </p>\n\n<p>Example: for employee portion of <code>142.22</code>, the answer should be <code>165.64</code> , and not <code>165.39</code> as returned by the VBA function? </p>\n\n<p>Similarly , for the second function, for <code>5048.94 - EmployerMPPportion</code> , the answer should be <code>50999.41</code>, whereas the answer is returning <code>51000</code>.</p>\n\n<p>I am aware I have used round function but it should round up to 2 decimal points only? </p>\n\n<p>I just read in the forum that <em>\"BCD  are not very space-efficient, but that's a trade-off you have to make for accuracy in this case\"</em>, if this is true then why do Excel's built-in functions always return correct values? Are they not designed in VBA?</p>\n\n<pre><code>Function MPPemployer (EmployeeMPPportion As Long)\n    Dim c As Double\n    c = Round((EmployeeMPPportion / (8.5 / 100) * (9.9 / 100)), 2)\n    MPPemployer = c\nEnd Function\n\nFunction Grossmppsalary (EmployerMPPportion As Long)\n    Dim g As Double\n    g = Round((EmployerMPPportion / (9.9 / 100)), 2)\n    Grossmppsalary = g\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1514936818, "post_id": 48069358, "comment_id": 83112468, "body": "ummm.... <code>=IF(LEN(A1)&gt;=4,RIGHT(A1,4),&quot;&quot;)</code>?"}, {"owner": {"reputation": 1, "user_id": 9165820, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SnKOx.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9165820/mark"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514937155, "post_id": 48069358, "comment_id": 83112555, "body": "Thanks Scott, excellent! It works nicely perfect."}], "owner": {"reputation": 1, "user_id": 9165820, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SnKOx.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9165820/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514936744, "creation_date": 1514936520, "last_edit_date": 1531164843, "question_id": 48069358, "link": "https://stackoverflow.com/questions/48069358/excel-split-numbers-from-the-right", "title": "EXCEL: Split numbers from the right", "body": "<p>How to keep a string of numbers from a Excel cell grabbed from the right and then the rest on the left to be deleted?:</p>\n\n<p>I would like to keep the first 4 characters from right to left. </p>\n\n<p>What I have:</p>\n\n<pre><code>222333444555\n88\n222333444\n9933\n</code></pre>\n\n<p>The result that I am looking for:</p>\n\n<pre><code>4555\n3444\n9933\n</code></pre>\n\n<p>Less than 4 characters could be deleted. In this sample the 88 number was deleted as well.</p>\n\n<p>The easy \"aparently\" solution is to splits the cells manually with the \"Text to Columns\" option, but this option start grabbing characters from the left. I need it grabbed from the right.</p>\n\n<p>I tried already RIGHT and LEFT fuctions, but it deletes characters from the left or right. I have not fixed length as you can see, so it doesn't work. </p>\n\n<p>Also I tried to analyze the following already answered question in a similar case, but I can not find the right answer:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/43349415/split-text-into-different-columns-from-the-right\">Split text into different columns from the right</a></p>\n\n<p>Any ideas?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "tabs", "automation", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 0, "creation_date": 1514941165, "post_id": 48069852, "comment_id": 83113529, "body": "One is <code>PDF Base*</code> the other is <code>PDPBase</code>. The lack of space in the second (CodeName) will cause in error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 0, "creation_date": 1514941420, "post_id": 48069852, "comment_id": 83113573, "body": "One is the tab name and the other is the codename - they don&#39;t need to be the same and in any case I&#39;m not using the codename..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1514940964, "creation_date": 1514940964, "answer_id": 48069852, "question_id": 48069195, "link": "https://stackoverflow.com/questions/48069195/vba-main-worksheet-to-add-values-across-other-new-not-yet-created-worksheets-a/48069852#48069852", "title": "VBA - Main worksheet to add values across other new not yet created worksheets across multilpe ranges", "body": "<p>Untested but should do what you want:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Const MAIN_WS_NAME As String = \"PDP Base\" 'use a constant for fixed values\n\n    Dim ws As Worksheet, mainws As Worksheet, wb As Workbook\n    Dim x As Long, y As Long 'Long not Single\n    Dim tVar As Double\n\n    Set wb = ActiveWorkbook\n    Set mainws = wb.Worksheets(MAIN_WS_NAME)\n\n    For y = 2 To 4\n        For x = 29 To 43\n            tVar = 0\n            For Each ws In wb.Worksheets\n                If ws.Name Like MAIN_WS_NAME &amp; \"*\" And ws.Name &lt;&gt; MAIN_WS_NAME Then\n                    tVar = tVar + ws.Cells(x, y).Value\n                End If\n            Next ws\n            mainws.Cells(x, y).Value = tVar\n        Next x\n    Next y\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9165764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac1e75610092274d555ed631df6eae0?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy241", "link": "https://stackoverflow.com/users/9165764/timmy241"}, "is_accepted": false, "score": 0, "last_activity_date": 1516388999, "creation_date": 1516388999, "answer_id": 48347981, "question_id": 48069195, "link": "https://stackoverflow.com/questions/48069195/vba-main-worksheet-to-add-values-across-other-new-not-yet-created-worksheets-a/48347981#48347981", "title": "VBA - Main worksheet to add values across other new not yet created worksheets across multilpe ranges", "body": "<p>Its been a bit since I posted the original question, but I've gotten much further since then and just wanted to post my progress for others to use incase they need something similar.</p>\n\n<p>There is still a lot of cleaning that could be done, and its not finished, but the basic idea works really <em>really</em> well. The code takes several <strong>codenamed</strong> (not tab names; allows users to change the tab name to something different) main sheets and loops through each, adding formulas that dynamically add cells from similarly named subsheets into the main sheet across multiple blocks of cells. </p>\n\n<p>Also wanted to thank the original answer again provided by Tim Williams as that helped me tremendously to get going in the right direction and is the foundation to the code below.</p>\n\n<p><strong>Use at your own risk.</strong> I hear CodeNames and using VBProject type of codes can give you a bad day if they break. </p>\n\n<p>Main Code Below</p>\n\n<pre><code>Public Sub Sheet_Initilization()\n\nDim ws As Worksheet, mainws As Worksheet, wb As Workbook\nDim codename As String\nDim mainwsname As String\n\nSet wb = ActiveWorkbook\n\n'block code to run code smoother\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n'PLACEHOLDER FOR LATER USE CaseNames = Array(\"PDPBase\", \"PDPSens\", \"PBPBase\", \"PBPSens\", \"PNPBase\", \"PNPSens\", \"PUDBase\", \"PUDSens\")\n\nCaseNames = Array(\"PDPBase\", \"PBPBase\", \"PNPBase\", \"PUDBase\") 'main 4 cases, more to come\n\nFor Each c In CaseNames     'cycle through each \"Main\" case sheet\n    codename = c\n    Set mainws = wb.Sheets(CN(wb, codename)) 'calls function to retrieve code name of the main case sheet\n                                             'allows users to change main case tab names without messing up the codes\n                                             'must change security settings to use, looking into alternatives\n\n    mainwsname = mainws.Name 'probably could do without with some optimization\n\nFor Each b In Range(\"InputAdditionCells\").Cells 'uses named range of multiple blocks of cells, B29:D34  M29:O43  I53:J68 for example\n                                                'cycles through each cell in every block\n\n    mainws.Range(b.Address).Formula = \"=\" 'initial formula\n    For Each ws In wb.Worksheets 'cycles through each sheet\n        If ws.Name Like mainwsname &amp; \"*\" And ws.Name &lt;&gt; mainwsname Then    'finds similarily named sub sheets (PDP Base 1, PDP Base 2...etc)\n                                                                           ', but won't use the main sheet (PDP Base)\n\n            If b.Address Like \"$Y*\" Then 'special column to use different offset formula\n                mainws.Range(b.Address).Formula = mainws.Range(b.Address).Formula &amp; \"+'\" &amp; ws.Name &amp; \"'!\" &amp; b.Offset(0, 4).Address\n            Else\n                mainws.Range(b.Address).Formula = mainws.Range(b.Address).Formula &amp; \"+'\" &amp; ws.Name &amp; \"'!\" &amp; b.Address\n            End If\n        End If\n    Next ws\nNext b\n\nFor Each d In Range(\"InputWeightedCells\").Cells 'same idea as before, different main formula (weighted average)\n    mainws.Range(d.Address).Formula = \"=\"\n    For Each ws In wb.Worksheets\n        If ws.Name Like mainwsname &amp; \"*\" And ws.Name &lt;&gt; mainwsname Then\n            If d.Address Like \"*$68\" Then 'special row to use different offset formula\n                mainws.Range(d.Address).Formula = mainws.Range(d.Address).Formula &amp; \"+('\" &amp; ws.Name &amp; \"'!\" &amp; d.Address _\n                &amp; \"*'\" &amp; ws.Name &amp; \"'!\" &amp; d.Offset(-21, 23).Address &amp; \")\"\n            Else\n                mainws.Range(d.Address).Formula = mainws.Range(d.Address).Formula &amp; \"+('\" &amp; ws.Name &amp; \"'!\" &amp; d.Address _\n                &amp; \"*'\" &amp; ws.Name &amp; \"'!\" &amp; d.Offset(-24, 23).Address &amp; \")\"\n            End If\n        End If\n    Next ws\nNext d\n\nMsgBox (mainwsname) 'DELETE; makes sure code is running properly/codebreak without using the break feature\n\nNext c\n\n'reactivate original block code\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nEnd Sub 'cool beans\n</code></pre>\n\n<p>Function that's called (need to change the Macro settings in the trust center settings from excel options to run). Once again use at your own risk.</p>\n\n<pre><code>Function CN(wb As Workbook, codename As String) As String\n\nCN = wb.VBProject.VBComponents(codename).Properties(\"Name\").Value\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9165764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac1e75610092274d555ed631df6eae0?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy241", "link": "https://stackoverflow.com/users/9165764/timmy241"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 48069852, "answer_count": 2, "score": 1, "last_activity_date": 1516388999, "creation_date": 1514935369, "question_id": 48069195, "link": "https://stackoverflow.com/questions/48069195/vba-main-worksheet-to-add-values-across-other-new-not-yet-created-worksheets-a", "title": "VBA - Main worksheet to add values across other new not yet created worksheets across multilpe ranges", "body": "<p>I'm pretty new to VBA and love to challenge myself,  but am at a loss on this project however.</p>\n\n<p>I have a workbook that has quite a few tabs used for various calculations and summations. The \"PDP Base\" main tab takes all \"PDP BaseX\" tabs and adds all values for the same cell across all \"PDP BaseX\" tabs into the main one. This is easy to handle manually when there are only 5 or so \"PDP BaseX\" tabs, but if there are potentially many tabs to add together (10+), combing through each is a pain. This is made worse if there are multiple cases to add formulas to (PNP;PBP;PUD;PBL - with each having a Base and Sens modifier).</p>\n\n<p>Each new \"PDP BaseX\" tab is copy pasted from a template ran by other code (not yet finished) with a new \"X+1\" value, and so I don't want to just copy paste a formula adding the new tab into the main tab.</p>\n\n<p>The end result will have code for all the main tabs of each category, but if I can get one main tab to do what I want, I can go from there. </p>\n\n<p>Below is some code that I feel is close, but it loops to infinity somewhere in there and won't move pass initial cell B29 (getting overflow into PDP Base B29 when result should be lets say 10 for example; PDP Base1 B29 = 2; PDP Base2 B29 = 6; PDP Base3 B29 = 4)</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim ws As Worksheet, mainws As Worksheet\nDim rng As Range, mainrng As Range\nDim x As Single, y As Single\nDim tVar As Double\n\nSet mainws = ActiveWorkbook.Worksheets(\"PDP Base\")\n\nWith mainws\n For y = 2 To 4\n  For x = 29 To 43\n   For Each ws In ActiveWorkbook.Worksheets\n    If ws.Name Like \"PDP Base*\" And ws.CodeName &lt;&gt; \"PDPBase\" Then \n              'the main tab has a codename assigned to it to not add itself\n     With ws\n      With .Range(Cells(x, y))\n       tVar = tVar + .Range(Cells(x, y)).Value\n\n      End With\n     End With\n    End If\n   Next ws\n\n  Set mainrng = Cells(x, y)\n  mainrng.Value = tVar\n  tVar = 0\n\n Next x\nNext y\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Would someone be able to shed some insight into this? Thank you!</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514932576, "post_id": 48068766, "comment_id": 83111220, "body": "Are you sure that your array has 6 &quot;columns&quot;?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1514932584, "post_id": 48068766, "comment_id": 83111222, "body": "On what iteration of <code>i</code> are you getting the error? When it crashes, hit debug, go to the yellow line and run your arrow over <code>i</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1514932665, "post_id": 48068766, "comment_id": 83111253, "body": "Oh when you load an array from a range it starts with 1 and you are trying to get 0 since you do not assign a value the first loop i = 0.  you need to start i at 1."}, {"owner": {"reputation": 457, "user_id": 8032508, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TxIiB.jpg?s=128&g=1", "display_name": "Jwok", "link": "https://stackoverflow.com/users/8032508/jwok"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514933083, "post_id": 48068766, "comment_id": 83111400, "body": "@Scott Craner, Unfortunately changing i = 0 did not help."}, {"owner": {"reputation": 457, "user_id": 8032508, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TxIiB.jpg?s=128&g=1", "display_name": "Jwok", "link": "https://stackoverflow.com/users/8032508/jwok"}, "edited": false, "score": 0, "creation_date": 1514933113, "post_id": 48068766, "comment_id": 83111408, "body": "Also, there are 21 &quot;columns&quot; in each row"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1514933125, "post_id": 48068766, "comment_id": 83111415, "body": "No it already is <code>0</code> you want to put <code>i=1</code> before the loop."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514933367, "post_id": 48068766, "comment_id": 83111489, "body": "you probably forgot to delete this but the variable <code>Roww</code> and all its uses can be removed without ill effect"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514933753, "post_id": 48068766, "comment_id": 83111621, "body": "And the <code>i=10</code> will mean it will only iterate once as it satisfies the while."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1514934338, "post_id": 48068766, "comment_id": 83111800, "body": "What is the point of the variable <code>r</code>? This code makes little sense."}], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 8032508, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TxIiB.jpg?s=128&g=1", "display_name": "Jwok", "link": "https://stackoverflow.com/users/8032508/jwok"}, "edited": false, "score": 0, "creation_date": 1514939097, "post_id": 48069433, "comment_id": 83113047, "body": "Thanks @Scott_Craner! I got something similar working but your solution is more elegant."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1514937154, "creation_date": 1514937154, "answer_id": 48069433, "question_id": 48068766, "link": "https://stackoverflow.com/questions/48068766/editing-array-in-vba/48069433#48069433", "title": "Editing Array in VBA", "body": "<p>I think you want this:</p>\n\n<pre><code>Sub arraytest()\n\nDim myArray As Variant\nDim i As Integer\n\nmyArray = ActiveWorkbook.Worksheets(\"Semesters\").ListObjects(\"tblSemester\").DataBodyRange.Value\n\nFor i = 1 To UBound(myArray, 1)\n    myArray(i, 5) = \"18/19\"\n    myArray(i, 6) = \"Fall\"\nNext\n\nWorksheets(\"Sheet1\").Range(\"A2\").Resize(UBound(myArray, 1), UBound(myArray, 2)).Value = myArray\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 8032508, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TxIiB.jpg?s=128&g=1", "display_name": "Jwok", "link": "https://stackoverflow.com/users/8032508/jwok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48069433, "answer_count": 1, "score": 0, "last_activity_date": 1514938216, "creation_date": 1514932440, "last_edit_date": 1531164843, "question_id": 48068766, "link": "https://stackoverflow.com/questions/48068766/editing-array-in-vba", "title": "Editing Array in VBA", "body": "<p>I am trying to capture a table via an array, and iterate through the array multiple times, changing the data in two columns through each iteration. My current code (below) is set up to iterate through the array once, changing the data in two sections (<em>, 5) and (</em>, 6). Unfortunately, it displays an error reading </p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range</p>\n</blockquote>\n\n<pre><code>Sub arraytest()\n\nDim myArray As Variant\n\nmyArray = ActiveWorkbook.Worksheets(\"Semesters\").ListObjects(\"tblSemester\").DataBodyRange.Value\n\nDim i As Integer\nDim Roww As Integer\n\nRoww = 1\n\nWhile i &lt; 10\n    For Each r In myArray\n        myArray(i, 5) = \"18/19\"\n        myArray(i, 6) = \"Fall\"\n        Roww = Roww + 1\n        i = 10\n    Next\nWend\n\n\nWorksheets(\"Sheet1\").Range(\"A2\", \"U2\").Resize(UBound(myArray, 1)).Value = myArray\n\nEnd Sub\n</code></pre>\n\n<p>How to I edit the code to successfully iterate through the array, changing the data on the specific columns?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "edited": false, "score": 0, "creation_date": 1514973394, "post_id": 48073007, "comment_id": 83123574, "body": "Thanks! Worked fine! ++"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1514964969, "last_edit_date": 1514964969, "creation_date": 1514964656, "answer_id": 48073007, "question_id": 48068518, "link": "https://stackoverflow.com/questions/48068518/consolidate-excel-information-in-one-e-mail-for-each-column/48073007#48073007", "title": "Consolidate Excel Information in one e-mail for each column", "body": "<p>My asumption is that one vendor has has excatly one supervisor, i.e. a 1:1 relation.</p>\n\n<p>Add the following property to the class cVendorline</p>\n\n<pre><code>    ' New Property for the mail address of the supervisor\nPublic Property Get MailSupervisor() As String\n    MailSupervisor = mMailSupervisor\nEnd Property\n\nPublic Property Let MailSupervisor(ByVal sNewValue As String)\n    mMailSupervisor = sNewValue\nEnd Property\n</code></pre>\n\n<p>So the complete code of the class cVendorline is</p>\n\n<pre><code>Option Explicit\n\nPrivate mClient As String\nPrivate mDate As Date\nPrivate mOS As String    \nPrivate mMailSupervisor As String\n\n\nPublic Property Get Client() As String\n        Client = mClient\nEnd Property\n\nPublic Property Let Client(ByVal bNewValue As String)\n        mClient = bNewValue\nEnd Property\n\nPublic Property Get dDate() As Date\n    dDate = mDate\nEnd Property\n\nPublic Property Let dDate(ByVal bNewValue As Date)\n    mDate = bNewValue\nEnd Property\n\nPublic Property Get OS() As String\n    OS = mOS\nEnd Property\n\nPublic Property Let OS(ByVal sNewValue As String)\n    mOS = sNewValue\nEnd Property\n' New Property for the mail address of the supervisor\nPublic Property Get MailSupervisor() As String\n    MailSupervisor = mMailSupervisor\nEnd Property\n\nPublic Property Let MailSupervisor(ByVal sNewValue As String)\n    mMailSupervisor = sNewValue\nEnd Property\n</code></pre>\n\n<p>And replcace the code in the module from the original post with</p>\n\n<pre><code>Option Explicit\n\nSub Consolidate()\n\n#If Early Then\n    Dim emailInformation As New Scripting.Dictionary\n#Else\n    Dim emailInformation As Object\n    Set emailInformation = CreateObject(\"Scripting.Dictionary\")\n#End If\n\n    GetEmailInformation emailInformation\n    SendInfoEmail emailInformation\nEnd Sub\n\nSub GetEmailInformation(emailInformation As Object)\n' added CONSTs for the columns (just to make it \"nicer\")\nConst COL_MAILVENDOR = 1\nConst COL_CLIENT = 3\nConst COL_DATE = 4\nConst COL_OS = 5\nConst COL_MAILSUPERVISOR = 7\n\nDim rg As Range\nDim sngRow As Range\n\nDim emailAddress As String\nDim vendorLine As cVendorline\nDim vendorLines As Collection\n\nSet rg = Range(\"A1\").CurrentRegion    ' Assuming the list starts in A1 and DOES NOT contain empty row\nSet rg = rg.Offset(1).Resize(rg.Rows.Count - 1)    ' Cut the headings\n\n    For Each sngRow In rg.Rows\n\n        emailAddress = sngRow.Cells(1, COL_MAILVENDOR)\n\n        Set vendorLine = New cVendorline\n        With vendorLine\n            .Client = sngRow.Cells(1, COL_CLIENT)\n            .dDate = sngRow.Cells(1, COL_DATE)\n            .OS = sngRow.Cells(1, COL_OS)\n            ' new column for supoervisor\n            .MailSupervisor = sngRow.Cells(1, COL_MAILSUPERVISOR)\n        End With\n\n        If emailInformation.Exists(emailAddress) Then\n            emailInformation.item(emailAddress).Add vendorLine\n        Else\n            Set vendorLines = New Collection\n            vendorLines.Add vendorLine\n            emailInformation.Add emailAddress, vendorLines\n        End If\n\n    Next\n\nEnd Sub\n\nSub SendInfoEmail(emailInformation As Object)\n\nDim sBody As String\nDim sBodyStart As String\nDim sBodyInfo As String\nDim sBodyEnd As String\nDim sCC As String\nDim emailAdress As Variant\nDim colLines As Collection\nDim line As Variant\n\n    sBodyStart = \"Hello,\" &amp; vbCrLf &amp; vbCrLf &amp; _\n                 \"Please, check your pending OS's\" &amp; vbCrLf &amp; vbCrLf &amp; _\n                 \"Detalhes:\" &amp; vbCrLf\n\n    For Each emailAdress In emailInformation\n        Set colLines = emailInformation(emailAdress)\n        sBodyInfo = \"\"\n\n        For Each line In colLines\n            sBodyInfo = sBodyInfo &amp; _\n                    \"Consultor:\" &amp; line.Client &amp; vbCrLf &amp; _\n                    \"Date:\" &amp; line.dDate &amp; vbCrLf &amp; _\n                    \"OS:\" &amp; line.OS &amp; vbCrLf\n                    ' just get the supervisor's mail from the last entry\n                    ' maybe a little bit sloppy to do it like that\n                    sCC = line.MailSupervisor\n        Next\n        sBodyEnd = \"Best Regards\" &amp; vbCrLf &amp; _\n                \"Team\"\n\n        sBody = sBodyStart &amp; sBodyInfo &amp; sBodyEnd\n        SendEmail emailAdress, \"OS - PENDING\", sBody, sCC\n    Next\n\nEnd Sub\n\nSub SendEmail(ByVal sTo As String _\n              , ByVal sSubject As String _\n                , ByVal sBody As String _\n                , Optional sCC As String _\n                  , Optional ByRef coll As Collection)\n' added \"Optional sCC As String\"\n\n    #If Early Then\n        Dim ol As Outlook.Application\n        Dim outMail As Outlook.MailItem\n        Set ol = New Outlook.Application\n    #Else\n        Dim ol As Object\n        Dim outMail As Object\n        Set ol = CreateObject(\"Outlook.Application\")\n    #End If\n\n    Set outMail = ol.CreateItem(0)\n\n    With outMail\n        .To = sTo\n        .cc = sCC\n        .Subject = sSubject\n        .Body = sBody\n        If Not (coll Is Nothing) Then\n            Dim item As Variant\n            For Each item In coll\n                .Attachments.Add item\n            Next\n        End If\n\n        .Display\n        '.Send\n    End With\n\n    Set outMail = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8369697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GzSHr.png?s=128&g=1", "display_name": "ARGC", "link": "https://stackoverflow.com/users/8369697/argc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 48073007, "answer_count": 1, "score": 0, "last_activity_date": 1515190405, "creation_date": 1514930972, "last_edit_date": 1531161705, "question_id": 48068518, "link": "https://stackoverflow.com/questions/48068518/consolidate-excel-information-in-one-e-mail-for-each-column", "title": "Consolidate Excel Information in one e-mail for each column", "body": "<p>I have a macro that group everything that is pending for each \"vendor\" and I need to send as \"CC\" to the respective supervisor of the \"vendor\" now.</p>\n\n<p>The original post was in the link <a href=\"https://stackoverflow.com/questions/48007366/consolidate-excel-information-in-one-e-mail-for-each-user/48008884?noredirect=1#comment82995829_48008884\">Consolidate Excel Information in one e-mail for each user</a></p>\n\n<pre><code>Vendor              Consultor   CLIENT  Date        OS      Status Supervisor\n-----------------------------------------------------------------------------\ntest@test.com       Andrew      NAME 1  25/12/2017  123456  Pend   John@test\ntest@test.com       Andrew      NAME 2  31/12/2017  789123  Pend   John@test\ntest134@test.com    Joseph      NAME 3  10/12/2017  654321  Pend   Mike@test\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1514930885, "post_id": 48068151, "comment_id": 83110590, "body": "That looks like a reasonable statement of the problem. We like to see people&#39;s efforts here as well, would you edit that into your question, at the end? Thanks."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1514933484, "post_id": 48068151, "comment_id": 83111531, "body": "I don&#39;t understand why you can&#39;t just copy ALL cells over. Why is it a problem if it copies a &quot;blank&quot; cell? It&#39;ll still be blank on your output sheet."}, {"owner": {"reputation": 5, "user_id": 7491939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a893fc36be6df080c688a6b56b491c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Ernest Cheung", "link": "https://stackoverflow.com/users/7491939/ernest-cheung"}, "edited": false, "score": 0, "creation_date": 1514936665, "post_id": 48068151, "comment_id": 83112434, "body": "Sorry I should have been more specific, On the Output Page, these is an area for the user to specify specific months. (ie User might input July to September, in this case, i would only need to look between July August and September)"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 7355110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8f049731432230772e0f5b3fa4c246?s=128&d=identicon&r=PG&f=1", "display_name": "AdamC", "link": "https://stackoverflow.com/users/7355110/adamc"}, "is_accepted": false, "score": 0, "last_activity_date": 1514937086, "last_edit_date": 1514937086, "creation_date": 1514936134, "answer_id": 48069303, "question_id": 48068151, "link": "https://stackoverflow.com/questions/48068151/extract-row-from-spreadsheet-if-not-blank-according-to-month/48069303#48069303", "title": "Extract Row from Spreadsheet if Not Blank According to Month", "body": "<p>Assuming that your table start with \"A1\" [row1 - date headers], here is the code:</p>\n\n<pre><code>Sub CleanData()\nDim arr() As Variant\nDim sh As Worksheet\nlastcolumn = ActiveSheet.Range(\"A\" &amp; 1).End(xlToRight).Column\ntableHeight = Range(Columns(1), Columns(lastcolumn)).Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n\nFor i = 1 To lastcolumn\n    y = 0\n    For j = 1 To tableHeight\n        If Cells(j, i) &lt;&gt; \"\" Then\n           If longestcolumn &lt;= y Then\n                ReDim Preserve arr(lastcolumn - 1, y)\n                arr(i - 1, y) = Cells(j, i)\n                If j = 1 Then arr(i - 1, y) = MonthName(Month(Cells(j, i)))\n                longestcolumn = y\n                y = y + 1\n            Else\n                arr(i - 1, y) = Cells(j, i)\n                If j = 1 Then arr(i - 1, y) = MonthName(Month(Cells(j, i)))\n                y = y + 1\n            End If\n        End If\n    Next j\nNext i\n\nSet sh = ThisWorkbook.Sheets.Add(After:= _\n             ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\nsh.Range(Cells(1, 1), Cells(longestcolumn, lastcolumn)) = Application.Transpose(arr)\n\nEnd Sub\n</code></pre>\n\n<p><em>Edited tableHeight parameter equation</em></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 7491939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a893fc36be6df080c688a6b56b491c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Ernest Cheung", "link": "https://stackoverflow.com/users/7491939/ernest-cheung"}, "edited": false, "score": 0, "creation_date": 1515173861, "post_id": 48069702, "comment_id": 83213565, "body": "Thank you IvenBach, I will be trying out this code this weekend, I will let you know my results. Much Appreciated."}], "tags": [], "owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "is_accepted": false, "score": 0, "last_activity_date": 1514939589, "creation_date": 1514939589, "answer_id": 48069702, "question_id": 48068151, "link": "https://stackoverflow.com/questions/48068151/extract-row-from-spreadsheet-if-not-blank-according-to-month/48069702#48069702", "title": "Extract Row from Spreadsheet if Not Blank According to Month", "body": "<p>Based on your comment about the output page having an area that specifies the months feed that in and this should get what you want. <code>CopyNonEmtpyRowsOver</code> takes in the range that includes the information you want, as well as your destination sheet. If your requirements change and you need a different output sheet or the source of your information changes you can change them where the subs are called to be clearer about your intent.</p>\n\n<pre><code>Public Sub RowCopyProcedure()\n    'Edit the argument of sourceRange determine your limits\n    CopyNonEmtpyRowsOver Range(Sheet2.Cells(1, 1), Sheet2.Cells(11, \"I\")), Sheet1\nEnd Sub\n\nPrivate Sub CopyNonEmtpyRowsOver(ByVal sourceRange As Range, ByVal destinationSheet As Worksheet)\n\n    Dim rowToMigrate As Range\n    Dim populatedRows As Long\n    Dim isRowPopulated As Boolean\n    For Each rowToMigrate In sourceRange.Rows\n        On Error Resume Next\n            isRowPopulated = rowToMigrate.SpecialCells(xlCellTypeConstants).Count &gt; 0\n        On Error GoTo 0\n        If isRowPopulated Then\n            MigrateRowOver rowToMigrate, destinationSheet.Cells(populatedRows + 1, 1)\n            populatedRows = populatedRows + 1\n            isRowPopulated = False\n        End If\n    Next\nEnd Sub\n\nPrivate Sub MigrateRowOver(ByVal sourceRow As Range, ByVal destinationCell As Range)\n    sourceRow.Copy destinationCell.Resize(ColumnSize:=sourceRow.Columns.Count)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7491939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a893fc36be6df080c688a6b56b491c7a?s=128&d=identicon&r=PG&f=1", "display_name": "Ernest Cheung", "link": "https://stackoverflow.com/users/7491939/ernest-cheung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1514939589, "creation_date": 1514928816, "last_edit_date": 1514936727, "question_id": 48068151, "link": "https://stackoverflow.com/questions/48068151/extract-row-from-spreadsheet-if-not-blank-according-to-month", "title": "Extract Row from Spreadsheet if Not Blank According to Month", "body": "<p>I've been having trouble coming up with a formula that can extract and entire row if Not Blank and if the Month Matches.</p>\n\n<p>WorkSheet1 - Outputs:</p>\n\n<p><img src=\"https://i.stack.imgur.com/eAjea.png\" alt=\"WorkSheet1 - Outputs\"></p>\n\n<p>Worksheet2 - Inputs:</p>\n\n<p><img src=\"https://i.stack.imgur.com/i50cd.png\" alt=\"Worksheet2 - Inputs\"></p>\n\n<p>In Worksheet2 - Inputs, each month is a column heading. In the cells below, some are empty some are not.</p>\n\n<p>I need to find a way to copy the row of each cell that is Not Empty and paste it into the Output Worksheet in the Corresponding month cell.</p>\n\n<p>Update:</p>\n\n<p>Sorry I should have been more specific, On the Output Page, these is an area for the user to specify specific months. (ie User might input July to September, in this case, i would only need to look between July August and September)</p>\n\n<p>I would share the macros I've tried using before, but its mostly gibberish..</p>\n"}, {"tags": ["sql", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1514931942, "post_id": 48068485, "comment_id": 83110978, "body": "Thanks.  I have been looking at Allen Browne&#39;s ConcantRelated(), but have not been able to creat the module without getting a compile error.  Here is what I am putting in:  SELECT PARCELNUMBER,  ConcatRelated(&quot;ACCOUNTNUMBER&quot;, &quot;dbo_ACCOUNT&quot;, &quot;PARCELNUMBER = &quot; &amp; [PARCELNUMBER]) FROM dbo_ACCOUNT;    The table I am pulling from is dbo_ACCOUNT."}, {"owner": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1514932931, "post_id": 48068485, "comment_id": 83111337, "body": "PARCELNUMBER replaces UPC in the above."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1514948401, "post_id": 48068485, "comment_id": 83114892, "body": "What error? Is <i>PARCELNUMBER</i> a string or number? See my note on this item."}, {"owner": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1514994212, "post_id": 48068485, "comment_id": 83135297, "body": "PARCELNUMBER is AlphaNumeric set to 64 characters.  I have been working on this and got the module to save OK.  I realized that I had to put a WHERE statement in there to filter for records that were active and for the current tax year.  I was having issues with getting the where statement to work, so I did a make table, filtered for the accounts I wanted and am trying to run the concantrelated query from that table.  I am now getting an error saying:  Error 3075: Syntax error in string in query expression &#39;PARCELNUMBER= 2057170475174&quot;"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1514999602, "post_id": 48068485, "comment_id": 83138393, "body": "This means <i>PARCELNUMBER</i> is a string, so follow exactly as I had posted using <i>UPC</i> with single quote wrapping and not how you do with above comment which assumes a number. Do note: <code>ConcatRelated()</code> has an optional <i>strwhere</i> argument."}, {"owner": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1515007719, "post_id": 48068485, "comment_id": 83142529, "body": "I didn&#39;t realize I omitted a single quote.   I am now getting past the point where it asks for the separator, however I am getting a different error.  Error 3070: The Microsoft Access database engine does not recognize &#39;-1&#39; as a valid field name or expression.  I will look into using the strwhere argument once I can get everything else to work.  I appreciate all your help in this.  VBA is not one of my strong points."}, {"owner": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1515009975, "post_id": 48068485, "comment_id": 83143587, "body": "OK, I got it working.  I had to remove the strSeparator = &quot;; &quot;   For some reason Microsoft access 2016 didn&#39;t like it.  It is giving me the results I was hoping for with a comma separator.  Thanks again!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "edited": false, "score": 0, "creation_date": 1515011232, "post_id": 48068485, "comment_id": 83144068, "body": "Try passing empty values for <i>strWhere</i> and <i>strOrder</i> that you do not use (see empty commas): <code>ConcatRelated(&quot;[Account Number]&quot;, &quot;myTable&quot;, &quot;PARCELNUMBER = &#39;&quot; &amp; [PARCELNUMBER] &amp; &quot;&#39;&quot;, , , strSeparator = &quot;; &quot;)</code>"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1514930719, "creation_date": 1514930719, "answer_id": 48068485, "question_id": 48068138, "link": "https://stackoverflow.com/questions/48068138/microsoft-access-2016-loop-query/48068485#48068485", "title": "Microsoft Access 2016 loop query?", "body": "<p>Consider Allen Browne's <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">ConcatRelated()</a> where you implement by doing the following:</p>\n\n<ol>\n<li><p>Place the VBA public function code in a standard module (not behind any form/report).</p></li>\n<li><p>Call it via an SQL  query. Below assumes UPC is a string column, otherwise remove single quote wrapping. Additionally, be sure to change default separator to semicolon.</p>\n\n  <pre class=\"lang-sql prettyprint-override\"><code>SELECT UPC,  \n       ConcatRelated(\"[Account Number]\", \"myTable\", \"UPC = '\" &amp; [UPC] &amp; \"'\",\n                     strSeparator = \"; \")\nFROM myTable;\n</code></pre></li>\n</ol>\n\n<p>Do note: since you are running a VBA-specific method, this function will not be available if you run MS Access outside the GUI (i.e., MSAccess.exe) such as ODBC/OLEDB connections.</p>\n"}], "owner": {"reputation": 1, "user_id": 2183265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d752d9260d10b218dcdc3b1f781b2bf?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/2183265/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514930719, "creation_date": 1514928767, "last_edit_date": 1514928790, "question_id": 48068138, "link": "https://stackoverflow.com/questions/48068138/microsoft-access-2016-loop-query", "title": "Microsoft Access 2016 loop query?", "body": "<p>I have a table that has account numbers and UPC numbers.  UPC number are unique, but each UPC may have several account numbers associated with it.  It may have only one account number, or it may have several account numbers.</p>\n\n<p>What I would like to do is get a full list of the account numbers associated with the UPC field, but put them all in one result field, separated by either a comma or semicolon. </p>\n\n<p>For example on the query result.... </p>\n\n<pre><code>UPC                        Account Number\n1225486214781              R0002458; R3325482; M2154865; M5214861; C2145789\n</code></pre>\n\n<p>Would a loop query enable me to do this?  If so, how would I go about putting it together?</p>\n"}, {"tags": ["vba", "arguments", "optional-arguments"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1514928801, "post_id": 48068093, "comment_id": 83109852, "body": "If a Sub has parameters then you&#39;d need to create a &quot;stub&quot; procedure to call it from (even when all parameters are optional and have default values): you could then run that using F5"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1514930724, "post_id": 48068170, "comment_id": 83110540, "body": "Thank you! That&#39;s what I was afraid of. :)"}], "tags": [], "owner": {"reputation": 71, "user_id": 7355110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8f049731432230772e0f5b3fa4c246?s=128&d=identicon&r=PG&f=1", "display_name": "AdamC", "link": "https://stackoverflow.com/users/7355110/adamc"}, "is_accepted": true, "score": 1, "last_activity_date": 1514928925, "creation_date": 1514928925, "answer_id": 48068170, "question_id": 48068093, "link": "https://stackoverflow.com/questions/48068093/excel-vba-program-with-optional-argument-wont-start/48068170#48068170", "title": "(Excel) vba program with optional argument won&#39;t start", "body": "<p>You can call it without args but from another sub:</p>\n\n<pre><code>Sub anotherSub()\n Call PopulateUniqueIngredientItems\nEnd Sub\n\nSub PopulateUniqueIngredientItems(Optional SortSheets As Boolean = True)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 48068170, "answer_count": 1, "score": 1, "last_activity_date": 1514928925, "creation_date": 1514928574, "question_id": 48068093, "link": "https://stackoverflow.com/questions/48068093/excel-vba-program-with-optional-argument-wont-start", "title": "(Excel) vba program with optional argument won&#39;t start", "body": "<p>I have a program (Sub) in VBA (in Excel) that has an optional Boolean argument. The default is set to true. When I try to start the program with F8, it dings at me and does nothing. When I try to start it with F5, it brings up the program list (same as alt-F8 from within Excel itself). The program I'm trying to start is not in the list.</p>\n\n<p>The relevant part of the code is just the first line:</p>\n\n<p>Sub PopulateUniqueIngredientItems(Optional SortSheets As Boolean = True)</p>\n\n<p>If I make argument required, it starts (but fails due to the missing argument). </p>\n\n<p>Any ideas as to what am I doing wrong? Or, is it just not possible to start a Sub directly when it has a parameter?</p>\n"}, {"tags": ["vba", "web", "extract", "innerhtml"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "edited": false, "score": 0, "creation_date": 1515107479, "post_id": 48069296, "comment_id": 83185498, "body": "Thanks bro. I tried your solution. It&#39;s Ok but I faced strange problem. Please download my Excel file(<a href=\"https://ufile.io/xc97w\" rel=\"nofollow noreferrer\">ufile.io/xc97w</a>). There are 2 buttons that are almost similar. Button 1 is not OK (why?) and Button 2 is OK. Thanks in advance."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "edited": false, "score": 0, "creation_date": 1515158031, "post_id": 48069296, "comment_id": 83204483, "body": "@AliM67 if you have a new question, please open a new thread so that other people can help you (here only I will see this comment). In any case, share your code and don&#39;t ask to download anything, I don&#39;t think anyone would take that risk. Thanks"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1514936063, "creation_date": 1514936063, "answer_id": 48069296, "question_id": 48067867, "link": "https://stackoverflow.com/questions/48067867/extract-data-from-website-using-vba-get-nothing/48069296#48069296", "title": "extract data from website using VBA get nothing", "body": "<p>This should be the answer to your question, though I don't think it really solves your problem. </p>\n\n<p>The XMLHTTP request you do to this website respond with an empty body, as you can notice from the line <code>Debug.Print .responseText</code>: </p>\n\n<pre><code>&lt;HTML&gt;\n    &lt;HEAD&gt;\n        &lt;TITLE&gt;&amp;#1575;&amp;#1605;&amp;#1740;&amp;#1606; &amp;#1570;&amp;#1588;&amp;#1606;&amp;#1575; &amp;#1575;&amp;#1740;&amp;#1585;&amp;#1575;&amp;#1606;&amp;#1740;&amp;#1575;&amp;#1606;&lt;/TITLE&gt;\n        &lt;META NAME=\"Keywords\" CONTENT=\"\"&gt;\n        &lt;META HTTP-EQUIV=\"Refresh\" CONTENT=\"0;URL=http://www.iafi.ir\"&gt;\n        &lt;META NAME=\"Description\" CONTENT=\"\"&gt;\n    &lt;/HEAD&gt; \n    &lt;BODY&gt; &lt;-- body is empty\n    &lt;/BODY&gt;\n&lt;/HTML&gt;\n</code></pre>\n\n<p>This is why, when you print the <code>.body.innerHTML</code> of your <code>HTML_document</code>, you get an empty string. </p>\n\n<p>Some websites are built in a way that only the full stack execution (i.e. also JavaScript execution, which doesn't happen when you perform an XMLHTTP request) is able to render correctly what you see in your browser.\nIn your specific case, you might need to get the information performing a slower but always working scraping based on an invisible browser. You can check out <a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba/27069914#27069914\">this answer</a> I wrote some time ago to have an idea. </p>\n"}], "owner": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 48069296, "answer_count": 1, "score": 1, "last_activity_date": 1514936063, "creation_date": 1514927319, "question_id": 48067867, "link": "https://stackoverflow.com/questions/48067867/extract-data-from-website-using-vba-get-nothing", "title": "extract data from website using VBA get nothing", "body": "<p>I use below code to read and extract data from websites. But in specific URL (<a href=\"http://www.iamf.ir\" rel=\"nofollow noreferrer\">http://www.iamf.ir</a>) there is a problem!</p>\n\n<pre><code>    Dim HTML_Content As HTMLDocument\n    Dim dados As Object\n\n    'Create HTMLFile Object\n    Set HTML_Content = New HTMLDocument\n\n    'Get the WebPage Content to HTMLFile Object\n    With CreateObject(\"msxml2.xmlhttp\")\n        .Open \"GET\", \"http://www.iamf.ir\", False\n        .send\n        HTML_Content.body.innerHTML = .responseText\n        Debug.Print .responseText                ' it's OK\n        Debug.Print HTML_Content.body.innerHTML  ' it show nothing! (problem is here)\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23, "user_id": 9165326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a66721b9f39e7b5fa6eed4a7b9a6186?s=128&d=identicon&r=PG&f=1", "display_name": "StillLearningHowtoCode", "link": "https://stackoverflow.com/users/9165326/stilllearninghowtocode"}, "edited": false, "score": 0, "creation_date": 1514928957, "post_id": 48067501, "comment_id": 83109910, "body": "@StillLearningHowtoCode  then remove the <code>Application.Quit</code>"}, {"owner": {"reputation": 23, "user_id": 9165326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a66721b9f39e7b5fa6eed4a7b9a6186?s=128&d=identicon&r=PG&f=1", "display_name": "StillLearningHowtoCode", "link": "https://stackoverflow.com/users/9165326/stilllearninghowtocode"}, "edited": false, "score": 0, "creation_date": 1514934394, "post_id": 48067501, "comment_id": 83111822, "body": "Any idea how to accomplish this without closing the original file as in all likelihood our team will be saving the file as they make edits, not always at the time they want to close it.  As a result, i&#39;d like to version my backup to coincide with each time they save the file."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23, "user_id": 9165326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a66721b9f39e7b5fa6eed4a7b9a6186?s=128&d=identicon&r=PG&f=1", "display_name": "StillLearningHowtoCode", "link": "https://stackoverflow.com/users/9165326/stilllearninghowtocode"}, "edited": false, "score": 0, "creation_date": 1514935892, "post_id": 48067501, "comment_id": 83112268, "body": "@StillLearningHowtoCode Consider <b>reversing the order</b> of the saves.  First do the backup save and then re-save with the original filename..........make sure when you re-save with the original name, that you do so without the password."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1514925326, "creation_date": 1514925326, "answer_id": 48067501, "question_id": 48066987, "link": "https://stackoverflow.com/questions/48066987/excel-vba-code-to-password-protect-back-up-file/48067501#48067501", "title": "Excel VBA code to password protect back up file", "body": "<p>I have an Excel file called <code>master.xlsm</code>.  This tiny sub:</p>\n\n<p>1.saves the file<br>\n2.saves a backup copy of the file with protection<br>\n3.quits Excel</p>\n\n<pre><code>Sub SaveAndBackup()\n    ThisWorkbook.Save\n    ThisWorkbook.SaveAs Filename:=\"backup.xlsm\", Password:=\"secret\"\n    Application.Quit\nEnd Sub\n</code></pre>\n\n<p>Change this  to meet your own file-naming and location needs.</p>\n"}], "owner": {"reputation": 23, "user_id": 9165326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a66721b9f39e7b5fa6eed4a7b9a6186?s=128&d=identicon&r=PG&f=1", "display_name": "StillLearningHowtoCode", "link": "https://stackoverflow.com/users/9165326/stilllearninghowtocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1514925326, "creation_date": 1514922712, "last_edit_date": 1531161705, "question_id": 48066987, "link": "https://stackoverflow.com/questions/48066987/excel-vba-code-to-password-protect-back-up-file", "title": "Excel VBA code to password protect back up file", "body": "<p>Good Afternoon,</p>\n\n<p>I have the below code that I'm using to create a back up of my workbook upon saving.  It is saving to a separate location and everything appears to be working correctly.  The below code is entered for the workbook instead of individual sheets.  </p>\n\n<p>Can anyone tell me how I can create a password protection on the back up file the below code is generating?  </p>\n\n<p>I'm fairly new to VBA scripting but I have seen a function to create password protection with the save as function but I don't know how to incorporate that into my code below.  </p>\n\n<p>Any help is greatly appreciated!</p>\n\n<hr>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nApplication.EnableEvents = False\n\nthisPath = ThisWorkbook.Path\nmyName = Left(ThisWorkbook.Name, (InStrRev(ThisWorkbook.Name, \".\") - 1))\next = Right(ThisWorkbook.Name, Len(ThisWorkbook.Name) - InStrRev(ThisWorkbook.Name, \".\"))\nbackupdirectory = \"Backup\"\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nIf Not FSO.FolderExists(ThisWorkbook.Path &amp; \"/\" &amp; backupdirectory) Then\n    FSO.CreateFolder (ThisWorkbook.Path &amp; \"/\" &amp; backupdirectory)\nEnd If\n\nT = Format(Now, \"mmm dd yyyy hh mm ss\")\nThisWorkbook.SaveCopyAs thisPath &amp; \"\\\" &amp; backupdirectory &amp; \"\\\" &amp; myName &amp; \" \" &amp; T &amp; \".\" &amp; ext\n\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 0, "creation_date": 1514986936, "post_id": 48067782, "comment_id": 83131005, "body": "I added the save call and it works beautifully. I have tweaked it a little as well. Thanks for the help!"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1514928031, "last_edit_date": 1514928031, "creation_date": 1514926802, "answer_id": 48067782, "question_id": 48066777, "link": "https://stackoverflow.com/questions/48066777/displaying-user-defined-property-of-mailitem-in-outlook/48067782#48067782", "title": "Displaying User Defined Property of MailItem in Outlook", "body": "<p>A save is required for a selection. An Inspector item prompts for a save.</p>\n\n<pre><code>Private Sub MarkHasNote_DisplayTest()\n\n    ' Add the UserProperty column with Field Chooser\n    ' You can view the value toggling when you run through the code\n\n    Dim Selection As Selection\n    Dim UserDefinedFieldName As String\n    Dim objProperty As UserProperty\n    Dim objItem As mailItem\n\n    UserDefinedFieldName = \"NoteTest\"\n    Set objItem = GetCurrentItem()\n    Set objProperty = objItem.UserProperties.Add(UserDefinedFieldName, Outlook.OlUserPropertyType.olYesNo, olFormatYesNoIcon)\n\n    objProperty.Value = Not objProperty.Value\n\n    ' Required for an explorer selection\n    objItem.Save\n\n    ' For an inspector item there would be a prompt to save\n    '  if not already done in the code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1317, "favorite_count": 0, "accepted_answer_id": 48067782, "answer_count": 1, "score": 2, "last_activity_date": 1593041370, "creation_date": 1514921699, "last_edit_date": 1593041370, "question_id": 48066777, "link": "https://stackoverflow.com/questions/48066777/displaying-user-defined-property-of-mailitem-in-outlook", "title": "Displaying User Defined Property of MailItem in Outlook", "body": "<p>I am attempting to add convenience when adding notes to emails in Outlook. </p>\n\n<p>My plan is to take my current procedure, which adds the notes to the selected email (as an attachment), and have it call a procedure which will set a <code>UserProperty</code> on the <code>MailItem</code> object so that I can easily see which emails have notes attached by adding a custom column to my email list view. </p>\n\n<p>From scouring the internet I have pieced together the following.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub MarkHasNote()\n    Dim Selection As Outlook.Selection\n    Dim UserDefinedFieldName As String\n    Dim objProperty As Outlook.UserProperty\n    Dim objItem As MailItem\n\n    UserDefinedFieldName = \"Note\"\n    Set objItem = GetCurrentItem()\n    Set objProperty = objItem.UserProperties.Add(UserDefinedFieldName, Outlook.OlUserPropertyType.olYesNo, olFormatYesNoIcon)\n    objProperty.Value = True\nEnd Sub\n\nFunction GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n        Case \"Explorer\"\n            Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n        Case \"Inspector\"\n            Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n\n<p>I have set a breakpoint and checked the <code>UserProperties</code> of the <code>MailItem</code>. I see that the details are there and the value is set to <strong>\"True\"</strong>. However, the email does not show the Yes/No icon in the <strong>\"Note\"</strong> column of the email pane of Outlook.</p>\n\n<p>How do I get Outlook to show my user defined property value in the email pane when I add the column to the view?</p>\n"}, {"tags": ["vba", "ms-access", "winapi"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1514921558, "post_id": 48066658, "comment_id": 83106774, "body": "&quot;<i>Is there a way to get the last input time ... for a specific applications (wich has an hWnd)?</i>&quot; - not directly, no. You will likely have to resort to a system-wide message hook via <code>SetWindowsHookEx()</code> to manually keep track of all input messages being sent around the system"}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 1, "creation_date": 1514945727, "post_id": 48066658, "comment_id": 83114407, "body": "Your example code compares current form and current control to previous values. To cover your &quot;typing in a textbox for a long time&quot; case, you could add the textbox Text property to that comparison (if it was a textbox). The case &quot;when user is watching records for a while&quot; would require them to at least be moving between records to detect anything (otherwise even mouse and keyboard hooks wouldn&#39;t help you) so you could also add the current form&#39;s current record ID or bookmark to the comparison to cover that case."}], "owner": {"reputation": 348, "user_id": 6895653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a29f287800b9ea23f06b1fe328761f9?s=128&d=identicon&r=PG&f=1", "display_name": "CamiloVA", "link": "https://stackoverflow.com/users/6895653/camilova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1514921094, "creation_date": 1514921094, "question_id": 48066658, "link": "https://stackoverflow.com/questions/48066658/getlastinputinfo-for-ms-access-application", "title": "GetLastInputInfo for MS Access Application", "body": "<p>Is there a way to get the last input time like <strong>GetLastInputInfo</strong> from library user32.dll but only for a specific applications (wich has an <strong>hWnd</strong>)?, not for the session-wide as GetLastInputInfo actually does, I mean, for the application (MS Access in my case).</p>\n\n<p><strong><em>Because I'm trying to close the MS Access Application after few minutes of inactivity, but I can't get this in a simple way.</em></strong></p>\n\n<p>Actually, I can get the <strong>GetLastInputInfo</strong> and close Access after few minutes of complete user's inactivity (no keys pressed and no mouse movements), but it needs to be able to close its when user is using, for example, a internet browser and he has forgotten close the Access Application after 5 minutes.</p>\n\n<p>It should be write using VBA.</p>\n\n<p>I can check if user is using any Form inside the MS Access Application using this <a href=\"https://msdn.microsoft.com/es-es/vba/access-vba/articles/detect-user-idle-time-or-inactivity\" rel=\"nofollow noreferrer\">Example</a>. But it doesn't detect activity when user is typing on a textbox a long time, or when user is whatching records for a while. I'm trying to do this in a \"<em>elegant</em>\" way, not writing a event handler on each controls on each form...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "edited": false, "score": 1, "creation_date": 1514921720, "post_id": 48066574, "comment_id": 83106842, "body": "Try it without the .Select method at the end, i.e. Set rng = Range(Selection,Selection.End(xlToRight))"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1514922305, "last_edit_date": 1514922305, "creation_date": 1514920920, "answer_id": 48066632, "question_id": 48066574, "link": "https://stackoverflow.com/questions/48066574/setting-the-range-of-a-chart-in-vba-as-a-variable/48066632#48066632", "title": "Setting the range of a chart in VBA as a variable", "body": "<p>Do not use <code>.Select</code></p>\n\n<pre><code> Sub temp3()\n'\n' temp3 Macro\n'\n    Dim rng As Range\n    Dim shp As Chart\n    With Worksheets(\"Sheet1\") 'Change to your sheet\n        Set rng = .Range(\"A1\", .Range(\"A1\").End(xlDown).End(xlToRight))\n\n        Set shp = Charts.Add\n        Set shp = shp.Location(Where:=xlLocationAsObject, Name:=.Name)\n        With shp\n            .ChartType = xlLineMarkers\n            .SetSourceData rng\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2695, "user_id": 886357, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d0e09de07d348483088b599fc27eff3a?s=128&d=identicon&r=PG", "display_name": "Morpheus", "link": "https://stackoverflow.com/users/886357/morpheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 1, "accepted_answer_id": 48066632, "answer_count": 1, "score": 0, "last_activity_date": 1514922305, "creation_date": 1514920621, "question_id": 48066574, "link": "https://stackoverflow.com/questions/48066574/setting-the-range-of-a-chart-in-vba-as-a-variable", "title": "Setting the range of a chart in VBA as a variable", "body": "<p>I am trying to set the define a range variable and then use this range variable as a source for an Excel chart. But I am getting the Object Required Error when i run my Macro at <code>Set rng =</code> </p>\n\n<pre><code> Sub temp3()\n'\n' temp3 Macro\n'\n    Dim rng As Range\n    Range(\"A1\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Set rng = Range(Selection, Selection.End(xlToRight)).Select\n\n    ActiveSheet.Shapes.AddChart2(332, xlLineMarkers).Select\n    ActiveChart.SetSourceData Source:=rng\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 1, "creation_date": 1514921314, "post_id": 48066513, "comment_id": 83106674, "body": "Hi! Please note that Stack Overflow is an English-only site. Edit your question into English or it will likely be closed as &#39;unclear what you are asking&#39;."}, {"owner": {"reputation": 1576, "user_id": 5453515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41cae4ee9e62e14df6757fc7a364cb2?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane Martin", "link": "https://stackoverflow.com/users/5453515/stephane-martin"}, "edited": false, "score": 0, "creation_date": 1514921542, "post_id": 48066513, "comment_id": 83106770, "body": "Just wrote a translation, it is in edit review."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1576, "user_id": 5453515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c41cae4ee9e62e14df6757fc7a364cb2?s=128&d=identicon&r=PG&f=1", "display_name": "Stephane Martin", "link": "https://stackoverflow.com/users/5453515/stephane-martin"}, "edited": false, "score": 1, "creation_date": 1514921976, "post_id": 48066513, "comment_id": 83106953, "body": "@StephaneMartin I appreciate your intentions, but read <a href=\"https://meta.stackoverflow.com/a/297680/7296893\">this meta post</a> : <i>Please do not translate posts for the OP. They need to be able to respond to feedback, and if they cannot themselves translate the post we cannot be certain that they can understand any feedback provided (by comments, answers, or Help Center content).</i>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1514925084, "post_id": 48066513, "comment_id": 83108305, "body": "Note that, while your edited question is no longer that unclear, you&#39;re not sharing an attempt, and it&#39;s possibly too broad (and half-answered by <a href=\"https://stackoverflow.com/a/35637357/7296893\">this answer</a>, it currently deletes all leading zeroes, but you can easily adapt it to only remove the first and last zero)"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1514964758, "post_id": 48066513, "comment_id": 83119605, "body": "@ErikvonAsmuth et al: The question is clear, and here is a fancy solution: <code>StrippedCode = Left(Code, Len(Code) - (Len(StrReverse(Val(&quot;1&quot; &amp; StrReverse(Code)))) - 1)) &amp; CStr(Val(StrReverse(Val(&quot;1&quot; &amp; StrReverse(Code)))) \\ 10)</code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1514965779, "post_id": 48066513, "comment_id": 83120015, "body": "@Gustav see the edits, it wasn&#39;t when it was posted, or when it was closed. Now it probably is a duplicate, that&#39;s why I haven&#39;t voted to reopen"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1514966720, "post_id": 48066513, "comment_id": 83120409, "body": "@ErikvonAsmuth: Yes, I saw your note but, as you stated, it is only the (easy) half of a solution, and the part left is really what this question is about."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1514967242, "post_id": 48066513, "comment_id": 83120615, "body": "@Gustav It would be what the question was about if OP had shared this in his attempt. Currently, it&#39;s either too broad (since OP wants to do two things at once and doesn&#39;t show an attempt nor specifies what is hard) or a duplicate in my opinion, or still unclear, since I see the expected output doesnt fit the question"}, {"owner": {"reputation": 21, "user_id": 9165163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cb41f10b281cda65760cea0141ceda?s=128&d=identicon&r=PG&f=1", "display_name": "SAID BACHIRI", "link": "https://stackoverflow.com/users/9165163/said-bachiri"}, "edited": false, "score": 0, "creation_date": 1514978432, "post_id": 48066513, "comment_id": 83126309, "body": "Hi all.I inspire the solution of Erik that I put in a function. It works very well. Solved problem. Thank for all ."}, {"owner": {"reputation": 7442, "user_id": 3745896, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ptFQe.jpg?s=128&g=1", "display_name": "River", "link": "https://stackoverflow.com/users/3745896/river"}, "edited": false, "score": 0, "creation_date": 1515000243, "post_id": 48066513, "comment_id": 83138752, "body": "@SAIDBACHIRI could you please post your solution as an answer? This way others who have the same problem can see how you solved it."}, {"owner": {"reputation": 21, "user_id": 9165163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cb41f10b281cda65760cea0141ceda?s=128&d=identicon&r=PG&f=1", "display_name": "SAID BACHIRI", "link": "https://stackoverflow.com/users/9165163/said-bachiri"}, "edited": false, "score": 0, "creation_date": 1515007412, "post_id": 48066513, "comment_id": 83142391, "body": "Hi all. anything special.  in a standar module: Public Function DeleteZero (ByVal Code as String) on \u200b\u200berror goto Err_DeleteZero     DeleteZero = Left (Code, Len (Code) - (Len (StrReverse (Val (&quot;1&quot; &amp; StrReverse (Code))) ) - 1)) &amp; CStr (Val (StrReverse (Val (&quot;1&quot; &amp; StrReverse (Code)))) \\ 10) Err_DeleteZero: ...Then I created an updated query. Where I put DeleteZero ([Code]). Then I copied the sql code of the query to execute it on click of a botton  with DoSetWarning. For me it works very well. Probably for the other he wants a Null&#39;s management. Thank you . sorry for my bad English"}], "answers": [{"tags": [], "owner": {"reputation": 3958, "user_id": 1311658, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/909aa52ce0850c5fd2135c8e9d6ea914?s=128&d=identicon&r=PG", "display_name": "Tom Collins", "link": "https://stackoverflow.com/users/1311658/tom-collins"}, "is_accepted": false, "score": 0, "last_activity_date": 1515015715, "creation_date": 1515015715, "answer_id": 48085523, "question_id": 48066513, "link": "https://stackoverflow.com/questions/48066513/delete-leading-zeros-in-alphanumeric-strings/48085523#48085523", "title": "Delete leading zeros in alphanumeric strings", "body": "<p>Based on the edited question, it's just this simple. Btw, this assumes there is at least 1 leading alpha character.</p>\n\n<pre><code>Function TrimLeadingZeros(MyString As String) As String\n   Dim Idx As Integer\n   For Idx = 2 To Len(MyString)\n      If IsNumeric(Mid(MyString, Idx, 1)) Then\n         Exit For\n      End If\n   Next\n   TrimLeadingZeros = Left(MyString, Idx - 1) &amp; CStr(CLng(Mid(MyString, Idx)))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9165163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cb41f10b281cda65760cea0141ceda?s=128&d=identicon&r=PG&f=1", "display_name": "SAID BACHIRI", "link": "https://stackoverflow.com/users/9165163/said-bachiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1593730353, "creation_date": 1514920318, "last_edit_date": 1593730353, "question_id": 48066513, "link": "https://stackoverflow.com/questions/48066513/delete-leading-zeros-in-alphanumeric-strings", "title": "Delete leading zeros in alphanumeric strings", "body": "<p>I use <em>Access 2016</em>. I want to use VBA to delete the zeroes (<em>0</em>) that are to the right of letters  and to the left of numbers.</p>\n\n<p>I have a table with alphanumeric fields such as this: </p>\n\n<pre><code>A00123050   AB00245098 TH00001250\n</code></pre>\n\n<p>I would like to delete the leading zeroes (after the leading letters) in each field like this:</p>\n\n<pre><code>A123050  AB245098 TH1250\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514928778, "post_id": 48067173, "comment_id": 83109834, "body": "im getting an immediate error with Sub SaveStats()  Ambiguous name detected: SaveStats"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514928790, "post_id": 48067173, "comment_id": 83109845, "body": "@JoBe  am not sure.  I only ran some simple tests."}, {"owner": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514928999, "post_id": 48067173, "comment_id": 83109929, "body": "first line &quot;Sub SaveStats()&quot;"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514929056, "post_id": 48067173, "comment_id": 83109953, "body": "@JoBe  Just change the name................it is conflicting with an old macro.............."}, {"owner": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514929138, "post_id": 48067173, "comment_id": 83109981, "body": "my bad i did not remove the generic &quot;sub Macro #&quot;"}, {"owner": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514929229, "post_id": 48067173, "comment_id": 83110017, "body": "This worked. Thanks!   I did not think to create sets. I will have read up on this to up my Macro game"}, {"owner": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514929295, "post_id": 48067173, "comment_id": 83110045, "body": "I don&#39;t understand why your answer was downvoted as you answered everything correctly."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "edited": false, "score": 0, "creation_date": 1514929376, "post_id": 48067173, "comment_id": 83110077, "body": "@JoBe  Perhaps because the macro has no error handling.............it will die if there is no data below the header!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1514929495, "last_edit_date": 1514929495, "creation_date": 1514923574, "answer_id": 48067173, "question_id": 48066345, "link": "https://stackoverflow.com/questions/48066345/excel-vba-macro-how-to-grab-median-and-average-of-column-and-print-out-results/48067173#48067173", "title": "Excel VBA Macro - How to grab Median and Average of column and print out results", "body": "<p>Say that somewhere in the worksheet we have a header cell with data below it like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YjRyD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YjRyD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Running this short macro will:</p>\n\n<p>1.locate the header and associated column of data<br>\n2. put the desired statistics in the cells below the values<br></p>\n\n<pre><code>Sub SaveStats()\n    Dim header As Range, DataRange As Range\n\n    Set header = Cells.Find(What:=\"total cycle time\", after:=Cells(1, 1))\n    Set DataRange = Range(header, Cells(Rows.Count, header.Column).End(xlUp))\n\n    With Application.WorksheetFunction\n        Cells(DataRange.Rows.Count + DataRange.Row, DataRange.Column).Value = .Average(DataRange)\n        Cells(DataRange.Rows.Count + DataRange.Row + 1, DataRange.Column).Value = .Median(DataRange)\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/A2qP4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A2qP4.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE:</strong></p>\n\n<p>The macro has no error handling.  It will die if there is no data below the header.</p>\n"}], "owner": {"reputation": 3, "user_id": 7991853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48fd0d967cec16e05e67187b424ee88?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Be", "link": "https://stackoverflow.com/users/7991853/jo-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1076, "favorite_count": 1, "accepted_answer_id": 48067173, "answer_count": 1, "score": 0, "last_activity_date": 1514929495, "creation_date": 1514919575, "last_edit_date": 1514921032, "question_id": 48066345, "link": "https://stackoverflow.com/questions/48066345/excel-vba-macro-how-to-grab-median-and-average-of-column-and-print-out-results", "title": "Excel VBA Macro - How to grab Median and Average of column and print out results", "body": "<p>I am trying to look up a column name \"total cycle time\" then at the very end of the column I would like the average and then a line below that the median of the entire column. </p>\n\n<p>Below is a start but it seems to only pull from one table hence the Table14 reference. I don't understand how to state look at only this active sheet.</p>\n\n<pre><code>Sub Macro10()\n'\n' Macro10 Macro\n'\nRange(\"U\" &amp; Cells.Rows.Count).End(xlUp).Select\nActiveCell.Offset(1, 0).Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = _\n        \"=AVERAGE(Table14[[#Headers],[#Data],[Total Cycle Time]])\"\n    ActiveCell.Offset(1, 0).Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = _\n        \"=MEDIAN(Table14[[#Headers],[#Data],[Total Cycle Time]])\"\n\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514934200, "post_id": 48066169, "comment_id": 83111769, "body": "Since you have a table, you don&#39;t need code for your ask. You can just apply the conditional formatting directly to the table. Use formula as an option and the formula will be something like <code>=OR(IsNumber(Search(tbl[Overall Description],&quot;concrete&quot;)),IsNumber(Search(tbl[Description of Work],&quot;concrete&quot;)...</code>"}, {"owner": {"reputation": 11, "user_id": 9165132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44dba1ec9a39903b985435cbdb191406?s=128&d=identicon&r=PG&f=1", "display_name": "NoeyPI", "link": "https://stackoverflow.com/users/9165132/noeypi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514988369, "post_id": 48066169, "comment_id": 83131772, "body": "I kept getting a message saying there&#39;s a problem with this formula.  Is there a similar formula which would work with an input value instead of including the search term within the formula?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514993705, "post_id": 48066169, "comment_id": 83134998, "body": "use <code>Search(&quot;concrete&quot;,tbl[Overall Description])</code> instead, I was only writing an example and got the syntax wrong. Also note you&#39;ll need to make adjustments for your table name, etc. What I provided was concept only for you to play with."}], "owner": {"reputation": 11, "user_id": 9165132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44dba1ec9a39903b985435cbdb191406?s=128&d=identicon&r=PG&f=1", "display_name": "NoeyPI", "link": "https://stackoverflow.com/users/9165132/noeypi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514987836, "creation_date": 1514918775, "last_edit_date": 1514987836, "question_id": 48066169, "link": "https://stackoverflow.com/questions/48066169/highlight-cell-in-one-column-based-on-conditional-formatting-of-other-columns", "title": "Highlight Cell in one Column BASED on Conditional Formatting of Other Columns", "body": "<p>I am a beginner with Macros. I slightly changed my code below to include conditional formatting based on an Input Value.  The code below applies a conditional format (orange highlight) to 6 specific columns based on whether those columns contain a specific text. I would like to add another step after this coding where the cells of another column (column B) are highlighted in a different color (yellow) if ANY of the 6 columns contain the orange highlighted conditional formatting. </p>\n\n<p>So for example - In Row 2, if any of the 6 columns contain the conditional formatting of an orange highlight, then B2 will be highlighted in yellow.</p>\n\n<p>Is there a similar formula which would work with an input value instead of including the search term within the formula? I don't know whether the solution lies in a specific formula or if I need to use an if and then statement instead.</p>\n\n<p>I've searched other online posts and there does seem to be a way to check whether a cell has conditional formatting by searching for a cell's Formatted Interior Color. I'm trying to create an If and then statement which checks all 6 columns per row and if I can get the specific row number - maybe I can apply the yellow highlighting to the 2nd cell of that row number. </p>\n\n<p>Please let me know if anyone has any further suggestions.</p>\n\n<p>Thanks </p>\n\n<p><a href=\"https://i.stack.imgur.com/FN1G4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FN1G4.png\" alt=\"enter image description here\"></a></p>\n"}]