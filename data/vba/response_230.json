[{"tags": ["excel", "vba", "copy", "autofilter", "listobject"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559777610, "post_id": 56469221, "comment_id": 99529878, "body": "Try to record macro with your desired actions, and see, if it even possible. Then generated VBA code"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559777740, "post_id": 56469221, "comment_id": 99529902, "body": "Try <code>With ComboWeekTable.Range</code>"}, {"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "edited": false, "score": 0, "creation_date": 1559778592, "post_id": 56469221, "comment_id": 99530048, "body": "I changed to ComboWeekTable.Range.  It is now highlighting the entire row below that ( &quot;.Autofilter.Rang.Copy&quot; ) and saying &quot;Object variable with block variable not set&quot;.  I have no idea what that means."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559779643, "post_id": 56469221, "comment_id": 99530209, "body": "Are there any visible rows at that point?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "edited": false, "score": 0, "creation_date": 1559791731, "post_id": 56469563, "comment_id": 99532122, "body": "The top bit of code works.  Thanks!  But I&#39;m new to VBA and don&#39;t understand where to place the second bit of code that eliminates errors if no rows are found.  Can you please tell me exactly where to place these 3 lines that eliminate run-time errors?"}, {"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "edited": false, "score": 0, "creation_date": 1559801255, "post_id": 56469563, "comment_id": 99534138, "body": "I am new to this and can barely make heads or tails out of my own code.  I do not understand how to translate your <code>Range(&quot;A15&quot;)</code> into the actual code that i have shown in my original post.  I&#39;m copying from table ComboWeekTable and am trying to paste to the bottom of RollupWeekTable.  And there is already some code in there, which i don&#39;t completely understand, to bump me down to the next available line (<code>LastRollupWeekRow = .Cells(.Rows.Count, sh1Col).End(xlUp).Row</code>).   Please help me understand how to cross-reference your &quot;A15&quot; to my code."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1559838419, "last_edit_date": 1559838419, "creation_date": 1559780369, "answer_id": 56469563, "question_id": 56469221, "link": "https://stackoverflow.com/questions/56469221/copy-a-filtered-table/56469563#56469563", "title": "Copy a Filtered Table", "body": "<p>EDITED to match your setup. This worked for me in testing:</p>\n\n<pre><code>Sub Tester()\n\n    Dim rngPaste As Range, ComboWeekTable As ListObject\n    Dim RollupTimeStamp As Date\n\n    'find the paste position\n    With RollupWeekSheet.ListObjects(\"Table2\").DataBodyRange\n       Set rngPaste = .Rows(.Rows.Count).Cells(1).Offset(1, 0)\n    End With\n\n    Set ComboWeekTable = ComboWeekSheet.ListObjects(\"Table1\")\n\n    RollupTimeStamp = RollupWeekSheet.Range(\"B3\").Value\n\n    With ComboWeekTable.DataBodyRange\n        .AutoFilter Field:=16, Criteria1:=\"&gt;\" &amp; RollupTimeStamp\n\n        On Error Resume Next '&lt;&lt; ignore run-time error if no rows visible\n        .SpecialCells(xlCellTypeVisible).Copy rngPaste\n        On Error GoTo 0      '&lt;&lt; stop ignoring errors\n\n        .AutoFilter\n    End With\n\n    ComboWeekTable.Range.AutoFilter Field:=1\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "edited": false, "score": 0, "creation_date": 1559790298, "post_id": 56469828, "comment_id": 99531891, "body": "This eliminated my errors, but it is copying the entire table body range, not just the filtered rows of the table body range."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "edited": false, "score": 0, "creation_date": 1559791928, "post_id": 56469828, "comment_id": 99532159, "body": "@Dave F  it worked for me.  Added Demo to illustrate"}, {"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "edited": false, "score": 0, "creation_date": 1559795303, "post_id": 56469828, "comment_id": 99532719, "body": "@ chrisneilsen   Idk. It works perfectly for me as long as there are filtered rows to be copied; it copies and pastes those rows perfectly, just like in your demo. But when there are no filtered rows showing, it copies and pastes the entire table. I&#39;m very new to VBA and maybe I&#39;m not applying something properly to my exact code. I&#39;ve updated the original post to show my updated code with your suggestions."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1559795898, "last_edit_date": 1559795898, "creation_date": 1559783713, "answer_id": 56469828, "question_id": 56469221, "link": "https://stackoverflow.com/questions/56469221/copy-a-filtered-table/56469828#56469828", "title": "Copy a Filtered Table", "body": "<p>It's a case of getting to the correct properties of the ListObject</p>\n\n<p>Assuming you want just the filtered data rows (and not the header):</p>\n\n<pre><code>With ComboWeekTable\n    .Range.AutoFilter Field:=4, Criteria1:=\"&gt;\" &amp; RollupTimeStamp\n    .DataBodyRange.Copy\nEnd With\n</code></pre>\n\n<p>Unlike <code>SpecialCells</code> this still works if the filter returns no rows (no error, doesn't paste anything), so no need for error trapping</p>\n\n<p>Demo</p>\n\n<pre><code>Sub Demo()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim lo As ListObject\n\n    Set ws1 = ActiveSheet\n    Set ws2 = ws1.Parent.Worksheets(ws1.Index + 1)\n    Set lo = ws1.ListObjects(1)\n\n    If lo.AutoFilter Is Nothing Then lo.Range.AutoFilter\n    lo.ShowAutoFilterDropDown = True\n    With lo\n        .Range.AutoFilter Field:=1, Criteria1:=\"=2\"\n        If Application.Aggregate(3, 5, lo.ListColumns(1).DataBodyRange) &gt; 0 Then 'Count All, ignoring hidden rows\n            .DataBodyRange.Copy\n            ws2.Range(\"D5\").PasteSpecial xlPasteValues\n        End If\n        lo.AutoFilter.ShowAllData ' clear filter\n    End With\nEnd Sub\n</code></pre>\n\n<p>Before running Demo</p>\n\n<p><a href=\"https://i.stack.imgur.com/Tk8zA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tk8zA.png\" alt=\"enter image description here\"></a></p>\n\n<p>After running Demo</p>\n\n<p><a href=\"https://i.stack.imgur.com/a0QuU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a0QuU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1504, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1559838419, "creation_date": 1559776881, "last_edit_date": 1559795062, "question_id": 56469221, "link": "https://stackoverflow.com/questions/56469221/copy-a-filtered-table", "title": "Copy a Filtered Table", "body": "<p>Trying to copy a filtered table and paste the results to the bottom of another table.</p>\n\n<pre><code>With RollupWeekSheet\n   sh1Col = .Range(\"Table1\").Cells(1).Column\n   LastRollupWeekRow = .Cells(.Rows.Count, sh1Col).End(xlUp).Row\nEnd With\n\n\nDim ComboWeekTable As ListObject\nSet ComboWeekTable = ComboWeekSheet.ListObjects(\"Table1\")\n\nDim RollupTimeStamp As Date\nRollupTimeStamp = RollupWeekSheet.Range(\"B3\").Value\n\nWith ComboWeekTable\n.Range.AutoFilter Field:=16, Criteria1:=\"&gt;\" &amp; RollupTimeStamp\n.DataBodyRange.Copy\nEnd With\n\nWith RollupWeekSheet\n.Cells(LastRollupWeekRow + 1, sh1Col).PasteSpecial xlPasteValues\nComboWeekTable.Range.AutoFilter Field:=1\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd With`\n\nWith ComboWeekSheet\nIf .AutoFilterMode Then\n.AutoFilterMode = False\nEnd If\nEnd With\n</code></pre>\n\n<p>It keeps highlighting the \".Autofilter\" located under my \"With ComboWeekTable\" line and saying \"Invalid use of property\", but I don't know why.  Please help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11516040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kI9qSyUV2rs/AAAAAAAAAAI/AAAAAAAAAA0/50t-G1XMxjQ/photo.jpg?sz=128", "display_name": "ABDEL-FATTAH MAGHARI", "link": "https://stackoverflow.com/users/11516040/abdel-fattah-maghari"}, "edited": false, "score": 0, "creation_date": 1559827274, "post_id": 56477947, "comment_id": 99547343, "body": "i attached my file   above  maybe you understand me"}, {"owner": {"reputation": 14, "user_id": 11532069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49f2f67f9e168771192bed1762006c0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel baker", "link": "https://stackoverflow.com/users/11532069/daniel-baker"}, "reply_to_user": {"reputation": 17, "user_id": 11516040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kI9qSyUV2rs/AAAAAAAAAAI/AAAAAAAAAA0/50t-G1XMxjQ/photo.jpg?sz=128", "display_name": "ABDEL-FATTAH MAGHARI", "link": "https://stackoverflow.com/users/11516040/abdel-fattah-maghari"}, "edited": false, "score": 0, "creation_date": 1559828068, "post_id": 56477947, "comment_id": 99547851, "body": "do you want the msgbox to say &quot;please choose 300,200 or 100?&quot;"}, {"owner": {"reputation": 14, "user_id": 11532069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49f2f67f9e168771192bed1762006c0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel baker", "link": "https://stackoverflow.com/users/11532069/daniel-baker"}, "reply_to_user": {"reputation": 17, "user_id": 11516040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kI9qSyUV2rs/AAAAAAAAAAI/AAAAAAAAAA0/50t-G1XMxjQ/photo.jpg?sz=128", "display_name": "ABDEL-FATTAH MAGHARI", "link": "https://stackoverflow.com/users/11516040/abdel-fattah-maghari"}, "edited": false, "score": 0, "creation_date": 1559846920, "post_id": 56477947, "comment_id": 99557146, "body": "I&#39;m still not entirely clear what you need, but are the acceptable answers in a specific place on a specific sheet? e.g. Sheets(&quot;ASheetName&quot;).Range(&quot;A1:A3&quot;)"}, {"owner": {"reputation": 17, "user_id": 11516040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kI9qSyUV2rs/AAAAAAAAAAI/AAAAAAAAAA0/50t-G1XMxjQ/photo.jpg?sz=128", "display_name": "ABDEL-FATTAH MAGHARI", "link": "https://stackoverflow.com/users/11516040/abdel-fattah-maghari"}, "edited": false, "score": 0, "creation_date": 1559848264, "post_id": 56477947, "comment_id": 99557673, "body": "do you see my image above? ok  i have sheet1 contains  column 3 a,b,c  (item,brand, quantity) and userform textbox1,2,3 when i  fill in user form  transfer data to sheet to but when i write the quantity more than what contains in column 3 (c) the balnce then show the message  you excessed  the quantity   for example the balance of  brand in column 3  300q when i fill textbox3 in userform  400q  as you see it more than what contains in sheet in column 3 here i would show the message &quot; you can&#39;t add this quantity available  only300"}, {"owner": {"reputation": 17, "user_id": 11516040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kI9qSyUV2rs/AAAAAAAAAAI/AAAAAAAAAA0/50t-G1XMxjQ/photo.jpg?sz=128", "display_name": "ABDEL-FATTAH MAGHARI", "link": "https://stackoverflow.com/users/11516040/abdel-fattah-maghari"}, "edited": false, "score": 0, "creation_date": 1559914151, "post_id": 56477947, "comment_id": 99579414, "body": "you have wrong in this line                 pick is &quot; &amp; MaxValu"}], "tags": [], "owner": {"reputation": 14, "user_id": 11532069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49f2f67f9e168771192bed1762006c0?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel baker", "link": "https://stackoverflow.com/users/11532069/daniel-baker"}, "is_accepted": false, "score": -1, "last_activity_date": 1559893207, "last_edit_date": 1559893207, "creation_date": 1559825272, "answer_id": 56477947, "question_id": 56468874, "link": "https://stackoverflow.com/questions/56468874/show-message-box-in-userform-under-specific-condition/56477947#56477947", "title": "Show message box in userform under specific condition", "body": "<p>I'm still not entirely sure what you mean, but try something like this</p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\n\n'assuming this is the range where the relevant values are'\nMaxValu = Application.WorksheetFunction.max(Sheets(\"Sheet1\").Range(\"C3:C5\"))\n\n'change the text box value to an integer'\nTxtBoxValu = CInt(Me.TextBox1.Value)\n\nIf TxtBoxValu &gt; MaxValu Then MsgBox \"this value is too high, the maximum you can \npick is \" &amp; MaxValu \n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11516040, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kI9qSyUV2rs/AAAAAAAAAAI/AAAAAAAAAA0/50t-G1XMxjQ/photo.jpg?sz=128", "display_name": "ABDEL-FATTAH MAGHARI", "link": "https://stackoverflow.com/users/11516040/abdel-fattah-maghari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559893207, "creation_date": 1559773845, "last_edit_date": 1559834964, "question_id": 56468874, "link": "https://stackoverflow.com/questions/56468874/show-message-box-in-userform-under-specific-condition", "title": "Show message box in userform under specific condition", "body": "<p><a href=\"https://i.stack.imgur.com/aZd59.jpg\" rel=\"nofollow noreferrer\">enter image description here</a>I have sheet1  contains 3 columns item,brand, quantity  and userform  contains the same element in sheet1  with textbox1, 2, 3 I would code do when I write the data in userform  show me warning message \"you can't add this brand  only 3 or 4...etc available\".</p>\n\n<p>For more explaining showing message depends on textbox3  example \ncolumn 3 in sheet1 contains quantity and when i fill textbox3 more than column 3 then show the message.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11606270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a16752454b076f9058d18b4de6e2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar Iracheta", "link": "https://stackoverflow.com/users/11606270/oscar-iracheta"}, "edited": false, "score": 0, "creation_date": 1559824044, "post_id": 56469696, "comment_id": 99545419, "body": "Thank you very much Tim this works great, just what i was looking for!!!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1559782003, "creation_date": 1559782003, "answer_id": 56469696, "question_id": 56468351, "link": "https://stackoverflow.com/questions/56468351/filter-multiple-pivot-tables-by-cell-value-same-worksheet/56469696#56469696", "title": "Filter Multiple Pivot tables By cell value same worksheet", "body": "<p>Untested:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim pt As PivotTable\n    Dim NewCat As String\n\n    'if this is in the sheet1 code module you can use\n    '  \"Me\" in place of \"Worksheets(\"Sheet1\")\"\n    NewCat = Worksheets(\"Sheet1\").Range(\"H3\").Value\n    Debug.Print \"Filtering on '\" &amp; NewCat &amp; \"'\"\n    'loop over all pivottables on the sheet\n    For Each pt In Worksheets(\"Sheet1\").PivotTables\n        With pt.PivotFields(\"Customer Name\")\n            .ClearAllFilters\n            .PivotFilters.Add Type:=xlCaptionEquals, Value1:=NewCat\n        End With\n    Next pt\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11606270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a16752454b076f9058d18b4de6e2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar Iracheta", "link": "https://stackoverflow.com/users/11606270/oscar-iracheta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559806993, "creation_date": 1559770654, "last_edit_date": 1559806993, "question_id": 56468351, "link": "https://stackoverflow.com/questions/56468351/filter-multiple-pivot-tables-by-cell-value-same-worksheet", "title": "Filter Multiple Pivot tables By cell value same worksheet", "body": "<p>My end goal is to be able to filter multiple pivot tables all in the same worksheet based on a cell value (H3).  Currently i have the code which works perfectly with one pivot table and I'm trying to add the rest. Any recommendations? </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'Set the Variables to be used\n\nDim pt As PivotTable\n\nDim Field As PivotField\n\nDim NewCat As String\n\n  'Here you amend to suit your data\n\nSet pt = Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\")\n\nSet Field = pt.PivotFields(\"Customer Name\")\n\nNewCat = Worksheets(\"Sheet1\").Range(\"H3\").Value\n\n\n\n'This updates and refreshes the PIVOT table\n\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Customer Name\")\n\n    .ClearAllFilters\n\n    .PivotFilters.Add Type:=xlCaptionEquals, \n\nValue1:=ActiveSheet.Range(\"H3\").Value\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559770781, "post_id": 56468350, "comment_id": 99528221, "body": "What line is the error happening at?"}, {"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559770892, "post_id": 56468350, "comment_id": 99528267, "body": ".Range.AutoFilter Field:=16, Criteria:=&quot;&gt;&quot; &amp; RollupTimeStamp"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559770899, "post_id": 56468350, "comment_id": 99528271, "body": "This has nothing to with your problem, but you don&#39;t need <code>DateTime.Now</code> just use <code>Now</code>."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559771361, "post_id": 56468350, "comment_id": 99528438, "body": "My previous comment (now deleted) wasnt useful. This website has a lot of useful tips on table ranges... good luck. <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/6/20/&hellip;</a>"}, {"owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559772926, "post_id": 56468350, "comment_id": 99528913, "body": "I changed Criteria to Criteria1 and fixed my original problem (and edited code above to reflect this).  Now my problem is that I am pasting the filtered table&#39;s header (top) row.  How can I copy and past only the filtered data body range?"}], "owner": {"reputation": 97, "user_id": 11205611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca1746e69cffa9888b8d6ece515fb6f?s=128&d=identicon&r=PG", "display_name": "Dave F", "link": "https://stackoverflow.com/users/11205611/dave-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559773023, "creation_date": 1559770642, "last_edit_date": 1559773023, "question_id": 56468350, "link": "https://stackoverflow.com/questions/56468350/autofilter-table-in-one-sheet-for-values-greater-than-variable-in-another-sheet", "title": "Autofilter table in one sheet for values greater than variable in another sheet", "body": "<p>Basics --- File1 contains Table1 and File2 contains Table2.  My macro, contained in File2, copies rows from Table1 and pastes them to the bottom of Table2. Every time I run the macro, I record a timestamp in File2. </p>\n\n<p>Specifics --- I want to copy from Table1 only those rows which contain a date (located in column 16) later than the timestamp I recorded in File2 the last time I ran the macro.</p>\n\n<p>File1 is ComboFile; Table1 is ComboWeekTable; File2 is Rollup; Table2 is RollupWeekTable</p>\n\n<pre><code>Sub CopyToRollup()\n\nDim RollupWeekSheet As Worksheet\nSet RollupWeekSheet = Workbooks(\"Tasks - Rollup\").Sheets(\"Weekly\")\n\nDim RollupWeekTable As ListObject\nSet RollupWeekTable = RollupWeekSheet.ListObjects(\"Table1\")\n\nDim RollupTimeStamp As String\nRollupTimeStamp = RollupWeekSheet.Range(\"B3\").Value\n\n\n\nDim ComboFile As Workbook\nSet ComboFile = Workbooks.Open(ComboPath, ReadOnly:=True)\n'Opens ComboFile as Read Only~~~~~~~~~~~\n\nDim ComboWeekSheet As Worksheet\nSet ComboWeekSheet = ComboFile.Sheets(\"Weekly\")\n\nDim ComboWeekTable As ListObject\nSet ComboWeekTable = ComboWeekSheet.ListObjects(\"Table1\")\n'Define most variables~~~~~~~~~~~~~~\n\n\n\nDim LastRollupWeekRow As Long\nDim sh1Col As Integer\nWith RollupWeekSheet\nsh1Col = .Range(\"Table1\").Cells(1).Column\nLastRollupWeekRow = .Cells(.Rows.Count, sh1Col).End(xlUp).Row\nEnd With\n'Move to the next empty row in Rollup Table 1.~~~~~~~~~~~~~~~~\n\n\n\nWith ComboWeekTable\n.Range.AutoFilter Field:=16, Criteria1:=\"&gt;\" &amp; RollupTimeStamp\n.AutoFilter.Range.Copy\nEnd With\n\nWith RollupWeekSheet\n.Cells(LastRollupWeekRow + 1, sh1Col).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd With\n'Filter ComboWeekTable column 16 for values greater than RollupTimeStamp, copy from ComboWeekTable only those rows added later than the timestamp, and paste them to the bottom of RollupWeekTable.~~~~~~~~~~~~~~~~\n\n\n\nRollupWeekSheet.Range(\"B3\").Value = DateTime.Now\n\nComboFile.Close savechanges:=False\n'Record a new RollupTimeStamp and close ComboFile.~~~~~~~~~~~~~~~~\n\nEnd Sub\n</code></pre>\n\n<p>It keeps telling me that a \"Named arguement not found\" for my autofilter.  I'm not sure what I'm doing wrong.  Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1559871947, "post_id": 56467554, "comment_id": 99563768, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/194565/discussion-on-question-by-selkie-returning-different-types-from-a-function\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1559771485, "post_id": 56468204, "comment_id": 99528479, "body": "Since this Q is very much about Variant and implicit type conversions, it&#39;s worth noting that both <code>Trim</code> and <code>UCase</code> take and return a <code>Variant</code>, while <code>Trim$</code> and <code>UCase$</code> both take and return a <code>String</code>. I&#39;d have gone with <code>StrComp</code> instead of uppercasing the input, but this code has no reason to blow up or otherwise fail, save for a type mismatch if the input cell actually contains a worksheet <code>Error</code> value, which can&#39;t be coerced into a <code>String</code> - but Excel will handle that, I think. Very elegant, upvoted."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1559778546, "last_edit_date": 1559778546, "creation_date": 1559769827, "answer_id": 56468204, "question_id": 56467554, "link": "https://stackoverflow.com/questions/56467554/returning-different-types-from-a-function/56468204#56468204", "title": "Returning different types from a function", "body": "<p>Unless I'm missing something:</p>\n\n<pre><code>Public Function ConvertToBoolean(InputString As String) As Variant\nDim s As String\nDim ret\n    s = Trim$(UCase$(InputString))\n    Select Case s\n        Case \"TRUE\", \"FALSE\"\n            ret = CBool(s)\n        Case Else\n            ret = InputString\n    End Select\n    ConvertToBoolean = ret\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/lqrer.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lqrer.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1559770346, "post_id": 56468209, "comment_id": 99528060, "body": "This modified version (and the original too) will work <i>if and only if</i> you include <code>Option Compare Text</code>.  I know you said you had that line, but the only way I can reproduce your issue is to omit it (same for both versions of your code)"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1560958759, "post_id": 56468209, "comment_id": 99910345, "body": "@chrisneilsen: Yes, that makes the code work the way it&#39;s supposed to, but has little to nothing to do with the question I was asking"}], "tags": [], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "is_accepted": true, "score": -2, "last_activity_date": 1559770463, "last_edit_date": 1559770463, "creation_date": 1559769851, "answer_id": 56468209, "question_id": 56467554, "link": "https://stackoverflow.com/questions/56467554/returning-different-types-from-a-function/56468209#56468209", "title": "Returning different types from a function", "body": "<p>So many thanks to @MathieuGuindon for explaining to me exactly how variants worked, and pointed me on the right path. </p>\n\n<p>With that, my code is now:</p>\n\n<pre><code>Option Compare Text\nPublic Function ConvertToBoolean(InputString As String) As Variant\nDim IsBoolean As Boolean\nDim ReturnString As String\nDim ReturnBoolean As Boolean\n\n\nIf InputString = \"True\" Then\n    IsBoolean = True\n    ReturnBoolean = True\nElseIf InputString = \"False\" Then\n    IsBoolean = True\n    ReturnBoolean = False\nElse\n    IsBoolean = False\n    ReturnString = InputString\nEnd If\n\nIf IsBoolean Then\n    ConvertToBoolean = ReturnBoolean\nElse\n    ConvertToBoolean = ReturnString\nEnd If\n\n\nEnd Function\n</code></pre>\n\n<p>Of course, as @MathieuGuindon mentioned, if you want to make this code ACTUALLY WORK, (as opposed to being a \"force the type\" exercise), you'll want to add StrComp() (Preferable), or Option Compare Text (Less preferable, apparently buggy)</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 3, "last_activity_date": 1559779991, "last_edit_date": 1559779991, "creation_date": 1559779624, "answer_id": 56469508, "question_id": 56467554, "link": "https://stackoverflow.com/questions/56467554/returning-different-types-from-a-function/56469508#56469508", "title": "Returning different types from a function", "body": "<p>For the sake of future readers:</p>\n\n<p>The root issue was case sensitivity, solved by ensuring compares are by <code>Text</code> and not <code>Binary</code></p>\n\n<p>Here's the evidence</p>\n\n<p><a href=\"https://i.stack.imgur.com/xAcM5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xAcM5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that Boolean values display UPPER CASE, center aligned.  String values in orignal case, left aligned, numbers right aligned.</p>\n\n<p>Here's a version, optimised to handle Errors, numbers, and self contained for Text based tests (this was <em>not</em> the version used in the tests below, as it contains additional features)</p>\n\n<pre><code>Public Function ConvertToBoolean(Val As Variant) As Variant\n    If IsError(Val) Then\n        ConvertToBoolean = Val\n    ElseIf IsEmpty(Val) Then\n        ConvertToBoolean = vbNullString\n    ElseIf StrComp(Trim$(Val), \"True\", vbTextCompare) = 0 Then\n        ConvertToBoolean = True\n    ElseIf StrComp(Trim$(Val), \"False\", vbTextCompare) = 0 Then\n        ConvertToBoolean = False\n    Else\n        ConvertToBoolean = Val\n    End If\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><Sub>Tests were based on this code</Sub></p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nPublic Function ConvertToBoolean1a(InputString As String) As Variant\n    Dim TempResults As Variant\n\n    If InputString = \"True\" Then\n        TempResults = True\n    ElseIf InputString = \"False\" Then\n        TempResults = False\n    Else\n        TempResults = InputString\n    End If\n\n    ConvertToBoolean1a = TempResults\nEnd Function\n\nPublic Function ConvertToBoolean2a(InputString As String) As Variant\n    Dim IsBoolean As Boolean\n    Dim ReturnString As String\n    Dim ReturnBoolean As Boolean\n\n    If InputString = \"True\" Then\n        IsBoolean = True\n        ReturnBoolean = True\n    ElseIf InputString = \"False\" Then\n        IsBoolean = True\n        ReturnBoolean = False\n    Else\n        IsBoolean = False\n        ReturnString = InputString\n    End If\n\n    If IsBoolean Then\n        ConvertToBoolean2a = ReturnBoolean\n    Else\n        ConvertToBoolean2a = ReturnString\n    End If\nEnd Function\n</code></pre>\n\n<p><Sub>And in a separate module (I've modified Davids version slightly to give a fair comparison.  His original version handles leading/trailing spaces, but thats an additional feature and costs time)</Sub></p>\n\n<pre><code>Option Explicit\n\nPublic Function ConvertToBoolean1b(InputString As String) As Variant\n    Dim TempResults As Variant\n\n    If InputString = \"True\" Then\n        TempResults = True\n    ElseIf InputString = \"False\" Then\n        TempResults = False\n    Else\n        TempResults = InputString\n    End If\n\n    ConvertToBoolean1b = TempResults\nEnd Function\n\nPublic Function ConvertToBoolean2b(InputString As String) As Variant\n    Dim IsBoolean As Boolean\n    Dim ReturnString As String\n    Dim ReturnBoolean As Boolean\n\n    If InputString = \"True\" Then\n        IsBoolean = True\n        ReturnBoolean = True\n    ElseIf InputString = \"False\" Then\n        IsBoolean = True\n        ReturnBoolean = False\n    Else\n        IsBoolean = False\n        ReturnString = InputString\n    End If\n\n    If IsBoolean Then\n        ConvertToBoolean2b = ReturnBoolean\n    Else\n        ConvertToBoolean2b = ReturnString\n    End If\nEnd Function\n\nPublic Function ConvertToBoolean3(Val As String) As Variant\n    If StrComp(Val, \"True\", vbTextCompare) = 0 Then\n        ConvertToBoolean3 = True\n    ElseIf StrComp(Val, \"False\", vbTextCompare) = 0 Then\n        ConvertToBoolean3 = False\n    Else\n        ConvertToBoolean3 = Val\n    End If\nEnd Function\n\n\nPublic Function ConvertToBoolean4(Val As Variant) As Variant\n    Dim s As String\n    s = UCase$(Val)\n    Select Case s\n        Case \"TRUE\", \"FALSE\"\n            ConvertToBoolean4 = CBool(s)\n        Case Else\n            ConvertToBoolean4 = Val\n    End Select\nEnd Function\n</code></pre>\n\n<p><Sub>I've also run a speed test to compare performance, using this code</Sub></p>\n\n<pre><code>Sub Test()\n    Dim n As Long, i As Long, j As Long\n    Dim T1 As Single, T2 As Single, T3 As Single, T4 As Single\n    Dim res As Variant\n\n    Dim Dat2(1 To 5) As String\n    Dat2(1) = \"true\"\n    Dat2(2) = \"false\"\n    Dat2(3) = \"   true\"\n    Dat2(4) = \"zx\"\n    Dat2(5) = \"\"\n    Dim cl As Range\n\n    Application.Calculation = xlCalculationManual\n\n    n = 1000000\n\n    T1 = Timer()\n    For i = 1 To n\n        For j = 1 To 5\n            res = ConvertToBoolean1a(Dat2(j))\n        Next\n    Next\n    T2 = Timer()\n\n    T3 = Timer()\n    For i = 1 To n\n        For j = 1 To 5\n            res = ConvertToBoolean2a(Dat2(j))\n        Next\n    Next\n    T4 = Timer()\n\n    'Verion 1a OP 1\n    [F22] = (T2 - T1) / n * 1000000#\n    'Verion 2a OP 2\n    [H22] = (T4 - T3) / n * 1000000#\n\n\n    n = n / 100\n\n    Set cl = [f10:f15]\n    T1 = Timer()\n    For i = 1 To n\n        cl.Calculate\n    Next\n    T2 = Timer()\n\n    Set cl = [h10:h15]\n    T3 = Timer()\n    For i = 1 To n\n        cl.Calculate\n    Next\n    T4 = Timer()\n\n    'Verion 1a OP 1 UDF\n    [F23] = (T2 - T1) / n * 1000000#\n    'Verion 2a OP 1 UDF\n    [H23] = (T4 - T3) / n * 1000000#\n\nEnd Sub\n</code></pre>\n\n<p><Sub>And</Sub></p>\n\n<pre><code>Sub Test2()\n    Dim n As Long, i As Long, j As Long\n    Dim T1 As Single, T2 As Single, T3 As Single, T4 As Single\n    Dim res As Variant\n\n    Dim Dat2(1 To 5) As String\n    Dat2(1) = \"true\"\n    Dat2(2) = \"false\"\n    Dat2(3) = \"   true\"\n    Dat2(4) = \"zx\"\n    Dat2(5) = \"\"\n    Dim cl As Range\n\n    Application.Calculation = xlCalculationManual\n\n    n = 1000000\n    T1 = Timer()\n    For i = 1 To n\n        For j = 1 To 5\n            res = ConvertToBoolean3(Dat2(j))\n        Next\n    Next\n    T2 = Timer()\n\n    T3 = Timer()\n    For i = 1 To n\n        For j = 1 To 5\n            res = ConvertToBoolean4(Dat2(j))\n        Next\n    Next\n    T4 = Timer()\n\n    'Verion 3 mine\n    [J22] = (T2 - T1) / n * 1000000#\n    'Verion 4 david\n    [K22] = (T4 - T3) / n * 1000000#\n\n\n    n = n / 100\n    Set cl = [j10:j15]\n    T1 = Timer()\n    For i = 1 To n\n        cl.Calculate\n    Next\n    T2 = Timer()\n\n    Set cl = [K10:K15]\n    T3 = Timer()\n    For i = 1 To n\n        cl.Calculate\n    Next\n    T4 = Timer()\n\n    'Verion 3 mine  UDF\n    [J23] = (T2 - T1) / n * 1000000#\n    'Verion 4 david UDF\n    [K23] = (T4 - T3) / n * 1000000#\n\n\nEnd Sub\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 56468209, "answer_count": 3, "score": 0, "last_activity_date": 1559779991, "creation_date": 1559766541, "last_edit_date": 1559768987, "question_id": 56467554, "link": "https://stackoverflow.com/questions/56467554/returning-different-types-from-a-function", "title": "Returning different types from a function", "body": "<p>So I have a function I wrote that checks if the string given to it is true, false, or something else. If it's True, I want it to return the boolean true, if it's false, I want to return the boolean false, and if it's anything else, I want it to keep returning the string.</p>\n\n<pre><code>Public Function ConvertToBoolean(InputString As String) As Variant\nDim TempResults As Variant\n\n\n    If InputString = \"True\" Then\n        TempResults = True\n    ElseIf InputString = \"False\" Then\n        TempResults = False\n    Else\n        TempResults = InputString\n    End If\n\n    ConvertToBoolean = TempResults\n\n\nEnd Function\n</code></pre>\n\n<p>However, it keeps defaulting to strings. I could dim it as boolean, but then regular strings get returned as TRUE, instead of as a string.</p>\n\n<p>How can I force/make the function type conversion work? Probably need it inside of the if statement, but I have no idea how to do that.</p>\n\n<p>Can't dim inside of the if (Although perhaps I could re-dim? Going to check)</p>\n\n<p>Edit: Further testing is showing that most of the time, a boolean is returned - but once in awhile it's returning a string instead, with all of the associated problems that I was trying to fix in the first place. So my question remains the same:</p>\n\n<p><strong>How can I explicitly declare a function (Or a variable) to return one given type or another?</strong></p>\n\n<p>Edit 2: Since people don't seem to believe that code doesn't always work perfect or the same every time:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yf8tA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yf8tA.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/wrUuH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wrUuH.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/I2Tn7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I2Tn7.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/mLaoj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mLaoj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 2, "creation_date": 1559766368, "post_id": 56467373, "comment_id": 99526515, "body": "Munging a bunch of strings together and executing it is a recipe for disaster. Sounds to me like some reworking of some of the architecture would be time well spent."}, {"owner": {"reputation": 171, "user_id": 9254726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070bdb0341821aed239bfa229c8f43a?s=128&d=identicon&r=PG&f=1", "display_name": "5E4ME", "link": "https://stackoverflow.com/users/9254726/5e4me"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1559769521, "post_id": 56467373, "comment_id": 99527763, "body": "@SeanLange Unfortunately I think you&#39;re right"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 9254726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070bdb0341821aed239bfa229c8f43a?s=128&d=identicon&r=PG&f=1", "display_name": "5E4ME", "link": "https://stackoverflow.com/users/9254726/5e4me"}, "edited": false, "score": 0, "creation_date": 1559769479, "post_id": 56467476, "comment_id": 99527745, "body": "I appreciate the answer. I guess I&#39;ll have to file this under &quot;just because I <i>could</i> doesn&#39;t mean I <i>should</i>.&quot;"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 5, "last_activity_date": 1559766140, "creation_date": 1559766140, "answer_id": 56467476, "question_id": 56467373, "link": "https://stackoverflow.com/questions/56467373/ms-access-store-vba-logic-on-sql-server/56467476#56467476", "title": "MS Access - Store VBA Logic on SQL Server", "body": "<p>Yes, but I highly recommend you don't.</p>\n\n<p>You can evaluate simple, single expressions using the <code>Eval</code> function in VBA.</p>\n\n<p>You can import and modify modules through <code>Application.VBE.ActiveVBProject.VBComponents</code>. Here, you can modify the string contents of a module, but this requires exclusive access and recompiling the database while the code is running (thus I highly recommend you don't do this).</p>\n\n<p>Generally, if you don't need to work with the Access application object, I recommend dynamically creating vbscript files instead, to avoid needing exclusive access and needing to recompile your database.</p>\n"}], "owner": {"reputation": 171, "user_id": 9254726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070bdb0341821aed239bfa229c8f43a?s=128&d=identicon&r=PG&f=1", "display_name": "5E4ME", "link": "https://stackoverflow.com/users/9254726/5e4me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 56467476, "answer_count": 1, "score": 1, "last_activity_date": 1594716123, "creation_date": 1559765680, "last_edit_date": 1594716123, "question_id": 56467373, "link": "https://stackoverflow.com/questions/56467373/ms-access-store-vba-logic-on-sql-server", "title": "MS Access - Store VBA Logic on SQL Server", "body": "<p>This might be a bit of a stretch. I have an MS Access front-end that sits on our SQL Server back-end and uses a mix of VBA and SQL stored procedures to process data. </p>\n\n<p>Several of my VBA procedures dynamically craft a SQL query by stitching together strings and then sending them over to the server to be executed. My question is whether this process can work in the reverse? For example, I set up a method in VBA that pulls a string from a table in the server and then executes it.  </p>\n\n<p>To clarify, I know how to use stored procedures to handle logic in the back-end. My goal here is to find a way to pull raw VBA out of a SQL table/store procedure and then run it in Access.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 3, "creation_date": 1559769807, "post_id": 56467364, "comment_id": 99527867, "body": "Your question is so complex I&#39;m not even sure if I understand it. A general word of advise: break your code up into pieces. For example, if a condition in your first loop matches, take the values of the row and store them in a range object. Then pass that range object to a separate function, perform your second loop, edit the range object (or not), then insert the Range object in the new sheet."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559774346, "post_id": 56467364, "comment_id": 99529266, "body": "First error I see is in getting the last row for your sheets, <code>Rows.Count</code> evaluates to <code>ActiveSheet.Rows.Count</code>, for example: <code>Sheets(&quot;TitleHelper&quot;).Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row</code>, which I bet is not what you want."}, {"owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559827599, "post_id": 56467364, "comment_id": 99547532, "body": "@FAB that doesnt seem to cause any issues. If i remove the &quot;for p =&quot; loop everything works as intended. Its just the P loop inside of the first if statement thats giving me problems"}, {"owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "edited": false, "score": 0, "creation_date": 1559828206, "post_id": 56467364, "comment_id": 99547944, "body": "@Amo van Boven so store &quot;oldSHEET.Rows(i).Copy newSHEET.Rows(MHTROWmax)&quot; as a range object and pass it on to a different sub/function that replaces the first cell with newPART. Then store that as a range object and pass it on to a different sub/function that adds the 19th + n values? that sounds like it would work. thank you for the advice i&#39;ll try that."}, {"owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559829964, "post_id": 56467364, "comment_id": 99549075, "body": "@FAB I see what you mean, but wouldn&#39;t the activesheet be newSHEET since <code>Set newSHEET = ThisWorkbook.Sheets.Add(After:= _              ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))</code> would activate the sheet?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559830016, "post_id": 56467364, "comment_id": 99549106, "body": "@BuhBlake my bad, I had in my mind that should always use <code>sheet.Rows.Count</code>, but just realised that it doesn&#39;t matter given that in any sheet the <code>Rows.Count</code> will be the same lol."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559831385, "post_id": 56467364, "comment_id": 99549940, "body": "@BuhBlake any chance you can include a screenshot to show how you want your output to look? Few rows should do, especially around your 19th + n.  By the way, add <code>Application.ScreenUpdating = False</code> at the begininng, and <code>Application.ScreenUpdating = True</code> at the end to speed up."}, {"owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559834130, "post_id": 56467364, "comment_id": 99551455, "body": "@FAB added a screenshot and changed the workbook link to include a version of expected results"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "is_accepted": true, "score": 0, "last_activity_date": 1560171818, "creation_date": 1560171818, "answer_id": 56526980, "question_id": 56467364, "link": "https://stackoverflow.com/questions/56467364/a-loop-inside-of-an-if-statement-inside-of-two-loops/56526980#56526980", "title": "A Loop Inside Of An If Statement Inside Of Two Loops", "body": "<p>Okay so i figured it out by actually taking the last loop (p loop) and looping it again with the i loop. So its actually 2 double loops instead of 1 triple loop. Theres definitely a better way to do this, but i'm glad i figured out any fix at all.</p>\n\n<p><strong>So basically the first two loops:</strong><p>\n- loops through oldSHEET<p>\n- Adds a copied row to newSHEET from oldSHEET<p>\n- Loops through TitleHelper<p>\n- If statement is true then adds a copied row to newSHEET from oldSHEET<p>\n- Change the first cell of the new row to newPART<p>\n<p>\nThen i change the values of oldSHEET and newSHEET to \"Result\" and a new sheet \"Result2\"\n<p>\n<strong>The second two loops:</strong><p>\n- loops through oldSHEET<p>\n- Adds a copied row to newSHEET from oldSHEET<p>\n- Loops through TitleHelper<p>\n- If statement is true then replace the 19th + n column on the new row<p></p>\n\n<pre><code>Sub ParentPartOne()\n    Dim childROWmax    As Long\n    Dim parentROWmax   As Long\n    Dim i              As Long\n    Dim j              As Long\n    Dim z              As Long\n    Dim p              As Long\n    Dim parentPATTERN  As Range\n    Dim parentPATTERN2 As Range\n    Dim parentWEIGHT   As Range\n    Dim childPATTERN   As Range\n    Dim oMAX           As Range\n    Dim oMIN           As Range\n    Dim childCODE      As Range\n    Dim parentPART     As Range\n    Dim newPART        As String\n    Dim newSHEET       As Worksheet\n    Dim oldSHEET       As Worksheet\n\n    Set oldSHEET = ActiveSheet\n    parentROWmax = oldSHEET.Cells(Rows.Count, 1).End(xlUp).Row\n    Set newSHEET = ThisWorkbook.Sheets.Add(After:= _\n                                           ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    newSHEET.Name = \"Result\"\n    childROWmax = Sheets(\"TitleHelper\").Cells(Rows.Count, 1).End(xlUp).Row\n    MHTROWmax = newSHEET.Cells(Rows.Count, 1).End(xlUp).Row\n\n\n    For i = 2 To parentROWmax\n        z = 1\n        n = 0\n\n       'Increment Result sheet row\n        MHTROWmax = MHTROWmax + 1\n\n       'get MHT row info for comparison\n        Set parentPATTERN = oldSHEET.Range(\"J\" &amp; i)\n        Set parentPATTERN2 = oldSHEET.Range(\"K\" &amp; i)\n        Set parentWEIGHT = oldSHEET.Range(\"H\" &amp; i)\n        Set parentPART = oldSHEET.Range(\"A\" &amp; i)\n\n       'Write a row to MHT Result Table\n        oldSHEET.Rows(i).Copy newSHEET.Rows(MHTROWmax)\n\n        For j = 2 To childROWmax\n\n           'get TitleHelper row info for comparison\n            Set childPATTERN = Worksheets(\"TitleHelper\").Range(\"A\" &amp; j)\n            Set oMAX = Worksheets(\"TitleHelper\").Range(\"C\" &amp; j)\n            Set oMIN = Worksheets(\"TitleHelper\").Range(\"B\" &amp; j)\n            Set childCODE = Worksheets(\"TitleHelper\").Range(\"F\" &amp; j)\n            newPART = parentPART &amp; \"*\" &amp; childCODE\n\n           'Perform if/then\n            If (parentPATTERN = childPATTERN _\n            Or parentPATTERN2 = childPATTERN) _\n            And parentWEIGHT &lt;= oMAX _\n            And parentWEIGHT &gt;= oMIN _\n            And z &lt; 5 Then\n                z = z + 1\n\n               'Increment Result sheet row\n                MHTROWmax = MHTROWmax + 1\n\n               'Criteria is met, write a row to MHT Result Table\n                oldSHEET.Rows(i).Copy newSHEET.Rows(MHTROWmax)\n                newSHEET.Cells(MHTROWmax, 1) = newPART\n            End If\n        Next j\n    Next i\n\n    Set oldSHEET = Sheets(\"Result\")\n    parentROWmax = oldSHEET.Cells(Rows.Count, 1).End(xlUp).Row\n    Set newSHEET = ThisWorkbook.Sheets.Add(After:= _\n                                           ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    newSHEET.Name = \"Result2\"\n    childROWmax = Sheets(\"TitleHelper\").Cells(Rows.Count, 1).End(xlUp).Row\n    MHTROWmax = newSHEET.Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To parentROWmax\n        z = 1\n        n = 0\n\n       'Increment Result sheet row\n        MHTROWmax = MHTROWmax + 1\n\n       'get MHT row info for comparison\n        Set parentPATTERN = oldSHEET.Range(\"J\" &amp; i)\n        Set parentPATTERN2 = oldSHEET.Range(\"K\" &amp; i)\n        Set parentWEIGHT = oldSHEET.Range(\"H\" &amp; i)\n        Set parentPART = oldSHEET.Range(\"A\" &amp; i)\n\n       'Write a row to MHT Result Table\n        oldSHEET.Rows(i).Copy newSHEET.Rows(MHTROWmax)\n\n        For p = 2 To childROWmax\n\n        If (parentPATTERN = Worksheets(\"TitleHelper\").Range(\"A\" &amp; p) _\n        Or parentPATTERN2 = Worksheets(\"TitleHelper\").Range(\"A\" &amp; p)) _\n        And parentWEIGHT &lt;= Worksheets(\"TitleHelper\").Range(\"C\" &amp; p) _\n        And parentWEIGHT &gt;= Worksheets(\"TitleHelper\").Range(\"B\" &amp; p) _\n        And n &lt; 4 Then\n            n = n + 1\n\n                newSHEET.Cells(MHTROWmax, 19 + n) = Worksheets(\"TitleHelper\").Range(\"E\" &amp; p).Value\n            End If\n        Next p\n    next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11447345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37f666ebfe3fbc37885ff17bdf2adade?s=128&d=identicon&r=PG&f=1", "display_name": "BuhBlake", "link": "https://stackoverflow.com/users/11447345/buhblake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56526980, "answer_count": 1, "score": 0, "last_activity_date": 1560171818, "creation_date": 1559765634, "last_edit_date": 1559834086, "question_id": 56467364, "link": "https://stackoverflow.com/questions/56467364/a-loop-inside-of-an-if-statement-inside-of-two-loops", "title": "A Loop Inside Of An If Statement Inside Of Two Loops", "body": "<pre><code>Sub aaa()\nDim childROWmax    As Long\nDim parentROWmax   As Long\nDim i              As Long\nDim j              As Long\nDim z              As Long\nDim p              As Long\nDim n              As Long\nDim parentPATTERN  As Range\nDim parentPATTERN2 As Range\nDim parentWEIGHT   As Range\nDim childPATTERN   As Range\nDim oMAX           As Range\nDim oMIN           As Range\nDim childCODE      As Range\nDim parentPART     As Range\nDim newPART        As String\nDim newSHEET       As Worksheet\nDim oldSHEET       As Worksheet\n\nSet oldSHEET = ActiveSheet\nparentROWmax = oldSHEET.Cells(Rows.Count, 1).End(xlUp).Row\nSet newSHEET = ThisWorkbook.Sheets.Add(After:= _\n             ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n    newSHEET.Name = \"Result\"\nchildROWmax = Sheets(\"TitleHelper\").Cells(Rows.Count, 1).End(xlUp).Row\nMHTROWmax = newSHEET.Cells(Rows.Count, 1).End(xlUp).Row\n\n\n    For i = 2 To parentROWmax\n        z = 1\n        n = 0\n\n        'Increment Result sheet row\n        MHTROWmax = MHTROWmax + 1\n\n        'get MHT row info for comparison\n           Set parentPATTERN = oldSHEET.Range(\"J\" &amp; i)\n           Set parentPATTERN2 = oldSHEET.Range(\"K\" &amp; i)\n           Set parentWEIGHT = oldSHEET.Range(\"H\" &amp; i)\n           Set parentPART = oldSHEET.Range(\"A\" &amp; i)\n\n        'Write a row to MHT Result Table\n        oldSHEET.Rows(i).Copy newSHEET.Rows(MHTROWmax)\n\n        For j = 2 To childROWmax\n\n            'get TitleHelper row info for comparison\n            Set childPATTERN = Worksheets(\"TitleHelper\").Range(\"A\" &amp; j)\n            Set oMAX = Worksheets(\"TitleHelper\").Range(\"C\" &amp; j)\n            Set oMIN = Worksheets(\"TitleHelper\").Range(\"B\" &amp; j)\n            Set childCODE = Worksheets(\"TitleHelper\").Range(\"F\" &amp; j)\n            newPART = parentPART &amp; \"*\" &amp; childCODE\n\n            'Perform if/then\n            If (parentPATTERN = childPATTERN _\n                Or parentPATTERN2 = childPATTERN) _\n               And parentWEIGHT &lt;= oMAX _\n               And parentWEIGHT &gt;= oMIN _\n               And z &lt; 5 Then\n                   z = z + 1\n\n                'Increment Result sheet row\n                MHTROWmax = MHTROWmax + 1\n\n                'Criteria is met, write a row to MHT Result Table\n                oldSHEET.Rows(i).Copy newSHEET.Rows(MHTROWmax)\n                newSHEET.Cells(MHTROWmax, 1) = newPART\n                    For p = 2 To childROWmax\n\n                         If (parentPATTERN = Worksheets(\"TitleHelper\").Range(\"A\" &amp; p) _\n                          Or parentPATTERN2 = Worksheets(\"TitleHelper\").Range(\"A\" &amp; p)) _\n                          And parentWEIGHT &lt;= Worksheets(\"TitleHelper\").Range(\"C\" &amp; p) _\n                          And parentWEIGHT &gt;= Worksheets(\"TitleHelper\").Range(\"B\" &amp; p) _\n                         And n &lt; 4 Then\n                             n = n + 1\n\n                          newSHEET.Cells(MHTROWmax, 19 + n) = Worksheets(\"TitleHelper\").Range(\"E\" &amp; p).Value\n                         End If\n                    Next p\n                End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>So i have this VBA code where it loops through a sheet (oldSHEET)\nfor each row in oldSHEET it will add a row to newSHEET\nthen it will copy the row over to the new row\nthen it will loop through a different sheet (TitleHelper)\nfor each row in TitleHelper it will go through an IF statement\nIf the statement is true it will add a row to newSHEET\nthen it will copy the row over to the new row\nthen it will replace the first cell in the new row with newPART\nthen it will loop through TitleHelper again\nfor each row in TitleHelper it will go through an IF statement\nIf the statement is true it will replace the 19th + n column on the new row</p>\n\n<p>that should be the end of the code, but if i put the end of the first IF statement above the P Loop it will only do the 19th + n replacement on the first iteration of the J Loop because of \"MHTROWmax = MHTROWmax + 1\"</p>\n\n<p>If the first IF statement ends before \"Next P\" with the second IF statement it gives me an error code.</p>\n\n<p>If the If statements remain how they are it will write the 19th + n replacement on the first iteration of the J loop and then do some weird stuff for the other iterations.</p>\n\n<p>I've included a copy of my worksheet\njust use the macro when \"MHT\" is active\n(EDIT: added the result page as it should appear. note: you would have to change the name of \"result\" to run the macro)\n<a href=\"https://drive.google.com/file/d/1ZbmcIr_bRp_f6cngMeZevj7zujcdW1RC/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1ZbmcIr_bRp_f6cngMeZevj7zujcdW1RC/view?usp=sharing</a></p>\n\n<p>Here is an image of the expected result as well\n<a href=\"https://i.stack.imgur.com/o9BaM.png\" rel=\"nofollow noreferrer\">Expected Results</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559769359, "post_id": 56466985, "comment_id": 99527697, "body": "What line does the error occur on? And what error is it exactly? Error 440 \u201cArray Index out of Bounds\u201d?"}, {"owner": {"reputation": 25, "user_id": 11595382, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-COaLU04GKIo/AAAAAAAAAAI/AAAAAAAAABA/zYLsjHqdE4o/photo.jpg?sz=128", "display_name": "Michael R. Nickerson", "link": "https://stackoverflow.com/users/11595382/michael-r-nickerson"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559823113, "post_id": 56466985, "comment_id": 99544900, "body": "It occurs on the first filter, so    ActiveSheet.ListObjects(&quot;Stories&quot;).Range.AutoFilter Field:=27, Operator:= _         xlFilterValues, Criteria2:=Array(0, &quot;6/3/2019&quot;)"}, {"owner": {"reputation": 25, "user_id": 11595382, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-COaLU04GKIo/AAAAAAAAAAI/AAAAAAAAABA/zYLsjHqdE4o/photo.jpg?sz=128", "display_name": "Michael R. Nickerson", "link": "https://stackoverflow.com/users/11595382/michael-r-nickerson"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559830972, "post_id": 56466985, "comment_id": 99549733, "body": "Run-time error &#39;9&#39;: Subscript out of range"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11595382, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-COaLU04GKIo/AAAAAAAAAAI/AAAAAAAAABA/zYLsjHqdE4o/photo.jpg?sz=128", "display_name": "Michael R. Nickerson", "link": "https://stackoverflow.com/users/11595382/michael-r-nickerson"}, "edited": false, "score": 0, "creation_date": 1559823151, "post_id": 56467638, "comment_id": 99544928, "body": "I tried it out, but that didn&#39;t seem to be the problem. thank you anyways."}], "tags": [], "owner": {"reputation": 142, "user_id": 6570713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SrIS2.jpg?s=128&g=1", "display_name": "Alvaro CC", "link": "https://stackoverflow.com/users/6570713/alvaro-cc"}, "is_accepted": false, "score": 1, "last_activity_date": 1559766911, "creation_date": 1559766911, "answer_id": 56467638, "question_id": 56466985, "link": "https://stackoverflow.com/questions/56466985/getting-an-out-of-bounds-error-on-my-macro/56467638#56467638", "title": "Getting an out of bounds error on my macro", "body": "<p>Could you try insering this line between each filtering?</p>\n\n<p></p>\n\n<p>Activesheet.AutoFilterMode = False</p>\n\n<p>just like this:</p>\n\n<pre><code>Activesheet.AutoFilterMode = False\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=27, Operator:= _\n    xlFilterValues, Criteria2:=Array(0, \"6/3/2019\")\n\n\nAcivesheet.AutoFilterMode = False\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=10, Criteria1 _\n    :=\"Released to Customers\"\n.......\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11595382, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-COaLU04GKIo/AAAAAAAAAAI/AAAAAAAAABA/zYLsjHqdE4o/photo.jpg?sz=128", "display_name": "Michael R. Nickerson", "link": "https://stackoverflow.com/users/11595382/michael-r-nickerson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559766911, "creation_date": 1559763717, "last_edit_date": 1559765076, "question_id": 56466985, "link": "https://stackoverflow.com/questions/56466985/getting-an-out-of-bounds-error-on-my-macro", "title": "Getting an out of bounds error on my macro", "body": "<p>I was making a VBA script which pulls an excel sheet from a page, copies it into my current page, then applies a recorded macro which changes the table filters. The issue occurs in the filters, where I am getting an out of range error every other time I run the script.</p>\n\n<p>My guess is that it occurs since the item is already set under a certain filter, that if I rerun the macro, it doesn't know how to deal with that situation.</p>\n\n<p>I was curious if anyone could find a fix to this.</p>\n\n<pre><code>Sub FilterCES()\n\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=27, Operator:= _\n    xlFilterValues, Criteria2:=Array(0, \"6/3/2019\")\n\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=10, Criteria1 _\n    :=\"Released to Customers\"\n'Filer by Type:\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=13, Criteria1 _\n    :=Array(\"full_trial\", \"renewal\", \"sale\", \"trial_to_sale\"), Operator:= _\n    xlFilterValues\n\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=15, Criteria1 _\n    :=Array(\"academic\", \"public_library\", \"schools\"), \n    Operator:=xlFilterValues\n\nActiveSheet.ListObjects(\"Stories\").Range.AutoFilter Field:=16, Criteria1 _\n    :=Array(\"Australia\", \"Canada\", \"Finland\", \"Germany\", \"Italy\", \n\"Netherlands\", _\n    \"New Zealand\", \"United Kingdom (GB)\", \"United States\", \"Nordics\", \n\"Norway\", \"Sweden\", \"Finland\", \"Denmark\"), Operator:= _\n    xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>I expected the macro to just change the settings to whatever I had selected since it uses auto filtering, but that isn't the case and I get an out of range error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1559783768, "post_id": 56466937, "comment_id": 99530833, "body": "Well you specify <code>xlXYScatterLinesNoMarkers</code> (LINES) and expect to see no lines?  Try <code>xlXYScatter</code> instead.  Also <code>.Format.Line.Visible = msoTrue</code> - why if you don&#39;t want the lines?  Remove the entire <code>With cht.SeriesCollection(seriesIndex)</code> block and it works fine"}, {"owner": {"reputation": 38, "user_id": 4597063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hW27n.jpg?s=128&g=1", "display_name": "ECO", "link": "https://stackoverflow.com/users/4597063/eco"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1559807431, "post_id": 56466937, "comment_id": 99536750, "body": "Sorry, my question was not clear. I edited the text to clarify it. My point is that I want to plot [column 2 values] vs [column 1 values], while I get a plot with only [column 2 values] on y-axis, and values from 1 to Nsamples on x-axis."}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 4597063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hW27n.jpg?s=128&g=1", "display_name": "ECO", "link": "https://stackoverflow.com/users/4597063/eco"}, "is_accepted": false, "score": 0, "last_activity_date": 1559816091, "creation_date": 1559816091, "answer_id": 56475477, "question_id": 56466937, "link": "https://stackoverflow.com/questions/56466937/why-my-vba-code-creates-line-plot-instead-of-scatter-plot/56475477#56475477", "title": "Why my VBA code creates line plot instead of scatter plot?", "body": "<p>After some more investigation, I fund the answer. I leave it here for anyone who might be interested. </p>\n\n<p>The problem was due to the fact that the data range that I provided included empty cells (or, to be more precise, cells with functions returning blanks). \nResizing XValues and Values to include only cells with data solved the problem. </p>\n"}], "owner": {"reputation": 38, "user_id": 4597063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hW27n.jpg?s=128&g=1", "display_name": "ECO", "link": "https://stackoverflow.com/users/4597063/eco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559816091, "creation_date": 1559763467, "last_edit_date": 1559807253, "question_id": 56466937, "link": "https://stackoverflow.com/questions/56466937/why-my-vba-code-creates-line-plot-instead-of-scatter-plot", "title": "Why my VBA code creates line plot instead of scatter plot?", "body": "<p>I'm trying to generate scatter plot from 2 data-columns, but instead I get a line plot where data of the first column is ignored (i.e.: if I have 1000 points, on x-axis I see values from 1 to 1000, regardless of the data stored in 1st column). I can't find the error in my code. What's wrong?</p>\n\n<pre><code>Public Sub Graph_Refresh()\n\n    Dim cht As Chart\n    Dim i As Integer\n    Dim seriesIndex As Integer\n    Set cht = Sheets(\"Graph\").ChartObjects(\"Chart 1\").Chart\n    seriesIndex = 0\n\n    ' ***** CLEAR OLD CONTENT *****\n    cht.ChartArea.ClearContents\n\n    ' ***** NON CHANGEABLE PARAMETERS *****\n    'Format Font Type and Size\n    cht.ChartType = xlXYScatterLinesNoMarkers                                   ' scatter plot\n    cht.ChartArea.Format.TextFrame2.TextRange.Font.Name = \"Arial\"\n    cht.ChartArea.Format.TextFrame2.TextRange.Font.Size = 12\n    cht.HasTitle = False      ' No chart title\n    'cht.SetElement (msoElementPrimaryValueGridLinesMajor)   'Gridlines\n\n    'Adjust x-axis\n    cht.HasAxis(xlCategory, xlPrimary) = True\n    cht.Axes(xlCategory, xlPrimary).HasTitle = True\n    cht.Axes(xlCategory).AxisTitle.Text = \"Frequency [MHz]\"\n    cht.Axes(xlCategory).MinimumScale = Sheets(\"Graph\").Range(\"AI7\").Value\n    cht.Axes(xlCategory).MaximumScale = Sheets(\"Graph\").Range(\"AI8\").Value\n\n    'Adjust y-axis\n    cht.HasAxis(xlValue, xlPrimary) = True\n    cht.Axes(xlValue, xlPrimary).HasTitle = True\n    cht.Axes(xlValue).AxisTitle.Text = \"S-Parameters [dB]\"\n    cht.Axes(xlValue).MinimumScale = Sheets(\"Graph\").Range(\"AI9\").Value\n    cht.Axes(xlValue).MaximumScale = Sheets(\"Graph\").Range(\"AI10\").Value\n    cht.Axes(xlValue).CrossesAt = -100\n\n    ' Data Series\n    For i = 1 To 5\n                    seriesIndex = seriesIndex + 1\n                    cht.SeriesCollection.NewSeries\n                    With Sheets(\"Graph\")\n                        cht.SeriesCollection(seriesIndex).Name = .Cells(6 + (i - 1) * 4).Value &amp; \" S11\"\n                    End With\n                    cht.SeriesCollection(seriesIndex).XValues = \"='\" &amp; Sheets(\"Data\" &amp; CStr(i)).Name &amp; \"'!$K$4:$K$10004\"\n                    cht.SeriesCollection(seriesIndex).Values = \"='\" &amp; Sheets(\"Data\" &amp; CStr(i)).Name &amp; \"'!$L$4:$L$10004\"\n                    ' Set line size and color\n                    With cht.SeriesCollection(seriesIndex)\n                        .Format.Line.Weight = 2.25\n                        .Format.Line.Visible = msoFalse\n                        .Format.Line.Visible = msoTrue\n                        .Format.Line.ForeColor.RGB = RGB(255,0,0)\n                        .MarkerStyle = xlMarkerStyleNone\n                    End With\n\n    Next i\n\n\n    ' Legend\n\n\nEnd Sub\n</code></pre>\n\n<p>Data are stored in sheets \"Data1\" - \"Data5\", and the range should be ok. Chart \"Chart 1\" already exists (that's why I don't create it).</p>\n\n<p>Thanks in advance for help!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1559783337, "creation_date": 1559783337, "answer_id": 56469801, "question_id": 56466564, "link": "https://stackoverflow.com/questions/56466564/exporting-comments-from-word-to-excel/56469801#56469801", "title": "Exporting Comments from Word to Excel", "body": "<p>Perhaps you should be using destSheet rather than Activesheet, since Activesheet isn't defined. Otherwise, you should prefix Activesheet with objExcelApp, thus:</p>\n\n<pre><code>objExcelApp.Activesheet\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1560167770, "creation_date": 1560167770, "answer_id": 56525922, "question_id": 56466564, "link": "https://stackoverflow.com/questions/56466564/exporting-comments-from-word-to-excel/56525922#56525922", "title": "Exporting Comments from Word to Excel", "body": "<p>Since you're running this in Word, VBA only \"knows\" things that belong to the Word <em>object model</em> unless the code specifically indicates a different object model is the source. Word knows nothing about \"Sheets\" - only Excel knows what <code>ActiveSheet</code> is. </p>\n\n<p>Even though the code you show us doesn't call the procedure <code>PrintFirstColumnOnActiveSheetToSheetName()</code>, where <code>ActiveSheet</code> is used, VBA <em>sees</em> it when it compiles the code. So you need to pass a reference to the Excel application to this procedure and use it. For example:</p>\n\n<pre><code>Public Sub PrintFirstColumnOnActiveSheetToSheetName(objExcel as Object)\n  objExcel.ActiveSheet.Name = objExcel.ActiveSheet.Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>To call this elsewhere in your code it would look something like the following line. Notice that the variable names for the same object do not need to be the same in different procedures - they can be, but it's not necessary. VBA \"remembers\" that the Excel application started previously is what's been passed to another procedure.</p>\n\n<pre><code>PrintFirstColumnOnActiveSheetToSheetName objExcelApp\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11605748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e5d234698d5f847b6c41f82cce3a87?s=128&d=identicon&r=PG&f=1", "display_name": "LearningToCode", "link": "https://stackoverflow.com/users/11605748/learningtocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560167770, "creation_date": 1559761495, "last_edit_date": 1559839767, "question_id": 56466564, "link": "https://stackoverflow.com/questions/56466564/exporting-comments-from-word-to-excel", "title": "Exporting Comments from Word to Excel", "body": "<p>I am getting an error when I try to run the following code in word to extract comments. The yellow highlight is over Public Sub PrintFirstColumnOnActiveSheetToSheetName(), which then says I have a compile error: variable not defined and highlights \"Activesheet\" within the Activesheet.range(\"A1\") at the bottom of the code</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FindWordComments()\n\n\nDim objExcelApp As Object\nDim wb As Object\nSet objExcelApp = CreateObject(\"Excel.Application\")\nSet wb = objExcelApp.Workbooks.Open(\"C:\\Desktop\\Book11\")\n\nDim myWord              As Word.Application\nDim myDoc               As Word.Document\nDim thisComment         As Word.Comment\n\nDim fDialog             As Office.FileDialog\nDim varFile             As Variant\n\nDim destSheet           As Worksheet\nDim rowToUse            As Integer\nDim colToUse            As Long\n\nSet fDialog = Application.FileDialog(msoFileDialogFilePicker)\nSet destSheet = wb.Sheets(\"Book11\")\ncolToUse = 1\n\nWith fDialog\n    .AllowMultiSelect = True\n    .Title = \"Import Files\"\n    .Filters.Clear\n    .Filters.Add \"Word Documents\", \"*.docx\"\n    .Filters.Add \"Word Macro Documents\", \"*.docm\"\n    .Filters.Add \"All Files\", \"*.*\"\nEnd With\n\nIf fDialog.Show Then\n\n    For Each varFile In fDialog.SelectedItems\n\n        rowToUse = 2\n\n    Set myWord = New Word.Application\n    Set myDoc = myWord.Documents.Open(varFile)\n\n    For Each thisComment In myDoc.Comments\n\n        With thisComment\n            destSheet.Cells(rowToUse, colToUse).Value = .Range.Text\n            destSheet.Cells(rowToUse, colToUse + 1).Value = .Scope.Text\n            destSheet.Columns(2).AutoFit\n        End With\n\n        rowToUse = rowToUse + 1\n\n    Next thisComment\n\n    destSheet.Cells(1, colToUse).Value = Left(myDoc.Name, 4)\n    'Put name of interview object in cell A1\n\n    destSheet.Cells(1, colToUse + 1).Value = ActiveDocument.Words.Count\n    'Put the number of words in cell B1\n\n    Set myDoc = Nothing\n    myWord.Quit\n\n    colToUse = colToUse + 2\n\nNext varFile\n\nEnd If\n\nEnd Sub\n\n\nPublic Sub PrintFirstColumnOnActiveSheetToSheetName()\n\n\nActiveSheet.Name = ActiveSheet.Range(\"A1\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 1, "creation_date": 1559761638, "post_id": 56466550, "comment_id": 99524560, "body": "Why don&#39;t you just create an end tab and a start tab, and write a cell formula that will sum the sandwich, e.g. &#39;=SUM(Start:End!A4)&#39;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559763115, "post_id": 56466550, "comment_id": 99525188, "body": "Note: this code will blow up with error 438 if any of the <code>Sheets</code> is actually a <code>Chart</code>. Consider iterating the <code>Worksheets</code> collection instead, ...and qualifying it with an explicit <code>Workbook</code> object reference, e.g. <code>ActiveWorkbook.Worksheets</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1559762787, "post_id": 56466710, "comment_id": 99525047, "body": "To be safe, I&#39;d do <code>Dim valueFromA4 as String</code>, to make sure Excel doesn&#39;t set <code>valueFromA4</code> as a <code>Range</code>. (...hm, it may not matter the way you&#39;re using it, but better to be explicit)"}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1559845116, "post_id": 56466710, "comment_id": 99556454, "body": "Yes it depends on how you want to use it. If you want a String value from the cell you can Dim it as a String and use Cells(4, 1).value2, which abstracts the value with no formatting."}], "tags": [], "owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "is_accepted": false, "score": -1, "last_activity_date": 1559846484, "last_edit_date": 1559846484, "creation_date": 1559762205, "answer_id": 56466710, "question_id": 56466550, "link": "https://stackoverflow.com/questions/56466550/how-can-i-add-across-multiple-sheets/56466710#56466710", "title": "How can I add across multiple sheets?", "body": "<p>If it's always the same location (A4) then you can just hard code it in.</p>\n\n<pre><code>valueFromA4 = Cells(4, 1).Value\n\nFor i = 2 To Sheets.Count\n    Sheets(i).Cells(4, 1).Value = valueFromA4\nNext i\n</code></pre>\n\n<p>I recommend using i in your for loop, just a convention. Most loops begin with i = 0, but with Excel Sheets begin with a count of 1, so the sheet after your first sheet will be 2.</p>\n"}, {"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1559768302, "last_edit_date": 1559768302, "creation_date": 1559767951, "answer_id": 56467840, "question_id": 56466550, "link": "https://stackoverflow.com/questions/56466550/how-can-i-add-across-multiple-sheets/56467840#56467840", "title": "How can I add across multiple sheets?", "body": "<p>Remember, always add <code>Option Explicit</code> on the very top of your code. This will force you to declare all your variables, which in turn will save you from all kinds of trouble.</p>\n\n<p>That's how i'd do it</p>\n\n<pre><code>Sub addAcrossSheets()\nDim sht As Worksheet\nDim totalSum As Double\ntotalSum = 0 'initialize the sum\nFor Each sht In ThisWorkbook.Worksheets 'loop through the collection of worksheets\n    totalSum = totalSum + sht.Range(\"A4\") 'update the sum\nNext sht\nDebug.Print totalSum 'the result is displayed in your immediate window\nEnd Sub\n</code></pre>\n\n<p>Now, you might want to exclude some worksheets from the sum. You could do that like so:</p>\n\n<pre><code>For Each sht In ThisWorkbook.Worksheets 'loop through the collection of worksheets\n    If sht.Name &lt;&gt; \"Something\" And sht.Name &lt;&gt; \"Something else\" Then 'exclude worksheets from the sum\n        totalSum = totalSum + sht.Range(\"A4\") 'update the sum\n    End If\nNext sht\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11605762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd41e86787d938143f3d322cbf414af6?s=128&d=identicon&r=PG&f=1", "display_name": "NotGoodAtVeeBeeA", "link": "https://stackoverflow.com/users/11605762/notgoodatveebeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559846704, "creation_date": 1559761389, "last_edit_date": 1559846704, "question_id": 56466550, "link": "https://stackoverflow.com/questions/56466550/how-can-i-add-across-multiple-sheets", "title": "How can I add across multiple sheets?", "body": "<p>I'm trying to add the same cell across multiple sheets in a single workbook. A few parameters:</p>\n\n<ul>\n<li>The cell will always be the same (A4)</li>\n<li>I'm not sure how many sheets I will have every month.</li>\n<li>It is stored as a number?</li>\n</ul>\n\n<p>I've tried googling this, and it always had a simple sum formula. I'm looking to specifically write a VBA function to do it.</p>\n\n<pre><code>Function AddAcrossSheets(rng As Range) As Variant\n\n    valRow = rng.Row\n    valCol = rng.Column\n\n\n    For x = 1 To Sheets.Count\n        AddAcrossSheets = Sheets(x).Cells(valRow, valCol).Value + AddAcrossSheets\n    Next x\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1559763691, "post_id": 56466488, "comment_id": 99525399, "body": "Note that <code>.End(xlDown)</code> <a href=\"https://stackoverflow.com/a/11169920/1188513\">can be unreliable</a>; best go <code>xlUp</code> <i>from the very bottom of the sheet</i>, especially if the column <i>might</i> have empty rows."}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559761579, "post_id": 56466526, "comment_id": 99524532, "body": "There are other values and tables in between, so I can&#39;t go down to the last row in A and ctrl up. But I can start from A4 and ctrl down to next blank cell and that&#39;s the range that I&#39;m trying to define"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559761752, "post_id": 56466526, "comment_id": 99524612, "body": "@GimGanDi try it now"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559762307, "post_id": 56466526, "comment_id": 99524860, "body": "<code>LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row</code> would be better."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559761731, "last_edit_date": 1559761731, "creation_date": 1559761231, "answer_id": 56466526, "question_id": 56466488, "link": "https://stackoverflow.com/questions/56466488/excel-vba-dynamic-range-to-use-with-for-each-statement/56466526#56466526", "title": "Excel VBA - Dynamic Range to use with For Each Statement", "body": "<p>Try this if it helps:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim LastRow As Long 'to find the last row on your range\n    Dim MyRange As Range 'to reference the whole range\n    Dim C As Range 'to loop through your range\n\n    With ThisWorkbook.Sheets(\"MySheet\") 'change MySheet for your sheet name\n        LastRow = .Cells(4, 1).End(xlDown).Row 'last row, how? You go down to the last row and then ctrl + up\n        Set MyRange = .Range(\"A4:A\" &amp; LastRow) 'dynamic range\n        For Each C In MyRange\n            'your code\n        Next C\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559763864, "post_id": 56466604, "comment_id": 99525468, "body": "<code>LastRow = Range(&quot;A&quot;, Rows.Count).End(xlUp).Row</code> would be better. <code>xlDown</code> is quite unpredictable. Also declaring/setting the sheets variable is recommended."}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559764705, "post_id": 56466604, "comment_id": 99525805, "body": "If I want the range to start from A4 then I would put simply replace <code>= Range(&quot;A&quot;,..</code> with <code>&quot;A4&quot;,..</code> ?"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559765103, "post_id": 56466604, "comment_id": 99526000, "body": "I get an error using <code>lastrow = Range(&quot;A4&quot;, Rows.Count).End(xlUp).Row</code> <code>Set rng1 = Range(&quot;A4:A&quot; &amp; lastrow)</code>"}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "reply_to_user": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559845857, "post_id": 56466604, "comment_id": 99556755, "body": "@GimGanDi yes, if you want the range to start at A4 then you would enter A4 as shown. Range objects use the format of (&quot;A4:B6&quot;), where A4 is the first cell on the upper left of the range and B6 would be the last cell in the lower right."}], "tags": [], "owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "is_accepted": true, "score": 0, "last_activity_date": 1559761698, "creation_date": 1559761698, "answer_id": 56466604, "question_id": 56466488, "link": "https://stackoverflow.com/questions/56466488/excel-vba-dynamic-range-to-use-with-for-each-statement/56466604#56466604", "title": "Excel VBA - Dynamic Range to use with For Each Statement", "body": "<p>You can use .xlDown, it's the equivalent of pressing ctrl+Shift+down.</p>\n\n<pre><code>Dim rng As Range\nDim lastRow As Long\n\nlastRow = Range(\"A4\").End(xlDown).Row\nSet rng = Range(\"A4:A\" &amp; lastRow)\n\nFor Each itm In rng\n    'do something\nNext itm\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 56466604, "answer_count": 2, "score": 0, "last_activity_date": 1559761731, "creation_date": 1559761051, "last_edit_date": 1559761427, "question_id": 56466488, "link": "https://stackoverflow.com/questions/56466488/excel-vba-dynamic-range-to-use-with-for-each-statement", "title": "Excel VBA - Dynamic Range to use with For Each Statement", "body": "<p>I'm trying to dynamically define a range in row like ctrl+down or ctrl+shift+down (to next blank cell) to be used with \"For Each itm In rng\" statement.  </p>\n\n<p>Originally I had it static like this <strong>set rng = Range(\"A4:A10\")</strong><br>\nSo I tried to change it to something like this</p>\n\n<pre><code>Dim rng As Range\n\nSet rng = Range(\"A4\").CurrentRegion.Rows.Count    \n\n    For Each itm In rng\n        ...        \n    Next itm\n</code></pre>\n\n<p>I also tried something like this  </p>\n\n<pre><code>Set StartCell = Range(\"A4\")\nrng = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\n</code></pre>\n\n<p>But the code doesn't seems to work with \"For Each itm In rng\" statement<br>\nAny help is very much appreciated.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 11605477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10a5ef2b7bea6be661746c4b420aa0?s=128&d=identicon&r=PG&f=1", "display_name": "RagingDeathWish", "link": "https://stackoverflow.com/users/11605477/ragingdeathwish"}, "edited": false, "score": 0, "creation_date": 1559762275, "post_id": 56466507, "comment_id": 99524848, "body": "Thanks for your answer. It improved my code. Even so, i got another error: Dim ra As Range      Set ra = xlBook.Sheets(1).Cells.Find(What:=&quot;SLD&quot;, LookIn:=xlFormulas, LookAt _     :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _     False, SearchFormat:=False) &#39;there is a pb with find      If ra Is Nothing Then         MsgBox &quot;Not found&quot;         Else         MsgBox ra.Address  &#39;it says method or data member not found     End If   and since i cant acces the addres i cannot copy the row"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 97, "user_id": 11605477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10a5ef2b7bea6be661746c4b420aa0?s=128&d=identicon&r=PG&f=1", "display_name": "RagingDeathWish", "link": "https://stackoverflow.com/users/11605477/ragingdeathwish"}, "edited": false, "score": 1, "creation_date": 1559771723, "post_id": 56466507, "comment_id": 99528551, "body": "<code>Dim ra As Object</code> not <code>Dim ra As Range</code> - if you use <code>Range</code> in Word&#39;s VBA environment it will assume you mean <code>Word.Range</code> not <code>Excel.Range</code>  The Word <code>Range</code> object doesn&#39;t have an <code>Address</code> property"}, {"owner": {"reputation": 97, "user_id": 11605477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10a5ef2b7bea6be661746c4b420aa0?s=128&d=identicon&r=PG&f=1", "display_name": "RagingDeathWish", "link": "https://stackoverflow.com/users/11605477/ragingdeathwish"}, "edited": false, "score": 0, "creation_date": 1559806530, "post_id": 56466507, "comment_id": 99536337, "body": "Thanks it worked better. Here it is:  Dim ra as Object Set ra =  xlBook.Sheets(1).Cells.Find(What:=&quot;SLD&quot;) &#39;works without the other arguments msgbox ra.address &#39; just to see that it works"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 97, "user_id": 11605477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10a5ef2b7bea6be661746c4b420aa0?s=128&d=identicon&r=PG&f=1", "display_name": "RagingDeathWish", "link": "https://stackoverflow.com/users/11605477/ragingdeathwish"}, "edited": false, "score": 0, "creation_date": 1559851705, "post_id": 56466507, "comment_id": 99559027, "body": "The only thing I&#39;d caution about not using the other arguments to <code>Find()</code> is that those default to the <i>last-used</i> settings. i.e. if you previously searched for something using <code>xlWhole</code> then that&#39;s what your VBA will use unless you specify otherwise by providing that argument."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1559794848, "last_edit_date": 1559794848, "creation_date": 1559761145, "answer_id": 56466507, "question_id": 56466404, "link": "https://stackoverflow.com/questions/56466404/find-a-string-within-an-excel-file-and-get-the-row-index/56466507#56466507", "title": "Find a string within an Excel file and get the row index", "body": "<pre><code>Set ra = Cells.Find(What:=\"SLD\", LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False) 'there is a pb with find\n</code></pre>\n\n<p><code>Cells</code> is part of your Excel application object, not part of your Word vba environment, so you need to qualify it as you did above</p>\n\n<pre><code>Dim ra As Object 'not Range\n\nSet ra = xlBook.Sheets(1).Cells.Find(What:=\"SLD\", LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False)\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 11605477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10a5ef2b7bea6be661746c4b420aa0?s=128&d=identicon&r=PG&f=1", "display_name": "RagingDeathWish", "link": "https://stackoverflow.com/users/11605477/ragingdeathwish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1577605880, "creation_date": 1559760729, "last_edit_date": 1577605880, "question_id": 56466404, "link": "https://stackoverflow.com/questions/56466404/find-a-string-within-an-excel-file-and-get-the-row-index", "title": "Find a string within an Excel file and get the row index", "body": "<p>I am trying to access an Excel file through Word and to search for a string.</p>\n\n<p>I am trying to get the whole row (for example: I am looking for the string \"Hello world\" in cell A7, then trying to get all the dates in row 7) then to place that info into my Word file at a precise location. </p>\n\n<p>Here is an example of the Excel file:</p>\n\n<pre><code>No       site           trig           type \n1        steve          stv            7\n2        Nancy          nco            3\n</code></pre>\n\n<p>etc..</p>\n\n<pre><code>Public Function test(ByVal strTitle As String, ByVal strTrigram As String) As String\n    Dim xlApp As Object\n    Dim xlBook As Object\n    Dim strName As String\n    Dim col As Column\n\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n    If Err Then\n        Set xlApp = CreateObject(\"Excel.Application\")\n    End If\n    On Error GoTo 0\n    Set xlBook = xlApp.Workbooks.Open(ActiveDocument.Path &amp; \"/FichierTrigrammes.xlsx\")\n    xlApp.Visible = False  'does not open the file, read only =&gt; faster to get the info\n\n    With xlBook.Sheets(1).Cells\n        Set rfind = .Find(What:=strTitle) ' on cherche si il y a ue colonne avec le nom\n        If rfind Is Nothing Then\n            MsgBox \"Pas de colonne avec ce titre\"\n            Exit Function\n        End If\n        MsgBox rfind.Column\n        'Debug.Print \"L'index de la colonnne\" &amp; titleCol &amp;; \" est \"; rfind.Column\n    End With\n\n    Dim ra As Range\n\n    Set ra = Cells.Find(What:=\"SLD\", LookIn:=xlFormulas, LookAt _\n      :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n      False, SearchFormat:=False) 'there is a pb with find\n\n    If ra Is Nothing Then\n        MsgBox \"Not found\"\n        Else\n        MsgBox ra.Address\n    End If         \n\n    strName = \"okay\"\n    'strName = xlBook.Sheets(1).Cells.Find(what:=strTrig)\n    xlBook.Close False ' no save\n    Set src = Nothing\n    Set xlApp = Nothing\n    Set xlBook = Nothing\n    test = strName\n\nEnd Function\n</code></pre>\n\n<p>I am trying to search if the header in the Excel file is what I need, then to locate the string (that should be here) and get the row index to get the whole row but an error pops up saying there is problem at the method find.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "concatenation"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1559763667, "post_id": 56466346, "comment_id": 99525391, "body": "Have you got an Excel new enough to use TEXTJOIN()?"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1559767991, "last_edit_date": 1559767991, "creation_date": 1559764677, "answer_id": 56467170, "question_id": 56466346, "link": "https://stackoverflow.com/questions/56466346/how-to-concatenate-column-titles-if-cells-in-a-range-contains-a-specific-text-ch/56467170#56467170", "title": "How to concatenate column titles if cells in a range contains a specific text/character", "body": "<p>Multiple options really:</p>\n\n<p><strong><em>Option 1: <a href=\"https://support.office.com/en-ie/article/textjoin-function-357b449a-ec91-49d0-80c3-0e8fc845691c\" rel=\"nofollow noreferrer\">Excel TEXTJOIN</a></em></strong></p>\n\n<p>If you have an Excel license supporting <code>TEXTJOIN()</code> you could use:</p>\n\n<pre><code>=TEXTJOIN(\", \",TRUE,IF(ISNUMBER(SEARCH(\"~*\",A2:C2)),A2:C2,\"\"))\n</code></pre>\n\n<p>For returning values or:</p>\n\n<pre><code>=TEXTJOIN(\", \",TRUE,IF(ISNUMBER(SEARCH(\"~*\",A2:C2)),$A$1:$C$1,\"\"))\n</code></pre>\n\n<p>For returning the column headers. Enter both formulas through <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd> and drag down.</p>\n\n<p><strong><em>Option 2: <a href=\"https://support.google.com/docs/answer/7013992?hl=en\" rel=\"nofollow noreferrer\">Google Spreadsheet TEXTJOIN</a></em></strong></p>\n\n<p>If you can use Google Spreadsheets (free to use, and if you just need to do this operation once it might be worthwhile to transfer your data) she same functions are available. It will look like:</p>\n\n<pre><code>=ARRAYFORMULA(TEXTJOIN(\", \",TRUE,IF(ISNUMBER(SEARCH(\"~*\",A2:C2)),A2:C2,\"\")))\n</code></pre>\n\n<p>For returning values or:</p>\n\n<pre><code>=ARRAYFORMULA(TEXTJOIN(\", \",TRUE,IF(ISNUMBER(SEARCH(\"~*\",A2:C2)),$A$1:$C$1,\"\")))\n</code></pre>\n\n<p>For returning column headers again.</p>\n\n<hr>\n\n<p><em>Notice in both Option 1 and Option 2 I have used a tilde, <code>~</code>, as an escape character telling excel we literally looking for an asterisk.</em></p>\n\n<hr>\n\n<p><strong><em>Option 3: Visual Basics</em></strong></p>\n\n<p>If you don't have an Excel license supporting <code>TEXTJOIN()</code> and using Google Spreadsheets is no option either, your best bet is an UDF (User Defined Function), for example:</p>\n\n<pre><code>Function CONCATENATEIF(RNG As Range, CON As String) As String\n\nFor Each CL In RNG\n    If InStr(1, CL.Value, CON) &gt; 0 Then CONCATENATEIF = CONCATENATEIF &amp; CL.Value &amp; \", \"\nNext CL\nIf CONCATENATEIF &lt;&gt; \"\" Then\n    CONCATENATEIF = Left(CONCATENATEIF, Len(CONCATENATEIF) - 2)\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Call it in your worksheet like:</p>\n\n<pre><code>=CONCATENATEIF(A2:C2,\"*\")\n</code></pre>\n\n<p>And drag down... (notice this time we don't need the tilde). Likewise, if you want to return the headers simply change <code>CONCATENATEIF = CONCATENATEIF &amp; CL.Value &amp; \", \"</code> into <code>CONCATENATEIF = CONCATENATEIF &amp; Cells(1, CL.Column).Value &amp; \", \"</code></p>\n\n<hr>\n\n<p><strong><em>Output for all options:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/25vq6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/25vq6.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Or:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/NctIg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NctIg.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 10901642, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hdxea5V24Yg/AAAAAAAAAAI/AAAAAAAAAAc/3TcJaS--NP8/photo.jpg?sz=128", "display_name": "Irene", "link": "https://stackoverflow.com/users/10901642/irene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 56467170, "answer_count": 1, "score": 2, "last_activity_date": 1559823655, "creation_date": 1559760421, "last_edit_date": 1559823655, "question_id": 56466346, "link": "https://stackoverflow.com/questions/56466346/how-to-concatenate-column-titles-if-cells-in-a-range-contains-a-specific-text-ch", "title": "How to concatenate column titles if cells in a range contains a specific text/character", "body": "<p>I am trying to create a list of column names based on specific criteria (if the cell contains \"*\"). </p>\n\n<p>Basically, I am trying to get Excel to automatically create the fourth column:</p>\n\n<pre><code>(1) A       B       C           List\n(2) Bob*    Mike    John*       A; C\n(3) Jane    Lisa*   Brenda*     B; C\n</code></pre>\n\n<p><strong>*Please note that I have over 100 columns</strong></p>\n\n<p>I am a little familiar with VBA and the Concatenate function but I'm no expert.</p>\n\n<p>Thanks for taking the time to read this post!</p>\n\n<p>Irene</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1559762877, "post_id": 56466285, "comment_id": 99525091, "body": "Where do the multipliers <code>51, 73, 17...</code> come from?"}, {"owner": {"reputation": 1002, "user_id": 1687356, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/vy1KO.jpg?s=128&g=1", "display_name": "bpy", "link": "https://stackoverflow.com/users/1687356/bpy"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1559766501, "post_id": 56466285, "comment_id": 99526564, "body": "The multipliers are always the same."}], "answers": [{"comments": [{"owner": {"reputation": 1002, "user_id": 1687356, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/vy1KO.jpg?s=128&g=1", "display_name": "bpy", "link": "https://stackoverflow.com/users/1687356/bpy"}, "edited": false, "score": 0, "creation_date": 1559762618, "post_id": 56466615, "comment_id": 99524979, "body": "I cannot store those numbers. The string is generated by each quote. I have dozzens of quotes by client."}, {"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "reply_to_user": {"reputation": 1002, "user_id": 1687356, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/vy1KO.jpg?s=128&g=1", "display_name": "bpy", "link": "https://stackoverflow.com/users/1687356/bpy"}, "edited": false, "score": 0, "creation_date": 1559762896, "post_id": 56466615, "comment_id": 99525102, "body": "Somehow you have to order these numbers, because the order is important so to multiply each of them with a digit in a specific position of the string, right? So you have to store them, if not in a table then in a structure like an array and create a function by VBA code to get the result."}], "tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": false, "score": 2, "last_activity_date": 1559761725, "creation_date": 1559761725, "answer_id": 56466615, "question_id": 56466285, "link": "https://stackoverflow.com/questions/56466285/how-to-split-a-string-to-multiply-each-single-number-by-a-value-in-ms-access-200/56466615#56466615", "title": "how to split a string to multiply each single number by a value in ms access 2007", "body": "<p>You can do it with SQL.<br/>\nCreate a table, say with name <code>weights</code>, with 2 columns:</p>\n\n<pre><code>id:     Number\nweight: Number\n</code></pre>\n\n<p>and insert these rows:</p>\n\n<pre><code>id  weight\n1   51\n2   73\n3   17\n4   89\n5   38\n6   62\n7   45\n8   53\n9   15\n10  50\n11  5\n12  49\n13  34\n14  81\n15  76\n16  27\n17  90\n18  9\n19  30\n20  3\n</code></pre>\n\n<p>Then execute this query:</p>\n\n<pre><code>SELECT SUM(w.weight * val(mid('11604999123400002586', w.id, 1))) AS result \nFROM weights AS w\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>2627\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1559763832, "post_id": 56466813, "comment_id": 99525456, "body": "Actually a will have values from a(0) all the way to a(20). a(0) is just not being used. I chose to make the code simpler and more readable, rather than use one less int worth of RAM."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1559763890, "post_id": 56466813, "comment_id": 99525477, "body": "Sorry I didn&#39;t realize that.  Nice."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1559764088, "post_id": 56466813, "comment_id": 99525564, "body": "To be honest I had to check and double check when I saw that, because in every other language a declaration of an array with <code>20</code> would indeed have 20 values from 0 to 19. It seems to be a unique VBA peculiarity."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 4, "last_activity_date": 1559762785, "creation_date": 1559762785, "answer_id": 56466813, "question_id": 56466285, "link": "https://stackoverflow.com/questions/56466285/how-to-split-a-string-to-multiply-each-single-number-by-a-value-in-ms-access-200/56466813#56466813", "title": "how to split a string to multiply each single number by a value in ms access 2007", "body": "<p>In VBA you can do something like this:</p>\n\n<pre><code>Dim a(20) as Integer\na(1) = 51\na(2) = 73\n\u2026\na(20) = 3\n\nDim Result AS Long: Result = 0\nFor i = 1 to 20\n    Result = Result + CInt(Mid(MyString,i,1)) * a(i)\n  Next i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1559768926, "last_edit_date": 1559768926, "creation_date": 1559765082, "answer_id": 56467252, "question_id": 56466285, "link": "https://stackoverflow.com/questions/56466285/how-to-split-a-string-to-multiply-each-single-number-by-a-value-in-ms-access-200/56467252#56467252", "title": "how to split a string to multiply each single number by a value in ms access 2007", "body": "<p>Consistency of structure is critical in string manipulation. Assume there will always be 20 digits in string and every record will have value.</p>\n\n<p>Calculate 20 columns and add them together for the Total - here are 2: </p>\n\n<p><code>SELECT Quotes.*, Mid([Data],1,1)*53 AS A, Mid([Data],2,1)*71 AS B, [A]+[B] AS Total FROM Quotes;</code></p>\n\n<p>Could pull weight factor from table. DLookup is one way but domain aggregate can cause slow performance in large dataset so if weight factors will never change, probably don't want this:  </p>\n\n<p><code>SELECT Quotes.Data, Mid([Data],1,1)* DLookup(\"Weight\",\"Factors\",\"ID=1\") AS A, Mid([Data],2,1)* DLookup(\"Weight\",\"Factors\",\"ID=2\") AS B, [A]+[B] AS Total FROM Quotes;</code></p>\n\n<p>A Cartesian relationship with aggregate calcs query using data and weight factors tables can calculate Total - Cartesian can also perform slowly with large dataset:</p>\n\n<pre><code>SELECT Quotes.ID, Sum(Mid([Data],[Factors].[ID],1)*[Weight]) AS Total\nFROM Factors, Quotes\nGROUP BY Quotes.ID;\n</code></pre>\n\n<p>A custom VBA function could return just the total. Call this function from query or textbox. The weight factors can be pulled from table or hard coded in an array construct.</p>\n\n<pre><code>Function GetTotal(strD) As Long\nDim rs As DAO.Recordset, x As Integer\nSet rs = CurrentDb.OpenRecordset(\"SELECT Weight FROM Factors ORDER BY ID\")\nFor x = 1 To 20\n    GetTotal = GetTotal + Mid(strD, x, 1) * rs!Weight\n    rs.MoveNext\nNext\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1002, "user_id": 1687356, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/vy1KO.jpg?s=128&g=1", "display_name": "bpy", "link": "https://stackoverflow.com/users/1687356/bpy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56466813, "answer_count": 3, "score": 0, "last_activity_date": 1594716137, "creation_date": 1559760080, "last_edit_date": 1594716137, "question_id": 56466285, "link": "https://stackoverflow.com/questions/56466285/how-to-split-a-string-to-multiply-each-single-number-by-a-value-in-ms-access-200", "title": "how to split a string to multiply each single number by a value in ms access 2007", "body": "<p>I need to split a string of 20 digits individually and multiply each single one by a value.</p>\n\n<pre><code>String (this string is in a text box) example: 11604999123400002586\n</code></pre>\n\n<p>After the split, I must do the following operation:</p>\n\n<pre><code>51 x 1\u00ba digit +\n73 x 2\u00ba digit +\n17 x 3\u00ba digit +\n89 x 4\u00ba digit +\n38 x 5\u00ba digit +\n62 x 6\u00ba digit +\n45 x 7\u00ba digit +\n53 x 8\u00ba digit +\n15 x 9\u00ba digit +\n50 x 10\u00ba digit +\n5 x 11\u00ba digit +\n49 x 12\u00ba digit +\n34 x 13\u00ba digit +\n81 x 14\u00ba digit +\n76 x 15\u00ba digit +\n27 x 16\u00ba digit +\n90 x 17\u00ba digit +\n9 x 18\u00ba digit +\n30 x 19\u00ba digit +\n3 x 20\u00ba digit\n</code></pre>\n\n<p><strong>In this example:</strong> </p>\n\n<pre><code>Result = 51x1 + 73x1 + 17x6 + 89x0 + 38x4 + 62x9 +\n45x9 + 53x9 + 15x1 + 50x2 + 5x3 + 49x4 + 34x0 + 81x0 + 76x0 + 27x0 + 90x2\n+ 9x5 + 30x8 + 3x6 = 2627\n</code></pre>\n\n<p>What would be the best way to do it?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559760286, "post_id": 56466091, "comment_id": 99523994, "body": "Something like <code>xlsheet.Cells(x,3).Value = tblrange.Text</code> for example"}, {"owner": {"reputation": 1, "user_id": 11605592, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vGirTAwsZNQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7HwCxu4Q_vFGQ-31NN020qsH4bQ/mo/photo.jpg?sz=128", "display_name": "Ankitha Suresh", "link": "https://stackoverflow.com/users/11605592/ankitha-suresh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559763753, "post_id": 56466091, "comment_id": 99525428, "body": "Hi. That worked well but at the end of each value that was added to excel there is an extra special character(some box). How do i remove that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1559764114, "post_id": 56466091, "comment_id": 99525578, "body": "Try <code>xlsheet.Cells(x,3).Value = Left(tblrange.Text, Len(tblrange.Text)-2)</code>"}], "owner": {"reputation": 1, "user_id": 11605592, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vGirTAwsZNQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7HwCxu4Q_vFGQ-31NN020qsH4bQ/mo/photo.jpg?sz=128", "display_name": "Ankitha Suresh", "link": "https://stackoverflow.com/users/11605592/ankitha-suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559759402, "creation_date": 1559759184, "last_edit_date": 1559759402, "question_id": 56466091, "link": "https://stackoverflow.com/questions/56466091/how-to-copy-a-single-column-from-word-to-pre-existing-excel-table-using-vba", "title": "How to copy a single column from word to pre-existing excel table using vba?", "body": "<p>I have a table in word that has two columns. I want to copy only the second column into the 2nd column of my pre-existing table in excel. My 'for' loop is working but all the data is getting repeatedly stored in the same cell.How do i store in consecutive cells of the column?</p>\n\n<pre><code>Sub copyToExcel()\nDim xlapp As Excel.Application\nDim xlwb As Excel.Workbook\nDim xlsheet As Excel.Worksheet\n\nDim doc As Document\nDim tbl As Table\nDim lstrw As Long, lstcol As Integer\nDim tblrange As Range\n\nSet doc = ThisDocument\nSet xlapp = CreateObject(\"Excel.Application\")\nxlapp.Visible = True\nSet xlwb = xlapp.Workbooks.Open(\"C:\\Users\\ankit\\Downloads\\challenges.xlsm\")\nSet xlsheet = xlwb.Worksheets(\"Challenge #2\")\n\nSet tbl = doc.Tables(1)\nWith tbl\n lstrw = .Rows.Count\n lstcol = .Columns.Count\n For x = 2 To lstrw\n    Set tblrange = .Cell(x, 2).Range\n    tblrange.End = .Cell(lstrow, lstcol).Range.End\n    tblrange.Copy\n    xlsheet.Paste\n Next x\nEnd With\n\nSet xlapp = Nothing\nSet xlwb = Nothing\nSet tblrange = Nothing\nSet xlsheet = Nothing\nSet doc = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listobject"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1559758808, "post_id": 56465950, "comment_id": 99523343, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/val-function\" rel=\"nofollow noreferrer\"><code>Val</code></a> is a built-in function. Maybe use a different name. Also you have a typo <code>Columns = tbl.Rable.Columns.Count</code>, what&#39;s <code>Rable</code>? Finally, you need to be consistent - you&#39;re using both <code>tbl.Range</code> and <code>tbl.DataBodyRange</code>. <code>tbl.Range</code> includes the header row. Not sure you want that. You might also want to consider a different name for <code>rows</code> and <code>Columns</code>."}, {"owner": {"reputation": 2541, "user_id": 989359, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ac4d82d7e1aa51dc2f3cc436f5be53b1?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/989359/josh"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559759534, "post_id": 56465950, "comment_id": 99523678, "body": "changing the variable names did the trick. Also, would it make more sense to iterate through each column or is it more advisable to use <code>tbl.ListRows(iter).Range(1, col).Value</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559759654, "post_id": 56465950, "comment_id": 99523729, "body": "I think the current approach is cleaner. <code>tbl.DataBodyRange.Cells(iter, col)</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559762199, "post_id": 56465950, "comment_id": 99524818, "body": "@BigBen the problem with <code>Range.Cells(row, col)</code> is that it&#39;s retrieving objects in an object collection <i>by index</i>, which is inefficient. Object collections <i>want</i> to be iterated with a <code>For Each</code> loop."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559762542, "post_id": 56465950, "comment_id": 99524952, "body": "@MathieuGuindon I agree. I would have proposed an array approach as you actually did :) (guess I&#39;m just too lazy today to write out an answer)."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1559764452, "post_id": 56466683, "comment_id": 99525704, "body": "any reason you put the <code>Dim currentCol</code> inside the first For loop?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559764506, "post_id": 56466683, "comment_id": 99525720, "body": "@chrisneilsen because I like my variables declared as close as possible to where they&#39;re used. <code>Dim</code> statements aren&#39;t executable though, so it pragmatically doesn&#39;t make a difference; <code>Dim currentRow As Long, currentCol As Long</code> above the outer loop would be just as good, but I don&#39;t like declaring multiple variables in a single instruction, so..."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559765361, "post_id": 56466683, "comment_id": 99526101, "body": "Thanks for that.  <i>so it pragmatically doesn&#39;t make a difference</i>. That&#39;s why I asked, unless one is aware of that, it might be misleading. (I&#39;ve answered a Q where the OP was expecting  a Dim to execute on each iteration )"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559765557, "post_id": 56466683, "comment_id": 99526164, "body": "@chrisneilsen TBH in real code I&#39;d probably extract the inner loop into its own procedure; having the variable inside the outer loop body makes it easier to just cut that code and paste it in a new method... where it would now be declared just above the loop body ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1559762053, "creation_date": 1559762053, "answer_id": 56466683, "question_id": 56465950, "link": "https://stackoverflow.com/questions/56465950/iterate-through-table-in-excel-vba/56466683#56466683", "title": "Iterate through Table in Excel VBA", "body": "<p>You have a <code>ListObject</code>, use its API! <code>ListRows</code> and <code>ListColumns</code> are object collections, and the fastest way to iterate these, <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">by several orders of magnitude</a>, is with a <code>For Each</code> loop:</p>\n\n<pre><code>Dim tblRow As ListRow\nFor Each tblRow In tbl.ListRows\n    Dim tblCol As ListColumn\n    For Each tblCol In tbl.ListColumns\n        Debug.Print \"(\" &amp; tblRow.Index &amp; \",\" &amp; tblCol.Index &amp; \"): \" &amp; tblRow.Range(tblCol.Index).Value\n    Next\nNext\n</code></pre>\n\n<p>If you just want to collect the contents into a 2D array of values, you don't need to iterate anything - just grab the <code>DataBodyRange</code> and treat it like any other \"regular\" <code>Range</code>:</p>\n\n<pre><code>Dim contents As Variant\ncontents = tbl.DataBodyRange.Value\n</code></pre>\n\n<p>If you later need to iterate that 2D variant array, the fastest way (same source as above) is <code>For...Next</code> loops:</p>\n\n<pre><code>Dim currentRow As Long\nFor currentRow = LBound(contents, 1) To UBound(contents, 1)\n    Dim currentCol As Long\n    For currentCol = LBound(contents, 2) To UBound(contents, 2)\n        Debug.Print \"(\" &amp; currentRow &amp; \",\" &amp; currentCol &amp; \"): \" &amp; contents(currentRow, currentCol)\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 2541, "user_id": 989359, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ac4d82d7e1aa51dc2f3cc436f5be53b1?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/989359/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 1, "accepted_answer_id": 56466683, "answer_count": 1, "score": 1, "last_activity_date": 1559762053, "creation_date": 1559758530, "last_edit_date": 1559762050, "question_id": 56465950, "link": "https://stackoverflow.com/questions/56465950/iterate-through-table-in-excel-vba", "title": "Iterate through Table in Excel VBA", "body": "<p>What is the best way to iterate through the contents of each cell in a table and retrieve/store its value.\nWith my current approach, I'm unable to obtain set the value of a table in my variable <code>val</code></p>\n\n<p>Sample Table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wy9pf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wy9pf.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Set ws = ActiveSheet\nws.Name = \"sheet1\"\n\nSet tbl = ws.ListObjects(\"tblBor\")\nApplication.Calculation = xlCalculationManual\nws.Calculate\n\nWith tbl.Sort\n         .SortFields.Clear\n         .SortFields.Add Key:=Range(\"tblBor[ID]\"), SortOn:=xlSortOnValues, Order:=xlAscending\n         .Header = xlYes\n         .Apply\nEnd With\n\nSet rng = Range(tbl)\nrows = tbl.Range.rows.Count\nColumns = tbl.Range.Columns.Count\n\nFor iter = 1 To rows\n    For col = 1 To Columns\n        'Iterate through each row by each column\n        'val = tbl.DataBodyRange(iter, col).Value\n\n    Next col\nNext iter\n</code></pre>\n"}, {"tags": ["excel", "vba", "cell", "formula", "constants"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559757243, "post_id": 56465548, "comment_id": 99522734, "body": "FWIW cell values cannot be <i>constant</i>. Curious what references you found suggesting a constant can be defined from a cell&#39;s value."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 0, "creation_date": 1559790713, "post_id": 56465674, "comment_id": 99531950, "body": "Thanks, Matthieu. Since I have many constants I need to fetch in this way (all text), I&#39;ll try something like:   `    Public Function strGetConstant (strConstant as String) As String         strGetConstant = strConstant     End Function`   ...and in the cell formula...       =&quot;Some prefix text &quot; &amp; strGetConstant(gcStrTheConstantINeed) &amp; &quot; some suffix text&quot;  Will let you know how it goes..."}, {"owner": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 0, "creation_date": 1559792425, "post_id": 56465674, "comment_id": 99532230, "body": "Sorry &quot;Mathieu&quot; -- the approach a tried based on your suggestion (<code>=&quot;My Prefix &quot; &amp; strGetConstant(gcStrProcess) &amp; &quot; my suffix&quot;</code> returns a #VALUE error. FYI, the constant in question is declared as <code>Public Const gcStrProcess As String = &quot;Process&quot;&#39;</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 1, "creation_date": 1559798324, "post_id": 56465674, "comment_id": 99533356, "body": "<code>gcStrProcess</code> is inaccessible to worksheet formulas, you need to expose them as functions... Also <a href=\"http://rubberduckvba.com/Inspections/Details/HungarianNotation\" rel=\"nofollow noreferrer\">ditch the Hungarian notation</a> ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1559757185, "creation_date": 1559757185, "answer_id": 56465674, "question_id": 56465548, "link": "https://stackoverflow.com/questions/56465548/referencing-public-constants-in-cell-formulas/56465674#56465674", "title": "Referencing Public Constants in Cell Formulas", "body": "<p>Your public constant lives in a standard module, and probably looks something like this:</p>\n\n<pre><code>Public Const Foo As Long = 42\n</code></pre>\n\n<p>You can expose it through a UDF:</p>\n\n<pre><code>Public Function GetFoo() As Long\n    GetFoo = Foo\nEnd Function\n</code></pre>\n\n<p>And now you can have <code>=\"some formula text \" &amp; GetFoo()</code> in a worksheet cell.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 0, "creation_date": 1559790102, "post_id": 56465903, "comment_id": 99531860, "body": "That was an aside. I didn&#39;t know to what extent the answer involved VBA or an Excel formula or some combination of the two. I thinks Matthiew provided the answer -- but thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 0, "creation_date": 1559790691, "post_id": 56465903, "comment_id": 99531948, "body": "@user11388509 feel free to mark Matthieu&#39;s answer as accepted by clicking the check mark to the left."}, {"owner": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 0, "creation_date": 1559791554, "post_id": 56465903, "comment_id": 99532100, "body": "To clarify -- I need to populate a cell with a combination of static text concatenated with a string constant value. The aside was to say that I had found solutions to an issue other than the one I am having, and that they were not what I was looking for. I could not find answers that addressed my specific need."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "edited": false, "score": 0, "creation_date": 1559791789, "post_id": 56465903, "comment_id": 99532134, "body": "It seems like you could use <code>Select Case</code> within a function similar to Matthieu&#39;s to return a constant depending on the input."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1559759061, "last_edit_date": 1559759061, "creation_date": 1559758299, "answer_id": 56465903, "question_id": 56465548, "link": "https://stackoverflow.com/questions/56465548/referencing-public-constants-in-cell-formulas/56465903#56465903", "title": "Referencing Public Constants in Cell Formulas", "body": "<p>I'm confused what you mean by \"I have found multiple references to defining constants from cell values.\" I think you're looking for a VBA solution (?), but just in case you're not, you can just define a name and you're good to go:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zgAGb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zgAGb.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Y9MjD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y9MjD.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11388509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c68da72e78fa3e784dd4654b9be6631e?s=128&d=identicon&r=PG&f=1", "display_name": "user11388509", "link": "https://stackoverflow.com/users/11388509/user11388509"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559759061, "creation_date": 1559756665, "question_id": 56465548, "link": "https://stackoverflow.com/questions/56465548/referencing-public-constants-in-cell-formulas", "title": "Referencing Public Constants in Cell Formulas", "body": "<p>I would like to be able reference a public constant in a cell formula. I have found multiple references to <strong>defining constants</strong> <em>from</em> cell values, but not for using constants in formulas. </p>\n\n<p>I would like to be able do something like this (I know that this is not the right syntax, but you get the idea...)</p>\n\n<pre><code>=\"Some formula text \" &amp; myPublicConstantName\n</code></pre>\n\n<p>Ideas?</p>\n\n<p>Thank!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559761461, "post_id": 56465432, "comment_id": 99524482, "body": "The categories already exist so I shouldn&#39;t need to add a new one to the existing category list."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559762427, "post_id": 56465432, "comment_id": 99524905, "body": "My bad - removed.  The answer though is that you need to append each new category to the previous one: &quot;Categories is a delimited string of category names that have been assigned to an Outlook item. This property uses the character specified in the value name, sList, under HKEY_CURRENT_USER\\Control Panel\\International in the Windows registry, as the delimiter for multiple categories. To convert the string of category names to an array of category names, use the Microsoft Visual Basic function Split.&quot;  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.categories\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559762814, "post_id": 56465432, "comment_id": 99525057, "body": "ok, so i&#39;d need to return a string value after each check, then convert/append those strings into an array and then use <code>item.Categories = array</code> to get it to assign to each category?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "edited": false, "score": 0, "creation_date": 1559767444, "post_id": 56467036, "comment_id": 99526993, "body": "So I incorp&#39;d your code and it still isn&#39;t adding multiple categories to one email when there are multiple attachments that meet the criteria. I&#39;ll edit my OP with the new code jic I missed something in translation."}, {"owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "edited": false, "score": 0, "creation_date": 1559768171, "post_id": 56467036, "comment_id": 99527261, "body": "also found this: <a href=\"https://stackoverflow.com/a/39781815/8478902\">stackoverflow.com/a/39781815/8478902</a>, however changing the <code>SEP</code> to <code>;</code> seems to break the script when I test it"}, {"owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "edited": false, "score": 0, "creation_date": 1559768877, "post_id": 56467036, "comment_id": 99527509, "body": "When I debug the code, it only looks at the first attachment and then doesn&#39;t iterate through the remaining."}, {"owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "edited": false, "score": 0, "creation_date": 1559769305, "post_id": 56467036, "comment_id": 99527681, "body": "Figured it out, my <code>for</code> statement had an error, I exited out before it would iterate through each attachment. Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1559763961, "creation_date": 1559763961, "answer_id": 56467036, "question_id": 56465432, "link": "https://stackoverflow.com/questions/56465432/how-to-categorize-multiple-attachments-of-different-file-types-or-criteria/56467036#56467036", "title": "How to categorize multiple attachments of different file types or criteria", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.categories\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.categories</a></p>\n\n<blockquote>\n  <p>Categories is a delimited string of category names that have been\n  assigned to an Outlook item. This property uses the character\n  specified in the value name, sList, under HKEY_CURRENT_USER\\Control\n  Panel\\International in the Windows registry, as the delimiter for\n  multiple categories. To convert the string of category names to an\n  array of category names, use the Microsoft Visual Basic function Split</p>\n</blockquote>\n\n<p>So something like this (untested):</p>\n\n<pre><code>Sub Tester()\n\n    Dim olkAtt As Outlook.Attachment, attName As String\n\n    '...\n    '...\n\n    'Check each attachment\n    For Each olkAtt In Item.Attachments\n\n        attName = LCase(olkAtt.Filename)\n\n        If Right(attName, 4) = \".dwg\" Or Right(attName, 4) = \".dxf\" Or _\n           Right(attName, 5) = \".xlsx\" Then\n\n           AddCategory Item, \"Native Files\"\n        ElseIf Right(attName, 4) = \".jpg\" Then\n            AddCategory Item, \"Photos\"\n        ElseIf InStr(0, attName, \"RFI\") &lt;&gt; 0 Then\n            AddCategory Item, \"RFI/DCN/FCN\"\n        End If\n        'Exit For  '???\n    Next\n    Set olkAtt = Nothing\nEnd Sub\n\n'add a category to an item if it doesn't already exist\nSub AddCategory(itm, cat)\n    Const SEP As String = \",\"\n    Dim c, bExists As Boolean\n    If Len(itm.Categories) = 0 Then\n        itm.Categories = cat\n        itm.Save\n    Else\n        arr = Split(itm.Categories, SEP)\n        For Each c In arr\n            If c = cat Then\n                bExists = True\n                Exit For\n            End If\n        Next c\n        If Not bExists Then\n            itm.Categories = Join(arr, SEP) &amp; SEP &amp; cat 'add if not present\n            itm.Save\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8478902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-az1yZeU4Krc/AAAAAAAAAAI/AAAAAAAAAlw/6vNrGdZOGvU/photo.jpg?sz=128", "display_name": "Jesse Therrien", "link": "https://stackoverflow.com/users/8478902/jesse-therrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56467036, "answer_count": 1, "score": 0, "last_activity_date": 1559769339, "creation_date": 1559756090, "last_edit_date": 1559769339, "question_id": 56465432, "link": "https://stackoverflow.com/questions/56465432/how-to-categorize-multiple-attachments-of-different-file-types-or-criteria", "title": "How to categorize multiple attachments of different file types or criteria", "body": "<p>I am looking to automate some of my email filing and one thing I am running into is that when, for example, a \".dwg\" file is found first and a \".jpg\" is attached as well, it only categorizes my email by \"Native Files\" and doesn't also categorize it as \"Photos\".</p>\n\n<pre><code>    Dim olkAtt As Outlook.Attachment\n    'Check each attachment\n    For Each olkAtt In item.Attachments\n        'If the attachments file name ends with .dwg\n        If Right(LCase(olkAtt.FileName), 4) = \".dwg\" Then\n            'Categorize email\n            item.Categories = \"Native Files\"\n            item.Save\n\n        'If the attachments file name ends with .dxf\n        ElseIf Right(LCase(olkAtt.FileName), 4) = \".dxf\" Then\n            'Categorize email\n            item.Categories = \"Native Files\"\n            item.Save\n\n        'If the attachments file name ends with .jpg\n        ElseIf Right(LCase(olkAtt.FileName), 4) = \".jpg\" Then\n            'Categorize email\n            item.Categories = \"Photos\"\n            item.Save\n\n        'If the attachments file name ends with .xlsx\n        ElseIf Right(LCase(olkAtt.FileName), 5) = \".xlsx\" Then\n            'Categorize email\n            item.Categories = \"Native Files\"\n            item.Save\n\n        ElseIf InStr(0, LCase(olkAtt.FileName), \"RFI\") &lt;&gt; 0 Then\n            'Categorize email\n            item.Categories = \"RFI/DCN/FCN\"\n            item.Save\n\n            End If\n    Exit For\n    Next\n    Set olkAtt = Nothing\nEnd Sub\n\n</code></pre>\n\n<p>I thought this would look at each attachment, run through the if statements and then categorize the email per attachment (I want emails to have multiple categories if there are multiple cases of files).</p>\n\n<p>Any and all help is appreciated.</p>\n\n<p>EDIT:</p>\n\n<p>After some help from Tim, here's the updated code:</p>\n\n<pre><code>Sub Categorize_Emails(item As Outlook.MailItem)\n    Dim olkAtt As Outlook.Attachment, attName As String\n    'Check each attachment\n    For Each olkAtt In item.Attachments\n\n    attName = LCase(olkAtt.FileName)\n        'If the attachment is an RFI or DCN or FCN\n        If InStr(LCase(attName), \"rfi\") &lt;&gt; 0 Or InStr(LCase(attName), \"dcn\") &lt;&gt; 0 Or InStr(LCase(attName), \"fcn\") &lt;&gt; 0 Then\n            'Categorize email\n            AddCategory item, \"RFI/DCN/FCN\"\n\n        'If the attachments file name ends with .jpg\n        ElseIf Right(LCase(olkAtt.FileName), 4) = \".jpg\" Then\n            'Categorize email\n            AddCategory item, \"Photos\"\n\n        'If the attachments file name ends with .dwg or .dxf or .xlsx\n        ElseIf Right(LCase(olkAtt.FileName), 4) = \".dwg\" Or Right(LCase(olkAtt.FileName), 4) = \".dxf\" Or Right(LCase(olkAtt.FileName), 5) = \".xlsx\" Then\n            'Categorize email\n            AddCategory item, \"Native Files\"\n\n            End If\n\n    Next olkAtt\n    Set olkAtt = Nothing\nEnd Sub\n\n\n'add a category to an item if it doesn't already exist\nSub AddCategory(itm, cat)\n    Const SEP As String = \";\"\n    Dim c, bExists As Boolean\n    If Len(itm.Categories) = 0 Then\n        itm.Categories = cat\n        itm.Save\n    Else\n        arr = Split(itm.Categories, SEP)\n        For Each c In arr\n            If c = cat Then\n                bExists = True\n                Exit For\n            End If\n        Next c\n        If Not bExists Then\n            itm.Categories = Join(arr, SEP) &amp; SEP &amp; cat 'add if not present\n            itm.Save\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "excel", "vba", "web-scraping", "drop-down-menu"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1559756235, "post_id": 56465123, "comment_id": 99522388, "body": "&quot;<i>Until now I did it with [...] but now it does not work for me</i>&quot;... can you please be more specific? What was working before and it&#39;s not working now exactly? As a side note, if you could copy-paste the HTML code instead of a screenshot it would be probably better."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1559756380, "post_id": 56465123, "comment_id": 99522439, "body": "Also, if you explain where you really want to go, there&#39;s probably a better solution than robotically scrolling down a dropdown menu."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559769712, "post_id": 56465123, "comment_id": 99527831, "body": "please share the url if possible"}, {"owner": {"reputation": 19, "user_id": 10316757, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iPwREIdQuqs/AAAAAAAAAAI/AAAAAAAACAs/Js_nnPAGVYE/photo.jpg?sz=128", "display_name": "Rebeca B.", "link": "https://stackoverflow.com/users/10316757/rebeca-b"}, "edited": false, "score": 0, "creation_date": 1559831246, "post_id": 56465123, "comment_id": 99549877, "body": "When I click in &quot;Generar&quot;, it opens a window where I have to fill a form, before I did it with bot.ExecuteScript (&quot;on_load_form(&#39;v_aux_presupuesto.php&#39;,&#39;&#39;,false,false,false,&zwnj;&#8203;false,&#39;app&#39;);&quot;) but it does not work right now. I can not share the url because it is private (user and password)"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1559769907, "creation_date": 1559769907, "answer_id": 56468224, "question_id": 56465123, "link": "https://stackoverflow.com/questions/56465123/how-to-scroll-through-a-drop-down-menu-with-selenium-webdriver-in-excel-vba/56468224#56468224", "title": "How to scroll through a drop-down menu with Selenium Webdriver in Excel VBA", "body": "<p>I would use a css <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors\" rel=\"nofollow noreferrer\">attribute = value selector</a> to get the parent element then descendant combinator to get the child <code>a</code> tag for click</p>\n\n<pre><code>bot.FindElementByCss(\"[data-title='Generar un presupuesto'] a\").Click\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10316757, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iPwREIdQuqs/AAAAAAAAAAI/AAAAAAAACAs/Js_nnPAGVYE/photo.jpg?sz=128", "display_name": "Rebeca B.", "link": "https://stackoverflow.com/users/10316757/rebeca-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1565931169, "creation_date": 1559754745, "last_edit_date": 1565931169, "question_id": 56465123, "link": "https://stackoverflow.com/questions/56465123/how-to-scroll-through-a-drop-down-menu-with-selenium-webdriver-in-excel-vba", "title": "How to scroll through a drop-down menu with Selenium Webdriver in Excel VBA", "body": "<p>I need to move through this menu until I get to the \"Generate\" option. </p>\n\n<p>I am doing it from Excel VBA. Until now I did it with </p>\n\n<pre><code>bot.ExecuteScript (\"on_load_form('v_aux_presupuesto.php','',false,false,false,false,'app');\")\n</code></pre>\n\n<p>but now it does not work for me. Is there some code to be able to move through the menu to that option? I can not do it in any way ...</p>\n\n<p>Here is the webpage's menu code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9WeF6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9WeF6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1559754858, "post_id": 56465074, "comment_id": 99521838, "body": "If <code>rng1 = Ws.Cells</code>, then <code>rng1.Row</code> is always 1. Perhaps you need to work with the filtered cells (maybe use <code>Range.SpecialCells</code> and <code>xlCellTypeVisible</code>."}, {"owner": {"reputation": 1, "user_id": 10055312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d8e612ec70262ed495d6a67a7910be?s=128&d=identicon&r=PG&f=1", "display_name": "Nablokov", "link": "https://stackoverflow.com/users/10055312/nablokov"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559756695, "post_id": 56465074, "comment_id": 99522535, "body": "Thanks for your comment, this is exactly my question, how to get a kind of output range obtained from the sheet and after filtering and sorting. A kind of (select where order by). Is it clearer ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559758085, "post_id": 56465074, "comment_id": 99523057, "body": "Yep. Maybe take a look at <a href=\"https://stackoverflow.com/questions/43065610/vba-selecting-visible-cells-after-filtering\">this question</a>. That should get you started."}], "owner": {"reputation": 1, "user_id": 10055312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d8e612ec70262ed495d6a67a7910be?s=128&d=identicon&r=PG&f=1", "display_name": "Nablokov", "link": "https://stackoverflow.com/users/10055312/nablokov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559754868, "creation_date": 1559754504, "last_edit_date": 1559754868, "question_id": 56465074, "link": "https://stackoverflow.com/questions/56465074/vba-how-to-get-range-filtered-and-sorted-in-a-userform", "title": "VBA How to get range filtered and sorted in a userform", "body": "<p>I am new on VBA and this is my problem :</p>\n\n<pre><code>Sheet \nA          B                C\nTOTO       300              Keep\nJOHN       200              Keep          \nJOHN       100              Keep\nROBERTO    300  \n</code></pre>\n\n<p>The goal is to get this range in the userform to create checkbox and textbox for each row after a filter on C = Keep and sort by A and B.</p>\n\n<p>I have tried this but the number of rows is still zero:</p>\n\n<pre><code>Set rng1 = Ws.Cells\n\nrng1.AutoFilter Field:=3, Criteria1:=\"Keep\"\nrng1.Sort Key1:=Range(\"A1\"), Order1:=xlAscending, key2:=Range(\"B1\"), order2:=xlAscending\nFor i = 1 To rng1.Row (always zero!)\n        Set Obj = UserForm1.Controls.Add(\"forms.textbox.1\")...  \n        Set Obj = UserForm1.Controls.Add(\"forms.checkbox.1\")...\nNext\n</code></pre>\n\n<p>Thanks by advance for any help</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1559754445, "post_id": 56464968, "comment_id": 99521657, "body": "If you attempt to re-format a cell containing a date and the cell resists, then the cell contains a <b>text string</b> rather than a <b>true Excel date</b>.  If this is the case, you will need either a formula or VBA to make the change."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559754562, "post_id": 56464968, "comment_id": 99521710, "body": "When you select a cell with the short date format, does it say date or general in that cell?"}, {"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1559754706, "post_id": 56464968, "comment_id": 99521770, "body": "It says date in the short formatted cell"}, {"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1559755115, "post_id": 56464968, "comment_id": 99521937, "body": "Is there a template of the VBA code to make the change @Gary&#39;sStudent ?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1559755217, "post_id": 56464968, "comment_id": 99521985, "body": "A helper column could solve this. If your bad dates are in the short format shown in column B, this would work: <code>=Date(Right(B2,4),Mid(B2,4,2),Left(B2,2))</code>. Then you could paste values back over the original data."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1559758524, "post_id": 56464968, "comment_id": 99523234, "body": "Where did  the dates come from?  If they came from a text/csv file, then you should go back to that file, and <b>import</b> it rather than <b>open</b>ing it.  When you do that, you will be able specify the date format in the file (eg: DMY).  Excel will then properly convert the dates and you can format them however you wish in Excel."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1559767710, "post_id": 56465259, "comment_id": 99527100, "body": "Thank you again @Gary&#39;s Student"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1559755312, "creation_date": 1559755312, "answer_id": 56465259, "question_id": 56464968, "link": "https://stackoverflow.com/questions/56464968/how-to-change-the-date-format-if-i-am-not-able-to-change-it/56465259#56465259", "title": "How to change the date format if i am not able to change it?", "body": "<p>Select the cells that resist format change and run this short VBA macro:</p>\n\n<pre><code>Sub DateFixer()\n    Dim cell As Range\n    Dim v As String, d As Date\n\n    For Each cell In Selection\n        v = cell.Text\n        If InStr(1, v, \"/\") &lt;&gt; 0 Then\n            arr = Split(v, \"/\")\n            d = DateSerial(arr(2), arr(1), arr(0))\n            cell.Clear\n            cell.Value = d\n            cell.NumberFormat = \"dddd,mmmm,dd,yyyy\"\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TPfXF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TPfXF.png\" alt=\"enter image description here\"></a></p>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kuCTn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kuCTn.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1559767689, "post_id": 56465657, "comment_id": 99527094, "body": "Thank you. I appreciate it @GMalc"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1559757107, "creation_date": 1559757107, "answer_id": 56465657, "question_id": 56464968, "link": "https://stackoverflow.com/questions/56464968/how-to-change-the-date-format-if-i-am-not-able-to-change-it/56465657#56465657", "title": "How to change the date format if i am not able to change it?", "body": "<p>Another option to @Gary'sStudent answer is to use CDate. As Gary states, only select the cells that resist the Date format, if you select the cells that are formatted correctly, you will receive an error. </p>\n\n<pre><code>Dim cel As Range\n    For Each cel In Selection\n        cel.Value = CDate(cel.Value)\n        cel.NumberFormat = \"dddd,mmmm/dd/yyyy\"\n    Next cel\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559757107, "creation_date": 1559754083, "question_id": 56464968, "link": "https://stackoverflow.com/questions/56464968/how-to-change-the-date-format-if-i-am-not-able-to-change-it", "title": "How to change the date format if i am not able to change it?", "body": "<p><a href=\"https://i.stack.imgur.com/AVPDL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AVPDL.png\" alt=\"enter image description here\"></a>Hello, </p>\n\n<p>Here is an image of my column I. I have some dates that are in the long format (example: Wednesday, June 12, 2019) and others that are in the short format (13/02/2017).</p>\n\n<p>I want all the dates to be formatted as the yellow cells (in the long format) but i am not able to change the format. When i try to change the format nothing happens. </p>\n\n<p>PS: If that helped i had to do some previous work with this sheet in which i went to Data --> text to column -->  and i selected date and a format dd/mm/yy for that step. But it seems that after doing that step, i am not able to coome back to any other format. </p>\n\n<p>Please let me know if you have any ideas about fixing this issue. </p>\n\n<p>Thanks :) </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559753442, "post_id": 56464825, "comment_id": 99521252, "body": "Can you share the <code>getAvgStockData</code> code as well? Also, if you comment out or remove <code>On Error Resume Next</code>, what error occurs, if any?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559753635, "post_id": 56464825, "comment_id": 99521300, "body": "If you are passing strings, this is unlikely to be a string, because is an entire row (or more depending on <code>tickerSymbol</code> value) <code>companySymbols.Rows(tickerSymbol.cellvalue)</code> (or the other one). You mean to pass only <code>Call getAvgStockData(tickerSymbol.cellvalue, exchangeSymbol.cellvalue)</code> instead? Would probably be good to know what <code>tickerSymbol</code> or <code>exchangeSymbol</code> are too."}, {"owner": {"reputation": 31, "user_id": 3242388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01124b3f33f0674741add0c1eef90937?s=128&d=identicon&r=PG&f=1", "display_name": "SammyC", "link": "https://stackoverflow.com/users/3242388/sammyc"}, "edited": false, "score": 0, "creation_date": 1559753659, "post_id": 56464825, "comment_id": 99521309, "body": "Thanks Ben, I commented out the &quot;ON Error...&quot; part and i get a runtime error on at the Call command saying Object Required."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1559753782, "post_id": 56464825, "comment_id": 99521357, "body": "And what range does <code>companyRange</code> represent?"}, {"owner": {"reputation": 31, "user_id": 3242388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01124b3f33f0674741add0c1eef90937?s=128&d=identicon&r=PG&f=1", "display_name": "SammyC", "link": "https://stackoverflow.com/users/3242388/sammyc"}, "edited": false, "score": 0, "creation_date": 1559753908, "post_id": 56464825, "comment_id": 99521403, "body": "the range is a table of company data that is mostly populated using the getAvgStockData() sub."}, {"owner": {"reputation": 31, "user_id": 3242388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01124b3f33f0674741add0c1eef90937?s=128&d=identicon&r=PG&f=1", "display_name": "SammyC", "link": "https://stackoverflow.com/users/3242388/sammyc"}, "edited": false, "score": 0, "creation_date": 1559754061, "post_id": 56464825, "comment_id": 99521479, "body": "i think i might just be getting mixed up on the syntax to read data from column row by row and to pass that value to another sub."}], "owner": {"reputation": 31, "user_id": 3242388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01124b3f33f0674741add0c1eef90937?s=128&d=identicon&r=PG&f=1", "display_name": "SammyC", "link": "https://stackoverflow.com/users/3242388/sammyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559753375, "creation_date": 1559753318, "last_edit_date": 1559753375, "question_id": 56464825, "link": "https://stackoverflow.com/questions/56464825/call-function-in-for-loop-is-not-passing-values", "title": "Call function in for loop is not passing values", "body": "<p>I am creating a sub that passes 2 values to another sub named \"getAvgStockData(ticker, exchange)\" that pulls data from the web regarding a companies historical prices and calculates a moving average.</p>\n\n<p>The sub I a working on reads the data from a table row by row to pass 2 strings to getAvgStockData(ticker,symbol) which pulls the data and does the calculation.</p>\n\n<p>For some reason not able to pass the 2 strings using the below code, any ideas? Thank you in advance!!!</p>\n\n<pre><code>Sub getAllAvgStockData()\n\n On Error Resume Next\n    Application.ScreenUpdating = False\n\n    Dim companySymbols As Range\n\n    Set companySymbols = Worksheets(\"ALL Public Companies\").Range(\"companyRange\")\n\n    For Each Row In companySymbols.Rows\n       Call getAvgStockData(companySymbols.Rows(tickerSymbol.cellvalue), \n         companySymbols.Rows(exchangeSymbol.cellvalue))         \n    Next Row\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The code should loop through the whole range of companies in a dynamic range table.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559752216, "post_id": 56464363, "comment_id": 99520706, "body": "Please provide sample data and expected results.  As is, it still sounds like a vlookup will work."}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559753806, "post_id": 56464363, "comment_id": 99521363, "body": "I placed a sample @tigeravatar"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559754634, "post_id": 56464363, "comment_id": 99521738, "body": "The images don&#39;t provide where the cells are (row/column are left out).  It also only shows a single person, so there would be no need to loop.  Lastly it doesn&#39;t show any way to look up <code>Sean Conlon</code> against the list shown in the sample data because <code>Sean Conlon</code> is not in the sample data.  If the email can be generated based off the name using a rule (like first initial + last name + @iadvancenow.com) then we can use it to perform the lookup, however it would be much easier if the data contains the name we want to look up.  Basically, there&#39;s still not enough information to effectively help."}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559754650, "post_id": 56464363, "comment_id": 99521746, "body": "updated question @dwirony"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559754798, "post_id": 56464363, "comment_id": 99521816, "body": "What do i need to add or do @tigeravatar"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559755469, "post_id": 56464363, "comment_id": 99522086, "body": "Add new screenshots that are more representative.  I&#39;m certain the seating chart has more than one entry, but it&#39;s not possible to know the pattern from what you&#39;ve shown.  Are all of the seats in the same column? Are there multiple seats in the same row?  A larger screenshot will be very helpful with this.  Make sure the screenshots (for both worksheets) include row/column labels so we know where the data is.  For the sample data, is there simply not a name column?  Can we actually use a rule like I described to generate an email address based off the name only?"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559756184, "post_id": 56464363, "comment_id": 99522362, "body": "@tigeravatar the only problem is that some of the information is confidential so I have blank out some spots"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559756527, "post_id": 56464363, "comment_id": 99522478, "body": "That&#39;s fine, we only need <i>sample</i> data that is representative of what you&#39;re working with, not the actual data.  Feel free to copy the layout to different sheets and replace anything confidential with fake stuff, like <code>name1</code>, <code>name2</code>, etc."}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559756839, "post_id": 56464363, "comment_id": 99522593, "body": "I edited it. @tigeravatar also this sheet ha to be completely automated so my boss could use it that&#39;s why I keep the emails the same. Like i said before the data will always be updated and the emails might shift in the column."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559757088, "post_id": 56464363, "comment_id": 99522685, "body": "For the seating chart, are the names only on row 82?  Are the names next to each other every 3 columns as shown?  Do they start on column W?  Is the suggested rule for generating the email address from the name valid?  Do you need the result from column <code>H</code> of your data sheet one row below the name, and the result from column <code>I</code> two rows below the name?"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559757745, "post_id": 56464363, "comment_id": 99522915, "body": "@tigeravatar the large seating chart I showed you is from an old file but on my actual seating chart it in rows 25, 44, 65, 82, 101, 120, 139. and the columns are merged so it is BC, EF, IJ, PQ, ST, WX, ZAA and the results from column H should be 14 cells below the first name and I would be 15 cells so Sean Conlon has row 82, so results from H should be in 96 and I in 97"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559757812, "post_id": 56464363, "comment_id": 99522943, "body": "so the names are on the rows listed and the columns given @tigeravatar"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759086, "post_id": 56465995, "comment_id": 99523474, "body": "@tirgeravatar is their anything I need to change"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759191, "post_id": 56465995, "comment_id": 99523521, "body": "@OmarAljonubi Only if your data isn&#39;t setup as you&#39;ve described, or if we can&#39;t generate the email based off the name as suggested, or the sheetnames need to be changed.  I&#39;ve tried to make it as easy as possible to modify.  Does it not return the expected results properly?"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759508, "post_id": 56465995, "comment_id": 99523672, "body": "No, it&#39;s not working, but I don&#39;t understand what you mean by the name suggestion. Also, Sheet2 is not the actual place I need it to be sheet is called &quot;two&quot; but I only made a new sheet because if it works there then I will change the sheet name my self @tigeravatar"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759555, "post_id": 56465995, "comment_id": 99523686, "body": "And I would like to tell you now thank you for the help you have been giving me so far, and I hope we could figure this out @tigeravatar"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759705, "post_id": 56465995, "comment_id": 99523746, "body": "@OmarAljonubi On your seating chart, you only have a name, like <code>Sean Conlon</code>, but in your data table, you only have an email address, like <code>sconlon@iadvancenow.com</code>.  That means we have to generate the email address based on the name.  I have been asking if we could use a standard rule to do so, which is <code>first letter of first name + last name + @iadvancenow.com</code>.  If that rule doesn&#39;t generate the correct email address, the code will not provide correct results.  Is there somewhere on the seating chart that has the actual email address we can use?  Or can you put the name in your data table?"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759794, "post_id": 56465995, "comment_id": 99523782, "body": "I will put the email in the seating Chart @tigeravatar"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559759849, "post_id": 56465995, "comment_id": 99523798, "body": "@OmarAljonubi where will the email address be located? One row below the name?"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559761042, "post_id": 56465995, "comment_id": 99524318, "body": "/Users/pricewinner/Desktop/Screen Shot 2019-06-05 at 2.57.06 PM.png"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559761109, "post_id": 56465995, "comment_id": 99524352, "body": "sEmail = Application.Trim(wsDest.Cells(vRow, vCol).Value)             If Len(sEmail) &gt; 0 Then                 sEmail = Left(sEmail, 1) &amp; Split(sEmail, &quot; &quot;)(1) &amp; &quot;@iadvancenow.com&quot;                 For i = 2 To 3                     vResult = Application.VLookup(sEmail, wsData.Range(&quot;G:I&quot;), i, False)"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559761151, "post_id": 56465995, "comment_id": 99524365, "body": "The sEmail....&quot;iadvancenow.com&quot; has a bug in ti @tigeravatar"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559761252, "post_id": 56465995, "comment_id": 99524414, "body": "I will replace the name of the person with their email and add a row above the email for the name"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559761329, "post_id": 56465995, "comment_id": 99524436, "body": "@OmarAljonubi If you are trying to add an image, please edit your question and put the image there, comments can&#39;t have images uploaded to them.  The purpose of the lines of code you&#39;ve quoted is to generate the email address off of a name in the format of <code>firstname lastname</code>.  Because you&#39;re replacing that with the email address, there&#39;s no need to do additional processing.  You can simply delete that line."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559761388, "post_id": 56465995, "comment_id": 99524459, "body": "@OmarAljonubi If adding the row above the email changes the rows where the email addresses are located on the Seating Chart sheet, be sure to update the row numbers in the <code>aSeatingRows</code> array."}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559762578, "post_id": 56465995, "comment_id": 99524963, "body": "I&#39;m running into another problem @tigeravatar I posted it on my question"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559762858, "post_id": 56465995, "comment_id": 99525084, "body": "It worked well for some people but not every one"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559762909, "post_id": 56465995, "comment_id": 99525109, "body": "@OmarAljonubi You&#39;ve posted a screenshot of a line of code that&#39;s highlighted, which probably means you got an error.  If you hover over the each variable, it show show their values.  Make sure each variable has a value.  My guess is that it&#39;s a problem due to merged cells.  My first suggestion is to never, ever used merged cells.  They&#39;re always unnecessary.  If you really need the effect, instead use <a href=\"https://exceljet.net/lessons/how-to-use-center-across-selection-in-excel\" rel=\"nofollow noreferrer\">Center Across Selection</a>."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559763072, "post_id": 56465995, "comment_id": 99525171, "body": "@OmarAljonubi I&#39;m also guessing you didn&#39;t actually update the row values in the <code>aSeatingRows</code> array.  You likely added rows to include the email addresses which changed which rows the code should be looking at.  You need to update that array so that it has the new, correct values."}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559763298, "post_id": 56465995, "comment_id": 99525247, "body": "I have only replaced the name with the email. I have not added any rows yet"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559764375, "post_id": 56465995, "comment_id": 99525672, "body": "Never Mind Bro It worked perfectly thank you very much for you help @tigeravatar"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1559758725, "creation_date": 1559758725, "answer_id": 56465995, "question_id": 56464363, "link": "https://stackoverflow.com/questions/56464363/taking-data-in-a-row-from-and-placing-it-into-a-different-sheet-in-column-form/56465995#56465995", "title": "Taking data in a row from and placing it into a different sheet in column form. Data is only moved if the person who has the data, name is listed", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Worksheets(\"three\")\n    Set wsDest = wb.Worksheets(\"Sheet2\")\n\n    Dim aSeatingRows As Variant\n    aSeatingRows = Array(25, 44, 65, 82, 101, 120, 139)\n\n    Dim aSeatingCols As Variant\n    aSeatingCols = Array(\"B\", \"E\", \"I\", \"P\", \"S\", \"W\", \"Z\")\n\n    Dim vResult As Variant\n    Dim sEmail As String\n    Dim vRow As Variant\n    Dim vCol As Variant\n    Dim i As Long\n\n    For Each vRow In aSeatingRows\n        For Each vCol In aSeatingCols\n            sEmail = Application.Trim(wsDest.Cells(vRow, vCol).Value)\n            If Len(sEmail) &gt; 0 Then\n                sEmail = Left(sEmail, 1) &amp; Split(sEmail, \" \")(1) &amp; \"@iadvancenow.com\"\n                For i = 2 To 3\n                    vResult = Application.VLookup(sEmail, wsData.Range(\"G:I\"), i, False)\n                    If IsError(vResult) Then\n                        wsDest.Cells(vRow + i + 12, vCol).ClearContents\n                    Else\n                        wsDest.Cells(vRow + i + 12, vCol).Value = vResult\n                    End If\n                Next i\n            Else\n                wsDest.Cells(vRow + 14, vCol).Resize(2).ClearContents\n            End If\n        Next vCol\n    Next vRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1559959963, "accepted_answer_id": 56465995, "answer_count": 1, "score": -2, "last_activity_date": 1559762522, "creation_date": 1559751397, "last_edit_date": 1559762522, "question_id": 56464363, "link": "https://stackoverflow.com/questions/56464363/taking-data-in-a-row-from-and-placing-it-into-a-different-sheet-in-column-form", "closed_reason": "Duplicate", "title": "Taking data in a row from and placing it into a different sheet in column form. Data is only moved if the person who has the data, name is listed", "body": "<p>I have consolidated data that contains how well a person is doing at work. it has a personal email and 2 rows of data to the right. on another sheet, I created a birds-eye view of a seating chart and now I need to place the data where the person is seating (in column form like B4 and C4 for example). My data, for example, is the person's email in cell A1 and their data is in B1 and C1. Now another problem is that the actual data comes from a website so the data will be constantly updated. so that means a person data will change or will not come up at all. Although, maybe a new person might bring in data. That means a new email and new data of course.  </p>\n\n<p>I tried using an IF statement it that went south</p>\n\n<pre><code>Sub button()\n\n     With Worksheets(\"three\").Range(\"G1\")\n\n        If .Value = \"sconlon@iadvancenow.com\" Then\n\n            Worksheets(\"Sheet2\").Range(\"C3\") = .Offset(0, 1).Value\n            Worksheets(\"Sheet2\").Range(\"D3\") = .Offset(0, 2).Value\n\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This is what should happen at the end when everything works out. the Consolidated data will be moved to another sheet (the seating chart) and under the person's name is their data. so the data that was consolidated will be placed there. Now the data will be updated so a person's data will change and there will be people who didn't have data before will have or will not have data now.</p>\n\n<p>The data\n<a href=\"https://i.stack.imgur.com/S1BaN.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>The seating chart<a href=\"https://i.stack.imgur.com/iHNmc.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>And this is a large picture of the seating chart but this is an old one but it is similar to what I have now, but the last picture of the two names is from my actual sheet </p>\n\n<p>problem im having now\n<a href=\"https://i.stack.imgur.com/IsWAX.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 3, "creation_date": 1559752299, "post_id": 56464264, "comment_id": 99520751, "body": "Why a hyperlink? The hyperlink doesn&#39;t actually act like a hyperlink but rather acts like a button? Why not hitch your VBA code to the Worksheet DoubleClick event instead? Or stick a button in there? Or use Worksheet_SelectionChange(). Hyperlink seems like an odd event to attach to."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 3159184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5682d97d4c36025736f4c37cb0a9d12?s=128&d=identicon&r=PG&f=1", "display_name": "cfardella", "link": "https://stackoverflow.com/users/3159184/cfardella"}, "is_accepted": false, "score": 0, "last_activity_date": 1559755051, "creation_date": 1559755051, "answer_id": 56465194, "question_id": 56464264, "link": "https://stackoverflow.com/questions/56464264/insert-date-into-another-columns-cell-using-vba/56465194#56465194", "title": "Insert date into another column&#39;s cell using VBA", "body": "<p>I assume that by using HYPERLINK you are using the mailto command to create an email? Either way... you can use the following:</p>\n\n<p>Open VBA and paste the below code in the Sheet Object (e.g. Sheet1(Sheet1)) part of the VBA. Every time in Sheet1 if you click on a cell in column 4 it will put the date in the appropriate row of AD (change as appropriate).</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf ActiveCell.Column = 4 Then\n    Range(\"AD\" &amp; Target.Row).Value = Date\nElse\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is very basic, you could add a check to see that the cell clicked contained a HYPERLINK, or perhaps prompt with a message box confirming the email send and date add.</p>\n"}], "owner": {"reputation": 9, "user_id": 2052648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e992dd3b324472d0b0d5eab0cb478dbb?s=128&d=identicon&r=PG", "display_name": "Nav", "link": "https://stackoverflow.com/users/2052648/nav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1559755051, "creation_date": 1559750949, "last_edit_date": 1559751021, "question_id": 56464264, "link": "https://stackoverflow.com/questions/56464264/insert-date-into-another-columns-cell-using-vba", "title": "Insert date into another column&#39;s cell using VBA", "body": "<p>I am trying to build a hyperlink in Excel. What I want it to essentially do is to send an email (which I have done using a formula as it uses various VLOOKUPs) and also add's today's date into another cell (indicating the date the email was sent).</p>\n\n<p>Each row in column D contains this hyperlink and depending on information on each row a different hyperlink is created. Once the hyperlink is pressed, I want the equivalent's row AD to state today's date. </p>\n\n<p>i.e. if I click the hyperlink in cell D4, AD4 will have an output of today's date (and a create new email window appears).</p>\n\n<p>I am quite new to macro building but what I guess needs to be done is a listener checks to see if a hyperlink is clicked in the column D\nOnce it is clicked, it takes the cell I've clicked into and add the number of columns into it to turn it from D to AD, then output today's date.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1559751205, "post_id": 56464254, "comment_id": 99520184, "body": "Here&#39;s the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.resize\" rel=\"nofollow noreferrer\"><code>Range.Resize</code></a> documentation. The <i>second</i> argument is the <i>ColumnSize</i>."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1559753975, "post_id": 56464254, "comment_id": 99521427, "body": "You need to clarify what you are trying to accomplish. Your code only selects` D4:D8` if <code>A8</code> is changed. If <code>A9</code> is changed it selects <code>D5:D9</code>, etc. Do you always want the range from row 4, or are you trying select the range 4 rows above the current row? That said, to fix your issue change <code>(5)</code> to <code>(,5)</code>, insert a comma before the <code>5</code>."}, {"owner": {"reputation": 11, "user_id": 11605068, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gza9m4-YZss/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSRXwlvZLUmZ5vjr3-yRZbKKGshA/mo/photo.jpg?sz=128", "display_name": "Varsha Dobariya", "link": "https://stackoverflow.com/users/11605068/varsha-dobariya"}, "edited": false, "score": 0, "creation_date": 1559756711, "post_id": 56464254, "comment_id": 99522545, "body": "what i want to accomplish is...if cell A8 changed then select d4:i4 &amp; if a9 changed select d9:i9...like wise...."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1559765618, "post_id": 56464254, "comment_id": 99526195, "body": "Then make the change I suggested."}], "owner": {"reputation": 11, "user_id": 11605068, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gza9m4-YZss/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSRXwlvZLUmZ5vjr3-yRZbKKGshA/mo/photo.jpg?sz=128", "display_name": "Varsha Dobariya", "link": "https://stackoverflow.com/users/11605068/varsha-dobariya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559750945, "creation_date": 1559750923, "last_edit_date": 1559750945, "question_id": 56464254, "link": "https://stackoverflow.com/questions/56464254/i-want-to-make-change-specified-range-in-vba-code", "title": "i want to make Change specified range in vba code", "body": "<p>I have vba coding where range of D4:D8 is selected but i want to get range D4:I4 instead of D4:D8.</p>\n\n<p>the code is given below</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim r As Range\n\n    If Target.Column = 1 And Target.Row &gt; 4 Then\n        Set r = Target.Offset(-4, 3).Resize(5)\n        Worksheets(\"ADP\").Range(r.Address).Value = r.Value\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>any help will be greatly appriciated by word of thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1559751402, "post_id": 56464235, "comment_id": 99520280, "body": "what do you mean by &quot;do not see the data that the form enters&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11604987, "user_type": "registered", "profile_image": "https://graph.facebook.com/922697791409307/picture?type=large", "display_name": "Matthew Ross", "link": "https://stackoverflow.com/users/11604987/matthew-ross"}, "edited": false, "score": 0, "creation_date": 1559768846, "post_id": 56464557, "comment_id": 99527496, "body": "The only thing that confuses me about what is happening is that I have the same code in place for the &quot;Use Material Button&quot; and it works fine..."}, {"owner": {"reputation": 1, "user_id": 11604987, "user_type": "registered", "profile_image": "https://graph.facebook.com/922697791409307/picture?type=large", "display_name": "Matthew Ross", "link": "https://stackoverflow.com/users/11604987/matthew-ross"}, "edited": false, "score": 0, "creation_date": 1559769412, "post_id": 56464557, "comment_id": 99527723, "body": "This did work though. I just don&#39;t understand what the difference was between the two. I am in the process of updating all of those sections to be the same code so maybe they won&#39;t have any issues later. Thank you for the help."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1559758375, "last_edit_date": 1559758375, "creation_date": 1559752132, "answer_id": 56464557, "question_id": 56464235, "link": "https://stackoverflow.com/questions/56464235/update-data-with-userform-textbox/56464557#56464557", "title": "Update data with Userform textbox", "body": "<p>Here's what I suspect is happening: The input <code>TextBox</code>es on your userform contain <code>String</code>. That's all they can ever contain. You're attempting to cast that string as numeric here:</p>\n\n<pre><code>Private Sub Transaction_Qty_Box_AfterUpdate()\n\n    On Error Resume Next\n    Me.Transaction_Qty_Box.Value = CDec(Me.Transaction_Qty_Box.Value)\n\n    'Confirm my suspicions:\n    MsgBox TypeName(Me.Transaction_Qty_Box.Value)\nEnd Sub\n</code></pre>\n\n<p>But then you're passing that <code>Decimal</code> instance back into the <code>TextBox.Value</code>, which implicitly converts it back to <code>String</code>.</p>\n\n<p>So, you've got the right idea, but you're doing it in the wrong place, I think. Try casting here instead:</p>\n\n<pre><code>table_object_row.Range(1, 6).Value = CDec(Me.Transaction_Qty_Box)\n</code></pre>\n\n<p>Note that this is already what you're doing with the <code>Me.DateBox</code>:</p>\n\n<pre><code>table_object_row.Range(1, 1).Value = CDate(Me.Date_Box)\n</code></pre>\n\n<p>You can probably remove the <code>_AfterUpdate</code> event handlers and just dump the textbox values to the sheet. Cast them as needed, and apply formatting directly to the cell if needed.</p>\n"}], "owner": {"reputation": 1, "user_id": 11604987, "user_type": "registered", "profile_image": "https://graph.facebook.com/922697791409307/picture?type=large", "display_name": "Matthew Ross", "link": "https://stackoverflow.com/users/11604987/matthew-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564329116, "creation_date": 1559750823, "last_edit_date": 1564329116, "question_id": 56464235, "link": "https://stackoverflow.com/questions/56464235/update-data-with-userform-textbox", "title": "Update data with Userform textbox", "body": "<p>I have a userform to add or remove inventory from a series of tables.</p>\n\n<p>The issue is when the info from the userform is added to ONLY the \"Received\" table the quantity cell is not acknowledged. It is populated but is not picked up by the table formulas I have in place.</p>\n\n<p>I can got to the table and manually type the quantities in and hit refresh all on the data tab and the quantities update correctly.</p>\n\n<p>I have a pivot table setup on each of these sheets to get the dates of entry, material, and quantity from the \"Received\" table the product that was entered via the userform shows a zero for the quantity.*</p>\n\n<p>I have tried several converters and format changes but I am still not getting results.</p>\n\n<p>Cdbl, Cint, Cdec, Format(), Changed formats in the Excel Table in question</p>\n\n<pre><code>Private Sub Add_Button_Click()\nMsgBox \"Are You Sure You Want To Add To Inventory?\"\nUnload Me\nTransaction_Form.Show\n\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\n\nSet the_sheet = Sheets(\"MATERIALS REC.\")\nSet table_list_object = the_sheet.ListObjects(1)\nSet table_object_row = table_list_object.ListRows.Add\n\ntable_object_row.Range(1, 1).Value = CDate(Me.Date_Box)\ntable_object_row.Range(1, 2).Value = Me.Material_Code_Box\ntable_object_row.Range(1, 4).Value = Me.Transaction_Qty_Box\ntable_object_row.Range(1, 5).Value = Me.Mat_Price_Box\ntable_object_row.Range(1, 6).Value = Me.cboSupplier_List\ntable_object_row.Range(1, 7).Value = Me.Order_Date_Box\n\nEnd Sub\n\n\nPrivate Sub cboSupplier_List_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nHookListBoxScroll Me, cboSupplier_List\nEnd Sub\n\n\nPrivate Sub Date_Box_AfterUpdate()\nOn Error Resume Next\nMe.Date_Box.Value = CDate(Me.Date_Box)\nEnd Sub\n\n\nPrivate Sub Mat_Price_Box_AfterUpdate()\nOn Error Resume Next\nMe.Mat_Price_Box.Value = Format(Me.Mat_Price_Box.Value, \"$####.##\")\nEnd Sub\n\n\nPrivate Sub Material_Code_Box_Change()\nOn Error Resume Next\nMe.Material_Code_Box.Value = StrConv(Me.Material_Code_Box.Value, vbUpperCase)\nEnd Sub\n\nPrivate Sub Next_Button_Click()\nMsgBox \"The Transaction Form Will Be Closed\"\nUnload Me\nEnd Sub\n\n\nPrivate Sub Order_Date_Box_AfterUpdate()\nOn Error Resume Next\nMe.Order_Date_Box.Value = CDate(Me.Order_Date_Box)\nEnd Sub    \n\n\nPrivate Sub Overide_Button_Click()\nMsgBox \"Are You Sure You Want To Overide\"\nrspn = InputBox(\"Enter Password\")\nIf rspn &lt;&gt; \"ENVenv11\" Then\nMsgBox \"Wrong password\"\nEnd If\n\nUnload Me\nTransaction_Form.Show\n\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\n\nSet the_sheet = Sheets(\"MATERIAL USAGE\")\nSet table_list_object = the_sheet.ListObjects(1)\nSet table_object_row = table_list_object.ListRows.Add\n\ntable_object_row.Range(1, 1).Value = Me.Date_Box\ntable_object_row.Range(1, 4).Value = Me.Material_Code_Box\ntable_object_row.Range(1, 6).Value = Me.Transaction_Qty_Box\ntable_object_row.Range(1, 3).Value = Me.Process_Box\ntable_object_row.Range(1, 2).Value = Me.Customer_Box\n\nEnd Sub\n\n\nPrivate Sub Today_Button_Click()\nDate_Box.Value = Date    \nEnd Sub\n\n\nPrivate Sub Transaction_Qty_Box_AfterUpdate()\nOn Error Resume Next\nMe.Transaction_Qty_Box.Value = CDec(Me.Transaction_Qty_Box.Value)\nEnd Sub\n\n\nPrivate Sub Use_Button_Click()\nMsgBox \"Are You Sure You Want To Remove From Inventory\"\nUnload Me\nTransaction_Form.Show\n\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\n\nSet the_sheet = Sheets(\"MATERIAL USAGE\")\nSet table_list_object = the_sheet.ListObjects(1)\nSet table_object_row = table_list_object.ListRows.Add\n\ntable_object_row.Range(1, 1).Value = Me.Date_Box\ntable_object_row.Range(1, 4).Value = Me.Material_Code_Box\ntable_object_row.Range(1, 6).Value = Me.Transaction_Qty_Box\ntable_object_row.Range(1, 3).Value = Me.Process_Box\ntable_object_row.Range(1, 2).Value = Me.Customer_Box\n\nEnd Sub\n\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n'Populate Supplier combo box.\n\nDim rngSupplier As Range\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Lookup_Lists\")\n\nFor Each rngSupplier In ws.Range(\"Suppliers\")\nMe.cboSupplier_List.AddItem rngSupplier.Value\nNext rngSupplier\n\nEnd Sub\n</code></pre>\n\n<p>When the add button is pushed the quantity cell in the Received table is populated. This happens no issues with it putting data in the table.</p>\n\n<p>The issue is the formulas do not see the data that the form enters into that cell. All other cell data populates and can be seen by various other formulas I have used to test it. It is just the quantity cell.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1559761012, "last_edit_date": 1559761012, "creation_date": 1559752384, "answer_id": 56464613, "question_id": 56464221, "link": "https://stackoverflow.com/questions/56464221/how-to-pass-values-from-one-userforms-code-to-another/56464613#56464613", "title": "How to pass values from one Userform&#39;s code to another", "body": "<p>The <code>Initialize</code> handler runs when the <em>instance</em> of the form class is created - and since you're coding against the forms' <em>default instance</em>, you're not controlling when that happens.</p>\n\n<p>The default instance of a class (any class with a <code>VB_PredeclaredId</code> attribute set to <code>True</code> - not just userforms) is created automatically, as soon as it's referenced. In this case, assuming this is the first time this form is referenced in this execution path, that would be here:</p>\n\n<pre><code>With uf_ColSelectA\n</code></pre>\n\n<p>If you put a breakpoint (<kbd>F9</kbd>) immediately after this line, you'll see that the empty message box pops up <em>before</em> execution reaches the <code>.hyperlink_A = hyperlink_A</code> instruction.</p>\n\n<p>If you want to keep using stateful userform default instances, you can do so by moving the code you have in the <code>Initialize</code> handler into the handler for the <code>Activate</code> event -which will be fired whenever the form is <em>activated</em> - since that's a <em>modal</em> form, that makes this chunk of code run whenever you <code>.Show</code> that form.</p>\n\n<pre><code>Private Sub UserForm_Activate()    'uf_ColSelectA\n    With Application.ActiveWindow\n        Me.Left = .Left + (.Width - Me.Width) / 2\n        Me.Top = .Top + (.Height - Me.Height) / 2\n    End With\n\n    MsgBox hyperlink_A \n\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(Filename:=hyperlink_A)\nEnd Sub\n</code></pre>\n\n<p>If you want to take control of how your objects are created (warmly recommend), then you need to <code>New</code> up the classes yourself. So instead of this:</p>\n\n<pre><code>With uf_ColSelectA\n    '...\n    .Show\nEnd With\n</code></pre>\n\n<p>You'll do this:</p>\n\n<pre><code>With New uf_ColSelectA\n    '...\n    .Show\nEnd With\n</code></pre>\n\n<p>See <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> for more details about the traps &amp; caveats of stateful default instances.</p>\n"}], "owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 56464613, "answer_count": 1, "score": 1, "last_activity_date": 1559761012, "creation_date": 1559750778, "question_id": 56464221, "link": "https://stackoverflow.com/questions/56464221/how-to-pass-values-from-one-userforms-code-to-another", "title": "How to pass values from one Userform&#39;s code to another", "body": "<p>I wish for the user to select a value from a column in a worksheet using a combo-box in a userform - from there, the program extracts a value from within that row (specifically, a hyperlink to another workbook). After that, another userform (list box) is supposed to pop up, populated with values from a row in the second workbook.</p>\n\n<p>Currently, the specific thing I'm having a problem with is transferring the hyperlink value (which is a variant) to the second useform's code so it can grab values from the workbook the hyperlink directs to.</p>\n\n<p>I've tried making the hyperlink variable public and I've tried replicating similar operations I found on the internet.</p>\n\n<p>In the first userform's code:</p>\n\n<pre><code>Public hyperlink_A As Variant\n\nPrivate Sub findColumns_button_Click()  'within uf_TestSelector\n    With uf_ColSelectA\n        .hyperlink_A = hyperlink_A\n        .Show\n    End With\n    fillData    'not relevant\nEnd Sub\n</code></pre>\n\n<p>In the second userform's code:</p>\n\n<pre><code>Option Explicit\nPublic mainWorkbook As Workbook\nPublic hyperlink_A As Variant\n\nPrivate Sub UserForm_Initialize()    'uf_ColSelectA\n    With Application.ActiveWindow\n        Me.Left = .Left + (.Width - Me.Width) / 2\n        Me.Top = .Top + (.Height - Me.Height) / 2\n    End With\n\n    MsgBox hyperlink_A  'shows empty MsgBox so hyperlink_A = empty\n                        'MsgBox only for debugging purposes\n\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(Filename:=hyperlink_A)\nEnd Sub\n</code></pre>\n\n<p>I'm expecting MsgBox hyperlink_A to open a MsgBox with the path to the second workbook, currently it's returning an empty MSgBox. The Second userform does show (but obviously empty)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559749546, "post_id": 56463844, "comment_id": 99519336, "body": "I&#39;m not sure I understand your question entirely. Are you just trying to fill column A down to the same row as the last row in column B?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559749623, "post_id": 56463844, "comment_id": 99519376, "body": "Instead of <code>a1048575</code>, use <code>Cells(Rows.Count, 1)</code>."}, {"owner": {"reputation": 141, "user_id": 2901200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/126f6edd8c6cf4843dec1e315c2b50e5?s=128&d=identicon&r=PG&f=1", "display_name": "user101998", "link": "https://stackoverflow.com/users/2901200/user101998"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559749722, "post_id": 56463844, "comment_id": 99519441, "body": "@BigBen I am trying to fill the entire last row of the worksheet, if the result of the fill of column B is nonempty. Column B contains links that are updated routinely."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559749818, "post_id": 56463844, "comment_id": 99519487, "body": "Can you add a sample screenshot maybe? Not sure I follow."}, {"owner": {"reputation": 141, "user_id": 2901200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/126f6edd8c6cf4843dec1e315c2b50e5?s=128&d=identicon&r=PG&f=1", "display_name": "user101998", "link": "https://stackoverflow.com/users/2901200/user101998"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559749944, "post_id": 56463844, "comment_id": 99519552, "body": "@BigBen Can&#39;t access image hosting site in where I&#39;m at. I can add it later. But the idea is that I would like to fill down an entire row, but if column B is empty after filling down, then I don&#39;t want to fill it down. (The fill down are done so that the rest of the code can proceed to do other stuff, using the information on that row. So if column B is empty after filling down, the rest of the code would result in an error)."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559750033, "post_id": 56463844, "comment_id": 99519603, "body": "Ok I think I have a better idea."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1559750195, "post_id": 56463844, "comment_id": 99519706, "body": "<code>While...Wend</code> is deprecated, use <code>Do While...Loop</code> instead. Then if/when you need to break out of the loop, you can do <code>Exit Do</code> instead of <code>GoTo</code>-jumping."}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559891919, "post_id": 56463844, "comment_id": 99568309, "body": "You should try to avoid using select aswell. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "owner": {"reputation": 141, "user_id": 2901200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/126f6edd8c6cf4843dec1e315c2b50e5?s=128&d=identicon&r=PG&f=1", "display_name": "user101998", "link": "https://stackoverflow.com/users/2901200/user101998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559749758, "creation_date": 1559749380, "last_edit_date": 1559749758, "question_id": 56463844, "link": "https://stackoverflow.com/questions/56463844/vba-using-the-value-of-a-filldown-operation-in-the-condition-of-a-while-loop", "title": "VBA - Using the value of a FillDown operation in the condition of a While loop", "body": "<p>I have a worksheet where I want to fill down the entire while the result of column B's fill down is nonempty. Column B contains the links to other workbooks that are updated routinely. Thus if column B is nonempty, I can proceed to the rest of the macro.</p>\n\n<p>In other words, I am trying to fill down column B first, and if it's nonempty, I will fill down the entire row. </p>\n\n<pre><code>While Range(\"b1048575\").End(xlUp).FillDown &lt;&gt; 0\n    Range(\"a1048575\").End(xlUp).offset(0, 200).Select\n    Selection.FillDown\n\nWend\n</code></pre>\n\n<p>However, the condition in the while loop results in the program halting. </p>\n\n<p>I thought of ways where I'd fill down the row anyways and check column B, and if it's empty, delete the row and get out of the loop. </p>\n\n<p>I am wondering if there is a more efficient approach here.</p>\n\n<p>Feel free to critique my code (I don't think the use of a1048575 is very \"professional\").</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1559750351, "post_id": 56463721, "comment_id": 99519787, "body": "try to avoid <code>ActiveCell</code>, <code>Select</code> etc because they cause confusion."}], "tags": [], "owner": {"reputation": 430, "user_id": 8322075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1525dfaae144b4cdc881a33c52e30abd?s=128&d=identicon&r=PG&f=1", "display_name": "taurus", "link": "https://stackoverflow.com/users/8322075/taurus"}, "is_accepted": false, "score": 0, "last_activity_date": 1559748990, "creation_date": 1559748990, "answer_id": 56463721, "question_id": 56463615, "link": "https://stackoverflow.com/questions/56463615/vba-get-row-and-column-index-of-cell-clicked-to-open-userbox-in-excel-2016/56463721#56463721", "title": "VBA Get Row and Column Index of Cell Clicked to Open UserBox in Excel 2016", "body": "<p>I figured this out. I can simply call <code>ActiveCell.Row</code> and <code>ActiveCell.Column</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 2, "last_activity_date": 1559750289, "creation_date": 1559750289, "answer_id": 56464095, "question_id": 56463615, "link": "https://stackoverflow.com/questions/56463615/vba-get-row-and-column-index-of-cell-clicked-to-open-userbox-in-excel-2016/56464095#56464095", "title": "VBA Get Row and Column Index of Cell Clicked to Open UserBox in Excel 2016", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Dim Column As Long, Row As Long\n\n    Column = Target.Column\n    Row = Target.Row\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 430, "user_id": 8322075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1525dfaae144b4cdc881a33c52e30abd?s=128&d=identicon&r=PG&f=1", "display_name": "taurus", "link": "https://stackoverflow.com/users/8322075/taurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 56464095, "answer_count": 2, "score": 0, "last_activity_date": 1559751859, "creation_date": 1559748641, "last_edit_date": 1559751859, "question_id": 56463615, "link": "https://stackoverflow.com/questions/56463615/vba-get-row-and-column-index-of-cell-clicked-to-open-userbox-in-excel-2016", "title": "VBA Get Row and Column Index of Cell Clicked to Open UserBox in Excel 2016", "body": "<p>I have defined a UserBox which opens on the double click of cells within a specified range. I do this with simple intersection checking in <code>Worksheet_BeforeDoubleClick()</code>. I have a row of header tags in my sheet and I want a label within the opened UserBox to display \"Opened with X\" where X is the header of the column the cell is in. For example, if cell C9 is double clicked, I want to to display the text of the header located in cell C2. I know how to apply the contents of an arbitrary cell to a label within the UserBox, but I'm not sure how to extract the row and column of the cell that was clicked.</p>\n"}, {"tags": ["vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1559751433, "post_id": 56463542, "comment_id": 99520300, "body": "You&#39;d first need to save the document as docx. You&#39;re telling Outlook to pick up the file ( <code>ActiveDocument.FullName</code>) - there&#39;s no way Outlook can make the conversion. In order to save the file as a docx, the macro code do perform these actions needs to be stored somewhere else. Best would probably be to save this docm as a dotm (a template) then create a new document from it each time you want to use it. The macro will be in the template and the document created from the template will be a docx by default. So then this code would work as you wish."}, {"owner": {"reputation": 13, "user_id": 4430280, "user_type": "registered", "profile_image": "https://graph.facebook.com/661156020/picture?type=large", "display_name": "Scott Law", "link": "https://stackoverflow.com/users/4430280/scott-law"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1559906193, "post_id": 56463542, "comment_id": 99575238, "body": "Thanks Cindy, how i&#39;ve done it"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1559870597, "creation_date": 1559870597, "answer_id": 56486893, "question_id": 56463542, "link": "https://stackoverflow.com/questions/56463542/is-there-a-way-to-convert-the-active-document-format-docm-to-a-docx-when-attac/56486893#56486893", "title": "Is there a way to convert the active document format (docm) to a docx when attaching it to an email in outlook", "body": "<p>If you add the code to the document's template instead of to the document itself, the document can be kept in the docx format throughout.</p>\n"}], "owner": {"reputation": 13, "user_id": 4430280, "user_type": "registered", "profile_image": "https://graph.facebook.com/661156020/picture?type=large", "display_name": "Scott Law", "link": "https://stackoverflow.com/users/4430280/scott-law"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 56486893, "answer_count": 1, "score": 0, "last_activity_date": 1559870597, "creation_date": 1559748364, "last_edit_date": 1559751155, "question_id": 56463542, "link": "https://stackoverflow.com/questions/56463542/is-there-a-way-to-convert-the-active-document-format-docm-to-a-docx-when-attac", "title": "Is there a way to convert the active document format (docm) to a docx when attaching it to an email in outlook", "body": "<p>I've set up a form that fills out the active document. Obviously this document is macro enabled because i'm using VBA. Once form is completed and submitted it will attach the active document to an outlook email. My IT team doesn't allow macro enabled documents to be sent over our systems so the email wont be allowed to send with a .docm attachment</p>\n\n<p>I've tried to convert the document myself, but i'm not very savvy with VBA in this regard.</p>\n\n<p>This is the code I have so far.</p>\n\n<pre><code>Private Sub OpenEmailAndAttach()\n    Dim olkApp As Object\n    Dim strSubject As String\n    Dim strTo As String\n    Dim strBody As String\n    Dim strAtt As String\n\n    strSubject = \"Expenditure Approval Request\"\n    strBody = \"Hi, \" &amp; Chr(10) &amp; Chr(10) &amp; \"Please could I request approval RE: works\" &amp; Chr(10) &amp; Chr(10) &amp; \"EAF is attached\" &amp; Chr(10) &amp; Chr(10) &amp; \"Regards, \" &amp; Chr(10) &amp; \"Name\"\n    strTo = \"email@email.com\"\n\n    strAtt = ActiveDocument.FullName\n\n    Set olkApp = CreateObject(\"outlook.application\")\n    With olkApp.createitem(0)\n        .to = strTo\n        .Subject = strSubject\n        .body = strBody\n        .attachments.Add strAtt\n        '.send\n        .Display\n    End With\n    Set olkApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>It works, but I need it to be attached as a .docx (non macro enabled) not a .docm file. Is it possible to do this type of conversion while attaching a document?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559749745, "post_id": 56463270, "comment_id": 99519447, "body": "What is the value of <code>PDFname</code>, how did you try to add it to <code>yFolder</code>, and what was the error?"}, {"owner": {"reputation": 21, "user_id": 7057715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80109bee1765638692f80fc29e26bbe9?s=128&d=identicon&r=PG&f=1", "display_name": "Mark_", "link": "https://stackoverflow.com/users/7057715/mark"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559750023, "post_id": 56463270, "comment_id": 99519599, "body": "The value of PDF Name is a string in cell J1 obtained through function Concatenate. I added in yFolder with following line of code:  yFolder = yFolder + &quot;\\&quot; + PDFname + &quot;.pdf&quot;"}, {"owner": {"reputation": 21, "user_id": 7057715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80109bee1765638692f80fc29e26bbe9?s=128&d=identicon&r=PG&f=1", "display_name": "Mark_", "link": "https://stackoverflow.com/users/7057715/mark"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559750413, "post_id": 56463270, "comment_id": 99519826, "body": "The value of PDF Name is a string in cell J1 obtained through function Concatenate. I added in yFolder with following line of code:  yFolder = yFolder + &quot;\\&quot; + PDFname + &quot;.pdf&quot;. The error I get is Runtime error 52. Invalid name or number file. and if I press debug it points to : If Len(Dir(yFolder))&gt;0 Then"}, {"owner": {"reputation": 1, "user_id": 11610248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2058030344499334/picture?type=large", "display_name": "Max Houser", "link": "https://stackoverflow.com/users/11610248/max-houser"}, "edited": false, "score": 0, "creation_date": 1559841301, "post_id": 56463270, "comment_id": 115086363, "body": "I am somewhat new to vba and am looking at this on my phone so please forgive me if I&#39;m way off but I&#39;d like to attempt to help. Do you have to dim your pdfname? I never saw it as a declared variable however again I am looking at this on my phone so I could&#39;ve easily missed it"}], "owner": {"reputation": 21, "user_id": 7057715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80109bee1765638692f80fc29e26bbe9?s=128&d=identicon&r=PG&f=1", "display_name": "Mark_", "link": "https://stackoverflow.com/users/7057715/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1607454294, "creation_date": 1559747329, "last_edit_date": 1607454294, "question_id": 56463270, "link": "https://stackoverflow.com/questions/56463270/name-pdf-using-data-from-excel-sheet", "title": "Name PDF using data from Excel sheet", "body": "<p>The following code makes a copy of a worksheet, cleans up unnecessary data, exports the Used Range of the new worksheet to PDF and creates an email with that PDF as an attachment.</p>\n<p>I am unable to &quot;personalize&quot; the name of the PDF file.<br />\nMy aim is to have a filename with Name of the Customer and other info from the original sheet.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ExportToPDFAndEmail()\n    Dim yFileDlg As FileDialog\n    Dim yFolder As String\n    Dim yYesorNo As Integer\n    Dim yOutlookObj As Object\n    Dim yEmailObj As Object\n    Dim NomeCliente, Subj, Email As String\n    \n    Set yFileDlg = Application.FileDialog(msoFileDialogFolderPicker)\n    \n    'Copies and pastes a copy of TEMPLATE Worksheet, then it cleans the new Sheet up from unsuseful data _\n    'and blank rows in the description column, finally it deletes some columns\n    Application.ScreenUpdating = False\n    Sheets(&quot;TEMPLATE&quot;).Select\n    Sheets(&quot;TEMPLATE&quot;).Copy Before:=Sheets(1)\n    ActiveSheet.Shapes.Range(Array(&quot;Button 1&quot;)).Select\n    Selection.Delete\n    Range(&quot;F9&quot;).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.SpecialCells(xlCellTypeFormulas, 16).Select\n    Selection.EntireRow.Delete\n    Cells.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n      :=False, Transpose:=False\n    Columns(&quot;F:Z&quot;).Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Range(&quot;B2&quot;).Select\n    \n    'User can choose Folder and filename to save PDF\n    If yFileDlg.Show = True Then\n       yFolder = yFileDlg.SelectedItems(1)\n    Else\n       MsgBox &quot;You must specify a folder to save the PDF into.&quot; &amp; vbCrLf &amp; vbCrLf &amp; &quot;Press OK to exit this macro.&quot;, vbCritical, &quot;You must specify destination folder.&quot;\n       Application.DisplayAlerts = False\n       ActiveSheet.Delete\n       Application.DisplayAlerts = True\n       Exit Sub\n    End If\n    \n    PDFname = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;J1&quot;).Value\n    yFolder = yFolder + &quot;\\&quot; + &quot;Sollecito al &quot; + &quot;.pdf&quot;\n     \n    'Checks if file already exists\n    If Len(Dir(yFolder)) &gt; 0 Then\n        yYesorNo = MsgBox(yFolder &amp; &quot; already exists.&quot; &amp; vbCrLf &amp; vbCrLf &amp; &quot;Do you want to overwrite it?&quot;, _\n                          vbYesNo + vbQuestion, &quot;File Exists&quot;)\n        On Error Resume Next\n        If yYesorNo = vbYes Then\n            Kill yFolder\n        Else\n            MsgBox &quot;If you don't overwrite the existing PDF, I can't continue.&quot; _\n                        &amp; vbCrLf &amp; vbCrLf &amp; &quot;Press OK to exit this macro.&quot;, vbCritical, &quot;Exiting Macro&quot;\n            Exit Sub\n        End If\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox &quot;Unable to delete existing file.  Please make sure the file is not open or write protected.&quot; _\n                        &amp; vbCrLf &amp; vbCrLf &amp; &quot;Press OK to exit this macro.&quot;, vbCritical, &quot;Unable to delete the file&quot;\n            Exit Sub\n        End If\n    End If\n    \n    s = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;X2&quot;).Value\n    NomeCliente = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;B3&quot;).Value\n    Email = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;D4&quot;).Value\n    Subj = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;X2&quot;).Value\n    MesgBefore = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;X3&quot;).Value\n    MesgAfter = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;X6&quot;).Value\n    MesgBefore = Replace(Replace(MesgBefore, &quot;#NomeCliente#&quot;, NomeCliente), Chr(10), &quot;&lt;br&gt;&quot;)\n    MesgAfter = Replace(Replace(MesgAfter, &quot;#NomeCliente#&quot;, NomeCliente), Chr(10), &quot;&lt;br&gt;&quot;)\n    \n    Set rng = ActiveSheet.UsedRange\n    ActiveSheet.PageSetup.PrintArea = rng.Address\n    With ActiveSheet.PageSetup\n            .PrintTitleRows = &quot;$2:$8&quot;\n            .PrintTitleColumns = &quot;&quot;\n            .LeftHeader = &quot;&quot;\n            .CenterHeader = &quot;&quot;\n            .RightHeader = &quot;&quot;\n            .LeftFooter = &quot;&quot;\n            .CenterFooter = &quot;&quot;\n            .RightFooter = &quot;&quot;\n            .LeftMargin = Application.InchesToPoints(0.25)\n            .RightMargin = Application.InchesToPoints(0.25)\n            .TopMargin = Application.InchesToPoints(0.75)\n            .BottomMargin = Application.InchesToPoints(0.75)\n            .HeaderMargin = Application.InchesToPoints(0.3)\n            .FooterMargin = Application.InchesToPoints(0.3)\n            .PrintHeadings = False\n            .PrintGridlines = False\n            .PrintComments = xlPrintNoComments\n            .CenterHorizontally = True\n            .CenterVertically = False\n            .Orientation = xlPortrait\n            .Draft = False\n            .PaperSize = xlPaperA4\n            .FirstPageNumber = xlAutomatic\n            .Order = xlDownThenOver\n            .BlackAndWhite = False\n            .Zoom = False\n            .FitToPagesWide = 1\n            .FitToPagesTall = 6\n            .PrintErrors = xlPrintErrorsDisplayed\n            .OddAndEvenPagesHeaderFooter = False\n            .DifferentFirstPageHeaderFooter = False\n            .ScaleWithDocHeaderFooter = True\n            .AlignMarginsHeaderFooter = True\n            .EvenPage.LeftHeader.Text = &quot;&quot;\n            .EvenPage.CenterHeader.Text = &quot;&quot;\n            .EvenPage.RightHeader.Text = &quot;&quot;\n            .EvenPage.LeftFooter.Text = &quot;&quot;\n            .EvenPage.CenterFooter.Text = &quot;&quot;\n            .EvenPage.RightFooter.Text = &quot;&quot;\n            .FirstPage.LeftHeader.Text = &quot;&quot;\n            .FirstPage.CenterHeader.Text = &quot;&quot;\n            .FirstPage.RightHeader.Text = &quot;&quot;\n            .FirstPage.LeftFooter.Text = &quot;&quot;\n            .FirstPage.CenterFooter.Text = &quot;&quot;\n            .FirstPage.RightFooter.Text = &quot;&quot;\n        End With\n    \n    'Exports to PDF\n    rng.ExportAsFixedFormat Type:=xlTypePDF, fileName:=yFolder, Quality:=xlQualityStandard\n    \n    'Creates Outlook Email\n    Set yOutlookObj = CreateObject(&quot;Outlook.Application&quot;)\n    Set yEmailObj = yOutlookObj.CreateItem(0)\n    With yEmailObj\n        .To = Email\n        .CC = &quot;&quot;\n        On Error Resume Next\n        .Attachments.Add yFolder\n        On Error GoTo 0\n        .Subject = s\n        .HTMLBody = .HTMLBody &amp; &quot;&lt;br&gt;&quot; &amp; MesgBefore &amp; &quot;&lt;br&gt;&lt;br&gt;&quot; &amp; MesgAfter &amp; &quot;&lt;/font&gt;&lt;/span&gt;&quot;\n        .Display\n    End With\n    On Error GoTo 0\n    Set yEmailObj = Nothing\n    Application.DisplayAlerts = False\n    ActiveSheet.Delete\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n<p>I would like the name of the PDF to be as the value in J1.</p>\n<pre><code>PDFname = Worksheets(&quot;TEMPLATE&quot;).Range(&quot;J1&quot;).Value\n</code></pre>\n<p>If I add PDFname in the yFolder, routine returns an error.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "method-call"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1559747001, "post_id": 56463152, "comment_id": 99517855, "body": "Work_sheet change will not fire on a cell change due to formula change. You will want worksheet_calculate."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559748010, "post_id": 56463152, "comment_id": 99518448, "body": "For an example of how to use worksheet_calculate for this, see here: <a href=\"https://stackoverflow.com/questions/56137635/automatically-enter-date-time-as-cell-is-updated-changed\" title=\"automatically enter date time as cell is updated changed\">stackoverflow.com/questions/56137635/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1559803456, "post_id": 56463152, "comment_id": 99534975, "body": "Note that <code>&quot;&#167;D2:&#167;J2&quot;</code> is no valid address it must be <code>&quot;$D2:$J2&quot;</code> using the dollar sign <code>$</code> not the section sign <code>&#167;</code>!"}, {"owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "edited": false, "score": 0, "creation_date": 1559840759, "post_id": 56463152, "comment_id": 99554576, "body": "Many thanks for all your inputs which has helped me to solve it! :) See my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "is_accepted": false, "score": 0, "last_activity_date": 1559840716, "creation_date": 1559840716, "answer_id": 56482136, "question_id": 56463152, "link": "https://stackoverflow.com/questions/56463152/when-formula-result-changes-in-cell-macro-doesnt-run-why/56482136#56482136", "title": "When formula result changes in cell, macro doesn&#39;t run. Why?", "body": "<p>Many thanks for all your inputs which has helped me to solve it! :)</p>\n\n<p>It now works like a charm!</p>\n\n<p>This worksheet_calculate code does the job (I have changed my cell range though):</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim Xrg As Range\nSet Xrg = Range(\"L2:L5\")\nIf Not Intersect(Xrg, Range(\"L2:L5\")) Is Nothing Then\nColor_Row\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559840716, "creation_date": 1559746910, "last_edit_date": 1559803358, "question_id": 56463152, "link": "https://stackoverflow.com/questions/56463152/when-formula-result-changes-in-cell-macro-doesnt-run-why", "title": "When formula result changes in cell, macro doesn&#39;t run. Why?", "body": "<p>When formula result changes in my table in column K range (\"K2:K5\") I want the entire row in the table to be filled with a color. But I only want the row to be colored if the result is not equal to 0.</p>\n\n<p>So eg. if the result changes in K2 (and is not = 0) the entire row A2:L2 will be colored.\nThe formula are refering to values that you select from dropdown-lists (created from \"data validation\" on the excel menu Data-tab). These dropdowns are located on the same row  (eg. \u201cD2:J2\u201d) as the related formula. The values in the dropdown is refering to a range on the same sheet outside of the table.\nSo far I have one code for the worksheet concerning the change event that calls the module with the  sub that will change the color on the row.</p>\n\n<p>But it doesn't work and I get no error messages.</p>\n\n<p>This is the code for the worksheet change event:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"\u00a7D2:\u00a7J2\" Then\nColor_Row\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Here the target address should propably be the whole range, but I don't know how to give the right syntax for that.</p>\n\n<p>Here is the code for changing color on row:</p>\n\n<pre><code>Sub Color_Row()\nDim r As Long, c As Long 'r=rows in the excel sheet | c= value of cell in _  \ncolumn k\nDim numrow As Long 'last row with data\nDim tblR As Long 'tablerow\n\nnumrow = TimeMeasure.Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n\nFor r = 2 To numrow\ntblR = r - 1\nc = Cells(r, 11).Value\n\nIf c &lt;&gt; 0 Then\n      [TimeDist].Rows(tblR).Interior.Color = 12961279\n\nElse\n\n      [TimeDist].Rows(tblR).Interior.Color = xlNone 'no fill color\n\n\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I have steped in to this code and watched variables like c, r, numrow, tblR and it all seems to match my table (the name of my table is TimeDist).</p>\n\n<p>The only thing that I've noticed is that no values ever assigns to c in the loop. I know though that this code works in another workbook, but then I manualy type in a new value in a specific cell outside of the table, which changes the formula result in table (then the rows get colored)</p>\n\n<p>I very thankfuly accept any help on this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11604666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b7547c26e13166243605c1d6e2da1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nahilis", "link": "https://stackoverflow.com/users/11604666/nahilis"}, "edited": false, "score": 0, "creation_date": 1559746765, "post_id": 56463093, "comment_id": 99517699, "body": "I just saw the formating, sorry for that"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1559746862, "post_id": 56463093, "comment_id": 99517780, "body": "A major improvement you could make is to incorporate the lessons of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 1, "user_id": 11604666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b7547c26e13166243605c1d6e2da1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nahilis", "link": "https://stackoverflow.com/users/11604666/nahilis"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560257312, "post_id": 56463093, "comment_id": 99669757, "body": "Awesome! Thank you so much for this, I will have a read through"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11604666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b7547c26e13166243605c1d6e2da1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nahilis", "link": "https://stackoverflow.com/users/11604666/nahilis"}, "edited": false, "score": 0, "creation_date": 1560257345, "post_id": 56463353, "comment_id": 99669780, "body": "This is exactly what I tried to achieve! Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1559747626, "creation_date": 1559747626, "answer_id": 56463353, "question_id": 56463093, "link": "https://stackoverflow.com/questions/56463093/vba-code-is-not-working-well-to-copy-and-paste-across-multiple-workbooks/56463353#56463353", "title": "VBA code is not working well to copy and paste across multiple workbooks", "body": "<p>Let's give this a shot - I've removed all the copying/pasting/activating and replaced it with fully qualified value exchanges. Additionally, turning <code>.ScreenUpdating</code> off might help. One note - I'm not sure what you're trying to do with the saving portion in your <code>Else</code> statement - is that a typo?</p>\n\n<pre><code>Option Explicit\nSub Marksheet()\n\n    Dim x As Long\n    Dim Wbk1 As Workbook, Wbk2 As Workbook\n    Dim Filename As String, Course As String\n\n    Set Wbk1 = ThisWorkbook\n    LRsource = Wbk1.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\n    Application.ScreenUpdating = False\n\n    For x = 2 To LRsource\n\n        Filename = Cells(x, \"T\")\n        Course = Cells(x, \"G\")\n\n        If Course = \"Course1\" Then\n\n            Set Wbk2 = Workbooks.Open(\"C:\\Users\\XXX\\Desktop\\Test\\Course1.xlsx\")\n\n            Wbk2.Sheets(1).Cells(5, \"C\").Value = Wbk1.Sheets(1).Cells(x, \"E\").Value\n            Wbk2.Sheets(1).Cells(7, \"C\").Value = Wbk1.Sheets(1).Cells(x, \"Q\").Value\n\n            Wbk2.SaveAs \"Course1_Location\\\" &amp; Filename &amp; \" .xlsx\"\n            Wbk2.Close\n\n        ElseIf Course = \"Course2\" Then\n\n            Set Wbk2 = Workbooks.Open(\"C:\\Users\\XXX\\Desktop\\Test\\Course2.xlsx\")\n\n            Wbk2.Sheets(1).Cells(5, \"C\").Value = Wbk1.Sheets(1).Cells(x, \"E\").Value\n            Wbk2.Sheets(1).Cells(7, \"C\").Value = Wbk1.Sheets(1).Cells(x, \"Q\").Value\n\n            Wbk2.SaveAs \"Course2_Location\\\" &amp; Filename &amp; \" .xlsx\"\n            Wbk2.Close\n\n        Else\n\n            Set Wbk2 = Workbooks.Open(\"C:\\Users\\XXX\\Desktop\\Test\\Course3_6.xlsx\")\n\n            Wbk2.Sheets(1).Cells(5, \"C\").Value = Wbk1.Sheets(1).Cells(x, \"E\").Value\n            Wbk2.Sheets(1).Cells(7, \"C\").Value = Wbk1.Sheets(1).Cells(x, \"Q\").Value\n            Wbk2.Sheets(1).Cells(3, \"D\").Value = Wbk1.Sheets(1).Cells(x, \"G\").Value\n\n            'What's going on here?\n            If Course = \"Course3\" Then\n                Wbk2.SaveAs \"Course3_Location\\\" &amp; Filename &amp; \" .xlsx\"\n            End If\n\n            Wbk2.SaveAs \"course3_Location\" &amp; Filename &amp; \" .xlsx\"\n            Wbk2.Close\n\n        End If\n    Next x\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11604666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b7547c26e13166243605c1d6e2da1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nahilis", "link": "https://stackoverflow.com/users/11604666/nahilis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559747626, "creation_date": 1559746736, "last_edit_date": 1559747015, "question_id": 56463093, "link": "https://stackoverflow.com/questions/56463093/vba-code-is-not-working-well-to-copy-and-paste-across-multiple-workbooks", "title": "VBA code is not working well to copy and paste across multiple workbooks", "body": "<p>In an attempt to automate my work, I am trying to generate personalised marksheets with name of student and marker in there as well as a save the workbook as\"Student_Marker_Course\" (for each student and marker), I have just picked up VBA last week and last time I tried to code something, it was in Java 10 years ago.</p>\n\n<p>The code that I used below works, however, I don't think it is optimised as it does take a little while to generate the 100+ marksheets, I was just wondering if I did it well and where I could try to optimise it, Thanks!</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Marksheet()\n    Dim x As Integer\n    Dim Wbk1 As Workbook, Wbk2 As Workbook\n    Dim Filename As String, Course As String\n\n    Set Wbk1 = ThisWorkbook\n    LRsource = Wbk1.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row ' find the final row\n\n    For x = 2 To LRsource\n        Filename = Cells(x, \"T\")\n        Course = Cells(x, \"G\")\n        'Below will find out which course the student is on and which marksheet to select\n\n        If Course = \"Course1\" Then\n            Set Wbk2 = Workbooks.Open(\"C:\\Users\\XXX\\Desktop\\Test\\Course1.xlsx\")  'Select Marksheet\n           'Below will copy and paste the student name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"E\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(5, \"C\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            'Below will copy and paste the Markers name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"Q\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(7, \"C\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            Wbk2.SaveAs \"Course1_Location\\\" &amp; Filename &amp; \" .xlsx\" 'Select destination\n            Wbk2.Close\n            Application.CutCopyMode = False\n        ElseIf Course = \"Course2\" Then\n            Set Wbk2 = Workbooks.Open(\"C:\\Users\\XXX\\Desktop\\Test\\Course2.xlsx\")  'Select Marksheet\n           'Below will copy and paste the student name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"E\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(5, \"C\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            'Below will copy and paste the Markers name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"Q\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(7, \"C\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            'Finding where to save it\n            Wbk2.SaveAs \"Course2_Location\\\" &amp; Filename &amp; \" .xlsx\" 'Select destination\n            Wbk2.Close\n            Application.CutCopyMode = False\n        Else\n            Set Wbk2 = Workbooks.Open(\"C:\\Users\\XXX\\Desktop\\Test\\Course3_6.xlsx\")  'Select Marksheet\n\n            'Below will copy and paste the student name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"E\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(5, \"C\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            'Below will copy and paste the Markers name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"Q\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(7, \"C\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n\n            'Below will copy and paste the course name\n            Wbk1.Sheets(1).Activate\n            Cells(x, \"G\").Copy\n            Wbk2.Activate\n            Sheets(1).Cells(3, \"D\").Select\n            ActiveSheet.Paste\n\n            'Finding where to save it, I have multiple courses here, hence the if \n            If Course = \"Course3\" Then\n                Wbk2.SaveAs \"Course3_Location\\\" &amp; Filename &amp; \" .xlsx\" 'Select destination\n            End If\n\n            'Repeat above If for each course\n            Wbk2.SaveAs \"course3_Location\" &amp; Filename &amp; \" .xlsx\" 'Select destination\n            Wbk2.Close\n            Application.CutCopyMode = False\n        End If\n    Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1559754195, "creation_date": 1559754195, "answer_id": 56464996, "question_id": 56463074, "link": "https://stackoverflow.com/questions/56463074/how-to-convert-outlook-messages-to-text-maintaining-double-byte-character-set/56464996#56464996", "title": "How to convert Outlook messages to text maintaining double-byte character set?", "body": "<p>You can read the <code>MailItem.Body</code> property (like all COM strings, it is UT-16), explicitly build the header, combine it with the message body, and save the file yourself.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> is an option, its version of <code>SaveAs(..., olTxt)</code> does not have this problem:</p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nset msg = Session.GetRDOObjectFromOutlookObject(myItem)\nmsg.SaveAs \"c:\\temp\\test.txt\", olTxt\n</code></pre>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559754195, "creation_date": 1559746657, "question_id": 56463074, "link": "https://stackoverflow.com/questions/56463074/how-to-convert-outlook-messages-to-text-maintaining-double-byte-character-set", "title": "How to convert Outlook messages to text maintaining double-byte character set?", "body": "<p>I have a code to convert outlook emails into text. Works great except for emails received with DBCS (double-byte character set) from CJK (Chinese/Japanese/Korean) languages.</p>\n\n<p>The code I have is as follows:</p>\n\n<pre><code>Sub SaveAsTXT(myMail As Outlook.MailItem)\n\n    Dim objItem As Object\n    Dim myFolder As Folder\n\n    ' Get sender email address\n    senderEmAddress = myMail.Sender.GetExchangeUser().PrimarySmtpAddress\n\n        If Not TypeName(myItem) = \"Nothing\" Then\n               strname = myMail.Subject\n               strdate = Format(myMail.ReceivedTime, \"yymmddhhmmss\")\n               myMail.SaveAs \"C:\\folder\\\" &amp; strdate &amp; \".txt\", olTXT\n        End If\nEnd Sub\n</code></pre>\n\n<p>I need to keep the extract as text. If I copy the email manually into notepad the CJK characters are copied correctly and saved correctly if I use UTF-8. </p>\n\n<p>What can I add in the VBA code to capture the CJK characters correctly?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1559744756, "post_id": 56462474, "comment_id": 99516536, "body": "A simple <code>VLookUp</code>would do the trick, wouldn&#39;t it?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1559744762, "post_id": 56462474, "comment_id": 99516540, "body": "Looks like you  need a loop instead of an <code>IF</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559745490, "post_id": 56462474, "comment_id": 99516974, "body": "@OmarAljonubi so you have a sheet where you have just Names or whatever, and another sheet with the names and additional data. You need to pull the data to te first sheet depending on the names?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559748524, "post_id": 56463197, "comment_id": 99518721, "body": "I added that code to my macro and it didn&#39;t work @tigeravatar"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559748627, "post_id": 56463197, "comment_id": 99518790, "body": "like nothing happened when I ran it @tigeravatar"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559749822, "post_id": 56463197, "comment_id": 99519495, "body": "@OmarAljonubi That&#39;s probably because the lookup column isn&#39;t actually column A.  What column in <code>Sheet2</code> are the lookup values?  If they&#39;re in column B, change <code>sLookupCol</code> to <code>&quot;B&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559750413, "post_id": 56463197, "comment_id": 99519827, "body": "that worked great, but all I need is how to take each persons data and place them in a different cell in a different sheet. Because I created a seating chart and each person is in a different spot so I need to place their data in their own cell @tigeravatar. Also, not be a burden, but need the data not to be in a row from but column."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "edited": false, "score": 0, "creation_date": 1559750501, "post_id": 56463197, "comment_id": 99519870, "body": "@OmarAljonubi What you&#39;re describing is very different from your original question.  Please open a new question and provide sample data with expected results."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1559747097, "creation_date": 1559747097, "answer_id": 56463197, "question_id": 56462474, "link": "https://stackoverflow.com/questions/56462474/pulling-multiple-names-that-are-listed-from-a-different-sheet-to-another/56463197#56463197", "title": "Pulling multiple names that are listed from a different sheet to another", "body": "<p>This can be done with a VLOOKUP.  If it has to be VBA, then this is a fairly simple solution for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim sLookupCol As String\n    Dim sLookupTable As String\n\n    Set ws = ActiveWorkbook.Worksheets(\"Sheet2\")\n    sLookupCol = \"A\"\n    sLookupTable = \"'three'!$G:$I\"\n\n    With ws.Range(\"C3:D\" &amp; ws.Cells(ws.Rows.Count, sLookupCol).End(xlUp).Row)\n        If .Row &lt; 3 Then Exit Sub   'No values to lookup\n        .Formula = \"=VLOOKUP($\" &amp; sLookupCol &amp; .Row &amp; \",\" &amp; sLookupTable &amp; \",COLUMN(B1),FALSE)\"\n        .Value = .Value\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11595280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-93H0rwXUKOI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rej32n02N0--ClZkuLEiRBjwzE5ZQ/mo/photo.jpg?sz=128", "display_name": "Omar Aljonubi", "link": "https://stackoverflow.com/users/11595280/omar-aljonubi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559747097, "creation_date": 1559744629, "question_id": 56462474, "link": "https://stackoverflow.com/questions/56462474/pulling-multiple-names-that-are-listed-from-a-different-sheet-to-another", "title": "Pulling multiple names that are listed from a different sheet to another", "body": "<p>I have consolidated data from sheet \"three\". The data consists of how a person is doing in their work. The two cells to the right of the person name give me their data, and that's what I'm transferring. Now I'm trying to take that data and place them in certain cells in a different sheet. Using VBA of course. </p>\n\n<p>I tried using an IF statement, but I think that might be the reason its not working </p>\n\n<pre><code>Sub button()\n\n    With Worksheets(\"three\").Range(\"G1\")\n\n        If .Value = \"sconlon@iadvancenow.com\" Then\n\n            Worksheets(\"Sheet2\").Range(\"C3\") = .Offset(0, 1).Value\n            Worksheets(\"Sheet2\").Range(\"D3\") = .Offset(0, 2).Value\n\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>What I'm getting from this code alone is just one person's data. I need multiple people's data taken and placed somewhere else. The real problem is some times when the data is updated that person name might not be there (because they might not have done any work), maybe someone else name pops up. who every name pops up needs to be set to their cell in a different sheet.</p>\n"}, {"tags": ["excel", "vba", "rest", "web-scraping", "asana-api"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1560182725, "post_id": 56494613, "comment_id": 99643017, "body": "That did not work, it download the same DOCTYPEhtml file."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "edited": false, "score": 0, "creation_date": 1560242210, "post_id": 56494613, "comment_id": 99661054, "body": "So you still have an authorization problem, as that is the result I also get, if I don&#39;t provide <i>any</i> Asana token. Maybe you should ask your question at <a href=\"https://forum.asana.com\" rel=\"nofollow noreferrer\">forum.asana.com</a>."}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1559911440, "creation_date": 1559911440, "answer_id": 56494613, "question_id": 56462470, "link": "https://stackoverflow.com/questions/56462470/download-csv-from-an-indirect-asana-link/56494613#56494613", "title": "Download .csv from an indirect Asana link", "body": "<p>I guess, you have an authorization problem, as user/password is not supported by Asana.<br>\nYou need a <a href=\"https://asana.com/developers/documentation/getting-started/auth#personal-access-token\" rel=\"nofollow noreferrer\">Personal Access Token</a>, which has to be set in your request header.</p>\n\n<p>Please replace this line</p>\n\n<pre><code>'Set HttpReq = CreateObject(\"Microsoft.XMLHTTP\")\nSet HttpReq = CreateObject(\"MSXML2.XMLHTTP\")\n</code></pre>\n\n<p>and that line:</p>\n\n<pre><code>'HttpReq.Open \"GET\", myURL, False, \"username\", \"password\"\nHttpReq.Open \"GET\", myURL, False\nHttpReq.setRequestHeader \"Authorization\", \"Bearer \" &amp; \"your Asana token here\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559911820, "creation_date": 1559744602, "last_edit_date": 1559911820, "question_id": 56462470, "link": "https://stackoverflow.com/questions/56462470/download-csv-from-an-indirect-asana-link", "title": "Download .csv from an indirect Asana link", "body": "<p>This code creates a download but not of the linked file as it is not direct. When I open the .csv file it downloads, it appears to be the data from the redirect, not the file linked to the redirect.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub Asana()\n\nDim myURL As String\nmyURL = \"https://app.asana.com/-/csv?id=955497629707333\"\n\nDim HttpReq As Object\nSet HttpReq = CreateObject(\"Microsoft.XMLHTTP\")\nHttpReq.Open \"GET\", myURL, False, \"username\", \"password\"\nHttpReq.send\n\n\nmyURL = HttpReq.responseBody\nIf HttpReq.Status = 200 Then\n    Set oStrm = CreateObject(\"ADODB.Stream\")\n    oStrm.Open\n    oStrm.Type = 1\n    oStrm.Write HttpReq.responseBody\n    oStrm.SaveToFile ThisWorkbook.Path &amp; \"\\\" &amp; \"SER_Backlog_BRCC.csv\", 2 ' 1 = no overwrite, 2 = overwrite\n    oStrm.Close\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It should be a spreadsheet copy of the data on the page, but it comes out with data in a spreadsheet of the website and not the linked .csv file you would get, if done manually.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xybhy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xybhy.png\" alt=\"DOCHTML\"></a></p>\n\n<p>Should be this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/112Vv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/112Vv.png\" alt=\"should be this\"></a>.</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 3279, "user_id": 1459036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yeDJp.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1459036/brad"}, "edited": false, "score": 0, "creation_date": 1559744428, "post_id": 56462382, "comment_id": 99516350, "body": "ta L ON A.PUMA_TSD_PollID = L.PUMA_CH_TSD_PollID ON A.PUMA_TSD_Po  this part, you have 2 ON statements in a row  probably needs to be AND"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1559745343, "post_id": 56462382, "comment_id": 99516881, "body": "Some basic formatting would reveal these types of issues quickly. Or even better, move this query to a stored procedure. Either way I voted to close this as it is just a typo."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "edited": false, "score": 0, "creation_date": 1559744916, "post_id": 56462449, "comment_id": 99516627, "body": "How do I store the query inside my &#39;sqlQry&#39; variable in multilines instead of the whole query in a single line?"}, {"owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "edited": false, "score": 0, "creation_date": 1559745359, "post_id": 56462449, "comment_id": 99516894, "body": "And now it&#39;s throwing me Compile error: User-defined type not defined!!!"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1559745588, "post_id": 56462449, "comment_id": 99517025, "body": "No need to change it to an AND, just remove the second one as they are identical. :)"}, {"owner": {"reputation": 3279, "user_id": 1459036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yeDJp.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1459036/brad"}, "edited": false, "score": 0, "creation_date": 1559746345, "post_id": 56462449, "comment_id": 99517457, "body": "Good catch Sean Lange, You can keep it single line, instead of changing to AND, just remove that section of code from your single line, so remove this:  ON A.PUMA_TSD_PollID = L.PUMA_CH_TSD_PollID"}, {"owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "edited": false, "score": 0, "creation_date": 1559750766, "post_id": 56462449, "comment_id": 99519995, "body": "That worked. The only issue I see now is no header or column labels being fetched..how do I fetch the records along with the column headers?"}, {"owner": {"reputation": 3279, "user_id": 1459036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yeDJp.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1459036/brad"}, "edited": false, "score": 0, "creation_date": 1559755202, "post_id": 56462449, "comment_id": 99521974, "body": "Your column headers come with the data, but you need to do something extra to get them.  I am not familiar with VBA but they are not part of the data, there should be a call or something to get them."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559755589, "post_id": 56462449, "comment_id": 99522134, "body": "CopyFromRecordset only copies the data, not the headers: you will need to loop over the recordset&#39;s <code>Fields</code> collection and get the <code>Name</code> of each field  <a href=\"https://stackoverflow.com/questions/36568793/adodb-recordset-column-headers\" title=\"adodb recordset column headers\">stackoverflow.com/questions/36568793/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "edited": false, "score": 0, "creation_date": 1559763473, "post_id": 56462449, "comment_id": 99525318, "body": "Thanks..I incorporated the loop and it&#39;s working as expected."}], "tags": [], "owner": {"reputation": 3279, "user_id": 1459036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yeDJp.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1459036/brad"}, "is_accepted": true, "score": 0, "last_activity_date": 1559763975, "last_edit_date": 1559763975, "creation_date": 1559744505, "answer_id": 56462449, "question_id": 56462382, "link": "https://stackoverflow.com/questions/56462382/run-time-error-while-fetching-data-from-sql-server-through-excel-vba/56462449#56462449", "title": "Run-time error while fetching data from SQL Server through Excel VBA", "body": "<p>Pulled your query out and pasted here.  Comment below, but removed ON and changed to AND.  You had 2 ON's in a row.</p>\n\n<pre><code>SELECT A.PUMA_TSD_PollID AS ID, PUMA_TSD_FieldName AS Field_Name,PUMA_TSD_FieldValue AS Field_Value,PUMA_TSD_IPAddress AS IP_Address,PUMA_TSD_PollDate AS Poll_Date,PUMA_TSD_Channel AS Channel,\nPUMA_TSD_MachineName AS Machine_Name,PUMA_TSD_TestBedType AS TestBedType \nFROM [WWW_AUXMOD].[dbo].[tblPUMA_TSD_AVLLynx] A \nINNER JOIN [WWW_AUXMOD].[dbo].tblPUMA_TSD_AVLLynxData L ON A.PUMA_TSD_PollID = L.PUMA_CH_TSD_PollID \n    -- change ON to AND HERE  (ON IS REMOVED)\n    --AND A.PUMA_TSD_PollID = L.PUMA_CH_TSD_PollID (Redundant statement) \nWHERE PUMA_TSD_MachineName != 'ELMS_SYSTEM' \nAND PUMA_TSD_PollDate &gt;= '6/2/19'\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10722930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-swnCNK4jCDE/AAAAAAAAAAI/AAAAAAAADZY/FdSUz8danm0/photo.jpg?sz=128", "display_name": "Imtiazul Haque", "link": "https://stackoverflow.com/users/10722930/imtiazul-haque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56462449, "answer_count": 1, "score": 0, "last_activity_date": 1559823628, "creation_date": 1559744258, "last_edit_date": 1559823628, "question_id": 56462382, "link": "https://stackoverflow.com/questions/56462382/run-time-error-while-fetching-data-from-sql-server-through-excel-vba", "title": "Run-time error while fetching data from SQL Server through Excel VBA", "body": "<p>I am trying to fetch some data from a SQL server to excel using VBA. After researching on web, I have cobbled up a code and when I execute it, it throws a </p>\n\n<blockquote>\n  <p>Run-time error -'2147217900 (80040e14)':<br>\n  Incorrect syntax near the keyword 'ON'.</p>\n</blockquote>\n\n<p>From the error it seems that the error is detected due to some abnormality in the query. The query was provided by the DBA team and incorporates data from 2 different tables. I used the same query to manually export data from the database to excel and it works. I don't know why vba is throwing error. Any help will be appreciated. Thanks.</p>\n\n<pre><code>Sub sync_data_vba_sqlserver()\n\nDim con As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sqlQry As String, strCon As String\nSet con = New ADODB.Connection\nSet rs = New ADODB.Recordset\nActiveSheet.Cells.ClearContents\n\nsqlQry = \"SELECT A.PUMA_TSD_PollID AS ID, PUMA_TSD_FieldName AS Field_Name,PUMA_TSD_FieldValue AS Field_Value,PUMA_TSD_IPAddress AS IP_Address,PUMA_TSD_PollDate AS Poll_Date,PUMA_TSD_Channel AS Channel,PUMA_TSD_MachineName AS Machine_Name,PUMA_TSD_TestBedType AS TestBedType FROM [WWW_AUXMOD].[dbo].[tblPUMA_TSD_AVLLynx] A INNER JOIN [WWW_AUXMOD].[dbo].tblPUMA_TSD_AVLLynxData L ON A.PUMA_TSD_PollID = L.PUMA_CH_TSD_PollID ON A.PUMA_TSD_PollID = L.PUMA_CH_TSD_PollID WHERE PUMA_TSD_MachineName != 'ELMS_SYSTEM' AND PUMA_TSD_PollDate &gt;= '6/2/19';\"\n\n\n'---- Replace below highlighted names with the corresponding values\n\nstrCon = \"Provider=sqloledb;Data Source=ECCDB1503.MD3Q.FORD.COM;Initial Catalog=WWW_AUXMOD;Integrated Security=SSPI\"\n\n'---  Open   the above connection string.\n\ncon.Open (strCon)\n\n    rs.Open sqlQry, con\n    ActiveSheet.Cells(2, 1).CopyFromRecordset rs\n    rs.Close\n\ncon.Close\nSet rs = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Expecting the data to be exported to Excel from SQL Server.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1559743753, "post_id": 56462172, "comment_id": 99515952, "body": "Watch out for those <code>ActiveSheet</code> references - they might be screwing things up."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559743938, "post_id": 56462172, "comment_id": 99516067, "body": "Why are you using <code>With Worksheets(&quot;Fall&quot;)</code> and then  <code>ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row</code>? also, you miss some dots to reference your with on the same line, <code>Rows.Count, 1</code> should be <code>.Rows.Count, 1</code> if it&#39;s referencing the worksheet Fall. Looks like you know how to qualify and reference worksheets, I&#39;d recommend get rid of all the <code>ActiveSheet</code> and fully qualify your ranges."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559745137, "post_id": 56462172, "comment_id": 99516756, "body": "@SJR thanks for the tip I&#39;ll play around and see if that&#39;s the problem."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559745326, "post_id": 56462172, "comment_id": 99516866, "body": "@Damian The <code>With Worksheets(&quot;Fall&quot;)</code> is there because I get a compile reference error without it. I also want to make sure it&#39;s referencing the right sheet in the workbook. The <code>ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row</code> is to make sure it&#39;s using last row on the active sheet."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559745417, "post_id": 56462172, "comment_id": 99516929, "body": "@Deke like SJR said, don&#39;t ever use the <code>ActiveSheet</code>reference all the sheets you are working with and then use the references. Update your code after that and if you still have problems tell us exactly where and will be able to help you."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559745445, "post_id": 56462172, "comment_id": 99516943, "body": "Are you sure it&#39;s the right sheet because until near the end the active sheet doesn&#39;t change. Anyway remove all doubt and follow Damian&#39;s advice."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1559747013, "post_id": 56462172, "comment_id": 99517861, "body": "Okay I&#39;ve removed all activesheet references. Still getting the issue. I&#39;m pretty sure what it&#39;s doing is remembering the last row that was an error and copying it. The issue seems to be with <code>If Not eRng Is Nothing Then</code> statement. It&#39;s not registering there is no error. It&#39;s just going to whatever was last copied when there is no error. IF there is an error it works correctly and will copy only that error row."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559747237, "post_id": 56462172, "comment_id": 99518026, "body": "Are you saying <code>eRng</code> is nothing but the code continues anyway? That doesn&#39;t seem possible. Have you stepped through your code using F8?"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1559747404, "post_id": 56462172, "comment_id": 99518124, "body": "Yes and yes.... That&#39;s why i&#39;m totally stumped. This works perfectly on every other spreadsheet that has this code but this one seems to ignore it&#39;s own logic. lol I&#39;ve been banging my head on this issue for two days."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559747520, "post_id": 56462172, "comment_id": 99518184, "body": "Does it fail on the first block or the second? Have you put dots everywhere you were lacking them (or a sheet reference)? Your second block is missing <code>on error goto 0</code>."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1559747939, "post_id": 56462172, "comment_id": 99518408, "body": "first block runs fine, Second block is where it fails. <code>on error goto 0</code> is back in place. I had removed it and the other on error to see if it was coming up with unexpected errors or not. Still fails on second block though."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559748084, "post_id": 56462172, "comment_id": 99518495, "body": "The OEG0 line needs to be before the If."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1559748370, "post_id": 56462172, "comment_id": 99518622, "body": "Sorry fixed that... but still has the issue."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559748492, "post_id": 56462172, "comment_id": 99518691, "body": "Must be something in the code you haven&#39;t posted. Is <code>erng</code> declared as a Range?"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1559748701, "post_id": 56462172, "comment_id": 99518847, "body": "I do have it declared. but found the answer. Set below."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1559748679, "post_id": 56463613, "comment_id": 99518827, "body": "I had to create a new reference for the range. So I changed eRng to eRg in the second block and added a second Dim eRg as Range."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559748993, "post_id": 56463613, "comment_id": 99519019, "body": "You shouldn&#39;t have to do that, though could argue it&#39;s good practice."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559749516, "post_id": 56463613, "comment_id": 99519321, "body": "Totally agree. It should just reset in the second block. Still open to idea&#39;s and solutions though. It&#39;s just this is something that works."}], "tags": [], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "is_accepted": false, "score": 0, "last_activity_date": 1559748624, "creation_date": 1559748624, "answer_id": 56463613, "question_id": 56462172, "link": "https://stackoverflow.com/questions/56462172/same-rows-from-one-range-copied-when-copying-rows-from-another-range/56463613#56463613", "title": "Same rows from one range copied when copying rows from another range", "body": "<pre><code>'Run Formulas for Lago, copy/Paste to Lago Output Sheet\nWith ws\n    lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(\"AT2:BC\" &amp; lrow).Formula = .Range(\"AT2:BC2\").Formula\nEnd With\n\nWith Worksheets(\"Fall\").Range(\"A3:CU\" &amp; lrow)\n    On Error Resume Next\n    Set eRng = .SpecialCells(xlCellTypeFormulas, xlErrors)\n    On Error GoTo 0\n    If Not eRng Is Nothing Then\n        Intersect(.Parent.Range(\"A:CU\"), eRng.EntireRow).Copy\n        Worksheets(\"Lago\").Range(\"A3\").PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n    End If\n    End With\nRange(\"AT3:BC\" &amp; lrow).ClearContents\n\n'Run Formulas for MF, copy/paste to MF output sheet\nWith ws\n    lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(\"BE2:BN\" &amp; lrow).Formula = .Range(\"BE2:BN2\").Formula\nEnd With\n\nWith Worksheets(\"Fall\").Range(\"A3:CU\" &amp; lrow)\n    On Error Resume Next\n    Set eRg = .SpecialCells(xlCellTypeFormulas, xlErrors) '&lt;---- Changed to eRg from eRng\n    On Error GoTo 0\n    If Not eRg Is Nothing Then '&lt;---- Changed to eRg from eRng\n        Intersect(.Parent.Range(\"A:CU\"), eRng.EntireRow).Copy\n        Worksheets(\"MF\").Range(\"A3\").PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n    End If\n    End With\n  Range(\"BE3:BN\" &amp; lrow).ClearContents\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1563149086, "creation_date": 1559743635, "last_edit_date": 1563149086, "question_id": 56462172, "link": "https://stackoverflow.com/questions/56462172/same-rows-from-one-range-copied-when-copying-rows-from-another-range", "title": "Same rows from one range copied when copying rows from another range", "body": "<p>I have code to copypaste a row with formula errors to another sheet.</p>\n\n<p>The problem is in copying rows for:<br>\n\"Run Formulas for MF, copy/paste to MF output sheet\" (Second half).</p>\n\n<p>It appears to copy the same rows that were in error for the \"Run Formulas for Lago, copy/Paste to Lago Output Sheet\" even though those cells were cleared of contents. I searched for any errors in those rows and there were none.</p>\n\n<p>The same code works as intended on other spreadsheets. </p>\n\n<p>My theory is that it is remembering the error rows and recopying them but it should reset when running the second time through.</p>\n\n<pre><code>'Run Formulas for Lago, copy/Paste to Lago Output Sheet\nWith ws\n    lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(\"AT2:BC\" &amp; lrow).Formula = .Range(\"AT2:BC2\").Formula\nEnd With\n\nWith Worksheets(\"Fall\").Range(\"A3:CU\" &amp; lrow)\n    On Error Resume Next\n    Set eRng = .SpecialCells(xlCellTypeFormulas, xlErrors)\n    On Error GoTo 0\n    If Not eRng Is Nothing Then\n        Intersect(.Parent.Range(\"A:CU\"), eRng.EntireRow).Copy\n        Worksheets(\"Lago\").Range(\"A3\").PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n    End If\n    End With\nRange(\"AT3:BC\" &amp; lrow).ClearContents\n\n'Run Formulas for MF, copy/paste to MF output sheet\nWith ws\n    lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(\"BE2:BN\" &amp; lrow).Formula = .Range(\"BE2:BN2\").Formula\nEnd With\n\nWith Worksheets(\"Fall\").Range(\"A3:CU\" &amp; lrow)\n    On Error Resume Next\n    Set eRng = .SpecialCells(xlCellTypeFormulas, xlErrors)\n    On Error GoTo 0\n    If Not eRng Is Nothing Then\n        Intersect(.Parent.Range(\"A:CU\"), eRng.EntireRow).Copy\n        Worksheets(\"MF\").Range(\"A3\").PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n    End If\n    End With\nRange(\"BE3:BN\" &amp; lrow).ClearContents\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "edited": false, "score": 7, "creation_date": 1559743059, "post_id": 56461992, "comment_id": 99515576, "body": "Because they aren&#180;t classes, but <b>Interfaces</b>."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1559743082, "post_id": 56461992, "comment_id": 99515593, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/interfaces/\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/csharp/programming-guide/&hellip;</a>"}, {"owner": {"reputation": 1643, "user_id": 9177810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziLgX.jpg?s=128&g=1", "display_name": "JamesS", "link": "https://stackoverflow.com/users/9177810/jamess"}, "edited": false, "score": 0, "creation_date": 1559743159, "post_id": 56461992, "comment_id": 99515633, "body": "Possibly also see <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms760248(v%3Dvs.85)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/windows/desktop/&hellip;</a> for more information on IXMLDOMElement"}, {"owner": {"reputation": 656, "user_id": 5053019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b93a6a90dfb5b9e3b253c9f318ab5a5b?s=128&d=identicon&r=PG", "display_name": "Flavio Francisco", "link": "https://stackoverflow.com/users/5053019/flavio-francisco"}, "edited": false, "score": 0, "creation_date": 1559743225, "post_id": 56461992, "comment_id": 99515673, "body": "As naming convention interfaces have their names starting with an upper case &quot;i&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559744966, "post_id": 56461992, "comment_id": 99516652, "body": "Interfaces provide an abstraction layer and help decouple components of an application, through polymorphism. The code works with an <code>IXMLSerializable</code> object, without needing to care for the actual implementation - it&#39;s guaranteed to be an object that exposes a <code>SerializationXML</code> string property and a getter for an <code>SerializationXMLElement</code>  property; <i>how</i> that&#39;s implemented is irrelevant to the caller. This is useful for <i>a lot</i> of things in OOP, and yes, <a href=\"https://stackoverflow.com/a/31861832/1188513\">VB6 &amp; VBA can do OOP</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 2, "last_activity_date": 1559743776, "last_edit_date": 1559743776, "creation_date": 1559743138, "answer_id": 56462032, "question_id": 56461992, "link": "https://stackoverflow.com/questions/56461992/why-do-some-classes-have-an-i-in-front-of-their-name/56462032#56462032", "title": "Why do some classes have an &quot;I&quot; in front of their name?", "body": "<p>The <code>I</code> stands for <strong>Interface</strong>, like specified in the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms757048(v%3Dvs.85)\" rel=\"nofollow noreferrer\">Microsoft Official Documentation</a>:</p>\n\n<blockquote>\n  <p><strong>IXMLDOMElement Members.</strong></p>\n  \n  <p>The following tables show the properties, methods, and events.</p>\n  \n  <p>In C++, this <strong>interface</strong> inherits from <strong>IXMLDOMNode</strong>.</p>\n</blockquote>\n\n<p>That was a pretty common convention and by doing so, you immediately know that it represent an <code>Interface</code>, without looking at the code.</p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1559750122, "post_id": 56462484, "comment_id": 99519666, "body": "<i>the point is that there are multiple classes that use the one interface</i> - not necessarily. I see it more as changing the color of the lens through which we look at a given object: I can have a <code>Person</code> class with a default instance that exposes a <code>Create</code> factory method and <code>Get</code>+<code>Let</code> accessors for a <code>Name</code> property; the class implemens <code>IPerson</code> which only exposes the <code>Get</code> accessor, and the rest of the code works off the effectively read-only <code>IPerson</code>. The number of classes that implement an interface is irrelevant IMO."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559751995, "post_id": 56462484, "comment_id": 99520591, "body": "@MathieuGuindon - yes, an interface can be a level of abstraction for properties and methods which themselves are a level of abstraction from fields. As far as API go like <code>IXmlDomElement</code>, there seems to be a place for interfaces in restricting access to the underlying class."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1559826935, "post_id": 56462484, "comment_id": 99547106, "body": "Interfaces are the only way to provide abstraction, not inheritance and the VBA language doesn&#39;t come with a convention for naming interfaces. The convention from your answer is from .NET, not VBA. See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/implements-statement\" rel=\"nofollow noreferrer\">Implements statement</a>."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": true, "score": 3, "last_activity_date": 1559749011, "last_edit_date": 1559749011, "creation_date": 1559744647, "answer_id": 56462484, "question_id": 56461992, "link": "https://stackoverflow.com/questions/56461992/why-do-some-classes-have-an-i-in-front-of-their-name/56462484#56462484", "title": "Why do some classes have an &quot;I&quot; in front of their name?", "body": "<p>Note that <code>VBA</code> supports interfaces, just as <code>C#/VB.NET</code> do (almost). Interfaces are the <em>only</em> way to provide inheritance mechanisms in <code>VBA</code>. </p>\n\n<blockquote>\n  <p><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/program-structure/naming-conventions\" rel=\"nofollow noreferrer\">By convention</a> interfaces start their name with the capital letter <code>I</code>. </p>\n</blockquote>\n\n<p>Here is an example interface declaration that states an object must define a name property</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>[File: IHasName.cls, Instancing: PublicNotCreatable] \nOption Explicit\n\nPublic Property Get Name() As String\nEnd Property\n</code></pre>\n\n<p>As you can see there is no implementation required.</p>\n\n<p>Now to create an object that uses the interface to advertise that it contains a name property. Of course, the point is that there are multiple classes that use the one interface.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>[File: Person.cls, Instancing: Private]\nOption Explicit\nImplements IHasName\n\nPrivate m_name As String\n\nPrivate Sub Class_Initialize()\n    m_name = \"&lt;Empty&gt;\"\nEnd Sub\n\n' Local property\nPublic Property Get Name() as String\n    Name = m_name\nEnd Property\n\nPublic Property Let Name(ByVal x As String)\n    m_name = x\nEnd Property\n\n' This is the interface implementation that relies on local the property `Name` \nPrivate Property Get IHasName_Name() As String\n    IHasName_Name = Name\nEnd Property\n</code></pre>\n\n<p>As a convenience in the UI once you include the <code>Implements</code> statement you can choose the interface properties from the top</p>\n\n<p><a href=\"https://i.stack.imgur.com/gwu3D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gwu3D.png\" alt=\"scr\"></a></p>\n\n<p>And to consume the above code use the following test, which calls a function that can take any object that implements <code>IHasName</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>[File: Module1.bas]\nOption Explicit\n\nPublic Sub TestInterface()\n\n    Dim target As New Person\n    target.Name = \"John\"\n\n    GenReport target\n    ' This prints the name \"John\".\nEnd Sub\n\nPublic Function GenReport(ByVal obj As IHasName)\n    Debug.Print obj.Name\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559746259, "post_id": 56462780, "comment_id": 99517420, "body": "<i>but a have a very poor support for it</i> - citation needed, ideally not coming from some hater that believes VBA is a toy language. Not supporting class inheritance is hardly making a dent in OOP support. <a href=\"https://github.com/rubberduck-vba/Battleship\" rel=\"nofollow noreferrer\">Here&#39;s some full-blown OOP VBA code</a> that&#39;s arguably better written than many implementations written in Java, C#, or other inheritance-supporting languages. You can&#39;t write a Model-View-Controller app in a language that has &quot;poor support&quot; for OOP. Consider removing that useless jab."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1559748131, "post_id": 56462780, "comment_id": 99518514, "body": "I am not a VBA hater. I have done a lot of cool things with it. But since I am programming in VB.NET and C#, I don&#39;t want to go back to VBA. OO design is a principle that you can even apply to languages not having classes etc. I do not pretend that you cannot write good OOP code in VBA/VB6, just the support is not comparable to the one you have in VB.NET/C#. No inheritance, no constructors, limited type system. Where are <code>List(Of T)</code>, <code>Dictionary(Of K, V)</code> etc. <code>Collection</code> is a monster trying to implement both of them but having a lot of limitations. <code>On Error Resume Next</code> ugh!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559748831, "post_id": 56462780, "comment_id": 99518926, "body": "I didn&#39;t mean to call <i>you</i> a VBA hater - that didn&#39;t come across as I intended, sorry. Constructors have nothing to do with OOP capabilities, and factories work beautifully in VBA/VB6 to achieve the same purpose (parameterized initialization of an object). The amazing type system in .NET, with generics (<code>Of T</code>), only appeared in .NET 2.0; before that, you had <code>ArrayList</code>, which was the very same kind of monster <code>Collection</code> is, plus all the value-type boxing penalties. OERN, absolutely agree, but that again has nothing to do with OOP. Comparing C# 7 /current VB to VB6 is just unfair ;-)"}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 0, "last_activity_date": 1559746010, "last_edit_date": 1559746010, "creation_date": 1559745658, "answer_id": 56462780, "question_id": 56461992, "link": "https://stackoverflow.com/questions/56461992/why-do-some-classes-have-an-i-in-front-of-their-name/56462780#56462780", "title": "Why do some classes have an &quot;I&quot; in front of their name?", "body": "<p><code>I</code> stands for interface. VBA and older Visual Basic dialects up to VB 6.0 are said to be object oriented but a have a very poor support for it. For example, there is no class inheritance. Nevertheless, you can declare and implement interfaces in VBA/VB6; however, there is no <code>Interface</code> keyword as there is a <code>Class</code> keyword. Instead, you just declare a class with empty Subs, Functions and Properties.</p>\n\n<p>Example. In a Class named <code>IComparable</code>, declare a <code>Function CompareTo</code>:</p>\n\n<pre><code>Public Function CompareTo(ByVal other As Object) As Long\n    'Must return -1, 0 or +1, if current object is less than, equal to or greater than obj.\n    'Must be empty here.\nEnd Function\n</code></pre>\n\n<p>Now you can declare classes that implement this interface. E.g. a Class named <code>clsDocument</code>:</p>\n\n<pre><code>Implements IComparer\n\npublic Name as String\n\nPrivate Function IComparable_CompareTo(other As Variant) As Long\n    IComparable_CompareTo = StrComp(Name, other.Name, vbTextCompare)\nEnd Function\n</code></pre>\n\n<p>Now, this lets you create search and sorting algorithms that you can apply to different class types that implement this method. Example of a class called <code>Document</code></p>\n\n<pre><code>Option Explicit\n\nImplements IComparable\n\nPublic Name As String\nPublic FileDate As Date\n\nPublic Function IComparable_CompareTo(ByVal other As Object) As Long\n    Dim doc As Document, comp As Long\n\n    Set doc = other\n    comp = StrComp(Me.Name, doc.Name, vbTextCompare)\n    If comp = 0 Then\n        If Me.FileDate &lt; doc.FileDate Then\n            IComparable_CompareTo = -1\n        ElseIf Me.FileDate &gt; doc.FileDate Then\n            IComparable_CompareTo = + 1\n        Else\n            IComparable_CompareTo = 0\n        End If\n    Else\n        IComparable_CompareTo = comp\n    End If\nEnd Function\n</code></pre>\n\n<p>Here an example of a QuickSort for VBA. It assumes that you pass it an array of IComparables:</p>\n\n<pre><code>Public Sub QuickSort(ByRef a() As IComparable)\n'Sorts a unidimensional array of IComparable's in ascending order very quickly.\n    Dim l As Long, u As Long\n\n    l = LBound(a)\n    u = UBound(a)\n    If u &gt; l Then\n        QS a, l, u\n    End If\nEnd Sub\n\nPrivate Sub QS(ByRef a() As IComparable, ByVal Low As Long, ByVal HI As Long)\n'Very fast sort: n Log n comparisons\n    Dim i As Long, j As Long, w As IComparable, x As IComparable\n\n    i = Low:   j = HI\n    Set x = a((Low + HI) \\ 2)\n    Do\n        While a(i).CompareTo(x) = -1:   i = i + 1:   Wend\n        While a(j).CompareTo(x) = 1:   j = j - 1:   Wend\n        If i &lt;= j Then\n            Set w = a(i):   Set a(i) = a(j):   Set a(j) = w\n            i = i + 1:   j = j - 1\n        End If\n    Loop Until i &gt; j\n    If Low &lt; j Then QS a, Low, j\n    If HI &gt; i Then QS a, i, HI\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 86, "user_id": 1892858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0db715a0ae2766cd8e91526d624ac0?s=128&d=identicon&r=PG", "display_name": "Joshua McVey", "link": "https://stackoverflow.com/users/1892858/joshua-mcvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 2, "accepted_answer_id": 56462484, "answer_count": 3, "score": 5, "last_activity_date": 1559749011, "creation_date": 1559742963, "last_edit_date": 1559743960, "question_id": 56461992, "link": "https://stackoverflow.com/questions/56461992/why-do-some-classes-have-an-i-in-front-of-their-name", "title": "Why do some classes have an &quot;I&quot; in front of their name?", "body": "<p>I'm working with some legacy code in Visual Basic 98, and there are several classes with an \"I\" in front of their name.  Most of the classes don't have this name, however.</p>\n\n<p>Here's the contents of the IXMLSerializable.cls file.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Serialization XML:\n'       Create and receive complete split data through XML node\nPublic Property Let SerializationXML(ByVal p_sXML As String)\nEnd Property\nPublic Property Get SerializationXML() As String\nEnd Property\n\nPublic Property Get SerializationXMLElement() As IXMLDOMElement\nEnd Property\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1559743905, "post_id": 56461967, "comment_id": 99516042, "body": "You need to include a header row when using AF, otherwise the first entry will be treated as such."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559743981, "post_id": 56461967, "comment_id": 99516098, "body": "^^ So possibly change both instances of <code>DataBodyRange</code> to <code>Range</code>."}, {"owner": {"reputation": 29, "user_id": 11604295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886b92fad785ec43f1f17ad6c5d047ee?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/11604295/simon"}, "edited": false, "score": 0, "creation_date": 1559745048, "post_id": 56461967, "comment_id": 99516702, "body": "Changing to range on either one throws the runtime error &quot;The extract range has a missing or invalid field name&quot;.  I tried clearing both the databodyrange and the headerrowrange, but to no avail."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559745387, "post_id": 56461967, "comment_id": 99516908, "body": "What are the headers for the source column and the destination column?"}, {"owner": {"reputation": 29, "user_id": 11604295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886b92fad785ec43f1f17ad6c5d047ee?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/11604295/simon"}, "edited": false, "score": 0, "creation_date": 1559745554, "post_id": 56461967, "comment_id": 99517013, "body": "The value for both headers is &quot;Service Rep&quot;, and the name for the source is &quot;Y12&quot;, the name for the dest is &quot;A31&quot;.  I don&#39;t see how the value or names should impact the copy"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1559758755, "post_id": 56461967, "comment_id": 99523322, "body": "I think we need to see a data sample that illustrates the problem to be able to help. Preferably upload a file to some sharing site, and post a link here.  Or create a table as text, perhaps using this <a href=\"https://www.tablesgenerator.com/markdown_tables\" rel=\"nofollow noreferrer\">Markdown Tables Generator</a>,"}, {"owner": {"reputation": 29, "user_id": 11604295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886b92fad785ec43f1f17ad6c5d047ee?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/11604295/simon"}, "edited": false, "score": 0, "creation_date": 1559767579, "post_id": 56461967, "comment_id": 99527053, "body": "Just got around to trying it on a different workbook and it worked.  However, the name for the first cell is changed to &quot;Extract&quot; again, not sure why"}], "owner": {"reputation": 29, "user_id": 11604295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886b92fad785ec43f1f17ad6c5d047ee?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/11604295/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559742854, "creation_date": 1559742854, "question_id": 56461967, "link": "https://stackoverflow.com/questions/56461967/advanced-filter-of-unique-values-from-column-copies-duplicate-values", "title": "Advanced Filter of unique values from column copies duplicate values", "body": "<p>I am trying to copy the unique values of a column from sourceTable to destTable by using this line of code:</p>\n\n<pre><code>sourceTable.DataBodyRange.Columns(myCol).AdvancedFilter _ \n  Action:=xlFilterCopy, CopyToRange:=destTable.DataBodyRange.Cells(1, 1), _\n  Unique:=True\n</code></pre>\n\n<p>This copies all the unique values, but it adds the first value of the sourceTable column twice.  A workaround could be to delete the first row of destTable, but I'd like to know why this happens.</p>\n\n<p>Additionally, the name of the cell that the duplicated value is changed to something else by excel.  It depends on the table, but for example, the name of first cell change to \"Extract\" instead of \"A28\" (Appears as \"Extract\" in name manager).  Any explanation of this would be nice as well.</p>\n"}, {"tags": ["excel", "vba", "activex", "commandbutton"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559741808, "post_id": 56461552, "comment_id": 99514766, "body": "By chance are you working with the file on a second monitor? A <a href=\"https://stackoverflow.com/questions/56265391/excel-active-x-button-cannot-be-clicked/\">similar question</a> was asked recently. I have had the same issue."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 2, "creation_date": 1559744127, "post_id": 56461552, "comment_id": 99516184, "body": "It&#39;s why I stopped using ActiveX controls.  They have a nasty habit of moving, ghosting, growing, shrinking and generally not doing what they are told."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559744262, "post_id": 56461552, "comment_id": 99516250, "body": "@Gareth couldn&#39;t agree with you more."}, {"owner": {"reputation": 1, "user_id": 11604274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9e27f2681eca2d07eb4738ffdc01ec?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Caflisch", "link": "https://stackoverflow.com/users/11604274/scott-caflisch"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559826764, "post_id": 56461552, "comment_id": 99546990, "body": "@BigBen That solved the problem...thank you for your help with this."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6711312, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hNoAs.jpg?s=128&g=1", "display_name": "Drinkwater", "link": "https://stackoverflow.com/users/6711312/drinkwater"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742524, "creation_date": 1559742524, "answer_id": 56461845, "question_id": 56461552, "link": "https://stackoverflow.com/questions/56461552/second-action-button-displaying-in-excel-vba-but-i-cannot-select-it/56461845#56461845", "title": "Second action button displaying in excel VBA, but I cannot select it", "body": "<p>Try to select one button and use 'Tab' Key to select next one</p>\n"}], "owner": {"reputation": 1, "user_id": 11604274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9e27f2681eca2d07eb4738ffdc01ec?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Caflisch", "link": "https://stackoverflow.com/users/11604274/scott-caflisch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559742524, "creation_date": 1559741578, "last_edit_date": 1559741828, "question_id": 56461552, "link": "https://stackoverflow.com/questions/56461552/second-action-button-displaying-in-excel-vba-but-i-cannot-select-it", "title": "Second action button displaying in excel VBA, but I cannot select it", "body": "<p>I'm new to using VB w/ excel, so please forgive my lack of technical verbiage.</p>\n\n<p>I recently received a new laptop, and transfered an excel file from my old laptop with VB setup to automatically generate reports. On the new laptop, when I click on my Active X Command Buttons, a smaller duplicate button appears. For some of these buttons, I can double click and the needed action is performed if that second button is under my mouse icon. For others (see picture), this second button displays, but when I move my mouse to get to it, it disappears.</p>\n\n<p>Any help in resolving this would be greatly appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IFDYR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IFDYR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 1, "user_id": 11421585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ADOUQa6WmBg/AAAAAAAAAAI/AAAAAAAAENY/3kmoYNOF-wU/photo.jpg?sz=128", "display_name": "sandeep jadhav", "link": "https://stackoverflow.com/users/11421585/sandeep-jadhav"}, "edited": false, "score": 0, "creation_date": 1559745436, "post_id": 56461973, "comment_id": 99516939, "body": "@sandeepjadhav Glad it helped, don&#39;t forget to mark it as correct so others might find it."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742889, "creation_date": 1559742889, "answer_id": 56461973, "question_id": 56461476, "link": "https://stackoverflow.com/questions/56461476/insert-row-after-specific-no-of-rows/56461973#56461973", "title": "Insert row after Specific no of rows", "body": "<p>This should do It:</p>\n\n<pre><code>Option Explicit\nSub Match()\n\n    Dim MyRow As Long\n\n    With ThisWorkbook.Sheets(\"MySheet\") 'Change MySheet for your sheet name\n        MyRow = WorksheetFunction.Match(.Range(\"C8\").Value, .Range(\"B1:B1000\"), 0) + 1\n        .Rows(MyRow).Insert\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11421585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ADOUQa6WmBg/AAAAAAAAAAI/AAAAAAAAENY/3kmoYNOF-wU/photo.jpg?sz=128", "display_name": "sandeep jadhav", "link": "https://stackoverflow.com/users/11421585/sandeep-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559742899, "creation_date": 1559741343, "last_edit_date": 1559742899, "question_id": 56461476, "link": "https://stackoverflow.com/questions/56461476/insert-row-after-specific-no-of-rows", "title": "Insert row after Specific no of rows", "body": "<p>I Have a list of candidates and i need to insert a row after a name which i will select after drop down in another cell.</p>\n\n<p>Let's say i have 5 candidates a, b,c, d,e and I select candidate b in the dropdown I need a VBA code to insert row under candidate brow.  </p>\n\n<pre><code>Sub Match()\nRange(\"C9\").Value = WorksheetFunction.Match(Range(\"C8\").Value, Range(\"B1:B1000\"), 0)\n</code></pre>\n\n<p>I have a drop down in cell c8 and i have a list of the name in the column now i am where i can find where is that text but i am unable to insert a row under it please help</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1559741195, "post_id": 56461354, "comment_id": 99514376, "body": "You&#39;ll have to rebuild an array without that as an entry. No direct delete as far as I know. Maybe a different data structure like a dictionary would be easier? See --&gt; <a href=\"https://stackoverflow.com/a/915333/4839827\">stackoverflow.com/a/915333/4839827</a> for an intro"}, {"owner": {"reputation": 191, "user_id": 10609408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05205d061d53c93f7dc53cfec02ec877?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10609408/tom"}, "edited": false, "score": 3, "creation_date": 1559741296, "post_id": 56461354, "comment_id": 99514429, "body": "<a href=\"https://stackoverflow.com/a/7000798/10609408\">You can find your answer here.</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1559741519, "post_id": 56461354, "comment_id": 99514571, "body": "This one would be pretty much ok - <code>myArray(1, 1) = &quot;&quot;</code> If you want to redim later, you would get an array of unequal array and most probably this would be a bad architecture."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1559764551, "post_id": 56461354, "comment_id": 99525747, "body": "@ClausMaier, posted a solution for a <b>simple* and reusable **element deletion routine</b> with the sole difference that you get a <b>1-based</b> resulting array. It&#39;s using the advanced possibilities of the <b><code>Application.Index</code> function</b> - c.f. article treating <a href=\"https://stackoverflow.com/questions/51688593/excel-vba-insert-new-first-column-in-datafield-array-without-loops-or-api-call/51714153#51714153\">Some pecularities of the Application.Index function</a>."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1559764980, "post_id": 56461354, "comment_id": 99525947, "body": "@ClausMaier - edited evident enumeration error in your original array assignment; BTW don&#39;t use a reserved function like <code>Array</code> to name an array, name it <code>arr</code> for instance as in my post; would appreciate some response if helpful :-;"}], "answers": [{"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1559743305, "last_edit_date": 1559743305, "creation_date": 1559742443, "answer_id": 56461820, "question_id": 56461354, "link": "https://stackoverflow.com/questions/56461354/excel-vba-arrays-is-there-a-simple-way-to-delete-a-dataset-by-the-index/56461820#56461820", "title": "Excel VBA Arrays: Is there a simple way to delete a dataset by the index?", "body": "<p>try this for 1d arrays</p>\n\n<pre><code>Sub test()\nDim strr As String\nstrr = \"0|1|2|3|5\"\nwArr = Split(strr, \"|\")\nd = DeleteElementAt(2, strr)\nEnd Sub\n\n\nFunction DeleteElementAt(ByVal index As Integer, ByRef prLsts, strDelimeter) As String\n       Dim i As Integer\n        Dim newLst\n        ' Move all element back one position\n        prLst = Split(prLsts, strDelimeter)\n        If UBound(prLst) &gt; 0 Then\n            ReDim newLst(UBound(prLst) - 1)\n            For i = 0 To UBound(prLst)\n                If i &lt;&gt; index Then newLst(y) = prLst(i): y = y + 1\n            Next\n            DeleteElementAt = Join(newLst, strDelimeter)\n        Else\n            DeleteElementAt = prLsts\n        End If\n\nEnd Function\n</code></pre>\n\n<p>for 2D array</p>\n\n<pre><code>Function Delete2dElementAt(ByVal index As Integer, ByRef prLsts) As Variant\n       Dim i As Integer\n        Dim newLst\n        ' Move all element back one position\n        prLst = prLsts\n        If index &gt; UBound(prLst) Then MsgBox \"overcome index\": Exit Function\n        If UBound(prLst) &gt; 0 Then\n            ReDim newLst(UBound(prLst) - 1, UBound(prLst, 2))\n            For i = 0 To UBound(prLst)\n                If i &lt;&gt; index Then\n                    For Z = LBound(prLst, 2) To UBound(prLst, 2)\n                        newLst(y, Z) = prLst(i, Z)\n                    Next Z\n                    y = y + 1\n                End If\n            Next\n            Delete2dElementAt = newLst\n        Else\n            Delete2dElementAt = prLsts\n        End If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1559765550, "last_edit_date": 1559765550, "creation_date": 1559763979, "answer_id": 56467038, "question_id": 56461354, "link": "https://stackoverflow.com/questions/56461354/excel-vba-arrays-is-there-a-simple-way-to-delete-a-dataset-by-the-index/56467038#56467038", "title": "Excel VBA Arrays: Is there a simple way to delete a dataset by the index?", "body": "<p><strong>Simple Procedure call close to your post, but returning a 1-based array</strong></p>\n\n<p>Using the advanced possibilities of the <code>Application.Index</code> function I demonstrate an approach close to your wanted pseudo-method <code>array.delete(1)</code> in OP:</p>\n\n<pre><code>  delArr arr, 2            ' see section [1] in the Example call below\n</code></pre>\n\n<p>where </p>\n\n<ul>\n<li><code>delArr</code> is the calling procedure, </li>\n<li><code>arr</code> is the array name (don't use a <em>reserved function's name</em> to <em>baptize</em> your array!) and </li>\n<li><code>2</code> is the element row number as <code>Application.Index</code> returns only <strong>1-based</strong> arrays.</li>\n</ul>\n\n<p><strong>Example call</strong></p>\n\n<pre><code>Sub DelGivenElementNumber()\n  Dim arr() As Variant, i As Long\n  ReDim arr(1 To 3, 1 To 3)                 ' redimension to 1-based array :-)\n  arr(1, 1) = \"abc\": arr(1, 2) = \"Peter\": arr(1, 3) = \"New York\"\n  arr(2, 1) = \"xyz\": arr(2, 2) = \"Bob\": arr(2, 3) = \"Los Angeles\"\n  arr(3, 1) = \"klm\": arr(3, 2) = \"Stacey\": arr(3, 3) = \"Seattle\"\n\n' --------------------------------\n' [1] delete element row  number 2          ' i.e. xyz|Bob|Los Angeles\n' --------------------------------\n  delArr arr, 2\n\n' [2] optionally: check remaining element rows (now 1-based!)\n  For i = LBound(arr) To UBound(arr)\n      Debug.Print i, dispArrElements(arr, i)\n  Next i\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Result of the restructured 1-based array in the VBE's immediate window:</p>\n</blockquote>\n\n<pre><code>1   abc, Peter, New York\n2   klm , Stacey, Seattle\n</code></pre>\n\n<p><strong>Main procedure <code>delArr</code></strong></p>\n\n<p>The main procedure <code>delArr</code> is only a <em>one liner</em> and has only two arguments: </p>\n\n<ol>\n<li>the data array itself passed <em>by reference</em> and </li>\n<li>the 'row' number to be deleted (1-based, e.g. 2 represents the second element row):</li>\n</ol>\n\n<pre><code>Sub delArr(arr, r As Long)\n    arr = Application.Index(arr, validRows(arr, r), allCols(UBound(arr, 2)))\nEnd Sub\n\n</code></pre>\n\n<p><strong>Helper functions</strong></p>\n\n<p>The main procedure uses two helper functions to get arrays with the remaining row numbers and column numbers (here: <code>Array(1,2,3)</code> for e.g. three columns).</p>\n\n<pre><code>Function validRows(arr, ByVal n&amp;) As Variant()\n' Purpose: get 0-based 1-dim Array(1,3), i.e. all remaining original row numbers counting from 1, omitting 2\n  Dim i&amp;, nRows&amp;\n  nRows = UBound(arr) - LBound(arr) + 1                           ' original row number\n  ReDim tmp(0 To nRows - 2)                                       ' zero-based tmp counter: -1, omitting element n: -1 ~~&gt; -2\n  For i = 1 To n - 1                                              ' collect elements before element n\n      tmp(i - 1) = i\n  Next i\n  For i = n To nRows - 1                                          ' collect elements after element n\n      tmp(i - 1) = i + 1                                          ' count old row numbers, but with reduced tmp counter\n  Next i\n'  Debug.Print Join(tmp, \"|\")\n  validRows = Application.Transpose(tmp)                          ' return array of found row numbers\nEnd Function\n\nFunction allCols(ByVal n&amp;) As Variant()\n' Purpose: get 0-based 1-dim Array(1,2,... n), i.e. all column numbers\n  allCols = Application.Transpose(Evaluate(\"row(1:\" &amp; n &amp; \")\"))\nEnd Function\n\n</code></pre>\n\n<p><strong>Optional function to display results</strong></p>\n\n<p>Uses the <code>Join</code> function to display one row element with all three columns of your example (see section <strong><code>[2]</code></strong> in the example call):</p>\n\n<pre><code>Function dispArrElements(arr, r As Long) As String\n  dispArrElements = Join(Application.Transpose(Application.Transpose(Application.Index(arr, r, 0))), \", \")\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9131274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff3271092d269820727d577654ed8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Claus Maier", "link": "https://stackoverflow.com/users/9131274/claus-maier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1559765550, "creation_date": 1559740862, "last_edit_date": 1559764765, "question_id": 56461354, "link": "https://stackoverflow.com/questions/56461354/excel-vba-arrays-is-there-a-simple-way-to-delete-a-dataset-by-the-index", "title": "Excel VBA Arrays: Is there a simple way to delete a dataset by the index?", "body": "<p>Is there a simple method to remove a specific data set from an array by the index?</p>\n\n<p>Example:</p>\n\n<pre><code>Dim array() as string\n\nReDim array(2,2)\n\narray(0,0) = \"abc\"\narray(0,1) = \"Peter\"\narray(0,2) = \"New York\"\n\narray(1,0) = \"xyz\"\narray(1,1) = \"Bob\"\narray(1,2) = \"Los Angeles\"\n\narray(2,0) = \"klm\"                       ' edited (enumeration error in OP)\narray(2,1) = \"Stacey\"\narray(2,2) = \"Seattle\"\n\n</code></pre>\n\n<p>So my array shows at<br>\n0: abc, Peter,New York<br>\n1: xyz, Bob, Los Angeles<br>\n2: klm, Stacey, Seattle</p>\n\n<p>I now know from a previous calculation I don't need Bob at <strong>index 1</strong> anymore and I want to delete his record</p>\n\n<p>Is there something simple like the following?</p>\n\n<pre><code>ReDim Preserve array(UBound(array) - 1)\narray.delete(1)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559741480, "post_id": 56461348, "comment_id": 99514547, "body": "It looks like you&#39;re working with tables. If so, I&#39;d recommend using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobject\" rel=\"nofollow noreferrer\"><code>ListObject</code></a>."}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559741845, "post_id": 56461348, "comment_id": 99514798, "body": "Hi @BigBen, well I just named my range &quot;Table1&quot; because it is a small section of a table. I am considering it just a normal range."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559741878, "post_id": 56461348, "comment_id": 99514825, "body": "Ah ok, just wanted to clarify."}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559751207, "post_id": 56461348, "comment_id": 99520187, "body": "Thank you @BigBen"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1559751145, "post_id": 56461686, "comment_id": 99520160, "body": "Thank you @Error 1004, this also works well :) I never normally use Option Explicit, what are it&#39;s main use cases?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 1, "creation_date": 1559751319, "post_id": 56461686, "comment_id": 99520236, "body": "@PKen here&#39;s the  <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/option-explicit-statement\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> documentation. It&#39;s recommended to always use it. In the VB Editor, click <i>Tools</i> &gt; <i>References</i> &gt; <i>Require Variable Declaration</i> to set this as default."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742492, "last_edit_date": 1559742492, "creation_date": 1559742002, "answer_id": 56461686, "question_id": 56461348, "link": "https://stackoverflow.com/questions/56461348/determine-if-a-named-range-exists-if-so-copy-it-if-not-move-on/56461686#56461686", "title": "Determine if a Named Range exists, if so copy it, if not move on", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim tbl As ListObject\n    Dim ws As Worksheet\n\n    'Loop all worksheets\n    For Each ws In ThisWorkbook.Worksheets\n        'Loop all tables - Listobjects\n        For Each tbl In ws.ListObjects\n\n            If tbl.Name = \"Table1\" Then\n\n            End If\n\n        Next tbl\n\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p><strong>OR:</strong></p>\n\n<pre><code>Sub test()\n\n    Dim strNameRange\n    Dim ws As Worksheets\n\n    For Each strNameRange In ThisWorkbook.Names\n\n        If strNameRange.Name = \"Table1\" Then\n\n        End If\n\n    Next strNameRange\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1559742162, "creation_date": 1559742162, "answer_id": 56461730, "question_id": 56461348, "link": "https://stackoverflow.com/questions/56461348/determine-if-a-named-range-exists-if-so-copy-it-if-not-move-on/56461730#56461730", "title": "Determine if a Named Range exists, if so copy it, if not move on", "body": "<p>Here is an answer for Named Ranges specifically.</p>\n\n<pre><code>Public Sub ExampleUsage()\n    Debug.Print DoesNameRangeExist(\"Table1\")\nEnd Sub\n\nPublic Function DoesNameRangeExist(ByVal NameOfRange As String) As Boolean\n    Dim NamedRanges    As Names\n    Dim Name           As Name\n\n    Set NamedRanges = ThisWorkbook.Names\n    DoesNameRangeExist = False\n\n    For Each Name In NamedRanges\n        If Name.Name = NameOfRange Then\n            DoesNameRangeExist = True\n            Exit For\n        End If\n    Next\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 56461730, "answer_count": 2, "score": 0, "last_activity_date": 1559751168, "creation_date": 1559740853, "last_edit_date": 1559751168, "question_id": 56461348, "link": "https://stackoverflow.com/questions/56461348/determine-if-a-named-range-exists-if-so-copy-it-if-not-move-on", "title": "Determine if a Named Range exists, if so copy it, if not move on", "body": "<p>I am trying to determine if a Named Range exists in my spreadsheet. If it doesn't exist, I do not want to set a variable to it. If it does exist, I want to set a variable to it. </p>\n\n<p>I have tried the following, but I can't seem to get the wording quite right. </p>\n\n<pre><code>If RangeExist(\"Table1\") &lt;&gt; 0 Then\n    Set QuBuild = ThisWorkbook.Worksheets(\"Features\").Range(\"Table1\")\nElse\nEnd If\n</code></pre>\n\n<p>If the named range \"Table1\" exists, I want to set it to the variable \"QuBuild\" to do something with later on (paste the table into word). If it doesn't exist, I don't want to set \"QuBuild\"equal to anything.</p>\n\n<p>Any help would be much appreciated!!</p>\n"}, {"tags": ["java", "excel", "vba", "apache-poi", "xlsm"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1559793675, "post_id": 56461251, "comment_id": 99532430, "body": "A <code>*.xlsx</code> file cannot contain macros, only <code>*.xlsm</code> can. And the recovery log shown has nothing to do with macro removing. A worksheet and the calculation chain was removed. And your code shown does simple things which thousands  of other <code>apache poi</code> users also are doing without problems. So your problems are not related to the code but probably to the used file where <code>Vars.XLS</code> points to. So no help possible without having that file."}], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1559817854, "post_id": 56461771, "comment_id": 99542092, "body": "I don&#39;t get error message, but file size is smaller after modification than original one, but I added a few more lines."}], "tags": [], "owner": {"reputation": 6211, "user_id": 3127812, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81cf3f200d376af31dd7642634ae192f?s=128&d=identicon&r=PG&f=1", "display_name": "Sambit", "link": "https://stackoverflow.com/users/3127812/sambit"}, "is_accepted": true, "score": 1, "last_activity_date": 1559742293, "creation_date": 1559742293, "answer_id": 56461771, "question_id": 56461251, "link": "https://stackoverflow.com/questions/56461251/apache-poi-to-keep-predefined-macros-after-editing/56461771#56461771", "title": "Apache POI to keep predefined macros after editing", "body": "<p>You are trying to update an excel sheet. In case of updation, you should not create row or cell, rather you have to read the cell. I provide below the brief code snippet, you can try.</p>\n\n<pre><code>XSSFRow row = sheet.getRow(some number);\nCell cell = row.getCell(some number);\ncell.setCellValue(recordcount);\n</code></pre>\n"}], "owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 1, "accepted_answer_id": 56461771, "answer_count": 1, "score": 0, "last_activity_date": 1559742293, "creation_date": 1559740456, "question_id": 56461251, "link": "https://stackoverflow.com/questions/56461251/apache-poi-to-keep-predefined-macros-after-editing", "title": "Apache POI to keep predefined macros after editing", "body": "<p>I have <code>XLSX</code> and <code>XLSM</code> files which contains some predefined macros. I try to use <code>Apache POI</code> to edit these files, but macros are removed automatically. I get a notification window when I try to open file after modification, that files are removed, because file is broken:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;recoveryLog xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"&gt;\n    &lt;logFileName&gt;error066080_01.xml&lt;/logFileName&gt;\n    &lt;summary&gt;Error in file (C:\\_privat\\completeReport.xlsm)&lt;/summary&gt;\n    &lt;removedRecords&gt;\n        &lt;removedRecord&gt;/xl/worksheets/sheet1.xml&lt;/removedRecord&gt;\n        &lt;removedRecord&gt;/xl/calcChain.xml&lt;/removedRecord&gt;\n    &lt;/removedRecords&gt;\n&lt;/recoveryLog&gt;\n</code></pre>\n\n<p>I use following code to handle fle, <code>Vars.XLS</code> contains path to a <code>XLSX/XLSM</code> file.       </p>\n\n<pre><code>File file = new File(Vars.XLS);\nFileInputStream inputStream = new FileInputStream(file);\nXSSFWorkbook workbook = XSSFWorkbookFactory.createWorkbook(inputStream);\nXSSFSheet sheet = workbook.getSheetAt(0);\nXSSFRow row = sheet.createRow(recordcount+4);\nCell cell;\n\ncell = row.createCell(0);\ncell.setCellValue(recordcount);\n\ninputStream.close();\nFileOutputStream fileOut=new FileOutputStream(Vars.XLS);\nworkbook.write(fileOut);\nfileOut.close();\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "conditional-formatting"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559740809, "post_id": 56461026, "comment_id": 99514158, "body": "And do you expect all values with 4, 3 and 2 to be highlighted? Or just the first 4, 3 and 2?"}, {"owner": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559742321, "post_id": 56461026, "comment_id": 99515119, "body": "yes, all values should be highlighted (3 x &quot;4&quot;, 3 x &quot;3&quot; and 3 x &quot;2&quot;) and that&#39;s the problem."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559750336, "post_id": 56461945, "comment_id": 99519779, "body": "Wow. Thank you a lot for quick answer and great idea. I can\u2019t wait to test it. Thanks again!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559756141, "post_id": 56461945, "comment_id": 99522348, "body": "No worries, let me know how it goes"}, {"owner": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559802389, "post_id": 56461945, "comment_id": 99534565, "body": "It works great! Thank you. I have one more question: is there a way to do it more dynamic? When the number of top values is determined based on the number of rows?  In my case there is a threshold (sometimes there are top 3 or 5 or 10 to be highlighted). Is there a way to pass it as argument in function? If there are no duplicates, \u201cLARGE\u201d function works perfectly but if there are any, the list of highlighted cells is not complete. I was thinking about an array in VBA to store unique (top) values and then in a loop I would check the entire range but maybe there is more sophisticated way?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559803133, "post_id": 56461945, "comment_id": 99534859, "body": "@Cammil, I&#39;m not sure it&#39;s possible using dynamic ranges AND dynamic number of top values through conditional formatting. If you decide to go VBA route, fille a background is not the same as applying a conditional formatting to a cell. Just be aware of that and I&#39;m sure it won&#39;t be too hard. In this case VBA might be just elegant enough :)"}, {"owner": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559806212, "post_id": 56461945, "comment_id": 99536179, "body": "Thank you again for quick answer. Well, this is what I was afraid of. So, I need to drop the idea of using conditional formatting. Let me try with VBA then. Nevertheless, \u201cthe trick\u201d with 3 formulas you provided I will use in the future for sure. Thanks again \ud83d\ude0a"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559841179, "post_id": 56461945, "comment_id": 99554752, "body": "If you can use on more column it can become very easy without vba, but that&#39;s up to you! @Cammil"}, {"owner": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "edited": false, "score": 0, "creation_date": 1559916187, "post_id": 56461945, "comment_id": 99580565, "body": "Well, I wish I could. Unfortunately, I cannot modify the worksheet (columns are fixed). So, the only way is to create a macro but thank you anyway."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1559742803, "creation_date": 1559742803, "answer_id": 56461945, "question_id": 56461026, "link": "https://stackoverflow.com/questions/56461026/conditional-formatting-highlight-top-3-problem-with-duplicates/56461945#56461945", "title": "Conditional Formatting - highlight &quot;Top 3&quot; - Problem with duplicates", "body": "<p>So here is one way to do what you want:</p>\n\n<p>Create three new conditional formatting rules:</p>\n\n<ol>\n<li><p>Apply to range <code>$A:$A</code></p>\n\n<pre><code>=$A1=MAX($A$1:$A$12)\n</code></pre></li>\n<li><p>Apply to range <code>$A:$A</code></p>\n\n<pre><code>=$A1=LARGE(($A$1:$A$12&lt;MAX($A$1:$A$12))*($A$1:$A$12),1)\n</code></pre></li>\n<li><p>Apply to range <code>$A:$A</code></p>\n\n<pre><code>=$A1=LARGE(($A$1:$A$12&lt;LARGE(($A$1:$A$12&lt;MAX($A$1:$A$12))*($A$1:$A$12),1))*($A$1:$A$12),1)\n</code></pre></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/vLHdh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vLHdh.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can also go the VBA route but that's up to you.</p>\n"}], "owner": {"reputation": 1, "user_id": 5520514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d84ccd486778dc7d3ec6bcc78ab6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Cammil", "link": "https://stackoverflow.com/users/5520514/cammil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559742803, "creation_date": 1559739600, "last_edit_date": 1559741399, "question_id": 56461026, "link": "https://stackoverflow.com/questions/56461026/conditional-formatting-highlight-top-3-problem-with-duplicates", "title": "Conditional Formatting - highlight &quot;Top 3&quot; - Problem with duplicates", "body": "<p>I have a set of data (numbers) in one column. What I wanted to achieve is to highlight (directly in this column) top 3 values. It works fine  if there are no duplicates but if there are any, I got wrong result (duplicates are considered as unique values).</p>\n\n<p>I wrote a simple function (please see it below), however it doesn't work as well. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function isTop(cellTop As Range, rngTop As Range, noTop As Integer) As Boolean\n\n'cellTop - cell to be checked\n'rngTop - range to be considered\n'noTop - nth top value\n\nDim iStartTop As Integer, noOccurTop As Integer, noTopUpdate As Integer\n\n    For iStartTop = 1 To noTop\n\n        If cellTop.Value = Application.WorksheetFunction.Large(rngTop, iStartTop) Then\n            isTop = True\n            Exit Function\n        End If\n\n    Next iStartTop\n\nEnd Function\n</code></pre>\n\n<p>Let's assume that there is the following set of data (12 elements) available in column A:</p>\n\n<pre><code>1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n</code></pre>\n\n<p>and I want to highlight top 3 elements (by using conditional formatting and either standard top 3 condition or function =isTop(A1,A:A,3)). After applying any of provided methods, only cells containing \"4\" will be highlighted. </p>\n\n<p>However, I expect to have \"4\", \"3\" and \"2\" highlighted. Is there a way to solve this problem if duplicates are present in a given column? </p>\n\n<p>Thank you in advance for your help.\nBest Regards,\nKamil</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559739397, "post_id": 56460897, "comment_id": 99513339, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20687810/vba-macro-that-search-for-file-in-multiple-subfolders\">VBA macro that search for file in multiple subfolders</a>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1559739633, "post_id": 56460897, "comment_id": 99513481, "body": "There are a few things to consider here: Are there any subfolders, what to do if the file isn&#39;t found, the pdf you are looking for needs to be an EXACT match to the filename (otherwise it isn&#39;t found)."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11077504"}, "edited": false, "score": 0, "creation_date": 1559742245, "post_id": 56461074, "comment_id": 99515068, "body": "Thanks that helps a lot. Is there a way to splash page with this line ThisWorkbook.FollowHyperlink sPath &amp; pdfname"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1559744195, "post_id": 56461074, "comment_id": 99516224, "body": "@TechTutors - you are welcome. What do you mean with &quot;splash page&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11077504"}, "edited": false, "score": 0, "creation_date": 1559800110, "post_id": 56461074, "comment_id": 99533839, "body": "Set the height and width of the dimensions of the pdf to half the screen?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11077504"}, "edited": false, "score": 0, "creation_date": 1559815417, "post_id": 56461074, "comment_id": 99540849, "body": "Please see my answer. I have one line barring me from completing the code"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1559827285, "post_id": 56461074, "comment_id": 99547351, "body": "@TechTutors - which line?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1559739761, "creation_date": 1559739761, "answer_id": 56461074, "question_id": 56460897, "link": "https://stackoverflow.com/questions/56460897/is-there-a-way-to-write-a-search-find-and-open-in-vba/56461074#56461074", "title": "Is there a way to write a search, find and open in vba?", "body": "<p>As far as you give the directory in which to \"search\" it is not a real search. Pretty much, everything needed could be just in one line: </p>\n\n<p><code>ThisWorkbook.FollowHyperlink S:\\PROFILE ORDERS\\somePdf.pdf</code> </p>\n\n<p>the rest depends on how do you want to aproach it. The code below would throw an error, if there is no such file in the specified directory.</p>\n\n<pre><code>Sub OpenPdf()\n\n    On Error GoTo OpenPdf_Error\n\n    Dim pdfname As String\n    Const sPath = \"C:\\Users\\gropc\\Desktop\\\"\n\n    pdfname = Application.InputBox(\"Enter the pdf you are looking for\")\n    pdfname = pdfname &amp; \".pdf\"\n\n    ThisWorkbook.FollowHyperlink sPath &amp; pdfname\n\n    On Error GoTo 0\n    Exit Sub\n\nOpenPdf_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure OpenPdf\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1559827441, "post_id": 56475303, "comment_id": 99547437, "body": "<a href=\"https://www.google.com/search?q=array+starting+at+1&amp;safe=strict&amp;source=lnms&amp;tbm=isch\" rel=\"nofollow noreferrer\">Why are your arrays starting from 1?</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11077504"}, "is_accepted": false, "score": 1, "last_activity_date": 1559815420, "creation_date": 1559815420, "answer_id": 56475303, "question_id": 56460897, "link": "https://stackoverflow.com/questions/56460897/is-there-a-way-to-write-a-search-find-and-open-in-vba/56475303#56475303", "title": "Is there a way to write a search, find and open in vba?", "body": "<pre><code>Sub OpenPdf()\n\n    On Error GoTo OpenPdf_Error\n\n    Dim pdfname As String\n    Dim pdf\n    Const sPath = \"S:\\RA QUOTES 2019\"\n    Dim FName As String\n    Dim arNames() As String\n    Dim myCount As Integer\n    Dim i As Integer\n\n    FName = Dir(\"S:\\RA QUOTES 2019\\*.pdf*\")\n    Do Until FName = \"\"\n        myCount = myCount + 1\n        ReDim Preserve arNames(1 To myCount)\n        arNames(myCount) = FName\n        FName = Dir\n        Loop\n\n\n    pdfname = Application.InputBox(\"Enter the pdf you are looking for\")\n    pdfname = \"PLQ\" &amp; pdfname\n\n\n\n\nFor i = 1 To UBound(arNames)\n\nIf IsInArray(pdfname, arNames(i)) = True Then\n\n    ThisWorkbook.FollowHyperlink sPath &amp; arNames(i)\n\n     End If\n\n    Next i\n\n    On Error GoTo 0\n    Exit Sub\n\nOpenPdf_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure OpenPdf\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11077504"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559815420, "creation_date": 1559739213, "last_edit_date": 1559739393, "question_id": 56460897, "link": "https://stackoverflow.com/questions/56460897/is-there-a-way-to-write-a-search-find-and-open-in-vba", "title": "Is there a way to write a search, find and open in vba?", "body": "<p>I am writing a code but dont know what the syntax is. I just want my code to search and find a pdf</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub open1()\n\nDim pdfname As String\nConst sPath = \"S:\\PROFILE ORDERS\\\"\nDim path1\n\npdfname = Application.InputBox(\"Enter the pdf you are looking for\")\npdfname = pdfname &amp; \".pdf\"\n\npath1 = Dir(sPath &amp; pdfname)\n\npath1.Open\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "analytics"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559740008, "post_id": 56460894, "comment_id": 99513725, "body": "What is <code>Regress</code> supposed to do? As for the alerts, if I&#39;m not wrong, that function (Regress) should have an alerts supress as well in order to not get any. If you can paste the content of that function here as well, or at least the top bit, to see what parameters are expected. Also, in the loop... all you want to achieve is to run that command? Last question... Are your sheet names all <code>SPCS0000XX</code> ? Starting at <code>SPCS000001</code> ending at <code>SPCS000101</code> ? Or what are the 2 sheet names to exclude."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559741706, "post_id": 56460894, "comment_id": 99514696, "body": "@DarXyde &quot;Regress&quot; is Linnear Regression function in the Data Analysis Toolpack. In terms of the loop I just want to go from Sheet3 to Sheet103, the names of the sheets are not a specific order or order in their name. The 2 sheets to exclude perhaps more simply are &quot;Data&quot; and &quot;Summary&quot; I did try DIM XRange and Range, Dim YRange as Range and Dim ORange as Range, and setting them but it would not work."}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1559765493, "post_id": 56462643, "comment_id": 99526138, "body": "Wouldn&#39;t the last row be found with <code>.End(xlDown).Row</code> instead of <code>.End(xlUp).Row</code>?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1559892011, "post_id": 56462643, "comment_id": 99568345, "body": "@ja72 nope, xlUP is better (starting from rows.count, which is all rows in the sheet)."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 1, "last_activity_date": 1559822089, "last_edit_date": 1559822089, "creation_date": 1559745156, "answer_id": 56462643, "question_id": 56460894, "link": "https://stackoverflow.com/questions/56460894/time-series-analysis-in-excel-using-vba/56462643#56462643", "title": "Time Series Analysis in Excel using VBA", "body": "<p>Ranges can be set programatically and you can refer to them with a variable instead of Activesheet. You can use a loop in which you can assemble the name of the sheet. So I'd do something like this: </p>\n\n<pre><code>    Dim iLastRow as Long, i As Long\n    Dim rC as Range, rL as Range, rS as Range\n    Dim sh As Worksheet\n\n    For i = 3 to 101\n        sSheetName = \"SPCS\" &amp; Format(i, \"000000\")\n        Set sh = Sheets(sSheetName)\n        If Err.Number &lt;&gt; 0 Then      ' check success\n            Debug.Print \"Error with sheet \" &amp; sSheetName\n        Else\n            iLastRow = sh.Cells(sh.Rows.Count, 1).End(xlUp).Row\n            Set rL = Range(sh.Cells(2, 12), sh.Cells(iLastRow, 12)  ' L column\n            Set rC = Range(sh.Cells(2, 3), sh.Cells(iLastRow, 3)    ' C column\n            Set rS = Range(sh.Cells(2, 19), sh.Cells(iLastRow, 19)   ' S column\n\n            Application.Run \"ATPVBAEN.XLAM!Regress\", rL, rC, False, True, , _\n                     rS, _False, False, False, False, , False\n        End If\n    Next \n</code></pre>\n\n<p>This is just a simple hint. You'll need to add quite a few more lines to make it robust like checking iLastRow for 0 or success of <code>Set rX</code> but for the first try it will do. For the alert I think others have already hit this issue, see this: <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/84268-suppress-overwrite-existing-data-alert-in-vba-macro\" rel=\"nofollow noreferrer\">suppress-overwrite-existing-data-alert-in-vba-macro</a> ATPVBAEM looks ignoring/overwriting <code>DisplayAlert</code> setting. </p>\n\n<p>EDIT: finding last row is corrected, thanx @ja72</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "edited": false, "score": 0, "creation_date": 1559858760, "post_id": 56466198, "comment_id": 99561357, "body": "thanks, that makes sense. My only question from that is can there be anything done in terms of the variable ranges? The range will change every month. So this month it will be .Range($L$2:$L$43) and .Range($L$2:$L$43). The range is taken from column F. It needs to go down from row 2, to the row that displays last month but come January 2020 it will go back to row 39."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "edited": false, "score": 0, "creation_date": 1559892456, "post_id": 56466198, "comment_id": 99568539, "body": "Assuming <code>&quot;$S$33&quot;</code> is always the same, see the updated answer to take in consideration possible different number of rows."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1559892324, "last_edit_date": 1559892324, "creation_date": 1559759723, "answer_id": 56466198, "question_id": 56460894, "link": "https://stackoverflow.com/questions/56460894/time-series-analysis-in-excel-using-vba/56466198#56466198", "title": "Time Series Analysis in Excel using VBA", "body": "<p>Haven't had time to answer earlier... this is another way to do it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TSA()\n\nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\nEnd With\n\nDim wb As Workbook: Set wb = ActiveWorkbook 'or ThisWorkbook, or Workbooks(\"book name\")\nDim ws As Worksheet, rng As Range\n\n\nFor Each ws In wb.Worksheets\n    'Alternatively: If ws.Name &lt;&gt; \"Data\" And ws.Name &lt;&gt; \"Summary\" Then\n    Set rng = ws.Range(\"C2:C\" &amp; ws.Cells(Rows.Count, \"C\").End(xlUp).Row)\n\n    If Left(ws.Name, 4) = \"SPCS\" Then\n        With ws\n            Application.Run \"ATPVBAEN.XLAM!Regress\", _\n                            .Range(rng.Offset(0, 9)), _\n                            .Range(rng), _\n                            False, _\n                            True, _\n                            , _\n                            .Range(\"$S$33\") '_\n                            ', False, False, False, False, , False\n\n        'Since most of the parameters are optional, and last ones you are only passing false values, you can ditch them.\n            'uncomment them above if you get any weird results because a false value was actually required\n        End With\n    End If\nNext ws\n\nWith Application\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Sadly that message box is built in the AddIn itself, and even if you have the password to the AddIn (<code>Wildebeest!!</code>), given the actual function is stored in <code>ANALYS32.XLL</code> file), you won't be able to do much about it.</p>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563328164, "creation_date": 1559739206, "last_edit_date": 1563328164, "question_id": 56460894, "link": "https://stackoverflow.com/questions/56460894/time-series-analysis-in-excel-using-vba", "title": "Time Series Analysis in Excel using VBA", "body": "<p>I have a workbook with up to 103 sheets.</p>\n\n<ul>\n<li>101 sheets will have a different product volume for Time Series Analysis.</li>\n<li>There is a RAW data tab from which each sheet will pull through the initial volume data.</li>\n<li>There is a summary sheet which is formulated to pull through 12 month forecast for all 101 items.</li>\n</ul>\n\n<p>I want to loop from Sheet 3 to 103 and automate the data analysis, regression part of Time Series Analysis to get the time series data refreshed onto the summary sheet.</p>\n\n<p>I have created a code below to show what I have tried. The issue I am getting is:</p>\n\n<ul>\n<li>I have to click \"Yes\" to overwriting the previous regression data which is in range $S$33 in each sheet. I thought that Application.DisplayAlerts = False would fix that.</li>\n<li>Each month the ranges will change. It will always start at $L$2 and $C$2 however needs to run down to the previous month. (Please see highlighted below) we are in Jun-19 now so it needs to range from $L$2 to $L$43 and $C$2 to $C$43 as Line 43 is the line of May-19.</li>\n</ul>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Sub TSA ()\n\n    '\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    '\n    Sheets(\"SPCS000052\").Activate\n         Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$L$2:$L$42\"), _\n            ActiveSheet.Range(\"$C$2:$C$42\"), False, True, , ActiveSheet.Range(\"$S$33\") _\n            , False, False, False, False, , False\n\n    Sheets(\"SPCS000053\").Activate\n         Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$L$2:$L$42\"), _\n            ActiveSheet.Range(\"$C$2:$C$42\"), False, True, , ActiveSheet.Range(\"$S$33\") _\n            , False, False, False, False, , False\n\n    Sheets(\"SPCS000130\").Activate\n         Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$L$2:$L$42\"), _\n            ActiveSheet.Range(\"$C$2:$C$42\"), False, True, , ActiveSheet.Range(\"$S$33\") _\n            , False, False, False, False, , False\n\n    Sheets(\"SPCS000078\").Activate\n         Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$L$2:$L$42\"), _\n            ActiveSheet.Range(\"$C$2:$C$42\"), False, True, , ActiveSheet.Range(\"$S$33\") _\n            , False, False, False, False, , False\n\n    Sheets(\"SPCS000063\").Activate\n         Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$L$2:$L$42\"), _\n            ActiveSheet.Range(\"$C$2:$C$42\"), False, True, , ActiveSheet.Range(\"$S$33\") _\n            , False, False, False, False, , False\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dvxDK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dvxDK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "selenium", "xpath", "google-chrome-headless"], "comments": [{"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "edited": false, "score": 0, "creation_date": 1559740270, "post_id": 56460451, "comment_id": 99513864, "body": "I have tried with python selenium  with chrome headless mode and it is working fine."}, {"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "edited": false, "score": 0, "creation_date": 1559740339, "post_id": 56460451, "comment_id": 99513911, "body": "No need to use indexes since it is only element  <code>&#47;&#47;span[@class=&#39;LrzXr zdqRlf kno-fv&#39;]</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559740431, "post_id": 56460451, "comment_id": 99513964, "body": "What error message are you getting and on which line?"}, {"owner": {"reputation": 1, "user_id": 11582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081156d05d818643ab45079681bea99e?s=128&d=identicon&r=PG&f=1", "display_name": "Sakyo", "link": "https://stackoverflow.com/users/11582368/sakyo"}, "reply_to_user": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "edited": false, "score": 0, "creation_date": 1559743814, "post_id": 56460451, "comment_id": 99515995, "body": "@KunduK : It works well on Python for me as well, but i don&#39;t know why it doesn&#39;t work with VBA on Excel on <b>headless mode</b>. It&#39;s fine in <b>normal mode</b> with VBA."}, {"owner": {"reputation": 1, "user_id": 11582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081156d05d818643ab45079681bea99e?s=128&d=identicon&r=PG&f=1", "display_name": "Sakyo", "link": "https://stackoverflow.com/users/11582368/sakyo"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559743816, "post_id": 56460451, "comment_id": 99515996, "body": "@QHarr With this code i don&#39;t have error, program just doesn&#39;t go inside the &quot;If&quot; loop."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081156d05d818643ab45079681bea99e?s=128&d=identicon&r=PG&f=1", "display_name": "Sakyo", "link": "https://stackoverflow.com/users/11582368/sakyo"}, "edited": false, "score": 0, "creation_date": 1559744055, "post_id": 56461309, "comment_id": 99516140, "body": "I tried to put 10sec waiting time, it&#39;s doesn&#39;t help in headless mode. (I can&#39;t wait to a specific element because it will return an error instead of let me handle the case in which no element was founded)"}, {"owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "reply_to_user": {"reputation": 1, "user_id": 11582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081156d05d818643ab45079681bea99e?s=128&d=identicon&r=PG&f=1", "display_name": "Sakyo", "link": "https://stackoverflow.com/users/11582368/sakyo"}, "edited": false, "score": 0, "creation_date": 1559744265, "post_id": 56461309, "comment_id": 99516253, "body": "@Sakyo : Can resize your window and check what you are getting?"}, {"owner": {"reputation": 1, "user_id": 11582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081156d05d818643ab45079681bea99e?s=128&d=identicon&r=PG&f=1", "display_name": "Sakyo", "link": "https://stackoverflow.com/users/11582368/sakyo"}, "edited": false, "score": 0, "creation_date": 1559744994, "post_id": 56461309, "comment_id": 99516669, "body": "I tried some random sizes, 2160x3840 and 1080x1920. It&#39;s the same, it didn&#39;t find element."}], "tags": [], "owner": {"reputation": 26505, "user_id": 10885684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b93ef11f20d07cf796af83ae1ffe83?s=128&d=identicon&r=PG&f=1", "display_name": "KunduK", "link": "https://stackoverflow.com/users/10885684/kunduk"}, "is_accepted": false, "score": 0, "last_activity_date": 1559740688, "creation_date": 1559740688, "answer_id": 56461309, "question_id": 56460451, "link": "https://stackoverflow.com/questions/56460451/selenium-vba-cant-find-xpath-with-google-chrome-in-headless-mode/56461309#56461309", "title": "Selenium [VBA] : Can&#39;t find XPath with Google Chrome in Headless mode", "body": "<p>I have verified with <code>python selenium</code> with chrome headless mode and it is working fine every time i run this code.\nI have used <code>WebdriverWait</code> which is explicit wait and wait for element to be clickable and then fetch the text value.</p>\n\n<p>I believe you can modify this code in <code>VBA</code>.</p>\n\n<pre><code>from selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\n\nchrome_options = webdriver.ChromeOptions()\nchrome_options.add_argument('--headless')\nchrome_options.add_argument('window-size=1920x1080');\ndriver=webdriver.Chrome(options=chrome_options)\ndriver.get(\"https://www.google.com\")\ndenomination = \"Fnac Lyon Bellecour\"\nadresse = \"85 Rue de la R\u00e9publique 69002 Lyon\"\nelement=driver.find_element_by_name('q')\nelement.send_keys(denomination + ' ' + adresse)\nelement.submit()\nprint(WebDriverWait(driver,10).until(EC.element_to_be_clickable((By.XPATH,\"//span[@class='LrzXr zdqRlf kno-fv']\"))).text)\n</code></pre>\n\n<h2>Output:</h2>\n\n<blockquote>\n  <p>+33 825 02 00 20</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 11582368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081156d05d818643ab45079681bea99e?s=128&d=identicon&r=PG&f=1", "display_name": "Sakyo", "link": "https://stackoverflow.com/users/11582368/sakyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 806, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559740688, "creation_date": 1559737458, "question_id": 56460451, "link": "https://stackoverflow.com/questions/56460451/selenium-vba-cant-find-xpath-with-google-chrome-in-headless-mode", "title": "Selenium [VBA] : Can&#39;t find XPath with Google Chrome in Headless mode", "body": "<p>I try to get informations from Google like mobile number for some shops/companies, and store it on a Excel sheet. I use Chrome driver (<em>v_74.0.3729.6</em>). \nIt works fine with Chrome in <strong>normal mode</strong>, it finds element with XPath, but when I use Chrome in <strong>headless mode</strong>, it doesn't find the element.</p>\n\n<p>I tried to change the size of the window and to add some options:</p>\n\n<pre><code>        .AddArgument (\"--window-size=1920,1080\")\n        .AddArgument (\"--no-sandbox\")\n        .AddArgument (\"--start-maximized\")\n        .AddArgument (\"--disable-gpu\")\n        .AddArgument (\"--disable-extensions\")\n</code></pre>\n\n<p>But no one works... \nI've also tried differents XPath (but if it works without headless mode, i suppose the XPath is correct):</p>\n\n<pre><code>browser.FindElementsByXPath(\"(//span[@class='LrzXr zdqRlf kno-fv'])[1]\")\nbrowser.FindElementsByXPath(\"//*[@id='uid_6']/div[1]/div[2]/div[4]/div/div/span[2]\")\n</code></pre>\n\n<p>I've also tried to put a waiting time (to be sure the page is fully loaded):\nApplication.Wait (Now + TimeValue(\"0:00:2\"))</p>\n\n<pre><code>Dim browser As New ChromeDriver\n\nWith browser\n        .AddArgument (\"--window-size=2160,3840\")\n        .AddArgument (\"--headless\")\nEnd With\n\ndenomination = \"Fnac Lyon Bellecour\"\nadresse = \"85 Rue de la R\u00e9publique 69002 Lyon\"\nbrowser.Get (\"https://www.google.com\")\nbrowser.FindElementByName(\"q\").SendKeys (denomination &amp; \" \" &amp; adresse)\nSendKeys \"~\"\n\nApplication.Wait (Now + TimeValue(\"0:00:2\"))\n\nIf browser.FindElementsByXPath(\"(//span[@class='LrzXr zdqRlf kno-fv'])[1]\").Count &gt;= 1 Then\n    telephone = browser.FindElementByXPath(\"(//span[@class='LrzXr zdqRlf kno-fv'])[1]\").Text\n    Sheets(\"Donnees\").Cells(1, 13).Value = telephone\nEnd If\n</code></pre>\n\n<p>It normally copy the mobile number of the shop in cell M1 but it can't find the element.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559737849, "post_id": 56460432, "comment_id": 99512425, "body": "This question is directly related to <a href=\"https://stackoverflow.com/questions/56458158/when-a-cell-value-changes-copy-the-column-from-where-the-cell-value-changed-to\">this one</a>. Have you tried changing around the numbers that make up the cells row and column?"}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1559738316, "post_id": 56460432, "comment_id": 99512685, "body": "just change a 4 to 0 or 1!"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559747164, "post_id": 56460432, "comment_id": 99517978, "body": "yes, i have tried a lot, but strangely it&#39;s not working. i don&#39;t know the exact reason"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559748152, "post_id": 56460432, "comment_id": 99518522, "body": "if you have understand the problem, and can throw some light on it, then it will be appriciated"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559747412, "post_id": 56460563, "comment_id": 99518126, "body": "actually, i have tried above code, which should logically work, but id doesn&#39;t for detailed understanding of problem, i would like to request you to refer to given link (<a href=\"https://stackoverflow.com/questions/56458158/when-a-cell-value-changes-copy-the-column-from-where-the-cell-value-changed-to\" title=\"when a cell value changes copy the column from where the cell value changed to\">stackoverflow.com/questions/56458158/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": true, "score": 4, "last_activity_date": 1559740594, "last_edit_date": 1559740594, "creation_date": 1559737901, "answer_id": 56460563, "question_id": 56460432, "link": "https://stackoverflow.com/questions/56460432/change-range-in-coding/56460563#56460563", "title": "Change range in coding", "body": "<p>For the <code>cells</code> function, the first parameter is the row, and the second is the column, so keep the first part the same (same row), and change the second instead (changing column D->I):</p>\n\n<pre><code>Dim wsSou As Worksheet, wsDes As Worksheet\n\nwsDes.Range(wsDes.Cells(Target.Row - 4, 4), wsDes.Cells(Target.Row - 4, 9)).Value = _\nwsSou.Range(wsSou.Cells(Target.Row - 4, 4), wsSou.Cells(Target.Row - 4, 9)).Value\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56460563, "answer_count": 1, "score": 1, "last_activity_date": 1559740594, "creation_date": 1559737402, "last_edit_date": 1559737572, "question_id": 56460432, "link": "https://stackoverflow.com/questions/56460432/change-range-in-coding", "title": "Change range in coding", "body": "<p>I have coding where range of D4:D8 is selected but i want to get range D4:I4 instead of D4:D8.</p>\n\n<p>I have tried following code</p>\n\n<pre><code>Dim wsSou As Worksheet, wsDes As Worksheet\n\nwsDes.Range(wsDes.Cells(Target.Row - 4, 4), wsDes.Cells(Target.Row, \n4)).Value = wsSou.Range(wsSou.Cells(Target.Row - 4, 4), \nwsSou.Cells(Target.Row, 4)).Value\n</code></pre>\n\n<p>above code is as per range D4:D8, Whereas i want to ge range D4:I4.</p>\n\n<p>thank you.</p>\n"}, {"tags": ["vba", "powerpoint", "pane"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1559748694, "post_id": 56460286, "comment_id": 99518844, "body": "I&#39;m all but certain that what you&#39;ve found is all there IS to find. I don&#39;t think there&#39;s any object model access to Selection, Animation, etc. panes. It&#39;d be a useful thing, though; please consider submitting a feature request to <a href=\"https://powerpoint.uservoice.com\" rel=\"nofollow noreferrer\">powerpoint.uservoice.com</a>  The program managers/developers really do watch what&#39;s submitted there."}], "owner": {"reputation": 11, "user_id": 11603798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kEUuR.jpg?s=128&g=1", "display_name": "J Goodman", "link": "https://stackoverflow.com/users/11603798/j-goodman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593729646, "creation_date": 1559736847, "last_edit_date": 1593729646, "question_id": 56460286, "link": "https://stackoverflow.com/questions/56460286/is-there-a-command-to-toggle-the-animation-pane-and-or-selection-pane", "title": "Is there a command to toggle the Animation Pane and/or Selection Pane?", "body": "<p>Is there a VBA command that will allow me to toggle panes such as the Animation and Selection? </p>\n\n<p>These panes close themselves when I close the file. I would like to be able to set up my environment the way I like in one click. Bonus points if I can position the pane with x,y coordinates.</p>\n\n<p>The commands that I've seen apply only to Notes, Slide Sorter and Normal views.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 2, "creation_date": 1559737311, "post_id": 56460211, "comment_id": 99512131, "body": "Sadly, no. You&#39;ll have to do a workaround using other events, such as <code>KeyUp</code> or <code>MouseDown</code>, or a combination."}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1559737516, "post_id": 56460211, "comment_id": 99512254, "body": "@DarXyde Good to Know, at least I can prepare for that at my leisure :-) Thanks"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1559739360, "post_id": 56460211, "comment_id": 99513317, "body": "You could catch the event itself (every event) and look which control fired it. see here for Enter: <a href=\"https://stackoverflow.com/questions/51930517/trigger-enter-field-behaviour-through-class-for-a-control/51936950#51936950\" title=\"trigger enter field behaviour through class for a control\">stackoverflow.com/questions/51930517/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1559747138, "post_id": 56460211, "comment_id": 99517960, "body": "Background as to why you aren&#39;t getting these events: They belong to the more general <code>Control</code>  class, from which the other controls &quot;inherit&quot;."}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1559757338, "post_id": 56460211, "comment_id": 99522766, "body": "@Cindy Meister Thanks Cindy was hoping someone might clarify that"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1559757902, "post_id": 56460211, "comment_id": 99522981, "body": "@EvR Thanks for that - It looks promising will take me some time to check it out"}, {"owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1559764930, "post_id": 56460211, "comment_id": 99525929, "body": "@EvR I tried Siddharths answer first but it hogs the processor, then tried your Answer worked too but no processor hogging - Upvoted your answer. Thanks."}], "owner": {"reputation": 1050, "user_id": 1302114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62492e08dd49b458a61a9cfab144c92f?s=128&d=identicon&r=PG", "display_name": "Tin Bum", "link": "https://stackoverflow.com/users/1302114/tin-bum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1559737096, "creation_date": 1559736554, "last_edit_date": 1559737096, "question_id": 56460211, "link": "https://stackoverflow.com/questions/56460211/class-object-textbox-on-userform-available-methods", "title": "Class Object TextBox on Userform available methods", "body": "<p>I have noticed that when I create a Class Module for a Textbox and use that on my forms - by adding via VBA in the form init event - neither the Enter or Exit methods are available. Of course if I just add a textbox to the form they are.</p>\n\n<p>I can get the DblClick method to work fine so my class is setup correctly and my form.init code is also ok.</p>\n\n<p>When I look in the Object browser for MSForms.TextBox I see it doesn't have Enter or Exit methods and presume this is the reason.</p>\n\n<p>There is no urgency for me on this because I noticed it when building my first form that uses my own classes for textbox - Fortunately for what I'm working on now - I don't actually need the Enter or Exit methods, but thought someone might know if there is a work-around because I may need them in the future and for textboxes they are very useful methods</p>\n\n<p>Here is my Class Code named nxTxtV</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents oTxtV As MSForms.TextBox\n\nPrivate Sub oTxtV_Enter()\n   ' This method never fires\n   MsgBox \"Hello World from the Enter Method\"\nEnd Sub\n\nPrivate Sub oTxtV_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n   ' This method works fine\n   MsgBox \"Hello World from the DoubleClick Method for \" &amp; oTxtV.Value\nEnd Sub\n</code></pre>\n\n<p>and here's my form initialise code</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n   Dim xItm As Control, i As Long\n   Dim dItm As nxTxtV   ' nxTxtV is the name of my class\n\n   For i = 1 To 5\n      Set xItm = Me.Controls.Add(\"Forms.TextBox.1\", \"Column\" &amp; i, True)\n      With xItm\n         .Value = \"P\" &amp; i\n         .AutoSize = False\n         .Font.Size = 9\n         .Width = 25\n         .Height = 250\n         .TextAlign = 2 ' Centred\n         .SpecialEffect = 0\n         .BackColor = RGB(255, 128, 0)\n         .WordWrap = True\n         .Left = 200 + (i * 27)\n         .Top = 5\n         .Enabled = True\n         .Visible = True\n      End With\n      Set dItm = New nxTxtV   ' nxTxtV is the name of my class\n      Set dItm.oTxtV = xItm\n      CodedObjs.Add dItm   ' CodedObjs is declared at module level (form level) as a Collection \n   Next i\nEnd Sub\n</code></pre>\n\n<p>In short, can I get my class to react to Enter &amp; Exit events ?</p>\n\n<p>Addendum - the CodedObjs Declaration</p>\n\n<pre><code>Public CodedObjs As New Collection\n</code></pre>\n"}, {"tags": ["excel", "vba", "wildcard"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736640, "post_id": 56460175, "comment_id": 99511798, "body": "So there is always one and only one folder in <code>C:\\BASE</code> that&#39;s name is ended with <code>.cv</code>?"}, {"owner": {"reputation": 3, "user_id": 11603863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad79b87e1f9b09675bfab33f05c7330?s=128&d=identicon&r=PG&f=1", "display_name": "Make465213", "link": "https://stackoverflow.com/users/11603863/make465213"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559737572, "post_id": 56460175, "comment_id": 99512276, "body": "Yes in C:\\BASE\\yyyyyy.c8\\ there is always just one folder with name ending in .cv"}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1559739489, "creation_date": 1559739489, "answer_id": 56460994, "question_id": 56460175, "link": "https://stackoverflow.com/questions/56460175/excel-vba-path-to-folder-with-unknown-foldername-but-known-extension/56460994#56460994", "title": "Excel VBA: path to folder with unknown foldername but known extension", "body": "<p>You could use a function to read a directory to look for a specific suffix and return what the name is:</p>\n\n<pre><code>Function FindFileNameBySuffix(InDir As String, suffix As String)\n\n\n    Dim foundFileName     As String\n    Dim oFile       As Object\n    Dim oFSO        As Object\n    Dim oFolder     As Object\n    Dim oFiles      As Object\n\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = oFSO.GetFolder(InDir)\n    Set oFiles = oFolder.Files\n\n    If oFiles.Count = 0 Then Exit Function\n\n    ReDim vaArray(1 To oFiles.Count)\n\n    For Each oFile In oFiles\n        If Right(oFile.Name, Len(suffix)) = suffix Then\n            FindFileNameBySuffix = oFile.Name\n            Exit Function\n        End If\n    Next\n\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1559739547, "creation_date": 1559739547, "answer_id": 56461013, "question_id": 56460175, "link": "https://stackoverflow.com/questions/56460175/excel-vba-path-to-folder-with-unknown-foldername-but-known-extension/56461013#56461013", "title": "Excel VBA: path to folder with unknown foldername but known extension", "body": "<p>Going by this statement</p>\n\n<blockquote>\n  <p>Yes in C:\\BASE\\yyyyyy.c8\\ there is always just one folder with name ending in .cv</p>\n</blockquote>\n\n<p>I borrowed this code form <a href=\"https://www.mrexcel.com/forum/excel-questions/650268-excel-vba-get-full-folder-name-folder-path-wildcard.html\" rel=\"nofollow noreferrer\">here</a> and tweaked it a little</p>\n\n<pre><code>Sub Find_SubFolder()\n    Dim sFile As String, sPathSeek As String, sPathMatch As String\n\n    Const sMainPath As String = \"C:\\BASE\\yyyyyy.c8\\\"\n\n    On Error Resume Next\n    sPathSeek = sMainPath &amp; \"*.cv\"\n    sFile = Dir(sPathSeek, vbDirectory)\n\n    Do While Len(sFile) &gt; 0\n        If Left(sFile, 1) &lt;&gt; \".\" Then\n            If (GetAttr(sFile) And vbDirectory) = vbDirectory Then\n                sPathMatch = sFile\n                Exit Do\n            End If\n        End If\n        sFile = Dir\n    Loop\n\n    'From here you can put your code to save your file...\n    Debug.print \"C:\\BASE\\yyyyyy.c8\\\" &amp; sPathMatch &amp; \"\\\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11603863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad79b87e1f9b09675bfab33f05c7330?s=128&d=identicon&r=PG&f=1", "display_name": "Make465213", "link": "https://stackoverflow.com/users/11603863/make465213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 56461013, "answer_count": 2, "score": 0, "last_activity_date": 1559742483, "creation_date": 1559736379, "last_edit_date": 1559742483, "question_id": 56460175, "link": "https://stackoverflow.com/questions/56460175/excel-vba-path-to-folder-with-unknown-foldername-but-known-extension", "title": "Excel VBA: path to folder with unknown foldername but known extension", "body": "<p>I have this <code>Excel</code> file that I use to modify and export datasets. It exports to the same folder, located in:</p>\n\n<pre><code>C:\\BASE\\yyyyyy.c8\\xxxxxx.cv\\Addresses.xlsm\n</code></pre>\n\n<p>I'd like to store this <code>.xlsm</code> in:</p>\n\n<pre><code>C:\\BASE\\yyyyyy.c8\\\n</code></pre>\n\n<p>instead, but I still need to export to the </p>\n\n<pre><code>C:\\BASE\\yyyyyy.c8\\xxxxxx.cv\\\n</code></pre>\n\n<p>folder. However this is tricky as the <code>xxxxxx.cv</code> foldername changes project to project, however the <code>.cv</code> extension of this foldername is always the same.</p>\n\n<p>Currently it uses following to make export files to root folder of the excel file:</p>\n\n<pre><code>convFileName = ActiveWorkbook.Path &amp; \"\\conv\" &amp; convTableNumber\n</code></pre>\n\n<p>I'd like it to work essensially like this, obviously this doesn't work, but how would I achieve this functionality?</p>\n\n<pre><code> convFileName = ActiveWorkbook.Path &amp; \\*.cv &amp; \"\\conv\" &amp; convTableNumber\n</code></pre>\n\n<p>Edit. Solution:</p>\n\n<pre><code>Dim sFile As String, sPathSeek As String, sPathMatch As String\nOn Error Resume Next\nsPathSeek = ActiveWorkbook.Path &amp; \"\\*.cv\"\nsFile = Dir(sPathSeek, vbDirectory)\n\nDo While Len(sFile) &gt; 0\n    If Left(sFile, 1) &lt;&gt; \".\" Then\n        If (GetAttr(sFile) And vbDirectory) = vbDirectory Then\n            sPathMatch = sFile\n            Exit Do\n        End If\n    End If\n    sFile = Dir\nLoop\n\nconvFileName = ActiveWorkbook.Path &amp; \"\\\" &amp; sPathMatch &amp; \"\\conv\" &amp; convTableNumber\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1559736282, "post_id": 56460133, "comment_id": 99511631, "body": "Please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1559739552, "post_id": 56460133, "comment_id": 99513438, "body": "Also consider using explicit references to <code>Worksheets</code> and <code>Workbooks</code> instead of <code>ActiveSheet</code> et al which make the code unreadable and unreliable."}], "owner": {"reputation": 1, "user_id": 11603883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tuPqt3lDGHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmRy3QGrHynyJiasL1n6ZyNLX_SQ/mo/photo.jpg?sz=128", "display_name": "SiyaG", "link": "https://stackoverflow.com/users/11603883/siyag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559822107, "creation_date": 1559736202, "last_edit_date": 1559822107, "question_id": 56460133, "link": "https://stackoverflow.com/questions/56460133/how-to-fix-run-time-error-5-when-using-vba-to-filter-excel", "title": "How to fix &quot;Run-time error &#39;5&#39; when using vba to filter excel", "body": "<p>I am trying to filter a table based of 2 criteria.</p>\n\n<p>Every time my macro runs, it displays the </p>\n\n<blockquote>\n  <p>Run-time Error '5'. Invalid procedure call or argument.</p>\n</blockquote>\n\n<p>message once it gets to filtering the sheet.</p>\n\n<p>I've switched laptops and copied the macro word by word and saved it in my personal macro book. With my previous laptop, this macro ran without error (my previous laptop was a Lenovo and this one is a Dell).</p>\n\n<p><strong>vba code</strong></p>\n\n<pre><code>Range(\"A2:X2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nActiveSheet.Range(\"A:X\").AutoFilter Field:=16, Criteria1:=\"&lt;&gt;*East*\", Criteria2:=\"&lt;&gt;*VO*\", Operator:= xlFilterValues\nSelection.ClearContents\nActiveSheet.Range(\"A:X\").AutoFilter Field:=16, Criteria1:=\"PR VO\"\nActiveSheet.Range(\"A:X\").AutoFilter Field:=11, Criteria1:=\"&lt;&gt;*EC *\", Operator:= xlFilterValues\nSelection.ClearContents\nActiveSheet.Range(\"A:X\").AutoFilter Field:=11\nActiveSheet.Range(\"A:X\").AutoFilter Field:=16\nActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range (\"A:A\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n   .Header = xlYes\n   .MatchCase = False\n   .Orientation = xlTopToBottom\n   .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>I expect this code to filter the values that do not match the criteria and clear that data. This is basically to filter out candidates for our Eastern Cape Region. The result however, is <code>Run-time Error '5'. Invalid procedure call or argument.</code></p>\n"}, {"tags": [".net", "vba", "sap", "saprfc"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1559742476, "post_id": 56459823, "comment_id": 99515207, "body": "Where is <code>objConnection</code> and <code>funcControl</code> declared? Should they be <code>Objects</code> or <code>Variants</code>?"}, {"owner": {"reputation": 13, "user_id": 10165842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d169952d25f6395d69597afec761bd?s=128&d=identicon&r=PG", "display_name": "zanniboni", "link": "https://stackoverflow.com/users/10165842/zanniboni"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1559742528, "post_id": 56459823, "comment_id": 99515244, "body": "I have tried to declare then as Objects and Variants and the error persists..."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1559742785, "post_id": 56459823, "comment_id": 99515412, "body": "Maybe this will help. <a href=\"https://blogs.sap.com/2007/12/12/accessing-sap-functions-from-excel-using-visual-basic-applications/\" rel=\"nofollow noreferrer\">blogs.sap.com/2007/12/12/&hellip;</a>"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1574261705, "post_id": 56459823, "comment_id": 104169888, "body": "Please let me know if I&#39;m breaking the SO rules here. I&#39;m trying to create traffic on my question by posting a link to it within a related question. I&#39;m hoping we can all solve this problem regardless of programming environment. <a href=\"https://stackoverflow.com/questions/58942674\">link</a>"}], "owner": {"reputation": 13, "user_id": 10165842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d169952d25f6395d69597afec761bd?s=128&d=identicon&r=PG", "display_name": "zanniboni", "link": "https://stackoverflow.com/users/10165842/zanniboni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574204653, "creation_date": 1559735041, "last_edit_date": 1574204653, "question_id": 56459823, "link": "https://stackoverflow.com/questions/56459823/sap-rfc-connection-with-vba-bad-variant-type", "title": "SAP RFC Connection with VBA - BAD VARIANT TYPE", "body": "<p>I'm having a problem with the SAP RFC when I'm trying to download some tables.\nWhen I try to create the connection I get the following error:</p>\n\n<blockquote>\n  <p>Bad Variant Type</p>\n</blockquote>\n\n<p>I checked the regedit registry for RFC and it is all right.</p>\n\n<p>The IT installed the SAP 7.50, but I'm unable to use such version cause it does not allow me to download some tables that I need, so I asked them to make the downgrade to the 7.40 version of SAP.</p>\n\n<p>The problem started just there.</p>\n\n<pre><code>Public Sub conecta_sap()\n\nSet ctlLogon = CreateObject(\"SAP.LogonControl.1\")\nSet funcControl = CreateObject(\"SAP.Functions\")\nSet ctlTableFactory = CreateObject(\"SAP.TableFactory.1\")\nSet objWindowsScriptShell = CreateObject(\"WScript.Shell\")\nSet objConnection = ctlLogon.NewConnection\n\nobjConnection.ApplicationServer = \"XXXXXXXXXX\"\nobjConnection.SystemNumber = \"30\"\nobjConnection.Client = \"300\"\nobjConnection.Language = \"PT\"\nobjConnection.USER = \"RFC_LANCO\"\nobjConnection.Password = \"XXXXXXXX\"\nbooReturn = objConnection.logon(0, True)\n\nIf booReturn &lt;&gt; True Then\n    MsgBox \"Imposs\u00edvel conectar no SAP!\"\n    End\nEnd If\n\nfuncControl.Connection = objConnection\nSet RFC_READ_TABLE = funcControl.Add(\"RFC_READ_TABLE\")\nSet strExport1 = RFC_READ_TABLE.exports(\"QUERY_TABLE\")\nSet strExport2 = RFC_READ_TABLE.exports(\"DELIMITER\")\nSet tblOptions = RFC_READ_TABLE.Tables(\"OPTIONS\")\nSet tblData = RFC_READ_TABLE.Tables(\"DATA\")\nSet tblFields = RFC_READ_TABLE.Tables(\"FIELDS\")\n\nEnd Sub\n</code></pre>\n\n<p>When I reach this line:\n<code>funcControl.Connection = objConnection</code></p>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Erro em tempo de execu\u00e7\u00e3o '-2147352568 (80020008)': Bad variant type</p>\n</blockquote>\n\n<p>Can anyone help me solve this problem?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["regex", "vba", "regex-group"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1559734440, "post_id": 56459639, "comment_id": 99510774, "body": "See <a href=\"https://regex101.com/r/yu2uW6/1\" rel=\"nofollow noreferrer\">regex101.com/r/yu2uW6/1</a>"}, {"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1559734824, "post_id": 56459639, "comment_id": 99510935, "body": "Thats really cool, is it possible for you to let me know the required edits on case 2 in my code"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 1, "creation_date": 1559735204, "post_id": 56459863, "comment_id": 99511107, "body": "Thanks a lot Wiktor, You are a savior!"}, {"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559735746, "post_id": 56459863, "comment_id": 99511371, "body": "Hey Wiktor, sorry i have not mentioned the full case here. so lets say that incase we have recived any inbetween text than the code is not working. see <a href=\"https://regex101.com/r/yu2uW6/3\" rel=\"nofollow noreferrer\">regex101.com/r/yu2uW6/3</a>"}, {"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559735837, "post_id": 56459863, "comment_id": 99511415, "body": "however i just wanted to capture the previous defined value only"}, {"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559736156, "post_id": 56459863, "comment_id": 99511566, "body": "Hey wiktor, i am really inspired with your quick help. can you also help me/ share the link from which we can learn the same."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559736297, "post_id": 56459863, "comment_id": 99511637, "body": "@ayushvarshney I learnt it on SO. I can suggest doing all lessons at <a href=\"http://regexone.com/\" rel=\"nofollow noreferrer\">regexone.com</a>, reading through <a href=\"http://www.regular-expressions.info\" rel=\"nofollow noreferrer\">regular-expressions.info</a>, <a href=\"http://stackoverflow.com/tags/regex/info\">regex SO tag description</a> (with many other links to great online resources), and the community SO post called <a href=\"http://stackoverflow.com/questions/22937618/reference-what-does-this-regex-mean\">What does the regex mean</a>. Also, <a href=\"http://rexegg.com\" rel=\"nofollow noreferrer\">rexegg.com</a> is worth having a look at."}, {"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559738365, "post_id": 56459863, "comment_id": 99512714, "body": "Hey wiktor, really sorry that i am looking for one more help from you... what if the position changes of all the values. see <a href=\"https://regex101.com/r/yu2uW6/6\" rel=\"nofollow noreferrer\">regex101.com/r/yu2uW6/6</a>"}, {"owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559738534, "post_id": 56459863, "comment_id": 99512818, "body": "Also if the column heading is not matching it will skip that value and this will effect the final template."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "edited": false, "score": 0, "creation_date": 1559739578, "post_id": 56459863, "comment_id": 99513454, "body": "@ayushvarshney If you need a more specific solution, you should share the exact data sample (use pastebin.com)."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1559735970, "last_edit_date": 1559735970, "creation_date": 1559735141, "answer_id": 56459863, "question_id": 56459639, "link": "https://stackoverflow.com/questions/56459639/excel-vba-regex-for-fetching-the-values-which-has-specific-text/56459863#56459863", "title": "Excel VBA Regex for fetching the values which has specific text", "body": "<p>You may use</p>\n\n<pre><code>Client:\\s*(.*)[\\r\\n][\\s\\S]*?^Price \\(USD\\):\\s*(.*)[\\r\\n][\\s\\S]*?^Time:\\s*(.*)[\\r\\n][\\s\\S]*?^Project Id:\\s*(\\w+)\n</code></pre>\n\n<p>Make sure you set <code>Reg1.Multiline = True</code>.</p>\n\n<p>See the <a href=\"https://regex101.com/r/yu2uW6/4\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p>The Client details will be in <code>M.SubMatches(0)</code> (Group 1), price info will be in <code>M.SubMatches(1)</code> (Group 2), time details in <code>M.SubMatches(2)</code> (Group 3), and the project ID will be in <code>M.SubMatches(3)</code> (Group 4). </p>\n\n<p>If you need to remove underscores from Group 4, the project ID, just use a post-processing step:</p>\n\n<pre><code>vText4 = Replace(M.SubMatches(3), \"_\", \"\")\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 5582677, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-vKClQ4FQorI/AAAAAAAAAAI/AAAAAAAAAAA/yxqdQk09QJc/photo.jpg?sz=128", "display_name": "ayush varshney", "link": "https://stackoverflow.com/users/5582677/ayush-varshney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56459863, "answer_count": 1, "score": 2, "last_activity_date": 1559735970, "creation_date": 1559734260, "last_edit_date": 1559735748, "question_id": 56459639, "link": "https://stackoverflow.com/questions/56459639/excel-vba-regex-for-fetching-the-values-which-has-specific-text", "title": "Excel VBA Regex for fetching the values which has specific text", "body": "<p>I am new to the vba and trying to solve my situation wherein we recieve multiple mail like below:</p>\n\n<p>we would like to create a database in excel for all the mails which are in my specific folder</p>\n\n<hr>\n\n<p>Package Summary:</p>\n\n<p>Client:  XYZ</p>\n\n<p>Price (USD):  3,000</p>\n\n<p>Time:  1 Week</p>\n\n<p>Project Id:  21312</p>\n\n<hr>\n\n<p>and some more text......</p>\n\n<p>here we would like to capture the information for Client, Price (USD), Time, Project Id.</p>\n\n<p>Have tried below code which capture the information and stores in excel file.</p>\n\n<pre><code>Sub GetFromOutlook()\n\nDim OutlookApp As Outlook.Application\nDim OutlookNamespace As Namespace\nDim Folder As MAPIFolder\nDim OutlookMail As Variant\n'Dim i As Integer\n\nSet OutlookApp = New Outlook.Application\nSet OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\nSet Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Dummy\").Folders(\"New Dummy\")\n\n'i = 1\n\nFor Each OutlookMail In Folder.Items\n\n    Dim sText As String\n\n    sText = OutlookMail.Body\n    Dim Reg1 As RegExp\n    Dim M1 As MatchCollection\n    Dim M As Match\n    Dim vText, vText2, vText3, vText4 As Variant\n    Dim i As Integer\n\n    Set Reg1 = New RegExp\n\n   ' \\s* = invisible spaces\n   ' \\d* = match digits\n   ' \\w* = match alphanumeric\n       For i = 1 To 9\n\n            With Reg1\n                Select Case i\n                Case 1\n                    .Pattern = \"(Client[:]([\\w-\\s]*)\\s*)\\n\"\n                    .Global = False                    \n                Case 2\n                    .Pattern = \"(([\\d]*\\,[\\d]*))\\s*\\n\"\n                    .Global = False\n                Case 3\n                    .Pattern = \"(Time[:]([\\w-\\s]*)\\s*)\\n\"\n                    .Global = False\n                Case 4\n                    .Pattern = \"(Project Id[:]([\\w-\\s]*)\\s*)\\n\"\n                    .Global = False\n\n                End Select\n\n            End With\n\n              If Reg1.Test(sText) Then\n                Set M1 = Reg1.Execute(sText)\n                 Select Case i\n                          Case 1\n                              For Each M In M1\n                                  vText = Trim(M.SubMatches(1))\n                              Next\n                          Case 2\n                              For Each M In M1\n                                  vText2 = Trim(M.SubMatches(1))\n                              Next\n                          Case 3\n                              For Each M In M1\n                                  vText3 = Trim(M.SubMatches(1))\n                              Next\n                          Case 4\n                              For Each M In M1\n                                  vText4 = Trim(M.SubMatches(1))\n                              Next\n\n                End Select\n\n              End If\n        Next i\n\n    Range(\"a1000\").End(xlUp).Offset(1, 0).Value = vText\n    Range(\"b1000\").End(xlUp).Offset(1, 0).Value = vText2\n    Range(\"c1000\").End(xlUp).Offset(1, 0).Value = vText3\n    Range(\"d1000\").End(xlUp).Offset(1, 0).Value = vText4\nNext OutlookMail\n\nSet Folder = Nothing\nSet OutlookNamespace = Nothing\nSet OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>Challenges:</strong></p>\n\n<p><strong>Challenge 1:</strong> if the heading Price (USD) changes to Price (GBP) still its storing the value, which should not be. it should only store the value only if the matching text found.</p>\n\n<p>i tried \"(Price (USD) [:] ([\\d]<em>\\,[\\d]</em>))\\s*\\n\" however its not working.</p>\n\n<p><strong>Challenge 2:</strong> for Project id, value is coming with underscore as well which i am unable to exclude.</p>\n\n<p>Would really appreciate if one can help me solving the above 2 challenge from my code.</p>\n\n<p>or else suggest any better approach for the same.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1559743032, "post_id": 56459355, "comment_id": 99515560, "body": "Please clarify, based on your statement &quot;numbers of text before blank&quot;, are you trying sum values or count text in the column?"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1559746677, "last_edit_date": 1559746677, "creation_date": 1559743965, "answer_id": 56462281, "question_id": 56459355, "link": "https://stackoverflow.com/questions/56459355/sum-until-blank/56462281#56462281", "title": "Sum until blank", "body": "<p>I think you are trying sum the values in multiple ranges separated by a blank cell in \"Col B\". If I am right, here is a simple code that will sum the values in multiple ranges in a \"Col B\" that are separated by a blank cell. The Sum formula will be inserted into \"Col C\" to the right of the first cell in each sumRng. Change the sheet name as required.</p>\n\n<pre><code>For Each sumRng In Sheets(\"Sheet1\").Columns(\"B\").SpecialCells(xlConstants, xlNumbers).Areas\n    sumA = sumRng.Address(False, False)\n    sumRng.Offset(, 1).Resize(1, 1).Formula = \"=SUM(\" &amp; sumA &amp; \")\"\nNext sumRng\n</code></pre>\n\n<p>If you are just trying to count the number of cells that are in the range you can use this simple code. If you are counting the cells with numbers use <code>xlNumbers</code>, if you are counting cells with text use <code>xlConstants</code>.</p>\n\n<pre><code>For Each cntRng In Sheets(\"Sheet1\").Columns(\"B\").SpecialCells(xlConstants, xlNumbers).Areas\n    cntA = cntRng.Address(False, False)\n    cntRng.Offset(, 1).Resize(1, 1) = cntRng.Count\nNext cntRng\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11583339, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mA1-FRRsLfY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcHyisNx3lKj2LHWzCEZpGp9buDTA/mo/photo.jpg?sz=128", "display_name": "Kristian Sveigaard", "link": "https://stackoverflow.com/users/11583339/kristian-sveigaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559746677, "creation_date": 1559733160, "last_edit_date": 1559739320, "question_id": 56459355, "link": "https://stackoverflow.com/questions/56459355/sum-until-blank", "title": "Sum until blank", "body": "<p>I have 2 column, in column B, a list with blank in between, the numbers of text before blank can vary. I need to insert a sum of the range at the first line of text in column next to it. \nAnd my two attemps of vba works but then dosent work. <br>\nOption 1: Works will insert \"sum=\" the range above with text.<br>\nOption 2: This inserts in the right place but only insert a \"FALSE\".<br></p>\n\n<pre><code>Example:\nColumn B:     ColumnC:\nHeader1       =SUM(B1:B4) eg. the sum of the range before first blank.\nSub1\nSub2\nSub3\n\"blank\"\nHeader2       =SUM(B6:B8) eg. the sum of the range before first blank.\nSub1\nSub2\n\"blank\"\n</code></pre>\n\n<pre><code>Sub KSV_Option_1()\n        Dim KSV_SrchRng As Range, cel As Range, KSV_Contain As String\n        Set KSV_SrchRng = Range(\"B1:B99\")\n        For Each cel In KSV_SrchRng\n            If InStr(cel.Value, \"Forsikringspr\u00e6mie\") &gt; 0 Then\n                KSV_Contain = cel.Value\n            ElseIf cel.Value &lt;&gt; \"\" Then\n                    Dim xRg As Range\n                    Dim i, j, StartRow, StartCol As Integer\n                    Set xRg = Range(\"B1:B99\")\n                    StartRow = xRg.Row\n                    StartCol = xRg.Column\n                    For i = StartCol To xRg.Columns.Count + StartCol - 1\n                        For j = xRg.Row To xRg.Rows.Count + StartRow - 1\n                            If Cells(j, i) = \"\" Then\n                                 Cells(j, i).Formula = \"=SUM(\" &amp; Cells(StartRow, i).Address &amp; \":\" &amp; Cells(j - 1, i).Address &amp; \")\"\n                                StartRow = j + 1\n                            End If\n                        Next\n                        StartRow = xRg.Row\n                    Next\n                End If\n        Next cel\nEnd Sub\n\n\nSub KSV_Option_2()\n        Dim KSV_SrchRng As Range, cel As Range, KSV_Contain As String\n        Set KSV_SrchRng = Range(\"B1:B99\")\n        For Each cel In KSV_SrchRng\n            If InStr(cel.Value, \"Forsikringspr\u00e6mie\") &gt; 0 Then\n                KSV_Contain = cel.Value\n            ElseIf cel.Value &lt;&gt; \"\" Then\n                    Dim xRg As Range\n                    Dim i, j, StartRow, StartCol As Integer\n                    Set xRg = Range(\"B1:B99\")\n                    StartRow = xRg.Row\n                    StartCol = xRg.Column\n                    For i = StartCol To xRg.Columns.Count + StartCol - 1\n                        For j = xRg.Row To xRg.Rows.Count + StartRow - 1\n                            If Cells(j, i) = \"\" Then\n                                 cel.Offset(0, 1).Value = Cells(j, i).Formula = \"=SUM(\" &amp; Cells(StartRow, i).Address &amp; \":\" &amp; Cells(j - 1, i).Address &amp; \")\"\n                                StartRow = j + 1\n                            End If\n                        Next\n                        StartRow = xRg.Row\n                    Next\n                End If\n        Next cel\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1559734588, "post_id": 56459085, "comment_id": 99510833, "body": "It&#39;s probably the same problem as your last question <code>Set li = .ListItems.Add(, , sh.Cells(r, 4).Value)</code> will probably work. and below continue from <code>li.ListSubItems.Add , , sh.Cells(r, 7).Value</code> onwards. Right now your have populated your first column with nothing."}], "answers": [{"comments": [{"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 0, "creation_date": 1559735564, "post_id": 56459756, "comment_id": 99511265, "body": "Thanks so much, its the curly brackets I am missing"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1559734730, "creation_date": 1559734730, "answer_id": 56459756, "question_id": 56459085, "link": "https://stackoverflow.com/questions/56459085/listview-populating-from-the-2nd-column/56459756#56459756", "title": "ListView Populating from the 2nd Column", "body": "<p>So based on the same <a href=\"https://10tec.com/articles/excel-vba-listview-control-examples.aspx\" rel=\"nofollow noreferrer\">link</a> I shared in a <a href=\"https://stackoverflow.com/questions/56457510/populating-a-listview/56458211#56458211\">former question of yours</a>, this should work:</p>\n\n<pre><code>'First bit of code....\nSet li = .ListItems.Add(, , sh.Cells(r, 4).Value)\n    li.ListSubItems.Add , , sh.Cells(r, 7).Value\n    li.ListSubItems.Add , , sh.Cells(r, 6).Value\n    li.ListSubItems.Add , , sh.Cells(r, 13).Value\n    'Continue your code....\n</code></pre>\n"}], "owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56459756, "answer_count": 1, "score": 2, "last_activity_date": 1559734730, "creation_date": 1559732113, "last_edit_date": 1559732174, "question_id": 56459085, "link": "https://stackoverflow.com/questions/56459085/listview-populating-from-the-2nd-column", "title": "ListView Populating from the 2nd Column", "body": "<p>I am populating a listview from a excel range, and the listview is populating from the 2nd column instead of the first.</p>\n\n<p>Is there an option that needs checked for this?</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Dim sh\nDim LR\nDim lC\nDim r\n\n\nWith LVIV\n   .View = lvwReport\n   .FullRowSelect = True\n   .Gridlines = True\n   .CheckBoxes = False\n\n   With .ColumnHeaders\n      .Clear\n      '.Add , , \"#\", 20\n      .Add , , \"Language\", 70\n      .Add , , \"Time\", 70\n      .Add , , \"Date\", 70\n      .Add , , \"Team\", 70\n      .Add , , \"HO #\", 70\n      .Add , , \"Case Worker\", 80\n      .Add , , \"Interpreter\", 80\n      .Add , , \"Room\", 30\n      .Add , , \"Applicant\", 70\n      .Add , , \"Interpreter\", 70\n      .Add , , \"Messaged DM\", 70\n      .Add , , \"IV Start Time\", 70\n      .Add , , \"Status\", 70\n\n   End With\n\n\n\n Dim li As ListItem\n\n    Set sh = ThisWorkbook.Worksheets(4)\n    With sh\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).row\n    End With\n    lC = 0\n\n\n\n\nFor r = 2 To LR\n   If Left(sh.Cells(r, 6), 10) = \"04/06/2019\" Then\n   Set li = .ListItems.Add()\n        li.ListSubItems.Add , , sh.Cells(r, 4).Value\n        li.ListSubItems.Add , , sh.Cells(r, 7).Value\n        li.ListSubItems.Add , , sh.Cells(r, 6).Value\n        li.ListSubItems.Add , , sh.Cells(r, 13).Value\n        li.ListSubItems.Add , , sh.Cells(r, 2).Value\n        li.ListSubItems.Add , , sh.Cells(r, 1).Value\n        li.ListSubItems.Add , , sh.Cells(r, 5).Value\n        li.ListSubItems.Add , , sh.Cells(r, 23).Value\n        ''\n        li.ListSubItems.Add , , sh.Cells(r, 13).Value\n        li.ListSubItems.Add , , sh.Cells(r, 2).Value\n        li.ListSubItems.Add , , sh.Cells(r, 1).Value\n        li.ListSubItems.Add , , sh.Cells(r, 5).Value\n        li.ListSubItems.Add , , sh.Cells(r, 23).Value\nEnd If\nNext\n\nEnd With\n</code></pre>\n\n<p>I have tried creating a new listview to get the default options, but its still the same.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559732095, "post_id": 56459026, "comment_id": 99509712, "body": "Most likely they have macros disabled so this can&#39;t work. To force them to enable macros try reading <a href=\"https://stackoverflow.com/a/9425491/7558682\">this</a>"}, {"owner": {"reputation": 1, "user_id": 11448360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e7b43c1757e1de362d3bfc207fc384?s=128&d=identicon&r=PG&f=1", "display_name": "CB12", "link": "https://stackoverflow.com/users/11448360/cb12"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559732490, "post_id": 56459026, "comment_id": 99509890, "body": "It can&#39;t be the issue. This is for work and my company automatically enable macros settings and company default."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559733223, "post_id": 56459026, "comment_id": 99510233, "body": "Are all Excel versions same and with same updates installed? Same OS?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559733313, "post_id": 56459026, "comment_id": 99510274, "body": "What do you mean with <i>&quot;is working for some people but not others&quot;</i> - is it not triggered at all or does something fail to work as expected?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1559735066, "post_id": 56459026, "comment_id": 99511042, "body": "<i>&quot;my company automatically enables macros&quot;</i> that seems like a security issue"}, {"owner": {"reputation": 1, "user_id": 11448360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e7b43c1757e1de362d3bfc207fc384?s=128&d=identicon&r=PG&f=1", "display_name": "CB12", "link": "https://stackoverflow.com/users/11448360/cb12"}, "edited": false, "score": 0, "creation_date": 1559736236, "post_id": 56459026, "comment_id": 99511607, "body": "Some either Excel 2010 or Excel 2013 but I have people on both versions that the macro works for."}], "owner": {"reputation": 1, "user_id": 11448360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e7b43c1757e1de362d3bfc207fc384?s=128&d=identicon&r=PG&f=1", "display_name": "CB12", "link": "https://stackoverflow.com/users/11448360/cb12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559731882, "creation_date": 1559731882, "question_id": 56459026, "link": "https://stackoverflow.com/questions/56459026/workbook-before-close-not-working-for-some-but-working-for-others", "title": "Workbook Before Close Not Working for some but working for others", "body": "<p>I have the following codes which is working for some people but not others.\nThe following does the reverse at opening the spreadsheet.\nCould it be a setting it excel?</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nDim Control As Office.CommandBarControl\n\nApplication.CommandBars(\"ply\").Enabled = True     'disables right-Click on \nsheet tab\n\nFor Each Control In Application.CommandBars.FindControls(ID:=21)    \n'disables CUT\nControl.Enabled = True\nNext Control For Each Control In \nApplication.CommandBars.FindControls(ID:=19)     'disables COPY\n    Control.Enabled = True\n Next Control\n\nApplication.DisplayFormulaBar = True\nApplication.CutCopyMode = True\nApplication.CellDragAndDrop = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559732440, "post_id": 56459019, "comment_id": 99509854, "body": "Which is the pattern for the title on the sheets? how is called the data sheet and the analisys sheet? <code>Raw Data</code> and <code>&quot;Rts &amp; MUs&quot;</code>?"}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559732734, "post_id": 56459019, "comment_id": 99509989, "body": "The titles I&#39;m using at the moment are for example, &#39;05-06-2019 Raw Data&#39; (data set) and &#39;05-06-2019 Rts &amp; MU&#39; (analysis sheet)."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559732823, "post_id": 56459019, "comment_id": 99510042, "body": "Are <code>Raw Data</code> and <code>Rts &amp; MU</code>always on the sheet name? Only the dates change, right?"}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559733650, "post_id": 56459019, "comment_id": 99510440, "body": "Correct, only the date will change to current day&#39;s date."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559733720, "post_id": 56459019, "comment_id": 99510476, "body": "Last question, the code is on the same workbook you want  to check, or in another workbook?"}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559733781, "post_id": 56459019, "comment_id": 99510502, "body": "The code is in the same workbook. Apologies, I should have specified initially!"}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1559735196, "post_id": 56459676, "comment_id": 99511101, "body": "Why do you use a numeric instead of a boolean to keep track if a sheet is there?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559735338, "post_id": 56459676, "comment_id": 99511158, "body": "@FunThomas could actually have done that... But I didn&#39;t think about booleans... Doesn&#39;t matter here I&#39;m using <code>Byte</code> so it&#39;s the same size on memory, right?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1559735850, "post_id": 56459676, "comment_id": 99511422, "body": "<b>(a)</b> Byte, Integer, Long and Boolean all uses 4 Bytes, see <a href=\"https://stackoverflow.com/a/26409520/7599798\">stackoverflow.com/a/26409520/7599798</a>. <b>(b)</b> Always use the appropriate data type. If you use a boolean, it&#39;s obvious that it can be only <code>True</code> or <code>False</code>. A numeric variable can get any number, and when you look at the code, you need to figure out what a number means. In your case, 1 means <i>not found</i>, 0 means <i>found</i>, but you need to look carefully to the code to see that."}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559737577, "post_id": 56459676, "comment_id": 99512277, "body": "@FunThomas - thank you very much for your input. I&#39;m trying to make sure I ingrain good practice from the offset. Would the rest of the code need to change much if a Boolean type was used?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559738231, "post_id": 56459676, "comment_id": 99512633, "body": "No. Use e.g. <code>rawDataFound as boolean</code> instead of countRawData, write <code>rawDataFound = True</code>  when the sheet was found and <code>If Not rawDataFound Then</code> when checking before the ` .Sheets.Add`-statement."}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559740504, "post_id": 56459676, "comment_id": 99513999, "body": "Great, thank you. That seems to work!   @FunThomas or @Damian - sorry one last question - regarding  <code>Set ws = .Sheets.Add(before:=.Sheets(.Sheets.Count))</code>  why is there a period at the start of <code>.Sheets</code>? That&#39;s the only bit of the code I don&#39;t understand..."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "edited": false, "score": 0, "creation_date": 1559741462, "post_id": 56459676, "comment_id": 99514530, "body": "@bennyjim To avoid writting full path to the range, you can use <code>With</code> And your workbook/worksheet/range object so you don&#39;t need to write it everytime. So instead of <code>Set ws = ThisWorkbook.Sheets.Add(before:=ThisWorkbook.Sheets(ThisWork&zwnj;&#8203;book.Sheets.Count))</code>. You just use a <code>With ThisWorkbook</code> and anything referencing the workbook will lead with the period."}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "edited": false, "score": 0, "creation_date": 1559741823, "post_id": 56459676, "comment_id": 99514780, "body": "Ahh I see! Much appreciated Damian."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1559734413, "creation_date": 1559734413, "answer_id": 56459676, "question_id": 56459019, "link": "https://stackoverflow.com/questions/56459019/add-sheets-in-specific-order-if-missing/56459676#56459676", "title": "Add sheets, in specific order, if missing", "body": "<p>Tested, 100% working:</p>\n\n<pre><code>Option Explicit\nSub CheckForWorksheets()\n\n    Dim szTodayRawData As String\n    Dim szTodayRtsMU As String\n    Dim ws As Worksheet\n    Dim countRawData As Byte 'check if exists the RawData sheet\n    Dim countRTsMU As Byte 'check if exists the RtsMU sheet\n\n    'Date and titles\n    szTodayRawData = Format(Date, \"dd-mm-yyyy\") &amp; \" \" &amp; \"Raw Data\"\n    szTodayRtsMU = Format(Date, \"dd-mm-yyyy\") &amp; \" \" &amp; \"Rts &amp; MUs\"\n\n    'Initialize the counters with 1\n    countRawData = 1\n    countRTsMU = 1\n\n    'This is a loop on all the worksheets on this workbook\n    For Each ws In ThisWorkbook.Worksheets\n        'If the sheets exists then the counter goes to 0\n        If ws.Name = szTodayRawData Then\n            countRawData = 0\n        ElseIf ws.Name = szTodayRtsMU Then\n            countRTsMU = 0\n        End If\n    Next ws\n\n    'Add the sheets if needed\n    With ThisWorkbook\n        If countRawData = 1 Then\n            Set ws = .Sheets.Add(before:=.Sheets(.Sheets.Count))\n            ws.Name = szTodayRawData\n        End If\n        If countRTsMU = 1 Then\n            Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n            ws.Name = szTodayRtsMU\n        End If\n    End With\n\n    'Delete any other sheet\n    For Each ws In ThisWorkbook.Sheets\n        If Not ws.Name = szTodayRawData And Not ws.Name = szTodayRtsMU Then\n            Application.DisplayAlerts = False\n            ws.Delete\n            Application.DisplayAlerts = True\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>If you need help understanding the code ask me anything.</p>\n"}], "owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56459676, "answer_count": 1, "score": 0, "last_activity_date": 1606946863, "creation_date": 1559731862, "last_edit_date": 1606946863, "question_id": 56459019, "link": "https://stackoverflow.com/questions/56459019/add-sheets-in-specific-order-if-missing", "title": "Add sheets, in specific order, if missing", "body": "<p>I'm setting up a workbook that has two sheets. One sheet is for a data set and the second sheet is for analysis.<br />\nThe data set sheet will be first (on the left/Sheet1) followed by the analysis sheet second (on the right/Sheet2).<br />\nEach sheet Name will have today's date and a title.</p>\n<p>I would like to check if both sheets are present for today's date.</p>\n<ul>\n<li>If Sheet1 is missing, add on the left.</li>\n<li>If Sheet2 is missing, add on the right.</li>\n<li>If both are missing, add both.</li>\n<li>There should be no other sheets.</li>\n</ul>\n<p>I have two modules. One checks for one sheet, and one checks for the other.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic szTodayRtsMU As String\nDim szTodayRawData As String\n\n' Add and name a sheet with today's date.\nSub AddRtsMUsSheets_Today()\n     \n     ' Date and title.\n    szTodayRtsMU = Format(Date, &quot;dd-mm-yyyy&quot;) &amp; &quot; &quot; &amp; &quot;Rts &amp; MUs&quot;\n     \n    On Error GoTo MakeSheet\n     \n     ' Check if sheet already exists, if it does, select activate it.\n    Sheets(szTodayRtsMU).Activate\n     \n     ' No errors, code is done.\n    Exit Sub\n     \n    MakeSheet:\n     ' If the sheet doesn't exist, add it.\n    ActiveWorkbook.Sheets.Add After:=Worksheets(Worksheets.Count)\n     ' Name it\n    ActiveSheet.Name = szTodayRtsMU\nEnd Sub\n\nSub AddRawDataSheets_Today()\n     \n     ' Date and title.\n    szTodayRawData = Format(Date, &quot;dd-mm-yyyy&quot;) &amp; &quot; &quot; &amp; &quot;Raw Data&quot;\n     \n    On Error GoTo MakeSheet\n     \n     ' Check if sheet already exists, if it does, select activate it.\n    Sheets(szTodayRawData).Activate\n     \n     ' No errors, code is done.\n    Exit Sub\n        \n    MakeSheet:\n     ' If the sheet doesn't exist, add it.\n    ActiveWorkbook.Sheets.Add Before:=Worksheets(Worksheets.Count)\n     ' Name it\n    ActiveSheet.Name = szTodayRawData\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559732785, "post_id": 56458908, "comment_id": 99510017, "body": "What is the goal of your code? This looks like overcomplicated."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559733272, "post_id": 56458908, "comment_id": 99510253, "body": "Could you please post a data example? the input you have and the expected output"}, {"owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "edited": false, "score": 0, "creation_date": 1559735233, "post_id": 56458908, "comment_id": 99511120, "body": "The goal is to get multiple named ranges where each range consist of the cells that have a value that is equal to the unique identifier in column G. In addition, this unique identifier is also the name of the corresponding range. So for example range <code>20160717</code> consist of all the cells in column A that have the value <code>2016-07-17</code>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559808911, "post_id": 56458908, "comment_id": 99537488, "body": "I think line <code>&quot;=SUBSTITUTE(x.Value,&quot;&quot;-&quot;&quot;,&quot;&quot;&quot;&quot;)&quot;</code> should be <code>&quot;=SUBSTITUTE(&quot; &amp; x.Value &amp; &quot;,&quot;&quot;-&quot;&quot;,&quot;&quot;&quot;&quot;)&quot;</code>."}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559731392, "creation_date": 1559731392, "question_id": 56458908, "link": "https://stackoverflow.com/questions/56458908/create-ranges-based-on-common-cell-values-and-create-matching-range-names", "title": "Create ranges based on common cell values and create matching range names", "body": "<p>I have a file with all data in column A. In addition, I have a number of unique identifiers in column G. I would like to group all the data in column A based on the identifiers in column G</p>\n\n<pre><code>Sub createRanges()\n\nDim LastRowAll, LastRowUnique As Integer\nDim x, y\nDim rng As Variant\n\nRange(\"G3\").Select\nSelection.End(xlDown).Select\nLastRowAll = ActiveCell.Row\n\nRange(\"A2\").Select\nSelection.End(xlDown).Select\nLastRowUnique = ActiveCell.Row\n\n\nFor Each x In Range(\"G3:G\" &amp; LastRowUnique)\n   For Each y In Range(\"A2:A\" &amp; LastRowAll)\n      If IsEmpty(rng) And y = x Then\n         rng = y.Address(0, 0)\n      ElseIf y = x Then\n         rng = rng &amp; \",\" &amp; y.Address(0, 0)\n      End If\n   Next y\n\n   rng_formula = \"=SUBSTITUTE(x.Value,\"\"-\"\",\"\"\"\")\"\n   rng_name = Application.Evaluate(rng_formula)\n   ' This yields error 2029\n   Range(rng).Name = rng_name\n   With ThisWorkbook\n     .Names(rng).Delete\n   End With\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Why does the following not work in my script;  </p>\n\n<pre><code> rng_formula = \"=SUBSTITUTE(x.Value,\"\"-\"\",\"\"\"\")\"\n rng_name = Application.Evaluate(rng_formula)\n</code></pre>\n\n<p><code>X.value</code> is equal to <code>\"2016-07-15\"</code> if I inspect the elements. I need to remove the <code>-</code> because this character is not possible in a named range. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1559731362, "post_id": 56458780, "comment_id": 99509406, "body": "That&#39;s a very unorthodox way to &quot;create 2 ranges&quot;. The way you are doing it, you are trying to apply <code>Union</code> to a couple of strings. That won&#39;t work. Start by declaring <code>lst</code> and <code>lst2</code> as <code>Range</code> and then <code>set</code> them properly."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559731444, "post_id": 56458780, "comment_id": 99509434, "body": "<code>Union</code> doesn&#39;t work with ranges from different worksheets."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1559744589, "post_id": 56458780, "comment_id": 99516440, "body": "This <code>.address</code> is not needed when setting the ranges."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1559745413, "post_id": 56458780, "comment_id": 99516927, "body": "Also, please get rid of the <code>ActiveSheet</code> reference and use an explicit reference to the worksheet where the combobox should be created."}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559742926, "post_id": 56459424, "comment_id": 99515503, "body": "I have edited my code to really have lst as range. I tried as shown, but i get a &quot;Run-time error: &#39;438&#39;: Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559743313, "post_id": 56459424, "comment_id": 99515714, "body": "@Phoenix, check if the edited answer works for you. I added <code>.ControlFormat</code> as I forgot to do so in initial answer."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1559744434, "post_id": 56459424, "comment_id": 99516357, "body": "@JvdV I don&#39;t think <code>.ControlFormat</code> is supported by an <code>ActiveX</code> combobox."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1559745392, "post_id": 56459424, "comment_id": 99516911, "body": "@StavrosJon, edited to avoid use of ActiveX control (as they are a pain on a worksheet imo)"}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559747809, "post_id": 56459424, "comment_id": 99518340, "body": "Yes but I need to use an ActiveX control because they are writable, and xlDropDown are not."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1559745288, "last_edit_date": 1559745288, "creation_date": 1559733467, "answer_id": 56459424, "question_id": 56458780, "link": "https://stackoverflow.com/questions/56458780/combobox-listfillrange-from-2-differents-sheets/56459424#56459424", "title": "Combobox listfillrange from 2 differents sheets", "body": "<p><code>Union</code> simply won't work over different worksheets. I think your best bet would be to individually add these items:</p>\n\n<pre><code>Set Ctrl = ActiveSheet.Shapes.AddFormControl(xlDropDown, Left:=Cells(1, 1).Left, Top:=Cells(2, 1).Top, Width:=100, Height:=20)\n\nWith Ctrl\n    .Name = \"CB\"\n    For Each cell In lst\n        .ControlFormat.AddItem cell.Value\n    Next cell\n    For Each cell In lst2\n        .ControlFormat.AddItem cell.Value\n    Next cell\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559742680, "post_id": 56460705, "comment_id": 99515337, "body": "it is Set rng1 = Range(sht1.Range(&quot;A1&quot;).address, sht1.Range(&quot;A&quot; &amp; sht1.Rows.Count).End(xlUp).address), no ?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559743369, "post_id": 56460705, "comment_id": 99515740, "body": "Not necessarily. It will work like that as well but strictly speaking, the <code>Range()</code> function takes as input two parameters of type <code>Range</code>. This <code>sht1.Range(&quot;A1&quot;)</code> is a <code>Range</code> while this <code>sht1.Range(&quot;A1&quot;).address</code> is a string."}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559747484, "post_id": 56460705, "comment_id": 99518165, "body": "But when i try to pass the range <code>sht1.Range(&quot;A1&quot;)</code>, I have an Error 1004 :  error 1004 method range of object _global failed"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559754891, "post_id": 56460705, "comment_id": 99521854, "body": "@Phoenix That happens probably because your code is located in one of your worksheet objects instead of a module. My bad. See updated code."}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559755333, "post_id": 56460705, "comment_id": 99522040, "body": "Thanks. I tried both, both works,I will use JvdV&#39;s version if it is more clean (and the combination version fail if one of the list contains only one cell)"}, {"owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "edited": false, "score": 0, "creation_date": 1559755432, "post_id": 56460705, "comment_id": 99522077, "body": "Yes It is on my worksheet because i havn&#39;t found any other way to create the combobox on user cell select"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 1, "last_activity_date": 1559754796, "last_edit_date": 1559754796, "creation_date": 1559738512, "answer_id": 56460705, "question_id": 56458780, "link": "https://stackoverflow.com/questions/56458780/combobox-listfillrange-from-2-differents-sheets/56460705#56460705", "title": "Combobox listfillrange from 2 differents sheets", "body": "<p>I <strong>highly</strong> recommend an approach using <code>For-Each</code> like the one Jvdv has demonstrated as it is easy, intuitive and elegant.</p>\n\n<p>If however, you absolutely have to do it your way (combining two lists into one), then here's my suggestion:</p>\n\n<pre><code>Sub initializeCombo()\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim sht3 As Worksheet\nDim rng1 As Range\nDim rng2 As Range\nDim lst1 As Variant\nDim lst2 As Variant\nDim lst3 As Variant\nDim i As Long\n\nSet sht1 = ThisWorkbook.Worksheets(\"WS1\") 'The worksheet where the first list is\nSet sht2 = ThisWorkbook.Worksheets(\"WS2\") 'The worksheet where the second list is\nSet sht3 = ThisWorkbook.Worksheets(\"WS3\") 'The worksheet where the ComboBoxt is\n\nSet rng1 = sht1.Range(sht1.Range(\"A1\"), sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp))\nSet rng2 = sht2.Range(sht2.Range(\"A1\"), sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp))\n\nlst1 = rng1\nlst2 = rng2\n\n''''''''''''Combine the 2 lists into one'''''''''''''\nReDim lst3(1 To UBound(lst1) + UBound(lst2))        '\nFor i = LBound(lst1) To UBound(lst1) Step 1         '\n    lst3(i) = lst1(i, 1)                            '\nNext i                                              '\nFor i = UBound(lst1) + 1 To UBound(lst3) Step 1     '\n    lst3(i) = lst2(i - UBound(lst1), 1)             '\nNext i                                              '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nsht3.OLEObjects(\"ComboBox1\").Object.List() = lst3\nEnd Sub \n</code></pre>\n\n<p>Finally if you want to programmatically create an <code>ActiveX</code> combobox in worksheet sht3 for example and assign it with <code>lst3</code> you have to do it like so:</p>\n\n<pre><code>    Dim Ctrl As Object\n    Set Ctrl = sht3.OLEObjects.Add(ClassType:=\"Forms.ComboBox.1\").Object\n    Ctrl.List() = lst3\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>JvdV's version modified to work with an ActiveX combobox would look like so:</p>\n\n<pre><code>Sub initializeCombo2()\nDim sht1 As Worksheet, sht2 As Worksheet, sht3 As Worksheet\nDim lst1 As Range, lst2 As Range, cell As Range\nDim Ctrl As Object\n\nSet sht1 = ThisWorkbook.Worksheets(\"BaseAliments\") 'The worksheet where the first list is\nSet sht2 = ThisWorkbook.Worksheets(\"BaseRecettes\") 'The worksheet where the second list is\nSet sht3 = ThisWorkbook.Worksheets(\"Menu\") 'The worksheet where the ComboBoxt is\nSet lst1 = sht1.Range(sht1.Range(\"A1\"), sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp))\nSet lst2 = sht2.Range(sht2.Range(\"A1\"), sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp))\nSet Ctrl = sht3.OLEObjects.Add(ClassType:=\"Forms.ComboBox.1\").Object\n\nFor Each cell In lst1\n    Ctrl.AddItem cell.Value\nNext cell\nFor Each cell In lst2\n    Ctrl.AddItem cell.Value\nNext cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 56460705, "answer_count": 2, "score": 1, "last_activity_date": 1559754796, "creation_date": 1559730823, "last_edit_date": 1559748050, "question_id": 56458780, "link": "https://stackoverflow.com/questions/56458780/combobox-listfillrange-from-2-differents-sheets", "title": "Combobox listfillrange from 2 differents sheets", "body": "<p>I would like to fill a combobox with data from 2 differents sheets.</p>\n\n<p>I have that function to create 2 ranges which works: </p>\n\n<pre><code>    Dim lst as Range\n    Dim lst2 as Range\n    Set sht1 = ThisWorkbook.Worksheets(\"BaseAliments\")\n    Set sht2 = ThisWorkbook.Worksheets(\"BaseRecettes\")\n    Set lst = Range(sht1.Range(\"A1\").address, sht1.Range(\"A\" &amp; sht1.Rows.Count).End(xlUp).address)\n    Set lst2 = Range(sht2.Range(\"A1\").address, sht2.Range(\"A\" &amp; sht2.Rows.Count).End(xlUp).address)\n</code></pre>\n\n<p>But then when i try to fill the listfillrange :</p>\n\n<pre><code>  Set Ctrl =Worksheets(\"Menu\").OLEObjects.Add(ClassType:=\"Forms.ComboBox.1\")\n  With Ctrl\n      .Name = \"CB\"\n      '.ListFillRange = 'Something to concatenate lst and lst2\n  End With\n</code></pre>\n\n<ul>\n<li>Union doesn't work between sheets</li>\n<li>I need to use ActiveX combo box (because they are writable)</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559730023, "creation_date": 1559730023, "question_id": 56458597, "link": "https://stackoverflow.com/questions/56458597/keep-gantt-chart-range-conditional-formatting", "title": "Keep Gantt Chart range conditional formatting", "body": "<p>I have Gantt Chart (Sheet1) and would like to copy and paste predefined Tasks from (Sheet2). Problem with current solution is that Conditional formatting is not applied to newly pasted rows as there is no conditional formatting on copied cells. I have tried to apply Conditional formatting on Sheet2 but then there is a lot of Conditional formatting's and formula for conditional formatting is connected to Sheet2 so it is not working correct after copying on Sheet1.</p>\n\n<p>Sheet2 = Data</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ph9Ez.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ph9Ez.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub InsertRev()\n\n    Application.DisplayAlerts = False\n\n    Dim c As Range\n    Set Rng = ActiveSheet.Range(\"A1:A5000\")\n    For dblCounter = Rng.Cells.Count To 1 Step -1\n        Set c = Rng(dblCounter)\n        If c.Value Like \"Last\" Then\n        ThisWorkbook.Worksheets(\"Data\").Rows(\"26:27\").Copy\n        c.EntireRow.insert\n    End If\n    Next dblCounter\n\n    Application.DisplayAlerts = True\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "worksheet", "calculation"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 4, "creation_date": 1559728979, "post_id": 56458197, "comment_id": 99508359, "body": "<code>If Not Intersect(...</code> will always come out to be true because you&#39;re comparing two identical ranges... it has no real value to it"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1559729557, "post_id": 56458197, "comment_id": 99508620, "body": "As per @TimStack his comment, your code has no added value. A simple <code>Msgbox &quot;Hi&quot;</code> on the Worksheet_Calculate event would do. Also, if you have more formulas that can trigger the event, you might want to look into <code>Worksheet_Change</code> event looking if <code>Target</code> would be equal to <code>H12</code> cell and if true, return messagebox."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559729945, "post_id": 56458197, "comment_id": 99508796, "body": "<code>Worksheet_Calculate</code> doesn&#39;t give you the exact range where values are being updated, so in your case it is useless. <code>Worksheet_Change</code> gives you exact location of the change, but even that would not give you any result if values are being changed using Formula."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1559731652, "post_id": 56458197, "comment_id": 99509523, "body": "You &#39;could&#39; add a UDF to your formula in K2:K5 see here: <a href=\"https://stackoverflow.com/questions/51495354/how-to-detect-if-a-cell-is-changed-by-an-if-formula-and-not-by-a-user/51496226#51496226\" title=\"how to detect if a cell is changed by an if formula and not by a user\">stackoverflow.com/questions/51495354/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "edited": false, "score": 0, "creation_date": 1559737088, "post_id": 56458592, "comment_id": 99512023, "body": "Very grateful for your solutions and explanations of how it&#39;s put together in a proper manner. It now works as intended. Many thanks!"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1559730999, "last_edit_date": 1559730999, "creation_date": 1559730015, "answer_id": 56458592, "question_id": 56458197, "link": "https://stackoverflow.com/questions/56458197/how-to-fix-msgbox-showing-up-twice-when-cell-formula-result-changes/56458592#56458592", "title": "How to fix msgbox showing up twice When Cell Formula Result Changes?", "body": "<p>Your current code has no added value on a <code>Worksheet_Calculate</code> event due to comparing two exact same ranges and see if they intersect. That would always be the case. Your code would have the same effect as:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    MsgBox \"Hi\"\nEnd Sub\n</code></pre>\n\n<p>Might you have more functions in your worksheet that could trigger this event unwanted outside range <code>K2:K5</code>, you should look into the <code>Worksheet_Change</code> event and return a messagebox when your referenced cell has changed value.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$H$12\" Then MsgBox \"Hi\"\nEnd Sub\n</code></pre>\n\n<p>Choose either one, but don't use both cause you'll end up with two msgbox's</p>\n"}], "owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 56458592, "answer_count": 1, "score": 0, "last_activity_date": 1559732007, "creation_date": 1559728521, "last_edit_date": 1559732007, "question_id": 56458197, "link": "https://stackoverflow.com/questions/56458197/how-to-fix-msgbox-showing-up-twice-when-cell-formula-result-changes", "title": "How to fix msgbox showing up twice When Cell Formula Result Changes?", "body": "<p>I want a msgbox to show up only once when formula result changes in my table range <code>(\"K2:K5\")</code>. Right now it shows twice. </p>\n\n<p>In this range I have excel-formulas. Formula: <code>H12*10</code></p>\n\n<p>These formulas is refering to a dropdown-list (a list that I've created from \"data validation\" on the excel menu Data-tab).</p>\n\n<p>The dropdown-list is located in <code>cell H12</code>.\nThe values in the dropdown is refering to range<code>(D15:D17)</code></p>\n\n<p>I've noticed though that the msgbox shows up once when I remove the dropdown and manualy type in values in <code>H12</code>.</p>\n\n<p>Thankful for any help on this </p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim Xrg As Range\nSet Xrg = Range(\"K2:K5\")\nIf Not Intersect(Xrg, Range(\"K2:K5\")) Is Nothing Then\n    MsgBox \"Hi\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I have also tried to add <code>Application.enableEvents</code> to the code but no success.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim Xrg As Range\nSet Xrg = Range(\"K2:K5\")\nApplication.EnableEvents = False\nIf Not Intersect(Xrg, Range(\"K2:K5\")) Is Nothing Then\n    MsgBox \"Hi\"\nEnd If\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559728777, "post_id": 56458158, "comment_id": 99508269, "body": "Have you tried anything other than just record a macro? A good start would be to check if <code>Target</code> consist of one cell plus if it intersects with column A."}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559728982, "post_id": 56458158, "comment_id": 99508361, "body": "to be honestly,as i am begginer, currently i do not have much knowledge about it, but tryig to learn. if you can help, it ll be appriciated."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559729625, "post_id": 56458158, "comment_id": 99508657, "body": "it is not clear, why if A8 is changed, D8-D4 should be copied? If A11 - then D11-D7 should be copied? If B10 is changed - nothing is copied?"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559731637, "post_id": 56458158, "comment_id": 99509519, "body": "YES, you are right, change should be in range A:A only if any change other than range A:A then nothing should be copied"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559732865, "post_id": 56458436, "comment_id": 99510059, "body": "YES, it&#39;s working very well, thank you for putting efforts &amp; investing your valuable time."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1559729435, "creation_date": 1559729435, "answer_id": 56458436, "question_id": 56458158, "link": "https://stackoverflow.com/questions/56458158/when-a-cell-value-changes-copy-the-column-from-where-the-cell-value-changed-to/56458436#56458436", "title": "When a cell value changes, copy the column from where the cell value changed to another sheet at the same range", "body": "<p>Assuming the relative range is consistent, try this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim r As Range\n\nIf Target.Column = 1 And Target.Row &gt; 4 Then\n    Set r = Target.Offset(-4, 3).Resize(5)\n    Worksheets(\"ADP\").Range(r.Address).Value = r.Value\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559732596, "post_id": 56459131, "comment_id": 99509938, "body": "YES,  it&#39;s working very well, thank you so much for giving time &amp; putting efforts"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559732813, "post_id": 56459131, "comment_id": 99510035, "body": "kindly, can you please suggest me that, where do i have to make changes if i want to paste range D4:I4, instead of D4:D8"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 1, "creation_date": 1559733153, "post_id": 56459131, "comment_id": 99510193, "body": "@Arshitpatel it s a good idea to <code>Set</code> both worksheets, to use <code>Target.Count = 1</code> to avoid errors when you select multi cells."}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559734005, "post_id": 56459131, "comment_id": 99510605, "body": "When i have replaced with new formula, outcome of macro was not as expected, cell value A10 CHANGED but value pasted in cell D4:D4 IN sheet &quot;ADP&quot;"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559734277, "post_id": 56459131, "comment_id": 99510703, "body": "AND i want to paste in D4:I4 whereas edited ans. is for D4:H4. THANK YOU."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559735902, "post_id": 56459131, "comment_id": 99511446, "body": "@Arshitpatel i try the code and when i change the value in <code>A10</code> line was paste in <code>D6:H6</code> which is the correct right?"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559758485, "post_id": 56459131, "comment_id": 99523218, "body": "what is required is, when i change value in A10 range of D10:I10 should be paste, &amp; suppose value in A11 change range of D11:I11 should be paste &amp; so on...like wise..."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 1, "creation_date": 1559760531, "post_id": 56459131, "comment_id": 99524085, "body": "@Arshitpatel finally i get your point. To busy day, see the updated answer."}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 1, "creation_date": 1559763967, "post_id": 56459131, "comment_id": 99525513, "body": "100% perfectly working now. thank you so much for finally resolving this issue. thanks for giving your valuable time and sharing knowledge. thanks by heart."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 1, "creation_date": 1559764608, "post_id": 56459131, "comment_id": 99525769, "body": "Glad to hear that i help!"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559801719, "post_id": 56459131, "comment_id": 99534325, "body": "suppose in sheet if there is any change at any cell in sheet, then macro should run, then what should be the macro? kindly can you help on this? present situation is, if there is change in range A:A then only macro runs. thank you."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1559802673, "post_id": 56459131, "comment_id": 99534657, "body": "Remove <code>If Not Intersect(Target, Range(&quot;A:A&quot;)) Is Nothing And Target.Count = 1 Then</code> &amp; <code>End If</code>"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 1, "creation_date": 1559802854, "post_id": 56459131, "comment_id": 99534735, "body": "yes ok. done. again thank you from bottom of my heart for helping."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1559760502, "last_edit_date": 1559760502, "creation_date": 1559732343, "answer_id": 56459131, "question_id": 56458158, "link": "https://stackoverflow.com/questions/56458158/when-a-cell-value-changes-copy-the-column-from-where-the-cell-value-changed-to/56459131#56459131", "title": "When a cell value changes, copy the column from where the cell value changed to another sheet at the same range", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim wsSou As Worksheet, wsDes As Worksheet\n\n    'Set the worksheets to avoid conflicts\n    Set wsSou = Target.Worksheet\n    Set wsDes = ThisWorkbook.Worksheets(\"ADP\")\n\n    If Not Intersect(Target, Range(\"A:A\")) Is Nothing And Target.Count = 1 Then\n\n        wsDes.Range(wsDes.Cells(Target.Row, 4), wsDes.Cells(Target.Row, 9)).Value = wsSou.Range(wsSou.Cells(Target.Row, 4), wsSou.Cells(Target.Row, 9)).Value\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 56459131, "answer_count": 2, "score": 0, "last_activity_date": 1559760502, "creation_date": 1559728339, "last_edit_date": 1559731981, "question_id": 56458158, "link": "https://stackoverflow.com/questions/56458158/when-a-cell-value-changes-copy-the-column-from-where-the-cell-value-changed-to", "title": "When a cell value changes, copy the column from where the cell value changed to another sheet at the same range", "body": "<p>For example, if in the range of A:A only cell A8 change then copy D4:D8 and paste it as value in sheet \"ADP\" at the same place i.e. D4:D8.</p>\n\n<p>For that I have tried the following macro</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.range = \"A:A\" Then\n        Call copy_paste_as_value\n    End If\nEnd Sub\n\n\nSub copy_paste_as_value()\n    Range(\"d4\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n    Sheets(\"ADP\").Activate\n    Range(\"B4\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"C4\").Select\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>I want to copy only that data against which cell value changes, but it copies the whole table to another sheet.</p>\n\n<p>main issue for me is to figure out which cell changed and copy data from that column only from which cell value changed.</p>\n\n<p>here, it's to be noted that data should be copied only if there is change in range A:A, if change in any other cell than copy paste not required.</p>\n\n<p>any help will be appriciated.\nthank you.</p>\n"}, {"tags": ["excel", "vba", "sap"], "comments": [{"owner": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "edited": false, "score": 0, "creation_date": 1559737569, "post_id": 56458141, "comment_id": 99512274, "body": "please help me i struggle :("}, {"owner": {"reputation": 8295, "user_id": 911419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa0d95b3830549589afbbc79d886c466?s=128&d=identicon&r=PG", "display_name": "Suncatcher", "link": "https://stackoverflow.com/users/911419/suncatcher"}, "edited": false, "score": 0, "creation_date": 1559824368, "post_id": 56458141, "comment_id": 99545599, "body": "This sort of questions were asked thousands time (<a href=\"https://stackoverflow.com/questions/45465172/export-sap-to-excel-completely-via-vba\">1</a> <a href=\"https://stackoverflow.com/questions/24297063/pulling-data-from-sap-using-excel-macros\">2</a> <a href=\"https://stackoverflow.com/questions/50009772/selecting-sap-fields-using-a-do-loop-vba\">3</a> <a href=\"https://stackoverflow.com/questions/19452461/vba-pulling-data-from-sap-for-dummies/19456656#19456656\">4</a>), don&#39;t be lazy to search"}, {"owner": {"reputation": 8295, "user_id": 911419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa0d95b3830549589afbbc79d886c466?s=128&d=identicon&r=PG", "display_name": "Suncatcher", "link": "https://stackoverflow.com/users/911419/suncatcher"}, "edited": false, "score": 0, "creation_date": 1559824381, "post_id": 56458141, "comment_id": 99545608, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19452461/vba-pulling-data-from-sap-for-dummies\">VBA pulling data from SAP for dummies</a>"}], "owner": {"reputation": 17, "user_id": 11304597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sZEIZ9uUvuE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBAPVJmwk43AbdrvvgiCpxp5X8mA/mo/photo.jpg?sz=128", "display_name": "Guimove ", "link": "https://stackoverflow.com/users/11304597/guimove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 895, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559728768, "creation_date": 1559728283, "last_edit_date": 1559728768, "question_id": 56458141, "link": "https://stackoverflow.com/questions/56458141/how-to-copy-data-from-sap-to-excel-with-vba", "title": "How to copy data from SAP to Excel with VBA?", "body": "<p>I would like to automate several transactions, so I import my data into a buffer file (I would prefer.txt). \nThen I will use this buffer file which will always have the same name for the example (TEST.txt). \nThen I want to copy this data to transfer it to my excel file, the file where I have to paste all my data (I'm going to call it FOS).</p>\n\n<pre><code>  Public Sub RunGUIScript()\n  Dim W_Ret As Boolean\n ' Connect to SAP\n  W_Ret = Attach_Session\n  If Not W_Ret Then\n  Exit Sub\n  End If\n  On Error GoTo myerr\n  objSess.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/tabpUCOM2/ssub%_\n  SUBSCREEN_TABBL1:RFBILA00:0002/ctxtBILAGKON\").text = \"3\"\n  objSess.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/tabpUCOM2/ssub%_\n  SUBSCREEN_TABBL1:RFBILA00:0002/ctxtBILAVART\").text = \"1\"\n  objSess.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/tabpUCOM2/ssub%_\n  SUBSCREEN_TABBL1:RFBILA00:0002/ctxtBILASKAL\").text = \n  \"0/0\"\n  objSess.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/tabpUCOM2/\n  ssub%_SUBSCREEN_TAB BL1:RFBILA00:0002/ctxtBILASKAL\").setFocus\n  objSess.findById(\"wnd[0]/usr/tabsTABSTRIP_TABBL1/tabpUCOM2/\n  ssub%_SUBSCREEN_TAB BL1:RFBILA00:0002/ctxtBILASKAL\").caretPosition = 3\n  objSess.findById(\"wnd[0]/tbar[1]/btn[8]\").press\n  objSess.findById(\"wnd[0]/mbar/menu[0]/menu[3]/menu[2]\").select\n  objSess.findById(\"wnd[1]/usr/subSUBSCREEN_STEPLOOP:SAPLSPO5:0150/\n  sub:SAPLSPO5:0150/radSPOPLI-SELFLAG[1,0]\").select\n  objSess.findById(\"wnd[1]/usr/subSUBSCREEN_STEPLOOP:SAPLSPO5:0150/\n  sub:SAPLSPO5: 0150/radSPOPLI-SELFLAG[1,0]\").setFocus\n  objSess.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n  objSess.findById(\"wnd[1]/usr/ctxtDY_FILENAME\").text = \"TEST.TXT\"\n  objSess.findById(\"wnd[1]/usr/ctxtDY_FILENAME\").caretPosition = 11\n  objSess.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n  Exit Sub\n</code></pre>\n\n<p>After executing this code I would like to search for the file at this path: C:\\Users\\p100789\\Documents\\SAP\\SAP GUI\nthen paste it into the Excel FOS file on a sheet called Table30.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 5, "creation_date": 1559729436, "post_id": 56458082, "comment_id": 99508563, "body": "<code>aData = rData.Value2 &amp; &quot; - &quot; &amp; rData.Offset(0, 2).Value2</code> is not valid when <code>rData</code> refers to more than one cell (as it will in your else clause).  You&#39;ll need to create a loop to populate the array"}, {"owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559731502, "post_id": 56458082, "comment_id": 99509457, "body": "is there another workaround apart from looping, perhaps defining another rData for the second value ? Or using Join() function?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1559739811, "post_id": 56458082, "comment_id": 99513591, "body": "What are you supposed to find, in terms of array size. And what do you want to do with your found data. Perhaps there is a better solution then the one you are trying to implement here."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559763521, "post_id": 56458082, "comment_id": 99525338, "body": "@joanna why do you want to avoid a loop?"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559733881, "creation_date": 1559728073, "last_edit_date": 1559733881, "question_id": 56458082, "link": "https://stackoverflow.com/questions/56458082/exel-vba-array-type-mismatch", "title": "Exel VBA Array - Type Mismatch", "body": "<p>I am trying to pass the value of two cells as a concatenated string to <code>adata</code> array, but I am getting a mismatch error. If I only use <code>aData = rData.Value2</code> the macro works fine. Not sure how to fix  this.</p>\n\n<pre><code>Set ws = x_bs\n    sSearchCol = \"C\"\n    sfind = ThisWorkbook.Names(\"dr_co\").RefersToRange(1, 1)\n    Set rFindText = ws.Columns(sSearchCol).Find(sfind, ws.Cells(ws.Rows.Count, sSearchCol), xlValues, xlWhole, , xlNext)\n    If rFindText Is Nothing Then GoTo errHandler\n    Set rFindBlank = ws.Range(sSearchCol &amp; 1, rFindText).Find(vbNullString, rFindText, xlValues, xlWhole, , xlPrevious)\n    Set rData = ws.Range(rFindBlank.Offset(1), rFindText.Offset(-1))\n\n    If rData.Cells.Count = 1 Then\n        ReDim aData(1 To 1, 1 To 1)\n        aData(1, 1) = rData.Value2 &amp; \" - \" &amp; rData.Offset(0, 2).Value2\n    Else\n        aData = rData.Value2 &amp; \" - \" &amp; rData.Offset(0, 2).Value2\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559727252, "post_id": 56457771, "comment_id": 99507542, "body": "In the second bit you are starting at the bottom and trying to go down."}, {"owner": {"reputation": 1, "user_id": 11603241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e1e519bd65997e71c6aae0d2e5d6df?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan phua", "link": "https://stackoverflow.com/users/11603241/ryan-phua"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559730585, "post_id": 56457771, "comment_id": 99509093, "body": "Thanks for the response. So why does the xldown not work in this instance? I thought it would go down to the last occupied cell."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559730719, "post_id": 56457771, "comment_id": 99509162, "body": "But you are starting from the last row in the sheet. You can\u2019t go down any further. It doesn\u2019t wrap. You\u2019d have to start at row 1."}, {"owner": {"reputation": 1, "user_id": 11603241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e1e519bd65997e71c6aae0d2e5d6df?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan phua", "link": "https://stackoverflow.com/users/11603241/ryan-phua"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559749711, "post_id": 56457771, "comment_id": 99519434, "body": "ahh  i see i see. Would you care to share the syntax  for that? Do i need to select the top cell first?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559750083, "post_id": 56457771, "comment_id": 99519641, "body": "Yes it&#39;s just <code>Worksheets(&quot;sheet1&quot;).cells(1,1).end(xldown).row</code> but it will give you the wrong result if there are blanks in the middle, and if only A1 is filled it will go to the very last cell."}], "owner": {"reputation": 1, "user_id": 11603241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53e1e519bd65997e71c6aae0d2e5d6df?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan phua", "link": "https://stackoverflow.com/users/11603241/ryan-phua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559750102, "creation_date": 1559726908, "last_edit_date": 1559750102, "question_id": 56457771, "link": "https://stackoverflow.com/questions/56457771/endxldown-vs-endxlup", "title": "End(Xldown) vs End(xlup)", "body": "<p>I have a simple worksheet of just 2 columns and 14 rows in which all cells within the range are filled. I was testing out counting the number of rows using both the xlup and xldown formula as follows:</p>\n\n<pre><code>Worksheets(\"sheet1\").cells(rows.count,1).end(xlup).row \nWorksheets(\"sheet1\").cells(rows.count,1).end(xldown).row\n</code></pre>\n\n<p>I was thinking that both should return me the number 14 but only the xlup returned 14 and the xldown returned 1048. Which is the total number of rows in the sheet. When I pressed CTRL down, which should be the xldown purpose, it did bring me to the bottom of the selection of 14 rows and not the entire excel sheet so I\u2019m not too sure why the code didn\u2019t work here.</p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1559726604, "post_id": 56457614, "comment_id": 99507214, "body": "It&#39;s <code>Activesheet</code>."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1559726614, "post_id": 56457614, "comment_id": 99507219, "body": "Try <code>OnlyDate = Left(DateName, 6)</code> You defined <code>DateName As String</code> so it&#39;s not an object and it have not any properties or methods that you can invoke with <code>.</code> so <code>DateName.Value</code> makes no sense at all because it is not an object. Also,, as @SJR said, try <code>ActiveSheet.Range(&quot;E1&quot;).Value = OnlyDate</code>. Object <code>ActiveWorksheet</code> does not exist."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559726857, "post_id": 56457614, "comment_id": 99507339, "body": "@FoxfireAndBurnsAndBurns - indeed, why is that not the error?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559726963, "post_id": 56457614, "comment_id": 99507396, "body": "@SJR what do you mean?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559727067, "post_id": 56457614, "comment_id": 99507449, "body": "@FoxfireAndBurnsAndBurns - OP says error message is &quot;didn&#39;t &quot;define my object&quot; which isn&#39;t right as that is not a valid message, but however I try it I can&#39;t get a related error message anyway."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559727148, "post_id": 56457614, "comment_id": 99507493, "body": "Your point raises an &quot;Invalid qualifier&quot; error. Mine raises 424 or undefined variable depending on whether Option Explicit is on."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559730721, "post_id": 56457614, "comment_id": 99509164, "body": "@SJR OP did not specify what error was or what line, but reading the code I detected those fails (but I did not tested), and posted about that. But I totally agree that &quot;define object&quot; is not a valid message :)"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 3, "last_activity_date": 1559730318, "last_edit_date": 1559730318, "creation_date": 1559727619, "answer_id": 56457966, "question_id": 56457614, "link": "https://stackoverflow.com/questions/56457614/how-to-return-worksheet-or-workbook-name-in-cell/56457966#56457966", "title": "How to return worksheet or workbook name in cell", "body": "<p>For the <strong>Workbook</strong> name, you could use VBA: </p>\n\n<pre><code>ActiveSheet.Range(\"E1\").Value = Left(ActiveWorkbook.Name, 6)\n</code></pre>\n\n<p>Or you could just use a formula in <code>E1</code> such as:</p>\n\n<pre><code>=MID(CELL(\"filename\"),FIND(\"[\",CELL(\"filename\"))+1,6)\n</code></pre>\n\n<hr>\n\n<p>For the <strong>Worksheet</strong> name, if you wanted the first 6 characters you could use VBA:</p>\n\n<pre><code> ActiveSheet.Range(\"F1\").Value = Left(ActiveSheet.Name, 6)\n</code></pre>\n\n<p>and the equivalent formula would be:</p>\n\n<pre><code>=MID(CELL(\"filename\"),FIND(\"]\",CELL(\"filename\"))+1,6)\n</code></pre>\n\n<p><strong><em>Note: both Excel formula require that the file has been saved at least once previously to work correctly.</em></strong></p>\n\n<hr>\n\n<p>Looking through your code though, one way to 'fix' it would be to use <code>Val</code> to convert the 6 character string to a value, that can be held in the <code>Long</code>.</p>\n\n<pre><code>Sub WorksheetDateName()\n    Dim DateName As String, OnlyDate As Long\n    DateName = ActiveWorkbook.Name\n    OnlyDate = Val(Left(DateName, 6))\n    ActiveSheet.Range(\"G1\").Value = OnlyDate\nEnd Sub\n</code></pre>\n\n<p>You'll also note I've changed <code>ActiveWorksheet</code> to <code>Activesheet</code> - as other comments have suggested.</p>\n"}], "owner": {"reputation": 31, "user_id": 11519387, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QL1k5jiUAKM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd83IK2UFUJnPeWMQyQWomWSyBwhQ/mo/photo.jpg?sz=128", "display_name": "mariestr", "link": "https://stackoverflow.com/users/11519387/mariestr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559730318, "creation_date": 1559726354, "question_id": 56457614, "link": "https://stackoverflow.com/questions/56457614/how-to-return-worksheet-or-workbook-name-in-cell", "title": "How to return worksheet or workbook name in cell", "body": "<p>I am trying to create a code that outputs the date (e.g. 201607) contained within the workbook name (e.g. 20160701_tyo). In the following code, I specify which cell to output the value, but I always run into an error that I didn't \"define my object\". What am I missing?</p>\n\n<pre><code>Sub WorksheetDateName()\n    Dim DateName As String, OnlyDate As Long\n    DateName = ActiveWorkbook.Name\n    OnlyDate = Left(DateName.Value, 6)\n    ActiveWorksheet.Range(\"E1\").Value = OnlyDate\nEnd Sub\n</code></pre>\n\n<p>Also, would it be possible to perform something similar for \"ActiveSheet\" in addition to \"ActiveWorkbook\"? Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "winapi"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559726486, "post_id": 56457559, "comment_id": 99507163, "body": "I don&#39;t know if this may help, but TAB key also finishes editing cell and skips to next one. Would that help?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1559729005, "post_id": 56457559, "comment_id": 99508373, "body": "Excel exposes an automation interface, so that you don&#39;t have to fiddle with faking input. See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/overview/excel\" rel=\"nofollow noreferrer\">Excel VBA reference</a> as a starting point."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 1, "creation_date": 1559729503, "post_id": 56457559, "comment_id": 99508599, "body": "IME is &quot;foreign character&quot; input, ignore these messages."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559729742, "post_id": 56457559, "comment_id": 99508704, "body": "<code>The only way I have found to stop excel from spreading the text across many cells and keep formatting like bullet points etc is after copying to the clipboard, to paste it directly into the formula bar.</code> I&#39;d rather to record a macro with desired actions (options when pasting text and so on, and the adopt generated VBA code for my needs)"}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 1, "creation_date": 1559802436, "post_id": 56457559, "comment_id": 99534582, "body": "Refer to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.sendkeys\" rel=\"nofollow noreferrer\">Application.SendKeys method (Excel)</a>."}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 10343900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e82da327864dbccda2d3014c2363d53?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10343900/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1559825748, "creation_date": 1559825748, "answer_id": 56478073, "question_id": 56457559, "link": "https://stackoverflow.com/questions/56457559/send-return-key-to-excel-formula-bar-using-winapi/56478073#56478073", "title": "Send Return Key To Excel Formula Bar Using WinAPI", "body": "<p>Thank you for all the comments. </p>\n\n<p>@Rita Han - MSFT The application.SendKeys worked as long as the focus was not the VBE window which is great! </p>\n"}], "owner": {"reputation": 161, "user_id": 10343900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e82da327864dbccda2d3014c2363d53?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/10343900/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559825748, "creation_date": 1559726127, "last_edit_date": 1592644375, "question_id": 56457559, "link": "https://stackoverflow.com/questions/56457559/send-return-key-to-excel-formula-bar-using-winapi", "title": "Send Return Key To Excel Formula Bar Using WinAPI", "body": "<h2>What I'm trying to do:</h2>\n<p>I'm trying to copy text to the clipboard then paste into excel while keeping all the formatting.</p>\n<p>The only way I have found to stop excel from spreading the text across many cells and keep formatting like bullet points etc is after copying to the clipboard, to paste it directly into the formula bar.</p>\n<h2>How I'm attempting it:</h2>\n<p>I'm using Win API to get the handle of the formula bar.</p>\n<p>Then sending a WM_PASTE message to the window to paste what's on the clipboard.</p>\n<p>Then sending a WM_SETFOCUS message to the window ready to receive the return key.</p>\n<p>Then sending a WM_KEYDOWN message for the return key.</p>\n<pre><code>Private Declare Function FindWindow _\n    Lib &quot;user32&quot; _\n    Alias &quot;FindWindowA&quot; _\n    (ByVal lpClassName As String, _\n    ByVal lpWindowName As String) As Long\n    \nPrivate Declare Function FindWindowEx _\n    Lib &quot;user32&quot; _\n    Alias &quot;FindWindowExA&quot; _\n    (ByVal hwndParent As Long, _\n    ByVal hwndChildAfter As Long, _\n    ByVal lpszClass As String, _\n    ByVal lpszWindow As String) As Long\n\nPrivate Declare Function SendMessage _\n    Lib &quot;user32.dll&quot; _\n    Alias &quot;SendMessageA&quot; _\n    (ByVal hWnd As Long, _\n    ByVal Msg As Long, _\n    ByVal wParam As Long, _\n    ByRef lParam As Any) _\n    As Long\n    \nDeclare Function PostMessage _\n    Lib &quot;user32&quot; _\n    Alias &quot;PostMessageA&quot; ( _\n    ByVal hWnd As Long, _\n    ByVal wMsg As Long, _\n    ByVal wParam As Long, _\n    lParam As Any) As Long\n\nDeclare Function SetForegroundWindow _\n    Lib &quot;user32&quot; _\n    (ByVal hWnd As Long) As Long\n                   \nPrivate Const WM_CUT As Long = &amp;H300\nPrivate Const WM_COPY As Long = &amp;H301\nPrivate Const WM_PASTE As Long = &amp;H302\nPrivate Const WM_CLEAR As Long = &amp;H303\nPrivate Const WM_UNDO As Long = &amp;H304\nPrivate Const WM_KEYDOWN  As Long = &amp;H100\nPrivate Const WM_KEYUP  As Long = &amp;H101\nPrivate Const VK_F5  As Long = &amp;H74\nPrivate Const VK_RETURN  As Long = &amp;HD\nPrivate Const WM_CHAR  As Long = &amp;H102\nPrivate Const WM_SETFOCUS  As Long = &amp;H7\nPrivate Const WM_KILLFOCUS  As Long = &amp;H8\nPrivate Const WM_IME_SETCONTEXT  As Long = &amp;H281\n\nPublic Sub pasteClipboard()\n    hwndMain = Application.hWnd: Debug.Print hwndMain\n    hwndFormulaBar = FindWindowEx(Application.hWnd, ByVal 0&amp;, &quot;EXCEL&lt;&quot;, vbNullString): Debug.Print hwndFormulaBar\n    hwndDesk = FindWindowEx(Application.hWnd, ByVal 0&amp;, &quot;XLDESK&quot;, vbNullString): Debug.Print hwndDesk\n    hwndSheet = FindWindowEx(hwndDesk, ByVal 0&amp;, &quot;EXCEL7&quot;, vbNullString): Debug.Print hwndSheet\n\n    RetVal = SendMessage(hwndFormulaBar, WM_PASTE, 0, ByVal 0)\n    Debug.Print SendMessage(hwndFormulaBar, WM_SETFOCUS, 0, 0)\n    Debug.Print SendMessage(hwndFormulaBar, WM_IME_SETCONTEXT, &amp;H0, &amp;H0)\n    Debug.Print SendMessage(hwndFormulaBar, WM_KEYDOWN, VK_RETURN, &amp;H0)\nEnd Sub\n</code></pre>\n<h2>The Problem:</h2>\n<p>This all works up until when I send the return key to finish editing the cell which is what I'd like to happen. Instead it puts a carriage return in the text box which makes a lot of sense but not the result I wanted.</p>\n<p>I've looked at the formula window with Spy++ and watched what happens when I type something in the window and hit return - when the return key is hit it finishes editing the cell.</p>\n<p><a href=\"https://i.stack.imgur.com/mNVJf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mNVJf.png\" alt=\"enter image description here\" /></a></p>\n<p>The only two commands I'm not using that show up in Spy++ are WM_IME_SETCONTEXT and WM_IME_NOTIFY but in all honesty I'm not sure what these two commands do.</p>\n<p>I tried using the WM_IME_SETCONTEXT above thinking I may have to change it before sending the return key but the results didn't change.</p>\n<h2>Any solutions?</h2>\n<p>If anyone can point me in the right direction of how to send a message that will finish editing the cell (doesn't have to be the return key, that was just my first thought) that would be great.</p>\n<p>Many Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559730282, "post_id": 56457547, "comment_id": 99508952, "body": "First thing you can do is Check your code by pressing <code>F8</code> .. That will execute your code line by line. That will help you identify what is going on Each step."}, {"owner": {"reputation": 25, "user_id": 11270908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cf8cd66bec3b39cf5a2ceb264abb33?s=128&d=identicon&r=PG&f=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/11270908/buddy"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559803156, "post_id": 56457547, "comment_id": 99534869, "body": "@Mikku this was a great idea. Only problem is now I got to see my graph being created incorrectly in real time. I think the main problem is that the graph is created with dummy values (on code: <code>Set Chart = ActiveChart</code> and not created empty and then values added, and so things get screwed up. How do I get the graph to be created empty?"}, {"owner": {"reputation": 25, "user_id": 11270908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cf8cd66bec3b39cf5a2ceb264abb33?s=128&d=identicon&r=PG&f=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/11270908/buddy"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559803775, "post_id": 56457547, "comment_id": 99535092, "body": "@Mikku thanks to your <code>F8</code> idea, and pinpointing the problem to the fact that the chart was created with data that was throwing it off, I simply added <code>ActiveChart.ChartArea.ClearContents</code> after the <code>Set Chart = ActiveChart</code> and it solved the problem. Chart content was emptied and chart came back with desired result. Thanks for the help"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559803836, "post_id": 56457547, "comment_id": 99535123, "body": "Glad it Worked :)"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 11270908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cf8cd66bec3b39cf5a2ceb264abb33?s=128&d=identicon&r=PG&f=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/11270908/buddy"}, "is_accepted": true, "score": 1, "last_activity_date": 1559803899, "creation_date": 1559803899, "answer_id": 56472234, "question_id": 56457547, "link": "https://stackoverflow.com/questions/56457547/creating-chart-on-one-sheet-based-on-dynamic-auto-filter-in-another-sheet-retu/56472234#56472234", "title": "Creating chart on one sheet based on dynamic auto filter in another sheet - returning incorrect range", "body": "<p>Writing this in answer mode to help others:\nFollowing the <code>Set Chart = ActiveChart</code>\nadd <code>ActiveChart.ChartArea.ClearContents</code> \nChart content should be emptied and chart will come back with desired result after the code completes its run.</p>\n"}], "owner": {"reputation": 25, "user_id": 11270908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62cf8cd66bec3b39cf5a2ceb264abb33?s=128&d=identicon&r=PG&f=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/11270908/buddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56472234, "answer_count": 1, "score": 0, "last_activity_date": 1559803899, "creation_date": 1559726102, "last_edit_date": 1559726871, "question_id": 56457547, "link": "https://stackoverflow.com/questions/56457547/creating-chart-on-one-sheet-based-on-dynamic-auto-filter-in-another-sheet-retu", "title": "Creating chart on one sheet based on dynamic auto filter in another sheet - returning incorrect range", "body": "<p>I have an excel workbook with multiple sheets. The first sheet is a dashboard on which I display charts based on data from other sheets.\nI have a sheet called Daily Score. In it are three columns:\nUser ID, Sum_PointsAdded, Day_Timestamp\nOn any given day, a user can have a row inserted with the points they added and the date added.\nThe header row starts on A3 and has auto filter applied.</p>\n\n<p>On the dashboard I have created a button that asks the user to insert a UserID via an input box. Based on that data, I filter the data to show only that user's score.\nA sample result would be:</p>\n\n<pre><code>User ID Sum_PointsAdded Day_Timestamp\n777      38                28/3/19\n777      11                20/3/19\n777      44                2/4/19\n777      24                13/5/19\n</code></pre>\n\n<p>The chart I add is a line chart and should show only one line (and one entry type in the legend).\nThe X axis is the date and the Y axis is the score.</p>\n\n<p>If I manually use the filter on the Daily Score sheet, and then I click the button on the Dashboard sheet and request the filter, the chart appears OK. However, if I simply click the chart button on the dashboard and don't fiddle with the filter, the chart I get has a line for Sum_PointsAdded and a line for Day_Timestamp (that I shouldn't get) and no line for score.\nThe legend has four entries: Score, Sum_PointsAdded, Day_Timestamp and Series4</p>\n\n<p>I'm assuming I'm doing something wrong with the filter or the definitions of the range for the chart. However I do have another chart on the dashboard sheet with the exact same set up (just with two lines on the chart), and there I have no problem.\nI've tried changing the location of the range definitions but it doesn't seems to work.\nNote: these are dynamic ranges.\nHere's my code:</p>\n\n<pre><code>Public Sub CreateDailyScoreChart()\n\nDim WS As Worksheet\nDim WS2 As Worksheet\nDim Rng1 As Range\nDim Rng2 As Range\nDim myValue As Variant\nDim LastRow As Long\nDim FirstRow As Long\nApplication.ScreenUpdating = False\n\nSet WS = ThisWorkbook.Sheets(\"Daily Score\")\nSet WS2 = ThisWorkbook.Sheets(\"Dashboard\")\n\nWith WS\n'set last row for entire table in order to define range\n LastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n Set Rng1 = .Range(\"A3:A\" &amp; LastRow)\n Set Rng2 = .Range(\"C3:C\" &amp; LastRow)\nEnd With\n\n\n'Input UserID\nmyValue = InputBox(\"Insert UserID\")\n\n'Filter based on UserID, for this month decending\nSheets(\"Daily Score\").Activate\n    On Error Resume Next\n    ActiveSheet.ShowAllData\n    Rng1.CurrentRegion.AutoFilter Field:=1, Criteria1:=\"=\" &amp; myValue\n\n\n  On Error GoTo 0\nWith WS.AutoFilter.Sort\n.SortFields.Clear\n.SortFields.Add2 Key _\n        :=Rng2, SortOn:=xlSortOnValues, Order:=xlAscending, _\n        DataOption:=xlSortNormal\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nRng2.AutoFilter Field:=3, Criteria1:=13, _\n        Operator:=11, Criteria2:=0, SubField:=0\n\nWith WS\n FirstRow = .AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Row\n'reset last row for filtered table\n LastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nEnd With\n\n'Delete existing chart if it exists\nOn Error Resume Next\nWith WS2\n.ChartObjects(\"DailyScore\").Activate\n.ChartObjects(\"DailyScore\").Delete\nEnd With\nOn Error GoTo 0\n\n'Add new chart\n'ThisWorkbook.Sheets(\"Dashboard\").Shapes.AddChart2(322, xlLineMarkers).Select\nWS.Activate\nWS.Shapes.AddChart2(332, xlLineMarkers).Select\n\n\nDim Chart As Chart\nSet Chart = ActiveChart\n\n\n'Defining X and Y Axis values\nDim xRng As Range\nDim vRng1 As Range\n\nWith WS\n\nSet xRng = .Range(.Cells(FirstRow, 3), .Cells(LastRow, 3))\nSet vRng1 = .Range(.Cells(FirstRow, 2), .Cells(LastRow, 2))\n\nEnd With\n\n\n'Adding series 1\nChart.SeriesCollection.NewSeries\nChart.FullSeriesCollection(1).XValues = xRng\nChart.FullSeriesCollection(1).Values = vRng1\nChart.FullSeriesCollection(1).Name = \"Score\"\n\n\nChart.SetElement (msoElementLegendBottom)\nChart.SetElement (msoElementChartTitleAboveChart)\nSelection.Caption = \"User \" &amp; myValue &amp; \" Daily Score This Year\"\nChart.Parent.Name = \"DailyScore\"\nChart.ChartArea.Select\nChart.Parent.Cut\n\nSheets(\"Dashboard\").Select\nSheets(\"Dashboard\").Activate\nRange(\"K20\").Select\nActiveSheet.Paste\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1559726702, "post_id": 56457510, "comment_id": 99507258, "body": "I think you need to use <code>Set li = ListView1.ListItems.Add(, , &quot;Item 1&quot;)</code> and then move on with your ListSubItems. Have a look <a href=\"https://10tec.com/articles/excel-vba-listview-control-examples.aspx\" rel=\"nofollow noreferrer\">here</a> and scroll down. Some nice examples."}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559728426, "post_id": 56457510, "comment_id": 99508109, "body": "Thanks, that&#39;s answered it"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1559728559, "creation_date": 1559728559, "answer_id": 56458211, "question_id": 56457510, "link": "https://stackoverflow.com/questions/56457510/populating-a-listview/56458211#56458211", "title": "Populating a ListView", "body": "<p>I think you need to use:</p>\n\n<pre><code>Set li = ListView1.ListItems.Add(, , \"Item 1\")\n</code></pre>\n\n<p>And then move on with your ListSubItems. Have a look <a href=\"https://10tec.com/articles/excel-vba-listview-control-examples.aspx\" rel=\"nofollow noreferrer\">here</a> and scroll down. Some nice examples.   </p>\n"}], "owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 56458211, "answer_count": 1, "score": 0, "last_activity_date": 1559728559, "creation_date": 1559725998, "last_edit_date": 1559726882, "question_id": 56457510, "link": "https://stackoverflow.com/questions/56457510/populating-a-listview", "title": "Populating a ListView", "body": "<p>I am struggling populating a listview, I have never used them before.</p>\n\n<p>I can populate one column, but I am struggling to populate the next column. </p>\n\n<p>This is what I have:</p>\n\n<pre><code>With ListView1\n   .View = lvwReport\n   .FullRowSelect = True\n   .Gridlines = True\n   With .ColumnHeaders\n      .Clear\n      .Add , , \"Language\", 70\n      .Add , , \"Language\", 70\n      .Add , , \"Language\", 70\n   End With\n\nEnd With\n\n\n\n\n    Set sh = ThisWorkbook.Worksheets(4)\n    With sh\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).row\n    End With\n    lC = 0\n\n\nFor r = 2 To LR\nSet li = ListView1.ListItems.Add\n   li.ListSubItems.Add , , sh.Cells(r, 4).Value\nNext\n</code></pre>\n\n<p>I thought I could just add an extra</p>\n\n<pre><code>Set li = ListView1.ListItems.Add\n   li.ListSubItems.Add , , sh.Cells(r, 5).Value\n</code></pre>\n\n<p>But this just appends the first column.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559725979, "post_id": 56457457, "comment_id": 99506940, "body": "What have you researched?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1559731006, "post_id": 56458298, "comment_id": 99509262, "body": "Run Time Error 1004 &#39;Unable to get the PivotFields property of the PivotTable class&#39;"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1559731186, "post_id": 56458298, "comment_id": 99509331, "body": "i change PageFields(&quot;Dt&quot; with PivotFields(&quot;Dt&quot;) i dint get the error but nothing happens i have the pivot checked with the 20190430 and i expect to deselect this and check 20190531"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1559731633, "post_id": 56458298, "comment_id": 99509517, "body": "I edited my answer, as I erroneously thought, the <code>PivotField</code> was used as filter field. If it works fine for you, please mark it as answer as described <a href=\"https://stackoverflow.com/help/accepted-answer\">here</a>."}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1559732071, "post_id": 56458298, "comment_id": 99509699, "body": "the code run no error and no job my code from recorder use .PivotItems(&quot;20190430&quot;).Visible = False         .PivotItems(&quot;20190531&quot;).Visible = True"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1559732276, "post_id": 56458298, "comment_id": 99509784, "body": "Now I changed it to the previous month&#39;s end."}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573562741, "post_id": 56458298, "comment_id": 103915366, "body": "Asger can i ask for your help again?"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1573714836, "post_id": 56458298, "comment_id": 103974683, "body": "Give it a try :)"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1559732254, "last_edit_date": 1559732254, "creation_date": 1559728858, "answer_id": 56458298, "question_id": 56457457, "link": "https://stackoverflow.com/questions/56457457/refresh-pivot-table-date/56458298#56458298", "title": "Refresh Pivot Table Date", "body": "<p>You have to build a string with the current month's last day,<br>\ncheck, if such a <code>PivotItem</code> exists,<br>\nset its visibility to true (as at least 1 pivotitem always has to be visible)<br>\nand then loop over all other pivotitems and switch them invisible:</p>\n\n<pre><code>Sub PivotBraunRefresh()\n    Dim pi As PivotItem\n    Dim strMonthEnd As String\n\n    ' last day of current month as string\n    strMonthEnd = Format(DateSerial(Year(Date), Month(Date), 1) - 1, \"YYYYMMDD\")\n\n    ' refresh pivottable\n    Sheets(\"Report-Inv-Actual\").PivotTables(\"PivotTable1\").PivotCache.Refresh\n\n    With Sheets(\"Report-Inv-Actual\").PivotTables(\"PivotTable1\").PivotFields(\"Dt\")\n        On Error Resume Next\n        ' check, if pivotfield exists\n        Set pi = .PivotItems(strMonthEnd)\n        On Error GoTo 0\n        If Not pi Is Nothing Then\n            pi.Visible = True\n            For Each pi In .PivotItems\n                If pi.Name &lt;&gt; strMonthEnd Then pi.Visible = False\n            Next pi\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>If you want to automate it further, you might place it within your <code>Workbook_Open()</code> event routine.</p>\n"}], "owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56458298, "answer_count": 1, "score": 1, "last_activity_date": 1559732254, "creation_date": 1559725786, "last_edit_date": 1559729346, "question_id": 56457457, "link": "https://stackoverflow.com/questions/56457457/refresh-pivot-table-date", "title": "Refresh Pivot Table Date", "body": "<p>I need to modify the following code to refresh pivot table and change the date filter, every end of month i have a new item in my date filter for example this month is 20190531 the previous item is 20190430 i need to deselect 20190430 and select 20190531 the next month i want the same situation but i have deselect 20190531 and select the new item 20190630...I need to have this dynamic not to change manually every month</p>\n\n<pre><code>Sub PivotBraunRefresh()\n\n    Sheets(\"Report-Inv-Actual\").Select\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Dt\")\n        .PivotItems(\"20190430\").Visible = False\n        .PivotItems(\"20190531\").Visible = True\n    End With\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "search"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559726239, "post_id": 56456875, "comment_id": 99507047, "body": "What do you mean with combine them? so If name or surname changes, add to listbox both of criterias?"}, {"owner": {"reputation": 1775, "user_id": 4764604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qCcfH.jpg?s=128&g=1", "display_name": "Revolucion for Monica", "link": "https://stackoverflow.com/users/4764604/revolucion-for-monica"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559727444, "post_id": 56456875, "comment_id": 99507634, "body": "@FoxfireAndBurnsAndBurns That the information in the first search field is added to the second to be more precise in the search. If I am looking for Antoine as a first name and I am looking for Smith as my last name, I want the search on the last name to be made on people who already have the first name Antoine. I do not know if it&#39;s a good browser design"}], "owner": {"reputation": 1775, "user_id": 4764604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qCcfH.jpg?s=128&g=1", "display_name": "Revolucion for Monica", "link": "https://stackoverflow.com/users/4764604/revolucion-for-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559813255, "creation_date": 1559723616, "last_edit_date": 1559813255, "question_id": 56456875, "link": "https://stackoverflow.com/questions/56456875/how-to-combine-the-investigation-of-two-search-boxes", "title": "How to combine the investigation of two search boxes?", "body": "<p>I have a staff list and a UserForm to search this list with several fields.</p>\n\n<pre><code>Matric Apellido Nombre Avi\u00f3n\n12     Burrow   Irving F15     \n42     Nelson   Howard A10\n18     Krings   Jack   F18   \n</code></pre>\n\n<p>How to combine the investigation of two (or more) search boxes? </p>\n\n<p>I tried the following code and I'm happy with it. \n    Option Compare Text</p>\n\n<pre><code>' M\u00e9thode qui se d\u00e9clanche lorsqu'on \u00e9cris dans le champ du pr\u00e9nom\nPrivate Sub name_reservist_Change()\n    ListBoxResults.Clear\n    If name_reservist &lt;&gt; \"\" Then searchresults\nEnd Sub\n\n' M\u00e9thode qui se d\u00e9clanche lorsqu'on \u00e9cris dans le champ du nom de famille\nPrivate Sub surname_reservist_Change() 'www.blog-excel.com/creer-un-champ-de-recherche-vba\n    ListBoxResults.Clear\n    If surname_reservist &lt;&gt; \"\" Then searchresults\nEnd Sub\n\n' M\u00e9thode qui aggr\u00e8ge les r\u00e9sultats des recherches\nSub searchresults()\n    ListBoxResults.Clear\n    For ligne = 2 To Sheets(\"RECAP\").Range(\"C1\").End(xlDown).Row\n        If Sheets(\"RECAP\").Cells(ligne, 4) Like \"*\" &amp; name_reservist &amp; \"*\" And Sheets(\"RECAP\").Cells(ligne, 3) Like \"*\" &amp; surname_reservist &amp; \"*\" Then\n            ListBoxResults.AddItem Sheets(\"RECAP\").Cells(ligne, 3) &amp; \" \" &amp; Sheets(\"RECAP\").Cells(ligne, 4)\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Yet I'm now thinking it might not be the best solution if I have lots of search screen like in this interface</p>\n\n<p><img src=\"https://justpaste.it/img/70ea01107bf07764c2dc73917ed650bb.png\" alt=\"photo]\"></p>\n\n<p>It seems that I can use the \"autofilter\" method, or pass the range to an array and traverse it, pass the range to a recordset and make a sql. However I have never used these methods.</p>\n\n<p>It's the first time I do a search engine. If you have browser design tips I'm interested. I know that my searches are not very efficient : for instance as far as any time I add a new character to the search I loop over the whole list again.</p>\n\n<h1>Update</h1>\n\n<p>I tried to generalize with all the ComboBoxes and TextBoxes:</p>\n\n<pre><code>' M\u00e9thode qui se d\u00e9clenche lorsqu'on \u00e9crit dans le champ du pr\u00e9nom\nPrivate Sub cboFunction_Change()\n    ListBoxResults.Clear\n    If cboFunction &lt;&gt; \"\" Then searchresults\nEnd Sub\n\n' M\u00e9thode qui se d\u00e9clenche lorsqu'on \u00e9crit dans le champ du pr\u00e9nom\nPrivate Sub txtNameReservist_Change()\n    ' on vide la ListBox des r\u00e9sultats pour la mettre \u00e0 jour\n    ListBoxResults.Clear\n    ' Si le champ n'est pas vide on lance la m\u00e9thode searchresults\n    If txtNameReservist &lt;&gt; \"\" Then searchresults\nEnd Sub\n...\n\n' M\u00e9thode qui aggr\u00e8ge les r\u00e9sultats des recherches\nSub searchresults()\n    ' on cherche \u00e0 partir de la ligne 2 jusqu'au bout de la feuille\n    For ligne = 2 To Sheets(\"RECAP\").Range(\"C1\").End(xlDown).Row\n\n        ' cr\u00e9ation des conditions\n        cond_function = Sheets(\"RECAP\").Cells(ligne, 2) Like \"*\" &amp; cboFunction &amp; \"*\"\n        cond_surname = Sheets(\"RECAP\").Cells(ligne, 3) Like \"*\" &amp; txtSurnameReservist &amp; \"*\"\n        cond_name = Sheets(\"RECAP\").Cells(ligne, 4) Like \"*\" &amp; txtNameReservist &amp; \"*\"\n        cond_sex = Sheets(\"RECAP\").Cells(ligne, 5) Like \"*\" &amp; cboSexReservist &amp; \"*\"\n        cond_rank = Sheets(\"RECAP\").Cells(ligne, 6) Like \"*\" &amp; cboRankReservist &amp; \"*\"\n        cond_txtIncorporationNumberReservist = Sheets(\"RECAP\").Cells(ligne, 7) Like \"*\" &amp; cboRankReservist &amp; \"*\"   \n\n        ...\n\n        ' on teste si les cellules sont proches \u00e0 droite ou \u00e0 gauche des donn\u00e9es \u00e9crites dans les champs de recherche\n        If cond_function And cond_surname And cond_name And cond_sex Then\n            ' On remplit la ListBox des r\u00e9sultats avec les noms et pr\u00e9nom des personnels\n            ListBoxResults.AddItem Sheets(\"RECAP\").Cells(ligne, 3) &amp; \" \" &amp; Sheets(\"RECAP\").Cells(ligne, 4)\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1559725461, "post_id": 56456793, "comment_id": 99506670, "body": "What variable type is <code>filename</code>?"}, {"owner": {"reputation": 9, "user_id": 11601324, "user_type": "registered", "profile_image": "https://graph.facebook.com/2476547585723249/picture?type=large", "display_name": "Kamil Stachowski", "link": "https://stackoverflow.com/users/11601324/kamil-stachowski"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1559728530, "post_id": 56456793, "comment_id": 99508164, "body": "Variable type is String for filename"}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 11561158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcfab384fc6e33996160df3ad56d2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hippolyte BRINGER", "link": "https://stackoverflow.com/users/11561158/hippolyte-bringer"}, "is_accepted": false, "score": 0, "last_activity_date": 1559724876, "creation_date": 1559724876, "answer_id": 56457220, "question_id": 56456793, "link": "https://stackoverflow.com/questions/56456793/data-import-operation-stops-when-triggered-by-a-shortcut-but-works-in-debug-mode/56457220#56457220", "title": "Data import operation stops when triggered by a shortcut but works in debug mode", "body": "<p>When you run it step by step it works, but not when you run normally ? It's weird !</p>\n\n<p>I recommend you to remove all <code>Select</code>, it's source of error ! Because may be when you run step by step you select a sheet \"manually\" and it's why your code run differently.</p>\n\n<p>Like this :</p>\n\n<pre><code>Sheets(\"Current Receipt On Stock\").Range(\"E2\").PasteSpecial Paste:=xlPasteValues, _\n        Operation:=xlNone, SkipBlanks :=False, Transpose:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 11601324, "user_type": "registered", "profile_image": "https://graph.facebook.com/2476547585723249/picture?type=large", "display_name": "Kamil Stachowski", "link": "https://stackoverflow.com/users/11601324/kamil-stachowski"}, "is_accepted": true, "score": 0, "last_activity_date": 1559898609, "last_edit_date": 1559898609, "creation_date": 1559728157, "answer_id": 56458109, "question_id": 56456793, "link": "https://stackoverflow.com/questions/56456793/data-import-operation-stops-when-triggered-by-a-shortcut-but-works-in-debug-mode/56458109#56458109", "title": "Data import operation stops when triggered by a shortcut but works in debug mode", "body": "<p><strong>UPDATE: Instead of shortcut I made a button as trigger and macro works, the problem occurs only while triggered by shortcut.</strong></p>\n\n<p>Thank you for suggestion about removing all <code>Select</code>, but the main problem still occurs.</p>\n\n<blockquote>\n  <p>When you run it step by step it works, but not when you run normally ?\n  It's weird !</p>\n</blockquote>\n\n<p>That's right, it's weird. I'm noob in VBA and try to understand the code but It stops while macro open workbook in this part:</p>\n\n<pre><code>    Filename = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xls*), *.xls*\", Title:=\"Select a Douglas Inbound Report File\")\n\nSet SrcWbk = Workbooks.Open(Filename)\n</code></pre>\n\n<p>it does not start copying the data from <strong>\"Summary\"</strong> sheet to the same named sheet in destination workbook (where macro is running):</p>\n\n<pre><code>Worksheets(\"Summary\").Activate\nSrcWbk.Sheets(\"Summary\").Range(\"A:W\").Copy DestWbk.Sheets(\"Summary\").Range(\"A:W\")\nSrcWbk.Close False\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11601324, "user_type": "registered", "profile_image": "https://graph.facebook.com/2476547585723249/picture?type=large", "display_name": "Kamil Stachowski", "link": "https://stackoverflow.com/users/11601324/kamil-stachowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1495, "favorite_count": 0, "accepted_answer_id": 56458109, "answer_count": 2, "score": 0, "last_activity_date": 1559898609, "creation_date": 1559723317, "last_edit_date": 1559740701, "question_id": 56456793, "link": "https://stackoverflow.com/questions/56456793/data-import-operation-stops-when-triggered-by-a-shortcut-but-works-in-debug-mode", "title": "Data import operation stops when triggered by a shortcut but works in debug mode", "body": "<p>I have a problem with macro, when running it stops while opening a source file (at first sheet - from second sheet should copy 3 ranges of data). While running it in debug mode it works properly step-by-step.\nI'm newbie in VBA and cannot locate the mistake in code. Thank you for help!</p>\n\n<p>I had problem with checking is \"Summary\" sheet already exists but i solved this problem using function and it works currently.</p>\n\n<p><strong>UPDATE</strong>: When source file (from which data have to be copied) is open, macro works triggered by a shortcut but it should open file, copy the ranges, paste it to the destination sheet. If source file is chosen from pop-up window triggered by macro, it opens and macro stops without copying and pasting.</p>\n\n<pre><code>If Not sheet_exists(\"Summary\") Then\nThisWorkbook.Sheets.Add( _\nAfter:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)).Name = _\n\"Summary\"\nEnd If\n\n    Filename = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xls*), *.xls*\", Title:=\"Select an Inbound Report File\")\n\nSet SrcWbk = Workbooks.Open(Filename)\nWorksheets(\"Summary\").Activate\nSrcWbk.Sheets(\"Summary\").Range(\"A:W\").Copy DestWbk.Sheets(\"Summary\").Range(\"A:W\")\nSrcWbk.Close False\n\n    DestWbk.Sheets(\"Summary\").Range(\"A9:F9\", Range(\"A9:F9\").End(xlDown)).Copy\n    Sheets(\"Current Receipt On Stock\").Select\n    Range(\"E2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nSheets(\"Summary\").Select\n\n    DestWbk.Sheets(\"Summary\").Range(\"G9:H9\", Range(\"G9:H9\").End(xlDown)).Copy\n    Sheets(\"Current Receipt On Stock\").Select\n    Range(\"L2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nSheets(\"Summary\").Select\n\n    DestWbk.Sheets(\"Summary\").Range(\"I9:W9\", Range(\"I9:W9\").End(xlDown)).Copy\n    Sheets(\"Current Receipt On Stock\").Select\n    Range(\"P2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nApplication.DisplayAlerts = False\nSheets(\"Summary\").Delete\nApplication.DisplayAlerts = True\nSheets(\"Current Receipt On Stock\").Range(\"E2\").Select\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559724550, "post_id": 56456746, "comment_id": 99506206, "body": "&quot; So I have to Loop through a folder and then Import every file that is not in the DB.&quot; - what does it means? Do you store information about imported files? Or you should only import all files from specified folder? Or do you check folder time by time and import that have not been imported earlier?"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559725382, "post_id": 56456746, "comment_id": 99506622, "body": "Sorry i forgot to add this info I loop through a specific folder and then open each file write the fileinfos into the DB with an SQL statement.  I do not know how to import all the new files after the first import because i loop the folder every 60 sec. and i have moved the file to the backupfolder before so i did not have this problem"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1559728738, "post_id": 56456746, "comment_id": 99508255, "body": "Are you just creating a record with file path and name?"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1559729134, "post_id": 56456746, "comment_id": 99508424, "body": "@June7  how do you mean that? I do not understand what exactly you mean"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559729211, "post_id": 56456746, "comment_id": 99508461, "body": "So point is this: how are you distinguish file that have to be processed from that have to be ignored?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1559729621, "post_id": 56456746, "comment_id": 99508655, "body": "Exactly what data do you &#39;write&#39; to record? Are you embedding file into attachment field? Are you opening a text file and saving its contents to a memo field? What data is in record that can be used to indicate what file it originally came from? Simplest may be to save file name. Code can use name of file in folder and see if that file name is already in table."}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559733386, "post_id": 56456746, "comment_id": 99510308, "body": "@VanNg well i acctualli would just need a way to only import the new filesnto the DB - is that possible?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559734655, "post_id": 56456746, "comment_id": 99510857, "body": "@alex how do you, as user, select <code>new</code> files? Their name different, you look a list of imported files? How?"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559735253, "post_id": 56456746, "comment_id": 99511129, "body": "@VanNg theese files are like this: XXX.ETI   and I do Search for *.ETI and the user does not have to search anything in the files."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559735632, "post_id": 56456746, "comment_id": 99511308, "body": "Ok. You have: 111.ETI, 222.ETI, 333.ETI. Which of them are <code>new</code>? How you find <code>new</code> files?"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559735864, "post_id": 56456746, "comment_id": 99511427, "body": "@VanNg yes this is my question: i have 111.eti,222.eti import them into the db then assume its 2h later 333.eti  i want to import this file then"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736063, "post_id": 56456746, "comment_id": 99511518, "body": "@alex, so you have several solutions. 1st variant: move files after processing to another folder (e.g. <code>ProcessedFiles</code>), so that program will always process any file that stored in current folder. 2nd variant: create a table, that will contain names of processed files, and compare files in folder with list of processed files"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736145, "post_id": 56456746, "comment_id": 99511559, "body": "@VanNg oh okay so i have mooved the files before but this option is no longer possible how do i \u201esync\u201c the table during the import?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736539, "post_id": 56456746, "comment_id": 99511760, "body": "Please explain, what does your program do? By logic: 1. I move through each file 2. For each file I 2.1 import it and 2.2 move to other folder... Because I don&#39;t understand your <code>sync</code> word. What does it mean? Try to explain your task in terms of problem, rather than solution?"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736613, "post_id": 56456746, "comment_id": 99511790, "body": "@VanNg  What I mean is how do I Compare the table with the Folder?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736729, "post_id": 56456746, "comment_id": 99511834, "body": "@alex, what is the goal of comparing table with the folder? Do you mean you want to compare list of files in table with list of files in folder? Be more detailed, please, large part of your thoughts is only in your mind, as I see, you need to express them"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559736892, "post_id": 56456746, "comment_id": 99511917, "body": "@VanNg  okay so I want to import files from folder xy to my DB that does work atm but after that I move the files so I do not run into an error trying to import a file twice. I want to comparte the folder xy with my table tab_xy so I can exclude the files from importing if they are on the list. And i do not know how i compare my array with a table of my DB"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559737797, "post_id": 56456746, "comment_id": 99512395, "body": "So you have to do following steps: 1. Get list of already imported files from <code>tab_xy</code> 2. Scan folder <code>xy</code> for list of files. 3. For each file, that in folder <code>xy</code> and not in table <code>tab_xy</code>: a. import file b. add file name to file list in table <code>tab_xy</code>. Correct?"}, {"owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "reply_to_user": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559738694, "post_id": 56456746, "comment_id": 99512905, "body": "@VanNg do you have a script part of this? because as I mentioned i am not that good at programming. would be nice."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1559759822, "creation_date": 1559759822, "answer_id": 56466212, "question_id": 56456746, "link": "https://stackoverflow.com/questions/56456746/access-import-data-from-a-folder-if-its-not-in-the-db/56466212#56466212", "title": "Access Import Data from a folder if its not in the DB", "body": "<p>You have some different options, depending on particulars that you are not providing.</p>\n\n<ol>\n<li><p>If the data in the imported files have unique, non-repeating qualities like sequence numbers or time stamps, check whether the records about to be imported already exist in the database.</p></li>\n<li><p>You said that moving the files to a different folder is no longer a good enough solution. How about renaming them? Can <code>111.ETI</code> be renamed to <code>111.imported.ETI</code> (or in any way be altered so that the filename itself marks it as already imported)?</p></li>\n<li><p>Add a new \"imported files\" table in your database where you keep track of all the files already imported.</p></li>\n<li><p>Check the creation date/time of each file and keep track of the latest date/time that has been imported. Be careful to use creation date/time and not last modification date/time if the files are accessed by other sources as well.</p></li>\n<li><p>If you have any control of how the source files are being generated/named, make sure the filenames themselves are sequential and keep track of the last imported file.</p></li>\n</ol>\n"}], "owner": {"reputation": 45, "user_id": 9653040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtjeJ.png?s=128&g=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9653040/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594716147, "creation_date": 1559723116, "last_edit_date": 1594716147, "question_id": 56456746, "link": "https://stackoverflow.com/questions/56456746/access-import-data-from-a-folder-if-its-not-in-the-db", "title": "Access Import Data from a folder if its not in the DB", "body": "<p>So I have to Loop through a folder and then Import every file that is not in the DB. </p>\n\n<p>With that said there is another program that needs to use the files after mine, I have the whole Import code but I do not know how to set the Import in order to only Import what is new.</p>\n\n<p>ATM it does Import all files from folder XXX and then moves them to a backup folder.</p>\n\n<p>I would like that it copies them to the backup folder and then only imports the new data.</p>\n\n<pre><code>ReDim Preserve FileArray(1000)\n\nDo While strFileName &lt;&gt; \"\" \nFileArray(Y) = strFolder &amp; \"\\\" &amp; strFileName\nstrFileName = Dir\nY = Y + 1\n\nLoop\n\nnr = Y\n\nY = Y - 1\n\nIf Y = -1 Then\nMsgBox (\"Keine Daten zum Importieren verf\u00fcgbar\")\nDoCmd.Requery\nExit Sub\n\nElse\n\n\nReDim Preserve FileArray(Y)\n\nEnd If\n</code></pre>\n\n<p>Here would have to be a statement to only import certain files but I do not understand how that is established.</p>\n\n<p>My coding skills are very low.</p>\n\n<p>Thanks for every help!</p>\n\n<p>(Yes I have Googled and searched on this stack.)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559723124, "post_id": 56456576, "comment_id": 99505477, "body": "You seem to be asking a very similar question every couple of weeks.  I think you need to describe the process from start to end as I don&#39;t think you are going about it the right way."}, {"owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1559725698, "post_id": 56456576, "comment_id": 99506785, "body": "Hi @Gareth Thanks for the comment, I have changed my question, hopefully is clearly now."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560259711, "post_id": 56457789, "comment_id": 99671334, "body": "Hello @FAB your code edit works fine, but I&#39;m having some problems, I would like to know how can I modify the code for it to respect it respective order on each row? The code is copying successfully the data under the headers, but it seems to be skipping some cells in the process and as a result the information does not match."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560260849, "post_id": 56457789, "comment_id": 99672039, "body": "@Pod you&#39;ll have to a lot more specific about &quot;in order&quot; means for you. Considering you have repeating headers, seemingly random across the sheet, my code picks them up in what Excel considers the order of <code>Find</code>, starting from previous <code>Find</code> range. so if you want all rows from column A, then column B, etc say that. If you want all column values from Row1, then Row2, etc, then say that. Otherwise how would you expect anyone to guess the order?"}, {"owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560264363, "post_id": 56457789, "comment_id": 99674271, "body": "I apologize for the misunderstanding @FAB . I would like to have the value from every Row due that each Row corresponds to a specific location. To explain a little bit more about my data: Each set of headers represent the information from a location, not every location has the same header nor on the same order, but the headers I&#39;m interested on all appear throughout all locations. I would like to have the value from every Row in each Column so once the Headers are arranged I am still able to see the correct location\u2019s data."}, {"owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560264958, "post_id": 56457789, "comment_id": 99674696, "body": "As a follow-up to this process I will use the schedules\u2019 headers which are divided in 4 different headers to set up a function that shows me if a location is open or closed. I need the headers arranged so I can run the function through the entire columns. This last part is already done but I am detailing it so you can have a better scope of my project.  @FAB"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560265793, "post_id": 56457789, "comment_id": 99675208, "body": "I<code>m sorry @Pod, but I</code>m still not more clear on what you want the final result to look like. If you can, please provide a screenshot side by side, of current sample data, and how you want it to look finally, then i`ll change the code to match that."}, {"owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560269274, "post_id": 56457789, "comment_id": 99677338, "body": "I have added a picture link &quot;Result Picture Example&quot; on top of the page. This picture is an example of the result. Each cell data from Row1 is specific from Row1, each data found in Row2 is specific from Row2, and so on. Hope this picture helps clarify my issue and thank you for the help. @FAB"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560270468, "post_id": 56457789, "comment_id": 99677954, "body": "@Pod i think it makes more sense now, even if you have headers all over, they are still relating to each other on the same row.... I`ll update my code when i get home."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 0, "creation_date": 1560286969, "post_id": 56457789, "comment_id": 99684916, "body": "@Pod see updated code, I think now it does what you want it do. I assume (hope) that at least &quot;/@codeInsee&quot; is a static column (always in A), otherwise might need some further tweaks."}, {"owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "edited": false, "score": 1, "creation_date": 1560328621, "post_id": 56457789, "comment_id": 99695960, "body": "Hello @FAB You are right, it is static in column A. The vba code works perfectly! Thank you for your time and help, I was stucked in this part of the project for weeks."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 0, "last_activity_date": 1560286816, "last_edit_date": 1560286816, "creation_date": 1559726942, "answer_id": 56457789, "question_id": 56456576, "link": "https://stackoverflow.com/questions/56456576/arrange-headers-data-vba/56457789#56457789", "title": "Arrange Header&#39;s Data VBA", "body": "<p>Assuming you have the titles already as headers for columns in the second sheet, please see if this helps, I've added comments in the code for more details:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub CopyHeadersColumns()\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\nEnd With\n\nWith ActiveWorkbook\n    Dim wsSrc As Worksheet: Set wsSrc = .Sheets(\"Sheet1\")\n    Dim wsDst As Worksheet: Set wsDst = .Sheets(\"Sheet2\")\nEnd With\n\nDim arrTitles As Variant\narrTitles = Array(\"/@codeInsee\", \"/Nom\", \"/Coordonn\u00e9esNum/T\u00e9l\u00e9copie\", \"/Coordonn\u00e9esNum/T\u00e9l\u00e9phone\", \"/Ouverture/PlageJ/@d\u00e9but\", \"/Ouverture/PlageJ/@fin\", \"/Ouverture/PlageJ/PlageH/@d\u00e9but\", \"/Ouverture/PlageJ/PlageH/@fin\")\n\nDim arrData As Variant, arrDstTitles As Variant, arrCols() As Long\nDim R As Long, C As Long, X As Long, Y As Long, lRowSrc As Long, lColSrc As Long, lRowDst As Long\n\narrDstTitles = wsDst.Cells(1, 1).Resize(1, wsDst.Cells(1, Columns.Count).End(xlToLeft).Column)\n\nDim dicTitles As Object\nSet dicTitles = CreateObject(\"Scripting.Dictionary\")\n\n'Allocate the column number of the destination title to the dictionary for reuse\nFor X = LBound(arrTitles) To UBound(arrTitles)\n    For Y = LBound(arrDstTitles, 2) To UBound(arrDstTitles, 2)\n        If arrTitles(X) = arrDstTitles(1, Y) Then\n            dicTitles(arrTitles(X)) = Y\n            Exit For\n        End If\n    Next Y\nNext X\n\n\nWith wsSrc\n    lRowSrc = .UsedRange.Rows.Count 'get the last row in the source worksheet\n    lColSrc = .UsedRange.Columns.Count 'get the last column in the source worksheet\n    arrData = .Cells(1, 1).Resize(lRowSrc, lColSrc) 'get the data into an array\n\n    For R = LBound(arrData) To UBound(arrData)\n        For C = LBound(arrData, 2) To UBound(arrData, 2)\n            'Check if row is a title\n            If dicTitles.Exists(arrData(R, C)) Then 'title found\n                If X &lt;&gt; R Then ReDim arrCols(1 To lColSrc) 'redimensionate the array to hold the column number of the destination\n                X = R 'save the row of the title\n                arrCols(C) = dicTitles(arrData(R, C))\n            ElseIf Not X = R And Not IsEmpty(arrData(R, C)) And Not arrCols(C) = 0 Then\n                With wsDst\n                    If C = 1 Then lRowDst = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n                    .Cells(lRowDst, arrCols(C)).Value = arrData(R, C)\n                End With\n            End If\n        Next C\n    Next R\nEnd With\n\nWith Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> changed the code based on new input from OP.</p>\n"}], "owner": {"reputation": 23, "user_id": 11527345, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-twjlFxUAE1I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcEa3yASo2_fvaezN8Um9vfRVYg_g/mo/photo.jpg?sz=128", "display_name": "Pod", "link": "https://stackoverflow.com/users/11527345/pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 56457789, "answer_count": 1, "score": 1, "last_activity_date": 1560521147, "creation_date": 1559722457, "last_edit_date": 1560521147, "question_id": 56456576, "link": "https://stackoverflow.com/questions/56456576/arrange-headers-data-vba", "title": "Arrange Header&#39;s Data VBA", "body": "<p>I am working on a sheet of data with several headers and I would like to arrange each header in a specific column. </p>\n\n<p>My issue right now is that I have several headers througout the rows and I am only able to arrange the headers by the first set of headers in the first row and not in all the rows. </p>\n\n<p>In every column and rows there are headers, I would like to have the respective data under the same header for each column.</p>\n\n<p>The code I am using right now that only allows to me to arrange the columns by the first row of columns is the following: </p>\n\n<pre><code>Sub CopyHeadersColumns()\n\n'Set the column heading you want. Add as many as you want, comma seperated\n'The order you enter determines the order they appear on the second sheet\nDim Titles As Variant\nTitles = Array(\"/@codeInsee\", \"/Nom\", \"/Coordonn\u00e9esNum/T\u00e9l\u00e9copie\", \"/Coordonn\u00e9esNum/T\u00e9l\u00e9phone\", \"/Ouverture/PlageJ/@d\u00e9but\", \"/Ouverture/PlageJ/@fin\", \"/Ouverture/PlageJ/PlageH/@d\u00e9but\", \"/Ouverture/PlageJ/PlageH/@fin\")\n\nDim i As Long 'Counter\n\nFor i = 0 To UBound(Titles)\n\n    'Select Full Report Sheet\n    Sheets(1).Select\n\n    'Find Notes column and copy. If it can't find the title, will move to the next.\n    On Error GoTo ErrHandler\n        Cells.Find(What:=Titles(i), After:=Range(\"A1\"), _\n        LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByColumns).EntireColumn.Copy\n    On Error GoTo 0\n\n    'Select Secondary Report sheet, column E and paste\n    Sheets(2).Select\n    Range(\"A1\").Offset(0, i).Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n\nNextOne:\nNext i\n\nExit Sub\n\nErrHandler:\nResume NextOne\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 3, "creation_date": 1559720446, "post_id": 56456086, "comment_id": 99504309, "body": "You&#39;re never changing the value of <code>sheet1.Cells(3, 7)</code>, so your loop never terminates."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1559720905, "post_id": 56456086, "comment_id": 99504488, "body": "Note: In the theoretical case you got your loop working to check that cell&#39;s value you are going to need a waiting time to actually be able to see &#39;blinking&#39;."}, {"owner": {"reputation": 3, "user_id": 10872670, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991255407628010/picture?type=large", "display_name": "De Bruce Luc", "link": "https://stackoverflow.com/users/10872670/de-bruce-luc"}, "edited": false, "score": 0, "creation_date": 1559721887, "post_id": 56456086, "comment_id": 99504900, "body": "Thanks jsheeran and JvdV. How can I add a waiting time.  Thanks"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1559722053, "post_id": 56456086, "comment_id": 99504969, "body": "@DeBruceLuc - Are you waiting for user input to change the value in <code>sheet1.Cells(3, 7)</code>?"}, {"owner": {"reputation": 3, "user_id": 10872670, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991255407628010/picture?type=large", "display_name": "De Bruce Luc", "link": "https://stackoverflow.com/users/10872670/de-bruce-luc"}, "edited": false, "score": 0, "creation_date": 1559722589, "post_id": 56456086, "comment_id": 99505228, "body": "@Enimativity -  Actually, the value in Cell G3 only changes when products are supplied and there is no low stock. Hence the value reverts to zero then the blinking should stop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559725307, "post_id": 56456086, "comment_id": 99506597, "body": "Check Application.OnTime (you will find examples on SO).  But whilst you might get it to work, it will be messy and you will probably regret it.  Better IMHO to make the button stand out another way."}], "owner": {"reputation": 3, "user_id": 10872670, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991255407628010/picture?type=large", "display_name": "De Bruce Luc", "link": "https://stackoverflow.com/users/10872670/de-bruce-luc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559721879, "creation_date": 1559720310, "last_edit_date": 1559720718, "question_id": 56456086, "link": "https://stackoverflow.com/questions/56456086/vba-do-while-loop", "title": "Vba: Do While/ Loop", "body": "<p>I have a command button titled \"LOW STOCK\" on my userform, I want the back color of this button to switch between yellow and salmon when Cell G3 > 0 (Cell G3 contains number of products below stock minimum limit). </p>\n\n<p>The blinking will prompt the user to click the button inorder to display (via a pop up message box) numbers of products having low stock. </p>\n\n<p>I inserted the code below in Userform_Initialize, but excel freezes up and displays on the title bar \"Excel is Not Responding\". Please I'll be glad to know where I went wrong.</p>\n\n<pre><code>Sub Userform_Initialize\n    Do while sheet1.Cells(3, 7) &gt; 0 \n        btnLowStock.Backcolor = RGB(255, 255, 0)\n        btnLowStock.Backcolor = RGB(255, 128, 128)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559724683, "post_id": 56455831, "comment_id": 99506276, "body": "Have you looked at <a href=\"https://stackoverflow.com/questions/19300248/changing-color-of-a-row-of-listview-according-to-item\">this old thread</a> for example? Would that be helpfull?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1559730533, "post_id": 56455831, "comment_id": 99509065, "body": "Do you want the (complete) row (back)color or the fontcolor in that row?"}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 0, "creation_date": 1559731239, "post_id": 56455831, "comment_id": 99509346, "body": "complete row, and back colour"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 2, "creation_date": 1559738956, "post_id": 56455831, "comment_id": 99513056, "body": "I think it&#39;s not possible in VBA (ForeColor is) [Maybe a picture with colored rows as background?]"}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "edited": false, "score": 0, "creation_date": 1559739818, "post_id": 56455831, "comment_id": 99513598, "body": "Thanks, that makes sense then"}], "owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559724840, "creation_date": 1559719178, "last_edit_date": 1559724840, "question_id": 56455831, "link": "https://stackoverflow.com/questions/56455831/change-colour-of-individual-item-in-listview-in-userform", "title": "Change Colour of Individual Item In Listview in Userform", "body": "<p>I am trying to use a <strong>ListView</strong> instead of a listbox, to give me some control over the background colours for individual rows.</p>\n\n<p>I have achieved changing the listview background colour as a whole for example: BackColor = &amp;HC000&amp; - However, I want to make one of the rows its own colour.</p>\n\n<pre><code>With ListView1\n   .View = lvwReport\n   .CheckBoxes = True\n   .FullRowSelect = True\n   .Gridlines = True\n   .BackColor = &amp;HC000&amp;\n   With .ColumnHeaders\n      .Clear\n      .Add , , \"Language\", 70\n      .Add , , \"Subitem-1\", 70\n      .Add , , \"Subitem-2\", 70\n   End With\n\n\n   Dim li As ListItem\n\n   Set li = .ListItems.Add()\n\n   li.Bold = True 'Bold item\n\n   'li.BackColor = Color.Gold\n   li.ListSubItems.Add , , \"Subitem 1.1\"\n   li.ListSubItems.Add , , \"Subitem 1.2\"\n\n\n   Set li = .ListItems.Add()\n   li.ListSubItems.Add , , \"Subitem 2.1\"\n   li.ListSubItems.Add , , \"Subitem 2.2\"\n\n   Set li = .ListItems.Add()\n\n   li.ListSubItems.Add , , \"Subitem 3.1\"\n   li.ListSubItems.Add , , \"Subitem 3.2\"\n\n\n   .ColumnHeaders(1).Position = 2\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559740908, "post_id": 56455637, "comment_id": 99514214, "body": "Where are you determining the number of pages and looping them?"}, {"owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559752249, "post_id": 56455637, "comment_id": 99520723, "body": "When I was clicking through the pages on the website, the URL doesn&#39;t change so I thought it would all be able to be pulled from the first page. However, my main question is why am I pulling two clinic names and no addresses? Is it something to do with the fact that the addresses are hidden?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559764435, "post_id": 56455637, "comment_id": 99525694, "body": "I can&#39;t load that page for some reason."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1559765019, "creation_date": 1559765019, "answer_id": 56467242, "question_id": 56455637, "link": "https://stackoverflow.com/questions/56455637/excel-vba-data-scrape-not-all-data-being-pulled/56467242#56467242", "title": "Excel VBA data scrape - not all data being pulled", "body": "<p>Try the following which returns nodeLists based on class and then indexing in</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim html As HTMLDocument\n    Set html = New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.scpcn.ca/clinics\", False\n        .send\n        html.body.innerHTML = .responseText\n        Dim names As Object, addresses As Object, i As Long\n        Set names = html.querySelectorAll(\".clinic-title\")\n        Set addresses = html.querySelectorAll(\".clinic-address\")\n        For i = 0 To names.Length - 1\n            With ActiveSheet\n                .Cells(i + 1, 1) = names.item(i).innerText\n                .Cells(i + 1, 2) = addresses.item(i).innerText\n            End With\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 11513229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bda9f9e740399983667568696750d?s=128&d=identicon&r=PG&f=1", "display_name": "bigalbunyan", "link": "https://stackoverflow.com/users/11513229/bigalbunyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 56467242, "answer_count": 1, "score": 1, "last_activity_date": 1559765019, "creation_date": 1559718228, "last_edit_date": 1559725259, "question_id": 56455637, "link": "https://stackoverflow.com/questions/56455637/excel-vba-data-scrape-not-all-data-being-pulled", "title": "Excel VBA data scrape - not all data being pulled", "body": "<p>I posted a similar question recently, but I've been able to successfully scrape some data from webpages since then. However, I've run into a problem. When trying to scrape from this page: <a href=\"https://www.scpcn.ca/clinics\" rel=\"nofollow noreferrer\">https://www.scpcn.ca/clinics</a></p>\n\n<p>I'm trying to get addresses and clinic names, however, when I use this code I only get the first page. It's also outputting two of each clinics on the first page but no addresses. </p>\n\n<p>Even weirder is that it worked once, pulling all the clinics and about half the addresses, when I deleted this and tried to run again I only got the first 10 clinics and that's where its at now. </p>\n\n<p>I thought the issue was that the page wasn't waiting long enough so I added a wait timer but that didn't seem to do anything.</p>\n\n<pre><code>Option Explicit\n\nSub GetSouthClinicData()\n\n    Dim objIE As InternetExplorer\n    Dim clinicEle As Object\n    Dim clinicAdd As Object\n\n    Dim clinicName As String\n    Dim clinicAddress As String\n    Dim y As Integer\n    Dim x As Integer\n\n    Set objIE = New InternetExplorer\n    objIE.Visible = True\n\n    objIE.Navigate \"https://www.scpcn.ca/clinics\"\n    While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Wend\n    Application.Wait (Now + TimeValue(\"0:00:5\"))\n\n    y = 2\n\n    For Each clinicEle In objIE.document.getElementsByClassName(\"clinic-title\")\n        clinicName = clinicEle.getElementsByTagName(\"a\")(0).innerText\n        Sheets(\"Sheet3\").Range(\"A\" &amp; y).Value = clinicName\n        y = y + 1\n    Next\n\n    x = 2\n        For Each clinicEle In objIE.document.getElementsByClassName(\"toggle-address clinic-address\")\n        clinicAddress = clinicEle.getElementsByTagName(\"br\")(0).innerText\n        Sheets(\"Sheet3\").Range(\"B\" &amp; x).Value = clinicAddress\n        x = x + 1\n    Next\n\n    objIE.Quit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559709989, "post_id": 56453439, "comment_id": 99501286, "body": "You could try to run a find/replace and give the formatting at the replacement time. Just a suggestion, as I&#39;m still in bed and can&#39;t test myself :)"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "edited": false, "score": 0, "creation_date": 1559729812, "post_id": 56453439, "comment_id": 99508735, "body": "You do realise that it is impossible to not use styles, don&#39;t you? Whatever style is applied at the point of insertion in refDoc is what will apply to the unformatted text you are bring across from the old doc. If refDoc is a new blank document then the style will be &#39;Normal&#39;. If refDoc is supposed to be formatted with &quot;Sabon LT&quot; simply changing the Normal style to use that font will solve your problem."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1559748801, "post_id": 56453439, "comment_id": 99518908, "body": "The problem you describe sounds like that character (at the very least) is formatted with a right-to-left language font setting or an Asian font setting. I&#39;ve run into similar issues with documents written originally with Hebrew as the <b><i>Windows</i></b> default language, for example. So start by investigating on what kind of system the documents were originally created on."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1559782859, "post_id": 56453439, "comment_id": 99530680, "body": "May refer to  @Cindy Meister&#39;s <a href=\"https://stackoverflow.com/questions/52472173/word-vba-macro-unable-to-change-font-size-of-non-english-words\">answer</a> solved similar problem faced by me and explore use of <code>NameBi</code> and   <code>SizeBi</code>"}], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1582780030, "creation_date": 1559700461, "last_edit_date": 1582780030, "question_id": 56453439, "link": "https://stackoverflow.com/questions/56453439/msword-leading-inverted-comma-doesnt-take-font-via-vba", "title": "MSWord - Leading inverted comma doesn&#39;t take font via VBA", "body": "<p>I've been tasked with writing some VBA to combine a number of MSWord documents into a single document and format it based on certain styles in the original. One of the formatting changes is a different font. The document owner can't use styles in the final document.</p>\n\n<p>My code works other than for one issue: If the paragraph is dialogue, ie it starts with an inverted comma, the new font is adopted apart from the very first inverted comma which has the default document font. Even if I set the <code>.Range.Font</code> property on the character, parapgraph or entire document, the default font of that inverted comma won't change. And yet it does if I manually select the text and set the font from my dropdown.</p>\n\n<p>Does anyone know what I'm missing here? How do I ensure that leading inverted commas in a paragraph adopt the assigned font? The relevant parts of the code are as follows:</p>\n\n<pre><code>Dim fd As FileDialog\nDim txDoc As Document, refDoc As Document\nDim rng As Range, chr As Range\nDim para As Paragraph\nDim pt(1) As Long\nDim i As Long, p As Long\n\n'... some code to open the files and find the relevant parts.\n\n'Transfer the text.\n\n'-&gt; refDoc is the new document to which the old documents are transferred.\n'-&gt; txDoc is one of the old documents.\n'-&gt; Both are opened from a FileDialog routine.\nWith refDoc\n    .Range(.Content.End - 1, .Content.End - 1).InsertBreak wdPageBreak\n    pt(0) = .Content.End - 1\n    .Range.InsertAfter txDoc.Content.Text\n    pt(1) = .Content.End - 1\nEnd With\n\n'Set the basic format.\nWith refDoc.Range(pt(0), pt(1))\n    With .Font\n        .Name = \"Sabon LT\"\n        .Size = 12\n    End With\n    With .ParagraphFormat\n        .LeftIndent = CentimetersToPoints(0)\n        .RightIndent = CentimetersToPoints(0)\n        .SpaceBefore = 0\n        .SpaceBeforeAuto = False\n        .SpaceAfter = 0\n        .SpaceAfterAuto = False\n        .LineSpacingRule = wdLineSpaceDouble\n        .Alignment = wdAlignParagraphLeft\n        .WidowControl = False\n        .KeepWithNext = False\n        .KeepTogether = False\n        .PageBreakBefore = False\n        .NoLineNumber = False\n        .Hyphenation = False\n        .FirstLineIndent = CentimetersToPoints(1)\n        .OutlineLevel = wdOutlineLevelBodyText\n        .CharacterUnitLeftIndent = 0\n        .CharacterUnitRightIndent = 0\n        .CharacterUnitFirstLineIndent = 0\n        .LineUnitBefore = 0\n        .LineUnitAfter = 0\n        .MirrorIndents = False\n        .TextboxTightWrap = wdTightNone\n        .CollapsedByDefault = False\n    End With\nEnd With\n\n'... some additional formatting code.\n</code></pre>\n"}, {"tags": ["vba", "levenshtein-distance"], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 3761714, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/59b4e7ad9accdee54411a1c49907c03f?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/3761714/luis"}, "edited": false, "score": 0, "creation_date": 1559746006, "post_id": 56454245, "comment_id": 99517266, "body": "thanks! But in the example at the end then... the distance between &quot;saturday&quot; and &quot;sunday&quot; is 3. How do we arrive at that number? It means the edit distance between the two words or strings is 3 - (add &quot;a&quot;, add &quot;t&quot;, change &quot;r&quot; to &quot;n&quot;)."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 209, "user_id": 3761714, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/59b4e7ad9accdee54411a1c49907c03f?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/3761714/luis"}, "edited": false, "score": 0, "creation_date": 1559753240, "post_id": 56454245, "comment_id": 99521179, "body": "I`ve added a bit more info... but long story short: with each loop iteration, it builds a matrix of the differences, starting from comparing 1:1 first letters, till the last. Based on the loop position, and with each iteration, it will use previous position values to calculate the difference at current position."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1559842848, "last_edit_date": 1559842848, "creation_date": 1559708782, "answer_id": 56454245, "question_id": 56453110, "link": "https://stackoverflow.com/questions/56453110/debugging-levenshtein-distance-implementation-how-is-the-min-distance-being-ca/56454245#56454245", "title": "Debugging Levenshtein distance implementation - how is the min distance being calculated?", "body": "<p>I don't have much clue about Levenshtein, however I can explain what's going on in that array, please see comments in the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>l1 = Len(s1) 'this sets a variable with the length of the first string\nl2 = Len(s2) 'this sets a variable with the length of the second string\n\nReDim d(l1, l2) 'redimension the array to this size, though this can be seen as ReDim d(0 to l1, 0 to l2)\n\nFor i = 0 To l1 'for i = 0 to length of first string\n    d(i, 0) = i 'allocate the value of i to each row in the array, at col 0\nNext i\n\nFor j = 0 To l2 'for j = 0 to length of second string\n    d(0, j) = j 'allocate the value of j to each column in the array, at row 0\nNext j\n</code></pre>\n\n<p><strong>EDIT:</strong> I've added some debugging (will print to ActiveSheet). Blue for where the letters match, red for the others... though the colour doesn't matter.</p>\n\n<p>As far as I can tell, with each loop iteration, it builds a matrix of the differences, starting from comparing 1:1 first letters, till the last. Based on the loop position, and with each iteration, it will use previous position values to calculate the difference at current position.</p>\n\n<p>This is probably easier to follow with shorter strings.</p>\n\n<ul>\n<li><p>Loop through each letter in second word, then loop through each letter in first word</p></li>\n<li><p>at first outer loop (for each row), first inner loop (for each column), we have <code>S</code> meet <code>S</code> = 0. (<code>d(i, j) = d(i - 1, j - 1)</code> evaluates to <code>d(i, j) = d(1 - 1, 1 - 1)</code>, i.e.: <code>0</code>)</p></li>\n<li><p>at first outer loop, second inner loop, we have <code>S</code> meet <code>U</code> = 1.</p></li>\n<li><p>etc, etc.</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/8LEIO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8LEIO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Other than that, step through the code and see how the variables change based on the if conditions... not sure i can explain this any better.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function Levenshtein(s1 As String, s2 As String)\n\nDim i As Integer, j As Integer\nDim l1 As Integer, l2 As Integer\nDim min1 As Integer, min2 As Integer\nDim d() As Integer\n\n'For debugging purposes only\nCells.Clear\nDim rngOutput As Range: Set rngOutput = ActiveSheet.Range(\"A1\").Resize(Len(s1) + 2, Len(s2) + 2)\n\nWith rngOutput\n    .ColumnWidth = 3\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\nEnd With\n\nl1 = Len(s1): l2 = Len(s2): ReDim d(l1, l2)\n\nFor i = 0 To l1\n    d(i, 0) = i\n    With rngOutput\n        .Cells(i + 3, 1) = Mid(s1, i + 1, 1)\n        If Not i = 0 Then .Cells(i + 2, 2) = i\n    End With\nNext i\n\nFor j = 0 To l2\n    d(0, j) = j\n    With rngOutput\n        .Cells(1, j + 3) = Mid(s2, j + 1, 1)\n        If Not j = 0 Then .Cells(2, j + 2) = j\n    End With\nNext j\n\nFor i = 1 To l1\n    For j = 1 To l2\n        If Mid(s1, i, 1) = Mid(s2, j, 1) Then\n            d(i, j) = d(i - 1, j - 1)\n\n            With rngOutput.Cells(i + 2, j + 2)\n                .Value = d(i, j)\n                .Font.Color = vbBlue\n            End With\n        Else\n            min1 = d(i - 1, j) + 1\n            min2 = d(i, j - 1) + 1\n            If min2 &lt; min1 Then\n                min1 = min2\n            End If\n            min2 = d(i - 1, j - 1) + 1\n            If min2 &lt; min1 Then\n                min1 = min2\n            End If\n            d(i, j) = min1\n\n            With Cells(i + 2, j + 2)\n                .Value = d(i, j)\n                .Font.Color = vbRed\n            End With\n        End If\n    Next\nNext\n\nLevenshtein = d(l1, l2)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 3761714, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/59b4e7ad9accdee54411a1c49907c03f?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/3761714/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 918, "favorite_count": 0, "accepted_answer_id": 56454245, "answer_count": 1, "score": 1, "last_activity_date": 1559842848, "creation_date": 1559697037, "last_edit_date": 1559842815, "question_id": 56453110, "link": "https://stackoverflow.com/questions/56453110/debugging-levenshtein-distance-implementation-how-is-the-min-distance-being-ca", "title": "Debugging Levenshtein distance implementation - how is the min distance being calculated?", "body": "<p>I have been trying to understand this code for while but I can't get how the distances are calculated.  I know how the algorithm should work (it provides the edit distance in characters between two strings and I can do it on paper), but I don't understand how this line (as an example)</p>\n\n<blockquote>\n  <p>d(i, j) = d(i - 1, j - 1)</p>\n</blockquote>\n\n<p>comes back as an integer. Same for min1, min2. We already define </p>\n\n<blockquote>\n  <p>d(i,0)</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>d(0,j)</p>\n</blockquote>\n\n<p>, but how does it get a value when </p>\n\n<blockquote>\n  <p>d(i,j)</p>\n</blockquote>\n\n<p>is not 0 in one of the two arguments? </p>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPublic Function Levenshtein(s1 As String, s2 As String)\n\nDim i As Integer\nDim j As Integer\nDim l1 As Integer\nDim l2 As Integer\nDim d() As Integer\nDim min1 As Integer\nDim min2 As Integer\n\nl1 = Len(s1)\nl2 = Len(s2)\nReDim d(l1, l2)\nFor i = 0 To l1\n    d(i, 0) = i\nNext\nFor j = 0 To l2\n    d(0, j) = j\nNext\nFor i = 1 To l1\n    For j = 1 To l2\n        If Mid(s1, i, 1) = Mid(s2, j, 1) Then\n            d(i, j) = d(i - 1, j - 1)   \n        Else\n            min1 = d(i - 1, j) + 1\n            min2 = d(i, j - 1) + 1\n            If min2 &lt; min1 Then\n                min1 = min2\n            End If\n            min2 = d(i - 1, j - 1) + 1\n            If min2 &lt; min1 Then\n                min1 = min2\n            End If\n            d(i, j) = min1\n        End If\n    Next\nNext\nLevenshtein = d(l1, l2)\nEnd Function\n\n?Levenshtein(\"saturday\",\"sunday\")\n\n3\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1559708635, "post_id": 56453051, "comment_id": 99501012, "body": "What&#39;s <code>Range(&quot;B&quot; &amp; i) &amp; InputBox(...)</code> supposed to return? That&#39;s not going to return a valid range, and I bet is an issue that will throw an error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559709990, "post_id": 56453051, "comment_id": 99501287, "body": "You need to capture the first Inputbox into a variable before you start the loop, or it will prompt for every iteration."}, {"owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "edited": false, "score": 0, "creation_date": 1559715805, "post_id": 56453051, "comment_id": 99502626, "body": "To reconfirm - you have two inputboxes, and you want the result to be returned in which column? (&#39;th column - what is that?). Can you show a snapshot of the expected result?"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 11363473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b17693398516c94c815d616d965047?s=128&d=identicon&r=PG&f=1", "display_name": "TenEM", "link": "https://stackoverflow.com/users/11363473/tenem"}, "is_accepted": true, "score": 0, "last_activity_date": 1560240216, "creation_date": 1560240216, "answer_id": 56539101, "question_id": 56453051, "link": "https://stackoverflow.com/questions/56453051/is-there-a-way-to-sort-data-from-an-imput-value/56539101#56539101", "title": "is there a way to sort data from an imput value", "body": "<p>Range(\"B\" &amp; i) contained a dropdown list and InputBox(...) a variable that is added to the text i solved the problem </p>\n\n<p>the isue was in Range(\"B\" &amp; i) the dropdown list wasn't detected and i specified the cells in the code. thanks everyone</p>\n\n<pre><code>Sub fill_next()\nFor i = 1 To 8\nIf Range(\"A\" &amp; 15).Value = Range(\"A\" &amp; i).Value Then\n\nRange(\"A\" &amp; 21).Value = Range(\"B\" &amp; 15) &amp; \"*\" &amp; InputBox(\"enter restaure date\",      \"Consultation\") &amp; \"*\"\"\" &amp; Range(\"C\" &amp; 15).Value\nEnd If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11363473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b17693398516c94c815d616d965047?s=128&d=identicon&r=PG&f=1", "display_name": "TenEM", "link": "https://stackoverflow.com/users/11363473/tenem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56539101, "answer_count": 1, "score": 0, "last_activity_date": 1560240216, "creation_date": 1559696531, "last_edit_date": 1559701521, "question_id": 56453051, "link": "https://stackoverflow.com/questions/56453051/is-there-a-way-to-sort-data-from-an-imput-value", "title": "is there a way to sort data from an imput value", "body": "<p>i have 3 columns in excel with the values Name / City / Birthday i try to create an inputbox where i can type in the Name and a second one where i will type in the birth date so that the result that will show up in the 'th column will be City+Birthday only for the name used in the first imputbox.\ni tried this but it didn't work</p>\n\n<pre><code>Sub fill_next()\n    For i = 2 To 10\n        If InputBox(\"vam\", \"val\") = Range(\"A\" &amp; i).Value Then\n            Range(\"E\" &amp; i).Value = Range(\"B\" &amp; i) &amp; InputBox(\"enter number\", \"value baliz\")\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "pass-through", "ms-access-reports"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1559697502, "post_id": 56452920, "comment_id": 99499177, "body": "Instead of popup input boxes, have users enter criteria into controls on form. Then instead of trying to set label Caption property, have textbox reference the form control. Textbox acts as &#39;label&#39;. Otherwise, have to use report Format event to set control properties. Format event triggers only for PrintPreview or direct to printer. Should have code to set QueryDefs behind a form."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1559697578, "post_id": 56452920, "comment_id": 99499193, "body": "What report are you running this code? The same one in <code>OpenReport</code>? Why are you using <code>inputbox</code> and not an Access form? This isn&#39;t Excel!"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559709753, "post_id": 56452920, "comment_id": 99501235, "body": "Does <code>Me.lblFromDate</code> exist? It sounds to me from that error message that either the label doesn&#39;t exist, or you are not using it correctly. In a excel userform, that&#39;s correct, but not so sure in your report. You can always comment out docmd for debugging purpose, I doubt has anything to do with that."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1559718792, "post_id": 56452920, "comment_id": 99503694, "body": "<i>Abends</i>? That&#39;s what a <i>Novell NetWare</i> server could do."}], "answers": [{"tags": [], "owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "is_accepted": false, "score": 0, "last_activity_date": 1559729890, "creation_date": 1559729890, "answer_id": 56458564, "question_id": 56452920, "link": "https://stackoverflow.com/questions/56452920/access-abends-after-docmd-openreport/56458564#56458564", "title": "Access abends after DoCmd.OpenReport", "body": "<p>As I remember, captions can not be modified, when report open. Only in design mode. So this is not correct, because you have already opened report</p>\n\n<pre><code>Me.lblFromDate.Caption = strFromDate\n</code></pre>\n\n<p>You should use text boxes instead of captions. Also you can clear the borders, fillings and so on, that text box will appear like a caption.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 9472407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040ae4c90591a8aadb40aaee2f16de0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/9472407/tim"}, "is_accepted": true, "score": 0, "last_activity_date": 1560265839, "last_edit_date": 1560265839, "creation_date": 1559832080, "answer_id": 56479906, "question_id": 56452920, "link": "https://stackoverflow.com/questions/56452920/access-abends-after-docmd-openreport/56479906#56479906", "title": "Access abends after DoCmd.OpenReport", "body": "<p>Finally the correct set of code was produced.  The button click creates strOpenArgs and passes it with .OpenReport.  The report opens and splits the OpenArgs and populates the appropriate labels with updated Captions.  Text boxes would not work!  Here's the button click event:</p>\n\n<pre><code>Private Sub btnPreviewP1_Click()\n\n    If (Me.txtToDateP1 &lt; Me.txtFromDateP1) Then\n        MsgBox (\"The From Date must occurr before the To Date!\")\n    End If\n\n    Dim strFromDateHMS  As String\n    Dim strToDateHMS    As String\n    Dim strSQLP1    As String\n    Dim strOpenArgs As String\n\n    strFromDateHMS = Format(Me.txtFromDateP1, \"yyyy-mm-dd\") &amp; \" \" &amp; Me.cboFromHourP1 &amp; \":\" &amp; Me.cboFromMinuteP1 &amp; \":\" &amp; Me.cboFromSecondP1\n    strToDateHMS = Format(Me.txtToDateP1, \"yyyy-mm-dd\") &amp; \" \" &amp; Me.cboToHourP1 &amp; \":\" &amp; Me.cboToMinuteP1 &amp; \":\" &amp; Me.cboToSecondP1\n\n    strSQLP1 = \"exec dbo.uspWorkCentreReport '\" &amp; strFromDateHMS &amp; \"','\" &amp; strToDateHMS &amp; \"','\" &amp; strWCP1 &amp; \"',\" &amp; strShiftP1\n\n    strOpenArgs = Me.RecordSource &amp; \"|\" &amp; strFromDateHMS &amp; \"|\" &amp; strToDateHMS &amp; \"|\" &amp; strWCP1 &amp; \"|\" &amp; strShiftP1\n\n    ' This line is all that's needed to modify the PT query\n    CurrentDb.QueryDefs(\"ptq_uspWorkCentreReport\").SQL = strSQLP1\n\n    DoCmd.OpenReport \"rpt_ptq_uspWorkCentreReport\", acViewReport, , , , strOpenArgs\n\nEnd Sub\n</code></pre>\n\n<p>And here's the reports _Open:</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\n    Dim SplitOpenArgs() As String\n    SplitOpenArgs = Split(Me.OpenArgs, \"|\")\n    Me.lblFromDate.Caption = SplitOpenArgs(1)\n    Me.lblToDate.Caption = SplitOpenArgs(2)\n    Me.lblWC.Caption = SplitOpenArgs(3)\n    Me.lblShift.Caption = SplitOpenArgs(4)\nEnd Sub\n</code></pre>\n\n<p>This opens the report every time with new appropriate data, so long as the report is closed before the form's button is pressed again for another refresh of the report.  If the report is not closed the report stays up with the original data and does not refresh with new data...  But that is <a href=\"https://stackoverflow.com/questions/56480889/access-report-cannot-be-closed-or-refreshed-from-vb-with-updated-parameter-set\">another question</a> I am about to ask.  Thanks All.</p>\n"}], "owner": {"reputation": 71, "user_id": 9472407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040ae4c90591a8aadb40aaee2f16de0f?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/9472407/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 56479906, "answer_count": 2, "score": -1, "last_activity_date": 1560265839, "creation_date": 1559695084, "question_id": 56452920, "link": "https://stackoverflow.com/questions/56452920/access-abends-after-docmd-openreport", "title": "Access abends after DoCmd.OpenReport", "body": "<p>A report is called from VBA to receive returned records from an Access pass-through query.  After the DoCmd completes the report's parameters are set in the report's appropriate label containers setting their .Caption property as required.  Access fails intermittently during this process which leads me to believe that the report is not truly open to receive the parameters.  Here's the VBA sub:</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\n\n    Dim strFromDate     As String\n    Dim strToDate       As String\n    Dim strWC           As String\n    Dim intShift        As Integer\n    Dim strSQL          As String\n\n    strFromDate = InputBox(\"Enter From Date and Time: \")\n    strToDate = InputBox(\"Enter To Date and Time: \")\n    strWC = InputBox(\"Enter Work Center: \")\n    intShift = InputBox(\"Enter Shift: \")\n\n    strSQL = \"exec dbo.uspWorkCentreReport_TEST \" &amp; \"'\" &amp; strFromDate &amp; \"', \" &amp; \"'\" &amp; strToDate &amp; \"', \" &amp; \"'\" &amp; strWC &amp; \"', \" &amp; intShift &amp; \";\"\n\n    CurrentDb.QueryDefs(\"ptq_uspWorkCentreReport\").SQL = strSQL\n\n    DoCmd.OpenReport \"rpt_qry_ptq_uspWorkCentreReport\", acViewReport\n\n    Me.lblFromDate.Caption = strFromDate\n    Me.lblToDate.Caption = strToDate\n    Me.lblWC.Caption = strWC\n    Me.lblShift.Caption = intShift\n\nEnd Sub\n</code></pre>\n\n<p>When the failure occurrs VBA highlights the Me.lblFromDate.Caption = strFromDate.  If I press Reset in VBA or End on the Run-time error '2467': dialog, Access abends without any other outward signs.  Access then re-opens to save the copied *_Backupx.accdb and opens with a fresh copy of the .accdb.  The error seems to be a standars MS error:\n<a href=\"https://i.stack.imgur.com/3MmJx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3MmJx.png\" alt=\"MS Run-time error 2467\"></a>\nAs I said the report is intermittent and when it fails VB always highlights the same line in code.  How do I capture what is happening or can I make VB wait a half of full second before it tries to write the parameters?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11570478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4120f26cd6e2339807f05eb365c8538b?s=128&d=identicon&r=PG&f=1", "display_name": "HDdanielm", "link": "https://stackoverflow.com/users/11570478/hddanielm"}, "edited": false, "score": 1, "creation_date": 1559704050, "post_id": 56453554, "comment_id": 99500236, "body": "Thank you for providing the notation alongside the code for the Macro itself, it was almost perfect as is for what I needed. They&#39;re in Column B on a different spreadsheet, so I just had to adjust the -4&#39;s to -1, then the -1 to 2 and it worked perfectly. This wasn&#39;t mentioned though, so I can&#39;t really hold that against you in any way.  I am brand new to VBA, so all of the explanation in comments, as well as a link to more details is very helpful. It&#39;s greatly appreciated!"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 0, "last_activity_date": 1559701689, "creation_date": 1559701689, "answer_id": 56453554, "question_id": 56452812, "link": "https://stackoverflow.com/questions/56452812/repeating-formula-with-incrementing-cell-reference/56453554#56453554", "title": "Repeating Formula with Incrementing Cell Reference", "body": "<p>The Excel application object has a function called <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.convertformula\" rel=\"nofollow noreferrer\">ConvertFormula</a> which you can use to change a formula between reference styles (A1 or R1C1) and to specify whether the rows and columns should be relative references or absolute references.</p>\n\n<p>If you start off by creating the formula in each row as a relative reference then you can use ConvertFormula to turn it into an absolute reference. The only restriction is that the formula cannot be longer than 255 characters.</p>\n\n<p>Adapting your code and following the advice in <a href=\"https://stackoverflow.com/q/10714251/2127508\">How to avoid using Select in Excel VBA</a> gives us:</p>\n\n<pre><code>Option Explicit\n\nSub HDDatesRef()\n\nDim r As Range\n\n' If we know the cell address we want to start in then we could use that directly\n' e.g. Set r = Worksheets(\"HD\").Range(\"E1\")\nSet r = ActiveCell\n\nDo\n    ' The With block just saves us typing r.FormulaR1C1 multiple times\n    With r\n        ' Don't know what your relative formula would be. I've assumed that we are\n        ' working in column E but adjust as appropriate\n        .FormulaR1C1 = \"=IF(AND(HD!RC[-4]&gt;0,ISBLANK(HD!RC[-1])),HD!RC[-4],\"\"n/a\"\")\"\n\n        ' Take the formula we already have which is in R1C1 format, keep it in R1C1 format,\n        ' change it from a relative reference based on cell r to an absolute reference\n        ' and make that the new formula for this cell\n        .FormulaR1C1 = Application.ConvertFormula(.FormulaR1C1, xlR1C1, xlR1C1, xlAbsolute, r)\n    End With\n\n    ' Move down one row\n    Set r = r.Offset(1, 0)\nLoop Until r.Value = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>In case you aren't familiar with them. here are the references for <a href=\"https://docs.microsoft.com/en-gb/office/vba/Language/Reference/user-interface-help/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit</a> and <a href=\"https://docs.microsoft.com/en-gb/office/vba/Language/Reference/user-interface-help/with-statement\" rel=\"nofollow noreferrer\">With...End With</a></p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1559709616, "creation_date": 1559709616, "answer_id": 56454337, "question_id": 56452812, "link": "https://stackoverflow.com/questions/56452812/repeating-formula-with-incrementing-cell-reference/56454337#56454337", "title": "Repeating Formula with Incrementing Cell Reference", "body": "<p>You can do this without looping, Excel is smart enough to know you want incremental.</p>\n\n<p>As an example do run this on a fresh sheet:</p>\n\n<pre><code>Sub ShowIncremental()\n    Range(\"A1:A10\").Formula = \"=Row(A1)\"\n    Range(\"B1:B10\").Formula = \"=A1*2\"\n    Range(\"C1:C10\").Formula = \"=sum(B$1:B1)\"\nEnd Sub\n</code></pre>\n\n<p>Notice the formulas created in A1:C10. Notice Excel incremented them even though the code didn't say to except in the case where we absoluted B$1.</p>\n\n<p>I recommend you do something similar with your code to avoid looping, this will be much much faster.</p>\n"}], "owner": {"reputation": 23, "user_id": 11570478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4120f26cd6e2339807f05eb365c8538b?s=128&d=identicon&r=PG&f=1", "display_name": "HDdanielm", "link": "https://stackoverflow.com/users/11570478/hddanielm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 56453554, "answer_count": 2, "score": 1, "last_activity_date": 1559709616, "creation_date": 1559693723, "last_edit_date": 1559699047, "question_id": 56452812, "link": "https://stackoverflow.com/questions/56452812/repeating-formula-with-incrementing-cell-reference", "title": "Repeating Formula with Incrementing Cell Reference", "body": "<p>So I have built a formula that has Absolute Cell References, and wanted to repeat the same formula down 3000 cells with each one referencing increment cells. (1st formula referring to Cell $A$1, 2nd formula referring to $A$2) I know that I could easily do this without referencing exact cells and the Fill Handle and this is currently how it's set up, however there's a very large number of people who work in this spreadsheet that have bad Excel manners, and regularly delete rows and cells or copy and paste, which breaks the formulas.</p>\n\n<p>Rather than manually editing the same formula in each cell to change the references from relative to absolute, I was wanting to run a Macro to automatically run the formula for 3000 cells.</p>\n\n<p>I had at first built a Macro that fills 20 cells with the formula, but it didn't adjust the formula based on the active cell. (Always entered with range $A$1:$A$20, and not $A$21:$a$40 when started further down) I changed the Macro to loop, but it looks with all formulas referencing $A$1 rather than updating.</p>\n\n<p>The Macro set up to loop is as follows:</p>\n\n<pre><code>Sub HDDatesRef()\n\nActiveCell.Select\nActiveCell.FormulaR1C1 = \"=IF(AND(HD!R1C1&gt;0,ISBLANK(HD!R1C4)),HD!R1C1,\"\"n/a\"\")\"\nActiveCell.Offset(1, 0).Range(\"A1\").Select\n\nLoop Until ActiveCell.Value = \"\"\n\nEnd Sub     \n</code></pre>\n\n<p>Any and all help with figuring this out would help immensely. Right now I also have access to Liknedin Learning, so if there's any suggestions for courses on there I should look into so I can understand what I need to do will help with this.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 0, "last_activity_date": 1559713333, "creation_date": 1559713333, "answer_id": 56454793, "question_id": 56452795, "link": "https://stackoverflow.com/questions/56452795/how-do-i-round-columns-based-on-heading-type/56454793#56454793", "title": "How do I round columns based on heading type", "body": "<p>You were close enough, just needed a bit from both of those tries together. Please see if the below helps, I've added an alternative using arrays as well (if you have lots of data, it will be much faster):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RoundRanges()\n\nDim ws As Worksheet: Set ws = ActiveSheet 'better use something like: ActiveWorkbook.Sheets(\"Sheet name here\")\nDim lRow As Long: lRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row 'get last row\nDim lCol As Long: lCol = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column 'get last column\n\nDim R As Long, C As Long\n\nFor C = 1 To lCol 'iterate through each column\n    Select Case ws.Cells(2, C) 'get the text of the cell 2...\n        Case \"Percent\"\n            For R = 3 To lRow 'iterate through each row\n                ws.Cells(R, C) = WorksheetFunction.Round(ws.Cells(R, C).Value, 1) 'apply the desired calculation\n            Next R\n        Case \"Dollars\"\n            For R = 3 To lRow 'iterate through each row\n                ws.Cells(R, C) = WorksheetFunction.Round(ws.Cells(R, C).Value, 2) 'apply the desired calculation\n            Next R\n    End Select\nNext C\n\n'ALTERNATIVE:\n'Dim arrData As Variant: arrData = ws.Range(ws.Cells(1, 1), ws.Cells(lRow, lCol))\n'For R = LBound(arrData) + 2 To UBound(arrData) 'skip first 2 rows\n'    For C = LBound(arrData, 2) To UBound(arrData, 2)\n'        If arrData(2, C) = \"Percent\" Then\n'            arrData(R, C) = Round(arrData(R, C), 1)\n'        ElseIf arrData(2, C) = \"Dollars\" Then\n'            arrData(R, C) = Round(arrData(R, C), 2)\n'        End If\n'    Next C\n'Next R\n'ws.Range(ws.Cells(1, 1), ws.Cells(lRow, lCol)) = arrData\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11445361, "user_type": "registered", "profile_image": "https://graph.facebook.com/650951922/picture?type=large", "display_name": "Nick Vanderkooi", "link": "https://stackoverflow.com/users/11445361/nick-vanderkooi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56454793, "answer_count": 1, "score": 1, "last_activity_date": 1559713333, "creation_date": 1559693536, "last_edit_date": 1559712804, "question_id": 56452795, "link": "https://stackoverflow.com/questions/56452795/how-do-i-round-columns-based-on-heading-type", "title": "How do I round columns based on heading type", "body": "<p>I have a table consisting of strings and numbers.  Row one contains the heading and row two contains the unit type (percent and dollars).  I would like to round the numbers in the column based on the heading in row two.</p>\n\n<p>At the moment I am selecting the columns individually.  Is there a way to round the column based on the heading in row two?</p>\n\n<pre><code>Sub Round()\n\nDim Lastrow As Long\nLastrow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row 'Determine \nlast row\n\n        For Each cell In ActiveSheet.Range(\"R3:R\" &amp; Lastrow)\n        cell.Value = WorksheetFunction.Round(cell.Value, 2) 'Round dollars to 2 places\n        Next cell\n\n        For Each cell In ActiveSheet.Range(\"AB3:AB\" &amp; Lastrow)\n        cell.Value = WorksheetFunction.Round(cell.Value, 2)\n        Next cell\n\n       For Each cell In ActiveSheet.Range(\"Q3:Q\" &amp; Lastrow)\n       cell.Value = WorksheetFunction.Round(cell.Value, 1) 'Round percentages to 1 places\n       Next cell\n\n       ....\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1673, "user_id": 3813846, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TAPN9.jpg?s=128&g=1", "display_name": "Kaiser", "link": "https://stackoverflow.com/users/3813846/kaiser"}, "edited": false, "score": 0, "creation_date": 1559703665, "post_id": 56452768, "comment_id": 99500180, "body": "You can do that with an array formula."}, {"owner": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "reply_to_user": {"reputation": 1673, "user_id": 3813846, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TAPN9.jpg?s=128&g=1", "display_name": "Kaiser", "link": "https://stackoverflow.com/users/3813846/kaiser"}, "edited": false, "score": 0, "creation_date": 1559795257, "post_id": 56452768, "comment_id": 99532713, "body": "What would that array formula look like?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "edited": false, "score": 0, "creation_date": 1559854338, "post_id": 56476389, "comment_id": 99560051, "body": "If fred flintstone had two more dates in column E (dates 3/9 and 3/22); I need an equation in C2 to look for the for the first fred flintsone date greater than B2 and in column E and get that return value that value, so I would need 3/9 returned"}, {"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "reply_to_user": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "edited": false, "score": 0, "creation_date": 1559856973, "post_id": 56476389, "comment_id": 99560841, "body": "So both of your lists have duplicate names?  Or is one of the a list of unique values?"}, {"owner": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "edited": false, "score": 0, "creation_date": 1559865238, "post_id": 56476389, "comment_id": 99562704, "body": "Yes, from the shot you post, I would need and equation in column C to look for the matching name in column D with the first date larger than the one in ColB"}, {"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "reply_to_user": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "edited": false, "score": 0, "creation_date": 1560009426, "post_id": 56476389, "comment_id": 99603169, "body": "Hello, I have revised the answer with a new formula."}, {"owner": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "edited": false, "score": 0, "creation_date": 1560347151, "post_id": 56476389, "comment_id": 99706951, "body": "One more question jenn; if there are dates before so for example Fred had a date of 6/1/2017 in column F. From trials in excel it pulls the closest value not the next highest value so is there a way to exclude value lower than the value in column B?"}, {"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "reply_to_user": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "edited": false, "score": 0, "creation_date": 1560997792, "post_id": 56476389, "comment_id": 99922953, "body": "I have revised the answer to exclude values equal to or lesser than the value in column B."}], "tags": [], "owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1560997757, "last_edit_date": 1560997757, "creation_date": 1559819528, "answer_id": 56476389, "question_id": 56452768, "link": "https://stackoverflow.com/questions/56452768/vlookup-equation/56476389#56476389", "title": "Vlookup equation", "body": "<p>You can nest your vlookup inside an if(countif to make it lookup only if your condition is met.  Whatever you are looking up needs to be in a column to the left of the date.  You will also need to have your list of dates sorted descending.</p>\n\n<p>Here is the formula in the example below:  <code>IF(COUNTIF($A$2:$A$6,D2)&gt;1,VLOOKUP(D2,$A$2:$B$6,2,0),\"\")</code></p>\n\n<p>Formula explanation:\nCount the number of time the value of D2 appears in A2:A6.  If it appears more than 1 time, return the value of adjacent cell to the right, otherwise, return blank. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Tsqaj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tsqaj.png\" alt=\"enter image description here\"></a></p>\n\n<p>REVISION</p>\n\n<p>A basic vlookup with an approximate match will work for this. When the match type is set to approximate, it returns the next higher result.</p>\n\n<pre><code>=VLOOKUP(A1,E1:F6,2,1)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/I37I0.jpg\" alt=\"enter image description here\"></p>\n\n<p>REVISION #2</p>\n\n<p>In order to omit values that are equal to or lesser than the value in column B, you'll need to use an index/match array.  Enter the formula below and then while your cursor is in the cell, press control+shift+enter.  Excel will then add curly braces around the formula and calculate it as an array and return the answer.</p>\n\n<pre><code>=IFNA(INDEX($F$1:$F$6,MATCH(1, ($E$1:$E$6=A1)*($F$1:$F$6&gt;B1),0)),\"\")\n</code></pre>\n\n<p>Without the IFNA wrapped around the Index/Match formula, if there are no matches with a greater date, Excel will return a #N/A error.  However, it will also return a #N/A error if you don't get the control+shift+enter done correctly.  </p>\n\n<p>I recommend you first enter the formula below, which doesn't include the IFNA wrapper, and confirm that some matches are returned.  If your item doesn't have any matches, then #N/A will be returned, but you'll know the formula is working properly. Then change the formula to the one above that does include the IFNA wrapper, so that blanks are returned in place of #N/A.  </p>\n\n<pre><code>=INDEX($F$1:$F$6,MATCH(1, ($E$1:$E$6=A5)*($F$1:$F$6&gt;B5),0))\n</code></pre>\n\n<p>After the first is done, you can double-click the lower-right corner of the cell to populate the rest of the column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/R4tcu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R4tcu.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6867513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829e47675598b2cc9a19b4598a127f4?s=128&d=identicon&r=PG&f=1", "display_name": "MVCSOC", "link": "https://stackoverflow.com/users/6867513/mvcsoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560997757, "creation_date": 1559693278, "last_edit_date": 1559731526, "question_id": 56452768, "link": "https://stackoverflow.com/questions/56452768/vlookup-equation", "title": "Vlookup equation", "body": "<p>If you have a date in col1, a name in col2 of sheet1, can you use a vlookup to search for the name in sheet2 and return the only first date greater if that name in sheet2 has multiple dates?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559689667, "post_id": 56452132, "comment_id": 99497890, "body": "Can you show an example of what you want to do? Maybe a picture?"}, {"owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559702998, "post_id": 56452132, "comment_id": 99500070, "body": "Sorry, I forgot to mention I am interesting the caption through an array."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 0, "creation_date": 1559703053, "post_id": 56452739, "comment_id": 99500087, "body": "Oh thanks, is there a way to iterate through an array for the caption title?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 0, "creation_date": 1559720430, "post_id": 56452739, "comment_id": 99504302, "body": "Answer edited for iteration through table cells"}, {"owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 0, "creation_date": 1559736504, "post_id": 56452739, "comment_id": 99511741, "body": "I ran it, getting an error on Set Tbl, The requested member of the collection does not exist"}, {"owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 0, "creation_date": 1559737081, "post_id": 56452739, "comment_id": 99512018, "body": "I got it to work, tweaked a couple lines but yeah, this is what I wanted. Thank you."}, {"owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 0, "creation_date": 1559749304, "post_id": 56452739, "comment_id": 99519206, "body": "quick question, how do i exit the table, as in I want to write more text below the table but the text keeps getting inputted into the table cell. How do I exit that cell? @Ahmed AU"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 1, "creation_date": 1559753131, "post_id": 56452739, "comment_id": 99521130, "body": "Try something like <code>Tbl.Select</code>  <code>Selection.Collapse Direction:=wdCollapseEnd</code> :  <code>Selection.Range.Text = &quot;Some text&quot;</code>"}, {"owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "edited": false, "score": 0, "creation_date": 1559755112, "post_id": 56452739, "comment_id": 99521936, "body": "Yeah big ups, I was missing the selection.collapse"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 2, "last_activity_date": 1559720354, "last_edit_date": 1559720354, "creation_date": 1559692955, "answer_id": 56452739, "question_id": 56452132, "link": "https://stackoverflow.com/questions/56452132/correct-way-to-insert-caption-with-photo-into-table-cell/56452739#56452739", "title": "Correct way to insert caption with photo into table cell?", "body": "<p>One example to achieve it (tested)</p>\n\n<pre><code>Sub test()\nDim Tbl As Table\nSet Tbl = ActiveDocument.Tables(1)\nTbl.Cell(2, 2).Range.InlineShapes.AddPicture \"C:\\users\\user\\desktop\\Flower1.jpg\"\nTbl.Cell(2, 2).Range.InlineShapes(1).Select\nSelection.InsertCaption Label:=\"Figure\", Title:=\" : Caption Flower 1\", Position:=wdCaptionPositionBelow\nEnd Sub\n</code></pre>\n\n<p>Edit: For iterating through table cells may try something like</p>\n\n<pre><code>Sub test()\nDim Tbl As Table, Cel As Cell, FnameArr As Variant, TitleArr As Variant\nDim Path As String, PicNo As Integer, Rw As Integer, Cl As Integer\nPath = \"C:\\users\\user\\desktop\\\"\n\n'array length should cover all the cells in the table\n'Use file name of your choice, only two file name used for test\nFnameArr = Array(\"Flower1.jpg\", \"Flower2.jpg\", \"Flower1.jpg\", \"Flower2.jpg\", \"Flower1.jpg\", \"Flower2.jpg\")\nTitleArr = Array(\"Caption R1C1\", \"Caption R1C2\", \"Caption R1C3\", \"Caption R2C1\", \"Caption R2C2\", \"Caption R2C3\")\n\nSet Tbl = ActiveDocument.Tables(1)\nPicNo = 0\n\n    For Rw = 1 To Tbl.Rows.Count\n    For Cl = 1 To Tbl.Rows(Rw).Cells.Count\n        If PicNo &lt;= UBound(TitleArr) Then\n        Tbl.Cell(Rw, Cl).Range.InlineShapes.AddPicture Path &amp; FnameArr(PicNo)\n        Tbl.Cell(Rw, Cl).Range.InlineShapes(1).Select\n        Selection.InsertCaption Label:=\"Figure\", Title:=\": \" &amp; TitleArr(PicNo), Position:=wdCaptionPositionBelow\n        Else\n        Tbl.Cell(Rw, Cl).Range.Text = \"No file name Provided\"\"\"\n        End If\n    PicNo = PicNo + 1\n    Next Cl\n    Next Rw\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/A1yH6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A1yH6.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 11314231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4cfd9fd5db6c57d08196373f10f34b1?s=128&d=identicon&r=PG&f=1", "display_name": "tmand6", "link": "https://stackoverflow.com/users/11314231/tmand6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "closed_date": 1559707302, "accepted_answer_id": 56452739, "answer_count": 1, "score": 0, "last_activity_date": 1559736343, "creation_date": 1559687449, "last_edit_date": 1559736343, "question_id": 56452132, "link": "https://stackoverflow.com/questions/56452132/correct-way-to-insert-caption-with-photo-into-table-cell", "closed_reason": "Needs details or clarity", "title": "Correct way to insert caption with photo into table cell?", "body": "<p>I created a table with VBA, a 3x2 table, got images to insert in each cell, but I cannot use cell.range.insertcaption .. to insert a caption. Not sure why that is. Is there a correct solution to this?</p>\n\n<p>Trying to insert pictures from a folder into a table cell made through VBA, and adding captions iterating though an array. </p>\n"}, {"tags": ["excel", "vba", "countif"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 7, "creation_date": 1559682376, "post_id": 56451333, "comment_id": 99496036, "body": "<code>WorksheetFunction.CountIf(WorkSheets(&quot;Sheet1&quot;).Cells,&quot;toad&quot;)</code> will count all the <code>toad</code>s in the whole worksheet on <code>Sheet1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "is_accepted": true, "score": 0, "last_activity_date": 1559718360, "last_edit_date": 1559718360, "creation_date": 1559687963, "answer_id": 56452206, "question_id": 56451333, "link": "https://stackoverflow.com/questions/56451333/global-countif-on-a-worksheet/56452206#56452206", "title": "Global COUNTIF on a worksheet", "body": "<p><em>I posted Scott Craner's answer which does the job !</em></p>\n\n<pre><code> WorksheetFunction.CountIf(WorkSheets(\"Sheet1\").Cells,\"toad\")  \n</code></pre>\n\n<p>will count the number of cells with <code>toad</code> in the whole worksheet on Sheet1</p>\n"}], "owner": {"reputation": 176, "user_id": 7790684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VUy0GkIrRI/AAAAAAAAAAI/AAAAAAAAAMg/o32NDkuuG60/photo.jpg?sz=128", "display_name": "Foxhunt", "link": "https://stackoverflow.com/users/7790684/foxhunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56452206, "answer_count": 1, "score": 0, "last_activity_date": 1559718360, "creation_date": 1559682165, "question_id": 56451333, "link": "https://stackoverflow.com/questions/56451333/global-countif-on-a-worksheet", "title": "Global COUNTIF on a worksheet", "body": "<p>I would like to <strong>count every occurrence</strong> of a string in an <strong>entire worksheet</strong>. </p>\n\n<p>I know that this function permit to count, but on a specific range:</p>\n\n<pre><code>WorksheetFunction.CountIf(myrange,myword)\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1559681863, "post_id": 56451222, "comment_id": 99495835, "body": "You can try something like <code>PivotFields(wsRawData.Cells(1, &quot;R&quot;).Value)</code> (assuming headers are on Row1 of your data sheet <code>wsRawData</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1559735477, "creation_date": 1559735477, "answer_id": 56459947, "question_id": 56451222, "link": "https://stackoverflow.com/questions/56451222/referencing-a-dynamic-pivot-field-using-pivotfields/56459947#56459947", "title": "Referencing a dynamic pivot field using .pivotfields", "body": "<p>You can reference every PivotField either by its Name or by its index, independent of its usage in the pivottable.</p>\n\n<p>Example:<br>\nIf your pivottable's source data begins in column \"A\", then <code>PivotFields(18)</code> refers to column \"R\".</p>\n\n<hr>\n\n<p><code>PivotFields(18).SourceName</code> (or .Name, .Value, .Caption) corresponds to the heading text of its sourcedata column.</p>\n\n<hr>\n\n<p>By this you can check, if a PivotField is used in your pivottable:</p>\n\n<pre><code>If .PivotFields(18).Orientation &lt;&gt; xlHidden Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11600949, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157050521180664/picture?type=large", "display_name": "Matt Hyland", "link": "https://stackoverflow.com/users/11600949/matt-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559735477, "creation_date": 1559681685, "last_edit_date": 1559720036, "question_id": 56451222, "link": "https://stackoverflow.com/questions/56451222/referencing-a-dynamic-pivot-field-using-pivotfields", "title": "Referencing a dynamic pivot field using .pivotfields", "body": "<p>I built a macro that I run monthly to generate a pivot table. When using .pivotfields(\"May-2019 Sales\") is there anyway I can reference a specific column instead of \"May\"? Like .pivotfields(\"R:R\") for example? </p>\n\n<p>I will always be interested in adding the last 4 columns (they are the current month) of the raw data, any other way around this is also appreciated!</p>\n\n<pre><code>  With myPivotTable\n\n     With .PivotFields(\"May-2019 Sales\")\n       .Orientation = xlRowField\n       .Position = 1 \n     End with\n\n  End with\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "eof"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1559682286, "post_id": 56451221, "comment_id": 99496003, "body": "How is your date stored? If is in date time, and has a time value... it won&#39;t be equal. Try <code>&gt;=</code>, i.e.:  <code>...&quot;and date_pres &gt;= &quot; &amp; &quot;#&quot; &amp; currentday &amp; &quot;#&quot;....</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1559683323, "post_id": 56451221, "comment_id": 99496305, "body": "Use a <code>Command</code> with an actual <code>Date</code> parameter instead of concatenating the value into the query. That way you don&#39;t have to deal with the utter minefield that is working with dates represented as strings."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 1, "creation_date": 1559686656, "post_id": 56451221, "comment_id": 99497238, "body": "Did you try removing the date and leave just badge_ID? that should return records, if that doesn&#39;t work, it&#39;s not the date. You can also try <code>CDate(Format(Date, &quot;m&#47;d&#47;yyyy&quot;))</code> which is one of the most accepted date formats in databases. The format you are using is also accepted but I doesn&#39;t hurt to try another. Try <code>extrct = &quot;SELECT * FROM [Table1] WHERE [badge_ID] = &quot; &amp; Me.BadgeInput &amp; &quot; AND [date_pres] = #&quot; &amp; CDate(Format(Date, &quot;m&#47;d&#47;yyyy&quot;)) &amp; &quot;#&quot;</code>"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1559687423, "post_id": 56451221, "comment_id": 99497407, "body": "Make sure the SQL you produce works in Access as a query. If you can get it working in Access, getting it to work in Excel will be a snap."}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559714336, "post_id": 56451221, "comment_id": 99502218, "body": "Sorry for the late reply, I am in europe so the time difference is on! My Date in Access is stored as Date/Time type and has date value in it. I tried removing the date and just leave the Badge_ID and then I got something, that&#39;s how I know that my date condition is wrong somewhere. I have tried the suggestions that you proposed (Cdate, date(),...) but still nothing in my recordset. @MathieuGuindon, can you be more specific on your solution?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559715321, "post_id": 56451221, "comment_id": 99502490, "body": "Just add after <code>extrct = ...</code> a line with following code <code>Debug.Print extrct</code> and study results in Immediate pane (Ctrl+G), try this SQL text in query designer"}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559719153, "post_id": 56451221, "comment_id": 99503828, "body": "I have just debugged the sql and used the same sql in Access and there was no output. So what I did is build a query in Access that was giving a result and paste the query in my vba code. Here is the query <code>extrct = &quot;select * from Table1 where (((Badge_ID)=&quot; &amp; Me.BadgeInput &amp; &quot;) AND ((date_prest)=#&quot; &amp; currentday &amp; &quot;#));&quot;</code>. This is still giving no result in my recordset. I&#39;m quite lost here!"}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559720371, "post_id": 56451221, "comment_id": 99504283, "body": "I have just noticed when debugging that no matter what <code>Badge_ID</code> I insert without specifying the date, the vba is always outputing the first row of the table. How is this possible? Looks like the filtering isn&#39;t working as expected. Here is the debug that I have used <code>For i = 0 To rs3.Fields.Count - 1 Debug.Print rs3(i).Name &amp; vbTab; Next i &#39;Debug.Print rs3(rs3.Fields.Count - 1)  Do While Not rs3.EOF  For i = 0 To rs3.Fields.Count - 1     Debug.Print rs(i) &amp; vbTab;  Next i  Debug.Print rs3(rs3.Fields.Count - 1)  rs3.MoveNext Loop</code>"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559719294, "post_id": 56455612, "comment_id": 99503877, "body": "I have tried changing to this format as well, but still no result in my recordset. This how I defined my variable <code>currentday = CDate(Format(Date, &quot;yyyy\\&#47;mm\\&#47;dd&quot;)</code>. I don&#39;t understand how I am able to get result when the query is run on Access but nothing when it is run in vba :s"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559722649, "post_id": 56455612, "comment_id": 99505267, "body": "No, that won&#39;t work - and actually doesn&#39;t make sense, if you think about it. Use my code line <i>as is</i>. Or use my alternative. See edited answer, please."}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559728390, "post_id": 56455612, "comment_id": 99508099, "body": "Thanks Gustav for your reply. I tried the edited version of your code but still didn&#39;t work. After debugging, I don&#39;t think the problem lies with the date. In my Access table, I have 11 rows of data. I have run the query without the date condition and changed the value of <code>BadgeInpu</code> with 4 existing ones. No matter the value of <code>BadgeInput</code>, the recordset always returns the first row of the table. So my guess is the problem lies here, rather than in the date condition. Would you happen to know what is going on here? I have put the debugging code in the comment above. Thanks"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559728715, "post_id": 56455612, "comment_id": 99508241, "body": "The only thing I can think of is, if the stored dates could have a time part. If so, round this off. See edited answer, please."}, {"owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "edited": false, "score": 0, "creation_date": 1559731527, "post_id": 56455612, "comment_id": 99509474, "body": "It worked with your third code... amazing! Thanks a lot for your help, very much appreciated :)"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1559728659, "last_edit_date": 1559728659, "creation_date": 1559718119, "answer_id": 56455612, "question_id": 56451221, "link": "https://stackoverflow.com/questions/56451221/recordset-in-excel-vba-returns-nothing-while-data-is-present-in-access-db/56455612#56455612", "title": "Recordset in excel vba returns nothing while data is present in Access DB", "body": "<p>As you live in Europe, it is mandatory to use a correct format for date value expressions:</p>\n\n<pre><code>currentday = Format(Date, \"yyyy\\/mm\\/dd\")\n</code></pre>\n\n<p>If you this is not just an example, and you will always use today's date, simply use:</p>\n\n<pre><code>extrct = \"select * from Table1 where badge_ID = \" &amp; Me.BadgeInput &amp; \" and date_pres = Date()\"\n</code></pre>\n\n<p>If you have stored a time component:</p>\n\n<pre><code>extrct = \"select * from Table1 where badge_ID = \" &amp; Me.BadgeInput &amp; \" and Fix(date_pres) = Date()\"\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 11558376, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082017408563647/picture?type=large", "display_name": "Bruno Bukavu Thai", "link": "https://stackoverflow.com/users/11558376/bruno-bukavu-thai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 56455612, "answer_count": 1, "score": 0, "last_activity_date": 1594716157, "creation_date": 1559681684, "last_edit_date": 1594716157, "question_id": 56451221, "link": "https://stackoverflow.com/questions/56451221/recordset-in-excel-vba-returns-nothing-while-data-is-present-in-access-db", "title": "Recordset in excel vba returns nothing while data is present in Access DB", "body": "<p>I am running my VBA code in excel that connects and extract a recordset from Access. I have a query that makes the selection based on date and an ID. I know the record is present in the table but it seems like when I add my date condition, the recordset is coming out empty.</p>\n\n<p>I have browsed through this website and every suggestion that I have seen, I have tried but still my recordset comes out empty</p>\n\n<p>Here is the code that I am using:</p>\n\n<pre><code>'Here is the query\n\ncurrentday = Format(Date, \"dd-mm-yyyy\")\nextrct = \"select * from Table1 where badge_ID=\" &amp; Me.BadgeInput &amp; \" \" &amp; \"and date_pres=\" &amp; \"#\" &amp; currentday &amp; \"#\"\nconn.Open (strconn)\n\nrs3.Open extrct, conn, adOpenKeyset, adLockOptimistic, adCmdText\n\n'This is where I check for any value is the recordset\nIf rs3.EOF And rs3.BOF Then -- This is coming out as True (no record)\nGoTo 1\nElse\nGoTo 2\nEnd If\n</code></pre>\n\n<p>I think the date condition has something wrong going on but I can't figure out what considering that I have tried everything I know</p>\n\n<p>Thanks in advance for your help</p>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559682816, "post_id": 56451036, "comment_id": 99496172, "body": "any reason you can&#39;t have <code>UserForm2.Show</code> <i>after</i> &quot;some code&quot; runs? Does <code>UserForm2</code> have to be modal or it can be shown modeless?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559683055, "post_id": 56451036, "comment_id": 99496238, "body": "also: <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">this article</a> explains the traps you&#39;re about to stick your foot into."}, {"owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559719420, "post_id": 56451036, "comment_id": 99503930, "body": "Sorry- I meant without WITHOUT unloading Userform2"}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1559681669, "creation_date": 1559681669, "answer_id": 56451218, "question_id": 56451036, "link": "https://stackoverflow.com/questions/56451036/is-it-possible-to-display-a-userform-and-executes-a-code-bellow-the-show-method/56451218#56451218", "title": "Is it possible to display a userform and executes a code bellow the .show method?", "body": "<p>Assuming you mean without unloading <code>Userform2</code>...</p>\n\n<p><code>Userform1</code> will wait for <code>Userform2</code> to finish...  however you can do something like this:</p>\n\n<p><strong>Userform1:</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n UserForm2.Show\n\nEnd Sub\n\nSub uf1msgbox()\n\n X = 1\n MsgBox X\n\nEnd Sub\n</code></pre>\n\n<p><strong>Userform2:</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n    UserForm1.uf1msgbox\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1559683568, "creation_date": 1559683568, "answer_id": 56451557, "question_id": 56451036, "link": "https://stackoverflow.com/questions/56451036/is-it-possible-to-display-a-userform-and-executes-a-code-bellow-the-show-method/56451557#56451557", "title": "Is it possible to display a userform and executes a code bellow the .show method?", "body": "<p>Not sure that's what you want, but this would do what you describe:</p>\n\n<pre><code>UserForm2.Show vbModeless\n</code></pre>\n\n<p>Note that <code>UserForm2</code> isn't modal anymore, which means the user can click outside the form, and even end up hiding it behind <code>UserForm1</code>.</p>\n\n<p>Modal forms return execution to the caller when they're hidden/closed or destroyed, modeless forms return execution to the caller immediately (<code>Initialize</code> and <code>Activate</code> handlers will run first though).</p>\n"}], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559683568, "creation_date": 1559680743, "question_id": 56451036, "link": "https://stackoverflow.com/questions/56451036/is-it-possible-to-display-a-userform-and-executes-a-code-bellow-the-show-method", "title": "Is it possible to display a userform and executes a code bellow the .show method?", "body": "<p>I want to display Userform2 from Userform1 then <strong>continue</strong> executing some code in Userform1 <strong>WITHOUT</strong> unloading Userform1 </p>\n\n<pre><code>Private Sub CommandButton1_Click()    \n UserForm2.Show\n x = 1\n MsgBox x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "transpose"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559680059, "post_id": 56450894, "comment_id": 99495070, "body": "You haven&#39;t specified the worksheet that your <code>Range</code>s are on. Implicitly they are on the <code>ActiveSheet</code>. Is that what you want?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559680614, "post_id": 56450894, "comment_id": 99495303, "body": "You need to change your Range to be <code>Range(&quot;U150:X150&quot;)</code> or else you need to setup a UNION. Also, don&#39;t <code>pastevalues</code>."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559680948, "post_id": 56450894, "comment_id": 99495447, "body": "You also have an <code>Integer</code> that should be a <code>DOUBLE</code> if it can be a decimal."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1559729728, "post_id": 56451024, "comment_id": 99508699, "body": "Even though the original wasn&#39;t, some indentation would be a nice touch."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1559706903, "last_edit_date": 1559706903, "creation_date": 1559680691, "answer_id": 56451024, "question_id": 56450894, "link": "https://stackoverflow.com/questions/56450894/trying-to-transpose-in-an-if-then-statement/56451024#56451024", "title": "Trying to transpose in an if then statement", "body": "<p>Upon further review, I was incorrect about the syntax range being defined incorrectly. I've never seen using <code>Range(\"U150\",\"X150\")</code> but it appears to be the same result as <code>Range(\"U150:X150\")</code>. You get an uptick for this discovery!</p>\n\n<p>Soo... the only thing wrong that I can see with your code that your <code>if-statement</code> is returning <code>False</code> because you have <code>B1</code> defined as an <code>Integer</code> and your if statement is checking for being <strong>equal to</strong> a decimal <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/integer-data-type\" rel=\"nofollow noreferrer\">which it will never be</a>. If you redefine <code>B1</code> as <code>Double</code>, I think your code will work as shown below. I ran this slightly modified code of yours successfully.</p>\n\n<p>Also, avoid using <code>Integer</code> in general. Just use <code>Long</code>. See <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/51689021#51689021\">post here</a> on some discoveries from the SO community. The memory savings isn't worth it.</p>\n\n<pre><code>Private Sub Data100_Modified()\n\n Dim b1 As Double, sourceRange As Range, targetRange As Range\n\nWith ActiveSheet\n\nb1 = .Range(\"V8\").Value\n\n\nIf b1 = 0.015625 Then\nSet sourceRange = .Range(\"A1\",\"A3\")\nSet targetRange = .Range(\"B2\",\"d2\")\n\nsourceRange.Copy\ntargetRange.PasteSpecial Paste:=xlPasteValues, Transpose:=True\n\nEnd If\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11601068, "user_type": "registered", "profile_image": "https://graph.facebook.com/2321858531204961/picture?type=large", "display_name": "Andrew Pettit", "link": "https://stackoverflow.com/users/11601068/andrew-pettit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56451024, "answer_count": 1, "score": 2, "last_activity_date": 1559706903, "creation_date": 1559679969, "last_edit_date": 1559688331, "question_id": 56450894, "link": "https://stackoverflow.com/questions/56450894/trying-to-transpose-in-an-if-then-statement", "title": "Trying to transpose in an if then statement", "body": "<p>Large project, need help with a sub that is called out in another sub</p>\n\n<p>This isnt outputting anything and the sub that calls it is working but not this part</p>\n\n<pre><code>`Private Sub Data100()\n\n Dim b1 As Integer\n Dim sourceRange As Range\n Dim targetRange As Range\n b1 = Range(\"V8\").Value\n\nIf b1 = 0.015625 Then\nSet sourceRange = Range(\"U150\", \"X150\")\nSet targetRange = Range(\"U201\", \"U204\")\nsourceRange.Copy\ntargetRange.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, \nSkipBlanks:=False, Transpose:=True\nEnd If\n\nEnd Sub`\n</code></pre>\n\n<p>no error message, just wont output anything. Would like to copy U150-X150 and output in column U201-U204</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1559680104, "post_id": 56450784, "comment_id": 99495089, "body": "Your code works fine for me in Excel 2010 and 2013. It might be useful to know what version of Excel you are using."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1559684626, "post_id": 56450784, "comment_id": 99496680, "body": "works fine in 2016 as well, are you sure the header is blank. Did you check the custom header interface and ensure there are no &amp;F"}, {"owner": {"reputation": 33, "user_id": 5925521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yr0YJ.png?s=128&g=1", "display_name": "xyquadrat", "link": "https://stackoverflow.com/users/5925521/xyquadrat"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1559731307, "post_id": 56450784, "comment_id": 99509375, "body": "@cybernetic.nomad I use Excel 2013. I tried this again with a new file &amp; blank header, but the issue persists and the header GUI also shows &quot;&amp;[Datei]&quot; (german for &quot;&amp;[File]&quot;) instead of &quot;&amp;[Seiten]&quot; (&quot;&amp;[Pages]&quot;). Could this be a locale problem? I also looked through all settings that seemed related, but haven&#39;t found anything that looks off."}, {"owner": {"reputation": 2175, "user_id": 1923017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8762b42da0a3deb0410c8f3e042f13ce?s=128&d=identicon&r=PG", "display_name": "The Conspiracy", "link": "https://stackoverflow.com/users/1923017/the-conspiracy"}, "edited": false, "score": 0, "creation_date": 1586947089, "post_id": 56450784, "comment_id": 108314000, "body": "I can confirm this bug for Excel 2019. I&#39;m on the German locale, too."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 5925521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yr0YJ.png?s=128&g=1", "display_name": "xyquadrat", "link": "https://stackoverflow.com/users/5925521/xyquadrat"}, "is_accepted": false, "score": 1, "last_activity_date": 1559732572, "creation_date": 1559732572, "answer_id": 56459204, "question_id": 56450784, "link": "https://stackoverflow.com/questions/56450784/format-codes-for-first-page-header-footer-are-different/56459204#56459204", "title": "Format codes for first page header/footer are different", "body": "<p>I have now managed to work around this problem. Instead of relying on the Microsoft documentation, enter the header/footer manually in the GUI and then use the Immediate Window (Crtl+G) for debugging and query the contents of the relevant header (e.g. <code>? ActiveSheet.PageSetup.FirstPage.RightHeader.Text</code>). This will then give you the correct format codes.</p>\n\n<p>If anybody else has an idea why this happens (and why others cannot reproduce it), I'll gladly accept this as an answer.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5912336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J1O67.jpg?s=128&g=1", "display_name": "Jan-Hendrik", "link": "https://stackoverflow.com/users/5912336/jan-hendrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1595415582, "creation_date": 1595415582, "answer_id": 63032651, "question_id": 56450784, "link": "https://stackoverflow.com/questions/56450784/format-codes-for-first-page-header-footer-are-different/63032651#63032651", "title": "Format codes for first page header/footer are different", "body": "<p>I have the same problem in Excel 2019: I wanted to show &quot;Page 1 of 5&quot; in the right footer.\nAs it concerns only the special settings for the first page, I solved it this way:</p>\n<pre><code>ActiveSheet.PageSetup.FirstPage.RightFooter.Text = &quot;Page 1 of &quot; + Trim(Str(ActiveSheet.PageSetup.Pages.Count))\n</code></pre>\n<p>Notice that this only works if filling cells, changing page layout, adding manual page breaks done by your VBA code is completed because before Excel can't now the correct amount of pages.</p>\n"}], "owner": {"reputation": 33, "user_id": 5925521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yr0YJ.png?s=128&g=1", "display_name": "xyquadrat", "link": "https://stackoverflow.com/users/5925521/xyquadrat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1595415582, "creation_date": 1559679457, "last_edit_date": 1559731172, "question_id": 56450784, "link": "https://stackoverflow.com/questions/56450784/format-codes-for-first-page-header-footer-are-different", "title": "Format codes for first page header/footer are different", "body": "<p>I want to set a different header and footer with VBA for the first page of an Excel 2013 sheet that should be printed. The header and footer should contain information such as the page number, the name of the active sheet and the file name. The official Microsoft documentation about format codes (<a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/workbooks-and-worksheets/formatting-and-vba-codes-for-headers-and-footers\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/excel/concepts/workbooks-and-worksheets/formatting-and-vba-codes-for-headers-and-footers</a>) provides various options for this, and all of those format codes work correctly on every page except for the first one - they appear to be assigned differently (e.g. \"&amp;N\" should display the number of pages, but displays the file name instead) . How can I use the correct format codes for the first page header/footer?</p>\n\n<p>I tried to assign those format codes to constants, but that doesn't work because the codes are only parsed when they are included in a header or footer string. I also recorded a macro while changing the headers manually (which works correctly), but that macro doesn't produce the correct output either.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub formatCodesTest()\n    With ActiveSheet.PageSetup\n        .DifferentFirstPageHeaderFooter = True\n        .FirstPage.LeftHeader.Text = \"&amp;N\"\n    End With\n    ActiveSheet.PrintPreview\nEnd Sub\n</code></pre>\n\n<p>I expected the output to be the number of pages (as it is described in the Microsoft docs), but the actual output is the file name.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1559680876, "post_id": 56450752, "comment_id": 99495413, "body": "A picture is a separate object.  Move the hyperlink that object."}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1559683494, "creation_date": 1559683494, "answer_id": 56451544, "question_id": 56450752, "link": "https://stackoverflow.com/questions/56450752/how-can-i-keep-a-cells-hyperlink-after-replacing-its-text-with-a-picture/56451544#56451544", "title": "How can I keep a cell&#39;s hyperlink after replacing its text with a picture?", "body": "<p>A Picture is a seperate object from the Cell.  Your code is placing the picture over a cell, it's not actually \"In\" the cell.</p>\n\n<p>You could move the hyperlink from the cell, to the Picture, like this</p>\n\n<pre><code>Sub test()\n    Dim MyPath As String\n    Dim Cell As Range\n    Dim shp As ShapeRange\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim ext As String\n    Dim HyperLinkAddr As String\n\n    Application.ScreenUpdating = False\n\n    Set ws = ActiveSheet\n\n    MyPath = \"C:\\Users\\\" &amp; Environ$(\"UserName\") &amp; \"\\Pictures\"\n    ext = \".png\"\n\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\n    With ws\n        Set rng = .Range(.Cells(1, 2), .Cells(.Rows.Count, \"B\").End(xlUp))\n    End With\n\n    For Each Cell In rng\n        If Cell.Value &lt;&gt; vbNullString Then\n            If Dir(MyPath &amp; Cell.Value2 &amp; ext) &lt;&gt; \"\" Then\n                ' Get a reference to the inserted shape, rather than relying on Selection\n                Set shp = ws.Pictures.Insert(MyPath &amp; Cell.Value2 &amp; ext).ShapeRange\n                With shp\n                    .LockAspectRatio = msoFalse\n                    .Left = Cell.Left\n                    .Top = Cell.Top\n                    .Width = Cell.Width\n                    .Height = Cell.Height\n\n                    If Cell.Hyperlinks.Count &gt; 0 Then\n                        HyperLinkAddr = Cell.Hyperlinks(1).Address\n                        Cell.Hyperlinks.Delete\n                        ws.Hyperlinks.Add _\n                          Anchor:=.Item(1), _\n                          Address:=HyperLinkAddr\n                    End If\n                End With\n            Else\n                Cell.Value = \"N/A\"\n            End If\n        End If\n    Next\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11601050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf75f6e3926d571b4d4ea91cef736b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/11601050/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559683494, "creation_date": 1559679315, "last_edit_date": 1559679337, "question_id": 56450752, "link": "https://stackoverflow.com/questions/56450752/how-can-i-keep-a-cells-hyperlink-after-replacing-its-text-with-a-picture", "title": "How can I keep a cell&#39;s hyperlink after replacing its text with a picture?", "body": "<p>I am trying to replace some hyperlinked text in cells but keep the hyperlink there. In other words, instead of clicking the text to take you to the website that the hyperlink leads to, you would click the picture to go to that website.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim MyPath As String\n    Dim CurrCell As Range\n    Dim Cell As Range\n    Dim LastRow As Long\n    Dim i As Long\n\n    Application.ScreenUpdating = False\n\n    MyPath = \"C:\\Users\\xxx\\Pictures\"\n\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\n    Set CurrCell = ActiveCell\n\n    LastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    For i = 1 To LastRow\n        Set Cell = Cells(i, \"B\")\n        If Cell.Value &lt;&gt; \"\" Then\n            If Dir(MyPath &amp; Cell.Value &amp; \".png\") &lt;&gt; \"\" Then\n                ActiveSheet.Pictures.Insert(MyPath &amp; Cell.Value &amp; \".png\").Select\n                With Selection.ShapeRange\n                    .LockAspectRatio = msoFalse\n                    .Left = Cell.Left\n                    .Top = Cell.Top\n                    .Width = Cell.Width\n                    .Height = Cell.Height\n                End With\n            Else\n                Cell.Value = \"N/A\"\n            End If\n        End If\n    Next i\n\n    CurrCell.Select\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "save-as"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1559677573, "post_id": 56450307, "comment_id": 99494029, "body": "You can&#39;t have a forward slash in the filename - <code>sSaveFileName = Format(Now(), &quot;MM&#47;DD&#47;YYYY&quot;</code> won&#39;t work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1559678242, "post_id": 56450307, "comment_id": 99494314, "body": "Consider using <code>Format(Now, &quot;yyyy-MM-dd&quot;)</code> instead, first because it&#39;s using characters legal in a filename, but also because it makes the file names sortable, <i>and</i> non-ambiguous to rest-of-the-world people that might come across the file. Also, &quot;yyyy-MM-dd&quot; is ISO standard and internationally understood, whereas &quot;MM/DD/YYYY&quot; only makes sense in the US (if at all)."}, {"owner": {"reputation": 67, "user_id": 11524867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f582c633b580372197b17058b97a1?s=128&d=identicon&r=PG&f=1", "display_name": "Nader", "link": "https://stackoverflow.com/users/11524867/nader"}, "edited": false, "score": 0, "creation_date": 1559698503, "post_id": 56450307, "comment_id": 99499343, "body": "Thank you! It works now, using legal characters"}], "owner": {"reputation": 67, "user_id": 11524867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b7f582c633b580372197b17058b97a1?s=128&d=identicon&r=PG&f=1", "display_name": "Nader", "link": "https://stackoverflow.com/users/11524867/nader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559677367, "creation_date": 1559677246, "last_edit_date": 1559677367, "question_id": 56450307, "link": "https://stackoverflow.com/questions/56450307/why-does-vba-give-an-object-error-when-i-paste-into-another-workbook-and-saveas", "title": "Why does VBA give an Object Error when I paste into another workbook and SaveAs", "body": "<p>For some ungodly reason, when I want to SaveAs I get a \"Method 'SaveAs' of obejct' _Workbook\". I know this has been approached from multiple angles on stack overflow, but I just couldn't understand.</p>\n\n<p>My code is very simple. Just copy the (manually) selected code on the macro workbook and open a data-less template from my drive. Then I paste into Range \"A2\". I would like to save as , but under a different name, one with today's date.</p>\n\n<p>Please kindly advise, I've lost nearly all hope.</p>\n\n<p>The error stems from the saveas method.</p>\n\n<pre><code>Sub AutoEmail()\n\n    Call trimFunction\n\n    Dim sSaveFileName As String\n    sSaveFileName = Format(Now(), \"MM/DD/YYYY\")\n\n    Selection.Copy\n\n    With Selection.Interior\n             .Pattern = xlSolid\n             .PatternColorIndex = xlAutomatic\n             .Color = 10092543\n             .TintAndShade = 0\n             .PatternTintAndShade = 0\n    End With\n\n    Workbooks.Open Filename:=\"U:\\FuturesClearing\\Wires\\Futures Wires Email _ \n        Templates\\Brokerage to Futures TDA.xlsx\"\n\n    Worksheets(\"Sheet1\").Range(\"A2\").PasteSpecial Paste:=xlPasteValues\n\n    ActiveWorkbook.SaveAs Filename:=\"U:\\FuturesClearing\\Wires\\Futures Wires _ \n    Email Templates\\Brokerage to Futures TDA \" &amp; sSaveFileName &amp; \".xlsx\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1559676825, "post_id": 56450210, "comment_id": 99493735, "body": "Use a <code>Workbook</code> variable: <code>Dim wb as Workbook</code>, then <code>Set wb = Workbooks.Open(Filename:=...)</code>. The original workbook is <code>ThisWorkbook</code>."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "edited": false, "score": 0, "creation_date": 1559679394, "post_id": 56450407, "comment_id": 99494780, "body": "I&#39;m trying to copy a range of values from the &#39;opened&#39; workbook and paste them onto my original workbook - I think this does the opposite?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "edited": false, "score": 0, "creation_date": 1559679519, "post_id": 56450407, "comment_id": 99494837, "body": "You are correct, but that was for testing purposes only... if you want to copy, the easiest way is to use the example above, just reverse the workbooks, i.e. instead of <code>workbook_A.Range.Value = workbook_B.Range.Value</code>, do <code>workbook_B.Range.Value = workbook_A.Range.Value</code>. It is as simple as that :)"}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 0, "last_activity_date": 1559677692, "creation_date": 1559677692, "answer_id": 56450407, "question_id": 56450210, "link": "https://stackoverflow.com/questions/56450210/how-to-quickly-switch-what-worksheet-workbook-is-being-edited-in-vba/56450407#56450407", "title": "How to quickly switch what worksheet/workbook is being edited in VBA", "body": "<p>See if this helps, I've edited your code, and by comparing I hope you get in the right direction... see comments in code for more details:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub findColumns_button_Click()  'userform code\n    Dim index As Integer, hyperlink_A As Variant, Wb As Worksheet, mainWorkbook As Workbook\n    Dim wbSrc As Workbook\n\n    Set mainWorkbook = ActiveWorkbook\n    With mainWorkbook.Worksheets(\"Data\")\n        .Cells(2, 2) = ResultA_Combo.Value\n        index = findIndex(.Value)\n        hyperlink_A = findHyperlink(index)\n        .Cells(3, 2) = hyperlink_A\n    End With\n\n    Set wbSrc = Workbooks.Open(Filename:=hyperlink_A)  'Allocate to variable and open at the same time\n\n    Dim test As Double\n    test = mainWorkbook.Worksheets(\"Data\").Range(\"S23\")\n    MsgBox test 'displays correct value from first workbook\n\n    mainWorkbook.Activate 'as long you fully qualify the ranges, you don't need and should avoid as much as possible to use .Activate &amp; .Select\n\n    Dim test2 As Double\n    wbSrc.Worksheets(1).Range(\"A1\") = mainWorkbook.Worksheets(\"Data\").Range(\"S23\") * 2\n    test2 = wbSrc.Worksheets(1).Range(\"A1\")\n\n    MsgBox test2 'displays correct value from second workbook\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56450407, "answer_count": 1, "score": 1, "last_activity_date": 1559677692, "creation_date": 1559676751, "question_id": 56450210, "link": "https://stackoverflow.com/questions/56450210/how-to-quickly-switch-what-worksheet-workbook-is-being-edited-in-vba", "title": "How to quickly switch what worksheet/workbook is being edited in VBA", "body": "<p>Basically, I want my program to open a hyperlink to another workbook and copy a range of values onto my original workbook. The problem is, I don't know how to properly reference the workbook to \"paste\" onto</p>\n\n<p>I've tried to replicate a lot of different internet examples. I've tried using \"Set\" and \"With\" to switch between them and I've tried to make the original workbook the active workbook before pasting and nothing has been working. </p>\n\n<pre><code>Private Sub findColumns_button_Click()  'userform code\n    Dim index As Integer, hyperlink_A As Variant, Wb As Worksheet, mainWorkbook As Variant\n    mainWorkbook = ActiveWorkbook.FullName\n    Worksheets(\"Data\").Cells(2, 2) = ResultA_Combo.Value\n    index = findIndex(Cells(2, 2).Value)\n    hyperlink_A = findHyperlink(index)\n    Worksheets(\"Data\").Cells(3, 2) = hyperlink_A\n    Workbooks.Open Filename:=hyperlink_A    'opens correctly\n    Dim test As Double\n    test = Worksheets(\"Data\").Range(\"S23\")\n    MsgBox test 'displays correct value from desired workbook\n    Workbooks.Activate Filename:=mainWorkbook   'not sure what to do here\n\n\nEnd Sub\n</code></pre>\n\n<p><code>MsgBox test</code> returns the desired value but I can't find a way to set a cell value in the original workbook equal to <code>test</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559677080, "post_id": 56450181, "comment_id": 99493831, "body": "Which part of this is giving you problems?  What did you try and what happened when you tried it?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1559679352, "post_id": 56450181, "comment_id": 99494770, "body": "&quot;Running this i get an error at the first square bracket in my portion of code.&quot; What is the error? What is that part of the code supposed to do? Why have you used square brackets? Why did we have to search for square brackets in the lengthy code? I suspect that if you can answer those questions, you will find your own answer."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1559679429, "post_id": 56450181, "comment_id": 99494795, "body": "<code>For Each ws In ThisWorkbook.Worksheets</code>, <code>If ws.Name &lt;&gt; &quot;RUNREADY&quot; Then</code>... you list rr = 0 in the false... if the last worksheet in the workbook is not &quot;RunReady&quot; then you will return 0.  Fix the logic for that section.  Inside of the loop, add to <code>rr</code>, outside of the loop use <code>rr</code> then set it to <code>0</code>."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1559679585, "post_id": 56450181, "comment_id": 99494867, "body": "also, <code>[RUNREADY.xlsm] Sheet1!cel.Value = ActiveWorkbook.FullName</code> is not correct syntax... something like <code>Workbook(&quot;RUNREADY.XLSM&quot;).Sheets(&quot;Sheet1&quot;).cel.value</code> would be more appropriate"}], "owner": {"reputation": 15, "user_id": 10535212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a64a32effebd3e8de36f15385a5115?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bourne", "link": "https://stackoverflow.com/users/10535212/r-bourne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559677936, "creation_date": 1559676554, "last_edit_date": 1559677936, "question_id": 56450181, "link": "https://stackoverflow.com/questions/56450181/is-there-a-way-to-check-nested-workbooks-for-specific-worksheets-and-list-out-or", "title": "Is there a way to check nested workbooks for specific worksheets and list out or mark those workbooks not containing the worksheet?", "body": "<p>I'm trying to save time in looking for excel files without a specific sheet named \"RUNREADY\" in a large directory of nested folders and excel files. This workbook without the worksheet would ideally be listed in a master excel file higher up in the directory or just have its name changed to end in a '(1)' or '(0)' depending on if it has the sheet or not.</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n'PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\nWith FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n'In Case of Cancel\nNextCode:\nmyPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n'Target File Extension (must include wildcard \"*\")\nmyExtension = \"*.xls*\"\n'Target Path with Ending Extention\nmyFile = Dir(myPath &amp; myExtension)\n'Loop through each Excel file in folder\nDo While myFile &lt;&gt; \"\"\n'Set variable equal to opened workbook\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n'Ensure Workbook has opened before moving on to next line of code\n  DoEvents\n'Change First Worksheet's Background Fill Blue\n  'wb.Worksheets(1).Range(\"A1:Z1\").Interior.Color = RGB(51, 98, 174)\n'Save and Close Workbook\n  wb.Close SaveChanges:=True\n'Ensure Workbook has closed before moving on to next line of code\n\n\n\n  Dim ws As Worksheet\n  Dim rr As Integer\n  Dim cel As Range\n  rr = 0\n  For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"RUNREADY\" Then\n            rr = rr + 1\n        Else\n            rr = 0\n        End If\n  Next ws\n  If rr = 1 Then\n    [RUNREADY.xlsm] Sheet1!cel.Value = ActiveWorkbook.FullName\n    [RUNREADY.xlsm] Sheet1!cel.Offset(1, 0)\n  End If\n\n\n\n'Get next file name\n  myFile = Dir\nLoop\n'Message Box when tasks are completed\nMsgBox \"Task Complete!\"\nResetSettings:\n'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I looked around for some sort of guidance and found this piece of code that searches through a file. I tried to write something that would write to a named excel file. my portion is spaced off in the middle of everything Running this i get an error at the first square bracket in my portion of code.</p>\n"}, {"tags": ["excel", "vba", "userform", "autofill"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1559675878, "post_id": 56449905, "comment_id": 99493394, "body": "You missed some <code>Rows.Count</code> that are not fully qualified, possibly the root of your problem? i.e.: <code>ThisWorkbook.Sheets(&quot;MFRL&quot;).Cells(Rows.Count, &quot;B&quot;)...</code> evaluates to <code>ThisWorkbook.Sheets(&quot;MFRL&quot;).Cells(ActiveSheet.Rows.Count, &quot;B&quot;)...</code> which might work because <code>Sheets(&quot;MFRL&quot;)</code> is your active sheet... but for the others..."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1559677123, "post_id": 56449905, "comment_id": 99493844, "body": "I&#39;ve edited your code, but can&#39;t be certain on the correct ranges, I&#39;ve just fixed the obvious parts. I don&#39;t see why the bordering would work, given your <code>Rows.Count</code> was still of the <code>ActiveSheet.Rows.Count</code>."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559677912, "post_id": 56450266, "comment_id": 99494177, "body": "I tried to incorporate your code but nothing seems to happen. Do you see anything wrong with just the autofill that seems off since the bordering works? Thanks"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559678144, "post_id": 56450266, "comment_id": 99494269, "body": "also the lastrow that I had a typo in was a typo, not sure if that changes the answer. The &quot;Monthly FGL Report&quot; should be &quot;JH&quot; instead"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1559679410, "post_id": 56450266, "comment_id": 99494788, "body": "I can&#39;t really see nothing wrong to be honest... I&#39;ve corrected some duplicate resizes, but other than that, without seeing the worksheet or knowing what you expect to see, is hard for me to guess. I&#39;ve added in the answer a method of debugging... see if it helps."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1559679807, "post_id": 56450266, "comment_id": 99494954, "body": "It looks to me like you are only trying to copy the values accross? Shouldn&#39;t use Autofill, but just <code>Range.Value = Range.Value</code> instead. Or if you want formulas, then <code>Range.Formula = </code>Range.Formula`..."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1559680182, "post_id": 56450266, "comment_id": 99495117, "body": "Right, which ranges are you trying to fill? Sheet CT &amp; JH from MFRL? or MFRL from CT &amp; JH?. Because at the moment your code is only filling (or trying) the sheet MFRL."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559680256, "post_id": 56450266, "comment_id": 99495152, "body": "I am trying to autofill cells on all 3 of the sheets for Scenario 3"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559680282, "post_id": 56450266, "comment_id": 99495166, "body": "Would you like to look at my workbook I could forward it to you if that would be easier to show you what I am doing"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1559680324, "post_id": 56450266, "comment_id": 99495186, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194461/discussion-between-darxyde-and-tmacjoshua\">continue this discussion in chat</a>."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1560011927, "post_id": 56450266, "comment_id": 99603726, "body": "Hey could you take a look at what I mentioned in the chat. I can make it a question if you would like."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1559683857, "last_edit_date": 1559683857, "creation_date": 1559677016, "answer_id": 56450266, "question_id": 56449905, "link": "https://stackoverflow.com/questions/56449905/autofill-an-area-of-cells-dependant-on-the-userform/56450266#56450266", "title": "Autofill an area of cells dependant on the userform", "body": "<p>To add to my comment, I've took the liberty to fix your code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n\nDim ColA As New Scripting.Dictionary  'Need Microsoft Scripting Runtime Reference\nDim ColB As New Scripting.Dictionary\nDim LastRow As Long\nDim Criteria1 As Boolean\nDim Criteria2 As Boolean\nDim C As Range\n\nDim wb As Workbook: Set wb = ThisWorkbook\n\nWith wb.Sheets(\"MFRL\")\n    LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row 'This gets the last row on column A\n    For Each C In .Range(\"A1:A\" &amp; LastRow) 'loop through the whole column\n    On Error Resume Next\n        'If you have duplicated entries this will throw an error\n        ColA.Add C.Value, C.Row 'add the values from column A to DictA, also store it's row for later purposes\n        ColB.Add C.Offset(0, 1).Value, C.Row 'add the values from column B to DictB, also store it's row for later purposes\n    Next C\n    'Criterias will give value of True if matched or False if not\n    Criteria1 = ColA.Exists(ComboBox2.Value) 'this is getting matched with ColA Dictionary\n    Criteria2 = ColB.Exists(ComboBox1.Value) 'this is getting matched with ColB Dictionary\n    If Criteria1 And Criteria2 Then 'SCENARIO 1\n        Call linepick\n\n    ElseIf Criteria1 And Not Criteria2 Then 'SCENARIO 2\n        .Cells(LastRow + 1, 1) = ComboBox2.Value\n        .Cells(LastRow + 1, 2) = ComboBox1.Value\n        Call linepick\n        .Cells(LastRow, \"B\").Offset(-1, 1).Resize(, 3).AutoFill .Cells(LastRow, \"B\").Offset(-1, 1).Resize(2, 3)\n        .Cells(LastRow, \"A\").Offset(-1, 0).Resize(2, 5).Borders.LineStyle = xlContinuous\n\n    ElseIf Not Criteria1 And Not Criteria2 Then 'SCENARIO 3\n        .Cells(LastRow + 1, 1) = ComboBox2.Value\n        .Cells(LastRow + 1, 2) = ComboBox1.Value\n        .Cells(LastRow, \"B\").Offset(-1, 1).Resize(, 3).AutoFill .Cells(LastRow, \"B\").Offset(-1, 1).Resize(2, 3)\n        .Cells(LastRow, \"A\").Offset(-1, 0).Resize(2, 5).Borders.LineStyle = xlContinuous\n\n        With wb.Sheets(\"CT\")\n            LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n            .Cells(LastRow, 1) = ComboBox2.Value\n            .Cells(LastRow, \"A\").Offset(-1, 1).Resize(, 21).AutoFill .Cells(LastRow, \"A\").Offset(-1, 1).Resize(2, 21)\n            .Cells(LastRow, \"A\").Resize(1, 22).Borders.LineStyle = xlContinuous\n        End With\n\n        With wb.Sheets(\"JH\")\n            LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n            .Cells(LastRow, 1) = ComboBox2.Value\n            .Cells(LastRow, \"AE\") = TextBox1.Value\n            .Cells(LastRow, \"AE\").Offset(-1, 1).Resize(, 4).AutoFill .Cells(LastRow, \"AE\").Offset(-1, 1).Resize(2, 4)\n            .Cells(LastRow, \"A\").Offset(-1, 0).Resize(2, 44).Borders.LineStyle = xlContinuous\n        End With\n    End If\nEnd With\n\n    wb.RefreshAll\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> The destination must include the source range.</p>\n\n<p><strong>EDIT2:</strong> fixed some problems in code</p>\n\n<p>Use the debugger to check if the ranges are what you expect them to be, i.e.:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print \"CT Range: \" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Offset(-1, 1).Resize(, 21).Address\nDebug.Print \"MFRL Range: \" &amp; wb.Sheets(\"MFRL\").Cells(wb.Sheets(\"MFRL\").Rows.Count, \"A\").End(xlUp).Offset(-1, 1).Resize(2, 21).Address\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56450266, "answer_count": 1, "score": 0, "last_activity_date": 1559683857, "creation_date": 1559675155, "last_edit_date": 1559676925, "question_id": 56449905, "link": "https://stackoverflow.com/questions/56449905/autofill-an-area-of-cells-dependant-on-the-userform", "title": "Autofill an area of cells dependant on the userform", "body": "<p>I have built code for a userform that will complete certain tasks depending on the scenario. Everything works, but the autofill code I have in place for scenario 3 (Sheets JH and CT) are not working. While in the same scenario the autofill for worksheet MRFL is doing as asked. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ColA As New Scripting.Dictionary  'Need Microsoft Scripting Runtime Reference\nDim ColB As New Scripting.Dictionary\nDim LastRow As Long\nDim Criteria1 As Boolean\nDim Criteria2 As Boolean\nDim C As Range\n\n\n\n\nWith ThisWorkbook.Sheets(\"MFRL\")\n    LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row 'This gets the last row on column A\n    For Each C In .Range(\"A1:A\" &amp; LastRow) 'loop through the whole column\n    On Error Resume Next\n        'If you have duplicated entries this will throw an error\n        ColA.Add C.Value, C.Row 'add the values from column A to DictA, also store it's row for later purposes\n        ColB.Add C.Offset(0, 1).Value, C.Row 'add the values from column B to DictB, also store it's row for later purposes\n    Next C\n    'Criterias will give value of True if matched or False if not\n    Criteria1 = ColA.Exists(ComboBox2.Value) 'this is getting matched with ColA Dictionary\n    Criteria2 = ColB.Exists(ComboBox1.Value) 'this is getting matched with ColB Dictionary\n    If Criteria1 And Criteria2 Then 'SCENARIO 1\n       Call linepick\n    ElseIf Criteria1 And Not Criteria2 Then 'SCENARIO 2\n        .Cells(LastRow + 1, 1) = ComboBox2.Value\n        .Cells(LastRow + 1, 2) = ComboBox1.Value\n         Call linepick\n        ThisWorkbook.Sheets(\"MFRL\").Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).AutoFill .Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).Resize(2)\n        ThisWorkbook.Sheets(\"MFRL\").Cells(Rows.Count, \"A\").End(xlUp).Offset(-1, 0).Resize(, 5).Resize(2).Borders.LineStyle = xlContinuous\n    ElseIf Not Criteria1 And Not Criteria2 Then 'SCENARIO 3\n        .Cells(LastRow + 1, 1) = ComboBox2.Value\n        .Cells(LastRow + 1, 2) = ComboBox1.Value\n        LastRow = ThisWorkbook.Sheets(\"CT\").Cells(ThisWorkbook.Sheets(\"CT\").Rows.Count, 1).End(xlUp).Row + 1\n        ThisWorkbook.Sheets(\"CT\").Cells(LastRow, 1) = ComboBox2.Value\n        ThisWorkbook.Sheets(\"CT\").Cells(Rows.Count, \"A\").End(xlUp).Offset(-1, 1).Resize(, 21).AutoFill .Cells(Rows.Count, \"A\").End(xlUp).Offset(-1, 1).Resize(, 21).Resize(2)\n        ThisWorkbook.Sheets(\"CT\").Cells(Rows.Count, \"A\").End(xlUp).Offset(-1, 0).Resize(, 21).Resize(2).Borders.LineStyle = xlContinuous\n        LastRow = ThisWorkbook.Sheets(\"JH\").Cells(ThisWorkbook.Sheets(\"JH\").Rows.Count, 1).End(xlUp).Row + 1\n        ThisWorkbook.Sheets(\"JH\").Cells(LastRow, 1) = ComboBox2.Value\n        ThisWorkbook.Sheets(\"JH\").Cells(LastRow, \"AE\") = TextBox1.Value\n        ThisWorkbook.Sheets(\"JH\").Cells(Rows.Count, \"AE\").End(xlUp).Offset(0, 1).Resize(, 4).AutoFill .Cells(Rows.Count, \"AE\").End(xlUp).Offset(0, 1).Resize(, 4).Resize(2)\n        ThisWorkbook.Sheets(\"JH\").Cells(Rows.Count, \"A\").End(xlUp).Offset(-1, 0).Resize(, 44).Resize(2).Borders.LineStyle = xlContinuous\n        ThisWorkbook.Sheets(\"MFRL\").Cells(LastRow, 1) = ComboBox2.Value\n        ThisWorkbook.Sheets(\"MFRL\").Cells(LastRow, 2) = ComboBox1.Value\n        ThisWorkbook.Sheets(\"MFRL\").Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).AutoFill .Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).Resize(2)\n        ThisWorkbook.Sheets(\"MFRL\").Cells(Rows.Count, \"A\").End(xlUp).Offset(-1, 0).Resize(, 5).Resize(2).Borders.LineStyle = xlContinuous\n    End If\n End With\n ActiveWorkbook.RefreshAll\n Unload Me\n End Sub\n</code></pre>\n"}]