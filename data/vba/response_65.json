[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1459980745, "post_id": 36463189, "comment_id": 60538382, "body": "Format the cells as numbers and not text, and Excel will do this for you."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1459983842, "post_id": 36463189, "comment_id": 60539420, "body": "You didn&#39;t try something like <code>if isnumeric(activecell) then activecell.Value=cdbl(activecell.Value)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459984035, "post_id": 36463261, "comment_id": 60539484, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow noreferrer\">The first element is the column number (1-based)</a> so why does yours start with 0?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459984715, "post_id": 36463261, "comment_id": 60539706, "body": "@findwindow  -Thanks for catching that. Fixed above now. Wrote that off the top of my head; I must have been day-dreaming of footnotes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459988210, "post_id": 36463261, "comment_id": 60540634, "body": "@findwindow - You only read half of the description for the <b>FieldInfo</b> parameter of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow noreferrer\">Range.TextToColumns method</a>. You missed <i>&#39;When the data is delimited, ...&#39;</i>. This is an <b>xlFixedWidth</b> &#39;split&#39; (not actually a split at all) and the <b>0</b> refers to the start of the fixed width position of the split. A single two element array of <b>0</b> and a <a href=\"https://msdn.microsoft.com/en-us/library/bb241018%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">xlColumnDataType</a> means only one column; no split at all."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1460040958, "post_id": 36463261, "comment_id": 60569840, "body": "Yea I didn&#39;t really understand what was meant by <code>xlFixedWidth</code> either XD The nomenclature is really poor because width to me suggests column width but it means number of columns? Seems <code>xlFixedWidth</code> is redundant if you can just indicate with 0 in the array? Thank you for explaining &lt;3 Guess I upvote even without footnote..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1459984654, "last_edit_date": 1459984654, "creation_date": 1459980768, "answer_id": 36463261, "question_id": 36463189, "link": "https://stackoverflow.com/questions/36463189/remove-zeros-at-the-beginning-of-a-string-of-numbers-vba/36463261#36463261", "title": "remove zero&#39;s at the beginning of a string of numbers VBA", "body": "<p>Try,</p>\n\n<pre><code>with worksheets(\"Sheet1\")\n    with .columns(1)\n        .numberformat = \"General\"\n        .texttocolumns destination:=.cells(1), _\n                       datatype:=xlFixedWidth, fieldinfo:=Array(0, 1)\n    end with\nend with\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1459981391, "creation_date": 1459981391, "answer_id": 36463382, "question_id": 36463189, "link": "https://stackoverflow.com/questions/36463189/remove-zeros-at-the-beginning-of-a-string-of-numbers-vba/36463382#36463382", "title": "remove zero&#39;s at the beginning of a string of numbers VBA", "body": "<p>If converting to numbers isn't a viable solution for you then this UDF will work:</p>\n\n<pre><code>Function StripLeadingZeros(MyString As String)\nDim X As Long\nFor X = 1 To Len(MyString)\n    If Left(MyString, 1) = \"0\" Then\n        MyString = Right(MyString, Len(MyString) - 1)\n    Else\n        Exit For\n    End If\nNext\nStripLeadingZeros = MyString\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1459982332, "post_id": 36463544, "comment_id": 60538949, "body": "What if there&#39;s more than 1 leading zero?"}, {"owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1460040544, "post_id": 36463544, "comment_id": 60569531, "body": "Hey, I updated the code section above. You essentially just loop through the string and examine the first character for a zero. There&#39;s really probably 100 ways to do this."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1460041050, "post_id": 36463544, "comment_id": 60569904, "body": "That&#39;s what Dan did above?"}], "tags": [], "owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "is_accepted": false, "score": 1, "last_activity_date": 1460040468, "last_edit_date": 1460040468, "creation_date": 1459982282, "answer_id": 36463544, "question_id": 36463189, "link": "https://stackoverflow.com/questions/36463189/remove-zeros-at-the-beginning-of-a-string-of-numbers-vba/36463544#36463544", "title": "remove zero&#39;s at the beginning of a string of numbers VBA", "body": "<p>I'm sure you can figure out how to iterate through each cell so I'm not going to demonstrate that in the code example below. This will do the trick. Replace A4 with each cell you need to process. </p>\n\n<pre><code>Dim My_Number As String\nDim i As Integer\nMy_Number = Range(\"A4\")\nFor i = 1 To Len(My_Number) - 1\n    If InStr(1, My_Number, \"0\") = 1 Then\n        My_Number = Right(My_Number, Len(My_Number) - 1)\n    Else\n        Range(\"A4\") = My_Number\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>Instr is looking for a zero in the fist position of the string. If if finds a zero then the next line writes all the string characters besides the first one(the zero) to the cell.</p>\n"}], "owner": {"reputation": 21, "user_id": 6037179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac972643ee6a7b0894a2128b1c61dd4d?s=128&d=identicon&r=PG&f=1", "display_name": "khert87", "link": "https://stackoverflow.com/users/6037179/khert87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2728, "favorite_count": 0, "accepted_answer_id": 36463261, "answer_count": 3, "score": 0, "last_activity_date": 1460040468, "creation_date": 1459980381, "last_edit_date": 1531164843, "question_id": 36463189, "link": "https://stackoverflow.com/questions/36463189/remove-zeros-at-the-beginning-of-a-string-of-numbers-vba", "title": "remove zero&#39;s at the beginning of a string of numbers VBA", "body": "<p>I have a column of numbers and I need to remove the leading zero's from each cell in the column if the numbers begin with zero's.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459982343, "post_id": 36463003, "comment_id": 60538953, "body": "Is the content you show the only content there is in the response?"}, {"owner": {"reputation": 3, "user_id": 6169166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b95193d5dcaa35edace53ef547db0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/6169166/alex-s"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1460052030, "post_id": 36463003, "comment_id": 60577066, "body": "Thanks for the help Tim. Using your code I was able to add in comments that were one line. However, I did run into an unexpected problem: The HTML is used as an online chat log, so while most entries are handled ok, I found a few instances where the text attributed to somebody read as &quot;I copied something &lt;br&gt;&lt;/br&gt;into the chat box &lt;br&gt;&lt;/br&gt; and the chat log kept all the newline.&quot; This is making it so your code creates three separate rows instead of one, attributing &quot;into the chat box&quot; to another user, and so on. I&#39;m looking into some sort of error catch right now."}, {"owner": {"reputation": 3, "user_id": 6169166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b95193d5dcaa35edace53ef547db0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/6169166/alex-s"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1460053360, "post_id": 36463003, "comment_id": 60577927, "body": "Worked like a charm. It did affect the formatting of the cells a bit because now there is an extra blank newline attached to each of the comment cells, doubling the cell height, but they are lining up great over the 200+ lines. If you could maybe help with the formatting, or if that&#39;s a result of the custom splitter that you used that needs to stay. Either way thanks and I&#39;ll mark as answered."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1460054779, "post_id": 36463003, "comment_id": 60578825, "body": "See update - you might have to tweak that a bit"}, {"owner": {"reputation": 3, "user_id": 6169166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b95193d5dcaa35edace53ef547db0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/6169166/alex-s"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1460058644, "post_id": 36463003, "comment_id": 60581103, "body": "Worked, thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1460054747, "last_edit_date": 1460054747, "creation_date": 1459982723, "answer_id": 36463628, "question_id": 36463003, "link": "https://stackoverflow.com/questions/36463003/parse-html-text-not-in-a-tag-using-vba/36463628#36463628", "title": "Parse HTML text not in a tag using VBA", "body": "<p>As long as that's the only content in the response and there are no other sections you could do something like this:</p>\n\n<p><strong>EDIT:</strong> revised to split on something other than <br></p>\n\n<pre><code>Sub Tester()\n\n    Const RW_START As Long = 5\n    Const SPLITTER = \"{xxxx}\"\n    Dim i As Integer, html_doc, itm\n    Dim Timestamp As Object\n    Dim Name As Object\n    Dim arr, sep, txt\n\n    Set html_doc = CreateObject(\"htmlfile\")\n    html_doc.body.innerHTML = Range(\"A1\").Value 'for my testing...\n\n\n    Set Timestamp = html_doc.body.getElementsByTagName(\"a\")\n    Set Name = html_doc.body.getElementsByTagName(\"font\")\n\n    i = RW_START\n    For Each itm In Timestamp\n        If itm.getAttribute(\"className\") = \"ts\" Then\n            Cells(i, 1).Value = itm.innerText\n            itm.innerText = \"\" '&lt;&lt;&lt;\n            i = i + 1\n        End If\n    Next\n\n    i = RW_START\n    For Each itm In Name\n        If itm.getAttribute(\"className\") = \"mn\" Then\n            Cells(i, 2).Value = itm.innerText\n            itm.innerText = IIf(i = RW_START, \"\", SPLITTER) '&lt;&lt;&lt;\n            i = i + 1\n        End If\n    Next\n\n    'get the remaining text and split on newline (&lt;br&gt;)\n    arr = Split(html_doc.body.innerText, SPLITTER)\n    i = RW_START\n    For Each itm In arr\n        itm = Trim(itm) \n        'remove trailing vbLf\n        If Right(itm, 1) = vblf Then itm = Left(itm, Len(itm)-1)\n        Cells(i, 3).Value = Trim(itm)\n        i = i + 1\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6169166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b95193d5dcaa35edace53ef547db0b3?s=128&d=identicon&r=PG&f=1", "display_name": "Alex S", "link": "https://stackoverflow.com/users/6169166/alex-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 36463628, "answer_count": 1, "score": 0, "last_activity_date": 1460054747, "creation_date": 1459979408, "last_edit_date": 1531164843, "question_id": 36463003, "link": "https://stackoverflow.com/questions/36463003/parse-html-text-not-in-a-tag-using-vba", "title": "Parse HTML text not in a tag using VBA", "body": "<p>I need to get some text that isn't enclosed by any HTML elements except for in the body tag, but the problem is that the text is broken up by other tags and needs to go into separate cells. </p>\n\n<p>For example:</p>\n\n<pre><code>&lt;a id=\"00:00:00\" class=\"ts\"&gt;[00:00:00]&lt;/a&gt; &lt;font class=\"mn\"&gt;Name1&lt;/font&gt; First bit of text&lt;br/&gt;\n&lt;a id=\"00:00:09\" class=\"ts\"&gt;[00:00:09]&lt;/a&gt; &lt;font class=\"mn\"&gt;Name2&lt;/font&gt; Second Line of Text&lt;br/&gt;\n&lt;a id=\"00:01:17\" class=\"ts\"&gt;[00:01:17]&lt;/a&gt; &lt;font class=\"mn\"&gt;Name3&lt;/font&gt; A third line of text&lt;br/&gt;\n&lt;a id=\"00:01:59\" class=\"ts\"&gt;[00:01:59]&lt;/a&gt; &lt;font class=\"mn\"&gt;Name4&lt;/font&gt; The final line of text&lt;br/&gt;\n</code></pre>\n\n<p>I am able to get the timestamps as well as the names into their respective columns, but I'm having trouble figuring out how to get each line of text into the corresponding rows.</p>\n\n<p>Here's my code so far:</p>\n\n<pre><code>Dim i As Integer\nDim Timestamp As Object\nDim Name As Object\n\nmy_url = \"path_to_url.html\"\nSet html_doc = CreateObject(\"htmlfile\")\nSet xml_obj = CreateObject(\"MSXML2.XMLHTTP\")\n\nxml_obj.Open \"GET\", my_url, False\nxml_obj.send\nhtml_doc.body.innerHTML = xml_obj.responseText\nSet xml_obj = Nothing\n\nSet Timestamp = html_doc.body.getElementsByTagName(\"a\")\nSet Name = html_doc.body.getElementsByTagName(\"font\")\n\ni = 2\nFor Each itm In Timestamp\n    If itm.getAttribute(\"className\") = \"ts\" Then\n        Cells(i, 1).Value = itm.innerText\n        i = i + 1\n    End If\nNext\n\ni = 2\nFor Each itm In Name\n    If itm.getAttribute(\"className\") = \"mn\" Then\n        Cells(i, 2).Value = itm.innerText\n        i = i + 1\n    End If\nNext\n</code></pre>\n\n<p>I was thinking about maybe using <code>&lt;br/&gt;</code> in some way and using LEFT, but I'm not sure if that's the best approach. Thanks in advance.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459981161, "post_id": 36463184, "comment_id": 60538534, "body": "@MR: In addition, you also should use <code>InStrRev</code> for the SUFFIX part. Currently it is only by luck (the first &quot;-&quot; always being at position 2) that this part works."}], "tags": [], "owner": {"reputation": 646, "user_id": 4509310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28aae8658c566754799b47f0ae3ac175?s=128&d=identicon&r=PG&f=1", "display_name": "Jon C", "link": "https://stackoverflow.com/users/4509310/jon-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1459980916, "last_edit_date": 1459980916, "creation_date": 1459980359, "answer_id": 36463184, "question_id": 36462639, "link": "https://stackoverflow.com/questions/36462639/splitting-a-single-database-field-into-multiple-fields/36463184#36463184", "title": "Splitting a Single Database Field into Multiple Fields", "body": "<p>The reason is that <code>mid</code> function expects 3 parameters:</p>\n\n<pre><code>Mid ( text, start_position, number_of_characters )\n</code></pre>\n\n<p>If you don't specify the last parameter, the <code>mid</code> function will return all characters after the start_position, which lead to your result.</p>\n\n<p>Try:</p>\n\n<pre><code>Mid([ADDRESS_ID],InStr([ADDRESS_ID],\"-\")+1,InStrRev([ADDRESS_ID],\"-\")-(InStr([ADDRESS_ID],\"-\")+1)) AS CODE\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1459981172, "creation_date": 1459981172, "answer_id": 36463341, "question_id": 36462639, "link": "https://stackoverflow.com/questions/36462639/splitting-a-single-database-field-into-multiple-fields/36463341#36463341", "title": "Splitting a Single Database Field into Multiple Fields", "body": "<p>This expression extracts the substring I think you want for <code>CODE</code>:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Mid([ADDRESS_ID], InStr(1, [ADDRESS_ID], \"-\") + 1, InStrRev([ADDRESS_ID], \"-\") - InStr(1, [ADDRESS_ID], \"-\") - 1) AS CODE\n</code></pre>\n\n<p>However, that expression is rather complex, and your other field expressions are already fairly complex --- whole lotta functions going on.</p>\n\n<p>If you will be running the query from within an Access session, you could use a custom function which leverages the VBA <code>Split()</code> function.  </p>\n\n<p>Then your query could be simpler and clear.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT SplitSegment([ADDRESS_ID], \"-\", 0) AS Abbreviation,\n       SplitSegment([ADDRESS_ID], \"-\", 1) AS CODE,\n       SplitSegment([ADDRESS_ID], \"-\", 2) AS SUFFIX,\n       MDM_Address_Remote_Key.ADDRESS_ID\nFROM MDM_Address_Remote_Key;\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function SplitSegment(ByVal pSource As Variant, _\n        ByVal pDelimter As String, _\n        ByVal pIndex As Long) As Variant\n\n    Dim varOut As Variant\n    varOut = Null\n    If Not IsNull(pSource) Then\n        varOut = Split(pSource, pDelimter)(pIndex)\n    End If\n    SplitSegment = varOut\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5290515, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a156e728054fa6039c15bfede409ea80?s=128&d=identicon&r=PG&f=1", "display_name": "M R", "link": "https://stackoverflow.com/users/5290515/m-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1459981625, "creation_date": 1459977871, "last_edit_date": 1459981625, "question_id": 36462639, "link": "https://stackoverflow.com/questions/36462639/splitting-a-single-database-field-into-multiple-fields", "title": "Splitting a Single Database Field into Multiple Fields", "body": "<p>The following is a query written to split the following tables. The third column is suffix, and the column before this field will not trim the -suffix off the end of the returned field. I have attached the query as well as an image of the results and the issue.</p>\n\n<pre><code>SELECT Left([ADDRESS_ID],InStr([ADDRESS_ID],\"-\")-1) AS Abbreviation,\n       Mid([ADDRESS_ID],InStr([ADDRESS_ID],\"-\")+1) AS CODE,\n       Right([ADDRESS_ID],InStr([ADDRESS_ID],\"-\")) AS SUFFIX,\n       MDM_Address_Remote_Key.ADDRESS_ID\nFROM MDM_Address_Remote_Key;\n</code></pre>\n\n<p>The three columns are broken apart and should look like the third; however, the middle column is holding onto the suffix at the end. How to resolve this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/xnUTk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xnUTk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459978651, "post_id": 36462583, "comment_id": 60537534, "body": "I need to review your description more closely, but for the &quot;flashes the screen like crazy&quot; part, you can use <code>Application.ScreenUpdating = FALSE</code> at the beginning of your sub and <code>Application.ScreenUpdating = TRUE</code> at the end of it."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459987654, "post_id": 36462583, "comment_id": 60540498, "body": "In your second code snippet, <code>cel.copy</code> is only copying from one cell in column A from the 9 AM worksheet. You are pasting the format of that cell into row stretching from A to AF in the 9 AM worksheet. I think you are wanting to copy from A to AF in the 9 am sheet and paste formats into A to AF in the 12 PM worksheet."}, {"owner": {"reputation": 1, "user_id": 6169086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba82de5cd900d97e8b538aed9319bfc8?s=128&d=identicon&r=PG&f=1", "display_name": "Leokul", "link": "https://stackoverflow.com/users/6169086/leokul"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1460064445, "post_id": 36462583, "comment_id": 60584188, "body": "Thank you for your input so far! I added the ScreenUpdating code to my modules. Also, you are correct that I am wanting to copy the A:AF cell formats of each row with the matching value in cell A#, and pasting only the format to the 12pm sheet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6169086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba82de5cd900d97e8b538aed9319bfc8?s=128&d=identicon&r=PG&f=1", "display_name": "Leokul", "link": "https://stackoverflow.com/users/6169086/leokul"}, "edited": false, "score": 0, "creation_date": 1460068729, "post_id": 36487820, "comment_id": 60585803, "body": "I tested that modification, and while I got really excited that it looked to work, it didn&#39;t. I ended up with fill formatting where some didn&#39;t match the values of the A column cells, and some did on the 12pm sheet."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1460065660, "creation_date": 1460065660, "answer_id": 36487820, "question_id": 36462583, "link": "https://stackoverflow.com/questions/36462583/macro-to-copy-only-formatting-of-matched-value-in-different-sheet/36487820#36487820", "title": "Macro to Copy ONLY Formatting of Matched Value in Different Sheet", "body": "<p>I haven't any data to test this against, but try something like the following ...</p>\n\n<pre><code>For Each cel In NewDataRng\n    Set MatchingValueCell = OldDataRng.Find(What:=cel.Value, _\n    After:=OldDataRng.Cells(OldDataRng.Cells.Count))\n    If Not MatchingValueCell Is Nothing Then _\n    Sheets(\"9am\").Rows(MatchingValueCell.Row).Copy\n    Sheets(\"12pm\").Rows(cel.Row).PasteSpecial Paste:=xlPasteFormats\nNext cel\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6169086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba82de5cd900d97e8b538aed9319bfc8?s=128&d=identicon&r=PG&f=1", "display_name": "Leokul", "link": "https://stackoverflow.com/users/6169086/leokul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460065660, "creation_date": 1459977643, "question_id": 36462583, "link": "https://stackoverflow.com/questions/36462583/macro-to-copy-only-formatting-of-matched-value-in-different-sheet", "title": "Macro to Copy ONLY Formatting of Matched Value in Different Sheet", "body": "<p>In advance, thank you for your help.\nIn Excel 2016, I have a workbook with 3 sheets labelled 9am, 12pm and 330pm.\nI have columns A through AF with values and formats set for each row.\nRight now, after some research on StackOverflow already, I have found a Macro that looks for values in column A in sheet 9am up to the last found value, then copies that value with it's cell formatting, as well as the values of the rest of the row cells (up to column AF), into the 12pm sheet.\nCode shown below:</p>\n\n<pre><code>Private Sub CopyDataAndFormat12pm()\nDim NewDataRng As Range 'For 12pm\nDim cel As Range 'For 12pm\nDim OldDataRng As Range 'For 9am\nDim MatchingValueCell As Range 'For 9am\nDim lastrow As Long\n\nWith Sheets(\"9am\")\n    lastrow = .Cells(Rows.Count, 1).End(xlUp).Row\n    Set NewDataRng = .Range(\"A2:A\" &amp; CStr(lastrow))\nEnd With\n\nWith Sheets(\"12pm\")\n    lastrow = .Cells(Rows.Count, 1).End(xlUp).Row\n    Set OldDataRng = .Range(\"A2:A\" &amp; CStr(lastrow))\nEnd With\n\nFor Each cel In NewDataRng\n    Set MatchingValueCell = OldDataRng.Find(What:=cel.Value, _\n    After:=OldDataRng.Cells(OldDataRng.Cells.Count))\n    If Not MatchingValueCell Is Nothing Then _\n    cel.Resize(1, 8).Copy MatchingValueCell\n\nNext cel\nEnd sub\n</code></pre>\n\n<p>This works great, except that I also have a macro that pastes the newest list of values for our 12pm report and automatically formats it for me, and the 12pm sheet may have new values for some of the columns (specifically columns C, I, J and K) and I need to retain the new values.\nSo basically, I need to modify this code so that it only pastes the formatting of rows (for columns A:AF for each row) into the new 12pm sheet for the matching values it finds.\nI have tried modifying the code to:</p>\n\n<pre><code>    For Each cel In NewDataRng\n    Set MatchingValueCell = OldDataRng.Find(What:=cel.Value, _\n    After:=OldDataRng.Cells(OldDataRng.Cells.Count))\n    If Not MatchingValueCell Is Nothing Then _\n    cel.Copy\n    cel.Resize(1, 31).PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n\n<p>But when I run it, it flashes the screen like crazy as it runs the code, and looks like it's doing what I want, but when the code finishes compiling, nothing is saved and it looks like the code never ran.</p>\n\n<p>Sorry if this isn't a good explanation, and if you need more code, please ask and I'll be more than happy to provide it as soon as possible.</p>\n\n<p>Thank you so much if you can help me!</p>\n\n<p>Regards,\nBrady</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1459982180, "post_id": 36462129, "comment_id": 60538897, "body": "Check out Gustav&#39;s <code>CSql</code> function, posted here: <a href=\"http://stackoverflow.com/a/36421361/3820271\">stackoverflow.com/a/36421361/3820271</a> - it handles a lot of data types (not OLE though)."}, {"owner": {"reputation": 115, "user_id": 5399736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153734041789047/picture?type=large", "display_name": "bcrimmins", "link": "https://stackoverflow.com/users/5399736/bcrimmins"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1460073630, "post_id": 36462129, "comment_id": 60587311, "body": "Thanks, @andre, that&#39;s a clean function and I may use it."}], "owner": {"reputation": 115, "user_id": 5399736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153734041789047/picture?type=large", "display_name": "bcrimmins", "link": "https://stackoverflow.com/users/5399736/bcrimmins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594642363, "creation_date": 1459976037, "last_edit_date": 1594642363, "question_id": 36462129, "link": "https://stackoverflow.com/questions/36462129/moving-data-between-dissimilar-tables-in-ms-access-2010", "title": "Moving data between dissimilar tables in MS Access 2010", "body": "<p>I have a set of tables that track various properties of equipment parts based on the type of part.  Some part types share certain properties, for example length, weight, last order date, etc.  However there are also some properties that are unique to a specific part type.  For example, parts that are of type \"motor\" would have a voltage but would not have a lumens rating, as would a part of type \"led\"... although an \"led\" part would also have a voltage.  </p>\n\n<p>Occasionally, a part's type will be changed and when that happens, our database requires that new records be created in the appropriate tables for tracking the part's new properties.  We want to be able to also copy over the previous shared property values from the previous parts type fields that are common between the old and new parts type tables.  In cases where the old and new fields are equivilent, they will share the exact same field name, i.e., the 'weight' field will be named 'weight' in both tables.</p>\n\n<p>In VBA, it is straightforward to loop through the fields in both tables and compare field names for a match.  When a match is found, the data then needs to get copied from the old parts type table to the corresponding field in the new table.  The tricky part (which I'm hoping for advice on) is how to efficiently UPDATE the new field when the data type can be anything, e.g., text, number, date, OLE object, etc.  Of course, the syntax for bounding each of these is different -- text fields require a single quote, dates require a pound sign, numbers don't need anything, not sure what an OLD object needs.</p>\n\n<p>My current thinking is to set a bounding character based on the data type of the field and then add those characters while building the SQL string that would then be executed to update the new table.  Here is some pseudo code and the SQL statement I was thinking I'd use.  The tdf objects are DAO tabledefs, the fld objects are DAO field objects.  </p>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>is there a better approach (more efficient, cleaner, reliable, standard)</p></li>\n<li><p>should I setup a recordset to actually access the data in the old\n    table or is DLookup() a decent choice given that there will only be\n    about 50 - 100 fields moved at a time?</p></li>\n<li><p>I've never moved OLE object between tables. No doubt, other\n    StackOverflow posts will address this.  But if you have thoughts\n    then I'd be happy to hear them.</p>\n\n<pre><code>&lt;nested loop to match old and new field names&gt;\n\n    &lt;if a matching field is found, then&gt;\n\n        strSQL = \"UPDATE \" &amp; tdfTo.Name &amp; \" SET \" &amp; fldTo.Name &amp; \" = \" &amp; DLookup(fldFrom.Name, tdfFrom.Name, \"part_number = \" &amp; strPartNum) &amp; \" WHERE part_number = '\" &amp; strPartNum &amp; \"';\"\n        CurrentDB.Execute strSQL\n\n&lt;end nested matching loop&gt;r\n</code></pre></li>\n</ol>\n"}, {"tags": ["excel", "csv", "substring", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976218, "post_id": 36462127, "comment_id": 60536228, "body": "Loop backwards by characters from the right until you hit the first <code>&#47;</code>?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1459976297, "post_id": 36462127, "comment_id": 60536269, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18617349/excel-last-character-string-match-in-a-string\">Excel: last character/string match in a string</a>"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1459976313, "post_id": 36462127, "comment_id": 60536276, "body": "Check out that other question; it&#39;s pretty comprehensive."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1459976474, "post_id": 36462221, "comment_id": 60536379, "body": "This one is a little shorter: <code>=MID(A1,SEARCH(&quot;}}}&quot;,SUBSTITUTE(A1,&quot;&#47;&quot;,&quot;}}}&quot;,LEN(A1)-LEN(SUB&zwnj;&#8203;STITUTE(A1,&quot;&#47;&quot;,&quot;&quot;)))&zwnj;&#8203;)+1,LEN(A1))</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459976506, "post_id": 36462221, "comment_id": 60536400, "body": "@ScottCraner - Nice! I knew there would probably be a quicker way, thanks for letting me know!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459976561, "post_id": 36462221, "comment_id": 60536428, "body": "Which by the way is nearly exact to the formula in the link by Grad eh bacon"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976586, "post_id": 36462221, "comment_id": 60536443, "body": "Why is it searching for <code>&quot;}}}&quot;</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1459976657, "post_id": 36462221, "comment_id": 60536493, "body": "See the link for a better explanation, but in essence I am replacing the last &quot;/&quot; with &quot;}}}&quot; then searching for it."}, {"owner": {"reputation": 23, "user_id": 4548355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d69651ca2f7d448499307f408ff5470?s=128&d=identicon&r=PG&f=1", "display_name": "katharey", "link": "https://stackoverflow.com/users/4548355/katharey"}, "edited": false, "score": 0, "creation_date": 1459976987, "post_id": 36462221, "comment_id": 60536698, "body": "Thanks so much for the quick response! I&#39;m able to get the original solution you proposed to work. The shorter version is giving me a function error, I&#39;ll have to look into it some more."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23, "user_id": 4548355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d69651ca2f7d448499307f408ff5470?s=128&d=identicon&r=PG&f=1", "display_name": "katharey", "link": "https://stackoverflow.com/users/4548355/katharey"}, "edited": false, "score": 0, "creation_date": 1460037337, "post_id": 36462221, "comment_id": 60566742, "body": "@katharey - if this works for you, do you mind marking as the answer (click the check outline left of my post)?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1459976530, "last_edit_date": 1592644375, "creation_date": 1459976321, "answer_id": 36462221, "question_id": 36462127, "link": "https://stackoverflow.com/questions/36462127/populate-cell-in-excel-wtih-substring-of-another-cell/36462221#36462221", "title": "Populate cell in Excel wtih substring of another cell", "body": "<p>If your text is in A4, put this in another cell:</p>\n<pre><code>=MID(A4,LEN(LEFT(A4,FIND(CHAR(1),SUBSTITUTE(A4,&quot;/&quot;,CHAR(1),LEN(A4)-LEN(SUBSTITUTE(A4,&quot;/&quot;,&quot;&quot;))))))+1,LEN(A4)-LEN(LEFT(A4,FIND(CHAR(1),SUBSTITUTE(A4,&quot;/&quot;,CHAR(1),LEN(A4)-LEN(SUBSTITUTE(A4,&quot;/&quot;,&quot;&quot;))))))+1)\n</code></pre>\n<p>I think that should work. Thanks to <a href=\"https://stackoverflow.com/a/18390137/4650297\">@Jerry</a> for the main part, where it finds the last <code>/</code> in a string.</p>\n<p>edit: Why downvote? It works for me:\n<a href=\"https://i.stack.imgur.com/9XoV8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9XoV8.jpg\" alt=\"enter image description here\" /></a></p>\n<p>edit 2:\nPer @ScottCraner, this is shorter: <code>=MID(A1,SEARCH(&quot;}}}&quot;,SUBSTITUTE(A1,&quot;/&quot;,&quot;}}}&quot;,LEN(A1)-LEN(SUBSTITUTE(A1,&quot;/&quot;,&quot;&quot;))\u200c\u200b))+1,LEN(A1))</code></p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1459977980, "creation_date": 1459977980, "answer_id": 36462667, "question_id": 36462127, "link": "https://stackoverflow.com/questions/36462127/populate-cell-in-excel-wtih-substring-of-another-cell/36462667#36462667", "title": "Populate cell in Excel wtih substring of another cell", "body": "<p>Here's a bit shorter formula to return the last delimited substring in a string.</p>\n\n<pre><code>=TRIM(RIGHT(SUBSTITUTE(A1,\"/\",REPT(\" \",99)),99))\n</code></pre>\n\n<p>Replace the delimiter with 99 spaces, then return the rightmost 99 characters.  The leading characters must be spaces also, so TRIM gets rid of them.</p>\n"}], "owner": {"reputation": 23, "user_id": 4548355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d69651ca2f7d448499307f408ff5470?s=128&d=identicon&r=PG&f=1", "display_name": "katharey", "link": "https://stackoverflow.com/users/4548355/katharey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 36462221, "answer_count": 2, "score": 1, "last_activity_date": 1459977980, "creation_date": 1459976034, "last_edit_date": 1531161705, "question_id": 36462127, "link": "https://stackoverflow.com/questions/36462127/populate-cell-in-excel-wtih-substring-of-another-cell", "title": "Populate cell in Excel wtih substring of another cell", "body": "<p>In Excel, I have a CSV in which column A is populated with category like strings, such as:</p>\n\n<p>ABCDE/FGHI/JKL/MNOPQR </p>\n\n<p>I need to auto populate column C with the value of the substring of everything after the last occurrence of the \"/\". In this example, it would have to be populated with \"MNOPQR\"</p>\n\n<p>Is there a function that could be used for this? \"RIGHT\" doesn't seem to do the trick. I don't know what the length of the substring will be in each row, so I definitely have to be able to look for the \"/\".</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976115, "post_id": 36462097, "comment_id": 60536166, "body": "tl;dr but regarding<code>declare them all as something that other macros can reference</code> set them to the variables you created...<code>wb1</code>, <code>wbFear</code>,<code>wbGender</code>, <code>wbHappy</code>."}, {"owner": {"reputation": 25, "user_id": 6095702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2150d0dc7611e77a4cd3a4ccc1c6517?s=128&d=identicon&r=PG&f=1", "display_name": "Christie Smith", "link": "https://stackoverflow.com/users/6095702/christie-smith"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976245, "post_id": 36462097, "comment_id": 60536239, "body": "I do set the workbooks that are opened as those variables, but they no longer work if I run a different sub."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976275, "post_id": 36462097, "comment_id": 60536257, "body": "Oh. Declare them as <code>public</code>? Edit: that is do so outside of any subs. Usually at the very top above everything else. Edit2: public scope is bad for debugging though. Have you considered passing the books as arguments?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1459976391, "post_id": 36462097, "comment_id": 60536328, "body": "Add a <code>wb As WorkBook</code> parameter to each of ProcessFear, ProcessGender and ProcessHappy.  Within each of those you can refer to <code>wb</code> as the workbook to work with.  At the end of <code>OpenWorkbooks</code> add <code>ProcessFear wbFear</code> etc"}, {"owner": {"reputation": 25, "user_id": 6095702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2150d0dc7611e77a4cd3a4ccc1c6517?s=128&d=identicon&r=PG&f=1", "display_name": "Christie Smith", "link": "https://stackoverflow.com/users/6095702/christie-smith"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976733, "post_id": 36462097, "comment_id": 60536540, "body": "Tim Williams, I am not quite sure what you mean...   @findwindow I haven&#39;t considered that... Would I still be able to have ProcessFear/Gender/Happy be different subs, with code separate from OpenWorkbooks?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976825, "post_id": 36462097, "comment_id": 60536603, "body": "@ChristieSmith Tim is saying the same thing I am but yes to your question. Also, you want Tim, not me ^_^;"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459979288, "post_id": 36462097, "comment_id": 60537814, "body": "I&#39;d have &quot;RunAll&quot; show a UserForm with 4 buttons each launching one of those subs (OpenWorkbooks, ProcessFear, ProcessGender, ProcessHappy) and have the first one write workbooks names in userform hidden (visible=false) labels so that any sub could access them  and set a proper workbook variable from."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1539753904, "post_id": 36462097, "comment_id": 92611368, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/14766238/608639\">Run same excel macro on multiple excel files</a>"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": true, "score": 0, "last_activity_date": 1459986454, "creation_date": 1459986454, "answer_id": 36464253, "question_id": 36462097, "link": "https://stackoverflow.com/questions/36462097/working-with-multiple-workbooks-and-macros-calling-workbooks-vba/36464253#36464253", "title": "Working with multiple workbooks and Macros - Calling workbooks? [VBA]", "body": "<p>There are better, more elegant solutions. But this is the simplest and also the easiest for you to implement. Declare 3 global object variables to hold the workbook references. Open the workbooks and assign to these variables in <code>OpenWorkbooks</code>. Use them as needed. Close them and set them to <code>Nothing</code> in a new procedure <code>CloseWorkbooks</code>. (<code>Call</code> is not needed in this context)</p>\n\n<pre><code>Public gwbFear as WorkBook\nPublic gwbGender as WorkBook\nPublic gwbHappy as WorkBook\n\nSub RunAll()\n    OpenWorkbooks\n    ProcessFear\n    ProcessGender\n    ProcessHappy\n    CloseWorkbooks\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6095702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2150d0dc7611e77a4cd3a4ccc1c6517?s=128&d=identicon&r=PG&f=1", "display_name": "Christie Smith", "link": "https://stackoverflow.com/users/6095702/christie-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7581, "favorite_count": 1, "accepted_answer_id": 36464253, "answer_count": 1, "score": 0, "last_activity_date": 1459986454, "creation_date": 1459975885, "last_edit_date": 1459976120, "question_id": 36462097, "link": "https://stackoverflow.com/questions/36462097/working-with-multiple-workbooks-and-macros-calling-workbooks-vba", "title": "Working with multiple workbooks and Macros - Calling workbooks? [VBA]", "body": "<p>I've got probably what is a simple question but I can't figure out what's going wrong. I'm trying to create one big Macro in excel that will do multiple things to multiple files. The context:</p>\n\n<p>The excel sheet I am running the Macro from is in its own folder. I've set up a little testing folder with this structure:\nC:\\Users\\schris\\Desktop\\Eprime Testing\\</p>\n\n<ul>\n<li><p>This folder has two folders in it:</p>\n\n<ul>\n<li><p>\\Master Dataset\\</p>\n\n<ul>\n<li>In this folder is where the excel file with the macro is</li>\n</ul></li>\n<li><p>\\Eprime Processing\\</p>\n\n<ul>\n<li>There are three folders in this folder, named 'Fear', 'Gender', and 'Happy'. In each of those folders is an excel file that I wish to open.</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>What I wanted to do was create a Sub RunAll that would call various other subs because there are many different things I want the Macro to do, and I wanted to keep it organized.</p>\n\n<p>So:</p>\n\n<pre><code>Sub RunAll()\nCall OpenWorkbooks\nCall ProcessFear\nCall ProcessGender\nCall ProcessHappy\n\nEnd Sub\n</code></pre>\n\n<p>Here is my OpenWorkbooks code:</p>\n\n<pre><code>Sub OpenWorkbooks()\nDim wb1 As Workbook\nDim wbFear As Workbook\nDim wbGender As Workbook\nDim wbHappy As Workbook\nDim FileToOpen As Variant\nDim FileToOpen2 As Variant\nDim FileToOpen3 As Variant\nDim Sheet As Worksheet\n\n' Must be workbook with the Macros I'm running\nSet wb1 = ActiveWorkbook\n\n' Opens Fear\nChDir \"C:\\Users\\schris\\Desktop\\Eprime Testing\\Eprime Processing\\Fear\"\n\nFileToOpen = Application.GetOpenFilename _\n(Title:=\"Please choose Fear file\")\n\nIf FileToOpen = False Then\n    MsgBox \"No File Specified.\", vbExclamation, \"ERROR\"\n    Exit Sub\nElse\n    Set wbFear = Workbooks.Open(fileName:=FileToOpen)\nEnd If\n\nSet wbFear = ActiveWorkbook\n\n' Opens Gender\nChDir \"C:\\Users\\schris\\Desktop\\Eprime Testing\\Eprime Processing\\Gender\"\n\nFileToOpen2 = Application.GetOpenFilename _\n(Title:=\"Please choose Gender file\")\n\nIf FileToOpen2 = False Then\n    MsgBox \"No File Specified.\", vbExclamation, \"ERROR\"\n    Exit Sub\nElse\n    Set wbGender = Workbooks.Open(fileName:=FileToOpen2)\nEnd If\n\nSet wbGender = ActiveWorkbook\n\n' Opens Happy\nChDir \"C:\\Users\\schris\\Desktop\\Eprime Testing\\Eprime Processing\\Happy\"\n\nFileToOpen3 = Application.GetOpenFilename _\n(Title:=\"Please choose Happy file\")\n\nIf FileToOpen3 = False Then\n    MsgBox \"No File Specified.\", vbExclamation, \"ERROR\"\n    Exit Sub\nElse\n    Set wbHappy = Workbooks.Open(fileName:=FileToOpen3)\nEnd If\n\nSet wbHappy = ActiveWorkbook\nEnd Sub\n</code></pre>\n\n<p>Now I want to be able to reference these three workbooks (wbFear, wbGender, wbHappy) and move seamlessly between them. When testing in Sub OpenWorkbooks(), doing <code>wbFear.Activate</code> would work and process correctly... But when I separated out the tasks of each macro (i.e., OpenWorkbooks now only opens the workbooks, ProcessFear only processes the data in the Fear workbook), I get a Run-time error '91': Object variable or With block variable not set.</p>\n\n<p>I'm assuming this has something to do with the declared workbook names being 'lost' as it switches Subs, but when I put the code from OpenWorkbooks into RunAll and only had ProcessFear run, it still couldn't activate the proper workbooks.</p>\n\n<p>Basically, my question is this:</p>\n\n<p>How can I have one Macro open three workbooks, and declare them all as something that other macros can reference? There are many tasks I need to do, so I really want to have separate Subs for each one, that way I don't get lost in the code.</p>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459975977, "post_id": 36462063, "comment_id": 60536082, "body": "<code>LastRow</code> is from <code>Report 1</code>, you should have <code>W = &quot;Chicago&quot;</code> before <code>Y = W</code>, <code>If Y = Z.Value</code> only tests for <b>entire</b> cell, not partials..."}, {"owner": {"reputation": 1, "user_id": 5982988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc336942bc1e8ac7f18ad1e0403a039a?s=128&d=identicon&r=PG", "display_name": "bbran", "link": "https://stackoverflow.com/users/5982988/bbran"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976530, "post_id": 36462063, "comment_id": 60536417, "body": "Thanks findwindow. I made the edits but it&#39;s still not copying and pasting the desired rows for some reason. Any additional help is much appreciated"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976652, "post_id": 36462063, "comment_id": 60536488, "body": "Uh, that was just some I noticed immediately. With those mistakes, there are bound to be more. Also, what exactly did you change <code>If Y = Z.Value Then</code> to? I doubt you used <code>instr</code>.... Edit: and you have y and z backwards...."}, {"owner": {"reputation": 1, "user_id": 5982988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc336942bc1e8ac7f18ad1e0403a039a?s=128&d=identicon&r=PG", "display_name": "bbran", "link": "https://stackoverflow.com/users/5982988/bbran"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976871, "post_id": 36462063, "comment_id": 60536629, "body": "I didn&#39;t change <b>If Y = Z.Value Then</b> to anything. and I didnt use instr. I had written a previous program following this format very similarly and it worked"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459976900, "post_id": 36462063, "comment_id": 60536646, "body": "You need to change <code>If Y = Z.Value Then</code>."}, {"owner": {"reputation": 1, "user_id": 5982988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc336942bc1e8ac7f18ad1e0403a039a?s=128&d=identicon&r=PG", "display_name": "bbran", "link": "https://stackoverflow.com/users/5982988/bbran"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459977176, "post_id": 36462063, "comment_id": 60536818, "body": "alright, why is that?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459979454, "post_id": 36462063, "comment_id": 60537861, "body": "You have <code>Y=W</code> followed by <code>W=&quot;Chicago&quot;</code>. Is <code>W</code> set somewhere else? As it reads now, <code>Y</code> will be an empty string."}, {"owner": {"reputation": 1, "user_id": 5982988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc336942bc1e8ac7f18ad1e0403a039a?s=128&d=identicon&r=PG", "display_name": "bbran", "link": "https://stackoverflow.com/users/5982988/bbran"}, "edited": false, "score": 0, "creation_date": 1459992678, "post_id": 36462063, "comment_id": 60541756, "body": "Ah ok so I should just set Y = &quot;Chicago&quot; then?"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1459994555, "post_id": 36462063, "comment_id": 60542276, "body": "Yes, also delete <code>W = &quot;Chicago&quot;</code> because You don&#39;t even use W in the code, unless it is a global variable defined somewhere else."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1460011674, "post_id": 36462063, "comment_id": 60548205, "body": "Do you want to copy only the specific cell content ? if J column matches Chicago"}, {"owner": {"reputation": 1, "user_id": 5982988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc336942bc1e8ac7f18ad1e0403a039a?s=128&d=identicon&r=PG", "display_name": "bbran", "link": "https://stackoverflow.com/users/5982988/bbran"}, "edited": false, "score": 0, "creation_date": 1460036918, "post_id": 36462063, "comment_id": 60566388, "body": "Yes, if the city listed in column J matches &quot;Chicago&quot;, then I want to copy the row and paste it into a new sheet"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460137552, "post_id": 36462063, "comment_id": 60618973, "body": "did you try my proposal?"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460028170, "creation_date": 1460028170, "answer_id": 36474723, "question_id": 36462063, "link": "https://stackoverflow.com/questions/36462063/code-wont-copy-and-paste-specific-cells-into-new-sheet-vba/36474723#36474723", "title": "Code Won&#39;t Copy and Paste Specific Cells Into New Sheet VBA", "body": "<p>no need for any helper (\"Report2\") sheet</p>\n\n<p>you could filter the relevant part of data cells and copy selected cells directly to \"Clean\" sheet as follows</p>\n\n<pre><code>Option Explicit\n\nSub BranchCount()\n\nDim s1 As Worksheet, sC As Worksheet\nDim LastRow As Long\n\nSet s1 = Worksheets(\"Report 1\")\nSet sC = Sheets(\"Clean\")\n\nWith s1\n    LastRow = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    With .Range(\"A1:J\" &amp; LastRow)\n        .AutoFilter field:=10, Criteria1:=\"Chicago\"\n        With .Offset(1).Resize(.Rows.Count - 1)\n            If Application.WorksheetFunction.Subtotal(103, .Columns(\"J\")) &gt; 1 Then .SpecialCells(xlCellTypeVisible).Copy Destination:=sC.Range(\"A700\").End(xlUp).Offset(1, 0)\n        End With\n        .AutoFilter\n    End With\nEnd With\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5982988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc336942bc1e8ac7f18ad1e0403a039a?s=128&d=identicon&r=PG", "display_name": "bbran", "link": "https://stackoverflow.com/users/5982988/bbran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460028170, "creation_date": 1459975785, "question_id": 36462063, "link": "https://stackoverflow.com/questions/36462063/code-wont-copy-and-paste-specific-cells-into-new-sheet-vba", "title": "Code Won&#39;t Copy and Paste Specific Cells Into New Sheet VBA", "body": "<p>I am using this code to check each row in worksheet \"Report2\" for the phrase \"Chicago\" and copy and paste any rows with \"Chicago\" in them into a new sheet. However, it is not working. Any help on why would be appreciated. </p>\n\n<p>Code: </p>\n\n<pre><code>Sub BranchCount()\n\nDim s As Worksheet\nDim LastRow As Long\n\nSet s = Worksheets(\"Report 1\")\nLastRow = s.UsedRange.SpecialCells(xlCellTypeLastCell).Row\n\nWorksheets(\"Report 1\").Select\nRange(\"A1:J\" &amp; LastRow).Select\nSelection.Copy\n\nSheets.Add.Name = \"Report2\"\nSelection.PasteSpecial xlPasteValues\nRange(\"A1\").EntireRow.Delete\nRange(\"B1\").EntireRow.Delete\nRange(\"C1\").EntireRow.Delete\n\nDim Z As Range\nDim Y As String\n\nY = W\nW = \"Chicago\"\n\nSheets(\"Report2\").Range(\"A1\").Select\n\nFor Each Z In Range(\"J1:J\" &amp; LastRow)\n    If Y = Z.Value Then\n        Z.EntireRow.Copy\n            Sheets(\"Clean\").Select\n                Range(\"A700\").End(xlUp).Offset(1, 0).Select\n                Selection.PasteSpecial xlPasteValues\n            Sheets(\"Report2\").Select\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if you can help. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459975650, "post_id": 36461960, "comment_id": 60535854, "body": "Guessing <code>swaFormula</code> is bad. You&#39;re using <code>activeworkbook&#47;sheet&#47;cell</code> so are you sure the object you want is active?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1459980147, "last_edit_date": 1495540241, "creation_date": 1459980147, "answer_id": 36463142, "question_id": 36461960, "link": "https://stackoverflow.com/questions/36461960/runtime-formula-error-1004-swaformula/36463142#36463142", "title": "Runtime formula error 1004 swaformula", "body": "<p>You are relying on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193314.aspx\" rel=\"nofollow noreferrer\">ActiveCell property</a>. There are better ways\u00b9 to reference cells than that but if those 'best practises can be disregarded for a minute, the ActiveCell knows what its <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980(v=office.11).aspx\" rel=\"nofollow noreferrer\">.Parent</a> worksheet and workbook are. </p>\n\n<p>Additionally, with no actual worksheet names provided, there is no guarantee that the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx\" rel=\"nofollow noreferrer\">ActiveSheet</a>'s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a> does not contain a space and may require ticks (e.g. <code>'</code>) to wrap it. Either those should be added as a matter of course or the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">Range.Address property</a> should be used to generate the strings for the cell range(s).</p>\n\n<p>The non-volatile <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX function</a> could concevably replace the volatile\u00b2 <a href=\"https://support.office.com/en-us/article/OFFSET-function-b3958b36-c30b-4fc3-979e-9b9bbfdcf592\" rel=\"nofollow noreferrer\">OFFSET function</a> but I don't know enough about the layout of your data to suggest an infallible substitute formula.</p>\n\n<pre><code>Dim swaFormula As String, rngName As String\nDim swaRow As Long, swaCol As Long\n\nrngName = \"pivotSourceOrderBase\"\nswaRow = 0: swaCol = 0\n\nWith ActiveCell\n    swaFormula = \"=OFFSET(\" &amp; _\n                    .Cells(1).Address(external:=True, ReferenceStyle:=xlR1C1) &amp; _\n                    \", 0, 0, COUNTA(\" &amp; _\n                    .Cells(1).EntireColumn.Address(external:=True, ReferenceStyle:=xlR1C1) &amp; _\n                    \")-\" &amp; swaRow &amp; \", COUNTA(\" &amp; _\n                    .Cells(1).EntireRow.Address(external:=True, ReferenceStyle:=xlR1C1) &amp; _\n                    \")-\" &amp; swaCol &amp; \")\"\n    Debug.Print swaFormula  '&lt;~~ check the formula in the Immediate window\n    On Error Resume Next    'may be needed for the next line\n    .Parent.Parent.Names(rngName).Delete\n    On Error GoTo 0\n    .Parent.Names.Add Name:=rngName, RefersToR1C1:=swaFormula\nEnd With\n</code></pre>\n\n<p>Walk through this and check the formula in the VBE's <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278736.aspx\" rel=\"nofollow noreferrer\">Immediate window</a> before attempting to apply it to the named range creation.</p>\n\n<hr>\n\n<p>\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n\n<p>\u00b2 <sub>Volatile functions recalculate whenever anything in the entire workbook changes, not just when something that affects their outcome changes. Examples of <strong>volatile</strong> functions are <a href=\"https://support.office.com/en-us/article/indirect-function-21f8bcfc-b174-4a50-9dc6-4dfb5b3361cd\" rel=\"nofollow noreferrer\">INDIRECT</a>, <a href=\"https://support.office.com/en-us/article/OFFSET-function-b3958b36-c30b-4fc3-979e-9b9bbfdcf592\" rel=\"nofollow noreferrer\">OFFSET</a>, <a href=\"https://support.office.com/en-us/article/TODAY-function-62B76639-BA50-4F86-AD4E-1A74FB2EA566\" rel=\"nofollow noreferrer\">TODAY</a>, <a href=\"https://support.office.com/en-us/article/NOW-function-3337FD29-145A-4347-B2E6-20C904739C46\" rel=\"nofollow noreferrer\">NOW</a>, <a href=\"https://support.office.com/en-us/article/RAND-function-4CBFA695-8869-4788-8D90-021EA9F5BE73\" rel=\"nofollow noreferrer\">RAND</a> and <a href=\"https://support.office.com/en-us/article/RANDBETWEEN-function-4CC7F0D1-87DC-4EB7-987F-A469AB381685\" rel=\"nofollow noreferrer\">RANDBETWEEN</a>. Some sub-functions of the <a href=\"https://support.office.com/en-us/article/CELL-function-51BD39A5-F338-4DBE-A33F-955D67C2B2CF\" rel=\"nofollow noreferrer\">CELL</a> and <a href=\"https://support.office.com/en-us/article/INFO-function-725f259a-0e4b-49b3-8b52-58815c69acae\" rel=\"nofollow noreferrer\">INFO</a> worksheet functions will make them volatile as well.</sub></p>\n"}], "owner": {"reputation": 31, "user_id": 6168979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ccb46c155e358d0f5edc85468a08e9?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa", "link": "https://stackoverflow.com/users/6168979/rafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1459980147, "creation_date": 1459975419, "last_edit_date": 1531161705, "question_id": 36461960, "link": "https://stackoverflow.com/questions/36461960/runtime-formula-error-1004-swaformula", "title": "Runtime formula error 1004 swaformula", "body": "<p>I am getting a formula error message: Run-time error 1004, for the second recurrence of a formula in the code; the code section in question as follows, for quick reference I pasted the two formulas just below, the first one runs OK, the second one gives the error that I cannot figure out.</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"pivotsourceFGPO\", RefersToR1C1:=swaFormula (no errors when running the macro)\n\n ActiveWorkbook.Names.Add Name:=\"pivotsourceorderbase\", RefersToR1C1:=swaFormula (FORMULA giving error)\n</code></pre>\n\n<p>Code: (partial)</p>\n\n<pre><code>swaFormula = \"=OFFSET(\" &amp; _\nActiveWorkbook.Worksheets(ActiveSheet.Index).Name &amp; \"!R\" &amp; ActiveCell.Row &amp; \"C\" &amp; ActiveCell.Column &amp; \",0,0,COUNTA(\" &amp; _\nActiveWorkbook.Worksheets(ActiveSheet.Index).Name &amp; \"!C\" &amp; ActiveCell.Column &amp; \") -\" &amp; swarow &amp; \",COUNTA(\" &amp; _\nActiveWorkbook.Worksheets(ActiveSheet.Index).Name &amp; \"!R\" &amp; ActiveCell.Row &amp; \")-\" &amp; swacol &amp; \")\"\n\nActiveWorkbook.Names.Add Name:=\"pivotsourceFGPO\", RefersToR1C1:=swaFormula\nDim PTCache As PivotCache\nDim pt As PivotTable\nDim WS As Worksheet\nDim pvtfld As PivotField\n\n' define the range which serves as the data range\n\nSet WS = Sheets.Add ' add new sheet to hold the pivot table\nSet PTCache = ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase,  SourceData:=\"=pivotsourceFGPO\")\n\n' Create the pivot table\nSet pt = PTCache.CreatePivotTable(TableDestination:=WS.Range(\"A1\"), TableName:=\"FGPOPivot\")\n\nActiveWorkbook.ShowPivotTableFieldList = True\n\npt.PivotFields(\"Key\").Orientation = xlRowField\npt.PivotFields(\"Key\").Position = 1\npt.PivotFields(\"MTL\").Orientation = xlRowField\npt.PivotFields(\"MTL\").Position = 2\npt.PivotFields(\"Size Code\").Orientation = xlRowField\npt.PivotFields(\"Size Code\").Position = 3\npt.PivotFields(\"Week\").Orientation = xlColumnField\npt.PivotFields(\"Week\").Position = 1\npt.AddDataField pt.PivotFields(\"Wip Qty\"), \"Sum of Wip Qty\", xlSum\n\n'Order base 1 pivot\nSheets(\"Order base (1)\").Select\nRange(\"A1\").Select\nswarow = ActiveCell.Row - 1\nswacol = ActiveCell.Column - 1\n\n' make it comma and not colon\nswaFormula = \"=OFFSET(\" &amp; _\nActiveWorkbook.Worksheets(ActiveSheet.Index).Name &amp; \"!R\" &amp; ActiveCell.Row &amp; \"C\" &amp; ActiveCell.Column &amp; \",0,0,COUNTA(\" &amp; _\n\nActiveWorkbook.Worksheets(ActiveSheet.Index).Name &amp; \"!C\" &amp; ActiveCell.Column &amp; \") -\" &amp; swarow &amp; \",COUNTA(\" &amp; _\nActiveWorkbook.Worksheets(ActiveSheet.Index).Name &amp; \"!R\" &amp; ActiveCell.Row &amp; \")-\" &amp; swacol &amp; \")\"\n\nActiveWorkbook.Names.Add Name:=\"pivotsourceorderbase\", RefersToR1C1:=swaFormula (FORMULA giving error)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459975112, "post_id": 36461850, "comment_id": 60535531, "body": "Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "is_accepted": false, "score": 0, "last_activity_date": 1459976328, "creation_date": 1459976328, "answer_id": 36462224, "question_id": 36461850, "link": "https://stackoverflow.com/questions/36461850/concatenating-in-vba-within-excel/36462224#36462224", "title": "Concatenating in VBA within Excel", "body": "<p>If you had 3 strings in A1, B1 and C1, you could get the concatenated string in D1 by putting in the formula `=CONCATENATE(A1,B1,C1)' in the cell D1. If you want to do it in VBA, </p>\n\n<pre><code>Public Sub MyConcatenation()\n    With ThisWorkbook.Worksheets(1)\n        .Cells(1, 4).Value = .Cells(1, 1).Value &amp; .Cells(1, 2).Value &amp; .Cells(1, 3).Value\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>If you won't take offense:</strong> You need to pick up an introductory book or website to learn VBA (it is not VB or VB.Net). It will be a long, uphill struggle to learn it through asking questions on forums.</p>\n"}], "owner": {"reputation": 1, "user_id": 6168888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d6fb85cf54e75c0fb800cf0d59abd38?s=128&d=identicon&r=PG&f=1", "display_name": "K Jay", "link": "https://stackoverflow.com/users/6168888/k-jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459976328, "creation_date": 1459975044, "question_id": 36461850, "link": "https://stackoverflow.com/questions/36461850/concatenating-in-vba-within-excel", "title": "Concatenating in VBA within Excel", "body": "<p>I am trying to accomplish something apparently simple but not for me. I\u2019m new to all this and I would like to see if I can get any far with this first project. Basically I have, say 3 text boxes with a string in it (name) and a button next to them.  Then there is another text box which will hold all 3 names so that I could copy as one string into clipboard. Many tutorials out there refer to concatenating the strings however I\u2019m still unable to find a decent answer. To be fully honest I am trying to achieve this task in VBA from within Excel 2010. So, my 3 names are actually in 3 different cells\u2026 Next to each of them I have a button with a macro attached (but vb will also be good for me) that will add the name into another cell. The buttons works ok but my problem is that I can\u2019t get them to concatenate in Excel. Every button just overwrites what\u2019s was there before. Any help? Suggestion? Tips? Mind you I can only be able to follow if the answer is simple and well explained as I am new to all of this. Thank you.</p>\n"}, {"tags": ["vba", "if-statement", "outlook", "contacts"], "answers": [{"tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1459995469, "last_edit_date": 1459995469, "creation_date": 1459993722, "answer_id": 36465298, "question_id": 36461803, "link": "https://stackoverflow.com/questions/36461803/outlook-vba-ignores-original-if-argument-when-else-argument-is-added/36465298#36465298", "title": "Outlook VBA ignores original If argument when Else argument is added", "body": "<p>You can't place the following part of the code inside for each loop:</p>\n\n<pre><code>Else\n    If MsgBox(\"Contact does not exist. Would you like to add one?\", vbYesNo, \"Confirm\") = vbYes Then\n        End\n    Else\n        End\n    End If\nEnd If\n</code></pre>\n\n<p>Let's assume you have 100 contacts and want to find one named \"Charlie\". The part of the code above gives the message box, saying that the contact does not exist after checking only 1 out of 100 contacts.</p>\n\n<p>You have to place the message box outside of the loop. You can use boolean to check if \"Charlie\" contact was found:</p>\n\n<pre><code>Dim contactFound as boolean\nFor Each Contact In ContactsFolder.Items\n   If Contact.FullName = SearchContactName Then\n      contactFound = true\n</code></pre>\n\n<p>Then just after the loop:</p>\n\n<pre><code>  If contactFound = false then\n      If MsgBox(\"Contact does not exist. Would you like to add one?\", vbYesNo, \"Confirm\") = vbYes Then\n         End\n      Else\n         End\n      End If\n  End if\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3513789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6b9605f0bc06115e950297d6f8aef5?s=128&d=identicon&r=PG&f=1", "display_name": "acheronff3", "link": "https://stackoverflow.com/users/3513789/acheronff3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 36465298, "answer_count": 1, "score": 0, "last_activity_date": 1459995469, "creation_date": 1459974884, "question_id": 36461803, "link": "https://stackoverflow.com/questions/36461803/outlook-vba-ignores-original-if-argument-when-else-argument-is-added", "title": "Outlook VBA ignores original If argument when Else argument is added", "body": "<p>Here is the original code that is working as intended:</p>\n\n<pre><code>Dim ContactsFolder As Folder\nSet ContactsFolder = Session.GetDefaultFolder(olFolderContacts)\nDim SearchContactName As String\nSet myItem = Outlook.CreateItem(olMailItem)\nDim NewContactEmail As String\nDim NewMail As Outlook.MailItem\nSet NewMail = Application.ActiveInspector.currentItem\n\n' Ask user for inputs\nSearchContactName = InputBox(\"What is the name of your contact you want to comment to on Trello?\")\n\nDim Contact As ContactItem\n\n'search contacts'\nFor Each Contact In ContactsFolder.Items\n    If Contact.FullName = SearchContactName Then\n        If Contact.IMAddress = \"\" Then 'add trello card link'\n            Contact.IMAddress = InputBox(\"What is the Trello card e-mail of this contact?\")\n            Contact.Save\n            myItem.To = Contact.IMAddress\n        Else\n            myItem.To = Contact.IMAddress\n        End If\n    End If\nNext\n\nmyItem.Body = NewMail.Body\nmyItem.Subject = NewMail.Subject\n\nmyItem.Display\n</code></pre>\n\n<p>My intention for this is that when it finds a contact, it will see if it has anything in the IMaddress. If it does have a link, then that will go into the \"To:\" of the e-mail. If it doesn't, outlook will prompt the user for a link, save the contact information and add the link to the \"To:\" of the e-mail. Like I said before, this code works as intended for any contacts that are in outlook, with or without a IMaddress. </p>\n\n<p>The trouble I run into is when there is no contact information saved. Here is the code as stripped down as I could replicate the error:</p>\n\n<pre><code>Sub LeaveAComment()\nDim ContactsFolder As Folder\nSet ContactsFolder = Session.GetDefaultFolder(olFolderContacts)\nDim SearchContactName As String\nSet myItem = Outlook.CreateItem(olMailItem)\nDim NewContactEmail As String\nDim NewMail As Outlook.MailItem\nSet NewMail = Application.ActiveInspector.currentItem\n\n' Ask user for inputs\nSearchContactName = InputBox(\"What is the name of your contact you want to comment to on Trello?\")\n\nDim Contact As ContactItem\n\n'search contacts'\nFor Each Contact In ContactsFolder.Items\n    If Contact.FullName = SearchContactName Then\n        If Contact.IMAddress = \"\" Then 'add trello card link'\n            Contact.IMAddress = InputBox(\"What is the Trello card e-mail of this contact?\")\n            Contact.Save\n            myItem.To = Contact.IMAddress\n        Else\n            myItem.To = Contact.IMAddress\n        End If\n    Else\n        If MsgBox(\"Contact does not exist. Would you like to add one?\", vbYesNo, \"Confirm\") = vbYes Then\n            End\n        Else\n            End\n        End If\n    End If\nNext\n\nmyItem.Body = NewMail.Body\nmyItem.Subject = NewMail.Subject\n\nmyItem.Display\n</code></pre>\n\n<p>It is when I add the </p>\n\n<pre><code>Else\n        If MsgBox(\"Contact does not exist. Would you like to add one?\", vbYesNo, \"Confirm\") = vbYes Then\n            End\n        Else\n            End\n        End If\nEnd If\n</code></pre>\n\n<p>that I run into problems. Now when I run the macro, the msgbox will trigger no matter if the Contact already exists or not. For some reason the original If Contact.FullName  = SearchContactName is being overridden by the Else, even though the Else shouldn't be triggered (at least in my thought process). I've tried reversing the logic and doing:</p>\n\n<pre><code>For Each Contact In ContactsFolder.Items\n    If Contact.FullName &lt;&gt; SearchContactName Then\n</code></pre>\n\n<p>But that brought out the same outcome. </p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 379, "user_id": 6134241, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7145cec770657cc6c03eb2b91f5f6798?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/6134241/ihidan"}, "is_accepted": false, "score": 0, "last_activity_date": 1459971127, "creation_date": 1459971127, "answer_id": 36460692, "question_id": 36460509, "link": "https://stackoverflow.com/questions/36460509/open-a-downloaded-file-in-excel-vba/36460692#36460692", "title": "Open a downloaded file in Excel VBA", "body": "<p>So after some research instead of trying to opening the file directly from the memory I just saved it on the user's default temp path and then opened it. Here is the code:</p>\n\n<pre><code>Sub Download()\n    Const MYURL = \"https://www.arembepe.net/temp/COMDINHEIRO_gabrielzancheta749999241.xlsx\"\n    Set objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    objHTTP.Open \"GET\", MYURL, False\n\n    objHTTP.Send\n\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write objHTTP.ResponseBody\n    oStream.SaveToFile (Environ(\"TEMP\") &amp; \".xlsx\")\n    oStream.Close\n\n    Workbooks.Open Environ(\"TEMP\") &amp; \".xlsx\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1459971458, "creation_date": 1459971458, "answer_id": 36460818, "question_id": 36460509, "link": "https://stackoverflow.com/questions/36460509/open-a-downloaded-file-in-excel-vba/36460818#36460818", "title": "Open a downloaded file in Excel VBA", "body": "<pre><code>Set wb = WorkBooks.open( _\n  \"https://www.arembepe.net/temp/COMDINHEIRO_gabrielzancheta749999241.xlsx\")\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6134241, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7145cec770657cc6c03eb2b91f5f6798?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/6134241/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2597, "favorite_count": 1, "accepted_answer_id": 36460818, "answer_count": 2, "score": 1, "last_activity_date": 1459971458, "creation_date": 1459970500, "last_edit_date": 1531164843, "question_id": 36460509, "link": "https://stackoverflow.com/questions/36460509/open-a-downloaded-file-in-excel-vba", "title": "Open a downloaded file in Excel VBA", "body": "<p>I am using the following code to download a .xlsx file from web on Excel VBA.    </p>\n\n<pre><code>Sub Download()\n        Const MYURL = \"https://www.arembepe.net/temp/COMDINHEIRO_gabrielzancheta749999241.xlsx\"\n        Set objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n        objHTTP.Open \"GET\", MYURL, False\n\n\n    objHTTP.Send\n\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write objHTTP.ResponseBody\n    oStream.SaveToFile (\"C:\\wamp\\file.xlsx\")\n    oStream.Close\nEnd Sub\n</code></pre>\n\n<p>The code succeeds to download the file and saves it in the directory. But instead of saving it I wish I could open the xlsx file on Excel. Is it possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459973736, "post_id": 36459111, "comment_id": 60534744, "body": "Have you considered abandoning the &#39;buttons&#39; (aka shapes) and simply use a double-click on a colored cell in column E to activate the image display? Your need to dynamically produce and rename/recolor shapes would be a whole lot easier."}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1459972124, "creation_date": 1459972124, "answer_id": 36461010, "question_id": 36459111, "link": "https://stackoverflow.com/questions/36459111/click-shape-or-button-preview-close-that-displays-an-image/36461010#36461010", "title": "click shape or button (preview/close) that displays an image", "body": "<p>While your original code was actually working, I made a few slight adjustments to ensure that all (multiple) pictures are included / shown on the sheet and to align these picture below each other. Have a look at the comments in the code and let me know what you think:</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\nDim lngRow As Long\nDim strPath As String\nDim picItem As Picture\nDim shtPatient As Worksheet\n\n'If there are multiple pictures then they should be shown\n'  underneath each other. dblLeft and dblTop will be used\n'  to place the next picture underneath the last one.\nDim dblTop As Double\nDim dblLeft As Double\n\nSet shtPatient = ThisWorkbook.Worksheets(1)\nstrPath = \"F:\\CAD_CAM division\\Unsorted Models\\\"\n\nWith shtPatient.Shapes(\"Rounded Rectangle 1\").TextFrame2.TextRange.Characters\n    If .Text = \"Close\" Then\n        .Text = \"Preview\"\n        ActiveSheet.Pictures.Delete\n    Else\n        .Text = \"Close\"\n        For lngRow = 2 To shtPatient.Cells(shtPatient.Rows.Count, \"A\").End(xlUp).Row\n            'First check if the file actually exists / can be found and inserted\n            If Dir(strPath &amp; shtPatient.Cells(lngRow, 1).Value2 &amp; \".jpg\") &lt;&gt; \"\" Then\n                Set picItem = shtPatient.Pictures.Insert(strPath &amp; shtPatient.Cells(lngRow, 1).Value2 &amp; \".jpg\")\n                'Name the picture so it can be found afterwards again using VBA\n                picItem.Name = shtPatient.Cells(lngRow, 1).Value2 &amp; \".jpg\"\n                If lngRow = 2 Then\n                    picItem.Top = shtPatient.Range(\"F2\").Top\n                    picItem.Left = shtPatient.Range(\"F2\").Left\n                    dblTop = picItem.Top + picItem.Height + 10\n                    dblLeft = picItem.Left\n                Else\n                    picItem.Top = dblTop\n                    picItem.Left = dblLeft\n                    dblTop = picItem.Top + picItem.Height + 10\n                End If\n            End If\n        Next lngRow\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6168307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef3a77703a1231ad76f91548dbb8c79?s=128&d=identicon&r=PG", "display_name": "A Rossi", "link": "https://stackoverflow.com/users/6168307/a-rossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 867, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459972124, "creation_date": 1459966338, "last_edit_date": 1459966534, "question_id": 36459111, "link": "https://stackoverflow.com/questions/36459111/click-shape-or-button-preview-close-that-displays-an-image", "title": "click shape or button (preview/close) that displays an image", "body": "<p>I am new to VBA and seeking help on a work project.  I have done some research and got started but am now over my head. </p>\n\n<p>My objectives are:\nCreate a click shape or button (preview/close) that displays an image from another location on computer.</p>\n\n<p>The image displayed will be dependent on the data input (col A: patient name; same name of jpeg image) for each name that is entered in the same row.</p>\n\n<p>Also I would like a new button/shape to be automatically created in the corresponding cell when a new name is added</p>\n\n<p>Thanks  Rick</p>\n\n<p><a href=\"https://i.stack.imgur.com/HYYHk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HYYHk.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Macro1()\n\nDim Path As String\n\n\nSet myDocument = Worksheets(1)\n\n\n\nPath = \"F:\\CAD_CAM division\\Unsorted Models\\\"\n\n myDocument.Pictures.Insert (Path &amp; ActiveCell.Value &amp; \".jpg\")\n\n\n    With ActiveSheet.Shapes(\"Rounded Rectangle 1\").TextFrame2.TextRange.Characters\n\n        If .Text = \"Close\" Then\n\n            .Text = \"Preview\"\n\n            ActiveSheet.Pictures.Delete\n        Else\n\n            .Text = \"Close\"\n\n            With ActiveSheet.Shapes(\"Rounded Rectangle 1\")\n\n\n\n            End With\n\n        End If\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 5021044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eedd7eb616d3d9374ca6012c1e5e250?s=128&d=identicon&r=PG&f=1", "display_name": "JPlatts", "link": "https://stackoverflow.com/users/5021044/jplatts"}, "is_accepted": false, "score": 2, "last_activity_date": 1459971127, "last_edit_date": 1495540442, "creation_date": 1459971127, "answer_id": 36460693, "question_id": 36458778, "link": "https://stackoverflow.com/questions/36458778/solving-systems-of-equations-in-excel/36460693#36460693", "title": "Solving Systems of Equations in Excel", "body": "<p>Write a vba function that takes in the values of X1, X2, \u03c31, and \u03c32 and returns both B and Theta.</p>\n\n<p>Here is how to write a function.\n<a href=\"http://www.excel-easy.com/vba/examples/user-defined-function.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba/examples/user-defined-function.html</a></p>\n\n<p>Here is how to return multiple values from one function.\n<a href=\"https://stackoverflow.com/questions/5339807/return-multiple-values-from-a-function-sub-or-type\">Return multiple values from a function, sub or type?</a></p>\n\n<p>You won't be able to call a function directly from the worksheet that edits 2 cells.\n<a href=\"https://superuser.com/questions/818141/excel-possible-to-fill-two-cells-with-one-if-formula\">https://superuser.com/questions/818141/excel-possible-to-fill-two-cells-with-one-if-formula</a></p>\n\n<p>Instead you will need to write a macro that calls the function over a range of values.\n<a href=\"https://stackoverflow.com/questions/1072075/how-do-i-call-a-vba-function-into-a-sub-procedure\">How do I call a VBA Function into a Sub Procedure</a></p>\n\n<p>You can set the range of arguments in the worksheet and just have your sub routine access the worksheet. Here is how to access the values in the worksheet.\n<a href=\"https://stackoverflow.com/questions/17584531/excel-vba-read-cell-value-from-code\">Excel VBA - read cell value from code</a></p>\n"}, {"comments": [{"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1460380884, "post_id": 36464154, "comment_id": 60700498, "body": "thank you! can you show me how you derived this expression for B? I get a different solution when I solve the system of equations"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1460388041, "post_id": 36464154, "comment_id": 60706056, "body": "@beeba Your solution is equivalent to mine. To get from yours to mine: 1. combine terms 1 and 2 in denominator to get n(S-w)ln(x/S). Same for terms 3 and 4 to get v(S-x)ln(w/S). 2. Divide both numerator and denominator through be (S-w)(S-x) leaving (n-v) in numerator and n<i>ln(x/S)/(S-x)-v</i>ln(w/S)/(S-w) in denominator. 3. Divide both numerator and denominator through by n*v leaving (1/v-1/n) in numerator and ln(x/S)/v/(S-x)-ln(w/S)/n/(S-w) in numerator. Then with a few small rearrangements you arrive at my solution."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1460388149, "post_id": 36464154, "comment_id": 60706124, "body": "Oh I see! Thank you very much"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1459986703, "last_edit_date": 1459986703, "creation_date": 1459985783, "answer_id": 36464154, "question_id": 36458778, "link": "https://stackoverflow.com/questions/36458778/solving-systems-of-equations-in-excel/36464154#36464154", "title": "Solving Systems of Equations in Excel", "body": "<p>You can solve the equations analytically to give these worksheet formulas:</p>\n\n<p>B:</p>\n\n<pre><code>=-(1/sigma2-1/sigma1)/(LN(X2/S)/(X2-S)/sigma2-LN(X1/S)/(X1-S)/sigma1)\n</code></pre>\n\n<p>sigma:</p>\n\n<pre><code>=sigma1/(1+B*LN(X1/S)/(X1-S))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=sigma2/(1+B*LN(X2/S)/(X2-S))\n</code></pre>\n\n<p>You can also derive a formula for sigma that doesn't depend on B:</p>\n\n<pre><code>=(sigma2*(X2-S)/LN(X2/S)-sigma1*(X1-S)/LN(X1/S))/((X2-S)/LN(X2/S)-(X1-S)/LN(X1/S))\n</code></pre>\n\n<p>I assumed natural logarithms; if you intended base 10 logs then substitute <code>LOG10</code> for <code>LN</code>.</p>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 36464154, "answer_count": 2, "score": -1, "last_activity_date": 1459986703, "creation_date": 1459965328, "question_id": 36458778, "link": "https://stackoverflow.com/questions/36458778/solving-systems-of-equations-in-excel", "title": "Solving Systems of Equations in Excel", "body": "<p>I want to solve the following system of equations in Excel.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5XSZA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5XSZA.png\" alt=\"enter image description here\"></a></p>\n\n<p>X1, X2, \u03c31 and \u03c32, and S are all known. I want to solve this system simultaneously to discover B and \u03c3. This is relatively trivial to do by hand. I can discover B and \u03c3 for one point in time without any trouble. </p>\n\n<p>However, in Excel I want to create a time series of B for various different values of S, X etc at different points of time. So I'll need to solve this system over and over again hundreds of times to create this time series. </p>\n\n<p>What tool in Excel or VBA can I use to:</p>\n\n<p>a) solve the above system of equations for given inputs of all variables except B and \u03c3</p>\n\n<p>b) automate the process so that I can solve the same system hundreds of times for different values of X1, X2, S, \u03c31 and \u03c32</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6168248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da0bf77d80c83041076eeac455df4b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sun", "link": "https://stackoverflow.com/users/6168248/j-sun"}, "edited": false, "score": 0, "creation_date": 1459965474, "post_id": 36458801, "comment_id": 60529786, "body": "Thanks for your help. Should I just change SaveAs to Path then?"}, {"owner": {"reputation": 1, "user_id": 6168248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da0bf77d80c83041076eeac455df4b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sun", "link": "https://stackoverflow.com/users/6168248/j-sun"}, "edited": false, "score": 0, "creation_date": 1459966053, "post_id": 36458801, "comment_id": 60530130, "body": "Hi Tim Williams, I tried your code, however, it showed me: Run-time error: MS Excel cannot access the file.. Did I do this wrong?"}, {"owner": {"reputation": 1, "user_id": 6168248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da0bf77d80c83041076eeac455df4b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sun", "link": "https://stackoverflow.com/users/6168248/j-sun"}, "edited": false, "score": 0, "creation_date": 1459966192, "post_id": 36458801, "comment_id": 60530226, "body": "ActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; &quot;File to Upload&quot;, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False     ActiveWindow.Close"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 6168248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da0bf77d80c83041076eeac455df4b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sun", "link": "https://stackoverflow.com/users/6168248/j-sun"}, "edited": false, "score": 0, "creation_date": 1459966735, "post_id": 36458801, "comment_id": 60530553, "body": "Where are you wanting to save the file - what exactly is the &quot;original file location&quot; ?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1459965403, "creation_date": 1459965403, "answer_id": 36458801, "question_id": 36458699, "link": "https://stackoverflow.com/questions/36458699/how-to-save-files-to-the-location-where-the-original-file-is-in-using-vba/36458801#36458801", "title": "How to save files to the location where the original file is in using vba?", "body": "<p>If you want to save in the same location as ActiveWorkbook then that is given by ActiveWorkBook.Path</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; \"File to Upload\", _\n                      FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6168248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da0bf77d80c83041076eeac455df4b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sun", "link": "https://stackoverflow.com/users/6168248/j-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459965403, "creation_date": 1459965145, "question_id": 36458699, "link": "https://stackoverflow.com/questions/36458699/how-to-save-files-to-the-location-where-the-original-file-is-in-using-vba", "title": "How to save files to the location where the original file is in using vba?", "body": "<p>I am writing a simple macro to do the followings:\n1. remove all the formats\n2. unhide all the hidden columns\n3. keep the four specified tabs: \"Forms\", \"Fields\", \"DataDictionaries\" and \"DataDictionaryEntries\"\n4. save the file (with those four tabs) under the location where the original file is in.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub removeformat()\n\nDim sheetlist As Variant\nDim sheet As Variant\nsheetlist = Array(\"Forms\", \"Fields\", \"DataDictionaries\", \"DataDictionaryEntries\")\n\nFor Each sheet In sheetlist\n    Sheets(sheet).Activate\n    Sheets(sheet).Cells.Select\n    Selection.ClearFormats\n    Sheets(sheet).Cells(1, 1).Select\n    Sheets(sheet).Columns(\"A:IV\").Hidden = False\n\nNext sheet\n\nSheets(Array(\"Forms\", \"Fields\", \"DataDictionaries\", \"DataDictionaryEntries\")).Copy\nActiveWorkbook.SaveAs Filename:=\"File to Upload\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nActiveWindow.Close\n\nEnd Sub\n</code></pre>\n\n<p>The problem is the fourth step. It won't save to the original file location, it is saved to the excel default location instead. Could you guys help me with this problem please? Many thanks!</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "edited": false, "score": 0, "creation_date": 1459964053, "post_id": 36458240, "comment_id": 60528860, "body": "<code>Sat_Net_Out_PORTME*.xlsx    r10, r10r20, r10r20r30 -   PRINTIMAGE*.txt             r10r20r30r40 -   Sat_Net_Out_OMAHA*.xlsx     r10r20r30r40r50 - </code>  This is what happens with that code. The structure is right, but the string itself is still adding to itself."}, {"owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "edited": false, "score": 0, "creation_date": 1459964346, "post_id": 36458240, "comment_id": 60529043, "body": "God, you&#39;re brilliant. Thank you so much. I learn something new every day from you it seems."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1459964260, "last_edit_date": 1459964260, "creation_date": 1459963746, "answer_id": 36458240, "question_id": 36457782, "link": "https://stackoverflow.com/questions/36457782/clearing-a-string-variable-after-each-iteration-of-for-loop/36458240#36458240", "title": "Clearing a string variable after each iteration of For Loop", "body": "<p>In your first loop you can't know when you've added the last item for any particular key, so you will have to add the dash later</p>\n\n<pre><code>Dim PrefixDict, k, j, p\nDim renamePrefix As String\nSet PrefixDict = CreateObject(\"Scripting.Dictionary\")\n\nFor k = 1 To fileList.Count\n\n    p = fileList(k).FilePattern\n    renamePrefix = fileList.Item(k).renamePrefix '&lt;&lt;&lt;EDIT\n\n    If Not PrefixDict.exists(p) Then\n        PrefixDict(p) = renamePrefix\n    Else\n        PrefixDict(p) = PrefixDict(p) &amp; \", \" &amp; renamePrefix\n    End If\nNext k\n\nFor Each j In PrefixDict\n    PrefixDict(j) = PrefixDict(j) &amp; \" - \"\n    Debug.Print j, PrefixDict(j)\nNext\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 1304152, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e60976c8c2ba3122059557c2685e64c3?s=128&d=identicon&r=PG", "display_name": "Eli Greenberg", "link": "https://stackoverflow.com/users/1304152/eli-greenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 36458240, "answer_count": 1, "score": 0, "last_activity_date": 1459964260, "creation_date": 1459962369, "last_edit_date": 1531161705, "question_id": 36457782, "link": "https://stackoverflow.com/questions/36457782/clearing-a-string-variable-after-each-iteration-of-for-loop", "title": "Clearing a string variable after each iteration of For Loop", "body": "<p>Code:</p>\n\n<pre><code>Dim PrefixDict, k, j\nDim renamePrefix As String\nSet PrefixDict = CreateObject(\"Scripting.Dictionary\")\n\nFor k = 1 To fileList.Count\n    renamePrefix = renamePrefix + fileList.Item(k).renamePrefix + IIf(k &lt; fileList.Count, \", \", \" - \")\n    PrefixDict(fileList(k).FilePattern) = renamePrefix\nNext k\n\nFor Each j In PrefixDict\nDebug.Print j, PrefixDict(j)\nNext\n</code></pre>\n\n<p>Output (Immediate Window):</p>\n\n<pre><code>Sat_Net_Out_PORTME*.xlsx    r10, r20, r30, \nPRINTIMAGE*.txt             r10, r20, r30, r40, \nSat_Net_Out_OMAHA*.xlsx     r10, r20, r30, r40, r50 - \n</code></pre>\n\n<p>Intended Output (Immediate Window):</p>\n\n<pre><code>Sat_Net_Out_PORTME*.xlsx    r10, r20, r30 - \nPRINTIMAGE*.txt             r40 -\nSat_Net_Out_OMAHA*.xlsx     r50 - \n</code></pre>\n\n<p>I am attempting to create a string for each .FilePattern in fileList (a collection of objects) that contains a concatenation of each item's .renamePrefix that matches each .FilePattern</p>\n\n<p>I think I'm setting up this For Loop incorrectly, because it's iterating through each item in the collection, not each .FilePattern in the collection. Essentially, I want a separate renamePrefix string for each .FilePattern. Is there anyway to set this up correctly?</p>\n\n<p>Edit:</p>\n\n<p>Collection Items</p>\n\n<pre><code>.FilePattern                .renamePrefix\nSat_Net_Out_PORTME*.xlsx    r10\nSat_Net_Out_PORTME*.xlsx    r20\nSat_Net_Out_PORTME*.xlsx    r30\nPRINTIMAGE*.txt             r40\nSat_Net_Out_OMAHA*.xlsx     r50\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1459964263, "post_id": 36457851, "comment_id": 60528985, "body": "Sorry not sure if that&#39;s the problem. If by switching the iCol to numbers I get errors in my statements, and also I don&#39;t think this is the case because when the part is found under column A the Select Case does work. The select case does not work when a new part is added to the bottom of the row."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459964288, "post_id": 36457851, "comment_id": 60529004, "body": "@INOPIAE string value is accepted by <code>Cells</code> object. Just type <code>?cells(1,&quot;C&quot;).address</code> in immediate window"}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1459964710, "post_id": 36457851, "comment_id": 60529258, "body": "Select Case MonthComboBox.value          Case &quot;Current Month&quot;          iCol = Cells(3, &quot;C&quot;).Address         Case &quot;Current Month +1&quot;          iCol = Cells(14, &quot;N&quot;).Address      Case &quot;Current Month +2&quot;              iCol = Cells(15, &quot;O&quot;).Address          Case &quot;Current Month +3&quot;              iCol = Cells(16, &quot;P&quot;).Address          Case &quot;Current Month +4&quot;              iCol = Cells(17, &quot;Q&quot;).Address"}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1459964761, "post_id": 36457851, "comment_id": 60529293, "body": "This is how I have switched it now, I get a debug error still"}], "tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 0, "last_activity_date": 1459962581, "creation_date": 1459962581, "answer_id": 36457851, "question_id": 36457482, "link": "https://stackoverflow.com/questions/36457482/how-to-add-data-inputed-through-combobox-and-add-to-to-excel-file/36457851#36457851", "title": "How to add data inputed through combobox and add to to excel file", "body": "<p>For the line value = Cells(iRow, iCol).value you need to have whole numbers as reference not letters.</p>\n\n<p>So you need to use numbers in your select statement:</p>\n\n<pre><code>Select Case MonthComboBox.value\n\nCase \"Current Month\"\n\n    iCol = 3\n\nCase \"Current Month +1\"\n\n    iCol = 14\n\nCase \"Current Month +2\"\n\n    iCol = 15\n\nCase \"Current Month +3\"\n\n    iCol = 16\n\nCase \"Current Month +4\"\n\n    iCol = 17\n\n\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1459963733, "creation_date": 1459961502, "last_edit_date": 1459963733, "question_id": 36457482, "link": "https://stackoverflow.com/questions/36457482/how-to-add-data-inputed-through-combobox-and-add-to-to-excel-file", "title": "How to add data inputed through combobox and add to to excel file", "body": "<p>Hello Guys I'm new to VBA Excel to bear with me. This is the code I have so far. It's a combobox with three inputs 1.Part# 2. Month (Icol) 3. Amount. I want my combobox to look at column A and see if the part is located if its not I want to add that part to the bottom of the row. Everything works fine except when a new part is added not on column A. The part gets added to the bottom of the row, but the value portion does not and this must corresponded to the month the user selected ex. New part, \"Current Month +1=N, 200. So add new part and add 200 to column N.</p>\n\n<p>Private Sub cmdAdd_Click()</p>\n\n<pre><code>Dim iRow As Long\nDim lastRow As Long\nDim iCol As String\nDim c As Range\nDim ws As Worksheet\nDim value As Long\nDim NewPart As Boolean\nSet ws = Worksheets(\"sheet2\")\n\nSet c = ws.Range(\"A7:A1048576\").Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole)\nIf c Is Nothing Then\n'find first empty row in database\n    lastRow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n    iRow = lastRow + 1\n    NewPart = True\nElse\n'find row where the part is\n    iRow = ws.Cells.Find(What:=Me.PartTextBox.value, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    NewPart = False\nEnd If\n'check for a part number\nIf Trim(Me.PartTextBox.value) = \"\" Then\n  Me.PartTextBox.SetFocus\n  MsgBox \"Please Enter A Part Number\"\n  Exit Sub\nEnd If\n\nIf Trim(Me.MonthComboBox.value) = \"\" Then\n  Me.MonthComboBox.SetFocus\n  MsgBox \"Please Enter A Month\"\n  Exit Sub\nEnd If\n\nIf Trim(Me.AddTextBox.value) = \"\" Then\n  Me.AddTextBox.SetFocus\n  MsgBox \"Please Enter A Value To Add Or Substract\"\n  Exit Sub\nEnd If\n\n'copy the data to the database\n'use protect and unprotect lines,\n'     with your password\n'     if worksheet is protected\n\nSelect Case MonthComboBox.value\n\n    Case \"Current Month\"\n\n        iCol = \"C\"\n\n    Case \"Current Month +1\"\n\n        iCol = \"N\"\n\n    Case \"Current Month +2\"\n\n        iCol = \"O\"\n\n    Case \"Current Month +3\"\n\n        iCol = \"P\"\n\n    Case \"Current Month +4\"\n\n        iCol = \"Q\"\n\n\n\nEnd Select\nvalue = Cells(iRow, iCol).value\n\nIf NewPart = True Then\n    ws.Cells(iRow, \"A\").value = Me.PartTextBox.value\n    ws.Cells(iRow, iCol).value = value + CLng(Me.AddTextBox.value)\n\n\nEnd If\n\n\n\nWith ws\n'  .Unprotect Password:=\"password\"\n\n  .Cells(iRow, iCol).value = value + CLng(Me.AddTextBox.value)\n\n'  .Protect Password:=\"password\"\nEnd With\n\n\n\n\n'clear the data\nMe.PartTextBox.value = \"\"\nMe.MonthComboBox.value = \"\"\nMe.AddTextBox.value = \"\"\nMe.PartTextBox.SetFocus\n\nEnd Sub\n\nPrivate Sub cmdClose_Click()\nUnload Me\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n\n'Empty NameTextBox\n PartTextBox.value = \"\"\n\n'Empty PhoneTextBox\n AddTextBox.value = \"\"\n\n'Empty DinnerComboBox\n\n'Fill DinnerComboBox\nWith MonthComboBox\n     .AddItem \"Current Month\"\n     .AddItem \"Current Month +1\"\n     .AddItem \"Current Month +2\"\n     .AddItem \"Current Month +3\"\n     .AddItem \"Current Month +4\"\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "network-drive"], "comments": [{"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1459962973, "post_id": 36457006, "comment_id": 60528167, "body": "Shared resources can be a pain to work with for that (and other) reasons. Avoid it if you can. Have you tried to store the link dynamically in a variable, e.g. <code>link =  Application.ThisWorkbook.FullName</code> and then updating that way instead?"}, {"owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "reply_to_user": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1459967875, "post_id": 36457006, "comment_id": 60531235, "body": "Yeah this unfortunately has to pull from a report on a shared company wide network drive. I was thinking about somehow figuring out the drive letter that the user has for that directory and then storing that in a string variable and concatenating it to a set workbook name, etc. Something like that. Open to ideas though."}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1459999434, "post_id": 36457006, "comment_id": 60543565, "body": "A possible workaround would be to loop through all possible drive letters with <code>On Error Resume Next</code> set until the shared workbook is found, since the name of the shared workbook remains the same regardless of the user. This is not a pretty solution, but it should work."}, {"owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "reply_to_user": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1460382822, "post_id": 36457006, "comment_id": 60702144, "body": "I ended up going into the sheet and just using find/replace to insert the full network path replacing the shortened F: Drive. I thought I had tried this before but it seems to have worked to set that destination across multiple computers. I made the change to the workbook on my desktop and then went in on my laptop and now the full path is showing on both."}], "owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 649, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459960170, "creation_date": 1459960170, "last_edit_date": 1531164843, "question_id": 36457006, "link": "https://stackoverflow.com/questions/36457006/linked-cells-on-a-network-drive-not-updating-because-file-location-gets-changed", "title": "Linked cells on a network drive not updating because file location gets changed", "body": "<p>I appreciate any help on this. </p>\n\n<p>I have an Excel workbook that has a few cells linked to another workbook. It\u2019s to a report that is in our \u201cShared Drive\u201d in the BAS1 folder. When I open on my desktop, all the links in the cells show the full file path like it appears below. I did all the direct linking between the 2 workbooks on my desktop. </p>\n\n<p><code>\\\\DTCNAS-SCFM003\\C_MTGBCD_Groups\\BK_FC_Cent_QA_Ops_Risk\\Bankruptcy QA Testing\\Haas\\BAS1</code></p>\n\n<p>But when someone else opens up the file (on a laptop for example) the links within the cell get shortened. When I open on my laptop it appears like below: </p>\n\n<p><code>E:\\Bankruptcy QA Testing\\Haas\\BAS1</code></p>\n\n<p>So If I try to update links from a laptop it will fail because it can\u2019t find the report location. </p>\n\n<p>I\u2019m wondering about 2 things:</p>\n\n<p>1: Why when I open on my desktop is the full file path location showing vs a shortened link?</p>\n\n<p>2: Since the first link location is a different letter on my desktop vs what it is for other people (ex: if I check my drives the long link is actually an F: Drive and for my boss it\u2019s a D: Drive) how do you get around linking to a certain file location on a shared drive when the drive letters can be different for everyone that is trying to open the report?</p>\n\n<p>I've read a little about the UNC (Universal Naming Convention) issues that others have had in the past but I'm not entirely sure how to implement this in my case. Would I have to figure out the User's drive letter locations every time before anyone would be able to update it somehow? I'm using the <code>ActiveWorkbook.UpdateLink Name:=ActiveWorkbook.LinkSources</code> piece of code to update outside links so I'm not sure how to combine these 2 processes. </p>\n\n<p>If you have any free time I\u2019d appreciate your thoughts on this if you have any. </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1459960644, "creation_date": 1459960644, "answer_id": 36457186, "question_id": 36456988, "link": "https://stackoverflow.com/questions/36456988/how-to-i-make-a-text-box-update-its-text-each-time-the-bound-field-is-updated/36457186#36457186", "title": "How to I make a text box update its text each time the bound field is updated?", "body": "<p>Try to replace <code>Me.FolderName.Requery</code> by <code>Me.Requery</code>. \n<code>Me.Repaint</code> not required here.</p>\n"}], "owner": {"reputation": 3, "user_id": 6010278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d07fba7e1f2bece66c14ac89490ee8?s=128&d=identicon&r=PG&f=1", "display_name": "Tree20093", "link": "https://stackoverflow.com/users/6010278/tree20093"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 36457186, "answer_count": 1, "score": 0, "last_activity_date": 1459960644, "creation_date": 1459960139, "question_id": 36456988, "link": "https://stackoverflow.com/questions/36456988/how-to-i-make-a-text-box-update-its-text-each-time-the-bound-field-is-updated", "title": "How to I make a text box update its text each time the bound field is updated?", "body": "<p>I am updating data with a button in Microsoft Access. Once the button is clicked the user has to select a folder. When the folder is selected, a query executes to put the folder name into a table. I've got the query executing fine and the data is being inserted correctly. My problem is now I want a text box to get the folder name from the table and display it. I got the text box bound to a field, but it isn't updating the text in the text box. How to I make a text box update its text each time the bound field is updated?</p>\n\n<p>Here's the code I made:</p>\n\n<pre><code> Dim sql As String\n\n sql = \"UPDATE tableName SET FolderName = '\" &amp; folderNameVariable &amp; \"' \" &amp; _\n        \"WHERE tableName.tableID= \" &amp; Me.tableID\n\n CurrentProject.Connection.Execute sql\n 'FolderName is the text box name\n Me.FolderName.Requery\n Me.Repaint\n</code></pre>\n"}, {"tags": ["mysql", "vba", "filter", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 2893200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mrkTt.png?s=128&g=1", "display_name": "Alec George Doran-Twyford", "link": "https://stackoverflow.com/users/2893200/alec-george-doran-twyford"}, "edited": false, "score": 0, "creation_date": 1460014437, "post_id": 36457523, "comment_id": 60549979, "body": "that worked however I need to add.  &quot;[name] LIKE &#39;%%&#39; AND&quot; as well"}, {"owner": {"reputation": 371, "user_id": 2893200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mrkTt.png?s=128&g=1", "display_name": "Alec George Doran-Twyford", "link": "https://stackoverflow.com/users/2893200/alec-george-doran-twyford"}, "edited": false, "score": 0, "creation_date": 1460014885, "post_id": 36457523, "comment_id": 60550264, "body": "UPDATE: the reason it wasn&#39;t working is I need to add if statment checking if the like %% will be empty or not."}], "tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": true, "score": 1, "last_activity_date": 1459961654, "creation_date": 1459961654, "answer_id": 36457523, "question_id": 36456976, "link": "https://stackoverflow.com/questions/36456976/vba-rs-filter-mysql-date-between/36457523#36457523", "title": "VBA rs.filter Mysql date between", "body": "<p>Try</p>\n\n<pre><code>rs.filter = \"[date_field] &gt;= #04/01/2016# AND [date_field] &lt;= #04/30/2016#\"\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 2893200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mrkTt.png?s=128&g=1", "display_name": "Alec George Doran-Twyford", "link": "https://stackoverflow.com/users/2893200/alec-george-doran-twyford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 36457523, "answer_count": 1, "score": 0, "last_activity_date": 1459961654, "creation_date": 1459960094, "question_id": 36456976, "link": "https://stackoverflow.com/questions/36456976/vba-rs-filter-mysql-date-between", "title": "VBA rs.filter Mysql date between", "body": "<p>Currently, I'm accessing a record set </p>\n\n<pre><code>tmpQuery = SELECT * FROM someImportantTable \nWHERE(name like '% {Some Value}  %') \nAND date_field BETWEEN '{Some Value}' AND '{Some Value}';\n</code></pre>\n\n<p>then doing</p>\n\n<pre><code>set tmpRS = someDatabase.execute(tmpQuery)\n</code></pre>\n\n<p>I am trying to reduce the amount of opening repeat connection to this table, so I want to do a <code>rs.filter</code> instead.</p>\n\n<p>However, I can't seem to master the syntax </p>\n\n<p>I assumed it something like this:</p>\n\n<p><code>rs.filter =  [name] LIKE '%%' AND [date_field] &gt;= #01/04/2016# AND [date_field] &lt;= #30/04/2016#</code></p>\n\n<p>or</p>\n\n<p><code>rs.filter =  [name] LIKE '%%' AND [date_field] &gt;= #2016-04-01# AND [date_field] &lt;= #2016-04-30#</code></p>\n\n<p>But it keeps giving me an error when it performed I get an error </p>\n\n<p><a href=\"https://i.stack.imgur.com/5qQJS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5qQJS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4877501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1389b175e0abc6d4a192771e3af4e74f?s=128&d=identicon&r=PG&f=1", "display_name": "wisenhiemer", "link": "https://stackoverflow.com/users/4877501/wisenhiemer"}, "edited": false, "score": 0, "creation_date": 1459961816, "post_id": 36457319, "comment_id": 60527454, "body": "how about printing into a table&#39;s cell?"}, {"owner": {"reputation": 135, "user_id": 4877501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1389b175e0abc6d4a192771e3af4e74f?s=128&d=identicon&r=PG&f=1", "display_name": "wisenhiemer", "link": "https://stackoverflow.com/users/4877501/wisenhiemer"}, "edited": false, "score": 0, "creation_date": 1459962265, "post_id": 36457319, "comment_id": 60527714, "body": "Never mind I figured it out. Thank you for your help."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1459961018, "creation_date": 1459961018, "answer_id": 36457319, "question_id": 36456930, "link": "https://stackoverflow.com/questions/36456930/how-to-debug-print-into-a-column-or-text-field-in-access/36457319#36457319", "title": "How to Debug.print into a column or text field in Access?", "body": "<p>Add a text box to the form, and assign <code>s</code> as the text box's <code>Value</code> ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print s\nMe!txtDebug.Value = s\n</code></pre>\n\n<p>If you want to append <code>s</code> to the text box <code>Value</code> (instead of replacing <code>Value</code> each time), you could add the new <code>s</code> value as a new line ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me!txtDebug.Value = Me!txtDebug.Value &amp; vbCrLf &amp; s\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4877501, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1389b175e0abc6d4a192771e3af4e74f?s=128&d=identicon&r=PG&f=1", "display_name": "wisenhiemer", "link": "https://stackoverflow.com/users/4877501/wisenhiemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "accepted_answer_id": 36457319, "answer_count": 1, "score": 1, "last_activity_date": 1459961105, "creation_date": 1459959971, "last_edit_date": 1459961105, "question_id": 36456930, "link": "https://stackoverflow.com/questions/36456930/how-to-debug-print-into-a-column-or-text-field-in-access", "title": "How to Debug.print into a column or text field in Access?", "body": "<p>Is there a way to print out results from <code>Debug.print</code> into a cell on a form instead of just printing in Immediate window? ps. I borrowed this code to generate passwords.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command23_Click()\nDim s As String * 8 'fixed length string with 8 characters\nDim n As Integer\nDim ch As Integer 'the character\nFor n = 1 To Len(s) 'don't hardcode the length twice\n    Do\n        ch = Rnd() * 127 'This could be more efficient.\n        '48 is '0', 57 is '9', 65 is 'A', 90 is 'Z', 97 is 'a', 122 is 'z'.\n    Loop While ch &lt; 48 Or ch &gt; 57 And ch &lt; 65 Or ch &gt; 90 And ch &lt; 97 Or ch &gt; 122\n    Mid(s, n, 1) = Chr(ch) 'bit more efficient than concatenation\nNext\n\nDebug.Print s\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "microstation"], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "is_accepted": true, "score": 0, "last_activity_date": 1460031044, "creation_date": 1460031044, "answer_id": 36475791, "question_id": 36456402, "link": "https://stackoverflow.com/questions/36456402/setting-linestyleparameters-in-microstation-vba/36475791#36475791", "title": "Setting LineStyleParameters in MicroStation VBA", "body": "<p><a href=\"http://communities.bentley.com/products/programming/microstation_programming/f/53220/p/117839/362841#362841\" rel=\"nofollow\">Answer was provided by Jan Slegr</a> on Bentley forums to which I finally got access. </p>\n\n<blockquote>\n  <p>Parenthesis are not used in VBA if a method is called without set =, so you have to remove them:</p>\n</blockquote>\n\n<pre><code>oLineElement.SetLineStyleParameters oParams\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 1, "accepted_answer_id": 36475791, "answer_count": 1, "score": 0, "last_activity_date": 1460031044, "creation_date": 1459958559, "question_id": 36456402, "link": "https://stackoverflow.com/questions/36456402/setting-linestyleparameters-in-microstation-vba", "title": "Setting LineStyleParameters in MicroStation VBA", "body": "<p>I was originally planning to ask this question on the Bentley forums for programming as they had <a href=\"http://communities.bentley.com/products/programming/microstation_programming/f/343173/t/79820\" rel=\"nofollow\">a similar answer for a C# question</a> which I was using to model mine on. However, the account I created for the forums doesn't seem to be working. </p>\n\n<p>The purpose of the code is to set the linestyle, color, lineweight and then lastly two settings which are classified under Line Style Parametra and known as Scale and Corner Mode.</p>\n\n<p>As background, I'm far more familiar with C# than VBA and that might be causing me to miss something, but the solution that I have feels similar to the C# approach highlighted in the link above (which I very serendipitously found):</p>\n\n<pre><code>Private Sub AdjustStyleToByLevel(lvlName As String)\n\n' Set up level definitions\nDim oLevel As Level\nSet oLevel = ActiveDesignFile.Levels(lvlName)\n\n' Set up scan criteria\nDim oScanCriteria As ElementScanCriteria\nSet oScanCriteria = New ElementScanCriteria\n\noScanCriteria.ExcludeAllLevels\noScanCriteria.IncludeLevel oLevel\n\nDim oEnumerator As ElementEnumerator\nSet oEnumerator = ActiveModelReference.Scan(oScanCriteria)\n\nDim oElement As Element\n\nDo While oEnumerator.MoveNext\n    Set oElement = oEnumerator.Current\n\n    If oElement.IsTraversableElement Then\n        Dim oLineElement As LineElement\n        Set oLineElement = oElement\n\n        Set oLineElement.LineStyle = ByLevelLineStyle\n        oLineElement.Color = ByLevelColor               ' -1\n        oLineElement.LineWeight = ByLevelLineWeight     ' -1\n\n        ' Define and set the Line Style settings\n        Dim oParams As LineStyleParameters\n        Set oParams = oElement.GetLineStyleParameters\n\n        oParams.ScaleFactor = Share.ChartScale / 100\n        oParams.SetRunThroughCorners\n\n        oLineElement.SetLineStyleParameters (oParams)\n        oLineElement.Rewrite\n    End If\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>It's the line <code>oLineElement.SetLineStyleParameters (oParams)</code> that gives me the error 438: 'Object does not support this method or property'. However, when comparing this to the C# approach mentioned above (quoted below), I fail to notice a major difference.</p>\n\n<pre><code>public void ChangeLineStyleScale()\n{\n    BCOM.Application msApp = BMI.Utilities.ComApp;\n    BCOM.LineElement oLine = msApp.ActiveModelReference.GetElementByID64(15092) as BCOM.LineElement;\n    BCOM.LineStyleParameters lsParams = oLine.GetLineStyleParameters();\n    lsParams.ScaleFactor = 2.0;\n    oLine.SetLineStyleParameters(lsParams);\n    oLine.Rewrite();\n}\n</code></pre>\n\n<p>Does anyone know what I am doing wrong here, or how to solve this issue?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459958969, "post_id": 36456388, "comment_id": 60525594, "body": "i have not tested this, may be this will help you. Add namespace to xmlnamespacemanager and pass that to selectsingle node for ex: i assigned namespace to abc then .SelectSingleNode(&quot;//abc:bm:_customer_t_company_name&quot;"}, {"owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "reply_to_user": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459960014, "post_id": 36456388, "comment_id": 60526314, "body": "Thanks Karthik for the quick resposne. Changing the code to the below giving a runtime error.  .setProperty &quot;SelectionNamespaces&quot;, &quot;xmlns:abc=&quot;&quot;<a href=\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\" rel=\"nofollow noreferrer\">xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1</a>&quot;&quot; xmlns:soap=&quot;&quot;<a href=\"http://schemas.xmlsoap.org/soap/envelope/\" rel=\"nofollow noreferrer\">schemas.xmlsoap.org/soap/envelope</a>&quot;&quot;&quot;         Dim strName As String         If .SelectSingleNode(&quot;//abc:bm:_customer_t_company_name&quot;) Is Nothing Then             MsgBox &quot;No Node&quot;         End If         strName = .SelectSingleNode(&quot;//abc:bm:_customer_t_company_name&quot;).Text  Expected Token &#39;EOF&#39; found &#39;:&#39; /abc:bm-&gt;:&lt;-_customer_t_company_name"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459960659, "post_id": 36456864, "comment_id": 60526743, "body": "Hi Tmdean, Thank you so much for your inputs.I tested by removing the SelectSingleNode lined and added the below  With Resp                 .setProperty &quot;SelectionNamespaces&quot;, &quot;xmlns:bm=&quot;&quot;<a href=\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\" rel=\"nofollow noreferrer\">xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1</a>&quot;&quot; xmlns:soap=&quot;&quot;<a href=\"http://schemas.xmlsoap.org/soap/envelope/\" rel=\"nofollow noreferrer\">schemas.xmlsoap.org/soap/envelope</a>&quot;&quot;&quot;         WScript.Echo Resp.SelectSingleNode(&quot;//bm:_customer_t_company_name&quot;).Text End With"}, {"owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459960665, "post_id": 36456864, "comment_id": 60526745, "body": "the line WScript.... gives the runtime error &quot;Object variable or with block variable not set&quot;.I have used Resp.LoadXML Req.responseText in my code, is it equivalent to  xml.LoadXML &quot;&lt;soap:Envelope xmlns:soap...&quot;  ?"}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459960973, "post_id": 36456864, "comment_id": 60526959, "body": "Yes, it&#39;s equivalent. In my script, I&#39;m loading the SOAP response XML directly into an DOMDocument60 object using LoadXML instead of doing a web request like you are. Since my code works, it appears that the problem is with the XML output that you&#39;re receiving from the web service and doesn&#39;t have anything to do with SelectSingleNode or XML namespaces."}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459961179, "post_id": 36456864, "comment_id": 60527080, "body": "If you want to run my VBScript example in Excel, just change WScript.Echo to Debug.Print"}, {"owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459963082, "post_id": 36456864, "comment_id": 60528238, "body": "Still the same error with the below code  &quot;Object variable or with block variable not set&quot; on the SelectSingleNode line. With Resp                  .setProperty &quot;SelectionNamespaces&quot;, &quot;xmlns:bm=&quot;&quot;<a href=\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\" rel=\"nofollow noreferrer\">xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1</a>&quot;&quot; xmlns:soap=&quot;&quot;<a href=\"http://schemas.xmlsoap.org/soap/envelope/\" rel=\"nofollow noreferrer\">schemas.xmlsoap.org/soap/envelope</a>&quot;&quot;&quot;                    Debug.Print .SelectSingleNode(&quot;//bm:_customer_t_company_name&quot;).Text              End With \t \tI checked the web service response by saving it in a textbox in the work sheet , It&#39;s the same I have given in my post too."}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459963650, "post_id": 36456864, "comment_id": 60528625, "body": "I rewrote my script in VBA so you should be able to run it in Excel now. If the XML you included in the question is the actual XML, it&#39;s truncated and missing a bunch of end tags. I had assumed you truncated it yourself for brevity but maybe not."}, {"owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459965192, "post_id": 36456864, "comment_id": 60529581, "body": "You are write, I truncated the response XML before pasting it in th epost. As you can see the XML does have the tag &lt;bm:_customer_t_company_name&gt;Test Account&lt;/bm:_customer_t_company_name&gt;  \tin it. I am not sure why it is still giving Nothing when I check the tag. I am able to fetch soap:Body tag successfully , but not any of its children."}, {"owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "edited": false, "score": 0, "creation_date": 1459966150, "post_id": 36456864, "comment_id": 60530199, "body": "I&#39;ve added a screen shot of the Full XML in my post , the tags I need to fetch are the children of highligted tag in the screenshot bm:data_xml/   bm:transaction"}], "tags": [], "owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "is_accepted": false, "score": 0, "last_activity_date": 1459963552, "last_edit_date": 1459963552, "creation_date": 1459959806, "answer_id": 36456864, "question_id": 36456388, "link": "https://stackoverflow.com/questions/36456388/vba-excel-macro-selectsinglenode-returns-nothing/36456864#36456864", "title": "VBA Excel Macro SelectSingleNode returns nothing", "body": "<p>Nothing's wrong with the code as you presented it. You should examine the XML that the web service is actually returning to make sure that it has the tag that you're looking for.</p>\n\n<p>I reduced your example to the following VBA Sub, which runs without error.</p>\n\n<pre><code>Sub Test()\n    Dim xml\n    Set xml = CreateObject(\"MSXML2.DOMDocument.6.0\")\n    xml.LoadXML \"&lt;soap:Envelope xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"&gt; &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"/&gt; &lt;soap:Body&gt; &lt;bm:getTransactionResponse xmlns:bm=\"\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\"\"&gt; &lt;bm:status&gt; &lt;bm:success&gt;true&lt;/bm:success&gt; &lt;bm:message&gt;Wed Apr 06 09:04:32 UTC 2016 - Successfully processed API for test1&lt;/bm:message&gt; &lt;/bm:status&gt; &lt;bm:transaction&gt; &lt;bm:category&gt;data&lt;/bm:category&gt; &lt;bm:action&gt;add&lt;/bm:action&gt; &lt;bm:id&gt;1111&lt;/bm:id&gt; &lt;bm:process_var_name&gt;xvgfdr&lt;/bm:process_var_name&gt; &lt;bm:buyer_company_name&gt;test1&lt;/bm:buyer_company_name&gt; &lt;bm:supplier_company_name&gt;test1&lt;/bm:supplier_company_name&gt; &lt;bm:step_var_name&gt;waitingForInternalApproval&lt;/bm:step_var_name&gt; &lt;bm:last_document_number&gt;2&lt;/bm:last_document_number&gt; &lt;bm:date_added&gt;2016-04-04 12:14:57&lt;/bm:date_added&gt; &lt;bm:date_modified&gt;2016-04-06 09:04:18&lt;/bm:date_modified&gt; &lt;bm:data_xml&gt; &lt;bm:transaction bm:bs_id=\"\"11111\"\" bm:buyer_company_name=\"\"test1\"\" bm:buyer_user_name=\"\"someone\"\" bm:currency_pref=\"\"GBP\"\" bm:data_type=\"\"0\"\" bm:document_name=\"\"Transaction\"\" bm:document_number=\"\"1\"\" bm:document_var_name=\"\"transaction\"\" bm:process_var_name=\"\"XXX_1\"\" bm:supplier_company_name=\"\"test1\"\"&gt; &lt;bm:_document_number&gt;1&lt;/bm:_document_number&gt; &lt;bm:createdBy_t&gt;SomeOne&lt;/bm:createdBy_t&gt; &lt;bm:_price_book_var_name&gt;_default&lt;/bm:_price_book_var_name&gt; &lt;bm:createdDate_t&gt;2016-04-04 00:00:00&lt;/bm:createdDate_t&gt; &lt;bm:currency_t&gt;INR&lt;/bm:currency_t&gt; &lt;bm:_customer_t_first_name/&gt; &lt;bm:_customer_t_last_name/&gt; &lt;bm:_customer_t_company_name&gt;Test Account&lt;/bm:_customer_t_company_name&gt; &lt;/bm:transaction&gt; &lt;/bm:data_xml&gt; &lt;/bm:transaction&gt; &lt;/bm:getTransactionResponse&gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt;\"\n\n    xml.SetProperty \"SelectionNamespaces\", \"xmlns:bm=\"\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\"\" xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"\"\n\n    Debug.Print xml.SelectSingleNode(\"//bm:_customer_t_company_name\").Text\nEnd Sub\n</code></pre>\n\n<p>Output is <code>Test Account</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 5185291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee64fb193114947b382215505ddffa?s=128&d=identicon&r=PG&f=1", "display_name": "user5185291", "link": "https://stackoverflow.com/users/5185291/user5185291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1429, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459965980, "creation_date": 1459958517, "last_edit_date": 1459965980, "question_id": 36456388, "link": "https://stackoverflow.com/questions/36456388/vba-excel-macro-selectsinglenode-returns-nothing", "title": "VBA Excel Macro SelectSingleNode returns nothing", "body": "<blockquote>\n  <p>My very first venture with excel macro, I have written code to parse a\n  web service response and I would like to update tag values in\n  individual cells in excel.</p>\n  \n  <p>Following is the excerpt of my XML (a huge web service response)</p>\n</blockquote>\n\n<pre><code>&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n   &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"/&gt;\n   &lt;soap:Body&gt;\n      &lt;bm:getTransactionResponse xmlns:bm=\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\"&gt;\n         &lt;bm:status&gt;\n            &lt;bm:success&gt;true&lt;/bm:success&gt;\n            &lt;bm:message&gt;Wed Apr 06 09:04:32 UTC 2016 - Successfully processed API for test1&lt;/bm:message&gt;\n         &lt;/bm:status&gt;\n         &lt;bm:transaction&gt;\n            &lt;bm:category&gt;data&lt;/bm:category&gt;\n            &lt;bm:action&gt;add&lt;/bm:action&gt;\n            &lt;bm:id&gt;1111&lt;/bm:id&gt;\n            &lt;bm:process_var_name&gt;xvgfdr&lt;/bm:process_var_name&gt;\n            &lt;bm:buyer_company_name&gt;test1&lt;/bm:buyer_company_name&gt;\n            &lt;bm:supplier_company_name&gt;test1&lt;/bm:supplier_company_name&gt;\n            &lt;bm:step_var_name&gt;waitingForInternalApproval&lt;/bm:step_var_name&gt;\n            &lt;bm:last_document_number&gt;2&lt;/bm:last_document_number&gt;\n            &lt;bm:date_added&gt;2016-04-04 12:14:57&lt;/bm:date_added&gt;\n            &lt;bm:date_modified&gt;2016-04-06 09:04:18&lt;/bm:date_modified&gt;\n            &lt;bm:data_xml&gt;\n               &lt;bm:transaction bm:bs_id=\"11111\" bm:buyer_company_name=\"test1\" bm:buyer_user_name=\"someone\" bm:currency_pref=\"GBP\" bm:data_type=\"0\" bm:document_name=\"Transaction\" bm:document_number=\"1\" bm:document_var_name=\"transaction\" bm:process_var_name=\"XXX_1\" bm:supplier_company_name=\"test1\"&gt;\n                  &lt;bm:_document_number&gt;1&lt;/bm:_document_number&gt;\n                  &lt;bm:createdBy_t&gt;SomeOne&lt;/bm:createdBy_t&gt;\n                  &lt;bm:_price_book_var_name&gt;_default&lt;/bm:_price_book_var_name&gt;\n                  &lt;bm:createdDate_t&gt;2016-04-04 00:00:00&lt;/bm:createdDate_t&gt;\n                  &lt;bm:currency_t&gt;INR&lt;/bm:currency_t&gt;\n                  &lt;bm:_customer_t_first_name/&gt;\n                  &lt;bm:_customer_t_last_name/&gt;\n                  &lt;bm:_customer_t_company_name&gt;Test Account&lt;/bm:_customer_t_company_name&gt;\n</code></pre>\n\n<p>I am trying to fetch the  Value of Tag <code>&lt;bm:_customer_t_company_name&gt;</code></p>\n\n<blockquote>\n  <p>Below is the code, I've been using.             </p>\n</blockquote>\n\n<pre><code>Sub Button1_Click()\n\n                'Set and instantiate our working objects\n                    Dim Req As Object\n                    Dim sEnv As String\n                    Dim Resp As New MSXML2.DOMDocument60\n                    Set Req = CreateObject(\"MSXML2.XMLHTTP\")\n                    Set Resp = CreateObject(\"MSXML2.DOMDocument.6.0\")                   \n                    With Req\n\n                    .Open \"Post\", \"https://XXXX.com/\", False                    \n                    Dim Pwd As String\n                    Pwd = Range(\"D8\").Value\n\n\n                    Dim QuoteId As String\n                    QuoteId = Range(\"D9\").Value\n\n                    ' SOAP envelope for submission to the Web Service\n                     sEnv = sEnv &amp; \"&lt;soapenv:Envelope xmlns:soapenv=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;soapenv:Header&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;wsse:Security xmlns:wsse=\"\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"\" xmlns:wsu=\"\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"\"&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;wsse:UsernameToken wsu:Id=\"\"UsernameToken-2\"\"&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;wsse:Username&gt;\" &amp; Range(\"D7\").Value &amp; \"&lt;/wsse:Username&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;wsse:Password Type=\"\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"\"&gt;\" &amp; Pwd &amp; \"&lt;/wsse:Password&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;/wsse:UsernameToken&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;/wsse:Security&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;/soapenv:Header&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;soapenv:Body&gt;\"\n                     sEnv = sEnv &amp; \"   &lt;bm:getTransaction&gt;\"\n                     sEnv = sEnv &amp; \"    &lt;bm:transaction&gt;\"\n                     sEnv = sEnv &amp; \"    &lt;bm:id&gt;\" &amp; Range(\"D9\").Value &amp; \"&lt;/bm:id&gt;\"\n                     sEnv = sEnv &amp; \"   &lt;/bm:transaction&gt;\"\n                     sEnv = sEnv &amp; \"   &lt;/bm:getTransaction&gt;\"\n                     sEnv = sEnv &amp; \"  &lt;/soapenv:Body&gt;\"\n                     sEnv = sEnv &amp; \"&lt;/soapenv:Envelope&gt;\"                    \n                    ' Send SOAP Request\n        .send (sEnv)       \n\n        Resp.LoadXML Req.responseText\n\n        End With\n        If Resp Is Nothing Then\n            MsgBox \"No XML\"\n        End If\n        With Resp\n\n        .setProperty \"SelectionNamespaces\", \"xmlns:bm=\"\"http://xmlns.oracle.com/XXXCLD/commerce/ZZZYYY_PPP_1\"\" xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\"\"\n        Dim strName As String\n        If .SelectSingleNode(\"//bm:_customer_t_company_name\") Is Nothing Then\n            MsgBox \"No Node\"\n        End If\n        strName = .SelectSingleNode(\"//bm:_customer_t_company_name\").Text\n        MsgBox strName\n    End With\n\n  'clean up code\n    Set Req = Nothing\n    Set Resp = Nothing\nRange(\"A1\").Value = \"DONE\"\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>.SelectSingleNode(\"//soap:Body\") works fine.\n                   the .SelectSingleNode(\"//bm:_customer_t_company_name\") always returns Nothing when I test my code. So is the </p>\n  \n  <blockquote>\n    <p>.SelectSingleNode(\"//bm:getTransactionResponse\"), returns nothing.</p>\n    \n    <p>Can you please let me know what I am doing wrong ?</p>\n  </blockquote>\n</blockquote>\n\n<p>Here is a screenshot of full XML structure<a href=\"http://i.stack.imgur.com/26aFK.jpg\" rel=\"nofollow\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel", "runtime-error", "oledbconnection"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459958294, "post_id": 36456205, "comment_id": 60525084, "body": "Do you need to start the <code>.CommandText</code> with a single apostrophe? I notice you added one at the end, so do you need one at the start? <code>.CommandText = &quot;&#39;EXEC dbo.TVCExtract &#39;&quot; &amp; Code &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459958510, "post_id": 36456205, "comment_id": 60525254, "body": "I hope, Stored procedures does not need apostrophe before EXEC"}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459968905, "post_id": 36456205, "comment_id": 60531851, "body": "Put a breakpoint on <code>ActiveWorkbook.Connections(&quot;PastelCost&quot;).Refresh</code> and do a <code>debug.print ActiveWorkbook.Connections(&quot;PastelCost&quot;).OLEDBConnection.Com&zwnj;&#8203;mandText</code> in the immediate window; then execute that directly against your database independent of Excel. If that fails, you could debug that SP."}, {"owner": {"reputation": 9, "user_id": 6167749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba8c21525e04286b46d223154fd7e8?s=128&d=identicon&r=PG&f=1", "display_name": "JPGrob", "link": "https://stackoverflow.com/users/6167749/jpgrob"}, "edited": false, "score": 0, "creation_date": 1460035959, "post_id": 36456205, "comment_id": 60565600, "body": "Got it working, thanks."}], "owner": {"reputation": 9, "user_id": 6167749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba8c21525e04286b46d223154fd7e8?s=128&d=identicon&r=PG&f=1", "display_name": "JPGrob", "link": "https://stackoverflow.com/users/6167749/jpgrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1723, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491599364, "creation_date": 1459958022, "question_id": 36456205, "link": "https://stackoverflow.com/questions/36456205/vba-oledbconnection-related-run-time-error-1004-application-defined-or-obj", "title": "VBA - OLEDBConnection related Run-Time Error &#39;1004&#39;: &quot;Application defined or object defined error&quot;", "body": "<p>I am trying to generate a table of costs, extracted from a SQL database, that are specifically related to a user inputted code.</p>\n\n<p>An example of what I mean:</p>\n\n<p>User input: TestCode</p>\n\n<p>Output: Some table with all costs related only to that code.</p>\n\n<p>I have been following instructions according to this page: <a href=\"https://www.mssqltips.com/sqlservertip/3436/passing-dynamic-query-values-from-excel-to-sql-server/\" rel=\"nofollow\">https://www.mssqltips.com/sqlservertip/3436/passing-dynamic-query-values-from-excel-to-sql-server/</a></p>\n\n<p>My code in VB is as follows:</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n\n    Dim Code As String\n\n    Code = Sheets(\"Project_TVC\").Range(\"B1\").Value\n\n    With ActiveWorkbook.Connections(\"PastelCost\").OLEDBConnection\n    .CommandText = \"EXEC dbo.TVCExtract '\" &amp; Code &amp; \"'\"\n    ActiveWorkbook.Connections(\"PastelCost\").Refresh\n    End With\n\n    End Sub\n</code></pre>\n\n<p>This ends with a Run-time error '1004': Application-defined or object-defined error. I have narrowed the error down to the something related to OLEDBConnection.</p>\n\n<p>I have no idea what is going on, and the solution may be simple, but I will greatly appreciate some help. </p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "interpolation", "linear-interpolation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459958149, "post_id": 36455864, "comment_id": 60524980, "body": "If a discontinuous range is passed you can detect that using <code>r.Areas.Count</code>"}, {"owner": {"reputation": 13, "user_id": 5066852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1910d55929a3b88bbf09a0d4b80a56?s=128&d=identicon&r=PG&f=1", "display_name": "AccessExcelVBA", "link": "https://stackoverflow.com/users/5066852/accessexcelvba"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459958227, "post_id": 36455864, "comment_id": 60525033, "body": "Sorry but I am new to VBA. what does r.Areas.Count do exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 6068036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fd50bb5fbc12d1bb7ead7e318f5e1b?s=128&d=identicon&r=PG", "display_name": "AlexM", "link": "https://stackoverflow.com/users/6068036/alexm"}, "edited": false, "score": 0, "creation_date": 1508961296, "post_id": 36456451, "comment_id": 80829264, "body": "FYI, this function requires the x-range (xR) to be sorted smallest to largest"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 6, "last_activity_date": 1459958667, "creation_date": 1459958667, "answer_id": 36456451, "question_id": 36455864, "link": "https://stackoverflow.com/questions/36455864/excel-linear-interpolation-vba/36456451#36456451", "title": "Excel Linear Interpolation VBA", "body": "<p>one very simple way is having the function accepting two ranges in input, one for X values (say rX) and one for Y ones (say rY), and then changing every occurrence of <code>r(foo,1)</code> to <code>rX(foo)</code> and <code>r(foo,2)</code> to <code>rY(foo)</code>  </p>\n\n<p>like follows</p>\n\n<pre><code>Option Explicit\n\nFunction Linterp2(rX As Range, rY As Range, x As Double) As Double\n     ' linear interpolator / extrapolator\n     ' R is a two-column range containing known x, known y\n    Dim lR As Long, l1 As Long, l2 As Long\n    Dim nR As Long\n     'If x = 1.5 Then Stop\n\n    nR = rX.Rows.Count\n    If nR &lt; 2 Then Exit Function\n\n    If x &lt; rX(1) Then ' x &lt; xmin, extrapolate\n        l1 = 1: l2 = 2: GoTo Interp\n\n    ElseIf x &gt; rX(nR) Then ' x &gt; xmax, extrapolate\n        l1 = nR - 1: l2 = nR: GoTo Interp\n\n    Else\n         ' a binary search would be better here\n        For lR = 1 To nR\n            If rX(lR) = x Then ' x is exact from table\n                Linterp2 = rY(lR)\n                Exit Function\n\n            ElseIf rX(lR) &gt; x Then ' x is between tabulated values, interpolate\n                l1 = lR: l2 = lR - 1: GoTo Interp\n\n            End If\n        Next\n    End If\n\nInterp:\n    Linterp2 = rY(l1) _\n    + (rY(l2) - rY(l1)) _\n    * (x - rX(l1)) _\n    / (rX(l2) - rX(l1))\n\nEnd Function\n</code></pre>\n\n<p>but you must implement code to check for consistency of the two ranges, like being both of one column each and with the same number of rows</p>\n"}], "owner": {"reputation": 13, "user_id": 5066852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1910d55929a3b88bbf09a0d4b80a56?s=128&d=identicon&r=PG&f=1", "display_name": "AccessExcelVBA", "link": "https://stackoverflow.com/users/5066852/accessexcelvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20793, "favorite_count": 0, "accepted_answer_id": 36456451, "answer_count": 1, "score": 1, "last_activity_date": 1606950824, "creation_date": 1459957098, "last_edit_date": 1459962247, "question_id": 36455864, "link": "https://stackoverflow.com/questions/36455864/excel-linear-interpolation-vba", "title": "Excel Linear Interpolation VBA", "body": "<p>this function interpolates/extrapolates a table of known x,y\nFor example,</p>\n\n<pre><code>x y\n1 10\n2 15\n3 20\n</code></pre>\n\n<p>Linterp(A1:B3, -1) = 0</p>\n\n<p>However, this code can only do two adjacent arrays.\nI would like to modify this code so that I can\nselect two separate arrays, for example N106:N109,P106:P109.\nHow can I make this adjustment in this code?</p>\n\n<pre><code>Function Linterp(r As Range, x As Double) As Double\n     ' linear interpolator / extrapolator\n     ' R is a two-column range containing known x, known y\n    Dim lR As Long, l1 As Long, l2 As Long\n    Dim nR As Long\n     'If x = 1.5 Then Stop\n\n    nR = r.Rows.Count\n    If nR &lt; 2 Then Exit Function\n\n    If x &lt; r(1, 1) Then ' x &lt; xmin, extrapolate\n        l1 = 1: l2 = 2: GoTo Interp\n\n    ElseIf x &gt; r(nR, 1) Then ' x &gt; xmax, extrapolate\n        l1 = nR - 1: l2 = nR: GoTo Interp\n\n    Else\n         ' a binary search would be better here\n        For lR = 1 To nR\n            If r(lR, 1) = x Then ' x is exact from table\n                Linterp = r(lR, 2)\n                Exit Function\n\n            ElseIf r(lR, 1) &gt; x Then ' x is between tabulated values, interpolate\n                l1 = lR: l2 = lR - 1: GoTo Interp\n\n            End If\n        Next\n    End If\n\nInterp:\n    Linterp = r(l1, 2) _\n    + (r(l2, 2) - r(l1, 2)) _\n    * (x - r(l1, 1)) _\n    / (r(l2, 1) - r(l1, 1))\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459955819, "post_id": 36455287, "comment_id": 60523180, "body": "<code>starting in E2</code> because <code>Cells(2 + (k * patientprofiles)</code> tells it to start on row 2 when <code>k=0</code> (beginning of loop). Edit: oh wait, you DO want it to start on <code>E2</code>..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1459955976, "post_id": 36455287, "comment_id": 60523302, "body": "You have <code>p</code> in  the second <code>Cells</code> that should be <code>patientprofiles</code>"}, {"owner": {"reputation": 47, "user_id": 6146017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cce235600dc7969ebcb9bbd1c93ea6e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarcasm24", "link": "https://stackoverflow.com/users/6146017/sarcasm24"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459956923, "post_id": 36455287, "comment_id": 60524001, "body": "@ScottCraner Well that&#39;s an embarrassing mistake! Thank you though, that helps; it&#39;s now almost working. The only problem is that it writes k+1 (in the example, 7) in the next 40 cells (i.e., E242:E281). Is there a way to get it to stop writing at E241?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1459957217, "post_id": 36455287, "comment_id": 60524249, "body": "<code>For k = 0 To observations - 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1460031524, "post_id": 36455913, "comment_id": 60561972, "body": "can you please mark it as solution, if its satisfies"}, {"owner": {"reputation": 47, "user_id": 6146017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cce235600dc7969ebcb9bbd1c93ea6e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarcasm24", "link": "https://stackoverflow.com/users/6146017/sarcasm24"}, "edited": false, "score": 0, "creation_date": 1460040320, "post_id": 36455913, "comment_id": 60569354, "body": "It still has the same issue of writing an extra value for the next 40 cells, though. I figured it out with Scott Craner&#39;s help above; I had a typo, plus I had to change it to <code>observations - 1</code>. Thank you for taking the time though!"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1459957227, "creation_date": 1459957227, "answer_id": 36455913, "question_id": 36455287, "link": "https://stackoverflow.com/questions/36455287/using-a-for-next-loop-to-write-values-which-depend-upon-the-counter/36455913#36455913", "title": "Using a For...Next Loop to Write Values which Depend Upon the Counter", "body": "<p>Another way as below</p>\n\n<pre><code>Sub testttt()\n    Dim k As Long\n    observations = 6\n    patientprofiles = 40\n    For k = 0 To observations\n        Range(\"E\" &amp; (Range(\"E\" &amp; Rows.Count).End(xlUp).Row + 1), \"E\" &amp; patientprofiles + (Range(\"E\" &amp; Rows.Count).End(xlUp).Row)).Value = k\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1459958978, "last_edit_date": 1459958978, "creation_date": 1459958584, "answer_id": 36456416, "question_id": 36455287, "link": "https://stackoverflow.com/questions/36455287/using-a-for-next-loop-to-write-values-which-depend-upon-the-counter/36456416#36456416", "title": "Using a For...Next Loop to Write Values which Depend Upon the Counter", "body": "<p>You want the <code>.Resize()</code> method in conjunction with the <code>Step</code> argument for a loop:</p>\n\n<pre><code>Sub Foo()\n\nDim k                 As Long\nDim incrementValue    As Long\nConst observations    As Long = 6\nConst patientProfiles As Long = 40\n\nincrementValue = 1\n\nFor k = 2 To observations * patientProfiles Step patientProfiles\n    Cells(k, 5).Resize(40, 1).Value = incrementValue\n    incrementValue = incrementValue + 1\nNext\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The <code>Step</code> argument tells the loop to increment in steps, for example:</p>\n\n<pre><code>For i = 1 To 10           '// 1,2,3,4,5,6,7,8,9,10\nFor i = 1 To 10 Step 2    '// 1,3,5,7,9\nFor i = 1 To 10 Step 3    '// 1,4,7,10\n</code></pre>\n\n<hr>\n\n<p>The <code>Resize()</code> method re-sizes a range object to the given parameters:</p>\n\n<pre><code>Range(\"A1\")                '// 1R x 1C\nRange(\"A1:B5\")             '// 5R x 2C\nRange(\"A1\").Resize(5, 2)   '// 5R x 2C (Now \"A1:B5\")\nRange(\"B5\").Resize(9, 1)   '// 9R x 1C (Now \"B5:B13\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459960378, "creation_date": 1459960378, "answer_id": 36457092, "question_id": 36455287, "link": "https://stackoverflow.com/questions/36455287/using-a-for-next-loop-to-write-values-which-depend-upon-the-counter/36457092#36457092", "title": "Using a For...Next Loop to Write Values which Depend Upon the Counter", "body": "<p>a \"formula\" approach</p>\n\n<pre><code>Option Explicit\n\nSub main()\n\nDim observations As Long, patientprofiles As Long\n\nobservations = 6\npatientprofiles = 10\n\nActiveSheet.Range(\"e2\").Resize(observations * patientprofiles).FormulaR1C1 = \"=IF(ROWS(R2C:RC)=1,1,IF(COUNTIF(R2C:R[-1]C,R[-1]C)&lt;\" &amp; observations &amp; \",R[-1]C,R[-1]C+1))\"\n\nEnd Sub\n</code></pre>\n\n<p>which could be also written directly in excel cells with the only care to limit the cells where to put it into or add to the formula an outer \"IF\" condition to count the number of rows where to write the resulting number</p>\n"}], "owner": {"reputation": 47, "user_id": 6146017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cce235600dc7969ebcb9bbd1c93ea6e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarcasm24", "link": "https://stackoverflow.com/users/6146017/sarcasm24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1459960378, "creation_date": 1459955624, "question_id": 36455287, "link": "https://stackoverflow.com/questions/36455287/using-a-for-next-loop-to-write-values-which-depend-upon-the-counter", "title": "Using a For...Next Loop to Write Values which Depend Upon the Counter", "body": "<p>I want to write \"1\" in a specified number of cells in column E, and then \"2\" in the same number of cells directly below the cells with 1 in them, and then \"3\", and so on, until the value I'm writing in the cells reaches a user-defined variable. I <em>think</em> I should be using a For...Next loop for this, but I'm not sure. The code I have now is this:</p>\n\n<pre><code>    Dim k As Long\n    For k = 0 To observations\n        Range(Cells(2 + (k * patientprofiles), 5), Cells(1 + p * (k + 1), 5)).Value = k + 1\n    Next\n</code></pre>\n\n<p>where <code>observations</code> is the value that I want to write in the cells, and <code>patientprofiles</code> is the number of cells to fill before moving to the next value. For example, if <code>observations</code> is 6 and <code>patientprofiles</code> is 40, I want to write 1 in cells E2:E41, 2 in cells E42:E81, 3 in cells E82:E121, 4 in cells E122:E161, 5 in cells E162:E201 and 6 in cells E202:E241.</p>\n\n<p>The code I have above is writing 7 in cells E1:E242, i.e., it's not changing the value it's writing as it moves through the loop, and it's starting in E1 and finishing in E242 instead of starting in E2 and finishing in E241.</p>\n\n<p>I have three questions about this:</p>\n\n<ol>\n<li><p>Am I correct in thinking that I should be using a For...Next loop to do this? If not, what should I be using?</p></li>\n<li><p>If For...Next is the right approach, how can I get VBA to write a different value in each of the cells, rather than the same one in all cells?</p></li>\n<li><p>Why is it starting a cell too high and ending a cell too low?</p></li>\n</ol>\n\n<p>Thank you for your help and I apologize if this is a really simple question or if it has been answered elsewhere.</p>\n"}, {"tags": ["vba", "excel", "olap", "olap-cube"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5914672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hW2aWgv9-Do/AAAAAAAAAAI/AAAAAAAAJzM/W4Ir8RtAZK8/photo.jpg?sz=128", "display_name": "onevba", "link": "https://stackoverflow.com/users/5914672/onevba"}, "edited": false, "score": 0, "creation_date": 1460112858, "post_id": 36454558, "comment_id": 60603092, "body": "Seems that I cannot link the slicer as the Pivot Table has grouped fields and is based on OLAP.   Am I correct to assume that I need to Dim all PivotTables I have and replicate code for them when adjusting your VBA code?"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 13, "user_id": 5914672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hW2aWgv9-Do/AAAAAAAAAAI/AAAAAAAAJzM/W4Ir8RtAZK8/photo.jpg?sz=128", "display_name": "onevba", "link": "https://stackoverflow.com/users/5914672/onevba"}, "edited": false, "score": 0, "creation_date": 1460118194, "post_id": 36454558, "comment_id": 60606390, "body": "It world probably be cleaner and shorter to loop through the pivots with a for or  for each loop."}], "tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": false, "score": 0, "last_activity_date": 1459955406, "last_edit_date": 1459955406, "creation_date": 1459953943, "answer_id": 36454558, "question_id": 36454391, "link": "https://stackoverflow.com/questions/36454391/excel-2013-filtering-on-multiple-olap-pivot-tables/36454558#36454558", "title": "Excel 2013 filtering on multiple OLAP pivot tables", "body": "<p>You could insert a slicer for each of those four fields. Once they are added, you can go to the Slicer Connections and select all of your pivots that are related.</p>\n\n<p>If you are looking for VBA, you would have to loop through all of the pivots on the sheet and then loop through all of the Report Filters members and store the values selected into an array.</p>\n\n<p>Or you could create the slicers on a hidden tab and use the CUBERANKEDMEMBER function to return all of the selections of the slicer and then use that to build your array and apply it to all of your pivot tables when any of your report filters change (you may use a Worksheet_PivotTableAfterValueChange procedure in your worksheet)</p>\n\n<p>Here is how we have done it with 2 pivot tables:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n''''variables for pivottable changed\n    Dim pivotname As String\n    Dim pivotname2 As String\n    Dim PT As PivotTable\n    Dim PT2 As PivotTable\n\n''''variables for pivotrowfields\n    Dim pti As PivotItem\n    Dim pti2 As PivotField\n\n''''variables for pagefilters\n    Dim PF As PivotField\n    Dim colPageFields As PivotFields\n    Dim aFilters As Variant\n\n'''Un-enable events to avoid an endless loop\n    Application.EnableEvents = False\n\n'''Set variables\n    pivotname = Target.Name\n\n    If pivotname = \"PivotTable1\" Then\n        pivotname2 = \"PivotTable4\"\n    Else\n        pivotname2 = \"PivotTable1\"\n        pivotname = \"PivotTable4\"\n    End If\n\n    If ActiveSheet.Name = \"Slicer Setup\" Then\n        Sheets(\"By Org Structure\").Activate\n    End If\n\n    Set PT = ActiveSheet.PivotTables(\"\" &amp; pivotname &amp; \"\")\n    Set PT2 = ActiveSheet.PivotTables(\"\" &amp; pivotname2 &amp; \"\")\n\n    Set colPageFields = PT.PageFields\n\n'''action for changing the filters on Page Fields\n    For Each PF In colPageFields\n\n                    PF.CubeField.EnableMultiplePageItems = True\n                    'PT2.PivotFields(PF.Name).CubeField.EnableMultiplePageItems = True\n                    aFilters = PT.PivotFields(PF.Name).VisibleItemsList\n                    If aFilters(1) = \"\" Then\n                        If PT.PivotFields(PF.Name).CubeField.AllItemsVisible = True Then\n                            PT2.PivotFields(PF.Name).ClearAllFilters\n                        Else\n                            PT2.PivotFields(PF.Name).VisibleItemsList = Array(\"\")\n                        End If\n                    Else\n                        PT2.PivotFields(PF.Name).VisibleItemsList = Array(aFilters)\n                    End If\n\n    Next\n\nSet colPageFields = PT.RowFields\n\n'''action for changing the filters on Row Fields\n    For Each PF In colPageFields\n                     PF.CubeField.EnableMultiplePageItems = True\n                    'PT2.PivotFields(PF.Name).CubeField.EnableMultiplePageItems = True\n                    aFilters = PT.PivotFields(PF.Name).VisibleItemsList\n                    If aFilters(1) = \"\" Then\n                        If PT.PivotFields(PF.Name).CubeField.AllItemsVisible = True Then\n                            PT2.PivotFields(PF.Name).ClearAllFilters\n                        Else\n                            PT2.PivotFields(PF.Name).VisibleItemsList = Array(\"\")\n                        End If\n                    Else\n                        PT2.PivotFields(PF.Name).VisibleItemsList = Array(aFilters)\n                    End If\n    Next\n\n\n'''Re-enable events to allow for this event macro to be kicked off again next time pivottables are changed\n    Application.EnableEvents = True\n\n    ActiveWorkbook.ShowPivotTableFieldList = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5914672, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hW2aWgv9-Do/AAAAAAAAAAI/AAAAAAAAJzM/W4Ir8RtAZK8/photo.jpg?sz=128", "display_name": "onevba", "link": "https://stackoverflow.com/users/5914672/onevba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1007, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459955406, "creation_date": 1459953541, "question_id": 36454391, "link": "https://stackoverflow.com/questions/36454391/excel-2013-filtering-on-multiple-olap-pivot-tables", "title": "Excel 2013 filtering on multiple OLAP pivot tables", "body": "<p>VBA newbie here.</p>\n\n<p>While I were able to sync multiple local data pivot tables using one of the VBA codes I found online, I am struggling with the following:</p>\n\n<p>I have 16 OLAP connected pivot tables on one sheet. Each has 6 filters, with 4 being the same across all of them. I'd like to be able to change all pivot tables using one of these four filters.</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 2753, "user_id": 6089766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f479be527ebc2747dbea8e777483cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Silenko", "link": "https://stackoverflow.com/users/6089766/adam-silenko"}, "edited": false, "score": 0, "creation_date": 1459953762, "post_id": 36454384, "comment_id": 60521541, "body": "on which line of code you get error?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1459953969, "post_id": 36454384, "comment_id": 60521708, "body": "Try <code>Selection.Pastespecial</code>."}, {"owner": {"reputation": 53, "user_id": 5767100, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3b6165bbcf5ee21ff9ca404ef1ab5dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjeev Shinde", "link": "https://stackoverflow.com/users/5767100/sanjeev-shinde"}, "edited": false, "score": 0, "creation_date": 1459957312, "post_id": 36454384, "comment_id": 60524320, "body": "@ Adam Silenko/// I am getting an error at &quot;open_book&quot;..."}], "answers": [{"comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 53, "user_id": 5767100, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3b6165bbcf5ee21ff9ca404ef1ab5dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjeev Shinde", "link": "https://stackoverflow.com/users/5767100/sanjeev-shinde"}, "edited": false, "score": 0, "creation_date": 1459957641, "post_id": 36455417, "comment_id": 60524579, "body": "@SanjeevShinde Welcome"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1459955937, "creation_date": 1459955937, "answer_id": 36455417, "question_id": 36454384, "link": "https://stackoverflow.com/questions/36454384/open-workbook-through-excel-vba-and-copy-contents/36455417#36455417", "title": "Open workbook through excel vba and copy contents", "body": "<p>Try the below code</p>\n\n<pre><code>Sub open_file()\n    Dim open_book As Variant\n    com_name = InputBox(\"Enter Company Ticker\", \"Enter Company Ticker\")\n    If (IsEmpty(com_name)) Then\n        msg = MsgBox(\"Please, enter company ticker\", vbCritical)\n    Else\n        Set open_book = Workbooks.Open(\"E:\\Mutual Fund\\data\\nifty 50\\\" &amp; com_name &amp; \".xlsx\")\n        Range(\"A:H\").Copy Windows(\"try.xlsm\").ActiveSheet.Range(\"A1\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "is_accepted": false, "score": 0, "last_activity_date": 1459956463, "creation_date": 1459956463, "answer_id": 36455617, "question_id": 36454384, "link": "https://stackoverflow.com/questions/36454384/open-workbook-through-excel-vba-and-copy-contents/36455617#36455617", "title": "Open workbook through excel vba and copy contents", "body": "<p>You have a typo error on \" Sel<strong>e</strong>ction.Copy\"</p>\n\n<p>You should also define from which worksheet the ranges come from. If you call your macro with a different active page than the one you want your operation to apply, it won't work. \nDo something like this :</p>\n\n<pre><code>open_book.Sheets(\"My_Sheet\").Range(\"A:A,H:H\").Select\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5767100, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3b6165bbcf5ee21ff9ca404ef1ab5dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjeev Shinde", "link": "https://stackoverflow.com/users/5767100/sanjeev-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 1, "accepted_answer_id": 36455417, "answer_count": 2, "score": 1, "last_activity_date": 1459956463, "creation_date": 1459953531, "question_id": 36454384, "link": "https://stackoverflow.com/questions/36454384/open-workbook-through-excel-vba-and-copy-contents", "title": "Open workbook through excel vba and copy contents", "body": "<p>I want to open a particular file and copy cells from that file and paste in active workbook, but I am getting an error '438': Object doesn't support this property or method.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub open_file()\nDim open_book As Variant\n\ncom_name = InputBox(\"Enter Company Ticker\", \"Enter Company Ticker\")\nIf (IsEmpty(com_name)) Then\n    msg = MsgBox(\"Please, enter company ticker\", vbCritical)\nElse\n    open_book = Workbooks.Open(\"E:\\Mutual Fund\\data\\nifty 50\\\" &amp; com_name &amp; \".xlsx\")\n    Windows(com_name &amp; \".xlsx\").Activate\n    Range(\"A:A,H:H\").Select\n    Selction.Copy\n    Windows(\"try.xlsm\").Activate\n    Range(\"A1\").Select\n    Selection.Paste\nEnd If \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459953976, "post_id": 36454280, "comment_id": 60521710, "body": "Look into Worksheet.Evaluate() Function.  It allows the direct use of worksheet functions."}], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "is_accepted": true, "score": 2, "last_activity_date": 1459955174, "creation_date": 1459955174, "answer_id": 36455115, "question_id": 36454280, "link": "https://stackoverflow.com/questions/36454280/excel-vba-equivalent-prior-year-date/36455115#36455115", "title": "Excel VBA - Equivalent Prior Year Date", "body": "<p>If you define a year as 52 weeks, rather than by days or months, then this makes the calculation much simpler, and you can use the DateAdd function.</p>\n\n<p>eg:</p>\n\n<pre><code>Function calcMTDDayDate(MTDDate As Date) As Date\n    calcMTDDayDate = DateAdd(\"ww\", -52, MTDDate)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 36455115, "answer_count": 1, "score": 1, "last_activity_date": 1459955174, "creation_date": 1459953254, "last_edit_date": 1459954332, "question_id": 36454280, "link": "https://stackoverflow.com/questions/36454280/excel-vba-equivalent-prior-year-date", "title": "Excel VBA - Equivalent Prior Year Date", "body": "<p>I have a worksheet formula which calculates the correct equivalent date in prior year. For example when reporting figures at work we don't compare 05/04/2016 against 05/04/2015 because the 5th in 2015 was a Sunday and this year it was a Tuesday. We therefore compare it against 07/04/2015.</p>\n\n<p>Because of leap years it's also not always +2 days ahead (or -2 behind, whichever way you want to look at it).</p>\n\n<p>I therefore created this worksheet formula which calculates the Week Start date of the same week in prior year, and adds weekday this year -1.</p>\n\n<pre><code>=(MAX(DATE(B2,1,1),DATE(B2,1,1)-WEEKDAY(DATE(B2,1,1),2)+(WEEKNUM(E3,2)-1)*7+1))+(WEEKDAY(E3,2)-1)\n\nB2 = 2015\n\nE3 = 05/04/2016\n</code></pre>\n\n<p>I want to convert this worksheet formula into a VBA Function so that I can pass any variable to it that I like and work out the equivalent date in prior year?</p>\n\n<p>However, some of these functions don't seem to be available in VBA, I know Weekday is and I need to swap DATE for DateSerial. However it doesn't seem MAX is an available function in VBA? I also don't know about WEEKNUM?</p>\n\n<p>If anyone could help convert this formula to a function I'd really appreciate it, this is what I have so far:</p>\n\n<pre><code>Function calcMTDDayDate(MTDDate As Date) As Date\n\nEnd Function\n</code></pre>\n\n<p>Well.... I made a start at least...</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2003"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 2, "creation_date": 1459953021, "post_id": 36453949, "comment_id": 60520932, "body": "Why those square brackets? Doesn&#39;t that imply a column name in this case?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 4, "creation_date": 1459953045, "post_id": 36453949, "comment_id": 60520958, "body": "Take care for <code>Jim O&#39;Shea</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 1, "last_activity_date": 1459953192, "last_edit_date": 1459953192, "creation_date": 1459952598, "answer_id": 36454024, "question_id": 36453949, "link": "https://stackoverflow.com/questions/36453949/update-null-fields-with-sql-in-ms-access/36454024#36454024", "title": "Update Null Fields with SQL in MS Access", "body": "<p>I think you need to have user as a <code>'string'</code> in your query using single quotes. Also, I have always used <code>set db = currentdb</code> instead of using <code>as</code></p>\n\n<pre><code>Public Sub testSub(user as string)\nDim db as DAO.Database\nDim sqlstr as String\nset db = CurrentDB\n\nsqlstr = \"UPDATE tTable1 SET Field1 = '\" &amp; user &amp; \"' WHERE Field1 IS NULL;\"\n\ndb.Execute sqlstr\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>EDIT:\n  As @jarlh has mentioned I agree, I don't think that the square parentheses are required</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 3, "last_activity_date": 1459954387, "last_edit_date": 1495541256, "creation_date": 1459954387, "answer_id": 36454773, "question_id": 36453949, "link": "https://stackoverflow.com/questions/36453949/update-null-fields-with-sql-in-ms-access/36454773#36454773", "title": "Update Null Fields with SQL in MS Access", "body": "<p>Consider a parameter query instead of concatenating a quoted string value into your <code>UPDATE</code> statement text.  You don't need those quotes when using the parameter approach, and that also safeguards you from the <a href=\"https://stackoverflow.com/questions/36453949/update-null-fields-with-sql-in-ms-access#comment60520958_36453949\">issue Alex warned about</a> (when the user string itself contains an apostrophe).</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub testSub(ByVal pUser As String)\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim sqlstr As String\n\n    sqlstr = \"UPDATE tTable1 SET Field1 = [which_user] WHERE Field1 IS NULL;\"\n    Set db = CurrentDb\n    Set qdf = db.CreateQueryDef(vbNullString, sqlstr)\n    qdf.Parameters(\"which_user\").Value = pUser\n    qdf.Execute sqlstr, dbFailOnError\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 1287985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22701cba26ce86f6bec949c1d554177?s=128&d=identicon&r=PG", "display_name": "SomethingSmithe", "link": "https://stackoverflow.com/users/1287985/somethingsmithe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2006, "favorite_count": 0, "accepted_answer_id": 36454024, "answer_count": 2, "score": 2, "last_activity_date": 1459954387, "creation_date": 1459952408, "last_edit_date": 1459952496, "question_id": 36453949, "link": "https://stackoverflow.com/questions/36453949/update-null-fields-with-sql-in-ms-access", "title": "Update Null Fields with SQL in MS Access", "body": "<p>I'm trying to run some SQL commands in Access VBA to update the blank (null) fields in a column with the value obtained from a combobox in the form.</p>\n\n<p>At the moment I'm receiving</p>\n\n<blockquote>\n  <p>Run time Error '3061' Too Few Parameters. Expected 1</p>\n</blockquote>\n\n<p>but it appears to be properly formed.</p>\n\n<p>The code I'm using is below. User will be passed as a string, e.g. - \"Joe Bloggs\".</p>\n\n<pre><code>Public Sub testSub(user as string)\nDim db as DAO.Database\nDim sqlstr as String\nset db as CurrentDB\n\nsqlstr = \"UPDATE tTable1 SET Field1 = [\" &amp; user &amp; \"] WHERE Field1 IS NULL;\"\n\ndb.Execute sqlstr\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ado", "adodb"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459951389, "post_id": 36453392, "comment_id": 60519593, "body": "You could use a WHERE clause in your SQL? And maybe a TOP?"}, {"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459951780, "post_id": 36453392, "comment_id": 60519918, "body": "The problem is that recordset should be used for several functions, so I can&#39;t use WHERE.. This is the short version of my code."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459953726, "post_id": 36453392, "comment_id": 60521504, "body": "Right now you are only passing one value (Fields(0) as second parameter of Match where an array of value is expected, that&#39;s might be why the complain."}, {"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459954192, "post_id": 36453392, "comment_id": 60521888, "body": "OK, but &#39;0&#39; means first column, and isn&#39;t  <code>rst.Fields(0) </code> an array?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459954735, "post_id": 36453392, "comment_id": 60522320, "body": "No, it means first field of current row of the recordset."}, {"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459955001, "post_id": 36453392, "comment_id": 60522527, "body": "Yes, you are right ! So, I guess the only way is to execute another recordset for this operation."}], "answers": [{"comments": [{"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1459954062, "post_id": 36454256, "comment_id": 60521784, "body": "but the <code>Find</code> method wants ability to move backwards. This gives an error &quot;Rowset does not support scrolling backward&quot;, despite I have set the recordset to dynamic mode: <code>rst.CursorType = adOpenDynamic</code>."}], "tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 0, "last_activity_date": 1459953201, "creation_date": 1459953201, "answer_id": 36454256, "question_id": 36453392, "link": "https://stackoverflow.com/questions/36453392/excel-vba-ado-connection-return-the-date-if-exists-or-the-previous-available/36454256#36454256", "title": "Excel VBA, ADO connection, return the date if exists, or the previous available date", "body": "<p>You might try the recordset find method:</p>\n\n<pre><code>rst.movefirst\nrst.find \"datecolumnname &gt;= \" &amp; mydate\nIf rst.BOF = false then\n  myfunction = rst.fields(0)\nElse\n  Set myfunction = nothing\nEndif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "edited": false, "score": 0, "creation_date": 1460043997, "post_id": 36455787, "comment_id": 60572090, "body": "But I have a question. If I open a connection and than execute the whole recordset, and use filter in function, would this be faster than if I execute data every time ?"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1459956883, "creation_date": 1459956883, "answer_id": 36455787, "question_id": 36453392, "link": "https://stackoverflow.com/questions/36453392/excel-vba-ado-connection-return-the-date-if-exists-or-the-previous-available/36455787#36455787", "title": "Excel VBA, ADO connection, return the date if exists, or the previous available date", "body": "<p>You can try this if you do multiple recordset:</p>\n\n<pre><code>Function myfunction(mydate as date) as date\n    Dim CurrentDate as Date\n    Set rst = cn.Execute(\"SELECT TOP 1 * FROM tbl1 WHERE (dates&lt;=\" &amp; Format(mydate, \"#mm/dd/yyyy#\") &amp; \") ORDER BY tbl1.dates DESC;\")\n    if not rst.EOF then\n        CurrentDate = rst.Fields(0)\n    else\n        'No record found\n    endif\n    myfunction = CurrentDate\nend function\n</code></pre>\n"}], "owner": {"reputation": 44, "user_id": 5069349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b8468b3ca1ac674b09743b3cf851695?s=128&d=identicon&r=PG&f=1", "display_name": "Gedeon", "link": "https://stackoverflow.com/users/5069349/gedeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 36455787, "answer_count": 2, "score": 0, "last_activity_date": 1459956883, "creation_date": 1459951121, "question_id": 36453392, "link": "https://stackoverflow.com/questions/36453392/excel-vba-ado-connection-return-the-date-if-exists-or-the-previous-available", "title": "Excel VBA, ADO connection, return the date if exists, or the previous available date", "body": "<p>I opened a new ADODB connection, and set a new recordset that have dates in the first field and values in the second field.</p>\n\n<ul>\n<li>01/01/2016</li>\n<li>02/01/2016</li>\n<li>04/01/2016</li>\n<li>05/01/2016</li>\n</ul>\n\n<p>So I'm building function <code>myfunction(mydate)</code> that should return the maximum available date which is equal or less(earlier) than mydate:</p>\n\n<pre><code>myfunction(mydate as date)\nDim CurrentDate as Date\n\nSet rst = cn.Execute(\"SELECT * FROM tbl1 ORDER BY dates;\")\nCurrentDate = worksheetfunction.INDEX(rst.Fields(0),worksheetfunction.MATCH(CDate(CurrentDate),rst.Fields(0), 1))\n\nmyfunction = CurrentDate\nend function\n</code></pre>\n\n<p>The results should be</p>\n\n<ul>\n<li>myfunction(\"02/01/2016\") = 02/01/2016</li>\n<li>myfunction(\"03/01/2016\") = 02/01/2016</li>\n</ul>\n\n<p>This works on excel speadsheet, but it gives an error \"Unable to get Match property of the WorksheetFunction\". Is there another way to get the result using this Array ?</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1459951228, "post_id": 36453087, "comment_id": 60519452, "body": "Try using <code>Application.Intersect</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1459951346, "creation_date": 1459951346, "answer_id": 36453494, "question_id": 36453087, "link": "https://stackoverflow.com/questions/36453087/run-time-error-1004-method-intersect-of-object-global-failed/36453494#36453494", "title": "Run-time error &#39;1004&#39;: Method &#39;Intersect&#39; of object&#39; _Global&#39; failed", "body": "<p>Does it work if you change the problem line with this:</p>\n\n<pre><code>if not intersect(A, Target) is nothing then Set Inte = Intersect(A, Target)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1459954624, "creation_date": 1459954624, "answer_id": 36454875, "question_id": 36453087, "link": "https://stackoverflow.com/questions/36453087/run-time-error-1004-method-intersect-of-object-global-failed/36454875#36454875", "title": "Run-time error &#39;1004&#39;: Method &#39;Intersect&#39; of object&#39; _Global&#39; failed", "body": "<p>there's a \"devil touch\" in your code since if the user types \"Closed\" in column \"J\" of the sheet in whose module you're placing this event handler, it deletes the <code>target</code> row (<code>Target.EntireRow.Delete</code>), thus leaving <code>target</code> unreferenced and preparing the ground for throwing an error in any subsequent use of <code>target</code>, which happens to be in <code>Set Inte = Intersect(A, Target)</code></p>\n\n<p>But If I correctly read your code, this shouldn't even happen since this latter line gets done only should target cross column \"C\", which can't be if it's in column \"J\"!.</p>\n\n<p>If what above is correct you may want to use a code like the following</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim nxtRow As Long\nDim Inte As Range, r As Range\n\nApplication.EnableEvents = False\n\nWith Target\n    'Determine Target Colunm\n    If .Column = 10 Then\n\n        'Check for \"Closed\", Copy/Delete Row if found\n        If .Value = \"Closed\" Then\n            nxtRow = Sheets(\"Closed Locks\").Range(\"J\" &amp; Rows.Count).End(xlUp).Row + 1\n            .EntireRow.Copy _\n            Destination:=Sheets(\"Closed Locks\").Range(\"A\" &amp; nxtRow)\n            .EntireRow.Delete\n\n        ElseIf Target = \"TD\" Then\n            'Check for \"TD\", Copy/Delete Row if found\n            nxtRow = Sheets(\"TD Locks\").Range(\"J\" &amp; Rows.Count).End(xlUp).Row + 1\n            .EntireRow.Copy _\n            Destination:=Sheets(\"TD Locks\").Range(\"A\" &amp; nxtRow)\n            .EntireRow.Delete\n        End If\n\n    Else\n\n        'Adds date when borrower name is entered\n        Set Inte = Intersect(.Cells, .Parent.Range(\"C:C\"))\n        If Not Inte Is Nothing Then\n            For Each r In Inte\n                If r.Offset(0, 8).Value = \"\" Then r.Offset(0, 8).Value = Date\n            Next r\n        End If\n\n    End If\nEnd With\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5975247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04fcab60073ece63fc96fae05cdb283e?s=128&d=identicon&r=PG", "display_name": "Solomon3y", "link": "https://stackoverflow.com/users/5975247/solomon3y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "accepted_answer_id": 36454875, "answer_count": 2, "score": 0, "last_activity_date": 1459958263, "creation_date": 1459950432, "last_edit_date": 1459958263, "question_id": 36453087, "link": "https://stackoverflow.com/questions/36453087/run-time-error-1004-method-intersect-of-object-global-failed", "title": "Run-time error &#39;1004&#39;: Method &#39;Intersect&#39; of object&#39; _Global&#39; failed", "body": "<p>I'm still fairly new at this and was trying to find an answer. Maybe it's not defined correctly or at all. Maybe it's not pointing to correct work sheet. I'm not really sure... Any help would be greatly appreciated! Thanks!</p>\n\n<p>Getting error on this line:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Set Inte = Intersect(A, Target)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Error code is:\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Run-time error '1004': Method 'Intersect' of object'_Global' failed</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Full code:\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\r\n'Determine Target Colunm\r\n If Target.Column = 10 Then\r\n'Check for \"TD\", Copy/Delete Row if found\r\n  If Target = \"TD\" Then\r\n    Application.EnableEvents = False\r\n      nxtRow = Sheets(\"TD Locks\").Range(\"J\" &amp; Rows.Count).End(xlUp).Row + 1\r\n      Target.EntireRow.Copy _\r\n        Destination:=Sheets(\"TD Locks\").Range(\"A\" &amp; nxtRow)\r\n      Target.EntireRow.Delete\r\n      Application.EnableEvents = True\r\n       Exit Sub\r\n  End If\r\n\r\n'Check for \"Closed\", Copy/Delete Row if found\r\n  If Target = \"Closed\" Then\r\n    Application.EnableEvents = False\r\n      nxtRow = Sheets(\"Closed Locks\").Range(\"J\" &amp; Rows.Count).End(xlUp).Row + 1\r\n      Target.EntireRow.Copy _\r\n        Destination:=Sheets(\"Closed Locks\").Range(\"A\" &amp; nxtRow)\r\n      Target.EntireRow.Delete\r\n      Application.EnableEvents = True\r\n  End If\r\n End If\r\n\r\n'Adds date when borrower name is entered\r\n    Dim A As Range, B As Range, Inte As Range, r As Range\r\n    Set A = Range(\"C:C\")\r\n    Set Inte = Intersect(A, Target)\r\n    If Inte Is Nothing Then Exit Sub\r\n    Application.EnableEvents = False\r\n        For Each r In Inte\r\n            If r.Offset(0, 8).Value = \"\" Then\r\n               r.Offset(0, 8).Value = Date\r\n            End If\r\n        Next r\r\n    Application.EnableEvents = True\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459950491, "post_id": 36452812, "comment_id": 60518824, "body": "I&#39;m not so sure what Selection would point to"}, {"owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459950742, "post_id": 36452812, "comment_id": 60519034, "body": "This is basically where the script is selecting from A2 and then shift+ctrl and left arrow and then down arrow to highlight all the records that need to be copied. If you imagine that the excel sheet has 3 columns and 150 rows per column"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459950821, "post_id": 36452812, "comment_id": 60519105, "body": "I&#39;m not sure <code>Selection</code> would point to some <code>xlSht2</code> cell. Maybe it&#39;s pointing to the hosting application (MSAccess?) current selection. Better go with full range qualification such as <code>xlSht2.Range(xlSht2.range(&quot;A1&quot;), xlSht2.range(&quot;A1&quot;).End(xlToRight).End(xlDown)).Copy Destination:=xlSht.Range(&quot;A1&quot;).End(xlDown).Offset(1, 0)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1459950842, "creation_date": 1459950842, "answer_id": 36453269, "question_id": 36452812, "link": "https://stackoverflow.com/questions/36452812/vba-using-access-to-append-records-from-one-excel-sheet-to-another/36453269#36453269", "title": "VBA Using Access To Append Records from One Excel Sheet To Another", "body": "<p>You don't need to <code>Select</code> areas prior to copying. The example below should work for your situation.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub test()\n    Dim xlShtMaster As Worksheet\n    Dim xlSht2 As Worksheet\n    xlSht2.UsedRange.Copy Destination:=xlShtMaster.Range(\"A1\").End(xlDown).Offset(1, 0)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "edited": false, "score": 0, "creation_date": 1459956568, "post_id": 36454405, "comment_id": 60523737, "body": "Thank you for the quick responses, however it seems im running out of memory when i use the code...This must have something to do with the <code>Copy xlSht.Range(&quot;F1&quot;).End(xlDown).Offset(1, 0)</code> As in my test files there is at most 100*3 columns and the master file is completely empty"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "edited": false, "score": 0, "creation_date": 1459957548, "post_id": 36454405, "comment_id": 60524495, "body": "is master file is the target?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459957724, "post_id": 36454405, "comment_id": 60524657, "body": "you must be sure that there&#39;s at least one non empty cell in column &quot;F&quot; after cell &quot;F1&quot;, otherwise <code>xlSht.Range(&quot;F1&quot;).End(xlDown)</code> would get the cell in the last row and <code>.Offset(1, 0)</code> would try to reach one row more down which doesn&#39;t exist!. Also check for <code>Selection</code> actual meaning"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459957797, "post_id": 36454405, "comment_id": 60524704, "body": "if your master file is empty then it should be xlSht2.Range(Selection, Selection.End(xlDown)).Copy xlSht.Range(&quot;F1&quot;)"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459957887, "post_id": 36454405, "comment_id": 60524783, "body": "you need to check the row count of selection with target whether its between the rows"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459958112, "post_id": 36454405, "comment_id": 60524953, "body": "see the edit in my code. Please mark as solution if its useful to you"}, {"owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "edited": false, "score": 0, "creation_date": 1460016587, "post_id": 36454405, "comment_id": 60551297, "body": "Hi @Karthick Im still getting the memory resources issue. The <code>master</code> file will start out blank with only the headers. So <code>A1:D1</code> will have headers but nothing else. The sheets being imported will have the same headers but data up to a couple of hundred rows"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "edited": false, "score": 0, "creation_date": 1460023052, "post_id": 36454405, "comment_id": 60555775, "body": "@JohnSmith, so you are now out of the error &quot;Run-Time error &#39;424&#39; Object Required&quot;"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1459958075, "last_edit_date": 1459958075, "creation_date": 1459953575, "answer_id": 36454405, "question_id": 36452812, "link": "https://stackoverflow.com/questions/36452812/vba-using-access-to-append-records-from-one-excel-sheet-to-another/36454405#36454405", "title": "VBA Using Access To Append Records from One Excel Sheet To Another", "body": "<p>In your code, Remove the 3 lines before Endif and include this</p>\n\n<pre><code>xlSht2.Range(Selection, Selection.End(xlToRight)).Select\nif xlSht.Range(\"F1\").End(xlDown).row=Rows.Count\n    xlSht2.Range(Selection, Selection.End(xlDown)).Copy xlSht.Range(\"F1\")\nElse    \n    xlSht2.Range(Selection, Selection.End(xlDown)).Copy xlSht.Range(\"F1\").End(xlDown).Offset(1, 0)\nEndif\n</code></pre>\n"}], "owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 1, "accepted_answer_id": 36454405, "answer_count": 2, "score": 0, "last_activity_date": 1459958075, "creation_date": 1459949789, "question_id": 36452812, "link": "https://stackoverflow.com/questions/36452812/vba-using-access-to-append-records-from-one-excel-sheet-to-another", "title": "VBA Using Access To Append Records from One Excel Sheet To Another", "body": "<p>I have an Access DB where I'm trying to copy several worksheets in a single folder into a master excel file</p>\n\n<p>I first build an array of file locations called <code>filedetails</code> for the workbooks and then open each one and paste the contents into the master file. Because i don't want the files pasting over each other. The starting location on the master workbook will always be an offset of 1 from the previous pasting location. All the workbooks are in the same working directory so the code is set up to stop the Main workbook being copied into itself</p>\n\n<p>The code fails at <code>xlSht2.Range(Selection, Selection.End(xlToRight)).Select</code> with the error message</p>\n\n<blockquote>\n  <p>Run-Time error '424' Object Required</p>\n</blockquote>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.Application\")\n\n'## Open Working File\nSet xlBook_A = xlApp.Workbooks.Open(strWF)\nSet xlSht = xlBook_A.Worksheets(1)\n\n' Open Each Sheet and Copy it into the Workbook (Except Worksheet into itself)\nFor intRecord = 1 To UBound(filedetails)\nIf (filedetails(1, intRecord)) &lt;&gt; strWF Then\n    Set xlBook_B = xlApp.Workbooks.Open(filedetails(1, intRecord))\n    Set xlSht2 = xlBook_B.Worksheets(1)\n\n    ' After the rows have been pasted, a new starting point not \"A2\" will need to be set\n    ' This offset will be done after each copy and paste giving an Append operation to MS Excel\n    ' So Sheet A wont overwrite Sheet B\n    xlSht2.Range(Selection, Selection.End(xlToRight)).Select\n    xlSht2.Range(Selection, Selection.End(xlDown)).Select\n    xlSht2.Selection.Copy Destination:=xlSht.Range(\"A1\").End(xlDown).Offset(1, 0)\n\nEnd If\n\nNext intRecord\n</code></pre>\n\n<p>Can anyone see where im going wrong?</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459950106, "post_id": 36452688, "comment_id": 60518516, "body": "you&#39;re almost there. you already have the proper sheets array, you can add a range addresses array and then iterate over the two of them simultaneously to gather both a sheet and the corresponding range over which act with your spell routine (which you didn&#39;t include in the above code)"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459961502, "post_id": 36454079, "comment_id": 60527262, "body": "I learned something new (once again!). I&#39;d add that since the OP&#39;s environment is Excel it could be avoided <code>CheckItNew</code> function and directly go with <code>If Application.CheckSpelling(Range(ss)(1).Text) Then</code>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1459952740, "creation_date": 1459952740, "answer_id": 36454079, "question_id": 36452688, "link": "https://stackoverflow.com/questions/36452688/vba-spell-check-specific-cells-in-excel/36454079#36454079", "title": "VBA Spell check specific cells in Excel", "body": "<p>To check spelling in specific cells try:</p>\n\n<pre><code>Sub bbuller()\n    Dim boo As Boolean\n\n    s = Array(\"Invoice!D15\", \"Invoice!D16\", \"Invoice!D17\", \"Invoice!D18\", \"Invoice!D19\", \"'Safety Inspection'!D38\")\n    For Each ss In s\n        boo = CheckItNew(Range(ss))\n        If boo Then\n            MsgBox ss &amp; \" has no errors\"\n        Else\n            MsgBox ss &amp; \" has errors\"\n        End If\n    Next ss\nEnd Sub\n\nPublic Function CheckItNew(r As Range) As Boolean\n    Dim MyText As String\n    MyText = r(1).Text\n    Dim oxlAp As Object\n    Set oxlAp = CreateObject(\"Excel.Application\")\n    CheckItNew = oxlAp.CheckSpelling(MyText)\n    oxlAp.Quit\n    Set oxlAp = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 1359157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/63d118bc646d3c55e957050b7be3e677?s=128&d=identicon&r=PG", "display_name": "bbuller", "link": "https://stackoverflow.com/users/1359157/bbuller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1512, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459952740, "creation_date": 1459949486, "question_id": 36452688, "link": "https://stackoverflow.com/questions/36452688/vba-spell-check-specific-cells-in-excel", "title": "VBA Spell check specific cells in Excel", "body": "<p>I'm using a macro to, among other things, spell check an invoice I've created in Excel before I save it.  Currently, it spell checks the entire workbook.  I'd like to spell check only certian cells of a specific sheet  (because I don't want to spell check peoples names and addresses on the invoice).</p>\n\n<p>Specifically, I'd like to spell check only cells D15-D19 on sheet \"Invoice\"  and cell D38 on sheet \"Safety Inspection\"</p>\n\n<p>Can someone point me in the right direction?</p>\n\n<p>This is the VBA code that I'm currently using that I'd like to refine:</p>\n\n<pre><code>Option Explicit\nSub SaveAsSafety()\n 'Saves filename as value of A1 plus the current date\n\n\nApplication.CommandBars(\"Tools\").Controls(\"Spelling...\").Execute\n 'Invokes spell check\n\nDim newFile As String, fName As String\n ' Don't use \"/\" in date, invalid syntax\nfName = Range(\"M9\").Value\n 'Change the date format to whatever you'd like, but make sure it's in quotes\nnewFile = fName &amp; \" - \" &amp; Range(\"D10\").Value &amp; \" - \" &amp; Range(\"D9\")\n ' Change directory to suit your PC, including USER NAME\n\nSheets(Array(\"Safety Inspection\", \"Invoice\")).Select\nSheets(\"Safety Inspection\").Activate\n\nChDir _\n\"C:\\Users\\Brian\\Google Drive\\Buller Heating and Air\\Invoices\"\nActiveWorkbook.SaveAs Filename:=newFile\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=Range(\"A1\").Value _\n, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n:=False, OpenAfterPublish:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1459949757, "post_id": 36452625, "comment_id": 60518225, "body": "What have you tried? There is probably a natural solution using the <code>Worksheet_SelectionChange</code> event."}, {"owner": {"reputation": 39, "user_id": 4306173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-zUp100COD5c/AAAAAAAAAAI/AAAAAAAABlY/TZS3HFEGQdQ/photo.jpg?sz=128", "display_name": "Omry Lieber", "link": "https://stackoverflow.com/users/4306173/omry-lieber"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1459951840, "post_id": 36452625, "comment_id": 60519967, "body": "I tried.. I am not know to really write in VBA..."}], "answers": [{"tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 0, "last_activity_date": 1459951377, "creation_date": 1459951377, "answer_id": 36453510, "question_id": 36452625, "link": "https://stackoverflow.com/questions/36452625/get-value-from-specific-background/36453510#36453510", "title": "get value from specific background", "body": "<p>Think of using the conditional formatting. </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 1, "last_activity_date": 1459956230, "creation_date": 1459956230, "answer_id": 36455532, "question_id": 36452625, "link": "https://stackoverflow.com/questions/36452625/get-value-from-specific-background/36455532#36455532", "title": "get value from specific background", "body": "<p>Put this in the code section of the worksheet :</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    With Target\n        If dictColours.Exists(.Interior.ColorIndex) Then\n            Sheets(\"Sheet1\").Range(\"C1\").Value = dictColours(.Interior.ColorIndex)\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>And add this to a new module, replacing the sheet reference:</p>\n\n<pre><code>Public dictColours As Scripting.Dictionary\n\nSub test()\n    Set dictColours = New Scripting.Dictionary\n\n    Dim rngTarget As Range\n    Set rngTarget = Sheets(\"Sheet1\").Range(\"A1\")\n\n    Do While rngTarget.Value &lt;&gt; \"\"\n        dictColours.Add rngTarget.Interior.ColorIndex, rngTarget.Value\n        Set rngTarget = rngTarget.Offset(1, 0)\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 4306173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-zUp100COD5c/AAAAAAAAAAI/AAAAAAAABlY/TZS3HFEGQdQ/photo.jpg?sz=128", "display_name": "Omry Lieber", "link": "https://stackoverflow.com/users/4306173/omry-lieber"}, "edited": false, "score": 0, "creation_date": 1460017880, "post_id": 36458298, "comment_id": 60552124, "body": "Hve you copied that code in the relevant Worksheet code pane and not in a module one. what is not working exactly? what error is thrown at which code line?"}, {"owner": {"reputation": 39, "user_id": 4306173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-zUp100COD5c/AAAAAAAAAAI/AAAAAAAABlY/TZS3HFEGQdQ/photo.jpg?sz=128", "display_name": "Omry Lieber", "link": "https://stackoverflow.com/users/4306173/omry-lieber"}, "edited": false, "score": 0, "creation_date": 1460027032, "post_id": 36458298, "comment_id": 60558684, "body": "this is the error: Compile error: User-defined type not defined"}, {"owner": {"reputation": 39, "user_id": 4306173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-zUp100COD5c/AAAAAAAAAAI/AAAAAAAABlY/TZS3HFEGQdQ/photo.jpg?sz=128", "display_name": "Omry Lieber", "link": "https://stackoverflow.com/users/4306173/omry-lieber"}, "edited": false, "score": 0, "creation_date": 1460028368, "post_id": 36458298, "comment_id": 60559704, "body": "I think Function GetDictColours(sht As Worksheet) As Scripting.Dictionary, this is not in yellow but this is seleced..."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 4306173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-zUp100COD5c/AAAAAAAAAAI/AAAAAAAABlY/TZS3HFEGQdQ/photo.jpg?sz=128", "display_name": "Omry Lieber", "link": "https://stackoverflow.com/users/4306173/omry-lieber"}, "edited": false, "score": 0, "creation_date": 1460029209, "post_id": 36458298, "comment_id": 60560310, "body": "Maybe you have to add a reference to &quot;Microsoft Scripting Runtime&quot; library. I&#39;m not by my PC and can&#39;t state exact step to accomplish this. If you don&#39;t already know ho to do it you can google &quot;vba excel how to add a new library reference&quot;"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459963978, "creation_date": 1459963978, "answer_id": 36458298, "question_id": 36452625, "link": "https://stackoverflow.com/questions/36452625/get-value-from-specific-background/36458298#36458298", "title": "get value from specific background", "body": "<p>elaborating on the very fine solution form Will I'd propose the following alternative code to be entirely put in the code section of the relevant worksheet</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim dictColours As Scripting.Dictionary\n\n    Set dictColours = GetDictColours(Target.Parent)\n\n    With Target\n        If dictColours.Exists(.Interior.ColorIndex) Then\n            .Parent.Range(\"C1\").Value = dictColours(.Interior.ColorIndex)\n        End If\n    End With\nEnd Sub\n\n\nFunction GetDictColours(sht As Worksheet) As Scripting.Dictionary\n    Dim i As Long\n\n    Set GetDictColours = New Scripting.Dictionary\n\n    Do While sht.Range(\"A1\").Offset(i) &lt;&gt; \"\"\n        GetDictColours.Add sht.Range(\"A1\").Offset(i).Interior.ColorIndex, sht.Range(\"A1\").Offset(i).Value\n        i = i + 1\n    Loop\n\nEnd Function\n</code></pre>\n\n<p>aside from some stylistic choices (everyone has his own favorites), it should be more simple for the OP to handle, he being (as he himself stated) a total VBA beginner!</p>\n"}], "owner": {"reputation": 39, "user_id": 4306173, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh6.googleusercontent.com/-zUp100COD5c/AAAAAAAAAAI/AAAAAAAABlY/TZS3HFEGQdQ/photo.jpg?sz=128", "display_name": "Omry Lieber", "link": "https://stackoverflow.com/users/4306173/omry-lieber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1459963978, "creation_date": 1459949347, "last_edit_date": 1459950027, "question_id": 36452625, "link": "https://stackoverflow.com/questions/36452625/get-value-from-specific-background", "title": "get value from specific background", "body": "<p>I have a list with background colors in \"A\" column and value in their ceil is the name of colors.\nI want to do that when I select a cell with a background color this will change the value of \"C1\" value to the value that have in \"A\" column.\n<br />\n(this is not the my real name of the colors, I have a specific name for each colors.)\nLike vlookup but with background colors and in the same ceil.\n<br />\nFor example:\n<a href=\"https://i.stack.imgur.com/rlUKU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rlUKU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you!</p>\n"}, {"tags": ["arrays", "vba", "excel", "return-type", "class-properties"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1459949862, "post_id": 36452556, "comment_id": 60518330, "body": "Your function specification says the return value is a <code>String array</code>. You&#39;re getting the error because your Else condition is attempting to return a single string. To me anyway, this would be a confusing return from a function because I&#39;d have to check the Type of the returned variable before using it. However, to solve your function as written, change the return value from <code>as String</code> to <code>as Variant</code>."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5963642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c16ca33c6ca60a6b687e6462e8522b?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Harper", "link": "https://stackoverflow.com/users/5963642/bryan-harper"}, "edited": false, "score": 0, "creation_date": 1459966876, "post_id": 36452779, "comment_id": 60530652, "body": "That did it! Thanks Alex. Additionally, I needed to use a temp array in the first part of the If statement."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1459949710, "creation_date": 1459949710, "answer_id": 36452779, "question_id": 36452556, "link": "https://stackoverflow.com/questions/36452556/vba-compile-error-cant-assign-to-read-only-property-returning-array-from-custo/36452779#36452779", "title": "VBA Compile Error: Can&#39;t Assign to Read-Only Property Returning Array from Custom Class Get Property", "body": "<p>You need a temporary array to avoid ambiguity between <code>MtbSheets(i)</code> being interpreted as a property/method/function call vs an array access:</p>\n\n<pre><code>ReDim temp(1 To 1) As String\ntemp(1) = pMtbSheets(index)\nMtbSheets = temp \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1459950275, "last_edit_date": 1459950275, "creation_date": 1459949826, "answer_id": 36452821, "question_id": 36452556, "link": "https://stackoverflow.com/questions/36452556/vba-compile-error-cant-assign-to-read-only-property-returning-array-from-custo/36452821#36452821", "title": "VBA Compile Error: Can&#39;t Assign to Read-Only Property Returning Array from Custom Class Get Property", "body": "<p>Edit: of course my answer won't work, you will need to use a temporary array as mentioned by Alex K. in his answer.</p>\n\n<p>Just return the array like you do in your IsMissing() branch:</p>\n\n<pre><code>' Custom Class Properties\nPrivate pMtbSheets() As String\n\n'Get and Let Methods\nPublic Property Get MtbSheets(Optional index As Variant) As String()\n    If IsMissing(index) Then\n        ReDim MtbSheets(1 To UBound(pMtbSheets))\n        MtbSheets = pMtbSheets()\n    Else\n        ReDim MtbSheets(1 To 1)\n        MtbSheets = pMtbSheets(index)\n    End If\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5963642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5c16ca33c6ca60a6b687e6462e8522b?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Harper", "link": "https://stackoverflow.com/users/5963642/bryan-harper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3016, "favorite_count": 1, "accepted_answer_id": 36452779, "answer_count": 2, "score": 3, "last_activity_date": 1459950275, "creation_date": 1459949167, "question_id": 36452556, "link": "https://stackoverflow.com/questions/36452556/vba-compile-error-cant-assign-to-read-only-property-returning-array-from-custo", "title": "VBA Compile Error: Can&#39;t Assign to Read-Only Property Returning Array from Custom Class Get Property", "body": "<p>I'm having an issue with the <em>Get</em> property from a custom class in VBA (Excel 2010). If an index argument is not given, then my Get property should return a reference (at least that's my impression) to the Class' array. If an index is given, it should return the value in the given index in the private array. </p>\n\n<pre><code>' Custom Class Properties\nPrivate pMtbSheets() As String\n\n'Get and Let Methods\nPublic Property Get MtbSheets(Optional index As Variant) As String()\n    If IsMissing(index) Then\n        ReDim MtbSheets(1 To UBound(pMtbSheets))\n        MtbSheets = pMtbSheets()\n    Else\n        ReDim MtbSheets(1 To 1)\n        MtbSheets(1) = pMtbSheets(index) '**Compiler error occures here**\n    End If\nEnd Property\n</code></pre>\n\n<p>Thanks for any help anyone is able to offer</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1459950339, "post_id": 36452504, "comment_id": 60518721, "body": "You didn&#39;t say what list or range you&#39;re filtering as the user types a value into A1. However, look at writing your code to catch the <code>Worksheet_Change</code> event for that worksheet. You can focus on the user&#39;s entry in A1 and then continually apply a filter to whatever list or range you need."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1459951764, "post_id": 36452504, "comment_id": 60519901, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18605402/excel-drop-down-search-function\">Excel Drop Down + search function</a>"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1459951823, "post_id": 36452504, "comment_id": 60519950, "body": "Check out that link; it&#39;s an ingenious solution. I had looked at that previously for exactly your use-case; I couldn&#39;t find anything else that didn&#39;t use VBA."}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 904245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9596a16f097cb7e4aded7a676463fb8b?s=128&d=identicon&r=PG", "display_name": "Todd Page", "link": "https://stackoverflow.com/users/904245/todd-page"}, "is_accepted": false, "score": 0, "last_activity_date": 1459953118, "last_edit_date": 1495541256, "creation_date": 1459953118, "answer_id": 36454216, "question_id": 36452504, "link": "https://stackoverflow.com/questions/36452504/excel-search-from-list-and-select-not-dropdown/36454216#36454216", "title": "Excel search from list and select - not dropdown", "body": "<p>Building off of the answer to <a href=\"https://stackoverflow.com/questions/13934821/vba-for-filtering-columns\">this similar question</a>, I came up with something that should work. I had a similar request recently; I think it's a nice feel as opposed to the usual UI for filters.</p>\n\n<p>My setup looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cuQoV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cuQoV.png\" alt=\"demo setup\"></a></p>\n\n<p>As @PeterT mentions, you will need to use the Worksheet_Change event for that specific sheet, which looks like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim filterField\n    filterField = 0\n\n    If Target.Address = \"$B$2\" Then\n        filterField = 1\n    ElseIf Target.Address = \"$C$2\" Then\n        filterField = 2\n    ElseIf Target.Address = \"$D$2\" Then\n        filterField = 3\n    ElseIf Target.Address = \"$E$2\" Then\n        filterField = 4\n    End If\n\n    If filterField &lt;&gt; 0 Then\n        Call UpdateFilter(filterField, Target.Value)\n    End If\nEnd Sub\n</code></pre>\n\n<p>There's a lot of cleaning up and simplifying that can be done in the code, this version is quick and dirty for this specific example - should not be hard to generalize, but if you need help, leave a comment.</p>\n\n<p>You need some more VBA to update the filters:</p>\n\n<pre><code>Public Sub UpdateFilter(filterField, strValue)\n\n    If strValue = \"\" Then\n        Range(\"B4\").AutoFilter field:=filterField, Criteria1:=\"&lt;&gt;\"\n    Else\n        strValue = strValue &amp; \"*\"\n        Range(\"B4\").AutoFilter field:=filterField, Criteria1:=strValue\n    End If\nEnd Sub\n</code></pre>\n\n<p>End result looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Gg4cH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gg4cH.png\" alt=\"Full Text\"></a></p>\n\n<p>Adding a '*' to the end of the string allows partial matches (\"Begins With...\"):</p>\n\n<p><a href=\"https://i.stack.imgur.com/zAUvq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zAUvq.png\" alt=\"Partial Text\"></a></p>\n"}], "owner": {"reputation": 1494, "user_id": 958429, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/oXnPZ.png?s=128&g=1", "display_name": "Wilest", "link": "https://stackoverflow.com/users/958429/wilest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459953118, "creation_date": 1459949009, "last_edit_date": 1531164843, "question_id": 36452504, "link": "https://stackoverflow.com/questions/36452504/excel-search-from-list-and-select-not-dropdown", "title": "Excel search from list and select - not dropdown", "body": "<p>I've looked quite at a few examples online.  Everything I find is in combo box drop down.  My boss wants to type in excel, for example in <strong>A1</strong> <em>123456</em> and then it must auto filter the data from a list all starting with <em>123456</em>.  Then he selects the option he wants and move on to cell A2.</p>\n\n<p>All the examples I've tried is for a combo box, that is not what he needs.  Can someone please point me in the right direction?  Help will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459949596, "post_id": 36452497, "comment_id": 60518119, "body": "Could you provide a sample of data and what result you expect to get? From what I understand CountIf() in excel or it&#39;s vba counterpart WorksheetFunction.CountIf() seems the appropriate tool."}, {"owner": {"reputation": 3, "user_id": 4843181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101d3898b56144f966787362cf94a040?s=128&d=identicon&r=PG&f=1", "display_name": "Fenrir", "link": "https://stackoverflow.com/users/4843181/fenrir"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1460038446, "post_id": 36452497, "comment_id": 60567731, "body": "Since it is an itterative countif, I was expecting a cumulative distribution function (logarithmic)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4843181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101d3898b56144f966787362cf94a040?s=128&d=identicon&r=PG&f=1", "display_name": "Fenrir", "link": "https://stackoverflow.com/users/4843181/fenrir"}, "edited": false, "score": 0, "creation_date": 1460038269, "post_id": 36453053, "comment_id": 60567592, "body": "I&#39;ve never seen this option on excel, it could in fact work. Thank you for the tip!"}], "tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 0, "last_activity_date": 1459950353, "creation_date": 1459950353, "answer_id": 36453053, "question_id": 36452497, "link": "https://stackoverflow.com/questions/36452497/excel-vba-countif-function/36453053#36453053", "title": "Excel VBA, countif function", "body": "<p>You might be able to solve your problem with a pivot table by having the values grouped by 100.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4843181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101d3898b56144f966787362cf94a040?s=128&d=identicon&r=PG&f=1", "display_name": "Fenrir", "link": "https://stackoverflow.com/users/4843181/fenrir"}, "edited": false, "score": 1, "creation_date": 1460038335, "post_id": 36453405, "comment_id": 60567644, "body": "Excellent! This is exactly what I needed, a well commented code where I could get a grasp of the VBA language."}], "tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": true, "score": 0, "last_activity_date": 1459951141, "creation_date": 1459951141, "answer_id": 36453405, "question_id": 36452497, "link": "https://stackoverflow.com/questions/36452497/excel-vba-countif-function/36453405#36453405", "title": "Excel VBA, countif function", "body": "<p>Inopiae has a great solution to this - pivot table grouped by 100 would probably be the best way to go, but since you're asking about VBA you could do something like this:</p>\n\n<pre><code>Sub CreateNumbers()\n'this will populate the worksheet with column 1 being numbers 1 - 65535\n    Dim topNum&amp;\n    topNum = 65535\n    Dim rA(topNum, 0)\n\n    For i = LBound(rA) To UBound(rA)\n        rA(i, 0) = i\n    Next i\n\n    ActiveSheet.Range(Cells(1, 1), Cells(topNum + 1, 1)) = rA\n\nEnd Sub\n\nSub countifIteration()\n'this will output the number based on criteria\n    Dim rA\n    rA = ActiveSheet.UsedRange\n    '&amp; dim as long\n    Dim Cols&amp;, maxNum&amp;, i&amp;\n\n    'defines maximum number of columns for plotting counts\n    maxNum = Application.WorksheetFunction.Max([a:a])\n    Cols = maxNum / 100\n\n    ReDim rA2(1, Cols)\n    For i = LBound(rA2, 2) To UBound(rA2, 2)\n        rA2(0, i) = CLng(i &amp; \"00\")\n        For j = LBound(rA) To UBound(rA)\n            If rA(j, 1) &gt; rA2(0, i) Then rA2(1, i) = rA2(1, i) + 1\n        Next j\n    Next i\n\n    Range(Cells(1, 3), Cells(2, Cols + 3)) = rA2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4843181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101d3898b56144f966787362cf94a040?s=128&d=identicon&r=PG&f=1", "display_name": "Fenrir", "link": "https://stackoverflow.com/users/4843181/fenrir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 36453405, "answer_count": 2, "score": 0, "last_activity_date": 1459951141, "creation_date": 1459948996, "question_id": 36452497, "link": "https://stackoverflow.com/questions/36452497/excel-vba-countif-function", "title": "Excel VBA, countif function", "body": "<p>Before explaining my current problematic I would like to say that I have very little experience with excel and vba; therefore my struggle here may appear to be silly but it is geniune.</p>\n\n<p>I have a column where I have a range of values going from 0 to say 6500. I would like to <strong>count</strong> the number of values that are above 100, 200, 300 ... 6500 and plot the given number vs 100. 200. 300 etc. </p>\n\n<p>On excel, I could simply use the function <strong>countif</strong> function, but I would like to act on the itteration to englobe most of the values and besides, that would be very laborious. </p>\n\n<p>I am thinking of a simple loop that will count the values for each itteration then writting the result on a particular column but I am not sure of how to do that.</p>\n\n<p>Any help or tip would be very welcome.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1459960765, "post_id": 36452158, "comment_id": 60526819, "body": "If you set a breakpoint and step through the code you might see what causes the unexpected behavior. Without knowing more, one possible suspect is <code>Rows.Count</code> --- without a qualifier I don&#39;t know what rows it refers to by default. You may need to be specify a worksheet or range, e.g. <code>.Range(some_range).Rows.Count</code> to get the behavior you&#39;re looking for."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1459963262, "creation_date": 1459963262, "answer_id": 36458069, "question_id": 36452158, "link": "https://stackoverflow.com/questions/36452158/duplicate-removal-using-an-array-in-vba/36458069#36458069", "title": "Duplicate Removal using an array in vba", "body": "<p>This looks off:</p>\n\n<pre><code>With formattedWS\n    Set targetRange = .Range(.Range(TargetSheetColumn &amp; \"7\"), _\n            .Range(TargetSheetColumn &amp; Rows.Count).End(xlUp))\n    targetArray = targetRange\nEnd With\n</code></pre>\n\n<p>with your supplied values it translates to:</p>\n\n<pre><code>With formattedWS\n    Set targetRange = .Range(.Range(\"G227\"), _\n            .Range(\"G221048576\").End(xlUp))\n    targetArray = targetRange\nEnd With \n</code></pre>\n\n<p>I don't think that's what you intended and should throw an error.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1460452621, "post_id": 36525176, "comment_id": 60736660, "body": "thank you for the help and the answer.  I have gone through it all to make sure I understand what is happening for the future.  Your answer works really well"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1460461105, "post_id": 36525176, "comment_id": 60742714, "body": "<i>It seems to have become almost received wisdom on this site that the task of deleting rows is best achieved by looping through a Range from bottom to top</i> is incorrect. Which a quick search would have revealed."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1460461885, "post_id": 36525176, "comment_id": 60743324, "body": "@brettdj, have to respectfully disagree. Try a &quot;vba row delete&quot; as a quick search and the predominant answer is a Step -1 loop. For top 3 most relevant posts (at least on my system) it&#39;s the accepted answer."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1460464840, "post_id": 36525176, "comment_id": 60745670, "body": "@ambie the first question of those questions doesn&#39;t pose code as an answer, the third has expert commentary and answers that notes range loops are poor practice. And the second uses a loop only as that is exactly where the question was aimed - the question didn&#39;t ask for best methods,  simply to address an existing loop."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1460266851, "last_edit_date": 1592644375, "creation_date": 1460256492, "answer_id": 36525176, "question_id": 36452158, "link": "https://stackoverflow.com/questions/36452158/duplicate-removal-using-an-array-in-vba/36525176#36525176", "title": "Duplicate Removal using an array in vba", "body": "<p>It seems to have become almost received wisdom on this site that the task of deleting rows is best achieved by looping through a <code>Range</code> from bottom to top and deleting each individual row whenever criteria are met. Yet this is really quite an inefficient method. Compare these two snippets, for example:</p>\n<pre><code>Dim r As Long\nDim clock As cTimer\n\nSet clock = New cTimer\n\nclock.StartCounter\nApplication.ScreenUpdating = False\nFor r = 1 To 10000\n    Sheet1.Cells(1, 1).EntireRow.Delete\nNext\nApplication.ScreenUpdating = True\nDebug.Print &quot;Row by row:&quot;; clock.TimeElapsed; &quot;ms&quot;\n\nclock.StartCounter\nApplication.ScreenUpdating = False\nSheet1.Range(&quot;A1:A10000&quot;).EntireRow.Delete\nApplication.ScreenUpdating = True\nDebug.Print &quot;Range:&quot;; clock.TimeElapsed; &quot;ms&quot;\n</code></pre>\n<p>Output is as follows:</p>\n<blockquote>\n<p>Row by row: 2876.18174935641 ms</p>\n<p>Range: 15.2153416146466 ms</p>\n</blockquote>\n<p>These results aren't surprising as it's probably fair to generalise that the greater the number of individual interactions with a <code>Worksheet</code>, the slower the programme will be.</p>\n<p>What's a shame is that some of the posts to do with removing duplicates go to great lengths to read <code>Worksheet</code> values and reference items into arrays in order to avoid excessive sheet interactions. And yet all of those efficiency gains are lost to inefficient row deletion. What's misleading is that these posts sometimes purport to be &quot;quick&quot;.</p>\n<p>Some might argue that they want to carry out tasks on the <code>Worksheet</code> in between row deletions. However, the VBA ranges update their addresses in the same way that an Excel formula range does. Have a look at the code below for an example of this:</p>\n<pre><code>Dim cell As Range\n\nSet cell = Sheet1.Range(&quot;A3&quot;)\nDebug.Print &quot;Address before deletion:&quot;; cell.Address\nSheet1.Range(&quot;A1&quot;).EntireRow.Delete\nDebug.Print &quot;Address after deletion:&quot;; cell.Address\n</code></pre>\n<p>Output is:</p>\n<blockquote>\n<p>Address before deletion:$A$3</p>\n<p>Address after deletion:$A$2</p>\n</blockquote>\n<p>So the following code would still delete cells &quot;A4&quot; and &quot;A6&quot; and the original cells &quot;A8&quot; and &quot;A10&quot;, for example:</p>\n<pre><code>Dim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Sheet1.Range(&quot;A4, A6&quot;)\nSet rng2 = Sheet1.Range(&quot;A8, A10&quot;)\nrng1.EntireRow.Delete\nSheet1.Range(&quot;A5&quot;).Insert xlDown\nrng2.EntireRow.Delete\n</code></pre>\n<p>For a practical application, the OP could genuinely answer the question of 'How do I delete duplicates between two excel sheets quickly vba'? with the following code:</p>\n<pre><code>Private Sub RemoveMatchingRowsAsBatch(refRange As Range, targetRange As Range)\n    Dim refValues As Variant\n    Dim refItems As Collection\n    Dim refIndex As Long\n    Dim refKey As String\n    Dim targetValues As Variant\n    Dim targetIndex As Long\n    Dim targetKey As String\n    Dim test As Variant\n    Dim delRows As Range\n    Dim added As Boolean\n    \n    'Read datasets into arrays\n    refValues = refRange.Value2\n    targetValues = targetRange.Value2\n    \n    'Loop through target values and check if items match\n    Set refItems = New Collection\n    For targetIndex = 1 To UBound(targetValues, 1)\n        If Not IsEmpty(targetValues(targetIndex, 1)) Then\n            targetKey = CStr(targetValues(targetIndex, 1))\n            test = Empty: On Error Resume Next\n            test = refItems(targetKey): On Error GoTo 0\n            \n            'Check if existing ref item list has a match\n            If Not IsEmpty(test) Then\n                targetRange.Cells(targetIndex, 1).EntireRow.Delete\n                If delRows Is Nothing Then\n                    Set delRows = targetRange.Cells(targetIndex, 1)\n                Else\n                    Set delRows = Union(delRows, targetRange.Cells(targetIndex, 1))\n                End If\n            Else\n                'There is no match so continue reading the reference list.\n                Do While refIndex &lt; UBound(refValues, 1)\n                    refIndex = refIndex + 1\n                    If Not IsEmpty(refValues(refIndex, 1)) Then\n                        'Test that the new reference item isn't itself a duplicate.\n                        refKey = CStr(refValues(refIndex, 1))\n                        On Error Resume Next\n                        refItems.Add refKey, refKey\n                        added = Err.Number = 0\n                        On Error GoTo 0\n                        'It isn't a duplicate so check for a match.\n                        If added Then\n                            If refKey = targetKey Then\n                                If delRows Is Nothing Then\n                                    Set delRows = targetRange.Cells(targetIndex, 1)\n                                Else\n                                    Set delRows = Union(delRows, targetRange.Cells(targetIndex, 1))\n                                End If\n                                Exit Do\n                            End If\n                        End If\n                    End If\n                Loop\n                        \n                        \n            End If\n        End If\n    Next\n    \n    'Now delete all rows in one 'batch'.\n    If Not delRows Is Nothing Then\n        delRows.EntireRow.Delete\n    End If\n\nEnd Sub\n</code></pre>\n<p>In actual fact, there are also some misunderstandings about the role and function of variables in the OP's code, and other respondents have already pointed those out. However, in the interest of completeness, a correct reading routine for his/her two <code>Worksheets</code> might be something like the below:</p>\n<pre><code>Public Sub ReadSheets()\n    Dim refFilePath As String\n    Dim refBookName As String\n    Dim refBook As Workbook\n    Dim refSheet As Worksheet\n    Dim refSheetName As String\n    Dim refCol As String\n    Dim refRow As Long\n    Dim refRange As Range\n    Dim refValues As Variant\n    Dim targetBook As Workbook\n    Dim targetSheet As Worksheet\n    Dim targetSheetName As String\n    Dim targetCol As String\n    Dim targetRow As Long\n    Dim targetRange As Range\n    Dim targetValues As Variant\n    \n    'Define your sheet variables.\n    refFilePath = &quot;Z:\\ambie\\VBA&quot;\n    refBookName = &quot;reference.xlsx&quot;\n    refSheetName = &quot;data&quot;\n    refCol = &quot;A&quot;\n    refRow = &quot;2&quot;\n    targetSheetName = &quot;uniques&quot;\n    targetCol = &quot;B&quot;\n    targetRow = &quot;3&quot;\n    \n    'Define the Excel the sheet objects.\n    On Error Resume Next\n    Set refBook = Workbooks(refBookName)\n    On Error GoTo 0\n    If refBook Is Nothing Then\n        Set refBook = Workbooks.Open(refFilePath &amp; &quot;\\&quot; &amp; refBookName)\n    End If\n    Set refSheet = refBook.Worksheets(refSheetName)\n    Set targetBook = ThisWorkbook\n    Set targetSheet = targetBook.Worksheets(targetSheetName)\n    \n    'Read both datasets.\n    With refSheet\n        Set refRange = .Range(.Cells(refRow, refCol), _\n                              .Cells(.Rows.Count, refCol).End(xlUp))\n    End With\n    \n    With targetSheet\n        Set targetRange = .Range(.Cells(targetRow, targetCol), _\n                                 .Cells(.Rows.Count, targetCol).End(xlUp))\n    End With\n    \n    'Call the removal routine here\n    RemoveMatchingRowsAsBatch refRange, targetRange\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "closed_date": 1460461162, "accepted_answer_id": 36525176, "answer_count": 2, "score": 0, "last_activity_date": 1460266851, "creation_date": 1459948148, "last_edit_date": 1495542677, "question_id": 36452158, "link": "https://stackoverflow.com/questions/36452158/duplicate-removal-using-an-array-in-vba", "closed_reason": "Duplicate", "title": "Duplicate Removal using an array in vba", "body": "<p>Hi have used some code from an answer to a question <a href=\"https://stackoverflow.com/questions/13665305/how-do-i-delete-duplicates-between-two-excel-sheets-quickly-vba\">'How do I delete duplicates between two excel sheets quickly vba'</a> and tried to alter this code to suite my own VBA script.  the code does delete rows the same amount as to what is in the array but it is just deleting the first 11 rows.  I am fairly new to VBA and not completely understanding why it is doing this.  Below is a copy of the script I am using.</p>\n\n<pre><code>    Dim overLayWB As Workbook       'Overlay_workbook\n    Dim formattedWB As Workbook     'Formatted_workbook\n    Dim formattedWS As Worksheet    'Current active worksheet (Formatted)\n    Dim overLayWS As Worksheet      'Worksheet in OverLay\n    Dim lastRowFormatted As Long\n    Dim lastRowOverLay As Long\n\n    Dim targetArray, searchArray\n    Dim targetRange As Range\n    Dim x As Long\n\n    'Update these 4 lines if your target and search ranges change\n    Dim TargetSheetName As String: TargetSheetName = \"Formatted\"\n    Dim TargetSheetColumn As String: TargetSheetColumn = \"G22\"\n    Dim SearchSheetName As String: SearchSheetName = \"Overlay\"\n    Dim SearchSheetColumn As String: SearchSheetColumn = \"G22\"\n\n\n\n    'open Overlay workbook\n    Set overLayWB = Workbooks.Open(\"C:\\Documents\\Templates\\Overlaye.xls\") 'Path for workbook Overlay to copy from\n    Set formattedWS = Workbooks(\"Formatted\").Sheets(\"DLT Formatted\")\n    Set overLayWS = Workbooks(\"Overlay\").Sheets(\"Overlay\")\n    Set formattedWB = ThisWorkbook\n\n 'Load target array\n    With formattedWS\n        Set targetRange = .Range(.Range(TargetSheetColumn &amp; \"7\"), _\n                .Range(TargetSheetColumn &amp; Rows.Count).End(xlUp))\n        targetArray = targetRange\n    End With\n\n 'Load Search Array\n    With overLayWS\n        searchArray = .Range(.Range(SearchSheetColumn &amp; \"7\"), _\n                .Range(SearchSheetColumn &amp; Rows.Count).End(xlUp))\n    End With\n\n\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    'Populate dictionary from search array\n    If IsArray(searchArray) Then\n        For x = 1 To UBound(searchArray)\n            If Not dict.exists(searchArray(x, 1)) Then\n                dict.add searchArray(x, 1), 1\n            End If\n        Next\n    Else\n        If Not dict.exists(searchArray) Then\n            dict.add searchArray, 1\n        End If\n    End If\n\n    'Delete rows with values found in dictionary\n    If IsArray(targetArray) Then\n        'Step backwards to avoid deleting the wrong rows.\n        For x = UBound(targetArray) To 1 Step -1\n            If dict.exists(targetArray(x, 1)) Then\n                targetRange.Cells(x).EntireRow.Delete\n            End If\n        Next\n    Else\n        If dict.exists(targetArray) Then\n            targetRange.EntireRow.Delete\n        End If\n    End If\n</code></pre>\n\n<p>Can anyone help me with this it would be much appreicated, I have not altered the scripting correctly, or is it missing something?</p>\n"}, {"tags": ["vba", "excel", "variants"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1459947262, "post_id": 36451534, "comment_id": 60516251, "body": "it might be simpler to use a dictionary.  Have a look here: <a href=\"http://stackoverflow.com/questions/915317/does-vba-have-dictionary-structure\" title=\"does vba have dictionary structure\">stackoverflow.com/questions/915317/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1459951083, "creation_date": 1459951083, "answer_id": 36453376, "question_id": 36451534, "link": "https://stackoverflow.com/questions/36451534/excel-vba-variant-array-lookup/36453376#36453376", "title": "Excel vba Variant array lookup", "body": "<p>Easily doable by abusing <code>MATCH</code>.</p>\n\n<p>The first procedure is just a test for verification, and also an example of how things have to be declared (and conversely, what declarations you would have to change if you need other variable types, etc).</p>\n\n<pre><code>Sub testCaller()\n    Dim testArr1() As Variant ' &lt;~~ Variable type must match\n    Dim testArr2() As Variant '     the variable required in the \n    Dim testArr3() As Variant '     actual procedure\n    Dim testArr4() As Variant\n\n\n    testArr1 = Array(\"abc\", \"abc\", \"def\", \"abc\", \"asdf\", \"bcd\")\n    testArr2 = Array(\"abc\", \"asdf\")\n    Call listUniqueArrayContents(testArr1(), testArr2())\n\n    testArr3 = Array(1, 2, 3, 4, 5)\n    testArr4 = Array(1, 2)\n    Call listUniqueArrayContents(testArr3(), testArr4())\nEnd Sub\n\nSub listUniqueArrayContents(arr() As Variant, arrCompare() As Variant)\n    Dim uniqueValues() As Variant\n    Dim mIndex As Variant\n    Dim j As Integer\n\n    j = 0\n\n    For i = 0 To UBound(arr())\n        ' Reset the placeholder for our MATCH values\n        mIndex = Null\n\n        ' Disable errors, otherwise you get popups every time there's a unique value\n        On Error Resume Next\n\n        ' Call MATCH function\n        mIndex = Application.WorksheetFunction.match(arr(i), arrCompare(), 0)\n\n        ' Restore normal error handling\n        On Error GoTo 0\n\n        If mIndex &lt; 1 Or IsNull(mIndex) Then\n            ' If match variable is Null, it means the value was unique\n            ' So we'll write that value to a separate array to keep track of it\n            If j = 0 Then ReDim Preserve uniqueValues(0 To 0)\n            If j &lt;&gt; 0 Then ReDim Preserve uniqueValues(UBound(uniqueValues()) + 1)\n            uniqueValues(UBound(uniqueValues)) = arr(i)\n            j = j + 1\n        End If\n    Next i\n\n    Debug.Print \"--Unique values:--\"\n    For k = LBound(uniqueValues()) To UBound(uniqueValues())\n        Debug.Print uniqueValues(k)\n    Next k\n    Debug.Print \"--End--\"\nEnd Sub\n</code></pre>\n\n<p>Which, for the test examples, gives you the expected:</p>\n\n<blockquote>\n  <p>--Unique values:--<br>\n  def<br>\n  bcd<br>\n  --End--<br>\n  --Unique values:--<br>\n  3<br>\n  4<br>\n  5<br>\n  --End--</p>\n</blockquote>\n\n<p>Alternatively, you can change this into a <code>Function</code> and have it return the array of unique values. </p>\n\n<p>Change this:<br>\n<code>Sub listUniqueArrayContents(arr() As Variant, arrCompare() As Variant)</code></p>\n\n<p>to this:<br>\n<code>Function listUniqueArrayContents(arr() As Variant, arrCompare() As Variant) As Variant</code> </p>\n\n<p>and replace the last-most <code>For</code>-loop with <code>listUniqueArrayContents = uniqueValues()</code></p>\n"}], "owner": {"reputation": 1225, "user_id": 1466580, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1d1132aedf6fda100febf80d734fe9f8?s=128&d=identicon&r=PG", "display_name": "pshemek", "link": "https://stackoverflow.com/users/1466580/pshemek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 36453376, "answer_count": 1, "score": 0, "last_activity_date": 1459951083, "creation_date": 1459946627, "last_edit_date": 1459948736, "question_id": 36451534, "link": "https://stackoverflow.com/questions/36451534/excel-vba-variant-array-lookup", "title": "Excel vba Variant array lookup", "body": "<p>I have two (non empty) arrays (of variants) with numbers. I would like to list all the data that is in the first array and is not in the second array.</p>\n\n<pre><code>Dim existingWorkerIDs() As Variant\nDim newWorkerIDs() As Variant\n\n  For Each temp In newWorkerIDs\n\n        If existingWorkerIDs.contains(temp) Then\n            ...do sth...\n        End If\n\n   Next temp\n</code></pre>\n\n<p>Is it possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 1, "creation_date": 1459945464, "post_id": 36451010, "comment_id": 60514738, "body": "Unsure what exactly you&#39;re trying to do.  You&#39;re trying to sort the letters alphabetically in each cell?  What are you looking to do with the number notations?"}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1459945685, "post_id": 36451010, "comment_id": 60514895, "body": "Apologies, I am trying to arrange them alphabetically, yes. I also wish to keep the numbers in the same position (which, as I understand, the Sort Function won&#39;t alter anyway)."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459945780, "post_id": 36451010, "comment_id": 60514972, "body": "How did an <b>S</b> get into row #4 <b>??</b>"}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1459947745, "post_id": 36451010, "comment_id": 60516638, "body": "Oh.... that was a typo..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 1, "last_activity_date": 1459946968, "last_edit_date": 1495540241, "creation_date": 1459946157, "answer_id": 36451361, "question_id": 36451010, "link": "https://stackoverflow.com/questions/36451010/is-it-possible-to-sort-an-entire-worksheet-from-left-to-right-using-vba/36451361#36451361", "title": "Is it possible to sort an entire worksheet from left to right using VBA", "body": "<p>Credit to <a href=\"http://www.thespreadsheetguru.com\" rel=\"nofollow noreferrer\">http://www.thespreadsheetguru.com</a> for the alphabetical sort I modified and to brettdj: <a href=\"https://stackoverflow.com/questions/20736071/vba-exclude-special-characters-and-numbers-but-keep-spaces-from-string\">VBA Exclude special characters and numbers but keep spaces from string</a></p>\n\n<pre><code>Sub sortcells(StartRange As Range)\n\n    Dim strArrCell() As String\n    Dim intTemp As Integer\n\n    Do While rngStart.Value &lt;&gt; \"\"\n        intTemp = Split(StartRange.Value, \":\")(0)\n        strArrCell = Split(StripNonAlpha(rngStart.Value), \" \")\n        strArrCell = Alphabetically_SortArray(strArrCell)\n        StartRange.Value = intTemp &amp; \": \" &amp; Join$(strArrCell, \" \")\n        Set StartRange = StartRange.Offset(1, 0)\n    Loop\n\nEnd Sub\n\nFunction Alphabetically_SortArray(myArray() As String) As String()\n\n    Dim x As Long, y As Long\n    Dim TempTxt1 As String\n    Dim TempTxt2 As String\n\n    For x = LBound(myArray) To UBound(myArray)\n      For y = x To UBound(myArray)\n        If UCase(myArray(y)) &lt; UCase(myArray(x)) Then\n          TempTxt1 = myArray(x)\n          TempTxt2 = myArray(y)\n          myArray(x) = TempTxt2\n          myArray(y) = TempTxt1\n        End If\n       Next y\n    Next x\n\n    Alphabetically_SortArray = myArray\n\nEnd Function\n\nFunction StripNonAlpha(TextToReplace As String) As String\n    Dim ObjRegex As Object\n    Set ObjRegex = CreateObject(\"vbscript.regexp\")\n    With ObjRegex\n        .Global = True\n        .Pattern = \"[^a-zA-Z\\s]+\"\n        StripNonAlpha = .Replace(Replace(TextToReplace, \"-\", Chr(32)), vbNullString)\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1459951552, "creation_date": 1459951552, "answer_id": 36453573, "question_id": 36451010, "link": "https://stackoverflow.com/questions/36451010/is-it-possible-to-sort-an-entire-worksheet-from-left-to-right-using-vba/36453573#36453573", "title": "Is it possible to sort an entire worksheet from left to right using VBA", "body": "<p>Hope below code will satisfy</p>\n\n<pre><code>Sub Sort()\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 1 To lastrow\n    lastcolumn = Cells(i, Columns.Count).End(xlToLeft).Column\n    ReDim sortalphabet(lastcolumn - 2) As String\n    For j = 2 To lastcolumn\n        sortalphabet(j - 2) = Cells(i, j)\n    Next j\n    For ii = LBound(sortalphabet) To UBound(sortalphabet) - 1\n        For j = LBound(sortalphabet) To UBound(sortalphabet) - 1\n            If ii &lt; UBound(sortalphabet) Then\n                Condition1 = sortalphabet(j) &gt; sortalphabet(j + 1)\n                If Condition1 Then\n                    t = sortalphabet(j)\n                    sortalphabet(j) = sortalphabet(j + 1)\n                    sortalphabet(j + 1) = t\n                 End If\n            End If\n        Next j\n    Next ii\n    For j = 2 To lastcolumn\n        Cells(i, j) = sortalphabet(j - 2)\n    Next j\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 36453573, "answer_count": 2, "score": 0, "last_activity_date": 1459951552, "creation_date": 1459945266, "last_edit_date": 1459947755, "question_id": 36451010, "link": "https://stackoverflow.com/questions/36451010/is-it-possible-to-sort-an-entire-worksheet-from-left-to-right-using-vba", "title": "Is it possible to sort an entire worksheet from left to right using VBA", "body": "<p>I have a large worksheet with the following information:</p>\n\n<pre><code>1: B T B J S\n\n2: A\n\n3: T S S P E \n\n4: E O R P W\n</code></pre>\n\n<p>Where the numbers all fall into column A. I want to include a line in a VBA script to arrange this entire worksheet to sort all the letters alphabetically, while keeping the numbers in the same position:</p>\n\n<pre><code>1: B B J S T\n\n2: A\n\n3: E P S S T\n\n4: E O P R W \n</code></pre>\n\n<p>This can be carried out on one line at a time, of course, but is it possible to arrange an entire worksheet like this? I know each line being sorted alphabetically from Left to Right will keep the numbers in the same position, so there's no need to consider that. Is there a simple solution I'm missing?</p>\n"}, {"tags": ["vba", "excel", "find", "row"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1459945104, "creation_date": 1459945104, "answer_id": 36450935, "question_id": 36450772, "link": "https://stackoverflow.com/questions/36450772/return-cell-row-and-column-of-a-cell-after-using-find/36450935#36450935", "title": "Return cell row and column of a cell after using find", "body": "<p>Write after your code:</p>\n\n<pre><code>debug.print cell.row\ndebug.print cell.column\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4964444, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/19f8820f57640ae84c044e99880398a3?s=128&d=identicon&r=PG&f=1", "display_name": "yfro", "link": "https://stackoverflow.com/users/4964444/yfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36450935, "answer_count": 1, "score": 1, "last_activity_date": 1518796644, "creation_date": 1459944694, "last_edit_date": 1518796644, "question_id": 36450772, "link": "https://stackoverflow.com/questions/36450772/return-cell-row-and-column-of-a-cell-after-using-find", "title": "Return cell row and column of a cell after using find", "body": "<p>I am searching for a VBA command that in combination with <code>find()</code> (or similar) returns the address of the found cell in a fixed column.</p>\n\n<p>Due to the programm, the value I am searching for exists only once, but apparently I could only return its value, not its location. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Set Cell = Selection.Find(What:=Choice, LookIn:=xlFormulas,_\n LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext,_\n MatchCase:=False, SearchFormat:=False)\n</code></pre>\n\n<p>It is probably an easy question, but help is much appreciated!</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1459945235, "creation_date": 1459945235, "answer_id": 36450998, "question_id": 36450759, "link": "https://stackoverflow.com/questions/36450759/ms-access-vba-trying-to-call-data-from-a-combo-box-but-only-if-a-field-is-empt/36450998#36450998", "title": "Ms Access VBA - Trying to call data from a combo box but only if a field is empty", "body": "<p>Don't treat <code>Is Null</code> like a variable, it is a part of SQL.</p>\n\n<p>You simply need</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>AND [RTWDate] Is Null\n</code></pre>\n\n<p>in your string.</p>\n"}], "owner": {"reputation": 3, "user_id": 6166560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7472363cc7b32895c7f6baa688a476d?s=128&d=identicon&r=PG&f=1", "display_name": "Evans", "link": "https://stackoverflow.com/users/6166560/evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 36450998, "answer_count": 1, "score": 0, "last_activity_date": 1459950583, "creation_date": 1459944676, "last_edit_date": 1459950583, "question_id": 36450759, "link": "https://stackoverflow.com/questions/36450759/ms-access-vba-trying-to-call-data-from-a-combo-box-but-only-if-a-field-is-empt", "title": "Ms Access VBA - Trying to call data from a combo box but only if a field is empty", "body": "<p>From the code below I want [KronosNO] to come from a database Combo box\nbut only if the [RTWDate] column is Null.</p>\n\n<pre><code>Set Rs = Application.CurrentDb.OpenRecordset(\n  \"SELECT * FROM tblAbsence WHERE [KronosNo] = '\" &amp; Me.cmbKronosNo.Value &amp; \"' \n   AND [RTWDate] = '\" &amp; \"Is Null\" &amp; \"' \", dbOpenDynaset)\n</code></pre>\n"}, {"tags": ["vba", "excel", "row-height"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1459944858, "creation_date": 1459944858, "answer_id": 36450848, "question_id": 36450694, "link": "https://stackoverflow.com/questions/36450694/error-1004-the-rowheight-property-of-the-range-object-can-not-be-set-vba/36450848#36450848", "title": "error 1004: The RowHeight property of the Range object can not be set. (VBA)", "body": "<p>Cells do not have row height. Rows have row height. Thus, you need something like this:</p>\n\n<pre><code>Rows(\"142:142\").rowheight =Rows(\"142:142\").rowheight + 4 \n</code></pre>\n"}], "owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2703, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478214999, "creation_date": 1459944496, "last_edit_date": 1478214999, "question_id": 36450694, "link": "https://stackoverflow.com/questions/36450694/error-1004-the-rowheight-property-of-the-range-object-can-not-be-set-vba", "title": "error 1004: The RowHeight property of the Range object can not be set. (VBA)", "body": "<p>The following error message is displayed as soon as my inputfield contains more than 1000 characters:</p>\n\n<blockquote>\n  <p>error 1004: The RowHeight property of the Range object can not be set.</p>\n</blockquote>\n\n<p>When I debug the code, on the following position is the error:</p>\n\n<pre><code>Sheets(\"Tab\").Cells(142, 2).RowHeight = Sheets(\"Tab\").Range(\"F\" &amp; \"142\").Rows.RowHeight + 4\n</code></pre>\n\n<p>The result should be a generated PDF file that contains a table with 2 columns.</p>\n"}, {"tags": ["php", "vba", "excel"], "comments": [{"owner": {"reputation": 4077, "user_id": 2394816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13e6e64263ea27ab1814eebad0649034?s=128&d=identicon&r=PG", "display_name": "Karl Gjertsen", "link": "https://stackoverflow.com/users/2394816/karl-gjertsen"}, "edited": false, "score": 0, "creation_date": 1459945920, "post_id": 36449793, "comment_id": 60515095, "body": "Hi Phil, Welcome to SO. Can you post some code, to help us see what you have tried so far?"}, {"owner": {"reputation": 23, "user_id": 5883870, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154044080866435/picture?type=large", "display_name": "Phil Jones", "link": "https://stackoverflow.com/users/5883870/phil-jones"}, "reply_to_user": {"reputation": 4077, "user_id": 2394816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13e6e64263ea27ab1814eebad0649034?s=128&d=identicon&r=PG", "display_name": "Karl Gjertsen", "link": "https://stackoverflow.com/users/2394816/karl-gjertsen"}, "edited": false, "score": 0, "creation_date": 1460056893, "post_id": 36449793, "comment_id": 60580053, "body": "Question updated to add some code."}, {"owner": {"reputation": 23, "user_id": 5883870, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154044080866435/picture?type=large", "display_name": "Phil Jones", "link": "https://stackoverflow.com/users/5883870/phil-jones"}, "reply_to_user": {"reputation": 4077, "user_id": 2394816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13e6e64263ea27ab1814eebad0649034?s=128&d=identicon&r=PG", "display_name": "Karl Gjertsen", "link": "https://stackoverflow.com/users/2394816/karl-gjertsen"}, "edited": false, "score": 0, "creation_date": 1460061758, "post_id": 36449793, "comment_id": 60582850, "body": "Thanks Karl for editing - and sorry I didn&#39;t realise that the code lines should be set as such."}, {"owner": {"reputation": 4077, "user_id": 2394816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13e6e64263ea27ab1814eebad0649034?s=128&d=identicon&r=PG", "display_name": "Karl Gjertsen", "link": "https://stackoverflow.com/users/2394816/karl-gjertsen"}, "edited": false, "score": 0, "creation_date": 1460061933, "post_id": 36449793, "comment_id": 60582942, "body": "no problem. There&#39;s a bit of a learning curve when you first get started."}, {"owner": {"reputation": 2210, "user_id": 1171790, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c1c715009d0c21222de8dd0522b87c6?s=128&d=identicon&r=PG", "display_name": "jonathanbell", "link": "https://stackoverflow.com/users/1171790/jonathanbell"}, "edited": false, "score": 0, "creation_date": 1484425953, "post_id": 36449793, "comment_id": 70507999, "body": "Any news on how you got this working? I tried something similar. I can see that Excel opens in the Task Manager but I guess IIS doesn&#39;t have permissions to open and run my file on a &quot;desktop&quot;. Any input appreciated."}, {"owner": {"reputation": 23, "user_id": 5883870, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154044080866435/picture?type=large", "display_name": "Phil Jones", "link": "https://stackoverflow.com/users/5883870/phil-jones"}, "edited": false, "score": 0, "creation_date": 1488371992, "post_id": 36449793, "comment_id": 72199621, "body": "Sorry Jonathan - we struggled so found a different route and just used a scheduler service to run on the host system."}], "owner": {"reputation": 23, "user_id": 5883870, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154044080866435/picture?type=large", "display_name": "Phil Jones", "link": "https://stackoverflow.com/users/5883870/phil-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1383, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460232944, "creation_date": 1459942138, "last_edit_date": 1460232944, "question_id": 36449793, "link": "https://stackoverflow.com/questions/36449793/exec-excel-macro-vba-from-php", "title": "Exec excel macro/VBA from php", "body": "<p>I have an Excel Spreadsheet with a set of VBA code that does all sorts of manipulation of data in a database. I now need to automate the running of this overnight - using PHP (Don't ask why PHP - there are reasons involving other things).</p>\n\n<p>The code runs automatically on Open.</p>\n\n<p>I've tried all sorts of things but struggling.</p>\n\n<p>I have a .bat file that executes the Excel - and it works fine from command line in windows.\nIn PHP If I use EXEC or even SYSTEM - it seems to run but does nothing. No Errors either\nEven tried to run the BAT file - but nothing.</p>\n\n<p>Running on Windows IIS.</p>\n\n<p>Any help greatly appreciated.</p>\n\n<p><strong>What I've tried:</strong></p>\n\n<p>I have a .bat file that contains the following; \n<code>\"C:\\Program Files\\Microsoft Office\\Office14\\excel.exe\" /e \"C:\\fls\\web\\phpTest\\DUMMYSsheet.xlsm\"</code>\n...when run in cmd or just double clicked in Windows it works fine - and the Ssheet just outputs a log file to say it's run.</p>\n\n<p>In PHP I have tried the following;</p>\n\n<pre><code>$cmd=\"'C:\\fls\\web\\phpTest\\runit.bat'\";\nsystem(\"cmd /c \".$cmd,$retVal);\n</code></pre>\n\n<p>Returns a 1 value - but doesn't execute the Spreadsheet code</p>\n\n<pre><code>$cmd=\"'C:\\Program Files\\Microsoft Office\\Office14\\excel.exe' /e 'C:\\fls\\web\\phpTest\\DUMMYSsheet.xlsm'\";\nsystem(\"cmd /c \".$cmd,$retVal);\n</code></pre>\n\n<p>Returns a 0 value - but doesn't execute the Spreadsheet code</p>\n\n<pre><code>$cmd=\"'C:\\Program Files\\Microsoft Office\\Office14\\excel.exe' /e 'C:\\fls\\web\\phpTest\\DUMMYSsheet.xlsm'\";\nexec($cmd, $retArr, $retVal);\n</code></pre>\n\n<p>Returns a 1 value - but doesn't execute the Spreadsheet code</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459939874, "post_id": 36448699, "comment_id": 60510534, "body": "Your code works as expected (only column A) for me."}, {"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 1, "creation_date": 1459939905, "post_id": 36448699, "comment_id": 60510558, "body": "Your code works perfectly for me. Do you have any paste links? For example if in cell B1 you have the formula =A1, then when A1 changes B1 will change also... is that kind of situation happening?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1459942759, "post_id": 36448699, "comment_id": 60512675, "body": "Please insure you have no merged cells spanning column <b>A</b>"}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1459945927, "post_id": 36448699, "comment_id": 60515097, "body": "@David, no, I don&#39;t have these links. Looks like my excel was overloaded or something. Not it works without any issues."}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459946024, "post_id": 36448699, "comment_id": 60515175, "body": "@Gary&#39;sStudent, thank you for hint, but I didn&#39;t have column <b>A</b> &quot;expanded&quot;. Looks like my excel was overloaded or something. Not it works without any issues."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1459946888, "post_id": 36448699, "comment_id": 60515922, "body": "Did you previously run a Find operation that looked at the whole workbook rather than a particular sheet? That would cause your problem."}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460015844, "post_id": 36448699, "comment_id": 60550824, "body": "@rory, maybe I used it not in the VBA but in Excel itself.. I didn&#39;t know it could affect my macro"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460017114, "post_id": 36448699, "comment_id": 60551653, "body": "Yes, they affect each other. Safest bet is to run an irrelevant Find operation in your code before you run the Replace. That should reset it to work at Sheet level."}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460031834, "post_id": 36448699, "comment_id": 60562207, "body": "@Rory, you are right, that was the problem. I couldn&#39;t find how to limit <code>Find</code> operation to one Sheet. May you please advice?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460032696, "post_id": 36448699, "comment_id": 60562884, "body": "Just run any Find operation and that should reset it."}], "owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459939339, "creation_date": 1459939339, "question_id": 36448699, "link": "https://stackoverflow.com/questions/36448699/vba-replace-method-replaces-out-of-specified-range", "title": "VBA. Replace method replaces out of specified range", "body": "<p>I have the following code:</p>\n\n<pre><code>Dim wsData as Worksheet\nDim ctryToTex As Range\n\nSet wsData = ActiveSheet\nSet ctryToTex = wsData.Columns(\"A\")\n\nWith ctryToTex\n    .Replace What:=\"01\", Replacement:=\"UK\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"03\", Replacement:=\"Norway\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"04\", Replacement:=\"Sweden\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"05\", Replacement:=\"Finland\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"06\", Replacement:=\"Denmark\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"09\", Replacement:=\"Germany\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"11\", Replacement:=\"Switzerland\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"12\", Replacement:=\"Netherlands\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"13\", Replacement:=\"Belgium\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"16\", Replacement:=\"Italy\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"17\", Replacement:=\"Spain\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\n    .Replace What:=\"21\", Replacement:=\"France\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True\nEnd With\n</code></pre>\n\n<p>I want it to replace numbers with countries in column \"A\", but instead the macro replaces all found values within the worksheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1459939798, "post_id": 36448607, "comment_id": 60510485, "body": "@jeeped this is not the same question as the one marked as duplicate.  I am using the remove duplicated function - the suggested question this duplicates does not.  I am a beginner at VBA so do not understand the code in that question"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459940238, "post_id": 36448607, "comment_id": 60510796, "body": "a) remove duplicates <b>always</b> removed the second; <b>never</b> the first so continually asking for it to remove the first makes no sense b) not understanding the code in that solution does not make it any less a duplicate. try to rework the code and if you run into trouble, post a new question showing your new effort and explain what you are having trouble with."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1459959123, "post_id": 36448607, "comment_id": 60525711, "body": "The question indicates that the user wants to delete the 1st occurrence, if &quot;Remove Duplicates&quot; only keeps the 1st occurrence, then it will not work in this situation. Possibly using &quot;Find&quot;, this will find the 1st occurrence, and then you can delete that row. If you are actually trying to find the last occurrence, then you should indicate this. Check this out...<a href=\"http://stackoverflow.com/questions/28132471/excel-vba-find-last-row-number-where-column-c-contains-a-known-value\">Find Last Occurance</a>"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1459939152, "answer_count": 0, "score": 0, "last_activity_date": 1459939101, "creation_date": 1459939101, "question_id": 36448607, "link": "https://stackoverflow.com/questions/36448607/removeduplicaties-function-in-vba", "closed_reason": "Duplicate", "title": "RemoveDuplicaties Function in VBA", "body": "<p>The RemoveDuplicates function in vba removes the second occurrence, I need to keep the second occurrence and delete the first.</p>\n\n<p>the column I am searching through is unsorted, I need to search a specific column for duplicates and if a duplicate is found then the first occurrence needs the entire row to be deleted, keeping the second</p>\n\n<p>this is the code I have so far.</p>\n\n<pre><code>Dim overLayWB As Workbook       'Overlay workbook\nDim formattedWB As Workbook     'Formatted workbook\nDim formattedWS As Worksheet    'Current active worksheet (Formatted)\nDim overLayWS As Worksheet      'Worksheet in OverLay\nDim lastRowFormatted As Long\nDim lastRowOverLay As Long\n\n'open Overlay workbook\nSet overLayWB = Workbooks.Open(\"C:\\Documents\\Overlay.xls\") 'Path for workbook Overlay to copy from\nSet formattedWS = Workbooks(\"Formatted\").Sheets(\"Formatted\")\nSet overLayWS = Workbooks(\"Overlay\").Sheets(\"Overlay\")\nSet formattedWB = ThisWorkbook\n\n'Find last row in worksheet Formatted\nWith formattedWS\n    lastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\n'Find last row in worksheet OverLay\nWith overLayWS\n    lastRowOverLay = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\n'Copy contents of Overlay over to Formatted\nRange(\"E22:BP\" &amp; lastRowOverLay).Select\n    Selection.Copy\n    ThisWorkbook.Sheets(\"Formatted\").Range(\"E\" &amp; lastRow).PasteSpecial\n\n'Close OverLay Workbook\nApplication.DisplayAlerts = False\noverLayWB.Close\n\n'Find last row after inserting overlay rows\n    With formattedWS\n        lastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n\n'Remove duplicates\n    formattedWS.Range(\"G22:G\" &amp; lastRow).RemoveDuplicates Columns:=5, Header:=xlYes\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4053285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ff308fb4c266f3885c9c4f6e863529?s=128&d=identicon&r=PG", "display_name": "Tim Couwelier", "link": "https://stackoverflow.com/users/4053285/tim-couwelier"}, "edited": false, "score": 1, "creation_date": 1459942241, "post_id": 36448440, "comment_id": 60512274, "body": "Also, if working with a server,  you may want to click &#39;No&#39; when asked if you want to copy it to the local add-in folder. By doing so, you can overwrite the network version with updates / extended functions for all users without having to redo the process. And depending on the nature, build a Ribbon bar with buttons for the functions (using Custom UI Editor, for example).. People tend to be forgetful with shortcut codes"}], "tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 2, "last_activity_date": 1459938649, "creation_date": 1459938649, "answer_id": 36448440, "question_id": 36447988, "link": "https://stackoverflow.com/questions/36447988/how-to-make-excel-addin-for-distributing-excel-macro/36448440#36448440", "title": "How to make excel addin for distributing excel macro", "body": "<p>Create a new file</p>\n\n<p>Copy your macros to the new file</p>\n\n<p>Save the new file as Excel-Addin (*.xlam)</p>\n\n<p>Distribute the Excel-Addin</p>\n\n<p>On the other PC Go to Excel -Options - Addins </p>\n\n<p>Add the botton choose Excel-add-ins press goto</p>\n\n<p>Search for the addin file and tick it</p>\n"}], "owner": {"reputation": 174, "user_id": 2115756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e9592a9a3403d95d72bb0e8d5f0ed38?s=128&d=identicon&r=PG", "display_name": "vladiz", "link": "https://stackoverflow.com/users/2115756/vladiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459938649, "creation_date": 1459937431, "question_id": 36447988, "link": "https://stackoverflow.com/questions/36447988/how-to-make-excel-addin-for-distributing-excel-macro", "title": "How to make excel addin for distributing excel macro", "body": "<p>I have two Excel macros in my personal workbook which I use with a combination of keys. </p>\n\n<p>Now other users want to have these macros and use them with a combination of keys. I have found information that the easiest way is to create an Excel addin and they have to install it. </p>\n\n<p>What is the process of creating this excel addin with my two macros, and then how can I install it to other users?</p>\n\n<p>We are using Excel 2013.</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1459940300, "creation_date": 1459940300, "answer_id": 36449093, "question_id": 36447835, "link": "https://stackoverflow.com/questions/36447835/vba-optimizing-macro-loop/36449093#36449093", "title": "VBA Optimizing macro loop", "body": "<p>try this</p>\n\n<pre><code>Option Explicit\n\nSub CountInvestorsByTwitterName2()\n    Dim row_total As Long\n    Dim Unqiue_Twitter_Names As Range\n    Dim found As Range\n\n    Dim sht As Worksheet\n    Dim r As Range, shtRng As Range\n\n    With Application\n        .Calculation = xlCalculationManual: .ScreenUpdating = False: .DisplayAlerts = False\n    End With\n\n    With Sheets(\"UNIQUE_DATA\")\n        .Columns(\"B:XFD\").EntireColumn.Delete\n        Set Unqiue_Twitter_Names = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).SpecialCells(xlCellTypeConstants, xlTextValues)\n    End With\n\n    For Each sht In Sheets\n        With sht\n            If .Name &lt;&gt; \"UNIQUE_DATA\" Then\n                Set shtRng = .Range(\"B2:B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row).SpecialCells(xlCellTypeConstants, xlTextValues)\n                For Each r In shtRng\n                    Set found = Unqiue_Twitter_Names.Find(What:=r.Value, LookIn:=xlValues, LookAt:=xlWhole)\n                    If Not found Is Nothing Then\n                        With found\n                            .Offset(0, 1).Value = CDbl(.Offset(0, 1).Value) + 1\n                            .End(xlToRight).Offset(0, 1).Value = sht.Name\n                        End With\n                    End If\n                Next\n            End If\n        End With\n    Next\n\n    With Application\n        .Calculation = xlCalculationAutomatic: .ScreenUpdating = True: .DisplayAlerts = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>if not sufficiently fast, you could try some \"array\" approach, storing relevant sheet cells values in a array and performing searching with them</p>\n\n<p>also a Dictionary approach could be worth examinating</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 4053285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ff308fb4c266f3885c9c4f6e863529?s=128&d=identicon&r=PG", "display_name": "Tim Couwelier", "link": "https://stackoverflow.com/users/4053285/tim-couwelier"}, "is_accepted": false, "score": 0, "last_activity_date": 1459942918, "creation_date": 1459942918, "answer_id": 36450118, "question_id": 36447835, "link": "https://stackoverflow.com/questions/36447835/vba-optimizing-macro-loop/36450118#36450118", "title": "VBA Optimizing macro loop", "body": "<p>What I would do:</p>\n\n<p>1) Clear the entire 'UNIQUE_DATA' sheet.<br>\n2) Loop through all worksheets, and if the name of the sheet isn't 'UNIQUE DATA', copy all rows with content to 'UNIQUE_DATA' (copy-paste rows, after detecting beforehand which rows, and at which lines to insert them)<br>\n3) Sort all rows in 'UNIQUE DATA' on the column containing the twitter handles. Macro code is easy to figure out if you macro-record it once.<br>\n4) Loop through all rows in sheet 'UNIQUE_DATA', and compare value of Twitter handle with the Twitter handle for the row below. If they match, delete the next row (and lower the upper bound of your loop counter).</p>\n\n<p>You should end up with all unique Twitter handles.\nI do have to agree the last step may take some time. But at least doing this is a complexity of O(n) rather then O(n\u00b2) you currently have with two nested loops. Especially for high values of n, the time difference should be significant.</p>\n"}], "owner": {"reputation": 13, "user_id": 6165738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3da9226e77112c10f8b8de47dd7dc993?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Davis", "link": "https://stackoverflow.com/users/6165738/ryan-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 36449093, "answer_count": 2, "score": 1, "last_activity_date": 1459942918, "creation_date": 1459937030, "last_edit_date": 1459938291, "question_id": 36447835, "link": "https://stackoverflow.com/questions/36447835/vba-optimizing-macro-loop", "title": "VBA Optimizing macro loop", "body": "<p>The scenario is that I have 40 sheets and there can be up to ~5k rows in each sheet so I'm dealing with a lot of data which is causing this macro to run extremely slow. For example the first sheet alone has around 15219162 computations which only has about 380 rows. Is there a way to trim down the amount of computations my macro has to run?</p>\n\n<p>There is 39326 unqiue twitter names so far which means 39326 x 387 rows in the first page.</p>\n\n<pre><code>Sub CountInvestorsByTwitterName()\n    With Application\n        .Calculation = xlCalculationManual: .ScreenUpdating = False: .DisplayAlerts = False\n    End With\n    Dim row_total As Long\n    Dim Unique_Values_Sheet As Worksheet\n    Set Unique_Values_Sheet = Sheets(Sheets.Count)\n    Unique_Values_Sheet.Columns(\"B:XFD\").EntireColumn.Delete\n    Dim Unique_Values_Sheet_row_total As Long\n    Unique_Values_Sheet_row_total = Unique_Values_Sheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    Dim Unqiue_Twitter_Names As Range\n    Set Unqiue_Twitter_Names = Unique_Values_Sheet.Range(\"A2:A\" &amp; Unique_Values_Sheet_row_total).Cells\n    For Each s In Sheets\n        If s.Name &lt;&gt; \"UNIQUE_DATA\" Then\n            row_total = s.Cells(Rows.Count, \"B\").End(xlUp).Row\n            For Each r In s.Range(\"B2:B\" &amp; row_total).Cells\n                    Twitter_Name = r.Value\n                    For Each c In Unqiue_Twitter_Names\n                        If c.Value = Twitter_Name Then\n                            With c\n                                .Offset(0, 1).Value = CDbl(.Offset(0, 1).Value) + 1\n                                .End(xlToRight).Offset(0, 1).Value = s.Name\n                            End With\n                        End If\n                    Next\n            Next\n        End If\n        ' Loop through first sheet\n'        Exit For\n    Next\n    With Application\n        .Calculation = xlCalculationAutomatic: .ScreenUpdating = True: .DisplayAlerts = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2887101, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003029800027/picture?type=large", "display_name": "John Sampson", "link": "https://stackoverflow.com/users/2887101/john-sampson"}, "edited": false, "score": 0, "creation_date": 1459957658, "post_id": 36448685, "comment_id": 60524595, "body": "I think the problem is that the line starting &quot;Catch:&quot; is run even if there is no error. This is rather obvious once I see it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1540566811, "last_edit_date": 1540566811, "creation_date": 1459939310, "answer_id": 36448685, "question_id": 36447813, "link": "https://stackoverflow.com/questions/36447813/excel-vba-detecting-empty-cell-to-end-loop/36448685#36448685", "title": "Excel VBA: Detecting empty cell to end loop", "body": "<p>Provided you're on the right sheet (replace below) the code you posted should work</p>\n\n<pre><code>i = 1    \nDo While sheets(\"sheet1\").Cells(i, 6).Value &lt;&gt; \"\"\n     i = i + 1\nLoop\n</code></pre>\n\n<p>Could you post a screenshot of the column end? Your error handling may be preventing the error message too, try disabling that temporarily. Do the columns all end on a certain row? You could specify \"<code>do while not blank AND row &lt; end row</code>\".</p>\n"}], "owner": {"reputation": 11, "user_id": 2887101, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003029800027/picture?type=large", "display_name": "John Sampson", "link": "https://stackoverflow.com/users/2887101/john-sampson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1521, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540566811, "creation_date": 1459936981, "last_edit_date": 1540566715, "question_id": 36447813, "link": "https://stackoverflow.com/questions/36447813/excel-vba-detecting-empty-cell-to-end-loop", "title": "Excel VBA: Detecting empty cell to end loop", "body": "<p>In Excel 2007 I have imported data consisting of a column of rows. I wish to set a VBA script to read through the data from top to bottom, using a loop. The loop should continue to iterate while the cell in the sixth column is not empty.\nI have tried:</p>\n\n<pre><code>Do While IsEmpty(Cells(i,6)) = False\n    ...\n    i = i + 1\nLoop\n</code></pre>\n\n<p>...and also</p>\n\n<pre><code>Do While Cells(i, 6).Value &lt;&gt; \"\"\n    ...\n    i = i + 1\nLoop\n</code></pre>\n\n<p>The loop does what it is supposed to but an error ensues because the program goes on reading below the block of data. (I inserted \"<code>On Error GoTo Catch</code>\" in the loop, then after the loop \"<code>Catch: MsgBox Cells(i, 6).Value &amp; \"Error</code>\" so as to confirm that an error occurs).</p>\n\n<p>There is nothing in the loop that would affect <code>Cells(i,6)</code>.</p>\n\n<p>There are many questions in Stack Overflow about empty cells but the answers tend to avoid the issue how to detect an empty cell to make a loop end. Is there a way of doing this?</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3286772, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aMMfZ.jpg?s=128&g=1", "display_name": "Rayearth", "link": "https://stackoverflow.com/users/3286772/rayearth"}, "edited": false, "score": 0, "creation_date": 1459940091, "post_id": 36447935, "comment_id": 60510685, "body": "Works as expected if data range is in one column. Can this solution be adopted to data in several columns with only one Text Box?"}, {"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "reply_to_user": {"reputation": 69, "user_id": 3286772, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aMMfZ.jpg?s=128&g=1", "display_name": "Rayearth", "link": "https://stackoverflow.com/users/3286772/rayearth"}, "edited": false, "score": 0, "creation_date": 1459940405, "post_id": 36447935, "comment_id": 60510909, "body": "You could do this by having a single column with an if statement looking at multiple columns and filtering on that combined column. i.e. if A = 2 or B = 2 Then 1 Else 0 and filter only for values in column C (the if statement) that have a value of 1 (i.e. meeting the condition that you have set)"}, {"owner": {"reputation": 69, "user_id": 3286772, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aMMfZ.jpg?s=128&g=1", "display_name": "Rayearth", "link": "https://stackoverflow.com/users/3286772/rayearth"}, "edited": false, "score": 0, "creation_date": 1459940667, "post_id": 36447935, "comment_id": 60511080, "body": "Thanks, I&#39;ll try that later. Much appreciated."}, {"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "reply_to_user": {"reputation": 69, "user_id": 3286772, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aMMfZ.jpg?s=128&g=1", "display_name": "Rayearth", "link": "https://stackoverflow.com/users/3286772/rayearth"}, "edited": false, "score": 0, "creation_date": 1459940704, "post_id": 36447935, "comment_id": 60511117, "body": "So you can use the following if statement in column D, &quot;= IF(XOR(IF(B5=$A$1,1,0),IF(C5=$A$1,1,0))=TRUE, 1, 0)&quot; and Filter on B4:D5000. Then set the Criteria=&quot;1&quot; and use Field = 3 in the VBA code"}], "tags": [], "owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "is_accepted": true, "score": 1, "last_activity_date": 1459940048, "last_edit_date": 1459940048, "creation_date": 1459937287, "answer_id": 36447935, "question_id": 36447259, "link": "https://stackoverflow.com/questions/36447259/vba-to-filter-data-as-you-type-numbers/36447935#36447935", "title": "VBA to filter data as you type (numbers)", "body": "<p>Follow the steps that the link did and then use the following code replacing the Range(\"$B$4:$B$5000\") sections with the actual data you want to filter. This also assumes that you are linking the Text Box to Cell A1.</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\nActiveSheet.Range(\"$B$4:$B$5000\").AutoFilter Field:=1, Criteria1:=\"\" &amp; CStr(Excel.ActiveSheet.Range(\"A1\").Value) &amp; \"\"\n\nEnd Sub\n</code></pre>\n\n<p>Additionally you may want to get all values that contain that integer in the number and you could use the following (although considerably slower)</p>\n\n<pre><code>Private Sub TextBox1_Change()\nApplication.ScreenUpdating = False\nvCheck = CStr(Range(\"A1\").Value)\nFor Each vCell In Range(\"B5:B5000\")\nvValue = CStr(vCell.Value)\nIf Not CBool(InStr(1, vValue, vCheck, vbBinaryCompare)) Then\nhideRow = vCell.Row\nRows(hideRow).Hidden = True\nElse\nhideRow = vCell.Row\nRows(hideRow).Hidden = False\nEnd If\nNext vCell\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 3286772, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aMMfZ.jpg?s=128&g=1", "display_name": "Rayearth", "link": "https://stackoverflow.com/users/3286772/rayearth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "accepted_answer_id": 36447935, "answer_count": 1, "score": -2, "last_activity_date": 1459940048, "creation_date": 1459935680, "question_id": 36447259, "link": "https://stackoverflow.com/questions/36447259/vba-to-filter-data-as-you-type-numbers", "title": "VBA to filter data as you type (numbers)", "body": "<p>How can this solution be modified to work with numbers? As for now it only works if the filtering phrase is text.</p>\n\n<p><a href=\"http://chandoo.org/wp/2015/08/22/filter-as-you-type-excel/\" rel=\"nofollow\">http://chandoo.org/wp/2015/08/22/filter-as-you-type-excel/</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459935217, "post_id": 36446538, "comment_id": 60507062, "body": "Just a small hint - when everything appears the right way when you do simple commands - then use macro recorder and edit the code with it."}, {"owner": {"reputation": 21, "user_id": 5964229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81037cf2260a60fb0a18020ca9b241de?s=128&d=identicon&r=PG&f=1", "display_name": "The Pony", "link": "https://stackoverflow.com/users/5964229/the-pony"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459942094, "post_id": 36446538, "comment_id": 60512148, "body": "Yes that was the first thing I did! Unfortunately the result was the same. The recorder gives out the code: ActiveSheet.PasteSpecial Format:=&quot;Unicode-Text&quot;, link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459942459, "post_id": 36446538, "comment_id": 60512448, "body": "How about &quot;.PasteSpecial Paste:=xlPasteFormats&quot;"}, {"owner": {"reputation": 21, "user_id": 5964229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81037cf2260a60fb0a18020ca9b241de?s=128&d=identicon&r=PG&f=1", "display_name": "The Pony", "link": "https://stackoverflow.com/users/5964229/the-pony"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459942877, "post_id": 36446538, "comment_id": 60512760, "body": "Maybe I&#39;m doing it wrong. But I get Error 1004. ActiveSheet.PasteSpecial Paste:=xlPasteFormats"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459943491, "post_id": 36446538, "comment_id": 60513216, "body": "activesheet.range(&quot;A1&quot;).pastespecial paste:=xlPasteFormats"}, {"owner": {"reputation": 21, "user_id": 5964229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81037cf2260a60fb0a18020ca9b241de?s=128&d=identicon&r=PG&f=1", "display_name": "The Pony", "link": "https://stackoverflow.com/users/5964229/the-pony"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1459944816, "post_id": 36446538, "comment_id": 60514219, "body": "Nope. Still 1004 PasteSpecial method couldnt be applied to the range object"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5964229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81037cf2260a60fb0a18020ca9b241de?s=128&d=identicon&r=PG&f=1", "display_name": "The Pony", "link": "https://stackoverflow.com/users/5964229/the-pony"}, "is_accepted": false, "score": 0, "last_activity_date": 1460356315, "last_edit_date": 1460356315, "creation_date": 1460029463, "answer_id": 36475206, "question_id": 36446538, "link": "https://stackoverflow.com/questions/36446538/vba-clipboard-paste-changes-date-to-us-format/36475206#36475206", "title": "vba: clipboard paste changes date to US format", "body": "<p>Since there doesn't seem to be an easy answer to this particular problem I wrote myself a workaround.</p>\n\n<p>This workaround is only necessary if you paste from windows clipboard and you have a lot of different data. Excel to excel has different possibilities. </p>\n\n<pre><code>Dim iDay As Integer\nDim iMonth As Integer\nDim iYear As Integer\nDim currRow As Integer\nDim iName As String\n\n'Change date to correct date because of xl bug\ncurrRow = 3\niName = ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 4)\n\nDo While iName &lt;&gt; \"\"\n    If InStr(1, ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 2), \"/\", vbTextCompare) &lt;&gt; 0 Then\n        ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 2).Replace \"/\", \".\"\n    Else\n        iDay = Split(ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 2), \".\")(1)\n        iMonth = Split(ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 2), \".\")(0)\n        iYear = Split(ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 2), \".\")(2)\n        ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 2) = DateSerial(iYear, iMonth, iDay)\n    End If\ncurrRow = currRow + 1\niName = ThisWorkbook.Sheets(\"YourSheet\").Cells(currRow, 4)\nLoop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5964229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81037cf2260a60fb0a18020ca9b241de?s=128&d=identicon&r=PG&f=1", "display_name": "The Pony", "link": "https://stackoverflow.com/users/5964229/the-pony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460356315, "creation_date": 1459933932, "last_edit_date": 1531164843, "question_id": 36446538, "link": "https://stackoverflow.com/questions/36446538/vba-clipboard-paste-changes-date-to-us-format", "title": "vba: clipboard paste changes date to US format", "body": "<p>I'm pretty sure that somewhere, someone already managed to explain this problem, but I just cant find the right answer for me.</p>\n\n<p>Here is the situation:\nOut of a program I copy a list to the clipboard of windows with values like this</p>\n\n<blockquote>\n  <p>Something Date      Time      Something  Something ...</p>\n  \n  <p>Bla       31/03/16  02:20:22  Bla        Bla</p>\n  \n  <p>Bla       01/04/16  03:10:10  Bla        Bla</p>\n</blockquote>\n\n<p>Then the VBA code finds the last free Row and does</p>\n\n<pre><code>.PasteSpecial xlPasteAll\n</code></pre>\n\n<p>The Result in Excel is</p>\n\n<blockquote>\n  <p>Bla 31/03/2016 20:22,0 Bla Bla</p>\n  \n  <p>Bla 04.01.2016 10:10,0 Bla Bla</p>\n</blockquote>\n\n<p>And that's not what it should be.</p>\n\n<p>I tried <code>.PasteSpecial Format:=\"Unicode-Text\"</code> with the same result</p>\n\n<p>I cant get <code>Paste:=xlValues</code> and so on to work. (1004)</p>\n\n<p>The best part is, if I right click (or ctrl+v) the sheet and past it, EVERYTHING just magically appears the right way.</p>\n\n<blockquote>\n  <p>Bla 31.03.2016 02:20:22 Bla Bla</p>\n  \n  <p>Bla 01.04.2016 03:10:10 Bla Bla</p>\n</blockquote>\n\n<p>So I assume I'm doing something very stupid and I just need to find the vba expression to make it right.</p>\n\n<p>Can someone please help me.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1459973623, "creation_date": 1459973623, "answer_id": 36461418, "question_id": 36446331, "link": "https://stackoverflow.com/questions/36446331/vba-select-account-from-which-download-emails/36461418#36461418", "title": "VBA select account from which download emails", "body": "<p>Instead of using <code>Namespace.GetDefaultFolder</code>, loop through the <code>Namespace.Stores</code> collection (Outlook 2010 and up), find the store you need to process, use <code>Store.GetDefaultFolder</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 3322937, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001501209894/picture?type=large", "display_name": "Kristaps G", "link": "https://stackoverflow.com/users/3322937/kristaps-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "closed_date": 1460015757, "answer_count": 1, "score": 0, "last_activity_date": 1593072412, "creation_date": 1459933415, "last_edit_date": 1593072412, "question_id": 36446331, "link": "https://stackoverflow.com/questions/36446331/vba-select-account-from-which-download-emails", "closed_reason": "Duplicate", "title": "VBA select account from which download emails", "body": "<p>Working on some small project, which download data from outlook 2013, but I'm stuck to one place, where I can change outlook account, and then download their inbox/sent mail/etc. </p>\n\n<p>Problematic place is where are those **** where are determened folder, and email(syntax there is wrong) - there I need help.</p>\n\n<pre><code>Sub export_mail_from_outlook()\n\nDim objItm As Object\nDim objFolder As Folder\nDim xlApp As Excel.Application\nDim xlWb As Excel.Workbook\nDim objParent As Folder\nDim lRow As Long\nDim epasts As String, mape As String\n\n    epasts = ThisWorkbook.Sheets(\"Main desk\").Cells(5, 2)\n    mape = ThisWorkbook.Sheets(\"Main desk\").Cells(6, 2)\n\n'Izveidojam jaunu failu un sheetu, kur liksim vajadzigo informaciju\n    Set xlApp = New Excel.Application\n    Set xlWb = xlApp.Workbooks.Add\n    Set xlSht = xlWb.Sheets(1)\n'nosaucam faila ieklauto sheetu/izklajlapu\n    xlSht.Name = \"Inbox Mail Data\"\n'konkretaja sheet/izklajlapa definejam pirmas rindas/kolonnu nosaukumus(bez si var ari iztikt, tikai tad ir jamaian lRow vertiba)\n    With xlSht\n        .Cells(1, 1) = \"Mape\"\n        .Cells(1, 2) = \"T\u0113ma\"\n        .Cells(1, 3) = \"E-pasta sa\u0146em\u0161anas datums\"\n        .Cells(1, 4) = \"Teksts\"\n        .Cells(1, 5) = \"S\u016bt\u012bt\u0101js\"\n        .Cells(1, 6) = \"Izmantotais epasts\"\n    End With\n\n'mapes dzilumu mainit saja vieta, var nemt visu, kas ir tikai Inbox mape,\n'var nemt visus, kas ir mapes apaksmape,\n'un var nemt mapes un apaksmapes epastus\n    ****Set objOutlook = CreateObject(\"Outlook.Application\")\n    ****Set objNameSpace = objOutlook.GetNamespace(\"MAPI\")\n    ****Set objParent = objNameSpace.GetDefaultFolder(olFolderInbox)\n\n\n'no kuras rindas saks ladet datus\n    lRow = 2\n\n'datuma ierobezojums ierakstiem, visus ierakstus pec konkreta datuma, likt pec vajadzibas(var ari izveidot msgbox un ielasit vertibu, tad sintake bus sekojosa(pielabot)\n\n    StrDate = InputBox(\"No kura datuma ielas\u012bt e-pastus. Datuma forma: yyyy.mm.dd ?\")\n    If IsDate(StrDate) Then\n    LimDate = DateValue(StrDate)\n    Else: MsgBox \"Nav pareizs datuma form\u0101ts, m\u0113gini v\u0113lreiz\"\n    Exit Sub\n    End If\n\n    'LimDate = VBA.DateValue(DateSerial(2016, 3, 1))\n\n        On Error Resume Next\n        With xlSht\n            For Each objItm In objParent.Items\n            If objItm.ReceivedTime &gt;= LimDate Then\n                .Cells(lRow, 1) = objParent\n                .Cells(lRow, 2) = objItm.Subject\n                .Cells(lRow, 3) = objItm.ReceivedTime\n                .Cells(lRow, 4) = objItm.Body\n                .Cells(lRow, 4).WrapText = False\n                .Cells(lRow, 5) = objItm.Sender\n                .Cells(lRow, 6) = epasts\n\n                lRow = lRow + 1\n            End If\n            Next\n        End With\n        On Error GoTo 0\n\n\n'izveidoto failu padarit redzamu\nxlApp.Visible = True\n\n\nSet xlSht = Nothing\nSet xlWb = Nothing\nSet xlApp = Nothing\n\nMsgBox \"No \" &amp; LimDate &amp; \" visi mapes \" &amp; objParent &amp; \" epasta ieraksti no epasta \" &amp; epasts\n\nEnd Sub\n</code></pre>\n\n<p>Multiple accounts - multiple inbox folders - specify email in code and download\n<a href=\"https://i.stack.imgur.com/SUNIb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SUNIb.png\" alt=\"Multiple accounts - multiple inbox folder - specify them in code and download\"></a></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "edited": false, "score": 0, "creation_date": 1459934083, "post_id": 36446265, "comment_id": 60506162, "body": "you want to remove and save just the active worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "edited": false, "score": 0, "creation_date": 1459934469, "post_id": 36446592, "comment_id": 60506447, "body": "Thank you but i get the following error: Run-time error &#39;9&#39;: Subscript out of range"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "reply_to_user": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "edited": false, "score": 0, "creation_date": 1459934886, "post_id": 36446592, "comment_id": 60506813, "body": "You might want to change ThisWorkbook.Sheets(&quot;Sheet1&quot;) to Application.ActiveSheet, just to check you wanted the value in range(&quot;B8&quot;) in the file save name too right? Might want to change Range(&quot;B8&quot;).Value to Application.ActiveSheet.Range(&quot;B8&quot;).Value - have changed to reflect in the code"}, {"owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "edited": false, "score": 0, "creation_date": 1459935326, "post_id": 36446592, "comment_id": 60507152, "body": "great thanks, that has worked but file saved as #060416-username which is fine but would like the text in cell B8 to be in that name also. then when i opened the file that it had saves it was blank and called sheet1 (2)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "reply_to_user": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "edited": false, "score": 0, "creation_date": 1459936177, "post_id": 36446592, "comment_id": 60507786, "body": "updated again - change &quot;Sheet1&quot; to the relevant sheet name in your workbook"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 3, "last_activity_date": 1459936120, "last_edit_date": 1459936120, "creation_date": 1459934063, "answer_id": 36446592, "question_id": 36446265, "link": "https://stackoverflow.com/questions/36446265/excel-macro-to-save/36446592#36446592", "title": "Excel Macro to save", "body": "<p>Something like this - </p>\n\n<pre><code>Sub SaveSheet()\n\nDim wbkDashboard As Workbook\nDim wsTarget As Worksheet\nSet wsTarget = Thisworkbook.worksheets(\"Sheet1\")\n\nDim strFileName As String\nstrFileName = wsTarget.Range(\"B8\").Value _\n    &amp; Format(Now, \"ddmmyyyy\") &amp; \"-\" &amp; Environ(\"username\") &amp; \".xlsx\"\n\nSet wbkDashboard = Workbooks.Add\nwsTarget .Copy Before:=wbkDashboard.Sheets(1)\n\nFor intSheetCount = 2 To wbkDashboard.Sheets.Count\n    wbkDashboard.Sheets(2).Delete\nNext\n\nwbkDashboard.SaveAs \"W:\\Test\\\" &amp; wsTarget.Range(\"B8\").Value  _\n    &amp; Format(Now, \"ddmmyyyy\") &amp; \"-\" &amp; Environ(\"username\") &amp; \".xlsx\"\n\nwbkDashboard.Close\nwsTarget.Range(\"B8\").Value= strFileName\n\nSet wsTarget = Nothing\nSet wbkDashboard = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "edited": false, "score": 0, "creation_date": 1459937262, "post_id": 36447312, "comment_id": 60508653, "body": "Just one more question. Is there a way to stop it saving the initial form. It seems to save data and then export fille dout sheet but then when i open the form again all the data is still there from last entry. Thanks"}], "tags": [], "owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "is_accepted": true, "score": 1, "last_activity_date": 1459937323, "last_edit_date": 1459937323, "creation_date": 1459935802, "answer_id": 36447312, "question_id": 36446265, "link": "https://stackoverflow.com/questions/36446265/excel-macro-to-save/36447312#36447312", "title": "Excel Macro to save", "body": "<p>This code will save any changes you have created in the current version, then it will save just the Active Sheet as a new workbook with the username and date (Credit to @Will on the Environment Variables).</p>\n\n<pre><code>Sub Saveworkbook()\nApplication.DisplayAlerts = False\nDim Sheet1 As Worksheet\nDim dName$, vName$, sName$\n    dName = Range(\"B8\")\n    vName = ActiveWorkbook.FullName\n    sName = ActiveWorkbook.ActiveSheet.Name\n    For Each Sheet1 In ActiveWorkbook.Sheets\n    If Not Sheet1.Name = sName Then\n    Sheet1.Delete\n    End If\n    Next Sheet1\n\n    ActiveWorkbook.SaveAs \"W:\\Test\\\" &amp; dName &amp; \"_\" &amp; Environ(\"username\") &amp; \"_\" &amp; Format(Now, \"ddmmyy\") &amp; \"xlsx\"\n    ActiveWorkbook.Close\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1373, "user_id": 4717141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10155311591285459/picture?type=large", "display_name": "ShizukaNaHaji", "link": "https://stackoverflow.com/users/4717141/shizukanahaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 36447312, "answer_count": 2, "score": 0, "last_activity_date": 1459937323, "creation_date": 1459933273, "last_edit_date": 1459933944, "question_id": 36446265, "link": "https://stackoverflow.com/questions/36446265/excel-macro-to-save", "title": "Excel Macro to save", "body": "<p>I know i should probably be doing this in access or VB but I dont know how to use either. At the moment I have a submit button at the end of my form that saves and closes the workbook as whatever is inputted to a certain cell.</p>\n\n<p>I am looking for a way to be able to do the same thing but break the worksheet out of the workbook. So it saves just the worksheet as its own excel file and with the name inputted into a certain cell. Below is the macro I am currently using.</p>\n\n<pre><code>Sub Saveworkbook()\nApplication.DisplayAlerts = False\nDim dName$, vName$\n    dName = Range(\"B8\")\n    vName = ActiveWorkbook.FullName\n    ActiveWorkbook.SaveAs \"W:\\Test\\\" &amp; dName\n    ActiveWorkbook.SaveAs vName\n    ActiveWorkbook.Close\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>It would also be cool if it could add the date and computers user in to save name but not essential.</p>\n\n<p>Thanks in advance \nSam</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459934840, "post_id": 36446687, "comment_id": 60506775, "body": "thanks for the help. I was also trying to do something similar, the Approach Looks fine to me but somehow nothing happens after the application of this code. I also tried to debug by placing a <code>msgbox &quot;comin here&quot;</code> just after the first If Condition which means that whenever I Change a value in Column B then the Message should appear. But unfortunately it doesnt"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459935138, "post_id": 36446687, "comment_id": 60507004, "body": "a) this belongs in a worksheet&#39;s code sheet, not a module code sheet b) it only adds a comment if there are values in columns B and P, the target (changed cell) is in row 6 or greater, I&#39;ve tested it and it worked well for both adding and removing values."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459935597, "post_id": 36446687, "comment_id": 60507352, "body": "I am calculating the values of Column P by a VLookup based on the values of column B. Which means that, as soon as I select a new Type, I will then get a corresponding value in Column P . The values in column P are not pre stored So Is this a Problem of dynamic calculation or something ? @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459935758, "post_id": 36446687, "comment_id": 60507463, "body": "no. while a formula does not trigger a worksheet_change, changing the value in column B would. i still suspect that you put it in the wrong place since you have not confirmed that you put it into the worksheet&#39;s code sheet."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459935911, "post_id": 36446687, "comment_id": 60507579, "body": "ok ok...I guess I figured out whats Happening. The Debugging works when a value in <code>column P</code> is changed. But It should happen the other way round. Do I Need to swap the ranges ?"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459936329, "post_id": 36446687, "comment_id": 60507907, "body": "Tried to fix It but still the comment does not appear."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459936333, "post_id": 36446687, "comment_id": 60507911, "body": "If you have formulas in column P then they will never be &#39;empty&#39;. I&#39;ve adjusted the code above. See the <a href=\"https://dl.dropboxusercontent.com/u/100009401/Dynamic%20Comments%20in%20Excel.xlsb\" rel=\"nofollow noreferrer\">sample workbook</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459936555, "post_id": 36446687, "comment_id": 60508096, "body": "Perhaps you have crashed with enableevents = false. Put <code>Application.EnableEvents = True</code> in the VBE&#39;s Immediate window and hit [enter] then try again."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459936928, "post_id": 36446687, "comment_id": 60508409, "body": "Yes. It works perfectly in your sample workbook. I am just wondering what could be the Problem ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459937145, "post_id": 36446687, "comment_id": 60508573, "body": "I&#39;m afraid I do not have an answer. Unless it is the enableevents environment variable or simply a corrupt VBA environment, I cannot even speculate."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459937310, "post_id": 36446687, "comment_id": 60508687, "body": "Is it related to the enableevents because I also have alot of code already behind the same worksheet ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459937473, "post_id": 36446687, "comment_id": 60508820, "body": "Yes it could be. EnableEvents must be True in order to trigger the Worksheet_Change. That&#39;s exactly why we turn them off; so changing something inside the Worksheet_Change doesn&#39;t trigger it again."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459945015, "post_id": 36446687, "comment_id": 60514373, "body": "I found another strange Thing. When I Change the value in <code>column P</code>, then the <code>column B</code> has the right comment while it should happen the other way round. Could you think what could be the possible Problem ? Also I have a list to Chose from in the <code>column B</code>. But I dont think so that is a Problem."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459945304, "post_id": 36446687, "comment_id": 60514613, "body": "Or to be more precise, after Debugging I found that it is only detecting changes in the <code>column P</code> and not in <code>column B</code>"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1459947215, "post_id": 36446687, "comment_id": 60516209, "body": "I found out the Problem. The already present code in the worksheet was already searching for <code>column B</code> adn if found then <code>Exit Sub</code> . So this code could not detect any Change in <code>column B</code>. I just placed this code above the old code and it works. Thanks alot for the help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1459936299, "last_edit_date": 1459936299, "creation_date": 1459934251, "answer_id": 36446687, "question_id": 36446074, "link": "https://stackoverflow.com/questions/36446074/dynamic-comments-in-excel/36446687#36446687", "title": "Dynamic Comments in Excel", "body": "<p>To automate this to the level of attaching or changing comments when values in columns B or P change you will need a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow\">Worksheet_Change</a> event macro.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"B:B,P:P\"), Range(\"6:1048576\")) Is Nothing Then\n        On Error GoTo bm_Safe_Exit\n        Application.EnableEvents = False\n        Dim bp As Range\n        For Each bp In Intersect(Target, Range(\"B:B,P:P\"), Range(\"6:1048576\"))\n            Range(\"B\" &amp; bp.Row).ClearComments\n            If Not IsEmpty(Cells(bp.Row, \"B\")) And CBool(Len(Cells(bp.Row, \"P\").Value)) Then\n                Range(\"B\" &amp; bp.Row).AddComment _\n                  Text:=\"Dauer : \" &amp; Range(\"P\" &amp; bp.Row).Value\n            End If\n        Next bp\n    End If\n\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>That should survive pasting or clearing multiple values in columns B and/or P.</p>\n"}], "owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2780, "favorite_count": 0, "accepted_answer_id": 36446687, "answer_count": 1, "score": 1, "last_activity_date": 1459936299, "creation_date": 1459932744, "last_edit_date": 1459932865, "question_id": 36446074, "link": "https://stackoverflow.com/questions/36446074/dynamic-comments-in-excel", "title": "Dynamic Comments in Excel", "body": "<p>I have a worksheet named \"OPL\" . I have Types in <code>column B</code> which is a drop down list. And by a lookup formulae I have already calculated there Number of hours and stored it in <code>column P</code>. Now I Need to add the values in <code>Column P</code> as the comments to the <code>B</code>. I have a code which does that as I want. But the Problem is I Need to run the macro everytime I add a new Type into the list. I want this to happen Dynamically i.e. As soon as I add a new Type, It should automatically take ist respective value from <code>column P</code> and make it a comment. I know that I Need to add this code in the Worksheet code by Setting the <code>Target</code> but somehow I am unable to implement it.</p>\n\n<pre><code>Public Sub addComment()\n\n    Dim row As Integer\n    Dim oldComment As String\n\n    'Set start row\n    row = 6\n\n    With Sheets(\"OPL\")\n\n        'Do until \"B\" cell is blank\n        Do While .Range(\"B\" &amp; row) &lt;&gt; \"\"\n\n            'If \"P\" cell is not blank\n            If .Range(\"P\" &amp; row) &lt;&gt; \"\" Then\n\n\n                'Insert comment for \"A\" with old if exist\n                .Range(\"B\" &amp; row).addComment (\"Dauer : \" &amp; .Range(\"P\" &amp; row).Value)\n\n            End If\n\n            'Increase row\n            row = row + 1\n\n        Loop\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "for-loop", "iteration"], "answers": [{"tags": [], "owner": {"reputation": 365, "user_id": 4890963, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-736h1CBQBh8/AAAAAAAAAAI/AAAAAAAABbc/4ybXk5rbcb4/photo.jpg?sz=128", "display_name": "CyberClaw", "link": "https://stackoverflow.com/users/4890963/cyberclaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1459933131, "creation_date": 1459933131, "answer_id": 36446215, "question_id": 36445836, "link": "https://stackoverflow.com/questions/36445836/is-there-a-for-i-in-foo-bar-baz-construct-in-vba/36446215#36446215", "title": "Is there a for i in (&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;) construct in VBA?", "body": "<p>Your question is a bit generic, but yes, you can do that using <code>For Each</code>. I'll paste some code of my own, and you'll see how it can work:</p>\n\n<pre><code>Sub Example()\n    Dim tempFolderStr As String\n    Dim tempFullStr As String\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim fs As Object\n\n(...)\n\n    Set objFolder = fs.GetFolder(tempFolderStr)\n\n    For Each objFile In objFolder.Files\n        tempFullStr = tempFolderStr &amp; objFile.name\n        Call Delete_File(tempFullStr)\n    Next objFile\n\nEnd Sub\n</code></pre>\n\n<p>This will iterate over every file it finds in the folder tempFolderStr.</p>\n\n<p>I'll leave the link to the apropriate MSDN article: <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/5ebk1751.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 408, "user_id": 183298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa5fa993b2139179bb205cd7c3bd4b7?s=128&d=identicon&r=PG", "display_name": "Sam Russo", "link": "https://stackoverflow.com/users/183298/sam-russo"}, "is_accepted": true, "score": 1, "last_activity_date": 1459949531, "creation_date": 1459949531, "answer_id": 36452704, "question_id": 36445836, "link": "https://stackoverflow.com/questions/36445836/is-there-a-for-i-in-foo-bar-baz-construct-in-vba/36452704#36452704", "title": "Is there a for i in (&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;) construct in VBA?", "body": "<p>Elegantly? You decide.</p>\n\n<p>Try:</p>\n\n<pre><code>Sub test()\n    Dim x As Variant\n\n    For Each x In Array(\"foo\", \"bar\", \"bas\")\n        Debug.Print x\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 36452704, "answer_count": 2, "score": 0, "last_activity_date": 1459949531, "creation_date": 1459932085, "question_id": 36445836, "link": "https://stackoverflow.com/questions/36445836/is-there-a-for-i-in-foo-bar-baz-construct-in-vba", "title": "Is there a for i in (&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;) construct in VBA?", "body": "<p>I have to iterate over a constant list of strings. As far as I know, there is no</p>\n\n<pre><code>for item in (\"foo\", \"bar\", \"baz\")\n   doSth(item)\nnext item\n</code></pre>\n\n<p>I was wondering how I can elegantly program such a construct.</p>\n"}, {"tags": ["arrays", "vba", "filesystemobject"], "answers": [{"tags": [], "owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1459933000, "creation_date": 1459933000, "answer_id": 36446161, "question_id": 36445460, "link": "https://stackoverflow.com/questions/36445460/vba-get-file-count-using-filesystemobject/36446161#36446161", "title": "VBA Get File Count using FileSystemObject", "body": "<p>Although i wasnt able to understand why i was getting the error, I found a function <a href=\"https://www.extendoffice.com/documents/excel/3159-excel-count-files-in-folder-directory.html\" rel=\"nofollow\">online</a> that seems to do what i need. I adapted the function and added the function to the code above</p>\n\n<pre><code>Public Function CountFiles(xPath As String)\n\nDim xCount As Long\nDim xFile As String\n\nxPath = \"C:\\temp\\HelloWorld\\\"\nxFile = Dir(xPath)\nDo While xFile &lt;&gt; \"\"\n    xCount = xCount + 1\n    xFile = Dir()\nLoop\nCountFiles = xCount\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3308, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459933000, "creation_date": 1459931082, "question_id": 36445460, "link": "https://stackoverflow.com/questions/36445460/vba-get-file-count-using-filesystemobject", "title": "VBA Get File Count using FileSystemObject", "body": "<p>I'm writing a function at the moment that tries to get the file paths of all the files that have been uploaded to a SharePoint directory in the last week. I then want to copy the files across to my local PC.</p>\n\n<p>My thinking goes like this</p>\n\n<p><strong>Function 1</strong> - gets a list of a folders</p>\n\n<ul>\n<li><strong>Function2</strong> takes each folder and searches the file paths for each \nfile created in the last week and returns an array of file paths</li>\n</ul>\n\n<p><strong>Function 3</strong> - Copies across the files based on the array of file paths</p>\n\n<p>I'm having trouble with the array. I want to specify the array size in advance based on the number of files in each folder. My code and the error is below</p>\n\n<p>Can anyone see the problem</p>\n\n<pre><code>Public Function get_remoteTables(strPath As String)\n\nDim objFSO As FileSystemObject\nDim objFolder As Folder\nDim objFiles As file\nDim filedetails() As Variant\nDim FileCount As Long\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(strPath)\n\n' Grab all the files in the subfolders\nFor Each objSubFolder In objFolder.SubFolders\n    'print folder path\n    Debug.Print (objSubFolder.Path)\n    Set objFiles = objFSO.GetFolder(objSubFolder.Path).Files\n        If Err.Number &lt;&gt; 0 Then\n            FileCount = 0\n        Else\n            FileCount = objFiles.Count\n        End If\n    get_Filenames (objSubFolder.Path)\nNext objSubFolder\n\nEnd Function \n\nSub test()\n\nCall get_remoteTables(\"C:\\temp\\ \")\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Compile Error Method or Data member not found: FileCount = objFiles.Count</p>\n</blockquote>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1459951843, "post_id": 36445384, "comment_id": 60519971, "body": "You seem to have deleted your previous question.  In a comment, I linked to an earlier answer that showed how to identify the attachments to an email;.  I can give you the link again if necessary. I do not believe it is possible to move attachments from one email to another.  You could save (to disc) the attachments from the old email then attach them to the new email. Alternatively, you could duplicate the old email, delete the unwanted attachments and replace sender, recipient and body.  I confess I have never done all of that in one go but the individual steps are not difficult."}, {"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1460005715, "post_id": 36445384, "comment_id": 60545424, "body": "Thank you so much for the info Tony, yes I deleted the other question as it was related to outlook to excel report, this is more to do with forwarding the existing email to a fixed email address and having only pdf attachments, if it has other attachments, those should not be forwarded."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460533457, "post_id": 36489137, "comment_id": 60780913, "body": "Hi Tony, I tried the above provided macros, They work Perfect, I had made some changes for the body and the subject as per the requirements :) , only one question is that , it doesn&#39;t forward the existing email, so I am unable to determine if it has been worked upon, Great Help Thank you Tony :)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460534398, "post_id": 36489137, "comment_id": 60781469, "body": "@PawanTejani  My standard technique is to move processed emails to another folder.  I do not normally use Explorer.  I normally search Inbox for emails of interest, process them and then move them to the archive folder.  As an alternative, there should be a copy of the forwarded email in Sent Items."}, {"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460535002, "post_id": 36489137, "comment_id": 60781891, "body": "Let me explain the situation, these emails are on a huge 250GB shared mailbox, hence I&#39;m avoiding creating more copies, I rather prefer forwarding the same email as other users get to see the specific email being actioned."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460536871, "post_id": 36489137, "comment_id": 60783141, "body": "Even if you do not change the subject or the title, you are creating a new email with a new sender, recipients and sent time.  I do not believe you can avoid a copy of the new email being saved in Sent Items.  I do not like deleting from Sent Items immediately.  You could have a macro that searches Sent Items for the previous day&#39;s emails and deletes them perhaps after adding a record to an Excel workbook."}, {"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460550874, "post_id": 36489137, "comment_id": 60793929, "body": "Hi Tony, Thank you for the help, my concern is that it doesn&#39;t remove the From Field ( original sender&#39;s email ) and reflect my name as I&#39;m sending the email now.  can you check on this part."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460631502, "post_id": 36489137, "comment_id": 60837846, "body": "In my experiments, the sender value is unchanged when an email is forwarded.  Does something different happen on your system?"}, {"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460638844, "post_id": 36489137, "comment_id": 60843662, "body": "the original email doesn&#39;t show that it has been forwarded, like it would show ,as the above macro creates a copy of it. so that is my concern. if you could advise of a fix it will be a life saver."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460653361, "post_id": 36489137, "comment_id": 60854774, "body": "In my macro, I have the statement <code>.Subject = &quot;FW: &quot; &amp; .Subject</code> which adds &quot;FW: &quot; to the beginning of the subject in the same way as happens if you manually forward an email.  Have you amended or removed this statement?"}, {"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1460658688, "post_id": 36489137, "comment_id": 60857781, "body": "Hi Tony,  yes because I have a dedicated subject to be sent to the recipients email address,  I will take a screenshot tomorrow morning to show you what I wish to achieve as I understand that the macro we are using now creates a copy of the existing email and then sends it"}, {"owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "edited": false, "score": 0, "creation_date": 1483509350, "post_id": 36489137, "comment_id": 70120206, "body": "the solution that finally works for me is as below :) thank you for your help I know i&#39;m posting too late but this works best"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1460072722, "creation_date": 1460072722, "answer_id": 36489137, "question_id": 36445384, "link": "https://stackoverflow.com/questions/36445384/forward-selected-emails-without-non-pdf-attachments/36489137#36489137", "title": "Forward selected emails without non-PDF attachments", "body": "<p>I have created two macros for you.</p>\n\n<p>The first, <code>Investigate</code>, outputs information about attachments to the Immediate Window.  There are four types of attachment.  A \u201cstandard\u201d attachment is of type \u201cBy Value\u201d.  I have never seen an OLE attachment and do not know what such an attachment is.  I have seen the other types but not for many years.</p>\n\n<p>The second, <code>ForwardEmailsWithoutNonPdfAttachments()</code>, demonstrates the functionality you seek.  I have sent emails containing a selection of attachments from my Gmail account to my Outlook account and have used the macro to send them back with the non-PDF attachments deleted.  These attachments were all \u201cBy Value\u201d attachments.  I am not sure what would happen if you tried to forward emails with other types of attachments which is the reason for the first macro.  This macro is not very elegant but it demonstrates the techniques necessary to meet your objective.</p>\n\n<pre><code>Option Explicit\nPublic Sub Investigate()\n\n  Dim AttachType As String\n  Dim Exp As Outlook.Explorer\n  Dim InxAttach As Long\n  Dim ItemCrnt As MailItem\n  Dim NumAttach As Long\n  Dim NumSelected As Long\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  NumSelected = Exp.Selection.Count\n\n  If NumSelected = 0 Then\n    Debug.Print \"No emails selected\"\n  Else\n    For Each ItemCrnt In Exp.Selection\n      With ItemCrnt\n        Debug.Print \"From: \" &amp; .SenderName &amp; \" | Subject: \" &amp; .Subject\n        For InxAttach = 1 To .Attachments.Count\n          ' There are four types of attachment:\n          '  *   olByValue       1\n          '  *   olByReference   4\n          '  *   olEmbeddedItem  5\n          '  *   olOLE           6\n          With .Attachments(InxAttach)\n            Select Case .Type\n              Case olByValue\n               AttachType = \"Val\"\n              Case olEmbeddeditem\n                AttachType = \"Ebd\"\n              Case olByReference\n                AttachType = \"Ref\"\n              Case olOLE\n                AttachType = \"OLE\"\n              Case Else\n                AttachType = \"Unk\"\n            End Select\n            Debug.Print AttachType &amp; \" \" &amp; .FileName &amp; \" | \" &amp; .DisplayName\n          End With  ' .Attachments(InxAttach)\n        Next  ' ItemCrnt\n      End With\n    Next\n  End If\n\nEnd Sub\nSub ForwardEmailsWithoutNonPdfAttachments()\n\n  Dim AttachType As String\n  Dim Exp As Outlook.Explorer\n  Dim InxAttach As Long\n  Dim ItemCopy As MailItem\n  Dim ItemOrig As MailItem\n  Dim NumAttach As Long\n  Dim NumSelected As Long\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  NumSelected = Exp.Selection.Count\n\n  If NumSelected = 0 Then\n    Debug.Print \"No emails selected\"\n  Else\n    For Each ItemOrig In Exp.Selection\n\n      Set ItemCopy = ItemOrig.Copy\n      With ItemCopy\n        .Subject = \"FW: \" &amp; .Subject\n        ' Delete all original recipients\n        Do While .Recipients.Count &gt; 0\n          .Recipients.Remove (1)\n        Loop\n        ' Add new recipient\n        .Recipients.Add \"tonydallimore23@gmail.com\"\n        If .Attachments.Count &gt; 0 Then\n          For InxAttach = .Attachments.Count To 1 Step -1\n            With .Attachments(InxAttach)\n              ' This will stop the macro if an attachment is not a regular attachment\n              Debug.Assert .Type = olByValue\n              If LCase(Right$(.FileName, 4)) &lt;&gt; \".pdf\" Then\n                .Delete\n              End If\n            End With  ' .Attachments(InxAttach)\n          Next InxAttach\n        End If\n        .Send\n      End With  ' ItemCopy\n      Set ItemCopy = Nothing\n    Next ItemOrig\n  End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6160958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6T7RXzqfBsY/AAAAAAAAAAI/AAAAAAAABNU/Ykulwl9iNnQ/photo.jpg?sz=128", "display_name": "Pawan Tejani", "link": "https://stackoverflow.com/users/6160958/pawan-tejani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 36489137, "answer_count": 1, "score": 0, "last_activity_date": 1593414867, "creation_date": 1459930895, "last_edit_date": 1593414867, "question_id": 36445384, "link": "https://stackoverflow.com/questions/36445384/forward-selected-emails-without-non-pdf-attachments", "title": "Forward selected emails without non-PDF attachments", "body": "<p>I am trying to send a completed work email containing multiple PDF attachments, I wish send only the PDF files to the recipient and avoid any other atttachments such as excel files or image files only pdf to be forwarded.</p>\n\n<p>P.S. note email may have more than 1 attachments with combination of pdfs, excels, images, however only pdfs have to be forwarded. I'm unable to find how to code that part. please see below my existing code.</p>\n\n<pre><code>        Sub Send2Recipient()\n\n        ' Send Completed Message to Recipient\n\n        On Error Resume Next\n\n        Dim oApp As Outlook.Application\n        Dim objFolder As Outlook.MAPIFolder\n        Set oApp = New Outlook.Application\n        Set objNS = Application.GetNamespace(\"MAPI\")\n        Set objInbox = objNS.GetDefaultFolder(olFolderInbox)\n        Set objFolder = objInbox.Folders(\"Helpdesk\")\n        Dim oEmail As Outlook.MailItem\n        Dim strFile As String\n        Dim sFileType As String\n\n        'Require that this procedure be called only when a message is selected\n        If Application.ActiveExplorer.Selection.Count = 0 Then\n            Exit Sub\n        End If\n\n        For Each objItem In Application.ActiveExplorer.Selection\n            If objFolder.DefaultItemType = olMailItem Then\n                If objItem.Class = olMail Then\n                    Response = MsgBox(\"Forward message (\" + item.Subject + \") to Appended Subject\")\n\n                    Set myforward = objItem.Forward\n                    myforward.Body = \"Scan Only\"\n                    myforward.Subject = \"Scan Only\"\n                    myforward.Recipients.Add \"DHL.GB01PREV@dhl.com\"\n                    myforward.Display\n                End If\n            End If\n        Next\n\n        End Sub\n</code></pre>\n\n<hr>\n\n<p>Updated VBA script</p>\n\n<pre><code>        Sub Send2New()\n\n        ' Send Completed Message to Accenture\n\n        On Error Resume Next\n\n        Dim oApp As Outlook.Application\n        Dim objFolder As Outlook.MAPIFolder\n        Set oApp = New Outlook.Application\n        Set objNS = Application.GetNamespace(\"MAPI\")\n        Set objInbox = objNS.GetDefaultFolder(olFolderInbox)\n        'Set objFolder = objInbox.Folders(\"Helpdesk\")\n        Dim oEmail As Outlook.MailItem\n        Dim strFile As String\n        Dim sFileType As String\n        Dim bk, fg As Integer\n\n        'Require that this procedure be called only when a message is selected\n        If Application.ActiveExplorer.Selection.Count = 0 Then\n            Exit Sub\n        End If\n\n        For Each objItem In Application.ActiveExplorer.Selection\n            If objFolder.DefaultItemType = olMailItem Then\n                If objItem.Class = olmail Then\n                    Response = MsgBox(\"Forward message (\" + Item.Subject + \") to Appended Subject\")\n\n                    Set myforward = objItem.Forward\n                    myforward.Body = \"Scan Only\"\n                    myforward.Subject = \"Scan Only\"\n                    myforward.Recipients.Add \"xyz@abc.com\"\n                    myforward.Display\n\n                    bk = myforward.Attachments.Count\n                    fg = 1\n                    For i = 1 To bk\n                        If InStr(LCase(myforward.Attachments(fg).FileName), \".pdf\") = 0 Then\n                            myforward.Attachments(fg).Delete\n                            Else: fg = fg + 1\n                        End If\n                    Next i\n\n                    End If\n            End If\n        Next\n\n        End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6151290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf06afdb0da390891e5de67649dbae5?s=128&d=identicon&r=PG&f=1", "display_name": "reza bozorgifard", "link": "https://stackoverflow.com/users/6151290/reza-bozorgifard"}, "edited": false, "score": 0, "creation_date": 1459939820, "post_id": 36446286, "comment_id": 60510500, "body": "instead of ActiveCell.Value  we must use ActiveCell.Text and its work.Thanks."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1459933323, "creation_date": 1459933323, "answer_id": 36446286, "question_id": 36445182, "link": "https://stackoverflow.com/questions/36445182/excel-vba-to-make-hyperlink-for-active-cell/36446286#36446286", "title": "Excel VBA to make hyperlink for active cell", "body": "<p>In order to obtain the active cell value and address, change your code the corresponding places with the following:</p>\n\n<pre><code>ActiveCell.Address\nActiveCell.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6151290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf06afdb0da390891e5de67649dbae5?s=128&d=identicon&r=PG&f=1", "display_name": "reza bozorgifard", "link": "https://stackoverflow.com/users/6151290/reza-bozorgifard"}, "is_accepted": true, "score": 0, "last_activity_date": 1459941441, "creation_date": 1459941441, "answer_id": 36449554, "question_id": 36445182, "link": "https://stackoverflow.com/questions/36445182/excel-vba-to-make-hyperlink-for-active-cell/36449554#36449554", "title": "Excel VBA to make hyperlink for active cell", "body": "<p>I find it just to close this topic.</p>\n\n<pre><code>Sub Button36_Click()\nDim newRange As Range\nSet newRange = Range(ActiveCell, ActiveCell.Offset(numRows, numCols))\n     With ActiveSheet\n   .Hyperlinks.Add Anchor:=newRange, _\n      Address:=.Parent.FullName &amp; \"#'\" &amp; .Name &amp; \"'!\" &amp; ActiveCell.Address, TextToDisplay:=ActiveCell.Text\n      End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1420, "user_id": 8036123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc23031964f75c05ba40418091003ddc?s=128&d=identicon&r=PG&f=1", "display_name": "nickthefreak", "link": "https://stackoverflow.com/users/8036123/nickthefreak"}, "edited": false, "score": 1, "creation_date": 1556293438, "post_id": 55870776, "comment_id": 98401834, "body": "Can you add some more comments and explanation of your solution? see how to write <a href=\"https://stackoverflow.com/help/how-to-answer\">a good answer</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 11416594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b867c6a5f28c11dbde2ff7ae1651d304?s=128&d=identicon&r=PG&f=1", "display_name": "markfuji28", "link": "https://stackoverflow.com/users/11416594/markfuji28"}, "is_accepted": false, "score": 0, "last_activity_date": 1556292666, "creation_date": 1556292666, "answer_id": 55870776, "question_id": 36445182, "link": "https://stackoverflow.com/questions/36445182/excel-vba-to-make-hyperlink-for-active-cell/55870776#55870776", "title": "Excel VBA to make hyperlink for active cell", "body": "<p>try this</p>\n\n<pre><code>Sub add_links_Input_Column()\nDim lRow As Long\nDim ColHead As String\n\nColHead = InputBox(\"Enter Column Letter\", \"Identify Column\", [c1].Value)\nIf ColHead = \"\" Then Exit Sub\n\n    With ActiveSheet\n        lRow = .Range(ColHead &amp; .Rows.Count).End(xlUp).Row\n        For Each c In .Range(ColHead &amp; \"2:\" &amp; ColHead &amp; lRow)\n            ActiveSheet.Hyperlinks.Add anchor:=c, Address:=c.Value\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6151290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf06afdb0da390891e5de67649dbae5?s=128&d=identicon&r=PG&f=1", "display_name": "reza bozorgifard", "link": "https://stackoverflow.com/users/6151290/reza-bozorgifard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5563, "favorite_count": 2, "accepted_answer_id": 36449554, "answer_count": 3, "score": 2, "last_activity_date": 1556292666, "creation_date": 1459930315, "last_edit_date": 1459940147, "question_id": 36445182, "link": "https://stackoverflow.com/questions/36445182/excel-vba-to-make-hyperlink-for-active-cell", "title": "Excel VBA to make hyperlink for active cell", "body": "<p>I want to make a link from active cell in workbook 1 which can I use it in workbook 2. I use the following code which assigned to a button:</p>\n\n<pre><code> With ActiveSheet\n   .Hyperlinks.Add Range(\"F6\"), _\n      .Parent.FullName &amp; \"#'\" &amp; .Name &amp; \"'!\" &amp; \"$A$1\", TextToDisplay:=\"link\"\n End With\n</code></pre>\n\n<p>This code made a link with full path and I can use it in any workbook but I need some changes which I could to:</p>\n\n<ol>\n<li>Make the active cell hyperlink not cell A1 which specified in code.</li>\n<li>The value in the active cell become text to display arg of hyperlink function.</li>\n</ol>\n\n<p>Thanks </p>\n\n<p>PS after Vityata answere: how can i change Range(\"F6\") to activecell adress?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1459936822, "creation_date": 1459936822, "answer_id": 36447757, "question_id": 36445064, "link": "https://stackoverflow.com/questions/36445064/modify-context-menus/36447757#36447757", "title": "Modify Context menus", "body": "<p>Word provides a completely different <code>CommandBar</code> object for each context-sensitive menu, rather than dynamically changing the contents of a single menu. That means you need to make the change for each context in which your command should appear.</p>\n\n<p>You can generate a list of CommandBars by looping the collection and writing the various properties out (for example, in a new document). Then you have to inspect that list, pick out the likely candidates, run your code then see if you guessed correctly.</p>\n\n<p>You want to be <em>very careful</em> where these changes are SAVED in Word. If you don't specify it specifically, Word could save the change in one place and delete it (assuming you \"undo\" your changes) in a different one. This can really muck up the Word configuration and make users extremely unhappy. So <em>always</em> use <code>Application.CustomizationContext</code> at the beginning of code that changes the <code>CommandBars</code>. The <code>CustomizationContext</code> can be any <code>Document</code> or <code>Template</code> object. </p>\n\n<p><strong>NOTE</strong>: The <code>CommandBars</code> object is actually deprecated as of Word 2010. From Word 2013 onwards the context menus should be customized using Ribbon XML. Just saying... It's possible that in a future version your code will no longer work.</p>\n"}], "owner": {"reputation": 13, "user_id": 6053720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LjVOAcobU6A/AAAAAAAAAAI/AAAAAAAAACQ/kpXJ6vDRy5g/photo.jpg?sz=128", "display_name": "Thinus Bothma", "link": "https://stackoverflow.com/users/6053720/thinus-bothma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594050759, "creation_date": 1459930000, "last_edit_date": 1594050759, "question_id": 36445064, "link": "https://stackoverflow.com/questions/36445064/modify-context-menus", "title": "Modify Context menus", "body": "<p>I have the following code to add a menu item on the Word 2013 right click menu:</p>\n\n<pre><code>    Sub CreateMenuItem()\n        Dim MenuButton As CommandBarButton\n        With CommandBars(\"Text\")\n            Set MenuButton = .Controls.Add(msoControlButton)\n            With MenuButton\n                .Caption = ChrW(&amp;H2714) '\"Correct\"\n                .Style = msoButtonCaption\n                .OnAction = \"InsertMark\"\n            End With\n        End With\n    End Sub\n</code></pre>\n\n<p>The issue is that the new menu item is not displayed when I right click on a Text box or a table.</p>\n\n<p>How do I remove a menu item that is not used by me, for example \"Translate\"</p>\n\n<p>Please Assist\nThinus</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1459930637, "post_id": 36445008, "comment_id": 60503907, "body": "copy a set of columns from one workbook to another without opening the another workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1459930046, "creation_date": 1459930046, "answer_id": 36445080, "question_id": 36445008, "link": "https://stackoverflow.com/questions/36445008/excel-vba-to-copy-a-range-of-data-in-columns-to-another-sheet/36445080#36445080", "title": "Excel Vba to copy a range of data in columns to another sheet", "body": "<p>Try setting it like this for all the ranges:</p>\n\n<pre><code>set itemIndex = Range(\"A8:A &amp; LR\")\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1459930395, "creation_date": 1459930395, "answer_id": 36445202, "question_id": 36445008, "link": "https://stackoverflow.com/questions/36445008/excel-vba-to-copy-a-range-of-data-in-columns-to-another-sheet/36445202#36445202", "title": "Excel Vba to copy a range of data in columns to another sheet", "body": "<p>Assuming LR is a number, instead of</p>\n\n<pre><code>itemIndex = Range(\"A8:A &amp; LR\")\n</code></pre>\n\n<p>It should be</p>\n\n<pre><code>itemIndex = Range(\"A8:A\" &amp; LR)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6154960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/622789e10875b476ee6c186aed48486c?s=128&d=identicon&r=PG&f=1", "display_name": "Riufaan", "link": "https://stackoverflow.com/users/6154960/riufaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459930395, "creation_date": 1459929832, "question_id": 36445008, "link": "https://stackoverflow.com/questions/36445008/excel-vba-to-copy-a-range-of-data-in-columns-to-another-sheet", "title": "Excel Vba to copy a range of data in columns to another sheet", "body": "<p>I am trying to copy a set of data from many column from a sheet of one workbook to a sheet of another workbook without opening the second workbook.</p>\n\n<pre><code>workbook 1\nsheet1\n\nColumn A      Column B      Column C        Column D     Column E     etc...\nindex         item No       Details         Price        Cust_nam\n002           23101         book            15           ahmed\n003           23102         CD              5            ahmed\n004           23103         DVD             6            ahmed\n</code></pre>\n\n<p>The sheet1 in the second workbook also is in the same column names and configuration.</p>\n\n<p>what i want to achieve is what ever i enter in workbook1 copy to workbook2. from the next available blank row.</p>\n\n<p>here is my code</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    LR = Range(\"A399\").End(xlUp).Row\n    LR1 = Range(\"B399\").End(xlUp).Row\n    LR2 = Range(\"C399\").End(xlUp).Row\n    LR3 = Range(\"D399\").End(xlUp).Row\n    LR4 = Range(\"E399\").End(xlUp).Row\n    LR5 = Range(\"F399\").End(xlUp).Row\n    LR6 = Range(\"G399\").End(xlUp).Row\n    LR7 = Range(\"H399\").End(xlUp).Row\n\n    Dim itemIndex As Range\n    Dim itemNumber As Range\n    Dim itemDetails As Range\n    Dim itemPrice As Range\n    Dim itemCust_nam As Range\n    Dim itemMobile As Range\n    Dim itemDate As Range\n    Dim itemTime As Range\n    Dim myData As Workbook\n\nWorksheets(\"Sheet1\").Select\n    itemIndex = Range(\"A8:A &amp; LR\")\n    itemNumber = Range(\"B8:B\" &amp; LR1)\n    itemDetails = Range(\"C8:C\" &amp; LR2)\n    itemPrice = Range(\"D8:D\" &amp; LR3)\n    itemCust_nam = Range(\"E8:E\" &amp; LR4)\n    itemMobile = Range(\"F8:F\" &amp; LR5)\n    itemDate = Range(\"G8:G\" &amp; LR6)\n    itemTime = Range(\"H8:H\" &amp; LR7)\n\n\nSet myData = Workbook\n\nmyData.SaveAs Filename:=\"C:\\Users\\athif\\Desktop\\Test_Pos\\DataBase.xlsx\", FileFormat:=51\n    Worksheets(\"Sales\").Select\n    Worksheets(\"Sales\").Range(\"A2\").Select\n    RowCount = Worksheets(\"Sales\").Range(\"A2\").CurrentRegion.Rows.Count\n    With Worksheets(\"Sales\").Range(\"A2\")\n    .Offset(RowCount, 0) = itemIndex\n    .Offset(RowCount, 1) = itemNumber\n    .Offset(RowCount, 2) = itemDetails\n    .Offset(RowCount, 3) = itemPrice\n    .Offset(RowCount, 4) = itemCust_nam\n    .Offset(RowCount, 5) = itemMobile\n    .Offset(RowCount, 6) = ItemData\n    .Offset(RowCount, 7) = itemTime\n    End With\n\n    myData.Save\n    End Sub\n</code></pre>\n\n<p>when ever i click the button it gives a run time error. Run-time error'1004': Method 'Range' of object'_worksheet' failed. and the debug highlight \" itemIndex = Range(\"A8:A &amp; LR\") \".</p>\n\n<p>want a solution as soon as possible.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1459929879, "post_id": 36444987, "comment_id": 60503485, "body": "<a href=\"https://support.office.com/en-au/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\">Conditional Formatting</a> with a native worksheet formula is a better solution."}, {"owner": {"reputation": 5, "user_id": 5882982, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-HDGYr0pR1LA/AAAAAAAAAAI/AAAAAAAAIXM/DMyEy9Q7Z1k/photo.jpg?sz=128", "display_name": "Epil epic", "link": "https://stackoverflow.com/users/5882982/epil-epic"}, "edited": false, "score": 0, "creation_date": 1459930321, "post_id": 36444987, "comment_id": 60503726, "body": "@Jeeped as rows and columns will be inserted. A conditional is no option. I need to be able to run the formatting code on this specific range after each addition."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": true, "score": 0, "last_activity_date": 1459930855, "creation_date": 1459930855, "answer_id": 36445372, "question_id": 36444987, "link": "https://stackoverflow.com/questions/36444987/use-function-on-range/36445372#36445372", "title": "Use Function on range", "body": "<pre><code>Sub test()\n\n    Dim rngApply As Range\n    Set rngApply = Sheets(\"X\").Range(\"D18:E1200\")\n    Dim varIndex As Variant\n\n    For Each varIndex In rngApply\n        If varIndex.Value &gt; Sheets(\"blocked(R)\").Range(\"D18\") Then\n            varIndex.Interior.ColorIndex = 10\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5882982, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-HDGYr0pR1LA/AAAAAAAAAAI/AAAAAAAAIXM/DMyEy9Q7Z1k/photo.jpg?sz=128", "display_name": "Epil epic", "link": "https://stackoverflow.com/users/5882982/epil-epic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 36445372, "answer_count": 1, "score": 0, "last_activity_date": 1459930855, "creation_date": 1459929770, "last_edit_date": 1495540237, "question_id": 36444987, "link": "https://stackoverflow.com/questions/36444987/use-function-on-range", "title": "Use Function on range", "body": "<p>Following my previous question:\n<a href=\"https://stackoverflow.com/questions/36429924/background-color-based-on-difference-with-cell\">Background Color based on difference with cell</a>\n. I would now like to apply this function to a range of rows.</p>\n\n<p>The function I'd like to apply is: </p>\n\n<pre><code>If Sheets(\"X\").Range(\"E18\") &gt; Sheets(\"blocked(R)\").Range(\"D18\") Then\n    Sheets(\"X\").Range(\"E18\").Interior.ColorIndex = 10\n</code></pre>\n\n<p>The range I need to apply this function to is fixed: <code>D18:E1200</code>.\nHowever, there will be an active filter on this range.</p>\n\n<p>The <code>Autofill</code> code of course is not working and writing a line of code for each of 1200 rows would be crazy. </p>\n\n<p>I have been searching and reading and I think it must be something like: </p>\n\n<pre><code>Dim rng As Range\nDim row As Range\nDim cell As Range\n\nSet rng = Range(\"A1:C2\")\n\nFor Each row In rng.Rows\n  For Each cell in row.Cells\n    'Do Something\n  Next cell\nNext row\n</code></pre>\n\n<p>But I don't seem to get it to work, I was hoping for some pointing into the right direction of the community.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 1713089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803068c4dea7734dca0895b617d427e8?s=128&d=identicon&r=PG", "display_name": "Drakemoore", "link": "https://stackoverflow.com/users/1713089/drakemoore"}, "is_accepted": false, "score": 0, "last_activity_date": 1459939211, "creation_date": 1459939211, "answer_id": 36448646, "question_id": 36444976, "link": "https://stackoverflow.com/questions/36444976/close-button-empty-cell-condition/36448646#36448646", "title": "Close button : empty cell condition", "body": "<p>Have you tried using BeforeClose instead of BeforeSave?</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n If ActiveSheet.Range(\"A1\").Value = \"\" Then\n     Cancel = True\n     Response = MsgBox(\"Please enter a value in A1\", vbCritical, \"Error!\")\n End If\nEnd Sub\n</code></pre>\n\n<p>Regards</p>\n"}], "owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459939211, "creation_date": 1459929738, "last_edit_date": 1459931864, "question_id": 36444976, "link": "https://stackoverflow.com/questions/36444976/close-button-empty-cell-condition", "title": "Close button : empty cell condition", "body": "<p>I found this code and it works perfectly. But when I hit close button, dialog is shown \"Do you weant to save changes\", and if I choose Yes, an error comes up that I don't have a value in a cell A. And then my file is automatically closed.</p>\n\n<p><strong>How to prevent this, and to stay in the document?</strong></p>\n\n<p>My code is:</p>\n\n<pre><code> Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nIf ActiveSheet.Range(\"A1\").Value = \"\" Then\nCancel = True\nResponse = MsgBox(\"Please enter a value in A1\", vbCritical, \"Error!\")\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459930378, "post_id": 36444736, "comment_id": 60503759, "body": "First, naming variable same as type is not a good idea, IMHO. Second, in <code>Dim cell, rng, test As range</code>, only test is of type Range, cell and rng are of type Variant. In VBA you need to repeat <code>As type</code> for each variable."}, {"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1459931940, "post_id": 36444736, "comment_id": 60504675, "body": "true, naming is terrible.....it was just for a proof of concept function. :-) The actual code would be more aptly named.   Now, if I indeed decalred explicitly cell as range, it would fail.  if I declared both rng and cell as variant and used the following: cell = tbl.DataBodyRange(5, 1).Address(False, False)   rng = .range(&quot;A3:P59&quot;).Address(False, False)   Set test = Application.Intersect(cell, rng)   I would get objects required"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1459930461, "post_id": 36445028, "comment_id": 60503801, "body": "yeah, sorry, tried making the formatting bit clearer. it does weird things.  So I can successfully set &#39;cell&#39; as a range with the Address from a cell in the table, debug.print will print it as &quot;A6&quot; in this example. However, no such thing seems to happen with the &#39;range&#39; variable.  If it gets set and I hover over it, it doesn&#39;t show anything and the debug.print will return &quot;type mismatch&quot;"}, {"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1459930545, "post_id": 36445028, "comment_id": 60503855, "body": "in short : cell is a range for a single cell: A6 Range is a real range: A3:P59  End goal is to find out if A6 exists in A3:P59 or not"}, {"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1459931198, "post_id": 36445028, "comment_id": 60504237, "body": "by the way: i cannot set it as you said, as I need to use a string that refers to a cell range in the table"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1459929873, "creation_date": 1459929873, "answer_id": 36445028, "question_id": 36444736, "link": "https://stackoverflow.com/questions/36444736/someexcel-vba-cannot-create-a-range-object-successfully/36445028#36445028", "title": "someExcel VBA: Cannot create a range object successfully", "body": "<p>Try setting the cell as well as following:</p>\n\n<pre><code>set cell = tbl.DataBodyRange(5, 1).Address(False, False)\n</code></pre>\n\n<p>What is cell? A Range?</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1459931085, "post_id": 36445265, "comment_id": 60504172, "body": "Also one of the many variations I tried. ==&gt; Returns &quot;object variable or with block variable not set&quot;"}], "tags": [], "owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1459930538, "creation_date": 1459930538, "answer_id": 36445265, "question_id": 36444736, "link": "https://stackoverflow.com/questions/36444736/someexcel-vba-cannot-create-a-range-object-successfully/36445265#36445265", "title": "someExcel VBA: Cannot create a range object successfully", "body": "<p>You do not need to add 'set' to the range value assignment.</p>\n\n<p>Try just</p>\n\n<p>range = .Range(\"A3:P59\")</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1460007488, "post_id": 36451276, "comment_id": 60546146, "body": "alass, that didn&#39;t work either. I think my VBA just getting freaky on me."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1460011553, "post_id": 36451276, "comment_id": 60548128, "body": "What error did you get? Because it worked fine on my side."}, {"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1460018611, "post_id": 36451276, "comment_id": 60552584, "body": "I just made a full copy now of your function rather than editing my own and got &quot;The Item with the specified name wasn&#39;t found&quot; on the line off application intersect"}, {"owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "edited": false, "score": 0, "creation_date": 1460018784, "post_id": 36451276, "comment_id": 60552692, "body": "if I changed your line to &quot;Set testResult = Application.Intersect(cellToTest, range(&quot;A3:P59&quot;))&quot; then the error is &quot;Method &#39;intersect&#39; of object_Application failed&quot; (which is already further than I got before"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1459945896, "creation_date": 1459945896, "answer_id": 36451276, "question_id": 36444736, "link": "https://stackoverflow.com/questions/36444736/someexcel-vba-cannot-create-a-range-object-successfully/36451276#36451276", "title": "someExcel VBA: Cannot create a range object successfully", "body": "<pre><code>Function TestCellRange() As Boolean\n    Dim tbl As ListObject\n    Dim cellToTest As Range\n    Dim testResult As Range\n\n    Set tbl = shRulebase.ListObjects(\"tblBFFirewallRules\")\n    Set cellToTest = tbl.DataBodyRange.Cells(5, 1)\n    'or with one more level of indirection\n    'Set cellToTest = shRulebase.range(tbl.DataBodyRange.Cells(5, 1).Value)         \n    Set testResult = Application.Intersect(cellToTest, [A3:P59])\n    If testResult Is Nothing Then\n        MsgBox (\"oops\")\n        TestCellRange = False\n    Else\n        MsgBox (\"yup yup\")\n        TestCellRange = True\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "is_accepted": false, "score": 0, "last_activity_date": 1460019147, "creation_date": 1460019147, "answer_id": 36471184, "question_id": 36444736, "link": "https://stackoverflow.com/questions/36444736/someexcel-vba-cannot-create-a-range-object-successfully/36471184#36471184", "title": "someExcel VBA: Cannot create a range object successfully", "body": "<p>Thanks to the post of VincentG I found the working solution. Thanks for that. </p>\n\n<pre><code>Function TestCellRange() As Boolean\nDim tbl As ListObject\nDim cellToTest As range\nDim testResult As range\n\nSet tbl = shRulebase.ListObjects(\"tblBFFirewallRules\")\nshRulebase.Activate\nSet cellToTest = tbl.DataBodyRange.Cells(5, 1)\n'or with one more level of indirection\n'Set cellToTest = shRulebase.range(tbl.DataBodyRange.Cells(5, 1).Value)\nSet testResult = Application.Intersect(cellToTest, range(\"A3:P59\"))\nIf testResult Is Nothing Then\n    MsgBox (\"oops\")\n    TestCellRange = False\nElse\n    MsgBox (\"yup yup\")\n    TestCellRange = True\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6165226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b34c19fd8fb33c0cd88829741e8fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Kraganov", "link": "https://stackoverflow.com/users/6165226/kraganov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1460019147, "creation_date": 1459929046, "last_edit_date": 1531164843, "question_id": 36444736, "link": "https://stackoverflow.com/questions/36444736/someexcel-vba-cannot-create-a-range-object-successfully", "title": "someExcel VBA: Cannot create a range object successfully", "body": "<p>This is my first question here, so bear with me. I'm a security consultant working on a huge firewall migration, for which I got my VBA skill from under a thick layer of dust. So far I have managed to get all my issues resolved by searching, but this issue: I get errors when doing exactly how I find it everywhere. </p>\n\n<p>What I want to do:\nI have an array that contains (among other things), strings formatted like this: \"A3:P59\", representing a cell range. \nNow, this are ranges within a table. When I get the address of a certain cell in the table, I want to test if it's in that range. </p>\n\n<p>I wrote a test function:</p>\n\n<pre><code>   Function TestCellRange() As Boolean  \n    Dim tbl As ListObject  \n    Dim cell, rng, test As range  \n    Dim range As range\n\n    Dim bRow, eRow As Integer\n\n    Set tbl = shRulebase.ListObjects(\"tblBFFirewallRules\")\n    shRulebase.Activate\n    With shRulebase\n\n    cell = tbl.DataBodyRange(5, 1).Address(False, False) 'it's this command that gives me issues\n    Set range = .range(.Cells(bRow, 1), .Cells(eRow, 16)) \n\n    Debug.Print cell\n    'Set rng = shRulebase.range(range)\n    Debug.Print rng\n\n    Set test = Application.Intersect(cell, range(range(A3), range(P59)))\n    If test Is Nothing Then\n        MsgBox (\"oops\")\n        TestCellRange = False\n\n    Else\n        MsgBox (\"yup yup\")\n        TestCellRange = True\n    End If\n    End With\n\nEnd Function\n</code></pre>\n\n<p>Now whatever I try, I keep getting blocked on the set range:  </p>\n\n<ul>\n<li><strong>set range =  .Range(\"A3:P59\")</strong> -> will return \"object required\", on the \"set test\" line (if i use intersect (cell, range))  </li>\n<li><strong>Set range = range(\"A3:P59\")</strong> -> will return object variable or with block variale not set on the same line  </li>\n<li><strong>Set range = .range(.Cells(bRow, 1), .Cells(eRow, 16))</strong> -> will step through, but debug.print returns a type mismatch and \"Set test = Application.Intersect(cell, range)\" returns a \"object required\"  </li>\n</ul>\n\n<p>Any help would be really appreciated...I'm all to familiar with networks ip's and the bits and bytes of it, but here I am a bit out of my comfort zone and I need to finish this by tomorrow :(</p>\n\n<p>Greetings,\nKraganov</p>\n\n<p>EDIT Some More tries:</p>\n\n<ul>\n<li><p><strong>rng and cell as variant:</strong><br>\ncell = tbl.DataBodyRange(5, 1).Address(False, False)<br>\nrng = .range(\"A3:P59\").Address(False, False)<br>\nSet test = Application.Intersect(cell, rng)<br>\n==>I would get objects required   </p></li>\n<li><p><strong>just using rng as range and trying to set it without \"set\"</strong><br>\nrng = .range(\"A3:P59\")  </p></li>\n</ul>\n\n<p>EDIT 2 : I found a way around using the range.</p>\n\n<p>So what I was trying to do, was the following:\nI had a table that contains information about firewall rules. However, not every line describes a rule. There are also lines that described the context in which the rules below that line were to be placed. \nOutside of the table, aside of those lines there would be a cell with the range of cells for that context. I wanted to use that to describe the context for those rules, if I pulled them.\nI ended up looping through the table rows and identifying those specific rows and setting a \"context\" variable when, a row like that was met.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1459928518, "post_id": 36444471, "comment_id": 60502621, "body": "Those Win32 (User32...?) API calls have to be imported differently for 32-bit and 64-bit Office installations. Perhaps that explains the difference between the two computers. See <a href=\"http://stackoverflow.com/questions/29723694/excel-2013-windows-class-names/29724663#29724663\">this</a>."}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1459931680, "post_id": 36444471, "comment_id": 60504510, "body": "Thanks, we both run 32bit version of word but he uses 32 bit pc and I use 64bit pc."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1459941552, "post_id": 36444471, "comment_id": 60511737, "body": "Just FWIW: You can use GetObject(, &quot;Excel.Application&quot;) and if that errors (429, as I recall) it&#39;s not running."}], "answers": [{"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 0, "last_activity_date": 1459932917, "creation_date": 1459932917, "answer_id": 36446131, "question_id": 36444471, "link": "https://stackoverflow.com/questions/36444471/find-out-if-excel-is-running/36446131#36446131", "title": "Find out if excel is running", "body": "<p>So here is the new function that works for me:</p>\n\n<pre><code>#If VBA7 Then\n  Private Declare PtrSafe Function FindWindow Lib \"USER32\" Alias \"FindWindowA\" ( _\n    ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr\n#Else\n  Private Declare Function FindWindow Lib \"USER32\" Alias \"FindWindowA\" ( _\n    ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n#End If\n\nFunction ExcelOpen() As Boolean\n    ExcelOpen = FindWindow(\"XLMAIN\", vbNullString)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1459932917, "creation_date": 1459928307, "question_id": 36444471, "link": "https://stackoverflow.com/questions/36444471/find-out-if-excel-is-running", "title": "Find out if excel is running", "body": "<p>I am trying to find out if excel is running, because after i am done creating excel files I need to know if I should close down excel or not.</p>\n\n<p>My method is working fine for me, but it fails on another user and I have no idea why it is failing. My bet would be that the while loop runs forever. So should I add a counter to avoid this or is there a better way to find out if excel is running?</p>\n\n<pre><code>Function ListWins(Optional title = \"*\", Optional Class = \"*\") As Boolean\n    Dim hWndThis As Long\n    ListWins = True\n    hWndThis = FindWindow(vbNullString, vbNullString)\n    While hWndThis\n        Dim sTitle As String, sClass As String\n        sTitle = Space$(255)\n        sTitle = Left$(sTitle, GetWindowText(hWndThis, sTitle, Len(sTitle)))\n        sClass = Space$(255)\n        sClass = Left$(sClass, GetClassName(hWndThis, sClass, Len(sClass)))\n        If sTitle Like title And sClass Like Class Then\n            ListWins = False\n            Debug.Print sTitle, sClass\n        End If\n        hWndThis = GetWindow(hWndThis, GW_HWNDNEXT)\n    Wend\nEnd Function\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460128803, "post_id": 36462569, "comment_id": 60613800, "body": "Can you tell me how to mark it, sorry i am very new here...thanks in advance."}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460726131, "post_id": 36462569, "comment_id": 60889745, "body": "@OldUgle can i give multiple conditions like this with OR i have a same field  of values but name is different  ?                                If aCol.Cells(1, 1).Value = &quot;Defect ID&quot; Or &quot;Key&quot; Then Set myOutCol = Sheets(&quot;Consolidated&quot;).Range(&quot;A:A&quot;)"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460742467, "post_id": 36462569, "comment_id": 60900533, "body": "Did you try? OR, AND and NOT are all valid in IF THEN logic."}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460746365, "post_id": 36462569, "comment_id": 60902745, "body": "yeah tried, it was throwing error. in my excel workbook , i have defects in multiple sheets with different headings. , if i could concatenate wtih OR it should pick value as and when it finds it"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460746933, "post_id": 36462569, "comment_id": 60903122, "body": "Sorry, I see the syntax error now. <code>If (aCol.Cells(1,1).Value = &quot;Defect ID&quot;) Or (aCol.Cells(1,1).Value = &quot;Key&quot;) Then Set myOutCol = Sheets(&quot;Consolidated&quot;).Range(&quot;A:A&quot;)</code>"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460749382, "post_id": 36462569, "comment_id": 60904391, "body": "cool... :) you are the best :) i will take a class from you :)"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460751228, "post_id": 36462569, "comment_id": 60905242, "body": "i need one more request from above your  in Consolidation sheet I need all Sheet name in A column left of defect  ex  Proj     \tDefect Prj A      \t123-A456  Prj A    \t123-A457 Prj A    \t123-A458 Prj B   \t123-A459 Prj C  \t123-A460 Prj C \t123-A461"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1460754751, "post_id": 36462569, "comment_id": 60906861, "body": "this worked,thanks you    For Each aRow In myInCol.Rows   myOutCol.Cells(iLoop, 1).Value = aRow.Cells(1, 1).Value  Cells(iLoop, 1).Value = myInSht.Name      iLoop = iLoop + 1       Next aRow"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "edited": false, "score": 0, "creation_date": 1461000343, "post_id": 36462569, "comment_id": 60988764, "body": "would you be able to help me here?   <a href=\"http://stackoverflow.com/questions/36684741/how-to-find-mulitiple-duplicate-values-in-excel-column-and-consolidate-the-dupli/36688184#36688184\" title=\"how to find mulitiple duplicate values in excel column and consolidate the dupli\">stackoverflow.com/questions/36684741/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 0, "last_activity_date": 1459977581, "creation_date": 1459977581, "answer_id": 36462569, "question_id": 36444383, "link": "https://stackoverflow.com/questions/36444383/how-to-consolidate-data-of-specific-columns-from-multiple-sheet-to-one-sheet-usi/36462569#36462569", "title": "How to consolidate data of Specific columns from multiple sheet to one sheet using excel macro when the required columns are not in same order", "body": "<p>This does as I interpreted your question. This should provide you a starting point if your requirements are a little different.</p>\n\n<p>Attach the following code to your button ...</p>\n\n<pre><code>Option Explicit\n\nSub consolidate()\n    Dim myInSht As Worksheet\n    Dim myOutSht As Worksheet\n    Dim aRow As Range\n    Dim aCol As Range\n    Dim myInCol As Range\n    Dim myOutCol As Range\n    Dim cell As Range\n    Dim iLoop As Long, jLoop As Long\n\n    jLoop = 2\n\n' loop through the worksheets\n    For Each myInSht In ActiveWorkbook.Worksheets\n' pick only the worksheets of interest\n        If myInSht.Name = \"PrjA\" Or myInSht.Name = \"PrjB\" Or myInSht.Name = \"PrjC\" Then\n' find the columns of interest in the worksheet\n            For Each aCol In myInSht.UsedRange.Columns\n                Set myOutCol = Nothing\n                If aCol.Cells(1, 1).Value = \"Defect id\" Then Set myOutCol = Sheets(\"Consolidated\").Range(\"A:A\")\n                If aCol.Cells(1, 1).Value = \"Defect summary\" Then Set myOutCol = Sheets(\"Consolidated\").Range(\"B:B\")\n                If aCol.Cells(1, 1).Value = \"severity\" Then Set myOutCol = Sheets(\"Consolidated\").Range(\"C:C\")\n                If aCol.Cells(1, 1).Value = \"priority\" Then Set myOutCol = Sheets(\"Consolidated\").Range(\"D:D\")\n                If aCol.Cells(1, 1).Value = \"status\" Then Set myOutCol = Sheets(\"Consolidated\").Range(\"E:E\")\n\n                If Not myOutCol Is Nothing Then\n' don't move the top line, it contains the headers - no data\n                    Set myInCol = aCol\n                    Set myInCol = myInCol.Offset(1, 0).Resize(myInCol.Rows.Count - 1, myInCol.Columns.Count)\n' transfer data from the project tab to the consolidated tab\n                    iLoop = jLoop\n                    For Each aRow In myInCol.Rows\n                        myOutCol.Cells(iLoop, 1).Value = aRow.Cells(1, 1).Value\n                        iLoop = iLoop + 1\n                    Next aRow\n                End If\n            Next aCol\n        End If\n        If iLoop &gt; jLoop Then jLoop = iLoop\n    Next myInSht\nEnd Sub\n</code></pre>\n\n<p>I used the following to test ...\nThe consolidated tab before consolidation ...\n<a href=\"https://i.stack.imgur.com/M6KVA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M6KVA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Project A contents ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/wU2dR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wU2dR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Project B contents ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/epMiV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/epMiV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Project C contents ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/RCIbN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RCIbN.png\" alt=\"enter image description here\"></a></p>\n\n<p>And after running the consolidation routine ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/aUXWJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aUXWJ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 0, "accepted_answer_id": 36462569, "answer_count": 1, "score": 0, "last_activity_date": 1481644349, "creation_date": 1459928063, "last_edit_date": 1531164843, "question_id": 36444383, "link": "https://stackoverflow.com/questions/36444383/how-to-consolidate-data-of-specific-columns-from-multiple-sheet-to-one-sheet-usi", "title": "How to consolidate data of Specific columns from multiple sheet to one sheet using excel macro when the required columns are not in same order", "body": "<p>I have defects for different project in an excel sheet with 10 project sheets e.g sheet A, Sheet B Sheet C ,Sheet D ,sheet E,Sheet F etc</p>\n\n<p>Each sheet has different columns, <strong>Defect id, defect summary, severity, priority, reported by, assigned to, status, date</strong> etc</p>\n\n<p>I want following columns (which is <strong>NOT IN SAME ORDER in all sheets</strong>) from all sheets to one sheet(defectconsolidation) </p>\n\n<p><strong>Defect id,Defect summary,severity,priority and status</strong></p>\n\n<p>When clicked a button , I need to see all above fields from <strong>JUST A,B and C project sheet and not from  all project.</strong></p>\n\n<p>hope some one will help.</p>\n\n<p><strong>Note</strong>: I can copy paste it manually but the requirement is we need to have a macro \nso far just created a excel sheet with name \"defect consolidation\" in my workbook\nthats all :( am bit new to macro</p>\n\n<p>system details : windows 7 and microsoft offer 2010.</p>\n"}, {"tags": ["vba", "syntax"], "comments": [{"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "edited": false, "score": 0, "creation_date": 1459926999, "post_id": 36443663, "comment_id": 60501699, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff194878.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194878.aspx</a> The Substitue command is expecting a string and it looks as though the string was never closed as you indicated."}], "answers": [{"tags": [], "owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "is_accepted": false, "score": 0, "last_activity_date": 1459927342, "creation_date": 1459927342, "answer_id": 36444159, "question_id": 36443663, "link": "https://stackoverflow.com/questions/36443663/syntax-error-in-vba-due-to-region-difference/36444159#36444159", "title": "Syntax error in VBA due to region difference", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff194878.aspx\" rel=\"nofollow\">msdn.microsoft.com/en-us/library/office/ff194878.aspx</a> </p>\n\n<p>The \"Substitute\" expression is expecting a string and it looks as though the string was never closed as you indicated. So instead of using the above it should be written as follows:</p>\n\n<pre><code>modyear = Application.WorksheetFunction.Substitute(modyear, \"?\", \"\")\n[String With Text] = Application.WorksheetFunction.Substitute([String With Text], [Find This String], [Replace Found String With This])\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6165053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2856d0c83b2114821fb899c31047ce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Jongil Lee", "link": "https://stackoverflow.com/users/6165053/jongil-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459927342, "creation_date": 1459925836, "last_edit_date": 1459925998, "question_id": 36443663, "link": "https://stackoverflow.com/questions/36443663/syntax-error-in-vba-due-to-region-difference", "title": "Syntax error in VBA due to region difference", "body": "<p>we're using excel macro for development work and mainly US team is developed. Whenever they deploy new macro it has some syntax issue.\nI just copied file from server and paste my laptop but it shows syntax error as below, I requested to confirm again from colleague, there is no issue.\n(Sorry I could not share whole code)</p>\n\n<p>: Syntax Error code, When I got error, code show like below.</p>\n\n<pre><code>modyear = Application.WorksheetFunction.Substitute(modyear, \"?, \"\")\n</code></pre>\n\n<p>--> the code missed quotation mark at behind of question mark, so if I modified code with additional quotation market then it works well.</p>\n\n<p>Does anyone know what's the reason to change character or way to find out root cause.\nThank you.</p>\n"}, {"tags": ["excel", "oracle", "vba"], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 1706531, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ab1d93da7069d856fdadf95ba59c141a?s=128&d=identicon&r=PG", "display_name": "Swaroop Nagendra", "link": "https://stackoverflow.com/users/1706531/swaroop-nagendra"}, "edited": false, "score": 0, "creation_date": 1459931546, "post_id": 36444960, "comment_id": 60504435, "body": "getting same error. Even though i have OraOLEDB*.dll files inside bin dir, it is throwing the error."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1459946352, "post_id": 36444960, "comment_id": 60515462, "body": "<code>OraOLEDB</code> is not <code>MSDAORA</code>. If you like to use the Oracle provider (which is the recommended one, because the Microsoft MSDAORA has been deprecated for years) you must use <code>Provider=OraOLEDB.Oracle</code>. OraOLEDB must be registered on the PC, simple file copy is not sufficient. Look for <code>REGSVR32.exe</code> if it is not registered."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1459929672, "creation_date": 1459929672, "answer_id": 36444960, "question_id": 36443649, "link": "https://stackoverflow.com/questions/36443649/provider-not-found-for-oracle-oraoledb/36444960#36444960", "title": "provider not found for oracle OraOLEDB", "body": "<p>please check with this code</p>\n\n<pre><code>Sub Oracle_Connection_VBA()\n    Dim con As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim query As String\n    Set con = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n    'Replace below with the corresponding values\n    strcon = \"Provider=MSDAORA;Data Source=[Your Database];Persist Security Info=True;User ID=[DB username];Password=[DbPassword]\"\n    con.Open (strcon)\n    'do\n    con.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 1706531, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ab1d93da7069d856fdadf95ba59c141a?s=128&d=identicon&r=PG", "display_name": "Swaroop Nagendra", "link": "https://stackoverflow.com/users/1706531/swaroop-nagendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1788, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459929672, "creation_date": 1459925785, "question_id": 36443649, "link": "https://stackoverflow.com/questions/36443649/provider-not-found-for-oracle-oraoledb", "title": "provider not found for oracle OraOLEDB", "body": "<p>I am trying to run a vba script in excel using Oracle db. When i try to establish a conn, it is showing some error like:</p>\n\n<pre><code>Connection Error\nImport failed: 3706 - Provider cannot be found. it may not be installed properly.\n</code></pre>\n\n<p>I know there are many Q&amp;A related to this, but i couldn't find any useful answers. please help me.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1459925122, "post_id": 36443335, "comment_id": 60500617, "body": "you could also go     <code>With Worksheets(&quot;Sheet1&quot;).Cells(1, 1).CurrentRegion         .Columns.AutoFit         .WrapText = False     End With</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459925344, "post_id": 36443335, "comment_id": 60500739, "body": "Good point; that would tighten it up a bit. I used the loop to exercise the .columns.count property of currentregion more than anything else."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459925956, "post_id": 36443335, "comment_id": 60501084, "body": "Of course I very well knew you knew it... it was just to add something possibly useful to the OP. and I&#39;m a big fan of &quot;tighten it up&quot;!"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1459926590, "post_id": 36443335, "comment_id": 60501458, "body": "Thanks for both your help! I really appreciate it. I managed to solve the issue with the code below:  <code>.UsedRange.Columns.AutoFit</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1459924672, "creation_date": 1459924672, "answer_id": 36443335, "question_id": 36443022, "link": "https://stackoverflow.com/questions/36443022/excel-vba-remove-overlapping-of-data-into-adjacent-fields/36443335#36443335", "title": "Excel VBA remove overlapping of data into adjacent fields", "body": "<p>I believe you are looking for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820840.aspx\" rel=\"nofollow\">Range.AutoFit</a> method.</p>\n\n<pre><code>Sub allFit()\n    Dim c As Long\n\n    With Worksheets(\"Sheet1\")\n        With .Cells(1, 1).CurrentRegion\n            For c = 1 To .Columns.Count\n                With .Columns(c)\n                    .WrapText = False\n                    .AutoFit\n                End With\n            Next c\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 3, "last_activity_date": 1459925497, "last_edit_date": 1459925497, "creation_date": 1459924747, "answer_id": 36443356, "question_id": 36443022, "link": "https://stackoverflow.com/questions/36443022/excel-vba-remove-overlapping-of-data-into-adjacent-fields/36443356#36443356", "title": "Excel VBA remove overlapping of data into adjacent fields", "body": "<p>Try to use this. Simple function, where you first select sheet where to apply, and then use function AutoFit on Columns (which means all columns) and it will size of columns by text length. Also you can select only some columns and etc... but its for different question</p>\n\n<pre><code>Sub adjustColumns()\n    Sheets(\"Sheet3\").Columns.AutoFit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 36443335, "answer_count": 2, "score": 2, "last_activity_date": 1459925497, "creation_date": 1459923539, "last_edit_date": 1459925233, "question_id": 36443022, "link": "https://stackoverflow.com/questions/36443022/excel-vba-remove-overlapping-of-data-into-adjacent-fields", "title": "Excel VBA remove overlapping of data into adjacent fields", "body": "<p>I'm trying to write a VBA script that incorporates the function to remove the overlapping of data into the adjacent cells and resize the cell to fit the length of the data as shown in the followings snaps. </p>\n\n<p>1) Original layout of data in Excel</p>\n\n<p><a href=\"https://i.stack.imgur.com/hmlee.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hmlee.png\" alt=\"Before\"></a></p>\n\n<p>2) Click the top let hand corner to select all fields</p>\n\n<p><a href=\"https://i.stack.imgur.com/mT24P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mT24P.png\" alt=\"Select all fields\"></a></p>\n\n<p>3) Double click on the sides of the cell at the columns to resize cells to fit data lengths.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bPmu5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bPmu5.png\" alt=\"Double click when this cursor appears\"></a></p>\n\n<p>Currently, I am using <code>.HorizontalAlignment</code> below, but it does not work:</p>\n\n<pre><code>With wks\n    With .Cells(1, 1).CurrentRegion\n        lastCol = .Columns.Count\n        lastRow = .Rows.Count\n    End With\n\n    'Select the interested cells and insert borders around the interested fields\n    .UsedRange.Borders.LineStyle = xlContinuous\n    .UsedRange.HorizontalAlignment = xlLeft\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459931225, "post_id": 36442787, "comment_id": 60504246, "body": "Could you please provide more detail on HOW it &quot;didn&#39;t work&quot;. Did you get an error? Did nothing copy? Or is something on the Clipboard, but pasting in Word is causing a problem?"}, {"owner": {"reputation": 58, "user_id": 4452902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69f368fa321df15a31c8e4db50fc75a?s=128&d=identicon&r=PG&f=1", "display_name": "marcelo13k", "link": "https://stackoverflow.com/users/4452902/marcelo13k"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459937586, "post_id": 36442787, "comment_id": 60508917, "body": "@CindyMeister Nothing happened. The CopyPicture and PasteSpecial commands did not throw any error, but the bitmap did not appear in the word document."}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 4452902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69f368fa321df15a31c8e4db50fc75a?s=128&d=identicon&r=PG&f=1", "display_name": "marcelo13k", "link": "https://stackoverflow.com/users/4452902/marcelo13k"}, "edited": false, "score": 0, "creation_date": 1460022999, "post_id": 36448188, "comment_id": 60555745, "body": "It produces the same result as without <code>xlScreen, xlBitmap</code> , meaning, no bitmap is copied, no error is thrown (of course I assumed <code>CopyPicture</code> dup is just a typo in your answer)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1459938010, "creation_date": 1459938010, "answer_id": 36448188, "question_id": 36442787, "link": "https://stackoverflow.com/questions/36442787/copying-a-bitmap-from-an-excel-cells-comment-to-a-word-document-using-vba/36448188#36448188", "title": "Copying a bitmap from an Excel cell&#39;s comment to a Word document using VBA", "body": "<p>try this</p>\n\n<pre><code>Range(\"A\" &amp; row).Comment.Shape.CopyPicture.CopyPicture xlScreen, xlBitmap\nWith wSelection\n    .PasteSpecial datatype:=wdPasteBitmap\n    ...\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 4452902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69f368fa321df15a31c8e4db50fc75a?s=128&d=identicon&r=PG&f=1", "display_name": "marcelo13k", "link": "https://stackoverflow.com/users/4452902/marcelo13k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1066, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459938010, "creation_date": 1459922663, "last_edit_date": 1531164843, "question_id": 36442787, "link": "https://stackoverflow.com/questions/36442787/copying-a-bitmap-from-an-excel-cells-comment-to-a-word-document-using-vba", "title": "Copying a bitmap from an Excel cell&#39;s comment to a Word document using VBA", "body": "<p>I wrote a macro to generate a questionnaire Word document from an Excel file.<br>\nThe excel row looks like this (the image is inside the cell's comment):</p>\n\n<p><a href=\"https://i.stack.imgur.com/yo1S7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yo1S7.png\" alt=\"excel db\"></a> </p>\n\n<p>I want the word Document to look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CRgid.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CRgid.png\" alt=\"word result\"></a></p>\n\n<p>So far I managed to create the question, but without the picture using this code:</p>\n\n<pre><code>... open app and document and get the relevant styles...\n\nWith wSelection\n    .Style = Question\n    .TypeText vbCrLf\n\n    .Style = QuestionBody\n    .TypeText Range(\"A\" &amp; row).Value &amp; vbCrLf\n\n\n    'Here I need to copy the bitmap\n    'How?\n\n\n    .Style = Answer\n    For Col = Asc(\"B\") To Asc(\"E\")\n        answerOption = Range(Chr(Col) &amp; row).Value\n        .TypeText answerOption &amp; vbCrLf\n    Next Col\n\n    .Style = wDoc.Styles(wdStyleNormal)\nEnd With\n</code></pre>\n\n<p>I cannot find how to copy the bitmap in the comment to the word document.\nI tried to use:</p>\n\n<pre><code>Range(\"A\" &amp; row).Comment.Shape.CopyPicture\n.PasteSpecial datatype:=wdPasteBitmap\n'or just .Paste\n</code></pre>\n\n<p>But it didn't work.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 521, "user_id": 4759923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6208b717188e9b434bef2bc9bba339f7?s=128&d=identicon&r=PG&f=1", "display_name": "user4759923", "link": "https://stackoverflow.com/users/4759923/user4759923"}, "edited": false, "score": 0, "creation_date": 1459922393, "post_id": 36442691, "comment_id": 60499209, "body": "What do you want to do? Please explain more cleary. What are you expecting? What is happening?"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 521, "user_id": 4759923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6208b717188e9b434bef2bc9bba339f7?s=128&d=identicon&r=PG&f=1", "display_name": "user4759923", "link": "https://stackoverflow.com/users/4759923/user4759923"}, "edited": false, "score": 0, "creation_date": 1459923084, "post_id": 36442691, "comment_id": 60499528, "body": "@user4759923 See my edited question"}], "answers": [{"comments": [{"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459923499, "post_id": 36442892, "comment_id": 60499728, "body": "see my edited answer, I&#39;m not looking for records that not exist, but records that not exist with same ID as in TableB and have one of the field same as in TableB."}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "reply_to_user": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459923570, "post_id": 36442892, "comment_id": 60499774, "body": "And thats what my first query does. @LuckyLuke82"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459923672, "post_id": 36442892, "comment_id": 60499823, "body": "Sorry @sagi, I haven&#39;t seen your second SQL, this works, thanks!!. First one not, second one."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459925971, "post_id": 36442892, "comment_id": 60501092, "body": "sorry to say, but I fully tested now - IT doesn&#39;t work ! It works when one of the other fields are Null, but if both fields have values  - checkbox gets checked even If ID is same in both tables. Should I use your 3rd SQL suggestion  or what ?"}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "reply_to_user": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459926276, "post_id": 36442892, "comment_id": 60501264, "body": "@LuckyLuke82 Yes, if what you need is what is said there. It combine the first two together :)"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459926634, "post_id": 36442892, "comment_id": 60501476, "body": "No, actually I don&#39;t need this, I tested now. What I need is what I edited in my question. Problem with your suggestion is when one of 2 other fields (not ID), have the same value as in different records - checkbox still gets checked. I hope you understand - I need to check only 1 record, and compare only 1 record, not matches in whole table."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459927005, "post_id": 36442892, "comment_id": 60501702, "body": "I think there might be some problems with &quot;&lt;&gt;&quot; in Access. Are there any alternatives ?"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1459928149, "post_id": 36442892, "comment_id": 60502406, "body": "I believe this is a bug in Access. It has to be some other solution."}], "tags": [], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "is_accepted": true, "score": 2, "last_activity_date": 1459923640, "last_edit_date": 1459923640, "creation_date": 1459923040, "answer_id": 36442892, "question_id": 36442691, "link": "https://stackoverflow.com/questions/36442691/access-sql-one-field-doesnt-exist-at-least-one-of-other-do-exist/36442892#36442892", "title": "Access SQL - One field doesn&#39;t exist, at least one of other do exist", "body": "<p>Use <code>NOT EXISTS()</code> , your query checks if there is a record with another ID, it doesn't check if <strong>ALL</strong> records have other ID :</p>\n\n<pre><code>UPDATE TableA\nSET TableA.checkbox = true\nWHERE NOT EXISTS(SELECT 1 FROM TableB\n                 WHERE (TableB_Name=TableA.Name OR TableB.Surname=TableA.Surname)\n                       AND TableB.ID=TableA.ID)\n</code></pre>\n\n<p>This will update the field to <code>true</code> only if a record with the same name/surname and ID doesn't exists.</p>\n\n<p>If 1 record with different ID is enough, you can use <code>EXISTS()</code> on the same principal : </p>\n\n<pre><code>UPDATE TableA\nSET TableA.checkbox = true\nWHERE EXISTS(SELECT 1 FROM TableB\n             WHERE (TableB_Name=TableA.Name OR TableB.Surname=TableA.Surname)\n                   AND TableB.ID&lt;&gt;TableA.ID)\n</code></pre>\n\n<p>Maybe you meant a combination , a record with the same ID doesn't exists, but exists one with another ID.. Then :</p>\n\n<pre><code>UPDATE TableA\nSET TableA.checkbox = true\nWHERE NOT EXISTS(SELECT 1 FROM TableB\n                 WHERE (TableB_Name=TableA.Name OR TableB.Surname=TableA.Surname)\n                       AND TableB.ID=TableA.ID)\n AND EXISTS(SELECT 1 FROM TableB\n            WHERE (TableB_Name=TableA.Name OR TableB.Surname=TableA.Surname)\n                  AND TableB.ID&lt;&gt;TableA.ID)\n</code></pre>\n"}], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 36442892, "answer_count": 1, "score": 0, "last_activity_date": 1594642396, "creation_date": 1459922298, "last_edit_date": 1594642396, "question_id": 36442691, "link": "https://stackoverflow.com/questions/36442691/access-sql-one-field-doesnt-exist-at-least-one-of-other-do-exist", "title": "Access SQL - One field doesn&#39;t exist, at least one of other do exist", "body": "<p>I need to update Checkbox in table, If same ID in another table doesn't exist, but at least one of other fields do exist. Here is what I have:</p>\n\n<pre><code>UPDATE TableA\n       INNER JOIN TableB_\n       ON TableB_Name=TableA.Name OR TableB.Surname=TableA.Surname\n       AND NOT TableB.ID=TableA.ID\n       SET TableA.Checkbox=True\n</code></pre>\n\n<p>This SQL is placed in load event of form. What am I doing wrong ?</p>\n\n<p>EDIT: What I want to do - </p>\n\n<pre><code>TableA\n\nID    Name  Surname \n200   John  Mills\n\nTableB\n\nID    Name  Surname\n300   Jane  Mills\n</code></pre>\n\n<p>You notice that in both table there is a match in \"Surname\" field. I want Checkbox to be checked in this case, BUT ID MUST BE DIFFERENT.</p>\n\n<p>In other words, I want to set Checkbox to True if there is a record with DIFFERENT ID, but one of the other fields are same.</p>\n"}, {"tags": ["vba", "listview", "drag-and-drop", "treeview", "activex"], "answers": [{"comments": [{"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1490924114, "post_id": 36507039, "comment_id": 73340220, "body": "Accept this as the answer, you put heaps of effort into it."}], "tags": [], "owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "is_accepted": false, "score": 6, "last_activity_date": 1460141109, "last_edit_date": 1495542326, "creation_date": 1460141109, "answer_id": 36507039, "question_id": 36442535, "link": "https://stackoverflow.com/questions/36442535/vba-drag-drop-from-treeview-to-listview-listview-to-treeview-activex-controls/36507039#36507039", "title": "VBA Drag Drop From TreeView to ListView &amp; ListView to TreeView (ActiveX Controls)", "body": "<p>Whew! After a few days of playing around and research I was able to find the answer on my own. Here it is for others who may have the same problem.</p>\n\n<p><b>First, a few important notes:</b></p>\n\n<p><b>1). You must set the following OLE properties for the TreeView and ListView.</b></p>\n\n<pre><code>TreeView1.OLEDragMode = 1  'Automatic \nListView1.OLEDropMode = 1  'Manual\n</code></pre>\n\n<p><b>2). In order to determine the selected node from the TreeView, you must use the HitTest method during the MouseDown event.</b></p>\n\n<p>This was causing a large part of my problem because I couldn't ever get it to give me the right selected node to then know what data to add to my ListView. </p>\n\n<p>To determine the selected node you use the TreeView.SelectedItem property. The quirky thing with that though is that unless you set it during the MouseDown event, VB will always think the previously item you selected item is the current selected item and add the wrong data to the ListView. Why?</p>\n\n<p>The TreeView.SelectedItem is determined on the MouseUp event. If, for example, you do a full mouse click and release on \"Node 1\", both the MouseDown and MouseUp events fire and the MouseUp event will set the TreeView.SelectedItem to \"Node 1\". Then, if you down click and HOLD the mouse button on \"Node 2\" and then immediately begin dragging (without releasing the mouse button), only the MouseDown event triggers. Since the MouseUp event never triggers, the TreeView.SelectedItem property stays as \"Node 1\" even though you are dragging \"Node 2\".  Therefore, when you try to use the SelectedItem property later to determine what to add to the target ListView (in my case) it gets the wrong data.</p>\n\n<p><b>3). When using the HitTest method during the MouseDown event, you must convert the Pixels to TWIPS.</b></p>\n\n<p>The MouseDown method returns the x-y coordinates in pixels, however, in VBA the HitTest method uses TWIPS (apparently .NET which now uses pixels so no conversion is needed there). So in order to determine the correct node, you have to convert it. I've read most to almost all Windows computers have a 15 to 1 ratio so you can simply use the following:</p>\n\n<pre><code>Set TreeView1.SelectedItem = TreeView1.HitTest(x * 15, y * 15)\n</code></pre>\n\n<p>However, if you don't want to take the chance that the 15 to 1 ratio will work for all Windows computers, you can calculate it using Windows API calls which I demonstrate below.</p>\n\n<p><b>Here's the stripped down version of the code.</b></p>\n\n<p>Note I'm keeping it simple by using the 'Automatic' drag property and settings so I don't have to use the 'DataObject' methods to set the cursor, determine the drag effects, etc... I'm just using the defaults and keeping it simple.</p>\n\n<pre><code>Private Sub TreeView1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As stdole.OLE_XPOS_PIXELS, ByVal y As stdole.OLE_YPOS_PIXELS)\n    Set TreeView1.SelectedItem = Nothing\n    If TreeView1.SelectedItem Is Nothing Then\n        Set TreeView1.SelectedItem = TreeView1.HitTest(x * 15, y * 15)\n    End If\nEnd Sub\n\nPrivate Sub TreeView1_OLEStartDrag(Data As MSComctlLib.DataObject, AllowedEffects As Long)\n    Data.SetData TreeView1.SelectedItem.Text, 1\nEnd Sub\n\nPrivate Sub ListView1_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)\n    ListView1.ListItems.Add ListView1.ListItems.Count + 1, , Data.GetData(1)\nEnd Sub\n</code></pre>\n\n<p>That's it!</p>\n\n<p>You should be able to take it from there to add any additional features you want.  Below, I've given a couple more alternatives.</p>\n\n<p><b>Alternative 1 - Giving a Highlight Effect</b></p>\n\n<p>An alternative approach could be used to give the visual to the user that highlights the tree node before selecting. (Note: You could do this during the TreeView OLEDragOver event as well, but I'm using the MouseMove Event)</p>\n\n<pre><code>Private Sub TreeView1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As stdole.OLE_XPOS_PIXELS, ByVal y As stdole.OLE_YPOS_PIXELS)\n    If Not (TreeView1.HitTest(x * TwipsPerPixelX, y * TwipsPerPixelY) Is Nothing) Then\n        Dim MyNode As Node\n        Set MyNode = TreeView1.HitTest(x * 15, y * 15)\n        MyNode.Selected = True\n        Set MyNode = Nothing\n    End If\nEnd Sub\n\nPrivate Sub TreeView1_OLEStartDrag(Data As MSComctlLib.DataObject, AllowedEffects As Long)\n    Data.SetData TreeView1.SelectedItem.Text, 1\nEnd Sub\n\nPrivate Sub ListView1_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)\n    ListView1.ListItems.Add ListView1.ListItems.Count + 1, , Data.GetData(1)\nEnd Sub\n</code></pre>\n\n<p><b>Alternative 2 - Calculating the Pixels to TWIPS Conversion</b></p>\n\n<p>Remember, this is only needed in VBA. You don't need to do this in .NET because I believe it uses pixels in both the Events and the HitTest methods.</p>\n\n<p>Instead of explicitly stating the conversion as 15 as in the above:</p>\n\n<pre><code>Set MyNode = TreeView1.HitTest(x * 15, y * 15)\n</code></pre>\n\n<p>You could calculate it using a combination of Windows API calls and your own function.  Here's how.</p>\n\n<p>First, the Windows API calls and user defined function placed in Module1:</p>\n\n<pre><code>Public Declare Function GetDesktopWindow Lib \"user32\" () As Long\nPublic Declare Function GetDC Lib \"user32\" (ByVal hwnd As Long) As Long\nPublic Declare Function GetDeviceCaps Lib \"gdi32\" (ByVal hdc As Long, ByVal nIndex As Long) As Long\nPublic Declare Function ReleaseDC Lib \"user32\" (ByVal hwnd As Long, ByVal hdc As Long) As Long\n\nConst LOGPIXELSX = 88\nConst LOGPIXELSY = 90\n\nPublic Function TwipsPerPixelX() As Integer\n    Dim MyDesktopWindowHandle As Long, MyDesktopWindowDeviceContext As Long\n    Dim MyWidthOfScreen As Long, MyUsedToReleaseDeviceContext As Long\n   'Get the handle of the desktop window\n    MyDesktopWindowHandle = GetDesktopWindow()\n    'Get the desktop window's device context\n    MyDesktopWindowDeviceContext = GetDC(MyDesktopWindowHandle)\n    'Get the width of the screen\n    MyWidthOfScreen = GetDeviceCaps(MyDesktopWindowDeviceContext, LOGPIXELSX)\n    'Release the device context\n    MyUsedToReleaseDeviceContext = ReleaseDC(MyDesktopWindowHandle, MyDesktopWindowDeviceContext)\n\n    TwipsPerPixelX = 1440 / MyWidthOfScreen '1 inch is always 1440 twips\nEnd Function\n\nPublic Function TwipsPerPixelY() As Integer\n    Dim MyDesktopWindowHandle As Long, MyDesktopWindowDeviceContext As Long\n    Dim MyHeightOfScreen As Long, MyUsedToReleaseDeviceContext As Long\n\n    'Get the handle of the desktop window\n    MyDesktopWindowHandle = GetDesktopWindow()\n    'Get the desktop window's device context\n    MyDesktopWindowDeviceContext = GetDC(MyDesktopWindowHandle)\n    'Get the width of the screen\n    MyHeightOfScreen = GetDeviceCaps(MyDesktopWindowDeviceContext, LOGPIXELSY)\n    'Release the device context\n    MyUsedToReleaseDeviceContext = ReleaseDC(MyDesktopWindowHandle, MyDesktopWindowDeviceContext)\n\n    TwipsPerPixelY = 1440 / MyHeightOfScreen '1 inch is always 1440 twips\nEnd Function\n</code></pre>\n\n<p>Then change the HitTest part of the code to the following:</p>\n\n<pre><code>Set TreeView1.SelectedItem = TreeView1.HitTest(x * TwipsPerPixelX, y * TwipsPerPixelY)\n</code></pre>\n\n<p>Hope that helps!</p>\n\n<p><b>References:</b></p>\n\n<p>Here are the references that helped piece this together and I must give credit where credit is due. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/5860529/creating-a-mouse-over-effect-on-a-vb-treeview-node\">Creating a &#39;mouse over&#39; effect on a VB TreeView node</a></p>\n\n<p><a href=\"http://forums.ni.com/t5/facebookforums/facebooksingletopicpage/facebook-app/417075545007603/message-uid/78682/tab/board/page/4806\" rel=\"nofollow noreferrer\">http://forums.ni.com/t5/facebookforums/facebooksingletopicpage/facebook-app/417075545007603/message-uid/78682/tab/board/page/4806</a></p>\n\n<p><a href=\"http://vbcity.com/forums/t/49091.aspx\" rel=\"nofollow noreferrer\">http://vbcity.com/forums/t/49091.aspx</a></p>\n\n<p><a href=\"http://www.experts-exchange.com/questions/20497792/TwipsPerPixelX-Y-via-the-API-for-VBA.html\" rel=\"nofollow noreferrer\">http://www.experts-exchange.com/questions/20497792/TwipsPerPixelX-Y-via-the-API-for-VBA.html</a></p>\n"}], "owner": {"reputation": 1013, "user_id": 3448932, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/jBnU6.jpg?s=128&g=1", "display_name": "ptownbro", "link": "https://stackoverflow.com/users/3448932/ptownbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4322, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460141109, "creation_date": 1459921684, "question_id": 36442535, "link": "https://stackoverflow.com/questions/36442535/vba-drag-drop-from-treeview-to-listview-listview-to-treeview-activex-controls", "title": "VBA Drag Drop From TreeView to ListView &amp; ListView to TreeView (ActiveX Controls)", "body": "<p>Trying to drag a child node only from a ActiveX TreeView Control to an ActiveX ListView control in VBA for Excel. It works occasionally, but something is wrong.  I'm unable to consistently get the drag event to fire (sometimes it works, sometimes not) or, when it does, determine what was selected to add to the listivew. </p>\n\n<p>My TreeView has the following nodes</p>\n\n<pre><code>-US (tag='parent')\n   -West (tag='parent')\n       -CA (tag='child')\n       -WA (tag='child')\n   -East (tag='parent')\n       -NY (tag='child')\n       -FL (tag='child')\n</code></pre>\n\n<p>In the above, I only want the drag to work on the nodes taged as 'child'. My attempted code is as follows:</p>\n\n<pre><code>Dim MyTreeNode As Node\nDim MyText As String\n\nPrivate Sub TreeView1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As stdole.OLE_XPOS_PIXELS, ByVal Y As stdole.OLE_YPOS_PIXELS)\n    Dim MyDataObject As DataObject\n    Dim Effect As Integer\n\n    If Button = 1 Then\n        'For some reason this executes multple times even though I'm only picking one node.\n        Debug.Print TreeView1.SelectedItem.Text\n\n        If InStr(1, TreeView1.SelectedItem.Tag, \"Child\") &gt; 0 Then\n            Set MyTreeNode = TreeView1.SelectedItem\n            Set MyDataObject = New DataObject\n\n            MyText = TreeView1.SelectedItem.Text\n            MyDataObject.SetText MyText\n            Effect = MyDataObject.StartDrag\n        End If\n    End If\nEnd Sub\n\nPrivate Sub ListView1_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, X As Single, Y As Single)\n    Dim MyListViewItem As ListItem\n    Set MyListViewItem = ListView1.ListItems.Add(1, \"M\" &amp; MyTreeNode.Key, MyTreeNode.Text)\nEnd Sub\n</code></pre>\n\n<p>Also trying to do this in reverse as well, but starting with TreeView to ListView</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1459920461, "post_id": 36442113, "comment_id": 60498383, "body": "there is no output with this macro. I can see it running, but the temp sheet remains empty. I am on Windows 10 with Office 2013, the code should run on machines with earlier versions though..."}, {"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1459921882, "post_id": 36442113, "comment_id": 60499006, "body": "Note: it seems that your loop from 1 to 255 has issues. I adjusted the code to this and its working: .Range(&quot;A65536&quot;).End(xlUp).Offset(1, 0) = strEnviro"}, {"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "edited": false, "score": 1, "creation_date": 1459928757, "post_id": 36442113, "comment_id": 60502777, "body": "I just tested this and it is working with: .Range(&quot;A&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row + 1).Value = strEnviron"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 3, "last_activity_date": 1459919840, "creation_date": 1459919840, "answer_id": 36442113, "question_id": 36441882, "link": "https://stackoverflow.com/questions/36441882/excel-vba-list-all-vba-environmental-variables/36442113#36442113", "title": "Excel VBA - list all VBA environmental variables", "body": "<p>few lines modified from your code as below.</p>\n\n<pre><code>Sub ListEnvironVariables()\n    Dim strEnviron As String\n    Dim i As Long\n    For i = 1 To 255\n        strEnviron = Environ(i)\n        If LenB(strEnviron) = 0&amp; Then Exit For\n        With Worksheets(\"temp\")\n            .Range(\"A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1).Value = strEnviron\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "edited": false, "score": 0, "creation_date": 1459921377, "post_id": 36442291, "comment_id": 60498777, "body": "this outputs into the VBA Immediate window, not the excel sheet itself. How can I get to paste into the &quot;temp&quot; worksheet instead?"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1459924313, "last_edit_date": 1459924313, "creation_date": 1459920585, "answer_id": 36442291, "question_id": 36441882, "link": "https://stackoverflow.com/questions/36441882/excel-vba-list-all-vba-environmental-variables/36442291#36442291", "title": "Excel VBA - list all VBA environmental variables", "body": "<p>Now I have changed the coding . This will list out all of the environment variables in your immediate window.  If you can't see this, choose this menu option:</p>\n\n<pre><code>  Sub ListEnvironmentVariables()\n'each environment variable in turn\nDim EnvironmentVariable As String\n'the number of each environment variable\nDim EnvironmentVariableIndex As Integer\nDim i As Long\n'get first environment variables\nEnvironmentVariableIndex = 1\nEnvironmentVariable = Environ(EnvironmentVariableIndex)\n'loop over all environment variables till there are no more\nDo Until EnvironmentVariable = \"\"\n'get next e.v. and print out its value\nWith Worksheets(\"temp\")\n            .Cells(i, 1).Value = EnvironmentVariableIndex\n            .Cells(i, 2).Value = EnvironmentVariable\n\n        End With\n'go on to next one\nEnvironmentVariableIndex = EnvironmentVariableIndex + 1\ni = i + 1\nEnvironmentVariable = Environ(EnvironmentVariableIndex)\nLoop\nEnd Sub\n</code></pre>\n\n<p>Plz look into this also for further reference\n<a href=\"http://www.wiseowl.co.uk/blog/s387/environment-variable-vba.htm\" rel=\"nofollow\">http://www.wiseowl.co.uk/blog/s387/environment-variable-vba.htm</a></p>\n"}], "owner": {"reputation": 936, "user_id": 2681133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0360c5e400cca0471779b3f50084378f?s=128&d=identicon&r=PG&f=1", "display_name": "Armitage2k", "link": "https://stackoverflow.com/users/2681133/armitage2k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7155, "favorite_count": 1, "accepted_answer_id": 36442113, "answer_count": 2, "score": 1, "last_activity_date": 1459924313, "creation_date": 1459918760, "question_id": 36441882, "link": "https://stackoverflow.com/questions/36441882/excel-vba-list-all-vba-environmental-variables", "title": "Excel VBA - list all VBA environmental variables", "body": "<p>How can I get excel to list me all available environmental variables on my \"temp\" sheet? Below code doesnt return anything for me...</p>\n\n<pre><code>Sub ListEnvironVariables()\n    Dim strEnviron As String\n    Dim i As Long\n    For i = 1 To 255\n        strEnviron = Environ(i)\n        If LenB(strEnviron) = 0&amp; Then Exit For\n        Debug.Print strEnviron\n    Next\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1459917275, "creation_date": 1459917275, "answer_id": 36441579, "question_id": 36441334, "link": "https://stackoverflow.com/questions/36441334/vba-to-handle-error/36441579#36441579", "title": "VBA to handle error", "body": "<p>You can tell it to jump to a maker on error:</p>\n\n<pre><code>On Error GoTo errFound\nFor intRow = 2 To intLastRow\n    If selenium.GetText(\"//form[@id='searchForm']/div[3]/div/div/table/tbody/tr[1]/td[5]\") = DOS Then\n        clmn = selenium.GetText(\"//form[@id='searchForm']/div[3]/div/div/table/tbody/tr[1]/td[2]\")\n        selenium.findElementByLinkText(clmn).Click\n        FileNo = FileNo + 1\n        Worksheets(\"Input\").Cells(intRow, 9).Value = FileNo\n    End If\nerrFound:\nNext intRow\n</code></pre>\n\n<p>However, I would put some if statements in there to try and handle errors rather than just jumping over them,</p>\n"}], "owner": {"reputation": 381, "user_id": 5087003, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/da9063e840000c81e2ab61cded8be10f?s=128&d=identicon&r=PG&f=1", "display_name": "Amol Naik", "link": "https://stackoverflow.com/users/5087003/amol-naik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459922744, "creation_date": 1459915728, "last_edit_date": 1459922744, "question_id": 36441334, "link": "https://stackoverflow.com/questions/36441334/vba-to-handle-error", "title": "VBA to handle error", "body": "<p>I want to handle error in VBA in IF condition For my following code the problem is that when i write <strong>On error resume Next</strong> it is handling error but continue with next statement in that is condition only,\nBut i want to skip to next for loop</p>\n\n<p>My Code:-</p>\n\n<pre><code>On Error GoTo 0\nOn Error Resume Next\nFor intRow = 2 To intLastRow\n\n  If selenium.getText(\"//form[@id='searchForm']/div[3]/div/div/table/tbody/tr[1]/td[5]\") = DOS Then\n\n    clmn = selenium.getText(\"//form[@id='searchForm']/div[3]/div/div/table/tbody/tr[1]/td[2]\")\n    selenium.findElementByLinkText(clmn).Click\n    FileNo = FileNo + 1\n    Worksheets(\"Input\").Cells(intRow, 9).Value = FileNo\n\n  End If\n\nNext intRow\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "ascii", "sendkeys"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459912613, "post_id": 36440734, "comment_id": 60496014, "body": "You will likely require the Win APi&#39;s SendMessage. You will need to know if you need 32-bit, 64-bit or both and what hte control code for the right [ctrl] key is. See <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">SendMessage function</a> to get started."}], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 5354201, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-kO3NpQm8Hdk/AAAAAAAAAAI/AAAAAAAAAQ0/xmkAxbnqOFI/photo.jpg?sz=128", "display_name": "trademark", "link": "https://stackoverflow.com/users/5354201/trademark"}, "edited": false, "score": 0, "creation_date": 1459912323, "post_id": 36440808, "comment_id": 60495929, "body": "Thanks for the quick answer.  I just tried it and it seems that this doesn&#39;t work in VBA.  It crashes the sub procedure.  If you know of a way of bundling an autoitscript into the office file and calling it with VBA that might also work."}], "tags": [], "owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "is_accepted": false, "score": 0, "last_activity_date": 1459912231, "creation_date": 1459912231, "answer_id": 36440808, "question_id": 36440734, "link": "https://stackoverflow.com/questions/36440734/send-rcontrol-keystroke-from-vba-macro/36440808#36440808", "title": "Send RControl keystroke from VBA Macro", "body": "<p>Have you tried using : {RCTRL}</p>\n\n<p><a href=\"https://www.autoitscript.com/autoit3/docs/appendix/SendKeys.htm\" rel=\"nofollow\">https://www.autoitscript.com/autoit3/docs/appendix/SendKeys.htm</a></p>\n"}], "owner": {"reputation": 354, "user_id": 5354201, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-kO3NpQm8Hdk/AAAAAAAAAAI/AAAAAAAAAQ0/xmkAxbnqOFI/photo.jpg?sz=128", "display_name": "trademark", "link": "https://stackoverflow.com/users/5354201/trademark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459912231, "creation_date": 1459911798, "question_id": 36440734, "link": "https://stackoverflow.com/questions/36440734/send-rcontrol-keystroke-from-vba-macro", "title": "Send RControl keystroke from VBA Macro", "body": "<p>I'm working on a VBA macro which needs to send a series of keystrokes.  For this application, I need to send a keystroke for Right Control.  Just the normal control is not sufficient.  I've seen the SendKeys method, but I don't see where you can specify <em>which</em> Control key is sent.  I'm hoping it's a quick and simple answer.  Thanks!</p>\n\n<p>P.S. I'm still learning SO, so please let me know if I need to add or change something to comply with community standards.  I'll be glad to modify the post.  Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1459911156, "post_id": 36440528, "comment_id": 60495597, "body": "Are you trying to save the workbook or worksheet? The <code>Dialogs(xlDialogSaveAs)</code> will only start in an initial folder when the workbbook has not previously been saved."}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1459911384, "post_id": 36440528, "comment_id": 60495658, "body": "I&#39;m trying to save the workbook. The workbook is exported from an online source and has not been previously saved in any folders. Is that the reason why the SaveAs dialog keeps showing me the C Drive instead?"}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1459912084, "post_id": 36440730, "comment_id": 60495855, "body": "Hi Tyler, I want to be able to see that I am saving the file in the correct location with the correct file name before I save. Is there another way that I can show the dialog box?"}, {"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "reply_to_user": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1459912953, "post_id": 36440730, "comment_id": 60496102, "body": "You could use a msgbox instead. This could act as a dialog box."}, {"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "reply_to_user": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 0, "creation_date": 1459913432, "post_id": 36440730, "comment_id": 60496228, "body": "@Jeeped has a solution below that should work for you."}], "tags": [], "owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "is_accepted": false, "score": 3, "last_activity_date": 1459913166, "last_edit_date": 1459913166, "creation_date": 1459911760, "answer_id": 36440730, "question_id": 36440528, "link": "https://stackoverflow.com/questions/36440528/excel-vba-xldialogsaveas-function-not-working/36440730#36440730", "title": "Excel VBA XLDialogSaveAs function not working", "body": "<p>Instead of showing the Save As Dialog box, just save directly to the folder.</p>\n\n<pre><code>   Application.DisplayAlerts = False\n   wks.SaveAs (sFilename + \"\\TestingFile - \" + Format(Date, \"YYYYMMDD\") + \".xlsx\")\n   Application.DisplayAlerts = True\n</code></pre>\n\n<p>or </p>\n\n<pre><code>   Application.DisplayAlerts = False\n   wks.SaveCopyAs (sFilename + \"\\TestingFile - \" + Format(Date, \"YYYYMMDD\") + \".xlsx\")\n   Application.DisplayAlerts = True\n</code></pre>\n\n<p>Lastly you could create your own Dialog Box to make sure you are saving in the correct location:</p>\n\n<pre><code>'Result = 2 is Cancel\n'Result = 1 is Ok\nresult = MsgBox(\"Would You Like To Save in the Following Location: \" + \"H:\\Test File....\", vbOKCancel, \"Save As\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "reply_to_user": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "edited": false, "score": 2, "creation_date": 1459913731, "post_id": 36440784, "comment_id": 60496288, "body": "@JJ2015 does your folder path exist. This method worked for me, but requires that the path actually exist prior to saving. Otherwise it will revert to the default path."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1459913863, "post_id": 36440784, "comment_id": 60496325, "body": "I actually ran that to my T: drive (a SD card inserted into my laptop) and it came out fine so long as it was a new workbook. Are you sure that the <code>H:\\testing file</code> folder exists? If it doesn&#39;t then yes, it will default back to C:."}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "reply_to_user": {"reputation": 753, "user_id": 3940979, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6104efe52619e157ea5bc08cfb095eb?s=128&d=identicon&r=PG", "display_name": "TsTeaTime", "link": "https://stackoverflow.com/users/3940979/tsteatime"}, "edited": false, "score": 0, "creation_date": 1459914541, "post_id": 36440784, "comment_id": 60496520, "body": "@TylerFurrer &amp; Jeeped, it work&#39;s now! I had that error again because I realised that I was testing from a file that&#39;s saved on my desktop. But now it&#39;s all good. Thank you both so much!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1459912108, "last_edit_date": 1495539920, "creation_date": 1459912108, "answer_id": 36440784, "question_id": 36440528, "link": "https://stackoverflow.com/questions/36440528/excel-vba-xldialogsaveas-function-not-working/36440784#36440784", "title": "Excel VBA XLDialogSaveAs function not working", "body": "<p>While I prefer the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195734.aspx\" rel=\"nofollow noreferrer\">Application.GetSaveAsFilename method</a> (see <a href=\"https://stackoverflow.com/questions/36320580/saveas-wont-accpet-strings-that-contain-in-excel-vba/36320966#36320966\">this</a>), setting the initial folder on a xlDialogSaveAs should be no problem providing that the original workbook has not been previously saved.</p>\n\n<pre><code>Sub externalRatingChangeFile()\n    Dim bSaved As Boolean\n    Dim xlsxFileFormat As XlFileFormat\n\n    'Declare the data type of the variables\n    Dim wks As Worksheet\n    Dim sFilename As String\n\n    'Set wks to the current active worksheet\n    Set wks = ActiveWorkbook.ActiveSheet\n\n    'Set the location to save the file to a variable\n    sFilename = \"H:\\testing file\"\n    xlsxFileFormat = XlFileFormat.xlOpenXMLWorkbook\n\n    'Save as .xlsx file in the specific location stated earlier\n    On Error GoTo err_handler\n    bSaved = Application.Dialogs(xlDialogSaveAs).Show(Arg1:=sFilename &amp; \"\\TestingFile - \" &amp; Format(Date, \"YYYYMMDD\"), _\n                                                      arg2:=xlsxFileFormat)\n\n    'System to/not display alerts to notify Users that they are replacing an existing file.\n    Application.DisplayAlerts = True\n\nerr_handler:\n    'Set Wks to its default value\n    Set wks = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2627, "favorite_count": 0, "accepted_answer_id": 36440784, "answer_count": 2, "score": 1, "last_activity_date": 1459914060, "creation_date": 1459910389, "last_edit_date": 1459914060, "question_id": 36440528, "link": "https://stackoverflow.com/questions/36440528/excel-vba-xldialogsaveas-function-not-working", "title": "Excel VBA XLDialogSaveAs function not working", "body": "<p>I am trying to automatically save a .xls file in a hardcoded location, in the .xlsx file format. I want the SaveAs dialog to be showing the hardcoded location, and the file name that has been coded in the \"File Name:\" field . This is so that all I need to do is click on the Save button. </p>\n\n<p>However, the SaveAs dialog always end up showing C Drive, when I want to save my file in the H Drive. </p>\n\n<p>The following are my codes: </p>\n\n<pre><code>Option Explicit\n\nSub externalRatingChangeFile()\n\n    'Declare the data type of the variables\n    Dim wks As Worksheet\n    Dim sFilename As String\n\n    'Set wks to the current active worksheet\n    Set wks = ActiveWorkbook.ActiveSheet\n\n    'Set the location to save the file to a variable\n    sFilename = \"H:\\testing file\"\n\n    'Save as .xlsx file in the specific location stated earlier\n    'If there are errors in the code, set wks to nothing and end the process\n    On Error GoTo err_handler\n    ChDrive sFilename\n    ChDir sFilename\n    Application.Dialogs(xlDialogSaveAs).Show (sFilename &amp; \"\\TestingFile - \" &amp; Format(Date, \"YYYYMMDD\") &amp; \".xlsx\")\n\n    'System to/not display alerts to notify Users that they are replacing an existing file.\n    Application.DisplayAlerts = True\n\n    err_handler:\n    'Set Wks to its default value\n    Set wks = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1459909494, "creation_date": 1459909494, "answer_id": 36440382, "question_id": 36440185, "link": "https://stackoverflow.com/questions/36440185/worksheet-activate-does-not-run-when-opening-workbook-even-if-i-call-sheet-acti/36440382#36440382", "title": "Worksheet_Activate does not run when opening workbook, even if I call sheet.Activate", "body": "<p>Using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838003.aspx\" rel=\"noreferrer\">Worksheet.Activate method</a> won't do anything if that worksheet was already active.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.ScreenUpdating = False\n    Worksheets(\"Sheet2\").Activate\n    Worksheets(\"Sheet1\").Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Make sure that you are passing the activation trigger to another worksheet and back to Sheet1 in order to run the Worksheet_Activate event macro or just run the code from the Workbook_Open sub.</p>\n"}, {"comments": [{"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1569828333, "post_id": 47851498, "comment_id": 102708138, "body": "It works!  and I think that this answer should be accepted as the best one"}], "tags": [], "owner": {"reputation": 11, "user_id": 9108593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfeb43b244999c51e11cc66daa4399d1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/9108593/nathan"}, "is_accepted": false, "score": 1, "last_activity_date": 1513475387, "last_edit_date": 1513475387, "creation_date": 1513474300, "answer_id": 47851498, "question_id": 36440185, "link": "https://stackoverflow.com/questions/36440185/worksheet-activate-does-not-run-when-opening-workbook-even-if-i-call-sheet-acti/47851498#47851498", "title": "Worksheet_Activate does not run when opening workbook, even if I call sheet.Activate", "body": "<p>Make the <code>Worksheet_Activate</code> <code>Public</code> instead of <code>Private</code>, then run <code>Worksheet(\"???\").Worksheet_Activate</code> within you <code>Workbook_Open</code> code.</p>\n"}], "owner": {"reputation": 47, "user_id": 6133158, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/28482cd6b39e2d2c0bd352f70ab0513e?s=128&d=identicon&r=PG&f=1", "display_name": "Han", "link": "https://stackoverflow.com/users/6133158/han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5485, "favorite_count": 0, "accepted_answer_id": 36440382, "answer_count": 2, "score": 2, "last_activity_date": 1533589709, "creation_date": 1459908262, "last_edit_date": 1533589709, "question_id": 36440185, "link": "https://stackoverflow.com/questions/36440185/worksheet-activate-does-not-run-when-opening-workbook-even-if-i-call-sheet-acti", "title": "Worksheet_Activate does not run when opening workbook, even if I call sheet.Activate", "body": "<p>Currently I have created VBA code in worksheet 1 \"Sheet1\" as </p>\n\n<pre><code>  Private Sub Worksheet_Activate ()\n</code></pre>\n\n<p>So every time I open the worksheet the VBA code will auto run. </p>\n\n<p>But the problem I'm facing now is every time I open the Excel workbook, even though I added the codding in ThisWorkbook, </p>\n\n<pre><code> Private Sub Workbook_Open()\n\n     Worksheets(\"Sheet1\").Activate\n\n End Sub\n</code></pre>\n\n<p>the worksheet will appear first but the VBA code won't auto run. Every time I need to shift another worksheet then shift back again, then only the VBA code will run, this is very annoying, is there any solution to fix this?</p>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1459907474, "post_id": 36440024, "comment_id": 60494611, "body": "All of the Activate and .Select makes this hard to read but try <code>If ActiveCell.Address = Range(&quot;a1&quot;).Address Then</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459909056, "post_id": 36440024, "comment_id": 60495049, "body": "It is not clear to me about your copy and paste operation. If you continually paste the found cells into new cells below where you have found them them the pasted cells are going to show up in the next find. This could lead to another continuous loop until you literally run out of rows on the worksheet. Please specify where you are finding the <b>pdl</b> values and where you are pasting them to."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459911744, "post_id": 36440024, "comment_id": 60495766, "body": "Your comments say &quot;and paste it in a1&quot;, but you never select A1 to paste."}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1459917011, "creation_date": 1459917011, "answer_id": 36441525, "question_id": 36440024, "link": "https://stackoverflow.com/questions/36440024/vba-do-while-loop-wont-exit-loop/36441525#36441525", "title": "vba do while loop wont exit loop", "body": "<pre><code>    If ActiveCell.Address = Range(\"a1\") Then\n        Exit Do\n    Else\n</code></pre>\n\n<p>Activecell.Address will never = Range(\"a1\") (Well it could but you would need the text in cell A1 to read \"$A$1\"</p>\n\n<p>If you want to test if the Activecell is cell A1 then you can do this:</p>\n\n<pre><code>    If ActiveCell.Address = \"$A$1\" Then\n        Exit Do\n    Else\n</code></pre>\n\n<p>Or this</p>\n\n<pre><code>    If ActiveCell.Address = Range(\"A1\").Address Then\n        Exit Do\n    Else\n</code></pre>\n\n<p>I would however encourage you to do some research on how to build macros without using select and selection as its very time costly to use them at run time.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4586547"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 864, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459917011, "creation_date": 1459907140, "last_edit_date": 1531161705, "question_id": 36440024, "link": "https://stackoverflow.com/questions/36440024/vba-do-while-loop-wont-exit-loop", "title": "vba do while loop wont exit loop", "body": "<p>I've been trying to figure out how to get this to break out of the do while loop.  The idea was to copy the first cell that found what I was looking for and paste it in a1 to use that as a reference to break the loop...but it is not working.</p>\n\n<pre><code>    Range(\"A1\").Select\n    Cells.Find(What:=\"pdl\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n        , SearchFormat:=False).Activate\n    Dim x As String\n    ActiveCell.Select\n    Selection.Copy\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    Cells.FindNext(After:=ActiveCell).Activate\n\n    Do While True\n        ActiveCell.Select\n        If ActiveCell.Address = Range(\"a1\") Then\n            Exit Do\n        Else\n            Selection.Copy\n            ActiveCell.Offset(0, 1).Select\n            ActiveSheet.Paste\n            Cells.FindNext(After:=ActiveCell).Activate\n        End If\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>It just keeps looping through the exit do. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1459898346, "post_id": 36438636, "comment_id": 60492237, "body": "Error is on which line?"}, {"owner": {"reputation": 21, "user_id": 6160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff748ceee81670254a50e442cd4fc966?s=128&d=identicon&r=PG&f=1", "display_name": "Stratos7", "link": "https://stackoverflow.com/users/6160404/stratos7"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459920011, "post_id": 36438636, "comment_id": 60498205, "body": "Hi Tim, Error is appearing after &quot;Set Doc = IE.Document&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1459899404, "post_id": 36438742, "comment_id": 60492574, "body": "<code>Set IE = New InternetExplorerMedium</code> creates the object"}, {"owner": {"reputation": 21, "user_id": 6160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff748ceee81670254a50e442cd4fc966?s=128&d=identicon&r=PG&f=1", "display_name": "Stratos7", "link": "https://stackoverflow.com/users/6160404/stratos7"}, "edited": false, "score": 0, "creation_date": 1459920292, "post_id": 36438742, "comment_id": 60498323, "body": "Yes I did try that. For some reason I was forced to use &quot;Set IE = New InternetExplorerMedium&quot; instead of &quot;Set IE = CreateObject(&quot;InternetExplorer.application&quot;)&quot;"}, {"owner": {"reputation": 21, "user_id": 6160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff748ceee81670254a50e442cd4fc966?s=128&d=identicon&r=PG&f=1", "display_name": "Stratos7", "link": "https://stackoverflow.com/users/6160404/stratos7"}, "edited": false, "score": 0, "creation_date": 1460092413, "post_id": 36438742, "comment_id": 60592108, "body": "Tried the new code -- still getting &quot;Object required&quot; error!! Driving me crazy!!!!"}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 1, "last_activity_date": 1459964868, "last_edit_date": 1495540349, "creation_date": 1459898350, "answer_id": 36438742, "question_id": 36438636, "link": "https://stackoverflow.com/questions/36438636/runtime-error-424-object-required-vba-internet-explorer-web-log-in/36438742#36438742", "title": "Runtime error 424 Object required -- VBA + Internet Explorer = Web Log in", "body": "<p>Did you try the method set forth in this example?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24038230/fill-user-name-and-password-in-a-webpage-using-vba\">Fill user name and password in a webpage using VBA</a></p>\n\n<p>I think you need to </p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>In your code you aren't actually creating an object, you're just declaring it.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Maybe bypass the usage of your Doc object:</p>\n\n<pre><code>Sub Website()\n\n  Dim IE As Object, UserName As Object, Password As Object, strCode As String\n\n  Set IE = New InternetExplorerMedium\n  IE.Visible = True\n  IE.Navigate \"http://appln.ABC.com/index.epl\"\n\n  Do While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n  Set UserName = IE.Document.getElementById(\"login_usr\")\n  UserName.Value = \"ABCDE\"\n\n  Set Password = IE.Document.getElementById(\"login_password\")\n  Password.Value = \"ABCDE\"\n\n  Set btnLogin = IE.Document.getElementById(\"Login\")\n  btnLogin.Click\n\nEnd Sub\n</code></pre>\n\n<p>In the linked example they only used one object, it seems you don't need to create objects for everything you're doing.  So, you could probably get away with:</p>\n\n<pre><code>Sub Website()\n\n  Dim IE As Object\n\n  Set IE = New InternetExplorerMedium\n  IE.Visible = True\n  IE.Navigate \"http://appln.ABC.com/index.epl\"\n\n  Do While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n  With IE.Document\n      .getElementById(\"login_usr\").Value = \"ABCDE\"\n      .getElementById(\"login_password\").Value = \"ABCDE\"\n      .getElementById(\"Login\").Click\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>You might also add a second do while loop for ready state, as in that linked example.</p>\n"}, {"comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1459965001, "post_id": 36442649, "comment_id": 60529435, "body": "I didn&#39;t look at your answer until I was done with mine, looks like pretty much the same thing.  Can you explain the purpose of the <code>IHTMLElement</code>?  I don&#39;t see it being used."}, {"owner": {"reputation": 21, "user_id": 6160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff748ceee81670254a50e442cd4fc966?s=128&d=identicon&r=PG&f=1", "display_name": "Stratos7", "link": "https://stackoverflow.com/users/6160404/stratos7"}, "edited": false, "score": 0, "creation_date": 1460001677, "post_id": 36442649, "comment_id": 60544156, "body": "Hi karthick - When I try your code, I am getting &quot;Automation error: The object invoked has disconnected from its clients&quot; error."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1460006947, "post_id": 36442649, "comment_id": 60545890, "body": "@n8. IHTML has never used here hence removed as per your advice.Thanks"}, {"owner": {"reputation": 21, "user_id": 6160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff748ceee81670254a50e442cd4fc966?s=128&d=identicon&r=PG&f=1", "display_name": "Stratos7", "link": "https://stackoverflow.com/users/6160404/stratos7"}, "edited": false, "score": 0, "creation_date": 1460092580, "post_id": 36442649, "comment_id": 60592172, "body": "Tried the code with no result. Error --&gt; &quot;Automation Error. Interface is unknown.&quot;"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1460111192, "post_id": 36442649, "comment_id": 60602079, "body": "try this <code>Set IE = New InternetExplorerMedium</code> instead of <code>Set ie = CreateObject(&quot;InternetExplorer.Application&quot;)</code> and it requires Microsoft Internet Controls"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1460136471, "post_id": 36442649, "comment_id": 60618432, "body": "That&#39;s what my answer does and it&#39;s not working for OP"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1460006955, "last_edit_date": 1460006955, "creation_date": 1459922158, "answer_id": 36442649, "question_id": 36438636, "link": "https://stackoverflow.com/questions/36438636/runtime-error-424-object-required-vba-internet-explorer-web-log-in/36442649#36442649", "title": "Runtime error 424 Object required -- VBA + Internet Explorer = Web Log in", "body": "<pre><code>Sub website()\n    Dim ie As Variant\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n    ie.navigate \"http://appln.ABC.com/index.epl\"\n    Do While ie.readyState &lt;&gt; 4: DoEvents: Loop\n    ie.document.getElementById(\"login_usr\").Value = \"ABCDE\"\n    ie.document.getElementById(\"login_password\").Value = \"ABCDE\"\n    ie.document.getElementById(\"Login\").Click\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 4336570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-Nzg7yEdkUYA/AAAAAAAAAAI/AAAAAAAAImE/_Sdxs4wvXvY/photo.jpg?sz=128", "display_name": "akilesh raj", "link": "https://stackoverflow.com/users/4336570/akilesh-raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1467103252, "creation_date": 1467103252, "answer_id": 38071188, "question_id": 36438636, "link": "https://stackoverflow.com/questions/36438636/runtime-error-424-object-required-vba-internet-explorer-web-log-in/38071188#38071188", "title": "Runtime error 424 Object required -- VBA + Internet Explorer = Web Log in", "body": "<p>I am not sure how but when I set </p>\n\n<pre><code> IE.Visible = False\n</code></pre>\n\n<p>I don't get the error anymore. Please do try and if possible explain why it happens.. </p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 6722550, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dfEm3JaIg3k/AAAAAAAAAAI/AAAAAAAAABU/n86QBa-o-NE/photo.jpg?sz=128", "display_name": "Robert Boyett", "link": "https://stackoverflow.com/users/6722550/robert-boyett"}, "is_accepted": false, "score": 0, "last_activity_date": 1521221091, "last_edit_date": 1521221091, "creation_date": 1521220172, "answer_id": 49326152, "question_id": 36438636, "link": "https://stackoverflow.com/questions/36438636/runtime-error-424-object-required-vba-internet-explorer-web-log-in/49326152#49326152", "title": "Runtime error 424 Object required -- VBA + Internet Explorer = Web Log in", "body": "<p>I was having the same problem and found another possible solution. I was checking <code>IE.Busy</code> in my wait loop. I ended up with the same error. It seems that Excel is not finding a <code>Document</code> element in the IE object initially. When I would wait about 1 minute then continue the code, the error would stop happening. I found the following code gave enough time to ensure the document element was created and Excel could find it to start finding elements.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Do While IE.Busy\n    Do Events\nLoop\n\nDo While IE.readyState &lt;&gt; 4\n    Do Events\nLoop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff748ceee81670254a50e442cd4fc966?s=128&d=identicon&r=PG&f=1", "display_name": "Stratos7", "link": "https://stackoverflow.com/users/6160404/stratos7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5857, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1521221091, "creation_date": 1459897584, "last_edit_date": 1459899717, "question_id": 36438636, "link": "https://stackoverflow.com/questions/36438636/runtime-error-424-object-required-vba-internet-explorer-web-log-in", "title": "Runtime error 424 Object required -- VBA + Internet Explorer = Web Log in", "body": "<p>I am attemting to log into a website using VBA and Internet Explorer. This is causing a Run TIme error 424 \"Object Required\".</p>\n\n<p>Here is my code. Looking for your expert advise. </p>\n\n<pre><code>Sub Website()\n\n  Dim IE As Object, Doc As Object, UserName As Object, Password As Object, strCode As String\n\n  Set IE = New InternetExplorerMedium\n  IE.Visible = True\n  IE.Navigate \"http://appln.ABC.com/index.epl\"\n\n  Do While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n  Set Doc = IE.Document\n\n  Set UserName = Doc.getElementById(\"login_usr\")\n  UserName.Value = \"ABCDE\"\n\n  Set Password = Doc.getElementById(\"login_password\")\n  Password.Value = \"ABCDE\"\n\n  Set btnLogin = Doc.getElementById(\"Login\")\n  btnLogin.Click\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459892988, "post_id": 36437662, "comment_id": 60490191, "body": "So do a <code>case</code> statement on <code>E54</code> and set <code>Copies:=variable</code>. Edit: oops, not copies. Print area XD"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459903574, "post_id": 36437662, "comment_id": 60493675, "body": "google search for sheets printout gets ... <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838253.aspx\" rel=\"nofollow noreferrer\">MSDN</a> . Use <code>from</code> and <code>to</code> to specify the page range you want to print."}, {"owner": {"reputation": 13, "user_id": 6131881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5649bdddd54e962148d3bf6065f272c?s=128&d=identicon&r=PG&f=1", "display_name": "Rob H.", "link": "https://stackoverflow.com/users/6131881/rob-h"}, "edited": false, "score": 0, "creation_date": 1460140352, "post_id": 36437662, "comment_id": 60620584, "body": "Thanks for giving me some direction."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 6131881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5649bdddd54e962148d3bf6065f272c?s=128&d=identicon&r=PG&f=1", "display_name": "Rob H.", "link": "https://stackoverflow.com/users/6131881/rob-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1460140211, "creation_date": 1460140211, "answer_id": 36506793, "question_id": 36437662, "link": "https://stackoverflow.com/questions/36437662/how-to-print-certain-pages-based-on-a-cell-value/36506793#36506793", "title": "How to print certain pages based on a cell value", "body": "<p>I'm not sure if this is the best way to write the code but it works.</p>\n\n<pre><code>Sub Print_Pages()\n\nSheet2.Hide_Blank_Rows2\nSheet3.Hide_Blank_Rows3\n\nDim Sheet As Worksheet: Set Sheet = ThisWorkbook.Worksheets(\"Inspection Report\")\n\n    Select Case CStr(Sheet.Range(\"E54\").Value2)\n    Case \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\"\n\n' Print_Pages_1_2_5_6\n\n    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=2, Copies:=1, Collate _\n        :=True, IgnorePrintAreas:=False\n    ActiveWindow.SelectedSheets.PrintOut From:=5, To:=6, Copies:=1, Collate _\n        :=True, IgnorePrintAreas:=False\n    Sheets(Array(\"Device List\", \"Deficiencies\")).Select\n    Sheets(\"Device List\").Activate\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\n\n    Case \"8\", \"9\", \"10\", \"11\", \"12\", \"13\", \"14\"\n\n' Print_Pages_1_2_3_5_6\n\n    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=3, Copies:=1, Collate _\n        :=True, IgnorePrintAreas:=False\n    ActiveWindow.SelectedSheets.PrintOut From:=5, To:=6, Copies:=1, Collate _\n        :=True, IgnorePrintAreas:=False\n    Sheets(Array(\"Device List\", \"Deficiencies\")).Select\n    Sheets(\"Device List\").Activate\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\n\n    Case \"15\", \"16\", \"17\", \"18\", \"19\", \"20\"\n\n' Print_Pages_1_2_3_4_5_6 Macro\n\n    Sheets(Array(\"Inspection Report\", \"Device List\", \"Deficiencies\")).Select\n    Sheets(\"Inspection Report\").Activate\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\n\n    Case Else\n        ' none\n    End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6131881, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5649bdddd54e962148d3bf6065f272c?s=128&d=identicon&r=PG&f=1", "display_name": "Rob H.", "link": "https://stackoverflow.com/users/6131881/rob-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 0, "accepted_answer_id": 36506793, "answer_count": 1, "score": 0, "last_activity_date": 1460140211, "creation_date": 1459892846, "last_edit_date": 1459900264, "question_id": 36437662, "link": "https://stackoverflow.com/questions/36437662/how-to-print-certain-pages-based-on-a-cell-value", "title": "How to print certain pages based on a cell value", "body": "<p>I have a workbook that has 3 worksheets and I have placed page breaks on the first worksheet to make the document look better.  The first worksheet is 6 pages long.  I would only like to print pages based on the value in cell E54.  If \"E54\"=0 then print pages 1, 5 and 6. If \"E54\" is greater than 0 and less than 8 then print pages 1, 2, 5 and 6. If \"E54\" is greater than 7 and less than 15 then print pages 1, 2, 3, 5 and 6. If \"E54\" is greater than 14 then print all pages.</p>\n\n<p>Here is the Macro that I am currently using to print all worksheets.</p>\n\n<pre><code>Sub Print_All_Pages()\n'\n' Run Macros to hide blank rows then print all three worksheets\n'\nSheet2.Hide_Blank_Rows2\nSheet3.Hide_Blank_Rows3\n'\n    Sheets(Array(\"Inspection Report\", \"Device List\", \"Deficiencies\")).Select\n    Sheets(\"Inspection Report\").Activate\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\n\n\nEnd Sub\n</code></pre>\n\n<p>Because I am hiding rows based on the value of cell \"E54\" it is still printing the pages with just the rows that are repeated at the top of every page.</p>\n"}, {"tags": ["vba", "excel", "if-statement", "do-loops"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1459902356, "post_id": 36437394, "comment_id": 60493363, "body": "A side note, you can&#39;t end a sub in the middle of the code, you need to <code>exit sub</code> instead. <code>End Sub</code> denotes the end of the subroutine"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1459920951, "post_id": 36437394, "comment_id": 60498595, "body": "some possibly useful notes: 1) since <code>otherfiledate </code> is used only once you could avoid declaring and initilializing it and simply go with <code>if FileDateTime(Filepath &amp; &quot;\\&quot; &amp; MyFile)&gt; zmasterdate</code>. 2) <code>ActiveSheet.Paste Destination:=Worksheets(&quot;Reflections&quot;).Range(Cells(erow, 2), Cells(erow, 14))</code> could be simply <code>ActiveSheet.Paste Destination:=Worksheets(&quot;Reflections&quot;).Cells(erow, 2)</code> and excel will fill as many cells as the copied range has. 3) should <code>Sheet1</code> be <code>Worksheets(&quot;Reflections&quot;)</code> then you could go with an <code>WIth Sheet1  .. End With</code> pattern 4) where is Sheet1 defined?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6047012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/140a281802049ec4d904370796482249?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Morales", "link": "https://stackoverflow.com/users/6047012/ivan-morales"}, "edited": false, "score": 0, "creation_date": 1459963857, "post_id": 36437513, "comment_id": 60528741, "body": "By doing that the code stops once it finds otherfiledate &gt; zmasterdate. How do I tell it to continue and go through every file in the folder?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 11, "user_id": 6047012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/140a281802049ec4d904370796482249?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Morales", "link": "https://stackoverflow.com/users/6047012/ivan-morales"}, "edited": false, "score": 0, "creation_date": 1459967217, "post_id": 36437513, "comment_id": 60530865, "body": "if it is stopping then there is some other issue and I am guessing it has to do with the FilePath.  This piece of code does loop through all files in a directory.   FilePath should have an ending \\ to it.  As is sits right now I am guessing it doesn&#39;t since you add a \\ in the filedatetime check."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1459892195, "creation_date": 1459892195, "answer_id": 36437513, "question_id": 36437394, "link": "https://stackoverflow.com/questions/36437394/vba-how-to-tell-if-else-statement-in-a-do-loop-to-continue/36437513#36437513", "title": "VBA: how to tell if/else statement in a do loop to continue", "body": "<p>You already do the check so you don't need an else Clause.  Just move your MyFile = Dir to the end of the loop</p>\n\n<pre><code>Sub Datecheck()\nDim MyFile As String\nDim erow\nDim Filepath As String\nDim otherfiledate As Date\nDim zmasterdate As Date\nFilepath = \"folder of where all files are located\"\nMyFile = Dir(Filepath)\nzmasterdate = FileDateTime(\"location of zmasterdate\")\n\nDo While Len(MyFile) &gt; 0\n    otherfiledate = FileDateTime(Filepath &amp; \"\\\" &amp; MyFile)\n    If otherfiledate &gt; zmasterdate Then\n\n        Workbooks.Open (Filepath &amp; MyFile)\n        Range(\"B4:N4\").Copy\n        ActiveWorkbook.Close\n\n        erow = Sheet1.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n        ActiveSheet.Paste Destination:=Worksheets(\"Reflections\").Range(Cells(erow, 2), Cells(erow, 14))\n\n    End If\n    MyFile = Dir\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6047012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/140a281802049ec4d904370796482249?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Morales", "link": "https://stackoverflow.com/users/6047012/ivan-morales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459901988, "creation_date": 1459891693, "last_edit_date": 1531164843, "question_id": 36437394, "link": "https://stackoverflow.com/questions/36437394/vba-how-to-tell-if-else-statement-in-a-do-loop-to-continue", "title": "VBA: how to tell if/else statement in a do loop to continue", "body": "<p>So I've written a code that goes through a folder opens up documents, copies information, and pastes in a master file located somewhere else. The problem I am having is that I want to add an if, else statement in order to compare the date the last time master file was modified to the documents in the other folder. When it doesn't meet the if statement I want the loop to skip that document and continue to compare the next document. Not sure how to proceed with this, the code can be seen below. </p>\n\n<pre><code>Sub Datecheck()\n    Dim MyFile As String\n    Dim erow\n    Dim Filepath As String\n    Dim otherfiledate As Date\n    Dim zmasterdate As Date\n    Filepath = \"folder of where all files are located\"\n    MyFile = Dir(Filepath)\n    zmasterdate = FileDateTime(\"location of zmasterdate\")\n\n    Do While Len(MyFile) &gt; 0\n        otherfiledate = FileDateTime(Filepath &amp; \"\\\" &amp; MyFile)\n        If otherfiledate &gt; zmasterdate Then\n\n            Workbooks.Open (Filepath &amp; MyFile)\n            Range(\"B4:N4\").Copy\n            ActiveWorkbook.Close\n\n            erow = Sheet1.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n            ActiveSheet.Paste Destination:=Worksheets(\"Reflections\").Range(Cells(erow, 2), Cells(erow, 14))\n\n            MyFile = Dir\n\n        Else\n\n            End Sub\n\n        End If\n    Loop \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 1, "creation_date": 1459898232, "post_id": 36437392, "comment_id": 60492208, "body": "The special field code braces &quot;{ }&quot; aren&#39;t findable using the regular characters {} and ms-word/word-vba do not themselves implement RegEx in the modern sense of the word. See, e.g. <a href=\"http://stackoverflow.com/questions/14547866/vba-syntax-to-find-an-if-conditional-statement-field-code/36209603#36209603\" title=\"vba syntax to find an if conditional statement field code\">stackoverflow.com/questions/14547866/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460058206, "post_id": 36447523, "comment_id": 60580809, "body": "I created the most simple doc. ever, added an XE code (note: which is visible regardless if I have &#39;hidden text&#39; (the backwards P symbol thing) off). Then the simple code I have above works.  Unfortunately, I can&#39;t really share my &quot;live&quot; document as it&#39;s confidental, but I will try to get a parsed down copy that I can share (I really appreciate your offer to help!).  Also, it still randomly will decide to loop through the same <code>.Find</code> part.  Also, FYI I have a bunch of Styles in the document, would that hinder this?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460123294, "post_id": 36447523, "comment_id": 60609969, "body": "Sorry, final question - now that I can grab the text of the Field (with your <code>Mid()</code> formula, I&#39;ve saved that to a String variable (<code>foundText = Mid(rngXE.text, iFieldCodeBegin, ...)</code>).  Where in the code would I loop through that to remove any semicolons, then &quot;reset&quot; the field text to be this new, semicolon-less, text?  I&#39;d do this in the section after you put &quot;Do something with the XE Field Content...&quot;?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1460131746, "post_id": 36447523, "comment_id": 60615681, "body": "Use the REPLACE function to get rid of the semicolons - no need for a loop! There are two places in my code for that: one in the &quot;main loop&quot;, the other in the section that handles tables, which is why I remark you might want to put that code in a different procedure, so you don&#39;t have to write it twice. &quot;Resetting&quot; field content can be tricky - if you run into problems please post a new question. I&#39;ll be marking some of this comments discussion for removal, since the problems no longer repro..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460134533, "post_id": 36447523, "comment_id": 60617381, "body": "Thanks @CindyMeister !!! :D :D (I used <code>editedDefinition = Replace(editedDefinition, &quot;;&quot;, &quot;&quot;)</code>  just before adding to the index.  You&#39;re a great help, I hope you have a nice weekend!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 4, "last_activity_date": 1459936262, "creation_date": 1459936262, "answer_id": 36447523, "question_id": 36437392, "link": "https://stackoverflow.com/questions/36437392/find-all-instances-of-xe-text-text-with-regex/36447523#36447523", "title": "Find all instances of &quot;{ XE text text }&quot; with RegEx", "body": "<p>Actually, you can find the starting braces of a field code using Word's Find by specifying the ESC combination: <code>^d</code> </p>\n\n<p>And when Find picks up the starting point of a field, the entire field is included in the Selection/Range. So you can loop all the XE fields in a document along the following lines:</p>\n\n<pre><code>Sub LoopAllXE()\n    Dim doc As word.Document\n    Dim rngDoc As word.Range\n    Dim rngXE As word.Range\n    Dim bFound As Boolean\n    Dim iFieldCodeBegin As Long\n\n    'Initialization\n    Set doc = ActiveDocument\n    Set rngDoc = doc.content\n    Set rngXE = rngDoc.Duplicate\n    bFound = True\n    iFieldCodeBegin = 6\n    With rngDoc.Find\n        .ClearFormatting\n        .ClearAllFuzzyOptions\n        .Text = \"^d XE\"\n        .Format = False\n        .wrap = wdFindStop\n    End With\n\n    'Get the XE fields' content\n    Do While bFound\n        bFound = rngDoc.Find.Execute\n        If bFound Then\n            Set rngXE = rngDoc.Duplicate\n            'Do something with the XE field content\n            'Below, the content is being trimmed of field code info\n            Debug.Print Mid(rngXE.Text, iFieldCodeBegin, _\n                            Len(rngXE) - iFieldCodeBegin - 1)\n            'Content in table cells needs to be processed differently\n            'in order to avoid looping endlessly on the first \"found\"\n            Do While rngDoc.Information(wdWithInTable) And bFound\n                rngDoc.Collapse wdCollapseEnd\n                'Remainder of cell content after XE-field\n                rngDoc.End = rngDoc.Cells(1).Range.End - 1\n                bFound = rngDoc.Find.Execute\n                Set rngXE = rngDoc.Duplicate\n                'Do something with the XE field content\n                'May make sense to put this in a separate procedure\n                Debug.Print Mid(rngXE.Text, iFieldCodeBegin, _\n                            Len(rngXE) - iFieldCodeBegin - 1)\n                If Not bFound Then\n                    rngDoc.MoveStart wdCell, 1\n                End If\n            Loop\n            rngDoc.Collapse wdCollapseEnd\n            rngDoc.End = doc.content.End\n        End If\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 36447523, "answer_count": 1, "score": 1, "last_activity_date": 1594024535, "creation_date": 1459891689, "last_edit_date": 1594024535, "question_id": 36437392, "link": "https://stackoverflow.com/questions/36437392/find-all-instances-of-xe-text-text-with-regex", "title": "Find all instances of &quot;{ XE text text }&quot; with RegEx", "body": "<p>I'm working on a macro that will loop through my Word document, and select all of the XE codes, to parse through.</p>\n\n<p>I'm trying to use <code>Find</code> to get all such texts, but my regex searches aren't working at all.</p>\n\n<p>I've tried: <code>&lt;/{ XE*/}&gt;</code>, <code>&lt;{*XE*}&gt;</code> to no avail.</p>\n\n<p>To remind, the text will look like this:</p>\n\n<pre><code>{ XE \"Superhero - means a person with some powers\" }\n{ XE \"Mountain is a tall hill, not always climbable.\" }\n{ XE \"Hill is a smaller mountain; not always large.\" }\n</code></pre>\n\n<p>I want to loop through each of these, and add two characters after each <code>;</code>found.  How can I find these using RegEx?</p>\n\n<p>Edit: For some reason, the <code>.Find</code> never executes, even with the below code:</p>\n\n<pre><code>Sub escape_Special_Characters_in_XE_Text()\nDim regExSearch$\nDim doc     As Word.Document\nDim rngDoc As Word.Range, rngXE As Word.Range, rng As Word.Range\nDim bFound  As Boolean\nDim iFieldCodeBegin&amp;\n\nSet doc = ActiveDocument\nSet rngDoc = doc.Content\nSet rngXE = rngDoc.Duplicate\nbFound = True\niFieldCodeBegin = 6          '?\nrngDoc.Find.ClearFormatting\nWith rngDoc.Find\n        .Text = \"^d XE\"\n        '.Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\nEnd With\n\nrngDoc.Find.Execute\nrngDoc.Select ' This selects the whole document for some reason?\n\nEnd Sub\n</code></pre>\n\n<p>Is there something I'm overlooking with regard to my Document? Why can't it find anything.  If I record a macro, it uses <code>Selection</code> instead of a variable, but I can run that over and over.  When I try to use variables is when it seems to disagree with me.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459892725, "post_id": 36437364, "comment_id": 60490062, "body": "&quot;Select&quot; means &quot;highlight/activate&quot; or &quot;allow user to choose&quot; ?"}, {"owner": {"reputation": 1, "user_id": 6163600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fd085838f608ddc4009c8b540611ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ordweb", "link": "https://stackoverflow.com/users/6163600/ordweb"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459940484, "post_id": 36437364, "comment_id": 60510969, "body": "Hi,&quot;highlight/activate&quot;"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1459952236, "post_id": 36437364, "comment_id": 60520264, "body": "Where and when do you try to run the code?"}, {"owner": {"reputation": 1, "user_id": 6163600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fd085838f608ddc4009c8b540611ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ordweb", "link": "https://stackoverflow.com/users/6163600/ordweb"}, "edited": false, "score": 0, "creation_date": 1460093651, "post_id": 36437364, "comment_id": 60592547, "body": "In Outlook vba interface"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6163600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fd085838f608ddc4009c8b540611ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ordweb", "link": "https://stackoverflow.com/users/6163600/ordweb"}, "edited": false, "score": 0, "creation_date": 1459972269, "post_id": 36453859, "comment_id": 60533894, "body": "Thanks this code select the right folder, but it doesn&#39;t set focus to the folder, I need to scrool down to see the folder in the left down outlook interface. Did you know how I can set Focus ? Thanks"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1459952216, "creation_date": 1459952216, "answer_id": 36453859, "question_id": 36437364, "link": "https://stackoverflow.com/questions/36437364/outlook-2013-select-specific-folder-in-tree/36453859#36453859", "title": "Outlook 2013 - Select specific folder in tree", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866719(v=office.15).aspx\" rel=\"nofollow\">CurrentFolder</a> property of the Explorer class allows to set a Folder object that represents the current folder displayed in the explorer. The property is used to change the folder the user is viewing. For example, you may try to run the following VBA code:</p>\n\n<pre><code>Sub ChangeCurrentFolder()  \n Dim myNamespace As Outlook.NameSpace \n Set myNamespace = Application.GetNamespace(\"MAPI\")  \n Set Application.ActiveExplorer.CurrentFolder = _  \n myNamespace.GetDefaultFolder(olFolderCalendar)  \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6163600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fd085838f608ddc4009c8b540611ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ordweb", "link": "https://stackoverflow.com/users/6163600/ordweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325046, "creation_date": 1459891622, "last_edit_date": 1593325046, "question_id": 36437364, "link": "https://stackoverflow.com/questions/36437364/outlook-2013-select-specific-folder-in-tree", "title": "Outlook 2013 - Select specific folder in tree", "body": "<p>I would like to select a specific in the tree on the left of the Outlook Interface.</p>\n\n<p>I arrived to select folder with this code but I can set focus to the folder.</p>\n\n<pre><code>Dim ObjOlFolder As Outlook.MAPIFolder\nSet ObjOlFolder = GetNamespace(\"MAPI\").Folders(\"XXX\").Folders(\"Tools\")\nSet ActiveExplorer.CurrentFolder = ObjOlFolder\n</code></pre>\n\n<p>Thanks By adavance\nBR</p>\n"}, {"tags": ["mysql", "sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "edited": false, "score": 0, "creation_date": 1459888365, "post_id": 36436446, "comment_id": 60487655, "body": "How many records do you have?"}, {"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "reply_to_user": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "edited": false, "score": 0, "creation_date": 1459888472, "post_id": 36436446, "comment_id": 60487706, "body": "There could be thousands of rows of data"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1459889865, "post_id": 36436446, "comment_id": 60488526, "body": "You have tagged this with mysql and sql-server but in your question you state postgre. Which DBMS are you actually using??"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1459889195, "post_id": 36436600, "comment_id": 60488101, "body": "Sorry I&#39;m only just learning all this so this may seem a stupid question, but how do I write that into my query?"}, {"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1459889782, "post_id": 36436600, "comment_id": 60488465, "body": "It&#39;s OK. you need to run the first query. It returns you result, contain INSERT statement. then you need to loop on that and execute each statement to insert the data."}], "tags": [], "owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "is_accepted": false, "score": 1, "last_activity_date": 1459888743, "creation_date": 1459888743, "answer_id": 36436600, "question_id": 36436446, "link": "https://stackoverflow.com/questions/36436446/split-sql-data-into-3-columns-using-delimiter/36436600#36436600", "title": "Split SQL data into 3 columns using delimiter", "body": "<p>I assume your table has 4 columns</p>\n\n<p>master_id, BMI1, BMI2, BMI3 and BMI4</p>\n\n<p>you can generate INSERT statements using below query and then run them on your database</p>\n\n<pre><code>select 'insert into newTable (master_id, BMI1, BMI2, BMI3) values( ' +\n   cast(master_id as varchar) + ',''' + replace(latestBMI, '|', ''',''') + ''')'\nfrom #t\n</code></pre>\n\n<p>It generates below statements (using your sample data)</p>\n\n<pre><code>insert into newTable (master_id, BMI1, BMI2, BMI3) values( 251,'2008-05-08','84','26.8')\ninsert into newTable (master_id, BMI1, BMI2, BMI3) values( 2848,'1992-11-23','86.71','27.3')\ninsert into newTable (master_id, BMI1, BMI2, BMI3) values( 2026,'2002-04-16','105','31.6')\ninsert into newTable (master_id, BMI1, BMI2, BMI3) values( 22316,'2014-02-28','107.955','35.1')\ninsert into newTable (master_id, BMI1, BMI2, BMI3) values( 16633,'2005-07-04','70','25')\ninsert into newTable (master_id, BMI1, BMI2, BMI3) values( 9545,'1997-04-08','82.73','24.9')\n</code></pre>\n\n<p>if the columns are not integer, you can modify the SELECT statement to get what you need. But still the generated INSERT will work, even if your columns are numeric.</p>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1459891593, "post_id": 36436867, "comment_id": 60489481, "body": "Of course. I should have thought of that. Great idea thank you"}], "tags": [], "owner": {"reputation": 134, "user_id": 3058511, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac3a2216d15adbea8a65473f8c8bd00b?s=128&d=identicon&r=PG&f=1", "display_name": "ScholarYoshi", "link": "https://stackoverflow.com/users/3058511/scholaryoshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1459890222, "last_edit_date": 1459890222, "creation_date": 1459889704, "answer_id": 36436867, "question_id": 36436446, "link": "https://stackoverflow.com/questions/36436446/split-sql-data-into-3-columns-using-delimiter/36436867#36436867", "title": "Split SQL data into 3 columns using delimiter", "body": "<p>After your code to import your data just use text to columns to separate it.</p>\n\n<pre><code>    Sub SepDelCol()\n       Columns(\"B:B\").Select\n       Selection.TextToColumns _\n       Destination:=Range(\"B:B\"), _\n       DataType:=xlDelimited, _\n       TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, _\n       Tab:=False, Semicolon:=False, Comma:=False, Space:=False, _\n       Other:=True, OtherChar:=\"|\"\n     End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 289037, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06d07a76220db66c0ad3016872602d26?s=128&d=identicon&r=PG", "display_name": "PMorganCA", "link": "https://stackoverflow.com/users/289037/pmorganca"}, "is_accepted": true, "score": 0, "last_activity_date": 1459889767, "creation_date": 1459889767, "answer_id": 36436894, "question_id": 36436446, "link": "https://stackoverflow.com/questions/36436446/split-sql-data-into-3-columns-using-delimiter/36436894#36436894", "title": "Split SQL data into 3 columns using delimiter", "body": "<p>If you are OK with fetching the data first and then splitting it once its in the table, try this (if you know your latestBMI data will be in the range B2:B7)</p>\n\n<blockquote>\n  <p>Selection.TextToColumns Destination:=Range(\"B2:B7\"), _ <br/>\n  &nbsp;&nbsp;&nbsp;DataType:=xlDelimited, _ <br/>\n  &nbsp;&nbsp;&nbsp;TextQualifier:=xlDoubleQuote,  _ <br/>\n  &nbsp;&nbsp;&nbsp;ConsecutiveDelimiter:=False,  _ <br/>\n  &nbsp;&nbsp;&nbsp;Tab:=False,  _ <br/>\n  &nbsp;&nbsp;&nbsp;Semicolon:=False, Comma:=False, Space:=False, Other:=True,  _ <br/>\n  &nbsp;&nbsp;&nbsp;OtherChar:=\"|\",  _ <br/>\n  &nbsp;&nbsp;&nbsp;FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)),  _ <br/>\n  &nbsp;&nbsp;&nbsp;TrailingMinusNumbers:=True</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1459891272, "post_id": 36436923, "comment_id": 60489297, "body": "I sort of resigned myself to this. You are correct it does end up like that after the extraction. Can I put the code directly under the current vba code which is on sheet1?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "edited": false, "score": 0, "creation_date": 1459892393, "post_id": 36436923, "comment_id": 60489891, "body": "Yes, you can put it directly under your existing code. Add a line that says <code>set ws = ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code>, right before you set <code>numRows</code> and it should work fine."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1459889849, "creation_date": 1459889849, "answer_id": 36436923, "question_id": 36436446, "link": "https://stackoverflow.com/questions/36436446/split-sql-data-into-3-columns-using-delimiter/36436923#36436923", "title": "Split SQL data into 3 columns using delimiter", "body": "<p>There are a variety of complicated SQL/database-based solutions (see <a href=\"http://sqlperformance.com/2012/07/t-sql-queries/split-strings\" rel=\"nofollow noreferrer\">Split Strings the Right Way</a>), it's going to be far easier to deal with your data in VBA after the SQL statement completes.</p>\n\n<p>Your code looks like it will produce a result that looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ABFj1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ABFj1.png\" alt=\"enter image description here\"></a></p>\n\n<p>So you should loop through the results in column B and separate it.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub test()\n    SeparateFields ActiveSheet\nEnd Sub\n\nSub SeparateFields(ws As Worksheet)\n    '--- assumes your concatenated field (after your SQL\n    '    statement) ends up in column B. The separated\n    '    fields go in columns B, C, D.\n    Dim concatFields As String\n    Dim fields() As String\n    Dim numRows As Long\n    Dim i As Long\n    numRows = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n    For i = 2 To numRows\n        concatFields = ws.Cells(i, 2).value\n        fields = Split(concatFields, \"|\", , vbTextCompare)\n        ws.Cells(i, 2).value = fields(0)\n        ws.Cells(i, 3).value = fields(1)\n        ws.Cells(i, 4).value = fields(2)\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 36436894, "answer_count": 4, "score": 2, "last_activity_date": 1459890222, "creation_date": 1459888209, "question_id": 36436446, "link": "https://stackoverflow.com/questions/36436446/split-sql-data-into-3-columns-using-delimiter", "title": "Split SQL data into 3 columns using delimiter", "body": "<p>I am using Excel VBA and connecting to PGSQL using OleDB. Unfortunately oledb does not allow references to columns outside of an aggregate function where group by has been applied to the table, so I have to concatenate the data, but I'm having trouble splitting the data (latestBMI) back out into 3 separate columns (eventdate|weight|bmi), because the weight and bmi values vary in length, but are divided by a pipe delimter.</p>\n\n<p>Here is what the table looks like through extraction:</p>\n\n<pre><code>master_id :   latestBMI\n251       :   2008-05-08|84|26.8\n2848      :   1992-11-23|86.71|27.3\n2026      :   2002-04-16|105|31.6\n22316     :   2014-02-28|107.955|35.1\n16633     :   2005-07-04|70|25\n9545      :   1997-04-08|82.73|24.9\n</code></pre>\n\n<p>I have been playing with various methods trying SUBSTRING, CHARINDEX, LEN, LEFT|RIGHT, but failing.\nHere is my current code but the SUBSTRING elements for weight and bmi are my problem:</p>\n\n<blockquote>\n<pre><code>Const sqlconnection = \"Provider=oledb;\"\n\nDim conn As New Connection\nconn.ConnectionString = sqlconnection\nconn.Open\nDim rs As Recordset\n\nSheets(\"Sheet1\").Select\nRange(\"A1\").Select\n\nDim DATA As String\nDATA = \"SELECT latest.master_id, \" _\n&amp; \"SUBSTRING(latestBMI,1,10) eventdate, \" _\n&amp; \"SUBSTRING(latestBMI,12,CHARINDEX('|',latestBMI,RIGHT(latestBMI,7)) weight, \" _\n&amp; \"SUBSTRING(latestBMI,20,4) BMI \" _\n&amp; \"FROM ( \" _\n&amp; \"SELECT master_id, \" _\n&amp; \"MAX(CAST(eventdate AS VARCHAR(10)) + '|' + RIGHT(weightkg,7)+ '|' + RIGHT(bmi,4)) AS latestBMI \" _\n&amp; \"FROM weight \" _\n&amp; \"GROUP BY master_id) as latest \" _\n&amp; \"LEFT JOIN person p on latest.master_id = p.entity_id \"\n\nSet rs = conn.Execute(DATA)\nWith ActiveSheet.QueryTables.Add(Connection:=rs, Destination:=Range(\"A1\"))\n    .Refresh\nEnd With\n</code></pre>\n</blockquote>\n\n<p>How do I get them into 3 separate columns using the pipe delimiter?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459886458, "post_id": 36435855, "comment_id": 60486529, "body": "What&#39;s the value of <code>lastRow</code> when it fails?  A simpler test would be <code>If Len(data(rowIndex, 1)) = 0 Then GoTo ExitRoutine</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1459886669, "creation_date": 1459886669, "answer_id": 36435986, "question_id": 36435855, "link": "https://stackoverflow.com/questions/36435855/putting-images-onto-an-excel-sheet-via-url-links/36435986#36435986", "title": "Putting images onto an excel sheet via URL links", "body": "<pre><code>lastRow = wks.Cells(2, \"B\").End(xlDown).Row\ndata = wks.Range(wks.Cells(3, \"C\"), wks.Cells(lastRow, \"C\")).Value2\n\nFor rowIndex = 3 To UBound(data, 1)\n    '....\n</code></pre>\n\n<p>If you start at rowIndex = 3 then you're skipping the first two rows of your input data: a 2-D array from a range always has lower bounds of 1 for both dimensions, regardless of the location of the range.</p>\n\n<p>In this case <code>data(1,1)</code> will correspond to C3, whereas <code>data(3,1)</code> is C5</p>\n"}], "owner": {"reputation": 91, "user_id": 4966093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/92RpQ.png?s=128&g=1", "display_name": "proxy156", "link": "https://stackoverflow.com/users/4966093/proxy156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459958504, "creation_date": 1459886123, "last_edit_date": 1492087236, "question_id": 36435855, "link": "https://stackoverflow.com/questions/36435855/putting-images-onto-an-excel-sheet-via-url-links", "title": "Putting images onto an excel sheet via URL links", "body": "<p>My sheet has three columns, \"A\" = Images, \"B\" = Image Names, and \"C\" = URL Links, with Rows 1 and 2 being used as headers and rows 3 to 1002 for user input. The Current working code will search for the image names in Column \"B\" in the folder you select, and inserts them into Column \"A\". This macro runs off of a commandbutton I have placed on a userform I have created.</p>\n\n<p>Working code is as follows (this is a edited version of the accepted answer <a href=\"https://codereview.stackexchange.com/questions/92490/finding-and-pasting-images-into-a-specific-cell\">here</a>):</p>\n\n<pre><code>Private Sub Add_Images_Click()\nConst EXIT_TEXT         As String = \"\"\nConst NO_PICTURE_FOUND  As String = \"No picture found\"\n\nDim picName             As String\nDim picFullName         As String\nDim rowIndex            As Long\nDim lastRow             As Long\nDim selectedFolder      As String\nDim data()              As Variant\nDim wks                 As Worksheet\nDim Cell                As Range\nDim pic                 As Picture\n\nOn Error GoTo ErrorHandler\n\nselectedFolder = GetFolder\nIf Len(selectedFolder) = 0 Then GoTo ExitRoutine\n\nApplication.ScreenUpdating = False\n\nSet wks = ActiveSheet\nlastRow = wks.Cells(2, \"B\").End(xlDown).Row\ndata = wks.Range(wks.Cells(3, \"B\"), wks.Cells(lastRow, \"B\")).Value2\n\nFor rowIndex = 3 To UBound(data, 1)\n    If StrComp(data(rowIndex, 1), EXIT_TEXT, vbTextCompare) = 0 Then GoTo ExitRoutine\n\n    picName = data(rowIndex, 1)\n    picFullName = selectedFolder &amp; picName\n\n    If Len(Dir(picFullName)) &gt; 0 Then\n        Set Cell = wks.Cells(rowIndex, \"A\")\n        Set pic = wks.Pictures.Insert(picFullName)\n        With pic\n            .ShapeRange.LockAspectRatio = msoFalse\n            .Height = Cell.Height\n            .Width = Cell.Width\n            .Top = Cell.Top\n            .Left = Cell.Left\n            .Placement = xlMoveAndSize\n        End With\n    Else\n        wks.Cells(rowIndex, \"A\").Value = NO_PICTURE_FOUND\n    End If\nNext rowIndex\n\nExitRoutine:\nSet wks = Nothing\nSet pic = Nothing\nApplication.ScreenUpdating = True\nUserForm.Hide\nExit Sub\n\nErrorHandler:\nMsgBox Prompt:=\"Unable to find photo\", _\n       Title:=\"An error occured\", _\n       Buttons:=vbExclamation\nResume ExitRoutine\n\nEnd Sub\nPrivate Function GetFolder() As String\nDim selectedFolder  As String\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n    .Title = \"Select the folder containing the Image/PDF files.\"\n    .Show\n\n    If .SelectedItems.count &gt; 0 Then\n        selectedFolder = .SelectedItems(1)\n        If Right$(selectedFolder, 1) &lt;&gt; Application.PathSeparator Then _\n            selectedFolder = selectedFolder &amp; Application.PathSeparator\n    End If\nEnd With\nGetFolder = selectedFolder\nEnd Function\n</code></pre>\n\n<p>I'm looking for a way to edit this macro so that it would be able to use the URL links for the images in Column \"C\" and find and insert the images into Column \"A\" that way. I found a working code (can't remember where, or I'd link it) that I tried to adapt with my current code to achieve the desired results. </p>\n\n<p>The sample code I found online:</p>\n\n<pre><code>Sub Images_Via_URL()\nDim url_column As Range\nDim image_column As Range\n\nSet url_column = Worksheets(1).UsedRange.Columns(\"A\")\nSet image_column = Worksheets(1).UsedRange.Columns(\"B\")\n\nDim i As Long\nFor i = 2 To url_column.Cells.Count\n\n  With image_column.Worksheet.Pictures.Insert(url_column.Cells(i).Value)\n    .Left = image_column.Cells(i).Left\n    .Top = image_column.Cells(i).Top\n    .Height = 100\n    .Width = 100\n  End With\nNext\nEnd Sub\n</code></pre>\n\n<p>The following code is my failed attempt to edit it myself. It worked once for a list of 7 URL links, then I deleted one of the links in the middle to see if it would handle the blank cell correctly, and now it flat out wont work. It goes into the \"ExitRoutine\" every time.</p>\n\n<p>Not Working Code:</p>\n\n<pre><code>Option Explicit\nPrivate Sub URL_Images_Click()\n\nConst EXIT_TEXT         As String = \"\"\nConst NO_PICTURE_FOUND  As String = \"No picture found\"\n\nDim picURL              As String\nDim rowIndex            As Long\nDim lastRow             As Long\nDim data()              As Variant\nDim wks                 As Worksheet\nDim Cell                As Range\nDim pic                 As Picture\n\nOn Error GoTo ErrorHandler\n\nApplication.ScreenUpdating = False\n\nSet wks = ActiveSheet\nlastRow = wks.Cells(2, \"B\").End(xlDown).Row\ndata = wks.Range(wks.Cells(3, \"C\"), wks.Cells(lastRow, \"C\")).Value2\n\nFor rowIndex = 3 To UBound(data, 1)\n    **If StrComp(data(rowIndex, 1), EXIT_TEXT, vbTextCompare) = 0 Then GoTo ExitRoutine**\n\n    picURL = data(rowIndex, 1)\n\n    If Len(picURL) &gt; 0 Then\n        Set Cell = wks.Cells(rowIndex, \"A\")\n        Set pic = wks.Pictures.Insert(picURL)\n        With pic\n            .ShapeRange.LockAspectRatio = msoFalse\n            .Height = Cell.Height\n            .Width = Cell.Width\n            .Top = Cell.Top\n            .Left = Cell.Left\n            .Placement = xlMoveAndSize\n        End With\n    Else\n        wks.Cells(rowIndex, \"A\").Value = NO_PICTURE_FOUND\n    End If\n\nNext rowIndex\n\nExitRoutine:\nSet wks = Nothing\nSet pic = Nothing\nApplication.ScreenUpdating = True\nUserForm.Hide\nExit Sub\n\nErrorHandler:\nMsgBox Prompt:=\"Unable to find photo\", _\n       Title:=\"An error occured\", _\n       Buttons:=vbExclamation\nResume ExitRoutine\n\nEnd Sub\n</code></pre>\n\n<p>I've bolded the line that is forcing it to the \"ExitRoutine\". I'm not sure how exactly that line works as I am not the one who originally wrote it. Any help would be great!</p>\n"}, {"tags": ["xml", "vba", "excel", "xml-parsing"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1459887667, "post_id": 36435730, "comment_id": 60487248, "body": "<code>objHTTP.responseXML.getElementsByTagName(&quot;ab&quot;)(0).nodeValue</code>"}, {"owner": {"reputation": 1, "user_id": 6163220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee89d13fc77c25762e388266de813f99?s=128&d=identicon&r=PG&f=1", "display_name": "B. Hope", "link": "https://stackoverflow.com/users/6163220/b-hope"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459956369, "post_id": 36435730, "comment_id": 60523594, "body": "Thanks Tim.  I tried your code as follows and do not get any errors, but I&#39;m also not getting the value of the ab node placed in the cell."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459957616, "post_id": 36435730, "comment_id": 60524551, "body": "What about <code>objHTTP.responseXML.getElementsByTagName(&quot;ab&quot;)(0).innerText</code> ?"}, {"owner": {"reputation": 1, "user_id": 6163220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee89d13fc77c25762e388266de813f99?s=128&d=identicon&r=PG&f=1", "display_name": "B. Hope", "link": "https://stackoverflow.com/users/6163220/b-hope"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459958009, "post_id": 36435730, "comment_id": 60524889, "body": "Solved!  SourceHTMLText = objHTTP.responseXML.getElementsByTagName(&quot;ab&quot;)(0).FirstChild&zwnj;&#8203;.NodeValue"}], "owner": {"reputation": 1, "user_id": 6163220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee89d13fc77c25762e388266de813f99?s=128&d=identicon&r=PG&f=1", "display_name": "B. Hope", "link": "https://stackoverflow.com/users/6163220/b-hope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459886071, "creation_date": 1459885726, "last_edit_date": 1531164843, "question_id": 36435730, "link": "https://stackoverflow.com/questions/36435730/retrieving-a-node-in-excel-vba-msxml2-serverxmlhttp", "title": "Retrieving a node in Excel VBA MSXML2.ServerXMLHTTP", "body": "<p>I've written a simple Excel 2010 VBA macro to retrieve XML output from a REST api.  I can get the entire XML output to be placed in the adjacent cell.  What I'm trying to do now is parse the output so that only the node called ab is placed into the adjacent cell.  I cheated and allowed the entire XML contents to be returned and then just used a MID function to find the string between ab and /ab but its messy.  I'd like to learn how to do this correctly so that I can parse out any specific node in the future and place it in an adjacent column.</p>\n\n<p>Here is the VBA macro \"SendID\" in Excel that submits the URL + the ActiveCell value and returns the SourceHTMLText into the adjacent column.  I had to block out the username and password so it will not work for you but a sample return is provided below:</p>\n\n<pre><code>Sub SendID()\n\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    URL = \"URL for REST API goes here\" &amp; ActiveCell.Value\n    objHTTP.Open \"GET\", URL, False\n    objHTTP.setRequestHeader \"User-Agent\", _\n                   \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    objHTTP.send (\"\")\n    SourceHTMLText = objHTTP.responseText\n\n\n\n  'If the return has the word Apache in it then there was no return.  \n  '  Put no DOI in the adjacent cell and move on.\n\n  If InStr(SourceHTMLText, \"Apache\") &gt; 0 Then\n      ActiveCell.Offset(0, 1).Value = \"no DOI\"\n  Else\n      ' Place the value in the adjacent cell\n      ActiveCell.Offset(0, 1).Value = SourceHTMLText\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>Here is the output of one REST API call.</p>\n\n<pre><code>\"&lt;?xml version=\"\"1.0\"\"?&gt;\n&lt;searchResponse xmlns:xsi=\"\"http://www.w3.org/2001/XMLSchema-instance\"\" xmlns:xsd=\"\"http://www.w3.org/2001/XMLSchema\"\"&gt;\n  &lt;Hits xmlns=\"\"http://epnet.com/webservices/SearchService/Response/2007/07/\"\"&gt;1&lt;/Hits&gt;\n  &lt;Statistics xmlns=\"\"http://epnet.com/webservices/SearchService/Response/2007/07/\"\"&gt;\n    &lt;Statistic&gt;\n      &lt;Database&gt;ffh&lt;/Database&gt;\n      &lt;Hits&gt;1&lt;/Hits&gt;\n    &lt;/Statistic&gt;\n  &lt;/Statistics&gt;\n  &lt;SearchResults xmlns=\"\"http://epnet.com/webservices/SearchService/Response/2007/07/\"\"&gt;\n    &lt;records xmlns=\"\"\"\"&gt;\n      &lt;rec recordID=\"\"1\"\"&gt;\n        &lt;pdfLink /&gt;\n        &lt;plink&gt;http://search.ebscohost.com/login.aspx?direct=true&amp;amp;db=ffh&amp;amp;AN=2015-06-Ne0978&amp;amp;site=ehost-live&lt;/plink&gt;\n        &lt;header shortDbName=\"\"ffh\"\" uiTerm=\"\"2015-06-Ne0978\"\" longDbName=\"\"FSTA - Food Science and Technology Abstracts\"\" uiTag=\"\"AN\"\"&gt;\n          &lt;controlInfo&gt;\n            &lt;bkinfo&gt;\n              &lt;aug /&gt;\n            &lt;/bkinfo&gt;\n            &lt;dissinfo /&gt;\n            &lt;confinfo /&gt;\n            &lt;jinfo&gt;\n              &lt;jid type=\"\"issn\"\"&gt;20487177&lt;/jid&gt;\n              &lt;jtl&gt;Food Science &amp;amp; Nutrition&lt;/jtl&gt;\n              &lt;issn type=\"\"print\"\"&gt;20487177&lt;/issn&gt;\n            &lt;/jinfo&gt;\n            &lt;pubinfo&gt;\n              &lt;dt year=\"\"2014\"\" month=\"\"01\"\" day=\"\"01\"\" /&gt;\n              &lt;vid&gt;2&lt;/vid&gt;\n              &lt;iid&gt;6&lt;/iid&gt;\n            &lt;/pubinfo&gt;\n            &lt;artinfo&gt;\n              &lt;ui&gt;2015-06-Ne0978&lt;/ui&gt;\n              &lt;ppf&gt;786&lt;/ppf&gt;\n              &lt;ppct&gt;6&lt;/ppct&gt;\n              &lt;tig&gt;\n                &lt;atl&gt;Fatty acid profile of gamma-irradiated and cooked African oil bean seed (&lt;i&gt;Pentaclethra macrophylla&lt;/i&gt; Benth).&lt;/atl&gt;\n              &lt;/tig&gt;\n              &lt;aug&gt;\n                &lt;au&gt;Olotu, I.&lt;/au&gt;\n                &lt;au&gt;Enujiugha, V.&lt;/au&gt;\n                &lt;au&gt;Obadina, A.&lt;/au&gt;\n                &lt;au&gt;Owolabi, K.&lt;/au&gt;\n              &lt;/aug&gt;\n              &lt;su&gt;AFRICAN OIL BEANS&lt;/su&gt;\n              &lt;su&gt;COOKING&lt;/su&gt;\n              &lt;su&gt;FATTY ACIDS&lt;/su&gt;\n              &lt;su&gt;GAMMA IRRADIATION&lt;/su&gt;\n              &lt;su&gt;IRRADIATION&lt;/su&gt;\n              &lt;su&gt;LEGUMES&lt;/su&gt;\n              &lt;su&gt;OILS&lt;/su&gt;\n              &lt;su&gt;OILSEEDS&lt;/su&gt;\n              &lt;su&gt;RANCIDITY&lt;/su&gt;\n              &lt;su&gt;Fats, oils and margarine&lt;/su&gt;\n              &lt;ab&gt;The safety and shelf-life of food products can be, respectively, ensured and extended with important food-processing technologies such as irradiation. The joint effect of cooking and 10 kGy gamma irradiation on the fatty acid composition of the oil of &lt;i&gt;Pentaclethra macrophylla&lt;/i&gt; Benth was evaluated. Oils from the raw seed, cooked seeds, irradiated seeds (10 kGy), cooked, and irradiated seeds (10 kGy) were extracted and analyzed for their fatty acid content. An omega-6-fatty acid (linoleic acid) was the principal unsaturated fatty acid in the bean seed oil (24.6%). Cooking significantly (&lt;i&gt;P &lt;/i&gt;&amp;lt; 0.05) increased Erucic acid by 3.3% and Linolenic acid by 23.0%. Combined treatment significantly (&lt;i&gt;P&lt;/i&gt;&amp;lt; 0.05) increased C18:2, C6:0, C20:2, C18:3, C20:3, C24:0, and C22:6 being linoleic, caproic, eicosadienoic, linolenic, eicosatrienoic, ligoceric, and docosahexaenoic acid, respectively, and this increase made the oil sample to have the highest total fatty acid content (154.9%), unsaturated to saturated fatty acid ratio (109.6), and unsaturated fatty acid content (153.9%). 10 kGy irradiation induces the formation of C20:5 (eicosapentaenoic), while cooking induced the formation of C20:4 (arachidic acid), C22:6 (Heneicosanoic acid), and C22:2 (docosadienoic acid). Combined 10 kGy cooking and irradiation increased the susceptibility of the oil of the African oil bean to rancidity.&lt;/ab&gt;\n              &lt;pubtype&gt;Journal Article&lt;/pubtype&gt;\n              &lt;doctype&gt;Journal Article&lt;/doctype&gt;\n              &lt;ougenre&gt;article&lt;/ougenre&gt;\n            &lt;/artinfo&gt;\n            &lt;holdings islocal=\"\"N\"\" /&gt;\n          &lt;/controlInfo&gt;\n        &lt;/header&gt;\n      &lt;/rec&gt;\n    &lt;/records&gt;\n  &lt;/SearchResults&gt;\n&lt;/searchResponse&gt;\"\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1459884817, "post_id": 36435450, "comment_id": 60485410, "body": "What line does the error occur on?  Instead of using <code>.Text</code>, do you get the same error with <code>.Value</code>?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459885590, "post_id": 36435450, "comment_id": 60485915, "body": "I think more detail is needed. This code works in the simple test I did (no errors)."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459885656, "post_id": 36435450, "comment_id": 60485967, "body": "Might want to consider <code>case</code> statement."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1459885838, "post_id": 36435450, "comment_id": 60486103, "body": "Is the active sheet the one you are searching? What is the value of <code>r</code> when you get the error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1459886032, "post_id": 36435450, "comment_id": 60486251, "body": "Is InStr actually needed? Is MOD, VER, OIL, etc. the whole cell or just part of a longer string within the cell?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459886763, "post_id": 36435450, "comment_id": 60486712, "body": "What&#39;s the idea behind your <code>If</code> statements? I see you&#39;re trying to see if some text (&quot;MOD&quot;,&quot;WH&quot;, etc) is in anywhere in the cell <code>Range(I &amp; [row])</code>?"}, {"owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "edited": false, "score": 0, "creation_date": 1459892086, "post_id": 36435450, "comment_id": 60489729, "body": "Apologies about the late reply. The program seems to go into an infinite loop and &quot;whites out&quot;. To me, this is likely an indication that lastrow is on the order of about 80,000.  The active sheet is the one being searched. The program times out before I can locate the variable r.  MOD, VER, OIL, etc. are values that will be placed in a cell if the criteria are met. They can be changed to Tom, Dick and Harry for all that matters."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1459887549, "creation_date": 1459887549, "answer_id": 36436250, "question_id": 36435450, "link": "https://stackoverflow.com/questions/36435450/method-value-of-object-range-failed/36436250#36436250", "title": "Method &#39;Value&#39; of object &#39;Range&#39; failed", "body": "<p>VBA environments are not immune to instability. If you have had multiple crashes, save your work and restart your machine (cold boot).</p>\n\n<p>With that said, each of these routines runs in less than a half-second as opposed to the 27 seconds that your original took to get through 80K cells.</p>\n\n<pre><code>Sub oilWT2()\n    Dim r As Long, vVALs As Variant\n\n    Debug.Print Timer\n    With Worksheets(\"Sheet5\")\n        vVALs = .Range(.Cells(2, \"I\"), .Cells(rows.Count, \"A\").End(xlUp).Offset(0, 8)).Value2\n        For r = LBound(vVALs, 1) To UBound(vVALs, 1)\n            Select Case UCase(vVALs(r, 1))\n                Case \"WH\"\n                    vVALs(r, 1) = \"O\"\n                Case \"MOD\", \"VER\"\n                    vVALs(r, 1) = Right(vVALs(r, 1), 1)\n                Case \"WT\", \"OIL\"\n                    'do nothing - value already correct\n                Case Else\n                    vVALs(r, 1) = \"N\"\n            End Select\n        Next r\n        .Cells(2, \"Z\").Resize(UBound(vVALs, 1), 1) = vVALs\n    End With\n    Debug.Print Timer\nEnd Sub\n\nSub oilWT3()\n    Dim r As Long, vVALs As Variant\n\n    Debug.Print Timer\n    With Worksheets(\"Sheet5\")\n        vVALs = .Range(.Cells(2, \"I\"), .Cells(rows.Count, \"A\").End(xlUp).Offset(0, 8)).Value2\n        For r = LBound(vVALs, 1) To UBound(vVALs, 1)\n            Select Case True\n                Case CBool(InStr(1, vVALs(r, 1), \"WH\", vbTextCompare))\n                    vVALs(r, 1) = \"O\"\n                Case CBool(InStr(1, vVALs(r, 1), \"MOD\", vbTextCompare)) Or _\n                     CBool(InStr(1, vVALs(r, 1), \"VER\", vbTextCompare))\n                    vVALs(r, 1) = Right(vVALs(r, 1), 1)\n                Case CBool(InStr(1, vVALs(r, 1), \"WT\", vbTextCompare))\n                    vVALs(r, 1) = \"WT\"\n                Case CBool(InStr(1, vVALs(r, 1), \"OIL\", vbTextCompare))\n                    vVALs(r, 1) = \"OIL\"\n                Case Else\n                    vVALs(r, 1) = \"N\"\n            End Select\n        Next r\n        .Cells(2, \"Z\").Resize(UBound(vVALs, 1), 1) = vVALs\n    End With\n    Debug.Print Timer\nEnd Sub\n</code></pre>\n\n<p>The former simply looks at the entire cell contents; the latter uses the <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1.aspx\" rel=\"nofollow\">InStr function</a> to search for a string-within-a-string as your original does. By reusing a variant array to store the new values, it makes the conditional statements more efficient than a cell-by-cell read. The values are similarly returned <em>en masse</em> to column Z.</p>\n"}], "owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2071, "favorite_count": 0, "accepted_answer_id": 36436250, "answer_count": 1, "score": 1, "last_activity_date": 1459890650, "creation_date": 1459884728, "last_edit_date": 1459890650, "question_id": 36435450, "link": "https://stackoverflow.com/questions/36435450/method-value-of-object-range-failed", "title": "Method &#39;Value&#39; of object &#39;Range&#39; failed", "body": "<p>The following snippet of VBA code attempts a simple If statement over on an excel column of approx 80k rows long. The following error occurs. </p>\n\n<p>Run-time error '-2147417848 (80010108)':\nMethod 'Value' of object 'Range' failed</p>\n\n<p>What is going wrong here?</p>\n\n<pre><code>Dim r As Long\nDim lastrow As Long\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor r = 2 To lastrow\n    If InStr(Range(\"I\" &amp; r).Text, \"WH\") Then\n        Range(\"Z\" &amp; r).Value = \"O\"\n    ElseIf InStr(Range(\"I\" &amp; r).Text, \"MOD\") Then\n        Range(\"Z\" &amp; r).Value = \"M\"\n    ElseIf InStr(Range(\"I\" &amp; r).Text, \"VER\") Then\n        Range(\"Z\" &amp; r).Value = \"V\"\n    ElseIf InStr(Range(\"I\" &amp; r).Text, \"WT\") Then\n        Range(\"Z\" &amp; r).Value = \"WT\"\n    ElseIf InStr(Range(\"E\" &amp; r).Text, \"OIL\") Then\n        Range(\"Z\" &amp; r).Value = \"OIL\"\n    Else: Range(\"Z\" &amp; r).Value = \"N\"\n    End If\nNext r\n</code></pre>\n"}, {"tags": ["macos", "vba", "excel", "phpexcel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459887396, "post_id": 36435397, "comment_id": 60487103, "body": "Maybe try the suggested formats here: <a href=\"http://www.rondebruin.nl/win/s5/win001.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s5/win001.htm</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1460504366, "post_id": 36435397, "comment_id": 60770818, "body": "Rather than hard code the <code>&#47;</code> or <code>\\ </code> , use <code>Application.PathSeparator</code>"}, {"owner": {"reputation": 3739, "user_id": 1268048, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/naEf9.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/1268048/phil"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1460554229, "post_id": 36435397, "comment_id": 60796910, "body": "@chrisneilsen excellent suggestion, thank you!!!"}], "owner": {"reputation": 3739, "user_id": 1268048, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/naEf9.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/1268048/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459935901, "creation_date": 1459884564, "last_edit_date": 1459935901, "question_id": 36435397, "link": "https://stackoverflow.com/questions/36435397/convert-excel-vb-macro-to-mac-compatible", "title": "Convert Excel VB Macro to Mac compatible", "body": "<p>I have the following VB Macro for taking a large Excel file and splitting it into many smaller files each consisting of 1,000 rows (999 of data, 1 row for headers).</p>\n\n<pre><code>Sub SplitExcelFile()\n  Dim wb As Workbook\n  Dim ThisSheet As Worksheet\n  Dim NumOfColumns As Integer\n  Dim RangeToCopy As Range\n  Dim RangeOfHeader As Range        'data (range) of header row\n  Dim WorkbookCounter As Integer\n  Dim RowsInFile                    'how many rows (incl. header) in new files?\n\n  Application.ScreenUpdating = False\n\n  'Initialize data\n  Set ThisSheet = ThisWorkbook.ActiveSheet\n  NumOfColumns = ThisSheet.UsedRange.Columns.Count\n  WorkbookCounter = 1\n  RowsInFile = 1000                  '1000 rows per file\n\n  'Copy the data of the first row (header)\n  Set RangeOfHeader = ThisSheet.Range(ThisSheet.Cells(1, 1), ThisSheet.Cells(1, NumOfColumns))\n\n  For p = 2 To ThisSheet.UsedRange.Rows.Count Step RowsInFile - 1\n    Set wb = Workbooks.Add\n\n    'Paste the header row in new file\n    RangeOfHeader.Copy wb.Sheets(1).Range(\"A1\")\n\n    'Paste the chunk of rows for this file\n    Set RangeToCopy = ThisSheet.Range(ThisSheet.Cells(p, 1), ThisSheet.Cells(p + RowsInFile - 2, NumOfColumns))\n    RangeToCopy.Copy wb.Sheets(1).Range(\"A2\")\n\n    'Save the new workbook, and close it\n    wb.SaveAs ThisWorkbook.Path &amp; \"/File_\" &amp; WorkbookCounter &amp; \".xls\", FileFormat:=xlWorkbookNormal\n    wb.Close\n\n    'Increment file counter\n    WorkbookCounter = WorkbookCounter + 1\n  Next p\n\n  Application.ScreenUpdating = True\n  Set wb = Nothing\nEnd Sub\n</code></pre>\n\n<p>It works perfectly on PC, but when I run it on Mac, it says error regarding object not defined.  So I thought okay it must be the Path separator is not a \"\\\", must be a \"/\".  So I change that and it seemed to run okay.  It created the files at least.  However, when I try to open them on a PC it shows error stating the following:</p>\n\n<pre><code>The file format and extension of 'File_1.xls' don't match.  The file could be corrupted or unsafe.  Unless you trust its source, don't open it.  Do you want to open it anyway?\n</code></pre>\n\n<p>This causes problems when I try to open it with PHPExcel on the website where it is being used.  Any ideas as to why this happens and how I can correct it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459883610, "post_id": 36435059, "comment_id": 60484666, "body": "Grab the name first? but may be better to architect it by grabbing the data you need via a variable from the second book instead."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1459884771, "post_id": 36435059, "comment_id": 60485388, "body": "Create a variable for the worksheet name, then update that variable.  Then just write the <code>vlookup</code> formula, and make sure to explicitly state which sheet which data is on."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1459888740, "post_id": 36435059, "comment_id": 60487860, "body": "Let&#39;s see the code, you are using"}, {"owner": {"reputation": 11, "user_id": 4227214, "user_type": "registered", "profile_image": "https://graph.facebook.com/514355431/picture?type=large", "display_name": "Sara Neal", "link": "https://stackoverflow.com/users/4227214/sara-neal"}, "edited": false, "score": 0, "creation_date": 1459890538, "post_id": 36435059, "comment_id": 60488922, "body": "This is what I have tried:   ActiveCell.FormulaR1C1 = _         &quot;=IFERROR(VLOOKUP(RC[-1],[&#39; &amp; workbooks(2) &amp; &#39;]Pivot Tables&#39;!C4:C5,2,FALSE),0)&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459890800, "post_id": 36435059, "comment_id": 60489063, "body": "Try <code>&quot;=IFERROR(VLOOKUP(RC[-1],[&quot; &amp; Workbooks(2).Name &amp; &quot;]Pivot Tables&#39;!C4:C5,2,FALSE),0)&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 4227214, "user_type": "registered", "profile_image": "https://graph.facebook.com/514355431/picture?type=large", "display_name": "Sara Neal", "link": "https://stackoverflow.com/users/4227214/sara-neal"}, "edited": false, "score": 0, "creation_date": 1459891229, "post_id": 36435059, "comment_id": 60489273, "body": "This is what I typed and it gave me a syntax error   ActiveCell.FormulaR1C1 =IFERROR(VLOOKUP(RC[-1],[&quot; &amp; workbooks(2).Name &amp; &quot;]Pivot Tables&#39;!C4:C5,2,FALSE),0)&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1459891998, "post_id": 36435059, "comment_id": 60489679, "body": "missed something <code>&quot;=IFERROR(VLOOKUP(RC[-1],&#39;[&quot; &amp; Workbooks(2).Name &amp; &quot;]Pivot Tables&#39;!C4:C5,2,FALSE),0)&quot;</code>  Also make sure that Workbooks(2) is the actual work book you want."}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1459900532, "post_id": 36435059, "comment_id": 60492876, "body": "What is the underlying problem you&#39;re trying to solve? We might have a simpler solution than this."}], "owner": {"reputation": 11, "user_id": 4227214, "user_type": "registered", "profile_image": "https://graph.facebook.com/514355431/picture?type=large", "display_name": "Sara Neal", "link": "https://stackoverflow.com/users/4227214/sara-neal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465161251, "creation_date": 1459883464, "last_edit_date": 1465161251, "question_id": 36435059, "link": "https://stackoverflow.com/questions/36435059/vba-vlookup-to-changing-workbook-name", "title": "VBA Vlookup to Changing Workbook Name", "body": "<p>I'm trying to a vlookup in vba between 2 workbooks. The workbook I'm looking up information from will have a different name every day. How do I write the vlookup to reference the current active workbook?</p>\n\n<p>In my other code, I've being using Workbooks(2) as my reference but it doesn't seem to work in the vlookup.</p>\n"}, {"tags": ["vba", "winapi"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1459885967, "post_id": 36434997, "comment_id": 60486202, "body": "What are the correct values for the things you specified?"}, {"owner": {"reputation": 178, "user_id": 5744945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDOkW.jpg?s=128&g=1", "display_name": "Snachmo", "link": "https://stackoverflow.com/users/5744945/snachmo"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1459888070, "post_id": 36434997, "comment_id": 60487474, "body": "Good question... The difference in width between 11 and 11.5pts is eight units, but the difference from 11.5 to 12pts is only one.  I&#39;d like to understand why the relationship between font size and returned width is not linear. (I understand this is normal at lower screen resolutions, but I don&#39;t believe it should come up at 300dpi). - edited op"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1459891312, "post_id": 36434997, "comment_id": 60489317, "body": "Interesting topic. I agree that the results should be more linear than that. Here&#39;s a screenshot of a simple test in Word at 400%, with &quot;Text&quot; at font sizes 10..13 with .5 steps. <a href=\"http://imgur.com/Wvrugdd\" rel=\"nofollow noreferrer\">imgur.com/Wvrugdd</a>"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1459897567, "post_id": 36434997, "comment_id": 60491993, "body": "Just arbitrarily multiplying by 300 makes no sense, the font renderer pays attention to the real dpi. Which is no doubt much lower, the effects of TrueType hinting and the pixel-grid fitting that ClearType likes to use certainly affect the width a great deal. You must use the correct HDC to get a correct measurement, fix your CreateDC() call to obtain a device context for the printer.   And you must call GetDeviceCaps() to obtain the correct LOGPIXELSY for the printer."}, {"owner": {"reputation": 178, "user_id": 5744945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDOkW.jpg?s=128&g=1", "display_name": "Snachmo", "link": "https://stackoverflow.com/users/5744945/snachmo"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1459899654, "post_id": 36434997, "comment_id": 60492648, "body": "@Hans Passant - I&#39;ve done some testing and so far as I can tell, LOGPIXELSX/Y = DPI for printers.  We&#39;ll be printing at 300dpi on a 1200dpi printer, which is why I used that value rather than GetDeviceCaps.  Any thoughts?"}], "owner": {"reputation": 178, "user_id": 5744945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aDOkW.jpg?s=128&g=1", "display_name": "Snachmo", "link": "https://stackoverflow.com/users/5744945/snachmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 836, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1459954902, "creation_date": 1459883273, "last_edit_date": 1459954902, "question_id": 36434997, "link": "https://stackoverflow.com/questions/36434997/results-of-gettextextentpoint32-arent-scaling-linearly-with-nheight", "title": "Results of GetTextExtentPoint32 aren&#39;t scaling linearly with nHeight", "body": "<p>I've written a VBA function to return the width of a string in a given font &amp; point size at 300dpi.  I'm not a very experienced programmer, and this is my first use of Windows API.  I would expect the width to decrease gradually with font size, but its not so gradual.</p>\n\n<p>For example:</p>\n\n<p>Point Size = Returned Width (string \"Text\" in font Arial)</p>\n\n<p>14 = 99</p>\n\n<p>13.5 = 95</p>\n\n<p>13 = 91</p>\n\n<p>12.5 = 90 </p>\n\n<p>12 = 84</p>\n\n<p>11.5 = 83 </p>\n\n<p>11 = 75</p>\n\n<p>So reducing font size by 0.5 changes width by 4>4>1>6>1>8.  I'd like to understand why there's a non-linear relationship between font size and returned width.  I know there's vaguery in font rendering, but I'd guess that's not the whole story here, especially not at 300dpi?</p>\n\n<p>Like I said, I'm a not-<em>quite</em>-novice so feel free to say \"Google [keyword], scrub!\"</p>\n\n<p>Context: Unlike most uses of GetTextExtent, there is no object I'm trying to fit.  End goal is a function to return whether string A at X points is wider than string B at Y points when printed in font F at 300dpi.</p>\n\n<p>Here's my code collapsed to one function...</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare PtrSafe Function CreateDC Lib \"gdi32.dll\" Alias \"CreateDCA\" (ByVal lpDriverName As String, ByVal lpDeviceName As String, ByVal lpOutput As String, ByVal lpInitData As Long) As Long\nPrivate Declare PtrSafe Function CreateFont Lib \"gdi32.dll\" Alias \"CreateFontA\" (ByVal nHeight As Integer, ByVal nWidth As Integer, ByVal nEscapement As Integer, ByVal nOrientation As Integer, ByVal fnWeight As Integer, ByVal fdwItalic As Long, ByVal fdwUnderline As Long, ByVal fdwStrikeOut As Long, ByVal fdwCharSet As Long, ByVal fdwOutputPrecision As Long, ByVal fdwClipPrecision As Long, ByVal fdwQuality As Long, ByVal fdwPitchAndFamily As Long, ByVal lpszFace As String) As Long\nPrivate Declare PtrSafe Function SelectObject Lib \"gdi32.dll\" (ByVal hDC As Long, ByVal hObject As Long) As Long\nPrivate Declare PtrSafe Function GetTextExtentPoint32 Lib \"gdi32.dll\" Alias \"GetTextExtentPoint32A\" (ByVal hDC As Long, ByVal lpctStr As String, ByVal c As Integer, ByRef sz As SIZE) As Boolean\nPrivate Declare PtrSafe Function DeleteDC Lib \"gdi32.dll\" (ByVal hDC As Long) As Long\nPrivate Declare PtrSafe Function DeleteObject Lib \"gdi32.dll\" (ByVal hObject As Long) As Long\n\nPrivate Type SIZE\n  x As Long\n  y As Long\nEnd Type\n\nFunction GetPrintedWidth(strToTest As String, strFontName as String, sngFontSize As Single)\n  'Create the device context. (Documents are rendered to PDF before printing, so I'm using the Adobe PDF printer driver. Mistake?)\n  Dim DC As Long: DC = CreateDC(0, \"Adobe PDF\", 0, 0)\n  'Convert sngFontSize points to logical units.  Final print is @300dpi.      \n  'Most examples I've seen use MulDiv, but it converts sngFontSize to long before calculating.\n  Dim nHeight As Long: nHeight = sngFontSize * 300 / 72\n  'Create the font.\n  Dim fnt As Long: fnt = CreateFont(nHeight, 0, 0, 0, 400, 0, 0, 0, 0, 0, 0, 0, 0, strFontName &amp; Chr$(0))\n  'Select font into DC.\n  DeleteObject SelectObject(DC, fnt) \n  'Get string dimensions.\n  Dim sz As SIZE: GetTextExtentPoint32 DC, strToTest, Len(strToTest), sz\n  'Return width.\n  GetPrintedWidth = sz.x \n  'Clean up.\n  DeleteObject fnt\n  DeleteDC DC\nEnd Function\n</code></pre>\n\n<p>I'm <em>extremely</em> open to basic code corrections, I'm still learning!</p>\n\n<p>Y'all are the best, thanks for everything :)</p>\n\n<hr>\n\n<p>Update</p>\n\n<p>Increasing nHeight smooths things out.  I get nearly linear results going from:</p>\n\n<pre><code>    nHeight = sngFontSize * 300 / 72\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>    nHeight = sngFontSize * 3000 / 72\n</code></pre>\n\n<p>So... I guess it <em>is</em> just a font scaling issue, but I'm completely in the dark as to why.  AFAIK the nHeight formula should be </p>\n\n<pre><code>    FontSize * PointsPerLogicalInch / 72\n</code></pre>\n\n<p>...ergo a 300dpi printer should have 300 PointsPerLogicalInch, no?</p>\n\n<hr>\n\n<p>Update 2</p>\n\n<p>GetDeviceCaps LOGPIXELSY is usually used to get PointsPerLogicalInch.  I tested my available printers:</p>\n\n<ul>\n<li><p>Adobe PDF print driver returned 1200</p></li>\n<li><p>My desk printer returned 600</p></li>\n</ul>\n\n<p><em>Incidentally, LOGPIXELSX returned the same</em></p>\n\n<p>So 300 should be right or I've bungled something.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1459881154, "post_id": 36434192, "comment_id": 60483118, "body": "You need to do your replacement of <code>x</code> within the loop.  Right now you&#39;re evaluating the same two equations 100 times.  It would help your question to show the original values of <code>tl1eq</code> and <code>tl2eq</code> and provide sample inputs for <code>hflow</code> and <code>lflow</code>"}, {"owner": {"reputation": 11, "user_id": 6162932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b69826103b951e2bb7018211594d5?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hodgins", "link": "https://stackoverflow.com/users/6162932/jason-hodgins"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459881862, "post_id": 36434192, "comment_id": 60483602, "body": "If I replace x in the loop, won&#39;t I get an error on the second loop when x has already been replaced? tl1eq and tl2eq are dynamic but are defined as ax2 + bx + c and dx6 + ex5..., just second and 6th order polynomials Sample inputs are just any two numbers where lflow is a lower number and hflow is a higher number. The user is supposed to interpret the chart and provide two numbers between which the trendlines cross."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459882297, "post_id": 36434192, "comment_id": 60483873, "body": "It&#39;s difficult to test without concrete examples - I would try out the fix myself but would like not to waste time figuring out sample equations and values.  As to the second loop - you wouldn&#39;t just move those two lines inside the loop: create two more strings which can hold the modified equations resulting from the x replacements: don&#39;t modify tl1eq and tl2eq beyond the <code>x2</code> replacement steps."}, {"owner": {"reputation": 11, "user_id": 6162932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b69826103b951e2bb7018211594d5?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hodgins", "link": "https://stackoverflow.com/users/6162932/jason-hodgins"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1459883698, "post_id": 36434192, "comment_id": 60484711, "body": "Ahh, it took a few tries, but that worked. Thanks so much!"}], "owner": {"reputation": 11, "user_id": 6162932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b69826103b951e2bb7018211594d5?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hodgins", "link": "https://stackoverflow.com/users/6162932/jason-hodgins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459880755, "creation_date": 1459880755, "last_edit_date": 1531161705, "question_id": 36434192, "link": "https://stackoverflow.com/questions/36434192/trendline-equation-evaluation-variable-values-not-updating-in-loop", "title": "Trendline Equation Evaluation Variable Values not Updating in Loop", "body": "<p>I'm writing a program that will take two trend lines that cross and keep evaluating them until a point that is acceptably close to the crossing is found.</p>\n\n<p>I have got to the point where I have the trendlines, formatted how I like, and I've replaced the x's with a variable (one column of an array). When I start my loop, where there are 100 inputs, the lowest of which will be my \"point\", the variable doesn't update to the new value, or step, before the trendline equations are evaluated.</p>\n\n<p>Here's the relevant section of my code, where tl1eq and tl2eq are my trendline equation strings:</p>\n\n<pre><code>tl1eq = Replace(tl1eq, \"y =\", \"\")\ntl1eq = Replace(tl1eq, \"x2\", \"x^2\")\ntl1eq = Replace(tl1eq, \"x\", \" * \" &amp; flhd(i, 1) &amp; \" \")\n\ntl2eq = Replace(tl2eq, \"y =\", \"\")\ntl2eq = Replace(tl2eq, \"x6\", \"x^6\")\ntl2eq = Replace(tl2eq, \"x5\", \"x^5\")\ntl2eq = Replace(tl2eq, \"x4\", \"x^4\")\ntl2eq = Replace(tl2eq, \"x3\", \"x^3\")\ntl2eq = Replace(tl2eq, \"x2\", \"x^2\")\ntl2eq = Replace(tl2eq, \"x\", \" * \" &amp; flhd(i, 1) &amp; \" \")\n\n'create an step amount between low and high flows, with 100 steps\nx = (hflow - lflow) / 100\n\n'fill array with step values and summation of curve equations\nFor i = 1 To 100\n    flhd(i, 1) = lflow + (x * i)\n    flhd(i, 2) = Abs(Evaluate(tl1eq) - Evaluate(tl2eq))\n    MsgBox (flhd(i, 1) &amp; \" \" &amp; tl1eq &amp; \" \" &amp; Evaluate(tl1eq) &amp; \" \" &amp; tl2eq &amp; \" \" &amp; Evaluate(tl2eq))\nNext i\n</code></pre>\n\n<p>flhd(i, 1) doesn't update in the strings when evaluating, but when in the msgbox it shows it as the correct value.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["arrays", "vba", "excel", "range"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1459880654, "post_id": 36434104, "comment_id": 60482759, "body": "You should understand that both <b>rows</b> and <b>columns</b> are reserved words in VBA and should not be used to name variables."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "edited": false, "score": 0, "creation_date": 1459961447, "post_id": 36434349, "comment_id": 60527227, "body": "thanks for that, would you be willing to chat with me in the chat forum on this site? I just have a few questions about graphing series in vba."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1459881276, "creation_date": 1459881276, "answer_id": 36434349, "question_id": 36434104, "link": "https://stackoverflow.com/questions/36434104/vba-defining-a-range-from-an-array/36434349#36434349", "title": "VBA defining a range from an array", "body": "<p>The following will collect your range values into a 2D range then slice off the second column into a new 2D array. The latter is simply 1 to 1 'column' wide.</p>\n\n<pre><code>Dim rws As Long, cols As Long, d As Long\nDim dataset() As Variant, subdataset() As Variant\nDim ShData As Worksheet\n\nSet ShData = Worksheets(\"Sheet4\")\n\nrws = ShData.Cells(ShData.rows.Count, 1).End(xlUp).Row\ncols = ShData.Cells(1, ShData.columns.Count).End(xlToLeft).Column\n\n'set array range (includes column titles and xAxix column)\ndataset = ShData.Range(ShData.Cells(1, 1), ShData.Cells(rws, cols))\n\nsubdataset = Application.Index(dataset, 0, 2) '&lt;~~second column\nFor d = LBound(subdataset, 1) To UBound(subdataset, 1)\n    Debug.Print subdataset(d, 1)\nNext d\n\nShData.Cells(1, \"Z\").Resize(UBound(subdataset, 1), UBound(subdataset, 2)) = subdataset\n</code></pre>\n\n<p>The last operation puts the values of the peeled off column back into the worksheet starting at Z1.</p>\n"}], "owner": {"reputation": 47, "user_id": 5941479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1dbd9fe91b73d50a9949b445615813?s=128&d=identicon&r=PG&f=1", "display_name": "Duranchula", "link": "https://stackoverflow.com/users/5941479/duranchula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 36434349, "answer_count": 1, "score": 1, "last_activity_date": 1459884266, "creation_date": 1459880460, "last_edit_date": 1531164843, "question_id": 36434104, "link": "https://stackoverflow.com/questions/36434104/vba-defining-a-range-from-an-array", "title": "VBA defining a range from an array", "body": "<p>So I have a 2d array with 1000 rows and 10 columns. I want to create 10 ranges for each of the 10 columns and then use them as series to make a chart. MY question is, how do I define a range from an array, without using the entire array, just one column in it?</p>\n\n<pre><code>Sub ChartLord()\n\n    Dim rows As Long\n    Dim columns As Integer\n    Dim mychart As Chart\n    Dim data As Range\n    Dim dataset() As Double\n\n    rows = ShData.Cells(ShData.rows.Count, 1).End(xlUp).Row\n    columns = ShData.Cells(1, ShData.columns.Count).End(xlToLeft).Column\n\n    'set array range (includes column titles and xAxix column)\n    dataset = ShData.Range(ShData.Cells(1, 1), ShData.Cells(rows, columns))\n\n\n\n    For Z = 0 To 10\n\n        Set data = ?\n        Set mychart = shtCharts.Shapes.AddChart2(200, xlColumnClustered, 50 + 300 * Z, 50, 300, 200, 5).Chart\n\n\n    Next Z\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "dialog", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1460558734, "post_id": 36434956, "comment_id": 60800860, "body": "Thank you!! This helped tremendously. I was able to do this for the resource pool and I ended up having to change the file in Project so that the dialog box didn&#39;t open when the file was opened as I couldn&#39;t find how to automate that one."}, {"owner": {"reputation": 121, "user_id": 6158704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EUcUq.jpg?s=128&g=1", "display_name": "ShaggyRogers", "link": "https://stackoverflow.com/users/6158704/shaggyrogers"}, "reply_to_user": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "edited": false, "score": 0, "creation_date": 1460568517, "post_id": 36434956, "comment_id": 60808016, "body": "Glad you got it working.Thank you for the feedback. @sfowler38"}], "tags": [], "owner": {"reputation": 121, "user_id": 6158704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EUcUq.jpg?s=128&g=1", "display_name": "ShaggyRogers", "link": "https://stackoverflow.com/users/6158704/shaggyrogers"}, "is_accepted": true, "score": 0, "last_activity_date": 1459884348, "last_edit_date": 1459884348, "creation_date": 1459883145, "answer_id": 36434956, "question_id": 36433948, "link": "https://stackoverflow.com/questions/36433948/vba-code-to-bypass-dialog-box/36434956#36434956", "title": "VBA Code to Bypass Dialog Box", "body": "<p>I would try <a href=\"https://stackoverflow.com/a/22307297/6158704\">this</a>: </p>\n\n<pre><code>mpApp.FileOpen Name:=file_location_and_name, ReadOnly:=True, openPool:=pjDoNotOpenPool\n</code></pre>\n\n<p>This is query I searched: <em>open resources pool information dialog vba.</em>\nI would try the same search for the other dialog if the problem persists after you apply the 1st fix.</p>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 5, "user_id": 4986519, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcadda7bbd1b479d3258b853b3607d03?s=128&d=identicon&r=PG&f=1", "display_name": "sfowler38", "link": "https://stackoverflow.com/users/4986519/sfowler38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 36434956, "answer_count": 1, "score": 0, "last_activity_date": 1460474345, "creation_date": 1459879961, "last_edit_date": 1531164843, "question_id": 36433948, "link": "https://stackoverflow.com/questions/36433948/vba-code-to-bypass-dialog-box", "title": "VBA Code to Bypass Dialog Box", "body": "<p>I have some code in VBA that opens up a Microsoft Project file, pulls some data, and then closes the file. Unfortunately, I have added some links to the Project file that now makes it so some Splash Screens pop up when opened. I'm trying to edit my code so that the code closes the Splash Screens for the user running the macro so that they don't see or have to respond to them and the macro continues through the process automatically. </p>\n\n<p>This is the code the way it is currently written (FileToOpen is set as the file location)</p>\n\n<pre><code>'Open the MSProject file\n        Set mpApp = New MSProject.Application\n        mpApp.Visible = True\n        AppActivate \"Microsoft Project\"\n        mpApp.FileOpen FileToOpen\n</code></pre>\n\n<p>Then it gathers the data and closes the file</p>\n\n<pre><code>'Close Project and select Excel as running program\n    mpApp.FileClose pjDoNotSave\n    mpApp.Quit\n    Set mpApp = Nothing\n</code></pre>\n\n<p>There are the splash screens I need to navigate through, clicking either OK or Cancel here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/o8woM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o8woM.jpg\" alt=\"1st dialog box\"></a></p>\n\n<p>Clicking Close here (not all other options may always be greyed out):</p>\n\n<p><a href=\"https://i.stack.imgur.com/iOm9J.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iOm9J.jpg\" alt=\"2nd dialog box\"></a></p>\n\n<p>Any help would be greatly appreciated!!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459879657, "post_id": 36433675, "comment_id": 60482090, "body": "Probably want to use an array with <code>worksheet_change</code>."}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459880173, "post_id": 36433675, "comment_id": 60482434, "body": "can you just provide me a coding example keeping in mind the as per the above situation"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1459880555, "post_id": 36433675, "comment_id": 60482685, "body": "Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459881935, "post_id": 36434456, "comment_id": 60483654, "body": "i dont want to copy and change..the user will enter a value into any of the cell under A column from a1 to a10..suppose a user enters a value say 1 in cell a5...then cell a1 will change to 2 , cell a2 to 3 a3 to 4 a4 to 5 , a5 is already 1 as the user entered it. a6 will be 6 and so on....need to to this via va coding so that the value changes dynamically"}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459882150, "post_id": 36434456, "comment_id": 60483790, "body": "i want it dynamically using vba..the user will enter a value in cloumn a itself. suppose a user enter value 1 in cell a5...then cell a1 will change to 2, cell a2 to 3, cell a3 to 4,cell a4 to 5, cell a5 is already 1 as entered by user. cell a6 to 6 and so on...so the changes will only be in cell a based on what the user enters in any of the cell in the range of a1 to a10.I hope u got my question"}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "reply_to_user": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459882777, "post_id": 36434456, "comment_id": 60484160, "body": "I miss understood Let me see if I can come up with someone I&#39;ll delete my question later on"}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459882990, "post_id": 36434456, "comment_id": 60484286, "body": "ur help will be appreciated..i need to complete this by tomorrow any how..atleast the working example"}, {"owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "reply_to_user": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459883117, "post_id": 36434456, "comment_id": 60484366, "body": "Can I ask what this will be used for"}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459883288, "post_id": 36434456, "comment_id": 60484460, "body": "i have a project which i need to complete..its basically setting up the prioties..as in currenty the priority is set from 1 to 10 sequentially..but if the user wants he can chage the priority ans so change in any 1 value will cause the other value to change..this is just an example...so that i can atleast get a start"}], "tags": [], "owner": {"reputation": 103, "user_id": 5190428, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3y5Qr.jpg?s=128&g=1", "display_name": "Brett Nelson", "link": "https://stackoverflow.com/users/5190428/brett-nelson"}, "is_accepted": false, "score": 0, "last_activity_date": 1459882828, "last_edit_date": 1459882828, "creation_date": 1459881561, "answer_id": 36434456, "question_id": 36433675, "link": "https://stackoverflow.com/questions/36433675/dynamically-changing-the-numbers-in-the-cell-based-on-the-the-user-input/36434456#36434456", "title": "dynamically changing the numbers in the cell based on the the user input", "body": "<p>You can just do a formula saying adding 1 from the next one up </p>\n\n<pre><code>A1=1\nA2=\"=A1+1\"\nA3=\"=A2+1\"\nA4=\"=A3+1\"\nA5=\"=A4+1\"\nA6=\"=A5+1\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/67Uqu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/67Uqu.png\" alt=\"enter image description here\"></a></p>\n\n<p>if you copy and paste it should automatically change</p>\n\n<p>am I not understanding your issue properly?</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459884332, "post_id": 36435078, "comment_id": 60485108, "body": "one more twist if can help me with the same as well..now suppose the value in a5 is changed to 1 and so all the other number changes which is working fine...now if i change the value of cell a7 to say 2 then in this case a1 will be 3 , a2 will be 4, a3 will be 5, a4 will be 6, a5 is already 1, a6 will be 7, a7 will be 2 as the user chaged the value, a8 will be 8..a9 will be 9 and so on...so if any other value chages it should not affect the value which is already changed."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459886232, "post_id": 36435078, "comment_id": 60486394, "body": "To do what you are asking, you need some means to determine which values are &quot;locked&quot; and which values are &quot;dynamic&quot;. You could do this with another column and code to manage it, you might do it with a persistent array, or you may code the values differently - e.g instead of 1-10, you might use text. For example a_1 is automatically generated value and u_1 is user generated value."}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459887108, "post_id": 36435078, "comment_id": 60486925, "body": "so u mean i can have a seperate database of the orignal values and then whenever any value changes it must be locked so that there wont be any changes to that value. and only the value which remained unchanged will change based on the user input..can you provide a coding example of the same if u can or if u have time?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459893453, "post_id": 36435078, "comment_id": 60490407, "body": "@RsharkSayyed you should upvote via top left corner of the answer if this helped you. This definitely deserves upvotes."}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459921272, "post_id": 36435078, "comment_id": 60498728, "body": "Bravo superb work done! Thanks @OldUgly Yes I did findwindow, but it is showing me when I&#39;ll earn 15 reputation then it will be displayed."}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459921836, "post_id": 36435078, "comment_id": 60498992, "body": "This is what I was looking for..Besides this for the second part of the same which is present in a different sheet. I need a value present in one cell to be replaced with the other as and when the user changes. which means suppose a1 has value &quot;3&quot; and a5 has value &quot;6&quot; ..and if the user change the value of cel a1 to &quot;6&quot; then cell a5 will get value &quot;3&quot; i.e value of cell a1. while the rest of all the value in the remaininf cell will remain unchanged. similarly it will continue as and when the user changes values"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1459922443, "post_id": 36435078, "comment_id": 60499227, "body": "Sounds like a challenge for you, now you have starting material. 8)"}, {"owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "edited": false, "score": 0, "creation_date": 1459924654, "post_id": 36435078, "comment_id": 60500368, "body": "yes I do have and will work on the same..Thanku so much"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 1, "last_activity_date": 1459894904, "last_edit_date": 1459894904, "creation_date": 1459883535, "answer_id": 36435078, "question_id": 36433675, "link": "https://stackoverflow.com/questions/36433675/dynamically-changing-the-numbers-in-the-cell-based-on-the-the-user-input/36435078#36435078", "title": "dynamically changing the numbers in the cell based on the the user input", "body": "<p>Try this Change event for the worksheet ...</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim myVal As Variant\n    Dim iCount As Long\n\n    Dim cell As Range\n    Dim myRange As Range\n\n    Set myRange = Worksheets(\"Sheet1\").Range(\"A1:A10\")\n\n    If Intersect(Target, Range(\"A1:A10\")) Is Nothing Or Target.Cells.Count &gt; 1 Then Exit Sub\n    Application.EnableEvents = False\n\n    myVal = Target.Value\n    iCount = 1\n    For Each cell In myRange\n        If Intersect(Target, cell) Is Nothing Then\n            If iCount = myVal Then\n                iCount = iCount + 1\n            End If\n            cell.Value = iCount\n            iCount = iCount + 1\n        End If\n    Next cell\n\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>... since you asked for a revision. This uses \"a_\" in front of the number to show that it's auto generated and \"u_\" to show it's user generated. </p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim myVal As Variant\n    Dim iCount As Long\n    Dim usedString As String\n    Dim BypassChange As Boolean\n\n    Dim cell As Range\n    Dim myRange As Range\n\n' if the changed range is not of interest, bail out\n    If Intersect(Target, Range(\"A1:A10\")) Is Nothing Or Target.Cells.Count &gt; 1 Then Exit Sub\n\n' get setup for the work\n    Set myRange = Worksheets(\"Sheet1\").Range(\"A1:A10\")\n\n' usedString will be used to determine if a number has already be set by the user\n    usedString = \" \"\n    For Each cell In myRange\n        If Left(cell.Value, 2) = \"u_\" Then\n            usedString = usedString &amp; \"-\" &amp; Right(cell.Value, Len(cell.Value) - 2) &amp; \"-\"\n        End If\n    Next cell\n\n' check to make sure the user hasn't specified the same number twice. If he has\n' BypassChange will make sure the change gets removed later.\n    myVal = Target.Value\n    If InStr(usedString, \"-\" &amp; myVal &amp; \"-\") &gt; 0 Then\n        MsgBox \"Value already specified -&gt; \" &amp; myVal\n        BypassChange = True\n    End If\n\n' here's the work\n    Application.EnableEvents = False\n\n    iCount = 1\n    For Each cell In myRange\n        If Intersect(Target, cell) Is Nothing Or BypassChange Then\n            If Left(cell.Value, 2) &lt;&gt; \"u_\" Then\n                If iCount = myVal Then\n                    iCount = iCount + 1\n                End If\n                Do While InStr(usedString, \"-\" &amp; iCount &amp; \"-\") &gt; 0\n                    iCount = iCount + 1\n                Loop\n                cell.Value = \"a_\" &amp; iCount\n                iCount = iCount + 1\n            End If\n        Else\n            cell.Value = \"u_\" &amp; myVal\n            usedString = usedString &amp; \"-\" &amp; Right(cell.Value, Len(cell.Value) - 2) &amp; \"-\"\n        End If\n    Next cell\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6162792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207492814293311/picture?type=large", "display_name": "Rshark Sayyed", "link": "https://stackoverflow.com/users/6162792/rshark-sayyed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459937735, "creation_date": 1459879073, "last_edit_date": 1459937735, "question_id": 36433675, "link": "https://stackoverflow.com/questions/36433675/dynamically-changing-the-numbers-in-the-cell-based-on-the-the-user-input", "title": "dynamically changing the numbers in the cell based on the the user input", "body": "<p>I Have a excel sheet under column a I have say 10 values\ncell A1 = 1, cell A2 = 2, cell A3 = 3.....cell A10 = 10\nNow suppose a user changes the value in cell A3. say cell A3 = 1\nso now all the other values should change dynamically\nsay A1 will change to 2, A2 will change 3, A3 is already 1, A4 will change to 4 and so on...\nsimilarly if any other values changes the rest values should be arranged dynamically..keeping only the unique 10 values. no values should be repeated.</p>\n\n<p>I have tried achieving this by copying the values but unable to do so.\n<a href=\"http://i.stack.imgur.com/P2MX4.png\" rel=\"nofollow\">enter image description here</a></p>\n"}, {"tags": ["excel", "reference", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1459877883, "post_id": 36433280, "comment_id": 60481011, "body": "Not clear what you are asking, but functions like <code>Indirect</code>, <code>Offset</code>, <code>Index</code> are probably directly relevant for a non-VBA approach."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1459877979, "creation_date": 1459877979, "answer_id": 36433359, "question_id": 36433280, "link": "https://stackoverflow.com/questions/36433280/excel-referencing-a-cell-using-a-function/36433359#36433359", "title": "Excel: Referencing a cell using a function", "body": "<p>You could use:</p>\n\n<pre><code>=INDEX(A:A,13+((ROW(1:1)-1)*7))-INDEX(B:B,13+((ROW(1:1)-1)*7))\n</code></pre>\n\n<p>And copy down as need be.</p>\n"}], "owner": {"reputation": 3, "user_id": 2872162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d12a56d52461ea08f86d3350dbd175be?s=128&d=identicon&r=PG&f=1", "display_name": "user2872162", "link": "https://stackoverflow.com/users/2872162/user2872162"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 36433359, "answer_count": 1, "score": 0, "last_activity_date": 1459877979, "creation_date": 1459877726, "last_edit_date": 1531161705, "question_id": 36433280, "link": "https://stackoverflow.com/questions/36433280/excel-referencing-a-cell-using-a-function", "title": "Excel: Referencing a cell using a function", "body": "<p>I hope i can explain this clearly, I am trying to compile data and the machine that i get the data from has 7 rows in between the values I need. Therefore to compile I write: </p>\n\n<pre><code>Cell1 = A13 - B13\nCell2 = A13(+7) - B13(+7) = A20 - B20\nCell3 = A20(+7) - B20(+7) = A27 - B27\nEtc.....     \n</code></pre>\n\n<p>Is there a way to write a reference using a function? In this case: A(x+7)</p>\n\n<p>Note: In this example the B column is just a \"control value\" that I have to subtract from A which is my \"sample value\"</p>\n"}, {"tags": ["vba", "ms-word", "userform"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459886098, "post_id": 36432835, "comment_id": 60486292, "body": "What&#39;s Hyperlinker? If it&#39;s the UserForm then the line Hyperlinker.Folder_Name.SetFocus is going to trigger <i>after</i> the UserForm is no longer displayed - <code>Show</code> will make this line wait until the UserForm is finished, with the effect that the UserForm is still active in the first document. Shouldn&#39;t this action be in the code to initialize the UserForm?"}, {"owner": {"reputation": 3, "user_id": 6131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b478ace89cc7302385bfbfcaeb0e39de?s=128&d=identicon&r=PG&f=1", "display_name": "Tornadospoon", "link": "https://stackoverflow.com/users/6131047/tornadospoon"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459886809, "post_id": 36432835, "comment_id": 60486741, "body": "@Cindy dear lord I&#39;m a fool. I moved that line, and it&#39;s working again. Long story short, I looked up the .setfocus line in a forum elsewhere and believe I either misinterpreted it or read some bad advice (likely the former). Thank you!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1459888045, "post_id": 36432835, "comment_id": 60487462, "body": "&quot;Can&#39;t see the forest for the trees&quot; - I know the feeling! Glad it was nothing more complicated... It&#39;s actually not a bad question - with VBA forms this kind of thing is not obvious at all..."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1459936325, "last_edit_date": 1495542675, "creation_date": 1459888828, "answer_id": 36436624, "question_id": 36432835, "link": "https://stackoverflow.com/questions/36432835/word-userform-wont-open-in-second-currently-active-document-after-opened-unloa/36436624#36436624", "title": "Word Userform won&#39;t open in second, currently active document after opened/unloaded in first document", "body": "<p>Working with UserForms in VBA can be tricky, because they're actually a kind of Class. Since VBA tries to make everything exceptionally simple, classes are not obvious, nor is how to work with them correctly. There are situations where they become traps for the unwary.</p>\n\n<p>So VBA makes it possible for you to work with an instance of a UserForm class without you needing to declare and instantiate a new object, as would normally be the case with a class object. The result being that the object can \"hang around\" and cause unexpected behavior, such as you're seeing.</p>\n\n<p>The more correct way to work with a UserForm may seem like a lot more work (code to type and complexity), but it helps to keep things sorted. Indeed, this approach would theoretically allow you to have a separate UserForm for various documents.</p>\n\n<pre><code>Dim frmHyperlinker as Hyperlinker\nSet frmHyperlinker = New Hyperlinker\nfrmHyperlinker.Folder_Name.SetFocus\nfrmHyperlinker.Show\n'Execution waits...\n'Now you're done with it, so clean up\nUnload frmHyperlinker\nSet frmHyperlinker = Nothing\n</code></pre>\n\n<p>There's an Answer in this discussion that goes into more technical detail, although the topic of that question is different from yours: <a href=\"https://stackoverflow.com/questions/20922511/add-public-methods-to-a-userform-module-in-vba\">Add Public Methods to a Userform Module in VBA</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b478ace89cc7302385bfbfcaeb0e39de?s=128&d=identicon&r=PG&f=1", "display_name": "Tornadospoon", "link": "https://stackoverflow.com/users/6131047/tornadospoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 36436624, "answer_count": 1, "score": -1, "last_activity_date": 1459936325, "creation_date": 1459876219, "last_edit_date": 1459890726, "question_id": 36432835, "link": "https://stackoverflow.com/questions/36432835/word-userform-wont-open-in-second-currently-active-document-after-opened-unloa", "title": "Word Userform won&#39;t open in second, currently active document after opened/unloaded in first document", "body": "<p>The headline really says it all, but here's my situation: I have a userform set up to collect user input, then uses that input in a macro and executes it. That, in itself, works exactly like I want it to. The problem comes when more than one document is open. </p>\n\n<p>To illustrate: I have two documents, 'doc a' and 'doc b'. I open both documents, then select 'doc a', open the userform using a show userform macro, input my data, and hit either 'Okay' or 'Cancel' (both of which are set to unload the userform once clicked). The macro runs, and then I select 'doc b' to do the same. This time, however, when I run my 'show userform' macro, 'doc a' is selected and the userform is opened there. </p>\n\n<p>This seems like a pretty basic issue, but I haven't been able to figure out any fixes. After putting 'unload me' failed to work in my button-click subs, I tried creating an unload macro and calling it from those subs instead, but neither is working for me. Any thoughts? (Also, while I'm already here- are there any good tricks to autofill the Userform with the most recently filled data? Not between opening/closing word, which I've seen some solutions for, but just while word is open, and I'm switching between active documents)</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nPrivate Sub UserForm_Initialize()\nFolder_Name = \"\"\nTag_Name = \"\"\nChecklist.Value = True\nSite_Report.Value = False\nSpace_Check.Value = False\nEnd Sub\n\nPublic Sub Okay_Click()\nfolder = Folder_Name.Text\ntag = Tag_Name.Text\ntagtxt = Tag_Name.Text &amp; \"[0-9]{1,}\"\ntagnum = Len(Tag_Name.Text)\nIf Checklist.Value = True Then\n    report_type = \"cl\"\nElse\n    report_type = \"sr\"\nEnd If\nIf Space_Check.Value = True Then\n    space = \"yes\"\nElse\n    space = \"no\"\nEnd If    \nIf Len(Folder_Name.Text) &gt; 0 Then    \nApplication.Run \"Mass_Hyperlink_v_5_0\"\nApplication.Run \"UnloadIt\"    \nElse   \nApplication.Run \"UnloadIt\"   \nEnd If   \nUnload Me\nEnd Sub\n\nPrivate Sub Cancel_Click()\nApplication.Run \"UnloadIt\"\nUnload Me \nEnd Sub\n</code></pre>\n\n<p>I don't think the issue is with the macros that this userform uses (it runs fine on its own, though the code is likely a bit hackneyed), but here's the code for good measure:</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nPublic tag As String\nPublic tagtxt As String\nPublic tagnum As String\nPublic folder As String\nPublic space As String\nPublic report_type As String\n\nPublic Sub Mass_Hyperlink_v_5_0()\n\nDim fileName As String\nDim filePath As String\nDim rng As Word.Range\nDim rng2 As Word.Range\nDim fileType As String\nDim start As String\nDim temp As String\n\nApplication.ScreenUpdating = False\n\nfileType = \"jpg\"\n\nIf space = \"Yes\" Then\n    start = \"%20(\"\n    Else: start = \"(\"\nEnd If\n\nIf report_type = \"cl\" Then\n    folder = \"..\\Images\\\" &amp; folder\n    Set rng = ActiveDocument.Range\n    Else: folder = folder\nEnd If\n\nIf report_type = \"sr\" Then\n    folder = \"Images\\\" &amp; folder\n    Set rng = Selection.Range\n    Else: folder = folder\nEnd If\n\n    Set rng2 = rng.Duplicate\n\n'tagtxt = tag &amp; \"[0-9]{1,}\"\n\nIf Len(rng) &gt; 0 And report_type = \"sr\" Then\n    With rng.Find\n        .Text = tagtxt\n        .Forward = False\n        .MatchWildcards = True\n        .Wrap = wdFindStop\n            Do While .Execute(findText:=tagtxt) = True\n            If rng.InRange(rng2) Then\n                rng.Select\n                'Selection.start = Selection.start + Len(tag)\n                Selection.start = Selection.start + tagnum\n                'ActiveDocument.Range(Selection.start - Len(tag), Selection.start).Delete\n                ActiveDocument.Range(Selection.start - tagnum, Selection.start).Delete\n                fileName = Selection.Text\n                filePath = folder &amp; \"\\\" &amp; Hyperlinker.Tag_Name.Text &amp; start &amp; fileName &amp; \")\" &amp; \".\" &amp; fileType\n                ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, address:= _\n                filePath, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:= _\n                (Hyperlinker.Tag_Name.Text &amp; Selection.Text)\n            Else\n                Exit Sub\n            End If\n            rng.Collapse wdCollapseStart\n        Loop\n    End With\nEnd If\nIf report_type = \"cl\" Then\n    With rng.Find\n        .Text = tagtxt\n        .Forward = False\n        .MatchWildcards = True\n        .Wrap = wdFindStop\n            Do While .Execute(findText:=tagtxt) = True\n            If rng.InRange(rng2) Then\n                rng.Select\n                'Selection.start = Selection.start + Len(tag)\n                Selection.start = Selection.start + tagnum\n                'ActiveDocument.Range(Selection.start - Len(tag), Selection.start).Delete\n                ActiveDocument.Range(Selection.start - tagnum, Selection.start).Delete\n                fileName = Selection.Text\n                filePath = folder &amp; \"\\\" &amp; Hyperlinker.Tag_Name.Text &amp; start &amp; fileName &amp; \")\" &amp; \".\" &amp; fileType\n                ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, address:= _\n                filePath, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:= _\n                (Hyperlinker.Tag_Name.Text &amp; Selection.Text)\n            Else\n                Exit Sub\n            End If\n            rng.Collapse wdCollapseStart\n        Loop\n    End With\n End If\nApplication.ScreenUpdating = True\nEnd Sub\n\nSub Show_Linker()\nHyperlinker.Show\nHyperlinker.Folder_Name.SetFocus\nEnd Sub\n\nSub UnloadIt()\nUnload Hyperlinker\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1459876417, "post_id": 36432825, "comment_id": 60480114, "body": "You haven&#39;t even specified the worksheet. See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for methods on getting away from relying on select and activate to accomplish your goals."}, {"owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 0, "creation_date": 1459883772, "post_id": 36432825, "comment_id": 60484756, "body": "Thank you for the tip @Jeeped I will read the article :)"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 1, "creation_date": 1459883795, "post_id": 36434440, "comment_id": 60484765, "body": "This worked perfectly @michwalk Thank you very much!"}], "tags": [], "owner": {"reputation": 323, "user_id": 5476844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c521cb21c869f244e44aae5257cc007?s=128&d=identicon&r=PG&f=1", "display_name": "michwalk", "link": "https://stackoverflow.com/users/5476844/michwalk"}, "is_accepted": true, "score": 1, "last_activity_date": 1459881524, "creation_date": 1459881524, "answer_id": 36434440, "question_id": 36432825, "link": "https://stackoverflow.com/questions/36432825/paste-in-first-available-cell/36434440#36434440", "title": "Paste in first available cell", "body": "<p>Try this out:</p>\n\n<pre><code>Dim book2 As Excel.Window\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n    Workbooks(\"Book2\").Activate\n    Range(\"A1\").Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(1, 0).Range(\"A1\").Select\n    ActiveSheet.Paste\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 0, "creation_date": 1461686238, "post_id": 36439594, "comment_id": 61307052, "body": "Thank you @brettdj Do I have to do something with the green asterisk?"}, {"owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "edited": false, "score": 0, "creation_date": 1461687028, "post_id": 36439594, "comment_id": 61307578, "body": "Oh, I pasted the name of the document. It worked. But it pasted it into A1 and not the first available cell in column A starting from the top :( @brettdj Is there something we can change in the code? Thank you!"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1459904009, "creation_date": 1459904009, "answer_id": 36439594, "question_id": 36432825, "link": "https://stackoverflow.com/questions/36432825/paste-in-first-available-cell/36439594#36439594", "title": "Paste in first available cell", "body": "<p>You could work more directly with ranges (without <code>Select</code>) as below:</p>\n\n<pre><code>Sub Better()\n\nDim Wb As Workbook\nDim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Range(ActiveCell, ActiveCell.End(xlToRight))\nSet rng1 = Range(rng1, rng1.End(xlDown))\n\nOn Error Resume Next\nSet Wb = Workbooks(\"book2.xlsm\")\nOn Error GoTo 0\n\nIf Wb Is Nothing Then Exit Sub\n\nSet rng2 = Wb.Sheets(1).Columns(1).Find(\"*\", Wb.Sheets(1).[a1], , , xlByRows, xlPrevious)\nIf rng2 Is Nothing Then Set rng2 = Wb.Sheets(1).[a1]\nrng1.Copy rng2.Offset(1, 0)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5899235, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/30c81ae8884910ee24a0c245568f5e1b?s=128&d=identicon&r=PG&f=1", "display_name": "BMRobin", "link": "https://stackoverflow.com/users/5899235/bmrobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 36434440, "answer_count": 2, "score": 0, "last_activity_date": 1459904009, "creation_date": 1459876188, "last_edit_date": 1459880029, "question_id": 36432825, "link": "https://stackoverflow.com/questions/36432825/paste-in-first-available-cell", "title": "Paste in first available cell", "body": "<p>I am trying to create a code that allows me to paste a selected range of data and paste it into Book2 in the first blank cell in Column A, starting from A1.\nThis is what I've got so far:</p>\n\n<pre><code>Sub Macro 1 ()        \n        Range(Selection, Selection.End(xlToRight)).Select\n        Range(Selection, Selection.End(xlDown)).Select            \n        Selection.Copy\n\n        Windows(\"Book2.xlsm\").Activate\n        **CurrentRow = Range(\"A1\").End(xlDown).Offset(1, 0).Row**\n        ActiveSheet.Paste\n    End Sub\n</code></pre>\n\n<p>I believe the trouble is the line with asterisks (**).Can someone help me rewrite this line/code so the copied data can paste in the first available cell from A1 down? (Up won't work since i have filled in cells further down the chart). Right now the code is pasting the data in whatever cell is selected :(</p>\n\n<p>Thank you for your help everyone.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459876253, "post_id": 36432764, "comment_id": 60480021, "body": "What part are you having trouble with? Reposting what someone else gave you and requesting modifications does not demonstrate any level of understanding what you hope to accomplish."}, {"owner": {"reputation": 3, "user_id": 2802184, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/369326fba939b30f324df5e27f79d2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Nina Manns", "link": "https://stackoverflow.com/users/2802184/nina-manns"}, "edited": false, "score": 0, "creation_date": 1459880269, "post_id": 36432764, "comment_id": 60482488, "body": "What I posted was what I originally gave and a user on this site gave me a better modification.  However, I am not sure how to change what is working in the code for me now in order to make it do the new thing I&#39;d like it to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1459880346, "post_id": 36432764, "comment_id": 60482548, "body": "So I will ask again... What part are you having trouble with?"}, {"owner": {"reputation": 3, "user_id": 2802184, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/369326fba939b30f324df5e27f79d2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Nina Manns", "link": "https://stackoverflow.com/users/2802184/nina-manns"}, "edited": false, "score": 0, "creation_date": 1459880893, "post_id": 36432764, "comment_id": 60482945, "body": "Please see edited code in my post.  I don&#39;t understand how to pull extracted data from the specific cells of each worksheet and transfer the output to the master sheet."}], "owner": {"reputation": 3, "user_id": 2802184, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/369326fba939b30f324df5e27f79d2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Nina Manns", "link": "https://stackoverflow.com/users/2802184/nina-manns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459880851, "creation_date": 1459875980, "last_edit_date": 1459880851, "question_id": 36432764, "link": "https://stackoverflow.com/questions/36432764/vba-code-to-extract-data-from-specific-cells-based-on-prompted-start-end-date", "title": "VBA Code to Extract Data from Specific Cells based on Prompted Start/End Date", "body": "<p>In an earlier post \"User3598756\" provided the code/solution to my inquiry on how to extract from multiple sheets to multiple sheets and I'm extremely thankful for the help.  </p>\n\n<p>Now I'd need to pull data by month, so I attempted to modify the below code hoping that when a new command button is clicked it pulls from each of the six sheets based on an entered begin/end date BUT extracts the data from specific columns only and transfers the results to a master sheet destination. BUT I apparently am not doing something correctly in the code I've tried to modify:</p>\n\n<pre><code>    Private Sub cmdRunMonthlyRpt_Click()\n\nDim startdate As Date, enddate As Date\nDim rng As Range, c As Range\nDim destRow(1) As Long\nDim shtSrc(1 To 6) As Worksheet\nDim shtDest(1) As Worksheet\nDim i As Long\n\nSet shtSrc(1) = Sheets(\"Recruiter\")\nSet shtSrc(2) = Sheets(\"SrRecruiter\")\nSet shtSrc(3) = Sheets(\"RecruiterSpc\")\nSet shtSrc(4) = Sheets(\"SrOfcSpc\")\nSet shtSrc(5) = Sheets(\"SrOfcSpcB\")\nSet shtSrc(6) = Sheets(\"UnivRecruiter\")\n\nSet shtDest(1) = Sheets(\"Extract_Scorecard_Month\")\n\ndestRow(1) = 2\n\nstartdate = CDate(InputBox(\"Input desired start date for report data\"))\nenddate = CDate(InputBox(\"Input desired end date for report data\"))\n\nFor i = 1 To 6\n    Set rng = shtSrc(i).Range(\"A:A\").SpecialCells(xlCellTypeConstants, xlNumbers) 'this will select only numbers constants. since dates are numbers they'll get into this range\n    For Each c In rng\n        If c.Value &gt;= startdate And c.Value &lt;= enddate Then\n             c.Offset(0, 0).Resize(1, 45).Copy Destination:=shtDest(i).Cells(destRow(i), 1)\n             destRow(i) = destRow(i) + 1\n        End If\n    Next c\nNext i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I think I am making things harder than needed, so if there's a better way to accomplish the desired output, I'd appreciate some instruction.  I am an Administrative Assistant trying to learn VBA.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1459883590, "post_id": 36432403, "comment_id": 60484654, "body": "Do you need the date of the last entered record? If so then I think you need to use the <code>dlast()</code> function?"}, {"owner": {"reputation": 11, "user_id": 6162461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460b059f9fdcaf91f0cf854d955ce556?s=128&d=identicon&r=PG&f=1", "display_name": "Mike R.", "link": "https://stackoverflow.com/users/6162461/mike-r"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1459892132, "post_id": 36432403, "comment_id": 60489754, "body": "Well, yes. But the requirement is asking to use &quot;DMax&quot; function to retrieve the last visit!"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 1, "creation_date": 1459924850, "post_id": 36432403, "comment_id": 60500471, "body": "&quot;This is what I have: LastVisit: DMax(&quot;VisitDate&quot;,&quot;tbl_Visits&quot;,&quot;[PetID]= &quot; &amp; &#39;PetID&#39;) But, it returns a single date( which is the latest date in the Visits table) for all the records, which is incorrect.&quot; what is incorrect about this, is the date incorrect or the fact it is only returning a single date which you feel is incorrect?"}], "owner": {"reputation": 11, "user_id": 6162461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460b059f9fdcaf91f0cf854d955ce556?s=128&d=identicon&r=PG&f=1", "display_name": "Mike R.", "link": "https://stackoverflow.com/users/6162461/mike-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461330440, "creation_date": 1459874868, "last_edit_date": 1461330440, "question_id": 36432403, "link": "https://stackoverflow.com/questions/36432403/ms-access-dmax-i-have-13-rows-of-different-pets-and-need-to-find-last-visit-for", "title": "MS Access Dmax: I have 13 rows of different Pets and need to find Last Visit for each?", "body": "<p>The problem: Create a <code>LastVisitDate</code> field/column using the <code>DMax</code> function based on <code>Pet</code>.</p>\n\n<p>The only tables I am allowed to use are <code>tbl_Customer</code> and <code>tbl_Pets</code>. I am suppose to add a field and use the Expression builder using <code>Dmax</code> accessing/referencing <code>tbl_Visits</code> that has <code>PetID</code> (text field). I have 13 distinct records to find their last visit date for each in the query. This is what I have:</p>\n\n<pre><code>LastVisit: DMax(\"VisitDate\",\"tbl_Visits\",\"[PetID]= \" &amp; 'PetID')\n</code></pre>\n\n<p>But, it returns a single date( which is the latest date in the Visits table) for all the records, which is incorrect. </p>\n\n<p>I also tried this, but it returns nothing:</p>\n\n<pre><code>LastVisit: DMax(\"VisitDate\",\"tbl_Visits\",\"[PetID]= '*'\")\n</code></pre>\n\n<p>I know the error has to do with how I have set up my \"Criteria.\" Any Suggestions? Thanks in advance.</p>\n\n<p>(I have an alternate way of adding Visits table, VisitDate and then do Totals and Group By \"Max\" which gets me the result, but I am not suppose to be adding <code>tbl_visits</code> to my query.)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459875555, "post_id": 36432327, "comment_id": 60479558, "body": "What is your Macro Security <b>Trust</b> setting(s) <b>??</b>"}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459876501, "post_id": 36432327, "comment_id": 60480173, "body": "It says Disable all macros with notification"}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459876532, "post_id": 36432327, "comment_id": 60480193, "body": "and Turst access is VBA Project object model is unchecked"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459876757, "post_id": 36432327, "comment_id": 60480329, "body": "Please review the following before proceeding:  <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/vbe.aspx</a>"}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459877339, "post_id": 36432327, "comment_id": 60480683, "body": "Thanks that doesn&#39;t sound like a good way to go, would there be a better way to do an export of a module, like ThisWorkbook.Activate then open an export file dialog then wbNew.Activate and open an import dialog?"}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1459878387, "post_id": 36432327, "comment_id": 60481322, "body": "Oh, I meant to say that my method above was not a good way to go from what you asked me to read...thanks good info"}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 6158704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EUcUq.jpg?s=128&g=1", "display_name": "ShaggyRogers", "link": "https://stackoverflow.com/users/6158704/shaggyrogers"}, "is_accepted": false, "score": 0, "last_activity_date": 1459923459, "last_edit_date": 1525816150, "creation_date": 1459921277, "answer_id": 36442448, "question_id": 36432327, "link": "https://stackoverflow.com/questions/36432327/vba-copy-module-from-one-workbook-to-another/36442448#36442448", "title": "VBA Copy Module from one Workbook to another", "body": "<p>Some of the times you cant step through the code when programing the VBIDE.  Even if your Code is 100% it will Err on Step. </p>\n\n<p>Place a Stop just outside of where you bugOut &amp; just let it run to the Stop. If it hits an Error with your Code still. You could verify your code against <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">Chips</a> function:</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 6158704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EUcUq.jpg?s=128&g=1", "display_name": "ShaggyRogers", "link": "https://stackoverflow.com/users/6158704/shaggyrogers"}, "edited": false, "score": 0, "creation_date": 1459924205, "post_id": 36443125, "comment_id": 60500083, "body": "Yup, might even need to add VBIDE in front of VBComponent. So it would look like        VBIDE.VBComponent"}, {"owner": {"reputation": 121, "user_id": 6158704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EUcUq.jpg?s=128&g=1", "display_name": "ShaggyRogers", "link": "https://stackoverflow.com/users/6158704/shaggyrogers"}, "edited": false, "score": 0, "creation_date": 1459969250, "post_id": 36443125, "comment_id": 60532083, "body": "Option Explicit seems to be the variable. Without it VBComponent is fine. With it one would need to add the VBIDE part."}], "tags": [], "owner": {"reputation": 1110, "user_id": 5461139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4b4054e24745d798a80ab0d6ab195557?s=128&d=identicon&r=PG&f=1", "display_name": "Gerneio", "link": "https://stackoverflow.com/users/5461139/gerneio"}, "is_accepted": false, "score": 1, "last_activity_date": 1459923899, "creation_date": 1459923899, "answer_id": 36443125, "question_id": 36432327, "link": "https://stackoverflow.com/questions/36432327/vba-copy-module-from-one-workbook-to-another/36443125#36443125", "title": "VBA Copy Module from one Workbook to another", "body": "<p>Assuming that both work books are open at the same time, give this a try</p>\n\n<pre><code>Dim comp as VBComponent\nSet comp = ThisWorkbook.VBProject.VBComponents(\"Coexis_BitAND\")\nWorkbooks(\"otherWorkbookName\").VBProject.VBComponents.add comp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1460041346, "creation_date": 1460041346, "answer_id": 36480095, "question_id": 36432327, "link": "https://stackoverflow.com/questions/36432327/vba-copy-module-from-one-workbook-to-another/36480095#36480095", "title": "VBA Copy Module from one Workbook to another", "body": "<p>This is what I found worked, from the original answer, thanks for all the help.</p>\n\n<pre><code>        If DUTs = 0 Then\n        '----- WARNING VBA Macro Settings must Trust access to VBA Project Object Models.\n        '----- Antivirus may detect this action and delete this file!\n        filePath = ActiveWorkbook.Path\n        ThisWorkbook.Activate\n        ActiveWorkbook.VBProject.VBComponents(\"Coexis_BitAND\").Export (filePath + \"\\Coexis_BitAND.bas\")\n        wbNew.Activate\n        ActiveWorkbook.VBProject.VBComponents.Import (filePath + \"\\Coexis_BitAND.bas\")\n\n    End If\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2813, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1460041346, "creation_date": 1459874579, "last_edit_date": 1459882247, "question_id": 36432327, "link": "https://stackoverflow.com/questions/36432327/vba-copy-module-from-one-workbook-to-another", "title": "VBA Copy Module from one Workbook to another", "body": "<p>Hello thanks for reading my question. I'm trying create an automated script that exports a module from one workbook to another new workbook</p>\n\n<pre><code>            ThisWorkbook.Activate\n        ActiveWorkbook.VBProject.VBComponents(\"Coexis_BitAND\").Export (\"c:\\Coexis_BitAND.bas\")\n        wbNew.Activate\n        ActiveWorkbook.VBProject.VBComponents.Import (\"c:\\Coexis_BitAND.bas\")\n</code></pre>\n\n<p>However, when I step through the code as soon as the step hits  \"ActiveWorkbook.VBProject.VBComponents(\"Coexis_BitAND\").Export (\"c:\\Coexis_BitAND.bas\")\" It jumps to one of my OnError Goto's. </p>\n\n<p>I've read it's possible to do this but have yet to find something that works, I'm sure it has to be something simple like my lack of experience with VBA</p>\n"}]