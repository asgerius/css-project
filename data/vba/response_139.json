[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504742437, "post_id": 46085852, "comment_id": 79133848, "body": "<a href=\"http://wellsr.com/vba/2016/excel/Show-Color-Palette-Dialog-Box-with-VBA-xlDialogEditColor/\" rel=\"nofollow noreferrer\">wellsr.com/vba/2016/excel/&hellip;</a>  (And please remove the [vb.net] tag if this is VBA.)"}, {"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504742814, "post_id": 46085852, "comment_id": 79133933, "body": "Hi, sorry I meant so that it be simple for a user to change the colour of multiple cells because of how my current application works. and thanks YowE3K, I will give that a read."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504743388, "post_id": 46085979, "comment_id": 79134066, "body": "I was hoping it worked somewhat similar to an input box where :        <code>recNum = InputBox(&quot;Enter the Number you Wish to Recolour:&quot;)</code>  recNum becomes the input,  In the above code I was hoping that the newColour variable would become the colour that was picked in the colour picker"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 1, "creation_date": 1504744034, "post_id": 46085979, "comment_id": 79134196, "body": "No, the dialog is editing the workbook colours.  It would be nice if there was a <code>Dialogs(xlDialogColourChooser)</code> (especially if they spelled &quot;colour&quot; correctly! ;) ) but there isn&#39;t as far as I know."}, {"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504744578, "post_id": 46085979, "comment_id": 79134303, "body": "So there is no way to pass a colour picker colour into a variable?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504745632, "post_id": 46085979, "comment_id": 79134525, "body": "If you wanted to put it into a variable, instead of directly colouring a cell, just use something like <code>xyz = ActiveWorkbook.Colors(1)</code>."}, {"owner": {"reputation": 809, "user_id": 980936, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/HYd8p.png?s=128&g=1", "display_name": "Eric F", "link": "https://stackoverflow.com/users/980936/eric-f"}, "edited": false, "score": 0, "creation_date": 1573766701, "post_id": 46085979, "comment_id": 104002815, "body": "A bit old of an answer but I wanted to add a note that <code>Thisworkbook.Colors(1)</code> is stored as an integer so it is possible to store it and use it as such. For example <code>Dim colornum as integer  colornum = Thisworkbook.Colors(1)</code>"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 4, "last_activity_date": 1504742821, "creation_date": 1504742821, "answer_id": 46085979, "question_id": 46085852, "link": "https://stackoverflow.com/questions/46085852/pass-a-colour-picker-colour-into-a-variable/46085979#46085979", "title": "Pass a colour picker colour into a variable", "body": "<p>Your code is asking the user to select a new colour for colour 1, and return <code>True</code> to the variable <code>newColour</code> if the user selects a colour, or <code>False</code> if they cancel.</p>\n\n<p>So you would be able to use your code as</p>\n\n<pre><code>newColour = Application.Dialogs(xlDialogEditColor).Show(1)\nIf newColour Then\n    Range(\"A1\").Interior.Color = ActiveWorkbook.Colors(1)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1580, "favorite_count": 0, "accepted_answer_id": 46085979, "answer_count": 1, "score": 2, "last_activity_date": 1504742821, "creation_date": 1504741886, "last_edit_date": 1531164843, "question_id": 46085852, "link": "https://stackoverflow.com/questions/46085852/pass-a-colour-picker-colour-into-a-variable", "title": "Pass a colour picker colour into a variable", "body": "<p>Is there a way to pass a colour selected from the inbuilt picker into a variable?\nSomething like this?</p>\n\n<pre><code>newColour = Application.Dialogs(xlDialogEditColor).Show(1)\n</code></pre>\n\n<p>If not, what is the best way to go about getting colours from a GUI into a variable so it is easy for the user to change colours?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504738895, "post_id": 46085461, "comment_id": 79133051, "body": "Using <code>.FormulaArray = myFormula1</code> implies that <code>myFormula1</code> is a valid formula by itself.  It isn&#39;t."}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504739502, "post_id": 46085461, "comment_id": 79133213, "body": "@YowE3K I wasn&#39;t aware of that. In myFormula1 I&#39;ve now moved the <code>IF(INDEX....</code>. near the end to the 2nd formula and closed that IF statement in formula1 with a simple <code>&quot;&quot;true&quot;&quot;,&quot;&quot;false&quot;&quot;)</code> and then use that in the replace as well. It still results in an error. As I mentioned though, even using =1+1 as a formula in myFormula1 results in the error once i reach the step <code>.FormulaArray = myFormula1 </code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504740713, "post_id": 46085461, "comment_id": 79133495, "body": "If you don&#39;t have any blank cells in <code>E2:AZ140</code> (or even if it is a blank sheet, which means your <code>UsedRange</code> doesn&#39;t extend there, and therefore the cells aren&#39;t classed as being blank) your <code>With</code> statement will crash, but once I get past that line I have no trouble setting the <code>FormulaArray</code> to <code>=1+1</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504740821, "post_id": 46085461, "comment_id": 79133521, "body": "What is the actual error message you get?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504741654, "post_id": 46085461, "comment_id": 79133705, "body": "The other issue you are going to have is that, if there are some non-blank cells in your destination range, you will probably have non-contiguous areas in the <code>Range(&quot;E2:AZ140&quot;).SpecialCells(xlCellTypeBlanks)</code> and so your formula will only be applied to the first of those areas."}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504741677, "post_id": 46085461, "comment_id": 79133710, "body": "It&#39;s the Runtime error 1004 &quot;Unable to set the FormulaArray property of the range class&quot; that many have reported and that allowed me to look up possible solutions. If I set the range to H14:H16 and delete the contents of H15, then run the VBA I still get the error. Is there a different solution to enter a formula into only empty cells? My sheet is big. ~800 columns and several thousand rows. A potential issue?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504741806, "post_id": 46085461, "comment_id": 79133736, "body": "So you get that same message with <code>=1+1</code>?  Hmmm.  Modify your code to insert a statement <code>MsgBox .Address</code> just before your <code>.FormulaArray = myFormula1</code> statement. I&#39;d be interested to know what range it is trying to apply the formula to.  (Do that with <code>myFormula1</code> set to <code>&quot;=1+1&quot;</code> - that will remove any noise from anything in the long formula.)"}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504742717, "post_id": 46085461, "comment_id": 79133908, "body": "@YowE3K I updated the question above to indicate the simplified code I created and ran. I still get the error. I&#39;m going to change computer and see if I still get the same issue on a different Excel install."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504742971, "post_id": 46085461, "comment_id": 79133971, "body": "Using <code>.FormulaArray = myFormula1</code> implies that <code>myFormula1</code> is a valid formula by itself.  <code>&quot;=1+1,X_X_X&quot;</code> is not valid."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504745279, "post_id": 46086042, "comment_id": 79134458, "body": "OK some progress. Many thanks. If I use that and set the range to H14:H16 and run it with H15 blank (H14 and H16 are non-blank), it enters the array formula into H15, but the addresses haven&#39;t incremented to match the cell. If I make H14 blank and the other 2 cells filled, same result, formula in but addresses still as written in the formula. If H16 is blank (H14 and H15 non-blank) I get the error &quot;No cells were found&quot; although H16 is empty and within the range."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504745988, "post_id": 46086042, "comment_id": 79134585, "body": "The last bit (&quot;no cells found&quot; even though H16 is blank) is likely because your <code>UsedRange</code> is currently only extending to H15 - cells outside the current &quot;used&quot; area of the worksheet do not appear to be deemed to be part of the worksheet when using <code>SpecialCells</code> (I suspect that is a deliberate decision by Microsoft, and not a bug).  For the first part, you are going to have to give us a lot more details as to what your worksheet looks like, and why you are only selecting some cells within the range to apply the formula to, before we can come up with any useful answer."}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504748393, "post_id": 46086042, "comment_id": 79135177, "body": "I&#39;m only selecting small sections of my full table for testing (time) purposes. Because of its size it is faster to only test on a small piece of it. My data tracks injuries in Major League Baseball. Each row represents a team and one of their games. In the columns are each player in the league. The cells contain game data for each player. If a cell is blank, either the player didn&#39;t play in the game, or they are not on that team and would be missing from all rows for the games for that team."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1504743843, "last_edit_date": 1504743843, "creation_date": 1504743378, "answer_id": 46086042, "question_id": 46085461, "link": "https://stackoverflow.com/questions/46085461/another-unable-to-set-the-formulaarray-property-of-the-range-class/46086042#46086042", "title": "Another &gt;&gt; Unable to set the FormulaArray property of the range class", "body": "<p>When you set a formula using <code>FormulaArray = ...</code>, it needs to be a valid formula.  (I think after each <code>Replace</code> the formula needs to continue being valid too, but I haven't tested that.  Edit: No, if the <code>Replace</code> would create an invalid formula, it just doesn't process it - but it doesn't crash.)</p>\n\n<p>Your problems all seem to stem from the use of invalid formulas in your <code>myFormula1</code> variable.</p>\n\n<p>I suggest you use the following:</p>\n\n<pre><code>Sub ArrayMacro()\n\n    Dim myFormula1 As String\n    Dim myFormula2 As String\n    Dim myFormula3 As String\n    Dim myFormula4 As String\n\n    myFormula1 = \"=IF(COUNTIFS(MLBtransactions!$D:$D,A$1,MLBtransactions!$A:$A,\"\"&lt;=\"\"&amp;$C2)&gt;0,IF(1232=$A2,\"\"DNP/SUS/MIN\"\",\"\"with \"\"&amp;1233),1234)\"\n    myFormula2 = \"INDEX(MLBtransactions!$A:$E,MATCH(1,(MLBtransactions!$D:$D=A$1)*(MLBtransactions!$A:$A&lt;=$C2),0),5)\"\n    myFormula3 = \"INDEX(MLBtransactions!$A:$E,MATCH(A$1,MLBtransactions!$D:$D,0),5)\"\n    myFormula4 = \"IF(COUNTIFS(MLBstats!$B:$B,A$1,MLBstats!$A:$A,$A2)=1,\"\"DNP/SUS/MIN\"\",\"\"LEAVE BLANK\"\")\"\n\n    'Insert the formula\n    With Sheets(\"Sheet1\").Range(\"E2:AZ140\").SpecialCells(xlCellTypeBlanks)\n        .FormulaArray = myFormula1\n        .Replace \"1232\", myFormula2\n        .Replace \"1233\", myFormula3\n        .Replace \"1234\", myFormula4\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504748247, "post_id": 46086106, "comment_id": 79135150, "body": "I&#39;ve tried the first option you mention. Entering the array formula outside the table, copying and pasting the formula into the table in all blank cells. The array formula is entered properly into the single cell and copied into all empty table cells well. But I lose the A$1 cell references which become #REF! in the resulting formulas. I don&#39;t use a lot of loops in my macros (don&#39;t know how). I&#39;m wondering if it would be more straightforward"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504749481, "post_id": 46086106, "comment_id": 79135445, "body": "I actually meant try putting it straight into one of the cells in your table. You can paste it into the first blank cell using: Range(&quot;h14:h16&quot;).SpecialCells(xlCellTypeBlanks).cells(1) and then copy it from there."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504749929, "post_id": 46086106, "comment_id": 79135553, "body": "That said, a loop is much safer. SpecialCells doesn&#39;t return blank cells after that last used cell on your spreadsheet, so may not return all cells you expect. I&#39;ve added a simple For loop to get you started, but you should read up on them more."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504750633, "post_id": 46086106, "comment_id": 79135737, "body": "That said, a loop is much slower. Using copy-paste will most likely be quicker. Also, if you don&#39;t know where your first blank cell will exist, that means you also don&#39;t know what the initial value for the formula needs to be before copying and pasting it. You may need to start by creating the formula in a cell you know will always be blank, but adjust it so that when it is copied into the table it has the correct references. You could determine this by working backwards: Put the correctly formula into a blank cell in a table, then copy and paste it to your always blank cell outside the table."}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504751622, "post_id": 46086106, "comment_id": 79135978, "body": "Thanks @Michael. Time shouldn&#39;t be an issue as the macro is replacing a manual step that takes me ~60 minutes. Even if the macro takes 120 minutes to complete it&#39;s time I don&#39;t have to spend doing it. I&#39;ll experiment with a loop. But I need to take the other issue of the error I was initially getting into consideration which might complicate the loop"}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1504750765, "last_edit_date": 1504750765, "creation_date": 1504743855, "answer_id": 46086106, "question_id": 46085461, "link": "https://stackoverflow.com/questions/46085461/another-unable-to-set-the-formulaarray-property-of-the-range-class/46086106#46086106", "title": "Another &gt;&gt; Unable to set the FormulaArray property of the range class", "body": "<p>Setting .FormulaArray to a range of cells in VBA is the same as pressing <code>CTRL</code>+<code>SHIFT</code>+<code>ENTER</code> while the entire range is selected. This is used when a single formula is returning an array of results and you want to display that array in the range of selected cells. This requires a contiguous range of cells to display the array. Trying to set .FormulaArray on a non-contiguous range of cells will fail, regardless of whether the formula is good or not.</p>\n\n<p>I think you're trying to create an Array Formula that returns a single result after performing analysis on arrays; and you want this formula used in all blank cells.</p>\n\n<p>In Excel, you would need to array-enter the formula into a single cell and then copy the formula into other cells.</p>\n\n<p>Similarly, you need to do it in 2 steps in VBA. You need to first set the .FormulaArray for just one cell. This will also confirm that the formula is being constructed correctly in VBA. You can then copy that cell to all blank cells, using PasteSpecial if you only want to copy the formula.</p>\n\n<p>Alternatively, you could loop through all blank cells setting the .FormulaArray individually, e.g.:</p>\n\n<pre><code>Dim raCell As Range\n\nFor Each raCell In Range(\"E2:AZ140\")\n    If IsEmpty(raCell) Then raCell.FormulaArray = ...\nNext\n</code></pre>\n\n<p>However, as you have dynamic references, you would need to construct the FormulaArray carefully to correctly determine the formula required based on the .Row and .Column of the current raCell.</p>\n\n<p>Copy and paste would be safer if you have an \"achor\" point. Somewhere you know you can always enter the exact same formula and get the correct result when copied and pasted to all other cells.</p>\n"}], "owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504750765, "creation_date": 1504738547, "last_edit_date": 1504743433, "question_id": 46085461, "link": "https://stackoverflow.com/questions/46085461/another-unable-to-set-the-formulaarray-property-of-the-range-class", "title": "Another &gt;&gt; Unable to set the FormulaArray property of the range class", "body": "<p>I've researched as many of the \"Unable to set the FormulaArray property of the range class\" issues here and in other sites to troubleshoot a FormulaArray operation I'm trying to carry out in a table of data.</p>\n\n<p>I've respected the 255 character limit in my formula taking into account R1C1, I've tried to insert the formula as a text string first. I've tried quite a few things. </p>\n\n<p>Now I'm thinking my issue is with the fact that I'm trying to insert my formula only into blank cells because if I simplify my formula to only be =1+1 I still get the error. If I change .FormulaArray to .Formula to simply enter a standard formula I also get the same error. Is this operation not possible with blank cells?</p>\n\n<p>The error occurs at the <code>.FormulaArray = myFormula1</code> step.</p>\n\n<p>To confirm, the formula by itself works (pasted further below) when entered into cells manually.</p>\n\n<pre><code>    Sub ArrayMacro()\n\n    Dim myFormula1 As String \n    Dim myFormula2 As String \n    Dim myFormula3 As String \n    Dim myFormula4 As String \n\n    myFormula1 = \"=IF(COUNTIFS(MLBtransactions!$D:$D,A$1,MLBtransactions!$A:$A,\"\"&lt;=\"\"&amp;$C2)&gt;0,IF(INDEX(MLB,\" &amp; \"X_X_X)\" \n    myFormula2 = \"transactions!$A:$E,MATCH(1,(MLBtransactions!$D:$D=A$1)*(MLBtransactions!$A:$A&lt;=$C2),0),,\" &amp; \"Y_Y_Y)\" \n    myFormula3 = \"5)=$A2,\"\"DNP/SUS/MIN\"\",\"\"with \"\" &amp; INDEX(MLBtransactions!$A:$E,MATCH(A$1,MLBtransactions,\" &amp; \"Z_Z_Z)\" \n    myFormula4 = \"!$D:$D,0),5)),IF(COUNTIFS(MLBstats!$B:$B,A$1,MLBstats!$A:$A,$A2)=1,\"\"DNP/SUS/MIN\"\",\"\"LEAVE BLANK\"\"))\" \n\n    Sheets(\"Sheet1\").Select  \n    With Range(\"E2:AZ140\").SpecialCells(4)\n    .FormulaArray = myFormula1 \n    .Replace \",X_X_X)\", myFormula2 \n    .Replace \",Y_Y_Y)\", myFormula3 \n    .Replace \",Z_Z_Z)\", myFormula4 \n    End With \n\n    End Sub\n</code></pre>\n\n<p>Question update. Using <code>With Range(\"E2:AZ140\").SpecialCells(xlCellTypeBlanks)</code> instead of <code>With Range(\"E2:AZ140\").SpecialCells(4)</code> also ends with the same error.</p>\n\n<p>Here is the full formula being used</p>\n\n<blockquote>\n  <p>=IF(COUNTIFS(MLBtransactions!$D:$D,A$1,MLBtransactions!$A:$A,\"&lt;=\"&amp;$C2)>0,IF(INDEX(MLBtransactions!$A:$E,MATCH(1,(MLBtransactions!$D:$D=A$1)*(MLBtransactions!$A:$A&lt;=$C2),0),5)=$A2,\"DNP/SUS/MIN\",\"with \" &amp; INDEX(MLBtransactions!$A:$E,MATCH(A$1,MLBtransactions!$D:$D,0),5)),IF(COUNTIFS(MLBstats!$B:$B,A$1,MLBstats!$A:$A,$A2)=1,\"DNP/SUS/MIN\",\"LEAVE BLANK\"))</p>\n</blockquote>\n\n<p>Testing with a simplified code (example below) led to the realization as YowE3K points out that myFormula1 needs to be valid in order for the procedure to work. </p>\n\n<pre><code>Sub ArrayMacro()\n\nDim myFormula1 As String\nDim myFormula2 As String\n\nmyFormula1 = \"=1+1\" &amp; \"+2+2\"\nmyFormula2 = \"+1+1\"\n\nSheets(\"Sheet1\").Select\nWith Range(\"h14:h16\").SpecialCells(xlCellTypeBlanks)\nMsgBox .Address\n.FormulaArray = myFormula1\n.Replace \"+2+2)\", myFormula2\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504741384, "post_id": 46085279, "comment_id": 79133648, "body": "it creates a new workbook and it does not save it?"}, {"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504744517, "post_id": 46085279, "comment_id": 79134290, "body": "@jsotola it creates a new workbook, but does not save it automatically. I&#39;m looking to have the code prompt the user to open an existing workbook first and that workbook will be used as the destination for the copies"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504750411, "post_id": 46085279, "comment_id": 79135668, "body": "so, just do web search for <code>open workbook using vba</code>  ... there should be a lot of examples"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1504790347, "post_id": 46086551, "comment_id": 79156680, "body": "Hi Tony. I tried your code, but whenever I have more than 1 workbook open (say, PERSONAL.XLSB and the destination workbook), the macro creates blank sheets in one book and copies all of the data onto a single sheet in the other book"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1504793744, "post_id": 46086551, "comment_id": 79159385, "body": "I&#39;ve made a small change, using the sh variable instead of ActiveSheet (since when debugging ActiveSheet can cause problems). Keep in mind that my code is just intended to get you started. I hope that helps"}, {"owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1504819925, "post_id": 46086551, "comment_id": 79173810, "body": "Yes it helped! Thank you"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "edited": false, "score": 0, "creation_date": 1504846326, "post_id": 46086551, "comment_id": 79180266, "body": "Glad you&#39;ve been helped. If you think your question has been answered please mark it as answered"}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1504793543, "last_edit_date": 1504793543, "creation_date": 1504747921, "answer_id": 46086551, "question_id": 46085279, "link": "https://stackoverflow.com/questions/46085279/excel-vba-copy-all-csv-from-one-folder-into-existing-workbook-as-separate-work/46086551#46086551", "title": "Excel VBA - Copy all csv from one folder into existing workbook as separate worksheets", "body": "<p>The code below does what you describe; that is it \"takes all .csv files from one folder and copies them into a pre-existing workbook, where all of the sheets have the same name as the source .csv file\". </p>\n\n<p>To produce the code, I first imported one of the <code>.csv</code> files using the macro recorder, and then modified the code to handle the general case of multiple files in the same folder. I also removed a lot of unnecessary code. You should be able to modify this code to suit your needs.</p>\n\n<pre><code>Option Explicit\nSub csvToSheets()\nDim wk As Workbook, sh As Worksheet, s As String\nConst path = \"C:\\test\\\"\n  s = Dir(path &amp; \"*.csv\")\nWhile s &lt;&gt; \"\"\n    ThisWorkbook.Worksheets.Add\n    Set sh = ActiveSheet\n\n\n    With sh.QueryTables.Add(Connection:=\"TEXT;\" &amp; path &amp; s, _\n        Destination:=Range(\"$A$1\"))\n        .Name = s\n        .TextFileParseType = xlDelimited\n        .TextFileCommaDelimiter = True\n        .Refresh BackgroundQuery:=False\n    End With\n    sh.Name = Left(s, Len(s) - 4)\n    s = Dir()\nWend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8508428, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7651bd1a22fa06075e919f47316f9029?s=128&d=identicon&r=PG&f=1", "display_name": "ClockworkNemo", "link": "https://stackoverflow.com/users/8508428/clockworknemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 2, "closed_date": 1504771020, "answer_count": 1, "score": -1, "last_activity_date": 1504793543, "creation_date": 1504737372, "last_edit_date": 1504783025, "question_id": 46085279, "link": "https://stackoverflow.com/questions/46085279/excel-vba-copy-all-csv-from-one-folder-into-existing-workbook-as-separate-work", "closed_reason": "Needs more focus", "title": "Excel VBA - Copy all csv from one folder into existing workbook as separate worksheets", "body": "<p>I am looking to create a macro that takes all .csv files from one folder and copies them into a pre-existing workbook, where all of the sheets have the same name as the source .csv file.</p>\n\n<p>I have found the code below (unfortunately, I do not remember where I exactly found it and cannot cite the author) Right now it only does part of what I'm looking for. It allows the user to select the folder where the .csv files are at, but it creates a new workbook and copies the files into that. I would like for the macro to also prompt the user to select the destination workbook for the files to be copied into.</p>\n\n<pre><code>Option Explicit\n\nSub csvCopier()\n\nDim wkb As Workbook\nDim wksDest As Worksheet\nDim strData As String\nDim x As Variant\nDim Cnt As Long\nDim r As Long\nDim c As Long\nDim i As Long\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.csv*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\nIf Right(myPath, 1) &lt;&gt; \"\\\" Then myPath = myPath &amp; \"\\\"\n\nmyFile = Dir(myPath &amp; \"*.csv\")\n\nDo While Len(myFile) &gt; 0\n\n    Cnt = Cnt + 1\n\n    If Cnt = 1 Then\n        Set wkb = Workbooks.Add(xlWBATWorksheet)\n    End If\n\n    Open myPath &amp; myFile For Input As #1\n\n        Set wksDest = wkb.Worksheets.Add\n\n        wksDest.Name = Left(myFile, InStr(1, myFile, \".csv\") - 1)\n\n        r = 2\n        c = 1\n        Do Until EOF(1)\n            Line Input #1, strData\n            x = Split(strData, \",\")\n            For i = LBound(x) To UBound(x)\n                Cells(r, c).Value = x(i)\n                c = c + 1\n            Next i\n            r = r + 1\n            c = 1\n        Loop\n\n    Close #1\n\n    myFile = Dir\n\nLoop\n\n   If Cnt &gt; 0 Then\n    Application.DisplayAlerts = False\n    wkb.Worksheets(wkb.Worksheets.Count).Delete\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    MsgBox \"Completed...\", vbInformation\n    Else\n    Application.ScreenUpdating = True\n    MsgBox \"No CSV files found...\", vbExclamation\n    End If\n\nResetSettings:\n'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504742381, "post_id": 46085233, "comment_id": 79133838, "body": "some of what you wrote is getting lost in translation.  it is not clear what you are asking to do..  .... please include an example of how the final data is obtained.  .... it is unclear what <i>Madrofor</i> is  .... attach a screenshot of what you are trying to do, if possible"}, {"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504767206, "post_id": 46085233, "comment_id": 79141003, "body": "Sorry for the inconvenience. I try to explain myself, I EDIT the post in order to clear it."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504768517, "post_id": 46085233, "comment_id": 79141810, "body": "it is not an inconvenience    .... what is Madrofor ?"}, {"owner": {"reputation": 362, "user_id": 6848370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f95c007c9aae09f758853b380f48666?s=128&d=identicon&r=PG&f=1", "display_name": "Proger_Cbsk", "link": "https://stackoverflow.com/users/6848370/proger-cbsk"}, "edited": false, "score": 0, "creation_date": 1504768715, "post_id": 46085233, "comment_id": 79141931, "body": "So the macro is to automate the cells&#39; formula in the Diary sheet ? Why not use macro to do the string concatenate and write directly the result in Diary&#39;s cells ? Just add a button called &quot;update me&quot; for your boss ... the macro will be easier."}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1504768784, "post_id": 46085233, "comment_id": 79141977, "body": "Well, it just too long to read and understand what your problem.  Could you specific your problem, like sample data, what it output now, and what it should be.  Moreover, remember to provide sample in text format, so we can test it before post as answer"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1504768836, "post_id": 46085233, "comment_id": 79142009, "body": "@Prisoner, the OP attached pictures"}, {"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "reply_to_user": {"reputation": 362, "user_id": 6848370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f95c007c9aae09f758853b380f48666?s=128&d=identicon&r=PG&f=1", "display_name": "Proger_Cbsk", "link": "https://stackoverflow.com/users/6848370/proger-cbsk"}, "edited": false, "score": 0, "creation_date": 1504769124, "post_id": 46085233, "comment_id": 79142222, "body": "@Proger_Cbsk I can do that ? I didn&#39;t know, I&#180;m just starter with vba and learning myself at home.... How I do that or what function I must search in order to learn to do it ?. Many thanks for your response"}, {"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "reply_to_user": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1504769209, "post_id": 46085233, "comment_id": 79142281, "body": "@Prisoner sorry I edit the post to do it shorter :( I hope it was clear now ... If you need aclaraciones don&#39;t hesitate to ask. Thanks for read it, any help will be appreciated"}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504769232, "post_id": 46085233, "comment_id": 79142297, "body": "@jsotola Maybe you want to take a look: <a href=\"https://meta.stackoverflow.com/a/285557/1050927\">meta.stackoverflow.com/a/285557/1050927</a>"}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1504769945, "post_id": 46085233, "comment_id": 79142734, "body": "That&#39;s better.  But I can&#39;t understand your code, you have for each loop with <code>element</code>, but never use in the loop; Assign formula before it assign (<code>a = b &amp; &quot;;&quot; &amp; b</code>); And what you try to do with <code>a = b &amp; &quot;;&quot; &amp; b</code>?"}, {"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "reply_to_user": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1504770192, "post_id": 46085233, "comment_id": 79142897, "body": "@Prisoner I try to add comments at code to clarify ... Hope it works :)"}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1504771081, "post_id": 46085233, "comment_id": 79143472, "body": "Try to post your table as text, you may use this <a href=\"https://senseful.github.io/text-table/\" rel=\"nofollow noreferrer\">tool</a> to help you.  And your comments cannot answer my question.  Note: I&#39;m not the owner for this tool, credit to &#39;senseful&#39;"}, {"owner": {"reputation": 362, "user_id": 6848370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f95c007c9aae09f758853b380f48666?s=128&d=identicon&r=PG&f=1", "display_name": "Proger_Cbsk", "link": "https://stackoverflow.com/users/6848370/proger-cbsk"}, "edited": false, "score": 0, "creation_date": 1504771329, "post_id": 46085233, "comment_id": 79143618, "body": "@Judith, simply do a <code>ActiveCell.Value = a</code> in your example . Direct concatenation is done like <code>ActiveCell.Value = a &amp; b &amp; &quot; hi! &quot; &amp; ...</code>"}, {"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "reply_to_user": {"reputation": 362, "user_id": 6848370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f95c007c9aae09f758853b380f48666?s=128&d=identicon&r=PG&f=1", "display_name": "Proger_Cbsk", "link": "https://stackoverflow.com/users/6848370/proger-cbsk"}, "edited": false, "score": 0, "creation_date": 1504778697, "post_id": 46085233, "comment_id": 79148637, "body": "@Proger_Cbsk Thanks for your proposal but when I added it I get only the first row and not all complete and get only: False;False value at the cell (whatever are the value  from r, the number of sheets it must concatenate). I don&#39;t know how overpass this False;False value and the limit to two concadenation. I hope you can provide any suggestion ... Anyway very thanks for your time :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "edited": false, "score": 0, "creation_date": 1504856198, "post_id": 46107879, "comment_id": 79184553, "body": "Thank you ! I check it but only works for Red and Black worksheets. If it&#39;s possible what I need is that I can add/remove dynamically sheets at the assign page. I try to add Color page for example and it didn&#39;t work.... I&#39;ll try to work in your code and thank you."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "edited": false, "score": 0, "creation_date": 1504887847, "post_id": 46107879, "comment_id": 79204189, "body": "<code>it didn&#39;t work</code> is not a description of a problem .... what did you try ?  ... what error did you get?  .... what was the undesired result?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "edited": false, "score": 0, "creation_date": 1504888050, "post_id": 46107879, "comment_id": 79204293, "body": "what is the reason for filling the <i>Diary</i> that way?  .... there may be a better way to present information."}, {"owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "edited": false, "score": 0, "creation_date": 1504891602, "post_id": 46107879, "comment_id": 79205988, "body": "Sorry i explain myself badly \ud83d\ude1e. It concatenate all the values is perfect. But only for Black and Red sheets. I need. That for all the sheets my boss put at one specific column at Asign Sheet. The idea is he can put there 24 - 25 names, change it without need to enter at code. That is the reason to use Data() and name1 to n variables to store the sheet names. I hope I explain myself better and apologize for not be clear before."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1504840075, "last_edit_date": 1504840075, "creation_date": 1504838940, "answer_id": 46107879, "question_id": 46085233, "link": "https://stackoverflow.com/questions/46085233/concatenate-strings-with-do-loop-with-dynamic-column-and-files/46107879#46107879", "title": "Concatenate Strings with Do Loop with dynamic column and files", "body": "<p>try this.   .... could be simplified by looping through \"colors\" .... black, red, etc</p>\n\n<pre><code>Sub Diary()\n\n    Dim red As Variant\n    red = Sheets(\"red\").Range(\"d6:g12\")                 ' put range data into an array for processing\n\n    Dim black As Variant\n    black = Sheets(\"black\").Range(\"d6:g12\")\n\n    Dim i As Integer\n    Dim j As Integer\n\n    Dim strC As String\n    Dim strS As String\n\n    For i = 1 To 7\n        For j = 1 To 4\n\n            strC = \"\"\n            strS = \"\"\n\n            If LCase(black(i, j)) = \"c\" Then strC = \"Black\"\n\n            If LCase(black(i, j)) = \"s\" Then strS = \"Black\"\n\n            If LCase(red(i, j)) = \"c\" Then\n                If Len(strC) &gt; 1 Then strC = strC &amp; \";\"\n                strC = strC &amp; \"Red\"\n            End If\n\n            If LCase(red(i, j)) = \"s\" Then\n                If Len(strS) &gt; 1 Then strS = strS &amp; \";\"\n                strS = strS &amp; \"Red\"\n            End If\n\n            Sheets(\"diary\").Range(\"c7\").Cells(i, j * 2 - 1) = strS\n            Sheets(\"diary\").Range(\"c7\").Cells(i, j * 2) = strC\n\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8568079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d710880352cf66f7336c4b5dfc5006?s=128&d=identicon&r=PG&f=1", "display_name": "Judith", "link": "https://stackoverflow.com/users/8568079/judith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504840075, "creation_date": 1504737121, "last_edit_date": 1504770723, "question_id": 46085233, "link": "https://stackoverflow.com/questions/46085233/concatenate-strings-with-do-loop-with-dynamic-column-and-files", "title": "Concatenate Strings with Do Loop with dynamic column and files", "body": "<p>So at Assign sheet I indicate the sheets to take data for each group (each for column and the first row is the explanation of the group). I dynamically can add res at the file or delete</p>\n\n<p>After I use predefined codes to assign which type of discounts / day are applied. At the example I only put two codes (C and S) and one week. For example the raw sheet data for designations Red and Black.\n<a href=\"https://i.stack.imgur.com/ENC30.png\" rel=\"nofollow noreferrer\">Data product worksheet</a></p>\n\n<p>Then at Diary I want to show the result of concatenate the B1 value (name of product) each time code fromm price are indicated into the rows. Also I use two loop because at raw product data I have one column for price but at the Diary I have two\n<a href=\"https://i.stack.imgur.com/bdefu.png\" rel=\"nofollow noreferrer\">Summary page</a></p>\n\n<p>This is what I finally want to get and doing like that because my boss don't know anything for code and he wan't edite it so I try to do ll dynamic at the sheets :) [I only put two images because i don't have reputations point enough to put more]</p>\n\n<p>With the formula I only get FALSE as answer :(, and I need to get what you can see at summary page</p>\n\n<pre><code>   Sub Diary()\n        Dim I As Integer, x As Integer, y As Integer, z As Integer, n As Integer\n        Dim p As Integer, d As Integer, f As Integer\n        Dim a As String, b As String\n        Dim element As Variant\n' Initialize variables I and y at 3 and 4 to begin to show the data at the column I desire. Also x and z were intended to pass the one column mode data sheet to the two column mode at the summary page.\n        I = 3\n        x = 1\n        y = 4\n        z = 0\n\n        With Worksheets(\"Asign\")\n            .Activate\n            .Range(\"B2\").Select\n        End With\n' Set the size of Data with sheet names it get form the page assign. It can dynamically changed as size as names of sheets\n        With ActiveSheet\n            r = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        End With\n\n        Dim Data() As String\n\n        ReDim Data(r)\n\n        For p = 1 To r - 1\n           Data(p) = ActiveSheet.Cells(p + 1, \"B\").Value\n        Next p\n\n        With Worksheets(\"Diary\")\n            .Activate\n            .Range(\"C7\").Select\n        End With\n' At Diary concatenate the same cell for all the sheets I have his name stored at Data() and then pass to the next cell with data at raw data sheets (in the images (Red, Black ,... pages). In this case search for code S \n\n        Do\n          Cells(7, I).Select\n           ActiveCell.Value = ActiveCell.FormulaR1C1 = \"=CONCATENATE(\" &amp; a &amp; \")\"\n            For Each element In Data\n               b = ActiveCell.FormulaR1C1 = \"IF(Data&amp; !R[-2]C[\" &amp; x &amp; \"]=\"\"S\"\",CONCATENATE(Data&amp;!R1C2,\"\", \"\"),\"\"\"\")\"\n               a = b &amp; \";\" &amp; b\n            Next element\n\n            x = x - 1\n            I = I + 2\n        Loop While I &lt; 4\n ' The same for the second column of summary sheet called Diary. In this case search for code C    \n        Do\n          Cells(7, y).Select\n           ActiveCell.Value = ActiveCell.FormulaR1C1 = _\n                                   \"=CONCATENATE(\" &amp; a &amp; \")\"\n           For Each element In Data\n              b = ActiveCell.FormulaR1C1 = \"IF(Data&amp; !R[-2]C[\" &amp; z &amp; \"]=\"\"S\"\",CONCATENATE(Data&amp;!R1C2,\"\", \"\"),\"\"\"\")\"\n              a = b &amp; \";\" &amp; b\n             Next element\n\n             z = z - 1\n             y = y + 2\n          Loop While I &lt; 4\n  ' Drag and Drop the formula to all the sheet's cells you need\n        Range(\"C8:E8\").Select\n        Selection.AutoFill Destination:=Range(\"C8:E10\"), Type:=xlFillDefault\n    '\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "events", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1504737086, "post_id": 46084671, "comment_id": 79132541, "body": "You need to clarify just what you are asking for. Are you trying to dynamically change what subroutine that a button launches? If so, is it a forms button or an active-X button?"}], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 7416484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4ded2dfe3912f01a9477f4518546ab?s=128&d=identicon&r=PG", "display_name": "GSD", "link": "https://stackoverflow.com/users/7416484/gsd"}, "is_accepted": false, "score": 0, "last_activity_date": 1504743645, "last_edit_date": 1504743645, "creation_date": 1504738455, "answer_id": 46085445, "question_id": 46084671, "link": "https://stackoverflow.com/questions/46084671/how-to-set-click-event-to-a-button-in-codebehind-in-excel-vba/46085445#46085445", "title": "How to set click event to a button in codebehind in Excel VBA?", "body": "<p>This routine adds a button and a button click event at run time to a already existing Userform1.  Note you need to set a reference to Microsoft Visual Basic For Applications Extensibility 5.3 (Tools | References)</p>\n\n<pre><code>Sub AddControlDynamically()\n\nDim vbCompFrm As VBComponent\nDim objButton As Object\n\n'Edit \"Userform1\" in the following line to your Userform name\nSet vbCompFrm = ThisWorkbook.VBProject.VBComponents(\"Userform1\")\n\n'Following line creates a command button on the form\nSet objButton = vbCompFrm.Designer.Controls.Add(\"Forms.CommandButton.1\")\n\nWith objButton\n    .Name = \"cmdButton1\"   'Can use this name for the Add event sub\n    .Left = 10\n    .Top = 10\n    .Height = 20\n    .Width = 80\n    .Caption = \"My Button\"\nEnd With\n\nWith vbCompFrm.CodeModule\n    .InsertLines .CountOfLines + 1, \"Private Sub cmdButton1_Click()\"\n    .InsertLines .CountOfLines + 1, \"    MsgBox \"\"Hello World!\"\"\"\n    .InsertLines .CountOfLines + 1, \"End Sub\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2266, "user_id": 5698517, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/915a651f37965c17b3a65cd9505bc6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Tor", "link": "https://stackoverflow.com/users/5698517/ali-tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 990, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504743645, "creation_date": 1504733646, "last_edit_date": 1531164843, "question_id": 46084671, "link": "https://stackoverflow.com/questions/46084671/how-to-set-click-event-to-a-button-in-codebehind-in-excel-vba", "title": "How to set click event to a button in codebehind in Excel VBA?", "body": "<p>I want to bind an event to a button in runtime using Excel VBA. Is there a method to create it like <code>button.Click += button_Click</code> in C#?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1504733500, "post_id": 46084504, "comment_id": 79131354, "body": "It&#39;s not the number of cells that you choose that is the issue, it is the <b>255 character limit</b> on a range name."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504736525, "post_id": 46084504, "comment_id": 79132389, "body": "I get a 1004 error with your second example..."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504746265, "post_id": 46084504, "comment_id": 79134650, "body": "you have a possible typo ... J2 is shown twice in both examples"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1504733332, "creation_date": 1504733332, "answer_id": 46084603, "question_id": 46084504, "link": "https://stackoverflow.com/questions/46084504/is-there-a-limit-to-the-number-of-cells-called-on-in-a-source-range/46084603#46084603", "title": "Is there a limit to the number of cells called on in a source range?", "body": "<p>That <code>\"A1, B1, C1\"</code> syntax is just shorthand for <code>Range.Union</code> - use explicit <code>Range.Union</code> calls and the sky is the limit!</p>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 1, "last_activity_date": 1504747864, "last_edit_date": 1504747864, "creation_date": 1504746798, "answer_id": 46086404, "question_id": 46084504, "link": "https://stackoverflow.com/questions/46084504/is-there-a-limit-to-the-number-of-cells-called-on-in-a-source-range/46086404#46086404", "title": "Is there a limit to the number of cells called on in a source range?", "body": "<p>not meant as an answer  ... just a tip</p>\n\n<p>simplify your range name</p>\n\n<pre><code>With mybook.Worksheets(1)\n    Set SourceRange = .Range(\"C2, J2,\" _\n                           &amp; \"D7, F7, K7,\" _\n                           &amp; \"G10:G12, J10:J12,\" _\n                           &amp; \"G14:G17, J14:J17,\" _\n                           &amp; \"J21,\" _\n                           &amp; \"D24:E30, G24:G30, I24:J30, O24:S30\")\nEnd With\nSourceRange.Select\nStop                 ' look at your worksheet here to see if the range is correct  ... comment out two lines after verification\n</code></pre>\n\n<p>if you are going to refer to <code>mybook.worksheets(1)</code> any place else, then define an object variable and use it, like so</p>\n\n<pre><code>Dim ws1 As Worksheet\nSet ws1 = mybook.Worksheets(1)\n\nSet SourceRange = ws1.Range(\"C2, J2,\" _\n                          &amp; \"D7, F7, K7,\" _\n                          &amp; \"G10:G12, J10:J12,\" _\n                          &amp; \"G14:G17, J14:J17,\" _\n                          &amp; \"J21,\" _\n                          &amp; \"D24:E30, G24:G30, I24:J30, O24:S30\")\nSourceRange.Select\nStop                 ' look at your worksheet here to see if the range is correct  ... comment out two lines after verification\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8501514, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8f9a15653e1f0c1da2781561a6bb7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "AMiller", "link": "https://stackoverflow.com/users/8501514/amiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 46084603, "answer_count": 2, "score": 1, "last_activity_date": 1504747864, "creation_date": 1504732788, "question_id": 46084504, "link": "https://stackoverflow.com/questions/46084504/is-there-a-limit-to-the-number-of-cells-called-on-in-a-source-range", "title": "Is there a limit to the number of cells called on in a source range?", "body": "<p>I pieced together a visual basic code that pulls data from cells in multiple workbooks and creates a master summary workbook.  I want to include a large number of cells from each workbook, but the Sub stops working if I include too many cells in the source range.  The first section of code below works fine.  If I add more cells (second section of code), the Sub still runs, but generates a blank workbook.  The rest of the code is identical in both cases.  Is there a maximum number of cells/ characters that I can include in a command?  Even so, I would think this wouldn't exceed such a limit.</p>\n\n<p>THIS CODE WORKS FINE</p>\n\n<pre><code> With mybook.Worksheets(1)\n                Set sourceRange = .Range(\"J2, C2, D7, F7, K7, G10, J10, G11, J11, G12, J12,\" _\n                &amp; \"G14, J14, G15, J15, G16, J16, G17, J17, J21,\" _\n                &amp; \"J2, D24:E24, G24, I24, J24, O24:S24,\" _\n                &amp; \"D25:E25, G25, I25, J25, O25:S25,\" _\n                &amp; \"D30:E30, G30, I30, J30, O30:S30\")\n\n            End With\n</code></pre>\n\n<p>THIS CODE RETURNS A BLANK WORKSHEET</p>\n\n<pre><code>With mybook.Worksheets(1)\n                Set sourceRange = .Range(\"J2, C2, D7, F7, K7, G10, J10, G11, J11, G12, J12,\" _\n                &amp; \"G14, J14, G15, J15, G16, J16, G17, J17, J21,\" _\n                &amp; \"J2, D24:E24, G24, I24, J24, O24:S24,\" _\n                &amp; \"D25:E25, G25, I25, J25, O25:S25,\" _\n                &amp; \"D26:E26, G26, I26, J26, O26:S26,\" _\n                &amp; \"D27:E27, G27, I27, J27, O27:S27,\" _\n                &amp; \"D28:E28, G28, I28, J28, O28:S28,\" _\n                &amp; \"D29:E29, G29, I29, J29, O29:S29,\" _\n                &amp; \"D30:E30, G30, I30, J30, O30:S30\")\n\n            End With\n</code></pre>\n\n<p>I've tried using different cells and have the same problem; it seems to be the number of cells I choose, not what is in the cells in the original workbook, that is the problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 1, "creation_date": 1504732998, "post_id": 46084492, "comment_id": 79131104, "body": "If it is one time do find <code>[Financial Statement Generator.xlsm]</code> and replace with empty string..."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1504733119, "creation_date": 1504733119, "answer_id": 46084558, "question_id": 46084492, "link": "https://stackoverflow.com/questions/46084492/inconsistency-in-formulas-while-copying-a-worksheet-to-new-workbook/46084558#46084558", "title": "Inconsistency in formulas while copying a worksheet to new workbook", "body": "<p>Copying the worksheets one at a time will have the issue you describe.  The simple way around it is to copy both sheets at once:</p>\n\n<pre><code>Dim sheetName As Variant\nSet wb = Workbooks.Add\nsheetName = Array(\"Q\" &amp; Quarter &amp; \" Financial Condition\", \"Q\" &amp; Quarter &amp; \" Activities\")\nThisWorkbook.sheets(sheetName).Copy Before:=wb.sheets(1)\n</code></pre>\n"}], "owner": {"reputation": 690, "user_id": 1915786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c83fee4d39bf5f07880c045d6998cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Surve", "link": "https://stackoverflow.com/users/1915786/praful-surve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 46084558, "answer_count": 1, "score": 0, "last_activity_date": 1504733119, "creation_date": 1504732743, "last_edit_date": 1504732858, "question_id": 46084492, "link": "https://stackoverflow.com/questions/46084492/inconsistency-in-formulas-while-copying-a-worksheet-to-new-workbook", "title": "Inconsistency in formulas while copying a worksheet to new workbook", "body": "<p>I have two worksheets (named 'Q4 Financial Condition' and 'Q4 Activites') in a workbook (named 'Financial Statement Generator'), and I need to copy the worksheets into a new workbook.</p>\n\n<p>Worksheet 'Q4 Financial Condition' has one cell formula as <code>='Q4 Activities'!F37 - H56 - H57</code></p>\n\n<p>When I do a copy to new workbook, the formula changes to <code>='[Financial Statement Generator.xlsm]Q4 Activities'!F37 - H56 - H57</code></p>\n\n<p>Is there any other alternatives in excel where I can retain the formula as it is and copy the worksheet to the new workbook.</p>\n\n<p>I am doing the copy sheets through macros-</p>\n\n<pre><code>Dim sheetName As Variant\nSet wb = Workbooks.Add\nsheetName = Array(\"Q\" &amp; Quarter &amp; \" Financial Condition\", \"Q\" &amp; Quarter &amp; \" Activities\")\nThisWorkbook.sheets(sheetName(1)).Copy Before:=wb.sheets(1)\nThisWorkbook.sheets(sheetName(0)).Copy Before:=wb.sheets(1)\n</code></pre>\n"}, {"tags": ["vba", "excel", "google-chrome", "hyperlink"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504732342, "post_id": 46084347, "comment_id": 79130820, "body": "If you show us the code that you are trying to get to work, and tell us what it isn&#39;t doing correctly, we might be better able to help you fix it than if we just have to guess what the issue is."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8496595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcce3bcac78fd0a492ff541017e8447?s=128&d=identicon&r=PG", "display_name": "user8496595", "link": "https://stackoverflow.com/users/8496595/user8496595"}, "edited": false, "score": 0, "creation_date": 1504950033, "post_id": 46084788, "comment_id": 79220805, "body": "Maybe I could modify it to open just a selection but as I don&#39;t know how to do it I will use it as it is. Thank you very much. I surely appreciate the time you are going to free me."}], "tags": [], "owner": {"reputation": 41, "user_id": 8555866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1188101071289910/picture?type=large", "display_name": "Alan C&#233;sar", "link": "https://stackoverflow.com/users/8555866/alan-c%c3%a9sar"}, "is_accepted": true, "score": 0, "last_activity_date": 1504738032, "last_edit_date": 1504738032, "creation_date": 1504734204, "answer_id": 46084788, "question_id": 46084347, "link": "https://stackoverflow.com/questions/46084347/open-multiple-hyperlinks-in-default-browser/46084788#46084788", "title": "Open multiple hyperlinks in default browser", "body": "<p>You can use a loop to call the <code>ActiveWorkbook.FollowHyperlink</code> function, and use the links you already have in your worksheet.\nAssuming you have the links in the form bellow:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HR273.png\" rel=\"nofollow noreferrer\">Links in worksheet</a></p>\n\n<p>You now have to loop in these links and open them one by one. In the bellow code the column A is hard coded, but you can easily change that by another input of yours, like a user selection, for example.</p>\n\n<pre><code>Sub test_link()\n\nDim current_row As Integer\nDim last_row As Integer\nDim current_sht As Worksheet\n\ncurrent_row = 1\nSet current_sht = ActiveWorkbook.ActiveSheet\nlast_row = current_sht.Cells(current_sht.Rows.Count, \"A\").End(xlUp).Row\n\nWhile current_row &lt;= last_row\n    ActiveWorkbook.FollowHyperlink Address:=current_sht.Range(\"A\" &amp; current_row) 'Open link\n    current_row = current_row + 1\nWend\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 19, "user_id": 8496595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dcce3bcac78fd0a492ff541017e8447?s=128&d=identicon&r=PG", "display_name": "user8496595", "link": "https://stackoverflow.com/users/8496595/user8496595"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 1, "closed_date": 1504758537, "accepted_answer_id": 46084788, "answer_count": 1, "score": 0, "last_activity_date": 1504738032, "creation_date": 1504732026, "last_edit_date": 1504732252, "question_id": 46084347, "link": "https://stackoverflow.com/questions/46084347/open-multiple-hyperlinks-in-default-browser", "closed_reason": "Not suitable for this site", "title": "Open multiple hyperlinks in default browser", "body": "<p>Good afternoon, I am asking this because I didn't get any of the codes I got from the web working. I have a sheet that has a lot of links and I want to be able to open at least 10 of them at a time, in tabs. I previously had some code (that I lost) that opened all of them(in chrome), which was a big problem.\nI would like 1 of 2 things:</p>\n\n<p>Option 1: Open all the hyperlinks I select from a column in my default browser(chrome) (the hyperlinks are there with the following formula \"=hyperlink(leftcell;\"OPEN\")</p>\n\n<p>Option 2: I paste either the hyperlink or text in another sheet and the 10 first rows are opened.</p>\n\n<p>I would greatly appreciate the help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504732875, "post_id": 46084402, "comment_id": 79131053, "body": "Are the source files all single-sheet workbooks, or do they have multiple sheets/tabs?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504733029, "post_id": 46084402, "comment_id": 79131122, "body": "The answer <a href=\"https://stackoverflow.com/questions/9259862/executeexcel4macro-to-get-value-from-closed-workbook\">ExecuteExcel4Macro to get value from closed workbook</a> will saolve your problem."}, {"owner": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504733144, "post_id": 46084402, "comment_id": 79131187, "body": "They are all single-sheet workbooks"}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504737651, "post_id": 46084905, "comment_id": 79132715, "body": "On the line &quot;Set sht = ThisWorkbook.Sheets(&quot;Data&quot;)&quot; I get the error &quot;runtime error 9 vba subscript out of range&quot;. Does this mean that I should replace &quot;Data&quot; with the specific number of files in the folder?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504738176, "post_id": 46084905, "comment_id": 79132859, "body": "No - you should name a sheet &quot;Data&quot; (or whatever you want) in the Excel file which contains the macro.  And adjust the path to where the source data files are stored."}, {"owner": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504738834, "post_id": 46084905, "comment_id": 79133035, "body": "Thanks! I changed &quot;Data&quot; to &quot;Sheet1&quot;. I&#39;ve also changed the target cells and the folder address. New error on line &quot;.Formula = &quot;=&#39;&quot; &amp; F_PATH &amp; &quot;[&quot; &amp; f &amp; &quot;]blah&#39;!&quot; &amp; ref&quot; is &quot;Runtime error 1004: Application defined or object defined error&quot;. Should I change blah to something specific? Hovering over the variables shows that the file path and the cell reference is correct."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504740798, "post_id": 46084905, "comment_id": 79133517, "body": "What&#39;s the value of <code>ref</code> when it fails?"}, {"owner": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504796417, "post_id": 46084905, "comment_id": 79161435, "body": "The value is &quot;$K$26&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504801345, "post_id": 46084905, "comment_id": 79164716, "body": "That&#39;s odd: for me (Excel 2013) I can put anything for the sheet name and it still works fine as long as the workbook only has a single sheet.  Glad you got it working though."}, {"owner": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "edited": false, "score": 0, "creation_date": 1504807069, "post_id": 46084905, "comment_id": 79167675, "body": "Hmmm...I&#39;m on excel 2010 at work. Thanks for the help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1504734863, "creation_date": 1504734863, "answer_id": 46084905, "question_id": 46084402, "link": "https://stackoverflow.com/questions/46084402/formula-or-vba-script-in-excel-to-display-specific-data-from-all-files-in-a-fold/46084905#46084905", "title": "Formula or VBA script in excel to display specific data from all files in a folder", "body": "<p>This should get you started.</p>\n\n<p>Note there are two approaches to extracting the data:</p>\n\n<ul>\n<li>ExecuteExcel4Macro: this is probably best if you know the worksheet names are all the same</li>\n<li>Formula-based version: as long as the source files only have a single sheet, then this will work regardless of the sheet names.</li>\n</ul>\n\n<p>Which one you use will depend on your exact use case.</p>\n\n<pre><code>Sub ExtractData()\n\n    Const F_PATH As String = \"C:\\_Stuff\\test\\files\\\"\n    Dim f, sht As Worksheet, arrRefs, rw As Long, cl As Long, ref\n\n    Set sht = ThisWorkbook.Sheets(\"Data\")\n\n    arrRefs = Array(\"$A$1\", \"$B$2\", \"$C$3\") 'cells to extract\n\n    rw = 2 'starting row for data\n    f = Dir(F_PATH &amp; \"*.xls*\")\n    Do While f &lt;&gt; \"\"\n\n        sht.Cells(rw, 1).Value = f 'record the filename\n\n        cl = 2 '&lt;&lt; starting column for extracted data\n        For Each ref In arrRefs\n\n            '## use this form if the worksheets all have the same name\n            'sht.Cells(rw, cl) = ExecuteExcel4Macro(\"'\" &amp; F_PATH &amp; \"[\" &amp; f &amp; _\n            '            \"]Sheet1'!\" &amp; Range(ref).Address(True, True, -xlR1C1))\n\n            '## use this form if the worksheet names might vary\n            '*** as long as there's only one worksheet in each file**\n            With sht.Cells(rw, cl)\n                .Formula = \"='\" &amp; F_PATH &amp; \"[\" &amp; f &amp; \"]blah'!\" &amp; ref\n                .Value = .Value\n            End With\n            cl = cl + 1 '&lt;&lt; next column\n        Next ref\n\n        rw = rw + 1\n        f = Dir() '&lt;&lt; next file\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1504732273, "question_id": 174988}, "owner": {"reputation": 682, "user_id": 5540779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cQBwUxcnTU4/AAAAAAAAAAI/AAAAAAAABJE/5NECUAi1nR4/photo.jpg?sz=128", "display_name": "Joe B", "link": "https://stackoverflow.com/users/5540779/joe-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 46084905, "answer_count": 1, "score": 0, "last_activity_date": 1504734863, "creation_date": 1504731812, "question_id": 46084402, "link": "https://stackoverflow.com/questions/46084402/formula-or-vba-script-in-excel-to-display-specific-data-from-all-files-in-a-fold", "title": "Formula or VBA script in excel to display specific data from all files in a folder", "body": "<p>I am working with a Powder Flow Tester at a research company (outputs data in excel format) and need a way to summarize the data from ~2000 files [in one folder] in one excel spreadsheet. I'd like 6 pieces of data from each file. The data is in the same spot in each spreadsheet. I have tried the following, but they are too user intensive to be practical. </p>\n\n<p>1) =SUM('C:\\Users\\MYUSER\\Desktop\\PFTData[PSFChoc.XLS]0001'!$K$26)\npoor because I need to change the file name manually for each file and need to change the cell accessed for each of the six data pieces I need. </p>\n\n<p>2) =INDIRECT(\"'\" &amp; $K$3 &amp; \"'[\" &amp; A12 &amp; \"]\" &amp; $K$2 &amp; \"'!\" &amp; $K$1)\npoor because each file needs to be open for INDIRECT to work. Computer will not handle that well. Same problem as the original formula too.</p>\n\n<p>3) Tried to use the Index function, but also needed to change the file name manually for each one.</p>\n\n<p>Is there a formula that can create an array of each file name and access the six data pieces from each file? I am open to VBA solutions, but I have zero experience with VBA. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 7416484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4ded2dfe3912f01a9477f4518546ab?s=128&d=identicon&r=PG", "display_name": "GSD", "link": "https://stackoverflow.com/users/7416484/gsd"}, "is_accepted": true, "score": 1, "last_activity_date": 1504816846, "creation_date": 1504816846, "answer_id": 46104774, "question_id": 46084216, "link": "https://stackoverflow.com/questions/46084216/copy-images-only-to-a-new-workbook/46104774#46104774", "title": "Copy images only to a new workbook", "body": "<p>You need to use the chartobjects collection, loop through each chart on your data sheet and paste as picture to your pictures worksheet:</p>\n\n<pre><code>Sub CopyChartsToPics()\nDim oChart As ChartObject\n\n    ActiveWorkbook.Worksheets(\"charts\").Activate\n\n    For Each oChart In ActiveSheet.ChartObjects\n        oChart.Select\n        oChart.Copy\n        ActiveWorkbook.Worksheets(\"pictures\").Select\n        ActiveWorkbook.Worksheets(\"pictures\").Pictures.Paste\n        ActiveWorkbook.Worksheets(\"charts\").Activate\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8538120, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83f6c5baf9fb34388c68a63233b3eea8?s=128&d=identicon&r=PG&f=1", "display_name": "Amasian21", "link": "https://stackoverflow.com/users/8538120/amasian21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 46104774, "answer_count": 1, "score": 0, "last_activity_date": 1504816846, "creation_date": 1504731420, "question_id": 46084216, "link": "https://stackoverflow.com/questions/46084216/copy-images-only-to-a-new-workbook", "title": "Copy images only to a new workbook", "body": "<p>I have created code correctly which will copy a sheet from the current workbook(main) and paste it into a new workbook(wbnew). The paste will do values only to prevent formulas from transferring. I'd like to do the same with graphs I have on a sheet called \"histograms\". You can copy a graph, and paste it as a picture. How can I do this with a sheet with multiple graphs on it?</p>\n\n<pre><code>        Main.Worksheets(\"MyData\").Copy Before:=wbnew.Sheets(1)\nWith wbnew.Sheets(1).UsedRange\n    .value = .value 'converts formulas to values\nEnd With\n\n\n        Main.Worksheets(\"Histograms\").Copy Before:=wbnew.Sheets(1)\nWith wbnew.Sheets(1).UsedRange\n    .Pictures = .Pictures 'converts graphs to pictures\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 844, "user_id": 1634249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rS4ct.png?s=128&g=1", "display_name": "Afforess", "link": "https://stackoverflow.com/users/1634249/afforess"}, "edited": false, "score": 0, "creation_date": 1504733302, "post_id": 46084117, "comment_id": 79131246, "body": "The line <code>ActiveSheet.Protect True, True, True, True, True</code> locks the spreadsheet, according to the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-protect-method-excel\" rel=\"nofollow noreferrer\">Microsoft documentation</a>. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-unprotect-method-excel\" rel=\"nofollow noreferrer\">The documentation</a> also suggests <code>ActiveSheet.Unprotect</code> should unlock it, assuming no password was set."}], "answers": [{"comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1504731794, "post_id": 46084265, "comment_id": 79130601, "body": "You&#39;re a savior! Thank you so much!  I thought that&#39;s what I did too, and I tried typing it in but it must have taken it as the True flag being the password not the actual word.  I really can&#39;t thank you enough!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 5, "last_activity_date": 1504731632, "creation_date": 1504731632, "answer_id": 46084265, "question_id": 46084117, "link": "https://stackoverflow.com/questions/46084117/vba-locked-my-worksheet/46084265#46084265", "title": "VBA locked my worksheet", "body": "<p>The first parameter of <code>ActiveSheet.Protect True, True, True, True, True</code> is the password, so you have set the password to be <code>True</code>. (Note: not <code>\"True\"</code>, the actual value <code>True</code>, which you won't be able to type in from the standard unprotect dialog.).</p>\n\n<p>You can unprotect it again by executing the command</p>\n\n<pre><code>ActiveSheet.Unprotect True\n</code></pre>\n\n<p>from the Immediate Window (or you could write a small Sub to do it).</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 46084265, "answer_count": 1, "score": 1, "last_activity_date": 1504732571, "creation_date": 1504730966, "question_id": 46084117, "link": "https://stackoverflow.com/questions/46084117/vba-locked-my-worksheet", "title": "VBA locked my worksheet", "body": "<p>I tried copying some code online that I found from below link...\n<a href=\"http://www.ozgrid.com/forum/showthread.php?t=15325\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=15325</a></p>\n\n<p>And I attempted to use some code to import an image via button within my Excel Workbook and this code locked my work sheet and when it prompts for a password I tried hitting enter with no prevail...</p>\n\n<p>Code I used below</p>\n\n<pre><code>Sub BrowsePicture()\nDim Pict\nDim ImgFileFormat As String\nDim PictCell As Range\nDim Ans As Integer\n\nActiveSheet.Protect True, True, True, True, True\nImgFileFormat = \"Image Files (*.bmp),others, tif (*.tif),*.tif, jpg (*.jpg),*.jpg\"\n\nGetPict:\nPict = Application.GetOpenFilename(ImgFileFormat)\n'Note you can load in any nearly file format\nIf Pict = False Then End\n\nAns = MsgBox(\"Open : \" &amp; Pict, vbYesNo, \"Insert Picture\")\nIf Ans = vbNo Then GoTo GetPict\n\n'Now paste to userselected cell\nGetCell:\nSet PictCell = Application.InputBox(\"Select the cell to insert into\", Type:=8)\nIf PictCell.Count &gt; 1 Then MsgBox \"Select ONE cell only\": GoTo GetCell\nPictCell.Select\nActiveSheet.Pictures.Insert(Pict).Select\nEnd Sub\n</code></pre>\n\n<p>Please help! I put a lot of work into this spread sheet and I can't edit anything :(</p>\n"}, {"tags": ["vba", "combobox", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1504798583, "post_id": 46083659, "comment_id": 79162968, "body": "You want the code that adds/sizes the shapes to appear in the CHANGE event of the combobox."}], "owner": {"reputation": 11, "user_id": 8155946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad22f254c66ce1e192d39395ae958008?s=128&d=identicon&r=PG&f=1", "display_name": "arod23", "link": "https://stackoverflow.com/users/8155946/arod23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504728943, "creation_date": 1504728943, "question_id": 46083659, "link": "https://stackoverflow.com/questions/46083659/using-a-combobox-to-change-shapes-in-powerpoint-vba", "title": "Using a ComboBox to Change Shapes in Powerpoint VBA", "body": "<p>I am trying to create a ComboBox for a PowerPoint Slide that would update the shapes on the slides depending on the user's dropdown selection. So far I have the following code, but the selection of the ComboBox item isn't triggering the change of shapes. Does anyone see the flaw in my code and why it is not triggering my shape changes?</p>\n\n<pre><code>Private Sub ComboBox1_Click()\nComboBox1.Clear\n    If ComboBox1.ListCount = 0 Then\n        With ComboBox1\n                .AddItem \"Increase\", 0\n                .AddItem \"Decrease\", 1\n                .AddItem \"No Effect\", 2\n        End With\n    End If \nDim sld As Slide\nDim shp1 As Shape\nDim l1 As Single\nDim l1m As Single\nDim t1 As Single\nDim t1m As Single\n\nl1 = 3.49 * 72\nl1m = 3.32 * 72\nt1 = 5.38 * 72\nt1m = 5.42 * 72\n\n\nSet sld = Application.ActiveWindow.View.Slide\n\n    If ComboBox1.Text = \"Increase\" Then\n        Set shp1 = sld.Shapes.AddShape(msoShapeUpArrow, _\n        Left:=l1, Top:=t1, Width:=0.35 * 72, Height:=0.28 * 72)\n\n        ElseIf ComboBox1.Text = \"Decrease\" Then\n        Set shp1 = sld.Shapes.AddShape(msoShapeDownArrow _\n        , Left:=l1, Top:=t1, Width:=0.35 * 72, Height:=0.28 * 72)\n        shp1.Name = \"1\"\n\n        Else: ComboBox1.Text = \"No Effect\"\n        Set shp3 = sld.Shapes.AddShape(msoShapeMathMinus, _\n        Left:=lm1, Top:=tm1, Width:=0.71 * 72, Height:=0.31 * 72)\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1504727643, "post_id": 46083221, "comment_id": 79128542, "body": "Use this to define <code>iRow</code> instead: <code>iRow = ws.Cells(ws.Rows.Count, &quot;A&quot;).End(xlUp).Row + 1</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1504727671, "post_id": 46083221, "comment_id": 79128569, "body": "You will get that error if there&#39;s no content on the &quot;Plan4&quot; worksheet."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504729929, "post_id": 46083221, "comment_id": 79129709, "body": "what is the error that you get? what is the name of your worksheet?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1504730510, "post_id": 46083221, "comment_id": 79129987, "body": "@tigeravatar, your method only works if column A always has data when the other cells have data"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "edited": false, "score": 0, "creation_date": 1505131977, "post_id": 46083805, "comment_id": 79272511, "body": "Hello, perfo. Thanks for answering. Your code works, but it&#39;s not inserting the investment category, only its value. I would like to insert both. If you wanna check my userform style again: <a href=\"https://i.stack.imgur.com/pIzwT.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/pIzwT.png</a> Thanks!"}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "reply_to_user": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "edited": false, "score": 0, "creation_date": 1505143408, "post_id": 46083805, "comment_id": 79280307, "body": "The original question was about the error in your code. My code fixed that so you should accept my answer as correct. I didn&#39;t attempt to alter the functionality of your code , only fix the error. The question you have now should really be posted as a different question however the values in the listbox wont be transferred unless you click on one. Are you just scrolling down the list and not selecting one  before pressing the insert button ?"}, {"owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "reply_to_user": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "edited": false, "score": 0, "creation_date": 1505199222, "post_id": 46083805, "comment_id": 79301508, "body": "Thanks. Did clicking on the list item also solve your other problem? If you prefer you can have a list auto select the top item unless someone changes it. YOu can&#39;t just scroll up and down and press the insert you need to click on a list item before insert..."}], "tags": [], "owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "is_accepted": true, "score": 1, "last_activity_date": 1504729617, "creation_date": 1504729617, "answer_id": 46083805, "question_id": 46083221, "link": "https://stackoverflow.com/questions/46083221/excel-userform-error/46083805#46083805", "title": "Excel UserForm Error", "body": "<pre><code>Private Sub CommandButton1_Click()\nDim iRow As Long\nDim ws As Worksheet\nDim FoundIt As Range\n\n\nSet ws = Worksheets(\"Plan4\")\nSet FoundIt = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues)\n\nIf FoundIt Is Nothing Then\n  MsgBox (\"nothing found\")\nElse\n\n  iRow = FoundIt.Row + 1\n  ws.Cells(iRow, 1).Value = Me.ListBox1.Value\n  ws.Cells(iRow, 2).Value = Me.TextBox1.Value\n  Me.ListBox1.Value = \"\"\n  Me.TextBox1.Value = \"\"\n  Me.TextBox1.SetFocus\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The problem is, if the find function doesn't get a match it returns a nothing value and then you try to get the row number from nothing.. My code above simplifies it a bit and only tries to get the row number if it is a valid range. </p>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1504730710, "creation_date": 1504730710, "answer_id": 46084064, "question_id": 46083221, "link": "https://stackoverflow.com/questions/46083221/excel-userform-error/46084064#46084064", "title": "Excel UserForm Error", "body": "<p>you need to start search at A1, because you are searching in UP direction from there, which rolls over to bottom of sheet and keeps going up until it hits data </p>\n\n<pre><code>iRow = ws.Cells.Find(What:=\"*\", after:=ws.range(\"A1\"), SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1504765302, "creation_date": 1504765302, "answer_id": 46089188, "question_id": 46083221, "link": "https://stackoverflow.com/questions/46083221/excel-userform-error/46089188#46089188", "title": "Excel UserForm Error", "body": "<pre><code>Dim rw As Range, f As Range\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Plan4\")\nSet f = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n                      SearchDirection:=xlPrevious, LookIn:=xlValues)\n\nIf Not f Is Nothing Then \n    Set rw = f.Offset(1,0).EntireRow\nElse\n    Set rw = ws.Rows(1)\nEnd If\n\nWith rw\n    .Cells(1).Value = Me.ListBox1.Value\n    .Cells(2).Value = Me.TextBox1.Value\nEnd With\n\nMe.ListBox1.Value = \"\"\nMe.TextBox1.Value = \"\"\nMe.TextBox1.SetFocus\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8571033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZjpRDkTQ8PY/AAAAAAAAAAI/AAAAAAAAACY/vLtY_XOBIqM/photo.jpg?sz=128", "display_name": "Beatriz Gargaro", "link": "https://stackoverflow.com/users/8571033/beatriz-gargaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 46083805, "answer_count": 3, "score": 1, "last_activity_date": 1504765302, "creation_date": 1504727107, "question_id": 46083221, "link": "https://stackoverflow.com/questions/46083221/excel-userform-error", "title": "Excel UserForm Error", "body": "<p>I'm trying to write a code to Insert Project Costs on a Worksheet. I am not an Excel Expert so I am using this tutorial to guide me: \n<a href=\"https://www.youtube.com/watch?v=NO10WZ2prDQ\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=NO10WZ2prDQ</a> (it's in Portuguese, but you can see what the UserForm does within the first minute of the video)</p>\n\n<p>What I want to do is insert costs in a worksheet and then filter them to generate a report of all project costs and their categories. </p>\n\n<p>Here's my UserForm: \n<a href=\"https://i.stack.imgur.com/pIzwT.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/pIzwT.png</a></p>\n\n<p>When coding for the Insert Button ('Inserir Custo'), here's what I typed:</p>\n\n<pre><code>Dim iRow As Long\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Plan4\")\n\niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nws.Cells(iRow, 1).Value = Me.ListBox1.Value\n\nws.Cells(iRow, 2).Value = Me.TextBox1.Value\n\nMe.ListBox1.Value = \"\"\nMe.TextBox1.Value = \"\"\nMe.TextBox1.SetFocus\n</code></pre>\n\n<p>Excel shows an error on the iRow line of the code, but I dont know whats wrong. When clicking that button, I want the code to insert the results of the ListBox1 in a cell, and the TextBox1 in another cell, next to it. </p>\n\n<p>Can someone help me? What did I write wrong?</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["arrays", "excel", "vba", "function"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1504727715, "post_id": 46083100, "comment_id": 79128594, "body": "Your function is named <code>FillSpotArray</code> but in your test Sub you are calling <code>FillTimeArray</code>..."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1504731327, "post_id": 46083100, "comment_id": 79130393, "body": "<i>I want it filled with two values. one for each coordinate of a list of cells</i> Does that mean that there are exactly 2 values, or are there 2 values for each coordinate? Also <code>Format(i + 2, j + 1)</code> only can be wrong =&gt; <code>Format(0 + 2, 0 + 1) = Format(2, 1)</code> and <code>1</code> is not a valid formatting... please make sure you know what <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\"><code>Format()</code></a> is doing. (You may be looking for <code>Array(i + 2, j + 1)</code>... )"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1504727878, "creation_date": 1504727878, "answer_id": 46083391, "question_id": 46083100, "link": "https://stackoverflow.com/questions/46083100/how-to-declare-and-fill-a-two-dimensional-array-with-a-function-vba/46083391#46083391", "title": "How to declare and fill a two dimensional array with a function vba", "body": "<p>You have not dimensioned your array:</p>\n\n<pre><code>Sub Start_Click()\n    Dim arTime(23, 11) As Integer\n    arTime = FillTimeArray(arTime)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1504728213, "creation_date": 1504728213, "answer_id": 46083468, "question_id": 46083100, "link": "https://stackoverflow.com/questions/46083100/how-to-declare-and-fill-a-two-dimensional-array-with-a-function-vba/46083468#46083468", "title": "How to declare and fill a two dimensional array with a function vba", "body": "<p>You need to Dim you array, call the function correctly, and return the output correctly in the function    </p>\n\n<pre><code>Sub Start_Click()\n    Dim arTime As Variant\n    arTime = FillSpotArray()\nEnd Sub\n\n\n'This is used to fill the array with a list of 12 columns that are 24 rows long\n'They are offsetted intentionally\n\nFunction FillSpotArray() As Integer()\n    Dim arr(23, 11) As Integer\n    For j = 0 To 11\n        For i = 0 To 23\n            arr(i, j) = Format(i + 2, j + 1)\n        Next i\n    Next j\n    FillSpotArray = arr\nEnd Function\n</code></pre>\n\n<p>I'm not entirely sure of your use of <code>Format</code> here though</p>\n"}], "owner": {"reputation": 19, "user_id": 4595378, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97cefa9c5d6c34a06b6811551eb18369?s=128&d=identicon&r=PG&f=1", "display_name": "MTB", "link": "https://stackoverflow.com/users/4595378/mtb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2269, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504728213, "creation_date": 1504726697, "question_id": 46083100, "link": "https://stackoverflow.com/questions/46083100/how-to-declare-and-fill-a-two-dimensional-array-with-a-function-vba", "title": "How to declare and fill a two dimensional array with a function vba", "body": "<p>I have an array that is declared within a subroutine. I want it filled with two values. one for each coordinate of a list of cells. I know that this isn't always the best way to do this, but for reasons involving the rest of my program, I need to do it exactly this way. </p>\n\n<pre><code>'This sub contains more, I've just included only the relevant stuff\n    Sub Start_Click()\n        Dim arTime() As Integer\n        arTime = FillTimeArray(arTime)\n    End Sub\n\n\n'This is used to fill the array with a list of 12 columns that are 24 rows long\n'They are offsetted intentionally\n\n    Function FillSpotArray(ByRef arr() As Integer) As Integer()\n        For j = 0 To 11\n            For i = 0 To 23\n                arr(i, j) = Format(i + 2, j + 1)\n            Next i\n        Next j\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 1, "creation_date": 1504724711, "post_id": 46082575, "comment_id": 79127065, "body": "The issue in your code block was <code>cell</code> iterates to have different values in <code>NameRng</code>.But for all the values <code>NameRng.Value</code> will always point to the first value, thus printing same Name for all rows."}, {"owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504726949, "post_id": 46082575, "comment_id": 79128210, "body": "I really appreciate the help! That works great for returning the employee name, but it is still not returning the employee ID."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 1, "creation_date": 1504727078, "post_id": 46082575, "comment_id": 79128273, "body": "Note you should do <code>EmpID = IDRng.Cells(i,1)</code> and not <code>EmpID = IDRng.Value</code>"}, {"owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504727297, "post_id": 46082575, "comment_id": 79128387, "body": "Thanks.  I am using the code copied from your revision and it still isn&#39;t returning the ID.  Should the NameRng be changed to A2:B10 instead of treating NameRng and IDRng as separate ranges?"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504727426, "post_id": 46082575, "comment_id": 79128443, "body": "@JustinHill can you upload the workbook for me to take a look?"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504727607, "post_id": 46082575, "comment_id": 79128520, "body": "One check I would do is replace <code>MsgBox &quot;Next&quot;</code> with <code>MsgBox EmpName&amp;EmpID</code>. This would help in checking if the iterations are working fine."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504727783, "post_id": 46082575, "comment_id": 79128636, "body": "Also I made a small edit to make the code a little more safer, by using <code>.Value</code> on Range object."}], "tags": [], "owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "is_accepted": false, "score": 2, "last_activity_date": 1504729066, "last_edit_date": 1504729066, "creation_date": 1504724571, "answer_id": 46082575, "question_id": 46082444, "link": "https://stackoverflow.com/questions/46082444/vba-return-next-value-from-for-loop/46082575#46082575", "title": "VBA return next value from for loop", "body": "<pre><code>   For Each cell In NameRng\n        EmpName = NameRng.Value\n        EmpID = IDRng.Value\n        ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n            IgnorePrintAreas:=False\n        MsgBox \"Next\"\n    Next cell\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>   For nRow = 1 to NameRng.Count\n        EmpName.Value = NameRng.Cells(nRow,1).Value\n        EmpID.Value = IDRng.Cells(nRow,1).Value\n        ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n            IgnorePrintAreas:=False\n        MsgBox \"Next\"\n    Next nRow\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1504725628, "post_id": 46082626, "comment_id": 79127527, "body": "in your case <code>IDRng.Value</code> would always point to the ID in first row?"}, {"owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504726834, "post_id": 46082626, "comment_id": 79128143, "body": "I really appreciate the help! That works great for returning the employee name, but it is still not returning the employee ID."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 1, "creation_date": 1504727152, "post_id": 46082626, "comment_id": 79128317, "body": "Oh, that&#39;s my mistake.  I&#39;ll edit it to add the <code>offset</code> to move over one column"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504727319, "post_id": 46082626, "comment_id": 79128393, "body": "I accidentally edit your question.  Sorry about that.  I don&#39;t think that I can roll it back."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1504727679, "post_id": 46082626, "comment_id": 79128574, "body": "That&#39;s not a problem at all!  It&#39;s written better now."}, {"owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "edited": false, "score": 0, "creation_date": 1504728946, "post_id": 46082626, "comment_id": 79129206, "body": "One last thing...if I want the range to be dynamic, so employees can be added, what would I replace &quot;Range(&quot;Employees!A2:Employees!A10&quot;)&quot; with?"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 1, "creation_date": 1504729732, "post_id": 46082626, "comment_id": 79129594, "body": "<code>Range(&quot;c1&quot;, Range(&quot;c1&quot;).End(xlDown))</code> this does the same thing as clicking <code>ctrl + down arrow</code> in VBA.  You just have to make sure that there aren&#39;t any skips in the column, or it will stop at the first skip."}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": true, "score": 1, "last_activity_date": 1504727217, "last_edit_date": 1504727217, "creation_date": 1504724764, "answer_id": 46082626, "question_id": 46082444, "link": "https://stackoverflow.com/questions/46082444/vba-return-next-value-from-for-loop/46082626#46082626", "title": "VBA return next value from for loop", "body": "<p>This should only require one simple fix.  Change <code>EmpName = NameRng.Value</code> to <code>EmpName = cell.Value</code> you are looping through <code>cell</code> up to <code>NameRng</code>, not looping through <code>NameRng</code>.</p>\n\n<pre><code>Sub btn_CompleteForm()\n    Dim Rng As Range, cell As Range, EmpName As Range\n    With Worksheets(\"ActionNotice\")\n        For Each cell In Range(\"Employees!A2:Employees!A10\")\n            .Range(\"D7\") = cell.value                 'Name\n            .Range(\"D8\") = cell.Offset(0, 1).value    'ID\n            ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n                                                 IgnorePrintAreas:=False\n            MsgBox \"Next\"\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 134, "user_id": 6835447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/625471f9507c88697728fc4b9611c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Hill", "link": "https://stackoverflow.com/users/6835447/justin-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 46082626, "answer_count": 2, "score": 0, "last_activity_date": 1504729066, "creation_date": 1504724052, "last_edit_date": 1504726404, "question_id": 46082444, "link": "https://stackoverflow.com/questions/46082444/vba-return-next-value-from-for-loop", "title": "VBA return next value from for loop", "body": "<p>I need to populate a cell with each value from a <code>For</code> loop.  I have a worksheet with Employee Names and Employee IDs.  I am attempting to populate cells on another worksheet and print to default printer (or PDF preferred), then do the same for the next employee in the list.</p>\n\n<p>Any help is greatly appreciated.  What I currently have only returns the first employee name and no ID.</p>\n\n<pre><code>Sub btn_CompleteForm()\n\nDim Rng As Range, cell As Range, EmpName As Range\nSet NameRng = Range(\"Employees!A2:Employees!A10\")\nSet IDRng = Range(\"Employees!B2:Employees!B10\")\nSet EmpName = Range(\"ActionNotice!D7\")\nSet EmpID = Range(\"ActionNotice!D8\")\n\nFor Each cell In NameRng\n    EmpName = NameRng.Value\n    EmpID = IDRng.Value\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\n    MsgBox \"Next\"\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504723847, "post_id": 46082332, "comment_id": 79126594, "body": "Are you trying to close an excel application that has been opened from within Access, or one that has been opened by the user?"}, {"owner": {"reputation": 77, "user_id": 5190518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991e1c6710d3cbbd5c4e3e99e30b3ed3?s=128&d=identicon&r=PG&f=1", "display_name": "SQLnRprobs", "link": "https://stackoverflow.com/users/5190518/sqlnrprobs"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504723904, "post_id": 46082332, "comment_id": 79126621, "body": "Opened by the user"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5190518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991e1c6710d3cbbd5c4e3e99e30b3ed3?s=128&d=identicon&r=PG&f=1", "display_name": "SQLnRprobs", "link": "https://stackoverflow.com/users/5190518/sqlnrprobs"}, "edited": false, "score": 0, "creation_date": 1504724435, "post_id": 46082446, "comment_id": 79126926, "body": "What if I only want to close one specific file?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 77, "user_id": 5190518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991e1c6710d3cbbd5c4e3e99e30b3ed3?s=128&d=identicon&r=PG&f=1", "display_name": "SQLnRprobs", "link": "https://stackoverflow.com/users/5190518/sqlnrprobs"}, "edited": false, "score": 0, "creation_date": 1504724853, "post_id": 46082446, "comment_id": 79127132, "body": "That is a really complex question, and I doubt it can be done properly. Closing Excel applications you didn&#39;t open through Access already isn&#39;t easy."}, {"owner": {"reputation": 77, "user_id": 5190518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991e1c6710d3cbbd5c4e3e99e30b3ed3?s=128&d=identicon&r=PG&f=1", "display_name": "SQLnRprobs", "link": "https://stackoverflow.com/users/5190518/sqlnrprobs"}, "edited": false, "score": 0, "creation_date": 1504725051, "post_id": 46082446, "comment_id": 79127235, "body": "Thanks for the help, I am just going to add a message box telling people to close the file if they have it open at the beginning of the process."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 77, "user_id": 5190518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991e1c6710d3cbbd5c4e3e99e30b3ed3?s=128&d=identicon&r=PG&f=1", "display_name": "SQLnRprobs", "link": "https://stackoverflow.com/users/5190518/sqlnrprobs"}, "edited": false, "score": 0, "creation_date": 1504727097, "post_id": 46082446, "comment_id": 79128280, "body": "See the current edit to close one specific workbook (I said it was more complex, didn&#39;t I?)"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1504727053, "last_edit_date": 1504727053, "creation_date": 1504724060, "answer_id": 46082446, "question_id": 46082332, "link": "https://stackoverflow.com/questions/46082332/close-specific-excel-file-opened-by-user-from-access-vba/46082446#46082446", "title": "Close specific Excel file opened by user from Access-VBA", "body": "<p>You can use the following code to close all Excel files (already posted <a href=\"https://stackoverflow.com/questions/45071752/run-a-macro-with-embedded-excel-sheet-in-access/45072192#45072192\">here</a>): \n    </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub CloseAllExcel()\n    Dim obj As Object\n    On Error GoTo ExitSub\n    Dim i As Integer\n    'There shouldn't be more than 10000 running Excel applications\n    'Can use While True too, but small risk of infinite loop\n    For i = 0 To 10000\n        Set obj = GetObject(, \"Excel.Application\")\n        obj.Quit\n    Next i\nExitSub:\nEnd Sub\n</code></pre>\n\n<p>But if we're going to close one specific one, we need some Win32 magic that I can't do, but hey, if you can't do something, you can find it on StackOverflow.\nMost code by Florent B found <a href=\"https://stackoverflow.com/questions/30363748/having-multiple-excel-instances-launched-how-can-i-get-the-application-object-f\">here</a></p>\n\n<p>First, declare our Win32 functions</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>#If VBA7 Then\n  Private Declare PtrSafe Function AccessibleObjectFromWindow Lib \"oleacc\" ( _\n    ByVal hwnd As LongPtr, ByVal dwId As Long, riid As Any, ppvObject As Object) As Long\n\n  Private Declare PtrSafe Function FindWindowExA Lib \"user32\" ( _\n    ByVal hwndParent As LongPtr, ByVal hwndChildAfter As LongPtr, _\n    ByVal lpszClass As String, ByVal lpszWindow As String) As LongPtr\n#Else\n  Private Declare Function AccessibleObjectFromWindow Lib \"oleacc\" ( _\n    ByVal hwnd As Long, ByVal dwId As Long, riid As Any, ppvObject As Object) As Long\n\n  Private Declare Function FindWindowExA Lib \"user32\" ( _\n    ByVal hwndParent As Long, ByVal hwndChildAfter As Long, _\n    ByVal lpszClass As String, ByVal lpszWindow As String) As Long\n#End If\n</code></pre>\n\n<p>Then use them to get all running Excel application objects</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetExcelInstances() As Collection\n  Dim guid&amp;(0 To 3), acc As Object, hwnd, hwnd2, hwnd3\n  guid(0) = &amp;H20400\n  guid(1) = &amp;H0\n  guid(2) = &amp;HC0\n  guid(3) = &amp;H46000000\n\n  Set GetExcelInstances = New Collection\n  Do\n    hwnd = FindWindowExA(0, hwnd, \"XLMAIN\", vbNullString)\n    If hwnd = 0 Then Exit Do\n    hwnd2 = FindWindowExA(hwnd, 0, \"XLDESK\", vbNullString)\n    hwnd3 = FindWindowExA(hwnd2, 0, \"EXCEL7\", vbNullString)\n    If AccessibleObjectFromWindow(hwnd3, &amp;HFFFFFFF0, guid(0), acc) = 0 Then\n      GetExcelInstances.Add acc.Application\n    End If\n  Loop\nEnd Function\n</code></pre>\n\n<p>And then use that collection so we can check which one has the workbook open, and close it</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub closeWorkbook(workbookPath As String)\n    Dim excelInstances As Collection\n    Set excelInstances = GetExcelInstances\n    Dim excelApp As Object\n    Dim excelWorkbook As Object\n    For Each excelApp In excelInstances\n        For Each excelWorkbook In excelApp.Workbooks\n            If excelWorkbook.FullName = workbookPath Then\n                excelWorkbook.Close False\n            End If\n        Next excelWorkbook\n        If excelApp.Workbooks.Count = 0 Then\n            excelApp.Quit\n        End If\n    Next excelApp\nEnd Sub\n</code></pre>\n\n<p>And then, implement that close function</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Path1 as String\nPath1 = \"C:/.....\"\ncloseWorkbook Path1\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5190518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/991e1c6710d3cbbd5c4e3e99e30b3ed3?s=128&d=identicon&r=PG&f=1", "display_name": "SQLnRprobs", "link": "https://stackoverflow.com/users/5190518/sqlnrprobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504727431, "creation_date": 1504723617, "last_edit_date": 1504727431, "question_id": 46082332, "link": "https://stackoverflow.com/questions/46082332/close-specific-excel-file-opened-by-user-from-access-vba", "title": "Close specific Excel file opened by user from Access-VBA", "body": "<p>I see version of how to do this with </p>\n\n<pre><code>Dim ran as Excel.Applcation \n</code></pre>\n\n<p>but the version of Access I am using doesn't have Excel.Application as an option.</p>\n\n<p>I have written the following code that runs, but does not close the file</p>\n\n<pre><code>Dim Path1 as String\nDim objXL As Object\nDim xlWB As Object\nPath1 = \"C:/.....\"\nSet objXL = CreateObject(\"Excel.Application\")\nSet xlWB = objXL.Workbooks.Open(Path1)\n\n\nxlWB.Close False\nSet xlWB = Nothing\nobjXL.Quit\nSet objXL = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1504723433, "post_id": 46082136, "comment_id": 79126382, "body": "In your first example clearing the <code>On Error Resume Next</code> in <code>OpenFile</code> using <code>On Error Goto 0</code> will not affect the error handling in your calling Sub."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1504723857, "post_id": 46082136, "comment_id": 79126599, "body": "<a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/errorhandling.htm</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504724040, "post_id": 46082136, "comment_id": 79126702, "body": "In the second example remove the <code>On Error GoTo MainErrorHandler</code>: any error you Raise inside <code>SubErrorHandler</code> will be passed back to the calling sub."}, {"owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504724127, "post_id": 46082136, "comment_id": 79126742, "body": "I see it now:  &quot;However, if the procedure in which the error occurs does not have an error handler, VBA looks backwards through the procedure calls which lead to the erroneous code. For example if procedure A calls B and B calls C, and A is the only procedure with an error handler, if an error occurs in procedure C, code execution is immediately transferred to the error handler in procedure A, skipping the remaining code in B.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "edited": false, "score": 1, "creation_date": 1504729847, "post_id": 46083641, "comment_id": 79129649, "body": "Great explanation, and nice suggestion for enum use.  One thing I would point out  for those reading this later, when resetting error handing after temporality turning on/off OERN in the same function as the Error Handler, you do need to call On Error Goto ErrorHandler instead of On Error Goto 0."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "edited": false, "score": 1, "creation_date": 1504729992, "post_id": 46083641, "comment_id": 79129741, "body": "@CassieD thanks! also note <code>Err.Raise Err.Number</code> is all you need to rethrow an error =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1504728870, "creation_date": 1504728870, "answer_id": 46083641, "question_id": 46082136, "link": "https://stackoverflow.com/questions/46082136/how-to-resume-error-handling-from-the-calling-function-while-in-a-subfunction-in/46083641#46083641", "title": "How to resume error handling from the calling function while in a subfunction in VBA?", "body": "<p>Labels are always local.</p>\n\n<p><code>On Error</code> is always local too - heck, its deprecated ancestor was <code>On Local Error</code>!</p>\n\n<p>So you can't <code>GoTo</code>-jump between procedure scopes (THANK GOD!!)</p>\n\n<p>This means at any given time, there's only ever one of two things the run-time can do <code>On Error</code>:</p>\n\n<ul>\n<li>Jump to a local error handler</li>\n<li>Blow up the current stack frame and see if the caller handles it</li>\n<li>[ignore the error and happily keep running blindfolded under blue skies and sunshine]</li>\n</ul>\n\n<p>That third point, you guessed it, is what <code>On Error Resume Next</code> does.</p>\n\n<p>One critical error you've done, is specifying an <code>On Error</code> statement <em>inside an error-handling subroutine</em>, and the error-handling subroutine runs regardless of whether you're in an error state or not. That makes following execution extremely confusing, even if that label was legal. <code>Exit Sub</code> or <code>Exit Function</code> (or heck, <code>Exit Property</code>, depending on what's your scope) <em>before</em> the handler, and make sure error-handling code is only ever hit <em>in an error state</em>.</p>\n\n<h3>Resetting error handling</h3>\n\n<p>So, one thing you want to do, is to <em>reset</em> error handling - here:</p>\n\n<pre><code>On Error Resume Next\nSet objFile = objFSO.OpenTextFile(fileLocation &amp; fileName, 1)\nOn Error GoTo ErrorHandler ' Label Not Defined!\n</code></pre>\n\n<p>You know <code>objFSO.OpenTextFile</code> can possibly blow up, and you want to handle it yourself, i.e. deal with the <code>objFile Is Nothing</code> possibiilty manually. You can absolutely do that, but then what you need is this:</p>\n\n<pre><code>On Error Resume Next\nSet objFile = objFSO.OpenTextFile(fileLocation &amp; fileName, 1)\nOn Error GoTo 0\n</code></pre>\n\n<p><code>On Error GoTo 0</code> resets error handling, i.e. the next instruction to throw an error <em>will</em> bubble up the call stack, until everything goes up in flames.</p>\n\n<h3>Custom Errors</h3>\n\n<p>The next thing you want to do, is to raise custom errors.</p>\n\n<blockquote>\n<pre><code>If isReallyBad Then\n    Call Err.Raise(2020, , \"Error that needs to cause application to exit!\")\nElse\n    Call Err.Raise(2001, , \"Error that just needs the function to exit!\")\nEnd If\n</code></pre>\n</blockquote>\n\n<p>That's pretty easy actually - but it's easier with an <code>Enum</code>:</p>\n\n<pre><code>Public Enum AppCustomError\n    ERR_ReallyBad = vbObjectError + 42\n    ERR_ReallyReallyBad\n    ERR_VeryReallyTerriblyBad\n    ERR_YouGetTheIdea\nEnd Enum\n</code></pre>\n\n<p>The <code>vbObjectError</code> constant ensures that your custom error numbering doesn't step on toes; your error numbers will all be negative - and with an <code>Enum</code> for each possible error you can throw, you don't need to care what the actual error number is, so you let the enum member mechanics do their thing (e.g. <code>ERR_ReallyReallyBad</code> will be <code>ERR_ReallyBad + 1</code>, automatically).</p>\n\n<p>Then you can do this (assuming you're in a class module - otherwise replace <code>TypeName(Me)</code> with some string literal, or skip it):</p>\n\n<pre><code>    On Error GoTo ErrHandler\n    If isReallyBad Then\n        Err.Raise ERR_VeryReallyTerriblyBad, TypeName(Me), \"Blow up the app!\"\n    Else\n        Err.Raise ERR_ReallyBad, TypeName(Me), \"Blow up this function!\"\n    End If\n    Exit Sub\nErrHandler:\n    With Err\n        Select Case .Number\n            Case ERR_VeryReallyTerriblyBad\n                .Raise .Number 'rethrow\n            Case ERR_ReallyBad\n                'function blew up, we're done here.\n            '...\n        End Select\n    End With\n</code></pre>\n\n<p>And then the calling code, which has its own error-handling subroutine, can decide that it can't deal with <code>ERR_VeryReallyTerriblyBad</code>, and just blow everything up by rethrowing:</p>\n\n<pre><code>    Exit Sub\nMainErrorHandler:\n    With Err\n        Select Case .Number\n            Case ERR_VeryReallyTerriblyBad\n                .Raise .Number 'rethrow\n            Case Else\n                MsgBox .Description\n        End Select\n    End With\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1277, "favorite_count": 0, "accepted_answer_id": 46083641, "answer_count": 1, "score": 2, "last_activity_date": 1504728870, "creation_date": 1504722818, "last_edit_date": 1531164843, "question_id": 46082136, "link": "https://stackoverflow.com/questions/46082136/how-to-resume-error-handling-from-the-calling-function-while-in-a-subfunction-in", "title": "How to resume error handling from the calling function while in a subfunction in VBA?", "body": "<p>When I write in VBA for Word or Excel, I typically have an error handler in my main function and call several subs from it, and most of the time, I want subs' messages to get caught in the main function. Typically everything works great with this strategy, and it mimics what I'm used to in C++. </p>\n\n<p>However, I run into trouble when I need a different type of error handling in one or two subs.</p>\n\n<p>For example, when I need to turn on <code>Resume Next</code> for the sake of checking if an object fails and is set to nothing. When I want to turn error handling on, my <code>MainErrorHandler</code> is now out of scope.</p>\n\n<pre><code>Sub Main()\n    On Error GoTo MainErrorHandler\n\n    Application.ScreenUpdating = False\n    Call OpenFile\n    Call SubWithOwnErrorHandling\n\n    'Do more stuff\n\n    GoTo CleanExit\n\nMainErrorHandler:\n    MsgBox Err.Description\n\nCleanExit:\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub OpenFile()\n\n    On Error Resume Next\n        Set objFile = objFSO.OpenTextFile(fileLocation &amp; fileName, 1)\n    On Error GoTo ErrorHandler ' Label Not Defined!\n\n    If objFile Is Nothing Then\n        Call Err.Raise(2009, , \"Out File doesn\u2019t exist.\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>Likewise, when I want to have a sub handle errors locally and occasionally elevate an error, I'm not sure how exactly to do that.</p>\n\n<pre><code>Sub SubWithOwnErrorHandling()\n    On Error GoTo SubErrorHandler\n\n    isReallyBad = True\n\n    If isReallyBad Then\n        Call Err.Raise(2020, , \"Error that needs to cause application to exit!\")\n    Else\n        Call Err.Raise(2001, , \"Error that just needs the function to exit!\")\n    End If\n\nSubErrorHandler:\n    On Error GoTo MainErrorHandler ' Label Not Defined!\n\n    If Err.Number = 2020 Then\n        Call Err.Raise(2020, , Err.Description)\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Is there any way to do what I'm trying to accomplish for either case?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1504725877, "post_id": 46081815, "comment_id": 79127664, "body": "shouldn&#39;t INDEKS be INDEX?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1504725955, "post_id": 46081815, "comment_id": 79127709, "body": "What are you actually trying to achieve? Your reference to B3 is probably making it a relative reference hence the extra row."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1504726216, "post_id": 46081815, "comment_id": 79127826, "body": "Delete the 0 in A1180 and your code should be fine, ofcourse along with @Sorceri &#39;s suggestion."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1504726411, "post_id": 46081815, "comment_id": 79127931, "body": "Also agree with @danieltakeshi"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1504726457, "post_id": 46081815, "comment_id": 79127956, "body": "@Sorceri INDEKS is INDEX on his excel language version, and the result #I/T is #N/A. Now i am wondering if <code>MATCH</code> is right. VBA&#39;s language is english, however, the Excel formula language is according to the language purchased. My excel is in portuguese, so i have to translate to english every time i want to make a SO question"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1504728912, "post_id": 46081815, "comment_id": 79129188, "body": "I can&#39;t see how you don&#39;t get an error on the <code>.Cells(1, Columns.Count)</code>.  That is pointing to the cell on row 3 which is one column beyond the rightmost column of the active sheet.  Are you sure that isn&#39;t just <code>Cells(1, Columns.Count)</code> (i.e. without the leading <code>.</code>) in your code?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504729705, "post_id": 46081815, "comment_id": 79129578, "body": "And isn&#39;t your code generating the formula to <b>two</b> rows below the last row, and one column beyond the last column??  (The offset by <code>B3</code> should be two rows one column more than the same range from <code>A1</code>.)"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1504731107, "creation_date": 1504731107, "answer_id": 46084146, "question_id": 46081815, "link": "https://stackoverflow.com/questions/46081815/target-formula-vba/46084146#46084146", "title": "Target formula VBA", "body": "<p>Consider that</p>\n\n<pre><code>Worksheets(\"Sheet3\").Range(\"B3\").Range(\"A1\")\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code>Worksheets(\"Sheet3\").Range(\"B3\")\n</code></pre>\n\n<p>and that</p>\n\n<pre><code>Worksheets(\"Sheet3\").Range(\"B3\").Range(\"C5:D10\")\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code>Worksheets(\"Sheet3\").Range(\"D7:E12\")\n</code></pre>\n\n<hr>\n\n<p>Your </p>\n\n<pre><code>With Worksheets(\"Sheet3\").Range(\"B3\")\n    Set Target = .Range(...)\nEnd With\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>Set Target = Worksheets(\"Sheet3\").Range(\"B3\").Range(...)\n</code></pre>\n\n<p>which is why you are not setting it to the area you think you should be.</p>\n\n<hr>\n\n<p>But I have no idea why <code>Worksheets(\"Sheet3\").Range(\"B3\").Cells(1, ActiveSheet.Columns.Count)</code> (the expanded equivalent of <code>.Cells(1, Columns.Count)</code> in your code) is not crashing out, as that is (assuming Sheet3 is active) equivalent to <code>Cells(2 + 1, 1 + Columns.Count)</code> which will give a 1004 error due to referencing a column beyond the right-hand limit.  (And does give that error when I try to run your code.)</p>\n\n<p>And I also have no idea why your code is filling in column B to the last row (but no other columns after B) and is then inserting one extra line (not two) below that which does extend beyond column B.</p>\n"}], "owner": {"reputation": 369, "user_id": 5595128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207810805730539/picture?type=large", "display_name": "Mikkel Astrup", "link": "https://stackoverflow.com/users/5595128/mikkel-astrup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504731107, "creation_date": 1504721564, "last_edit_date": 1504725584, "question_id": 46081815, "link": "https://stackoverflow.com/questions/46081815/target-formula-vba", "title": "Target formula VBA", "body": "<p>I'm running VBA to fill in all cells using last row last col. But my VBA fills in from B3 and until last row, and then adds a line below the last row and fills in to last col.</p>\n\n<p>The code looks like this: </p>\n\n<pre><code>Sub RUNFILL()\nWith Worksheets(\"Sheet3\").Range(\"B3\")\n    Set Target = .Range(.Cells(1, Columns.Count).End(xlToLeft), Cells(Rows.Count, \"A\").End(xlUp))\n    Target.FormulaLocal = \"=INDEKS(Sheet1!$N:$N;MATCH(Sheet3!$A:$A&amp;Sheet3!B$1;Sheet1!$R:$R;0))\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I'm not sure why it fills in that way, so I'm hoping that someone can see the problem and help me correct it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/54bip.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/54bip.png\" alt=\"Image of the problem\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504718657, "post_id": 46080985, "comment_id": 79123776, "body": "Pls refresh the page to i updated the expected output. because i uploaded the wrong picture"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504719551, "post_id": 46080985, "comment_id": 79124243, "body": "The second textbox also takes into account the values of your first list. Best to put those in column 3 and 4 instead of below each other."}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504720082, "post_id": 46080985, "comment_id": 79124570, "body": "You mean sir you&#39;re suggesting to append those data column per column each word that is splitted not rows by rows?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504720317, "post_id": 46080985, "comment_id": 79124690, "body": "No. Put the data from textbox 1 to column 1 and 2. Put data from textbox 2 to column 3 and 4."}], "answers": [{"comments": [{"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504721947, "post_id": 46081717, "comment_id": 79125595, "body": "i tried sir it works if i type something like this: <code>financial financial</code> the no duplicated word displays the (1) financial only and the <code>with duplicated word</code> displays <code>financial financial</code> but if i enter something like this <code>my real problem is location because the location</code> it also displays same value as this. the other duplicated word which is the location displays too in column no duplicated"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 1, "creation_date": 1504722744, "post_id": 46081717, "comment_id": 79125996, "body": "I&#39;ve updated it - this now returns <code>my real problem is location because the</code> Is that what&#39;s expected?"}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504723175, "post_id": 46081717, "comment_id": 79126244, "body": "Sir tom it works as i expected. This is what i need. Thankyou sir. The reason why i want to keep once only the duplicated word is that i am avoiding the inaccurate counting of most occurence word based on the splitted text that is why i need this kind of output. To eliminate the duplicated word and keep once only. Yes sir this is the answer :) thankyou"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1504722696, "last_edit_date": 1504722696, "creation_date": 1504721244, "answer_id": 46081717, "question_id": 46080985, "link": "https://stackoverflow.com/questions/46080985/split-text-and-save-to-different-fieldsno-duplicate-with-duplicate-using-arra/46081717#46081717", "title": "Split text and save to different fields(No duplicate, With Duplicate) Using Array in Excel VBA", "body": "<p>Try using this instead. Your vba is looping through the entire range. Where as what I think you want to do is loop through only</p>\n\n<pre><code>Sub SplitText()\n    Dim WArray As Variant\n    Dim TextString As String\n    Dim col_no_dup As Long\n    Dim col_dup As Long\n    Dim counter As Boolean\n    Dim sht_database As Worksheet\n\n    With ThisWorkbook\n        Set sht_database = .Sheets(\"Duplication\")\n        TextString = LCase(sht_database.OLEObjects(\"TextBox1\").Object.Text)\n    End With\n\n    WArray = Split(TextString, \" \") 'load array\n\n    If (TextString = \"\") Then\n        MsgBox (\"Error: Pls Enter your data\")\n        End\n    End If\n\n    'set column locations for duplicates/no duplicates\n    col_no_dup = 1\n    col_dup = 2\n\n     With sht_database\n        'Print whole array into duplicates column\n        .Cells(Cells.Rows.Count, col_dup).End(xlUp).Offset(1, 0).Resize(UBound(WArray) + IIf(LBound(WArray) = 0, 1, 0)) = Application.Transpose(WArray)\n        lrow_no_dup = .Cells(.Rows.Count, col_no_dup).End(xlUp).Row + 1\n        'Loop through array\n        For i = LBound(WArray) To UBound(WArray)\n            counter = False\n            For n = lrow_no_dup To lrow_no_dup + UBound(WArray) 'loop through and check each existing value in the no dup column\n                If .Cells(n, col_no_dup).Value = WArray(i) Then\n                    counter = True 'account for each occurence\n                    Exit For\n                End If\n            Next n\n            If counter = False Then 'counter = 0 implies the value doesn't exist in the \"No Duplicates\" column\n                .Cells(lrow_no_dup + j, col_no_dup).Value = WArray(i)\n                j = j + 1\n            End If\n        Next i\n    End With\n\n    MsgBox (\"Successfully inserted\")\n\nEnd Sub\nPrivate Sub CommandButton1_Click()\n    Call SplitText\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504723730, "post_id": 46082328, "comment_id": 79126518, "body": "This is also very helpful answer with margins to identify per inputs thankyou sir thomas :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504723892, "post_id": 46082328, "comment_id": 79126616, "body": "I think that it would be better if you had the No Duplicated Word  data start on the same row as the With Duplicated Word data."}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504724172, "post_id": 46082328, "comment_id": 79126767, "body": "hmm what lines should i remove in the codes to do that sir ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1504724643, "post_id": 46082328, "comment_id": 79127030, "body": "I modified my code to give you the option of lining up the entries."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1504724612, "last_edit_date": 1504724612, "creation_date": 1504723600, "answer_id": 46082328, "question_id": 46080985, "link": "https://stackoverflow.com/questions/46080985/split-text-and-save-to-different-fieldsno-duplicate-with-duplicate-using-arra/46082328#46082328", "title": "Split text and save to different fields(No duplicate, With Duplicate) Using Array in Excel VBA", "body": "<p>Arraylist and Dictionaries are ideal when trying to remove duplicates.  </p>\n\n<h2><a href=\"https://i.stack.imgur.com/DX5x4.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DX5x4.gif\" alt=\"enter image description here\"></a></h2>\n\n<pre><code>Sub SplitText()\n    Dim LineUpEntries As Boolean\n    Dim TextString As String\n    Dim v As Variant\n    Dim listDups As Object, listNoDups As Object\n    Set listDups = CreateObject(\"System.Collections.Arraylist\")\n    Set listNoDups = CreateObject(\"System.Collections.Arraylist\")\n\n    'You need to adjust the Worksheet's name\n    TextString = LCase(ThisWorkbook.Sheets(\"Split\").TextBox1.value)\n\n    For Each v In Split(TextString, \" \")\n        listDups.Add v\n        If Not listNoDups.Contains(v) Then\n            listNoDups.Add v\n        End If\n    Next\n\n    'LineUpEntries = True 'Uncomment this line to line up the entries\n    With ThisWorkbook.Sheets(\"Duplication\")\n        If LineUpEntries Then\n            With .Cells(.Rows.Count, 2).End(xlUp).Offset(1, -1).Resize(listNoDups.Count)\n                .value = Application.Transpose(listNoDups.ToArray)\n                FormatRange .Cells\n            End With\n        Else\n            With .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Resize(listNoDups.Count)\n                .value = Application.Transpose(listNoDups.ToArray)\n                FormatRange .Cells\n            End With\n        End If\n        With .Cells(.Rows.Count, 2).End(xlUp).Offset(1).Resize(listDups.Count)\n            .value = Application.Transpose(listDups.ToArray)\n            FormatRange .Cells\n        End With\n    End With\n\nEnd Sub\n\nSub FormatRange(Target As Range)\n    With Target\n        With .Borders(xlEdgeLeft)\n            .LineStyle = xlContinuous\n            .ColorIndex = 0\n            .TintAndShade = 0\n            .Weight = xlThin\n        End With\n        With .Borders(xlEdgeTop)\n            .LineStyle = xlContinuous\n            .ColorIndex = 0\n            .TintAndShade = 0\n            .Weight = xlThin\n        End With\n        With .Borders(xlEdgeBottom)\n            .LineStyle = xlContinuous\n            .ColorIndex = 0\n            .TintAndShade = 0\n            .Weight = xlThin\n        End With\n        With .Borders(xlEdgeRight)\n            .LineStyle = xlContinuous\n            .ColorIndex = 0\n            .TintAndShade = 0\n            .Weight = xlThin\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 46081717, "answer_count": 2, "score": 0, "last_activity_date": 1504725715, "creation_date": 1504718227, "last_edit_date": 1504725715, "question_id": 46080985, "link": "https://stackoverflow.com/questions/46080985/split-text-and-save-to-different-fieldsno-duplicate-with-duplicate-using-arra", "title": "Split text and save to different fields(No duplicate, With Duplicate) Using Array in Excel VBA", "body": "<p>As you can see in the picture below, I have Current Output and Expected output. The First thing is that I  have worksheet <code>SPLIT</code> and <code>Duplication.</code>\nWhat I want is for <code>TextBox1</code> to be filled and entered by the user. It will be  saved to a different column the <code>No Duplicated Word</code> and <code>With Duplicated Word</code></p>\n\n<p>In this picture, in the <code>current output</code> at the <code>first input</code> all insertion of data looks well. But in the <code>2nd input</code> of data everything was failed. How can I do this with this code? In the expected output the shown picture says that it removes the duplicate word and saves it, but still the <code>financial word is not missing</code>.</p>\n\n<p>Code</p>\n\n<pre><code>Sub SplitText()\n    Dim WArray As Variant\n    Dim TextString As String\n    Dim col_no_dup As Long\n    Dim col_dup As Long\n    Dim counter As Integer\n    Dim sht_database As Worksheet\n\n    With ThisWorkbook\n        Set sht_database = .Sheets(\"Duplication\")\n        TextString = LCase(TextBox1)\n    End With\n\n    WArray = Split(TextString, \" \") 'load array\n\n    If (TextString = \"\") Then\n        MsgBox (\"Error: Pls Enter your data\")\n    End\n    Else: End If\n\n    'set column locations for duplicates/no duplicates\n    col_no_dup = 1\n    col_dup = 2\n\n    With sht_database\n    'Print whole array into duplicates column\n    .Cells(Cells.Rows.Count,col_dup).End(xlUp).Offset(1,0).Resize(UBound(WArray)+ IIf(LBound(WArray) = 0, 1, 0)) = Application.Transpose(WArray)\n\n    'Loop through array\n    For i = LBound(WArray) To UBound(WArray)\n        counter = 0\n        lrow_no_dup = .Cells(Cells.Rows.Count, col_no_dup).End(xlUp).row\n        For n = 1 To lrow_no_dup 'loop through and check each existing value in the no dup column\n            If .Cells(n, col_no_dup).Value = WArray(i) Then\n                counter = counter + 1 'account for each occurence\n            Else: End If\n        Next n\n        If counter = 0 Then 'counter = 0 implies the value doesn't exist in the \"No Duplicates\" column\n            .Cells(lrow_no_dup + 1, col_no_dup).Value = WArray(i)\n        Else: End If\n    Next i\n\n    End With\n\n    MsgBox (\"Successfully inserted\")\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    Call SplitText\nEnd Sub\n</code></pre>\n\n<p><strong>Current output</strong>\n<a href=\"https://i.stack.imgur.com/Jrkuj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jrkuj.png\" alt=\"Current output\"></a>\n <strong>Expected output</strong>\n<a href=\"https://i.stack.imgur.com/mytHu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mytHu.png\" alt=\"expected output\"></a></p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 55, "user_id": 8570333, "user_type": "registered", "profile_image": "https://graph.facebook.com/1836995109663269/picture?type=large", "display_name": "Monojoll", "link": "https://stackoverflow.com/users/8570333/monojoll"}, "edited": false, "score": 0, "creation_date": 1504717963, "post_id": 46080912, "comment_id": 79123374, "body": "sorry for my lack of punctuation !"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504718335, "post_id": 46080912, "comment_id": 79123597, "body": "You need to watch this video:<a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5&amp;t=3128s\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1504719213, "post_id": 46080912, "comment_id": 79124061, "body": "It is recommended to avoid the use of select: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504720397, "post_id": 46080912, "comment_id": 79124751, "body": "What you have tried to do, to break up the information?  (e.g. WIRE-3FEC-2.5:WH/VT to 3FEC,\t2.5,\tWH/VT)"}, {"owner": {"reputation": 55, "user_id": 8570333, "user_type": "registered", "profile_image": "https://graph.facebook.com/1836995109663269/picture?type=large", "display_name": "Monojoll", "link": "https://stackoverflow.com/users/8570333/monojoll"}, "edited": false, "score": 0, "creation_date": 1504720797, "post_id": 46080912, "comment_id": 79124983, "body": "nothing yet, still figuring it out."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1504721323, "last_edit_date": 1504721323, "creation_date": 1504720673, "answer_id": 46081581, "question_id": 46080912, "link": "https://stackoverflow.com/questions/46080912/vba-excel-filter-specific-string-content-in-a-whole-column-and-paste-it-in-anoth/46081581#46081581", "title": "VBA Excel filter specific string content in a whole column and paste it in another column", "body": "<p>This is the way to do it.  </p>\n\n<pre><code>Sub ProcessData()\n    Dim x As Long, y As Long\n    Dim r As Range\n    Dim values As Variant\n\n    With Sheet3\n        For y = 1 To 4\n            If InStr(1, Cells(1, y).value, \"Wire/Hose/Tube type\") Then\n                .Columns(y).Resize(, 3).Insert Shift:=xlToRight\n                Exit For\n            End If\n        Next\n        y = y + 3\n\n        For Each r In .Range(.Cells(2, y), .Cells(.Rows.Count, y).End(xlUp))\n            values = Split(Replace(r.value, \":\", \"-\"), \"-\")\n            r.Offset(0, -3).value = values(1)\n            r.Offset(0, -2).value = values(2)\n            r.Offset(0, -1).value = values(3)\n        Next\n        .Cells(1, y - 3).Resize(1, 3).value = Array(\"Wire\", \"Size\", \"Color\")\n        .Columns(y).Delete\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8570333, "user_type": "registered", "profile_image": "https://graph.facebook.com/1836995109663269/picture?type=large", "display_name": "Monojoll", "link": "https://stackoverflow.com/users/8570333/monojoll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 46081581, "answer_count": 1, "score": -1, "last_activity_date": 1504721323, "creation_date": 1504717884, "question_id": 46080912, "link": "https://stackoverflow.com/questions/46080912/vba-excel-filter-specific-string-content-in-a-whole-column-and-paste-it-in-anoth", "title": "VBA Excel filter specific string content in a whole column and paste it in another column", "body": "<p>I have a matrix of aprox 5000 rows that looks something as seen on im1 (not the real matrix)</p>\n\n<p><a href=\"https://i.stack.imgur.com/H0Nsm.png\" rel=\"nofollow noreferrer\">im1</a></p>\n\n<p>Basically I coded something that inserts 3 empty columns to the right of wire/hose/type with the respective names \"Wire, Size and Color\" written in the top cell of the column</p>\n\n<p>The column Wire/hose/Type contains 3 types of information\nthe first would be the 4 character long string that start with a number (like 3FEC or 4LOP). this is a pattern\nthe second is a number like 2.5 or 0.50 \nthe third is the string that contains one or two colors (GN or GN/BN for example)</p>\n\n<p>What I want to do is Identify the first type of information in every cell of the column and paste it on \"Wire\", to paste the second type of information on \"size\" and the third on \"color\" and finally deleting the column Wire/hose type so finally it looks something as seen on im2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DX9md.png\" rel=\"nofollow noreferrer\">im2</a></p>\n\n<p>If anyone could please guide me a little on filling at least the first parameter so i can fill the rest with the same reasoning I would really appreciate it, don't mean to sound cliche but I'm kind of new in this coding environment </p>\n\n<p>my code so far looks like this:</p>\n\n<p>Sheet3.Activate</p>\n\n<pre><code>For i = 1 To 4\n    celltxt2 = ActiveSheet.Cells(1, i).Text\n    If InStr(1, celltxt2, \"Wire/Hose/Tube type\") Then\n        Columns(i + 1).EntireColumn.Select\n        Selection.Insert Shift:=xlToRight\n        Selection.Insert Shift:=xlToRight\n        Selection.Insert Shift:=xlToRight\n    End If\nNext i\no = 1\n    Do While IsEmpty(Cells(1, o)) = False\n        o = o + 1\n    Loop\nSet wr = Cells(1, o)\nwr.Value = \"Wire\"\nSet sz = Cells(1, o + 1)\nsz.Value = \"Size\"\nSet clr = Cells(1, o + 2)\nclr.Value = \"Color\"\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1504717388, "post_id": 46080693, "comment_id": 79123048, "body": "well you don&#39;t show connecting to the database or closing the db connection so I&#39;m guessing there is something wrong in those parts."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1504717456, "post_id": 46080693, "comment_id": 79123091, "body": "Perhaps try <code>Set cdb = CurrentDb</code> followed by <code>Set qdf = cdb.QueryDefs(&quot;qerApndNote&quot;)</code>"}, {"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1504717601, "post_id": 46080693, "comment_id": 79123192, "body": "my other suggestion is to change the routine to do some logging -- log the values before the call, log the values after the call, include timestamps.  Mysteries will be revealed."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1504717643, "post_id": 46080693, "comment_id": 79123210, "body": "Kind of a long shot, but try addressing the parameters by name, not by index. <code>qdf.Parameters(&quot;noteDetails&quot;).Value = txtDetails.Value</code> etc."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8533487"}, "edited": false, "score": 0, "creation_date": 1504718176, "post_id": 46080693, "comment_id": 79123498, "body": "Still isn&#39;t filling in the user ID or the date time columns, though I thank you all for your help nonetheless."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1504718323, "post_id": 46080693, "comment_id": 79123586, "body": "I do not believe the query or code is the issue. You are passing parameters from what appears to be a form control and another method, <code>getCurrentUserID()</code>. These may not retain values at runtime of query. Hence the inconsistency. Please show their code and/or describe form."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1504718528, "post_id": 46080693, "comment_id": 79123711, "body": "In fact, since you  mention <code>Now()</code> strangely does not insert, I am convinced it may be your environment. Please describe architecture. FE/BE split across a LAN network? How is this query triggered (what form event or macro)? Do not run MS Access on thumb drives or internet folders (Dropbox, Google Drive, etc.)."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1504721123, "post_id": 46080693, "comment_id": 79125172, "body": "Hmm. Your code, parameters and their values seem perfectly fine. <i>This should work.</i> Grr. In case you don&#39;t do this regularly anyway, try Compact/Repair and a full <a href=\"http://stackoverflow.com/a/3268188/3820271\">Decompile</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8533487"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1504722341, "post_id": 46080693, "comment_id": 79125812, "body": "@Andre I do regularly compact/repair, which I&#39;m glad to know is a good idea.  The whole decompile / recompile thing doesn&#39;t seem to have changed anything though, apart from the fact that <i>frmNewNote</i>, which is a popup, refuses to pop up now..."}, {"owner": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1504724038, "post_id": 46080693, "comment_id": 79126698, "body": "Just a thought.  Since you are passing Now(), have you tried removing noteTime as a parameter, and insert Now() instead.  It shouldn&#39;t make a difference, but I have seen instances where doing something like this has made a difference, and has provided the clue as to where to look for the problem!  Re frmNewNote post recompile - can you still open it in design view?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8533487"}, "reply_to_user": {"reputation": 3486, "user_id": 7990032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddc6e1440249194031cf7d4820a31661?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Willcock", "link": "https://stackoverflow.com/users/7990032/jonathan-willcock"}, "edited": false, "score": 0, "creation_date": 1504729186, "post_id": 46080693, "comment_id": 79129324, "body": "@JonathanWillcock Huh.  Would you look at that.  It takes care of that particular piece.  Still got another to fix, but hey, progress!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8533487"}, "edited": false, "score": 1, "creation_date": 1504720076, "post_id": 46081399, "comment_id": 79124567, "body": "From everything that I&#39;ve read and learned about until now, this right here isn&#39;t exactly the best practice.  The way I&#39;ve done it, I actually <i>can</i> have single quotes in my strings, because the queries are parameterized.  At least, that&#39;s the gist of it, I think."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1504720477, "post_id": 46081399, "comment_id": 79124799, "body": "I added on more change with the use of <code>Me.</code>. As for the best practice it really depends on your environment and the openness of your system. In most cases when dealing with just the Access UI and not an Internet facing application, just using replace to deal with single quotes makes life a lot easier, especially when having much more complicated queries generated by code. I usually create a short function calling it something like <code>Qs</code> to take care of the single quote issue, to make code more readable."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1504720130, "last_edit_date": 1504720130, "creation_date": 1504719920, "answer_id": 46081399, "question_id": 46080693, "link": "https://stackoverflow.com/questions/46080693/ms-access-sql-append-query-behavior-is-erratic/46081399#46081399", "title": "MS Access - SQL append query behavior is erratic", "body": "<p>You are doing way more work than you have to. All you need is:</p>\n\n<pre><code>DoCmd.RunSQL(\"INSERT INTO tblNotes (NOTE_DETAILS, NOTE_TIME_CREATED, NOTE_SOURCE_USER) VALUES ('\" &amp; Me.txtDetails &amp; \"',Now(),\" &amp; CurrUserID  &amp; \")\")\n</code></pre>\n\n<p>Note the change from <code>txtDetails.Value</code> to <code>Me.txtDetails</code> which is what may have been messing you up. This of course assumes the code runs in the form's context, otherwise you have to get he value of the text field using a reference to the form.</p>\n\n<p>The only other thing to consider is making sure <code>Me.txtDetails</code> does not have any single quotes, so probably use <code>Replace(Me.txtDetails,\"'\",\"''\")</code> instead.</p>\n\n<p>That way you can also replace <code>DoCmd.RunSQL</code> with <code>MsgBox</code> to troubleshoot the exact query.</p>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1504727039, "creation_date": 1504727039, "answer_id": 46083190, "question_id": 46080693, "link": "https://stackoverflow.com/questions/46080693/ms-access-sql-append-query-behavior-is-erratic/46083190#46083190", "title": "MS Access - SQL append query behavior is erratic", "body": "<p>I just remembered something:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/39106471/ms-access-2013-calling-insert-queries-from-vba-with-strange-errors\">MS Access 2013 calling insert queries from VBA with strange errors</a></p>\n\n<p>You have a <code>LongText</code> parameter. These don't really work. See also <a href=\"https://stackoverflow.com/a/37052403/3820271\">https://stackoverflow.com/a/37052403/3820271</a></p>\n\n<p>If the entered notes will always be &lt;= 255 characters, change the parameter to <code>ShortText</code>.</p>\n\n<p>If the text can be longer, you'll have to use either SunKnight0's approach with a concatenated INSERT statement.</p>\n\n<p>Or use a Recordset and its <a href=\"https://msdn.microsoft.com/en-us/library/bb220954(v=office.12).aspx\" rel=\"nofollow noreferrer\"><code>.AddNew</code></a> method, which will be a similar amount of code to your current solution, but also be completely safe from injection or formatting issues.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8533487"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 46083190, "answer_count": 2, "score": 2, "last_activity_date": 1504727039, "creation_date": 1504717117, "last_edit_date": 1504720132, "question_id": 46080693, "link": "https://stackoverflow.com/questions/46080693/ms-access-sql-append-query-behavior-is-erratic", "title": "MS Access - SQL append query behavior is erratic", "body": "<p>I've been working on an Access database for the last couple weeks, and it's my first project with the tool.  Dealing with append queries seems to have become an utter nightmare, and is incredibly frustrating.  Even more so because it seems to have simply stopped working in any consistent manner overnight.</p>\n\n<p>The SQL query that I have written goes thus:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS noteDetails LongText, noteTime DateTime, srcUserID Long;\nINSERT INTO tblNotes (NOTE_DETAILS, NOTE_TIME_CREATED, NOTE_SOURCE_USER)\nVALUES (noteDetails, noteTime, srcUserID)\n</code></pre>\n\n<p>In <em>tblNotes</em>:</p>\n\n<pre><code>NOTE_ID is an AutoNumber\nNOTE_DETAILS is a Long Text\nNOTE_TIME_CREATED is a Date/Time\nNOTE_SOURCE_USER is a Number\n</code></pre>\n\n<p>The way that I'm running this query is through VBA:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set qdf = CurrentDb.QueryDefs(\"qerApndNote\")\nqdf.Parameters(0).Value = txtDetails.Value\nqdf.Parameters(1).Value = Now()\nqdf.Parameters(2).Value = getCurrentUserID()\nqdf.Execute dbFailOnError\nqdf.Close\nSet qdf = Nothing\n\n' Where CurrUserID is a global long\n' txtDetails.Value is a textbox's contents\n' Now() is the VBA built-in function to return a date/time combo\n</code></pre>\n\n<p>I have attempted to run this query manually from the navigation bar, and it works fine when done in that manner.</p>\n\n<p>However, running it from VBA has resulted in such things as there being no time / date inserted, sometimes a user ID is not inserted, sometimes both, sometimes even the details text is missing.</p>\n\n<p>What is it that I'm missing?  Is there any general advice for users of MS Access to follow that I am not?  I'm aware that NOTE is a restricted word in Access, but I really don't think that should apply here, right?</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>EDIT</strong>:  The form that I'm passing data from is called frmNewNote, and there is a control in it named txtDetails.  It's just a regular textbox.  Don't really know what else to share about that.</p>\n\n<p>The getCurrentUserID function is in a module, <em>modGlobal</em>:</p>\n\n<pre><code>Public CurrUserID As Long\n\nPublic Function getCurrentUserID() As Long\n    getCurrentUserID = CurrUserID\nEnd Function\n\nPublic Function setCurrentUserID(CurrID As Long)\n    CurrUserID = CurrID\nEnd Function\n</code></pre>\n\n<p>It's about as barebones as you can get, really.  And there is never a circumstance that you'll get to the form before SetCurrentUserID has been called during your... session?  There's a login form involved.</p>\n\n<p>@Andre's code for logging:</p>\n\n<pre><code> 0            noteDetailsText             This is a note test\n 1            noteTimeCreated             9/6/2017 10:28:45 AM \n 2            srcUserID      1\n</code></pre>\n\n<p>As for my architecture, um, it's just the single database file right now, on the desktop.  The entire function/sub is run when you click a button, <em>btnEnter</em>.  It does some other stuff before it gets to the SQL statement bit - checks for null values and prompts user for entries if that's the case.</p>\n"}, {"tags": ["vba", "if-statement"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1504716410, "post_id": 46080483, "comment_id": 79122520, "body": "Does any of your cell contains an error?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504716456, "post_id": 46080483, "comment_id": 79122547, "body": "Your numbers are text strings that look like numbers?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1504717859, "post_id": 46080483, "comment_id": 79123321, "body": "Does <code>If IsError(cellh.Value) Then Stop</code> break on <code>Stop</code>? If so, you have error values in your data; you can&#39;t do math or value comparisons on error values. Check with <code>IsError</code> <i>before</i> you do the math/comparisons."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1504718287, "post_id": 46080483, "comment_id": 79123570, "body": "Remove the <code>Not</code> on <code>If Not InStr(cellh, &quot;LINE:&quot;) &gt; 0 Then</code> as the line with <code>LINE:</code> will return False and move to the ElseIFs"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 1, "creation_date": 1504719484, "post_id": 46080483, "comment_id": 79124196, "body": "Your &quot;Type mismatch&quot; is coming from your test of <code>cellh.Value &gt; 0</code>.  Cellh is clearly a string and you are trying to compare it like it is an integer.  In order to do the compare, you have to convert your cellh to an integer.  You can do this by creating your own function that verifies you truly have an integer to convert (hint hint... do this).  Or if you are sure it will be an &quot;only numeric text&quot; by the time it gets to the last ElseIf, you can use <code>cint(cellh.Value) &gt; 0</code> to convert it.  You&#39;d then need to do the same for <code>cint(cellh.Value) * -1</code>"}, {"owner": {"reputation": 45, "user_id": 8222808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e434456796e78784b63d490aff810639?s=128&d=identicon&r=PG&f=1", "display_name": "bjefko", "link": "https://stackoverflow.com/users/8222808/bjefko"}, "edited": false, "score": 0, "creation_date": 1504724686, "post_id": 46080483, "comment_id": 79127048, "body": "Thanks guys.  I did end up taking out the &#39;Not&#39; and the code is running well and doing what it should be.  I think I&#39;m good to go here.  Thanks Scott!  Also, I added in my data just so you can see what I&#39;m trying to work with."}], "owner": {"reputation": 45, "user_id": 8222808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e434456796e78784b63d490aff810639?s=128&d=identicon&r=PG&f=1", "display_name": "bjefko", "link": "https://stackoverflow.com/users/8222808/bjefko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504724531, "creation_date": 1504716284, "last_edit_date": 1504724531, "question_id": 46080483, "link": "https://stackoverflow.com/questions/46080483/instr-for-line-skip-remove-turn-postive-into-negative", "title": "Instr for &quot;Line&quot; (skip), &quot;-&quot; (remove &quot;-&quot;), turn postive into negative", "body": "<p>Having a bit of an issue with some code here.  I want to do three things.  I want to skip the line in a range if it contains \"LINE:\", I want to remove any trailing \"-\" in the string, and I want to turn any positive values into negative values.  Below is my code, but I'm having trouble with it.  I'm getting a \"Type mismatch\" error on the below line.</p>\n\n<pre><code>ElseIf cellh.Value &gt; 0 Then cellh.Value = cellh.Value * 1\n</code></pre>\n\n<p>I'm thinking it's because it's trying to evaluate a range instead of integer, but I need to be able to reference the range to keep the for each going.  Any help would be appreciated.  Code below.  Thanks!</p>\n\n<pre><code>Sub Test()\n\nDim rngh As Range, cellh As Range\nDim myString As String\nSet rngh = Range(\"E1:E24\")\n\nFor Each cellh In rngh\n    If Not InStr(cellh, \"LINE:\") &gt; 0 Then\n    ElseIf InStr(cellh, \"-\") &gt; 0 Then\n        myString = cellh.Text\n        myString = Left(myString, Len(myString) - 1)\n        cellh.Value = myString\n    ElseIf cellh.Value &gt; 0 Then cellh.Value = cellh.Value * -1\n    End If\nNext cellh\n\nEnd Sub\n\nLINE: 00005    &lt;--Skip these lines\n$12.29-        &lt;--Cut off trailing \"-\"\n$2.59          &lt;--Make a negative number\n$13.56-\n$2.59 \nLINE: 00006\n$130.02-\nLINE: 00007\n$20.13-\n$28.74-\nLINE: 00008\n$41.10-\n$13.70-\nLINE: 00009\n$9.61-\nLINE: 00010\n$5.00-\n$7.18-\nLINE: 00011\n$7.52-\n$8.89-\nLINE: 00012\n$43.34-\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504716077, "post_id": 46080390, "comment_id": 79122316, "body": "Very similar question; <a href=\"https://stackoverflow.com/questions/46079043/auto-fill-to-last-cell-in-row-auto-fill-horizontally-instead-of-vertically/46079426\" title=\"auto fill to last cell in row auto fill horizontally instead of vertically\">stackoverflow.com/questions/46079043/&hellip;</a>  though you will need to change it from columns to rows."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 3, "creation_date": 1504716427, "post_id": 46080390, "comment_id": 79122533, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46079043/auto-fill-to-last-cell-in-row-auto-fill-horizontally-instead-of-vertically\">Auto-fill to last cell in row (auto-fill horizontally instead of vertically)</a>"}], "owner": {"reputation": 5, "user_id": 8570289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86f3071580bc8398d4b17357bafbc87?s=128&d=identicon&r=PG&f=1", "display_name": "pkumar", "link": "https://stackoverflow.com/users/8570289/pkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504727378, "creation_date": 1504715937, "last_edit_date": 1504727378, "question_id": 46080390, "link": "https://stackoverflow.com/questions/46080390/vba-for-excel-to-insert-a-new-column-and-fill-down-with-a-text-ckdup-but-its-not", "title": "VBA For Excel to insert a new column and fill down with a text CKDUP but its not working", "body": "<p>I am trying to do an simple type and fill down on a vba code but it is not working.Can some one guide me through it , I am new to VBA on Excel.</p>\n\n<p>The Fill down should be equal to the length of the column next it.</p>\n\n<p>when i do manually it is working.</p>\n\n<p>Here is the code</p>\n\n<pre><code>   Sub Macro7()\n'\n' Macro7 Macro\n'\n\n'\n    Columns(\"B:B\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Columns(\"D:D\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"B2\").Select\n    ActiveCell.FormulaR1C1 = \"(ck dup)\"\n    Selection.FillDown\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504715012, "post_id": 46079787, "comment_id": 79121659, "body": "Your <code>Property Let</code> won&#39;t compile."}, {"owner": {"reputation": 325, "user_id": 3104963, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/3deb59a9c2cde3d75b46189e0dc9adbb?s=128&d=identicon&r=PG&f=1", "display_name": "KM529", "link": "https://stackoverflow.com/users/3104963/km529"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504715176, "post_id": 46079787, "comment_id": 79121769, "body": "I modified it from double to variant in the declaration at the top. That should work for compiling at least"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504715365, "post_id": 46079787, "comment_id": 79121890, "body": "Nope, you can&#39;t assign to a static array"}, {"owner": {"reputation": 325, "user_id": 3104963, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/3deb59a9c2cde3d75b46189e0dc9adbb?s=128&d=identicon&r=PG&f=1", "display_name": "KM529", "link": "https://stackoverflow.com/users/3104963/km529"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504717455, "post_id": 46079787, "comment_id": 79123090, "body": "I managed to find a reference to this in a different question here that answers the question well:  <a href=\"https://stackoverflow.com/questions/9720018/get-an-array-into-a-class-property\" title=\"get an array into a class property\">stackoverflow.com/questions/9720018/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1504842249, "post_id": 46080555, "comment_id": 79179353, "body": "more likely something like months_(i)=value , and i is also in the parameters section of the let property"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1504716581, "creation_date": 1504716581, "answer_id": 46080555, "question_id": 46079787, "link": "https://stackoverflow.com/questions/46079787/how-do-you-modify-the-elements-in-a-classs-array-property/46080555#46080555", "title": "How do you modify the elements in a class&#39;s array property?", "body": "<p><code>months_ = Months</code> needs to be changed to <code>months_ = value</code></p>\n\n<pre><code>Private something As String\nPrivate something2 As String\nPrivate months_(12) As Variant\n\nPublic Property Let Months(value As Variant)\n    months_ = value\nEnd Property\n\nPublic Property Get Months() As Variant\n    Months = months_\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 3104963, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/3deb59a9c2cde3d75b46189e0dc9adbb?s=128&d=identicon&r=PG&f=1", "display_name": "KM529", "link": "https://stackoverflow.com/users/3104963/km529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504716581, "creation_date": 1504713815, "last_edit_date": 1531164843, "question_id": 46079787, "link": "https://stackoverflow.com/questions/46079787/how-do-you-modify-the-elements-in-a-classs-array-property", "title": "How do you modify the elements in a class&#39;s array property?", "body": "<p>I have created a module that contains multiple fields, with one of them being an array of doubles. The issue that I'm having with this is that the values do not seem to be getting modified when they should be. </p>\n\n<p>I have looked around, but been unable to find any examples of someone doing this. Is that because it isn't possible, or is it bad practice? Is there some way to work around this?</p>\n\n<p>I have included some code below:</p>\n\n<pre><code>MODULE CODE 1:\n\nPrivate something as String\nPrivate something2 as String\nPrivate months_(12) as Variant\n\nPublic Property Let Months(value as Variant)\n    months_ = Months\nEnd Property\n\nPublic Property Get Months() as Variant\n    Months = months_\nEnd Property\n</code></pre>\n\n<p>In the code that utilizes this, I attempted to access and modify a value in that array directly through the following where \"lines\" as an array of the objects mentioned:</p>\n\n<pre><code>lines(0).Months(i Mod 12) = aDoubleValue\n</code></pre>\n\n<p>So far this code is giving me no results at all. I have a for loop printing the values of each of the elements within lines and they are all blank, despite being set to either a 0 or 5</p>\n\n<p>The code doing this is as follows:</p>\n\n<pre><code>For i = 0 To tsWork.Count            \n    If tsWork(i) Is Nothing Then                 \n        lines(1).Months(i Mod 12) = 0#\n    Else\n        lines(1).Months(i Mod 12) = 5#  \n    End If\nNext           \n\n\nFor i = 0 To UBound(lines(0).Months)\n    response2 = MsgBox(\"\" &amp; i &amp; \" = \" &amp; lines(1).Months(i), vbOKOnly, \"Check values\")\nNext\n</code></pre>\n\n<p>At the point where this code executes, the count of tsWork has been tested to be 30+, and after execution, the UBound of lines(1).Months is 12, as is expected, but without any values.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1504713714, "post_id": 46079566, "comment_id": 79120864, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8570006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29f092ea4c8ed70b9c50031a237ae96?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8570006/ben"}, "edited": false, "score": 0, "creation_date": 1504716489, "post_id": 46079862, "comment_id": 79122576, "body": "Thanks so much for this solution Scott. This looks to work great. Apologies if I&#39;ve broken a rule on this section of the site--I was under the impression that this would constitute a question. As one follow up, would it be easy to extrapolate the formula I&#39;d need to add a fourth column from the formula&#39;s that you provided? It looks like it would be fairly straightforward, but I&#39;m by no means an expert in this type of analysis."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 69, "user_id": 8570006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29f092ea4c8ed70b9c50031a237ae96?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8570006/ben"}, "edited": false, "score": 0, "creation_date": 1504716656, "post_id": 46079862, "comment_id": 79122656, "body": "@Ben normally it is expected to show what you have tried and where it is failing, especially when requesting vba code.  As you also indicated you wanted a formula <b>AND</b> I found this an intriguing puzzle, I answered.  I also voted to close it as too broad.  Just remember that next time when you ask come with what you have tried and were it went wrong.  Stack Overflow is not a code for me site it is to help overcome problematic code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 69, "user_id": 8570006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29f092ea4c8ed70b9c50031a237ae96?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8570006/ben"}, "edited": false, "score": 0, "creation_date": 1504716784, "post_id": 46079862, "comment_id": 79122734, "body": "@Ben as far as adding a column, it is not too difficult, try on your own.  If you are not able to do it, then come back and ask a new question.  Post what you have tried to modify the above formulas and link to this question."}, {"owner": {"reputation": 69, "user_id": 8570006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29f092ea4c8ed70b9c50031a237ae96?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8570006/ben"}, "edited": false, "score": 0, "creation_date": 1504716855, "post_id": 46079862, "comment_id": 79122772, "body": "Will do. Thanks for your help."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1504714080, "creation_date": 1504714080, "answer_id": 46079862, "question_id": 46079566, "link": "https://stackoverflow.com/questions/46079566/create-flattened-data-label-columns-from-multiple-lists/46079862#46079862", "title": "Create &quot;Flattened&quot; Data Label Columns from Multiple Lists", "body": "<p>Three formulas:</p>\n\n<pre><code>=IFERROR(INDEX($A$1:INDEX(A:A,MATCH(1E+99,A:A)),INT((ROW(1:1)-1)/((COUNTA(B:B)-1)*(COUNTA(C:C)-1)))+2),\"\")\n\n=IF(E2&lt;&gt;\"\",INDEX(B:B,MOD(INT((ROW(1:1)-1)/(COUNTA(C:C)-1)),COUNTA(B:B)-1)+2),\"\")\n\n=IF(E2&lt;&gt;\"\",INDEX(C:C,MOD((ROW(1:1)-1),COUNTA(C:C)-1)+2),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/1EMAS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1EMAS.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 69, "user_id": 8570006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29f092ea4c8ed70b9c50031a237ae96?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8570006/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1504742968, "accepted_answer_id": 46079862, "answer_count": 1, "score": -3, "last_activity_date": 1538571209, "creation_date": 1504713139, "last_edit_date": 1538571209, "question_id": 46079566, "link": "https://stackoverflow.com/questions/46079566/create-flattened-data-label-columns-from-multiple-lists", "closed_reason": "Needs more focus", "title": "Create &quot;Flattened&quot; Data Label Columns from Multiple Lists", "body": "<p>I want to create a \"flattened\" data structure in Excel for several data labels with listed attributes. For example:</p>\n\n<p>I have the following lists of data:</p>\n\n<pre><code>Date     Department  Forecast Period\nJan-16   Marketing    2015 Nov\nFeb-16   Accounting   2015 Dec\nMar-16   HR \nApr-16      \n</code></pre>\n\n<p>I want to transform the above into the following data structure:</p>\n\n<pre><code>Date    Department  Forecast Period\nJan-16  Marketing   2015 Nov\nJan-16  Marketing   2015 Dec\nJan-16  Accounting  2015 Nov\nJan-16  Accounting  2015 Dec\nJan-16  HR          2015 Nov\nJan-16  HR          2015 Dec\nFeb-16  Marketing   2015 Nov\nFeb-16  Marketing   2015 Dec\nFeb-16  Accounting  2015 Nov\nFeb-16  Accounting  2015 Dec\nFeb-16  HR          2015 Nov\nFeb-16  HR          2015 Dec\nMar-16  Marketing   2015 Nov\nMar-16  Marketing   2015 Dec\nMar-16  Accounting  2015 Nov\nMar-16  Accounting  2015 Dec\nMar-16  HR          2015 Nov\nMar-16  HR          2015 Dec\nApr-16  Marketing   2015 Nov\nApr-16  Marketing   2015 Dec\nApr-16  Accounting  2015 Nov\nApr-16  Accounting  2015 Dec\nApr-16  HR          2015 Nov\nApr-16  HR          2015 Dec\n</code></pre>\n\n<p>Ideally, I would also be able to add/remove items from the first three lists and the transformed data would adjust accordingly. I'm not sure if VBA or formulas would be the best way to tackle this, but hopefully you will be able to give me some guidance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 2, "last_activity_date": 1504712460, "creation_date": 1504712460, "answer_id": 46079361, "question_id": 46079043, "link": "https://stackoverflow.com/questions/46079043/auto-fill-to-last-cell-in-row-auto-fill-horizontally-instead-of-vertically/46079361#46079361", "title": "Auto-fill to last cell in row (auto-fill horizontally instead of vertically)", "body": "<p>a possible solution.</p>\n\n<pre><code>Rows(\"1:1\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"D1\").FormulaR1C1 = \"=TEXT(R[1]C,\"\"mmm-yyyy\"\")\"\nlastcol = Cells(2, Columns.Count).End(xlToLeft).Column\nRange(\"D1\").AutoFill Destination:=Range(\"D1\", Cells(1, lastcol)), Type:=xlFillDefault\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1504712660, "creation_date": 1504712660, "answer_id": 46079426, "question_id": 46079043, "link": "https://stackoverflow.com/questions/46079043/auto-fill-to-last-cell-in-row-auto-fill-horizontally-instead-of-vertically/46079426#46079426", "title": "Auto-fill to last cell in row (auto-fill horizontally instead of vertically)", "body": "<p>First avoid <code>.Select</code> it slows the code and can be Then you can just fill the formula without the need of Autofill.</p>\n\n<p>Also get in the habit of declaring the parent worksheet of all ranges.</p>\n\n<p>We find the last used column with <code>.Cells(2,.Columns.Count).End(xltoLeft).Column)</code>.</p>\n\n<p>Using that in another Cells() we get the last cell in row 1, <code>.Cells(1,.Cells(2,.Columns.Count).End(xltoLeft).Column)</code>.</p>\n\n<p>So, <code>.Range(\"D1\",.Cells(1,.Cells(2,.Columns.Count).End(xltoLeft).Column))</code> creates a range from D1 to the last used column in Row 2:</p>\n\n<pre><code>With ActiveSheet 'Should be replaced with your sheet name: Worksheets(\"Sheet1\")\n\n    .Rows(\"1:1\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    .Range(\"D1\",.Cells(1,.Cells(2,.Columns.Count).End(xltoLeft).Column)).FormulaR1C1 = \"=TEXT(R[1]C,\"\"mmm-yyyy\"\")\"\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3297566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369d4c16caa476a64333377c697d1138?s=128&d=identicon&r=PG&f=1", "display_name": "wlfpck", "link": "https://stackoverflow.com/users/3297566/wlfpck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 46079426, "answer_count": 2, "score": 0, "last_activity_date": 1504727631, "creation_date": 1504711459, "last_edit_date": 1504727631, "question_id": 46079043, "link": "https://stackoverflow.com/questions/46079043/auto-fill-to-last-cell-in-row-auto-fill-horizontally-instead-of-vertically", "title": "Auto-fill to last cell in row (auto-fill horizontally instead of vertically)", "body": "<p>Hopefully this will be a quick fix.</p>\n\n<p>I've googled around and all the VBA codes are to auto-fill a column down to the last cell.  However, I'm trying to auto-fill across a row.</p>\n\n<p>My current code snippet is below.  What I want to do is take the heading at the top which has the date in it and create a new heading that just has the month and year.  This is for the rest of the macro to run.  However, right now, users are having to manually do the formula auto-fill across the top.</p>\n\n<p>My code is:</p>\n\n<pre><code>Rows(\"1:1\").Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"D1\").Select\nActiveCell.FormulaR1C1 = \"=TEXT(R[1]C,\"\"mmm-yyyy\"\")\"\nLastCol = Range(\"D1\").End(xlToRight).Column\nRange(\"D1\").Select\nSelection.AutoFill Destination:=Range(\"D1:AD1\"), Type:=xlFillDefault\nRange(\"D1:AD1\").Select\n</code></pre>\n\n<p>In the line that is:</p>\n\n<pre><code>Selection.AutoFill Destination:=Range(\"D1:AD1\"), Type:=xlFillDefault\n</code></pre>\n\n<p>Is there anyway to get \"AD1\" to be whatever the last cell in the new row 2 is?</p>\n"}, {"tags": ["xml", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1504713070, "post_id": 46079429, "comment_id": 79120448, "body": "I shall give it a try.  Thankyou."}], "tags": [], "owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "is_accepted": false, "score": 0, "last_activity_date": 1504713150, "last_edit_date": 1504713150, "creation_date": 1504712666, "answer_id": 46079429, "question_id": 46078790, "link": "https://stackoverflow.com/questions/46078790/get-values-from-xlrangevaluemspersistxml-resultant-xml/46079429#46079429", "title": "Get values from xlRangeValueMSPersistXML resultant XML", "body": "<p>i tried doing it in powershell just to see how to navigate through the scheme.... Im not sure how to translate it into vba but here is the navigation</p>\n\n<p>for <code>&lt;s:datatype dt:type=\"float\"/&gt;</code> you can use something like</p>\n\n<p><code>Set p = x.xml.PivotCache.Schema.Attributetype.datatype.type</code>or<br>\n<code>Set p = x.PivotCache.Schema.Attributetype.datatype.type</code></p>\n\n<p>and for <code>&lt;z:row Col1=\"0.33333333333333331\"/&gt;</code> you can use something like</p>\n\n<p><code>Set p = x.xml.PivotCache.data.row.Col1</code> or\n<code>Set p = x.PivotCache.data.row.Col1</code></p>\n\n<p>i cant really test it but hopefully that helps...</p>\n"}], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504713150, "creation_date": 1504710634, "question_id": 46078790, "link": "https://stackoverflow.com/questions/46078790/get-values-from-xlrangevaluemspersistxml-resultant-xml", "title": "Get values from xlRangeValueMSPersistXML resultant XML", "body": "<p>I am trying to read the following XML from </p>\n\n<p><code>ActiveCell.Value(XlRangeValueDataType.xlRangeValueMSPersistXML)</code></p>\n\n<pre><code>&lt;xml xmlns:x=\"urn:schemas-microsoft-com:office:excel\"\n xmlns:dt=\"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882\"\n xmlns:s=\"uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882\"\n xmlns:rs=\"urn:schemas-microsoft-com:rowset\" xmlns:z=\"#RowsetSchema\"&gt;\n &lt;x:PivotCache&gt;\n  &lt;x:CacheIndex&gt;1&lt;/x:CacheIndex&gt;\n  &lt;s:Schema id=\"RowsetSchema\"&gt;\n   &lt;s:ElementType name=\"row\" content=\"eltOnly\"&gt;\n    &lt;s:attribute type=\"Col1\"/&gt;\n    &lt;s:extends type=\"rs:rowbase\"/&gt;\n   &lt;/s:ElementType&gt;\n   &lt;s:AttributeType name=\"Col1\" rs:name=\"Field1\"&gt;\n    &lt;s:datatype dt:type=\"float\"/&gt;\n   &lt;/s:AttributeType&gt;\n  &lt;/s:Schema&gt;\n  &lt;rs:data&gt;\n   &lt;z:row Col1=\"0.33333333333333331\"/&gt;\n  &lt;/rs:data&gt;\n &lt;/x:PivotCache&gt;\n&lt;/xml&gt; \n</code></pre>\n\n<p>Using the following code, however, I am struggling to get the contents of </p>\n\n<pre><code>Dim x As MSXML2.DOMDocument\nDim s As String\nDim p As IXMLDOMNode\n\ns = ActiveCell.Value(XlRangeValueDataType.xlRangeValueMSPersistXML)\n\nSet x = New MSXML2.DOMDocument\nx.LoadXML (s)\n\nSet p = x.FirstChild\n</code></pre>\n\n<p><code>&lt;s:datatype dt:type=\"float\"/&gt;</code> and <code>&lt;z:row Col1=\"0.33333333333333331\"/&gt;</code>  I only seem to get a return for <code>&lt;x:PivotCache&gt;</code>  There only seems to be one child, and looking from the locals window I can not see much else.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504711467, "post_id": 46078734, "comment_id": 79119476, "body": "Thank you very much @Vityata ! This is exactly what I needed."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504711520, "post_id": 46078734, "comment_id": 79119507, "body": "@NickRivera - glad I was able to help :)"}, {"owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504720105, "post_id": 46078734, "comment_id": 79124583, "body": "I forgot to mention..when I have selected more than one cell and right click and select &quot;clear contents&quot;, the &quot;NULL&quot; values get deleted (which worked as requested), but not the yellow fill. Is there a way to clear the yellow fill as well? @Vityata"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504720317, "post_id": 46078734, "comment_id": 79124692, "body": "@NickRivera - I do not understand completely what is your aim, but try writing <code>Target.Clear</code> before the condition. It should clear anything. If this is not what you want, write <code>Target.Clear</code> in the condition."}, {"owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504734834, "post_id": 46078734, "comment_id": 79131868, "body": "My aim is to remove the yellow fill color of the two adjacent cells if I select &quot;NO&quot; in the same cell where &quot;YES&quot; was already selected. In other words, whenever I select either &quot;YES&quot; or &quot;NO&quot; the predetermined data adjusts accordingly to its requirements. I can open a new question for this, but I thought maybe this was something that could be done here. @Vityata"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504771742, "post_id": 46078734, "comment_id": 79143887, "body": "@NickRivera - did you try including <code>Target.Clear</code>? It will clear the yellow color."}, {"owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504797399, "post_id": 46078734, "comment_id": 79162189, "body": "Yes, I tried including Target.Clear, but it removed the data validation drop-down formatting in addition to the yellow fill. How does Target.Clear look in the visual basic editor the way you are describing it? @Vityata"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504798229, "post_id": 46078734, "comment_id": 79162752, "body": "@NickRivera try <code>target.Interior.color = vbWhite</code> instead of <code>Target.Clear</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1504710463, "creation_date": 1504710463, "answer_id": 46078734, "question_id": 46078556, "link": "https://stackoverflow.com/questions/46078556/how-do-i-prevent-a-run-time-error-13-type-mismatch/46078734#46078734", "title": "How do I prevent a run-time error 13: type mismatch?", "body": "<p>Add on the top the following:</p>\n\n<p><code>If Target.Count &gt; 1 then Exit Sub</code> </p>\n\n<p>Thus, you would exit the sub, whenever you have selected more than 1 cell.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504732153, "post_id": 46080764, "comment_id": 79130746, "body": "I used your code in place of mine. The macro doesn&#39;t enter &quot;NULL&quot; in the adjacent two cells if I select &quot;NO&quot; from the drop-down list. Similarly, if I select &quot;YES&quot;, the macro doesn&#39;t enter  a yellow fill in the two adjacent cells. @Dirk Reichel"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504740977, "post_id": 46080764, "comment_id": 79133556, "body": "@NickRivera Tested it and got no problem. Still, I will run some additional tests and give feedback as soon as I am home again."}, {"owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504741532, "post_id": 46080764, "comment_id": 79133680, "body": "Thanks @Dirk Reichel . I&#39;ll test it again on my end as well."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "edited": false, "score": 0, "creation_date": 1504747324, "post_id": 46080764, "comment_id": 79134906, "body": "@NickRivera got the problem: for some reason MY &quot;Yes&quot; and &quot;No&quot; was uppercase while the check is case sensitive :P Corrected the answer and added a solution to your increased problem. Also keep in mind that your code (also will mine) runs for ALL sheets!"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1504747309, "last_edit_date": 1504747309, "creation_date": 1504717323, "answer_id": 46080764, "question_id": 46078556, "link": "https://stackoverflow.com/questions/46078556/how-do-i-prevent-a-run-time-error-13-type-mismatch/46080764#46080764", "title": "How do I prevent a run-time error 13: type mismatch?", "body": "<p>Assuming that you also want to copy/paste some \"Yes\"/\"No\" there and want it to be processed the correct way, this will do it in an easy short way:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n  If Intersect(Target, Columns(2)) Is Nothing Then Exit Sub\n  Application.ScreenUpdating = False\n  Dim cell\n  For Each cell In Intersect(Target, Columns(2)).Cells\n    If cell.Value = \"Yes\" Then\n      cell.Offset(0, 1).Resize(1, 2).Interior.ColorIndex = 6\n    ElseIf cell.Value = \"No\" Then\n      cell.Offset(0, 1).Resize(1, 2).Value = \"NULL\"\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nThe range is set to <code>B1:B9999</code> because clearing the whole column may freeze excel.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n  If Intersect(Target, Target.Parent.Range(\"B1:B9999\")) Is Nothing Then Exit Sub\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Dim cell\n  For Each cell In Intersect(Target, Target.Parent.Range(\"B1:B9999\")).Cells\n    If cell.Value = \"Yes\" Then\n      cell.Offset(0, 1).Resize(1, 2).Interior.ColorIndex = 6\n      cell.Offset(0, 1).Resize(1, 2).ClearContents\n    ElseIf cell.Value = \"No\" Then\n      cell.Offset(0, 1).Resize(1, 2).Value = \"NULL\"\n      cell.Offset(0, 1).Resize(1, 2).Interior.Pattern = xlNone\n    Else\n      cell.Offset(0, 1).Resize(1, 2).ClearContents\n      cell.Offset(0, 1).Resize(1, 2).Interior.Pattern = xlNone\n    End If\n  Next\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>If you want to only clear out \"NULL\" and undo the yellow color, you need to check each cell first like this:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n  If Intersect(Target, Target.Parent.Range(\"B1:B9999\")) Is Nothing Then Exit Sub\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Dim cell\n  For Each cell In Intersect(Target, Target.Parent.Range(\"B1:B9999\")).Cells\n    If cell.Value = \"Yes\" Then\n      cell.Offset(0, 1).Resize(1, 2).Interior.ColorIndex = 6\n      If cell.Offset(0, 1).Value = \"NULL\" Then cell.Offset(0, 1).ClearContents\n      If cell.Offset(0, 2).Value = \"NULL\" Then cell.Offset(0, 2).ClearContents\n    ElseIf cell.Value = \"No\" Then\n      cell.Offset(0, 1).Resize(1, 2).Value = \"NULL\"\n      If cell.Offset(0, 1).Interior.ColorIndex = 6 Then cell.Offset(0, 1).Interior.Pattern = xlNone\n      If cell.Offset(0, 2).Interior.ColorIndex = 6 Then cell.Offset(0, 2).Interior.Pattern = xlNone\n    Else\n      If cell.Offset(0, 1).Value = \"NULL\" Then cell.Offset(0, 1).ClearContents\n      If cell.Offset(0, 2).Value = \"NULL\" Then cell.Offset(0, 2).ClearContents\n      If cell.Offset(0, 1).Interior.ColorIndex = 6 Then cell.Offset(0, 1).Interior.Pattern = xlNone\n      If cell.Offset(0, 2).Interior.ColorIndex = 6 Then cell.Offset(0, 2).Interior.Pattern = xlNone\n    End If\n  Next\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8308426, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c363cee4cb1a5c9ac8464432cba9731?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/8308426/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 46078734, "answer_count": 2, "score": 1, "last_activity_date": 1504747309, "creation_date": 1504709960, "last_edit_date": 1531161705, "question_id": 46078556, "link": "https://stackoverflow.com/questions/46078556/how-do-i-prevent-a-run-time-error-13-type-mismatch", "title": "How do I prevent a run-time error 13: type mismatch?", "body": "<p>I have a macro that will populate multiple columns either with a value or with a yellow color based on a drop-down selection. For example, the drop-down list contains two items, \"YES\" and \"NO\". When an item is selected, the adjacent two cells will populate with predetermined data, as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rb9rO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rb9rO.png\" alt=\"enter image description here\"></a></p>\n\n<p>The above macro works until I right click and select \"clear contents\" to delete a range of values, as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4oG1V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4oG1V.png\" alt=\"enter image description here\"></a></p>\n\n<p>Below is the code presenting the problem:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\nApplication.ScreenUpdating = False\n\nSelect Case Target\n\n  Case \"YES\"\n    If Target = \"YES\" Then\n        Target.Offset(0, 1).Interior.ColorIndex = 6\n\n            If Not Target.Cells.Count = 1 Then\n                Exit Sub\n                    If Intersect(Target, Columns(2)) Is Nothing Then\n                        Exit Sub\n                    End If\n            End If\n    End If\n  Case Else\n    If Target = \"NO\" Then\n        Target.Offset(0, 1) = \"NULL\"\n        Target.Offset(0, 2) = \"NULL\"\n            If Not Target.Cells.Count = 1 Then\n                Exit Sub\n                    If Intersect(Target, Columns(2)) Is Nothing Then\n                        Exit Sub\n                            If Intersect(Target, Columns(2)) Is Nothing Then\n                                Exit Sub\n                            End If\n                    End If\n            End If\n    End If\n  End Select\nEnd Sub\n</code></pre>\n\n<p>I tried to figure out how to prevent this error many times, but I haven't been successful. I would appreciate any help in figuring this out!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 8533306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f0154e3bf9010cc8d4d3807516bf44?s=128&d=identicon&r=PG&f=1", "display_name": "Xire", "link": "https://stackoverflow.com/users/8533306/xire"}, "is_accepted": false, "score": 1, "last_activity_date": 1504709965, "creation_date": 1504709965, "answer_id": 46078558, "question_id": 46078472, "link": "https://stackoverflow.com/questions/46078472/excel-file-dialog-box-appearing-multiple-times/46078558#46078558", "title": "Excel file dialog box appearing multiple times", "body": "<p>you can make it shorter :</p>\n\n<pre><code>filepath = Application.GetOpenFilename(\"All files (*.*),*.*\")\nIf filepath = False Then Exit Sub\nMsgBox filepath \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504711331, "post_id": 46078741, "comment_id": 79119385, "body": "<code>If .Show &lt;&gt; -1</code> just doesn&#39;t look right at all. That condition will <code>Exit Sub</code> if <code>.Show</code> returns a <code>Variant&#47;Boolean</code> (<code>False</code>), but also it it returns a <code>Variant&#47;String</code> actual file name, leaving <code>strPathAndFile</code> (wow dat name) unassigned."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504712467, "post_id": 46078741, "comment_id": 79120092, "body": "Actually, according to the help file, the Show method <code>&quot;Displays a file dialog box and returns a Long indicating whether the user pressed the Action button (-1) or the Cancel button (0). &quot;</code>.  So it would seem appropriate.  And, also, the file name is actually returned from the SelectionItems property.  Or am I missing something?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504712558, "post_id": 46078741, "comment_id": 79120146, "body": "Gah, sorry I got confused with other means to do the same thing. Regardless, seems to me that checking <code>.SelectedItems.Count = 0</code> would be much easier to read. Does what it says, says what it does."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504712721, "post_id": 46078741, "comment_id": 79120245, "body": "Yeah, I would agree with you there.  Using the <code>.SelectedItems.Count = 0</code> is easier to read."}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1504710477, "creation_date": 1504710477, "answer_id": 46078741, "question_id": 46078472, "link": "https://stackoverflow.com/questions/46078472/excel-file-dialog-box-appearing-multiple-times/46078741#46078741", "title": "Excel file dialog box appearing multiple times", "body": "<p>In your code, you're calling the Show method twice.  Hence the dialog box displays twice.  Try the following instead...</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim strPathAndFile As String\n    With Application.FileDialog(msoFileDialogOpen)\n        .Title = \"Choose File\"\n        .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then Exit Sub\n        strPathAndFile = .SelectedItems(1)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 3, "last_activity_date": 1504710480, "creation_date": 1504710480, "answer_id": 46078742, "question_id": 46078472, "link": "https://stackoverflow.com/questions/46078472/excel-file-dialog-box-appearing-multiple-times/46078742#46078742", "title": "Excel file dialog box appearing multiple times", "body": "<p>The <code>.Show</code> method displays the File Dialog similarly to <code>Userform.Show</code>.  So every time you call <code>.Show</code> the Dialog is displayed.</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogOpen)\n    .Title = \"Choose File\"\n    .AllowMultiSelect = False\n    .Show\n    If .SelectedItems.Count = 0 Then\n        Exit Sub\n    Else\n        FileSelected = .SelectedItems(1)\n    End If\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8569800, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bac9bc8c0edb5f2ea8093016819aa925?s=128&d=identicon&r=PG&f=1", "display_name": "Mdurocher", "link": "https://stackoverflow.com/users/8569800/mdurocher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1504724781, "creation_date": 1504709748, "last_edit_date": 1504724781, "question_id": 46078472, "link": "https://stackoverflow.com/questions/46078472/excel-file-dialog-box-appearing-multiple-times", "title": "Excel file dialog box appearing multiple times", "body": "<p>I am using <code>Application.FileDialog(msoFileDialogOpen)</code> to allow a user to select a file to import data from. However, after the user selects a file it pops open the file dialog box again asking them to choose a file. It will do this 2-3 times before it continues on.</p>\n\n<p>Have I accidentally created a loop?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nSet myFile = Application.FileDialog(msoFileDialogOpen)\n\nWith myFile\n    .Title = \"Choose File\"\n\n    .AllowMultiSelect = False\n\n    If .Show &lt;&gt; -1 Then\n       Exit Sub\n       ElseIf .Show &lt;&gt; 0 Then\n       FileSelected = .SelectedItems(1)\n    End If\nEnd With\n\n'data location &amp; range to copy\n\nmydata = \"='[FileSelected]'!$C$10:$C$21\" '&lt;&lt; change as required\n\n'link to worksheet\nWith ThisWorkbook.Worksheets(1).Range(\"C10:C21\") '&lt;&lt; change as required\n.Formula = mydata\n'convert formula to text\n.Value = .Value\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>So I have tried each of your solutions, and I am still getting two open file dialog boxes, however there is a difference between the two that I didn't notice before. the first box has the appropriate \"Choose File\" title, however the second box has \"Update Values: FilesSelected\" for the title. I also have added the last few lines that I excluded before. Thanks again for all your help.  </p>\n"}, {"tags": ["vba", "excel", "excelquery"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504710403, "post_id": 46078441, "comment_id": 79118717, "body": "Does it help if you use: <code>Destination:=Activesheet.Range(&quot;$A$1&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 8569676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ef2c2c55083e10900f29c61f2951e7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume B.", "link": "https://stackoverflow.com/users/8569676/guillaume-b"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504711061, "post_id": 46078441, "comment_id": 79119203, "body": "Thx for the answer. I tried the following destination: range(&quot;$A$1&quot;), activesheet.range(&quot;$A$1&quot;), ThisWorkbook.Sheets(&quot;Sessions&quot;).Range(&quot;$A$1&quot;) I precise that the path specified is the right one (link to the folder containing the file on my computer)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504772219, "post_id": 46078441, "comment_id": 79144180, "body": "Try removing the Array() command from the Source argument - it is not needed."}, {"owner": {"reputation": 1, "user_id": 8569676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ef2c2c55083e10900f29c61f2951e7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume B.", "link": "https://stackoverflow.com/users/8569676/guillaume-b"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504773864, "post_id": 46078441, "comment_id": 79145234, "body": "I&#39;ll check, it may be linked to this indeed. After rebuilding my program step by step, I found that the problem was coming from the &quot;Option base 1&quot; that I put at top of the module. So the array may not be read properly."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8569676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ef2c2c55083e10900f29c61f2951e7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume B.", "link": "https://stackoverflow.com/users/8569676/guillaume-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1504774321, "creation_date": 1504774321, "answer_id": 46091970, "question_id": 46078441, "link": "https://stackoverflow.com/questions/46078441/excel-vba-listobjects-add-querytable-error-9/46091970#46091970", "title": "Excel VBA listobjects.add querytable error 9", "body": "<p>The problem is comming from the \"Option base 1\" and the array used by the recorder. Keeping the option and modifying the code to avoid array works, as well as well deleting the \"Option Base 1\".</p>\n"}], "owner": {"reputation": 1, "user_id": 8569676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ef2c2c55083e10900f29c61f2951e7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume B.", "link": "https://stackoverflow.com/users/8569676/guillaume-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504774321, "creation_date": 1504709669, "last_edit_date": 1531164843, "question_id": 46078441, "link": "https://stackoverflow.com/questions/46078441/excel-vba-listobjects-add-querytable-error-9", "title": "Excel VBA listobjects.add querytable error 9", "body": "<p>I aim to get data from a csv file using an SQL request. I already made it successfully in a previous Workbook, so I copied it and modified it only on the SQL request part. I have an execution error 9 on the first line, which has not been modified after copying the code:</p>\n\n<pre><code>ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array( _\n    \"ODBC;DBQ=\" &amp; Path &amp; \";DefaultDir=\" &amp; Path &amp; _\n    \";Driver={Microsoft Access Text Driver (*.txt, *.csv)};DriverId=27;FIL=text\", _\n    \";MaxBufferSize=2048;MaxScanRows=8;PageTimeout=5;SafeTransactions=0;Threads=3;UID=admin;UserCommitSync=Yes;\" _\n    ), Destination:=ThisWorkbook.Sheets(\"Sessions\").Range(\"$A$1\")).QueryTable\n</code></pre>\n\n<p>The variable Path is the path to get to the folder where the file is stored. The Sheet \"Sessions\" is created before this line is ran, an is activated.</p>\n\n<p>This is the complete code of the request:</p>\n\n<pre><code>With ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array( _\n    \"ODBC;DBQ=\" &amp; Path &amp; \";DefaultDir=\" &amp; Path &amp; _\n    \";Driver={Microsoft Access Text Driver (*.txt, *.csv)};DriverId=27;FIL=text\", _\n    \";MaxBufferSize=2048;MaxScanRows=8;PageTimeout=5;SafeTransactions=0;Threads=3;UID=admin;UserCommitSync=Yes;\" _\n    ), Destination:=ThisWorkbook.Sheets(\"Sessions\").Range(\"$A$1\")).QueryTable\n    .CommandText = Array( _\n    Selection &amp; Chr(13) &amp; Chr(10) &amp; \"FROM `\" &amp; NameFile(1) &amp; \"` `\" &amp; NameFile(2) &amp; \"`\" &amp; _\n    Chr(13) &amp; Chr(10) &amp; Condition)\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"Session\"\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>I am quite new with connections in VBA, as it is only my second program using it. It is probably very simple to correct but I did not find a working solution for my case.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504710245, "post_id": 46078348, "comment_id": 79118577, "body": "It&#39;s not really clear what the problem with using <code>i</code> is"}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504711191, "post_id": 46078348, "comment_id": 79119290, "body": "The approved answer in <a href=\"https://stackoverflow.com/questions/41945089/vba-create-several-textboxes-comboboxes-dynamically-in-userform\" title=\"vba create several textboxes comboboxes dynamically in userform\">stackoverflow.com/questions/41945089/&hellip;</a> explains it better than I can. From what I gathered, <code>Combobox1</code> is a default name for the control, so I can&#39;t use <code>&quot;Combobox&quot; &amp; i</code> to name it. They suggested that <code>&quot;ComboBox&quot; &amp; i</code> would work. That&#39;s not the bulk of my question. My question is how to dynamically add labels and textboxes to a predefined form. I thought putting the code for one each in a <code>for...next</code> loop would work, but it leaves the form blank, for some reason."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504711347, "post_id": 46078348, "comment_id": 79119399, "body": "You can rename the controls unless another control has it&#39;s name."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504713385, "post_id": 46078348, "comment_id": 79120655, "body": "Instead of worrying about the controls names, it would probably be easier to create two class level collections and add the controls to the collection as they are created."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504713880, "post_id": 46078348, "comment_id": 79120969, "body": "In that case all you need to do is not use the default &quot;base&quot; name of &quot;Textbox&quot; and just use (eg) &quot;txtBox&quot;   Then there&#39;s no chance of names colliding."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504722037, "post_id": 46079555, "comment_id": 79125646, "body": "PERFECT!! Had to make a few modifications as everything was mushed together in my userform, but it works our perfectly. Updating my original code to show the results. Thanks."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504726249, "post_id": 46079555, "comment_id": 79127844, "body": "Next issue...how do you get the data from these dynamically created textboxes? I tried using <code>MultipleOptionForm.Textbox1.Value</code>, but it&#39;s not allowing me to view it in a <code>MsgBox</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504726669, "post_id": 46079555, "comment_id": 79128056, "body": "I appended the anser to your &quot;Next Issue&quot; to my answer."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504728892, "post_id": 46079555, "comment_id": 79129181, "body": "I just tried that and I&#39;m still not getting the <code>MsgBox</code> to show. I even checked the button name (<code>AsgnFLNButton</code>) and the procedure that handles the click (<code>Sub AsgnFLNButton_Click()</code>). Not sure what I&#39;m doing wrong. I should be able to get the value of the textbox, but it&#39;s like the form pops up and prevents the button click event to occur."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504788994, "post_id": 46079555, "comment_id": 79155668, "body": "I&#39;m still at a loss. If I make a function to accept the button click within the bulk of my code, the form does nothing. If I attach the function to the actual button itself, then I get an out of range error because there&#39;s nothing feeding the function from the bulk of the code. I even tried <code>UserArray = Module1.VERIFY_MULTIPLE.UserArray</code> and still get an error. Any ideas, or do I have to ask a separate question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504797481, "post_id": 46079555, "comment_id": 79162245, "body": "A separate question would be best.  It&#39;s too hard to explain things in comments."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 5, "last_activity_date": 1504726635, "last_edit_date": 1504726635, "creation_date": 1504713109, "answer_id": 46079555, "question_id": 46078348, "link": "https://stackoverflow.com/questions/46078348/adding-multiple-labels-and-textboxes-to-an-excel-userform-during-runtime-using-v/46079555#46079555", "title": "adding multiple labels and textboxes to an Excel userform during runtime using vba", "body": "<p>Lou the answer to the question is misleading.  The question wants to provide a default name when adding the control by changing its ProgID ( bstrProgID is a string that references the class that is to be created).   </p>\n\n<p>You can rename the new controls provided that another control does not have the same name. </p>\n\n<p>You can also pass the controls name as an argument to the <code>Controls.Add</code> method. </p>\n\n<p>Your labels are not showing is that you never set the <code>Label.Caption</code> value.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lU6j2.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/lU6j2.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub CreateControl()\n    Dim newLbl As MSForms.Label\n    Dim newTxt As MSForms.Control\n    Dim i As Integer, TopAmt\n    Dim UserArray As Variant\n\n    TopAmt = 50\n    UserArray = Array(\"Cat\", \"Dog\", \"Horse\", \"Gorrilla\")\n\n    For i = LBound(UserArray) To UBound(UserArray)\n        Set newLbl = MultipleOptionForm.Controls.Add(\"Forms.Label.1\")\n        With newLbl\n            .Name = \"Label\" &amp; i\n            .Left = 50\n            .Top = TopAmt\n            .Visible = True\n            .Caption = UserArray(i)\n            Debug.Print .Name,\n        End With\n\n        Set newTxt = MultipleOptionForm.Controls.Add(bstrProgID:=\"Forms.Textbox.1\", Name:=\"Textbox\" &amp; i)\n        With newTxt\n            .Left = 100\n            .Top = TopAmt\n            .Visible = True\n            Debug.Print .Name\n        End With\n        TopAmt = TopAmt + newTxt.Height\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Next Issue: how do you get the data from these dynamically created textboxes?</h2>\n\n<pre><code>Dim newTxt As MSForms.Control\nFor i = LBound(UserArray) To UBound(UserArray)\n    set newTxt  =  MultipleOptionForm.Controls(\"Textbox\" &amp; i)\n    If UserArray(i) &lt;&gt; newTxt.Value then\n        'Do something\n    End if\nNext\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5352, "favorite_count": 4, "accepted_answer_id": 46079555, "answer_count": 1, "score": 2, "last_activity_date": 1504726635, "creation_date": 1504709440, "last_edit_date": 1504723190, "question_id": 46078348, "link": "https://stackoverflow.com/questions/46078348/adding-multiple-labels-and-textboxes-to-an-excel-userform-during-runtime-using-v", "title": "adding multiple labels and textboxes to an Excel userform during runtime using vba", "body": "<p>I'm creating an inventory management tool with Excel VBA. I've created code that gathers a list of names from a drop down box on Internet Explorer and puts them into an array.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aMRru.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aMRru.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I need to do is something similar to <a href=\"https://stackoverflow.com/questions/41945089/vba-create-several-textboxes-comboboxes-dynamically-in-userform\">vba create several textboxes comboboxes dynamically in userform</a>, but I would be dynamically adding labels for the user names and textboxes for the number of FLNs each person would be receiving.  These would then go into a predefined userform I've already created.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7u1IY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7u1IY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Per the code example above, I realize I can't use <code>.Name = \"Textbox\" &amp; i</code> to rename the next label or textbox. <code>i</code> has to equal to an ever-changing list, so it can't be set in stone; hence why there has to be as many labels and textboxes as <code>UBound(UserArray)</code>.</p>\n\n<p><strong>UPDATED</strong></p>\n\n<pre><code>Private Sub CreateControl()\n    Dim newTxt As msforms.Control, newLbl\n    Dim i As Integer, TopAmt\n    Dim UserArray As String\n\n    TopAmt = 30\n\n    For i = LBound(MyArray) + 1 To UBound(MyArray) - 1\n        Set newLbl = MultipleOptionForm.Controls.Add(\"Forms.Label.1\")\n        With newLbl\n            .Name = \"Label\" &amp; i\n            .Left = 10\n            .Top = TopAmt\n            .WordWrap = False\n            .AutoSize = True\n            .Visible = True\n            .Caption = MyArray(i)\n            Debug.Print .Name,\n        End With\n\n        Set newTxt = MultipleOptionForm.Controls.Add(bstrProgID:=\"Forms.Textbox.1\", Name:=\"Textbox\" &amp; i)\n        With newTxt\n            .Left = 150\n            .Top = TopAmt\n            .Visible = True\n            .Width = 20\n            Debug.Print .Name\n        End With\n        TopAmt = TopAmt + newTxt.Height\n    Next\n\n    MultipleOptionForm.Show\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/N0rlj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N0rlj.png\" alt=\"Any suggestions on how to do this, if possible? I&#39;d hate to use the Excel spreadsheet itself to accomplish this.\"></a></p>\n"}, {"tags": ["vba", "excel", "loops", "type-mismatch"], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 51, "user_id": 7243081, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/xtahl.jpg?s=128&g=1", "display_name": "euranoo", "link": "https://stackoverflow.com/users/7243081/euranoo"}, "edited": false, "score": 0, "creation_date": 1504862116, "post_id": 46078090, "comment_id": 79188029, "body": "On which line??"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1504708709, "creation_date": 1504708709, "answer_id": 46078090, "question_id": 46077866, "link": "https://stackoverflow.com/questions/46077866/worksheets-loop-type-mismatch-error/46078090#46078090", "title": "Worksheets loop type mismatch error", "body": "<p>Try using this instead</p>\n\n<pre><code>Dim y As Long\nDim PodSheet As Worksheet\n\nSet PodSheet = ThisWorkbook.Sheets(\"Podsumowanie\")\n\nFor y = 1 To ThisWorkbook.Worksheets.Count\n    With ThisWorkbook.Sheets(y)\n        If .Cells(1, 47).Value2 = 1 Then\n            PodSheet.Cells(2, y + 1) = .Range(\"U2\")\n            PodSheet.Cells(3, y + 1) = .Range(\"V2\")\n            PodSheet.Cells(4, y + 1) = .Range(\"W2\")\n            PodSheet.Cells(5, y + 1) = .Range(\"P3\")\n            PodSheet.Cells(6, y + 1) = .Range(\"Q3\")\n            PodSheet.Cells(7, y + 1) = .Range(\"R3\")\n            PodSheet.Cells(8, y + 1) = .Range(\"S3\")\n        Else\n            PodSheet.Cells(2, y + 1) = .Range(\"U2\")\n            PodSheet.Cells(3, y + 1) = .Range(\"V2\")\n            PodSheet.Cells(4, y + 1) = .Range(\"W2\")\n            PodSheet.Cells(5, y + 1) = .Range(\"P8\")\n            PodSheet.Cells(6, y + 1) = .Range(\"Q8\")\n            PodSheet.Cells(7, y + 1) = .Range(\"R8\")\n            PodSheet.Cells(8, y + 1) = .Range(\"S8\")\n        End If\n    End With\nNext y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1504918205, "creation_date": 1504918205, "answer_id": 46126204, "question_id": 46077866, "link": "https://stackoverflow.com/questions/46077866/worksheets-loop-type-mismatch-error/46126204#46126204", "title": "Worksheets loop type mismatch error", "body": "<p><strong>Type Mismatch error</strong> is caused when <code>Cells(1, 47)</code> contains an error - to avoid it use <strong><code>IsError()</code></strong>\nAnother issue will be caused when the cell is empty or doesn't contain a number</p>\n\n<p>You can also minimize repetition like in Tom's answer, and not .Activate each sheet<br>\nThis contains all suggestions, but is not tested (you didn't include the full procedure)</p>\n\n<hr>\n\n<pre><code>Dim y As Long, c As Long, thisCol As Long, pCol As Long\nDim ws As Worksheet, podWs As Worksheet, cel As Range\n\nSet podWs = ThisWorkbook.Worksheets(\"Podsumowanie\")\n\nFor Each ws In ThisWorkbook.Worksheets\n    With ws\n        pCol = .Index + 1\n        podWs.Cells(2, pCol) = .Range(\"U2\")\n        podWs.Cells(3, pCol) = .Range(\"V2\")\n        podWs.Cells(4, pCol) = .Range(\"W2\")\n        Set cel = .Cells(1, 47)\n        If Not IsError(cel) Then\n            If IsNumeric(cel.Value2) Then\n                thisCol = IIf(cel = 1, 3, 8)\n                podWs.Cells(5, pCol) = .Range(\"P\" &amp; thisCol)\n                podWs.Cells(6, pCol) = .Range(\"Q\" &amp; thisCol)\n                podWs.Cells(7, pCol) = .Range(\"R\" &amp; thisCol)\n                podWs.Cells(8, pCol) = .Range(\"S\" &amp; thisCol)\n            End If\n        End If\n    End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7243081, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/xtahl.jpg?s=128&g=1", "display_name": "euranoo", "link": "https://stackoverflow.com/users/7243081/euranoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504918400, "creation_date": 1504708151, "last_edit_date": 1504918400, "question_id": 46077866, "link": "https://stackoverflow.com/questions/46077866/worksheets-loop-type-mismatch-error", "title": "Worksheets loop type mismatch error", "body": "<p>I'm getting \"error13 type mismatch\" when iterating over all worksheets in the workbook in line 7 of the code (<code>If ActiveSheet.Cells(1, 47) = 1 Then</code>). Does anyone know how to fix this?</p>\n\n<pre><code>Dim y As Integer\nDim c As Integer\nDim ws_num As Integer\n\nDim starting_ws As Worksheet\nSet starting_ws = ActiveSheet 'remember which worksheet is active in the beginning\nws_num = ThisWorkbook.Worksheets.Count\nFor y = 1 To ws_num\n    ThisWorkbook.Worksheets(y).Activate\n    If ActiveSheet.Cells(1, 47) = 1 Then\n        Worksheets(\"Podsumowanie\").Cells(2, y + 1) = ThisWorkbook.Worksheets(y).Range(\"U2\")\n        Worksheets(\"Podsumowanie\").Cells(3, y + 1) = ThisWorkbook.Worksheets(y).Range(\"V2\")\n        Worksheets(\"Podsumowanie\").Cells(4, y + 1) = ThisWorkbook.Worksheets(y).Range(\"W2\")\n\n        Worksheets(\"Podsumowanie\").Cells(5, y + 1) = ThisWorkbook.Worksheets(y).Range(\"P3\")\n        Worksheets(\"Podsumowanie\").Cells(6, y + 1) = ThisWorkbook.Worksheets(y).Range(\"Q3\")\n        Worksheets(\"Podsumowanie\").Cells(7, y + 1) = ThisWorkbook.Worksheets(y).Range(\"R3\")\n        Worksheets(\"Podsumowanie\").Cells(8, y + 1) = ThisWorkbook.Worksheets(y).Range(\"S3\")\n    Else\n        Worksheets(\"Podsumowanie\").Cells(2, y + 1) = ThisWorkbook.Worksheets(y).Range(\"U2\")\n        Worksheets(\"Podsumowanie\").Cells(3, y + 1) = ThisWorkbook.Worksheets(y).Range(\"V2\")\n        Worksheets(\"Podsumowanie\").Cells(4, y + 1) = ThisWorkbook.Worksheets(y).Range(\"W2\")\n\n        Worksheets(\"Podsumowanie\").Cells(5, y + 1) = ThisWorkbook.Worksheets(y).Range(\"P8\")\n        Worksheets(\"Podsumowanie\").Cells(6, y + 1) = ThisWorkbook.Worksheets(y).Range(\"Q8\")\n        Worksheets(\"Podsumowanie\").Cells(7, y + 1) = ThisWorkbook.Worksheets(y).Range(\"R8\")\n        Worksheets(\"Podsumowanie\").Cells(8, y + 1) = ThisWorkbook.Worksheets(y).Range(\"S8\")\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "delete-row", "vba"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 3, "creation_date": 1504707737, "post_id": 46077673, "comment_id": 79116632, "body": "The fastest way would be to select all the rows first then delete them at once using <code>Range.Delete</code>. It&#39;s the delete operation that takes the most time."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 2, "creation_date": 1504708008, "post_id": 46077673, "comment_id": 79116863, "body": "Just adding to John Wu&#39;s answer, your range might be non contiguous, so you might need to create a non contiguous range"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1504715782, "post_id": 46077673, "comment_id": 79122130, "body": "Also use <code>Application.ScreenUpdating = False</code> before the loop (and don&#39;t forget to turn it back on afterwards)"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 3, "last_activity_date": 1504708158, "creation_date": 1504708158, "answer_id": 46077868, "question_id": 46077673, "link": "https://stackoverflow.com/questions/46077673/improving-a-loop-to-delete-rows-in-excel-faster/46077868#46077868", "title": "Improving a Loop to delete rows in excel faster", "body": "<p>Assign all of the rows that you want to delete to a range and then delete the range in one go. This is much faster then deleting one by one and prevents errors. </p>\n\n<pre><code>Const colBD As Long = 56\nDim IRow     As Long\nDim LstRow  As Long\nDim DelRng As Range\n\nLstRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIRow = 3\n\n'loop to delete rows with zero in colBD\nDo While IRow &lt;= LstRow\n    If Cells(IRow, colBD) = 0 Then\n        If DelRng Is Nothing Then\n            Set DelRng = Cells(IRow, 1)\n        Else\n            Set DelRng = Union(DelRng, Cells(IRow, 1))\n        End If\n    Else\n        IRow = IRow + 1                     ' move to next row\n    End If\nLoop\n\nIf Not DelRng Is Nothing Then DelRng.EntireRow.Delete\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 4, "last_activity_date": 1504708204, "creation_date": 1504708204, "answer_id": 46077892, "question_id": 46077673, "link": "https://stackoverflow.com/questions/46077673/improving-a-loop-to-delete-rows-in-excel-faster/46077892#46077892", "title": "Improving a Loop to delete rows in excel faster", "body": "<p>The comment above is correct, better to delete all at once, however if looping it best to start at the end and work back.  It easy to get in an endless loop.</p>\n\n<pre><code>Const colBD As Long = 56\nDim IRow As Long\nDim LstRow As Long\nDim i As Integer\n\nLstRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIRow = 3\n\n'Always start with the last row and work towards the first when deleting rows\nFor i= LstRow to IRow Step - 1\n    If Cells(i, colBD) = 0 Then\n        Cells(i, 1).EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 3, "last_activity_date": 1504710047, "creation_date": 1504710047, "answer_id": 46078587, "question_id": 46077673, "link": "https://stackoverflow.com/questions/46077673/improving-a-loop-to-delete-rows-in-excel-faster/46078587#46078587", "title": "Improving a Loop to delete rows in excel faster", "body": "<p>I'd filter for <code>0</code> first and then delete all visible rows:</p>\n\n<pre><code>Const colBD As Long = 56\nDim IRow As Long\nDim LstRow As Long\n\nLstRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIRow = 3\n\nActiveSheet.Range(\"A1:BD1\").AutoFilter Field:=colBD, Criteria1:=\"0\"\nRange(\"BD\" &amp; IRow &amp; \":BD\" &amp; LstRow).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8569484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cd05c54862e2fef58eeca4d507504a6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan B", "link": "https://stackoverflow.com/users/8569484/ryan-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1504710047, "creation_date": 1504707614, "last_edit_date": 1531164843, "question_id": 46077673, "link": "https://stackoverflow.com/questions/46077673/improving-a-loop-to-delete-rows-in-excel-faster", "title": "Improving a Loop to delete rows in excel faster", "body": "<p>I have created a loop to delete rows if the value in column BD is zero.  The loop can take up to a half hour.  I have seen recommendations to use autofilters or create variant arrays to expedite the function.  Let me know if you can suggest a better solution for my code below.</p>\n\n<pre><code>Const colBD As Long = 56\nDim IRow     As Long\nDim LstRow  As Long\n\n\nLstRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIRow = 3\n\n'loop to delete rows with zero in colBD\nDo While IRow &lt;= LstRow\n    If Cells(IRow, colBD) = 0 Then\n        Cells(IRow, 1).EntireRow.Delete\n        LstRow = LstRow - 1             ' one less row\n    Else\n        IRow = IRow + 1                     ' move to next row\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504706732, "post_id": 46077208, "comment_id": 79115891, "body": "Unless <code>searchColumn2</code> has 2 columns, you should be using <code>And searchColumn2.Cells(i, 1).Value</code> rather than <code>And searchColumn2.Cells(i, 2).Value</code>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504706780, "post_id": 46077208, "comment_id": 79115926, "body": "Debug the code step by step, and tell us if the code itself produces an error."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504706876, "post_id": 46077208, "comment_id": 79115997, "body": "Still not working. I try to <code>MsgBox (searchColumn1.Cells(i, 1).Value)</code> it returns <code>VALUE</code> and doesn&#39;t msgbox anything."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 2, "creation_date": 1504706995, "post_id": 46077208, "comment_id": 79116098, "body": "It can be the Variable Type, try to analyze what type you are using, sometimes <code>As Variant</code>can cause errors. Also use <code>Option Explicit</code>"}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1504707317, "post_id": 46077208, "comment_id": 79116349, "body": "<code>searchColumn1.Rows.Count</code> it returns 1048576 the max rows... are you sure about it?"}, {"owner": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504707388, "post_id": 46077208, "comment_id": 79116400, "body": "At which line do you get this error?"}, {"owner": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "edited": false, "score": 0, "creation_date": 1504708537, "post_id": 46077208, "comment_id": 79117279, "body": "I found two issue :  - condition not working : parse searchColumnValue to a variable before testing - searchColumn.Rows.Count, if you select all column result in zero, and you &quot;VALUE&quot; Error"}], "answers": [{"comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504707979, "post_id": 46077696, "comment_id": 79116843, "body": "@ScottCraner Yes I was about to fix that thanks. Actually I assumed it depending on the variable name, but surely it may be a range."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1504708047, "post_id": 46077696, "comment_id": 79116896, "body": "Another method would be <code>Intersect(searchColumn1,searchColumn1.Parent.UsedRange).rows</code>"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504708432, "post_id": 46077696, "comment_id": 79117197, "body": "@ScottCraner <code>Intersect(searchColumn1,searchColumn1.Parent.UsedRange).rows</code> returns a value error without any useful info. The edited method works both for column and range."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504708559, "post_id": 46077696, "comment_id": 79117296, "body": "sorry forgot the <code>.Count</code> at the end."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504708923, "post_id": 46077696, "comment_id": 79117593, "body": "And it is just a personal quirk, yours will work fine."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1504708926, "post_id": 46077696, "comment_id": 79117596, "body": "@ScottCraner Definitely it works, thanks for this nice alternative!"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1504712256, "last_edit_date": 1504712256, "creation_date": 1504707662, "answer_id": 46077696, "question_id": 46077208, "link": "https://stackoverflow.com/questions/46077208/multi-condition-search-function-doesnt-work/46077696#46077696", "title": "Multi condition search function doesn&#39;t work", "body": "<p>Try getting column numbers with <code>.column</code> property. Also try to get the last used row number as per below:</p>\n\n<pre><code>Function betterSearch(searchValue1 As Variant, searchValue2 As Variant, _\n            searchColumn1 As Range, searchColumn2 As Range, _\n            resultColumn As Range)\n    Dim i As Long\n    For i = 1 To Cells(Rows.Count, searchColumn1.Column).End(xlUp).Row\n        If Cells(i, searchColumn1.Column).Value = searchValue1 _\n            And Cells(i, searchColumn2.Column).Value = searchValue2 Then\n            betterSearch = Cells(i, resultColumn.Column)\n            MsgBox (\"found\")\n            Exit For\n        End If\n        betterSearch = \"Not found\"\n    Next\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504712733, "post_id": 46077918, "comment_id": 79120256, "body": "Can you explain what is the point of having <code>searchColumn2</code> as an argument if you are not going to use it in the function at all? I believe OP has the searchColumn 1 and 2 as adjacent columns in his workbook so that the code must have worked for him. I believe you should change the line as <code>c2 = searchColumn2.Cells(i, 1).Value</code>?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504716055, "post_id": 46077918, "comment_id": 79122302, "body": "Also if you have an empty cell in the <code>searchColumn1</code>, the code will stop looking for the rest of the values. You should find the last non-empty row from bottom to top, not from top to bottom. You can refer to <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this</a>"}], "tags": [], "owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "is_accepted": true, "score": 2, "last_activity_date": 1504713585, "last_edit_date": 1504713585, "creation_date": 1504708286, "answer_id": 46077918, "question_id": 46077208, "link": "https://stackoverflow.com/questions/46077208/multi-condition-search-function-doesnt-work/46077918#46077918", "title": "Multi condition search function doesn&#39;t work", "body": "<p>this worked for me fine-- \n<strong>Updated</strong></p>\n\n<pre><code> Sub foo44()\n    Dim val As Variant\n    Dim c1 As Range\n    Dim c2 As Range\n    Dim c3 As Range\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set c1 = ws.Range(\"C:C\")\n    Set c2 = ws.Range(\"D:D\")\n    Set c3 = ws.Range(\"E:E\")\n\n    Debug.Print betterSearch(23, 23, c1, c2, c3)\n    End Sub\n\n\n     Function betterSearch(searchValue1 As Variant, searchValue2 As Variant, searchColumn1 As Range, searchColumn2 As Range, resultColumn As Range)\n        Dim i As Long\n        Dim c1 As Variant\n        Dim c2 As Variant\n        For i = 1 To searchColumn1.End(xlDown).Row\n             c1 = searchColumn1.Cells(i, 1).Value\n             c2 = searchColumn2.Cells(i, 1).Value\n            ' Debug.Print c1\n             'Debug.Print c2\n            If c1 = searchValue1 And c2 = searchValue2 Then\n                betterSearch = resultColumn.Cells(i, 1).Value\n                    Exit For\n            End If\n            betterSearch = \"Not found\"\n        Next\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 46077918, "answer_count": 2, "score": 0, "last_activity_date": 1504713585, "creation_date": 1504706333, "question_id": 46077208, "link": "https://stackoverflow.com/questions/46077208/multi-condition-search-function-doesnt-work", "title": "Multi condition search function doesn&#39;t work", "body": "<p>I have a function that takes 2 search values and 2 columns and 1 result column (total 5 arguments) and returns the value from the last column if the first two conditions are met. But it doesn't work and returns <code>VALUE</code> error. I can't figure out what's wrong here. </p>\n\n<pre><code> Function betterSearch(searchValue1 As Variant, searchValue2 As Variant, _\n            searchColumn1 As Variant, searchColumn2 As Variant, _\n            resultColumn As Variant)\n    Dim i As Integer\n    For i = 1 To searchColumn1.Rows.Count\n        If searchColumn1.Cells(i, 1).Value = searchValue1 _\n                    And searchColumn2.Cells(i, 2).Value = searchValue2 Then\n            betterSearch = resultColumn.Cells(i, 1)\n                MsgBox (\"found\")\n                Exit For\n        End If\n        betterSearch = \"Not found\"\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 2, "creation_date": 1504705392, "post_id": 46076853, "comment_id": 79114894, "body": "you only run the <code>RandBetween</code> once, and then set the value of all cells in the range to the result. you have to loop the range, and call <code>RandBetween</code> for every cell."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1504705885, "last_edit_date": 1504705885, "creation_date": 1504705473, "answer_id": 46076918, "question_id": 46076853, "link": "https://stackoverflow.com/questions/46076853/how-to-generate-randomly-zeros-and-ones-in-a-range-with-vba/46076918#46076918", "title": "how to generate randomly zeros and ones in a range with vba?", "body": "<p>You will either need to loop and put the value in each cell individually or:</p>\n\n<p>We can put the formula in the entire range, calculate and then reassign just the values to that range.</p>\n\n<pre><code>Private Sub Btn_RandomNumbers_Click()\n With ThisWorkbook.Sheets(\"Sheet1\").Range(\"c3:c302\")\n    .Formula= \"=RANDBETWEEN(0,1)\"\n    Application.Calculate\n    .Value = .Value\n End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1504705479, "creation_date": 1504705479, "answer_id": 46076919, "question_id": 46076853, "link": "https://stackoverflow.com/questions/46076853/how-to-generate-randomly-zeros-and-ones-in-a-range-with-vba/46076919#46076919", "title": "how to generate randomly zeros and ones in a range with vba?", "body": "<p>You generate the value once and the fill the whole range with this value. If you want each cell to be random, you need to create a loop and iterate through each cell.</p>\n\n<p>Pseudo code:</p>\n\n<pre><code>For each Cell in Range Do\n 'write random number in \"Cell\"\nNext Cell\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6679009, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6f808f90af1b8ef0e5c1cbe89a53693d?s=128&d=identicon&r=PG&f=1", "display_name": "brain_dead_cow", "link": "https://stackoverflow.com/users/6679009/brain-dead-cow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504705885, "creation_date": 1504705307, "question_id": 46076853, "link": "https://stackoverflow.com/questions/46076853/how-to-generate-randomly-zeros-and-ones-in-a-range-with-vba", "title": "how to generate randomly zeros and ones in a range with vba?", "body": "<p>I am trying to generate two random integers 0 and 1 in a range using vba; However when i run the sub it only fills the cells  with the <strong>same value</strong>; either 1 or 0. \nWhere is the problem with the code?</p>\n\n<pre><code>Private Sub Btn_RandomNumbers_Click()\n ThisWorkbook.Sheets(\"Sheet1\").Range(\"c3:c302\").value = \nApplication.Choose(Application.RandBetween(1, 2), 0, 1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1504706247, "post_id": 46076343, "comment_id": 79115546, "body": "FYI, semantically a <code>Function</code> should <i>return a value</i>. If you&#39;re not returning anything from a <code>Function</code> procedure, consider making it a <code>Sub</code> instead. Also <code>Call</code> is obsolete/redundant/not needed, and you need to get a grip on proper indentation, and specify <code>Option Explicit</code> to avoid having VBA happily compiling typos and thus introducing easily avoidable bugs. My <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> OSS VBE add-in can help you with all of that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504709844, "post_id": 46076343, "comment_id": 79118278, "body": "That&#39;s probably documented on MSDN, isn&#39;t it?"}], "answers": [{"tags": [], "owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "is_accepted": true, "score": 0, "last_activity_date": 1504710773, "creation_date": 1504710773, "answer_id": 46078835, "question_id": 46076343, "link": "https://stackoverflow.com/questions/46076343/the-range-cannot-be-deleted-when-adding-a-table/46078835#46078835", "title": "&quot;The range cannot be deleted&quot; when adding a table", "body": "<p>Setting a more specific range solved the issue. </p>\n\n<p>Set objRange = objDoc.Range(Start:=0, End:=0)</p>\n\n<p>Does not give multiple tables but at least it does not cause an error. </p>\n"}], "owner": {"reputation": 783, "user_id": 1082410, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2fd9ea2cafe88dda86f7663839fa12c5?s=128&d=identicon&r=PG", "display_name": "Tolure", "link": "https://stackoverflow.com/users/1082410/tolure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 46078835, "answer_count": 1, "score": 0, "last_activity_date": 1504710773, "creation_date": 1504703812, "last_edit_date": 1504706041, "question_id": 46076343, "link": "https://stackoverflow.com/questions/46076343/the-range-cannot-be-deleted-when-adding-a-table", "title": "&quot;The range cannot be deleted&quot; when adding a table", "body": "<p>I have a function to create a table in my Word document. </p>\n\n<p>Running first <code>Main</code> in WordManager assigns <code>objWord</code> and <code>objDoc</code>. Running <code>FnAddTableToWordDocument</code> in WordFormating works on the first run but fails every time on the second run. </p>\n\n<p>The error I get is the following:</p>\n\n<blockquote>\n  <p>Run-time error 6028<br>\n  The range cannot be deleted</p>\n</blockquote>\n\n<p>On line:</p>\n\n<pre><code>objDoc.Tables.Add objRange, intNoOfRows, intNoOfColumns\n</code></pre>\n\n<p>Two Modules:</p>\n\n<p>Module #1 - WordManager:</p>\n\n<pre><code>Module WordManager    \nPublic objWord As Word.Application\nPublic objDoc As Word.Document\n\nSub Main() ' This is to be replaced by a call from the actual CA tool.\n    Call initWordManager(\"[string path]\", \"test2.doc\")\nEnd Sub\n\nSub initWordManager(Path, Name)\n    sFilePath = Path\n    sFileName = Name\n\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = True\n\n    Set objDoc = objWord.Documents.Add\nEnd Sub\n</code></pre>\n\n<p>Module #2 - WordFormating:</p>\n\n<pre><code>Function FnAddTableToWordDocument()\n\n   Dim intNoOfRows\n\n   Dim intNoOfColumns\n\n   Dim objRange\n\n   Dim objTable\n\n intNoOfRows = 5\n\n intNoOfColumns = 3\n\n\n  objWord.Visible = True\n\n  Set objRange = objDoc.Range\n\n  objDoc.Tables.Add objRange, intNoOfRows, intNoOfColumns\n\n  Set objTable = objDoc.Tables(1)\n\n    objTable.Borders.Enable = True\n\n  For i = 1 To intNoOfRows\n\n     For j = 1 To intNoOfColumns\n\n objTable.Cell(i, j).Range.Text = \"Sumit_\" &amp; i &amp; j\n\n     Next\n\n  Next\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet-function", "worksheet"], "comments": [{"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504703849, "post_id": 46076105, "comment_id": 79113673, "body": "you may have to be a bit more specific. Maybe show samples from your data. When is a calculation performed? In your code you have <code>B6:B12</code> but in your question you have <code>C6:F12</code> and <code>B6:F12</code>."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1504704402, "post_id": 46076105, "comment_id": 79114122, "body": "Are you trying to run the function only if there is a value in Range<code>B6:B12</code>? If it is what you are trying, use <code>If aCell &lt;&gt; &quot;&quot; Then</code>or <a href=\"https://stackoverflow.com/questions/409434/automatically-execute-an-excel-macro-on-a-cell-change\">on cell or range change</a>"}, {"owner": {"reputation": 403, "user_id": 4656407, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/242c932d9f24259ed8a2fa06e2bf3645?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4656407/chris"}, "edited": false, "score": 0, "creation_date": 1504705694, "post_id": 46076105, "comment_id": 79115106, "body": "separate calculations are performed in all cells B6:F12, so that is 35 different calculations.  When the calculations that are in B6:B12 happen i want SomeFunction() to be called.  As it sits any time ANY calculation anywhere on the worksheet is called, the SomeFunction()  is called via the iteration."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 4656407, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/242c932d9f24259ed8a2fa06e2bf3645?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4656407/chris"}, "edited": false, "score": 0, "creation_date": 1504727031, "post_id": 46077371, "comment_id": 79128257, "body": "Is ActiveCell a protected variable that is a part of worksheet_calculate? or do i have to declare it?"}, {"owner": {"reputation": 403, "user_id": 4656407, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/242c932d9f24259ed8a2fa06e2bf3645?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4656407/chris"}, "edited": false, "score": 0, "creation_date": 1504728556, "post_id": 46077371, "comment_id": 79129013, "body": "sorry this ends up with object error 1006, as i am creating a value in a cell on another worksheet as well as creating a worksheet sometimes if one doesnt exist, and im assuming when it creates the worksheet and/or creates the value in the cell it moves the active cell and cause this to have issues."}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1504770304, "last_edit_date": 1504770304, "creation_date": 1504706755, "answer_id": 46077371, "question_id": 46076105, "link": "https://stackoverflow.com/questions/46076105/how-to-limit-worksheet-calculate-to-only-execute-when-specified-range-is-calcu/46077371#46077371", "title": "How to Limit Worksheet_Calculate() to Only Execute When Specified Range is Calculated", "body": "<p>Add this before you start your <code>FOR</code> loop:</p>\n\n<pre><code>If Not Application.Intersect(ActiveCell, aRange) Is Nothing Then\n</code></pre>\n\n<p>This will only trigger the <code>FOR</code> loop if you are in the given range</p>\n\n<p><strong>EDIT</strong><br>\nI have the code setup like below and it seems to work for me:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Dim oWS As Worksheet: Set oWS = ThisWorkbook.Worksheets(\"Sheet8\")\n    Dim aRange As Range: Set aRange = oWS.Range(\"F6:F10\")\n    If ActiveSheet.Name = oWS.Name Then\n        If Not Application.Intersect(ActiveCell, aRange) Is Nothing Then\n            MsgBox \"In range\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 4656407, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/242c932d9f24259ed8a2fa06e2bf3645?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4656407/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1271, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504770304, "creation_date": 1504703228, "question_id": 46076105, "link": "https://stackoverflow.com/questions/46076105/how-to-limit-worksheet-calculate-to-only-execute-when-specified-range-is-calcu", "title": "How to Limit Worksheet_Calculate() to Only Execute When Specified Range is Calculated", "body": "<p>so this is a general question, Im sure this has been asked before, but i cant find much help.</p>\n\n<p>In Excel having a range in a worksheet say B6:F12 that are all the results of calculations I am having a problem with the Worksheet_Calculate() subroutine</p>\n\n<p>my problem is that with this VERY generalized code for the worksheet_calculate subroutine</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n     Dim aCell as Range\n     Dim aRange as Range\n     Set aRange = Range(B6:B12)\n     For Each aCell in aRange\n          SomeFunction(aCell)\n     Next\nEnd Sub\n</code></pre>\n\n<p>any calculation that happens in the Range C6:F12 causes the iteration through aRange to happen and unneeded calls to SomeFunction(aCell).</p>\n\n<p>How can I make this scenario only happen when there is a calculation performed on the range B6:B12 ?</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1504703793, "post_id": 46076073, "comment_id": 79113618, "body": "Do you know how to do it with the mouse? (over the data-tab -&gt; sort) then record a macro and go from there"}, {"owner": {"reputation": 81, "user_id": 4743385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6fada56d97997bbd4aa0c9af0c3783ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz Adamczewski", "link": "https://stackoverflow.com/users/4743385/mariusz-adamczewski"}, "reply_to_user": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1504704344, "post_id": 46076073, "comment_id": 79114072, "body": "I have got milions of records."}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 0, "creation_date": 1504704913, "post_id": 46076073, "comment_id": 79114515, "body": "So? Start recording a Macro, Highlight Column A and B, go to the Data-Tab -&gt; Sort the way you want to sort, stop recording the macro. Look at what was recorded and adjust it to your needs"}], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": true, "score": 1, "last_activity_date": 1504706112, "last_edit_date": 1504706112, "creation_date": 1504705442, "answer_id": 46076906, "question_id": 46076073, "link": "https://stackoverflow.com/questions/46076073/vba-sorting-data-in-two-phases/46076906#46076906", "title": "VBA Sorting Data in two phases", "body": "<p>Just create the following Sub and call it when you have any new data:</p>\n\n<pre><code>Public Sub sort_()\n    Range(\"A1\").CurrentRegion.sort Key1:=Range(\"B1\"), Order1:=xlAscending, Key2:=Range(\"A1\"), Order2:=xlAscending\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4743385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6fada56d97997bbd4aa0c9af0c3783ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz Adamczewski", "link": "https://stackoverflow.com/users/4743385/mariusz-adamczewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 46076906, "answer_count": 1, "score": -1, "last_activity_date": 1504706112, "creation_date": 1504703144, "question_id": 46076073, "link": "https://stackoverflow.com/questions/46076073/vba-sorting-data-in-two-phases", "title": "VBA Sorting Data in two phases", "body": "<p>I have got a table <br><br>\n<a href=\"https://i.stack.imgur.com/Mosum.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mosum.png\" alt=\"enter image description here\"></a></p>\n\n<p>And I dont know how to sort the data in way which i need.</p>\n\n<p>The result which I want is here:<br><br>\n<a href=\"https://i.stack.imgur.com/oiQJw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oiQJw.png\" alt=\"enter image description here\"></a></p>\n\n<p>And at the beggining I want to sort the column number 2 where are Animal and IT then after that i want to sort from A to Z only data where in second column is Animal, then sort data where in the second column is 'IT'.</p>\n\n<p>I have found only one way how could I do it.</p>\n\n<p>And... To sort the data by second column I can use </p>\n\n<pre><code>Range(\"A1:B6\").Sort Key1:=Range(\"B1\"), Order1:=xlAscending\n</code></pre>\n\n<p>But what after that? I think about... Write a loop which will go through the column 2 and for example. Will start from 1 (Animal) and go next... will be for example other value (IT), it will read number of record and -1 (in this example it will be 3). Then add fuction sort data in range.</p>\n\n<p>I dont know if it will work...</p>\n\n<p>Do you have maybe other ideas how to do it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1504702978, "post_id": 46075937, "comment_id": 79112941, "body": "Did you try it?  What did not work?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703053, "post_id": 46075937, "comment_id": 79112997, "body": "@Scott Craner, I didn&#39;t yet. I&#39;m not well used to Range properties. Anyways I thought the quesiton and the answers might be useful to future users since there&#39;s little on topic here."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1504703085, "post_id": 46075937, "comment_id": 79113027, "body": "This loop seems right, doesn&#39;t seem to have syntax errors."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703099, "post_id": 46075937, "comment_id": 79113043, "body": "It is out there.  and yes it works."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703141, "post_id": 46075937, "comment_id": 79113077, "body": "@Scott Craner I had trouble finding it then. Sure there are other people like me."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1504703234, "post_id": 46075937, "comment_id": 79113153, "body": "Another method that assumes the Cells() property, since it is one column: <code>column1(i)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703368, "post_id": 46075937, "comment_id": 79113256, "body": "And this took me one search and it was the first option when I searched <code>Range.Cells</code>: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-cells-property-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1504703403, "post_id": 46075937, "comment_id": 79113280, "body": "dim i as <b>Long</b> !!!!!  (unless you work with Excel 3.0   8-)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1504703404, "post_id": 46075937, "comment_id": 79113281, "body": "Ah, now it may not work - you&#39;ve changed <code>1000</code> to <code>column1.Height</code>.  Do you mean <code>column1.cells.count</code> instead?  If a cell height is 15 and there&#39;s 1000 cells in the column then column height = 15000 (I think), while count of cells equals 1000."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703453, "post_id": 46075937, "comment_id": 79113337, "body": "And here is an excellent one from stack overflow: <a href=\"https://stackoverflow.com/questions/25879619/whats-the-difference-between-range-item-and-range-cells\" title=\"whats the difference between range item and range cells\">stackoverflow.com/questions/25879619/&hellip;</a>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1504703532, "post_id": 46075937, "comment_id": 79113421, "body": "You can also use Union for non contiguous Range and loop through it"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703805, "post_id": 46075937, "comment_id": 79113627, "body": "@ScottCraner - I can&#39;t see the duplication.  The linked question is talking about the difference between just <code>Cells(x,y)</code> and <code>Item(x,y)</code> while this is about looping through two ranges."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504703876, "post_id": 46075937, "comment_id": 79113697, "body": "It also explain explicitly how what you want to do works.  The question might be different but the answer, answers your question."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1504706137, "post_id": 46075937, "comment_id": 79115455, "body": "@Darren Bartrup-Cook I meant to get a number of rows in the Range. The <code>coutn</code> is the correct one, I suppose?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504706532, "post_id": 46075937, "comment_id": 79115751, "body": "@ScottCraner  Not my question.   I have to disagree with you though and getting myself thoroughly confused trying to explain that. :)  <b>Ans</b> - yes, you&#39;ll need the count of the cells rather than the height."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1504706847, "post_id": 46075937, "comment_id": 79115979, "body": "@DarrenBartrup-Cook you have enough rep to vote to reopen.  I was going off the fact that the OP wanted to know if the Range.Cells() property worked, Sidd&#39;s answer not only states it will, it explains the difference between Range.Cells() and Worksheets.Cells().  As to the other error of the count, it was not in there when I went looking for the duplicate.  It was added after the fact. Also the OP stated that they wanted a place for others to find, and this will now direct them to a great instruction on that property."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504708018, "post_id": 46075937, "comment_id": 79116869, "body": "@ScottCraner.  I was reading through the code when it changed to <code>column1.Height</code> and I was just pointing out to the OP what the result of that was (not the count of cells).  I&#39;m not actually sure what the OP was asking - I assumed it was just how to loop through a couple of ranges, with the 2nd range offset by 1 column (I&#39;d use <code>For...Each</code> &amp; <code>OFFSET</code> but the OP doesn&#39;t want that).  Don&#39;t think I&#39;ll go as far as voting to re-open (that would involve me scrolling up and pressing a button!) if Ans has the Answer he&#39;s after."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1504708154, "post_id": 46075937, "comment_id": 79116974, "body": "@DarrenBartrup-Cook and apparhently he does: <a href=\"https://stackoverflow.com/questions/46077208/multi-condition-search-function-doesnt-work#46077696\" title=\"multi condition search function doesnt work%2346077696\">stackoverflow.com/questions/46077208/&hellip;</a>  Which is a great question."}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "closed_date": 1504703504, "answer_count": 0, "score": 0, "last_activity_date": 1504703153, "creation_date": 1504702788, "last_edit_date": 1504703153, "question_id": 46075937, "link": "https://stackoverflow.com/questions/46075937/excel-vba-loop-through-two-ranges-using-integer-in-for-loop", "closed_reason": "Duplicate", "title": "Excel vba loop through two ranges using integer in for loop", "body": "<p>How would I loop through two ranges using an integer, like this:</p>\n\n<pre><code>Dim column1 As Range\nSet column1=.Range(\"A1:A1000\")\nDim column2 As Range\nSet column2=.Range(\"B1:B1000\")\n\nDim i As Integer\nFor i=1 To column1.Height\n If column1.Cells(i,1).Value = someValue And column2.Cells(i,1).Value = someValue then\n   ...\n End If\nNext\n</code></pre>\n\n<p>Would this approach work? How do I access the cells of the stored ranges? Most questions and answers deal with the looping via <code>For Each</code> cycle, which is something I'd like to avoid.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1504702707, "post_id": 46075880, "comment_id": 79112746, "body": "How about <code>lblHi.Caption = &quot;Hello2&quot;</code> ?"}, {"owner": {"reputation": 11, "user_id": 6547383, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ivHRVCx1qvk/AAAAAAAAAAI/AAAAAAAAABU/I1xhUK2-HuE/photo.jpg?sz=128", "display_name": "senthil ss", "link": "https://stackoverflow.com/users/6547383/senthil-ss"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1504702813, "post_id": 46075880, "comment_id": 79112826, "body": "no. I cant able to get this id ( lblHi ). I just add to check"}], "owner": {"reputation": 11, "user_id": 6547383, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ivHRVCx1qvk/AAAAAAAAAAI/AAAAAAAAABU/I1xhUK2-HuE/photo.jpg?sz=128", "display_name": "senthil ss", "link": "https://stackoverflow.com/users/6547383/senthil-ss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504702608, "creation_date": 1504702608, "last_edit_date": 1531164843, "question_id": 46075880, "link": "https://stackoverflow.com/questions/46075880/how-to-update-a-label-caption-in-powerpoint-from-excel-in-vba", "title": "how to update a label caption in powerpoint from excel in vba", "body": "<p>I need to update a label caption using Powerpoint object from excel macro. I cant able to update.</p>\n\n<pre><code>Dim objPpt As PowerPoint.Application\nDim objPre As Presentation\nDim objSlide As Slide\nDim objLayout As CustomLayout\nDim objTxtBox As Shape\n\nSet objPpt = CreateObject(\"Powerpoint.Application\")\nSet objPre = objPpt.Presentations.Open(\"H:\\Macro\\SamplePpt.pptm\")\nActivePresentation.Slides(1).lblHi.Caption = \"Hello\"\nSet objSlide = objPre.Slides.Item(1)\nSet objTxtBox = objSlide.Shapes.Item(1)\n\nlblHi.Caption = \"Hello\"\n</code></pre>\n\n<p>Help me to do this....!!!!</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1504711778, "post_id": 46075900, "comment_id": 79119670, "body": "Thanks, good point. I had a similar routine for an array function, so just was reapplying that here. Your code is better and more efficient. Highly appreciated."}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1504716381, "post_id": 46075900, "comment_id": 79122501, "body": "Just be advised that the dim i and i in next i are not required and next i will cause error. I edited the code, but need peer review before getting applied."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 1, "creation_date": 1504716473, "post_id": 46075900, "comment_id": 79122564, "body": "You&#39;re absolutely correct. I was using <code>For i = LBound(Text) to UBound(Text)</code> and forgot to change those bits when changed to a <code>For Each Loop</code> I&#39;ll edit my answer. Good spot"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 5, "last_activity_date": 1504737299, "last_edit_date": 1504737299, "creation_date": 1504702680, "answer_id": 46075900, "question_id": 46075654, "link": "https://stackoverflow.com/questions/46075654/how-to-have-multiple-optional-arguments-in-a-user-defined-function-in-vba-excel/46075900#46075900", "title": "how to have multiple optional arguments in a user defined function in VBA/ Excel", "body": "<p>Use the <code>ParamArray</code>. The <code>ParamArray</code> must always be the last thing to be declared and must be of the type <code>Variant</code>. It will allow you to enter as many variables as you like without having to define each one of them.</p>\n\n<pre><code>Function IfAmong(TextToCheck, ParamArray Text() As Variant) As Boolean\n    Dim txt As Variant\n    Dim dd As New Scripting.Dictionary\n\n    dd.CompareMode = TextCompare\n\n    For Each txt In Text()\n        If Not txt = vbNullString Then dd.Add Key:=txt, Item:=dd.Count\n    Next txt\n\n    IfAmong = dd.Exists(TextToCheck)\n    dd.RemoveAll\nEnd Function\n</code></pre>\n\n<p>However, I would do this using:</p>\n\n<pre><code>Function IfAmong(TextToCheck, ParamArray Text() As Variant) As Boolean\n    Dim txt As Variant\n    ' Default value if not found\n    IfAmong = False\n    For Each txt In Text()\n        ' Make sure input is text\n        If TypeName(txt) = \"String\" Then\n            ' Test if they're equal ignoring case\n            If LCase(txt) = LCase(TextToCheck) Then\n                ' Set to true as found\n                IfAmong = True\n                ' There's no point to keep searching as we've already got our answer so lets exit\n                Exit For\n            End If\n        End If\n    Next txt\nEnd Function\n</code></pre>\n\n<p>This way you avoid using a dictionary which could cause reference errors. Your Dictionary in your function also doesn't handle duplicate values. A Dictionary doesn't allow you to have multiple keys of the same value so as soon as you have a duplicate text value your function will fall over as these are not handled.</p>\n"}], "owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2465, "favorite_count": 1, "accepted_answer_id": 46075900, "answer_count": 1, "score": 3, "last_activity_date": 1504737299, "creation_date": 1504701983, "question_id": 46075654, "link": "https://stackoverflow.com/questions/46075654/how-to-have-multiple-optional-arguments-in-a-user-defined-function-in-vba-excel", "title": "how to have multiple optional arguments in a user defined function in VBA/ Excel", "body": "<p>I need to develop an UDF for checking a cell value against several possible entries to check whether the cell is equal to any of those values or not. As you see I have an idea regarding how to do this check. But coding the function in a way that can accept multiple optional entries in not clear for me. for instance I am looking something dynamic like CONCATENATE in EXCEL { CONCATENATE( text1, [ text2, ... text_n ] )}.  My code for such function with 5 optional argument is as follow: </p>\n\n<pre><code>Function IfAmong(TextToCheck As String, Text1 As String, Optional Text2 As String, _ \n    Optional Text3 As String, Optional Text4 As String, Optional Text5 As String,_ \n    Optional text6 As String) As Boolean    \n    Dim dd As New Scripting.Dictionary\n    dd.CompareMode = TextCompare\n       dd.Add Text1, dd.Count\n       If Text2 &lt;&gt; \"\" Then dd.Add Text2, dd.Count\n       If Text3 &lt;&gt; \"\" Then dd.Add Text3, dd.Count\n       If Text4 &lt;&gt; \"\" Then dd.Add Text4, dd.Count\n       If Text5 &lt;&gt; \"\" Then dd.Add Text5, dd.Count\n       If text6 &lt;&gt; \"\" Then dd.Add text6, dd.Count\n    IfAmong = dd.Exists(TextToCheck)\n    dd.RemoveAll\nEnd Function\n</code></pre>\n\n<p>I want to make it relative to number of optional entries desired by the user (As said like concatenate). and also if possible make the checking of entries automatic through a loop. I tried adding the texts as an array, but not working!</p>\n\n<pre><code>for i =2 to Ubound(text(i))\n     if text(i) &lt;&gt;\"\" then..........\nnext\n</code></pre>\n\n<p>I was not able to do that as well. </p>\n\n<p>Thanks and regards,\nM</p>\n"}, {"tags": ["vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1504706624, "post_id": 46075736, "comment_id": 79115820, "body": "Yes this is great! Thanks so much, fit much better in my code and it looks neater."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1504884138, "post_id": 46075736, "comment_id": 79202092, "body": "@SteveG, no problem. Happy to help"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1504702658, "last_edit_date": 1504702658, "creation_date": 1504702222, "answer_id": 46075736, "question_id": 46075540, "link": "https://stackoverflow.com/questions/46075540/using-vlookup-in-vba-type-mismatch-error/46075736#46075736", "title": "Using VLookup in VBA type mismatch error", "body": "<p>It's a much better idea to use <code>Find</code> and <code>Offset</code> rather than <code>VLookup</code> in VBA. Offset by one column to replicate <code>2,0)</code> in <code>VLOOKUP</code>. Something like this:</p>\n\n<pre><code>Sub Test()\n    Dim tableArray As Range, found As Range\n\n    Set tableArray = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A1000\")\n\n    Set found = tableArray.Find(what:=\"someValue\", lookat:=xlWhole)\n\n    If Not found Is Nothing Then\n        MsgBox found.Offset(0, 1).Value\n    Else\n        MsgBox \"Not found\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 46075736, "answer_count": 1, "score": 1, "last_activity_date": 1504702658, "creation_date": 1504701661, "question_id": 46075540, "link": "https://stackoverflow.com/questions/46075540/using-vlookup-in-vba-type-mismatch-error", "title": "Using VLookup in VBA type mismatch error", "body": "<p>I am trying to figure out how to use vlookups in vba.</p>\n\n<pre><code>Function Check_NPI_NUM(pracno As String, npi As String) As String\n   Dim tempRange As Range\n   Set tempRange = ThisWorkbook.Worksheets(\"tempSheet\").Columns(\"C:D\")\n\n   Dim fixedPracno As Variant\n   'fixed pracno will look like this \"$C$64941\"\n   fixedPracno = Replace(pracno, \"H\", \"C\")\n\n   If (npi = \"0\") Then\n    Check_NPI_NUM = Application.IfError(Application.VLookup(fixedPracno, tempRange, 2, False), \"0\")\n   Else\n    Check_NPI_NUM = npi\n   End If\nEnd Function\n</code></pre>\n\n<p>I think my problem is the second part of the lookup to another sheet. I get a mismatch type error and I can't figure out why. If it is the first part of the lookup can someone explain why?</p>\n"}, {"tags": ["vba", "macos", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1504702104, "post_id": 46075488, "comment_id": 79112269, "body": "<a href=\"https://stackoverflow.com/questions/27344932/regex-with-vba-excel-at-mac\">Have a look at this</a>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1504702118, "post_id": 46075488, "comment_id": 79112284, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27344932/regex-with-vba-excel-at-mac\">RegEx with VBA Excel at Mac</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1504702511, "creation_date": 1504702511, "answer_id": 46075842, "question_id": 46075488, "link": "https://stackoverflow.com/questions/46075488/extracting-lookup-value-from-vlookup-formula-on-macos/46075842#46075842", "title": "Extracting lookup_value from VLOOKUP formula on MacOS", "body": "<p>I don't have a Mac here to test, but I think this should work:</p>\n\n<pre><code>Function extractFirstInt(strValue As String) As Integer\n    Dim codes() As Byte\n    Dim n As Long\n    Dim pos As Long\n    Dim length As Long\n    If strValue Like \"*#*\" Then\n        codes = strValue\n        length = 1\n        For n = LBound(codes) To UBound(codes) Step 2\n            Select Case codes(n)\n                Case 48 To 57\n                    If pos = 0 Then pos = n \\ 2 + 1 Else length = length + 1\n                Case Else\n                    If pos &lt;&gt; 0 Then Exit For\n            End Select\n        Next\n        extractFirstInt = CInt(Mid$(strValue, pos, length))\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1944, "user_id": 1115367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/d62wl.png?s=128&g=1", "display_name": "Kid Diamond", "link": "https://stackoverflow.com/users/1115367/kid-diamond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 46075842, "answer_count": 1, "score": 0, "last_activity_date": 1504702511, "creation_date": 1504701512, "question_id": 46075488, "link": "https://stackoverflow.com/questions/46075488/extracting-lookup-value-from-vlookup-formula-on-macos", "title": "Extracting lookup_value from VLOOKUP formula on MacOS", "body": "<p>On Windows I used the following function to extract the <code>lookup_value</code> from a <code>VLOOKUP</code> formula. However, I recently switched to macOS and the function is now incompatible.</p>\n\n<p>VBA in Excel on Mac does not support regular expressions. Is there any alternative function I could use or am I out of luck?</p>\n\n<pre><code>Function extractFirstInt(strValue As String) As Integer\n    Dim regex As New regexp\n    regex.Pattern = \"(\\d+)\"\n    extractFirstInt = regex.Execute(strValue)(0).SubMatches(0)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1504701076, "post_id": 46074124, "comment_id": 79111509, "body": "Your code lacks elementary logic. First, VBA can only run if you have an MS Office document open. Which one is it? You can&#39;t open a dialog box to select a document before you have the code running. Next, if you want to open Excel from Word you must first run Word, then create an Excel application. Finally, if you want to select the Excel workbook from a dialog box you can do that from Word. You should bring this much order into your code before you submit it to scrutiny by others. At least, your intention will be/should be clear."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1504706428, "post_id": 46074124, "comment_id": 79115665, "body": "@Variatus - I think you might be over complicating it.  OP states &quot;When Word opens&quot;.  That tells me that they want code in the open event <code>Document_Open()</code> that pops up a file selection box, grabs the Excel data with Excel being invisible, and inserts  it into the Word document that is open.  They even gave their code bits and stated that it works in Excel but not Word."}, {"owner": {"reputation": 1269, "user_id": 2866836, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/mKkwp.jpg?s=128&g=1", "display_name": "Manuela", "link": "https://stackoverflow.com/users/2866836/manuela"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1504707688, "post_id": 46074124, "comment_id": 79116603, "body": "@Variatus I think what Leila needs here, is just a code snippet, which does the same thing but works in a word file: It can open a given excel file (open but invisible for users) and copy the content from the excel file to the current word file. The code above already does it, but it runs in an excel file and reads the content from the excel file copy it to a given word file."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8568651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2012011762378230/picture?type=large", "display_name": "Leila Dai", "link": "https://stackoverflow.com/users/8568651/leila-dai"}, "edited": false, "score": 0, "creation_date": 1504770261, "post_id": 46078103, "comment_id": 79142942, "body": "Thank you for your help! May l ask one more thing ? How to paste the table to a bookmark according to the bookmark &#39;s name?"}, {"owner": {"reputation": 31, "user_id": 8568651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2012011762378230/picture?type=large", "display_name": "Leila Dai", "link": "https://stackoverflow.com/users/8568651/leila-dai"}, "edited": false, "score": 0, "creation_date": 1504858131, "post_id": 46078103, "comment_id": 79185617, "body": "Thanks a lot for your help!"}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": true, "score": 4, "last_activity_date": 1504794293, "last_edit_date": 1504794293, "creation_date": 1504708753, "answer_id": 46078103, "question_id": 46074124, "link": "https://stackoverflow.com/questions/46074124/how-to-copy-and-paste-excel-to-word-with-word-vba/46078103#46078103", "title": "how to copy and paste excel to word with word vba", "body": "<p>This should get you started.  Place the code below in your Word document in the 'ThisDocument' module.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bo7le.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bo7le.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Add Excel reference to your Word VBA.  In the VBA editor go to Tools and then References.  Check the box next to Microsoft Excel 14.0 Object Library.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GivtZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GivtZ.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<pre><code>Private Sub Document_Open()\n    Dim intChoice As Integer\n    Dim strPath As String\n\n    Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n    intChoice = Application.FileDialog(msoFileDialogOpen).Show\n\n    If intChoice &lt;&gt; 0 Then\n        strPath = Application.FileDialog(msoFileDialogOpen).SelectedItems(1)\n    End If\n\n    CopyWorksheetsToWord (strPath)\nEnd Sub\n\n\nFunction CopyWorksheetsToWord(filePath As String)\n    Dim exApp As Excel.Application\n    Dim exWbk As Excel.Workbook\n    Dim exWks As Excel.Worksheet\n    Dim wdDoc As Word.Document\n\n    Application.ScreenUpdating = False\n    Application.StatusBar = \"Creating new document...\"\n\n    Set wdDoc = ActiveDocument\n    Set exApp = New Excel.Application\n    exApp.Visible = False\n\n    Set exWbk = exApp.Workbooks.Open(filePath)\n\n    For Each exWks In exWbk.Worksheets\n        exWks.UsedRange.Copy\n        wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.InsertParagraphAfter\n        wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.Paste\n        exApp.CutCopyMode = False\n        wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.InsertParagraphAfter\n        If Not exWks.Name = exWbk.Worksheets(exWbk.Worksheets.Count).Name Then\n            With wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range\n                .InsertParagraphBefore\n                .Collapse Direction:=wdCollapseEnd\n                .InsertBreak Type:=wdPageBreak\n            End With\n        End If\n    Next exWks\n\n    Application.StatusBar = \"Cleaning up...\"\n\n    Set exWks = Nothing\n    exWbk.Close\n    Set exWbk = Nothing\n    Set exApp = Nothing\n\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\nEnd Function\n</code></pre>\n\n<hr>\n\n<ol>\n<li>Save file as macro-enabled file (.docm)</li>\n<li>Close word file</li>\n<li>Open word file and the code will run. First thing you'll see is a file open box to select the Excel file.</li>\n</ol>\n\n<p><em>Tested code but there is no error checking.</em></p>\n\n<hr>\n\n<p><strong>Update per comment</strong></p>\n\n<p>Bookmarks can be located by name using the following syntax: <code>wdDoc.Bookmarks(\"Bookmark2\").Range</code></p>\n\n<p>In this case I inserted a bookmark and labeled it <em>Bookmark2</em></p>\n\n<p>Updated Function Code:</p>\n\n<pre><code>Function CopyWorksheetsToWord(filePath As String)\n    Dim exApp As Excel.Application\n    Dim exWbk As Excel.Workbook\n    Dim exWks As Excel.Worksheet\n    Dim wdDoc As Word.Document\n    Dim bmRange As Range\n\n    Application.ScreenUpdating = False\n    Application.StatusBar = \"Creating new document...\"\n\n    Set wdDoc = ActiveDocument\n    Set exApp = New Excel.Application\n    exApp.Visible = False\n\n    Set exWbk = exApp.Workbooks.Open(filePath)\n\n    For Each exWks In exWbk.Worksheets\n        exWks.UsedRange.Copy\n\n        Set bmRange = wdDoc.Bookmarks(\"Bookmark2\").Range\n        bmRange.Paste\n\n        exApp.CutCopyMode = False\n        wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.InsertParagraphAfter\n        If Not exWks.Name = exWbk.Worksheets(exWbk.Worksheets.Count).Name Then\n            With wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range\n                .InsertParagraphBefore\n                .Collapse Direction:=wdCollapseEnd\n                .InsertBreak Type:=wdPageBreak\n            End With\n        End If\n    Next exWks\n\n    Application.StatusBar = \"Cleaning up...\"\n\n    Set exWks = Nothing\n    exWbk.Close\n    Set exWbk = Nothing\n    Set exApp = Nothing\n\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\nEnd Function\n</code></pre>\n\n<p>Since your looping through sheets you'll probably need to play with formatting and how your stacking each section in the document but this should get you going.</p>\n"}], "owner": {"reputation": 31, "user_id": 8568651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2012011762378230/picture?type=large", "display_name": "Leila Dai", "link": "https://stackoverflow.com/users/8568651/leila-dai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5685, "favorite_count": 2, "accepted_answer_id": 46078103, "answer_count": 1, "score": 0, "last_activity_date": 1504794293, "creation_date": 1504697588, "last_edit_date": 1531164843, "question_id": 46074124, "link": "https://stackoverflow.com/questions/46074124/how-to-copy-and-paste-excel-to-word-with-word-vba", "title": "how to copy and paste excel to word with word vba", "body": "<p>I want to insert the Excel file at the seartain BOOkmark in the Word doc without opening Excel, automatically inserted when the Word doc opens.</p>\n\n<p>1.I'm thinking to make a pop up window with a open file dialog bottom firstly. And my code is following:<strong>(but it only work in excel VBA doesn't work in word VBA how should I change the code so that I can do it in word??? )</strong></p>\n\n<pre><code>Sub openfile()\nDim intChoice As Integer\nDim strPath As String\nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\nintChoice = Application.FileDialog(msoFileDialogOpen).Show\nIf intChoice &lt;&gt; 0 Then\nstrPath = Application.FileDialog( _\nmsoFileDialogOpen).SelectedItems(1)\nEnd If\nEnd Sub\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Then I made a copy and paste bottom the code is as follows:<strong>(It also only work when l code it in excel how to change to word vba?)</strong></p>\n\n<pre><code>Sub CopyWorksheetsToWord()\nDim wdApp As Word.Application, wdDoc As Word.Document, ws As Worksheet\nApplication.ScreenUpdating = False\nApplication.StatusBar = \"Creating new document...\"\nSet wdApp = New Word.Application\nSet wdDoc = wdApp.Documents.Add\nFor Each ws In ActiveWorkbook.Worksheets\n\nws.UsedRange.Copy\nwdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.InsertParagraphAfter\nwdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.Paste\nApplication.CutCopyMode = False\nwdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range.InsertParagraphAfter\nIf Not ws.Name = Worksheets(Worksheets.Count).Name Then\n    With wdDoc.Paragraphs(wdDoc.Paragraphs.Count).Range\n        .InsertParagraphBefore\n        .Collapse Direction:=wdCollapseEnd\n        .InsertBreak Type:=wdPageBreak\n    End With\n    End If\n    Next ws\n    Set ws = Nothing\n    Application.StatusBar = \"Cleaning up...\"\n    With wdApp.ActiveWindow\n    If .View.SplitSpecial = wdPaneNone Then\n    .ActivePane.View.Type = wdNormalView\n     Else\n    .View.Type = wdNormalView\n    End If\n    End With\n    Set wdDoc = Nothing\n    wdApp.Visible = True\n    Set wdApp = Nothing\n    Application.StatusBar = False\n    End Sub\n</code></pre></li>\n</ol>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 9, "creation_date": 1504694852, "post_id": 46073213, "comment_id": 79107014, "body": "<a href=\"https://ericlippert.com/2012/12/17/performance-rant/\" rel=\"nofollow noreferrer\">Race your horses</a>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 2, "creation_date": 1504696383, "post_id": 46073213, "comment_id": 79108076, "body": "They have different purposes: <code>InStr()</code> is used to find a sub-string within <b>one</b> string. <code>Find()</code> is used to find a string in multiple strings (as in Cells). I use <code>InStr()</code> to make a faster version of <code>Find()</code> by transfering ranges to arrays, looping them, and using <code>InStr()</code>. So you should define your purpose and measure the difference"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1504696486, "post_id": 46073213, "comment_id": 79108141, "body": "@paulbica <code>Find()</code> is used for cell in a particular range. Am I correct or missing anything overhere?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1504698079, "post_id": 46073213, "comment_id": 79109272, "body": "@nishitdey - <code>Find()</code> is used to search multiple cells in a range. If you and the OP are thinking of <code>FindB()</code> there are ways to measure the difference between them as well - by using a large paragraph to find multiple sub-strings, and measure the response with a <a href=\"https://stackoverflow.com/a/7116928/4914662\">microtimer</a>"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1515592285, "post_id": 46073213, "comment_id": 83357596, "body": "Range.Find is very different from WorksheetFunction.Find."}], "answers": [{"comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1504706440, "post_id": 46073674, "comment_id": 79115673, "body": "<code>WorksheetFunction.Find</code> does the same as <code>=FIND(</code>, witch is the formula version of InStr, returning #NA if not found rather than the 0 returned from InStr"}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 2, "last_activity_date": 1504696143, "creation_date": 1504696143, "answer_id": 46073674, "question_id": 46073213, "link": "https://stackoverflow.com/questions/46073213/which-is-faster-in-excel-vba-instr-or-find/46073674#46073674", "title": "Which is faster in Excel VBA: InStr or Find?", "body": "<p>Both are same and it does the same action.</p>\n\n<p>Most (but not all) worksheet functions can also be called from VBA. For example, you can use the VLOOKUP worksheet function in VBA by calling <code>Application.WorksheetFunction.VLookup</code> (or Application.VLookup).</p>\n\n<p>Similarly, you can use Application.WorksheetFunction.Find and <code>Application.WorksheetFunction.Search</code>. You can use them to emulate the way the worksheet functions work in your VBA code.</p>\n\n<p>These functions are only available in Excel VBA, whereas InStr is a generic VBA function, available in all Office applications (and in VB6, VB.NET etc.)</p>\n\n<p>Apart from that, the Range object in Excel VBA has a Find method, and the Worksheet object has a Find object. These, however, serve a different purpose: you can't use them to search for text within a string, but to search for cells with specified content.</p>\n"}], "owner": {"reputation": 11, "user_id": 5088447, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9FMEXO_3mL0/AAAAAAAAAAI/AAAAAAAAvko/d4AjcN956L8/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/5088447/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2520, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504696143, "creation_date": 1504694742, "question_id": 46073213, "link": "https://stackoverflow.com/questions/46073213/which-is-faster-in-excel-vba-instr-or-find", "title": "Which is faster in Excel VBA: InStr or Find?", "body": "<p>I've got a function which uses InStr() to locate a character in a string, but I know there is a built in function in Excel called FIND(). Can anyone advise which is faster or more cpu efficient?</p>\n\n<pre><code>hours_position = InStr(1, value, \" \")\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>hours_position = Application.WorksheetFunction.Find(\" \", value, 1)\n</code></pre>\n"}, {"tags": ["vba", "excel", "email"], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1504695859, "post_id": 46073279, "comment_id": 79107689, "body": "Thank you for the answer.. Unfortunatelly, it stills pastes the rows where everything is 0.. However, I dont know if its important to mention it, but in the first two columns of the range there are some type of vertical headers, so there are no values there.. the values start from the third row of the range... is it important?"}, {"owner": {"reputation": 286, "user_id": 6514401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FFXB.jpg?s=128&g=1", "display_name": "SMFSW", "link": "https://stackoverflow.com/users/6514401/smfsw"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 1, "creation_date": 1504715453, "post_id": 46073279, "comment_id": 79121954, "body": "Alright, it&#39;s somewhat hard to find a solution for you if we cannot test it by ourselves; what I can suggest is executing your script step by step to better understand how it is running (and what happens). It could give you some clues."}, {"owner": {"reputation": 286, "user_id": 6514401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FFXB.jpg?s=128&g=1", "display_name": "SMFSW", "link": "https://stackoverflow.com/users/6514401/smfsw"}, "reply_to_user": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1505151658, "post_id": 46073279, "comment_id": 79284940, "body": "@PericlesFaliagas Did you manage to get the desired results? Or did you find where things starts to go wrong while executing step by step?"}, {"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1505196913, "post_id": 46073279, "comment_id": 79300192, "body": "hey ! I actually tried a different method and worked better! I simply created an assisting sheet to move the range there and then edit it while being isolated. Thanks for the interest though!"}], "tags": [], "owner": {"reputation": 286, "user_id": 6514401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3FFXB.jpg?s=128&g=1", "display_name": "SMFSW", "link": "https://stackoverflow.com/users/6514401/smfsw"}, "is_accepted": false, "score": 0, "last_activity_date": 1504694981, "creation_date": 1504694981, "answer_id": 46073279, "question_id": 46073101, "link": "https://stackoverflow.com/questions/46073101/macro-to-send-mails-with-selected-range-only-rows-that-abide-by-if-condition/46073279#46073279", "title": "macro to send mails with selected range (only rows that abide by if condition)", "body": "<p>you may try add <code>Criteria2:=\"&lt;&gt;0\"</code> in your filtering code line:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Report\").Range(\"I24:U24\").AutoFilter Field:=2, Criteria1:=ThisWorkbook.Sheets(\"Report\").Cells((I + 2), 27).Value\n</code></pre>\n\n<p>If it doesn't work on a single line, you probably should try to <code>AutoFilter</code> on a next statement. Please note in this case, it would be <code>Criteria1</code>.</p>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504698586, "creation_date": 1504694348, "last_edit_date": 1504698586, "question_id": 46073101, "link": "https://stackoverflow.com/questions/46073101/macro-to-send-mails-with-selected-range-only-rows-that-abide-by-if-condition", "title": "macro to send mails with selected range (only rows that abide by if condition)", "body": "<p>I have created a macro which automatically sends part of an excel sheet via email to some recipients. The code is fully functional and is working great. </p>\n\n<p>However, I want to implement a minor change to it: The macro is actually filtering a range (a column), it copies the rows that exist after the filtering and then pastes then in another sheet.<br/>\nAfter that, it sends the copy-pasted range to some recipients.</p>\n\n<p>What I want to change is, to tell the macro to send only the copy pasted rows that have values inside and not only 0.<br/>\nSo, if a row (every row has 8 columns with data) has only 0 in all of its columns then don't send this one.</p>\n\n<p>I will provide the code below. It should be easy to add an If condition but I have tried and failed. Possibly someone knows how to add the If condition inside the code.</p>\n\n<pre><code>Sub MAIL()\n    Dim ToArray As String\n    Dim CCArray As String\n    Dim Subject As String\n    Dim Content As String\n    Dim lastrow1 As Integer\n    Dim lastrow2 As Integer\n    Application.ScreenUpdating = False\n    For I = 1 To 20\n    Sheets.Add.Name = \"WS1\"\n    Sheets(\"Report\").Activate\n    ToArray = \"aaa@gmail.com\"\n    'ToArray = ThisWorkbook.Sheets(\"Report\").Cells((I + 2), 28).Value\n    CCArray = ThisWorkbook.Sheets(\"Report\").Cells((I + 2), 29).Value\n    Subject = ThisWorkbook.Sheets(\"Report\").Cells((I + 2), 30).Value\n    Content = ThisWorkbook.Sheets(\"Report\").Cells((I + 2), 31).Value\n    ThisWorkbook.Sheets(\"Report\").Range(\"I24:U24\").AutoFilter Field:=2, Criteria1:=ThisWorkbook.Sheets(\"Report\").Cells((I + 2), 27).Value\n    lastrow1 = ThisWorkbook.Sheets(\"Report\").Cells(ThisWorkbook.Sheets(\"Report\").Rows.Count, \"U\").End(xlUp).Row\n    ThisWorkbook.Sheets(\"Report\").Range(\"K24:U\" &amp; lastrow1).SpecialCells(xlCellTypeVisible).Copy ThisWorkbook.Sheets(\"WS1\").Cells(1, 1)\n    lastrow2 = ThisWorkbook.Sheets(\"WS1\").Cells(Sheets(\"WS1\").Rows.Count, \"A\").End(xlUp).Row\n    If lastrow2 &gt;= 2 Then\n        Sheets(\"WS1\").Columns(\"A:M\").AutoFit\n        Sheets(\"WS1\").Activate\n        Sheets(\"WS1\").Range(\"A1:M\" &amp; lastrow2).Select\n        ActiveWorkbook.EnvelopeVisible = True\n        With Sheets(\"Report\").MailEnvelope\n          .Introduction = Content\n          .Item.To = ToArray\n          .Item.CC = CCArray\n          .Item.Subject = Subject\n          .Item.Send\n        End With\n        Application.ScreenUpdating = True\n        Application.DisplayAlerts = False\n    End If\n    Sheets(\"WS1\").Delete\n    Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "number-formatting"], "comments": [{"owner": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504694987, "post_id": 46073059, "comment_id": 79107103, "body": "What version of Excel/VBA do you use?"}, {"owner": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "reply_to_user": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504695056, "post_id": 46073059, "comment_id": 79107154, "body": "Excel 2011 mac version"}, {"owner": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504695239, "post_id": 46073059, "comment_id": 79107291, "body": "Please add other statements of your code. It seems your problem is related to them."}, {"owner": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "reply_to_user": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504695493, "post_id": 46073059, "comment_id": 79107461, "body": "Added. Thanks a lot"}, {"owner": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504695776, "post_id": 46073059, "comment_id": 79107634, "body": "You passed <code>8</code> as <code>NumDigitsAfterDecimal</code> argument of <code>FormatPercent</code>, while it is <code>2</code> in your previous line. And would you add the data of the line that you have problem with?"}, {"owner": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "reply_to_user": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504695867, "post_id": 46073059, "comment_id": 79107698, "body": "It should be 8, Typo. Attached a screen shot"}, {"owner": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "reply_to_user": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "edited": false, "score": 0, "creation_date": 1504696604, "post_id": 46073059, "comment_id": 79108227, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/153771/discussion-between-mehdi-javan-and-pak-ho-cheung\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "reply_to_user": {"reputation": 969, "user_id": 5613292, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tbk5Q.jpg?s=128&g=1", "display_name": "Mehdi Javan", "link": "https://stackoverflow.com/users/5613292/mehdi-javan"}, "edited": false, "score": 0, "creation_date": 1504698011, "post_id": 46073059, "comment_id": 79109211, "body": "Please see my update. I guess it is excel problem?"}], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "is_accepted": false, "score": 0, "last_activity_date": 1504699747, "creation_date": 1504699747, "answer_id": 46074852, "question_id": 46073059, "link": "https://stackoverflow.com/questions/46073059/vba-convert-a-very-small-value-to-percentage/46074852#46074852", "title": "VBA - convert a very small value to percentage", "body": "<p>I solve this by change </p>\n\n<pre><code>Cells(i, 6) = FormatPercent(Cells(i, 6), 8, , vbTrue)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Cells(i, 6) = FormatPercent(Cells(i, 6) * 10000, 8, , vbTrue)\nCells(i, 6) = Cells(i, 6) / 10000\n</code></pre>\n\n<p>I know this is not the most correct answer. If you have a better one, I will vote yours.</p>\n"}], "owner": {"reputation": 1392, "user_id": 5737856, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/10153324680797338/picture?type=large", "display_name": "Pak Ho Cheung", "link": "https://stackoverflow.com/users/5737856/pak-ho-cheung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504699747, "creation_date": 1504694198, "last_edit_date": 1592644375, "question_id": 46073059, "link": "https://stackoverflow.com/questions/46073059/vba-convert-a-very-small-value-to-percentage", "title": "VBA - convert a very small value to percentage", "body": "<p>I am trying to convert a really small value to percentage but I got a strange number. For example of the small value, -8.45129E-05.</p>\n<p>Currently, I am using below code for conversion.</p>\n<pre><code>Cells(i, 6) = FormatPercent(Cells(i, 6), 8, , vbTrue)\n</code></pre>\n<p>I got a result of -845.13% if the small value is -8.45129E-05, but the correct result should be -0.00845129%. I guess the issue is caused by the E-05. Any suggestions to fix that?</p>\n<p><strong>Example with new excel file.</strong></p>\n<p>Line 10 column 6 should be -0.0084513% (122.21/122.76-1)-(1291/1296.7-1) (Column D to F is calculated by Sub and Column H to J is calculated by hand)</p>\n<p><a href=\"https://i.stack.imgur.com/W7s4J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W7s4J.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1504694320, "post_id": 46072974, "comment_id": 79106680, "body": "Your code didn&#39;t specify the <code>pivotfield</code> to be added."}, {"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "reply_to_user": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1504694530, "post_id": 46072974, "comment_id": 79106810, "body": "I think I am getting an error before that is even an issue... I will add a line of me (attempting to) adding a field."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1504695490, "post_id": 46072974, "comment_id": 79107456, "body": "For the EDIT, include quotation marks: <code>.PivotTables(&quot;MyPivot&quot;)</code>"}, {"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "reply_to_user": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1504695629, "post_id": 46072974, "comment_id": 79107543, "body": "@Egalth No, <code>MyPivot</code> is not the name of the pivot."}, {"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504695701, "post_id": 46072974, "comment_id": 79107584, "body": "I tried this but it made no difference to the error. MyPivot is already = &quot;PivotTable2&quot; (depending on which sheet I am on), so would this matter?"}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1504695915, "post_id": 46072974, "comment_id": 79107731, "body": "Ok. @kulapo, of course, I was too quick."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1504696327, "post_id": 46072974, "comment_id": 79108031, "body": "@alex1stef2 read my answer and code below, see if it works as you intended"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504696541, "post_id": 46073670, "comment_id": 79108183, "body": "I have been trying things very similar to this and this version is clearly the most concise but I still get a runtime error of: <code>Unable to get the PivotFields property of the PivotTable class</code>."}, {"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504696681, "post_id": 46073670, "comment_id": 79108282, "body": "Kulapo just deleted his answer but when hovering over MyPivot just before the error it is equal to &quot;PivotTable2&quot; and if I manually go to this pivot table and click on it, the PivotTable Field List definitely lists GuidelinePercent as an option."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504696707, "post_id": 46073670, "comment_id": 79108302, "body": "@alex1stef2 let me add a debug option to my code, try the code under <b>Edit 1</b>"}, {"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504697360, "post_id": 46073670, "comment_id": 79108737, "body": "Okay it looks like this has worked, no need at all for the error message! I am unsure as to why, it could just be that your first suggestion was fine and I didn&#39;t redefine a pivot field at the top! Thank you so much, I will try to use this format going forward to get everything to work well! - will you be willing to return here and answer any questions if I have more problems?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 1, "creation_date": 1504697466, "post_id": 46073670, "comment_id": 79108811, "body": "@alex1stef2 sure, but you should open a new post if it is related to another issue (so future users won&#39;t be confused) , ok ?"}, {"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504697613, "post_id": 46073670, "comment_id": 79108909, "body": "ok! though quickly, how do I completely clear all filters and axes at the start of the loop so that I can rerun my code without any issues?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504697705, "post_id": 46073670, "comment_id": 79108963, "body": "@alex1stef2 you mean of all PivotTables ? use <code>MyPivot.ClearAllFilters</code>"}, {"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504697943, "post_id": 46073670, "comment_id": 79109157, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/153775/discussion-between-alex1stef2-and-shai-rado\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1504696984, "last_edit_date": 1504696984, "creation_date": 1504696136, "answer_id": 46073670, "question_id": 46072974, "link": "https://stackoverflow.com/questions/46072974/vba-code-for-running-through-pivot-tables-and-changing-filters-labels/46073670#46073670", "title": "VBA code for running through pivot tables and changing filters/labels", "body": "<p>You have a loop of <code>For Each MySheet In ActiveWorkbook.Worksheets</code>, so when you are using later <code>With ActiveSheet</code> it is not the same sheet as <code>MySheet</code>, infact you don't need to use <code>ActiveSheet</code>, you can use directly the <code>PivotTable</code> object you name <code>MyPivot</code>.</p>\n\n<p>Try the code below:</p>\n\n<pre><code> With MyPivot\n     .AddDataField .PivotFields(\"GuidelinePercent\"), \"Count of GuidelinePercent\", xlCount\n End With\n</code></pre>\n\n<p><strong>Edit 1</strong>:</p>\n\n<pre><code> Dim PvtFld As PivotField\n\n With MyPivot\n     On Error Resume Next\n     Set PvtFld = .PivotFields(\"GuidelinePercent\")\n     On Error GoTo 0\n     If PvtFld Is Nothing Then\n         MsgBox \"Error in setting the PivotField\"\n     Else\n         .AddDataField PvtFld, \"Count of \" &amp; PvtFld.Name, xlCount\n     End If\n End With\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 46073670, "answer_count": 1, "score": 0, "last_activity_date": 1504696984, "creation_date": 1504693932, "last_edit_date": 1504694611, "question_id": 46072974, "link": "https://stackoverflow.com/questions/46072974/vba-code-for-running-through-pivot-tables-and-changing-filters-labels", "title": "VBA code for running through pivot tables and changing filters/labels", "body": "<p>Effectively I am trying to create some VBA code that will loop through a bunch of sheets with pivot tables, apply certain conditions to the pivot tables (i.e. change the fields depending on a variable/change the filter depending on a cell value, as I have tried to demonstrate in the code below). This doesn't even come close to running (I am a complete beginner trying to update legacy code), so I am looking for pointers as to how to use the variables defined for the results I want.</p>\n\n<p>My current issue is that I can't seem to call the PivotTable to start changing fields etc.</p>\n\n<pre><code>Option Explicit\nDim MySheet As Worksheet\nDim MyPivot As PivotTable\nDim NewCat As String\n\nSub RefreshPivots()\n\n For Each MySheet In ActiveWorkbook.Worksheets\n    For Each MyPivot In MySheet.PivotTables\n        NewCat = Worksheets(\"WorkingSheet\").Range(\"B44\").Value\n        MyPivot.RefreshTable\n\n        With ActiveSheet\n         .MyPivot.AddDataField\n         .MyPivot.PivotFields (\"GuidelinePercent\"), \"Count of GuidelinePercent\", xlCount\n        End With\n\n    Next MyPivot\n Next MySheet\n</code></pre>\n\n<p>(A lot more will go in the loop, this is just the first issue I have encountered).</p>\n\n<p>I am getting: <code>Run-time error '438' Object doesn't support this property or method</code> on line </p>\n\n<p><code>With ActiveSheet.MyPivot.AddDataField</code></p>\n\n<p>Any help would be great!</p>\n\n<p>EDIT;</p>\n\n<p>When trying </p>\n\n<pre><code>With ActiveSheet\n.PivotTables(MyPivot).AddDataField\n.PivotTables(MyPivot).PivotFields (\"GuidelinePercent\"), \"Count of GuidelinePercent\", xlCount\nEnd With\n</code></pre>\n\n<p>I get <code>Run-time error'1004': Unable to get the Pivot Tables property of the Worksheet class</code> on the line <code>.MyPivot.AddDataField</code>.</p>\n"}, {"tags": ["vba", "forms", "ms-access", "ms-word"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1504694576, "post_id": 46072913, "comment_id": 79106838, "body": "There are numerous ways to go about this, the most obvious one to me would be to place a bookmark and add a table on that bookmark. Review <a href=\"https://msdn.microsoft.com/en-us/library/w1702h4a.aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"nofollow noreferrer\">this MSDN page</a> to create a table, and <a href=\"https://msdn.microsoft.com/en-us/library/tkf9d64e.aspx\" rel=\"nofollow noreferrer\">this one</a> to add values to the cells of the table. You could also include the table in your template, and add row to the table in the loop. If you&#39;re having trouble with this, ask a new specific question about it. Your question is very broad."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1504695212, "post_id": 46072913, "comment_id": 79107269, "body": "Also I would use Word Mail Merge functionality instead of one-by-one coping values from recordset to bookmarked text."}, {"owner": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "edited": false, "score": 0, "creation_date": 1504695780, "post_id": 46072913, "comment_id": 79107639, "body": "Thanks Eric! That answers the &quot;how to format the output data on the word form&quot; nicely, I&#39;ll use a table. Now i need to wrap my head around how to loop through the data in subform table to select and output the data related to the specific application. This subform&#39;s table will hold data related to many individual forms/license applications, I need to get only the entries related to the specific application only. I have no idea how to code this."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504696526, "post_id": 46072913, "comment_id": 79108171, "body": "You can just loop through the subforms recordsetclone. If you ask a separate specific question (e.g. how can I loop through all records and fields in a subform), you will get a more full answer (I tend to not answer multi-barrelled questions, since people having the same problem can&#39;t find the answer if the question isn&#39;t clear)."}, {"owner": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "edited": false, "score": 0, "creation_date": 1504697995, "post_id": 46072913, "comment_id": 79109197, "body": "Ok, cool. I&#39;ll ask a new question. Sorry, i&#39;m very new to this"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "edited": false, "score": 0, "creation_date": 1504779159, "post_id": 46074427, "comment_id": 79148934, "body": "Thanks Kostas! I tried that and got it mostly working. Still having issues with the table, but i&#39;ll ask another question about that specific issue if i can&#39;t get it going. Appreciate it"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "edited": false, "score": 0, "creation_date": 1504779389, "post_id": 46074427, "comment_id": 79149093, "body": "Just create a simple table with 7 columns and 1 row. Add the additional columns to the script and test."}, {"owner": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "edited": false, "score": 0, "creation_date": 1504787986, "post_id": 46074427, "comment_id": 79154868, "body": "I&#39;ve tried all sorts but keep getting the error message - the requested member of the collection does not exist"}, {"owner": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "edited": false, "score": 0, "creation_date": 1504827911, "post_id": 46074427, "comment_id": 79176219, "body": "Kostas, Thank you so much!! I&#39;ve now learned how to number code lines and output the line number with the error message, also how to get my subform table data outputting to the table exactly as you said. It works perfectly. Brilliant!! Thanks!"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1504698898, "last_edit_date": 1504698898, "creation_date": 1504698505, "answer_id": 46074427, "question_id": 46072913, "link": "https://stackoverflow.com/questions/46072913/ms-access-form-data-export-to-word/46074427#46074427", "title": "Ms-Access form data export to Word", "body": "<p>This will point you to the right direction. You need to make a couple of changes though to fit your needs e.g. insert all your bookmarks, update the SQL strings and recordset fields.</p>\n\n<p>You also need to make a few changes to your Word document though:</p>\n\n<p>1) Add a table to hold the manager data (loop). Hide the borders if needed. <br>\n2) Save the document as <strong>Word Template</strong> (.dotx)</p>\n\n<pre><code>Public Sub ExportToWord()\n    On Error GoTo ErrorTrap\n\n    Const TemplatePath As String = \"C:\\forms\\templates\\Form 3 - Sec 36(1).dotx\"\n\n    'Data\n    Dim rs As DAO.Recordset\n    Set rs = CurrentDb().OpenRecordset(\"SELECT * FROM TableName WHERE [Criteria]\", dbOpenSnapshot)\n\n    'SaveAs\n    Dim name_ As String\n        name_ = \"C:\\forms\\generated\\\" &amp; rs![FieldName] &amp; \"_Form 3 - Sec 36(1).docx\"\n\n    'Word\n    Dim oWord As Word.Application\n    Set oWord = New Word.Application\n        oWord.Visible = False\n\n    Dim oDoc As Word.Document\n    Set oDoc = oWord.Documents.Add(TemplatePath)\n    With oDoc\n        .Bookmarks(\"Bookmark_1\").Range.Text = rs![FieldName_1]\n        .Bookmarks(\"Bookmark_2\").Range.Text = rs![FieldName_2]\n        .Bookmarks(\"Bookmark_3\").Range.Text = rs![FieldName_3]\n        '...\n    End With\n\n        rs.Close\n    Set rs = Nothing\n\n    'Loop data\n    Set rs = CurrentDb().OpenRecordset(\"SELECT * FROM TableName WHERE [Criteria]\", dbOpenSnapshot)\n    With rs\n        If Not .EOF Then\n            .MoveLast\n            .MoveFirst\n        End If\n    End With\n\n    Dim idx As Integer\n    For idx = 1 To rs.RecordCount\n        With oDoc.Tables(1)\n            .Cell(idx, 1).Range.Text = rs![FieldName_1]    '1st Column\n            .Cell(idx, 2).Range.Text = rs![FieldName_2]    '2nd Column\n            .Cell(idx, 3).Range.Text = rs![FieldName_1]    '3rd Column\n            '...\n            'add extra rows if required\n            If rs.AbsolutePosition &lt;&gt; rs.RecordCount - 1 Then .Columns(1).Cells.Add\n        End With\n        rs.MoveNext\n    Next idx\n\n    'Save\n    With oDoc\n        .SaveAs FileName:=name_, FileFormat:=Word.WdSaveFormat.wdFormatXMLDocument\n        .Close SaveChanges:=wdDoNotSaveChanges\n    End With\n\nLeave:\n    On Error Resume Next\n        rs.Close\n    Set rs = Nothing\n        oWord.Quit\n    Set oWord = Nothing\n    On Error GoTo 0\n    Exit Sub\n\nErrorTrap:\n    MsgBox Err.Description, vbCritical, \"ExportToWord()\"\n    Resume Leave\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8567997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f4d059183c4d0e67ddc7ce4d66d96?s=128&d=identicon&r=PG&f=1", "display_name": "Realhost", "link": "https://stackoverflow.com/users/8567997/realhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504698898, "creation_date": 1504693799, "question_id": 46072913, "link": "https://stackoverflow.com/questions/46072913/ms-access-form-data-export-to-word", "title": "Ms-Access form data export to Word", "body": "<p>I really some help! Here's a link to a google drive zip of the access database that I'm struggling with.\n<a href=\"https://drive.google.com/file/d/0BwjnhQS2X7_Qamt4clFLc1Ztb2c/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/0BwjnhQS2X7_Qamt4clFLc1Ztb2c/view?usp=sharing</a></p>\n\n<p>So, what I have is an access database made up of a few tables and a form and some sub forms. The database info gets inputted to the tables via a form that I've created. In the example, the form is called \"Database\". This form exports to a word document, fields on the database go to bookmarks on the word doc. This works great so far. </p>\n\n<p>In the attachment there is a \"template\" folder with the original word document, when the code runs it saves the completed form to the \"generated\" folder - works like a charm. Its a very long form for applications for liquor licenses. </p>\n\n<p>So you fill in the form in access, it saves to the tables and exports the data to the word template document. </p>\n\n<p>The problem that I have is that there is a subform on tab8 of the form where \"director details\" are saved. There can be any number of directors per application. I've managed to access the data on the subform's table, but have no idea how to loop through the data in that table to get all the information that is applicable to that application only and not data related to other applications. There is a relationship between the director details table and the application details table(this is the main table) and I'm using an application identifier field that I've created called and \"ACNumber\" which is unique to each application. There is a combobox on the form that selects the application and the form and subforms bring up the correct data when you select it.</p>\n\n<p>The other part of the problem is how do I output this to word? A bookmark won't work, because all the fields are being repeated. Is there a way that all the data entries can be outputted to a single bookmark mabe in a textbox with the labels?</p>\n\n<p>This is how it looks on the word document form:</p>\n\n<p>(First person)<br>\nFull name           :   generate from item 5.4(a) from database\nPhysical address    :   generate from item 5.4(b) from database\nPostal code         :   generate from item 5.4(c) from database\nPostal address      :   generate from item 5.4(d) from database\nPostal code         :   generate from item 5.4(e) from database\nIdentity number     :   generate from item 5.4(f) from database</p>\n\n<p>(More person\u2019s to add if needed)      </p>\n\n<p>Ok, I hope that describes my problem accurately.\nI've tried all sorts to get this working, but its beyond me, please help guys!!!\nBelow is the code that I'm using: (the loop for the subform doesn't work, but one entry from that table is exported to the bookmarks currently in place)\nI've tried all sorts to get this working, but its beyond me, please help guys!!!</p>\n\n<hr>\n\n<pre><code>`Private Sub ExportToWord_Click()\n\n'Print customer slip for current customer.\n  Dim appWord As Word.Application\n  Dim doc As Word.Document\n  Dim drst As Recordset\n  Set drst = CurrentDb.OpenRecordset(Name:=\"62 Other Interests\", Type:=RecordsetTypeEnum.dbOpenDynaset)\n  'Avoid error 429, when Word isnt open.\n  On Error Resume Next\n  Err.Clear\n  'Set appWord object variable to running instance of Word.\n  Set appWord = GetObject(, \"Word.Application\")\n\n  If Err.Number &lt;&gt; 0 Then\n    'If Word isnt open, create a new instance of Word.\n    Set appWord = New Word.Application\n  End If\n  Set doc = appWord.Documents.Open(\"C:\\forms\\templates\\Form 3 - Sec 36(1).docx\", , True)\n  With doc\n    .Bookmarks(\"wAppTradingNames\").Range.Text = Nz(Me!AppTradingName, \"\")\n    .Bookmarks(\"wAppTradingName\").Range.Text = Nz(Me!AppTradingName, \"\")\n    .Bookmarks(\"wCompanyName\").Range.Text = Nz(Me!CompanyName, \"\")\n    .Bookmarks(\"wCompanyNumber\").Range.Text = Nz(Me!CompanyNumber, \"\")\n    .Bookmarks(\"wRAddress1\").Range.Text = Nz(Me!RAddress1, \"\")\n    .Bookmarks(\"wPostalCode\").Range.Text = Nz(Me!PostalCode, \"\")\n    .Bookmarks(\"wRPostalAddress1\").Range.Text = Nz(Me!RPostalAddress1, \"\")\n    .Bookmarks(\"wRPostalCode\").Range.Text = Nz(Me!RPostalCode, \"\")\n    .Bookmarks(\"wDomicilium1\").Range.Text = Nz(Me!Domicilium1, \"\")\n    .Bookmarks(\"wDomiciliumCode\").Range.Text = Nz(Me!DomiciliumCode, \"\")\n    .Bookmarks(\"wDomAfter1\").Range.Text = Nz(Me!DomAfter1, \"\")\n    .Bookmarks(\"wDomAfterCode\").Range.Text = Nz(Me!DomAfterCode, \"\")\n    .Bookmarks(\"wTelOffice\").Range.Text = Nz(Me!TelOffice, \"\")\n    .Bookmarks(\"wTelCell\").Range.Text = Nz(Me!TelCell, \"\")\n    .Bookmarks(\"wTelHome\").Range.Text = Nz(Me!TelHome, \"\")\n    .Bookmarks(\"wFaxNumber\").Range.Text = Nz(Me!FaxNumber, \"\")\n    .Bookmarks(\"wEmail\").Range.Text = Nz(Me!Email, \"\")\n    .Bookmarks(\"wFIP\").Range.Text = Nz(Me!FIP, \"\")\n    .Bookmarks(\"wAppLicCat\").Range.Text = Nz(Me!AppLicCat, \"\")\n    .Bookmarks(\"wLiqourType\").Range.Text = Nz(Me!LiqourType, \"\")\n    .Bookmarks(\"wAppTradingName\").Range.Text = Nz(Me!AppTradingName, \"\")\n    .Bookmarks(\"wAppTradingName\").Range.Text = Nz(Me!AppTradingName, \"\")\n    .Bookmarks(\"wLPAddress\").Range.Text = Nz(Me!LPAddress, \"\")\n    .Bookmarks(\"wErfNumber\").Range.Text = Nz(Me!ErfNumber, \"\")\n    .Bookmarks(\"wLPPostalCode\").Range.Text = Nz(Me!LPPostalCode, \"\")\n    .Bookmarks(\"wLPOwnership\").Range.Text = Nz(Me!LPOwnership, \"\")\n    .Bookmarks(\"wLPOwnersName\").Range.Text = Nz(Me!LpOwnersName, \"\")\n    .Bookmarks(\"wLpOwnerAddress\").Range.Text = Nz(Me!LpOwnerAddress, \"\")\n    .Bookmarks(\"wLpRightOccupation\").Range.Text = Nz(Me!LpRightOccupation, \"\")\n    .Bookmarks(\"wLPOccDuration\").Range.Text = Nz(Me!LPOccDuration, \"\")\n    .Bookmarks(\"wLpPremNotErected\").Range.Text = Nz(Me!LpPremNotErected, \"\")\n    .Bookmarks(\"wLpPremAlterReq\").Range.Text = Nz(Me!LpPremAlterReq, \"\")\n    .Bookmarks(\"wLpPremAllGood\").Range.Text = Nz(Me!LpPremAllGood, \"\")\n    .Bookmarks(\"wLpBuildCommence\").Range.Text = Nz(Me!LpBuildCommence, \"\")\n    .Bookmarks(\"wLpBuildDuration\").Range.Text = Nz(Me!LpBuildDuration, \"\")\n    .Bookmarks(\"wLpTradingHours\").Range.Text = Nz(Me!LpTradingHours, \"\")\n    .Bookmarks(\"wLpRenewal\").Range.Text = Nz(Me!LpRenewal, \"\")\n    .Bookmarks(\"wLpJobsa\").Range.Text = Nz(Me!LpJobsa, \"\")\n    .Bookmarks(\"wLpJobsB\").Range.Text = Nz(Me!LpJobsB, \"\")\n    .Bookmarks(\"wLpJobsC\").Range.Text = Nz(Me!LpJobsC, \"\")\n    .Bookmarks(\"wNNPRegName\").Range.Text = Nz(Me!NNPRegName, \"\")\n    .Bookmarks(\"wNNPRegNumber\").Range.Text = Nz(Me!NNPRegNumber, \"\")\n    .Bookmarks(\"wNNPRegDate\").Range.Text = Nz(Me!NNPRegDate, \"\")\n    .Bookmarks(\"wOtherInterests\").Range.Text = Nz(drst!OtherInterests, \"\")\n    .Visible = True\n    .Activate\n  End With\n\n  Dim rst As Recordset: Set rst = CurrentDb.OpenRecordset(Name:=\"5 Director Details\", Type:=RecordsetTypeEnum.dbOpenDynaset)\n  'Do While Not rst.EOF\n    With doc\n      .Bookmarks(\"wPersonLabel\").Range.Text = Nz(rst!PersonLabel, \"\")\n      .Bookmarks(\"wFullName\").Range.Text = Nz(rst!FullName, \"\")\n      .Bookmarks(\"wPhAddress\").Range.Text = Nz(rst!PhAddress, \"\")\n      .Bookmarks(\"wPhCode\").Range.Text = Nz(rst!PhCode, \"\")\n      .Bookmarks(\"wPAddress\").Range.Text = Nz(rst!PAddress, \"\")\n      .Bookmarks(\"wPCode\").Range.Text = Nz(rst!PCode, \"\")\n      .Bookmarks(\"wIdNumber\").Range.Text = Nz(rst!IdNumber, \"\")\n      .Visible = True\n      .Activate\n      rst.MoveNext\n    End With\n  'Loop\n\n  doc.SaveAs2 \"C:\\forms\\generated\\\" &amp; Me!ACNumber &amp; \"_Form 3 - Sec 36(1).docx\"\n  Set doc = Nothing\n  Set appWord = Nothing\n  Exit Sub\n\nerrHandler:\n  MsgBox Err.Number &amp; \": \" &amp; Err.Description\n\nEnd Sub\n\n\n`\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1504693754, "post_id": 46072805, "comment_id": 79106263, "body": "Where <code>k</code> is defined?"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "reply_to_user": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1504693786, "post_id": 46072805, "comment_id": 79106295, "body": "k is defined at the top i have only included the part where i have the issue."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1504698558, "post_id": 46072924, "comment_id": 79109577, "body": "@AnirudhChauhan - start debugging step by step with <code>F8</code> and try paying attention what <code>arrElem</code> is and its value. For example add <code>debug.print arrElem</code> before the <code>If Len(arrElem)=7</code>. Hopefully, after about 30 minutes of pressing <code>F8</code> you would see the solution."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1504694211, "last_edit_date": 1504694211, "creation_date": 1504693828, "answer_id": 46072924, "question_id": 46072805, "link": "https://stackoverflow.com/questions/46072805/error-in-the-vba-code/46072924#46072924", "title": "Error in the VBA code", "body": "<p>You need to exit the nested for loop, if you find <code>available</code> value. Like this:</p>\n\n<pre><code>With ThisWorkbook.Sheets(Prod(j))\nLastRow = ThisWorkbook.Sheets(Prod(j)).Columns(\"A\").Cells.Find(\"*\", \nSearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n    For Each cell In .Range(\"L1:W1000\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        arr = Split(Replace(cell.Value, \"  \", \" \"), \" \")\n        For Each arrElem In arr\n            If Len(arrElem) = 7 Then\n            ThisWorkbook.Sheets(\"Sheet1\").Range(\"D\" &amp; k).Value = \"available\"\n            Exit For 'You exit only the nested loop here!\n            Else\n            ThisWorkbook.Sheets(\"Sheet1\").Range(\"D\" &amp; k).Value = \"NOT available\"\n            End If\n        Next arrElem\n    Next cell\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504697491, "creation_date": 1504693498, "last_edit_date": 1504697491, "question_id": 46072805, "link": "https://stackoverflow.com/questions/46072805/error-in-the-vba-code", "title": "Error in the VBA code", "body": "<p>The aim of my code is to print available if there is any data betweeen L1 to W1000 of length 7.</p>\n\n<p>Although it finds the value of length 7, my code doesn't obey exit for.</p>\n\n<p>what is the reason?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Prod As Variant\nDim Dev As Variant\nDim counter As Integer\nDim j As Variant\n\nProd = Array(\"PBA_100\", \"PCA_500\", \"PRD_500\", \"PGA_500\", \"PVD_500\")\n\nFor j = LBound(Prod) To UBound(Prod)\n     MsgBox Prod(j)\n\n With ThisWorkbook.Sheets(Prod(j))\n LastRow = ThisWorkbook.Sheets(Prod(j)).Columns(\"A\").Cells.Find(\"*\", \n SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n    For Each cell In .Range(\"N2:N\" &amp; LastRow)\n        arr = Split(Replace(cell.Value, \"  \", \" \"), \" \")\n        For Each arrElem In arr\n            If Len(arrElem) = 7 Then\n            MsgBox arrElem\n        Exit For\n      Else\n      MsgBox arrElem\n            End If\n        Next arrElem\n    Next cell\n End With\n\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pdf", "fonts", "colors"], "comments": [{"owner": {"reputation": 6769, "user_id": 7073944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BecHV.png?s=128&g=1", "display_name": "Vanquished Wombat", "link": "https://stackoverflow.com/users/7073944/vanquished-wombat"}, "edited": false, "score": 0, "creation_date": 1504707779, "post_id": 46072266, "comment_id": 79116669, "body": "What programming language are you using please? AFAIK the JSO route is for VBA but the := construct and &#39;next i&#39; do not appear to be standard VBA."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7665534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b2e38d22a3a59ca2e5450c13e21c?s=128&d=identicon&r=PG&f=1", "display_name": "RASMP", "link": "https://stackoverflow.com/users/7665534/rasmp"}, "edited": false, "score": 0, "creation_date": 1504704278, "post_id": 46073006, "comment_id": 79114006, "body": "I have tried that as well, but that also gives me an error - Run-time error 13&#39;: Type mismatch :("}, {"owner": {"reputation": 6769, "user_id": 7073944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BecHV.png?s=128&g=1", "display_name": "Vanquished Wombat", "link": "https://stackoverflow.com/users/7073944/vanquished-wombat"}, "reply_to_user": {"reputation": 3, "user_id": 7665534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b2e38d22a3a59ca2e5450c13e21c?s=128&d=identicon&r=PG&f=1", "display_name": "RASMP", "link": "https://stackoverflow.com/users/7665534/rasmp"}, "edited": false, "score": 0, "creation_date": 1504707819, "post_id": 46073006, "comment_id": 79116702, "body": "Edited for VBA color array config. But see my question against your post  about what language you are using."}], "tags": [], "owner": {"reputation": 6769, "user_id": 7073944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BecHV.png?s=128&g=1", "display_name": "Vanquished Wombat", "link": "https://stackoverflow.com/users/7073944/vanquished-wombat"}, "is_accepted": true, "score": 0, "last_activity_date": 1504707704, "last_edit_date": 1504707704, "creation_date": 1504693993, "answer_id": 46073006, "question_id": 46072266, "link": "https://stackoverflow.com/questions/46072266/pdf-page-number-font-color-using-addwatermarkfromtext/46073006#46073006", "title": "pdf page number font color using addwatermarkfromtext", "body": "<p>According to <a href=\"http://help.adobe.com/livedocs/acrobat_sdk/10/Acrobat10_HTMLHelp/wwhelp/wwhimpl/js/html/wwhelp.htm?href=JS_API_AcroJS.88.437.html&amp;accessible=true\" rel=\"nofollow noreferrer\">the docs</a> the format for color information is more complex than you suggest. It needs a color type then value. Quote:</p>\n\n<blockquote>\n  <p>For example, the color red can be represented as [\"RGB\", 1, 0, 0]</p>\n</blockquote>\n\n<p>So I guess you want something more like </p>\n\n<pre><code>aColor:=[\"RGB\", 1, 0, 0]\n</code></pre>\n\n<p>But that may be for JavaScript. The equivalent in VBA would be something like:</p>\n\n<pre><code>dim color(0 to 3) as Variant \ncolor(0) = \"RGB\"\ncolor(1) = 1#\ncolor(2) = 0#\ncolor(3) = 0#\n</code></pre>\n\n<p>then </p>\n\n<pre><code>aColor=color\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7665534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6128b2e38d22a3a59ca2e5450c13e21c?s=128&d=identicon&r=PG&f=1", "display_name": "RASMP", "link": "https://stackoverflow.com/users/7665534/rasmp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 46073006, "answer_count": 1, "score": 0, "last_activity_date": 1504707704, "creation_date": 1504692009, "question_id": 46072266, "link": "https://stackoverflow.com/questions/46072266/pdf-page-number-font-color-using-addwatermarkfromtext", "title": "pdf page number font color using addwatermarkfromtext", "body": "<p>I have a question regarding inserting page numbers in a pdf file using addwatermarkfromtext but at the same time change the font color of the page number. I am using the following code to insert the page number and that is working very well. Searching the internet I should be able to insert a line with \"aColor:=color.red\" but that is not working and the code will return an error. Does anyone know how to change the standard font color (black) to another color??</p>\n\n<pre><code>for i=1 to 10\njso.addWatermarkFromText _\n            cText:=Str(i) , _\n            cFont:=\"Arial\", _\n            nFontSize:=9, _\n            nTextAlign:=1, _\n            nHorizAlign:=2, _\n            nVertAlign:=4, _\n            nVertValue:=24, _\n            nHorizValue:=-48, _\n            nStart:=i - 1, _\n            nEnd:=i - 1\nnext i\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "ms-office", "vsto", "aspose-cells"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1504696424, "post_id": 46071936, "comment_id": 79108101, "body": "I&#39;m presuming that you need this so that a user cannot manipulate the box?. If you assign a macro to the boxes in worksheet VBA, you can simply set the focus to somewhere on your worksheet (i.e. a cell) every time the box gets focus"}, {"owner": {"reputation": 28755, "user_id": 303685, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/uXNpf.jpg?s=128&g=1", "display_name": "Water Cooler v2", "link": "https://stackoverflow.com/users/303685/water-cooler-v2"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1504696607, "post_id": 46071936, "comment_id": 79108231, "body": "I understand that. I was wondering if there&#39;s a property or method I can call to disable focus altogether. Thing is: I am asking if there&#39;s something in VBA/VSTO only so I can get to know the property or method name. I am not going to be programming in either of those two models. I am writing something in Java against Office Online."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1504713884, "post_id": 46071936, "comment_id": 79120971, "body": "Make the workbook shared :)"}], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 1715603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQ6uN.png?s=128&g=1", "display_name": "shakeel", "link": "https://stackoverflow.com/users/1715603/shakeel"}, "is_accepted": true, "score": 1, "last_activity_date": 1504768933, "last_edit_date": 1504768933, "creation_date": 1504768531, "answer_id": 46090102, "question_id": 46071936, "link": "https://stackoverflow.com/questions/46071936/make-a-wordart-not-recieve-focus/46090102#46090102", "title": "Make a WordArt not recieve focus", "body": "<p>This can be achieved by protecting your worksheet. You can learn from internet how to protect worksheet and its contents or objects. Aspose.Cells supports the protection of worksheet.</p>\n\n<p>Please see the following sample code which uses Aspose.Cells APIs. It explains how to protect your worksheet contents or objects. Please modify the code as per your needs.</p>\n\n<p><em>Both Java and C# codes are given for a reference.</em></p>\n\n<p><strong>Java</strong></p>\n\n<pre><code>//Load your workbook\nWorkbook wb = new Workbook(\"sample.xlsx\");\n\n//Access first worksheet\nWorksheet ws = wb.getWorksheets().get(0);\n\n//Unlock all cells of your worksheet\nStyle st = ws.getCells().get(\"A1\").getStyle();\nst.setLocked(false);\n\nStyleFlag flg = new StyleFlag();\nflg.setLocked(true);\n\nws.getCells().applyStyle(st, flg);\n\n//Specify protection types\nProtection p = ws.getProtection();\np.setAllowEditingContent(false);\np.setAllowEditingObject(false);\np.setAllowEditingScenario(false);\n\n//Protect the worksheet\nws.protect(ProtectionType.ALL);\n\n//Save the workbook\nwb.save(\"output.xlsx\");\n</code></pre>\n\n<p><strong>C#</strong></p>\n\n<pre><code>//Load your workbook\nWorkbook wb = new Workbook(\"sample.xlsx\");\n\n//Access first worksheet\nWorksheet ws = wb.Worksheets[0];\n\n//Unlock all cells of your worksheet\nStyle st = ws.Cells[\"A1\"].GetStyle();\nst.IsLocked = false;\n\nStyleFlag flg = new StyleFlag();\nflg.Locked = true;\n\nws.Cells.ApplyStyle(st, flg);\n\n//Specify protection types\nProtection p = ws.Protection;\np.AllowEditingContent = false;\np.AllowEditingObject = false;\np.AllowEditingScenario = false;\n\n//Protect the worksheet\nws.Protect(ProtectionType.All);\n\n//Save the workbook\nwb.Save(\"output.xlsx\");\n</code></pre>\n\n<p><strong><em>Note:</strong> I am working as Developer Evangelist at Aspose</em></p>\n"}, {"comments": [{"owner": {"reputation": 28755, "user_id": 303685, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/uXNpf.jpg?s=128&g=1", "display_name": "Water Cooler v2", "link": "https://stackoverflow.com/users/303685/water-cooler-v2"}, "edited": false, "score": 0, "creation_date": 1505130069, "post_id": 46103169, "comment_id": 79271225, "body": "Thank you, Amjad."}], "tags": [], "owner": {"reputation": 1398, "user_id": 3405358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a8e03b141d1a64aad6f852f2c0faba?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad Sahi", "link": "https://stackoverflow.com/users/3405358/amjad-sahi"}, "is_accepted": false, "score": 1, "last_activity_date": 1504809945, "creation_date": 1504809945, "answer_id": 46103169, "question_id": 46071936, "link": "https://stackoverflow.com/questions/46071936/make-a-wordart-not-recieve-focus/46103169#46103169", "title": "Make a WordArt not recieve focus", "body": "<p>Well, in Aspose.Cells APIs, you may try using certain locking attributes of the wordart shape to accomplish your task, see the sample code for your reference:\ne.g\n<strong>Sample code:</strong></p>\n\n<pre><code>Workbook workbook = new Workbook();\nWorksheet worksheet = workbook.getWorksheets().get(0);\nShape wordart = worksheet.getShapes().addTextEffect(MsoPresetTextEffect.TEXT_EFFECT_1, \"CONFIDENTIAL\", \"Open Sans\", 50, false, true, 18, 8, 1, 1, 130, 800);\n\n    //Lock Shape Aspects.\n    wordart.setLocked(true);\n    wordart.setLockedProperty(ShapeLockType.SELECTION, true);\n    wordart.setLockedProperty(ShapeLockType.SHAPE_TYPE, true);\n    wordart.setLockedProperty(ShapeLockType.MOVE, true);\n    wordart.setLockedProperty(ShapeLockType.RESIZE, true);\n    wordart.setLockedProperty(ShapeLockType.TEXT, true);\n\n    FillFormat wordArtFormat = wordart.getFill();\n    wordArtFormat.setFillType(FillType.SOLID);\n    wordArtFormat.getSolidFill().setColor(Color.getLightGray());\n    wordArtFormat.setTransparency(0.55);\n    wordart.setHasLine(false); \n\n    workbook.save(\"out1.xlsx\");\n</code></pre>\n\n<p>Hope, this helps a bit.</p>\n\n<p>I am working as Support developer/Evangelist at Aspose.</p>\n"}], "owner": {"reputation": 28755, "user_id": 303685, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/uXNpf.jpg?s=128&g=1", "display_name": "Water Cooler v2", "link": "https://stackoverflow.com/users/303685/water-cooler-v2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 46090102, "answer_count": 2, "score": 0, "last_activity_date": 1504809945, "creation_date": 1504691120, "question_id": 46071936, "link": "https://stackoverflow.com/questions/46071936/make-a-wordart-not-recieve-focus", "title": "Make a WordArt not recieve focus", "body": "<p>Is there an API in VSTO/VBA for Excel or Aspose Cells for Java to make it so that a WordArt I added to the Excel worksheet never receives keyboard or mouse focus?</p>\n\n<p>For e.g. in the picture below, when I click on the WordArt, it receives focus. When it has focus and I hit the Tab key on the keyboard, the focus goes to the next WordArt, i.e. the one above it.</p>\n\n<p>I'd like these WordArt objects never to receive keyboard or mouse focus. Is there a way?</p>\n\n<p><a href=\"https://i.stack.imgur.com/9tryR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9tryR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1504697499, "post_id": 46071620, "comment_id": 79108834, "body": "There&#39;s always Excel4 macros in an Excel4 type worksheet?"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1504690526, "creation_date": 1504690526, "answer_id": 46071698, "question_id": 46071620, "link": "https://stackoverflow.com/questions/46071620/vba-execute-code-stored-in-cells-is-it-possible/46071698#46071698", "title": "VBA execute code stored in Cells - is it possible?", "body": "<p>No. You can't store code in the worksheet. But you can store the name of a procedure in a worksheet cell and then call that procedure using <code>Application.Run</code></p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 8135572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a951b5d2e96c304e6f07edfa54b68937?s=128&d=identicon&r=PG&f=1", "display_name": "Drac0", "link": "https://stackoverflow.com/users/8135572/drac0"}, "edited": false, "score": 0, "creation_date": 1504691276, "post_id": 46071942, "comment_id": 79104569, "body": "I just need to use simple functions like instr, abs and so on so i guess it would be easier to just look for specific words in cells and if they are found use specific funtions."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1504691294, "last_edit_date": 1525816189, "creation_date": 1504691133, "answer_id": 46071942, "question_id": 46071620, "link": "https://stackoverflow.com/questions/46071620/vba-execute-code-stored-in-cells-is-it-possible/46071942#46071942", "title": "VBA execute code stored in Cells - is it possible?", "body": "<p><strong>Short answer:</strong> No</p>\n\n<p>You can only run code that is within the VBA editor. Therefore it is not possible to run code from a cell directly. </p>\n\n<p><strong>But \u2026</strong><br>\nBut what you can do (as a workaround) is writing a procedure that extracts the VBA code from that cell and includes it into a module and then runs that code.</p>\n\n<p>However even if this is possible this would be a task for a pro-user and it is not recommended for beginners (you should know what you do here).</p>\n\n<p>Nevertheless if you want to have a look into how to add procedures/functions into the VBA Editor have a look at <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">Programming The VBA Editor</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504693377, "post_id": 46072501, "comment_id": 79106019, "body": "Can <code>Application.Run</code> line be replaced with <code>Evaluate foo</code>?"}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504693573, "post_id": 46072501, "comment_id": 79106138, "body": "I do not think so: <code>Evaluate</code> parses a string to an excel-based formula, which is not the same as what <code>Application.Run</code> does."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504693952, "post_id": 46072501, "comment_id": 79106413, "body": "<code>Worksheet(&quot;Sheet&quot;).Evaluate &quot;0+Test()&quot;</code> works for me though. I&#39;m curious, are you programmatically creating separate module with <code>Sub</code> which consists of one line from cell? Kinda new to VBA, so anything new amazes me."}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504694704, "post_id": 46072501, "comment_id": 79106922, "body": "Does <code>Worksheet(&quot;Sheet&quot;).Evaluate &quot;0+test()&quot;</code> work as a replacement of <code>Application.Run</code>? It works as a way to call the <code>test</code> subroutine, but when I try to use it as a replacement for <code>Application.Run</code>, it fails. Yes, <code>StringExecute</code> takes a string which is the main body of a <code>Sub</code> and turns it into an actual <code>Sub</code>, it executes it and then it removes it. I have seen this in a couple of applications that connect to VBA/Excel, but needs to be quite defensive when programming like this in an actual application."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1504695319, "post_id": 46072501, "comment_id": 79107331, "body": "Hm, I was wrong, it can&#39;t evaluate non-existing <code>Sub</code>, though there is a workaround by adding another <code>Sub</code>/<code>Function</code> to <code>Call foo</code>. Anyway <code>Application.Run</code> is much easier. Thanks for tips."}], "tags": [], "owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "is_accepted": false, "score": 4, "last_activity_date": 1504692632, "creation_date": 1504692632, "answer_id": 46072501, "question_id": 46071620, "link": "https://stackoverflow.com/questions/46071620/vba-execute-code-stored-in-cells-is-it-possible/46072501#46072501", "title": "VBA execute code stored in Cells - is it possible?", "body": "<p>First, use <a href=\"https://stackoverflow.com/questions/25638344/programmatic-access-to-visual-basic-project-is-not-trusted-excel\">this answer</a> to ensure programmatic access to the VBA model. Then, use <a href=\"https://stackoverflow.com/questions/43216390/how-to-run-a-string-as-a-command-in-vba\">this method</a> that makes a string parser for a simple command located in a worksheet cell. This should be enough to get you going.</p>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/O9im3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O9im3.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim strCode As String\n    strCode = Sheet1.Range(\"A1\").Text\n    StringExecute strCode\nEnd Sub\n\nSub StringExecute(s As String) \n    ' Credits to A.S.H., see https://stackoverflow.com/questions/43216390/how-to-run-a-string-as-a-command-in-vba\n    Dim vbComp As Object\n    Set vbComp = ThisWorkbook.VBProject.VBComponents.Add(1)\n    vbComp.CodeModule.AddFromString \"Sub foo()\" &amp; vbCrLf &amp; s &amp; vbCrLf &amp; \"End Sub\"\n    Application.Run vbComp.Name &amp; \".foo\"\n    ThisWorkbook.VBProject.VBComponents.Remove vbComp\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1504693353, "creation_date": 1504693353, "answer_id": 46072765, "question_id": 46071620, "link": "https://stackoverflow.com/questions/46071620/vba-execute-code-stored-in-cells-is-it-possible/46072765#46072765", "title": "VBA execute code stored in Cells - is it possible?", "body": "<p>The closest you can easily get to your goal is to use VBA User Defined Functions. These can be called from worksheet formulas in the same way as native Excel functions.</p>\n\n<p>But they have limitations compared to a VBA subroutine - the main one being that they can only return information to the cells that they occupy.</p>\n"}], "owner": {"reputation": 89, "user_id": 8135572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a951b5d2e96c304e6f07edfa54b68937?s=128&d=identicon&r=PG&f=1", "display_name": "Drac0", "link": "https://stackoverflow.com/users/8135572/drac0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1701, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1504693353, "creation_date": 1504690309, "last_edit_date": 1531161705, "question_id": 46071620, "link": "https://stackoverflow.com/questions/46071620/vba-execute-code-stored-in-cells-is-it-possible", "title": "VBA execute code stored in Cells - is it possible?", "body": "<p>Is it possible to execute code written in specific excel cells?</p>\n\n<p>For example: In <code>Range(\"A1\")</code> I have <code>text -&gt; debug.print(\"Test\")</code>. I need some way to execute this from VBA code.</p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["excel", "vba", "hide", "hidden"], "comments": [{"owner": {"reputation": 71, "user_id": 8097995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68d44158bcb16fe81d0aee6fb98d988?s=128&d=identicon&r=PG&f=1", "display_name": "AmyOakes", "link": "https://stackoverflow.com/users/8097995/amyoakes"}, "edited": false, "score": 2, "creation_date": 1504689975, "post_id": 46071407, "comment_id": 79103581, "body": "Have you tried any code already? If so could you post it on your question. Also is it if on column has a 0 or all the columns are 0?"}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 1259330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JhSL.jpg?s=128&g=1", "display_name": "perfo", "link": "https://stackoverflow.com/users/1259330/perfo"}, "is_accepted": false, "score": 0, "last_activity_date": 1504692148, "creation_date": 1504692148, "answer_id": 46072317, "question_id": 46071407, "link": "https://stackoverflow.com/questions/46071407/hide-columns-which-its-row-have-zero-value-using-vba-excel/46072317#46072317", "title": "Hide columns which its row have zero value using VBA Excel", "body": "<pre><code>Option Explicit\nSub HideZeros()\n  HideCells (1)\nEnd Sub\nSub HideCells(Col_Num As Integer)\nDim Row_num As Integer\nFor Row_num = 1 To 10\n  If Sheet1.Cells(Row_num, Col_Num).Value = 0 Then Sheet1.Cells(Row_num, Col_Num).Delete Shift:=xlUp\nNext\nEnd Sub\n</code></pre>\n\n<p>The above is to point you in the right direction to modify as you wish. It will delete any cells with the 0 value in the first 10 rows of sheet 1 column A and move the rest up.. \nYou can't hide one cell you can only hide a row / column. So delete is your only option...Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 8097995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68d44158bcb16fe81d0aee6fb98d988?s=128&d=identicon&r=PG&f=1", "display_name": "AmyOakes", "link": "https://stackoverflow.com/users/8097995/amyoakes"}, "is_accepted": false, "score": 0, "last_activity_date": 1504693549, "creation_date": 1504693549, "answer_id": 46072827, "question_id": 46071407, "link": "https://stackoverflow.com/questions/46071407/hide-columns-which-its-row-have-zero-value-using-vba-excel/46072827#46072827", "title": "Hide columns which its row have zero value using VBA Excel", "body": "<p>I have created two solutions dependent on what it is you want to do. In the code i  have explained what each step is doing the rest of the code is just repeated for the different columns. \nThe first one hides the column if and row in that column is equal to zero:</p>\n\n<pre><code>    Sub HideRowsWhereAnyRowIsZero()\n\n    Dim i As Long 'Declarations\n\n    For i = 1 To Rows.Count 'Find the last row and loop through until reached\n        If Cells(i, 1).Value = \"0\" Then 'if the cell equals 0 then move to next step if not move to next cell\n                Cells(i, 1).EntireColumn.Hidden = True 'hide column\n                    If Cells(i, 1).EntireColumn.Hidden = True Then Exit For 'if column has been hidden then break the loop\n        End If 'if cell doesnt  equal 0 move on\n    Next i 'creates loop to go thorugh each row in column\n\n\n    For i = 1 To Rows.Count\n        If Cells(i, 2).Value = \"0\" Then\n            Cells(i, 2).EntireColumn.Hidden = True\n                If Cells(i, 2).EntireColumn.Hidden = True Then Exit For\n        End If\n    Next i\n\n    For i = 1 To Rows.Count\n        If Cells(i, 3).Value = \"0\" Then\n            Cells(i, 3).EntireColumn.Hidden = True\n                If Cells(i, 3).EntireColumn.Hidden = True Then Exit For\n        End If\n    Next i\n\n\n    For i = 1 To Rows.Count\n        If Cells(i, 4).Value = \"0\" Then\n            Cells(i, 4).EntireColumn.Hidden = True\n                If Cells(i, 4).EntireColumn.Hidden = True Then Exit For\n        End If\n    Next i\n\n\n    For i = 1 To Rows.Count\n        If Cells(i, 6).Value = \"0\" Then\n            Cells(i, 6).EntireColumn.Hidden = True\n                If Cells(i, 6).EntireColumn.Hidden = True Then Exit For\n        End If\n    Next i\n\n    End Sub\n</code></pre>\n\n<p>The next piece of code hides only where all the rows in the column are 0 </p>\n\n<pre><code>Sub HideColumnsWhenAllRowsAreZero()\n\nDim Lastrow As Long\n\nLastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).row 'finds the last row for column A\n\n    If WorksheetFunction.Sum(Range(\"A1:A\" &amp; Lastrow)) = 0 Then 'sum the values of the column if it equals 0 then move on to hide column\n\n        Range(\"A1:A\" &amp; Lastrow).EntireColumn.Hidden = True 'Hides column\n\n    End If 'Ends statement for column\n\nLastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).row\n\n    If WorksheetFunction.Sum(Range(\"B1:B\" &amp; Lastrow)) = 0 Then\n\n        Range(\"B1:B\" &amp; Lastrow).EntireColumn.Hidden = True\n\n    End If\n\nLastrow = Range(\"C\" &amp; Rows.Count).End(xlUp).row\n\n       If WorksheetFunction.Sum(Range(\"C1:C\" &amp; Lastrow)) = 0 Then\n\n        Range(\"C1:C\" &amp; Lastrow).EntireColumn.Hidden = True\n\n    End If\n\nLastrow = Range(\"D\" &amp; Rows.Count).End(xlUp).row\n\n    If WorksheetFunction.Sum(Range(\"D1:D\" &amp; Lastrow)) = 0 Then\n\n        Range(\"D1:D\" &amp; Lastrow).EntireColumn.Hidden = True\n\n    End If\n\nLastrow = Range(\"F\" &amp; Rows.Count).End(xlUp).row\n\n    If WorksheetFunction.Sum(Range(\"F1:F\" &amp; Lastrow)) = 0 Then\n\n        Range(\"F1:F\" &amp; Lastrow).EntireColumn.Hidden = True\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>I would suggest stepping thorugh the code (using F8) and try to understand what is actually happening.</p>\n"}], "owner": {"reputation": 1, "user_id": 8236158, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ynh0n45HAgY/AAAAAAAAAAI/AAAAAAAAALE/XeUJ3jxn9wM/photo.jpg?sz=128", "display_name": "Minh \u0110\u1ee9c Ph\u1ea1m", "link": "https://stackoverflow.com/users/8236158/minh-%c4%90%e1%bb%a9c-ph%e1%ba%a1m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1291, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1504693549, "creation_date": 1504689745, "question_id": 46071407, "link": "https://stackoverflow.com/questions/46071407/hide-columns-which-its-row-have-zero-value-using-vba-excel", "title": "Hide columns which its row have zero value using VBA Excel", "body": "<p>I have an Excel worksheet with the values is numbers in columns A,B,C,D and F (these columns have multiple rows). All I want is when click on a button, all columns which its rows have zero value will be hidden.     </p>\n\n<p>So if anyone have solution for this, please help me! Thank you so much</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1504689179, "post_id": 46070879, "comment_id": 79102959, "body": "Please edit your question to include what you&#39;ve already tried to save us spending time suggesting things that don&#39;t work for you. It also helps us to better understand what you are trying to achieve."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4425229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3Ltpc.jpg?s=128&g=1", "display_name": "TheMightyNight", "link": "https://stackoverflow.com/users/4425229/themightynight"}, "edited": false, "score": 0, "creation_date": 1504689149, "post_id": 46071130, "comment_id": 79102933, "body": "@Vivyata: thanks. But this is specific to Name Manager. Let me add screen shots."}, {"owner": {"reputation": 151, "user_id": 4425229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3Ltpc.jpg?s=128&g=1", "display_name": "TheMightyNight", "link": "https://stackoverflow.com/users/4425229/themightynight"}, "edited": false, "score": 0, "creation_date": 1504689725, "post_id": 46071130, "comment_id": 79103398, "body": "Did you find these values &quot;ads and das&quot; shown in name manager. e.g. we can see &quot;LOF,MSBIP,MSAIS&quot; in added image. because i tried the same but no values are getting populated."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 151, "user_id": 4425229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3Ltpc.jpg?s=128&g=1", "display_name": "TheMightyNight", "link": "https://stackoverflow.com/users/4425229/themightynight"}, "edited": false, "score": 0, "creation_date": 1504689816, "post_id": 46071130, "comment_id": 79103453, "body": "@TheMightyNight - <code>ads</code> and <code>das</code> were written by me in Excel. In the name manager you give the address(es) of the range(es)."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 151, "user_id": 4425229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3Ltpc.jpg?s=128&g=1", "display_name": "TheMightyNight", "link": "https://stackoverflow.com/users/4425229/themightynight"}, "edited": false, "score": 0, "creation_date": 1504689976, "post_id": 46071130, "comment_id": 79103583, "body": "The values are not populated indeed, but they are there. You can check it by using the <code>index()</code> formulas in my answer."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 151, "user_id": 4425229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3Ltpc.jpg?s=128&g=1", "display_name": "TheMightyNight", "link": "https://stackoverflow.com/users/4425229/themightynight"}, "edited": false, "score": 0, "creation_date": 1504690131, "post_id": 46071130, "comment_id": 79103705, "body": "@TheMightyNight - it does not show, because they are two ranges. But you can see that they exist, if you use the <code>=Index()</code> formula from my answer. Just refer the way I do."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1504690578, "last_edit_date": 1504690578, "creation_date": 1504688970, "answer_id": 46071130, "question_id": 46070879, "link": "https://stackoverflow.com/questions/46070879/excel-name-manager-referring-2-ranges/46071130#46071130", "title": "Excel Name Manager referring 2 ranges", "body": "<p>Let's say you have <code>test</code> named range, refering to <strong>B4</strong> and <strong>D4</strong> like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GdM3s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GdM3s.png\" alt=\"enter image description here\"></a></p>\n\n<p>To get <strong>B4</strong> you need this formula:</p>\n\n<pre><code>=INDEX(test;1;1)\n</code></pre>\n\n<p>To get <strong>D4</strong> you need this formula:</p>\n\n<pre><code>=INDEX(test;1;1;2)\n</code></pre>\n\n<hr>\n\n<p>This is how the name manager looks like for two different cells:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sVuhz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sVuhz.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>In the name range more than one range is shown like this <code>{...}</code>. This is done for internal reasons by Excel. However, if it was not, the expected output should have been like this: <code>[{\"LOF\"};{\"MSAIS\"}]</code> or something similar.</p>\n"}], "owner": {"reputation": 151, "user_id": 4425229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/3Ltpc.jpg?s=128&g=1", "display_name": "TheMightyNight", "link": "https://stackoverflow.com/users/4425229/themightynight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 46071130, "answer_count": 1, "score": 0, "last_activity_date": 1504690578, "creation_date": 1504688314, "last_edit_date": 1531161705, "question_id": 46070879, "link": "https://stackoverflow.com/questions/46070879/excel-name-manager-referring-2-ranges", "title": "Excel Name Manager referring 2 ranges", "body": "<p>In MS-Excel 2016's name manager if i'm trying to add data for 2 or more consecutive cells, it's working fine. e.g.</p>\n\n<pre><code>='Data Sets'!$C$2:$C$5\n</code></pre>\n\n<p>Now if i want to get only 2 data i.e. </p>\n\n<pre><code>$C$2 &amp; $C$5\n</code></pre>\n\n<p>I'm unable to do so. Kindly help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/02q9X.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/02q9X.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Note: I'm using these for dynamic lists (INDIRECT).</p>\n\n<p>Expected Output: <code>{\"LOF\";\"MSAIS\"}</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504688504, "post_id": 46070805, "comment_id": 79102416, "body": "to get the first <b>emptyRow</b> in column &quot;A&quot;, use : <code>emptyRow = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row + 1</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504688854, "post_id": 46070805, "comment_id": 79102713, "body": "Besided that your code runs well with the User_form I&#39;ve tested, what values are you using in <code>PartSNTextBox</code> ?"}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504743152, "post_id": 46070805, "comment_id": 79134010, "body": "Hi Shai Rado, the values that will be key in is 123456789AA0000001 (9 integer+2 aphablet + 7 integer. The weird thing is my result will shows correct answer on the excel cells but  &quot;Run Time Error 13&quot; will appear."}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504751300, "post_id": 46070805, "comment_id": 79135901, "body": "<code>Private Sub UserForm_Initialize()  If Cells(2, 8) = &quot;&quot; Then NextSNTextBox.Value = &quot;123456789AA0000001&quot; Else NextSNTextBox.Value = Cells(2, 8).Value End If  PartSNTextBox.Value = &quot;&quot;  Label11.BackColor = 1 Label12.BackColor = 1  PackingSNTextBox.Value = &quot;&quot;  Label8.BackColor = 1 Label9.BackColor = 1  PartSNTextBox.SetFocus  End Sub</code>"}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504751316, "post_id": 46070805, "comment_id": 79135904, "body": "<code>Private Sub PartSNTextBox_Afterupdate() If Not IsEmpty(PartSNTextBox) Then Label11.BackColor = 1 Label12.BackColor = 1 Label8.BackColor = 1 Label9.BackColor = 1 End If  If PartSNTextBox.Value = NextSNTextBox.Value Then Label12.BackColor = vbGreen PackingSNTextBox.Enabled = True  Else PackingSNTextBox.Enabled = False Label11.BackColor = vbRed MsgBox (&quot;Wrong Serial Number&quot;) PartSNTextBox = &quot;&quot; PartSNTextBox.SetFocus  End If End Sub  Private Sub PartSNTextBox_Enter() PackingSNTextBox.Enabled = True  End Sub</code>"}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504751348, "post_id": 46070805, "comment_id": 79135910, "body": "<code>Private Sub PackingSNTextBox_Enter() ClearButton.Enabled = True  End Sub Private Sub ClearButton_Click()  Call UserForm_Initialize  End Sub Private Sub CancelButton_Click()  Unload Me  End Sub</code>"}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504751365, "post_id": 46070805, "comment_id": 79135917, "body": "I posted other part of code as maybe other part of code is causing fail"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1504750790, "post_id": 46072007, "comment_id": 79135778, "body": "I had change to &quot;Change&quot;. However, same &quot;Run Time Error 13&quot; appear too."}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1504751112, "post_id": 46072007, "comment_id": 79135852, "body": "<code>Private Sub PartSNTextBox_Afterupdate() If Not IsEmpty(PartSNTextBox) Then Label11.BackColor = 1 Label12.BackColor = 1 Label8.BackColor = 1 Label9.BackColor = 1 End If  If PartSNTextBox.Value = NextSNTextBox.Value Then Label12.BackColor = vbGreen PackingSNTextBox.Enabled = True  Else PackingSNTextBox.Enabled = False Label11.BackColor = vbRed MsgBox (&quot;Wrong Serial Number&quot;) PartSNTextBox = &quot;&quot; PartSNTextBox.SetFocus  End If End Sub  Private Sub PartSNTextBox_Enter() PackingSNTextBox.Enabled = True  End Sub</code>"}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1504751179, "post_id": 46072007, "comment_id": 79135864, "body": "`Option Explicit Private Sub UserForm_Initialize()  If Cells(2, 8) = &quot;&quot; Then NextSNTextBox.Value = &quot;123456789AA0000001&quot; Else NextSNTextBox.Value = Cells(2, 8).Value End If  PartSNTextBox.Value = &quot;&quot;  Label11.BackColor = 1 Label12.BackColor = 1  PackingSNTextBox.Value = &quot;&quot;  Label8.BackColor = 1 Label9.BackColor = 1  PartSNTextBox.SetFocus  End Sub"}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1504751227, "post_id": 46072007, "comment_id": 79135880, "body": "I posted other part of code as maybe other part of code is causing fail"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1504751272, "post_id": 46072007, "comment_id": 79135893, "body": "PackingSNTextBox must have a non-numeric character in it.   Scanners are programmed to prefix and suffix special characters to the barcode.  A line return at the end should not cause an issue but it might."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1504751661, "post_id": 46072007, "comment_id": 79135987, "body": "I just updated my answer with a crude function to return the numeric portion of a string.  Let me know it it works."}, {"owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "edited": false, "score": 0, "creation_date": 1505819407, "post_id": 46072007, "comment_id": 79559884, "body": "Hi Thomas, Thanks for your help. I had use your formula and with some modification to obtain what I want."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1504751605, "last_edit_date": 1504751605, "creation_date": 1504691288, "answer_id": 46072007, "question_id": 46070805, "link": "https://stackoverflow.com/questions/46070805/excel-vba-run-time-error-13-stuck-on-the-1-formula/46072007#46072007", "title": "Excel VBA - Run Time Error 13 (Stuck on the +1 formula)", "body": "<p>The <code>AfterUpdate</code> event fires before the control's value is changed.  Use the <code>Change()</code> event instead.</p>\n\n<p>Here is my simple test:</p>\n\n<pre><code>Private Sub PackingSNTextBox_AfterUpdate()\n    lblPackingSNTextBox_AfterUpdate.Caption = \"PackingSNTextBox_AfterUpdate: \" &amp; PartSNTextBox.Value\nEnd Sub\n\nPrivate Sub PartSNTextBox_Change()\n     lblPartSNTextBox_Change.Caption = \"PartSNTextBox_Change: \" &amp; PartSNTextBox.Value\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Tofjz.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tofjz.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub PartSNTextBox_Change()\n\n    Dim Temp1 As String, Temp1A As Long, Temp1B As String, Temp2 As String, Temp11 As Long, Temp1AA As String, Temp3 As String\n    PartSNTextBox.Enabled = True\n\n    If PartSNTextBox.Value = PackingSNTextBox.Value Then\n        Label8.BackColor = vbGreen\n\n        Temp1 = Right(PackingSNTextBox.Value, 7)\n        Temp11 = getNumbersFromString(Temp1)\n        Temp1A = Temp11 + 1\n        Temp1AA = CStr(Temp1A)\n        Temp1B = Right(\"0000000\" &amp; Temp1AA, 7)\n        Temp3 = Left(PackingSNTextBox.Value, 9)\n        Temp2 = Temp3 &amp; Temp1B\n\n        With Sheet1\n            With .Range(\"A\" &amp; .Rows.Count).Offset(1)\n                'Transfer information\n                .Value = Label13\n                .Offset(0, 1).Value = Label14\n                .Offset(0, 2).Value = Now\n                .Offset(0, 3).Value = PartSNTextBox.Value\n                .Offset(0, 4).Value = PackingSNTextBox.Value\n            End With\n        End With\n\n        NextSNTextBox.Value = Temp2\n        Cells(emptyRow, 8).Value = Temp2\n        PartSNTextBox.Value = \"\"\n        PackingSNTextBox.Value = \"\"\n        PartSNTextBox.SetFocus\n    Else\n        ClearButton.Enabled = False\n        Label9.BackColor = vbRed\n        MsgBox (\"Wrong Pairing\")\n        PackingSNTextBox = \"\"\n        PackingSNTextBox.SetFocus\n    End If\nEnd Sub\n\nFunction getNumbersFromString(text As String) As Single\n    Dim result As String\n    Dim i As Long\n    For i = 1 To Len(text)\n        If Mid(text, i, 1) Like \"[1-9.,]\" Then result = result &amp; Mid(text, i, 1)\n    Next\n    If Len(result) &gt; 0 Then getNumbersFromString = CSng(s)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8567830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66cd36f02666482a178832b00516b386?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/8567830/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 46072007, "answer_count": 1, "score": 0, "last_activity_date": 1504751605, "creation_date": 1504688110, "last_edit_date": 1504688403, "question_id": 46070805, "link": "https://stackoverflow.com/questions/46070805/excel-vba-run-time-error-13-stuck-on-the-1-formula", "title": "Excel VBA - Run Time Error 13 (Stuck on the +1 formula)", "body": "<p>I am doing a scanning Barcode system by using form. \nThis is how the form works:</p>\n\n<ol>\n<li>User will scan the barcode into \"Packing QR Code Serial Number\".</li>\n<li>Form will compare \"Packing QR Code Serial Number\" with \"Part QR Code Serial Number\". If same, shows \"OK\". Then, <strong>the last 7 number is choosen out and increase 1</strong>; if not, show \"NG\" and setfocus back to \"Packing QR Code Serial Number\".</li>\n</ol>\n\n<p>However, Excel showed \"Run Time Error 13\" and stuck on the +1 formula\".\nMay I know why is this happen? Any mistake on the code ?\nThanks</p>\n\n<pre><code>_____________________________________________________________________________\nPrivate Sub PackingSNTextBox_AfterUpdate()\n\nDim emptyRow As Long, Temp1 As String, Temp1A As Long, Temp1B As String, Temp2 As String, Temp11 As Long, Temp1AA As String, Temp3 As String\n\n'Make Sheet1 active\nSheet1.Activate\nPartSNTextBox.Enabled = True\n\nIf PartSNTextBox.Value = PackingSNTextBox.Value Then\n    Label8.BackColor = vbGreen\n\n    Temp1 = Right(PackingSNTextBox.Value, 7)\n    Temp11 = CLng(Temp1)\n    Temp1A = Temp11 + 1\n    Temp1AA = CStr(Temp1A)\n    Temp1B = Right(\"0000000\" &amp; Temp1AA, 7)\n    Temp3 = Left(PackingSNTextBox.Value, 9)\n    Temp2 = Temp3 &amp; Temp1B\n\n    'Determine emptyRow\n    emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n    'Transfer information\n    Cells(emptyRow, 1).Value = Label13\n    Cells(emptyRow, 2).Value = Label14\n    Cells(emptyRow, 3).Value = Now\n    Cells(emptyRow, 4).Value = PartSNTextBox.Value\n    Cells(emptyRow, 5).Value = PackingSNTextBox.Value\n\n    NextSNTextBox.Value = Temp2\n    Cells(emptyRow, 8).Value = Temp2\n    PartSNTextBox.Value = \"\"\n    PackingSNTextBox.Value = \"\"\n    PartSNTextBox.SetFocus    \nElse\n    ClearButton.Enabled = False\n    Label9.BackColor = vbRed\n    MsgBox (\"Wrong Pairing\")\n    PackingSNTextBox = \"\"\n    PackingSNTextBox.SetFocus\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504687953, "post_id": 46070685, "comment_id": 79102018, "body": "(1) Why don&#39;t you use formulas? There is no need for VBA I think. Formulas are Excel&#39;s strength this is what it was designed for. (2) If you really need VBA then please show the code you already have and ask a <i>specific</i> question to it, because this is not a free code writing service. (3) Also try to describe it more detailed, your question is not very clear/exactly. You even didn&#39;t ask a question."}, {"owner": {"reputation": 1, "user_id": 2630581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437620713/picture?type=large", "display_name": "Sathya", "link": "https://stackoverflow.com/users/2630581/sathya"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504688185, "post_id": 46070685, "comment_id": 79102169, "body": "thank you for replying formula is enough for me but i have to add only specific columns for each cases how to do in excel formula and transfer to next sheet"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504688299, "post_id": 46070685, "comment_id": 79102268, "body": "Sorry but your question is very unclear. You need to be much more specific to get a useful answer. And you need to show what you already have, because we will not do all the work for you. People are here to help you to solve your issues on your own."}, {"owner": {"reputation": 1, "user_id": 2630581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437620713/picture?type=large", "display_name": "Sathya", "link": "https://stackoverflow.com/users/2630581/sathya"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504688357, "post_id": 46070685, "comment_id": 79102305, "body": "column h2 to h8 and h9 to h10 and h11 to h13 should be automatically selected and sum is it possible to do for such case and transfer to sheet 2"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504688451, "post_id": 46070685, "comment_id": 79102369, "body": "Then use formulas <code>=SUM(Sheet1!H2:H8)</code> and <code>=SUM(Sheet1!H9:H10)</code> and <code>=SUM(Sheet1!H11:H13)</code> in sheet 2"}, {"owner": {"reputation": 1, "user_id": 2630581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437620713/picture?type=large", "display_name": "Sathya", "link": "https://stackoverflow.com/users/2630581/sathya"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504688966, "post_id": 46070685, "comment_id": 79102783, "body": "this is very direct formula which i need is sum of sheet H2 to H8 may wary from case to case for example some excel sheet if the first column value range 0 to 300 lies in H2 to H15 then h2 to h8 has to be sum. the sheet should automatically select value range in 300 + of column 1 and sum it. i tried with direct formula earlier as given by you it is tedious because i have thousands of data which cannot be done manually."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504690138, "post_id": 46070685, "comment_id": 79103710, "body": "This can still be done without VBA (see my answer below). As I said try to use formulas first this is Excel&#39;s strength."}, {"owner": {"reputation": 1, "user_id": 2630581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437620713/picture?type=large", "display_name": "Sathya", "link": "https://stackoverflow.com/users/2630581/sathya"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504692322, "post_id": 46070685, "comment_id": 79105286, "body": "thank you it was usefull"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1504690057, "last_edit_date": 1504690057, "creation_date": 1504689681, "answer_id": 46071393, "question_id": 46070685, "link": "https://stackoverflow.com/questions/46070685/using-excel-macro-to-sum-data-of-specific-column-and-transfer-data-to-sheet2/46071393#46071393", "title": "using excel macro to sum data of specific column and transfer data to sheet2", "body": "<p>This can be done with the formula <a href=\"https://support.office.com/en-us/article/SUMIFS-function-c9e748f5-7ea7-455d-9406-611cebce642b\" rel=\"nofollow noreferrer\">SUMIFS</a></p>\n\n<pre><code>=SUMIFS(Sheet1!H:H,Sheet1!A:A,\"&gt;=0\",Sheet1!A:A,\"&lt;300\")\n</code></pre>\n\n<p>This formula calculates the sum of column H,<br>\nwhere the value in column A is between 0 and 299 (<code>&gt;=0 and &lt;300</code>)</p>\n\n<pre><code>=SUMIFS(Sheet1!H:H,Sheet1!A:A,\"&gt;=300\",Sheet1!A:A,\"&lt;600\")\n</code></pre>\n\n<p>This formula calculates the sum of column H,<br>\nwhere the value in column A is between 300 and 599  (<code>&gt;=300 and &lt;600</code>)</p>\n\n<blockquote>\n  <p>Note: Make sure you use the correct criteria and that eg 300 is not included in both ranges (No overlapping). First range goes from 0 to 299 second range goes from 300 to 599!<br>\n  Therefore I used <code>&gt;=</code> and <code>&lt;</code>. Make sure that <code>=</code> is only used in the upper OR the lower of these both criteria.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 2630581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1437620713/picture?type=large", "display_name": "Sathya", "link": "https://stackoverflow.com/users/2630581/sathya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 46071393, "answer_count": 1, "score": 0, "last_activity_date": 1504690087, "creation_date": 1504687740, "last_edit_date": 1504690087, "question_id": 46070685, "link": "https://stackoverflow.com/questions/46070685/using-excel-macro-to-sum-data-of-specific-column-and-transfer-data-to-sheet2", "title": "using excel macro to sum data of specific column and transfer data to sheet2", "body": "<p>I'm working on Excel 2007 macros where I have to select data in first column from range 0 to 300 , 300 to 600, 600 to 900 and so on incrementing 300.<br>\nWhere the values of column H with respect to 0 to 300 should be sum and transfer to sheet2 and sum of values of 300 to 600 of H column transferred to sheet2 for all such cases. </p>\n\n<p>I wish to create a button in Excel macro by pressing it transfer all data summing to sheet2. The picture below describes better about my case.</p>\n\n<p><a href=\"https://i.stack.imgur.com/24JFv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/24JFv.png\" alt=\"Picture of my problem case\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1504689400, "post_id": 46070408, "comment_id": 79103129, "body": "Excel workbooks only store data to 17 digits of precision, and only display 15 digits. The only way to read the additional 2 is to read the XML of the file (assuming an XML format workbook)."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1504692562, "post_id": 46070408, "comment_id": 79105457, "body": "To put that in perspective, 15 digits is enough to express the distance from earth to the sun measured in the thickness of human hairs. 30 digits precision would allow you to measure the distance to Proxima Centauri in hydrogen atoms. You can&#39;t even express money with that kind of accuracy - during the few nanoseconds it takes to process such an amount, sufficient interest accumulates to change the result !"}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 5128729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/578a9ae305935ad7709ad80f97172ade?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5128729/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1505432928, "creation_date": 1505432928, "answer_id": 46229731, "question_id": 46070408, "link": "https://stackoverflow.com/questions/46070408/is-there-a-way-to-get-the-stored-value-of-a-truncated-number-in-excel/46229731#46229731", "title": "Is there a way to get the stored value of a truncated number in Excel", "body": "<p>Can you save the file in a different format?  For example:  If the data were saved in CSV format then there are data types which would allow for the precision that you need...</p>\n"}], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1505432928, "creation_date": 1504686778, "question_id": 46070408, "link": "https://stackoverflow.com/questions/46070408/is-there-a-way-to-get-the-stored-value-of-a-truncated-number-in-excel", "title": "Is there a way to get the stored value of a truncated number in Excel", "body": "<p>I am having trouble with an ADO connection to an Excel workbook.</p>\n\n<p>The data in the workbook, is entered from another system to around 28-30dp.  The data is taken to a Decimal field in Access which is (28,27) which is accepted as precision.  </p>\n\n<p>However when I transfer from </p>\n\n<p><code>Select * into</code> or a line by line <code>insert into</code> I only get the displayed truncated value through each way.</p>\n\n<p>I have tried this also using a column in Excel, where the value = <code>=1/3</code> and I get the same result, like <code>0.3333333333333330000000000000</code></p>\n\n<p>Is there a way to get the stored value, not the truncated value.  </p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1504686574, "post_id": 46070294, "comment_id": 79101171, "body": "Ctrl + C and then Ctrl + V"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504686697, "post_id": 46070294, "comment_id": 79101247, "body": "@Luuklag that&#39;s not what I would call <i>automate</i>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1504686809, "post_id": 46070294, "comment_id": 79101300, "body": "@Nurzhan Welcome to Stack Overflow. Please notice, that this is not a free coding service. Therefore please show the code you already have and tell us where you got stuck and if you got any error messages. There are many tutorials out there (1) how to <i><a href=\"https://stackoverflow.com/questions/32908099/copy-data-from-one-sheet-to-another\">copy from one sheet to another</a></i> and (2) how to <i><a href=\"https://stackoverflow.com/questions/16882143/find-out-the-last-used-column-in-a-given-row-excel-vba\">find the last used column</a></i>  which give you a decent idea how to start your own code."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1504686816, "post_id": 46070294, "comment_id": 79101304, "body": "What code have you tried?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1504715656, "post_id": 46070294, "comment_id": 79122074, "body": "Please read: <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 9, "user_id": 8567230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dix6iQEHZ1Y/AAAAAAAAAAI/AAAAAAAAAb4/d6z2o6A4imo/photo.jpg?sz=128", "display_name": "Nurzhan", "link": "https://stackoverflow.com/users/8567230/nurzhan"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504777150, "post_id": 46070294, "comment_id": 79147503, "body": "@Luuklag thanks, man! you&#39;re so smart! Thanks guys, these are my 1st steps in VBA, actually long time ago started but gave up for a while. But now realized how important VBA is for engineers. Which book you can recommend for beginners? I&#39;m interested more in VBA. Because I still cannot fill logics behind VBA in some cases."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8567230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dix6iQEHZ1Y/AAAAAAAAAAI/AAAAAAAAAb4/d6z2o6A4imo/photo.jpg?sz=128", "display_name": "Nurzhan", "link": "https://stackoverflow.com/users/8567230/nurzhan"}, "edited": false, "score": 0, "creation_date": 1504786804, "post_id": 46073020, "comment_id": 79153971, "body": "Alexey, seems this is what I want, thanks! However 1 more problem appeared. When a new sheet is created with copied data all the data is in date format. How can I fix it to make the format general?"}], "tags": [], "owner": {"reputation": 119, "user_id": 8418961, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IDpqT67sr_U/AAAAAAAAAAI/AAAAAAAACV8/-QMYyG68EMI/photo.jpg?sz=128", "display_name": "ru13r", "link": "https://stackoverflow.com/users/8418961/ru13r"}, "is_accepted": false, "score": 0, "last_activity_date": 1504694504, "last_edit_date": 1504694504, "creation_date": 1504694077, "answer_id": 46073020, "question_id": 46070294, "link": "https://stackoverflow.com/questions/46070294/how-to-automate-copying-a-specific-range-of-cells-from-30-sheets-into-1-sheet/46073020#46073020", "title": "How to automate copying a specific range of cells from 30 sheets into 1 sheet.", "body": "<p>This is a general code for copying ranges:</p>\n\n<pre><code>Sub Copy_ranges()\n\n   Dim NS As Worksheet\n\n   Application.ScreenUpdating = False\n   Application.EnableEvents = False\n\n   Set NS = Sheets.Add\n\n   i = 1\n   refRange = \"A1:D10\"\n\n   For Each sht In Worksheets\n      If (sht.Name &lt;&gt; NS.Name) Then\n         Set SheetRange = sht.Range(Right(refRange, Len(refRange) - InStr(refRange, \"!\")))\n         SheetRange.Copy\n         NS.Cells(i, 1).Value = sht.Name\n         NS.Cells(i, 2).PasteSpecial xlPasteValues\n         i = i + SheetRange.Rows.Count\n      End If\n   Next sht\n   Application.ScreenUpdating = True\n   Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>You may modify refRange to your range and the paste cycle to suit your needs:</p>\n\n<pre><code>Sub Copy_ranges()\n\n    Dim NS As Worksheet\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Set NS = Sheets.Add\n\n    i = 1\n    refRange = \"A1:A10\"\n\n    For Each sht In Worksheets\n        If (sht.Name &lt;&gt; NS.Name) Then\n          Set SheetRange = sht.Range(Right(refRange, Len(refRange) - InStr(refRange, \"!\")))\n          SheetRange.Copy\n          NS.Cells(1, i).Value = sht.Name\n          NS.Cells(2, i).PasteSpecial xlPasteValues\n          i = i + SheetRange.Columns.Count\n        End If\n    Next sht\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1504784616, "creation_date": 1504784616, "answer_id": 46095496, "question_id": 46070294, "link": "https://stackoverflow.com/questions/46070294/how-to-automate-copying-a-specific-range-of-cells-from-30-sheets-into-1-sheet/46095496#46095496", "title": "How to automate copying a specific range of cells from 30 sheets into 1 sheet.", "body": "<p>Download and install this AddIn.</p>\n\n<p><a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n\n<p>That will do the work for you, as well as many other variations of what you are doing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7r2Ht.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7r2Ht.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 8567230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dix6iQEHZ1Y/AAAAAAAAAAI/AAAAAAAAAb4/d6z2o6A4imo/photo.jpg?sz=128", "display_name": "Nurzhan", "link": "https://stackoverflow.com/users/8567230/nurzhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504784616, "creation_date": 1504686433, "last_edit_date": 1531164843, "question_id": 46070294, "link": "https://stackoverflow.com/questions/46070294/how-to-automate-copying-a-specific-range-of-cells-from-30-sheets-into-1-sheet", "title": "How to automate copying a specific range of cells from 30 sheets into 1 sheet.", "body": "<p>I have 30 sheets for each day of the month. In each of them there are same columns with different data, say in the range A1:A30. So my task is to copy this range from all the sheets and past in one master sheet in different adjacent columns, ex. A1:A30, B1:B30, C1:C30 an so on.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1504686662, "post_id": 46070270, "comment_id": 79101220, "body": "What code do you already have? Add it to your post"}, {"owner": {"reputation": 639, "user_id": 8547656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vMrWS.jpg?s=128&g=1", "display_name": "Moher", "link": "https://stackoverflow.com/users/8547656/moher"}, "edited": false, "score": 0, "creation_date": 1504686683, "post_id": 46070270, "comment_id": 79101233, "body": "what is the problem of the excel filtering?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1504701185, "post_id": 46070270, "comment_id": 79111597, "body": "You could use Userforms to add a Combobox that adds the Desc column without duplicates and then use the desc selected to Search with a Dictionary Object or .Find, or just filter"}], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1504725879, "creation_date": 1504725879, "answer_id": 46082904, "question_id": 46070270, "link": "https://stackoverflow.com/questions/46070270/search-a-table-with-multiple-criteria-vbaexcel/46082904#46082904", "title": "Search a table with multiple criteria - VBA(Excel)", "body": "<p>@Ashwin, Here's little routine I use for searching on a partial name in a list of over 11,000 records, then I can autofilter on a category to narrow the list down. The results are posted to another sheet in the workbook, as I need to see all 36 columns in the results. If you require additional autofilters, then just add onto the end. I just use 2 inputboxes for the search because it has to be quick and on the fly. You should be able to modify any of the code to fit your needs. Hope this helps.</p>\n\n<pre><code>Public Sub SearchForItem()\n  'SEARCH FOR SOMETHING AND OPTION TO SORT BY SOMETHING ELSE\nDim lngLastRow As Long\nDim lngRow As Long\nDim strValue As String\nDim lngRowOutput As Long\nDim result As String\nDim quest1 As String\n\n\nresult = InputBox(prompt:=\"What ?\", Title:=\"First Search Item\")\n   If result = vbNullString Then\n       Exit Sub\n   Else\n' where does the data end in Sheet1\n   lngLastRow = Sheet2.UsedRange.Rows.Count\n\n   If lngLastRow = 1 Then Exit Sub ' no data\n\n' Clear down sheet2, assume we have column headings in row 1 we want to keep\n   Sheet7.Range(\"6:1048576\").Clear\n\nlngRowOutput = 6 ' where are we going to write the values to in Sheet7 \n\nFor lngRow = 6 To lngLastRow\n    strValue = Sheet2.Cells(lngRow, 2).Value ' get value from column B\n\n    If InStr(1, strValue, result, vbTextCompare) &gt; 0 Then ' can we find \"First Search Item\" in the text\n        Sheet2.Rows(lngRow).Copy\n        Sheet7.Rows(lngRowOutput).PasteSpecial\n        lngRowOutput = lngRowOutput + 1\n    End If\n\nNext lngRow\n\nEnd If\n\n   'Go to the results and decide whether to AutoFilter or not\n    Sheets(\"SResults\").Select\nquest1 = MsgBox(\"Do you want to select a category ?\", vbYesNo)\n  If quest1 = vbNo Then\n  Exit Sub\n  Else\n ActiveSheet.Range(\"$A$5:$AG$106\").AutoFilter Field:=3, Criteria1:=\"=*\" &amp; InputBox(\"Operator to search for?\") &amp; \"*\"\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3271206, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/119e88d7f30a8af5481eb2db96fccb49?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/3271206/ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1581, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504725879, "creation_date": 1504686334, "last_edit_date": 1531164843, "question_id": 46070270, "link": "https://stackoverflow.com/questions/46070270/search-a-table-with-multiple-criteria-vbaexcel", "title": "Search a table with multiple criteria - VBA(Excel)", "body": "<p>I have been trying to built a search utility based on multiple criteria. My current code helps me do the search based on only one criteria.</p>\n\n<p>I am looking to search based on Desc, Category (partial or full search), Price (e.g. >10, &lt;50 i.e with any of the operators)</p>\n\n<p>The below is an example data I am trying to search, I have also included the expected result scenarios too:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vzSIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vzSIa.png\" alt=\"Sample output\"></a></p>\n\n<p>Complete Data<br>\nSearch              </p>\n\n<pre><code>SKU Desc    Category    Price\n1   Pen UTL 5\n2   Pie1    FOOD    15\n3   Pie2    FOOD    17\n4   Pie3    FOOD    25\n5   Pie4    FOOD    30\n6   Paper1  UTL 4\n7   Paper2  UTL 4.5\n8   Paper3  UTL 10\n9   Paper4  UTL 12\n10  Paper5  UTL 14\n11  Calculator1 UTL 50\n12  Calculator2 UTL 70\n13  Calculator3 UTL 90\n</code></pre>\n\n<p>Someone's help will be much appreciated here. My actual data will span up to 20K records.</p>\n\n<p>The below is the current code: here I have the data to be searched in A4:D17 and the results are displayed at H:K</p>\n\n<pre><code>Option Explicit\n\nSub finddata()\n\nDim Catagoryname As String Dim finalrow As Integer Dim i As Integer 'row counter\n\nSheets(\"Data\").Range(\"H5:k17\").ClearContents Catagoryname = Sheets(\"Data\").Range(\"J2\").Value finalrow = WorksheetFunction.CountA(Range(\"A:A\"))\n\nFor i = 5 To finalrow\n    If Cells(i, 3) = Catagoryname Then\n        Range(Cells(i, 1), Cells(i, 12)).Copy\n        Range(\"H100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n    End If Next i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0crrY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0crrY.png\" alt=\"Data\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1504683979, "post_id": 46069338, "comment_id": 79099627, "body": "You&#39;ll need to loop through the cells, read each cell, work out the length of the cell string, subtract 3 and use that as the input to get the n leftmost characters, then write into the target range."}], "answers": [{"comments": [{"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "reply_to_user": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504783782, "post_id": 46069566, "comment_id": 79152041, "body": "@Hermes, in lieu of your instruction <code>inputWS1.Range(&quot;A4:A&quot; &amp; lastRow).Copy outputWS.Range(&quot;B2&quot;)</code>"}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504827394, "post_id": 46069566, "comment_id": 79176093, "body": "the line inputWS1.Range(&quot;A4:A&quot; &amp; lastRow).Copy outputWS.Range(&quot;B2&quot;) is working fine for me"}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504827456, "post_id": 46069566, "comment_id": 79176116, "body": "the actual cells im trying to go from are inputWS3.Range(&quot;D2:D&quot;)  to inputWS3.Range(&quot;M2:M&quot;)"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "reply_to_user": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504854398, "post_id": 46069566, "comment_id": 79183523, "body": "I have modified the code.Put it after the instruction that copies the data to the column M of inputWS3"}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1505281015, "post_id": 46069566, "comment_id": 79341345, "body": "It Worked! Thanks"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": true, "score": 3, "last_activity_date": 1504854335, "last_edit_date": 1504854335, "creation_date": 1504684013, "answer_id": 46069566, "question_id": 46069338, "link": "https://stackoverflow.com/questions/46069338/removing-last-characters-vba/46069566#46069566", "title": "Removing last characters vba", "body": "<p>use the left function</p>\n\n<pre><code>With inputWS3\n    For i = 2 To lastrow\n        .Cells(i, \"M\") = Left(.Cells(i, \"M\").Value, Len(.Cells(i, \"M\").Value) - 3)\n    Next i\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504761974, "post_id": 46069876, "comment_id": 79138506, "body": "it gives me a error. im not sure if i understood your comments properly on the code. it tells me to debug on the set rng ="}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504786152, "post_id": 46069876, "comment_id": 79153585, "body": "@HermesOmarGomez The code works fine as it is above. I can&#39;t help you implement it into your code because you haven&#39;t shown us your code.."}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504808545, "post_id": 46069876, "comment_id": 79168446, "body": "I just edited the post and added my current code. i first tried your code as it is and had no luck. tried some more changes and no luck. Your help is appreciated."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 3, "last_activity_date": 1504685082, "creation_date": 1504685082, "answer_id": 46069876, "question_id": 46069338, "link": "https://stackoverflow.com/questions/46069338/removing-last-characters-vba/46069876#46069876", "title": "Removing last characters vba", "body": "<p>As h2so4 pointed out <code>Left</code> and <code>Len</code> are a good way to go. However, in terms of implementing something like this, it can be quite important to loop through an <em>array</em> rather than the range. It will be much quicker if you've got lots of data.</p>\n\n<pre><code>Sub Test()\n    Dim rng As Range\n    Dim arr As Variant\n    Dim i As Long\n\n    Set rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A1000\") 'your input range\n    arr = Application.Transpose(rng) 'fill variant array with values from range\n\n    For i = 1 To UBound(arr)\n        arr(i) = Left(arr(i), Len(arr(i)) - 3) 'loop through array removing last three chars\n    Next i\n\n    rng.Value = Application.Transpose(arr) 'return array to the worksheet in one go\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3832, "favorite_count": 0, "accepted_answer_id": 46069566, "answer_count": 2, "score": 0, "last_activity_date": 1504854335, "creation_date": 1504683197, "last_edit_date": 1504808505, "question_id": 46069338, "link": "https://stackoverflow.com/questions/46069338/removing-last-characters-vba", "title": "Removing last characters vba", "body": "<p>I have a column that has a set of Numbers on each cell.</p>\n\n<p>Im simply looking to copy the data on the column til the last row leaving behind the last 3 digits on each cell.</p>\n\n<p>I have a variable for the last row: <em>LASTROW</em> and a range already set. </p>\n\n<p>My code kinda looks like this</p>\n\n<pre><code>inputWS1.Range(\"A4:A\" &amp; lastRow).Copy outputWS.Range(\"B2\")\n</code></pre>\n\n<p>As i said, im looking to copy data from A4 to B2 and on, but i want to remove the last 3 characters on A4 when they move to B2 on the other sheet. </p>\n\n<p>Please Help and thanks for all your help!</p>\n\n<p>edit: my current code is :</p>\n\n<pre><code>Private Sub Update_Click()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim path As String, fileName As String\nDim lastRowUniversal As Long, lastRowOutput As Long, rowCntr As Long, lastColumn As Long\nDim inputWS1 As Worksheet, inputWS2 As Worksheet, inputWS3 As Worksheet, outputWS As Worksheet\nDim rng As Range\nDim arr As Variant\nDim i As Long\nConst dtFORM As String = \"=IF(ISNUMBER(J4:J&lt;r&gt;),DATE(YEAR(J4:J&lt;r&gt;)-1,\" &amp; \"MONTH(J4:J&lt;r&gt;),DAY(J4:J&lt;r&gt;)),J4:J&lt;r&gt;)\"\n\n\n\n'set your sheets here\nSet inputWS1 = ThisWorkbook.Sheets(\"Universal\")\nSet inputWS2 = ThisWorkbook.Sheets(\"Geovera\")\nSet inputWS3 = ThisWorkbook.Sheets(\"Citizens\")\nSet outputWS = ThisWorkbook.Sheets(\"Carriers\")\nSet rng = inputWS3.Range(\"D2:D\")\narr = inputWS3.Range(\"M2:M\" &amp; LastRowCitizens)\n\n    'get last rows from both sheets\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowCitizens = inputWS3.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowGeovera = inputWS2.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row\nlastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    'get last rows from both sheets\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowCitizens = inputWS3.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowGeovera = inputWS2.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row\nlastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\nrowCntr = 1\n\nFor i = 1 To UBound(arr)\narr(i) = Left(arr(i), Len(arr(i)) - 3)\nNext i\n\n\n'get last rows from both sheets\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowCitizens = inputWS3.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowGeovera = inputWS2.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row\nlastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Universal\ninputWS1.Range(\"A4:A\" &amp; lastRowUniversal).Copy outputWS.Range(\"B2\")\ninputWS1.Range(\"B4:B\" &amp; lastRowUniversal).Copy outputWS.Range(\"C2\")\ninputWS1.Range(\"N4:N\" &amp; lastRowUniversal).Value = inputWS1.Name\ninputWS1.Range(\"N4:N\" &amp; lastRowUniversal).Copy outputWS.Range(\"E2\")\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Value = inputWS1.Evaluate(Replace(dtFORM, \"&lt;r&gt;\", lastRowUniversal))\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Copy outputWS.Range(\"G2\")\ninputWS1.Range(\"G4:G\" &amp; lastRowUniversal).Copy outputWS.Range(\"H2\")\n\n'Geovera\ninputWS2.Range(\"F2:F\" &amp; lastRowGeovera).Copy outputWS.Range(\"B\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"I2:I\" &amp; lastRowGeovera).Copy outputWS.Range(\"C\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"P2:P\" &amp; lastRowGeovera).Value = inputWS2.Name\ninputWS2.Range(\"P2:P\" &amp; lastRowGeovera).Copy outputWS.Range(\"E\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"N2:N\" &amp; lastRowGeovera).Copy outputWS.Range(\"H\" &amp; lastRowUniversal - 1)\ninputWS2.Range(\"G2:G\" &amp; lastRowGeovera).Copy outputWS.Range(\"G\" &amp; lastRowUniversal - 1)\n\n'Citizens\ninputWS3.Range(\"M2:M\" &amp; LastRowCitizens).Value = arr\n\n\n\n\n\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpivot", "powerquery"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504683304, "post_id": 46069305, "comment_id": 79099237, "body": "Just check if it is a valid workbook. Plenty of info about that around here. You could even open the sheet and check if it has the right columns for example."}, {"owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504700379, "post_id": 46069305, "comment_id": 79110938, "body": "@Luuklag - fully appreciate that&#39;s possible (that is in fact the workaround I am using) but if I can find an answer with the .Refresh method the code will be easier to maintain, as I won&#39;t need to update it if any new queries are added, which is very likely to happen."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504706686, "post_id": 46069305, "comment_id": 79115854, "body": "Perhaps there is an event handler for this kind of error message?"}, {"owner": {"reputation": 3484, "user_id": 3851129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86d2fd71d5f3554f387797b7db37b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Lopez-Lago - MSFT", "link": "https://stackoverflow.com/users/3851129/alejandro-lopez-lago-msft"}, "edited": false, "score": 0, "creation_date": 1504722058, "post_id": 46069305, "comment_id": 79125659, "body": "What is the error message in the dialog box that appears? This would be a bug in Power Query."}, {"owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "edited": false, "score": 1, "creation_date": 1504768687, "post_id": 46069305, "comment_id": 79141914, "body": "An example of the error in the dialog box is: [Expression.Error] The key didn&#39;t match any rows in the table.  But the error is correct - if the newly selected workbook does not contain the correct data structure/tables then it will of course error. But I can&#39;t capture the error in VBA which is the problem."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9678274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12b1139dbf42de73188580e5e49dba7?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Wein", "link": "https://stackoverflow.com/users/9678274/richard-wein"}, "is_accepted": false, "score": 1, "last_activity_date": 1524308241, "creation_date": 1524308241, "answer_id": 49955047, "question_id": 46069305, "link": "https://stackoverflow.com/questions/46069305/unable-to-capture-errors-in-vba-when-refreshing-a-query-from-powerquery/49955047#49955047", "title": "Unable to capture errors in VBA when refreshing a query from PowerQuery", "body": "<p>Two options:</p>\n\n<ol>\n<li><p>Check for the error in your Power Query M code. If you detect an error, output a different data table, perhaps a 1x1 table containing just an error code. When this error occurs, the PQ refresh completes successfully (as far as PQ is concerned), the user gets no error message, and your VBA code can check whether PQ produced the error table.</p></li>\n<li><p>Use an AfterRefresh event for the QueryTable, as described here:\n<a href=\"https://stackoverflow.com/questions/43548543/how-to-check-whether-connection-refresh-was-successful\">How to check whether Connection Refresh was successful</a></p></li>\n</ol>\n\n<p>I've used #1 in the past. I've just discovered #2 and tried it. It works for me, but it doesn't prevent the PQ error message.</p>\n"}], "owner": {"reputation": 313, "user_id": 2333402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d33488407f4aea5362eaac866fdab3a?s=128&d=identicon&r=PG", "display_name": "Jaspos", "link": "https://stackoverflow.com/users/2333402/jaspos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1524308241, "creation_date": 1504683083, "question_id": 46069305, "link": "https://stackoverflow.com/questions/46069305/unable-to-capture-errors-in-vba-when-refreshing-a-query-from-powerquery", "title": "Unable to capture errors in VBA when refreshing a query from PowerQuery", "body": "<p>I have a workbook with several PowerQuery queries to other workbooks.</p>\n\n<p>This workbook is updated annually at each FY - meaning the queries need to point to new workbooks every year. This can of course be done manually, but there are a lot of queries and the average user does not know how (and also, much of the PowerQuery functionality is intentionally hidden from the user).</p>\n\n<p>So I have written some code to allow the user to select a new workbook to point to, and then this code updates the PQ formula with the new source workbook. This all works fine.</p>\n\n<p>The problem is, I need to ensure the user has selected a valid workbook so that the queries still work. My plan was to simply update the formula with the new workbook name, and then run a Refresh, and capture any errors (if the refresh works fine then my assumption is the workbook selected is a valid one).</p>\n\n<p>But here's the problem. When I use the .Refresh method in VBA, no error is reported. There IS a user dialog reporting an error, but nothing is captured by VBA - the code continues running as if all was OK, and no error number is raised.</p>\n\n<p>And moreover, the dialog does not react to Application.DisplayAlerts = False. It still shows, then the VBA code continues as if nothing has happened.</p>\n\n<p>So does anyone know if there is any way I can capture this error? FYI the code I am using for the reresh is as follows (simplified):</p>\n\n<pre><code>Application.DisplayAlerts = False ' This does not stop the user dialog!\nDim conn as WorkbookConnection\n\nSet conn = ThisWorkbook.Connections(\"MyQueryName\")\nconn.Refresh 'No error raised here, even if the Refresh fails\n(there is however a user error dialog)\n</code></pre>\n\n<p>(NB the issue is the same if I use conn.OLEDBConnection.Refresh)</p>\n\n<p>FYI according the MS documentation, I SHOULD be able to stop the dialog boxes, but it is not working for me (see <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/workbookconnection-refresh-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/VBA/Excel-VBA/articles/workbookconnection-refresh-method-excel</a>)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 3, "creation_date": 1504682152, "post_id": 46068860, "comment_id": 79098500, "body": "Copy and paste as values"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504682254, "post_id": 46068860, "comment_id": 79098565, "body": "Was hoping for some function or other method instead of the &quot;manual&quot; way. I hope that was not too complicated to understand"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 3, "creation_date": 1504682790, "post_id": 46068860, "comment_id": 79098916, "body": "If you want a VBA solution show us what code you already have and where that needs improving. We are not a free code writing service."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504682902, "post_id": 46068860, "comment_id": 79098980, "body": "Couldn&#39;t find anything in google was hoping to get some leads here. I don&#39;t know the VBA language and I am not sure if it is possible. I do not need free code I just need &quot;expert&quot; guidance on how to approach it"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1504682991, "post_id": 46068860, "comment_id": 79099029, "body": "this can be achieved easily, the only problem is &quot;after a certain time&quot;, you will need to trace changes and save some kind of timestamp somewhere"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 3, "creation_date": 1504683063, "post_id": 46068860, "comment_id": 79099077, "body": "start from recording a macro with copying -&gt; pasting as values and try to modify the code"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1504683072, "post_id": 46068860, "comment_id": 79099087, "body": "Yeah I believe the &quot;after a certain time&quot; portion is simple. It&#39;s the function that will run after that condition is met is what i&#39;m troubled about. I&#39;ll see what I can do from macros thanks"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504683186, "post_id": 46068860, "comment_id": 79099163, "body": "Copy and paste special is something vba does just fine"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1504683274, "post_id": 46068860, "comment_id": 79099225, "body": "Then I can start learning on VBA as well. Thanks"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1504698715, "post_id": 46068860, "comment_id": 79109682, "body": "As mentioned used &quot;After a certain time&quot;, or as I prefer to call it &quot;Effective Date&quot;.  It will be one extra column in in your table of employee salary information.  One you have that you can add another search condition to your formula which will vary depending on how its set up.  in match and Vlookup you want to look at that last option argument that you can set to 1 or 0 (or -1) depending on the function used.  You do not want an exact match on effective date, but rather and after a date, or before date.   Again all depends on how you have things set up and how your are doing your search."}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1504779781, "post_id": 46072179, "comment_id": 79149350, "body": "Thank you will try this out"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1504691727, "creation_date": 1504691727, "answer_id": 46072179, "question_id": 46068860, "link": "https://stackoverflow.com/questions/46068860/ms-excel-how-do-i-replace-cells-with-formulas-to-its-calculated-value-automati/46072179#46072179", "title": "(MS EXCEL) How do I replace cells with formulas to its calculated value AUTOMATICALLY?", "body": "<p>No! Not copying and pasting, there's a simpler way. You want to convert the Formula property of a given cell (what's shown in the formula bar in Excel) into the Value property of the cell (what's shown in the cell on the spreadsheet). For a given range A1:B6 this would done by the statement</p>\n\n<pre><code> Range(\"A1:B6\").formula = Range(\"A1:B6\").value\n</code></pre>\n\n<p>But there's a quirk in Excel that you can run faster by accessing a Value2 property, so </p>\n\n<pre><code> Range(\"A1:B6\").formula = Range(\"A1:B6\").value2\n</code></pre>\n\n<p>The rest of the code is left as an exercise for the reader :-)</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1504691727, "creation_date": 1504681535, "last_edit_date": 1531161705, "question_id": 46068860, "link": "https://stackoverflow.com/questions/46068860/ms-excel-how-do-i-replace-cells-with-formulas-to-its-calculated-value-automati", "title": "(MS EXCEL) How do I replace cells with formulas to its calculated value AUTOMATICALLY?", "body": "<p>I am making a payroll program in Excel and one of my concerns is that the salaries of the employees are searched using the INDEX and MATCH or VLOOKUP function. The problem is if the salaries get updated in the future (e.g. a raise or changes in rates), all the previous entries that used the old salaries will be updated to the new salaries. This is a disaster and would make my entire program useless and inefficient. Therefore I need to automatically lock previous calculated cells after a certain time.</p>\n\n<p>Edit: Note we do not want to do this manually such as copy pasting values only because almost all cells are connected to each other and one mistake by the encoder or if they forget to do this before updating a value, everything will be messed up.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504677555, "post_id": 46067499, "comment_id": 79095910, "body": "i have the Application.ScreenUpdating set on it as well"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504682873, "post_id": 46067944, "comment_id": 79098963, "body": "This one worked great for me as i am using the worksheet form! Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1504678086, "creation_date": 1504678086, "answer_id": 46067944, "question_id": 46067499, "link": "https://stackoverflow.com/questions/46067499/substract-a-year-from-date-values-on-a-new-column/46067944#46067944", "title": "Substract a year from date values on a new column", "body": "<p>There are two forms of Evaluate:</p>\n\n<ul>\n<li>Application (default) - uses the scope of the <code>ActiveSheet</code>: that may not be the sheet you expect/want.</li>\n<li>Worksheet (needs to be qualified with a worksheet object) - operates using the scope of the qualifying worksheet</li>\n</ul>\n\n<p>You should use the worksheet form or you may get unexpected results.</p>\n\n<p>This worked for me:</p>\n\n<pre><code>Sub Tester()\n\n    Const dtFORM As String = \"=IF(ISNUMBER(J4:J&lt;r&gt;),DATE(YEAR(J4:J&lt;r&gt;)-1,\" &amp; _\n                             \"MONTH(J4:J&lt;r&gt;),DAY(J4:J&lt;r&gt;)),J4:J&lt;r&gt;)\"\n\n    Dim inputWS1 As Worksheet, lastRowUniversal\n\n    Set inputWS1 = ThisWorkbook.Sheets(\"Universal\")\n\n    lastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    '### use the *worksheet* form of Evaluate ###\n    inputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Value = _\n                 inputWS1.Evaluate(Replace(dtFORM, \"&lt;r&gt;\", lastRowUniversal))\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1504678708, "post_id": 46067972, "comment_id": 79096466, "body": "It works as long as the worksheet &quot;Universal&quot; is the active sheet."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1504679925, "post_id": 46067972, "comment_id": 79097127, "body": "That&#39;s true since the formula used is not qualified with the sheet reference."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1504678218, "creation_date": 1504678218, "answer_id": 46067972, "question_id": 46067499, "link": "https://stackoverflow.com/questions/46067499/substract-a-year-from-date-values-on-a-new-column/46067972#46067972", "title": "Substract a year from date values on a new column", "body": "<p>It works as expected.</p>\n\n<p>You get 1/0/1900 because the corresponding cell in column J might be blank.\nTry it like this...</p>\n\n<pre><code>Dim lastRowUniversal As Long\nDim inputWS1 As Worksheet\nSet inputWS1 = ThisWorkbook.Sheets(\"Universal\")\n\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Value = Evaluate(\"=IF(ISNUMBER(J4:J\" &amp; lastRowUniversal &amp; \"),DATE(YEAR(J4:J\" &amp; lastRowUniversal &amp; \")-1,MONTH(J4:J\" &amp; lastRowUniversal &amp; \"),DAY(J4:J\" &amp; lastRowUniversal &amp; \")),J4:J\" &amp; lastRowUniversal &amp; \")\")\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).NumberFormat = \"mm/dd/yyyy;;\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 46067944, "answer_count": 2, "score": 1, "last_activity_date": 1504678218, "creation_date": 1504676087, "question_id": 46067499, "link": "https://stackoverflow.com/questions/46067499/substract-a-year-from-date-values-on-a-new-column", "title": "Substract a year from date values on a new column", "body": "<p>I am running a macro to take date values from cell J4 to the last row with value on the column and place new values on L4:L with a year substracted from the value on column J of the same row.</p>\n\n<p>The code for this step that i have is:</p>\n\n<pre><code>Private Sub Update_Click() \nDim inputWS1 As Worksheet\nSet inputWS1 = ThisWorkbook.Sheets(\"Universal\")\n\nlastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row \n\ninputWS1.Range(\"L4:L\" &amp; lastRowUniversal).Value = Evaluate(\"=IF(ISNUMBER(J4:J\" &amp; lastRowUniversal &amp; \"),DATE(YEAR(J4:J\" &amp; lastRowUniversal &amp; \")-1,MONTH(J4:J\" &amp; lastRowUniversal &amp; \"),DAY(J4:J\" &amp; lastRowUniversal &amp; \")),J4:J\" &amp; lastRowUniversal &amp; \")\")\n</code></pre>\n\n<p>`</p>\n\n<p>The macro goes thru however values on L4:L show \"1/0/1900\". So i know the <em>lastrow</em> variable is working, because it only runs til the last row where J4 ends.</p>\n\n<p>Can you guys help me correct this so if value on J4 is 02/01/2017 it shows 02/01/2016 on L4?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 0, "creation_date": 1504672126, "post_id": 46066696, "comment_id": 79094123, "body": "I&#39;d like to test this out. Before I get started, I&#39;m guessing you&#39;ve ruled out stuff like formatting inconsistencies (although if you leave the second argument in SpecialCells blank it should pick all cells irrespective of formatting) and anything about the ranges being dis-contiguous?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1504672266, "post_id": 46066696, "comment_id": 79094153, "body": "And have you checked that you actually have both constants and formulas within that range (i.e. it isn&#39;t all constants or all formulas)?"}, {"owner": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 0, "creation_date": 1504672342, "post_id": 46066696, "comment_id": 79094161, "body": "Also as another thought: I don&#39;t know if you&#39;d get an error if you had more than 30 discontinuous regions as arguments in Union: <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/application-union-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/VBA/Excel-VBA/articles/applicatio&zwnj;&#8203;n-union-method-excel</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504672352, "post_id": 46066696, "comment_id": 79094165, "body": "P.S. I would certainly be changing <code>Range(&quot;A1:M14&quot;)</code> to be <code>Sheets(&quot;Uploading Checklist (M)&quot;).Range(&quot;A1:M14&quot;)</code> to avoid one potential source of problems."}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1504672356, "post_id": 46066696, "comment_id": 79094166, "body": "Is the button in the sheet &quot;<code>Uploading Checklist (M)</code>&quot;?"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "reply_to_user": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 0, "creation_date": 1504672530, "post_id": 46066696, "comment_id": 79094204, "body": "@neophlegm he is giving only two arguments to the function no?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 345, "user_id": 2249155, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/4jbea.png?s=128&g=1", "display_name": "neophlegm", "link": "https://stackoverflow.com/users/2249155/neophlegm"}, "edited": false, "score": 2, "creation_date": 1504672536, "post_id": 46066696, "comment_id": 79094208, "body": "@neophlegm The 30 in that documentation would refer to the number of parameters, not what shape each of the parameters is (i.e. not how many Areas were in each parameter).  (Note: I just tested and could create a <code>Union</code> of 600 discrete, discontinuous, cells, just adding one at a time to the previous union within a loop.  I stopped at 600 - that wasn&#39;t a limit.)"}, {"owner": {"reputation": 2212, "user_id": 6935152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f02ebbd76d4b518363a38bbbdf8e2c7f?s=128&d=identicon&r=PG&f=1", "display_name": "kaza", "link": "https://stackoverflow.com/users/6935152/kaza"}, "edited": false, "score": 0, "creation_date": 1504672691, "post_id": 46066696, "comment_id": 79094256, "body": "If the button is in someother sheet other than <code>&quot;Uploading Checklist (M)&quot;</code> then @YouE3K &#39;s comment about using <code>Sheets(&quot;Uploading Checklist (M)&quot;).Range(&quot;A1:M14&quot;)</code> should resolve this issue."}, {"owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504681916, "post_id": 46066696, "comment_id": 79098333, "body": "Hi all. Thank you so much for the comments and suggestions. I love this site, and I love you guys. haha.  And indeed, I have tested/double checked a lot of the things you guys have pointed out.  It&#39;s actually @YowE3K that pointed out what I believe is the problem. My range is usually mostly constants, and rarely have formulas, and now I tested that every time I added a formula, it works now. (the original of this had a range where both constantly exist.) So thanks. If you wanna post that as an official answer, I could have it as officially accepted answer. :)"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "edited": false, "score": 0, "creation_date": 1504682082, "post_id": 46067408, "comment_id": 79098456, "body": "Thanks for the help. Based on the comments, I have had it fixed. This code is simple and workable, so thanks. Just wondering, would it be slow if there&#39;s a large amount of data? I know in this example, the range is tiny; but from the original one I created which works, my range is something like A1:CZ300+ thingy. Would it lag (or work faster/slower) than what I originally did? Thanks."}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1504675634, "creation_date": 1504675634, "answer_id": 46067408, "question_id": 46066696, "link": "https://stackoverflow.com/questions/46066696/excel-vba-code-to-select-all-cells-with-data-sometimes-working/46067408#46067408", "title": "Excel VBA code to select all cells with data sometimes working", "body": "<p>Maybe this is too simplistic, but it seems to do what you want. The animated .gif shows it working to \"lock all cells with data in them\". (I made the second button just for convenience).  If nothing else it might be good to start from something like this that works and modify to suit your needs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8TZI6.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8TZI6.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Dim cell As Range, sh As Worksheet\n\nSub Button4_Click()\nSet sh = Worksheets(\"Sheet1\")\nsh.Unprotect Password:=\"s\"\nFor Each cell In sh.UsedRange\n  If cell &lt;&gt; \"\" Then cell.Locked = True Else cell.Locked = False\nNext\nsh.Protect Password:=\"s\"\nEnd Sub\n\nSub Button5_Click()\nSet sh = Worksheets(\"Sheet1\")\nsh.Unprotect Password:=\"s\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1504684726, "creation_date": 1504684726, "answer_id": 46069761, "question_id": 46066696, "link": "https://stackoverflow.com/questions/46066696/excel-vba-code-to-select-all-cells-with-data-sometimes-working/46069761#46069761", "title": "Excel VBA code to select all cells with data sometimes working", "body": "<p>The <code>Union</code> you are attempting will not work if either of the parameters is <code>Nothing</code> (i.e. you either have no constants in the range, or you have no formulas in the range).</p>\n\n<p>Prior to doing the <code>Union</code>, you should check the parameters aren't <code>Nothing</code> but, once you start changing your code to do that, it would be just as simple to do the locking in two parts - so I recommend you rewrite the code as follows:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    With Sheets(\"Uploading Checklist (M)\")\n        .Unprotect Password:=\"signature\"\n        With .Range(\"A1:M14\")\n            'Lock any constants\n            If Not .SpecialCells(xlCellTypeConstants) Is Nothing Then\n                .SpecialCells(xlCellTypeConstants).Locked = True\n            End If\n            'Lock any formulas\n            If Not .SpecialCells(xlCellTypeFormulas) Is Nothing Then\n                .SpecialCells(xlCellTypeFormulas).Locked = True\n            End If\n        End With\n        .Protect Password:=\"signature\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7555213, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f389f053a619bf5ca158b2e4363be74e?s=128&d=identicon&r=PG&f=1", "display_name": "DWReyes", "link": "https://stackoverflow.com/users/7555213/dwreyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 1, "accepted_answer_id": 46069761, "answer_count": 2, "score": 1, "last_activity_date": 1504684726, "creation_date": 1504671357, "question_id": 46066696, "link": "https://stackoverflow.com/questions/46066696/excel-vba-code-to-select-all-cells-with-data-sometimes-working", "title": "Excel VBA code to select all cells with data sometimes working", "body": "<p>I once built a VBA button to automatically lock all cells with data in them. And it was working perfectly. Now I wanted to copy that button to another worksheet. So I created another button, copy and pasted the whole VBA over, then edited the worksheet names and range. And, it's only working like 5% of the time, the rest of the time, I'm getting an \"Run-Time error '1004': No cells were found.\" I've tried a few fixed, changing Sheets to Worksheets, or adding a \", 23\" to the specialcells argument. However, nothing is working right now. When I try stepping in, it sometimes say both rng and lckrng as empty, and sometimes only show lockrng as empty and not show rng at all. Problem is this used to be a working code, and now, it still works around 5% of time. Any idea why? Thank you very much!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim rng As Range\nDim lockrng As Range\n\nSheets(\"Uploading Checklist (M)\").Unprotect Password:=\"signature\"\nSet rng = Range(\"A1:M14\")\n\n'Selecting hardcoded data and formulas\n  Set lockrng = Union(rng.SpecialCells(xlCellTypeConstants), rng.SpecialCells(xlCellTypeFormulas))\n\nlockrng.Locked = True\nSheets(\"Uploading Checklist (M)\").Protect Password:=\"signature\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "sharepoint", "ado"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8566482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eada7b69580b0e2b4a93d4e98fb6ce9?s=128&d=identicon&r=PG", "display_name": "user8566482", "link": "https://stackoverflow.com/users/8566482/user8566482"}, "edited": false, "score": 0, "creation_date": 1504751351, "post_id": 46067535, "comment_id": 79135911, "body": "Thank you shA.t,  Could you explain more detail on [ loop over rsXl records and create your commandShP and execute it ] I am getting excited there can be the answer!"}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "reply_to_user": {"reputation": 13, "user_id": 8566482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eada7b69580b0e2b4a93d4e98fb6ce9?s=128&d=identicon&r=PG", "display_name": "user8566482", "link": "https://stackoverflow.com/users/8566482/user8566482"}, "edited": false, "score": 0, "creation_date": 1504793071, "post_id": 46067535, "comment_id": 79158816, "body": "Use a sample for a [loop over a recordset like this] that you can create a SQL command like <code>insert into Schedule_DB (NAME,TYPE_W) values (&#39;name&#39;,&#39;type&#39;);</code> then execute this command using connection to SharePoint(<code>cnnShP</code>) ;)."}], "tags": [], "owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1504676978, "last_edit_date": 1504676978, "creation_date": 1504676278, "answer_id": 46067535, "question_id": 46065967, "link": "https://stackoverflow.com/questions/46065967/cant-insert-records-from-excel-to-sharepoint/46067535#46067535", "title": "Can&#39;t insert records from Excel to SharePoint", "body": "<p>When you want to read data from your Excel sheet you need to have a <code>ADODB.Connection</code> with <em>Read permission</em>, then to write data to your SharePoint List you need to have another <code>ADODB.Connection</code> with <em>Write permission</em>.</p>\n\n<blockquote>\n  <p>Note: You can't transport your whole data in that way, You can generate a big command with whole data then use it or generate command for each record of your Excel data.</p>\n</blockquote>\n\n<p>About your exception it is simply says it can't find your sheet name in SharePoint Lists.</p>\n\n<hr>\n\n<p>A sample to guide you can be something like this:</p>\n\n<pre><code>Dim cnnXl As New ADODB.Connection\nDim rsXl As New ADODB.Recordset    \nDim cnnShP As New ADODB.Connection\n\nconStrXl = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='C:\\yourExcel.xlsx';\" &amp; _\n         \"Extended Properties=\"\"Excel 12.0;HDR=YES;IMEX=1;\"\";\"\n\ncommandXl = \"SELECT [Field1], [Field2] FROM [Worksheet$$A1:D7] WHERE [Thing1] &gt; 1\"\n\nconStrShP = \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;\" &amp; _\n            \"DATABASE=yourSite;LIST={yourListCLSID};\"\n</code></pre>\n\n<p>Then open <code>cnnXl</code> and run <code>commandXl</code> and read data to <code>rsXl</code>.<br>\nThen open <code>cnnShP</code> and loop over <code>rsXl</code> records and create your <code>commandShP</code> and execute it.</p>\n"}], "owner": {"reputation": 13, "user_id": 8566482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eada7b69580b0e2b4a93d4e98fb6ce9?s=128&d=identicon&r=PG", "display_name": "user8566482", "link": "https://stackoverflow.com/users/8566482/user8566482"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 46067535, "answer_count": 1, "score": 1, "last_activity_date": 1504695070, "creation_date": 1504665663, "last_edit_date": 1504674645, "question_id": 46065967, "link": "https://stackoverflow.com/questions/46065967/cant-insert-records-from-excel-to-sharepoint", "title": "Can&#39;t insert records from Excel to SharePoint", "body": "<p>Currently I am suffering Excel ADO issue.</p>\n\n<p>Here is the thing taht\nI was trying to insert some records \nfrom \"Excel table\" to \"SharePoint list\" Using ADO connection.\nBut failed (Can't recognize Excel table in SQL Statement)</p>\n\n<pre><code>Dim SQL        As String\nDim CN         As New ADODB.Connection\nDim OLEDB      As String\nDim LIST       As String\nDim SITE       As String\n\nLIST = \"{EE028282-3D7E-4D37-93EE-50FB69C4432C}\"\nSITE = \"https://asml.sharepoint.com/teams/FFKR_DUV_YS_Installation_and_Relocation/Product\"\nOLEDB = \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;\" &amp; _\n         \"DATABASE=\" &amp; SITE &amp; \";\" &amp; _\n         \"LIST=\" &amp; LIST &amp; \";\"\n\nSet CN = New ADODB.Connection\nCN.Open OLEDB\n\n    SQL = SQL &amp; \"INSERT INTO Schedule_DB (NAME,TYPE_W) \"\n    SQL = SQL &amp; \"SELECT * \"\n    SQL = SQL &amp; \"FROM [\" &amp; ThisWorkbook.FullName &amp; \"].[S_RAW$] \"\n\n    CN.Execute CommandText:=SQL\nCN.Close\n</code></pre>\n\n<p>If I run it I got error -><br>\n<a href=\"https://i.stack.imgur.com/5euLZ.png\" rel=\"nofollow noreferrer\">Error image</a></p>\n\n<p>I have already check the miss-spell, and the amount of item is too much, so I would prefer to process it as a one SQL statement.<br>\n\"Excel to Excel\" works well But still have no ideas for \"Excel to SharePoint List\".\nPlease share your advice.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 3, "creation_date": 1504668143, "post_id": 46065939, "comment_id": 79093131, "body": "On which line of code does the error occur?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1504685857, "post_id": 46065939, "comment_id": 79100721, "body": "<code>Set ws = Worksheets(ActiveSheet.Name)</code> is the same as <code>set ws=activesheet</code>  you have no checks after your finds, you need to check <code>C</code> and <code>C2</code> being <code>nothing</code> i.e. not found.  Maybe."}, {"owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1504706270, "post_id": 46065939, "comment_id": 79115560, "body": "@Variatus, error ocurrs on <code>Private Sub textoControles_Change()</code>, on line <code>If Not IsError(Application.Match(Me.textoControles.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(2).DataBodyRang&zwnj;&#8203;e, 0)) Then</code>"}, {"owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1504706592, "post_id": 46065939, "comment_id": 79115803, "body": "@Nathan_Sav, thanks. The line <code>If Not IsError(Application.Match(Me.textoControles.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(2).DataBodyRang&zwnj;&#8203;e, 0)) Then</code> does not fulfill thath function? It should avoid set C to be nothing."}, {"owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "edited": false, "score": 0, "creation_date": 1504706790, "post_id": 46065939, "comment_id": 79115935, "body": "The strange thing is that error ocurrs only if I have the table ActiveSheet.Name with no data (empty), but, if the table ActiveSheet.Name has any data in the first column and I enter data into textoCausas no error stops the macro. To claify, column 1 is filled with <code>textoCausas</code>, and column 2 with <code>textoControles</code>"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1504775941, "creation_date": 1504775941, "answer_id": 46092552, "question_id": 46065939, "link": "https://stackoverflow.com/questions/46065939/error-5-in-text-field-change/46092552#46092552", "title": "Error 5 in text field change", "body": "<p>It's the IsError function. In VBA it tells if a variant has the value vbError. I wanted to say this yesterday but I couldn't replicate the error. It doesn't seem to result from the Match function. Perhaps, the <code>ListObject</code> doesn't exist on a blank sheet causing an error to occur which doesn't assign a value of vbError to the variant resulting from the test. So, the thing to do is to assign <code>Application.Match(Me.textoControles.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(2).DataBodyRang\u200c\u200be</code> to a temporary variable. Precede the line with <code>On Error Resume Next</code> and follow it with <code>If Err Then</code>, and your problem should go away.</p>\n"}], "owner": {"reputation": 41, "user_id": 4282278, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/659182315/picture?type=large", "display_name": "Wilson M&#233;ndez Pe&#241;alosa", "link": "https://stackoverflow.com/users/4282278/wilson-m%c3%a9ndez-pe%c3%b1alosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 46092552, "answer_count": 1, "score": 0, "last_activity_date": 1504775941, "creation_date": 1504665439, "last_edit_date": 1504679717, "question_id": 46065939, "link": "https://stackoverflow.com/questions/46065939/error-5-in-text-field-change", "title": "Error 5 in text field change", "body": "<p>I'm updating and populating a combobox named <code>textoControles</code> after updating another combobox named <code>textoCausas</code>. The first combobox <code>textoControles</code> upadtes itself with its change. </p>\n\n<p>Now, I'm getting error '5' in this scenario:</p>\n\n<p>If I have the table <code>ActiveSheet.Name</code> with no data (empty) and enter data into combobox <code>textoCausas</code>, and then enter a character (just entering any character) on <code>textoCausas</code>, then the error '5' stops the macro.</p>\n\n<p>But, if the table <code>ActiveSheet.Name</code> has any data in the first column and I enter data into <code>textoCausas</code> no error stops the macro.</p>\n\n<p>I need some help to solve this error. Thanks!</p>\n\n<pre><code>Private Sub textoCausas_AfterUpdate()\nDim ws As Worksheet, controles As Range, planes As Range, utlimafila As Double, numeroCausa As Double, C As Range\n\nSet ws = Worksheets(ActiveSheet.Name)\n\nultimafila = ws.ListObjects(ActiveSheet.Name).Range.Columns(11).Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nIf ultimafila &lt;&gt; 8 Then\n    With Me.textoControles\n        .Clear\n        If Not IsError(Application.Match(Me.textoCausas.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange, 0)) Then\n            Set C = ws.ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange.Find(textoCausas.Value, LookIn:=xlValues, lookat:=xlWhole)\n            index = C.Row\n            numeroCausa = ws.Cells(index, 11)\n            For Each controles In ws.ListObjects(ActiveSheet.Name).ListColumns(2).DataBodyRange\n                If controles.Columns(10) = numeroCausa Then\n                    If controles.Value &lt;&gt; Empty Then\n                        .AddItem controles.Value\n                        .List(.ListCount - 1, 1) = controles.Offset(0, 1).Value\n                    End If\n                End If\n            Next controles\n        End If\n    End With\n    With Me.textoPlanes\n        .Clear\n        If Not IsError(Application.Match(Me.textoCausas.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange, 0)) Then\n            Set C = ws.ListObjects(ActiveSheet.Name).ListColumns(1).DataBodyRange.Find(textoCausas.Value, LookIn:=xlValues, lookat:=xlWhole)\n            index = C.Row\n            numeroCausa = ws.Cells(index, 11)\n            For Each planes In ws.ListObjects(ActiveSheet.Name).ListColumns(6).DataBodyRange\n                If planes.Columns(6) = numeroCausa Then\n                    If planes.Value &lt;&gt; Empty Then\n                        .AddItem planes.Value\n                        .List(.ListCount - 1, 1) = planes.Offset(0, 1).Value\n                    End If\n                End If\n            Next planes\n        End If\n    End With\nEnd If\n\nMe.textoControles = Null\nMe.textoPlanes = Null\nEnd Sub\n\nPrivate Sub textoControles_Change()\n\nDim ws As Worksheet, C As Range, C2 As Range\nSet ws = Worksheets(ActiveSheet.Name)\n\nMe.textoEfectividad = Null\nMe.textoFrecuencia = Null\nMe.textoResponsable = Null\n\nIf Trim(Me.textoControles.Value &amp; vbNullString) = vbNullString Then\n    Me.textoEfectividad = Null\n    Me.textoFrecuencia = Null\n    Me.textoResponsable = Null\n    Exit Sub\nEnd If\n\n\nIf Not IsError(Application.Match(Me.textoControles.Value, ws.ListObjects(ActiveSheet.Name).ListColumns(2).DataBodyRange, 0)) Then\n    Set C = ws.ListObjects(ActiveSheet.Name).ListColumns(2).DataBodyRange.Find(textoControles.Value, LookIn:=xlValues, lookat:=xlWhole)\n    index = C.Row\n    Set C2 = ws.ListObjects(ActiveSheet.Name).ListColumns(11).DataBodyRange.Find(ws.Cells(index, 11), LookIn:=xlFormulas, lookat:=xlWhole, SearchDirection:=xlPrevious) 'xlFormulas para buscar en celdas ocultas\n    index2 = C2.Row\n    For i = index To index2\n        If ws.Cells(i, 2) = Me.textoControles Then\n            Me.textoEfectividad = ws.Cells(i, 3)\n            Me.textoFrecuencia = ws.Cells(i, 4)\n            Me.textoResponsable = ws.Cells(i, 5)\n        Exit For\n        End If\n    Next i\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504677175, "post_id": 46065836, "comment_id": 79095744, "body": "<code>ActiveSheet.Range(&quot;A3:AT&quot;).AutoFilter</code> seems like it might be a problem..."}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1504698586, "post_id": 46065836, "comment_id": 79109596, "body": "The Problem with this very basic approach is you end up opening complete source workbook, and if your source workbook is having significantly bigger size then the main problem will come when you try to copy a large range, as first it gets stored in clip board and excel might not respond after that if memory usage crosses the limit... I had similar job and I first approach was exactly the similar as yours, which didn&#39;t worked for me. so I had to do it with VBA-SQL.... and if your source data file is not that big then I think your code is very over complexed..."}, {"owner": {"reputation": 11, "user_id": 8566444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9d3b2856a11b01e175fcc79e6839c0?s=128&d=identicon&r=PG&f=1", "display_name": "EduCoell", "link": "https://stackoverflow.com/users/8566444/educoell"}, "edited": false, "score": 0, "creation_date": 1504699556, "post_id": 46065836, "comment_id": 79110254, "body": "Then how can I simplify it? I am relatively new to VBA"}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1504706153, "post_id": 46065836, "comment_id": 79115471, "body": "how does size of your source file varies? how much it is now? In my case it became unpractical to do it by simply opening the source workbook and copy pasting columns.. then I had to use VBA-SQL approach. <a href=\"https://analysistabs.com/excel-vba/ado-sql-macros-connecting-database/\" rel=\"nofollow noreferrer\">Here</a>"}, {"owner": {"reputation": 11, "user_id": 8566444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9d3b2856a11b01e175fcc79e6839c0?s=128&d=identicon&r=PG&f=1", "display_name": "EduCoell", "link": "https://stackoverflow.com/users/8566444/educoell"}, "edited": false, "score": 0, "creation_date": 1504724461, "post_id": 46065836, "comment_id": 79126940, "body": "For the first workbook, which pulls information from a range: before filtering there are over 200000 records, after filtering to 02 I pull 22000 records. For the second workbook, which pulls information from a table with a name that won&#39;t change: before filtering there are over 180000 records, after filtering I get 8700 records."}], "owner": {"reputation": 11, "user_id": 8566444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9d3b2856a11b01e175fcc79e6839c0?s=128&d=identicon&r=PG&f=1", "display_name": "EduCoell", "link": "https://stackoverflow.com/users/8566444/educoell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504666381, "creation_date": 1504664491, "last_edit_date": 1504666381, "question_id": 46065836, "link": "https://stackoverflow.com/questions/46065836/excel-vba-pull-filtered-information-from-user-chosen-workbooks", "title": "Excel-vba pull filtered information from user-chosen workbooks", "body": "<p>I have to make a master report that compiles information from two somewhat big workbooks. These workbooks change weekly, but the information structure in each one is and will always be the same, right from how many columns to each column name (how many records each one has might vary, of course, from 20000 to 25000, etc.)</p>\n\n<p>From Workbook 1, I have to pull information from specific columns from a range. Through investigation I managed to find a nice piece of code that helped me a lot. The information spans from A:W in the worksheet, but I just need information from columns c, f, g, i, and w. </p>\n\n<pre><code>Private Sub BtnImportDPr_Click()\nDim wkbCrntWorkBook As Workbook\nDim wkbSourceBook As Workbook\nDim rngSourceRange As Range\nDim rngDestination As Range\nSet wkbCrntWorkBook = ActiveWorkbook\n    With Application.FileDialog(msoFileDialogOpen)\n        .Filters.Clear\n        .Filters.Add \"Excel 2007-16\", \"*.xlsx; *.xlsm; *.xlsa; *.xlsb\"\n        .AllowMultiSelect = False\n        .Show\n        If .SelectedItems.Count &gt; 0 Then\n            Workbooks.Open .SelectedItems(1)\n            Set wkbSourceBook = ActiveWorkbook\n            Worksheets(\"SysSummary\").Activate\n            ActiveSheet.Range(\"A:W\").AutoFilter Field:=3, Criteria1:=\"&lt;=700\" _\n            , Operator:=xlAnd\n            Set rngSourceRange = Application.InputBox(prompt:=\"Select source range\", Title:=\"Source Range\", Default:=\"SysSummary!C:C,SysSummary!F:F,SysSummary!G:G,SysSummary!I:I,SysSummary!W:W\", Type:=8)\n            wkbCrntWorkBook.Activate\n            Set rngDestination = Application.InputBox(prompt:=\"Select destination cell\", Title:=\"Select Destination\", Default:=\"B:F\", Type:=8)\n            rngSourceRange.Copy rngDestination\n            rngDestination.CurrentRegion.EntireColumn.AutoFit\n            wkbSourceBook.Close False\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>This code allows the user to choose the workbook he/she wants to work with, I know it looks a risky with lots of potential errors, but I am sure that the structure of the range I am pulling information from will remain the same since once it is changed it will probably means this work utility will be nonexistent.\n|||</p>\n\n<p>Now, with the second workbook I need to work with a table (which across all the workbooks the user will choose, its name will remain the same). The table is big, from columns A to AQ, but I just need information from columns a, e, u, p, q, v and aa.</p>\n\n<p>So, since the last code worked I tried using it again but some errores popped out. Like, a table is different.</p>\n\n<pre><code>Private Sub BtnImportTTS_Click()\nDim wkbCrntWorkBook As Workbook\nDim wkbSourceBook As Workbook\nDim rngSourceRange As Range\nDim rngDestination As Range\nSet wkbCrntWorkBook = ActiveWorkbook\n    With Application.FileDialog(msoFileDialogOpen)\n        .Filters.Clear\n        .Filters.Add \"Excel 2007-16\", \"*.xlsx; *.xlsm; *.xlsa; *.xlsb\"\n        .AllowMultiSelect = False\n        .Show\n        If .SelectedItems.Count &gt; 0 Then\n            Workbooks.Open .SelectedItems(1)\n            Set wkbSourceBook = ActiveWorkbook\n            Worksheets(\"Sys_DETAIL\").Activate\n            ConvertTableToRange\n            ActiveSheet.Range(\"A3:AT\").AutoFilter Field:=27, Criteria1:=\"02\"\n            Set rngSourceRange = Application.InputBox(prompt:=\"Select source range\", Title:=\"Source Range\", Default:=\"Sys_DETAIL!A:A,Sys_DETAIL!E:E,Sys_DETAIL!U:U,Sys_DETAIL!P:P,Sys_DETAIL!Q:Q,Sys_DETAIL!V:V,Sys_DETAIL!AA:AA\", Type:=8)\n            wkbCrntWorkBook.Activate\n            Set rngDestination = Application.InputBox(prompt:=\"Select destination cell\", Title:=\"Select Destination\", Default:=\"B:H\", Type:=8)\n            rngSourceRange.Copy rngDestination\n            rngDestination.CurrentRegion.EntireColumn.AutoFit\n            wkbSourceBook.Close savechanges:=False\n        End If\n    End With\nEnd Sub\n\nSub ConvertTableToRange()\nDim rList As Range\n\nWith Worksheets(\"TTS_DETAIL\").ListObjects(\"Table_TRACK_TTS.accdb\")\n    Set rList = .Range\n    .Unlist                           ' convert the table back to a range\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>After investigating a bit, I decided to go the lazy route and just convert the table to a normal range through vba code, and it worked. But for some reason, I cant pull all the information. After filtering to Criteria1: 02 (which is extremely important) I am left with 8500 records (from 200000 that used to be), but Excel just pulls 5000 records. </p>\n\n<p>I am not sure if it has something to do with the fact that the range used to be a table. So, if someone can help me modify my code or give me a new one that works with table I will very much appreciate it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 2, "creation_date": 1504667670, "post_id": 46065792, "comment_id": 79093040, "body": "use the object <b><i>FileSystemObject</i></b>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504668911, "post_id": 46065792, "comment_id": 79093315, "body": "I just answer a Recursive FIle search problem, <a href=\"https://stackoverflow.com/questions/46053474/vba-verify-file-extension-as-excel-file/46054222#46054222\">VBA Verify File extension as excel file?</a>, that can be modified for a folder search."}], "owner": {"reputation": 9, "user_id": 8475244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da05294611ca50a16b05540f5ca77dfb?s=128&d=identicon&r=PG&f=1", "display_name": "C. Kyle", "link": "https://stackoverflow.com/users/8475244/c-kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504664727, "creation_date": 1504664076, "last_edit_date": 1504664727, "question_id": 46065792, "link": "https://stackoverflow.com/questions/46065792/vba-finding-folder-inside-a-directory-and-returning-the-path-of-that-folder", "title": "VBA - Finding folder inside a directory and returning the path of that folder", "body": "<p>I am using excel vba to make an application that acts as a job card. User will fill in relevant fields, press a button to update a running summary of costs, as well as generate a printable pdf of the job card. I have very limited experience in coding (a semester of java 4 years ago) so i am relatively new to this. </p>\n\n<p>Currently, the application automatically updates the summary file and can open a word template file and fill it in with information from the input fields, so it mostly works. I have realised an issue in the way it is finding the summary files, in that as soon as a folder name does not align with the way i am constructing the folder paths in the app, it will return errors. </p>\n\n<p>At the moment I am going into folders like this:</p>\n\n<pre><code>    templatePath = \"C:\\SERVICE\\Card Template.doc\"\nIf cbxType.Text = \"Plant\" Then\n    savePath = \"C:\\SERVICE\\0.1 PLANT\\\" &amp; cbxNo.Text &amp; \" - \" &amp; txtMakeModel.Text &amp; \" \" &amp; txtRego.Text &amp; \"\\0.2 SERVICE SHEETS\\\"\n    ElseIf cbxType.Text = \"Vehicle\" Then\n    savePath = \"C:\\SERVICE\\0.2 VEHICLES\\\"\n\nEnd If\n</code></pre>\n\n<p>The directory is constructed from text and combo boxes which are populated once the user chooses a type (plant, vehicle, etc.) and then ID, which fills in boxes for model name, registration number, hours etc.</p>\n\n<p>I am after a piece of code that can iterate through a given directory, searching the folder names for a string and returning the path of that folder. Each folder begins with the ID number, so I figure I can search folder names for that but I am not sure how to construct the loop. Any help with this, or alternative ideas would be appreciated. If it isn't too much to ask I'd also like a little bit of an explanation on how it works.</p>\n"}, {"tags": ["javascript", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504672133, "post_id": 46065754, "comment_id": 79094124, "body": "<a href=\"https://stackoverflow.com/questions/46064846/vba-skip-popup-message-box-in-webpage\" title=\"vba skip popup message box in webpage\">stackoverflow.com/questions/46064846/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1504680395, "creation_date": 1504680395, "answer_id": 46068536, "question_id": 46065754, "link": "https://stackoverflow.com/questions/46065754/vba-code-to-click-ok-on-javascript-popup/46068536#46068536", "title": "VBA code to click OK on Javascript Popup", "body": "<p>Popup window needs to be searched first and you have to send .click to that particular IE object. Please find the sample function and Sub which you can use. In following code, you need to send .click to iePopup object once it is found.</p>\n\n<pre><code>'Add references: Microsoft Internet Controls &amp; Microsoft HTML Object Library\nSub TestURLmatch()\nDim ie As Object\nDim sMatch As String\n\n'URL needs to be changed in next line\nsMatch = \"http://www.google.com\"\n\nOn Error Resume Next\nSet iePopup = GetIEatURL(sMatch &amp; \"*\")\nOn Error GoTo 0\nIf Not iePopup Is Nothing Then\n    MsgBox \"Found webpage at \" &amp; iePopup.LocationURL\nEnd If\nEnd Sub\n\nFunction GetIEatURL(sMatch As String) As Object\nDim ie As Object, oShApp As Object, oWin As Object\nSet oShApp = CreateObject(\"Shell.Application\")\nFor Each oWin In oShApp.Windows\n    If TypeName(oWin.Document) = \"HTMLDocument\" Then\n        Set ie = oWin\n        If LCase(ie.LocationURL) Like LCase(sMatch) Then\n            Set GetIEatURL = ie\n            Exit For\n        End If\n    End If\nNext\nSet oShApp = Nothing\nSet oWin = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8566458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213497293815714/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/8566458/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 995, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504680395, "creation_date": 1504663734, "last_edit_date": 1504664782, "question_id": 46065754, "link": "https://stackoverflow.com/questions/46065754/vba-code-to-click-ok-on-javascript-popup", "title": "VBA code to click OK on Javascript Popup", "body": "<p>I'm automating a VBA script to enter info on a webpage. I'm doing great until I get to this section of the code on the webpage:</p>\n\n<pre><code>   var message = \"You must read and accept these terms .\\n\\n\";\n   if(index &lt; 10)\n\n   var response = confirm(message);\n\n   if (response==true) {frm.h_index.value = index; frm.submit(); return true;}\n   else return false;\n</code></pre>\n\n<p>I can execute a <code>.Click</code> function on the original webpage which then causes this popup to run. From here, my code can't do anything until I manually click OK on the Javascript popup. I've searched all I can, and still not sure how to handle this.</p>\n\n<p>How can I programmatically dismiss that Javascript popup?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504669646, "post_id": 46065532, "comment_id": 79093498, "body": "I can&#39;t replicate it showing <code>False</code> but, ignoring that for the moment, what are you trying to do with that <code>If</code>?  It seems to be saying that if something is selected, you are setting <code>xSelLst</code> to be the string <code>&quot;data11;data10;data9;...data2;data1;&quot;</code>.  That seems to be a strange thing to do.  Aren&#39;t you interested in <b>what</b> was selected rather than just that <b>something</b> was selected?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504673439, "post_id": 46065532, "comment_id": 79094462, "body": "xLstBox.Selected(xLstBox.ListIndex )  to   xLstBox.Selected(I)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8218514"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504676314, "post_id": 46065532, "comment_id": 79095386, "body": "@YowE3K Thank you for your reply. I&#39;m trying to get what was selected and print it. do you have another way to do that?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504679313, "post_id": 46065532, "comment_id": 79096769, "body": "<code>xLstBox.List(xLstBox.ListIndex)</code>?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504681147, "post_id": 46065532, "comment_id": 79097862, "body": "You are repopulating the listbox each time you click on the Rectangle2. I think repopulating the listbox make you loose your selection."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8218514"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504683731, "post_id": 46065532, "comment_id": 79099492, "body": "@YowE3K it didn&#39;t work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8218514"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504683737, "post_id": 46065532, "comment_id": 79099497, "body": "@Vincent G can you please give me a solution Thank you"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1504684001, "post_id": 46065532, "comment_id": 79099632, "body": "Either don&#39;t populate the listbox in the Rectangle2_Click event but somewhere else, or maybe move the populate inside the <code>If xLstBox.Visible = False Then </code> branch (I suppose the listbox is initially hidden)."}], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 8558614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2h6yS.jpg?s=128&g=1", "display_name": "Nikolaos Polygenis", "link": "https://stackoverflow.com/users/8558614/nikolaos-polygenis"}, "is_accepted": false, "score": 0, "last_activity_date": 1504786094, "last_edit_date": 1504786094, "creation_date": 1504784239, "answer_id": 46095381, "question_id": 46065532, "link": "https://stackoverflow.com/questions/46065532/vba-listbox-selected-always-return-false/46095381#46095381", "title": "VBA ListBox.Selected always return false", "body": "<p>Please try the code Below</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Rectangle2_Click()\n\nDim MyList(10) As String\nMyList(0) = \"data1\"\nMyList(1) = \"data2\"\nMyList(2) = \"data3\"\nMyList(3) = \"data4\"\nMyList(4) = \"data5\"\nMyList(5) = \"data6\"\nMyList(6) = \"data7\"\nMyList(7) = \"data8\"\nMyList(8) = \"data9\"\nMyList(9) = \"data10\"\nMyList(10) = \"data11\"\n\nDim xSelShp As Shape\nDim xSelLst As Variant\nDim xLstBox As Object\nDim I As Integer\nDim rng As Range\n\nSet xSelShp = ActiveSheet.Shapes(Application.Caller)\nSet xLstBox = ListBox1\n\nxLstBox.List = MyList ' Insert Data from array to ListBox\n\nSet rng = ActiveSheet.Range(\"I10:R10\") 'I must setting width,heigh and location because everytime i click the button the size become smaller and the position changed.\nxLstBox.Width = 150\nxLstBox.Height = 180\nxLstBox.Top = rng.Top\nxLstBox.Left = rng.Left\n\nIf xLstBox.Visible = False Then\n    xLstBox.Visible = True\n    xSelShp.TextFrame2.TextRange.Characters.Text = \"Pickup Options\"\nElseIf xLstBox.Visible = True Then\nxSelShp.TextFrame2.TextRange.Characters.Text = \"Pickup Options\"\n\n\n    For I = 0 To xLstBox.ListCount - 1\n\n        If xLstBox.Selected(I) Then \n            xSelLst = xLstBox.List(I) &amp; \";\" &amp; xSelLst\n        End If\n    Next I\n    If xSelLst &lt;&gt; \"\" Then\n        Range(\"ListBoxOutput\") = Mid(xSelLst, 1, Len(xSelLst) - 1)\n    Else\n        Range(\"ListBoxOutput\") = \"\"\n    End If\n    Else\n\nxLstBox.Visible = False\n    xSelShp.TextFrame2.TextRange.Characters.Text = \"Select Options\"\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>on Workbook open add the following</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n\n\nSheet1.Shapes.Range(Array(\"Rectangle 2\")).Select\n    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = \"Select Options\"\n    Sheet1.ListBox1.Visible = False\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8218514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504786094, "creation_date": 1504661831, "question_id": 46065532, "link": "https://stackoverflow.com/questions/46065532/vba-listbox-selected-always-return-false", "title": "VBA ListBox.Selected always return false", "body": "<p>I'm trying to create ListBox that show up when clicking a button. and get list data from an array. but for some reason ListBox.Selected always False even though I clicked the ListBox.</p>\n\n<pre><code>Sub Rectangle2_Click()\n\nDim MyList(10) As String\nMyList(0) = \"data1\"\nMyList(1) = \"data2\"\nMyList(2) = \"data3\"\nMyList(3) = \"data4\"\nMyList(4) = \"data5\"\nMyList(5) = \"data6\"\nMyList(6) = \"data7\"\nMyList(7) = \"data8\"\nMyList(8) = \"data9\"\nMyList(9) = \"data10\"\nMyList(10) = \"data11\"\n\nDim xSelShp As Shape \nDim xSelLst As Variant\nDim I As Integer\n\nSet xSelShp = ActiveSheet.Shapes(Application.Caller) \nSet xLstBox = ActiveSheet.ListBox1 \n\nxLstBox.List = MyList ' Insert Data from array to ListBox\n\nSet rng = ActiveSheet.Range(\"I10:R10\") 'I must setting width,heigh and location because everytime i click the button the size become smaller and the position changed.\nxLstBox.Width = 150\nxLstBox.Height = 180\nxLstBox.Top = rng.Top\nxLstBox.Left = rng.Left\n\nIf xLstBox.Visible = False Then\n    xLstBox.Visible = True\n    xSelShp.TextFrame2.TextRange.Characters.Text = Pickup Options\"\nElse\n    xLstBox.Visible = False\n    xSelShp.TextFrame2.TextRange.Characters.Text = \"Select Options\"\n    For I = 0 To xLstBox.ListCount - 1\n\n        If xLstBox.Selected(xLstBox.ListIndex) Then '&lt;&lt; This is the problem. Always return False\n            xSelLst = xLstBox.List(I) &amp; \";\" &amp; xSelLst\n        End If\n    Next I\n    If xSelLst &lt;&gt; \"\" Then\n        Range(\"ListBoxOutput\") = Mid(xSelLst, 1, Len(xSelLst) - 1)\n    Else\n        Range(\"ListBoxOutput\") = \"\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I look other people code and their using selected function too. can someone please help me, how to solve this problem. thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504663371, "post_id": 46065518, "comment_id": 79092111, "body": "which sheet do you want to copy the the data to... im a little confused because <code>lastRowOutput</code> is referencing <code>Carriers</code> sheet but you have the variable where you are grabbing information from the <code>Geovera</code> sheet."}, {"owner": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 0, "creation_date": 1504663406, "post_id": 46065518, "comment_id": 79092126, "body": "What if you just try inputWS2.Range(&quot;F2:F&quot; &amp; lastRowOutput).Copy outputWS.Range(&quot;B65536&quot;) without the .end(xlUp).row?  It doesn&#39;t give an error on my sheet."}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "reply_to_user": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504663617, "post_id": 46065518, "comment_id": 79092177, "body": "Hey @ShanayL, im trying to copy the data to Carrier. the Lastrowoutput variable was put on the last line by me trying to tweak it out."}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "reply_to_user": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 0, "creation_date": 1504663667, "post_id": 46065518, "comment_id": 79092187, "body": "@CDVAProgrammer That didnt work."}, {"owner": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 0, "creation_date": 1504663827, "post_id": 46065518, "comment_id": 79092230, "body": "I think it would help to see an example data set, ie how does the first two input sheets look like and also see how the output sheet is supposed to be."}, {"owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "edited": false, "score": 0, "creation_date": 1504664541, "post_id": 46065518, "comment_id": 79092392, "body": "Here is a shareable link.  <a href=\"https://drive.google.com/open?id=0B6iO6tzl38BqRDA1SWZ1QjM5Wnc\" rel=\"nofollow noreferrer\">drive.google.com/open?id=0B6iO6tzl38BqRDA1SWZ1QjM5Wnc</a>  last line messed up my code on the Carriers sheet which is my main sheet and were i want ALL data to go to"}], "answers": [{"tags": [], "owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "is_accepted": true, "score": 1, "last_activity_date": 1504665630, "creation_date": 1504665630, "answer_id": 46065961, "question_id": 46065518, "link": "https://stackoverflow.com/questions/46065518/paste-data-on-last-row-of-input-sheet/46065961#46065961", "title": "Paste data on last row of input sheet", "body": "<p>instead of </p>\n\n<pre><code>inputWS2.Range(\"F2:F\" &amp; lastRowOutput).Copy outputWS.Range(\"B65536\").End(xlUp).Row\n</code></pre>\n\n<p>try </p>\n\n<pre><code>inputWS2.Range(\"F2:F\" &amp; lastRowGeovera).Copy outputWS.Range(\"B\" &amp; lastRowUniversal - 1)\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8540592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh4.googleusercontent.com/-1xYxoC7KMW0/AAAAAAAAAAI/AAAAAAAAABg/pLIMFPu4TGU/photo.jpg?sz=128", "display_name": "Hermes Omar Gomez", "link": "https://stackoverflow.com/users/8540592/hermes-omar-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 46065961, "answer_count": 1, "score": 0, "last_activity_date": 1504666795, "creation_date": 1504661749, "last_edit_date": 1504666795, "question_id": 46065518, "link": "https://stackoverflow.com/questions/46065518/paste-data-on-last-row-of-input-sheet", "title": "Paste data on last row of input sheet", "body": "<p>Im creating a macro which pulls data from several columns on several sheets and organize all data into one sheet.</p>\n\n<p>The code i have is :</p>\n\n<pre><code>Private Sub Update_Click()\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Dim path As String, fileName As String\n    Dim lastRowInput As Long, lastRowOutput As Long, rowCntr As Long, lastColumn As Long\n    Dim inputWS1 As Worksheet, inputWS2 As Worksheet, outputWS As Worksheet\n\n    'set your sheets here\n    Set inputWS1 = ThisWorkbook.Sheets(\"Universal\")\n    Set inputWS2 = ThisWorkbook.Sheets(\"Geovera\")\n    Set outputWS = ThisWorkbook.Sheets(\"Carriers\")\n\n\n    rowCntr = 1\n\n    'get last rows from both sheets\n    lastRowUniversal = inputWS1.Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastRowGeovera = inputWS2.Cells(Rows.Count, \"F\").End(xlUp).Row\n    LastRowPolicy = outputWS.Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n    lastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastColumn = inputWS1.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    'Universal\n    inputWS1.Range(\"A4:A\" &amp; lastRowUniversal).Copy outputWS.Range(\"B2\")\n    inputWS1.Range(\"B4:B\" &amp; lastRowUniversal).Copy outputWS.Range(\"C2\")\n    outputWS.Range(\"E2:E\" &amp; (lastRowUniversal - 2)).Value = inputWS1.Name\n    inputWS1.Range(\"J4:J\" &amp; lastRowUniversal).Copy outputWS.Range(\"G2\")\n    outputWS.Range(\"G2:G\" &amp; (lastRowUniversal - 2)).Value = Evaluate(\"=IF(ISNUMBER(G2:G\" &amp; (lastRowUniversal - 2) &amp; \"),DATE(YEAR(G2:G\" &amp; (lastRowUniversal - 2) &amp; \")-1,MONTH(G2:G\" &amp; (lastRowUniversal - 2) &amp; \"),DAY(G2:G\" &amp; lastRowUniversal &amp; \")),G2:G\" &amp; (lastRowUniversal - 2) &amp; \")\")\n    inputWS1.Range(\"G4:G\" &amp; lastRowUniversal).Copy outputWS.Range(\"H2\")\n\n    'Geovera\n    inputWS2.Range(\"F2:F\" &amp; lastRowOutput).Copy outputWS.Range(\"B65536\").End(xlUp).Row\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic \nEnd Sub\n</code></pre>\n\n<p>I finished working on migrating one sheet to the organized main sheet. </p>\n\n<p>When i start setting up the 2nd sheet i noticed that it overwrites the data from the first sheet. I want a code that will paste the data at the first blank space on the row.</p>\n\n<p>My error is coming at this line:</p>\n\n<pre><code>inputWS2.Range(\"F2:F\" &amp; lastRowOutput).Copy outputWS.Range(\"B65536\").End(xlUp).Row\n</code></pre>\n\n<p>is still not there. But i want the data from column F to move to column B on the main sheet without deleting what i already copied on the previous sheet.</p>\n\n<p>Please help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "edited": false, "score": 0, "creation_date": 1504684638, "post_id": 46065380, "comment_id": 79100010, "body": "match function takes a range of single col as lookup array... so in your case it is throwing error compile time itself but you are not able to see it because of the ignore error statement that you have added. So you are changing color of col C and E only, so I am guessing you are intending to search the key in both of these col itself..."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504739060, "post_id": 46069834, "comment_id": 79133098, "body": "This works for consecutive blocks, however if the column is broken then it will assign a new colour"}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "reply_to_user": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504766099, "post_id": 46069834, "comment_id": 79140335, "body": "@ohnoohdear do you mean if one of a cell in a column is Empty... if that is the case the just add a if isEmpty() condition before the first match function and ignore every empty cell to get colured"}, {"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504823502, "post_id": 46069834, "comment_id": 79175061, "body": "No, all cells in both columns are filled to the bottom."}], "tags": [], "owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "is_accepted": true, "score": 0, "last_activity_date": 1504684945, "creation_date": 1504684945, "answer_id": 46069834, "question_id": 46065380, "link": "https://stackoverflow.com/questions/46065380/each-instance-of-a-value-gets-the-same-colour-and-new-values-get-a-new-colour/46069834#46069834", "title": "Each instance of a value gets the same colour and new values get a new colour", "body": "<p>Assuming: -  As you are changing color of col C and E only, so I am guessing you are intending to search the presence of the number in C and E only... so Col D is of no significance here...</p>\n\n<pre><code> Option Explicit\n\nSub colourNumbers()\n\nDim a, x, x1, x2, b, lastRow, lastCol As Long\nDim wf As WorksheetFunction\nDim analysisSheet As Worksheet\nDim rng1, rng2 As Range\n\nSet wf = Application.WorksheetFunction\nSet analysisSheet = ThisWorkbook.Worksheets(\"Sheet1\")\n\n\nlastRow = ActiveSheet.Cells(Rows.Count, 3).End(xlUp).Row\n\n\nSet rng1 = analysisSheet.Range(\"C3:C\" &amp; lastRow)\nSet rng2 = analysisSheet.Range(\"E3:E\" &amp; lastRow)\n\nlastCol = 3\n\nFor a = 3 To lastRow\n\n    If b = 3 Then\n        b = 5\n    Else\n        b = 3\n    End If\n\n    If b = 5 Then\n        a = a - 1\n    End If\n\n\n\n\nx = 0\nx1 = 0\nx2 = 0\n\nOn Error Resume Next\nx1 = wf.Match(analysisSheet.Cells(a, b).Value, rng1, 0) + 2 ' match function offset from where the array starts\nOn Error GoTo 0\n\nOn Error Resume Next\nx2 = wf.Match(analysisSheet.Cells(a, b).Value, rng2, 0) + 2\nOn Error GoTo 0\n\n\nIf x1 = 0 And x2 &gt; 0 Then\n    x = x2\nElseIf x2 = 0 And x1 &gt; 0 Then\n    x = x1\nElseIf x2 &gt; 0 And x1 &gt; 0 Then\n    x = x1 'pick anyone\nElse\n    x = 0\nEnd If\n\n\n'Debug.Print x\n'Debug.Print analysisSheet.Cells(a, b).Value\n\n\n\nIf x &gt; 0 And x &lt;&gt; a And b = lastCol Then\n    'Debug.Print \"Same\"\n    analysisSheet.Cells(a, b).Interior.Color = analysisSheet.Cells(x, 3).Interior.Color\n    lastCol = b\n\nElseIf x &gt; 0 And x = a And b &lt;&gt; lastCol Then\n   ' Debug.Print \"Same2\"\n    analysisSheet.Cells(a, b).Interior.Color = analysisSheet.Cells(x, 3).Interior.Color\n\nElseIf x &gt; 0 And x &lt;&gt; a And b &lt;&gt; lastCol Then\n    'Debug.Print \"Same2\"\n    analysisSheet.Cells(a, b).Interior.Color = analysisSheet.Cells(x, 3).Interior.Color\n\nElse\n    analysisSheet.Cells(a, b).Interior.Color = RGB(wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\n\nEnd If\n\n\n\nNext a\n\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>PS:</strong> More efficiently while searching a key in multiple col use Find() method instead of Match().</p>\n"}], "owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 46069834, "answer_count": 1, "score": 0, "last_activity_date": 1504684945, "creation_date": 1504660680, "question_id": 46065380, "link": "https://stackoverflow.com/questions/46065380/each-instance-of-a-value-gets-the-same-colour-and-new-values-get-a-new-colour", "title": "Each instance of a value gets the same colour and new values get a new colour", "body": "<p>Hi I recently asked the question, here:\n<a href=\"https://stackoverflow.com/questions/46063772/assigning-colours-to-each-instance-of-a-value/46064675\">Assigning Colours to each Instance of a value</a>,\nhowever this ended up not working for me and I was unsure if I should carry on in that thread or start a new one because I have changed some things. Here is my new code, it alternates cell selection between two columns and changes the colour of the selected cell, however if the number already exists, I want them to have the same colour. What I have now, doesnt seem to match and assigns a random colour despite there being matches. </p>\n\n<pre><code>Sub colourNumbers()\nDim a As Long\nDim b As Long\nSet wf = Application.WorksheetFunction\nDim analysisSheet As Worksheet\nSet analysisSheet = ActiveSheet\n    lastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor a = 3 To lastRow\n\n    If b = 3 Then\n    b = 5\n        Else\n            b = 3\n    End If\n\n    If b = 5 Then\n        a = a - 1\n    End If\n\nanalysisSheet.Cells(a, b).Select\nWith Selection\nx = 0\nOn Error Resume Next\nx = wf.Match(Selection.Value, _\n    Range(\"C3:E\" &amp; [C3000].End(xlUp).Row), 0)\nOn Error GoTo 0\nIf x &gt; 0 Then\n    target.Interior.Color = Cells(x, 3).Interior.Color\n    Else\n        Selection.Interior.Color = RGB( _\n            wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\n    End If\nEnd With\nNext a\nEnd Sub\n</code></pre>\n\n<p>any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel", "checkbox", "password-protection"], "comments": [{"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504659075, "post_id": 46065060, "comment_id": 79091164, "body": "What is your goal? Do you just want to have a checkbox cause True or False to appear in its linked cell?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1504697192, "post_id": 46065060, "comment_id": 79108622, "body": "Have you unlocked the checkbox itself?"}, {"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "reply_to_user": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504710096, "post_id": 46065060, "comment_id": 79118472, "body": "@TonyM Yes.  That is exactly it."}, {"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1504710241, "post_id": 46065060, "comment_id": 79118574, "body": "@HarassedDad I need to preserve protections.  It&#39;s the fact that the linked cell is locked/protected that is causing the exception."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1505294777, "post_id": 46065060, "comment_id": 79349657, "body": "Are you sure? Check boxes themselves have a protected property - and if they&#39;re protected you can&#39;t click on them . There&#39;s no way to distinguish the error message from clicking on a protected  checkbox from that from attempting to change the underlying cell that the checkbox is linked to."}], "owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504657633, "creation_date": 1504657633, "question_id": 46065060, "link": "https://stackoverflow.com/questions/46065060/vba-userinterfaceonly-true-is-not-working-for-checkbox-linkedcell", "title": "VBA: UserInterfaceOnly:=True is not working for Checkbox LinkedCell", "body": "<p>I'm trying to allow a Checkbox to assign a TRUE/FALSE value to its <code>LinkedCell</code> on a protected sheet.  As you can see below, anytime it locks the worksheet, it sets <code>UserInterfaceOnly:=True</code>.  BUT, when I click the Checkbox, it gives me the exception message box that says it is a protected sheet.</p>\n\n<p>Since the <code>LinkedCell</code> assigns the value immediately, there is no chance to toggle worksheet protection without utilizing a function to assign the TRUE/FALSE value.  I'd like to avoid that if possible.</p>\n\n<p>Am I missing something?  I've looked at a few questions previously posted here on SO, but they don't seem to cover my issue.</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub ResetLogWorksheet()\n\n    Sheet1.Range(\"C1\").Value = \"\"\n\n    'Lock entire worksheet except select manual entry cell\n    With Sheet1\n       .Unprotect Password:=GetProtectPassword()\n       .Range(\"C1:O1\").Locked = False\n       .Protect Password:=GetProtectPassword(), UserInterfaceOnly:=True, AllowFormattingCells:=True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "duplicates", "complextype"], "comments": [{"owner": {"reputation": 875, "user_id": 6698273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29c77a7034e4def459c75c7fa1ee5e7d?s=128&d=identicon&r=PG&f=1", "display_name": "BlooB", "link": "https://stackoverflow.com/users/6698273/bloob"}, "edited": false, "score": 0, "creation_date": 1504656910, "post_id": 46064951, "comment_id": 79090745, "body": "why not make a variable of first name + last name, than do any matching?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504657078, "post_id": 46064951, "comment_id": 79090770, "body": "You can use MATCH with two columns : <a href=\"http://www.excel-easy.com/examples/two-column-lookup.html\" rel=\"nofollow noreferrer\">excel-easy.com/examples/two-column-lookup.html</a>"}, {"owner": {"reputation": 875, "user_id": 6698273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29c77a7034e4def459c75c7fa1ee5e7d?s=128&d=identicon&r=PG&f=1", "display_name": "BlooB", "link": "https://stackoverflow.com/users/6698273/bloob"}, "edited": false, "score": 0, "creation_date": 1504657383, "post_id": 46064951, "comment_id": 79090818, "body": "Or you can use  vLOOKUP"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1504661314, "post_id": 46064951, "comment_id": 79091618, "body": "Do you know VBA or are you looking for a Formula style answer?"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1504670922, "last_edit_date": 1504670922, "creation_date": 1504670187, "answer_id": 46066563, "question_id": 46064951, "link": "https://stackoverflow.com/questions/46064951/excel-check-identify-duplicate-text-between-multiple-rows-and-on-another-shee/46066563#46066563", "title": "EXCEL - Check/ identify duplicate text between multiple rows AND on another sheet", "body": "<p>If a custom report is more convenient, the VBA code bellow needs an extra sheet</p>\n\n<p>Assuming that your sheets are \"Sheet1\" (S1), \"Sheet2\" (S2), and Sheet3 (the report), the solution will generate on Sheet3 a list with all unique FirstName + LastName from S1 that have a match on S2</p>\n\n<ul>\n<li>Column B will show how many duplicates exist in S1</li>\n<li>Column C = First Name (S1)</li>\n<li>Column D = Last Name (S1)</li>\n<li>Column E will show how many duplicates exist in S2</li>\n</ul>\n\n<p>Additional functionality:</p>\n\n<p>If you click on any Name (First or Last) on S3 it will filter S1 and S2 for that name, similar to this:</p>\n\n<hr>\n\n<p>S1</p>\n\n<p><a href=\"https://i.stack.imgur.com/0qujc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0qujc.png\" alt=\"enter image description here\"></a></p>\n\n<p>S2</p>\n\n<p><a href=\"https://i.stack.imgur.com/JfKrx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JfKrx.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Report (S3)</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZZAAi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZZAAi.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Clicking on \"First3\" (or \"Last3\") in S3, you'll get</p>\n\n<p>S1</p>\n\n<p><a href=\"https://i.stack.imgur.com/Welw6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Welw6.png\" alt=\"enter image description here\"></a></p>\n\n<p>S2</p>\n\n<p><a href=\"https://i.stack.imgur.com/HkYKT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HkYKT.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>The code:</p>\n\n<p>Open VBA editor: <kbd>Alt</kbd>+<kbd>F11</kbd></p>\n\n<ul>\n<li>Insert a new generic module: anywhere in the top-left pane right-click and select Insert -> Module</li>\n<li>In the new module (probably called Module1), right pane, paste the following code:</li>\n</ul>\n\n<hr>\n\n<p><strong>Module1</strong> (total of 4 procedures):</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub FindMatches()\n    Dim ws1 As Worksheet, ws2 As Worksheet, d1 As Object, d2 As Object\n\n    Set ws1 = Sheet1\n    Set ws2 = Sheet2\n    Set d1 = ReadNames(ws1)\n    Set d2 = ReadNames(ws2)\n\n    If Not d1 Is Nothing And Not d2 Is Nothing Then MatchNames d1, d2\n    Sheet3.Activate\nEnd Sub\n\nPrivate Function ReadNames(ByRef ws As Worksheet) As Object\n    If Not ws Is Nothing Then\n        Dim d As Object, ur As Variant, i As Long\n\n        Set d = CreateObject(\"Scripting.Dictionary\")\n        d.CompareMode = TextCompare\n\n        ur = ws.UsedRange.Columns(\"C:D\") 'Read all names\n        For i = LBound(ur) To UBound(ur)\n            If Not d.Exists(ur(i, 1) &amp; \" \" &amp; ur(i, 2)) Then 'this keeps count of dupes\n                d(ur(i, 1) &amp; \" \" &amp; ur(i, 2)) = 1\n            Else\n                d(ur(i, 1) &amp; \" \" &amp; ur(i, 2)) = d(ur(i, 1) &amp; \" \" &amp; ur(i, 2)) + 1\n            End If\n        Next\n        Set ReadNames = d\n    End If\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>'Generates list of unique names on Sheet3, for full names from Sheet1, found on Sheet2\n\nPrivate Sub MatchNames(ByRef d1 As Object, d2 As Object)\n    If Not d1 Is Nothing And Not d2 Is Nothing Then\n        Dim ur As Variant, itm As Variant, i As Long, fl As Variant\n\n        With Sheet3     'Or use Worksheets(\"Sheet3\") 'or \"Matches\", or \"Report\", etc\n            .UsedRange.EntireRow.Delete\n            ur = .Range(.Cells(1, 2), .Cells(d1.Count, 5))\n        End With\n        ur(1, 1) = \"Sheet1 Count\":  ur(1, 4) = \"Sheet2 Count\"\n        ur(1, 2) = \"First Name\":    ur(1, 3) = \"Last Name\"\n        i = 2\n        For Each itm In d1\n            If d2.Exists(itm) Then\n                ur(i, 1) = d1(itm)\n                fl = Split(itm)\n                ur(i, 2) = fl(0)\n                ur(i, 3) = fl(1)\n                ur(i, 4) = d2(itm)\n                i = i + 1\n            End If\n        Next\n        With Sheet3\n            .Range(.Cells(1, 2), .Cells(d1.Count, 5)) = ur\n            With .UsedRange.Columns\n                .EntireColumn.AutoFit\n                .HorizontalAlignment = xlCenter\n            End With\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub FilterNames(ByRef ws As Worksheet, ByVal fName As String, lName As String)\n    With ws.UsedRange\n        .AutoFilter Field:=4, Criteria1:=lName\n        .AutoFilter Field:=3, Criteria1:=fName\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Now, in the VBA editor double-click the item \"Sheet3\" (top left) to open its module and paste this code</p>\n\n<hr>\n\n<p><strong>\"Sheet3\" Module</strong> (1 procedure):</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.CountLarge = 1 Then\n        Dim lr As Long, fn As String, ln As String\n        lr = Me.UsedRange.Rows.Count\n        With Target\n            If (.Row &gt; 1 And .Row &lt;= lr) And (.Column = 3 Or .Column = 4) Then\n                fn = .Value2\n                ln = .Offset(, 1).Value2\n                If .Column = 4 Then\n                    fn = .Offset(, -1).Value2\n                    ln = .Value2\n                End If\n                FilterNames Sheet1, fn, ln\n                FilterNames Sheet2, fn, ln\n            Else\n                If Sheet1.AutoFilterMode Then Sheet1.UsedRange.AutoFilter\n                If Sheet2.AutoFilterMode Then Sheet2.UsedRange.AutoFilter\n            End If\n        End With\n        Sheet1.Activate\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To execute the code</p>\n\n<ul>\n<li>double-click Module1 again</li>\n<li>place the mouse cursor anywhere in the top Sub <strong><code>FindMatches()</code></strong></li>\n<li>press <kbd>F5</kbd></li>\n</ul>\n\n<p>Make sure that all sheets are named exactly \"Sheet1\", \"Sheet2\", and \"Sheet3\"</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 8566157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155460387627110/picture?type=large", "display_name": "Scarlett Mansfield", "link": "https://stackoverflow.com/users/8566157/scarlett-mansfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504670922, "creation_date": 1504656628, "question_id": 46064951, "link": "https://stackoverflow.com/questions/46064951/excel-check-identify-duplicate-text-between-multiple-rows-and-on-another-shee", "title": "EXCEL - Check/ identify duplicate text between multiple rows AND on another sheet", "body": "<p>I have the first and last name of criminals in New York during the early 20th C. I have narrowed down the certain sector of crime I'm focusing on, but I want to cross-reference the names with the wider database to see if they have committed any other offences. The problem is, the first name and last name are in different cells. SO, the best I've been able to do so far is mark an 'X' if there is a match for the last name, and an 'X' in the column next to if there is a match for the first name. The problem with this is that while it narrows it down SLIGHTLY, there's lots of people that have the name 'Adam' for example, and lots with the last name 'Brown', so it doesn't show there's actually a match.</p>\n\n<p>So spreadsheet 1 'S1', has a last name (e.g. Brown) in C2 and first name (e.g. John) in D2 while spreadsheet 2 'S2' has totally different names in C2 and D2, so I need to search through all the column of C and then D for a match.</p>\n\n<p>Is there a way of writing a code for this? Any ideas?!</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8566057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b6e72788af2ae03d3b296a845fca62?s=128&d=identicon&r=PG&f=1", "display_name": "Joao Silva", "link": "https://stackoverflow.com/users/8566057/joao-silva"}, "edited": false, "score": 0, "creation_date": 1504705052, "post_id": 46064928, "comment_id": 79114618, "body": "Awesome! It works perfectly\u2026 I can\u2019t assess the complexity of the solution (seems simple what is great), but I can tell you that you\u2019ve helped me a lot and saved me a lot of time. Many thanks"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1504657490, "last_edit_date": 1504657490, "creation_date": 1504656412, "answer_id": 46064928, "question_id": 46064846, "link": "https://stackoverflow.com/questions/46064846/vba-skip-popup-message-box-in-webpage/46064928#46064928", "title": "vba skip popup message box in webpage", "body": "<p>You can try overwriting <code>window.confirm</code> with a different functionality:</p>\n\n<pre><code>With HTMLdoc.parentWindow\n    .execScript \"window.confirm = function(){return true;};\", \"JScript\"\n    .execScript \"licitarLeilao();\", \"JScript\"\nEnd With\n</code></pre>\n\n<p>In a test page that worked OK for me.</p>\n\n<p><strong>NOTE</strong>: if there's any other code on the web page which uses <code>confirm</code> then the functionality of that code may be impacted.</p>\n"}], "owner": {"reputation": 3, "user_id": 8566057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b6e72788af2ae03d3b296a845fca62?s=128&d=identicon&r=PG&f=1", "display_name": "Joao Silva", "link": "https://stackoverflow.com/users/8566057/joao-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 46064928, "answer_count": 1, "score": -1, "last_activity_date": 1504657490, "creation_date": 1504655716, "last_edit_date": 1504656071, "question_id": 46064846, "link": "https://stackoverflow.com/questions/46064846/vba-skip-popup-message-box-in-webpage", "title": "vba skip popup message box in webpage", "body": "<p>I\u2019m a beginner and desperately seeking for help. I would kindly request your support and apologize in advance for the poor wording and eventual lack of info (again, I\u2019m a rookie). I\u2019m building an Excel macro to fill in a (private) webpage and after filling in the requested data, I\u2019m also able to call the javascript function that submits the data/form. However, it appears a \u201cMessage from webpage\u201d that I\u2019m unable to confirm (always \"ok\"/enter) or simple skip. The Macro just stops and I can\u2019t do anything without clicking manually in the \u201cok\u201d button. I\u2019ve spend several hours searching and trying different solutions but nothing seems to work, probably due to my poor skills. Hereunder I send the code that is beating me hard (hope is enough). Looking forward for your help</p>\n\n<p>MY CODE</p>\n\n<pre><code>DIM HTMLdoc As MSHTML.HTMLDocument\n\n' Submits data but gets stuck in the popup message box\nHTMLdoc.all.Item\nCall HTMLdoc.parentWindow.execScript(\"licitarLeilao();\", \"JScript\")\n</code></pre>\n\n<p>WEBPAGE</p>\n\n<pre><code>...\nfunction licitarLeilao(){\n    var ultimaLicitacao = document.getElementById('ultimaLicitacao').value;\n    var valorLicitar = document.getElementById('valorLicitar').value;\n\n    if(ultimaLicitacao == ' -- '){\n        ultimaLicitacao = document.getElementById('valorBase').value;\n    }\n\n    var racio = toNum(valorLicitar) / toNum(ultimaLicitacao);\n\n    if (racio &lt; 1.5) {\n        if(!confirm('Confirma o valor de licita\u00e7\u00e3o (' + valorLicitar +' eur.) do leil\u00e3o?')){\n            return false;\n        }   \n    }\n    else {  \n        if(!confirm('ATEN\u00c7\u00c3O!! O valor de licita\u00e7\u00e3o \u00e9 muito superior \u00e0 \u00faltima licita\u00e7\u00e3o. \\n\\n Confirma o valor de licita\u00e7\u00e3o (' + valorLicitar +' eur.) do leil\u00e3o?')){\n            return false;\n        }\n    }   \n\n    var flow = document.getElementById('flow');\n    flow.value = '8';\n\n    document.formulario.submit();\n}\n</code></pre>\n"}, {"tags": ["excel", "dataset", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1504651621, "post_id": 46064270, "comment_id": 79089535, "body": "Also, I looked into multi-selecting all of the rows of interest in the loop and performing the delete with one line of code after all of the rows were selected, but couldn&#39;t figure out a way of doing this. I would assume this would likely increase the overall computation time."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1504655812, "post_id": 46064360, "comment_id": 79090521, "body": "Thank you I will try this tomorrow. Do you expect to see a large decrease in computation time using this method?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1504659485, "post_id": 46064360, "comment_id": 79091239, "body": "@Jesse yes as it only does the delete once."}, {"owner": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1504717761, "post_id": 46064360, "comment_id": 79123280, "body": "I compared your method to the original one using a small dataset, and it is roughly 225% faster. Using the same dataset, the loops took 519s and 231s to execute. Both sets of code are in an .xlsm that have a lot of other sheets, modules, etc. I then took my original code and inserted it into an empty .xlsm and timed it again, and it took 71s to execute. I assume your method would take ~30s in an empty .xlsm. So my next question: Are there any other properties that I can disable during the loop to speed things up?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1504717915, "post_id": 46064360, "comment_id": 79123350, "body": "@Jesse Yes, disable all events and screen updating.  Make sure to re-enable them before leaving the macro.  Please remember to mark an answer as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1505256287, "post_id": 46064360, "comment_id": 79335507, "body": "Could you be more specific on disabling all events? I have tried disabling screen updates as well asApplication.Calculation = xlCalculationManual. My code is just much slower in the larger spreadsheet and I can&#39;t seem to get it to execute as quickly as it does in an empty spreadsheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "edited": false, "score": 0, "creation_date": 1505257178, "post_id": 46064360, "comment_id": 79335732, "body": "<code>Application.EnableEvents = False</code> and make sure it is set back to True before ending the sub.  But this will only effect the code if you have events.  Events are code in that fire when things happen; like Worksheet_Change or Worksheet_calculate @Jesse"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1504652226, "last_edit_date": 1504652226, "creation_date": 1504651805, "answer_id": 46064360, "question_id": 46064270, "link": "https://stackoverflow.com/questions/46064270/deleting-every-2nd-and-3rd-row-using-vba/46064360#46064360", "title": "Deleting every 2nd and 3rd row using VBA", "body": "<p>Use a for loop that allows the stepping by a certain number:</p>\n\n<blockquote>\n  <p><code>For i = 8 To n Step 3</code></p>\n</blockquote>\n\n<p>Use Union to create a disjointed range stored in a range variable.</p>\n\n<blockquote>\n  <p><code>Set rng = Union(rng, .Range(.Cells(i + 1, 1), .Cells(i + 2, 1)))</code></p>\n</blockquote>\n\n<p>Then delete all at once.</p>\n\n<blockquote>\n  <p><code>rng.EntireRow.Delete</code></p>\n</blockquote>\n\n<p>Another good habit to encourage is the use of <strong>ALWAYS</strong> declaring the parent of any range objects.  As your code gets more and more complicated, not declaring the parents can lead to problems.</p>\n\n<p>By using the <code>With</code> block.</p>\n\n<blockquote>\n  <p><code>With Worksheets(\"Sheet1\")</code></p>\n</blockquote>\n\n<p>we can precede all the range objects with <code>.</code> to denote the link to that parent.</p>\n\n<blockquote>\n  <p><code>Set rng = .Range(\"A6:A7\")</code></p>\n</blockquote>\n\n<pre><code>Sub Delete()\n\nDim n As Long\nDim i As Long\nDim rng As Range\n\nApplication.Calculation = xlCalculationManual\n\nWith Worksheets(\"Sheet1\") 'change to your sheet\n    n = Application.WorksheetFunction.Count(.Range(\"A:A\"))\n\n    Set rng = .Range(\"A6:A7\")\n\n    For i = 8 To n Step 3\n        Set rng = Union(rng, .Range(.Cells(i + 1, 1), .Cells(i + 2, 1)))\n    Next i\nEnd With\n\nrng.EntireRow.Delete\n\nApplication.Calculation = xlCalculationAutomatic    \n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1504656357, "creation_date": 1504656357, "answer_id": 46064922, "question_id": 46064270, "link": "https://stackoverflow.com/questions/46064270/deleting-every-2nd-and-3rd-row-using-vba/46064922#46064922", "title": "Deleting every 2nd and 3rd row using VBA", "body": "<p>You could use arrays and write out one-third of the rows into a new array. Then print out to the screen after clearing the original. </p>\n\n<p>You would lose formulas if any are there. If you had just a basic dataset, this might suit you. It should be fast</p>\n\n<pre><code>Sub MyDelete()\n    Dim r As Range\n    Set r = Sheet1.Range(\"A1\").CurrentRegion  'perhaps define better\n    Set r = r.Offset(1, 0).Resize(r.Rows.Count - 1)  ' I assume row 1 is header row.\n\nApplication.ScreenUpdating = False\n\n    Dim arr As Variant\n    arr = r.Value\n\n    Dim newArr() As Variant\n    ReDim newArr(1 To UBound(arr), 1 To UBound(arr, 2))\n    Dim i As Long, j As Long, newCounter As Long\n    i = 1\n    newCounter = 1\n\n    Do\n        For j = 1 To UBound(arr, 2)\n            newArr(newCounter, j) = arr(i, j)\n        Next j\n\n        newCounter = newCounter + 1\n        i = i + 3\n    Loop While i &lt;= UBound(arr)\n\n    r.ClearContents\n    Sheet1.Range(\"A2\").Resize(newCounter - 1, UBound(arr, 2)).Value = newArr\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8565932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582c51501acc6b95e7652ab2b12908f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/8565932/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 46064360, "answer_count": 2, "score": 1, "last_activity_date": 1504656357, "creation_date": 1504651227, "last_edit_date": 1531161705, "question_id": 46064270, "link": "https://stackoverflow.com/questions/46064270/deleting-every-2nd-and-3rd-row-using-vba", "title": "Deleting every 2nd and 3rd row using VBA", "body": "<p>I am looking for insight on quickly removing two-thirds of a medium sized dataset. Currently, I am importing the space-delimited data into Excel from a text file, and I am using a loop to delete the data row by row. The loop starts on the bottom most row of the data and deletes rows going up. The data is chronologically ordered, and I can't simply chop off the first or last two thirds of the data. Essentially what is happening is the data is being over sampled and too many data points exists too close to one another. It is a painstakingly slow process, and I am just looking for another method.</p>\n\n<pre><code>Sub Delete()\n\nDim n As Long\n\nn = Application.WorksheetFunction.Count(Range(\"A:A\"))\n\nApplication.Calculation = xlCalculationManual\n\nDo While n &gt; 5\n\nn = n - 1\nRows(n).Delete\nn = n - 1\nRows(n).Delete\nn = n - 1\n\nLoop\n\n   Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "automation"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1504661681, "post_id": 46063997, "comment_id": 79091692, "body": "If these are &quot;real tables&quot;, the ListObject will provide the # of columns.  So just add one column to each ListObject, then copy from the next to last to the last column.  If these are not &quot;real tables&quot;, there are other ways to locate the table on a worksheet, depending on your data."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1504685636, "post_id": 46063997, "comment_id": 79100586, "body": "I agree with @RonRosenfeld that using tables/listobjects is worth exploring in your scenario, here&#39;s a nice introduction. <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/6/20/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user844705"}, "is_accepted": false, "score": 1, "last_activity_date": 1504650953, "last_edit_date": 1504650953, "creation_date": 1504650040, "answer_id": 46064105, "question_id": 46063997, "link": "https://stackoverflow.com/questions/46063997/need-vba-script-to-extend-excel-table-every-week/46064105#46064105", "title": "Need VBA script to extend Excel table every week", "body": "<p>You dont need VBA to do this. Use dynamic defined names and reference them in your formulas. For example, if you add a named range and add this in the refersTo dialog</p>\n\n<pre><code>=OFFSET($A$1,0,0,COUNTA($A:$A),COUNTA($1:$1)\n</code></pre>\n\n<p>your range will automatically expand from cell A1 (as long as there are no blank cells in column A or Row 1). You can then use that named range in your formulae.</p>\n\n<p>More here <a href=\"http://www.excel-easy.com/examples/dynamic-named-range.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/examples/dynamic-named-range.html</a></p>\n"}], "owner": {"reputation": 175, "user_id": 7507702, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CnRdM.png?s=128&g=1", "display_name": "Hasek", "link": "https://stackoverflow.com/users/7507702/hasek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504650953, "creation_date": 1504649226, "question_id": 46063997, "link": "https://stackoverflow.com/questions/46063997/need-vba-script-to-extend-excel-table-every-week", "title": "Need VBA script to extend Excel table every week", "body": "<p>The problem is as follows: I have several tables in Excel with given number of raws and dynamic number of columns (each week a new column should be added, currently I'm doing it manually). I want to automate it and create a script that will extend every raw range to the next column (namely the range from A2 to C2 should become from A2 to D2), and so on (such that running script N times will result in extending a table to N columns further). By \"extending\" I mean extending formulas, since each cell in my tables contains any formula. Is there any way to do it via VBA?</p>\n\n<p>I can't just record the corresponding macro because I have now idea how to specify that I don't want to link it with any specific range, but instead always extend just to one column right.</p>\n\n<p>Any help and examples will be very appreciative.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1504651309, "post_id": 46064117, "comment_id": 79089437, "body": "Ah, <code>.Parent</code> that&#39;s what I was looking for, thank you. Also, datasheet comes into play because I need that subform to load in datasheet view because that&#39;s how the client wants this form and I can&#39;t put a textbox into the subform without it either messing up datasheet view or the textbox not rendering fully like I need it to."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 1, "creation_date": 1504694687, "post_id": 46064117, "comment_id": 79106914, "body": "You are confusing me. Datasheet view implies that there are multiple records in the subform. What use is synchronizing a main form textbox with a whole column in the subform? Please clarify what you actually want to achieve. @MarkKramer"}, {"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1504725484, "post_id": 46064117, "comment_id": 79127442, "body": "In datasheet view you can only see the first line of a string but the client wants all of the lines in this field to be visible when you select the record, which means I need to link a textbox to the field and the client wants the textbox to be editable which is why I couldn&#39;t just set the field as the textbox&#39;s datasource."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1504728247, "last_edit_date": 1504728247, "creation_date": 1504650105, "answer_id": 46064117, "question_id": 46063909, "link": "https://stackoverflow.com/questions/46063909/how-to-reference-events-on-objects-in-a-subform-from-inside-the-main-form/46064117#46064117", "title": "How to reference events on objects in a subform from inside the main form", "body": "<p>Not sure I get the whole problem (how does datasheet view come into play?), but this should do what you want:</p>\n\n<p>(in the subform)</p>\n\n<pre><code>Private Sub Notes_AfterUpdate()\n    Me.Parent!Notes_Textbox.Value = Me![Notes].Value\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Edit from comment: By far the easiest solution would be a continuous form instead of a datasheet in a subform.</p>\n\n<p>You can have two textboxes, a one-liner in the Details section, and a large one in the form header or footer. Both have the same control source and are automatically updated when the other one is edited. No code required.</p>\n\n<p>If it must be a subform-datasheet, you can use a similar approach: bind the main form to the same recordsource, and in <code>On Current</code> of the subform, move the main form to the same current record.</p>\n"}], "owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 46064117, "answer_count": 1, "score": 1, "last_activity_date": 1504728247, "creation_date": 1504648669, "question_id": 46063909, "link": "https://stackoverflow.com/questions/46063909/how-to-reference-events-on-objects-in-a-subform-from-inside-the-main-form", "title": "How to reference events on objects in a subform from inside the main form", "body": "<p>Imagine a form that, for demontration purposes, contains only a subform and a textbox that need to mirror each other.</p>\n\n<p>I tried to accomplish this by setting the <strong>Control Source</strong> on the textbox to the value of the field in the subform and this worked to make them mirror each other, but the textbox isn't editable so this is an unsuitable solution.</p>\n\n<p>The next thing I decided to try was using the <strong>AfterUpdate</strong> event on both controls to run code that sets the value of the other control.</p>\n\n<p>This is easy for the textbox:</p>\n\n<pre><code>'Set value of Notes field on subform whenever value of the corresponding textbox \nPrivate Sub Notes_Textbox_AfterUpdate()\n    Me.subform.Form![Notes] = Me.Notes_Textbox.Text\nEnd Sub\n</code></pre>\n\n<p>However, this isn't as simple for the subform field. I don't know how to reference an event on a field in a subform in a way that will still allow me to reference controls outside that subform.</p>\n\n<p>As a demonstration, I need a way to do this:</p>\n\n<pre><code>Private Sub subform_Notes_AfterUpdate()\n    Me.Notes_Textbox.Text = Me.subform.Form![Notes]\nEnd Sub\n</code></pre>\n\n<p>I can access the subform fields AfterUpdate event within the scope of the subform but if I do that, then I can't access the Textbox because it is in the main form, not the subform.</p>\n\n<p>So I either need a way to define an event function on a field in a subform from within the scope of the main form, or a way to make the textbox part of the subform while maintaining the subforms ability to open in datasheet view.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504648582, "post_id": 46063772, "comment_id": 79088646, "body": "What sort of numbers are they?  If they were all less than 16,777,216 then you could assign the RGB code based on the number itself rather than selecting a random (and potentially non-unique) value."}, {"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504649568, "post_id": 46063772, "comment_id": 79088968, "body": "They&#39;re phone numbers, so that wont work unfortunately. e.g. 6427XXXXXXX"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504651107, "post_id": 46063772, "comment_id": 79089389, "body": "If only the last 7 digits change, that is less than 16,777,216.  (Or, even if the leading digits did change, if you were happy to have a 1 in 10 million chance of non-unique colours, just take the number mod 10000000 and use that.)"}, {"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504651375, "post_id": 46063772, "comment_id": 79089466, "body": "I am thinking of somehow converting the last digits in the phone number to a hex or RGB code, as this is the last few digits of a phone number, these are likely to be unique, also the variable within the equation will be the same, meaning that each number will get the same colour which is what I want, I will post what I come up with"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504651416, "post_id": 46063772, "comment_id": 79089479, "body": "Can the same number appear more than once in the same column?"}, {"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504651520, "post_id": 46063772, "comment_id": 79089502, "body": "Yes, the sheet shows a conversation between phone numbers, so assigning each phone number a unique colour will make the data easier to read."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504652088, "post_id": 46063772, "comment_id": 79089643, "body": "Just remember that an RGB code is simply a number between 0 and 16777215.  There&#39;s no real conversion necessary, except to make two colours visibly distinguishable from each other (e.g. <code>target.Interior.Color = 12345678</code> is going to be hard to distinguish from <code>target.Interior.Color = 12345679</code> - they both look very bluish)."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504652650, "post_id": 46064338, "comment_id": 79089791, "body": "Hi, thank you so much.   There is about a 1 in 8,000,000 chance of getting the same colour, and there aren&#39;t a lot of unique numbers that appear on the same page. I was thinking that in the event of a duplicate colour being generated, the sheet could just be re-generated from the raw data so this is not a problem."}], "tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": false, "score": 0, "last_activity_date": 1504651615, "creation_date": 1504651615, "answer_id": 46064338, "question_id": 46063772, "link": "https://stackoverflow.com/questions/46063772/assigning-colours-to-each-instance-of-a-value/46064338#46064338", "title": "Assigning Colours to each Instance of a value", "body": "<p>I think you just have things backwards.  You are using the match function on the same column you are editing when you should be using the match function on the other column.  You are also resizing the range on the same column which could have more or less rows than your other column which could limit the range to find an exact match on the opposite column.</p>\n\n<p>I changed you code just a little and I got it to work.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\nSet wf = Application.WorksheetFunction\nIf target.Cells.Count = 1 Then\n    If target.Column = 5 Then\n    x = 0\n    On Error Resume Next\n    x = wf.Match(target.Value, _\n        Range(\"C1:C\" &amp; [C3000].End(xlUp).Row), 0)\n    On Error GoTo 0\n    If x &gt; 0 Then\n        target.Interior.Color = Cells(x, 3).Interior.Color\n        Else\n            target.Interior.Color = RGB( _\n                wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\n        End If\n    End If\nEnd If\n\nIf target.Cells.Count = 1 Then\n    If target.Column = 3 Then\n    x = 0\n    On Error Resume Next\n    x = wf.Match(target.Value, _\n        Range(\"E1:E\" &amp; [E3000].End(xlUp).Row), 0)\n    On Error GoTo 0\n\n    If x &gt; 0 Then\n        target.Interior.Color = Cells(x, 5).Interior.Color\n        Else\n            target.Interior.Color = RGB( _\n                wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I just switched the target.Column = # and the range reference in each loop to look at the opposite column.  One last thing to note there is a slim possibility of getting the same color on a different number using the randomization.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504655099, "post_id": 46064675, "comment_id": 79090382, "body": "This goes in the worksheet module, Is there a way to add this programatically to a newly generated sheet?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504655742, "post_id": 46064675, "comment_id": 79090511, "body": "@ohnoohdear There are ways, but using VBA to write VBA is beyond the scope of this question.  (And probably beyond my skills to answer!)  So it would be better to ask that in another question so that it gets the attention it deserves."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "edited": false, "score": 0, "creation_date": 1504670035, "post_id": 46064675, "comment_id": 79093609, "body": "@ohnoohdear, do post the second question. There&#39;s an easy solution using Application events."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1504655015, "last_edit_date": 1504655015, "creation_date": 1504654297, "answer_id": 46064675, "question_id": 46063772, "link": "https://stackoverflow.com/questions/46063772/assigning-colours-to-each-instance-of-a-value/46064675#46064675", "title": "Assigning Colours to each Instance of a value", "body": "<p>The following <code>Change</code> event will set the colour of any <strong>new</strong> value entered into either column C or E, utilising the <code>FindColour</code> function to obtain the existing colour for that value anywhere else in column C or E (not necessarily only in rows above it).</p>\n\n<p>The <code>ResetThem</code> subroutine clears out all formatting on columns C and E and then resets the colours starting from scratch.  (Useful if you already have data in those columns which hasn't yet been coloured.)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Cells.Count = 1 Then\n        If Target.Column = 3 Or Target.Column = 5 Then\n            Target.Interior.Color = FindColour(Target.Value)\n        End If\n    End If\nEnd Sub\n\nFunction FindColour(v As Variant) As Long\n    Set wf = Application.WorksheetFunction\n    On Error Resume Next\n    x = 0\n    'See if value exists in column C\n    x = wf.Match(v, Range(\"C:C\"), 0)\n    If x &gt; 0 Then\n        If Cells(x, \"C\").Interior.Color &lt;&gt; vbWhite Then\n            FindColour = Cells(x, \"C\").Interior.Color\n            Exit Function\n        End If\n    End If\n    'See if value exists in column E\n    x = wf.Match(v, Range(\"E:E\"), 0)\n    If x &gt; 0 Then\n        If Cells(x, \"E\").Interior.Color &lt;&gt; vbWhite Then\n            FindColour = Cells(x, \"E\").Interior.Color\n            Exit Function\n        End If\n    End If\n    'Assign a random colour\n    FindColour = RGB(wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\nEnd Function\n\nSub ResetThem()\n    With Columns(\"C\").Interior\n        .Pattern = xlNone\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With Columns(\"E\").Interior\n        .Pattern = xlNone\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    Dim r As Long\n    'Starting at row 2 to avoid assigning a colour to headings\n    ' (change \"2\" to \"1\", or some other number, as appropriate)\n    For r = 2 To Cells(Rows.Count, \"C\").End(xlUp).Row\n        If Not IsEmpty(Cells(r, \"C\").Value) Then\n            Cells(r, \"C\").Interior.Color = FindColour(Cells(r, \"C\").Value)\n        End If\n    Next r\n    For r = 2 To Cells(Rows.Count, \"E\").End(xlUp).Row\n        If Not IsEmpty(Cells(r, \"E\").Value) Then\n            Cells(r, \"E\").Interior.Color = FindColour(Cells(r, \"E\").Value)\n        End If\n    Next r\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>One potential problem is that, if a value is entered into a cell when that same value already exists in a cell below it in the same column but doesn't exist in the other column, a new colour will be assigned.  There are ways around that issue, but I'm not sure whether it will occur in your situation, so I haven't catered for it.</p>\n"}], "owner": {"reputation": 27, "user_id": 8561338, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/771e0a5792cda8906280794294f280a6?s=128&d=identicon&r=PG&f=1", "display_name": "oh no oh dear", "link": "https://stackoverflow.com/users/8561338/oh-no-oh-dear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 46064675, "answer_count": 2, "score": 0, "last_activity_date": 1504655015, "creation_date": 1504647839, "question_id": 46063772, "link": "https://stackoverflow.com/questions/46063772/assigning-colours-to-each-instance-of-a-value", "title": "Assigning Colours to each Instance of a value", "body": "<p>I am trying to make a program in which there are two sets of numbers in two set columns, like sender and receiver numbers. I want to assign each instance of a value a colour that is unique to that number. However if a sender number is in the receiver column and vice versa, the two should have the same colour between the two columns.</p>\n\n<p>I have this so far which works within one column. I have tried playing with the column variables:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\nSet wf = Application.WorksheetFunctio\nIf target.Cells.Count = 1 Then\n    If target.Column = 3 Then\n    x = 0\n    On Error Resume Next\n    x = wf.Match(target.Value, _\n        Range(\"C1\").Resize(target.Row - 1), 0)\n    On Error GoTo 0\n    If x &gt; 0 Then\n        target.Interior.Color = Cells(x, 3).Interior.Color\n        Else\n            target.Interior.Color = RGB( _\n                wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\n        End If\n    End If\nEnd If\n\nIf target.Cells.Count = 1 Then\n    If target.Column = 5 Then\n    x = 0\n    On Error Resume Next\n    x = wf.Match(target.Value, _\n        Range(\"e1\").Resize(target.Row - 1), 0)\n    On Error GoTo 0\n\n    If x &gt; 0 Then\n        target.Interior.Color = Cells(x, 5).Interior.Color\n        Else\n            target.Interior.Color = RGB( _\n                wf.RandBetween(125, 255), wf.RandBetween(125, 255), wf.RandBetween(125, 255))\n        End If\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1504647313, "post_id": 46063583, "comment_id": 79088172, "body": "Show us what you already tried. And try to do it step by step. Dozens of similar questions have been asked before, so there is plenty of code around to help you get started."}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1504730963, "creation_date": 1504730963, "answer_id": 46084116, "question_id": 46063583, "link": "https://stackoverflow.com/questions/46063583/export-excel-sheets-and-send-them-as-emails-loop/46084116#46084116", "title": "Export Excel sheets and send them as emails (Loop)", "body": "<p>here is some code to get you started</p>\n\n<p>it loops through all the cells on all the rows</p>\n\n<p>just add routines to create emails, do attachments, save files, etc.</p>\n\n<pre><code>Option Explicit\n\nSub exportIntoEmails()\n\n    Dim rng As Range\n\n    For Each rng In Range(\"a1:a20\")\n\n        Debug.Print \"file\", rng.Columns(\"b\").Value\n        Debug.Print \"folder\", rng.Columns(\"d\").Value\n        Debug.Print \"filename\", rng.Columns(\"e\").Value\n        Debug.Print \"subject\", rng.Columns(\"f\").Value\n        Debug.Print \"dist. list\", rng.Columns(\"g\").Hyperlinks(1).Address\n        Debug.Print \"cc list\", Replace(rng.Columns(\"h\").Hyperlinks(1).Address, \"mailto:\", \"\")\n        Debug.Print \"email body\", rng.Columns(\"i\").Value\n\n        Dim aaa As Range\n        For Each aaa In rng.Columns(\"j\").Resize(1, 2)\n            Debug.Print \"attach\", aaa.Value\n        Next aaa\n\n    Next rng\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8565747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NMifJWSEyvo/AAAAAAAAAAI/AAAAAAAAAB8/ESwiaykcOVA/photo.jpg?sz=128", "display_name": "Alexander Gavrailov", "link": "https://stackoverflow.com/users/8565747/alexander-gavrailov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504730963, "creation_date": 1504646791, "last_edit_date": 1504649027, "question_id": 46063583, "link": "https://stackoverflow.com/questions/46063583/export-excel-sheets-and-send-them-as-emails-loop", "title": "Export Excel sheets and send them as emails (Loop)", "body": "<p><a href=\"https://i.stack.imgur.com/pYVB8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pYVB8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm trying to automate a report production and distribution process. What I need to do is create a macro that goes through the list (1 to 20) and for each row creates a new file (separate Excel file), pastes 2 tabs from the current one (sheet names are in columns J and K) and saves it under the filename in column E. Then the macro should open Outlook and create an email by attaching the file and using the subject, distribution list, email body as shown in the table. </p>\n\n<p>I'd highly appreciate any help as I've been bumping my head with this for a while.</p>\n\n<hr>\n\n<p>I'm aware that similar questions have been asked before. I've tried to combine code that addresses different parts of this process. So far I have the following:</p>\n\n<pre><code>enter code here\nSub Create_Files()\n\nDim MyDateStr As String\nDim wkbCurrent As Workbook\nDim wkbtemp As Workbook\nDim wkbtemp2 As Workbook\nDim MyLocation As String\nDim SheetName As String\n\nSet wkbCurrent = ActiveWorkbook\nMyDateStr = wkbCurrent.Sheets(\"Control\").Range(\"F12\")\n\nChDir \"W:\\Finance Analysis\\Contsys2\\DATA\\aacorpfinance\\_yr 2017\\Expense    reports\\\"\n  If Len(Dir(MyDateStr, vbDirectory)) = 0 Then\n    MkDir (MyDateStr)\nEnd If\n\nMyLocation = \"W:\\Finance Analysis\\Contsys2\\DATA\\aacorpfinance\\_yr 2017\\Expense reports\\\"\n\n SheetName = wkbCurrent.Sheets(\"Emails\").Range(\"C2\")\n\n Set wkbtemp = Workbooks.Add\n\n wkbCurrent.Sheets(SheetName).Cells.Select\n\n\n With wkbtemp\n wkbtemp.Sheets(\"Sheet1\").Range(\"A1\").PasteSpecial\n\n\n\n wkbCurrent.Sheets(\"M &amp; A\").Copy\n wkbtemp2.Sheets(\"Sheet2\").Range(\"A1\").Select\n ActiveSheet.PasteSpecial Paste:=xlValues\n\n Set wkbtemp = Sheets.Add(After:=Sheets(Sheets.Count))\n\n End Sub\n</code></pre>\n\n<p>I haven't reached the loop and emails part but I have some code that I found elsewhere that I am trying to use as a basis.</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8155946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad22f254c66ce1e192d39395ae958008?s=128&d=identicon&r=PG&f=1", "display_name": "arod23", "link": "https://stackoverflow.com/users/8155946/arod23"}, "edited": false, "score": 0, "creation_date": 1504708376, "post_id": 46070513, "comment_id": 79117149, "body": "Thank you Tim that was very helpful.  For anyone else who runs across the same problem, the value is 164 and the code is msoShapeMathMinus"}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1504687138, "creation_date": 1504687138, "answer_id": 46070513, "question_id": 46063569, "link": "https://stackoverflow.com/questions/46063569/adding-a-minus-sign-symbol-in-powerpoint-vba/46070513#46070513", "title": "Adding a minus sign symbol in PowerPoint VBA", "body": "<p>The list you reference is for Office 2003. If that is what you're working with then those are the only AutoShape types available.</p>\n\n<p>If you are working with a more recent version I suggest you look for the reference pages on MSDN for the version of Office that you are working with.</p>\n\n<p>If you add a shape to a slide and select it you can always find the value of MsoAutoShapeType by querying it in the Immediate Window</p>\n\n<pre><code>?ActiveWindow.Selection.ShapeRange.AutoShapeType\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8155946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad22f254c66ce1e192d39395ae958008?s=128&d=identicon&r=PG&f=1", "display_name": "arod23", "link": "https://stackoverflow.com/users/8155946/arod23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593730184, "creation_date": 1504646716, "last_edit_date": 1593730184, "question_id": 46063569, "link": "https://stackoverflow.com/questions/46063569/adding-a-minus-sign-symbol-in-powerpoint-vba", "title": "Adding a minus sign symbol in PowerPoint VBA", "body": "<p>Does anyone know how to add a minus sign symbol into a PowerPoint slide using VBA? I have been referencing this chart <a href=\"https://msdn.microsoft.com/en-us/library/office/aa211643(v=office.11).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa211643(v=office.11).aspx</a> but don't see the minus symbol listed.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8565715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6d4e39f109bc6bcaad8066e3c3a51c?s=128&d=identicon&r=PG&f=1", "display_name": "ooolongT", "link": "https://stackoverflow.com/users/8565715/ooolongt"}, "edited": false, "score": 0, "creation_date": 1504719350, "post_id": 46063458, "comment_id": 79124130, "body": "I really need to get hip to SUMPRODUCT... thank you, Scott!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 8565715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6d4e39f109bc6bcaad8066e3c3a51c?s=128&d=identicon&r=PG&f=1", "display_name": "ooolongT", "link": "https://stackoverflow.com/users/8565715/ooolongt"}, "edited": false, "score": 0, "creation_date": 1504719481, "post_id": 46063458, "comment_id": 79124193, "body": "@ooolongT if this worked for you please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1504646143, "creation_date": 1504646143, "answer_id": 46063458, "question_id": 46063389, "link": "https://stackoverflow.com/questions/46063389/summing-the-amount-over-a-specific-value-in-a-pivot-table/46063458#46063458", "title": "Summing the amount over a specific value in a pivot table", "body": "<p>Use SUMPRODUCT()</p>\n\n<pre><code>=SUMPRODUCT((A1:A5&gt;40)*(A1:A5-40))\n</code></pre>\n\n<p>Where <code>A1:A5</code> is the range of the column in your pivot table.</p>\n"}], "owner": {"reputation": 1, "user_id": 8565715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f6d4e39f109bc6bcaad8066e3c3a51c?s=128&d=identicon&r=PG&f=1", "display_name": "ooolongT", "link": "https://stackoverflow.com/users/8565715/ooolongt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504646143, "creation_date": 1504645834, "last_edit_date": 1504645873, "question_id": 46063389, "link": "https://stackoverflow.com/questions/46063389/summing-the-amount-over-a-specific-value-in-a-pivot-table", "title": "Summing the amount over a specific value in a pivot table", "body": "<p>I have some data in a pivot table and I am trying to figure out how to sum each number over 40 in a pivot table column, but only the amount over 40:</p>\n\n<pre><code>40\n41\n42\n39\n38\n</code></pre>\n\n<p>The above should yield 3  because there are two numbers over 40 (41, 42), and total amount over 40 is 3.</p>\n\n<p>I have not been able to figure out how to do it formulaically, so I am resigned to VBA if necessary. </p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "date", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1504646891, "post_id": 46063381, "comment_id": 79087996, "body": "DD/MM/YYYY is international format and is not Access standard which is MM/DD/YYYY. Review <a href=\"http://allenbrowne.com/ser-36.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-36.html</a>. Using dd in the Format function forces the placeholder 0 so it formats as 06, not 6. I am surprised the Format function works at all without the format mask in quote marks."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1504647262, "post_id": 46063381, "comment_id": 79088150, "body": "Result of Format function is a string, not a date value. I just re-read the question. Very odd. The formatted date should match to 06/09/2017, not 6/09/2017."}, {"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1504647838, "post_id": 46063381, "comment_id": 79088378, "body": "@June7 oh my bad it did have quotes when i ran it but i just rewrote it hastily from the CDate one to show what i had tried when i copied it into the question"}, {"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1504647945, "post_id": 46063381, "comment_id": 79088411, "body": "Im in New Zealand which is outside of the U.S. so my regional setting is New Zealand and the default date format is dd/mm/yyyy, not sure if it effects this at all but im stating it just in case"}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "is_accepted": true, "score": 0, "last_activity_date": 1504650145, "creation_date": 1504650145, "answer_id": 46064126, "question_id": 46063381, "link": "https://stackoverflow.com/questions/46063381/access-vba-find-date-not-working-for-single-digit-days/46064126#46064126", "title": "access vba find date not working for single digit days", "body": "<p>found a solution<br>\ni just check if a 0 is added from the format function and remove the 0 if it is added</p>\n\n<pre><code>dataDate = Format(Me.RejectDatetb, \"dd/mm/yyyy\")\nIf Left(dataDate, 1) = \"0\" Then\n    dataDate = Right(dataDate, Len(dataDate) - 1)\nEnd If\ncolNo = .Cells.Find(What:=dataDate, After:=.Cells(1, 1), LookIn:=(-4123), SearchOrder:=2, SearchDirection:=1, MatchCase:=False).Column\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 46064126, "answer_count": 1, "score": -1, "last_activity_date": 1504650145, "creation_date": 1504645785, "question_id": 46063381, "link": "https://stackoverflow.com/questions/46063381/access-vba-find-date-not-working-for-single-digit-days", "title": "access vba find date not working for single digit days", "body": "<p>I am trying to copy data from an access database to an excel spread sheet  </p>\n\n<p>first i need to find the right column by searching for a date, this works fine for dates where the day has 2 digits ie 16/09/2017 but for dates with a single digit day 6/09/2017 it cannot find the date   </p>\n\n<p>in excel i tried to do a find with 6/09/2017 and it found it fine but it couldn't find 06/09/2017  </p>\n\n<p>my field in access shows as 6/09/2017 so i am not sure where the problem is, code i have tried below (all with the same result)</p>\n\n<pre><code>colNo = .Cells.Find(What:=Format(Me.RejectDate,dd/mm/yyyy), After:=.Cells(1, 1), LookIn:=(-4123), SearchOrder:=2, SearchDirection:=1, MatchCase:=False).Column\n\ncolNo = .Cells.Find(What:=CDate(Me.RejectDate), After:=.Cells(1, 1), LookIn:=(-4123), SearchOrder:=2, SearchDirection:=1, MatchCase:=False).Column\n\ncolNo = .Cells.Find(What:=Me.RejectDate, After:=.Cells(1, 1), LookIn:=(-4123), SearchOrder:=2, SearchDirection:=1, MatchCase:=False).Column\n</code></pre>\n\n<p>is the 0 being added automatically? if so why? and how do i stop it?<br>\nor is something else the problem?</p>\n"}, {"tags": ["xml", "ms-access", "vbscript", "vba", "jpeg2000"], "comments": [{"owner": {"reputation": 41, "user_id": 3895539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5d34a31bb30bc218f7dd6224201d3ff?s=128&d=identicon&r=PG&f=1", "display_name": "spudchick", "link": "https://stackoverflow.com/users/3895539/spudchick"}, "edited": false, "score": 0, "creation_date": 1504646410, "post_id": 46063335, "comment_id": 79087800, "body": "Correction: I need the original parent document path, including name ((ABSOLUTEPATH)."}, {"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1504678948, "post_id": 46063335, "comment_id": 79096572, "body": "i.e, you want this calue &quot;I:\\Processing_Unit\\L145\\Box127\\L145Y1921I001S0005.tif&quot; from the xml you posted?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504697061, "post_id": 46063335, "comment_id": 79108539, "body": "The real problem is outlined in <a href=\"https://stackoverflow.com/questions/44220571/read-jpeg2000-metadata\">this question</a>: there is still no way to read the metadata through an open-source command-line application."}, {"owner": {"reputation": 41, "user_id": 3895539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5d34a31bb30bc218f7dd6224201d3ff?s=128&d=identicon&r=PG&f=1", "display_name": "spudchick", "link": "https://stackoverflow.com/users/3895539/spudchick"}, "reply_to_user": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1504708412, "post_id": 46063335, "comment_id": 79117180, "body": "@Kira yes, that&#39;s what I&#39;m after."}, {"owner": {"reputation": 41, "user_id": 3895539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5d34a31bb30bc218f7dd6224201d3ff?s=128&d=identicon&r=PG&f=1", "display_name": "spudchick", "link": "https://stackoverflow.com/users/3895539/spudchick"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504708419, "post_id": 46063335, "comment_id": 79117187, "body": "@Erik  I hope that isn&#39;t true, but I can buy something that can be integrated this way if not too costly."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504710581, "post_id": 46063335, "comment_id": 79118850, "body": "@spudchick if it isn&#39;t, you could answer the question I&#39;ve linked to. <a href=\"http://kakadusoftware.com/\" rel=\"nofollow noreferrer\">Kakadu</a> might have a tool, but they&#39;re commercial, and their 6 month evaluation version already costs $500"}], "owner": {"reputation": 41, "user_id": 3895539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5d34a31bb30bc218f7dd6224201d3ff?s=128&d=identicon&r=PG&f=1", "display_name": "spudchick", "link": "https://stackoverflow.com/users/3895539/spudchick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1594639165, "creation_date": 1504645535, "last_edit_date": 1594639165, "question_id": 46063335, "link": "https://stackoverflow.com/questions/46063335/extract-xml-metadata-column-from-jpeg2000-images-using-vbscript-vba", "title": "extract XML metadata/column from jpeg2000 images using vbscript/VBA", "body": "<p>I have routines that collect and analyze file/folder data in relation to database content--system has been in place and working well for many years. These routines use vbscript/AccessVBA to collect file information and prepare/load records to a SQL server db.  I'm not currently storing the filestreams in SQL server, just their paths and data about the files.  Now I need to extract XML metadata from some of these files, which I haven't had to work with.</p>\n\n<p>The files are JPEG2000 derived from TIFFs.  They are generated via batch and metadata from the original TIFFs is added to the JP2s. I can see the XML using JP2 Meta Editor: </p>\n\n<p><a href=\"https://i.stack.imgur.com/wqNNR.png\" rel=\"nofollow noreferrer\">j2k tool</a></p>\n\n<p>The XML looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Originating Facility --&gt;\n&lt;TIFF&gt;\n   &lt;METADATA&gt;\n      &lt;FILENAME&gt;L145Y1921I001S0005.tif&lt;/FILENAME&gt;\n      &lt;SEPARATOR&gt;\\&lt;/SEPARATOR&gt;\n      &lt;PARENT&gt;I:\\Processing_Unit\\L145\\Box127&lt;/PARENT&gt;\n      &lt;CANONICALPATH&gt;I:\\Processing_Unit\\L145\\Box127\\L145Y1921I001S0005.tif&lt;/CANONICALPATH&gt;\n      &lt;ABSOLUTEPATH&gt;I:\\Processing_Unit\\L145\\Box127\\L145Y1921I001S0005.tif&lt;/ABSOLUTEPATH&gt;\n      &lt;PATH&gt;I:\\Processing_Unit\\L145\\Box127\\L145Y1921I001S0005.tif&lt;/PATH&gt;\n      &lt;FILE&gt;true&lt;/FILE&gt;\n      &lt;DIRECTORY&gt;false&lt;/DIRECTORY&gt;\n      &lt;FILELENGTH&gt;18462952&lt;/FILELENGTH&gt;\n      &lt;HIDDEN&gt;false&lt;/HIDDEN&gt;\n      &lt;ABSOLUTE&gt;true&lt;/ABSOLUTE&gt;\n      &lt;URL&gt;file:/I:/Processing_Unit/L145/Box127/L145Y1921I001S0005.tif&lt;/URL&gt;\n      &lt;URI&gt;file:/I:/Processing_Unit/L145/Box127/L145Y1921I001S0005.tif&lt;/URI&gt;\n      &lt;READ&gt;true&lt;/READ&gt;\n      &lt;WRITE&gt;true&lt;/WRITE&gt;\n      &lt;EXTENSION&gt;tif&lt;/EXTENSION&gt;\n      &lt;MODIFIED&gt;2009-04-02 11:17:31&lt;/MODIFIED&gt;\n      &lt;DATE&gt;20090402&lt;/DATE&gt;\n      &lt;DATEPATTERN&gt;yyyyMMdd&lt;/DATEPATTERN&gt;\n      &lt;TIME&gt;111731987&lt;/TIME&gt;\n      &lt;TIMEPATTERN&gt;HHmmssSSS&lt;/TIMEPATTERN&gt;\n      &lt;TYPE&gt;image/tiff&lt;/TYPE&gt;\n      &lt;PID&gt;null&lt;/PID&gt;\n      &lt;OID&gt;null&lt;/OID&gt;\n      &lt;FID&gt;null&lt;/FID&gt;\n      &lt;PROCESSOR&gt;unknown&lt;/PROCESSOR&gt;\n   &lt;/METADATA&gt;\n   &lt;HEADER&gt;\n      &lt;LITTLEENDIAN&gt;true&lt;/LITTLEENDIAN&gt;\n      &lt;VERSION&gt;1.0&lt;/VERSION&gt;\n   &lt;/HEADER&gt;\n   &lt;IMAGEFILEDIRECTORY&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;NewSubfileType&lt;/NAME&gt;\n         &lt;TAG&gt;254&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;4&lt;/TYPE&gt;\n         &lt;VALUE&gt;0&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;ImageWidth&lt;/NAME&gt;\n         &lt;TAG&gt;256&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;2705&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;ImageLength&lt;/NAME&gt;\n         &lt;TAG&gt;257&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;2275&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;BitsPerSample&lt;/NAME&gt;\n         &lt;TAG&gt;258&lt;/TAG&gt;\n         &lt;LENGTH&gt;3&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;8&lt;/VALUE&gt;\n         &lt;VALUE&gt;8&lt;/VALUE&gt;\n         &lt;VALUE&gt;8&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Compression&lt;/NAME&gt;\n         &lt;TAG&gt;259&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;1&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;PhotometricInterpretation&lt;/NAME&gt;\n         &lt;TAG&gt;262&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;2&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;DocumentName&lt;/NAME&gt;\n         &lt;TAG&gt;269&lt;/TAG&gt;\n         &lt;LENGTH&gt;22&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;L145Y1921I001S0005.tif&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;ImageDescription&lt;/NAME&gt;\n         &lt;TAG&gt;270&lt;/TAG&gt;\n         &lt;LENGTH&gt;6&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;paper&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Make&lt;/NAME&gt;\n         &lt;TAG&gt;271&lt;/TAG&gt;\n         &lt;LENGTH&gt;10&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;Phase One&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Model&lt;/NAME&gt;\n         &lt;TAG&gt;272&lt;/TAG&gt;\n         &lt;LENGTH&gt;6&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;P 30+&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Orientation&lt;/NAME&gt;\n         &lt;TAG&gt;274&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;1&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;SamplesPerPixel&lt;/NAME&gt;\n         &lt;TAG&gt;277&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;3&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;RowsPerStrip&lt;/NAME&gt;\n         &lt;TAG&gt;278&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;2275&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;XResolution&lt;/NAME&gt;\n         &lt;TAG&gt;282&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;5&lt;/TYPE&gt;\n         &lt;VALUE&gt;300.0&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;YResolution&lt;/NAME&gt;\n         &lt;TAG&gt;283&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;5&lt;/TYPE&gt;\n         &lt;VALUE&gt;300.0&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;PlanarConfiguration&lt;/NAME&gt;\n         &lt;TAG&gt;284&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;1&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;ResolutionUnit&lt;/NAME&gt;\n         &lt;TAG&gt;296&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;3&lt;/TYPE&gt;\n         &lt;VALUE&gt;2&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Software&lt;/NAME&gt;\n         &lt;TAG&gt;305&lt;/TAG&gt;\n         &lt;LENGTH&gt;51&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;Capture One 4 Windows; Adobe Photoshop CS3 Windows&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;DateTime&lt;/NAME&gt;\n         &lt;TAG&gt;306&lt;/TAG&gt;\n         &lt;LENGTH&gt;20&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;2009:03:26 11:23:36&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Artist&lt;/NAME&gt;\n         &lt;TAG&gt;315&lt;/TAG&gt;\n         &lt;LENGTH&gt;33&lt;/LENGTH&gt;\n         &lt;TYPE&gt;2&lt;/TYPE&gt;\n         &lt;VALUE&gt;Preservation Center&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Custom&lt;/NAME&gt;\n         &lt;TAG&gt;34665&lt;/TAG&gt;\n         &lt;LENGTH&gt;1&lt;/LENGTH&gt;\n         &lt;TYPE&gt;4&lt;/TYPE&gt;\n         &lt;VALUE&gt;null&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n      &lt;ELEMENT&gt;\n         &lt;NAME&gt;Custom&lt;/NAME&gt;\n         &lt;TAG&gt;34675&lt;/TAG&gt;\n         &lt;LENGTH&gt;560&lt;/LENGTH&gt;\n         &lt;TYPE&gt;7&lt;/TYPE&gt;\n         &lt;VALUE&gt;null&lt;/VALUE&gt;\n      &lt;/ELEMENT&gt;\n   &lt;/IMAGEFILEDIRECTORY&gt;\n&lt;/TIFF&gt;\n</code></pre>\n\n<p>I need to extract the original document name--the parent TIFF name--from each of these JP2 files. </p>\n\n<p>Is there a straightforward way to incorporate this into the existing file collection routine, using VBA/VBscript?  I will need to be able to process hundreds of thousands of existing file records to get this new additional value, as well as including this extraction in folder scans going forward. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504647610, "post_id": 46063238, "comment_id": 79088294, "body": "Show us what you tried"}, {"owner": {"reputation": 49, "user_id": 8516081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10214154429551740/picture?type=large", "display_name": "Jigar Rathod", "link": "https://stackoverflow.com/users/8516081/jigar-rathod"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504651328, "post_id": 46063238, "comment_id": 79089448, "body": "on TextAge_exit i tried to use a left function with in if condition  - if left(textage.text,2) &gt;=58 then CheckPEN.value = False it gave me run time or compile error i guess. Can&#39;t share the code of what i tried initially as have deleted it"}, {"owner": {"reputation": 49, "user_id": 8516081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10214154429551740/picture?type=large", "display_name": "Jigar Rathod", "link": "https://stackoverflow.com/users/8516081/jigar-rathod"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1504656611, "post_id": 46063238, "comment_id": 79090679, "body": "Never mind its working fine now. I was running the code on TextAge_Error instead of exit."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 8516081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10214154429551740/picture?type=large", "display_name": "Jigar Rathod", "link": "https://stackoverflow.com/users/8516081/jigar-rathod"}, "is_accepted": true, "score": 0, "last_activity_date": 1504656740, "creation_date": 1504656740, "answer_id": 46064962, "question_id": 46063238, "link": "https://stackoverflow.com/questions/46063238/textbox-value-to-disable-a-checkbox-based-on-condition/46064962#46064962", "title": "textbox value to disable a checkbox based on condition", "body": "<pre><code>Private Sub TextAge_Exit(ByVal Cancel As MSForms.ReturnBoolean)\nIf Left(Me.TextAge.value, 2) &gt;= 58 Then\n    Me.CheckPEN.value = False\n    CheckPEN.Enabled = False\nElse:\n    CheckPEN.Enabled = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8516081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10214154429551740/picture?type=large", "display_name": "Jigar Rathod", "link": "https://stackoverflow.com/users/8516081/jigar-rathod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 46064962, "answer_count": 1, "score": 0, "last_activity_date": 1504656740, "creation_date": 1504644982, "last_edit_date": 1531161705, "question_id": 46063238, "link": "https://stackoverflow.com/questions/46063238/textbox-value-to-disable-a-checkbox-based-on-condition", "title": "textbox value to disable a checkbox based on condition", "body": "<p>I'm actually familiar with how to disable a textbox or checkbox but what im looking here is that a textbox of age that is automatically calculated based on DOB. See below code :</p>\n\n<pre><code>Private Sub TextDOB_Exit(ByVal Cancel As MSForms.ReturnBoolean)\nIf IsDate(Me.TextDOB.value) Then\nMe.TextAge.value _\n= Age(CDate(Me.TextDOB.value), Date)\nElse\nMe.TextAge.value = \"Invalid entry\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>the results of the above code is such \"27 yrs 9 months\"\nNow further on basis of this i have to disable a check box for pension only if the employee age is greater than 58.</p>\n\n<p>Can i use the left function which we have in excel in a userform? tried something but didnt work out well. Please help</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1504645049, "post_id": 46063211, "comment_id": 79087273, "body": "Please show the IF formula with the multiple criteria Index/Match.  A single IndexMatch is not an array formula and thus does not need the CSE, but the multiple does require the CSE."}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504650192, "post_id": 46063211, "comment_id": 79089143, "body": "Hi @ScottCraner. I updated the original post with the additional information."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1504651544, "post_id": 46063211, "comment_id": 79089505, "body": "indirect raises a warning flag...is the address that indirect is dealing with in the same workbook or a workbook that is already opened?  if the answer is yes, then nothing to worry about.  if the answer is no, that may be the issue"}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1504652127, "post_id": 46063211, "comment_id": 79089658, "body": "@ForwardEd Yes. In the same sheet actually. I couldn&#39;t find a better way of referencing the 1st row in the column since I&#39;m running this formula through a macro (eventually)"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1504655012, "post_id": 46063211, "comment_id": 79090358, "body": "<code>ROW(A$1)</code> will always be row 1 dues the $ and the A will update as the cell is copied left and right"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1504655144, "post_id": 46063211, "comment_id": 79090393, "body": "Did you break down each component of your formula to see if they behave as expected independently?"}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1504656333, "post_id": 46063211, "comment_id": 79090623, "body": "I did. And all components (3 different IF statements) used separately gave the right response. But together, the assembled formula always gave the default false result. However, I went back and looked at the indirects again. I changed them all to direct cell references, and it WORKS. Thanks @ForwardEd"}, {"owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "edited": false, "score": 0, "creation_date": 1504656517, "post_id": 46063211, "comment_id": 79090660, "body": "Now I have to open a new question about a macro to fill blank cells with an array formula. I have one that can enter a formula into blanks cells, but not an array formula."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1504659443, "creation_date": 1504659443, "answer_id": 46065269, "question_id": 46063211, "link": "https://stackoverflow.com/questions/46063211/index-match-formula-works-but-not-within-countifs-or-if-statement/46065269#46065269", "title": "Index Match formula works, but not within COUNTIFS or IF statement", "body": "<p>All components (3 different IF statements) used separately gave the right response separately. But together, the assembled formula always gave the default false result. However, I went back and looked at the indirects again. I changed them all to direct cell references, and it WORKS</p>\n"}], "owner": {"reputation": 23, "user_id": 8565591, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dcfe7005b606a2a4880542ddbf755963?s=128&d=identicon&r=PG&f=1", "display_name": "NathanC", "link": "https://stackoverflow.com/users/8565591/nathanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505365569, "creation_date": 1504644825, "last_edit_date": 1531161705, "question_id": 46063211, "link": "https://stackoverflow.com/questions/46063211/index-match-formula-works-but-not-within-countifs-or-if-statement", "title": "Index Match formula works, but not within COUNTIFS or IF statement", "body": "<p>I've spent over 24 hours pulling my hair out on this one and have searched for the solution here extensively. I've been improving my <code>INDEX/MATCH</code> skills over the past few months but have run into a challenge this time. I'm sure someone here can spot the issue.</p>\n\n<p>I'm running <code>INDEX/MATCH</code> within an IF statement. Everything works fine with a 1 criteria match and I get the proper result just by using enter (don't seem to need to use <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd>).</p>\n\n<pre><code>IF(INDEX(transactions!$A:$E,MATCH(UI$1,transactions!$D:$D,0),5)=$A16,\"DNP\",\"with \" &amp; INDEX(transactions!$A:$E,MATCH(UI$1,transactions!$D:$D,0),5)))\n</code></pre>\n\n<p>and I get the proper result. However if I add 1 more criteria to the <code>INDEX/MATCH</code>in the if statement and press <kbd>Enter</kbd> alone I get a <code>#N/A</code> error. If I use <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> I get the wrong result (the false value of the <code>IF</code> statement).</p>\n\n<p>The <code>INDEX/MATCH formula</code> with the 2 criteria gives the PROPER OUTPUT when used on its own</p>\n\n<pre><code>INDEX(transactions!$A:$E,MATCH(1,(transactions!$D:$D=UI$1)*(transactions!$A:$A&lt;=C16),0),5)\n</code></pre>\n\n<p>But, again, when added in to the same <code>IF</code> statement above in place of the single criteria match, I get the errors mentioned above. Any thoughts?</p>\n\n<p><strong>UPDATE:</strong> Here it is placed in its <code>IF</code> statement and it now runs fine. I had an extra bracket that was causing a problem</p>\n\n<pre><code>IF(INDEX(transactions!$A:$E,MATCH(1,(transactions!$D:$D=UI$1)*(transactions!$A:$A&lt;=C16),0),5)=$A16,\"DNP\",\"with \" &amp; INDEX(transactions!$A:$E,MATCH(UI$1,transactions!$D:$D,0),5))\n</code></pre>\n\n<p>BUT now the issue is when I insert into a nested <code>IF</code> statement I was using it in. I now get the false outcome every time (\"LEAVE BLANK\"), which is not the desired outcome.</p>\n\n<pre><code>IF(COUNTIFS(transactions!$D:$D,INDIRECT(ADDRESS(1,COLUMN(),1)),transactions!$A:$A,\"&lt;=\"&amp;INDIRECT(\"C\"&amp;ROW()))&gt;0, IF(INDEX(transactions!$A:$E,MATCH(1,(transactions!$D:$D=UI$1)*(transactions!$A:$A&lt;=C16),0),5)=$A16,\"DNP\",\"with \" &amp; INDEX(transactions!$A:$E,MATCH(UI$1,transactions!$D:$D,0),5)), IF(COUNTIFS(stats!$B:$B,INDIRECT(ADDRESS(1,COLUMN(),1)),stats!$A:$A,INDIRECT(\"A\"&amp;ROW()))=1,\"DNP\",\"LEAVE BLANK\"))\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504645468, "post_id": 46063192, "comment_id": 79087435, "body": "I think your variables need to be in the top of a module not <code>ThisWorkbook</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504645637, "post_id": 46063192, "comment_id": 79087505, "body": "^^ or you would need to refer to them as <code>ThisWorkbook.BillingMaxRows</code> (for instance) outside of the <code>ThisWorkbook</code> code module."}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504645960, "post_id": 46063192, "comment_id": 79087616, "body": "Scott  - i tried moving the variables from the declarations area of ThisWorkbook to the declaration area of Module1...and they all are zero -- so even though they were calculated in ThisWorkbook those values are gone. So i don&#39;t think the first comment is correct"}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504646161, "post_id": 46063192, "comment_id": 79087702, "body": "Yow...that suggestion did work...i.e. i can reference them as ThisWorkbook.BillingMaxColumns."}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504646236, "post_id": 46063192, "comment_id": 79087734, "body": "So basic question...when you declare a variable as Public in the declarations area do you always have to refer to it by &lt;module&gt;.variable vs. variable? I could see needing to do that if i had a local copy but in this case there was none"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504647389, "post_id": 46063192, "comment_id": 79088208, "body": "@Cooper5114 just tried it, I put in Module1, the declarations.  I put your code in ThisWorkbook, ran the code.  Then in Module2 I ran a single line sub <code>Debug.Print BillingMaxRows</code> and got the correct answer.  Not sure why you are getting 0.  But you should read what Matt says about using global declarations. It is not the best method."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504647238, "post_id": 46063464, "comment_id": 79088139, "body": "ok...understood and thanks. One related question. At what point does that instance of ThisWorkbook.Foo get destroyed? Reason i ask is that the first time i run the method that uses it...it has a value. When i hit a breakpoint and stop and then re-run the same method...then the value is gone."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504648026, "post_id": 46063464, "comment_id": 79088450, "body": "<code>ThisWorkbook</code> is the workbook running the code.. It&#39;s destroyed when it&#39;s closed... Global state gets reset whenever the <code>End</code> keyword is encountered, or when you hit the debugger&#39;s Stop button - regardless of where it&#39;s stored (std module, global class instance, class default instance)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504648134, "post_id": 46063464, "comment_id": 79088494, "body": "Also your values represent row numbers, and you&#39;re declaring them as 16-bit integers. Declare them <code>As Long</code> to avoid integer overflow issues."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504648284, "post_id": 46063464, "comment_id": 79088532, "body": "That said the values should probably be exposed as get-only, calculated properties on the respective worksheet they&#39;re for. Aaand lastly, if that code means to find the last used cell with data, it&#39;s wrong. Research how to find the last used row in a worksheet, you&#39;ll find a highly-upvoted extremely detailed answer on this site."}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504653727, "post_id": 46063464, "comment_id": 79090059, "body": "Mat...thanks for each of the comments and i will search for how to determine the last used row/column..."}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504660731, "post_id": 46063464, "comment_id": 79091502, "body": "ok...one more nube question as i hadn&#39;t done this in years...but how do i get the vb editor in excel to show much autocomplete. for example if i type"}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504660787, "post_id": 46063464, "comment_id": 79091513, "body": "Sheets(&quot;foo&quot;). &lt;--i thought when i pressed &quot;.&quot; i&#39;d get prompted for choices"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504661042, "post_id": 46063464, "comment_id": 79091560, "body": "@Cooper5114 the <code>Sheets</code> collection doesn&#39;t only contain <code>Worksheet</code> objects; you should use the <code>Worksheets</code> collection if you&#39;re looking for a <code>Worksheet</code>, otherwise expect mayhem when you end up accidentally pulling a <code>Chart</code>! Anyway both collections yield <code>Variant&#47;Object</code> items, so if you want <i>IntelliSense</i> and autocomplete, you need to assign the item to a local <code>Worksheet</code> object variable: <code>Dim sheet As Worksheet</code> and then <code>Set sheet = book.Worksheets(indexOrName)</code>. Any call made against <code>Object</code> can only be resolved at run-time (hence &quot;late-bound&quot;) - careful then, it compiles typos!"}, {"owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504662112, "post_id": 46063464, "comment_id": 79091801, "body": "got it...this is the problem w/getting started by creating macros and looking at the code they generate."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "edited": false, "score": 0, "creation_date": 1504662561, "post_id": 46063464, "comment_id": 79091913, "body": "@Cooper5114 See if my pet project <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can help you write better VBA code =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1504646165, "creation_date": 1504646165, "answer_id": 46063464, "question_id": 46063192, "link": "https://stackoverflow.com/questions/46063192/global-scope-lost-in-vba-excel/46063464#46063464", "title": "Global scope lost in vba-excel", "body": "<p><code>ThisWorkbook</code>, as well as any <code>Worksheet</code> module, is an <em>object</em> - an instance of a <em>class module</em> - in this case an instance of the <code>Workbook</code> class.</p>\n\n<p><code>Public</code> members in class modules aren't <em>global</em>; they're publicly accessible to whoever is able to access an instance of the class.</p>\n\n<p>So <code>Public Foo As Long</code> declared as a <em>field</em> in <code>ThisWorkbook</code>, would be accessible through:</p>\n\n<pre><code>Debug.Print ThisWorkbook.Foo\n</code></pre>\n\n<p>And assigned all the same:</p>\n\n<pre><code>ThisWorkbook.Foo = 42\n</code></pre>\n\n<p>If you want the variable to be <em>publicly accessible</em>, but <em>read-only</em>, you must <em>encapsulate</em> it. Declare it <code>Private</code>, and expose a <code>Property Get</code> accessor for it:</p>\n\n<pre><code>Private mFoo As Long\n\nPublic Property Get Foo() As Long\n    Foo = mFoo\nEnd Property\n</code></pre>\n\n<p>And then you can have any member in <code>ThisWorkbook</code> assign <code>mFoo</code>, and any member in any other module of the project <em>read</em> <code>Foo</code>.</p>\n\n<hr>\n\n<p>If you want an actual <em>global variable</em> (hint: you probably <em>don't</em>), then you need to declare it in a <em>standard module</em> (.bas) instead.</p>\n"}], "owner": {"reputation": 53, "user_id": 8565669, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bbf6f89c165cf486c73d09b57986514?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper5114", "link": "https://stackoverflow.com/users/8565669/cooper5114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504646165, "creation_date": 1504644733, "question_id": 46063192, "link": "https://stackoverflow.com/questions/46063192/global-scope-lost-in-vba-excel", "title": "Global scope lost in vba-excel", "body": "<p>Goal = create a variable that gets calculated when i start excel and have that variable globally available to all other modules -- i.e. the size of a given worksheet. </p>\n\n<p>In ThisWorkbook i have this in the declaration part. I thought that each of these would be visible/persistent to other modules. This does actually get called as expected when i start excel. </p>\n\n<pre><code>Public BillingMaxRows As Integer\nPublic BillingMaxColumns As Integer\nPublic MonthlyMaxRows As Integer\nPublic MonthlyMaxColumns As Integer\n</code></pre>\n\n<p>and then this outside of the declarations part. </p>\n\n<pre><code> Sub Workbook_Open()\n    BillingMaxRows = Sheets(\"billing\").UsedRange.Rows.Count\n    BillingMaxColumns = Sheets(\"billing\").UsedRange.Columns.Count\n    MonthlyMaxRows = Sheets(\"Monthly Billings\").UsedRange.Rows.Count\n    MonthlyMaxColumns = Sheets(\"Monthly Billings\").UsedRange.Columns.Count\n    MsgBox (BillingMaxRows)    \nEnd Sub\n</code></pre>\n\n<p>Then in a generic module i try <code>enter code here</code>and use any of these variables but they do not appear to be in scope. </p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 0, "creation_date": 1504645016, "post_id": 46063176, "comment_id": 79087256, "body": "can you show us the table definition for <code>controls</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 0, "creation_date": 1504645058, "post_id": 46063176, "comment_id": 79087276, "body": "And also, never wise to put spaces in a column name."}, {"owner": {"reputation": 11, "user_id": 7601379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1205724309476825/picture?type=large", "display_name": "mjcallen", "link": "https://stackoverflow.com/users/7601379/mjcallen"}, "edited": false, "score": 0, "creation_date": 1504645341, "post_id": 46063176, "comment_id": 79087389, "body": "no new query i write works including queries of other tables. [key status] exists in controls and should be returning either &#39;key&#39; or &#39;non-key&#39;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 0, "creation_date": 1504645748, "post_id": 46063176, "comment_id": 79087541, "body": "queries of other tables with column names with spaces in them?  Please show the table definition."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1504646443, "post_id": 46063176, "comment_id": 79087820, "body": "What RDBMS is this? Please tag as <i>controls</i> can be a reserved words. Also do not wrap items in <code>SELECT</code> with parentheses."}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1504656909, "creation_date": 1504656909, "answer_id": 46064974, "question_id": 46063176, "link": "https://stackoverflow.com/questions/46063176/item-cannot-be-found-in-the-collection-corresponding-to-the-requested-name-or-or/46064974#46064974", "title": "Item cannot be found in the collection corresponding to the requested name or ordinal error", "body": "<p>Here's a general approach to solving this issue. The error is indicating that either the table name or the column name does not exist. The <code>OpenSchema</code> method can be used to list the table names which do exist along with the column names in those tables.</p>\n\n<p>This macro will output the details of all of the tables and columns in the database to a worksheet for you to examine. If the table name or column name has been mangled in some way then you should be able to detect this. If your connection is somehow not pointing to the correct database then this should hopefully also be apparent.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub outputTablesAndColumns()\n\n' Assumes that a variable called `Cn` is in scope\n' and that `Cn` refers to an open ADODB.Connection\n\n' Extract the schema\nDim rs As ADODB.Recordset\nSet rs = Cn.OpenSchema(adSchemaColumns)\n\n' Output the field names and the results\nDim fld As ADODB.Field\nDim i As Integer\n\nWith Worksheets(\"Sheet4\")\n    .UsedRange.ClearContents\n\n    For Each fld In rs.Fields\n        i = i + 1\n        .Cells(1, i).Value = fld.Name\n    Next fld\n\n    .Cells(2, 1).CopyFromRecordset rs\n    .Cells.Columns.Autofit\nEnd With\n\n' Tidy up\nrs.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7601379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1205724309476825/picture?type=large", "display_name": "mjcallen", "link": "https://stackoverflow.com/users/7601379/mjcallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 763, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504656909, "creation_date": 1504644635, "last_edit_date": 1504646520, "question_id": 46063176, "link": "https://stackoverflow.com/questions/46063176/item-cannot-be-found-in-the-collection-corresponding-to-the-requested-name-or-or", "title": "Item cannot be found in the collection corresponding to the requested name or ordinal error", "body": "<p>I've looked at a bunch of posts regarding this error, but can't find a solution to handle my issue. Here's what I'm facing:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n    Initialize\n    Query_Run \"select distinct([key status]) from controls\"\nEnd Sub\n\nFunction Query_Run(qstring)\n    Set rs = New ADODB.Recordset\n    Application.ODBCTimeout = 120\n    rs.Open qstring, Cn, adOpenStatic\nEnd Function\n</code></pre>\n\n<p><em>Initialize</em> creates a new connection to the database.</p>\n\n<p><em>Query_Run</em> creates a new record set and runs the sql query to store whatever the query would return. However, it is giving me the error mentioned in the title. </p>\n\n<p>I've used <em>Query_Run</em> in numerous other areas in the project and it still works, but anything new I write gets the error mentioned in the title. <code>[key status]</code> exists and isn't misspelled, same with controls. Not sure what I'm missing here.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1504644689, "post_id": 46063141, "comment_id": 79087106, "body": "You need to start here: <a href=\"https://www.youtube.com/watch?v=c8reU-H1PKQ\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells, Activecell, End, Offset)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8565666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xeiUO6JWxTU/AAAAAAAAAAI/AAAAAAAAAEk/uZt0fH-1ibQ/photo.jpg?sz=128", "display_name": "Alexis Tremblay Lapierre", "link": "https://stackoverflow.com/users/8565666/alexis-tremblay-lapierre"}, "edited": false, "score": 0, "creation_date": 1504655148, "post_id": 46063274, "comment_id": 79090395, "body": "I don&#39;t know if I misused your code because whenever I re-run the macro it writes over the old data. I&#39;m trying to keep every data transfered that way. Here is what my code : <code>Sheets(&quot;Suivi&quot;).Select  With Sheets(&quot;Rapport&quot;)     .Cells(.Rows.Count, &quot;H&quot;).End(xlUp).Offset(-1, 0).Value = Sheets(&quot;Suivi&quot;).Range(&quot;B3&quot;).Value      Range(&quot;B3&quot;).Select     Application.CutCopyMode = False     Selection.Copy     Sheets(&quot;Rapport&quot;).Select     Range(&quot;H6&quot;).Select     Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _         False, Transpose:=False End With</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 8565666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xeiUO6JWxTU/AAAAAAAAAAI/AAAAAAAAAEk/uZt0fH-1ibQ/photo.jpg?sz=128", "display_name": "Alexis Tremblay Lapierre", "link": "https://stackoverflow.com/users/8565666/alexis-tremblay-lapierre"}, "edited": false, "score": 0, "creation_date": 1504655310, "post_id": 46063274, "comment_id": 79090425, "body": "If you want to copy to the next available cell in column H of sheet Rapport, get rid of <b>everything</b> you just pasted into your comment (the <code>Offset(-1, 0)</code> is especially wrong) and replace it with the code in my answer, except changing my <code>&quot;I&quot;</code> to <code>&quot;H&quot;</code>."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1504645160, "creation_date": 1504645160, "answer_id": 46063274, "question_id": 46063141, "link": "https://stackoverflow.com/questions/46063141/macro-excel-mac-transfer-data-from-a-table-to-another-and-add-a-line-after/46063274#46063274", "title": "Macro (excel_mac) Transfer data from a table to another and add a line after", "body": "<p>On the assumption that you are just trying to fill up column I, you probably want to use something like:</p>\n\n<pre><code>With Sheets(\"Rapport\")\n    .Cells(.Rows.Count, \"I\").End(xlUp).Offset(1, 0).Value = Sheets(\"Suivi\").Range(\"B3\").Value\nEnd With\n</code></pre>\n\n<hr>\n\n<p>Note: This will work on Windows, but I don't know about in the Mac version.  (But it is so basic that I can't really imagine that the two versions won't cater for this in the same way.)</p>\n"}], "owner": {"reputation": 1, "user_id": 8565666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xeiUO6JWxTU/AAAAAAAAAAI/AAAAAAAAAEk/uZt0fH-1ibQ/photo.jpg?sz=128", "display_name": "Alexis Tremblay Lapierre", "link": "https://stackoverflow.com/users/8565666/alexis-tremblay-lapierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593675834, "creation_date": 1504644475, "last_edit_date": 1593675834, "question_id": 46063141, "link": "https://stackoverflow.com/questions/46063141/macro-excel-mac-transfer-data-from-a-table-to-another-and-add-a-line-after", "title": "Macro (excel_mac) Transfer data from a table to another and add a line after", "body": "<p>I'm trying to create a macro that will, after each execution, change the range of where it will be transfered.</p>\n\n<p>This is my code right now (no idea how to change the line after each exe):</p>\n\n<pre><code>Sheets(\"Suivi\").Select\n    Range(\"B3\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Rapport\").Select\n    Range(\"I6\").Select\n    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=False\n</code></pre>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": false, "score": 0, "last_activity_date": 1504705357, "creation_date": 1504705357, "answer_id": 46076868, "question_id": 46063079, "link": "https://stackoverflow.com/questions/46063079/copy-data-to-new-added-worksheets-based-on-selection/46076868#46076868", "title": "Copy data to new-added worksheets based on selection", "body": "<p>Put this stuff at the top of your macro:</p>\n\n<pre><code>Dim wInfo As Worksheet\nDim x as Long\nSet wInfo = Sheets(\"Information\")\n</code></pre>\n\n<p>Then put this right before your <code>End If</code></p>\n\n<pre><code>'check if model # is found in Col D of Information\nIf Application.CountIf(wInfo.Columns(4), ws.Name) Then\n\n    'copy headers\n    wInfo.Range(\"D1:H1\").Copy ws.Range(\"D1\")\n\n    'look for matching model # and copy data if match\n    For x = 1 To wInfo.Cells(wInfo.Rows.Count, 4).End(xlUp).Row\n        If wInfo.Cells(x, 4).Value = ws.Name Then wInfo.Range(\"D\" &amp; x &amp; \":\" &amp; \"H\" &amp; x).Copy ws.Cells(Application.CountA(ws.Columns(4)) + 1, 4)\n    Next x\nEnd If\n</code></pre>\n\n<p>In the sample data you provided, it looked like there was only info to be copied over between columns D and H, so that's what I based this answer on. It copies the values from D to H on the Information sheet to D to H on the new worksheet.</p>\n"}], "owner": {"reputation": 13, "user_id": 7722677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea7f101b8509bb8e1f47b05e42e108f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/7722677/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504705357, "creation_date": 1504644126, "question_id": 46063079, "link": "https://stackoverflow.com/questions/46063079/copy-data-to-new-added-worksheets-based-on-selection", "title": "Copy data to new-added worksheets based on selection", "body": "<p>I have the following code that adds new worksheets based on a range of cells in another worksheet. The code adds up to 10 worksheets and it will name them after the data written in cells. For example:\nI might have the following data in my \"VG-Class\" worksheet:</p>\n\n<p>Cell U2: 1851-A3 --------- Cell U3: 1736-A9 ------ Cell U4: 2171-A7</p>\n\n<p>So the macro will create 3 new worksheets with the names 1851-A3, 1736-A9 and 2171-A7. This is my code:</p>\n\n<pre><code>Private CommandButton1_Click()\nDim lRow As Integer, i As Integer\nDim ws As Worksheet\nDim cel As Range\nDim numLines As Integer\ni = 0\nlRow = Worksheets(\"V-Class GC\").Cells(Rows.Count, 10).End(xlUp).Row\n\nFor Each cel In Worksheets(\"V-Class GC\").Range(\"U2:U\" &amp; lRow)\n    If shtNameChk(cel.Value) = False Then\n    Set ws = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n        ws.Name = cel.Value\n    cel.Offset(0, -1).Hyperlinks.Add Anchor:=cel.Offset(0, -1), Address:=\"\", _\n    SubAddress:=ws.Name &amp; \"!A1\", TextToDisplay:=cel.Offset(0, -2).Value &amp; \", \" &amp; cel.Offset(0, -3).Value\n    i = i + 1\n    End If\nNext\nWorksheets(\"V-Class GC\").Select\nEnd Sub\n</code></pre>\n\n<p>What I'm trying to do is to populate each one of these new worksheets based on the data from another worksheet called \"Information\". The new created worksheet \"1851-A3\" has associated a model, package, reference and price in a list with more codes. I'll use a VLOOKUP to find and place these values. However, I don't know how to make a reference between the name of my worksheets and the codes in this list so the macro can find and place the information corresponding to every code/worksheet name. It's like a report generator. </p>\n\n<p><a href=\"https://i.stack.imgur.com/sufoI.jpg\" rel=\"nofollow noreferrer\">Look at this image if you want to see graphically what I mean: </a></p>\n\n<p>Thank you so much in advance!</p>\n"}, {"tags": ["excel", "vba", "paste", "formulas"], "comments": [{"owner": {"reputation": 446, "user_id": 6894803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52fe65c57a31e6a6db4c8f5ebf168c5?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Moore", "link": "https://stackoverflow.com/users/6894803/chris-moore"}, "edited": false, "score": 0, "creation_date": 1504643572, "post_id": 46062922, "comment_id": 79086615, "body": "Your question says: &quot;I have been trying with this macro, but it doesn&#39;t copy formulas, only values and I need to paste on values, not on formulas.&quot; which sounds like it&#39;s doing what you need it to.  Can you clarify?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 446, "user_id": 6894803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52fe65c57a31e6a6db4c8f5ebf168c5?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Moore", "link": "https://stackoverflow.com/users/6894803/chris-moore"}, "edited": false, "score": 0, "creation_date": 1504643708, "post_id": 46062922, "comment_id": 79086674, "body": "@ChrisMoore OP is trying to copy values without overwriting existing formulas"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504644140, "post_id": 46063028, "comment_id": 79086857, "body": "Making wrong code look wrong 101: <code>c</code> is a terrible identifier - this bug wouldn&#39;t have happened if <code>c</code> was named <code>targetCell</code> instead ...assuming <code>Set targetCell = source(...)</code> looks wrong enough"}, {"owner": {"reputation": 23, "user_id": 8565585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aafe5037106480774cdc6060fc0e61e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/8565585/diego"}, "edited": false, "score": 0, "creation_date": 1504644518, "post_id": 46063028, "comment_id": 79087033, "body": "Thank you so much. I was really stuck! You solve my issue :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1504643892, "creation_date": 1504643892, "answer_id": 46063028, "question_id": 46062922, "link": "https://stackoverflow.com/questions/46062922/paste-if-value-in-target/46063028#46063028", "title": "Paste IF value in target", "body": "<p>Change the inside of your loop to:</p>\n\n<pre><code>Set c = target(RowIndex:=i, ColumnIndex:=j)\nIf Left(c.Formula, 1) &lt;&gt; \"=\" Then\n    c.Value = source(RowIndex:=i, ColumnIndex:=j).Value\nEnd If\n</code></pre>\n\n<p>Your current code is testing whether there is a formula in the <strong>source</strong> cell, but your question implies that you should be testing for a formula in the <strong>target</strong> cell.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8565585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aafe5037106480774cdc6060fc0e61e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/8565585/diego"}, "edited": false, "score": 0, "creation_date": 1504811176, "post_id": 46077518, "comment_id": 79169732, "body": "Thank you Tony, I really appreciate it :)"}, {"owner": {"reputation": 23, "user_id": 8565585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aafe5037106480774cdc6060fc0e61e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/8565585/diego"}, "edited": false, "score": 0, "creation_date": 1508752601, "post_id": 46077518, "comment_id": 80720170, "body": "how can I add multiple ranges to this loop? I tried the below but it only copy/paste the first range Z18:AA250 - AU18:AV250  Dim rSource As Range Dim rTarget As Range Set rSource = ActiveSheet.Range(&quot;Z18:AA250,W18:X250,H18:H250,O18:O250&quot;) Set rTarget = ActiveSheet.Range(&quot;AU18:AV250,AX18:AY250,AR18:AR250,AS18:AS2&zwnj;&#8203;50&quot;) For Item = 1 To rSource.Count    If Not rTarget.Cells(Item).HasFormula Then       rTarget.Cells(Item).Value = rSource.Cells(Item).Value    End If Next Item"}], "tags": [], "owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "is_accepted": false, "score": 0, "last_activity_date": 1504707139, "creation_date": 1504707139, "answer_id": 46077518, "question_id": 46062922, "link": "https://stackoverflow.com/questions/46062922/paste-if-value-in-target/46077518#46077518", "title": "Paste IF value in target", "body": "<p>This loop might be more efficient:</p>\n\n<pre><code>Dim rSource As Range\nDim rTarget As Range\nSet rSource = Worksheets(\"Sheet1\").Range(\"C2:C22\")\nSet rTarget = Worksheets(\"Sheet1\").Range(\"D2:D22\")\nFor Item = 1 To rSource.Count\n   If Not rTarget.Cells(Item).HasFormula Then\n      rTarget.Cells(Item).Value = rSource.Cells(Item).Value\n   End If\nNext Item\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8565585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aafe5037106480774cdc6060fc0e61e?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/8565585/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 46063028, "answer_count": 2, "score": 0, "last_activity_date": 1504707139, "creation_date": 1504643408, "last_edit_date": 1504643569, "question_id": 46062922, "link": "https://stackoverflow.com/questions/46062922/paste-if-value-in-target", "title": "Paste IF value in target", "body": "<p>I want to create a macro to copy a range (C2:C22) where there are formulas and paste it on column range (D2:D22) as values. My problem is that every 6 cells I have a formula and I don't want the macro to override it. \nI have been trying with this macro, but it doesn't copy formulas, only values and I need to paste on values, not on formulas.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub example()\n    Dim source As Range\n    Dim target As Range\n    Set source = ActiveSheet.Range(\"c2:c22\")\n    Set target = ActiveSheet.Range(\"d2:d22\")\n    copy_formulas source:=source, target:=target\n\nEnd Sub\n\nPublic Sub copy_formulas(source As Range, target As Range)\n    'Assumes that all formulas start with '=' and all non formulas do not\n    Dim i As Long\n    Dim j As Long\n    Dim c As Range\n\n    For i = 1 To source.Rows.Count\n        For j = 1 To source.Columns.Count\n            Set c = source(RowIndex:=i, ColumnIndex:=j)\n            If Left(c.Formula, 1) &lt;&gt; \"=\" Then\n                target(RowIndex:=i, ColumnIndex:=j).Value = c.Value\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1504645695, "post_id": 46062686, "comment_id": 79087524, "body": "When you enclose an argument within brackets, you force the argument to be passed by value.  So here an array of values is passed to SetSourceData instead of a range object.  Therefore, remove the brackets from your argument --&gt;  <code>.Chart.SetSourceData Sheet2.Range(&quot;Table_Unit_2_Data[#All]&quot;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "is_accepted": false, "score": 1, "last_activity_date": 1504675187, "creation_date": 1504675187, "answer_id": 46067316, "question_id": 46062686, "link": "https://stackoverflow.com/questions/46062686/excel-2016-vba-set-source-data-for-a-chart-to-a-named-table/46067316#46067316", "title": "Excel 2016 VBA: Set Source Data for a Chart to a Named Table", "body": "<p>In addition to what Domenic said (which is correct + would cause the \"Object Required\" error), your code doesn't make it clear what \"Sheet2\" is, except that it's the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-codename-property-excel\" rel=\"nofollow noreferrer\">codename</a> of some sheet. From the recorded macro, I can infer that the actual table is on a sheet called \"Build\", so another possibility to consider is that Sheet2 isn't actually the codename of Sheets(\"Build\"). Again, I can't actually tell from the code provided.</p>\n\n<p>While I do like using sheet codenames, I'd strongly recommend against using them if you're not going to make the names descriptive.</p>\n\n<p>FWIW,  there's another way to reference table ranges that's a little more flexible, especially if you're going to be referring to the table elsewhere in the code. Just make a ListObject variable:</p>\n\n<pre><code>Dim UnitTable2 As ListObject\nSet UnitTable2 = Sheets(\"Build\").ListObjects(\"Table_Unit_2_Data\")\n</code></pre>\n\n<p>And you'll be able to reference any part of the table really easily:</p>\n\n<pre><code>Dim rng As Range\n'Reference the whole table, including headers:\nSet rng = UnitTable2.Range\n'Reference just the table data (no headers):\nSet rng = UnitTable2.DataBodyRange\n'Reference just the data in a single column:\nSet rng = UnitTable2.ListColumns(\"Col1\").DataBodyRange\n'Reference the headers only\nSet rng = UnitTable2.HeaderRowRange\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8549544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b57d45ddee8af9621116a72812412a?s=128&d=identicon&r=PG&f=1", "display_name": "ReducingDirt", "link": "https://stackoverflow.com/users/8549544/reducingdirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2427, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504675187, "creation_date": 1504642303, "question_id": 46062686, "link": "https://stackoverflow.com/questions/46062686/excel-2016-vba-set-source-data-for-a-chart-to-a-named-table", "title": "Excel 2016 VBA: Set Source Data for a Chart to a Named Table", "body": "<p>The title is pretty self-explanatory.</p>\n\n<p>I have a named table, <code>Table_Unit_2_Data</code>, which I would like to set as the source data for a chart that will be created using VBA.</p>\n\n<p>During the recording of a macro I selected the entirety of the table, and inserted a chart. This is the code that I got (Build is the name of the Sheet):</p>\n\n<pre><code>Sub Test()\n    Range(\"Table_Unit_2_Data[#All]\").Select\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatterSmoothNoMarkers).Select\n    ActiveChart.SetSourceData Source:= Range(\"Build!$Y$1:$AD$2\")\nEnd Sub\n</code></pre>\n\n<p>Well, for one thing, as you can see, a specific $A$1 range is passed into the SetSoureData. This will not work because the range of <code>Table_Unit_2_Data</code> will change.</p>\n\n<p>I attempted this:</p>\n\n<pre><code>With Sheet2.Shapes.AddChart2(240, xlXYScatterSmoothNoMarkers)\n    .Chart.SetSourceData (Sheet2.Range(\"Table_Unit_2_Data[#All]\"))\nEnd With\n</code></pre>\n\n<p>But then I get the error \"Object Required\".</p>\n\n<p>I can't seem to phrase my search queries in such a way as to find relevant answers to this specific question on the internet so I apologize for asking what is likely a redundant question. If someone could help me with this problem I would be greatly appreciative and if anyone has a good article or source online for information regarding the nuances of chart creation within VBA that would also be very helpful.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["json", "vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504642963, "post_id": 46062641, "comment_id": 79086319, "body": "Look at the encoding. <code>Debug.Print</code> and the VBE want to work with ANSI/ASCII."}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504643426, "post_id": 46062641, "comment_id": 79086535, "body": "so where can I change it? sorry, I am begginer :-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504643501, "post_id": 46062641, "comment_id": 79086588, "body": "Look into how to use <code>StrConv</code>, see if it helps."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1504643673, "post_id": 46062641, "comment_id": 79086657, "body": "It looks like <code>responseText</code> failed to decode the response from <code>utf-8</code> to <code>utf-16</code>. It might be due to a header in the response. You&#39;ll probably have to convert the response with <code>ADODB.Stream</code> or <code>MultiByteToWideChar</code>. There&#39;s too many &quot;?&quot; to be due to the ANSI limitation of the immediate window."}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504644233, "post_id": 46062641, "comment_id": 79086896, "body": "Hey Florent, I don&#39;t understand what you mean. How to use ADOBD.Stream ?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1504644398, "post_id": 46062641, "comment_id": 79086974, "body": "@Vba_Beg, have a look here: <a href=\"https://stackoverflow.com/questions/14252762/how-to-parse-line-by-line-winhttp-response-utf-8-encoded-csv\" title=\"how to parse line by line winhttp response utf 8 encoded csv\">stackoverflow.com/questions/14252762/&hellip;</a>"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504645081, "post_id": 46062641, "comment_id": 79087285, "body": "Thanks , but I see the following error: Arguments are of the wrong type, are out of acceptable range or are in conflict with one another"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504645093, "post_id": 46062641, "comment_id": 79087292, "body": "the part of code: FileStream.Type = 1 &#39;Binary     FileStream.Write xmlhttp.responseText"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504645114, "post_id": 46062641, "comment_id": 79087301, "body": "may it be related to this :  FileStream.Type ?"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504645128, "post_id": 46062641, "comment_id": 79087306, "body": "should I change the type ?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1504645935, "post_id": 46062641, "comment_id": 79087608, "body": "@Vba_Beg, you need to keep the line <code>FileStream.Write HTTPReq.responseBody</code>. For the line  <code>FileStream.Charset</code>, you need to set the one returned by the response. It should be <code>utf-8</code>. Check the returned header <code>content-type</code>  with <code>xmlhttp.GetResponseHeader(&quot;content-type&quot;)</code>."}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504646894, "post_id": 46062641, "comment_id": 79087999, "body": "it returns application/json; charset=utf-8"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504646962, "post_id": 46062641, "comment_id": 79088025, "body": "Changed the code to <a href=\"https://paste.ofcode.org/ahkgPQmWNcmqvvhPYpNbnP\" rel=\"nofollow noreferrer\">paste.ofcode.org/ahkgPQmWNcmqvvhPYpNbnP</a>"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504646980, "post_id": 46062641, "comment_id": 79088036, "body": "But still see the safe text format :-"}, {"owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "edited": false, "score": 0, "creation_date": 1504646995, "post_id": 46062641, "comment_id": 79088041, "body": "nothing change :-("}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1505508320, "post_id": 46062641, "comment_id": 79458686, "body": "@Vba_Beg try <code>Cells(1, 1).Value = xmlhttp.responseTex</code> or <code>MsgBox xmlhttp.responseTex</code> instead of <code>Debug.Print (xmlhttp.responseText)</code> to output response. Then just copy the string and paste here."}], "owner": {"reputation": 313, "user_id": 8565541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/609ceac9eb65ce57c077c4dc67615ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Vba_Beg", "link": "https://stackoverflow.com/users/8565541/vba-beg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513610652, "creation_date": 1504642048, "last_edit_date": 1513610652, "question_id": 46062641, "link": "https://stackoverflow.com/questions/46062641/invalid-data-format-from-request-response-vba", "title": "Invalid data format from request response - VBA", "body": "<p>Trying to pull data from private page,  I am receiving a JSON response and would like to check whether everything is okay. The status of the request is fine (200), but if I use</p>\n\n<pre><code>Debug.Print (xmlhttp.responseText)\n</code></pre>\n\n<p>I see unknown ( for me ) format, it looks like:</p>\n\n<blockquote>\n  <p>?      ?s???+]?f? ?n??????w????@??E????LJ??n???\n</blockquote>\n\n<p>Do you know how to convert it to standard JSON code ? </p>\n\n<p>If I use the same headers in Javascript, then everything is okay, so I would like to know why excel converting the response to such strange form</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "oledbconnection", "data-connections"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1504643155, "post_id": 46062557, "comment_id": 79086416, "body": "What is the error? It&#39;s probably going to be impossible to find the issue without seeing the SQL code."}, {"owner": {"reputation": 129, "user_id": 2097541, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ac6558c0b9850d3b7adce909f8f64ab0?s=128&d=identicon&r=PG", "display_name": "RARascon", "link": "https://stackoverflow.com/users/2097541/rarascon"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1504644407, "post_id": 46062557, "comment_id": 79086977, "body": "Sorry, I did forget to add that... It&#39;s Run-time error 1004: Application-defined or object-defined error. I know that doesn&#39;t help though.  I&#39;ve posted the entire code sans the details of the query.  The query works, and I&#39;ve tested it in vba up to this point. I&#39;ll keep testing though and see if I can backtrack."}, {"owner": {"reputation": 129, "user_id": 2097541, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ac6558c0b9850d3b7adce909f8f64ab0?s=128&d=identicon&r=PG", "display_name": "RARascon", "link": "https://stackoverflow.com/users/2097541/rarascon"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1504647016, "post_id": 46062557, "comment_id": 79088055, "body": "What I also forgot to add is that I didn&#39;t get that error previously until after I added on to the sql."}, {"owner": {"reputation": 129, "user_id": 2097541, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ac6558c0b9850d3b7adce909f8f64ab0?s=128&d=identicon&r=PG", "display_name": "RARascon", "link": "https://stackoverflow.com/users/2097541/rarascon"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1504647605, "post_id": 46062557, "comment_id": 79088291, "body": "Running some tests... it&#39;s now working that I took out a portion of the union query.  So, I&#39;m thinking there&#39;s a syntax issue with the SQL in StrQueryCO.  I&#39;ll correct that and see if I get any other errors."}], "answers": [{"comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1504653186, "post_id": 46064511, "comment_id": 79089935, "body": "Just wanted to say - you might consider running some queries, combining the data in excel using VBA, and then running additional queries. I know I was running into some issues where my SQL was getting incredibly complex - I ended up just bringing the data over using SQL and handling it using VBA."}], "tags": [], "owner": {"reputation": 129, "user_id": 2097541, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ac6558c0b9850d3b7adce909f8f64ab0?s=128&d=identicon&r=PG", "display_name": "RARascon", "link": "https://stackoverflow.com/users/2097541/rarascon"}, "is_accepted": false, "score": 1, "last_activity_date": 1504652910, "creation_date": 1504652910, "answer_id": 46064511, "question_id": 46062557, "link": "https://stackoverflow.com/questions/46062557/excel-vba-oledb-connection-commandtext-error/46064511#46064511", "title": "Excel VBA: OLEDB Connection.CommandText Error", "body": "<p>After doing more searching and tests, the problem is that the total CommandText characters has exceeded the allowable 32,767 chars. </p>\n\n<p>user1274820: In a way, you were right where you needed to see the whole code.  The sql is so long because of the way our tables are setup and the sql length is a necessary evil. I'll be looking into other options to run this.</p>\n"}], "owner": {"reputation": 129, "user_id": 2097541, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ac6558c0b9850d3b7adce909f8f64ab0?s=128&d=identicon&r=PG", "display_name": "RARascon", "link": "https://stackoverflow.com/users/2097541/rarascon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1730, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504652910, "creation_date": 1504641736, "question_id": 46062557, "link": "https://stackoverflow.com/questions/46062557/excel-vba-oledb-connection-commandtext-error", "title": "Excel VBA: OLEDB Connection.CommandText Error", "body": "<p>Hello:  I've had success with a long SQL (Oracle) as the Command Text in an OLEDB Data Connection that I entered manually.  I then had success entering the SQL via VBA (because I need it to update based on a changing Item List), and only running the first part of the union query as a test.</p>\n\n<p>However, when I made this last change adding a 2nd piece to the union query and making the strQuery command include three separate query strings, it's now throwing me an error at this line of the code below:  .CommandText = StrQueryAll</p>\n\n<pre><code>StrQueryAll = StrQueryBegin &amp; StrQueryAZ &amp; StrQueryCO &amp; StrQueryEnd\n\n    With ActiveWorkbook.Connections(\"connection_name\").OLEDBConnection\n        .CommandText = StrQueryAll\n        .Refresh\n    End With\n</code></pre>\n\n<p>Below is the entire code with the actual sql removed.  Is there an issue with the code for the sql too long? Or maybe another issue, but it's indirectly saying there's an error?  Maybe it doesn't like strQueryAll command? I can do one big sql string with adding on strings with the continuation limitation, but thought it might be cleaner breaking up the sqls.</p>\n\n<p>Thanks for your help!</p>\n\n<pre><code>Private Sub Refresh_Data()\n\nDim cnn As New ADODB.Connection\nDim rst As New ADODB.Recordset\nDim ConnectionString As String\nDim StrQueryAll As String\nDim StrQueryBegin As String\nDim StrQueryAZ As String\nDim StrQueryCO As String\nDim StrQueryCA As String\nDim StrQueryEnd As String\nDim Item_List As String\nDim wksItemList As Worksheet\nDim wksDataTable As Worksheet\nDim rngItems As Range\nDim rngDatatbl As Range\n\nDim myMSG As String\n'Dim pt As PivotTable\n\nmyString = \"Refreshing Tables - Please Wait\"\nApplication.StatusBar = myString\n\n'With Application\n    '.EnableEvents = False\n    '.ScreenUpdating = False\n'End With\n\n    Set wksItemList = Worksheets(\"Items\")\n    Set rngItems = wksItemList.Range(\"E4\")\n    Set wksDataTable = Worksheets(\"data\")\n    Set rngDatatbl = wksDataTable.Range(\"A3\")\n\nItem_List = rngItems.Value\n\nStrQueryBegin = \"SELECT \" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n   ..... more sql....\n\n   .... next sql string ....\n            StrQueryAZ = \"    -- ****  AZ  ****\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"  select\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n   ..... more sql....\n\n   .... next sql string ....\nStrQueryCO = Chr(13) &amp; \"\" &amp; Chr(10) &amp; \" UNION \" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"    -- ****  CO SYS  ****\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"  select \" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n   ..... more sql....\n\n   .... next sql string ....\nStrQueryEnd = \"            ) \" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \" ORDER BY  \" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n            \"   ITEM_NBR, WHS  \" &amp; Chr(13) &amp; \"\" &amp; Chr(10)\n\nDebug.Print StrQueryBegin &amp; StrQueryAZ &amp; StrQueryCO &amp; StrQueryEnd\nStrQueryAll = StrQueryBegin &amp; StrQueryAZ &amp; StrQueryCO &amp; StrQueryEnd\n\n\n    With ActiveWorkbook.Connections(\"connection_name\").OLEDBConnection\n        .CommandText = StrQueryAll\n        .Refresh\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1504642173, "post_id": 46062431, "comment_id": 79085950, "body": "This? <code>Range(&quot;A1:AH&quot; &amp; Range(&quot;C&quot; &amp; Rows.count).End(xlUp).Row - 2).Select</code> Note that using <code>Select</code> is inefficient and usually unnecessary."}], "answers": [{"tags": [], "owner": {"reputation": 1440, "user_id": 8108679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/abOaf.jpg?s=128&g=1", "display_name": "ChrisM", "link": "https://stackoverflow.com/users/8108679/chrism"}, "is_accepted": false, "score": 0, "last_activity_date": 1504642749, "creation_date": 1504642749, "answer_id": 46062785, "question_id": 46062431, "link": "https://stackoverflow.com/questions/46062431/endxlup-but-remove-bottom-2-rows-from-selected-area/46062785#46062785", "title": "End(xlUp), but remove bottom 2 rows from selected area?", "body": "<p>You need to put -2 in the Offset part and put the bracket in the correct place</p>\n\n<pre><code>Sub SelectRangeDown_Discontiguous()\n   Range(\"A1:AH1\", Range(\"C1048576\").End(xlUp).Offset(-2, 0)).Select\nEnd Sub\n</code></pre>\n\n<p>As long as the end row has something in column C.</p>\n"}], "owner": {"reputation": 1, "user_id": 8565500, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154862970437108/picture?type=large", "display_name": "Darren Barker", "link": "https://stackoverflow.com/users/8565500/darren-barker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504643449, "creation_date": 1504641229, "last_edit_date": 1531161705, "question_id": 46062431, "link": "https://stackoverflow.com/questions/46062431/endxlup-but-remove-bottom-2-rows-from-selected-area", "title": "End(xlUp), but remove bottom 2 rows from selected area?", "body": "<pre><code>Sub SelectRangeDown_Discontiguous()\n   Range(\"A1:AH1\", Range(\"c1048576\").End(xlUp)).Offset(0, 0).Select\nEnd Sub\n</code></pre>\n\n<p>I am using the above macro to select data from the active sheet to copy. However, there is a line free of data and then a footer at the bottom, so I need to reduce the area selected by 2 rows before copying. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1504641119, "post_id": 46062363, "comment_id": 79085429, "body": "you have your sets backwards.  <code>Set Repairs = Sheet1</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1504641501, "post_id": 46062363, "comment_id": 79085621, "body": "Please <a href=\"https://stackoverflow.com/posts/46062363/edit\">edit</a> your question title so that it&#39;s helpful to other people that would be having the same problem as you - what would you type in Google?"}, {"owner": {"reputation": 1, "user_id": 8565467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ceac3216ebf61cccce307a339b960c?s=128&d=identicon&r=PG&f=1", "display_name": "A Singh", "link": "https://stackoverflow.com/users/8565467/a-singh"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504729515, "post_id": 46062363, "comment_id": 79129481, "body": "@ScottCraner thanks, i have tried changing it but i still get the same error and  Private sub commandbutton1_Click() gets highlighted yellow and Set Engineer gets highlighted blue with the same error message."}, {"owner": {"reputation": 1, "user_id": 8565467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ceac3216ebf61cccce307a339b960c?s=128&d=identicon&r=PG&f=1", "display_name": "A Singh", "link": "https://stackoverflow.com/users/8565467/a-singh"}, "edited": false, "score": 0, "creation_date": 1504729666, "post_id": 46062363, "comment_id": 79129553, "body": "Private Sub CommandButton1_Click()  Dim Repairs As Worksheet Dim void2 As Worksheet Dim Engineer As String Dim finalrow As Integer   Set Repairs = Sheet1 Set void2 = Sheet2 Set Engineer = void2.Range(&quot;b2&quot;).Value void2.Range(&quot;A7:AI4000&quot;).ClearContents Repairs.Select finalrow = Cells(Rows.Count, 1).End(xlUp).Row For i = 7 To finalrow If Cells(i, 10) = voids Then Range(Cells(i, 1), Cells(i, 34)).Copy void2.Select Range(&quot;A5000&quot;).End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats Repairs.Select End If Next i void2.Select Range(&quot;b2&quot;).Select End Sub"}], "owner": {"reputation": 1, "user_id": 8565467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29ceac3216ebf61cccce307a339b960c?s=128&d=identicon&r=PG&f=1", "display_name": "A Singh", "link": "https://stackoverflow.com/users/8565467/a-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504729364, "creation_date": 1504640940, "last_edit_date": 1504729364, "question_id": 46062363, "link": "https://stackoverflow.com/questions/46062363/copying-one-row-to-another-excel-spreadsheet-after-meeting-a-value-using-vba", "title": "copying one row to another excel spreadsheet after meeting a value using VBA", "body": "<p>so i'm a novice at excel visual basic but i looked up a code and for some reason i keep getting an error can anyone help to solve this: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Repairs As Worksheet    \nDim void2 As Worksheet    \nDim Engineer As String    \nDim finalrow As Integer    \n\nSet Sheet1 = Repairs    \nSet sheet4 = void2\n\nSet Engineer = void2.Range(\"b2\").Value\n\nvoid2.Range(\"A7:AI4000\").ClearContents\n\nRepairs.Select    \nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row    \n\nFor i = 7 To finalrow    \n     If Cells(i, 10) = voids Then    \n         Range(Cells(i, 1), Cells(i, 34)).Copy    \n         void2.Select    \n         Range(\"A5000\").End(xlUp).Offset(1, 0).PasteSpecialxlPasteFormulasAndNumberFormats    \n        Repairs.Select    \n    End If    \nNext i\n\nvoid2.Select    \nRange(\"b2\").Select    \n\n\nEnd Sub\n</code></pre>\n\n<p>the Private Sub CommandButton1_Click() is highlighted in yellow after i click the run it comes up with an error stating -compile error: invalid use of property. \nAll i'm trying to do is in worksheet \"void 2\" click on a drop down list select the criteria such as VOID or ADAM or JIM etc, and then click a button to scan all the data in column L of repairs (this is where the original data is) and pick out that particular row of data and copy it onto \"void 2\" sheet. </p>\n\n<p>please help i would appreciate all the help i can get! thank you.</p>\n"}, {"tags": ["vba", "excel", "sum"], "comments": [{"owner": {"reputation": 1618, "user_id": 1125532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/V8XyY.jpg?s=128&g=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/1125532/jeffrey"}, "edited": false, "score": 2, "creation_date": 1504644005, "post_id": 46062350, "comment_id": 79086802, "body": "Please add some more information to your question: I&#39;m missing what programming language you are using (I guess VBA?). Add that as tag as well so people can find your question."}, {"owner": {"reputation": 1, "user_id": 8534171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8f4abc140005b4bce9189ba91134b7?s=128&d=identicon&r=PG&f=1", "display_name": "dauti", "link": "https://stackoverflow.com/users/8534171/dauti"}, "reply_to_user": {"reputation": 1618, "user_id": 1125532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/V8XyY.jpg?s=128&g=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/1125532/jeffrey"}, "edited": false, "score": 0, "creation_date": 1504719677, "post_id": 46062350, "comment_id": 79124321, "body": "yes im trying to use excel vba"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1504719773, "post_id": 46062350, "comment_id": 79124383, "body": "why vba?  a formula on the sheet seems like it would work just as well..."}, {"owner": {"reputation": 248, "user_id": 8131936, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a969359221040fb8213ff372360018f4?s=128&d=identicon&r=PG&f=1", "display_name": "Salek", "link": "https://stackoverflow.com/users/8131936/salek"}, "edited": false, "score": 0, "creation_date": 1504719827, "post_id": 46062350, "comment_id": 79124414, "body": "&#39;next N&#39;? maybe just &#39;next&#39;?"}, {"owner": {"reputation": 1, "user_id": 8534171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8f4abc140005b4bce9189ba91134b7?s=128&d=identicon&r=PG&f=1", "display_name": "dauti", "link": "https://stackoverflow.com/users/8534171/dauti"}, "edited": false, "score": 0, "creation_date": 1504720326, "post_id": 46062350, "comment_id": 79124697, "body": "fixed it! thank you"}], "owner": {"reputation": 1, "user_id": 8534171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8f4abc140005b4bce9189ba91134b7?s=128&d=identicon&r=PG&f=1", "display_name": "dauti", "link": "https://stackoverflow.com/users/8534171/dauti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504719661, "creation_date": 1504640907, "last_edit_date": 1531164843, "question_id": 46062350, "link": "https://stackoverflow.com/questions/46062350/sum-two-columns", "title": "Sum two columns", "body": "<p>In columns <code>D, E, F, G I</code> have numbers that I want to work with. I want the sum of columns <code>F</code> and <code>G</code> to come up in column <code>H</code>, and then the product of columns <code>D</code> and <code>E</code> to come up in column <code>I</code>. This is the code I am trying, but nothing is coming up in columns <code>H</code> and <code>I</code>, where the sum and product should be. My sheet name is <code>T1</code></p>\n\n<pre><code>Sub pnltotal()\n\nFor n = 2 To lastrow\nT1.Cells(n, 8) = T1.Cells(n, 6) + T1.Cells(n, 7)\nT1.Cells(n, 9) = T1.Cells(n, 4) * T1.Cells(n, 5)\nNext n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1504641119, "post_id": 46062234, "comment_id": 79085430, "body": "Missing <code>End If</code> in your last code block after <code>If .Value &lt; Now - 1 Then</code> (the error message is a bit misleading)"}, {"owner": {"reputation": 1, "user_id": 8564518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca9ff8a5046aad51fadda09287bf0e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8564518/chris"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504649051, "post_id": 46062234, "comment_id": 79088799, "body": "Thank you Tim, that eliminated the error.  The block does not perform the expected function though, is there a fault in my logic?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8564518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca9ff8a5046aad51fadda09287bf0e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8564518/chris"}, "edited": false, "score": 0, "creation_date": 1504660914, "post_id": 46064079, "comment_id": 79091531, "body": "Thank you again for your time and assistance Tim.  However, this still does not work for me.  In a blank *.xlsm workbook, I test with entering a character into F1.  V1 populates with today&#39;s date as desired.  In V2, I enter the past date 08/08/2008, as a representation of a date that ought to be changed to today&#39;s date.  No change, the same as my working document.  Running Excel 2016 on Windows 7."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 8564518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca9ff8a5046aad51fadda09287bf0e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8564518/chris"}, "edited": false, "score": 0, "creation_date": 1504665211, "post_id": 46064079, "comment_id": 79092538, "body": "Your code only responds to changes in columns D and F, so it&#39;s not going to do anything when you make a change in ColV...  I assumed from your description that the dates in V were all automatic."}, {"owner": {"reputation": 1, "user_id": 8564518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca9ff8a5046aad51fadda09287bf0e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8564518/chris"}, "edited": false, "score": 0, "creation_date": 1504667768, "post_id": 46064079, "comment_id": 79093059, "body": "Very good Tim, I revise from the point of view of an initial evaluation of V.  I appreciate your guidance!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1504649850, "creation_date": 1504649850, "answer_id": 46064079, "question_id": 46062234, "link": "https://stackoverflow.com/questions/46062234/i-am-trying-to-update-a-previously-entered-date-in-the-past-to-the-current-date/46064079#46064079", "title": "I am trying to update a previously entered date in the past to the current date, if a condition is met", "body": "<p>This seems to work for me:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    Dim rCell As Range\n    Dim rChange As Range\n\n    On Error GoTo ErrHandler\n    Set rChange = Intersect(Target, Range(\"D:D\"))\n    If Not rChange Is Nothing Then\n        Application.EnableEvents = False\n        For Each rCell In rChange\n            If rCell &gt; \"\" Then\n                With rCell.Offset(0, 11)\n                    .Value = Now\n                    .NumberFormat = \"mm/dd/yy\"\n                End With\n            End If\n        Next\n    End If\n\n    '## combining your two loops into a single block ##\n    Set rChange = Intersect(Target, Range(\"F:F\"))\n    If Not rChange Is Nothing Then\n        Application.EnableEvents = False\n        For Each rCell In rChange\n            With rCell.Offset(0, 16)\n                .NumberFormat = \"mm/dd/yy\"\n                If Len(rCell) &gt; 0 Then\n                    .Value = Now\n                Else\n                    If .Value &lt; Now - 1 Then .Value = Now\n                End If\n            End With\n        Next\n    End If\n\nExitHandler:\n    Set rCell = Nothing\n    Set rChange = Nothing\n    Application.EnableEvents = True\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description\n    Resume ExitHandler\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8564518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06ca9ff8a5046aad51fadda09287bf0e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8564518/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504649850, "creation_date": 1504640422, "last_edit_date": 1504649258, "question_id": 46062234, "link": "https://stackoverflow.com/questions/46062234/i-am-trying-to-update-a-previously-entered-date-in-the-past-to-the-current-date", "title": "I am trying to update a previously entered date in the past to the current date, if a condition is met", "body": "<p>I have a worksheet that I use to help forecast cash flow.  </p>\n\n<p>Column V is a date that is initially the anticipated invoice date, and upon issuance of an invoice, becomes the actual invoice date.  Upon issuing a Purchase Order(\"D:D\") or Invoice(\"F:F\"), I manually enter the associated number and the current date is entered in the appropriate cells of that row, Purchase Order(With rCell.Offset(0, 11)){Column O} Invoice(With rCell.Offset(0, 16)){Column V}, to be referenced in other worksheets.  </p>\n\n<p>I've discovered the need to automatically make sure that the date in Column V is never in the past, which does occasionally occur.  I am having difficulty with this.  I need to only update Column V dates in the past, to the current date, IF Column F is empty.</p>\n\n<p>Any assistance would be greatly appreciated!</p>\n\n<p>Chris</p>\n\n<p>This is what I have.  The first two routines run as desired.  The third is the current date issue, and does not function as expected.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    Dim rCell As Range\n    Dim rChange As Range\n\n    On Error GoTo ErrHandler\n    Set rChange = Intersect(Target, Range(\"D:D\"))\n    If Not rChange Is Nothing Then\n        Application.EnableEvents = False\n        For Each rCell In rChange\n            If rCell &gt; \"\" Then\n                With rCell.Offset(0, 11)\n                    .Value = Now\n                    .NumberFormat = \"mm/dd/yy\"\n                End With\n            End If\n        Next\n    End If\n\n    On Error GoTo ErrHandler\n    Set rChange = Intersect(Target, Range(\"F:F\"))\n    If Not rChange Is Nothing Then\n        Application.EnableEvents = False\n        For Each rCell In rChange\n            If rCell &gt; \"\" Then\n                With rCell.Offset(0, 16)\n                    .Value = Now\n                    .NumberFormat = \"mm/dd/yy\"\n                End With\n            End If\n        Next\n    End If\n\n    On Error GoTo ErrHandler\n        Set rChange = Intersect(Target, Range(\"F:F\"))\n        If Not rChange Is Nothing Then\n            Application.EnableEvents = False\n            For Each rCell In rChange\n                If rCell = \"\" Then\n                    With rCell.Offset(0, 16)\n                        If .Value &lt; Now - 1 Then\n                            .Value = Now\n                            .NumberFormat = \"mm/dd/yy\"\n                        End If\n                    End With\n                End If\n            Next\n        End If\n\nExitHandler:\n    Set rCell = Nothing\n    Set rChange = Nothing\n    Application.EnableEvents = True\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description\n    Resume ExitHandler\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1504640325, "post_id": 46062203, "comment_id": 79085022, "body": "Wait, you say your code works but you want it shorter?"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1504640652, "post_id": 46062203, "comment_id": 79085207, "body": "Ohhh, I see what you are doing. This is highly inefficient. It will work but there is a better way. You need to use <code>For Loops</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8565392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec789faee97b1cd9ca8063325ce108c7?s=128&d=identicon&r=PG&f=1", "display_name": "L Schaller", "link": "https://stackoverflow.com/users/8565392/l-schaller"}, "edited": false, "score": 0, "creation_date": 1504643100, "post_id": 46062549, "comment_id": 79086384, "body": "I works but it is only copying the information from column L not columns L through O from the original worksheet. It also doesn&#39;t seem to be copying 98 lines of data"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 11, "user_id": 8565392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec789faee97b1cd9ca8063325ce108c7?s=128&d=identicon&r=PG&f=1", "display_name": "L Schaller", "link": "https://stackoverflow.com/users/8565392/l-schaller"}, "edited": false, "score": 0, "creation_date": 1504643789, "post_id": 46062549, "comment_id": 79086707, "body": "I think now its fixed. I&#39;m not used to ranges, so I reverted back to cells, so now I know it works. However, it goes from line 3 to line 98. It should go to line 101? You can see where to change that, right?"}, {"owner": {"reputation": 11, "user_id": 8565392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec789faee97b1cd9ca8063325ce108c7?s=128&d=identicon&r=PG&f=1", "display_name": "L Schaller", "link": "https://stackoverflow.com/users/8565392/l-schaller"}, "edited": false, "score": 0, "creation_date": 1504648214, "post_id": 46062549, "comment_id": 79088511, "body": "That worked.  I tried to setup a second sub called copy distribution2 and called it at the end to enter the lines for the second invoice distribution but it doesn&#39;t seem to work, it sums them up (I added that to the end of the first sub) but it doesn&#39;t insert the rows like the first one does"}, {"owner": {"reputation": 11, "user_id": 8565392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec789faee97b1cd9ca8063325ce108c7?s=128&d=identicon&r=PG&f=1", "display_name": "L Schaller", "link": "https://stackoverflow.com/users/8565392/l-schaller"}, "edited": false, "score": 0, "creation_date": 1504648503, "post_id": 46062549, "comment_id": 79088616, "body": "Figured it out I had to change it to row 3 was overwriting row 2"}], "tags": [], "owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "is_accepted": false, "score": 1, "last_activity_date": 1504643725, "last_edit_date": 1504643725, "creation_date": 1504641680, "answer_id": 46062549, "question_id": 46062203, "link": "https://stackoverflow.com/questions/46062203/excel-vba-copying-from-one-worksheet-to-another-row-by-row-up-to-a-fixed-number/46062549#46062549", "title": "Excel VBA copying From one worksheet to another row by row up to a fixed number of rows", "body": "<p>Here it is with loops</p>\n\n<pre><code>Sub Copy_Distribution()\nDim OriginSheet As Worksheet\nSet OriginSheet = Sheets(\"Import Setup\")\nDim ObjectiveSheet As Worksheet\nSet ObjectiveSheet = Sheets(\"Import\")\nDim ColumnToPaste As Long\nDim RowToGetValue As Long\nDim GetColumn As Long\nColumnToPaste = 15 'Because GetColumn\nFor RowToGetValue = 3 To 98 'From 3 to 98 right?\n    If OriginSheet.Cells(RowToGetValue, 12).Value &gt; 0 Then\n        For GetColumn = 1 To 4\n            ObjectiveSheet.Cells(2, ColumnToPaste + GetColumn).Value = OriginSheet.Cells(RowToGetValue, 11 + GetColumn).Value\n        Next GetColumn\n    ColumnToPaste = ColumnToPaste + 4\n    End If\nNext RowToGetValue\n\nEnd Sub\n</code></pre>\n\n<p>I replaced the ranges to be dynamic, from row 3 to 98, and made the columns get increments of 4, so they wont overlap.\nCan you give it a try to see if it works with your data?</p>\n"}], "owner": {"reputation": 11, "user_id": 8565392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec789faee97b1cd9ca8063325ce108c7?s=128&d=identicon&r=PG&f=1", "display_name": "L Schaller", "link": "https://stackoverflow.com/users/8565392/l-schaller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504643725, "creation_date": 1504640269, "last_edit_date": 1531161705, "question_id": 46062203, "link": "https://stackoverflow.com/questions/46062203/excel-vba-copying-from-one-worksheet-to-another-row-by-row-up-to-a-fixed-number", "title": "Excel VBA copying From one worksheet to another row by row up to a fixed number of rows", "body": "<p>I need to copy row 2 of a worksheet (Import Setup) to row 2 of another worksheet (Import) Then I need to copy columns L-O on the next row of the import setup worksheet and append it to the end of row 2 in on the Import worksheet is the amount in column L is greater than 0.  I need to continue copying columns L-O from the next rows on Import Setup sheet into the import sheet until I copy 98 rows, then I need to copy the entire row of the following row on the Import Setup sheet to row 3 of the Import sheet and continue as above until I reach 98 then repeat process again.  I know what I have here will work but I am looking for an easier way then having to type out so much code.</p>\n\n<pre><code>Sub Create_invoice()\n\n' Copies the first row of an invoice to the import template\n\n    Sheets(\"Import Setup\").Select\n    Range(\"A2:O2\").Select\n    Application.CutCopyMode = False\nSelection.Copy\nSheets(\"Import\").Select\nRange(\"A2\").Select\nActiveSheet.Paste\n\n'Calls macro to copy additional Distributions up to 99\n\nCall Copy_Distribution\n\nEnd Sub\n\nSub Copy_Distribution()\n\n'Copys distribution if invoice amount is not 0 up to 99\n\n Sheets(\"Import Setup\").Select\n If Range(\"L3\").Value &gt; 0 Then\n  Range(\"L3:O3\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"P2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L4\").Value &gt; 0 Then\n Range(\"L4:O4\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"T2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L5\").Value &gt; 0 Then\n Range(\"L5:O5\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"X2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L6\").Value &gt; 0 Then\n Range(\"L6:O6\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AB2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L7\").Value &gt; 0 Then\n Range(\"L7:O7\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AF2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L8\").Value &gt; 0 Then\n Range(\"L8:O8\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AJ2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L9\").Value &gt; 0 Then\n Range(\"L9:O9\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AN2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L10\").Value &gt; 0 Then\n Range(\"L10:O10\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AR2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L11\").Value &gt; 0 Then\n Range(\"L11:O11\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AV2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L12\").Value &gt; 0 Then\n Range(\"L12:O12\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"AZ2\").Select\n ActiveSheet.Paste\n End If\n\n Sheets(\"Import Setup\").Select\n If Range(\"L13\").Value &gt; 0 Then\n Range(\"L13:O13\").Select\n Application.CutCopyMode = False\n Selection.Copy\n Sheets(\"Import\").Select\n Range(\"BD2\").Select\n ActiveSheet.Paste\n End If\n\n\nEnd Sub\n</code></pre>\n"}]