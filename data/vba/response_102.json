[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1482365928, "post_id": 41273817, "comment_id": 69749443, "body": "Social engineering?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482366335, "post_id": 41273817, "comment_id": 69749546, "body": "Who is the intended user, and what&#39;s their relationship to you ?  Same company, or different/random ?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482366936, "post_id": 41273817, "comment_id": 69749692, "body": "install a rootkit?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482367137, "post_id": 41273817, "comment_id": 69749740, "body": "Same company. Co-workers"}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "is_accepted": false, "score": 3, "last_activity_date": 1482950010, "last_edit_date": 1482950010, "creation_date": 1482366064, "answer_id": 41274016, "question_id": 41273817, "link": "https://stackoverflow.com/questions/41273817/how-to-bypass-macros-have-been-disabled-message-and-have-macros-run-workbook-a/41274016#41274016", "title": "How to bypass &quot;Macros have been disabled&quot; message and have macros run Workbook_Activate?", "body": "<p>This can often be resolved by including the workbook's folder path in their <a href=\"https://support.office.com/en-us/article/Create-remove-or-change-a-trusted-location-for-your-files-f5151879-25ea-4998-80a5-4208b3540a62\" rel=\"nofollow noreferrer\">Trusted Locations</a>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1482369382, "last_edit_date": 1482369382, "creation_date": 1482368945, "answer_id": 41274371, "question_id": 41273817, "link": "https://stackoverflow.com/questions/41273817/how-to-bypass-macros-have-been-disabled-message-and-have-macros-run-workbook-a/41274371#41274371", "title": "How to bypass &quot;Macros have been disabled&quot; message and have macros run Workbook_Activate?", "body": "<p>As sigil pointed out adding the file's folder location to the Trusted Locations will prevent the <code>Enable Content</code> and <code>Enable Macros</code> dialog boxes from appearing.  </p>\n\n<p>Alternately, you could create a VBScript file to open the workbook.  </p>\n\n<ul>\n<li>Paste this could into NotePad</li>\n<li>Adjust the FILE_NAME constant</li>\n<li>Hold down <kbd>Ctrl</kbd>+<kbd>S</kbd></li>\n<li>Click [Save as type]</li>\n<li>Select All Files (<em>.</em>)</li>\n<li>Save the file with <code>.vbs</code> as it's extension</li>\n</ul>\n\n<hr>\n\n<pre><code>Const FILE_NAME = \"C:\\Excel FIles\\Hello World.xlsm\"\nDim oExcel\nOn Error Resume Next\nSet oExcel = GetObject(, \"Excel.Application\")\nOn Error Goto 0\n\nIf TypeName(oExcel) = \"Empty\" Then Set oExcel = WScript.CreateObject(\"Excel.Application\")\noExcel.Visible = True\noExcel.Workbooks.Open FILE_NAME\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2334, "favorite_count": 1, "answer_count": 2, "score": -3, "last_activity_date": 1482950010, "creation_date": 1482364530, "question_id": 41273817, "link": "https://stackoverflow.com/questions/41273817/how-to-bypass-macros-have-been-disabled-message-and-have-macros-run-workbook-a", "title": "How to bypass &quot;Macros have been disabled&quot; message and have macros run Workbook_Activate?", "body": "<p>I have some VBA code that formats/resizes the screen when the workbook/worksheet is activated. </p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Private Sub Workbook_Activate()\n  Dim SaveSelection As Object\n  Set SaveSelection = Selection\n  Application.ScreenUpdating = False\n  Range(\"A1:T50\").Select\n  ActiveWindow.Zoom = True\n  Application.DisplayFullScreen = False\n  Application.DisplayFormulaBar = False\n  ActiveWindow.DisplayWorkbookTabs = True\n  ActiveWindow.DisplayHeadings = False\n  ActiveWindow.DisplayGridlines = False\n   Range(\"A1:T50\").Select\n  ActiveWindow.Zoom = True\n  On Error GoTo ExitPoint\n  SaveSelection.Select\n  Application.ScreenUpdating = True\nExitPoint:\nEnd Sub\n</code></pre>\n\n<p>The problem here is that when the user first opens the workbook, they get this Security Warning message \"Macros have been disabled\", so the macro does not run when the user first opens the workbook because the message appears.</p>\n\n<p>Does anyone know of a workaround to this?</p>\n"}, {"tags": ["vba", "excel", "listbox", "userform", "excel-2016"], "comments": [{"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1482371462, "post_id": 41273692, "comment_id": 69750771, "body": "Is the user selecting different ranges from ComboBox1? Are you looking for the number of columns in the combobox or the number of columns in the selected range?"}], "answers": [{"tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 0, "last_activity_date": 1482370938, "last_edit_date": 1482370938, "creation_date": 1482369832, "answer_id": 41274470, "question_id": 41273692, "link": "https://stackoverflow.com/questions/41273692/ms-excel-vba-populate-listbox-with-varying-column-requirements/41274470#41274470", "title": "ms excel vba populate listbox with varying column requirements", "body": "<p>To add items to the listbox, just define your range and loop through them to add to list.</p>\n\n<p>Now I have just specified an arbitrary range, you can make that range dynamic and to what ever you need and the code will adjust the columns and rows count for you. You don't need to mess with the <code>listbox</code> properties for column count, as it is done programmatically to suit the dynamic nature of your issue.</p>\n\n<pre><code>   Dim x      \n   Dim i As Long\n   Dim y As Long\n   Dim yy As Long\n\n    x = Range(\"C1:E20\") ' change this to suit the range you want       \n    y = (UBound(x, 2) - LBound(x, 2))\n\n    ListBox1.ColumnCount = y + 1\n    For i = 0 To UBound(x) - 1\n      With ListBox1\n       .AddItem\n        For yy = 0 To y\n          .List(i, yy) = x(i + 1, yy + 1)\n        Next\n      End With\n    Next    \n</code></pre>\n\n<p>Then to get multiple select, change the properties of the list box,</p>\n\n<p><a href=\"https://i.stack.imgur.com/IQXOm.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IQXOm.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1482371703, "last_edit_date": 1495539946, "creation_date": 1482371703, "answer_id": 41274691, "question_id": 41273692, "link": "https://stackoverflow.com/questions/41273692/ms-excel-vba-populate-listbox-with-varying-column-requirements/41274691#41274691", "title": "ms excel vba populate listbox with varying column requirements", "body": "<p>Here I modified my answer to <a href=\"https://stackoverflow.com/questions/39624018/excel-combobox-autosize-dropdown-only/39626351#39626351\">Excel ComboBox - Autosize Dropdown Only</a> to adjust the <code>Column</code> counts and <code>ListWidths</code> of a ComboBox or ListBox.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kCbkY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCbkY.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Usage</h2>\n\n<pre><code>ConfigureComboOrListBox ListBox1\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub ConfigureComboOrListBox(LCBox As Object)\n    Dim arrData, arrWidths\n    Dim x As Long, y As Long, ListWidth As Double\n    arrData = LCBox.List\n    ReDim arrWidths(UBound(arrData, 2))\n\n    For x = 0 To UBound(arrData, 1)\n        For y = 0 To UBound(arrData, 2)\n\n            If Len(arrData(x, y)) &gt; arrWidths(y) Then arrWidths(y) = Len(arrData(x, y))\n\n        Next\n    Next\n\n    For y = 0 To UBound(arrWidths)\n\n        arrWidths(y) = arrWidths(y) * LCBox.Font.Size\n        ListWidth = ListWidth + arrWidths(y)\n    Next\n\n    With LCBox\n        .ColumnCount = UBound(arrWidths) + 1\n        .ColumnWidths = Join(arrWidths, \";\")\n        .ListWidth = ListWidth\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4922368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae1a70ecb4744c3b6ab98bdb805c41?s=128&d=identicon&r=PG&f=1", "display_name": "darkdimension", "link": "https://stackoverflow.com/users/4922368/darkdimension"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1550, "favorite_count": 1, "accepted_answer_id": 41274691, "answer_count": 2, "score": 0, "last_activity_date": 1482371703, "creation_date": 1482363500, "question_id": 41273692, "link": "https://stackoverflow.com/questions/41273692/ms-excel-vba-populate-listbox-with-varying-column-requirements", "title": "ms excel vba populate listbox with varying column requirements", "body": "<p><strong>BACKGROUND</strong>  </p>\n\n<p>I am developing a userform in ms excel to provide a 'dashboard' for data spread over several worksheets. The userform presents a combobox and from that selection, the listbox is populated. The userform also allows the listbox information to be copied by a 'COPY' button. The rowsource for the listbox can be a single column (e.g., Budget!$L$191) or several columns &amp; rows (e.g.,  JKG.Slave!$I$38:$JM$44).  </p>\n\n<p>I have selected the 'MultiSelect' property in the listbox properties.</p>\n\n<p><strong>CHALLENGES</strong>  </p>\n\n<p>How do I display all rowsource data in a multicolumn (if needed) listbox?<br>\nHow do I dynamically capture the column count needed to support the multicolumn listbox?<br>\nCan I use a variable to capture the column count and have it populate the listbox at runtime?  </p>\n\n<p><strong>CODE SAMPLE FROM PROJECT</strong> </p>\n\n<pre><code>Public Sub ComboBox1_Change()\n\nDim cSelect As String\nDim lcount As Integer\n\ncSelect = UserForm2.ComboBox1.Value\n\nUserForm2.ListBox1.RowSource = cSelect\n\nlcount = UserForm2.ComboBox1.ColumnCount\n\nMsgBox lcount\n\nEnd Sub  \n</code></pre>\n\n<p>The variable lcount returns one (1) even when the rowsource is the multiple rows &amp; multiple columns selection.  </p>\n\n<p>Thank you all for the help.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1482366595, "post_id": 41273534, "comment_id": 69749614, "body": "Loop over the <code>ListParagraphs</code> and get the largest <code>ListFormat.ListLevelNumber</code>"}, {"owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482379681, "post_id": 41273534, "comment_id": 69752680, "body": "@TimWilliams I added up doing the same. Was hoping if there was some such a property in the <code>WORD Object Model</code>. But it seems there is none."}], "owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482421872, "creation_date": 1482362318, "last_edit_date": 1482421872, "question_id": 41273534, "link": "https://stackoverflow.com/questions/41273534/word-vba-to-find-highest-list-level-number-of-a-list", "title": "WORD VBA to find highest List Level number of a list", "body": "<p>How to find the above for following list. We already know the <code>ActiveDocument.Lists(1).ListParagraphs.Count</code> gives number of items in the list:</p>\n\n<pre><code>OList = ActiveDocument.Lists(1)\n</code></pre>\n\n<p>For example, is there any WORD VBA property that would return 3 - the highest List Level number - for the following WORD Document lists:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nzpYS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nzpYS.png\" alt=\"enter image description here\"></a></p>\n\n<p>OR</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y5sk0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5sk0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1704475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734eb8e6cb07bd603da0547a70df0db5?s=128&d=identicon&r=PG", "display_name": "user1704475", "link": "https://stackoverflow.com/users/1704475/user1704475"}, "edited": false, "score": 0, "creation_date": 1482455503, "post_id": 41273659, "comment_id": 69790571, "body": "Thanks Lucas! The VBA worked like a champ. I appreciate the help. --dave"}], "tags": [], "owner": {"reputation": 361, "user_id": 4466402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7139b7ab17ebd71a9387eb4a6fd1c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Kellner", "link": "https://stackoverflow.com/users/4466402/lucas-kellner"}, "is_accepted": false, "score": 0, "last_activity_date": 1483809520, "last_edit_date": 1483809520, "creation_date": 1482363248, "answer_id": 41273659, "question_id": 41273159, "link": "https://stackoverflow.com/questions/41273159/how-to-iteratively-delete-words-defined-in-a-list/41273659#41273659", "title": "How to iteratively delete words defined in a list", "body": "<p>In order to use the text in the .TXT file you can use the Open ... For Input method.  You can loop through the words and lines in that .TXT file and do a Find/Replace in your doc.</p>\n\n<p>Here is a code snip you can adapt:</p>\n\n<pre><code>Sub DeleteWordsStoredInTXTFileFromThisDoc()\nDim filePath As String\n' change the filePath to point to your file\n' you can put the full path, for example \"C:\\foldername\\filename.txt\"\nfilePath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\textfile.txt\"\n\nOpen filePath For Input As 1\nDim LineFromFile As String\nDo Until EOF(1)\n    Line Input #1, LineFromFile\n    Dim LineItems() As String\n    Dim LineItem As Variant\n    ' depending on how you are listing your naughty words you need to pick from the following lines\n    ' if your words are separated by commas\n    'LineItems = Split(LineFromFile, \",\")\n    ' if your words are separated onto different lines\n    LineItems = Split(LineFromFile, Chr(13))\n    For Each LineItem In LineItems\n        With Selection.Find\n            .Text = LineItem\n            .Replacement.Text = \"\"\n            .Execute MatchWholeWord:=True, Replace:=wdReplaceAll, Forward:=True, Wrap:=wdFindContinue\n        End With\n    Next LineItem\nLoop\nClose #1\nEnd Sub\n</code></pre>\n\n<p>Please be aware that if your .TXT list of words to delete does not include a space either before or after the word then you will end up leaving behind an extra space in your doc.  Deleting the word \"bad\" from \"Big bad wolf\" will yield </p>\n\n<pre><code>\"Big  wolf\" \n</code></pre>\n\n<p>when you probably want </p>\n\n<pre><code>\"Big wolf\" \n</code></pre>\n\n<p>Adding spaces to your word list like \"bad \" or \" bad\" will help avoid this.  You have to proofread your document obviously.</p>\n"}], "owner": {"reputation": 1, "user_id": 1704475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734eb8e6cb07bd603da0547a70df0db5?s=128&d=identicon&r=PG", "display_name": "user1704475", "link": "https://stackoverflow.com/users/1704475/user1704475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1483809520, "creation_date": 1482360206, "question_id": 41273159, "link": "https://stackoverflow.com/questions/41273159/how-to-iteratively-delete-words-defined-in-a-list", "title": "How to iteratively delete words defined in a list", "body": "<p>I want to delete from a .DOCX file all of the occurrences of unwanted words defined in a list. I'm creating a concordance but I don't want to process common words (e.g., \"the\"  \"and\"  \"either\" ...)</p>\n\n<p>I have .DOCX file, which I've also stored as a .TXT, that is the main document from which I want to construct concordance. I have a list of unwanted words in a separate .TXT file.</p>\n\n<p>How can I write (or record) a macro to repeatedly get the next word off the list, find and delete all occurrences of that word, repeat until list is exhausted.</p>\n\n<p>It would be ok to use VBA in Word or create a macro in editor.exe (MS's free editor).</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["forms", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1482432010, "post_id": 41274044, "comment_id": 69781881, "body": "I tried this and I get - &quot;The command or action &#39;DeleteRecord&#39; isn&#39;t available now."}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1482437761, "post_id": 41274044, "comment_id": 69784574, "body": "The real problem seems to stem from losing the bookmark, or so.  For example, if I delete all records from a slide, and come back to that slide,I would expect to see the slide show a blank, but it shows the records from the other slide."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1482366279, "creation_date": 1482366279, "answer_id": 41274044, "question_id": 41272684, "link": "https://stackoverflow.com/questions/41272684/deleting-the-first-record-on-continuous-form-in-ms-access-2013/41274044#41274044", "title": "Deleting the first record on continuous form in MS Access 2013", "body": "<p>If you delete a record with SQL, the form doesn't know about it. You need to do <code>Me.Requery</code> afterwards.</p>\n\n<p>Much simpler would be to run <code>DoCmd.RunCommand acCmdDeleteRecord</code>.</p>\n\n<p>From <a href=\"http://access.mvps.org/access/RunCommand/codeex/50-223.htm\" rel=\"nofollow noreferrer\">http://access.mvps.org/access/RunCommand/codeex/50-223.htm</a> :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Code from Microsoft Knowledge Base Adapted by Terry Wickenden\nPrivate Sub cmdDelete_Click()\n\n  On Error GoTo Err_cmdDelete_Click\n\n  DoCmd.SetWarnings False\n  If MsgBox(\"Confirm deletion of the record?\", vbQuestion + vbYesNo + vbDefaultButton2, \"Delete?\") =  vbYes Then\n    DoCmd.RunCommand acCmdSelectRecord ' I think this isn't needed\n    DoCmd.RunCommand acCmdDeleteRecord\n  End If\n\nExit_cmdDelete_Click:\n  DoCmd.SetWarnings True\n  Exit Sub\n\nErr_cmdDelete_Click:\n  MsgBox Err.Description\n  Resume Exit_cmdDelete_Click\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482366279, "creation_date": 1482357855, "last_edit_date": 1482365806, "question_id": 41272684, "link": "https://stackoverflow.com/questions/41272684/deleting-the-first-record-on-continuous-form-in-ms-access-2013", "title": "Deleting the first record on continuous form in MS Access 2013", "body": "<p>I have a \"remove\" button on a continuous form that performs the following SQL when clicked:</p>\n\n<pre><code>Dim strSQL As String\nstrSQL = \"Delete SLIDE_NAME, COB_TITLE, COB_ID, COB_CATEGORY \" _\n      &amp; \"FROM tbl_SLIDE_LIST \" _\n      &amp; \"WHERE SLIDE_NAME='\" &amp; strSlideName &amp; \"' AND COB_TITLE='\" &amp; strCOB_TITLE &amp; \"';\"\n\nCurrentDb.Execute (strSQL)\n</code></pre>\n\n<p>The button sits on the continuous form like so:\n<a href=\"https://i.stack.imgur.com/yRNsp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRNsp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>There must be some sort of initialization I need to perform to make this work properly -</p>\n\n<p>I can delete the 2nd and 3rd records with no problem, but if I click the \"remove\" button on the first record, the subform becomes blank, as if I deleted all records - (which is not actually the case).  Then if I reselect the \"Test Slide\" to look at what actually happened, I receive the error \"The data has been changed\"  Another user edited this record and saved the changes before you attempted to save your changes.</p>\n\n<p>What is happening here and what do I need to do to make this work correctly?</p>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7327744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kwvEM.jpg?s=128&g=1", "display_name": "G.Medina", "link": "https://stackoverflow.com/users/7327744/g-medina"}, "edited": false, "score": 0, "creation_date": 1482362787, "post_id": 41273137, "comment_id": 69748650, "body": "Thanks, looking for the file will take the same time as if i would just write the formulas myself, the column name finder its perfect that will be really useful"}], "tags": [], "owner": {"reputation": 361, "user_id": 4466402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7139b7ab17ebd71a9387eb4a6fd1c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Kellner", "link": "https://stackoverflow.com/users/4466402/lucas-kellner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482360453, "last_edit_date": 1482360453, "creation_date": 1482360100, "answer_id": 41273137, "question_id": 41272629, "link": "https://stackoverflow.com/questions/41272629/create-a-macro-that-extracts-information-from-a-temporal-sheet/41273137#41273137", "title": "Create a macro that extracts information from a temporal sheet", "body": "<p>It is possible to open a FileDialog and have the user navigate to the file.  Would that interest you?  Code example here:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865217.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff865217.aspx</a></p>\n\n<p>I adapted the above to one of my projects by setting the parameters of the dialog box to allow the user to pick from PDF files.  Here is my modified version:</p>\n\n<pre><code>Function PDFLocator(InitialPath As String) as String\n    'Declare a variable as a FileDialog object.\n    Dim fd As FileDialog\n\n    'Create a FileDialog object as a File Picker dialog box.\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    'Declare a variable to contain the path\n    'of each selected item. Even though the path is aString,\n    'the variable must be a Variant because For Each...Next\n    'routines only work with Variants and Objects.\n    Dim vrtSelectedItem As Variant\n\n    'Use a With...End With block to reference the FileDialog object.\n    With fd\n        ' Set up the dialog box\n        .AllowMultiSelect = False\n        .ButtonName = \"S&amp;elect\"\n        .Filters.Clear\n        .Filters.Add \"Scanned Document\", \"*.pdf\", 1\n        .Title = \"File Dialog Box\"\n        .InitialFileName = InitialPath\n        .InitialView = msoFileDialogViewDetails\n\n        'Use the Show method to display the File Picker dialog box and return the user's action.\n        'The user pressed the button.\n        If .Show = -1 Then\n\n            'Step through each string in the FileDialogSelectedItems collection.\n            For Each vrtSelectedItem In .SelectedItems\n\n                'vrtSelectedItem is aString that contains the path of each selected item.\n                'You can use any file I/O functions that you want to work with this path.\n                'This example displays the path in a message box.\n                'MsgBox \"The path is: \" &amp; vrtSelectedItem\n                PDFLocator = vrtSelectedItem\n\n            Next vrtSelectedItem\n        'The user pressed Cancel.\n        Else\n        End If\n    End With\n\n    'Set the object variable to Nothing.\n    Set fd = Nothing\nEnd Function\n</code></pre>\n\n<p>It is possible to locate columns based on the column name or header row.  You can use the Find method to get the range.column here is a line from one of my projects:</p>\n\n<pre><code>DataColNumber = wb.wks.Range(\"1:1\").Find(\"Machine\", LookIn:=xlValues, lookat:=xlWhole).Column\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1482383302, "creation_date": 1482383302, "answer_id": 41276125, "question_id": 41272629, "link": "https://stackoverflow.com/questions/41272629/create-a-macro-that-extracts-information-from-a-temporal-sheet/41276125#41276125", "title": "Create a macro that extracts information from a temporal sheet", "body": "<p>If the beginning of the file name will always be \"ExportReport\", and there will only ever be one \"ExportReport\" file in that folder, you could loop through all of the files in that folder, looking for just that bit of the filename.</p>\n\n<pre><code>Function GetFileName() as String\n    Dim MyObj As Object, MySource As Object, file As Variant\n   file = Dir(\"c:\\[path to Programs(x86)]\\\")\n   While (file &lt;&gt; \"\")\n      If InStr(file, \"ExportReport\") &gt; 0 Then 'This is looking for the string \"ExportReport\" in each filename, and will exit when it finds a file that matches.\n         GetFileName = file\n         Exit Sub\n      End If\n     file = Dir\n  Wend\nEnd Function\n</code></pre>\n\n<p>Then you can use the output of this in place of your filename. For example:</p>\n\n<pre><code>filename = GetFileName\nActiveCell.FormulaR1C1 = _\n        \"=MAX('\" &amp; filename &amp; \"'!C5)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7327744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kwvEM.jpg?s=128&g=1", "display_name": "G.Medina", "link": "https://stackoverflow.com/users/7327744/g-medina"}, "is_accepted": true, "score": 0, "last_activity_date": 1483564642, "last_edit_date": 1483564642, "creation_date": 1483563430, "answer_id": 41473100, "question_id": 41272629, "link": "https://stackoverflow.com/questions/41272629/create-a-macro-that-extracts-information-from-a-temporal-sheet/41473100#41473100", "title": "Create a macro that extracts information from a temporal sheet", "body": "<p>Ok so I finally got it working, </p>\n\n<p>First a created this</p>\n\n<pre><code>Sub ExtractInfoOnTemp()\n'\n' Macro1 Macro\n' Extracts \"Max\",\"Count\" &amp; \"Sum\" From Temporal File\n'\n' Keyboard Shortcut: Ctrl+Shift+T\n'\nActiveCell.FormulaR1C1 = \"=MAX(C[4])\"\n Range(\"A1\").Select\n\nSelection.NumberFormat = \"m/d/yyyy\"\n Range(\"B1\").Select\n\nActiveCell.FormulaR1C1 = \"=COUNT(C[9])\"\n  Range(\"A1\").Select\n\nSelection.End(xlToLeft).Select\n    Range(\"C1\").Select\n\nActiveCell.FormulaR1C1 = \"=SUM(C[8])\"\n  Range(\"C1\").Select\n\nSelection.Style = \"Currency\"\nSelection.End(xlToLeft).Select\n\nEnd Sub\n</code></pre>\n\n<p>This extracts the data on the sheet being worked on on the first row, there are only 3 values to it, Its not used directly</p>\n\n<p>Then I created this one, whichs copy pastes it to the Master sheet, that on is constant so the name stays there, if anything I just change the name</p>\n\n<pre><code>Sub PrintInfoInMaster()\nCurWkbk = ActiveWorkbook.Name\nDim c\nDim example As Range\n\nSet example = Range(\"A1:C4\")\nApplication.Run \"PERSONAL.XLSB!ExtractInfoOnTemp\"\nActiveCell.Range(\"A1:C1\").Select\nSelection.Copy\nWindows(\"AllNonParSummary - MASTER.xlsx\").Activate\n\n'This is to look for the first empy cel from top to botom and select it     to paste the info\nFor Each c In Range(\"H:H\").Cells \nIf c = \"\" Then\nc.Select\n Exit For\n    End If\n\nNext\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nActiveCell.Offset(0, 1).Range(\"Table1[[#Headers],[ProviderLastName]]\").Select\nWindows(CurWkbk).Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7327744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kwvEM.jpg?s=128&g=1", "display_name": "G.Medina", "link": "https://stackoverflow.com/users/7327744/g-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 41473100, "answer_count": 3, "score": 0, "last_activity_date": 1483564642, "creation_date": 1482357651, "last_edit_date": 1482366618, "question_id": 41272629, "link": "https://stackoverflow.com/questions/41272629/create-a-macro-that-extracts-information-from-a-temporal-sheet", "title": "Create a macro that extracts information from a temporal sheet", "body": "<p>I have a master sheet in which i have to extract info from another one, this sheet is generated from XML file of a program created long time ago for the company but it automatically opens it up in excel.</p>\n\n<p>That file is saved in some folder in the Programs(x86) folder, so the name will always change, also is not only one file, every time I open a new record it will be saved there</p>\n\n<p>The things I need to extract, is a</p>\n\n<pre><code>=Max (Column X:X)\n=Count (Y:Y)\n=Sum (Y:Y) (From that same last one)\n</code></pre>\n\n<p>I recorded a macro, but for the file path it will get the one I recorded it with.</p>\n\n<p>I don't know how to make it to be for the other excel sheet besides changing the file path manually</p>\n\n<p>I was wondering if something like (if there is another sheet open extract it from there, making only 2 sheets to be open to avoid the code crashing?) can be created, or something else?</p>\n\n<p>Also, the columns will always have the same name, but not the same position, could it be referenced with the name of the column?</p>\n\n<p>This is the macro I recorded</p>\n\n<pre><code> Sub test_2()\n' test_2 Macro\n' asdad\n' Keyboard Shortcut: Ctrl+Shift+T\n    ActiveCell.Select&lt;br&gt;\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = _\n        \"=MAX('ExportReport27d8b91d-bafc-4437-a37d-90e53df817f8.htm'!C5)\"\n    ActiveCell.Offset(0, 1).Range(\"Table1[[#Headers],[TaxID]]\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=COUNT('ExportReport27d8b91d-bafc-4437-a37d-90e53df817f8.htm'!C11)\"\n    ActiveCell.Offset(0, 1).Range(\"Table1[[#Headers],[TaxID]]\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=SUM('ExportReport27d8b91d-bafc-4437-a37d-90e53df817f8.htm'!C11)\"\n    ActiveCell.Offset(1, 0).Range(\"Table1[[#Headers],[TaxID]]\").Select\nEnd Sub\n</code></pre>\n\n<p>I'm also open for suggestions, maybe a different method.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1482356513, "post_id": 41272297, "comment_id": 69746150, "body": "@DomainsFeatured - I&#39;m not sure whether I deserved any reputation upvote for that answer - it was way too easy."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 1, "creation_date": 1482356717, "post_id": 41272297, "comment_id": 69746236, "body": "@DomainsFeatured P.S.  You might benefit from reading up on some of the VBA functions: <a href=\"https://www.techonthenet.com/excel/formulas/index_vba.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/index_vba.php</a>"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1482356215, "creation_date": 1482356215, "answer_id": 41272297, "question_id": 41272269, "link": "https://stackoverflow.com/questions/41272269/how-to-set-case-to-omit-any-words-less-than-x-characters/41272297#41272297", "title": "How To Set Case To Omit Any Words Less Than X Characters", "body": "<p>Test the length of the word:</p>\n\n<pre><code>For i = 0 To UBound(words, 1)\n    If Len(words(i)) &gt; 2 Then\n        Select Case words(i)\n            Case = \"and\", \"big\", \"small\", \"whatever else you want to add\"\n            Case Else\n                For Each phrase In phrases\n                    If InStr(1, phrase.Value, words(i)) Then\n                        matches = matches &amp; phrase &amp; \"/\"\n                    End If\n                Next phrase\n        End Select\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1482356712, "creation_date": 1482356712, "answer_id": 41272400, "question_id": 41272269, "link": "https://stackoverflow.com/questions/41272269/how-to-set-case-to-omit-any-words-less-than-x-characters/41272400#41272400", "title": "How To Set Case To Omit Any Words Less Than X Characters", "body": "<pre><code>Dim forbiddenWordsArr As Variant\nDim forbiddenWords As String\n\nforbiddenWordsArr= Array(\"and\",\"or\",\"big\",\"small\",\"whatever else you want to add\")\nforbiddenWords=\"|\" &amp; Join(forbiddenWordsArr,\"|\"), &amp; \"|\"\nFor i = 0 To UBound(words, 1)\n    Select Case True\n        Case = Len(words(i))&lt;3 or InStr(forbiddenWords, \"|\" &amp; words(i) &amp; \"|\") &gt; 0\n\n        Case Else\n\n   ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1482405901, "creation_date": 1482405901, "answer_id": 41282058, "question_id": 41272269, "link": "https://stackoverflow.com/questions/41272269/how-to-set-case-to-omit-any-words-less-than-x-characters/41282058#41282058", "title": "How To Set Case To Omit Any Words Less Than X Characters", "body": "<p>I looked back at the original link you posted leading in to this.</p>\n\n<p>I think you would be better off removing all the unnecessary words (your blacklist and less than 3 characters) which this <code>Regexp</code> does, leaving the white-listed words in a 1D array for use with your phrases.</p>\n\n<pre><code>Dim StrIn As String\nDim objRegex As Object\nDim Words\n\nStrIn = Join(Application.Transpose(ThisWorkbook.Worksheets(\"Topics\").Range(\"D1:D3000\")), Chr(32))\n\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n  .Pattern = \"\\b([a-z]{1,2}|and|or|big|small)\\b\"\n  .Global = True\n  .ignorecase = True\nStrIn = Application.Trim(.Replace(StrIn, vbNullString))\nEnd With\n\nWords = Split(StrIn, Chr(32))\n</code></pre>\n"}], "owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 41272297, "answer_count": 3, "score": 1, "last_activity_date": 1482405901, "creation_date": 1482356102, "last_edit_date": 1495540418, "question_id": 41272269, "link": "https://stackoverflow.com/questions/41272269/how-to-set-case-to-omit-any-words-less-than-x-characters", "title": "How To Set Case To Omit Any Words Less Than X Characters", "body": "<p>I'm working with the following loop. I have a case that omits or <a href=\"https://stackoverflow.com/questions/41271023/how-to-blacklist-words-in-vba-code\">blacklists certain words in VBA</a>. However, I would like to omit any words that are less than 3 characters.</p>\n\n<pre><code>For i = 0 To UBound(words, 1)\n    Select Case words(i)\n        Case = \"and\",\"or\",\"big\",\"small\",\"whatever else you want to add\"\n        Case Else\n            For Each phrase In phrases\n                If InStr(1, phrase.Value, words(i)) Then\n                    matches = matches &amp; phrase &amp; \"/\"\n                End If\n            Next phrase\n    End Select\nNext i\n</code></pre>\n\n<p>Anyone know how to do that? I'm thinking <code>Case =&gt; \"[something for 3 characters]\"</code> to be inserted along with the additional code. You positive input and support is appreciated. </p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7327642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb1773463866383f18d695ffe2e2107?s=128&d=identicon&r=PG&f=1", "display_name": "Forensic Gator", "link": "https://stackoverflow.com/users/7327642/forensic-gator"}, "edited": false, "score": 0, "creation_date": 1482424195, "post_id": 41272966, "comment_id": 69777569, "body": "My poor work laptop can&#39;t handle the size of the file. I did a test run with a smaller file and it worked great. Thanks! I will keep this in my library so smaller projects until I get a more powerful computer :)"}], "tags": [], "owner": {"reputation": 133, "user_id": 4258385, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c41972ad3daddb1f5a08a8f2da6e30ab?s=128&d=identicon&r=PG&f=1", "display_name": "lorgan", "link": "https://stackoverflow.com/users/4258385/lorgan"}, "is_accepted": false, "score": 0, "last_activity_date": 1482359262, "creation_date": 1482359262, "answer_id": 41272966, "question_id": 41272212, "link": "https://stackoverflow.com/questions/41272212/excel-list-to-powerpoint-slide-header/41272966#41272966", "title": "Excel List to PowerPoint Slide Header", "body": "<p>Create a blank ppt file - in the first slide paste in a single column table with your excel data, Ive assumed your required headers are in each row. Name the table (Ive used HeadersTable) - you can use the Selection Pane to do this found on the Home tab.</p>\n\n<p>Open the VBA editor in ppt - Alt+F11, add a new module and run the below code. </p>\n\n<pre><code>Sub createHeaders()\n\n    Dim sl As Slide\n    Dim tbl As Table\n    Dim shp As Shape\n    Dim i As Long\n\n    Set sl = ActivePresentation.Slides(1)\n    Set tbl = sl.Shapes(\"HeadersTable\").Table\n\n    For i = 1 To tbl.Rows.Count\n\n        Set sl = ActivePresentation.Slides.Add(i + 1, ppLayoutTitleOnly)\n        Set shp = sl.Shapes(\"Title 1\")\n        shp.TextFrame.TextRange.Text = tbl.Rows(i).Cells.Item(1).Shape.TextFrame.TextRange.Text\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7327642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb1773463866383f18d695ffe2e2107?s=128&d=identicon&r=PG&f=1", "display_name": "Forensic Gator", "link": "https://stackoverflow.com/users/7327642/forensic-gator"}, "edited": false, "score": 0, "creation_date": 1482424256, "post_id": 41273227, "comment_id": 69777608, "body": "I was able to do this in 4 separate projects. Thanks so much!"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1482360516, "creation_date": 1482360516, "answer_id": 41273227, "question_id": 41272212, "link": "https://stackoverflow.com/questions/41272212/excel-list-to-powerpoint-slide-header/41273227#41273227", "title": "Excel List to PowerPoint Slide Header", "body": "<p>Save from Excel to a plain text file. You'll probably need to break this up into a couple of steps because PPT won't handle more than a certain number of these at a go.</p>\n\n<p>Then start PowerPoint and choose File | Open, Files of type: <em>.</em>\nChoose your text file and let PPT open it.</p>\n\n<p>Rinse and repeat.</p>\n"}], "owner": {"reputation": 1, "user_id": 7327642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb1773463866383f18d695ffe2e2107?s=128&d=identicon&r=PG&f=1", "display_name": "Forensic Gator", "link": "https://stackoverflow.com/users/7327642/forensic-gator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482360516, "creation_date": 1482355884, "question_id": 41272212, "link": "https://stackoverflow.com/questions/41272212/excel-list-to-powerpoint-slide-header", "title": "Excel List to PowerPoint Slide Header", "body": "<p>I have looked at a ton of questions that have already been posted but nothing quite fits what I am looking for. I have an excel list of ~ 750 different title/headers that I need to use to create PPT slides. I just need to create a titled but otherwise blank PPT slide. I am extremely new to coding and most of the solutions are more complicated that I need (i.e. importing charts and pictures). Any help to point a noob in the right direction would be greatly appreciated :)</p>\n"}, {"tags": ["excel", "vba", "indexing", "macros", "match"], "comments": [{"owner": {"reputation": 1025, "user_id": 2026740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe3644e242eeabe917840ddd85204d1?s=128&d=identicon&r=PG", "display_name": "Daniel Corzo", "link": "https://stackoverflow.com/users/2026740/daniel-corzo"}, "edited": false, "score": 0, "creation_date": 1482354644, "post_id": 41271868, "comment_id": 69745239, "body": "Hello and welcome to StackOverflow. Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482354970, "post_id": 41271868, "comment_id": 69745413, "body": "<code>Match(Sheet4.Cells(i,&quot;Q&quot;).Value...</code>"}, {"owner": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482356308, "post_id": 41271868, "comment_id": 69746049, "body": "Thank you, Scott! Unfortunately it says Run-time error &#39;1004&#39;: Method &#39;Range&#39; of object&#39;_Worksheet&#39; failed. Maybe there&#39;s another bigger issue in my code..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482356418, "post_id": 41272077, "comment_id": 69746102, "body": "I appreciate your quick answer, Pete. Unfortunately I&#39;m getting this: &quot;Run-time error &#39;0&#39;: Subscript out of range&quot;. Do you have an idea what that means?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482357429, "post_id": 41272077, "comment_id": 69746569, "body": "did you define LastRowSheet4 and LastRowSheet8?"}, {"owner": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482357627, "post_id": 41272077, "comment_id": 69746664, "body": "Yep, like this: LastRowSheet4 = Sheet4.Cells(Cells.Rows.Count, &quot;K&quot;).End(xlUp).Row LastRowSheet8 = Sheet8.Cells(Cells.Rows.Count, &quot;B&quot;).End(xlUp).Row"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482361757, "post_id": 41272077, "comment_id": 69748350, "body": "you should try it like this: LastRowSheet4 = Worksheets(&quot;Sheet4&quot;).Cells(Cells.Rows.Count, &quot;K&quot;).End(xlUp).Row"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482361804, "post_id": 41272077, "comment_id": 69748366, "body": "And did you dim LastRowSheet4 as anything? It&#39;s always hard to guess the error when you can&#39;t see the full code."}, {"owner": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482401889, "post_id": 41272077, "comment_id": 69763108, "body": "I changed both, but nothing worked. I pasted the full code above. thank you so much!"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "edited": false, "score": 0, "creation_date": 1482422991, "post_id": 41272077, "comment_id": 69776699, "body": "I&#39;m surprised your solution worked. When I run the code, i get an error that  Set src4 = Sheet2 and Set dst4 = Sheet4 are not defined as worksheets."}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 0, "last_activity_date": 1482355192, "creation_date": 1482355192, "answer_id": 41272077, "question_id": 41271868, "link": "https://stackoverflow.com/questions/41271868/index-match-in-vba/41272077#41272077", "title": "Index/Match in VBA", "body": "<p>Have you tried something like the following code:</p>\n\n<pre><code>For i = 1 To LastRowSheet4\n    For i2 = 1 To LastRowSheet8\n\n    If Worksheets(\"Sheet4\").Range(\"P\" &amp; i).Value = Worksheets(\"Sheet8\").Range(\"A\" &amp; i2).Value Then\n        Worksheets(\"Sheet4\").Range(\"Q\" &amp; i).Value = Worksheets(\"Sheet8\").Range(\"K\" &amp; i2).Value\n    End If\n\n    Next i2\nNext i\n</code></pre>\n\n<p>You will just need to define the upper ends of both sheets (LastRowSheet4 and LastRowSheet8) and this should work.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "is_accepted": false, "score": 0, "last_activity_date": 1482418431, "creation_date": 1482418431, "answer_id": 41285881, "question_id": 41271868, "link": "https://stackoverflow.com/questions/41271868/index-match-in-vba/41285881#41285881", "title": "Index/Match in VBA", "body": "<p>Thanks for your help. I solved the problem with recording a macro and modifying it:</p>\n\n<pre><code>Sheet4.Cells(3, 17).FormulaR1C1 = _\n        \"=INDEX('TS-48 Matrix'!C[-7],MATCH('Missing Both'!RC[-1],'TS-48 Matrix'!C[-16],0))\"\nRange(\"Q3\").AutoFill Destination:=Range(\"Q3:Q\" &amp; lastRowSheet4)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7327619, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5eHVAfHumM/AAAAAAAAAAI/AAAAAAAABxY/NSi9lzhQWeo/photo.jpg?sz=128", "display_name": "Andy Weinzierl", "link": "https://stackoverflow.com/users/7327619/andy-weinzierl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1482418431, "creation_date": 1482354211, "last_edit_date": 1482401825, "question_id": 41271868, "link": "https://stackoverflow.com/questions/41271868/index-match-in-vba", "title": "Index/Match in VBA", "body": "<p>I tried several ways, but I still have a problem in my code.</p>\n\n<p>What I want to do (this example in <strong>Q2 on Sheet4</strong>):</p>\n\n<pre><code>=INDEX('Sheet8'!K:K,MATCH('Sheet4'!P2,'Sheet8'!A:A,0))\n</code></pre>\n\n<p>I'd like to do it for all rows with content in column <strong>K on Sheet 4</strong> so I'll probably need \"For i = 1...\"</p>\n\n<p>What I tried:</p>\n\n<pre><code>For i = 1 To LastRowShort\nrow_mtch = Application.WorksheetFunction.Match(Sheet4.Cells(\"Q????\").Value, Sheet8.Range(\"A1:A\"), 0)\n\nSheet4.Range(\"R\" &amp; i).Value = Application.WorksheetFunction.Index(Sheet8.Range(\"K1:K\" &amp; LastRowShort), row_mtch)\nNext i\n</code></pre>\n\n<p>Thanks a lot!\nAndy</p>\n\n<p>Entire Module:</p>\n\n<pre><code>Sub MissingBoth()\n\nApplication.ScreenUpdating = False\n\n Dim MyRange, CopyRange As Range\n Dim LastRow As Long\n Dim LastRowSheet4 As Long\n Dim LastRowSheet8 As Long\n Set src4 = Sheet2\n Set dst4 = Sheet4\nLastRow = src4.Cells(Cells.Rows.Count, \"D\").End(xlUp).Row\nLastRowSheet8 = Worksheets(\"Sheet8\").Cells(Cells.Rows.Count, \"B\").End(xlUp).Row\nLastRowSheet4 = Worksheets(\"Sheet4\").Cells(Cells.Rows.Count, \"K\").End(xlUp).Row\n\n src4.Unprotect\n dst4.Unprotect\n\n If src4.FilterMode = True Then\n    src4.ShowAllData\nEnd If\n\n dst4.Cells.ClearFormats\n dst4.Cells.Clear\n\n\n 'Find content in the \"Type of Rack\" cells\n    j = 3\n    For i = 10 To LastRow\n        If src4.Cells(i, \"CL\").Value = \"\" And src4.Cells(i, \"GV\").Value = \"\" Then\n        src4.Cells(i, \"CL\").EntireRow.Copy dst4.Cells(j, 1)\n            j = j + 1\n        End If\n    Next i\n\nsrc4.Range(\"A6:GW7\").Copy Destination:=dst4.Range(\"A1:GW2\")\n\n'Copy every column EXCEPT the following\ndst4.Range(\"GW1,CM1:GU1, U1:CK1,R1:S1,P1,J1:M1\").EntireColumn.Delete\n\nFor i = 1 To LastRowSheet4\n    For i2 = 1 To LastRowSheet8\n\n    If Worksheets(\"Sheet4\").Range(\"P\" &amp; i).Value = Worksheets(\"Sheet8\").Range(\"A\" &amp; i2).Value Then\n        Worksheets(\"Sheet4\").Range(\"Q\" &amp; i).Value = Worksheets(\"Sheet8\").Range(\"K\" &amp; i2).Value\n    End If\n\n    Next i2\nNext i\n\ndst4.Columns(\"A:AX\").EntireColumn.AutoFit\ndst4.Rows(\"1:500\").RowHeight = 15\ndst4.Columns(\"N:O\").Interior.Color = vbYellow\ndst4.Rows(\"1:2\").Interior.ColorIndex = 15\ndst4.Range(\"B:I\").EntireColumn.Hidden = True\n\n Application.ScreenUpdating = True\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1482352551, "post_id": 41271402, "comment_id": 69744139, "body": "Here are 2 solutions: 1) Use parameterized query.  See here: <a href=\"http://stackoverflow.com/questions/31059553/how-to-run-parameterized-query-from-vba-parameters-sourced-from-recordset\" title=\"how to run parameterized query from vba parameters sourced from recordset\">stackoverflow.com/questions/31059553/&hellip;</a> 2) create <code>Parameterize</code> procedure that will scrub your string by replacing single and double quotes by a double version of itself."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1482352610, "post_id": 41271402, "comment_id": 69744174, "body": "try <code>REPLACE(Description,&quot;&#39;&quot;,&quot;&#39;&#39;&quot;)</code>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1482352627, "post_id": 41271402, "comment_id": 69744183, "body": "See here: <a href=\"http://stackoverflow.com/questions/13134070/dealing-with-single-quotes-in-excel-vba-sql-queries\" title=\"dealing with single quotes in excel vba sql queries\">stackoverflow.com/questions/13134070/&hellip;</a> for an example of the second solution (without a procedure, just in the SQL build)"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1482390428, "post_id": 41271402, "comment_id": 69756484, "body": "Alternatively, use my <i>CSql</i> function listed <a href=\"http://stackoverflow.com/questions/36996045/insert-order-to-ms-access-from-vb6/36997461#36997461\">here</a> to concatenate the values in a structured manner."}, {"owner": {"reputation": 133, "user_id": 7327542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd031733aa7692ffdbdef0ed6907bf4?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/7327542/scott"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1482418928, "post_id": 41271402, "comment_id": 69773893, "body": "Thanks for the responses guys, the replace funtion seems to eb what i am looking for. I dont ge tthe syntax error in my dlookup now, but the parameter still isnt finding the term in my domain with the new string:test1 = Me.desc.Value      <code>test2 = Replace(test1, &quot;&#39;&quot;, &quot;&#39;&#39;&quot;)     Dim DQ As String     DQ = Chr(34)      test1 = Replace(test2, DQ, DQ &amp; DQ) </code> @DStanley"}, {"owner": {"reputation": 133, "user_id": 7327542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd031733aa7692ffdbdef0ed6907bf4?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/7327542/scott"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1482419164, "post_id": 41271402, "comment_id": 69774019, "body": "my dlookup criteria went from 1&#39; x 4&quot; Steel Rod to 1&#39;&#39; x 4&quot;&quot; Steel Rod but returned no results from my domain inventory where there is definitely an entry 1&#39; x 4&quot; Steel Rod. do i have to replace the quotes in the domain too somehow? @DStanley"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1482419246, "post_id": 41271402, "comment_id": 69774069, "body": "You shouldn&#39;t need to replace double-quotes within a string variable.  You&#39;d only need to do that in a string <i>literal</i>."}, {"owner": {"reputation": 133, "user_id": 7327542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd031733aa7692ffdbdef0ed6907bf4?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/7327542/scott"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1482419630, "post_id": 41271402, "comment_id": 69774321, "body": "@DStanley Okay, removed the double quotes code, runs through with no syntax error. Okay terrific. I should&#39;ve just taken your exact advice instead of extrapolating. Thank you very much"}], "owner": {"reputation": 133, "user_id": 7327542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd031733aa7692ffdbdef0ed6907bf4?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/7327542/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "closed_date": 1482352667, "answer_count": 0, "score": 0, "last_activity_date": 1593956978, "creation_date": 1482352179, "last_edit_date": 1593956978, "question_id": 41271402, "link": "https://stackoverflow.com/questions/41271402/single-and-double-quotes-in-dynamic-sql-criteria", "closed_reason": "Duplicate", "title": "Single and Double Quotes in dynamic SQL Criteria", "body": "<p>I am doing Data base coding based on a large quantity of driving material descriptions. A ton (Thousands) of these variables include measurements such as 1' x 4\" Steel Rod for example</p>\n\n<p>I can't escape the quote in the criteria SQL because my criteria is dynamic. How else can I escape the quote?</p>\n\n<pre><code>If IsNull(Me.part.Value) = True Then\n'if no part entered, use description\nDescription = Me.desc.Value\n'look up the data on this part\nMe.Quantity.Value = Nz(DLookup(\"[Inventory]\", \"myQuery\", \"[myQuery]!_\n[Material Description] ='\" &amp; Description &amp; \"' And [myQuery]![Dept] ='\" &amp; dept &amp; \"'\"))\n</code></pre>\n\n<p>where description is from a combobox that is filled based on department such as 1' x 4\" Steel Rod </p>\n\n<p>EDIT: Most questions that this would be related as duplicate are looking for single quotes only such as names with single quotes whereas I have fields with several single and double quotes int he same criteria</p>\n"}, {"tags": ["excel", "git", "vba", "module", "worksheet"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1482351477, "post_id": 41271171, "comment_id": 69743524, "body": "I replied to a similar question yesterday <a href=\"http://stackoverflow.com/questions/41240745/version-control-system-for-excel-vba-code/41241212#41241212\" title=\"version control system for excel vba code\">stackoverflow.com/questions/41240745/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482354621, "post_id": 41271290, "comment_id": 69745227, "body": "FWIW I don&#39;t think there <i>is</i> a solution to this problem. It&#39;s just a nasty side-effect of VBA being embedded into a host document, and that&#39;s the very nature of it."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 2, "last_activity_date": 1482352079, "last_edit_date": 1495539944, "creation_date": 1482351749, "answer_id": 41271290, "question_id": 41271171, "link": "https://stackoverflow.com/questions/41271171/how-to-export-sheet-buttons-and-details-with-vba/41271290#41271290", "title": "How to Export Sheet Buttons and Details with VBA", "body": "<p>I replied to a similar question yesterday <a href=\"https://stackoverflow.com/questions/41240745/version-control-system-for-excel-vba-code/41241212#41241212\">Version control system for Excel-VBA code</a></p>\n\n<p>Source controlling sheets is tough.  Imagine you serialise data in cells A1,A2,A3 so you might have</p>\n\n<pre><code>A1:\"Foo\"\nA2:\"Bar\"\nA3:\"Baz\"\n...\nA5577: \"Kevin\"\n</code></pre>\n\n<p>i.e. plenty of rows.  then you insert a row at line at the top, so 3 for example, then all of the rows below would then be out of sync and would throw 5000! mismatchs in a version comparison; this was quite irritating (when I worked on a system that did this).</p>\n\n<p>Perhaps you might like to have a good think about this problem and post a possible solution.  Having a quick think about it myself, I wonder if some logic analogous to a linked list would help.  So, one serialises a cell and then also serializes a link to the next cell and one traverse a whole list of cells.  Then a single row insert would only require one change, a link insertion.</p>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1482354804, "post_id": 41271929, "comment_id": 69745328, "body": "I agree with last phrase in penultimate paragraph, write code to draw on the sheet and then you can diff that code to see how the sheet has changed."}, {"owner": {"reputation": 1982, "user_id": 2664815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mmDaY.jpg?s=128&g=1", "display_name": "aCarella", "link": "https://stackoverflow.com/users/2664815/acarella"}, "edited": false, "score": 0, "creation_date": 1482356081, "post_id": 41271929, "comment_id": 69745932, "body": "Yes. Definitely want version control for the UI/sheets, not the data that lives on them. As in, I could write code that constructs the UI, which is what you mentioned. I might do just that so I can then implement that code into the rest of the project&#39;s version control. Very helpful answer."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1482354516, "creation_date": 1482354516, "answer_id": 41271929, "question_id": 41271171, "link": "https://stackoverflow.com/questions/41271171/how-to-export-sheet-buttons-and-details-with-vba/41271929#41271929", "title": "How to Export Sheet Buttons and Details with VBA", "body": "<p>A \"sheet\" is a <code>Document</code>-type <code>VBComponent</code>, which <em>is</em> a class module, subclassing a specific object type in the host application's object model (here a <code>Worksheet</code> class). So the \"code\" part is exported as a class module; the \"document\" part is, well, your host document - that content is <strong>much</strong> more than just cell values and formulas (fonts, cell formats, conditional formats, cell comments, shapes, etc.), and in Office 2007+ those are serialized in an XML format, wrapped-up in a .zip (which is then renamed with a .xlsx extension): for <em>proper</em> source control of the document you need the diffs on the actual XML.</p>\n\n<p>Moreover, you can't import a document-type <code>VBComponent</code> back into a <code>VBProject</code>, because it's the host application that owns document-type components. For example to add a worksheet to <code>ThisWorkbook</code>, you need to use the Excel object model and call <code>ThisWorkbook.Worksheets.Add</code>; ditto for removing them.</p>\n\n<p>That's why there is no source control solution for VBA that deals with every single use case: for it to be full-featured, it would have to be able to modify the compressed XML of the document's very structure, <em>while that document is opened</em>, by loading the XML from disk.</p>\n\n<p>I have this OSS project, <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a>, which features integrated Git source control:</p>\n\n<p><img src=\"https://i.stack.imgur.com/N9cMf.png\" alt=\"Rubberduck&#39;s Source Control panel\"></p>\n\n<p>It's host-agnostic, so there's nothing host-specific about what it does - but even if some <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/2437#issuecomment-267960811\" rel=\"nofollow noreferrer\">claim \"it's simple\"</a>, the reality is that, well, it isn't: one person will be happy with being able to restore the code-behind; another will want the cell values and formulas; another will need to be able to restore shapes and their formats and assigned macros, and another person will complain because they lose their conditional formats when restoring their project from source control: at the end of the day the only way to have a document-type <code>VBComponent</code> under source control, is to extract its XML and keep <em>that</em> under source control... but then, you can't quite <em>restore</em> the document.</p>\n\n<p>The only reasonable solution, is to decouple the VBA code implmentation from the document as much as possible - write VBA code that works regardless of what worksheets are in the workbook the code is hosted in; parameterize everything, and have a module that generates the worksheet layouts and formats and whatnot - in other words, don't \"design\" the worksheets (in Excel), \"code\" them (in the VBE).</p>\n\n<p>As for the data... well, tough luck: source control is meant to be for <em>code</em>, not for <em>data</em>.</p>\n"}], "owner": {"reputation": 1982, "user_id": 2664815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mmDaY.jpg?s=128&g=1", "display_name": "aCarella", "link": "https://stackoverflow.com/users/2664815/acarella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 1, "accepted_answer_id": 41271929, "answer_count": 2, "score": 1, "last_activity_date": 1482354516, "creation_date": 1482351196, "question_id": 41271171, "link": "https://stackoverflow.com/questions/41271171/how-to-export-sheet-buttons-and-details-with-vba", "title": "How to Export Sheet Buttons and Details with VBA", "body": "<p>I've been messing around with importing/exporting VBA modules and classes in an Excel app that I work on. Seems really useful to use with version control. I like it. I can easily implement code changes in modules, export my changes, commit and push my changes, and \"reload\" (delete all modules and re-import) my changes in another instance of the Excel app.</p>\n\n<p>However, I can't find a way to use this with sheets. If I add a visual change to a sheet (say, I add a button or change the way the sheet looks), is there a way to export the sheet as code, just like modules, so that I can then import the sheet exactly as it looked from my changes?</p>\n\n<p>I'm aware of some pseudo-solutions to this already, but are either not going to fit into what I need in terms of version control, or will be too much of a lift. For one, I can write a VBA script to copy my Excel app to a .xlsx file, which will house any of my sheet changes, and then I can import them into another instance of the app if I wanted to. The problem with that is that I won't be able to include them in my version control. I also know that I can write scripts in the event <code>Workbook_Open</code> to essentially make my user interface on my sheets programmatically each time the Excel app is opened. This will solve my problem of committing my code, but is too much of a lift.</p>\n\n<p>Any suggestions or solutions to this problem?</p>\n\n<p>EDIT: To be clear, I'm aware that I can export my sheets as modules as well. However, there doesn't seem anything that indicates what the sheet looked like on export. Consequently, when I import the \"sheet\", it is imported as a class module.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1482352241, "post_id": 41271204, "comment_id": 69743944, "body": "Actually, I got the first term to work! The ones after the first comma don&#39;t work though."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1482352928, "post_id": 41271204, "comment_id": 69744333, "body": "Change <code>Case &lt;&gt; &quot;and&quot;,&quot;or&quot;,&quot;big&quot;,&quot;small&quot;,&quot;whatever else you want to add&quot;</code> to <code>Case &quot;and&quot;, &quot;or&quot;, &quot;big&quot;, &quot;small&quot;, &quot;whatever else you want to add&quot;</code> followed by <code>Case Else</code> (The current format is testing <code>(&lt;&gt; &quot;and&quot;) OR (= &quot;or&quot;) OR (= &quot;big&quot;) etc</code>)"}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482353324, "post_id": 41271204, "comment_id": 69744544, "body": "@YowE3K, that helped, but for some reason, certain terms like small are still being left in"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482353574, "post_id": 41271204, "comment_id": 69744670, "body": "@SMeaden <code>Case Is &lt;&gt; &quot;and&quot;, &quot;or&quot;, &quot;big&quot;, &quot;small&quot;, &quot;whatever else you want to add&quot;</code> is interpreted as <code>Case Is &lt;&gt; &quot;and&quot;, Is = &quot;or&quot;, Is = &quot;big&quot;, Is = &quot;small&quot;, Is = &quot;whatever else you want to add&quot;</code> and will evaluate to true as if the statement is <code>If testexpression &lt;&gt; &quot;and&quot; Or testexpression = &quot;or&quot; Or testexpression = &quot;big&quot; ....</code> - i.e. it inserts <code>Or</code> between each expression."}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482353749, "post_id": 41271204, "comment_id": 69744773, "body": "Okay, just to update, @SMeaden is correct. It autocorrects to <code>Case Is &lt;&gt; &quot;and&quot;, &quot;or&quot;, &quot;big&quot;, &quot;small&quot;, &quot;whatever else you want to add&quot;</code> However, that only works for the first term. The following terms are not blacklisted."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1482353784, "post_id": 41271204, "comment_id": 69744793, "body": "@DomainsFeatured - is it &quot;small&quot; that is being left in, or something like &quot;Small&quot; - it will be case-sensitive unless extra code is used."}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1482353794, "post_id": 41271204, "comment_id": 69744798, "body": "@ScottHoltzman, can you see why it would only work for the first term? Your code is nearly perfect."}, {"owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482353892, "post_id": 41271204, "comment_id": 69744843, "body": "@YowE3K, it&#39;s leaving &quot;small&quot;, I made it&#39;s the same case"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1482354075, "post_id": 41271204, "comment_id": 69744938, "body": "@DomainsFeatured - Ah, I remember running across this issue in the past with <code>&lt;&gt;</code> in <code>Case</code> statements. See my edit and try again."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "edited": false, "score": 0, "creation_date": 1482354436, "post_id": 41271204, "comment_id": 69745123, "body": "@DomainsFeatured Not sure why &quot;small&quot; got past my suggestion, but not Scott&#39;s identical (apart from the leading [default] <code>=</code>) but as long as it works that&#39;s great."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 6, "last_activity_date": 1482354043, "last_edit_date": 1482354043, "creation_date": 1482351311, "answer_id": 41271204, "question_id": 41271023, "link": "https://stackoverflow.com/questions/41271023/how-to-blacklist-words-in-vba-code/41271204#41271204", "title": "How To Blacklist Words In VBA Code", "body": "<p>If I understand what you want correctly, you can place a <code>Select Case</code> statement inside the <code>For Each Loop</code></p>\n\n<pre><code>For i = 0 To UBound(words, 1)\n    Select Case words(i)\n        Case = \"and\",\"or\",\"big\",\"small\",\"whatever else you want to add\"\n        Case Else\n            For Each phrase In phrases\n                If InStr(1, phrase.Value, words(i)) Then\n                    matches = matches &amp; phrase &amp; \"/\"\n                End If\n            Next phrase\n    End Select\nNext i\n</code></pre>\n\n<p>However, this will get unwieldy if there are a large amount of terms. </p>\n\n<p>If there are a large amount of terms you can store the BlackListed Terms on a worksheet and then do something like this:</p>\n\n<pre><code>For i = 0 To UBound(words, 1)\n    If ThisWorkbook.Worksheets(\"Topics\").Range(\"BlackList\").Find(words(i),lookat:=xlWhole) is Nothing Then \n            For Each phrase In phrases\n                If InStr(1, phrase.Value, words(i)) Then\n                    matches = matches &amp; phrase &amp; \"/\"\n                End If\n            Next phrase\n    End If\nNext i\n</code></pre>\n\n<p><em>assumes BlackList is a namedrange. If not just replace with <code>A1:A100</code> or whatever the range is.</em></p>\n"}], "owner": {"reputation": 1304, "user_id": 3119675, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/06d6269d834a756fa777ebd9e6653748?s=128&d=identicon&r=PG&f=1", "display_name": "DomainsFeatured", "link": "https://stackoverflow.com/users/3119675/domainsfeatured"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 41271204, "answer_count": 1, "score": 3, "last_activity_date": 1482354043, "creation_date": 1482350607, "last_edit_date": 1495542827, "question_id": 41271023, "link": "https://stackoverflow.com/questions/41271023/how-to-blacklist-words-in-vba-code", "title": "How To Blacklist Words In VBA Code", "body": "<p>I have the following script that <a href=\"https://stackoverflow.com/questions/40661523/match-any-word-inside-cell-with-any-word-in-range-of-cells\">matches any word in a cell to any other word in a range of cells</a>. However, I would like the code to omit certain common terms like \"and, or, big, small\".</p>\n\n<p>I'm not very good with VBA, so I was hoping someone might be able to tell me where to add it into the code:</p>\n\n<pre><code>Sub FindSimilar()\nDim phrases As Range, phrase As Range\nDim terms As Range, term As Range\nDim matches As String\nDim words() As String\n\n'ensure this has the correct sheet names for your workbook\nSet phrases = ThisWorkbook.Worksheets(\"Export\").Range(\"B2:B2000\")\nSet terms = ThisWorkbook.Worksheets(\"Topics\").Range(\"D100:D3000\")\n\nFor Each term In terms\n    matches = \"\"\n    words() = Split(term.Value)\n\n    For i = 0 To UBound(words, 1)\n        For Each phrase In phrases\n            If InStr(1, phrase.Value, words(i)) Then\n                matches = matches &amp; phrase &amp; \"/\"\n            End If\n        Next phrase\n    Next i\n\n    If matches &lt;&gt; vbNullString Then\n        term.Offset(0, 6).Value = Left(matches, Len(matches) - 1)\n    Else\n        term.Offset(0, 6).Value = \"No match\"\n    End If\nNext term\nEnd Sub\n</code></pre>\n\n<p>How can I blacklist terms in the code? Your positive input and support is highly appreciated. </p>\n"}, {"tags": ["vba", "email", "outlook", "basic"], "comments": [{"owner": {"reputation": 1068, "user_id": 2125802, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd84962823581c3c103d14c88f4c38b9?s=128&d=identicon&r=PG", "display_name": "Marcelo", "link": "https://stackoverflow.com/users/2125802/marcelo"}, "edited": false, "score": 0, "creation_date": 1482355347, "post_id": 41270991, "comment_id": 69745593, "body": "Are they all running the same version of outlook? What error are you getting?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1482356325, "post_id": 41270991, "comment_id": 69746061, "body": "Do you run the code in Outlook on a third machine?"}, {"owner": {"reputation": 21, "user_id": 7327435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0410593c3b2e38fa8cde123bf49dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Duff", "link": "https://stackoverflow.com/users/7327435/steve-duff"}, "reply_to_user": {"reputation": 1068, "user_id": 2125802, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd84962823581c3c103d14c88f4c38b9?s=128&d=identicon&r=PG", "display_name": "Marcelo", "link": "https://stackoverflow.com/users/2125802/marcelo"}, "edited": false, "score": 0, "creation_date": 1483455245, "post_id": 41270991, "comment_id": 70098574, "body": "@Marcelo: They are all running the same version of Outlook. The error I am getting is &quot;Error # -2147417843. Automation error. An outgoing call cannot be made since the application is dispatching an input-synchronous call.&quot;"}, {"owner": {"reputation": 21, "user_id": 7327435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0410593c3b2e38fa8cde123bf49dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Duff", "link": "https://stackoverflow.com/users/7327435/steve-duff"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1483455405, "post_id": 41270991, "comment_id": 70098689, "body": "@EugeneAstafiev: Sorry, I don&#39;t understand part of your question. I am running the code from within VBA. What do you mean &quot;run the code in Outlook&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7327435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0410593c3b2e38fa8cde123bf49dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Duff", "link": "https://stackoverflow.com/users/7327435/steve-duff"}, "edited": false, "score": 0, "creation_date": 1483455774, "post_id": 41271124, "comment_id": 70098947, "body": "The code is being executed by a high-performance software program called TeleForm Reader. It is simply stays open as an application on a server (not in the tray). How can I start up a timer to run the code? I have been reading about that as a possible solution but haven&#39;t found a good URL that explains how to do it. Thanks."}, {"owner": {"reputation": 21, "user_id": 7327435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0410593c3b2e38fa8cde123bf49dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Duff", "link": "https://stackoverflow.com/users/7327435/steve-duff"}, "edited": false, "score": 0, "creation_date": 1483456025, "post_id": 41271124, "comment_id": 70099101, "body": "I believe that the third machine (called Reader) is doing some multi-threaded operations and that is why the error is coming up when trying to call Outlook from the third machine. I&#39;ve never had to deal with threads before. Ugh! If I can&#39;t figure a way around, I might have to switch my approach and try sending the email using MAPI or by using direct SMTP."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1482351039, "creation_date": 1482351039, "answer_id": 41271124, "question_id": 41270991, "link": "https://stackoverflow.com/questions/41270991/vba-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-in/41271124#41271124", "title": "VBA - An outgoing call cannot be made since the application is dispatching an input-synchronous call", "body": "<p>When exactly is that code being executed? Is it running from a tray icon event handler by any chance? </p>\n\n<p>Start up a timer, when the timer fires (you will be out of the incoming RPC call), run your code above.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7327435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0410593c3b2e38fa8cde123bf49dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Duff", "link": "https://stackoverflow.com/users/7327435/steve-duff"}, "is_accepted": true, "score": 0, "last_activity_date": 1483541943, "creation_date": 1483541943, "answer_id": 41466872, "question_id": 41270991, "link": "https://stackoverflow.com/questions/41270991/vba-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-in/41466872#41466872", "title": "VBA - An outgoing call cannot be made since the application is dispatching an input-synchronous call", "body": "<p>Thanks, everyone, for the intial responses. Turns out what solved the problem is to use CDO for sending the email. Here is the code that worked for me:</p>\n\n<pre><code>Set objMessage = CreateObject(\"cdo.message\")\nSet objConfig = CreateObject(\"cdo.configuration\")\nSet Flds = objConfig.Fields\nFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\nFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"myExchangeServerName\"\nFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1  'basic (clear-text) authentication\nFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"myDomain\\user@myDomain.com\"\nFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"myPassword\"\nFlds.Update\nSet objMessage.Configuration = objConfig\nobjMessage.To = \"toEmail@someDomain.com\"\nobjMessage.From = \"fromEmail@someOtherDomain.com\"\nobjMessage.Subject = \"My Subject\"\nobjMessage.Fields.Update\nobjMessage.HTMLBody = \"&lt;p&gt;&lt;span style=\"\"font-family: 'Calibri','Arial','sans-serif'\"\";&gt;My Body Text&lt;/span&gt;&lt;/p&gt;\"\nobjMessage.AddAttachment \"C:/path/filename.txt\"\nobjMessage.Send\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7327435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0410593c3b2e38fa8cde123bf49dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Duff", "link": "https://stackoverflow.com/users/7327435/steve-duff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 41466872, "answer_count": 2, "score": 2, "last_activity_date": 1483541943, "creation_date": 1482350400, "question_id": 41270991, "link": "https://stackoverflow.com/questions/41270991/vba-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-in", "title": "VBA - An outgoing call cannot be made since the application is dispatching an input-synchronous call", "body": "<p>I want to send an email via code using Microsoft Visual Basic for Applications. The Microsoft Outlook 12.0 Object Library is checked under Tools/References. The code compiles error-free. The code works fine on two different machines, but when I test it on a third machine, it gives the error when executing line #2.</p>\n\n<pre><code>Dim email As Outlook.MailItem\nSet email = Application.CreateItem(olMailItem)\n    email.To = \"myemailaddress@gmail.com\"\n    email.Subject = \"Subject\"\n    email.Body = \"Body\"\n    email.Send\nSet email = Nothing\n</code></pre>\n\n<p>I have reviewed many posts about this error but cannot find a matching solution. Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba", "templates", "ms-word", "mailmerge"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1482350152, "post_id": 41270852, "comment_id": 69742807, "body": "Type <i>mail merge</i> in Word&#39;s help."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1482350159, "post_id": 41270852, "comment_id": 69742812, "body": "Have you tried using the macro recorder, I think you&#39;d find the code intuitive to follow and a professional like you could tidy it up easily."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1484495767, "creation_date": 1484495767, "answer_id": 41663086, "question_id": 41270852, "link": "https://stackoverflow.com/questions/41270852/extract-from-excel-to-microsoft-word/41663086#41663086", "title": "Extract from EXCEL to MICROSOFT WORD", "body": "<p>Update Bookmarks in Word; controlled from Excel:</p>\n\n<pre><code>Sub PushToWord() \n\nDim objWord As New Word.Application \nDim doc As Word.Document \nDim bkmk As Word.Bookmark \nsWdFileName = Application.GetOpenFilename(, , , , False) \nSet doc = objWord.Documents.Open(sWdFileName) \n\nFor Each bmk In doc.Bookmarks \nIf bmk.Name = \"BrokerFirstName\" Then bmk.Range.Text = Range(\"B1\").Value \nIf bmk.Name = \"BrokerLastName\" Then bmk.Range.Text = Range(\"B2\").Value \nNext \n\nobjWord.Visible = True \n\nEnd Sub\n</code></pre>\n\n<p>IF you don't know how this works, do a little Googling for 'Word DocVariable'.</p>\n\n<p>Good luck!!</p>\n"}], "owner": {"reputation": 13, "user_id": 5220114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d64059b0575da572c8fd5a2009c8c8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Khub", "link": "https://stackoverflow.com/users/5220114/joseph-khub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484495767, "creation_date": 1482349851, "last_edit_date": 1482403226, "question_id": 41270852, "link": "https://stackoverflow.com/questions/41270852/extract-from-excel-to-microsoft-word", "title": "Extract from EXCEL to MICROSOFT WORD", "body": "<p>I write proposals using a very simple Excel Spreadsheet. \nThere are a couple of fields involved and maybe a few IF statements - i.e. the state a project is located in will affect the cost...very basic stuff.</p>\n\n<p>Using this Excel spreadsheet, I generate a Microsoft Word Document from a template, but manually, constantly pressing CTRL+F and manually typing numbers in. How do I go about automatically populating said Word Document - I want to be able to finish my proposal in Excel, and then hit a button and have a word document that's ready to be emailed to the client.</p>\n\n<p>Would be nice to just be able to generate a new word document in the same location from just the excel spreadsheet.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 51, "user_id": 4614526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Z8C_gy4mVF8/AAAAAAAAAAI/AAAAAAAABGw/3xTUBMvgvgE/photo.jpg?sz=128", "display_name": "jeroen", "link": "https://stackoverflow.com/users/4614526/jeroen"}, "edited": false, "score": 1, "creation_date": 1482353690, "post_id": 41270740, "comment_id": 69744739, "body": "@jeroen please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1482349410, "creation_date": 1482349410, "answer_id": 41270740, "question_id": 41270657, "link": "https://stackoverflow.com/questions/41270657/convert-cell-value-to-datetime/41270740#41270740", "title": "Convert cell value to DateTime", "body": "<p>Two issues:</p>\n\n<p>First you must remove the <code>at</code></p>\n\n<p>Second you need a space between the time and the <code>AM</code> or <code>PM</code></p>\n\n<p>The follow formula will turn it into a date/time:</p>\n\n<pre><code>=--SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(A1,\"at\",\"\"),\"AM\",\" AM\"),\"PM\",\" PM\")\n</code></pre>\n\n<p>Then you can format the cell with the custom format:</p>\n\n<pre><code>yyyy/mm/dd hh:mm\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dwvJs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dwvJs.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 4614526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Z8C_gy4mVF8/AAAAAAAAAAI/AAAAAAAABGw/3xTUBMvgvgE/photo.jpg?sz=128", "display_name": "jeroen", "link": "https://stackoverflow.com/users/4614526/jeroen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 41270740, "answer_count": 1, "score": 0, "last_activity_date": 1482354906, "creation_date": 1482349130, "last_edit_date": 1531161705, "question_id": 41270657, "link": "https://stackoverflow.com/questions/41270657/convert-cell-value-to-datetime", "title": "Convert cell value to DateTime", "body": "<p>I have a row of cells in Excel filled with datetimes in the following messy format: <code>July 13, 2016 at 12:10AM</code>. I want to convert this to <code>2016/07/13 12:10</code> ('yyyy/mm/dd hh:mm' in the 24h format). Can I do this using a formula or should I write a vba code for this?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 2, "creation_date": 1482350394, "post_id": 41270578, "comment_id": 69742950, "body": "Interesting.  Try a more privileged file format, like one that can contain macros (even though the document properties are probably stored elsewhere, just try it)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1482350779, "post_id": 41270578, "comment_id": 69743156, "body": "You&#39;re using Office 2010+ to save an Office 2003 document? (seems <a href=\"http://stackoverflow.com/q/4107210/1188513\">SaveAs2 was introduced in Office 2010</a>)"}, {"owner": {"reputation": 61, "user_id": 7066557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea092e1746e1d9b2ddd9c494d7db8b7?s=128&d=identicon&r=PG", "display_name": "McGinn", "link": "https://stackoverflow.com/users/7066557/mcginn"}, "edited": false, "score": 0, "creation_date": 1482374395, "post_id": 41270578, "comment_id": 69751437, "body": "Yes I am, I&#39;m using VBA injected into the XSL to generate the document with it.  Then it performs actions and loads things based on the info. I&#39;m open to better ways, but for the moment that&#39;s how it works. Everything is known to work with 2003 standards from the source, that&#39;s why."}], "owner": {"reputation": 61, "user_id": 7066557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea092e1746e1d9b2ddd9c494d7db8b7?s=128&d=identicon&r=PG", "display_name": "McGinn", "link": "https://stackoverflow.com/users/7066557/mcginn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482350235, "creation_date": 1482348787, "last_edit_date": 1482350235, "question_id": 41270578, "link": "https://stackoverflow.com/questions/41270578/customdocumentproperties-stripped-when-using-saveas2", "title": "CustomDocumentProperties stripped when using SaveAs2", "body": "<p>I'm using xsl to pass variables to the CustomDocumentProperties of the Word 2003 Doc being generated in order to use VBA to make decisions based on those variables.</p>\n\n<p>The file populates with the data as needed, but after the following command, the new file doesn't contain the CustomDocumentProperties that were set.  </p>\n\n<p><code>ActiveDocument.SaveAs2 FileName:=path, FileFormat:=wdFormatDocument</code></p>\n\n<p>Is there a way to save the document without stripping the custom document properties?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 3, "creation_date": 1482348669, "post_id": 41270511, "comment_id": 69742025, "body": "brackets mismatch?  You have 4 left brackets and 3 right brackets so expression is not valid."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482348704, "post_id": 41270511, "comment_id": 69742042, "body": "You are missing a <code>)</code> at the end."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1482348907, "post_id": 41270511, "comment_id": 69742167, "body": "<code>Range(&quot;n2&quot;).FormulaR1C1 = &quot;=IFERROR(IF(RC11=&quot;&quot;,RC12,RC11),0)*(RC6&#47;IF(RC8=&quot;&quot;,1,RC8)&quot;</code> needs to be <code>Range(&quot;n2&quot;).FormulaR1C1 = &quot;=IFERROR(IF(RC11=&quot;&quot;&quot;&quot;,RC12,RC11),0)*(RC6&#47;IF(RC8=&quot;&quot;&quot;&quot;,1,RC8)&zwnj;&#8203;)&quot;</code>  (i.e. missing bracket and double double-quotation marks)"}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482350225, "post_id": 41270511, "comment_id": 69742842, "body": "Thanks everyone! @YowE3K, how come double-double quotations are necessary here?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 2, "creation_date": 1482350712, "post_id": 41270511, "comment_id": 69743117, "body": "@andrew green: on double quotes  <a href=\"http://stackoverflow.com/questions/15770599/about-using-double-quotes-in-vbscript\" title=\"about using double quotes in vbscript\">stackoverflow.com/questions/15770599/&hellip;</a>"}, {"owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482350792, "post_id": 41270511, "comment_id": 69743166, "body": "@SMeaden Thank you!!"}], "owner": {"reputation": 135, "user_id": 7303921, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e00cbdc30855186305aff33cf4097495?s=128&d=identicon&r=PG&f=1", "display_name": "ERKSMTY", "link": "https://stackoverflow.com/users/7303921/erksmty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482349952, "creation_date": 1482348536, "last_edit_date": 1531164843, "question_id": 41270511, "link": "https://stackoverflow.com/questions/41270511/vba-formula-w-relative-reference", "title": "VBA Formula w/ Relative Reference", "body": "<p>I'm running into an issue using the following VBA formula. The code was working until I changed </p>\n\n<pre><code>IFERROR(IF(VLOOKUP(RC1,ListPrice,11,FALSE)=0,VLOOKUP(RC1,ListPrice,12,FALSE),VLOOKUP(RC1,ListPrice,11,FALSE)),0)*RC6\n</code></pre>\n\n<p>to</p>\n\n<pre><code>iferror(IF(RC11=\"\",RC12,RC11),0)*(RC6/IF(RC8=\"\",1,RC8)\n</code></pre>\n\n<p>Thanks for your help!</p>\n\n<p><strong>Complete VBA:</strong></p>\n\n<pre><code>Sub STDCOST()\nDim LastRow As Long\nSheets(\"EXPIRE\").Select\nRange(\"n1\").Value = \"Ext_Cost\"\nRange(\"n2\").FormulaR1C1 = \"=IFERROR(IF(RC11=\"\",RC12,RC11),0)*(RC6/IF(RC8=\"\",1,RC8)\"\n\n\nRange(\"I1\").Select\n\nWith ActiveSheet\n    LastRow = .Cells(.Rows.Count, \"I\").End(xlUp).Row\nEnd With\nRange(\"n2\").AutoFill Destination:=Range(\"n2:n\" &amp; LastRow)\nColumns(\"n:n\").Select\nRange(\"n:n\").Style = \"Currency\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482348884, "post_id": 41270483, "comment_id": 69742153, "body": "Application.Caller helps here but must be a Forms button."}, {"owner": {"reputation": 69, "user_id": 5356045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9b6748c6277f3514b9b45d1b9a0ce94?s=128&d=identicon&r=PG&f=1", "display_name": "Jokru", "link": "https://stackoverflow.com/users/5356045/jokru"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1482351777, "post_id": 41270483, "comment_id": 69743668, "body": "@EEM There are none, I tried searching the web, but couldn&#39;t get anywhere with this"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5356045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9b6748c6277f3514b9b45d1b9a0ce94?s=128&d=identicon&r=PG&f=1", "display_name": "Jokru", "link": "https://stackoverflow.com/users/5356045/jokru"}, "edited": false, "score": 0, "creation_date": 1482352004, "post_id": 41270735, "comment_id": 69743791, "body": "My apologies, my excel is in finnish and was unsure what the difference was, but I&#39;m asking about the non-ActiveX buttons, so it works perfectly."}, {"owner": {"reputation": 69, "user_id": 5356045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9b6748c6277f3514b9b45d1b9a0ce94?s=128&d=identicon&r=PG&f=1", "display_name": "Jokru", "link": "https://stackoverflow.com/users/5356045/jokru"}, "edited": false, "score": 0, "creation_date": 1482352046, "post_id": 41270735, "comment_id": 69743811, "body": "And since I can&#39;t apparently edit my comment, thank you!"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 69, "user_id": 5356045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9b6748c6277f3514b9b45d1b9a0ce94?s=128&d=identicon&r=PG&f=1", "display_name": "Jokru", "link": "https://stackoverflow.com/users/5356045/jokru"}, "edited": false, "score": 0, "creation_date": 1482352167, "post_id": 41270735, "comment_id": 69743894, "body": "You can edit comments when your reputation gets higher, I think.  So, I hope you&#39;ll return to StackOverflow."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 1, "last_activity_date": 1482349827, "last_edit_date": 1482349827, "creation_date": 1482349404, "answer_id": 41270735, "question_id": 41270483, "link": "https://stackoverflow.com/questions/41270483/use-button-caption-as-variable-excel/41270735#41270735", "title": "Use button caption as variable excel", "body": "<p>Try this, works with Forms buttons but not ActiveX buttons.</p>\n\n<pre><code>Sub Button1_Click()\n\n    If Not IsError(Application.Caller) Then\n\n        Dim obj2 As Object\n        Set obj2 = ActiveSheet.Shapes.Item(Application.Caller)\n        Debug.Print obj2.AlternativeText\n    End If\nEnd Sub\n</code></pre>\n\n<p>but your question asked about command buttons (the ActiveX variety) and this is more involved, we need to find the shape and then drill in via OLEFormat and two layers of IDispatch to get a reference to the command button, then we use WithEvents to fire event handler.</p>\n\n<pre><code>Option Explicit\n\n'* Inside Sheet module\n\nPrivate WithEvents mcmd As MSForms.CommandButton\n\nPrivate Sub Initialise()\n    Dim obj As Object\n    Set obj = Me.Shapes.Item(\"CommandButton1\")\n    Set mcmd = obj.OLEFormat.Object.Object\n\nEnd Sub\n\nPrivate Sub mcmd_Click()\n\n    Debug.Print mcmd.Caption\n\nEnd Sub\n</code></pre>\n\n<p>Sadly you need to initialise code like this for every command button I think.</p>\n"}], "owner": {"reputation": 69, "user_id": 5356045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9b6748c6277f3514b9b45d1b9a0ce94?s=128&d=identicon&r=PG&f=1", "display_name": "Jokru", "link": "https://stackoverflow.com/users/5356045/jokru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "accepted_answer_id": 41270735, "answer_count": 1, "score": 0, "last_activity_date": 1482349827, "creation_date": 1482348414, "question_id": 41270483, "link": "https://stackoverflow.com/questions/41270483/use-button-caption-as-variable-excel", "title": "Use button caption as variable excel", "body": "<p>This has to be an obvious thing to do, but I want to use the name of a command button that is pressed in excel as a variable in a macro. The macro would be as simple as setting the value of a cell to the name of the button; So if button captioned \"10\" is pressed the cells value would be \"10\", the same macro needs to work for all numeral button captions/names.\nAgain, sorry if this is obvious!</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 6591306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/216133722705d139bad313b9ee4de190?s=128&d=identicon&r=PG&f=1", "display_name": "matan justme", "link": "https://stackoverflow.com/users/6591306/matan-justme"}, "edited": false, "score": 0, "creation_date": 1482351017, "post_id": 41271032, "comment_id": 69743278, "body": "Thank you very much for the help, I appreciate it, works like a charm."}, {"owner": {"reputation": 317, "user_id": 6591306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/216133722705d139bad313b9ee4de190?s=128&d=identicon&r=PG&f=1", "display_name": "matan justme", "link": "https://stackoverflow.com/users/6591306/matan-justme"}, "edited": false, "score": 0, "creation_date": 1482353705, "post_id": 41271032, "comment_id": 69744747, "body": "Unfortunately I can&#39;t do that, since I dont have 15 reputation myself."}, {"owner": {"reputation": 317, "user_id": 6591306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/216133722705d139bad313b9ee4de190?s=128&d=identicon&r=PG&f=1", "display_name": "matan justme", "link": "https://stackoverflow.com/users/6591306/matan-justme"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482356794, "post_id": 41271032, "comment_id": 69746263, "body": "@YowE3K - Alright, did so then. Ty for the explanation."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1482350633, "creation_date": 1482350633, "answer_id": 41271032, "question_id": 41270476, "link": "https://stackoverflow.com/questions/41270476/how-to-get-a-default-outlook-folder-from-2-different-users-using-vba/41271032#41271032", "title": "how to get a default outlook folder from 2 different users using vba", "body": "<p>Loop though the stores in the <code>Namespace.Stores</code> collection and use <code>Store.GetDefaultFolder</code> instead. </p>\n"}], "owner": {"reputation": 317, "user_id": 6591306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/216133722705d139bad313b9ee4de190?s=128&d=identicon&r=PG&f=1", "display_name": "matan justme", "link": "https://stackoverflow.com/users/6591306/matan-justme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 41271032, "answer_count": 1, "score": 0, "last_activity_date": 1482350633, "creation_date": 1482348353, "question_id": 41270476, "link": "https://stackoverflow.com/questions/41270476/how-to-get-a-default-outlook-folder-from-2-different-users-using-vba", "title": "how to get a default outlook folder from 2 different users using vba", "body": "<p>There is a command for getting a default folder from outlook with vba, which is:</p>\n\n<pre><code>OutlookApplication.Session.GetDefaultFolder(x)\n</code></pre>\n\n<p>for example:</p>\n\n<pre><code>OutlookApplication.Session.GetDefaultFolder(olFolderOutbox)\n</code></pre>\n\n<p>However, the email user name isn't stated in the code, therefore it'll use the default outlook user.</p>\n\n<p>My question is how to use the function to work with both users, assuming i have 2 emails linked to my outlook account.</p>\n\n<p>Hope to get a satisfying answer, thanks in advance.</p>\n"}, {"tags": ["ms-access", "button", "vba", "label"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1482351120, "post_id": 41270370, "comment_id": 69743339, "body": "Consider debugging your dlookup. How does the <code>WHERE</code> condition in argument 3 evaluate? In the immediate window, what does <code>?AMButton</code> return? It returns a NULL, because command buttons do not have a <code>.value</code> property. So your argument evaluates to: <code>[ProgrammeID] = Null</code> and since ProgrammeID is your PK, there will never be a null ProgrammeID so your <code>DLookup</code> can never return a value. You need to reference your form control that contains the value of ProgrammeID, not your command button."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1482390763, "creation_date": 1482390763, "answer_id": 41277606, "question_id": 41270370, "link": "https://stackoverflow.com/questions/41270370/how-to-change-the-caption-of-a-label-using-dlookup-from-pressing-a-button-in-mic/41277606#41277606", "title": "How to change the caption of a label using DLookup from pressing a button in Microsoft Access using VBA", "body": "<p>You <em>ProgrammedID</em> could (and should) be a <em>Long</em>. If so, no quotes:</p>\n\n<pre><code>Forms!StudentOptionForm!S1CreditsL.Caption = DLookup(\"[Sem1-Credits]\", \"Programme\", \"[ProgrammeID] = \" &amp; AMButton &amp; \"\")\n</code></pre>\n\n<p>And bevare that <em>DLookup</em> will return <em>Null</em> for no results which <em>Caption</em> doesn't accept, thus wrap in <em>Nz</em>:</p>\n\n<pre><code>Forms!StudentOptionForm!S1CreditsL.Caption = Nz(DLookup(\"[Sem1-Credits]\", \"Programme\", \"[ProgrammeID] = \" &amp; AMButton &amp; \"\"))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7327319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f364aebd2cbf9367f947f427027b7902?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/7327319/josh-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482390763, "creation_date": 1482347971, "question_id": 41270370, "link": "https://stackoverflow.com/questions/41270370/how-to-change-the-caption-of-a-label-using-dlookup-from-pressing-a-button-in-mic", "title": "How to change the caption of a label using DLookup from pressing a button in Microsoft Access using VBA", "body": "<p>In Microsoft access I want to be able to change the caption of a label after pressing a certain button on my form in Microsoft Access. I have tried the VBA code as shown below but it does not work and the caption stays the same.</p>\n\n<p><strong>How do I fix this ?</strong></p>\n\n<p>The field from the table is an integer called \"Sem1-Credits\" and the contents of this field according to the relevant programmeID is what I want the label caption to be changed to.\nFor example the ProgrammeID of \"AM\" has the Sem1-Credits of \"30\" in the table</p>\n\n<p>The Table is called \"Programme\"\nThe unique identifier of that table is \"ProgrammeID\"\nThe name of the button is AMButton</p>\n\n<pre><code>Forms!StudentOptionForm!S1CreditsL.Caption = DLookup(\"[Sem1-Credits]\", \"Programme\", \"[ProgrammeID]= '\" &amp; AMButton &amp; \"'\")\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1482345505, "creation_date": 1482345505, "answer_id": 41269719, "question_id": 41269649, "link": "https://stackoverflow.com/questions/41269649/workbook-open-code-stops-running-midway-through/41269719#41269719", "title": "Workbook.Open Code Stops Running Midway Through", "body": "<p>I came up with a bootleg workaround in case anyone wants a subpar solution to this problem.</p>\n\n<p><strong>Bootleg Workaround</strong></p>\n\n<p>I took all the code that runs after AddIns(sAddInName).Installed = False and copied it to a new procedure WorkbookOpen_Part2.</p>\n\n<p>Right before the AddIns(sAddInName).Installed = False line, I added an Application.OnTime for Now+1 second to run WorkbookOpen_Part2.</p>\n\n<p>Then, right after AddIns(sAddInName).Installed = False I cancel the Application.OnTime call.</p>\n\n<p>This way if the code doesn't do its weird stop, then the OnTime is instantly canceled and never runs. If the code does do its weird stop, then the OnTime resumes the rest of the code a second later.</p>\n\n<pre><code>mdNextCheckTime = Now + TimeValue(\"00:00:01\")\nApplication.OnTime mdNextCheckTime, \"WorkbookOpen_Part2\"\n\nAddIns(\"TAAA\").Installed = False\n\nCancelCheck 'This cancels the Application.OnTime\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5875728, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/03d3c47750184970e44c36234addc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5875728/mike-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482345505, "creation_date": 1482345285, "last_edit_date": 1531161705, "question_id": 41269649, "link": "https://stackoverflow.com/questions/41269649/workbook-open-code-stops-running-midway-through", "title": "Workbook.Open Code Stops Running Midway Through", "body": "<p><em>Code at the bottom</em></p>\n\n<p>I'm working on an Update System for the AddIn I created for my team to use at work.</p>\n\n<p>I created a mini 'Helper' file. When it's opened, it does the following:</p>\n\n<p>1) Saves itself to Application.StartupPath</p>\n\n<p>2) Uninstalls the current version of the AddIn</p>\n\n<p>3) Copies the most recent version of the AddIn from the Network Drive to the local ADDINS folder</p>\n\n<p>4) Reinstalls the new version of the AddIn</p>\n\n<p>5) Closes itself (the Helper file)</p>\n\n<p>This way whenever someone opens Excel, they will always have the most recent version of the AddIn.</p>\n\n<p>If someone opens Excel from scratch, or they open the Helper file directly, all of the above works as expected. However, when I try and upgrade FROM the ADDIN, it doesn't.</p>\n\n<p>There's an 'Update' button on the AddIn. Click that button (basically) opens the Helper file. The idea being that if the Helper file is opened, it will automatically Update the AddIn.</p>\n\n<p>However the Helper code (which is all contained in Workbook_Open) stops running at: <em>AddIns(sAddInName).Installed = False</em></p>\n\n<p>There's no error or anything. If I step into the code, after that line is run, the AddIn runs its BeforeClose() code, and after that's done, it just stops, as if there was no code after it (although there is).</p>\n\n<p><strong>Relevant Code</strong></p>\n\n<p><em>Helper Code - Logging/Error Handling Removed</em></p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    'Load Master Path and AddIn Path\n    Dim sAddInPath As String, sAddInMasterPath As String\n    sAddInPath = Environ$(\"APPDATA\") &amp; \"\\Microsoft\\Addins\\TAAA.xlam\"\n    sAddInMasterPath = \"...\\TAAA - AddIn.xlam\"\n\n    'If TAAA Helper Isn't Auto-Open, Set to Auto-Open\n    If ThisWorkbook.Path &lt;&gt; Application.StartupPath Then\n        ThisWorkbook.SaveAs Application.StartupPath &amp; \"\\\" &amp;     ThisWorkbook.Name\n    End If\n\n    'If AddIn Is Available Then Uninstall It\n    If bAddInAvailableToInstall(\"TAAA\") Then\n\n        AddIns(\"TAAA\").Installed = False\n</code></pre>\n\n<p>-------- IT STOPS AFTER THE ABOVE LINE ---------</p>\n\n<pre><code>    End If\n\n    'Copying Master AddIn to Local Path\n    FileCopy sAddInMasterPath, sAddInPath\n\n    'If AddIn Is Unavailable Then Add It\n    If Not bAddInAvailableToInstall(\"TAAA\") Then\n        Dim myAddIn As AddIn\n        Set myAddIn = Application.AddIns.Add(Filename:=sAddInPath,     CopyFile:=True)\n    End If\n\n    'Installing AddIn\n    AddIns(\"TAAA\").Installed = True\n\n    ThisWorkbook.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-types"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1482345034, "post_id": 41269526, "comment_id": 69739971, "body": "data.composition has no item (0,0) it starts at (1,1)."}, {"owner": {"reputation": 21, "user_id": 7327010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8BbynZm-y0w/AAAAAAAAAAI/AAAAAAAAACA/pHdpWtnsBeM/photo.jpg?sz=128", "display_name": "Cristian Jimenez", "link": "https://stackoverflow.com/users/7327010/cristian-jimenez"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482345306, "post_id": 41269526, "comment_id": 69740130, "body": "Hi Scott Craner, thanks for you answer. I tried what you mentioned and still the code is doing the same thing. Not working yet"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482345365, "post_id": 41269526, "comment_id": 69740160, "body": "Same with Cells() there is not a cell at row 0 it starts with 1"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7327010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8BbynZm-y0w/AAAAAAAAAAI/AAAAAAAAACA/pHdpWtnsBeM/photo.jpg?sz=128", "display_name": "Cristian Jimenez", "link": "https://stackoverflow.com/users/7327010/cristian-jimenez"}, "is_accepted": false, "score": 0, "last_activity_date": 1482347976, "creation_date": 1482347976, "answer_id": 41270372, "question_id": 41269526, "link": "https://stackoverflow.com/questions/41269526/redim-multidimentional-arrays-in-user-defined-type-in-excel-vba/41270372#41270372", "title": "ReDim multidimentional arrays in User Defined Type in EXCEL vba", "body": "<p>I figured it out. The problem was that the c<strong>ell where I was reading the data from were formatted as general rather than number</strong>. That is why it was not reading the data from excel worksheet. \nI tested this by assigning a constant value \"500\" to the element data.composition(i,j) and it worked. Here is what I did to test that hypothesis. </p>\n\n<pre><code>for i=1 To a\nFor j = 1 To b\n'This is the line where my code crashes\ndata.composition(i, j) = 500\nNext j\nNext i\n</code></pre>\n\n<p>Once the problem was identified I fixed the code.\nHere is how the final code looks. It works perfectly. Thanks for your help!</p>\n\n<pre><code>Option Base 1\nPrivate Type testing_thermo_data\n'one dimesional arrays\ntemperature() As Double\npressure() As Double\n'two dimensional array\ncomposition() As Double\nEnd Type\n\nsub read_from_sheet_to_type()\n\nDim data as testing_thermo_data\nDim a,b,i as integer\n'a and b are determined with some other function (it works),\n'to simplif I will set them to a number\na=20\nb=10\n'Now I will reDim the elements of the UDT to the proper size\n'One dimension array with a=10 elements\nReDim data.temperature (a) as double\n'One dimension array with a=10 elements\nReDim data.pressure (a) as double\n'Two dimensional array. Matriz of  a=10 by b=20\nReDim data.composition (1 To a, 1 To b) as double \n\nFor i = 1 To (a)\ndata.temperature(i) = Application.ActiveSheet.Cells(i + 3, 1).Value\ndata.pressure(i) = Application.ActiveSheet.Cells(i + 3, 2).Value\n   For j = 1 To (b)\n   'This is the line where my code crashes\n   data.composition(i, j) = Application.ActiveSheet.Cells(i, j + 3).Value\n   Next j\nNext i\nend sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7327010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8BbynZm-y0w/AAAAAAAAAAI/AAAAAAAAACA/pHdpWtnsBeM/photo.jpg?sz=128", "display_name": "Cristian Jimenez", "link": "https://stackoverflow.com/users/7327010/cristian-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1502, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526393582, "creation_date": 1482344848, "last_edit_date": 1526393582, "question_id": 41269526, "link": "https://stackoverflow.com/questions/41269526/redim-multidimentional-arrays-in-user-defined-type-in-excel-vba", "title": "ReDim multidimentional arrays in User Defined Type in EXCEL vba", "body": "<p>Thanks for your help!!</p>\n\n<p>My question is as follow. I have a section of code that intends to get data from a table and store it into a user defined type. Since the table might change size, the idea is to dynamically give the size to the elements of the type. The type has two one dimensional arrays and one two dimensional array. I am having trouble with the two dimensional array. Can Excel VBA support this feature?</p>\n\n<pre><code>Private Type testing_thermo_data\n'one dimesional arrays\ntemperature() As Double\npressure() As Double\n'two dimensional array\ncomposition() As Double\nEnd Type\n\nsub read_from_sheet_to_type()\n\nDim data as testing_thermo_data\nDim a,b,i as integer\n'a and b are determined with some other function (it works), so to simplify I will set them to a number\na=20\nb=10\n'Now I will reDim the elements of the UDT to the proper size\n'One dimension array with a=10 elements\nReDim data.temperature (a) as double\n'One dimension array with a=10 elements\nReDim data.pressure (a) as double\n'Two dimensional array. Matriz of  a=10 by b=20\nReDim data.composition (1 To a, 1 To b) as double \n\nFor i = 0 To (a- 1)\ndata.temperature(i) = Application.ActiveSheet.Cells(i + 3, 1).Value\ndata.pressure(i) = Application.ActiveSheet.Cells(i + 3, 2).Value\n    For j = 0 To (b-1)\n    'This is the line where my code crashes\n    data.composition(i, j) = Application.ActiveSheet.Cells(i, j + 3).Value\n    Next j\nNext i\nend sub\n</code></pre>\n\n<p>$Once I run the code I get the following error as shown in the picture.\nRun-time error '1004':\nApplication-defined or object-defined error</p>\n\n<p><img src=\"https://i.stack.imgur.com/lTYDR.jpg\" alt=\"Application-defined or object-defined error\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482347899, "post_id": 41269451, "comment_id": 69741574, "body": "FWIW from a <a href=\"https://ux.stackexchange.com\">User Experience</a> perspective, it&#39;s not immediately obvious why a <i>higher</i> number should have a <i>downward</i> red arrow, and a <i>lower</i> number should have an <i>upward</i> green arrow."}], "answers": [{"comments": [{"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482349138, "post_id": 41270425, "comment_id": 69742290, "body": "Thank you for the comment Mat. The colored circles are a good idea. What do you mean by TY and LY? Also, instead of adding an additional column, is there a way to implement this logic into the VBA code itself? Reason being I have 16 columns that needs to be compared, so this would be a lot of additional columns. Plus, this is a pivot table, so I would need to use Calculated Fields which introduces a lot of additional steps."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482349707, "post_id": 41270425, "comment_id": 69742583, "body": "That&#39;s &quot;This Year&quot; and &quot;Last Year&quot; ;-) if you can add the calculations in the pivot source data, you don&#39;t need calculated pivot fields. The problem is that, in my experience, pivot tables once formatted should be PDF&#39;d as-is, else they wreck the formats. Avoiding cell references in formsts is the only way I&#39;ve found to avoid that. Maybe someone else will have a better idea though."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482349870, "post_id": 41270425, "comment_id": 69742670, "body": "Ah ok, got it. Hmm, as I think about it, adding an additional column in the data source might be easier said than done.These values are calculated fields to begin with, so adding the additional column in the data source would mean restructuring all of my existing data."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1482351655, "post_id": 41270425, "comment_id": 69743612, "body": "I always try to have as much of the calculations in the pivot source (using an actual Excel table (<code>ListObject</code>) as a data source), and only have calculated pivot fields for things that can&#39;t be aggregated with a <code>SUM</code>, e.g. profit margin percentages, which can&#39;t be added up and need to still work with aggregated subtotals."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1482348473, "last_edit_date": 1482348473, "creation_date": 1482348138, "answer_id": 41270425, "question_id": 41269451, "link": "https://stackoverflow.com/questions/41269451/conditional-formatting-a-pivot-table-using-vba/41270425#41270425", "title": "Conditional formatting a pivot table using VBA", "body": "<p>Change your conditional logic to use constant expressions instead of cell addresses.</p>\n\n<p>Add a column that calculates the difference between TY and LY, and make the icons conditional to the <em>difference</em> being <code>&lt;0</code>, <code>&gt;0</code>, or <code>=0</code>.</p>\n\n<p>Also as I mentioned in comments:</p>\n\n<blockquote>\n  <p><em>FWIW from a User Experience perspective, it's not immediately obvious why a higher number should have a downward red arrow, and a lower number should have an upward green arrow.</em></p>\n</blockquote>\n\n<p>Consider using the colored circles icon set instead of arrows.</p>\n\n<p><img src=\"https://i.stack.imgur.com/6voMQ.png\" alt=\"colored circles\"></p>\n\n<p>That way you still convey \"good\", \"neutral\" and \"bad\", without implying an up/down direction that's contradicting the represented data.</p>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1604, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1482348473, "creation_date": 1482344535, "question_id": 41269451, "link": "https://stackoverflow.com/questions/41269451/conditional-formatting-a-pivot-table-using-vba", "title": "Conditional formatting a pivot table using VBA", "body": "<p>I'm trying to apply some VBA code that will compare several columns of data.</p>\n\n<p>See image below (this conditional formatting is correct by the way):\n<a href=\"https://i.stack.imgur.com/KAGND.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KAGND.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In this instance, the values in column c are being compared to column B, E to D, G to F, I to H. A higher score is bad, so the conditional formatting is in all 2016 columns, if the value is greater than 2015, there should be a red down arrow, and a green arrow if the opposite is true.</p>\n\n<p>Here is the code I've been using:</p>\n\n<pre><code>Sub ColorYear()\n    Dim long1 As Long\n    Dim t As Long\n    Dim c As Long\n    Application.ScreenUpdating = False\n    ' Last used row\n    long1 = Cells(Rows.Count, 1).End(xlUp).Row\n    ' Delete existing rules\n    Range(\"A7:U\" &amp; long1).FormatConditions.Delete\n    ' Loop through the rows\n    For t = 3 To long1\n        For c = 5 To 21 Step 2 ' columns C,E,G,I\n            With Cells(t, c).FormatConditions.AddIconSetCondition\n                .IconSet = ActiveWorkbook.IconSets(xl3Triangles)\n                .ReverseOrder = True\n                With .IconCriteria(2)\n                    .Type = xlConditionValueFormula\n                    .Value = \"=\" &amp; Cells(t, c - 1).Address\n                    .Operator = 7\n                End With\n                With .IconCriteria(3)\n                    .Type = xlConditionValueFormula\n                    .Value = \"=\" &amp; Cells(t, c - 1).Address\n                    .Operator = 5\n                End With\n            End With\n        Next c\n    Next t\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This works so long as there is no filtering applied. For instance, if there is no filter being applied cell C3 gets compared to B3. However, if I apply some filters, C2 gets compared to B3 (it's original cell), so the comparison is incorrect and gives me the wrong conditional formatting.</p>\n\n<p>See image below (this is the incorrect formatting with filters applied):</p>\n\n<p><a href=\"https://i.stack.imgur.com/RDjYG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RDjYG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Can anyone assist?</p>\n"}, {"tags": ["arrays", "vba", "excel", "transpose"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482343767, "post_id": 41269159, "comment_id": 69739263, "body": "Both <code>WorksheetFunction.Transpose</code> and <code>Application.Transpose</code> methods work successfully when I test this. Can you show more of your code and possibly example data?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482343825, "post_id": 41269159, "comment_id": 69739294, "body": "@DavidZemens are you transposing a 1D array?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482343902, "post_id": 41269159, "comment_id": 69739342, "body": "@Mat&#39;sMug yes, e.g., <code>Dim arr1(2) As Variant</code> and then filled with <code>Date</code> type values."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482343939, "post_id": 41269159, "comment_id": 69739362, "body": "Huh, I always assumed the function wanted to work with a 2D array"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1482344059, "post_id": 41269159, "comment_id": 69739425, "body": "Transpose will turn a 1d array (<i>n</i> rows) in to a 2d array (1 column, <i>n</i> rows) @Mat&#39;sMug"}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482344657, "post_id": 41269159, "comment_id": 69739754, "body": "@DavidZemens I don&#39;t think that&#39;s true. I&#39;ve been transposing 1D arrays all week, and they come out as 1D."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1482344903, "post_id": 41269159, "comment_id": 69739894, "body": "@ShawnV.Wilson no they don&#39;t.  <a href=\"http://imgur.com/a/ZgjIo\" rel=\"nofollow noreferrer\">imgur.com/a/ZgjIo</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1482344328, "creation_date": 1482344328, "answer_id": 41269382, "question_id": 41269159, "link": "https://stackoverflow.com/questions/41269159/excel-vba-can-an-array-of-dates-be-transposed/41269382#41269382", "title": "Excel VBA: Can an array of dates be transposed?", "body": "<p>Properly coded the following should work:</p>\n\n<pre><code>Sub DepositArrays()\n    Dim ary1(1 To 2) As String, ary2(1 To 2) As Date\n\n    ary1(1) = \"James\"\n    ary1(2) = \"Ravenswood\"\n    ary2(1) = DateSerial(1945, 1, 20)\n    ary2(2) = Date\n\n    With Application.WorksheetFunction\n        Range(\"A1:A2\") = .Transpose(ary1)\n        Range(\"B1:B2\") = .Transpose(ary2)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Yields:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HH1Uw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HH1Uw.png\" alt=\"enter image description here\"></a></p>\n\n<p>Without the <code>TRANSPOSE()</code>, the code runs, but will not produce correct results.</p>\n"}, {"comments": [{"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1482344836, "post_id": 41269473, "comment_id": 69739857, "body": "I <i>am</i> using a range. (Actually, a column of a ListObject). For simplicity, I tested it with Selection, and got the same error, so that&#39;s what I posted."}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 1, "creation_date": 1482344901, "post_id": 41269473, "comment_id": 69739893, "body": "Using a loop will slow my procedure to a crawl. Arrays are much faster. (When they work!)"}, {"owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "reply_to_user": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 1, "creation_date": 1482345350, "post_id": 41269473, "comment_id": 69740155, "body": "i have assumed the reason was efficiency...but if there are not many indexes inside the array it possible to set <code>application.ScreenUpdating</code> property to False and set <code>Application.Calculation</code> to xlCalculateManual. it will speed up the execution dramatically (in case you are not familiar with it)"}], "tags": [], "owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "is_accepted": false, "score": 0, "last_activity_date": 1482344628, "creation_date": 1482344628, "answer_id": 41269473, "question_id": 41269159, "link": "https://stackoverflow.com/questions/41269159/excel-vba-can-an-array-of-dates-be-transposed/41269473#41269473", "title": "Excel VBA: Can an array of dates be transposed?", "body": "<p>why not to use a <code>range</code>:</p>\n\n<pre><code>Private Sub Test()\n\nDim arr(79) As Variant\nFor i = o To UBound(arr)\n    arr(i) = Now\nNext\n\nDim rng As Range\nSet rng = Range(Cells(2, 2), Cells(81, 2))\nrng = WorksheetFunction.Transpose(arr)\n\nEnd Sub\n</code></pre>\n\n<p>also another option is a simple loop to iterate trough the array and populate data to the worksheet:</p>\n\n<pre><code>Private Sub Test2()\n\nDim arr(79) As Variant\nFor i = o To UBound(arr)\n    arr(i) = Now\nNext\n\nFor i = o To UBound(arr)\n    Cells(i + 1, 1) = arr(i)\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1482345838, "last_edit_date": 1482345838, "creation_date": 1482344995, "answer_id": 41269568, "question_id": 41269159, "link": "https://stackoverflow.com/questions/41269159/excel-vba-can-an-array-of-dates-be-transposed/41269568#41269568", "title": "Excel VBA: Can an array of dates be transposed?", "body": "<p>Both methods work for me, whether I use <code>Transpose</code> as a member of the <code>Application</code> class or the <code>WorksheetFunction</code> class. If any element of the array contains a string >= 255 characters in length, I get a <strong>Type Mismatch</strong> error, but I can't replicate the <strong>Invalid Procedure Call</strong> error.</p>\n\n<p>Can you test this in a blank workbook?</p>\n\n<pre><code>Sub foo()\nDim arr1(79), vals, rng As Range\nDim i As Long\n\nFor i = LBound(arr1) To UBound(arr1)\n    arr1(i) = DateAdd(\"d\", i, #1/1/2016#)\nNext\n\nSet rng = Range(\"A1:A80\")\nrng = Application.Transpose(arr1)\nvals = arr1\n\nSet rng = rng.Offset(, 1)\nrng = Application.WorksheetFunction.Transpose(arr1)\n\n'Both methods work even if the destination range is the wrong size:\nSet rng = rng.Offset(, 1).Resize(100)\nrng = Application.Transpose(arr1)\n\nSet rng = rng.Offset(, 1).Resize(50)\nrng = Application.WorksheetFunction.Transpose(arr1)\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1482345838, "creation_date": 1482343528, "question_id": 41269159, "link": "https://stackoverflow.com/questions/41269159/excel-vba-can-an-array-of-dates-be-transposed", "title": "Excel VBA: Can an array of dates be transposed?", "body": "<p>I have two arrays that I need to paste into my spreadsheet. Since each destination is a column, I'm using the Transpose command, like so:</p>\n\n<pre><code>Selection = WorksheetFunction.Transpose(arr1)\n</code></pre>\n\n<p>This works for one of the arrays, but the other gives me an Invalid Procedure Call (Error 5). Both arrays are the same size: arr(1 to 79).</p>\n\n<p>The only difference between the two that I can tell is that all the values in the \"good\" array are Variant/String, and most of the ones in the \"bad\" array are Variant/Date. </p>\n\n<p>Should that actually make a difference? If so, is there a way of converting the values in the latter array?</p>\n"}, {"tags": ["javascript", "excel", "vba", "call"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1482344485, "post_id": 41268757, "comment_id": 69739658, "body": "<code>IE.document.getElementById(&quot;ctl00_cphMain_btnAddTab&quot;).Click</code>"}, {"owner": {"reputation": 45, "user_id": 7296973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f87626844cf5cfa00e8fe45cc680fa?s=128&d=identicon&r=PG&f=1", "display_name": "P. Mann", "link": "https://stackoverflow.com/users/7296973/p-mann"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482425266, "post_id": 41268757, "comment_id": 69778255, "body": "You beauty, thanks."}, {"owner": {"reputation": 5384, "user_id": 5546267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/s1D5g.jpg?s=128&g=1", "display_name": "Blag", "link": "https://stackoverflow.com/users/5546267/blag"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482428713, "post_id": 41268757, "comment_id": 69780233, "body": "@TimWilliams please add your answer, to allow P.Mann to flag as solved"}, {"owner": {"reputation": 59, "user_id": 12391795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCCNqJfv0sH8NHBif37ObuD00Qm2l2QgbGsrzysXA=k-s128", "display_name": "SelpaqM", "link": "https://stackoverflow.com/users/12391795/selpaqm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1608728201, "post_id": 41268757, "comment_id": 115667675, "body": "@TimWilliams , actually I have simmilar issue, however my HTML code has no id for href. it is using same javascript. I cannot click the button. <a href=\"https://stackoverflow.com/questions/65411558/click-page-numbers-one-by-one-javascript-dopostback-button-with-vba\">link</a> you may see my question in this post."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1482429506, "creation_date": 1482429506, "answer_id": 41289214, "question_id": 41268757, "link": "https://stackoverflow.com/questions/41268757/click-a-javascript-button-with-vba/41289214#41289214", "title": "&quot;Click&quot; a javascript button with VBA", "body": "<p>This should work:</p>\n\n<pre><code>IE.document.getElementById(\"ctl00_cphMain_btnAddTab\").Click\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7296973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f87626844cf5cfa00e8fe45cc680fa?s=128&d=identicon&r=PG&f=1", "display_name": "P. Mann", "link": "https://stackoverflow.com/users/7296973/p-mann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5412, "favorite_count": 0, "accepted_answer_id": 41289214, "answer_count": 1, "score": 0, "last_activity_date": 1489746853, "creation_date": 1482342022, "question_id": 41268757, "link": "https://stackoverflow.com/questions/41268757/click-a-javascript-button-with-vba", "title": "&quot;Click&quot; a javascript button with VBA", "body": "<p>endless googling and lots of solutions haven't seemed to help. I keep getting endless errors of different kinds, and just can't find an elegant way of clicking this button unless I get the code to wait for four seconds while I click it manually with my mouse. </p>\n\n<p>It works on other buttons, but I'm working if the problem here is the nested doPostBack and the many '' (substituted from \"\") in it? </p>\n\n<p>Code below (I've trimmed out irrelevant sections)</p>\n\n<p>VBA Code:</p>\n\n<pre><code>Sub IE_Clicks()\n\n    Dim shellWins As ShellWindows\n    Dim IE As InternetExplorer\n\n    Set shellWins = New ShellWindows\n\n    If shellWins.Count &gt; 0 Then\n    ' Get IE\n    Set IE = shellWins.Item(0)\n    IE.Visible = True\n    Else\n    ' Create IE\n    Set IE = New InternetExplorer\n    IE.Visible = True\n    End If\n\n    IE.Navigate (\"[URL]\")\n\nDo While (IE.Busy Or IE.READYSTATE &lt;&gt; READYSTATE.READYSTATE_COMPLETE)\n    DoEvents\nLoop\n    Call IE.document.parentWindow.execScript(\"WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions('ctl00$cphMain$btnAddTab', '', true, '', '', false, false))\", \"JavaScript\")\n\n    Set IE = Nothing\n End Sub\n</code></pre>\n\n<p>HTML Code: </p>\n\n<pre><code>&lt;input type=\"submit\" name=\"ctl00$cphMain$btnAddTab\" value=\"Add New\" onclick=\"javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&amp;quot;ctl00$cphMain$btnAddTab&amp;quot;, &amp;quot;&amp;quot;, true, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, false, false))\" id=\"ctl00_cphMain_btnAddTab\" class=\"ActionButton\"&gt;\n</code></pre>\n\n<p>JavaScript:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n//&lt;![CDATA[\nvar theForm = document.forms['aspnetForm'];\nif (!theForm) {\n    theForm = document.aspnetForm;\n}\nfunction __doPostBack(eventTarget, eventArgument) {\n    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {\n        theForm.__EVENTTARGET.value = eventTarget;\n        theForm.__EVENTARGUMENT.value = eventArgument;\n        theForm.submit();\n    }\n}\n//]]&gt;\n&lt;/script&gt;\n</code></pre>\n\n<p>Something that would enable me to click this button would be amazing. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482343030, "post_id": 41268708, "comment_id": 69738814, "body": "Should they match row by row? or only exist in the other?"}, {"owner": {"reputation": 13, "user_id": 6590288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c507607a8c90c62de943f0e73d41740?s=128&d=identicon&r=PG&f=1", "display_name": "Sammy O&#39;Day", "link": "https://stackoverflow.com/users/6590288/sammy-oday"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482343746, "post_id": 41268708, "comment_id": 69739250, "body": "Whatever entity id is in worksheet Blah must also be in worksheet Blah1. After inserting rows on Blah1 I was going to fill in the blank rows with the appropriate information from Blah."}, {"owner": {"reputation": 13, "user_id": 6590288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c507607a8c90c62de943f0e73d41740?s=128&d=identicon&r=PG&f=1", "display_name": "Sammy O&#39;Day", "link": "https://stackoverflow.com/users/6590288/sammy-oday"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482343870, "post_id": 41268708, "comment_id": 69739320, "body": "But no, the entity ids do not have to line up exactly from one sheet to the other"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482343963, "post_id": 41268708, "comment_id": 69739372, "body": "Then it does not matter where you add the lines.  Just cycle through the first sheet and see if it exists in the second, if not then copy and paste the line to the bottom of the second list."}, {"owner": {"reputation": 13, "user_id": 6590288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c507607a8c90c62de943f0e73d41740?s=128&d=identicon&r=PG&f=1", "display_name": "Sammy O&#39;Day", "link": "https://stackoverflow.com/users/6590288/sammy-oday"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482344095, "post_id": 41268708, "comment_id": 69739450, "body": "And how would I do that?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1482344227, "post_id": 41268708, "comment_id": 69739535, "body": "There are many many examples on how to do that on this site alone a quick search: <code>copy row to another page based on criteria vba</code>,<code>Find if value exists in another sheet vba</code>, and <code>Find last row with value vba</code> will give a lot of examples."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 6590288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c507607a8c90c62de943f0e73d41740?s=128&d=identicon&r=PG&f=1", "display_name": "Sammy O&#39;Day", "link": "https://stackoverflow.com/users/6590288/sammy-oday"}, "is_accepted": false, "score": 0, "last_activity_date": 1482348108, "creation_date": 1482348108, "answer_id": 41270413, "question_id": 41268708, "link": "https://stackoverflow.com/questions/41268708/using-vba-to-compare-cells-from-different-sheets-and-insert-new-row-on-one-sheet/41270413#41270413", "title": "Using VBA To Compare Cells From Different Sheets And Insert New Row On One Sheet When Cells Don&#39;t Match", "body": "<p>I was actually able to find my answer on Mr. Excel. I think it was the double Fors that was messing me up. Once that was figured out, I was able to figure out how to add in the values I needed from sheet Blah to sheet Blah1. In searching based on what Scott said, I wasn't able to find what I actually needed. I'm sure there's an easier way to do this, and as I get more experience maybe I'll figure it out.</p>\n\n<pre><code>    Sub InsertRows()\n     Dim lastrow As Long, i As Long, j As Long\n\n     lastrow = Sheets(\"Blah\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    j = 14\n\n    For i = 2 To lastrow\n    If Sheets(\"Blah1\").Cells(j, 1).Value &lt;&gt; Sheets(\"Blah\").Cells(i, 1).Value Then\n     Sheets(\"Blah1\").Rows(j).Insert Shift:=xlDown\n    Sheets(\"Blah1\").Cells(j, 2).Value = Sheets(\"Blah\").Cells(i, 10).Value\n    Sheets(\"Blah1\").Cells(j, 3).Value = Sheets(\"Blah\").Cells(i, 11).Value\n    Sheets(\"Blah1\").Cells(j, 5).Value = \"2017\"\n    Sheets(\"Blah1\").Cells(j, 6).Value = Sheets(\"Blah\").Cells(i, 2).Value\n    Sheets(\"Blah1\").Cells(j, 7).Value = Sheets(\"Blah\").Cells(i, 3).Value\n    Sheets(\"Blah1\").Cells(j, 8).Value = Sheets(\"Blah\").Cells(i, 4).Value\n     Sheets(\"Blah1\").Cells(j, 9).Value = Sheets(\"Blah\").Cells(i, 5).Value\n\n    End If\n     j = j + 1\n    Next i\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6590288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c507607a8c90c62de943f0e73d41740?s=128&d=identicon&r=PG&f=1", "display_name": "Sammy O&#39;Day", "link": "https://stackoverflow.com/users/6590288/sammy-oday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482348108, "creation_date": 1482341861, "last_edit_date": 1531164843, "question_id": 41268708, "link": "https://stackoverflow.com/questions/41268708/using-vba-to-compare-cells-from-different-sheets-and-insert-new-row-on-one-sheet", "title": "Using VBA To Compare Cells From Different Sheets And Insert New Row On One Sheet When Cells Don&#39;t Match", "body": "<p>I have two worksheets in which I need to compare the entity id in worksheet Blah with the entity id in worksheet Blah1. The entity ids are stored in column A on both sheets. If an entity id exists in Blah but not Blah 1, I need to insert a blank row on the Blah 1 table where it's missing the entity id. The range of rows I need to compare will change from month to month. I know that rows 5 through 92 on Blah 2 match rows 2 through 89, but it starts inserting at row 11 and continues to insert rows until I hit escape. I know I also probably need another if that tells the code to go to the next I if the entity id is blank, but I'm not sure how to do that.</p>\n\n<p>So in summary, I need to compare the entity ids and insert a new row for any entity ids that are missing. Any help would be greatly appreciated.</p>\n\n<pre><code> Sub InsertNewRow()\n Dim i As Long, j As Long, lastrow1 As Long, lastrow2 As Long\n\n lastrow1 = Sheets(\"Blah\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n lastrow2 = Sheets(\"Blah1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n     For j = 2 To lastrow2\n      For i = 5 To lastrow1\n        If Sheets(\"Blah\").Cells(j, 1) &lt;&gt; Sheets(\"Blah1\").Cells(i, 1) Then\n            Sheets(\"Blah1\").Cells(i, 1).EntireRow.Insert\n End If\n     Next i\n Next j\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vbscript", "macros", "large-files", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482347169, "post_id": 41268524, "comment_id": 69741156, "body": "Form Controls or ActiveX controls?"}, {"owner": {"reputation": 147, "user_id": 1817127, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05621c1bcc26c48633b6817af165eef4?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/1817127/todd"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482389120, "post_id": 41268524, "comment_id": 69755883, "body": "My apologies, Form Controls"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 1817127, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05621c1bcc26c48633b6817af165eef4?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/1817127/todd"}, "edited": false, "score": 0, "creation_date": 1483327040, "post_id": 41271607, "comment_id": 70047357, "body": "I could not get these to work. I had to add &quot;PtrSafe&quot; to the Functions in order to get them to clear the debugger, but that removed the Alias&#39;. I could not find a way to get the Property line to clear."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "reply_to_user": {"reputation": 147, "user_id": 1817127, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05621c1bcc26c48633b6817af165eef4?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/1817127/todd"}, "edited": false, "score": 0, "creation_date": 1483327378, "post_id": 41271607, "comment_id": 70047407, "body": "The property line is from Object Browser showing you where Excel&#39;s hWnd is."}, {"owner": {"reputation": 147, "user_id": 1817127, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05621c1bcc26c48633b6817af165eef4?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/1817127/todd"}, "edited": false, "score": 0, "creation_date": 1483328365, "post_id": 41271607, "comment_id": 70047588, "body": "I&#39;ve never been in that area.. found it, thank you! It is showing as the same setting as you have there, so I&#39;ll try to clear the Clipboard via this method during the next update. I edited my question to reflect what I&#39;ve found out so far. Issue seems to be tied directly to the files stored in %temp%."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "is_accepted": false, "score": 0, "last_activity_date": 1483329201, "last_edit_date": 1483329201, "creation_date": 1482353164, "answer_id": 41271607, "question_id": 41268524, "link": "https://stackoverflow.com/questions/41268524/excel-workbook-fails-to-open-after-updating-and-saving/41271607#41271607", "title": "Excel Workbook fails to open after updating and saving", "body": "<pre><code>Public Declare Function CloseClipboard Lib \"user32\" () As Long\nPublic Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\nPublic Declare Function EmptyClipboard Lib \"user32\" () As Long\n\nProperty Hwnd As Long\n    read-only\n    Member of Excel.Application\n</code></pre>\n\n<p>The normal architecture is UI in one thing and data in another. I think you should mostly be in a database rather than using a spreadsheet as a database.</p>\n\n<p>Excel doesn't copy anything to the clipboard until it exits or you paste in a non excel program.</p>\n\n<p>So call OpenClipboard, EmptyClipboard, then CloseClipboard. This will remove any ambiguity about memory. The end result will be none used for sure. According to Help don't use Excel's HWnd but use 0.</p>\n\n<p>This is VB6/VBA6 <code>alias</code> is optional.</p>\n\n<pre><code>Private Declare Function CloseClipboard Lib \"user32\" () As Long\nPrivate Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function EmptyClipboard Lib \"user32\" () As Long\n\nPrivate Sub Form_Load()   \n    x = OpenClipboard(0)\n    y = EmptyClipboard()\n    z = CloseClipboard()\n    MsgBox x &amp; \" \" &amp; y &amp; \" \" &amp; z\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 1817127, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05621c1bcc26c48633b6817af165eef4?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/1817127/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483329201, "creation_date": 1482341150, "last_edit_date": 1531161705, "question_id": 41268524, "link": "https://stackoverflow.com/questions/41268524/excel-workbook-fails-to-open-after-updating-and-saving", "title": "Excel Workbook fails to open after updating and saving", "body": "<p>I have two Workbooks that work in tandem with one another. Twice a week (via MS W10 Task Scheduler and a simple vbscript, which runs Excel with display set to \"Hidden\"), one of the Workbooks opens (WB-A), performs a web query, uses the retrieved data to update four of its sheets, saves itself, and then opens the other Workbook (WB-B) to begin further processing of the new data.</p>\n\n<p>This all worked beautifully, for a time. Now, after this update process has completed, the only way I can get back into the Workbooks is if I manually cycle to another Office build version (by way of \"<a href=\"https://support.microsoft.com/en-us/kb/2770432\" rel=\"nofollow noreferrer\">officec2rclient.exe /update user updatetoversion=</a><a href=\"https://technet.microsoft.com/en-us/library/mt592918.aspx?f=255&amp;MSPPError=-2147217396#BKMK_ByDate\" rel=\"nofollow noreferrer\">16.0.XXXX.XXXX</a>\", I have been switching between 1609 and 1610). </p>\n\n<p>Without doing this, Excel will crash, and I will see the error telling me that Excel has \"stopped responding\". If I open Excel first, and then try to open either of the Workbooks, sometimes I will see an error with only \"400\" displayed inside a critical alert MsgBox.</p>\n\n<p>Initially I though that perhaps the issue was being caused by the weight of WB-B (~70mb on disk, ~4GB in memory), so I began hacking away at it. I removed all the extraneous conditional formatting, named ranges, and external links (to WB-A). That seemed to help considerably, at least in the load time.</p>\n\n<p>At first blush, it appeared that I had resolved the issue with these improvements. Optimizing the external links reduced the number of calls by about ~60%, and reduced the overall memory usage by ~50%. It was not until after the next scheduled update that I realized I was not out of the woods yet.</p>\n\n<h1>Relevant details concerning both Workbooks</h1>\n\n<p>1) They contain form buttons (controls), conditional formatting, named ranges, formulas, and are both macro-enabled.</p>\n\n<p>2) When they fail to open, they fail when the buttons (controls) should be appearing (I believe as the Workbook is finishing its \"Calculate\" process).</p>\n\n<p>3) Attempting to use the built-in \"Open and Repair\" function within Excel fails to load either Workbook at precisely the same moment as a normal attempt would.</p>\n\n<p>4) Performing a repair installation of Office365 (both Quick and Online methods) does nothing to resolve the issue.</p>\n\n<p>5) There have been other times I will go to open WB-B, and every cell is formatted as a Date. Erasing the incorrectly saved format for \"Normal\" corrects the issue.</p>\n\n<h1>Preceding this issue</h1>\n\n<p>Right before this started happening, I was getting the \"<em><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_other/ms-excel-2007-error-message-the-picture-is-too/f9932485-43b7-4f73-af82-1f6f1f559438\" rel=\"nofollow noreferrer\">The picture is too large and will be truncated</a></em>\" message as the automatic update process seemed to be wrapping up and saving each of the Workbooks. Before saving, I added <code>Application.CutCopyMode = False</code> which seemed to eradicate that error, as I no longer see that pop-up.</p>\n\n<h2>Next steps</h2>\n\n<p>I realize that the conditional formatting and complex formulas I have in each of the Workbooks are significant impediments, so I am mustering up the courage to hack away at each Workbook, again. I can add/remove all of the buttons/conditional formatting in WB-B at will, so as irritating as that would be (to deal with each time I open the file), it is a possibility.</p>\n\n<p>The only other thing I can think of doing at this point is splitting each of the Workbooks in \"half\".</p>\n\n<p>There are 4 or 5 Sheets I could see allocating to a new Workbook in WB-A, and I could limit the number of Sheets in WB-B (currently it adds a new Sheet during each update, totaling ~160 Sheets as of today). Limiting the number of Sheets in WB-B would mean I would have to create a hidden sheet that contained all of the \"post cut-off\" Sheets' relevant data, as there are Subs that rely on said data to complete successfully. These Sheets that would be removed would need to be moved to a new Workbook, as they visually aide in the analysis of the Workbook in its entirety.</p>\n\n<h2>Plea for help</h2>\n\n<p>Before I get into all of that, I am hoping that someone knows of some simple bit of VBA I can use to fix all of this. It seems to me that Excel must be caching something related to these Workbooks, but I have not been able to locate any info regarding that. I was under the impression that using <code>Application.CutCopyMode = False</code> cleared the clipboard, but maybe there is more to it than that.</p>\n\n<h2>Update (1-1-16)</h2>\n\n<p>It appears that the issue is directly related to the files stored in %temp%. After clearing that, I am no longer experiencing any issues.</p>\n\n<h2>So to summarize</h2>\n\n<p><strike><strong>1) What are the proper methods for clearing all caches Excel may be using (including Clipboard)?</strong></p>\n\n<p><strong>2) What could explain a Workbook failing to open and crashing Excel, yet successfully opening <em>after</em> switching to a different Office build version?</strong></strike></p>\n\n<p><strong>3) Is there a line of code that will delete all temp files Excel stores in <code>%temp%</code>?</strong></p>\n\n<p><em>Relevant system info: Windows 10 Pro 64-bit, AMD FX 8350, 16 GB DDR3, Office365 1609 (Build 7369.2055)+</em></p>\n\n<p><em>Note: I also see this issue on my laptop, which is Intel/DDR4, so it is doubtful that the issue has anything to do with the processor/RAM.</em></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482337970, "post_id": 41267556, "comment_id": 69735999, "body": "What is the specific problem or error?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482339158, "post_id": 41267556, "comment_id": 69736720, "body": "Why is there an <code>EndSub</code> line label?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482339604, "post_id": 41267556, "comment_id": 69736982, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29166379/sumifs-using-excel-vba\">SUMIFs using Excel VBA</a>"}, {"owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 0, "creation_date": 1482341335, "post_id": 41267556, "comment_id": 69737913, "body": "The specific problem is it doesn&#39;t calculate the sumif."}, {"owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482350928, "post_id": 41267556, "comment_id": 69743229, "body": "@Mat&#39;sMug I&#39;m not sure.  I didn&#39;t write the initial code"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 1, "creation_date": 1482341707, "post_id": 41267613, "comment_id": 69738113, "body": "@JBree You could also use <code>Application.Evaluate(&quot;=SUMIFS(&#39;Calc by loan&#39;!C:D,&quot;&quot;Salesperson&quot;&quot;,&#39;Calc by loan&#39;!D:D)&quot;)</code>"}, {"owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482350849, "post_id": 41267613, "comment_id": 69743194, "body": "@DavidZemens I get a runtime error 13 type mismatch with that code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482351404, "post_id": 41267613, "comment_id": 69743489, "body": "<code>Sumact = Application.WorksheetFunction.SumIf(Worksheets(&quot;Calc by loan&quot;).Range(&quot;C:C&quot;),&quot;Salesperson&quot;,Worksheets(&quot;Calc by loan&quot;).Range(&quot;D:D&quot;))</code> does not give me any problems."}, {"owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 0, "creation_date": 1482353740, "post_id": 41267613, "comment_id": 69744769, "body": "@ScottCraner You&#39;re right.  I no longer get the error, but it&#39;s not putting the sum in the field.  If I want it in the earningsDue column, should I start it with earningsDue = Application.Worksheet...... ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 1, "creation_date": 1482353895, "post_id": 41267613, "comment_id": 69744845, "body": "@JBree you do not do anything with Sumact.  so if you want it to show up in a cell then you need to do something with that value."}, {"owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 0, "creation_date": 1482423497, "post_id": 41267613, "comment_id": 69777054, "body": "@ScottCraner So could I do something like   earningsDue = Sumact  I&#39;m really new at this (obviously).  Thanks for all your help"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 0, "creation_date": 1482425197, "post_id": 41267613, "comment_id": 69778213, "body": "Sure @JBree Just remember that variables only last as long as the procedres are running.  Also please mark as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "edited": false, "score": 0, "creation_date": 1482426629, "post_id": 41267613, "comment_id": 69779108, "body": "@ScottCraner I know I&#39;m close.  Here&#39;s what I have for that section...  &#39;Lauren comp         If compPlan = &quot;L&quot; Then                 Sumact = Application.WorksheetFunction.SumIf(Worksheets(&quot;Calc by loan&quot;).Range(&quot;C:C&quot;), &quot;Doe, John&quot;, Worksheets(&quot;Calc by loan&quot;).Range(&quot;D:D&quot;))         End If             ActiveSheet.Range(&quot;AQ&quot; &amp; Index).Value = Sumact"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1482341289, "last_edit_date": 1482341289, "creation_date": 1482338056, "answer_id": 41267613, "question_id": 41267556, "link": "https://stackoverflow.com/questions/41267556/excel-vba-sumif-function/41267613#41267613", "title": "Excel VBA Sumif function", "body": "<p>You would use it like this:</p>\n\n<pre><code>Application.WorksheetFunction.SumIf(Worksheets(\"Calc by loan\").Range(\"C:C\"),\"Salesperson\",Worksheets(\"Calc by loan\").Range(\"D:D\"))\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7326656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d32999f3129c473f8c86eb568b49c5b?s=128&d=identicon&r=PG&f=1", "display_name": "J Bree", "link": "https://stackoverflow.com/users/7326656/j-bree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "accepted_answer_id": 41267613, "answer_count": 1, "score": 0, "last_activity_date": 1482341289, "creation_date": 1482337859, "last_edit_date": 1482337930, "question_id": 41267556, "link": "https://stackoverflow.com/questions/41267556/excel-vba-sumif-function", "title": "Excel VBA Sumif function", "body": "<p>I have a working script that I need to add a sumif to.  I think you should be able to see where I'm trying to enter the formula.  I am trying to reference another sheet in the same workbook.  The section I'm stuck on is if the compPlan = L.</p>\n\n<pre><code>Sub CalculateCommission()\n    Dim Index As Integer    'Row Index\n    Dim employeeName As String 'A\n    Dim compPlan As String  'B\n    Dim baseWage As Double  'AM\n    Dim commAN As Double 'AN\n    Dim guarantee As Double 'AO\n    Dim earningsDue As Double   'AQ\n    Dim priorPay As Double 'AR from prior pay cycle\n    Dim priorBase As Integer 'AS from prior pay cycle\n    Dim newComm As Double   'AU\n    Dim packBack As Double 'AP\n\n    Index = 3\n\n    Do While Len(ActiveSheet.Range(\"B\" &amp; Index))\n        employeeName = UCase(ActiveSheet.Range(\"A\" &amp; Index))\n        compPlan = UCase(ActiveSheet.Range(\"B\" &amp; Index))\n        baseWage = ActiveSheet.Range(\"AM\" &amp; Index)\n        newComm = ActiveSheet.Range(\"AU\" &amp; Index)\n        earningsDue = ActiveSheet.Range(\"AQ\" &amp; Index)\n        guarantee = ActiveSheet.Range(\"AO\" &amp; Index)\n        packBack = ActiveSheet.Range(\"AP\" &amp; Index)\n\n\n        If (IsError(ActiveSheet.Range(\"AR\" &amp; Index)) = False) Then\n            priorPay = ActiveSheet.Range(\"AR\" &amp; Index)\n        Else\n            priorPay = 0\n        End If\n\n        If (IsError(ActiveSheet.Range(\"AS\" &amp; Index)) = False) Then\n            priorBase = ActiveSheet.Range(\"AS\" &amp; Index)\n        Else\n            priorBase = 0\n        End If\n\n        commAN = ActiveSheet.Range(\"AN\" &amp; Index)\n\n\n        If compPlan = \"B\" Or compPlan = \"D\" Or compPlan = \"E\" Or compPlan = \"I\" Or compPlan = \"J\" Or compPlan = \"L\" Then\n                commAN = earningsDue - baseWage - guarantee - priorBase\n            Else\n                commAN = earningsDue - baseWage - guarantee\n        End If\n\n\n        If compPlan = \"L\" Then\n                Sumact = Application.SumIf 'Calc by loan'!C:D,\"Salesperson\",'Calc by loan'!D:D)\n        End If\n\n\n\n        If compPlan = \"B\" Or compPlan = \"D\" Or compPlan = \"E\" Or compPlan = \"I\" Or compPlan = \"J\" Then\n            If baseWage + newComm &gt; baseWage Then\n                earningsDue = baseWage + newComm + guarantee + priorBase - priorPay + packBack\n            Else\n                earningsDue = baseWage + guarantee + packBack\n            End If\n        Else\n            If newComm &gt; baseWage + priorPay Then\n                earningsDue = newComm - priorPay + guarantee + packBack\n            Else\n                earningsDue = baseWage + guarantee + packBack\n            End If\n        End If\n        ActiveSheet.Range(\"AQ\" &amp; Index).Value = earningsDue\n        Index = Index + 1\n    Loop\nEndSub:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "plot", "automation"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482337909, "post_id": 41267473, "comment_id": 69735972, "body": "Have you tried anything?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1482338046, "post_id": 41267473, "comment_id": 69736045, "body": "tables are the best bet."}, {"owner": {"reputation": 3382, "user_id": 2991243, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f8ea812a930b985b785cae4cfae3797?s=128&d=identicon&r=PG&f=1", "display_name": "Eghbal", "link": "https://stackoverflow.com/users/2991243/eghbal"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482338104, "post_id": 41267473, "comment_id": 69736078, "body": "@cyboashu. How can I do that?"}, {"owner": {"reputation": 3382, "user_id": 2991243, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f8ea812a930b985b785cae4cfae3797?s=128&d=identicon&r=PG&f=1", "display_name": "Eghbal", "link": "https://stackoverflow.com/users/2991243/eghbal"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482338180, "post_id": 41267473, "comment_id": 69736130, "body": "@Mat&#39;sMug. Currently I&#39;m checking some VBA codes."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1482338251, "post_id": 41267473, "comment_id": 69736163, "body": "will post an answer in few mins"}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1482338590, "creation_date": 1482338590, "answer_id": 41267791, "question_id": 41267473, "link": "https://stackoverflow.com/questions/41267473/automated-excel-line-chart-updating-using-new-inserted-data/41267791#41267791", "title": "Automated EXCEL line chart updating using new inserted data", "body": "<p>Let's say your data looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/a9d9v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a9d9v.png\" alt=\"enter image description here\"></a></p>\n\n<p>First you need <a href=\"https://support.office.com/en-us/article/Create-or-delete-an-Excel-table-in-a-worksheet-e81aa349-b006-4f8a-9806-5af9df0ac664\" rel=\"nofollow noreferrer\">to convert it to table.</a> </p>\n\n<p><a href=\"https://i.stack.imgur.com/ezeM9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ezeM9.png\" alt=\"enter image description here\"></a></p>\n\n<p>After that yiu are all set, now insert a chart based on this table. </p>\n\n<p>After that, whenever you edit/update your table, the change will be reflected realtime in your chart.</p>\n\n<p>Its that simple.:)</p>\n"}], "owner": {"reputation": 3382, "user_id": 2991243, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f8ea812a930b985b785cae4cfae3797?s=128&d=identicon&r=PG&f=1", "display_name": "Eghbal", "link": "https://stackoverflow.com/users/2991243/eghbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 41267791, "answer_count": 1, "score": 0, "last_activity_date": 1482338590, "creation_date": 1482337569, "question_id": 41267473, "link": "https://stackoverflow.com/questions/41267473/automated-excel-line-chart-updating-using-new-inserted-data", "title": "Automated EXCEL line chart updating using new inserted data", "body": "<p>Suppose that I have some date in EXCEL. I need my line plot automatically updated after adding new data. We can Have more(or less) rows (x1,x2, etc.) or more or less columns (years) or both. I want EXCEL automatically update chart by using new inserted data (we don't know new row and column size). How can I do this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/iAWdI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iAWdI.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1482341505, "post_id": 41267471, "comment_id": 69738012, "body": "its good!!!! but one thing. with the max number, it works with most but there are some areas where it dosnt"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1482349773, "post_id": 41267471, "comment_id": 69742623, "body": "Do you have my edit in, <code>FR = Range(&quot;A1:G1&quot;).End(xlDown).Row &#39;Freeze this row</code>?"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "edited": false, "score": 0, "creation_date": 1482351248, "post_id": 41267471, "comment_id": 69743403, "body": "I think I know what happened. I made a tiny edit to my code that should do the trick, but please do tell me if it doesn&#39;t."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 1, "last_activity_date": 1482351221, "last_edit_date": 1482351221, "creation_date": 1482337565, "answer_id": 41267471, "question_id": 41267199, "link": "https://stackoverflow.com/questions/41267199/remove-duplicates-with-conditions/41267471#41267471", "title": "remove duplicates with conditions", "body": "<p>I feel like the code you wrote is pretty close. I'd just make a few modifications. I think you'd be best to have two loops so you can always compare what is in the first loop with what is in the second.</p>\n\n<pre><code>Sub DeleteTheDoops()\nDim RowNdx As Long \nDim RowNdx2 As Long\nDim FR as Long\nFR = Range(\"A1:G1\").End(xlDown).Row 'Freeze this row\nFor RowNdx = FR To 2 Step -1\n    For RowNdx2 = FR to 2 Step -1\n        'From what I can tell, you are interested when A, E and F are \n        'equal and when C is smallest, so ...\n        If RowNdx &lt;&gt; RowNdx2 and _\n           Cells(RowNdx, \"A\").Value = Cells(RowNdx2, \"A\").Value and _\n           Cells(RowNdx, \"F\").Value = Cells(RowNdx2, \"F\").Value and _\n           Cells(RowNdx, \"E\").Value = Cells(RowNdx2, \"E\").Value and _\n           Cells(RowNdx, \"C\").Value &gt;= Cells(RowNdx2, \"C\").Value Then\n               Rows(RowNdx2).Delete\n        End If\n    Next RowNdx2\nNext RowNdx\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 1, "last_activity_date": 1482341239, "last_edit_date": 1482341239, "creation_date": 1482340872, "answer_id": 41268453, "question_id": 41267199, "link": "https://stackoverflow.com/questions/41267199/remove-duplicates-with-conditions/41268453#41268453", "title": "remove duplicates with conditions", "body": "<p><strong><em>Best approach:</em></strong>\n<br>Your best way to do so is by using a <a href=\"http://analystcave.com/excel-vba-dictionary-arrays-and-other-data-structures/\" rel=\"nofollow noreferrer\">dictionary</a> and, if the elements repeats, erase it. This kind of approach may save you a lot of time if you need to modify parameters later on, as well in the code execution itself. The dictionary itself is designed to manage data structures like this.\n<br><strong><em>Code approach:</em></strong>\n<br>This may give you a nice scope for what you need, suit to your needs.</p>\n\n<pre><code>Sub DuplicatedValues()\nDim DictionaryKey As String: DictionaryKey = \"\"\nDim DictionaryForDups As Dictionary\nDim CounterCriteriaForDup As Long\nDim TotalRows As Long: TotalRows = Sheets(\"MySheet\").Cells(Rows.Count, 1).End(xlUp).Row\nDim CounterRows As Long\n\n    For CounterRows = 2 To TotalRows 'title is 1\n    'Counter criteria is based on the column within the row\n    For CounterCriteriaForDup = 2 To Sheets(\"MySheet\").UsedRange.Columns.Count 'you may use another approach to get last column if needed\n        Select Case CounterCriteriaForDup\n            Case 1, 3, 5, 6 'Column numbers to get criteria to say it's duplicated A=1, C=3, ...\n            DictionaryKey = DictionaryKey &amp; Trim(Cells(CounterRows, CounterCriteriaForDup).Value)\n         End Select\n    Next CounterCriteriaForDup\n    If Not DictionaryForDups.Exists(DictionaryKey) Then ' 1. If Not DictionaryForDups.Exists(DictionaryKey)\n                Call DictionaryForDups.Add(DictionaryKey, CounterRows - 1)\n    Else ' 1. If Not DictionaryForDups.Exists(DictionaryKey)\n        Rows(CounterRows).Delete\n        CounterRows = CounterRows - 1\n        End If ' 1. If Not DictionaryForDups.Exists(DictionaryKey)\n        DictionaryKey = vbNullString\n    Next CounterRows\nEnd Sub\n</code></pre>\n\n<p><strong><em><br>Further comments:</em></strong>\n<br>Data structures like this are hard to deal at first, give a read for other useful data management varaibles, such as arrays, collections in the link gave above. </p>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "is_accepted": false, "score": 0, "last_activity_date": 1482399871, "creation_date": 1482399871, "answer_id": 41280101, "question_id": 41267199, "link": "https://stackoverflow.com/questions/41267199/remove-duplicates-with-conditions/41280101#41280101", "title": "remove duplicates with conditions", "body": "<p>ok, i think i got it.\ni first will delete all diplicates that are the same (1st,2nd,3rd)\nand then ill delete the remaining will the lowest number</p>\n\n<p>thank you @Matt Cremeens</p>\n\n<pre><code>Sub DeleteTheDoops()\nDim RowNdx As LongDim RowNdx2 As LongFor RowNdx = Range(\"A1:G1\").End(xlDown).Row To 3 Step -1\nFor RowNdx2 = RowNdx - 1 To 2 Step -1 'Begin at one above RowNdx\n    'when A, E and F are equal so just delete duplicates as normanl\n    If Cells(RowNdx, \"A\").Value = Cells(RowNdx2, \"A\").Value And _\n       Cells(RowNdx, \"g\").Value = Cells(RowNdx2, \"g\").Value And _\n       Cells(RowNdx, \"f\").Value = Cells(RowNdx2, \"f\").Value And _\n       Cells(RowNdx, \"h\").Value = Cells(RowNdx2, \"h\").Value And _\n       Cells(RowNdx, \"C\").Value = Cells(RowNdx2, \"C\").Value Then\n           Rows(RowNdx2).Delete End If 'now delete duplicates that have a smaller number in column c\n    If Cells(RowNdx, \"A\").Value = Cells(RowNdx2, \"A\").Value And _\n        Cells(RowNdx, \"g\").Value = Cells(RowNdx2, \"g\").Value And _\n        Cells(RowNdx2, \"C\").Value &gt;= Cells(RowNdx - 1, \"C\").Value Then\n           Rows(RowNdx).Delete End If\n\n   Next RowNdx2 Next RowNdx End Sub\n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 7190120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-C1HwOEzASJw/AAAAAAAAAAI/AAAAAAAAABs/pTrPIWoA5yw/photo.jpg?sz=128", "display_name": "aj_bk", "link": "https://stackoverflow.com/users/7190120/aj-bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1289, "favorite_count": 0, "accepted_answer_id": 41267471, "answer_count": 3, "score": 0, "last_activity_date": 1482399871, "creation_date": 1482336607, "question_id": 41267199, "link": "https://stackoverflow.com/questions/41267199/remove-duplicates-with-conditions", "title": "remove duplicates with conditions", "body": "<p>I have a data chart that i update every week. when i add new data i need to delete the duplicate data. but there are conditions, rules what to delete and what not.\nin the pictures i explain.\nbasically i need to manually see if the new data (in yellow) has the same numbers,names,dates and values.</p>\n\n<p>if all data above is the same then its a simple delete duplicate. but if there are some data that isn't the same as the old data i need to keep it. and i also need to keep the data that has the most hours out of the duplicates.(column c)</p>\n\n<p>geez..it sounds crazy but i manged to record a macro (whats in the pictures)</p>\n\n<pre><code>Sub Macro20() ActiveWorkbook.Worksheets(\"excel\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"excel\").Sort.SortFields.Add Key:=Range(\"A2:A80\"), _\n    SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortTextAsNumbers\nActiveWorkbook.Worksheets(\"excel\").Sort.SortFields.Add Key:=Range(\"G2:G80\"), _\n    SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"excel\").Sort\n    .SetRange Range(\"A1:P80\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nActiveSheet.Range(\"$A$1:$P$80\").RemoveDuplicates Columns:=Array(1, 2, 5, 6, 7), _\n    Header:=xlYes  End Sub\n</code></pre>\n\n<p>the problem here is that is dosent keep the highest hour, and that the range isnt dynamic</p>\n\n<p>and i made a code - only that the code dosent keep the biggest number in hours.\nim so close!! what am i missing?   </p>\n\n<pre><code>Sub DeleteTheDoops()\nDim RowNdx As Long \nFor RowNdx = Range(\"A1:G1\").End(xlDown).Row To 2 Step -1\nIf Cells(RowNdx, \"A\").Value = Cells(RowNdx - 1, \"A\").Value Then\n If Cells(RowNdx, \"F\").Value = Cells(RowNdx - 1, \"F\").Value Then\n    If Cells(RowNdx, \"C\").Value &lt;= Cells(RowNdx - 1, \"C\").Value Then\n    If Cells(RowNdx, \"E\").Value &lt;= Cells(RowNdx - 1, \"E\").Value Then\n       Rows(RowNdx).Delete\n    Else\n        Rows(RowNdx - 1).Delete\n    End If\nEnd If \nEnd If \nEnd IfNext RowNdx\nEnd Sub\n</code></pre>\n\n<p>im kinda lost. hope i was clear. thank you !!</p>\n\n<p><a href=\"https://i.stack.imgur.com/XWk3r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XWk3r.png\" alt=\"1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0VtlM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0VtlM.png\" alt=\"2\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0V9uB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0V9uB.png\" alt=\"3\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0aOWe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0aOWe.png\" alt=\"4\"></a></p>\n"}, {"tags": ["vba", "dialog", "wordbasic"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482335393, "post_id": 41266713, "comment_id": 69734291, "body": "IMO the only reliably safe way to &quot;convert&quot; that <code>UserDialog</code> is to add a new <code>UserForm</code> to your VBA project, and [re-]create it from scratch."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482335554, "post_id": 41266713, "comment_id": 69734401, "body": "@Mat&#39;sMug thanks. I was also think this, but I have a hard time finding information about the <code>UserDialog</code> and what these parametres means."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482335854, "post_id": 41266713, "comment_id": 69734613, "body": "You&#39;re probably better off re-designing it off a screenshot of the original one. The 4 first parameters look like coordinates, and then there&#39;s a caption when relevant to the control, and the other parameter seems to assign a <i>dialog function</i>, whatever that does. Could possibly be mapping to <code>Property Get</code> and <code>Property Let</code> members in the dialog&#39;s code-behind."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482336155, "post_id": 41266713, "comment_id": 69734862, "body": "Is that WordBasic?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482336219, "post_id": 41266713, "comment_id": 69734905, "body": "@Comintern from what I have Googled so far, something could suggest it is, but I am unsure."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482336742, "post_id": 41266713, "comment_id": 69735262, "body": "Looks like there&#39;s an automatic VBA conversion if you open an ancient Word document in Word 2007.  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194689.aspx\" rel=\"nofollow noreferrer\">This link</a> might be helpful."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482336868, "post_id": 41266713, "comment_id": 69735357, "body": "@Comintern unfortunately, I do not have access to a Word 95 template :-( My macro is an exported file."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1482337094, "post_id": 41266713, "comment_id": 69735498, "body": "I have found this <a href=\"https://msdn.microsoft.com/en-us/library/aa211967(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa211967(v=office.11).aspx</a> I might be useful, I will take a look."}, {"owner": {"user_type": "does_not_exist", "display_name": "user65839"}, "edited": false, "score": 0, "creation_date": 1482342208, "post_id": 41266713, "comment_id": 69738370, "body": "Yes, that looks like WordBasic to me. (I vaguely remember playing around with WordBasic briefly as a child making a simple guess-my-number game in it.) This is so old it may fit better on Retrocomputing.SE (though I&#39;m only half-serious). As others have said, you&#39;ll probably just need to figure out what it&#39;s doing and reimplement in current VBA."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user65839"}, "is_accepted": false, "score": 0, "last_activity_date": 1500385113, "creation_date": 1500385113, "answer_id": 45168463, "question_id": 41266713, "link": "https://stackoverflow.com/questions/41266713/how-to-convert-a-vb-userdialog-to-vba-userform/45168463#45168463", "title": "How to convert a VB UserDialog to VBA UserForm?", "body": "<p>WordBASIC is pretty old. There is <a href=\"https://msdn.microsoft.com/en-us/library/office/aa211926%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">some ability in some versions of Word to automatically convert WordBASIC to VBA</a>, so you could try that if you can find the right version (probably the older the better, back to Word 97 when VBA was introduced), but I wouldn't really expect a whole lot out of it.</p>\n\n<p>Your best bet is probably to do as you suggest: Create a new form in VBA style, use the code as a baseline of what controls are needed and roughly how the dialog was laid out, and hook up the logic to the rest of the code as needed.</p>\n\n<p>\"Best practice\" as with any porting project is to ensure you know the real business requirements as best as you can, and use the existing code as a guideline (and to help understand the real business requirements better), but really implement modern code \"the right way\" to accomplish your actual business objectives, rather than just trying to port over line by line.</p>\n"}], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1500385113, "creation_date": 1482335113, "last_edit_date": 1500294528, "question_id": 41266713, "link": "https://stackoverflow.com/questions/41266713/how-to-convert-a-vb-userdialog-to-vba-userform", "title": "How to convert a VB UserDialog to VBA UserForm?", "body": "<p>I have this really old macro from 1996 (yes!) that I think is somewhat Visual Basic (not sure tho) that I cannot get to work in VBA. The most of the code is running fine, but I am troubled by the <code>UserForm</code> as it is called <code>Dialog</code> in this code.<br>\nI think I need to create a userform instead as VB does not operate with that. But I am not sure how to tackle it. Should I just create a new userform and place the objects according to the coordinates and then it will work or what is best practice?</p>\n\n<pre><code>     Begin Dialog UserDialog x,y,291,171,\"Batch Printing\",.DialogFunction\n            OKButton 204, 152, 40, 14\n            CancelButton 248, 152, 40, 14\n            Text 8, 4, 20, 8, \"Path:\", .Text1\n            TextBox 8, 16, 96, 12, .dPath\n            Text 8, 56, 32, 8, \"Files:\", .Text2\n            ListBox 8, 68, 96, 96, sFilesList$, .dFiles\n            PushButton 36, 36, 40, 14, \"&amp;Refresh\", .dRefresh\n            GroupBox 112, 8, 176, 92, \"Select a printer\", .SelectPrinter\n            OptionGroup .PrinterSelection\n                    OptionButton 120, 24, 92, 8, \"&amp;Default Printer\", .DefPrint\n                    OptionButton 120, 56, 84, 8, \"&amp;Specific Printer\", .SpecPrint\n            Text 128, 36, 148, 8, sDefaultPrinter, .Text3\n            DropListBox 120, 68, 160, 52, sPrinterList, .SpecificPrinter\n    End Dialog\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": true, "score": 2, "last_activity_date": 1482336293, "last_edit_date": 1482336293, "creation_date": 1482335598, "answer_id": 41266870, "question_id": 41266712, "link": "https://stackoverflow.com/questions/41266712/using-one-macro-on-different-tables-independently/41266870#41266870", "title": "Using one macro on different tables, independently", "body": "<p>I have 3 examples for you, the first finds the table for the cell you specify.  In this case you need to change the <code>D6</code> in <code>TableName = ActiveSheet.Range(\"D6\").ListObject.Name</code> to a cell inside the table. After finding the table, it runs the filter on that table.  All 3 examples will throw a message box if a table is not found, you can comment that out or delete it if you don't want it.  You should be able to tie your button to any of the 3 and use it.  </p>\n\n<p>I found the code to find the table <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">here</a> and modified it to work with your provided code.</p>\n\n<pre><code>Sub RangeTable()\n\nDim TableName As String\nDim ActiveTable As ListObject\n\n'Determine if ActiveCell is inside a Table\n  On Error GoTo NoTableSelected\n    TableName = ActiveSheet.Range(\"D6\").ListObject.Name 'Change range to cell inside of table\n    Set ActiveTable = ActiveSheet.ListObjects(TableName)\n  On Error GoTo 0\n\n'Do something with your table variable (ie Add a row to the bottom of the ActiveTable)\n  ActiveTable.Range.AutoFilter Field:=6, Criteria1:=\"&gt;\" &amp; Range(\"K9\").Value\n\nExit Sub\n\n'Error Handling\nNoTableSelected:\n  MsgBox \"There is no Table currently selected!\", vbCritical\n\nEnd Sub\n</code></pre>\n\n<p>The code below will look at the cell you currently have selected, find the table associated with it and then run the filter using that table. </p>\n\n<pre><code>Sub ActiveTable()\n\nDim SelectedCell As Range\nDim TableName As String\nDim ActiveTable As ListObject\n\nSet SelectedCell = ActiveCell\n\n'Determine if ActiveCell is inside a Table\n  On Error GoTo NoTableSelected\n    TableName = SelectedCell.ListObject.Name\n    Set ActiveTable = ActiveSheet.ListObjects(TableName)\n  On Error GoTo 0\n\n'Do something with your table variable (ie Add a row to the bottom of the ActiveTable)\n  ActiveTable.Range.AutoFilter Field:=6, Criteria1:=\"&gt;\" &amp; Range(\"K9\").Value\n\nExit Sub\n\n'Error Handling\nNoTableSelected:\n  MsgBox \"There is no Table currently selected!\", vbCritical\n\nEnd Sub\n</code></pre>\n\n<p>Another alternative is the code below which just runs the filter on the first table found on the ActiveSheet so if you just have one table then this should work fine.  With this one you don't need to select a cell inside the table before running it but if you have more than one table per sheet you may want to use the above code.</p>\n\n<pre><code>Sub SheetTable()\n\nDim TableName As String\nDim ActiveTable As ListObject\n\n'Determine if ActiveCell is inside a Table\n  On Error GoTo NoTableSelected\n    TableName = ActiveSheet.ListObjects.Item(1)\n    Set ActiveTable = ActiveSheet.ListObjects(TableName)\n  On Error GoTo 0\n\n'Do something with your table variable (ie Add a row to the bottom of the ActiveTable)\n  ActiveTable.Range.AutoFilter Field:=6, Criteria1:=\"&gt;\" &amp; Range(\"K9\").Value\n\nExit Sub\n\n'Error Handling\nNoTableSelected:\n  MsgBox \"There is no Table currently selected!\", vbCritical\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 4747513, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/iYTDC.jpg?s=128&g=1", "display_name": "Robert Tan", "link": "https://stackoverflow.com/users/4747513/robert-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 41266870, "answer_count": 1, "score": 0, "last_activity_date": 1482336293, "creation_date": 1482335111, "question_id": 41266712, "link": "https://stackoverflow.com/questions/41266712/using-one-macro-on-different-tables-independently", "title": "Using one macro on different tables, independently", "body": "<p>Goal</p>\n\n<p>A button that executes Autofilter on a table based on cell values. </p>\n\n<p>Problem</p>\n\n<p>When duplicating the sheet, the macro refers to the table on the original sheet.</p>\n\n<p>Current Code</p>\n\n<pre><code>Sub Macro1()\n    ActiveSheet.ListObjects(\"Table33\").Range.AutoFilter Field:=6, Criteria1:=\"&gt;\" &amp; Range(\"K9\").Value\nEnd Sub\n</code></pre>\n\n<p>Is there a way to assign a table in a relative manner? The table always appears in the same cells, sheet by sheet.</p>\n"}, {"tags": ["excel", "vba", "algorithm", "data-structures", "shortest-path"], "answers": [{"tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1482337826, "creation_date": 1482337826, "answer_id": 41267546, "question_id": 41266711, "link": "https://stackoverflow.com/questions/41266711/how-can-i-determine-the-best-data-structure-implementation-for-my-dataset/41267546#41267546", "title": "How can I determine the best data structure/implementation for my dataset?", "body": "<p>Try the book Practical Management Science by Winston &amp; Albright and check out the chapter on Operations Management - lots of models explained in there from the simple onwards. Available online as a pdf : <a href=\"http://ingenieria-industrial.net/downloads/practicalmanagementscience.pdf\" rel=\"nofollow noreferrer\">http://ingenieria-industrial.net/downloads/practicalmanagementscience.pdf</a></p>\n"}, {"tags": [], "owner": {"reputation": 1013, "user_id": 4572265, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9e8188d784d1d6ec3d391288dedce228?s=128&d=identicon&r=PG&f=1", "display_name": "skrubber", "link": "https://stackoverflow.com/users/4572265/skrubber"}, "is_accepted": false, "score": 0, "last_activity_date": 1482504808, "creation_date": 1482504808, "answer_id": 41303573, "question_id": 41266711, "link": "https://stackoverflow.com/questions/41266711/how-can-i-determine-the-best-data-structure-implementation-for-my-dataset/41303573#41303573", "title": "How can I determine the best data structure/implementation for my dataset?", "body": "<p>VBA is more a scripting language than a full-fledged one, though one may contend that the underlying framework is .NET. Why don't you give a shot at C++ or Java? If you intuitively understand the data structure and the algorithm, then it'll be a breeze coding in these. Chapter 4 of Algorithms by Sedgewick and Wayne has a beautiful explanation of Shortest Paths. You may also consider studying Bellman-Ford algorithm if you foresee any negative weight cycles on a vertex. </p>\n"}], "owner": {"reputation": 21, "user_id": 7128109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dee997439df792cc90bcab988c6fa28?s=128&d=identicon&r=PG&f=1", "display_name": "Jr SENG", "link": "https://stackoverflow.com/users/7128109/jr-seng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1482504808, "creation_date": 1482335110, "last_edit_date": 1592644375, "question_id": 41266711, "link": "https://stackoverflow.com/questions/41266711/how-can-i-determine-the-best-data-structure-implementation-for-my-dataset", "title": "How can I determine the best data structure/implementation for my dataset?", "body": "<p>Preface: I'm a self-taught coder, so a lot of my knowledge is limited to my research. I'm hoping to have other opinions as I want to build things right the first time. I need help with determining an appropriate solution and how to implement the solution.</p>\n<hr />\n<p>I'm looking to build a least cost alternative model (essentially a shortest path) for delivering between locations (<code>nodes</code>), based on different modes of transportation (<code>vehicles</code>) and the different roads taken (<code>paths</code>). Another consideration is the product price (<code>value</code>) to determine the least cost path.</p>\n<p>Here are my important data items:</p>\n<ul>\n<li><code>nodes</code>: cities where the product will travel to and from.</li>\n<li><code>paths</code>: roads have different costs, depending on the road.</li>\n<li><code>vehicles</code>: varying vehicles have differing rental costs when transporting (motorbike, car, truck). Note that the cost of a vehicle is not constant, it is highly dependent on the to/from nodes. For example, using a car to go from city A to city B will have a different cost than using a car to go from city B to A or city A to city C.</li>\n<li><code>value</code>: Product value. Again, a product's value is highly dependent on its destination node. The same product can have a different value at City A, B or C.</li>\n</ul>\n<hr />\n<h1>Problem Statement</h1>\n<p>How to setup data structure to best determine where the least cost path would be to get a product from one location to every other location.</p>\n<h1>Possible Solutions</h1>\n<p>From my research, I believe a <strong>weighted graph</strong> data structure would be most suitable for my situation in combination with <strong>dijkstra's</strong> algorithm. I believe breaking the problem down simpler would be essential, to first create a simple weighted graph of only <code>nodes</code> and <code>paths</code>.</p>\n<p>From there, adding the <code>vehicle</code> cost and the product <code>value</code> considerations afterwards. Perhaps just adding the two values as a cost to &quot;visit&quot; a <code>node</code>? (aka incorporate it into the <code>path</code> cost?)</p>\n<p>Thoughts on my current solution? Other considerations I overlooked? Perhaps a better solution?</p>\n<h1>Implementation</h1>\n<p>I'd love to be able to build this within Excel VBA (as that is how I learned how to code) and Excel is what I use for my tools. Would VBA be too limited in this task? How else can I incorporate my analysis with Excel with another language?</p>\n"}, {"tags": ["vba", "ms-access", "macros"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1482334561, "post_id": 41266457, "comment_id": 69733715, "body": "runsql I think from docmd or currentproject.connection.execute"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1482334747, "post_id": 41266457, "comment_id": 69733841, "body": "<a href=\"http://www.utteraccess.com/wiki/index.php/RunSQL_vs_Execute\" rel=\"nofollow noreferrer\">utteraccess.com/wiki/index.php/RunSQL_vs_Execute</a>"}, {"owner": {"reputation": 11, "user_id": 6141343, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f9fb071ff8c96e8d632204a16e68e0?s=128&d=identicon&r=PG&f=1", "display_name": "mattyb", "link": "https://stackoverflow.com/users/6141343/mattyb"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1482335724, "post_id": 41266457, "comment_id": 69734518, "body": "does this have to be done with code or is there a way to do it with built in macro actions?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6141343, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f9fb071ff8c96e8d632204a16e68e0?s=128&d=identicon&r=PG&f=1", "display_name": "mattyb", "link": "https://stackoverflow.com/users/6141343/mattyb"}, "edited": false, "score": 0, "creation_date": 1482344809, "post_id": 41267395, "comment_id": 69739840, "body": "This did not answer the question. It&#39;s a make table query (its the only query in the database) and is the correct one. When you use the macro action &#39;OpenQuery&#39; it does not make a table it opens it as if it were a select query. When I physically click run on the query design itself it does create a table."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 11, "user_id": 6141343, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f9fb071ff8c96e8d632204a16e68e0?s=128&d=identicon&r=PG&f=1", "display_name": "mattyb", "link": "https://stackoverflow.com/users/6141343/mattyb"}, "edited": false, "score": 1, "creation_date": 1482365375, "post_id": 41267395, "comment_id": 69749308, "body": "Please add the Access version tag to your question. Access 2010 behaves as I described. @mattyb"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1482337297, "creation_date": 1482337297, "answer_id": 41267395, "question_id": 41266457, "link": "https://stackoverflow.com/questions/41266457/how-do-i-create-an-ms-access-macro-that-will-run-a-make-table-query-not-just-o/41267395#41267395", "title": "How do I create an ms-access macro that will RUN a make table query? (not just open it)", "body": "<p>Running a make table query from the DB object list is the same as <code>DoCmd.OpenQuery \"make table query\"</code> in VBA, and the same as running a macro with the macro action 'OpenQuery'.</p>\n\n<p>In all cases the table is created (after showing warnings about creating the table).</p>\n\n<p>So either you picked the wrong query, or it isn't actually a make table query (SELECT INTO).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14778497, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3bb698374650f4f2f7b23e55fdcf0fdd?s=128&d=identicon&r=PG", "display_name": "Ramon Wessel", "link": "https://stackoverflow.com/users/14778497/ramon-wessel"}, "is_accepted": false, "score": 0, "last_activity_date": 1607328293, "creation_date": 1607328293, "answer_id": 65177988, "question_id": 41266457, "link": "https://stackoverflow.com/questions/41266457/how-do-i-create-an-ms-access-macro-that-will-run-a-make-table-query-not-just-o/65177988#65177988", "title": "How do I create an ms-access macro that will RUN a make table query? (not just open it)", "body": "<p>You probably already solved your issue, but Andre's answer is correct, you just have to make sure that you save your query once you make it as a &quot;Make table&quot; query. It should show in your object list with an exclamation mark to indicate it will update data.</p>\n"}], "owner": {"reputation": 11, "user_id": 6141343, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f9fb071ff8c96e8d632204a16e68e0?s=128&d=identicon&r=PG&f=1", "display_name": "mattyb", "link": "https://stackoverflow.com/users/6141343/mattyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3278, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1607328293, "creation_date": 1482334386, "last_edit_date": 1483023574, "question_id": 41266457, "link": "https://stackoverflow.com/questions/41266457/how-do-i-create-an-ms-access-macro-that-will-run-a-make-table-query-not-just-o", "title": "How do I create an ms-access macro that will RUN a make table query? (not just open it)", "body": "<p>I am trying to create a macro in access 2013 that RUNS a make table query. As far as I can tell, using the macro action 'OpenQuery' is the most obvious action that could do this. However, this literally opens the query and doesn't create an actual physical table.</p>\n\n<p>How do I make this macro RUN the make table query to create a new table?</p>\n"}, {"tags": ["ms-access", "vba", "kml", "google-earth"], "answers": [{"tags": [], "owner": {"reputation": 224, "user_id": 1422243, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4aa03dd2bab8886ae745c8cfaa465d01?s=128&d=identicon&r=PG", "display_name": "Passage", "link": "https://stackoverflow.com/users/1422243/passage"}, "is_accepted": false, "score": 0, "last_activity_date": 1482336008, "creation_date": 1482336008, "answer_id": 41267014, "question_id": 41266314, "link": "https://stackoverflow.com/questions/41266314/vba-sub-reads-file-differently-than-file-explorer/41267014#41267014", "title": "VBA sub reads file differently than file explorer", "body": "<p>It seems that the problem lay in the fact that the file was still open for editing when the shell script to run it was called. The problem stopped occurring after moving <code>Close #1</code> between <code>Print #1, output</code> and <code>Dim wsh As Object</code>.</p>\n\n<pre><code>Print #1, output 'Print to file.\nClose #1\nDim wsh As Object\n</code></pre>\n"}], "owner": {"reputation": 224, "user_id": 1422243, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4aa03dd2bab8886ae745c8cfaa465d01?s=128&d=identicon&r=PG", "display_name": "Passage", "link": "https://stackoverflow.com/users/1422243/passage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594640797, "creation_date": 1482334029, "last_edit_date": 1594640797, "question_id": 41266314, "link": "https://stackoverflow.com/questions/41266314/vba-sub-reads-file-differently-than-file-explorer", "title": "VBA sub reads file differently than file explorer", "body": "<p>I am building an Access form that should allow users to input a street address in the form of Address (number), Street, Town, County, State. Once this is done, they can click a button to generate a KML file defining a placemark at that address and open it in Google Earth. However, when the file is opened, Google Earth gives an error, stating \"No results - empty KML file\". If the file is then opened manually through File Explorer, the placemark generates (nearly) as expected. The method code and generated KML for the input <code>address = 3</code>, <code>street = \"Todd Lane\"</code>, <code>Town = \"Old Tappan\"</code>, <code>County = Bergen</code>, <code>State = \"New Jersey\"</code> are shown below.</p>\n\n<pre><code>Private Sub ExportToKMLButton_Click()\n    Dim FName As String\n    FName = \"C:\\Users\\Public\\QueryOutput.KML\"\n    Close #1 'Make sure nothing is already open as #1.\n    Open FName For Output As #1 'Open the file defined by FName.\n\n    Dim outputtext As New Collection\n    outputtext.Add \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" 'Denotes the language to follow.\n    outputtext.Add Item:=\"&lt;kml xmlns=\"\"http://earth.google.com/kml/2.0\"\"&gt;\"\n    outputtext.Add Item:=\"&lt;Document&gt;\"\n        outputtext.Add Item:=\"&lt;Placemark&gt;\"\n            outputtext.Add Item:=\"&lt;name&gt;Active Location&lt;/name&gt;\"\n            outputtext.Add Item:=\"&lt;lookat&gt;Active Location&lt;/name&gt;\"\n            outputtext.Add Item:=\"&lt;address&gt;\" &amp; Address.Value &amp; \" \" &amp; Street.Value &amp; _\n            \", \" &amp; Town.Value &amp; \", \" &amp; County.Value &amp; \" County, \" &amp; State.Value &amp; \"&lt;/address&gt;\"\n        outputtext.Add Item:=\"&lt;/Placemark&gt;\"\n    outputtext.Add Item:=\"&lt;/Document&gt;\"\n    outputtext.Add Item:=\"&lt;/kml&gt;\"\n\n    Dim output As String\n    Dim i As Long\n    For i = 1 To outputtext.Count\n        output = output &amp; outputtext.Item(i)\n    Next i\n\n    output = Replace(output, \"&amp;\", \"and\") 'Remove any ampersands from the output to avoid errors.\n    Print #1, output 'Print to file.\n\n    Dim wsh As Object\n    Set wsh = VBA.CreateObject(\"WScript.Shell\")\n    wsh.Run FName, 1, True\n    On Error GoTo EndOfExport 'If the user runs this function twice consecutively, without closing Google Earth, both instances of the function _\n                               will resume simultaneously when Earth is closed. One will delete the single extant copy of the KML file, and the _\n                               other will attempt to do the same. When the file is not found, an error will occur. This error does no harm, so _\n                               we simply skip it and end the function.\n    'Kill FName 'Deletes the generated file after opening it.\n    GoTo EndOfExport\nErrorFound:\n    MsgBox (\"An error has occurred. Your export may be incomplete.\")\nEndOfExport:\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>And the generated KML (edited for readability; no line breaks in original):</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;kml xmlns=\"http://earth.google.com/kml/2.0\"&gt;\n&lt;Document&gt;\n&lt;Placemark&gt;\n&lt;name&gt;Active Location&lt;/name&gt;\n&lt;address&gt;3 Todd Lane, Old Tappan, Bergen County, New Jersey&lt;/address&gt; \n&lt;/Placemark&gt;\n&lt;/Document&gt;\n&lt;/kml&gt;\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482332468, "post_id": 41265738, "comment_id": 69732241, "body": "can you also tag this with Access-VBA?  Can&#39;t you just parameterise it?  Make instances of &quot;TestTable&quot; a variable that you pass in as a parameter?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1482333280, "post_id": 41265738, "comment_id": 69732826, "body": "are the tables the same in size (width) you could use a UNION query, with a &#39;table name&#39; addition?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1482333602, "post_id": 41265738, "comment_id": 69733016, "body": "You need to show some XML data and explain how you want to integrate as XML maintans nested tree structure? Where should tables be inserted?"}, {"owner": {"reputation": 1, "user_id": 7326286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca72583ce0b0851a221ef84ca3a600f3?s=128&d=identicon&r=PG&f=1", "display_name": "try4356", "link": "https://stackoverflow.com/users/7326286/try4356"}, "edited": false, "score": 0, "creation_date": 1483438518, "post_id": 41265738, "comment_id": 70088224, "body": "The tables will be inserted in a powerpoint. But the guy who does it need the xml tables nested like this. the problem is i can only do it with that format with 1 table in this case &quot;testtable&quot;. But i have 50 more tables i need exported to xml in one file, and i don&#39;t how to do it."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1487558656, "creation_date": 1487558656, "answer_id": 42335655, "question_id": 41265738, "link": "https://stackoverflow.com/questions/41265738/export-multiple-tables-from-access-to-one-xml-file/42335655#42335655", "title": "Export multiple tables from Access to one XML file", "body": "<p>Consider looping through all tables of database using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195790.aspx\" rel=\"nofollow noreferrer\">TableDefs</a> collection, iteratively calling your <code>ExportXML()</code> function with passed-in parameter. And at the same time build a special XSLT script to later bind all resulting XML files into one master file. </p>\n\n<p>As information, XSLT is a special-purpose language designed to transform XML files and can import an external XML using its <code>document()</code> function. The XSLT must be saved to disk and not used in memory since it must read directory for other XML files.</p>\n\n<p><strong>XSLT</strong> Model </p>\n\n<p><em>(script that is dynamically built in code below; notice first Table1.xml not declared since it is the original transformation source in VBA)</em></p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;xsl:transform xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" version=\"1.0\"&gt;\n  &lt;xsl:output version=\"1.0\" encoding=\"UTF-8\" indent=\"yes\" method=\"xml\"/&gt;\n  &lt;xsl:strip-space elements=\"*\"/&gt;\n\n  &lt;xsl:template match=\"/\"&gt;\n    &lt;root&gt;\n      &lt;xsl:copy-of select=\"*\"/&gt;\n      &lt;xsl:copy-of select=\"document('Table2.xml')/root/*\"/&gt;\n      &lt;xsl:copy-of select=\"document('Table3.xml')/root/*\"/&gt;\n      &lt;xsl:copy-of select=\"document('Table4.xml')/root/*\"/&gt;\n      ...\n      &lt;xsl:copy-of select=\"document('Tabl50.xml')/root/*\"/&gt;\n    &lt;/root&gt;\n  &lt;/xsl:template&gt;\n&lt;/xsl:transform\n</code></pre>\n\n<p><strong>VBA</strong> <em>(using original function with parameter of table name)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function ExportXML(tblname As String)\n    '...same exact code with following line changes...\n\n    strSQL = \"select * from [\" &amp; tblname &amp; \"]\"\n    '...\n    path = Application.CurrentProject.Path &amp; \"\\\" &amp; tblname &amp; \".xml\" \n\n    ' REMOVE SUCCESS MSGBOX\nEnd Function\n\nPublic Sub MasterXMLFile()\nOn Error GoTo ErrHandle\n    ' ADD VBA REFERENCE: MSXML, v6.0\n    Dim xmlDoc As New MSXML2.DOMDocument60, xslDoc As New MSXML2.DOMDocument60, newDoc As New MSXML2.DOMDocument60\n    Dim xslstr As String, firstXML As String\n    Dim tbl As TableDef\n    Dim i As Integer: i = 1\n\n    ' START XSLT\n    xslstr = \"&lt;xsl:transform xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" version=\"\"1.0\"\"&gt;\" _\n                    &amp; \" &lt;xsl:output version=\"\"1.0\"\" encoding=\"\"UTF-8\"\" indent=\"\"yes\"\" method=\"\"xml\"\"/&gt;\" _\n                    &amp; \" &lt;xsl:strip-space elements=\"\"*\"\"/&gt;\" _\n                    &amp; \"   \" _\n                    &amp; \"   &lt;xsl:template match=\"\"/\"\"&gt;\" _\n                    &amp; \"     &lt;root&gt;\" _\n                    &amp; \"       &lt;xsl:copy-of select=\"\"*\"\"/&gt;\"\n\n    For Each tbl In CurrentDb.TableDefs\n        If i = 1 Then firstXML = tbl.Name\n        ' CALL ORIGINAL FUNCTION\n        Call ExportXML(tbl.Name)\n\n        ' CONCATENATE XSLT STRING\n        xslstr = xslstr &amp; \"  &lt;xsl:copy-of select=\"\"document('\" &amp; tbl.Name &amp; \".xml')/root/*\"\"/&gt;\"\n        i = i + 1    \n    Next tbl\n\n    ' END XSLT\n    xslstr = xslstr &amp; \"     &lt;/root&gt;\" _\n                    &amp; \"   &lt;/xsl:template&gt;\" _\n                    &amp; \"   \" _\n                    &amp; \"&lt;/xsl:transform&gt;\"\n\n    xslDoc.loadXML xslstr\n    xslDoc.Save Application.CurrentProject.Path &amp; \"\\MasterFile.xsl\"\n\n    ' LOAD FIRST XML AND XSL\n    xmlDoc.Load Application.CurrentProject.Path &amp; \"\\\" &amp; firstXML &amp; \".xml\"\n\n    Set xslDoc = New MSXML2.DOMDocument60\n    xslDoc.Load Application.CurrentProject.Path &amp; \"\\MasterFile.xsl\"\n    xslDoc.async = False\n    xslDoc.SetProperty \"AllowDocumentFunction\", True\n\n    ' TRANSFORM SOURCE TO NEW DOCUMENT\n    xmlDoc.transformNodeToObject xslDoc, newDoc\n\n    ' SAVE TRANSFORMED RESULT\n    newDoc.Save Application.CurrentProject.Path &amp; \"\\MasterFile.xml\"\n\n    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing\n    MsgBox \"Succesfully built Master database XML!\", vbDefaultButton1, \"Export\"\n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"RUNTIME ERROR\"\n    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing\n    Exit Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7326286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca72583ce0b0851a221ef84ca3a600f3?s=128&d=identicon&r=PG&f=1", "display_name": "try4356", "link": "https://stackoverflow.com/users/7326286/try4356"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 700, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594640393, "creation_date": 1482332370, "last_edit_date": 1594640393, "question_id": 41265738, "link": "https://stackoverflow.com/questions/41265738/export-multiple-tables-from-access-to-one-xml-file", "title": "Export multiple tables from Access to one XML file", "body": "<p>I can only export 1 table from Access with this code.</p>\n\n<pre><code>Option Compare Database\n\nFunction ExportXML()\n\n'Init root xml\nDim objDom As DOMDocument\nSet objDom = New DOMDocument\n\nDim objRootElem As IXMLDOMElement\nSet objRootElem = objDom.createElement(\"root\")\nobjDom.appendChild objRootElem\n\nDim objChartElem As IXMLDOMElement\nSet objChartElem = objDom.createElement(\"charts\")\nobjRootElem.appendChild objChartElem\n'At this point we will have root-&gt;charts\n\n'Get current database file\nDim db As Database\nSet db = CurrentDb\n\n'Construct query\nDim strSQL As String\nstrSQL = \"select * from TestTable\"\n\n'Get result set\nDim rs As DAO.Recordset\nSet rs = db.OpenRecordset(strSQL)\n\n'Create chartEntry in xml\nDim objSpecificChartElem As IXMLDOMElement\nSet objSpecificChartElem = objDom.createElement(\"chart\")\nobjChartElem.appendChild objSpecificChartElem\n\n' Creates Attribute to the Member Element\nSet objKeyRel = objDom.createAttribute(\"Key\")\nobjKeyRel.nodeValue = \"TestTable\" 'Value corresponds to table name\nobjSpecificChartElem.setAttributeNode objKeyRel\n\n'Looping through each row\nDo While Not rs.EOF\n    'Current row\n\n    'Create entry in specific chart element\n    Dim objRowElem As IXMLDOMElement\n    Set objRowElem = objDom.createElement(\"col\")\n    objSpecificChartElem.appendChild objRowElem\n\n    'We skip the ID column\n    For i = 1 To rs.Fields.Count - 1\n        'Each field\n\n        Dim objColElem As IXMLDOMElement\n        Set objColElem = objDom.createElement(\"string\") 'Add logic to determine datatype\n        objRowElem.appendChild objColElem\n\n        'Extract value and add to element\n        Set objColValue = objDom.createAttribute(\"val\")\n        objColValue.nodeValue = rs.Fields(i).Value\n        objColElem.setAttributeNode objColValue\n\n    Next i\n\n    'Next\n    rs.MoveNext\nLoop\n\n'Save\nDim path As String\npath = CurrentDb.Name &amp; \".export.xml\"\nobjDom.Save (path)\n\n'Show success\nMsgBox \"Succesfully exported at: \" &amp; path, vbDefaultButton1, \"Export\"\n\n\nEnd Function\n</code></pre>\n\n<p>How do I use the format of this code but export multiple tables to one XML file?</p>\n\n<p>The XML output will look like this.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; \n&lt;root&gt;     \n&lt;charts&gt;         \n&lt;chart key=\"testtable\"&gt;             \n&lt;col&gt;                 \n&lt;string val=\"quarter\"/&gt;                 \n&lt;string val=\"Q1\"/&gt;                \n&lt;string val=\"Q2\"/&gt;                 \n&lt;string val=\"Q3\"/&gt;                 \n&lt;string val=\"Q4\"/&gt;             \n&lt;/col&gt;             \n&lt;col&gt;                 \n&lt;string val=\"Group 1\"/&gt;                 \n&lt;double val=\"100.1\"/&gt;                 \n&lt;double val=\"200.6\"/&gt;                 \n&lt;double val=\"250\"/&gt;                 \n&lt;double val=\"300.8\"/&gt;             \n&lt;/col&gt;             \n&lt;col&gt;                 \n&lt;string val=\"Group 2\"/&gt;                 \n&lt;double val=\"250\"/&gt;                 \n&lt;double val=\"100.1\"/&gt;                 \n&lt;double val=\"300.8\"/&gt;                 \n&lt;double val=\"200.6\"/&gt;             \n&lt;/col&gt;             \n&lt;col&gt;                 \n&lt;string val=\"growth\"/&gt;                 \n&lt;double val=\"22.5\"/&gt;                 \n&lt;double val=\"-5.1\"/&gt;                 \n&lt;double val=\"3.8\"/&gt;                 \n&lt;double val=\"50.6\"/&gt;             \n&lt;/col&gt;         \n&lt;/chart&gt;         \n&lt;chart key=\"halfyear\"&gt;             \n&lt;col&gt;                 \n&lt;string val=\"Period\"/&gt;                 \n&lt;string val=\"spring\"/&gt;                 \n&lt;string val=\"winter\"/&gt;             \n&lt;/col&gt;             \n&lt;col&gt;                 \n&lt;string val=\"numbers\"/&gt;                 \n&lt;double val=\"50\"/&gt;                 \n&lt;double val=\"150\"/&gt;             \n&lt;/col&gt;             \n&lt;col&gt;                 \n&lt;string val=\"price\"/&gt;                 \n&lt;double val=\"8.3\"/&gt;                 \n&lt;double val=\"1.2\"/&gt;            \n&lt;/col&gt;             \n&lt;col&gt;                    \n&lt;string val=\"difference\"/&gt;                 \n&lt;double val=\"0\"/&gt;                 \n&lt;double val=\"-7\"/&gt;             \n&lt;/col&gt;         \n&lt;/chart&gt;     \n&lt;/charts&gt; \n&lt;/root&gt; \n</code></pre>\n\n<p>This is how the table should look:</p>\n\n<p><img src=\"https://i.stack.imgur.com/LcDST.png\" alt=\"table\"></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482332198, "post_id": 41265486, "comment_id": 69732057, "body": "Can you just store both encodings in the database?"}, {"owner": {"reputation": 23, "user_id": 7320204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ad560c2719774bf1065a2f9360f4ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7320204/dan"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482332361, "post_id": 41265486, "comment_id": 69732174, "body": "1. That does not solve the issue - it just goes around it."}, {"owner": {"reputation": 23, "user_id": 7320204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ad560c2719774bf1065a2f9360f4ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7320204/dan"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482332502, "post_id": 41265486, "comment_id": 69732267, "body": "2. What about the 7,000+ users that are already there? 3. when I open new accounts i will still need the same function."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482333085, "post_id": 41265486, "comment_id": 69732696, "body": "Then I guess I&#39;m not clear on what you&#39;re looking for.  Are you looking for some way to change the encoding of the input strings from the user? What encoding are they reaching your application <i>in</i>? What encoding are you using in the database?"}, {"owner": {"reputation": 23, "user_id": 7320204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ad560c2719774bf1065a2f9360f4ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7320204/dan"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482347384, "post_id": 41265486, "comment_id": 69741287, "body": "As I explained in my question, the problem is when the keyboard is on one language and the username is in the other then the username has to be retyped in the correct language. what i am looking for is that it find the result even when it was typed in the wrong language."}], "answers": [{"tags": [], "owner": {"reputation": 52, "user_id": 7320109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093cab90150f60c135c78a5ffa05aecc?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ess", "link": "https://stackoverflow.com/users/7320109/dee-ess"}, "is_accepted": true, "score": 0, "last_activity_date": 1482342204, "creation_date": 1482342204, "answer_id": 41268813, "question_id": 41265486, "link": "https://stackoverflow.com/questions/41265486/what-would-be-the-best-way-to-convert-input-into-other-keyboard-languages/41268813#41268813", "title": "What would be the best way to convert input into other keyboard languages?", "body": "<p>This should work:</p>\n\n<pre><code>SearchBox_AfterUpdate()\nsearchstringlang1 = Me.searchbox\nsearchstringlang2 = Me.searchbox\nstr1 = \"qwertyuiopasdfghjkl;zxcvbnm,./\" &amp; \"/'\u05e7\u05e8\u05d0\u05d8\u05d5\u05df\u05dd\u05e4\u05e9\u05d3\u05d2\u05db\u05e2\u05d9\u05d7\u05dc\u05da\u05e3\u05d6\u05e1\u05d1\u05d4\u05e0\u05de\u05e6\u05ea\u05e5\"\nstr2 = \"/'\u05e7\u05e8\u05d0\u05d8\u05d5\u05df\u05dd\u05e4\u05e9\u05d3\u05d2\u05db\u05e2\u05d9\u05d7\u05dc\u05da\u05e3\u05d6\u05e1\u05d1\u05d4\u05e0\u05de\u05e6\u05ea\u05e5\" &amp; \"qwertyuiopasdfghjkl;zxcvbnm,./\"\nFor n = 1 To Len(searchstringlang1)\nIf InStr(1, str1, Mid(searchstringlang1, n, 1)) &gt; 0 Then\nsearchstringlang2 = searchstringlang2 &amp; Mid(str2, InStr(1, str1, Mid(searchstringlang1, n, 1)), 1)\nElse\nsearchstringlang2 = searchstringlang2 &amp; Mid(searchstringlang1, n, 1)\nEnd If\nNext\nMe.Filter = \"[username]\" &amp; \" like \"\"*\" &amp; searchstring &amp; \"*\"\" or [username]  like \"\"*\" &amp; searchstringlang2 &amp; \"*\"\"\"\nEnd Sub\n</code></pre>\n\n<p>Obviously you can do this in any language (I picked the language you used in your example) granted that you type both languages in the same order for the two strings [<code>str1</code> and <code>str2</code>].</p>\n\n<p>Much Luck</p>\n"}], "owner": {"reputation": 23, "user_id": 7320204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ad560c2719774bf1065a2f9360f4ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7320204/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 41268813, "answer_count": 1, "score": 0, "last_activity_date": 1594640793, "creation_date": 1482331559, "last_edit_date": 1594640793, "question_id": 41265486, "link": "https://stackoverflow.com/questions/41265486/what-would-be-the-best-way-to-convert-input-into-other-keyboard-languages", "title": "What would be the best way to convert input into other keyboard languages?", "body": "<p>I recently built an access program where there are accounts for customers at an agency.</p>\n\n<p>The problem is that <strong>lots of their customer's account names are not in english</strong>. this makes it difficult for agents to search because they have to keep changing between the two languages.</p>\n\n<p>I sent them a software I found that enables changing the language after it has been entered (<a href=\"http://langover.com/\" rel=\"nofollow noreferrer\">http://langover.com/</a>) but they are not happy with it.</p>\n\n<p>They want me to build them something that will automatically search in both languages.</p>\n\n<p>Below is the code I am using now:</p>\n\n<pre><code>Private Sub SearchBox_AfterUpdate()\n    Me.Filter = \"[USER]\" &amp; \" like \"\"*\" &amp; me.SearchBox &amp; \"*\"\" \n    Me.FilterOn = True\nEnd Sub\n</code></pre>\n\n<p>What would be the best way to get two strings according to the two keyboard language setups?</p>\n\n<p>(For example when typing <code>akuo</code> you would get results for <code>akuo</code> as well as <code>\u05e9\u05dc\u05d5\u05dd</code>)</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482333415, "post_id": 41265414, "comment_id": 69732898, "body": "If you want people to recreate you should highlight what sheets are referenced in your formula.  I can see <code>Data</code> and <code>Home</code> so far."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "edited": false, "score": 0, "creation_date": 1482332299, "post_id": 41265641, "comment_id": 69732125, "body": "i need this formula to be inserted to more than 100 rows though. I need this to be inserted down the entire column of L"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "edited": false, "score": 0, "creation_date": 1482332435, "post_id": 41265641, "comment_id": 69732224, "body": "@Bing.Wong you will crash Excel.  That many array formulas that refer to full column references like you have will cause huge delays in computations.  You need to limit all the references and the number of entries to only what is in the referenced data set and the actual number of data point in column J."}, {"owner": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "edited": false, "score": 0, "creation_date": 1482332689, "post_id": 41265641, "comment_id": 69732395, "body": "ok point taken. Is there a way i can insert these formulas down to the last used row then please? E.G. Last used row from column A for instance."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "edited": false, "score": 0, "creation_date": 1482332808, "post_id": 41265641, "comment_id": 69732482, "body": "Yo need to do more than that.  If your data set  on Data is not over 1 million lines you need to adjust your formula to only the extents of that data."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482333556, "last_edit_date": 1482333556, "creation_date": 1482332056, "answer_id": 41265641, "question_id": 41265414, "link": "https://stackoverflow.com/questions/41265414/vba-insert-array-formula-from-range-to-end-row/41265641#41265641", "title": "vba insert array formula from range to end row?", "body": "<p>The reason you get the error is the <code>\"\"</code> to provide double quotes to the formula you need to use <code>\"\"\"\"</code> instead.</p>\n\n<p>Then you would enter the formula into L10 this way:</p>\n\n<pre><code>ActiveSheet.Range(\"L10\").FormulaArray = \"=IF(J10&lt;&gt;\"\"\"\",INDEX(Data!B:B,MATCH(1,(Home!H10=Data!C:C)*(Home!I10=Data!D:D)*(Home!J10=Data!E:E),0)),INDEX(Data!B:B,MATCH(1,(Home!H10=Data!C:C)*(Home!I10=Data!D:D)*(K10=Data!F:F),0)))\"\n</code></pre>\n\n<p>Then to fill the rows below use Range.AutoFill</p>\n\n<pre><code>ActiveSheet.Range(\"L10\").AutoFill .Range(\"L10:l100\")\n</code></pre>\n\n<p>Where L10:L100 is the range into which the formula is to be placed.</p>\n\n<p>So:</p>\n\n<pre><code>Sub Check()\nDim lastrow As Long\nDim sht As Worksheet\n\nSet sht = ActiveSheet\nWith sht\n    lastrow = .Cells(.Rows.Count, 10).End(xlUp).Row\n\n    .Range(\"L10\").FormulaArray = \"=IF(J10&lt;&gt;\"\"\"\",INDEX(Data!B:B,MATCH(1,(Home!H10=Data!C:C)*(Home!I10=Data!D:D)*(Home!J10=Data!E:E),0)),INDEX(Data!B:B,MATCH(1,(Home!H10=Data!C:C)*(Home!I10=Data!D:D)*(K10=Data!F:F),0)))\"\n    .Range(\"L10\").AutoFill ActiveSheet.Range(\"L10:L\" &amp; lastrow)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong></p>\n\n<p>As stated in the comments, all the full column references to the data set on Data need to also be changed to reference only the data.</p>\n\n<p>Array formulas will iterate and calculate the entire reference.  So each Formula will do over 8 million calculations.  Multiply that by how many times the formula is entered and you can see how this will impact the calculation times and might even crash your excel.</p>\n"}], "owner": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1035, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482333586, "creation_date": 1482331318, "question_id": 41265414, "link": "https://stackoverflow.com/questions/41265414/vba-insert-array-formula-from-range-to-end-row", "title": "vba insert array formula from range to end row?", "body": "<p>I am trying to insert an array formula down a column from row 10 onwards:</p>\n\n<pre><code>Sub Check()\nActiveSheet.Range(\"L10\").End(xlUp).Row.FormulaArray = \"=IF(J10&lt;&gt;\"\",INDEX(Data!B:B,MATCH(1,(Home!H10=Data!C:C)*(Home!I10=Data!D:D)*(Home!J10=Data!E:E),0)),INDEX(Data!B:B,MATCH(1,(Home!H10=Data!C:C)*(Home!I10=Data!D:D)*(K10=Data!F:F),0)))\"\nEnd Sub\n</code></pre>\n\n<p>For some reason this doesn't work and i get a object required error.\nI also want each cell refernce to go down with each row. I'm new to vba so apologies if my code is not great, but if someone could please point me in the right direction i'd really appreciate it?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 0, "creation_date": 1482331575, "post_id": 41265327, "comment_id": 69731652, "body": "Use the <code>ResolveAll</code> method to resolve the recipients of your <code>MailItem</code>. Exlained in MSDN <a href=\"https://msdn.microsoft.com/en-us/library/office/ff867165.aspx\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "reply_to_user": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 0, "creation_date": 1482335104, "post_id": 41265327, "comment_id": 69734090, "body": "How do I change the DistListItem into a recipient object?"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "edited": false, "score": 0, "creation_date": 1482335226, "post_id": 41266086, "comment_id": 69734180, "body": "The folder was not added to the Outlook Address Book. Is there a way to add it to my local address book?"}, {"owner": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "edited": false, "score": 0, "creation_date": 1482343329, "post_id": 41266086, "comment_id": 69738982, "body": "I have set that for the &quot;Planning Weekly Distribution List&quot; folder and it still does not resolve the name. I have tried with another contact group name rather than &quot;Test&quot; too."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "edited": false, "score": 0, "creation_date": 1482345859, "post_id": 41266086, "comment_id": 69740457, "body": "Can you see that folder as a container in the Address Book (hit Ctrl + Shift + B)?"}, {"owner": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "edited": false, "score": 0, "creation_date": 1483439155, "post_id": 41266086, "comment_id": 70088632, "body": "No it does not appear in there at all. Sorry for the delay."}, {"owner": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "edited": false, "score": 0, "creation_date": 1483439894, "post_id": 41266086, "comment_id": 70089098, "body": "There appears to be a slight delay in it adding it. Its on after 30 seconds waiting. Thanks!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1482335700, "last_edit_date": 1482335700, "creation_date": 1482333419, "answer_id": 41266086, "question_id": 41265327, "link": "https://stackoverflow.com/questions/41265327/resolving-distribution-list-in-outlook-vba/41266086#41266086", "title": "Resolving distribution list in Outlook VBA", "body": "<p>Was \"Planning Weekly Distribution List\" folder added as the Outlook address book (right click on the folder, Properties, Outlook Address Book)? If yes, just set the BCC property to \"test\" - Outlook will resolve the name (assuming it is unambiguous). </p>\n\n<p>If not, you will need to add the DL members as recipients one at a time. </p>\n\n<p>To make sure the folder is used by the Outlook Address Book, set the <code>MAPIFolder.ShowAsOutlookAB</code> property.</p>\n"}], "owner": {"reputation": 139, "user_id": 6022816, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6cb0c4d36616a8c824f1e526b9fa08fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6022816/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1337, "favorite_count": 0, "accepted_answer_id": 41266086, "answer_count": 1, "score": 0, "last_activity_date": 1592896966, "creation_date": 1482331078, "last_edit_date": 1592896966, "question_id": 41265327, "link": "https://stackoverflow.com/questions/41265327/resolving-distribution-list-in-outlook-vba", "title": "Resolving distribution list in Outlook VBA", "body": "<p>I am trying to create an email using VBA which pulls its recipients from a Public Folder with Distribution list. </p>\n\n<p>I have the below code which works except it does not resolve the list, the recipient remains as a string.</p>\n\n<pre><code>Sub Email()\n\nDim list As Outlook.DistListItem\nDim oAPP                       As Object\nDim oItem                      As Object\nConst olMailItem               As Long = 0\n\nSet list = Application.Session.GetDefaultFolder(olPublicFoldersAllPublicFolders).Folders.Item(\"Planning Weekly Distribution List\").Items.Item(\"Test\")\n\nSet oAPP = CreateObject(\"Outlook.Application\")\nSet oItem = oAPP.CreateItem(olMailItem)\nWith oItem\n     .Display\nEnd With\n\nWith oItem\n    .BCC = list\n    .Subject = \"hey\"\n    .HTMLBody = Body &amp; \"&lt;br&gt;\" &amp; .HTMLBody\n    .Display\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1482331306, "post_id": 41265299, "comment_id": 69731469, "body": "Do you have cells in which some of the text is red and some of the text is black??"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1482332179, "post_id": 41265299, "comment_id": 69732043, "body": "@Gary&#39;sStudent the note in the code states that <code>delet only black text maintening other color text in the same cell</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1482332251, "post_id": 41265299, "comment_id": 69732092, "body": "You will need to iterate through each character in each cell (So two loops) testing each character for the color and create a temp string of only those that are red."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1482331708, "post_id": 41265459, "comment_id": 69731731, "body": "Ok ,,, If Cell.Font.ColorIndex =1 Then ... here is my problem: deleting only the black text...."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1482332688, "post_id": 41265459, "comment_id": 69732394, "body": "<code>If cell.Characters(i, 1).Font.ColorIndex &lt;&gt; 1</code>  Op wants to remove the black text not keep it."}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1482335983, "post_id": 41265459, "comment_id": 69734701, "body": "Very nice routine"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 2, "last_activity_date": 1482339922, "last_edit_date": 1482339922, "creation_date": 1482331459, "answer_id": 41265459, "question_id": 41265299, "link": "https://stackoverflow.com/questions/41265299/removing-only-black-text-font-on-a-large-cell-range/41265459#41265459", "title": "Removing only black text font on a large cell range", "body": "<p>You can pick out character colours and test them individually:</p>\n\n<pre><code>Sub deleteonlyblacktextincell()\n\n    Range(\"A1:B20347\").Select\n\n    For Each cell In Selection\n        Dim textOut As String\n        textOut = \"\"\n        For i = 1 To Len(cell)\n            If cell.Characters(i, 1).Font.ColorIndex &lt;&gt; 1 Then\n                textOut = textOut &amp; Mid(cell, i, 1)\n            End If\n        Next\n        cell.Value = textOut\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1482332154, "post_id": 41265510, "comment_id": 69732026, "body": "Almost there! The only problem are cells containing red and black text. In those cases both colors are maintained"}, {"owner": {"reputation": 21, "user_id": 7326158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c94078953518985b82147711d06af7dc?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7326158/patrick"}, "reply_to_user": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1482332256, "post_id": 41265510, "comment_id": 69732095, "body": "I guess in this case your question is unclear. Do you just want to delete the black characters or the whole text in a Cell?"}, {"owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "edited": false, "score": 0, "creation_date": 1482335213, "post_id": 41265510, "comment_id": 69734170, "body": "Thanks for your help... I want to keep only red text"}], "tags": [], "owner": {"reputation": 21, "user_id": 7326158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c94078953518985b82147711d06af7dc?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7326158/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1482331630, "creation_date": 1482331630, "answer_id": 41265510, "question_id": 41265299, "link": "https://stackoverflow.com/questions/41265299/removing-only-black-text-font-on-a-large-cell-range/41265510#41265510", "title": "Removing only black text font on a large cell range", "body": "<p>try this:</p>\n\n<pre><code>Sub deleteonlyblacktextincell()\nDim rng As Range\nSet rng = Selection\n\nFor Each Cell In rng\n    If Cell.Font.ColorIndex = 1 Then\n\n    'this only removes the text and doesn't delete the Cell itself\n    Cell.Value = \"\"\n\n    End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7326222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e0291329d935021b67f64235abb9ad?s=128&d=identicon&r=PG", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/7326222/emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 41265459, "answer_count": 2, "score": 1, "last_activity_date": 1482339922, "creation_date": 1482331010, "last_edit_date": 1531164843, "question_id": 41265299, "link": "https://stackoverflow.com/questions/41265299/removing-only-black-text-font-on-a-large-cell-range", "title": "Removing only black text font on a large cell range", "body": "<p>This is what I need: \nI have more than 20.000 cells containing in the same cell text in black and red\nI want to delete all black text (maintaining red) contained in cells rage A1:A20347. But my routine won\u2019t work. A little help will be appreciated </p>\n\n<pre><code>Sub deleteonlyblacktextincell()\n\nRange(\"A1:A20347\").Select    \n        For Each Cell In Selection\n        If Font.ColorIndex = 1 Then\n\n        ' it is here where a want to delet only black text maintening other color text in the same cell\n\n        End If\n        Next \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1482336372, "post_id": 41265191, "comment_id": 69735001, "body": "Welcome to S.O! Have you tried anything? If so, please, provide the code, take a look to the <a href=\"http://stackoverflow.com/tour\">tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>. Friendly reminder: StackOverflow is not a &quot;we code for you&quot; service provider. <a href=\"https://blog.udemy.com/excel-macros-tutorial/\" rel=\"nofollow noreferrer\">Introduction to VBA</a>"}, {"owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482394408, "post_id": 41265191, "comment_id": 69758467, "body": "hello sgdva. please read again the question, i&#39;m sure you&#39;ll get the sense. if not, please notice that i don&#39;t ask for code. i just ask if it&#39;s possible. can you &#39;code for me&#39; with &#39;&lt;yes it is possible/&gt;&#39; or &#39;&lt;no, i think that&#39;s impossible/&gt;?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482419361, "post_id": 41265191, "comment_id": 69774140, "body": "&lt;no, i think that&#39;s impossible/&gt; It&#39;s not possible to pass a default value to filter objects -as you are trying to do it in the image- other than with the work around send keys method."}], "owner": {"reputation": 138, "user_id": 2284877, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/041b5353112512851f3a4897b1b2ce26?s=128&d=identicon&r=PG", "display_name": "user2284877", "link": "https://stackoverflow.com/users/2284877/user2284877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482411084, "creation_date": 1482330689, "last_edit_date": 1531164843, "question_id": 41265191, "link": "https://stackoverflow.com/questions/41265191/get-default-value-in-excel-autofilter-searchbox", "title": "Get default value in excel autofilter searchbox", "body": "<p>It is possible to pass a variable to excel autofilter searchbox ? (Except sendkeys method)    </p>\n\n<pre><code>Sub slixx()\nDim x\nx = \"bubi\"\nRange(\"b10\").Select\nSendKeys \"%{down}\"\nSendKeys \"%{down}e\"\nSendKeys x\nEnd Sub\n</code></pre>\n\n<p>Thank you.\n<a href=\"https://i.stack.imgur.com/nzP6k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nzP6k.png\" alt=\"img here\"></a></p>\n"}, {"tags": ["excel", "vba", "passwords", "editing", "protection"], "comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1482332077, "post_id": 41264884, "comment_id": 69731979, "body": "lock for viewing, as @Jeremy suggests, then supply the code in a separate file"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482337256, "post_id": 41264884, "comment_id": 69735582, "body": "Why do you need to lock the <i>code</i> from edits?  Can&#39;t you just make the <i>Excel file</i> read-only?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1482348313, "post_id": 41264884, "comment_id": 69741828, "body": "I&#39;m very surprised this isn&#39;t a duplicate question... somewhere..."}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482330970, "post_id": 41265108, "comment_id": 69731237, "body": "Apologies - Misunderstood what was being looked for"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": -2, "last_activity_date": 1482330468, "creation_date": 1482330468, "answer_id": 41265108, "question_id": 41264884, "link": "https://stackoverflow.com/questions/41264884/vba-excel-password-to-lock-macro-from-editing-but-still-allow-users-to-see-the-c/41265108#41265108", "title": "VBA Excel password to lock macro from editing but still allow users to see the code", "body": "<p>There is, first:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ex8dd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ex8dd.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then you'll see this (tick/untick the box as needed):</p>\n\n<p><a href=\"https://i.stack.imgur.com/BnYzw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BnYzw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1482330871, "last_edit_date": 1482330871, "creation_date": 1482330512, "answer_id": 41265125, "question_id": 41264884, "link": "https://stackoverflow.com/questions/41264884/vba-excel-password-to-lock-macro-from-editing-but-still-allow-users-to-see-the-c/41265125#41265125", "title": "VBA Excel password to lock macro from editing but still allow users to see the code", "body": "<p>This is not possible by any conventional means.  Some crazy solution maybe possible by subclassing (synonym for intercepting) the windows message queue and cancelling any keyboard strokes but that is way way too complicated.</p>\n\n<p>Sorry, it is not like VB.NET of C#.Net where perhaps the modules are source controlled and if not checked out read-only.</p>\n\n<p>You could create a second workbook on the fly and copy the modules there so you won;t have to worry about others changing the code.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1482334005, "creation_date": 1482334005, "answer_id": 41266300, "question_id": 41264884, "link": "https://stackoverflow.com/questions/41264884/vba-excel-password-to-lock-macro-from-editing-but-still-allow-users-to-see-the-c/41266300#41266300", "title": "VBA Excel password to lock macro from editing but still allow users to see the code", "body": "<blockquote>\n  <p><em>I would like them to see the code to learn, but at the same time I would like to secure and protect the code from any changes.</em></p>\n</blockquote>\n\n<p>This is an X-Y problem: what you need is not to \"lock modules for edits\", what you need is a way to \"revert\" any changes that might have been done inadvertently by inexperimented viewers.</p>\n\n<p>The only built-in, legit and 100% safe way to do what you want to do is to print out the code and hand out hard copies for study.</p>\n\n<p>The solution you <em>actually need</em> exists, it's called <em>source control</em>.</p>\n\n<p>Without source control, the \"truth\" resides inside the document host; whatever code exists in that document is the <em>single version of the truth</em>, and any changes made to it <em>become</em> the new truth. One way to circumvent that is to use the file system: make versioned copies of the macros you distribute, so that if some user changes something and breaks it, you can always re-send the original version you had given them.</p>\n\n<p>With source control, the \"truth\" resides <em>outside</em> the document host, in a <em>repository</em>. The source control system is responsible for keeping track of all changes, when they're made, and by whom. The \"truth\" becomes a <em>tree</em>, and you can create <em>branches</em> and start implementing a new feature without affecting the \"trunk\" until you <em>merge</em> your changes.</p>\n\n<p>Unfortunately, the VBE isn't very source control friendly: for source control to work well, you need it to track each individual source code file/module separately - and VBA code is, by definition, <em>embedded</em> in a host document, which can itself contain things that refer to VBA code (e.g. a <em>shape</em>/button that's assigned to a <em>macro</em>), and the VBA code can refer to things in the host document (e.g. code that refers to a specific <code>Worksheet</code> object), so while there are plenty of more or less simple solutions to export the code from the project into the file system, and import it back... I don't know of any solution that covers every single use case.</p>\n\n<p>I have an open-source VBE add-in project going on (see <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> on GitHub) that includes an IDE-integrated Git source control panel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/N9cMf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N9cMf.png\" alt=\"Rubberduck&#39;s source control panel\"></a></p>\n\n<p>There <em>are</em> <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues?q=is%3Aopen+is%3Aissue+label%3Asource-control-integration\" rel=\"nofollow noreferrer\">a number of issues</a> with it - for example it's completely host-agnostic, so there is no support [yet] for anything that's host-specific (i.e. Rubberduck does not use the host application's object model for this). But the project is open-source, and extremely active, so all bugs will eventually be squashed :)</p>\n\n<p>Notice the <em>included changes</em> section in the above screenshot:</p>\n\n<p><img src=\"https://i.stack.imgur.com/cv8Ky.png\" alt=\"&quot;Undo changes&quot; button\"></p>\n\n<p>The \"undo\" source control command literally reverts any changes made to a file since it was pulled from the repository: with source control you no longer have to worry about local changes breaking your <em>single version of the truth</em>. And even if \"bad\" changes get committed to the repository, you can always revert them, and \"go back\" to any previous commit.</p>\n\n<p>You can control who can and cannot push changes to the repository too, so you don't have to worry about one user pushing \"bad\" changes and breaking your project. And their local changes can be reverted quite easily.</p>\n\n<p>Now, whether introducing inexperimented <em>would-be-coders</em> to source control concepts is a good idea, is another debate... but IMO it can't hurt to be exposed to things like source control and <em>unit testing</em> from the start - <em>especially</em> if VBA is to be an entryway into the bigger, wider and wilder world of programming.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1482340106, "creation_date": 1482340106, "answer_id": 41268228, "question_id": 41264884, "link": "https://stackoverflow.com/questions/41264884/vba-excel-password-to-lock-macro-from-editing-but-still-allow-users-to-see-the-c/41268228#41268228", "title": "VBA Excel password to lock macro from editing but still allow users to see the code", "body": "<p>As the other answerers have pointed out, this simply isn't possible without taking some extraordinary action like installing a plugin that monitors all keystrokes, or some other heavy handed solution.  If all you want to do is allow users to view the code, show them the code.  You don't have to do it with the VBE at all:</p>\n\n<pre><code>Public Sub DisplayWorkbookCode(wb As Workbook)\n    Dim i As Long\n    With wb.VBProject.VBComponents\n        For i = 1 To .Count\n            With .Item(i).CodeModule\n                If .CountOfLines &gt; 0 Then\n                    MsgBox .Lines(1, .CountOfLines), , .Name\n                End If\n            End With\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Sample Usage:</p>\n\n<pre><code>DisplayWorkbookCode ThisWorkbook\n</code></pre>\n\n<p>Note that the sample above just uses a message box to display the code for each module - if there's a ton of code you might want to build a custom UserForm to display it or something like that.</p>\n"}], "owner": {"reputation": 1, "user_id": 7326079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac61fd72caf43b9db9d87b4d3a0d9ba2?s=128&d=identicon&r=PG&f=1", "display_name": "Vbashark", "link": "https://stackoverflow.com/users/7326079/vbashark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1394, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1482340106, "creation_date": 1482329806, "question_id": 41264884, "link": "https://stackoverflow.com/questions/41264884/vba-excel-password-to-lock-macro-from-editing-but-still-allow-users-to-see-the-c", "title": "VBA Excel password to lock macro from editing but still allow users to see the code", "body": "<p>I cannot find any information if it is possible to allow users to see the macro code, but at the same time, make them unable to change the VBA code. I need to lock it for editing only. \nI have an excel file which is used by many users. I would like them to see the code to learn, but at the same time I would like to secure and protect the code from any changes.\nIs that possible?</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328356, "post_id": 41264350, "comment_id": 69729426, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14613609/how-to-delete-row-based-on-cell-value\">How to delete row based on cell value</a>"}, {"owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "reply_to_user": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328443, "post_id": 41264350, "comment_id": 69729500, "body": "Yep, it is possible to be a duplicate. But in my case there are 2 columns which can be in the condition of delete the row"}, {"owner": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328528, "post_id": 41264350, "comment_id": 69729569, "body": "In your case, it should be a matter of just adding to the code to take into consideration both column C and D, instead of just one column (is that what you are saying in your comment?)"}, {"owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "reply_to_user": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328564, "post_id": 41264350, "comment_id": 69729598, "body": "A quick example for me then? for let say 4 columns in the condition?"}, {"owner": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328704, "post_id": 41264350, "comment_id": 69729676, "body": "If I had to guess (I don&#39;t know VBA), you would add to the <code>Do While</code> in the answer to include both of your columns.  Perhaps something like: <code>ThisWorkbook.ActiveSheet.Range(&quot;C1&quot;).CurrentRegion.Rows.Coun&zwnj;&#8203;t &amp;&amp; ThisWorkbook.ActiveSheet.Range(&quot;D1&quot;).CurrentRegion.Rows.Coun&zwnj;&#8203;t</code>"}, {"owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "reply_to_user": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328744, "post_id": 41264350, "comment_id": 69729695, "body": "So, you don&#39;t know VBA"}, {"owner": {"reputation": 1073, "user_id": 6530134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nY41u.png?s=128&g=1", "display_name": "Timothy G.", "link": "https://stackoverflow.com/users/6530134/timothy-g"}, "edited": false, "score": 0, "creation_date": 1482328932, "post_id": 41264350, "comment_id": 69729839, "body": "No, not really. I&#39;ve worked with it once using ASP.NET, but that&#39;s not the point.  The point is, the <i>possible</i> duplicate may be able to help you.  If it doesn&#39;t, then fine, if it does, then this question is essentially a duplicate of that question.  That&#39;s why its a <i>possible</i> duplicate."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1482330772, "post_id": 41264350, "comment_id": 69731088, "body": "Is it just me or is there an elephant in the room singing &quot;I want someone to do my code for me&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "edited": false, "score": 0, "creation_date": 1482328859, "post_id": 41264382, "comment_id": 69729790, "body": "In your link, it doesn&#39;t give an example for considering 2 or 3 or 10 columns having their values to be compared to 0"}], "tags": [], "owner": {"reputation": 271, "user_id": 7256964, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e70b0eaf720c005e63c55f824ebd9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Kapa11", "link": "https://stackoverflow.com/users/7256964/kapa11"}, "is_accepted": false, "score": 0, "last_activity_date": 1482328333, "creation_date": 1482328333, "answer_id": 41264382, "question_id": 41264350, "link": "https://stackoverflow.com/questions/41264350/delete-rows-with-2-columns-containing-specific-data/41264382#41264382", "title": "delete rows with 2 columns containing specific data", "body": "<p>Short Googling gave me multiple approaches:</p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/815-excel-remove-rows-based-on-cell-value.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/815-excel-remove-rows-based-on-cell-value.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 4554380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/315b74a086b3f1bb222dc68f6de9d894?s=128&d=identicon&r=PG&f=1", "display_name": "Charlton", "link": "https://stackoverflow.com/users/4554380/charlton"}, "is_accepted": false, "score": 0, "last_activity_date": 1482328826, "creation_date": 1482328826, "answer_id": 41264551, "question_id": 41264350, "link": "https://stackoverflow.com/questions/41264350/delete-rows-with-2-columns-containing-specific-data/41264551#41264551", "title": "delete rows with 2 columns containing specific data", "body": "<p>Apply filter to cols C and D where value is 0, and delete the displayed rows. </p>\n"}, {"comments": [{"owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "edited": false, "score": 0, "creation_date": 1482329494, "post_id": 41264682, "comment_id": 69730206, "body": "Thanks for your response. &quot;Object reference not found&quot;"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1482329224, "creation_date": 1482329224, "answer_id": 41264682, "question_id": 41264350, "link": "https://stackoverflow.com/questions/41264350/delete-rows-with-2-columns-containing-specific-data/41264682#41264682", "title": "delete rows with 2 columns containing specific data", "body": "<p>Consider:</p>\n\n<pre><code>Sub RowKiller213()\n    Dim i As Long, N As Long\n\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = N To 1 Step -1\n        If Cells(i, \"C\").Value = 0 And Cells(i, \"D\").Value = 0 Then\n            Cells(i, \"C\").EntireRow.Delete\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong><em>Note:</em></strong></p>\n\n<ul>\n<li>the loop runs bottom-up</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "edited": false, "score": 0, "creation_date": 1482330272, "post_id": 41264978, "comment_id": 69730737, "body": "With - not allowed outside as a procedure."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "edited": false, "score": 0, "creation_date": 1482330485, "post_id": 41264978, "comment_id": 69730883, "body": "you have to wrap that code in a <code>Sub WhateverName()</code> <code>End Sub</code> block! See edited code"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "edited": false, "score": 0, "creation_date": 1482333229, "post_id": 41264978, "comment_id": 69732787, "body": "@FlorinM., did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1482330483, "last_edit_date": 1482330483, "creation_date": 1482330076, "answer_id": 41264978, "question_id": 41264350, "link": "https://stackoverflow.com/questions/41264350/delete-rows-with-2-columns-containing-specific-data/41264978#41264978", "title": "delete rows with 2 columns containing specific data", "body": "<p>be sure you have first row as header one and then use this:</p>\n\n<pre><code>Sub Main()\n    With Worksheets(\"mySheetName\")\n        With .Range(\"D1\", .Cells(.Rows.Count, 1).End(xlUp))\n            .AutoFilter field:=3, Criteria1:=0\n            .AutoFilter field:=4, Criteria1:=0\n            If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2119, "user_id": 1326910, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/EBygr.jpg?s=128&g=1", "display_name": "Florin M.", "link": "https://stackoverflow.com/users/1326910/florin-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 41264978, "answer_count": 4, "score": 0, "last_activity_date": 1482330483, "creation_date": 1482328187, "last_edit_date": 1482328966, "question_id": 41264350, "link": "https://stackoverflow.com/questions/41264350/delete-rows-with-2-columns-containing-specific-data", "title": "delete rows with 2 columns containing specific data", "body": "<p>I have an excel file containing one sheet which this data:</p>\n\n<pre><code>      A    |     B      |     C    |       D\n________________________________________________\n    321        2016/12/01    0           0\n    123        2016/12/03    23          0\n    1321       2016/12/05    12          1\n    2315       2015/12/03    0           0\n    23154      2015/12/03    0           0\n</code></pre>\n\n<p>I do want to delete all rows if the value from C <code>AND</code> D is 0. How can I achieve this?</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 7325870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ada1e7c7ac296242782ce840f09292?s=128&d=identicon&r=PG&f=1", "display_name": "JJ Okocha", "link": "https://stackoverflow.com/users/7325870/jj-okocha"}, "edited": false, "score": 0, "creation_date": 1482410464, "post_id": 41263872, "comment_id": 69768385, "body": "Olease let me know if more information is needed to help me solve this problem."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7325870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ada1e7c7ac296242782ce840f09292?s=128&d=identicon&r=PG&f=1", "display_name": "JJ Okocha", "link": "https://stackoverflow.com/users/7325870/jj-okocha"}, "is_accepted": false, "score": 0, "last_activity_date": 1482410750, "creation_date": 1482410750, "answer_id": 41283509, "question_id": 41263872, "link": "https://stackoverflow.com/questions/41263872/use-vba-to-trigger-html-anchor-href-javascriptvoid0/41283509#41283509", "title": "Use vba to trigger html anchor href=&quot;javascript:void(0)&quot;", "body": "<p>I already managed to change the time shown on the website element by using</p>\n\n<pre><code>Set myData10 = IE.document.getElementsByTagName(\"span\")\nFor Each inputElement In myData10\n    If inputElement.ID = \"select2-chosen-3\" Then\n        Set timepicker = inputElement\n        timepicker.Focus\n        timepicker.innerText = \"02:00 - 03:00\"\n     End If\nNext\n</code></pre>\n\n<p>but it seems like the new time is still not processed by the website. The data on the website did not change to the new time.</p>\n"}], "owner": {"reputation": 1, "user_id": 7325870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ada1e7c7ac296242782ce840f09292?s=128&d=identicon&r=PG&f=1", "display_name": "JJ Okocha", "link": "https://stackoverflow.com/users/7325870/jj-okocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1524119048, "creation_date": 1482326771, "last_edit_date": 1531164843, "question_id": 41263872, "link": "https://stackoverflow.com/questions/41263872/use-vba-to-trigger-html-anchor-href-javascriptvoid0", "title": "Use vba to trigger html anchor href=&quot;javascript:void(0)&quot;", "body": "<p>This is my first post ever, so I hope not to bore you.</p>\n\n<p>I am trying to use excel vba to access this <a href=\"https://www.eex-transparency.com/homepage/power/germany/production/usage/actual-unitwise-production-100-mw-\" rel=\"nofollow noreferrer\">website</a> to get its data. I can get the data and I can change the dates, my problem is to change the times (e.g. 00:00 - 01:00 to 01:00 - 02:00). I guess this is due to the </p>\n\n<pre><code>&lt;a href=\"javascript:void(0)\" class=\"select2-choice\" tabindex=\"-1\"&gt;\n</code></pre>\n\n<p>behind the element. \nI just don't understand how to pass on the new time-span and how to trigger it to change the data. I already tried \"FireEvents (\"onclick\")\" on the anchor element without success. </p>\n\n<p>I hope anybody can help me. Thank you!!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 4, "creation_date": 1482327473, "post_id": 41263672, "comment_id": 69728835, "body": "<i>Empty</i> is very different from &quot;&quot;."}, {"owner": {"reputation": 52, "user_id": 7320109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093cab90150f60c135c78a5ffa05aecc?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ess", "link": "https://stackoverflow.com/users/7320109/dee-ess"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1482401142, "post_id": 41263672, "comment_id": 69762604, "body": "Correct. my mistake. (Although i see this is a common misconception since i noticed now that @Erik von Asmuth answered this as well &quot; &quot;&quot; is an empty string.&quot;  (Although i do like his idea of using <code>If nz([variable], &quot;&quot;) = &quot;&quot; Then</code>) [i am pretty new here - am i supposed to edit what i wrote?]"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1482405171, "post_id": 41263672, "comment_id": 69765165, "body": "Yes, the Nz method seems unbeatable. If you can edit your answer, by all means just go ahead. Merry Christmas."}], "tags": [], "owner": {"reputation": 52, "user_id": 7320109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093cab90150f60c135c78a5ffa05aecc?s=128&d=identicon&r=PG&f=1", "display_name": "Dee Ess", "link": "https://stackoverflow.com/users/7320109/dee-ess"}, "is_accepted": false, "score": -1, "last_activity_date": 1482407401, "last_edit_date": 1482407401, "creation_date": 1482326173, "answer_id": 41263672, "question_id": 41263642, "link": "https://stackoverflow.com/questions/41263642/is-there-a-difference-between-isnullx-and-x/41263672#41263672", "title": "Is there a difference between IsNull(x) and x = &quot;&quot;?", "body": "<p><code>isnull</code> means the value is not known while <strong>edit:</strong> <code>\"\"</code> means it is zero-length string*</p>\n\n<hr>\n\n<p><sub>*Credit: @Macro Man.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482327259, "post_id": 41263679, "comment_id": 69728694, "body": "It might be more accurate to say null is the absence of value to avoid confusing it with <code>Nothing</code>. <code>IsNull(Nothing)</code> evaluates to false because <code>Nothing</code> is an object reference."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1482327390, "post_id": 41263679, "comment_id": 69728779, "body": "And you forgot <i>Empty</i>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1482327400, "post_id": 41263679, "comment_id": 69728783, "body": "I would say it&#39;s more like an empty nullable variable, than nothing, as this would confuse matters <code>Dim o As Object: Set o = New Excel.Application: Set o = Nothing: Debug.Print IsNull(o)</code>  this returns false"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1482327500, "post_id": 41263679, "comment_id": 69728854, "body": "@Gustav - <code>Empty</code> is technically a <code>Variant</code> of type <code>VT_EMPTY</code> - <code>IsNull(Empty)</code> also evaluates to false."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1482327514, "post_id": 41263679, "comment_id": 69728863, "body": "@Gustav I&#39;ve not forgotten it - there is no mention of <code>IsEmpty()</code> in the OP&#39;s code"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1482328381, "post_id": 41263679, "comment_id": 69729442, "body": "True, but if x can be <i>Null</i> it must be declared as a <i>Variant</i> and, if not having been assigned a value, <code>IsNull(x)</code> will return False while <code>x = &quot;&quot;</code> returns True. Thus, you have to use both checks - or use <code>Nz(x) = &quot;&quot;</code> which behaves as expected in all cases."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 5, "last_activity_date": 1482327394, "last_edit_date": 1495541784, "creation_date": 1482326186, "answer_id": 41263679, "question_id": 41263642, "link": "https://stackoverflow.com/questions/41263642/is-there-a-difference-between-isnullx-and-x/41263679#41263679", "title": "Is there a difference between IsNull(x) and x = &quot;&quot;?", "body": "<p><code>NULL</code> is the absence of a value*</p>\n\n<p><code>\"\"</code> is a zero-length string</p>\n\n<p>Due to implicit conversion - an object that hasn't been populated yet <em>might</em> return true for both cases. However if you were to place a value of <code>\"\"</code> in there, it would return False for <code>isnull()</code> and True for <code>= \"\"</code></p>\n\n<p><em><sup>*Credit to <a href=\"https://stackoverflow.com/users/4088852/comintern\">Comintern</a> for improving the explanation (see comments)</sup></em></p>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1482326496, "creation_date": 1482326496, "answer_id": 41263773, "question_id": 41263642, "link": "https://stackoverflow.com/questions/41263642/is-there-a-difference-between-isnullx-and-x/41263773#41263773", "title": "Is there a difference between IsNull(x) and x = &quot;&quot;?", "body": "<p>As said by the other answers, null is nothing, \"\" is an empty string.</p>\n\n<p>To test for both null and empty variables in access VBA, use the following:</p>\n\n<pre><code>If nz([variable], \"\") = \"\" Then do stuff\n</code></pre>\n\n<p>The nz function converts null variables to \"\" or 0</p>\n"}, {"comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1482327383, "post_id": 41264065, "comment_id": 69728774, "body": "you could add results as a comments right to <code>debug.print</code> lines to improve readability..."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 3, "last_activity_date": 1482327723, "last_edit_date": 1482327723, "creation_date": 1482327322, "answer_id": 41264065, "question_id": 41263642, "link": "https://stackoverflow.com/questions/41263642/is-there-a-difference-between-isnullx-and-x/41264065#41264065", "title": "Is there a difference between IsNull(x) and x = &quot;&quot;?", "body": "<p>If you do that check, to makes sense x must be a <em>Variant</em>, and Null is not \"Nothing\". Nothing means Empty and a special check for that exists.</p>\n\n<p>Run this and see:</p>\n\n<pre><code>Dim x   As Variant\n\nDebug.Print IsEmpty(x)  ' True\nDebug.Print IsNull(x)   ' False\nDebug.Print x = \"\"      ' True\nDebug.Print Nz(x) = \"\"  ' True\n\nx = Null\nDebug.Print IsEmpty(x)  ' False\nDebug.Print IsNull(x)   ' True\nDebug.Print x = \"\"      ' Null\nDebug.Print Nz(x) = \"\"  ' True\n\nx = \"\"\nDebug.Print IsEmpty(x)  ' False\nDebug.Print IsNull(x)   ' False\nDebug.Print x = \"\"      ' True\nDebug.Print Nz(x) = \"\"  ' True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": false, "score": 0, "last_activity_date": 1482869525, "creation_date": 1482869525, "answer_id": 41351619, "question_id": 41263642, "link": "https://stackoverflow.com/questions/41263642/is-there-a-difference-between-isnullx-and-x/41351619#41351619", "title": "Is there a difference between IsNull(x) and x = &quot;&quot;?", "body": "<p>when I want to check for a null/ empty string\nI use </p>\n\n<pre><code>If x &amp; \"\" &lt;&gt; \"\" then\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7320204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ad560c2719774bf1065a2f9360f4ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7320204/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 41263679, "answer_count": 5, "score": 0, "last_activity_date": 1594651243, "creation_date": 1482326069, "last_edit_date": 1594651243, "question_id": 41263642, "link": "https://stackoverflow.com/questions/41263642/is-there-a-difference-between-isnullx-and-x", "title": "Is there a difference between IsNull(x) and x = &quot;&quot;?", "body": "<p>In if statements I always have to use <code>if isnull(x) or x = \"\" then</code></p>\n\n<p>What is the difference between the two and why doesn't each of them work in some cases?</p>\n"}, {"tags": ["xml", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482325207, "post_id": 41263225, "comment_id": 69727309, "body": "yeah I already ask about it, still didn&#39;t found any answer for that, I&#39;m blowing my mind how to merge two different codes. the first mission i have is to display names of cat with ID 17 (Tigger,angel, peaunut) and i know how to do it with xDoc , and in other place of code i also want to print name of cat with Id=&quot;173&quot; and this i also doing with oDoc, i&#39;m desperately tryng to marge them, i don&#39;t want to load the doc twice, all the answer and i still not get it what should i do"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 1, "creation_date": 1482325278, "post_id": 41263225, "comment_id": 69727365, "body": "I don&#39;t understand why you have two documents.  Please edit question to show what Tools References you have active.  And as yesterday, I suggest you stick to the latest library Microsoft Xml 6.0.  Also edit your code to fully qualify your <code>Dim</code> statements so <code>Dim foo as MSXML2.DomDoucment60</code>"}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482325339, "post_id": 41263225, "comment_id": 69727418, "body": "about your answer how you Do the singular?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482325465, "post_id": 41263225, "comment_id": 69727496, "body": "@David: let me tell you that SelectSingleNode calls SelectNodes and then calls .item(0) to get the first item."}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482325641, "post_id": 41263225, "comment_id": 69727608, "body": "Thanks god! this is finally solve my problem, I wrote your solution and add  .text , that was what i ask for..."}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482325904, "post_id": 41263225, "comment_id": 69727777, "body": "Debug.Print list.Item(0).Attributes(1).Text"}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482325942, "post_id": 41263225, "comment_id": 69727807, "body": "when you use it you don&#39;t need the loop , and i think that will be an answer to my question , thanks for helping"}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482326088, "post_id": 41263225, "comment_id": 69727894, "body": "if i want to print it but i don&#39;t know the number of attribute, you know if i can search attribute by name and not by number ? something like that?  Debug.Print list.Item(0).Attributes(&quot;Name&quot;).Text"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 1, "creation_date": 1482326268, "post_id": 41263225, "comment_id": 69728018, "body": "Debug.Print list.Item(0).Attributes.getNamedItem(&quot;Name&quot;).Text"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 3, "last_activity_date": 1482326720, "last_edit_date": 1495540418, "creation_date": 1482324682, "answer_id": 41263225, "question_id": 41263153, "link": "https://stackoverflow.com/questions/41263153/get-attributes-name-item-of-the-first-node-from-list-of-nodes/41263225#41263225", "title": "get Attributes name item of the first node from list of nodes", "body": "<p>I don't know why you opened a new question, this is revisiting yesterday's <a href=\"https://stackoverflow.com/questions/41242293/read-xml-child-node-attribute-on-vba-with-odoc\">Read XML child node Attribute on VBA with oDOC</a></p>\n\n<p>Anyway, if you really have a problem with the loop running one item (frankly, I don't know why) then you can inspect the <code>length</code> of the <code>list</code> object.</p>\n\n<pre><code>If list.length=1 Then\n    List.item(0).Attributes.getNamedItem(\"Name\").Text\nElse\n    'Do the loop\nEnd If\n</code></pre>\n\n<p>Can't you just add a comment saying you expect the for loop to run over one single item?</p>\n\n<p>Rewriting your code </p>\n\n<pre><code>Sub Tst()\n\n\n    Dim xDoc As MSXML2.DOMDocument60\n    Set xDoc = New MSXML2.DOMDocument60\n    xDoc.Load ThisWorkbook.Path &amp; \"\\example2.xml\" '&lt;---- my path is different\n\n    Dim oSingular As MSXML2.IXMLDOMNode\n    Set oSingular = xDoc.SelectSingleNode(\"/animal/cat[(@ID)=\"\"17\"\"]\")\n\n    Debug.Print oSingular.Attributes.getNamedItem(\"Name\").Text\n\n'    Set List = xDoc.SelectNodes(\"/animal/cat[(@ID)=\"\"17\"\"]\")\n'    Dim attr As IXMLDOMAttribute\n'    Dim node As IXMLDOMNode\n'    Dim childNode As IXMLDOMNode\n'\n'    For Each node In List\n'        Debug.Print node.Attributes.getNamedItem(\"Name\").Text\n'    Next node\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 41263225, "answer_count": 1, "score": 0, "last_activity_date": 1482326720, "creation_date": 1482324369, "question_id": 41263153, "link": "https://stackoverflow.com/questions/41263153/get-attributes-name-item-of-the-first-node-from-list-of-nodes", "title": "get Attributes name item of the first node from list of nodes", "body": "<p>the following code will print  this:\n\"GAL\"</p>\n\n<p>is there any option to print the same output using  \"xDoc.SelectNodes\"\nbut without the 'for each node in list'?\nbecause i know that the parent will be only one node, so seems to me silly that I have to use this- 'for' and also define new variable ('node')<br>\n thanks for any help !</p>\n\n<p>VBA:</p>\n\n<pre><code>    Dim xDoc As DOMDocument\n    Set xDoc = New DOMDocument\n    xDoc.Load (\"C:\\....\\example2.xml\")\n    Set list = xDoc.SelectNodes(\"/animal/cat[(@ID)=\"\"17\"\"]\")\n    Dim attr As IXMLDOMAttribute\n    Dim node As IXMLDOMNode\n    Dim childNode As IXMLDOMNode\n\n   For Each node In list\n        Debug.Print node.Attributes.getNamedItem(\"Name\").Text\n    Next node\n</code></pre>\n\n<p>XML:</p>\n\n<pre><code>&lt;animal&gt;\n           &lt;dog ID=\"16\" Name=\"Lucy\"/&gt;\n           &lt;cat ID=\"156\" Name=\"Chloe\"/&gt;\n           &lt;cat ID=\"17\" Name=\"GAL\"&gt;\n                 &lt;child ID=\"173\" Name=\"Tigger\"/&gt;\n                 &lt;child ID=\"1256\" Name=\"Angel\"/&gt;\n                 &lt;child ID=\"256\" Name=\"Peanut\"/&gt;\n           &lt;/cat&gt;\n           &lt;cat ID=\"18\" Name=\"Charlie\"&gt;\n                 &lt;child ID=\"173\" Name=\"Smokey\"/&gt;\n           &lt;/cat&gt;\n  &lt;/animal&gt;\n</code></pre>\n"}, {"tags": ["excel", "file-management", "vba"], "comments": [{"owner": {"reputation": 2248, "user_id": 6499439, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b69ace4bd7428cbae7eb904d7a497351?s=128&d=identicon&r=PG", "display_name": "Katie", "link": "https://stackoverflow.com/users/6499439/katie"}, "edited": false, "score": 0, "creation_date": 1482324412, "post_id": 41263017, "comment_id": 69726803, "body": "Welcome to Stack Overflow!  You can take the <a href=\"https://stackoverflow.com/tour\">tour</a> first and learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> a good question and create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  That makes it easier for us to help you."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 7072020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/789dd1a5101057b052e9200fe112e433?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnarok", "link": "https://stackoverflow.com/users/7072020/ragnarok"}, "is_accepted": false, "score": 0, "last_activity_date": 1482382125, "creation_date": 1482382125, "answer_id": 41275961, "question_id": 41263017, "link": "https://stackoverflow.com/questions/41263017/managing-files-using-visual-basic-for-application/41275961#41275961", "title": "Managing files using Visual Basic for application", "body": "<p>I'm not sure what your asking, but if you want to move a file, it's very simple and easy and you could have found this on the internet.</p>\n\n<p>Look into this website for more information: <a href=\"https://msdn.microsoft.com/en-us/library/2t00swhw.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/2t00swhw.aspx</a></p>\n\n<p>How I would move a file(according to msdn)</p>\n\n<blockquote>\n  <p>My.Computer.FileSystem.MoveFile(\"C:\\Folder1\\arg1.txt\",\n  \"C:\\Folder1\\arg2.txt\")</p>\n</blockquote>\n\n<p>The first argument would be the directory you have the file in, the second, is the one you want move it to.</p>\n"}], "owner": {"reputation": 1, "user_id": 7080282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e705d5f4908a4edca9da41a3d5e558de?s=128&d=identicon&r=PG&f=1", "display_name": "user7080282", "link": "https://stackoverflow.com/users/7080282/user7080282"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482382125, "creation_date": 1482323941, "last_edit_date": 1531164843, "question_id": 41263017, "link": "https://stackoverflow.com/questions/41263017/managing-files-using-visual-basic-for-application", "title": "Managing files using Visual Basic for application", "body": "<p>I have some files hyperlinked in Excel. Can I have a VBA code to manage these files using their hyperlinked address? For example, moving a file from one folder to another both hyperlinked.\nAny thoughts?</p>\n"}, {"tags": ["vba", "bloomberg"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1482329799, "post_id": 41262939, "comment_id": 69730407, "body": "Define struggle so we can help you out, are you getting an error message from the code or unexpected results as is?  Can you point to the line of code giving you trouble?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1482331325, "post_id": 41262939, "comment_id": 69731480, "body": "Please publish some documentation re Bloomberg.  The chances that the SO community has this is very very slim."}, {"owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "reply_to_user": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1482341912, "post_id": 41262939, "comment_id": 69738214, "body": "@JimmySmith: It is the BLP_DATA_CTRLLib.BlpData which causes the problem. If I run it on Excel 2016 the worksheet simply crashes."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 1, "creation_date": 1482348146, "post_id": 41269581, "comment_id": 69741722, "body": "Thanks for your reply so far. I would need the code in VBA, so C# is not an option, Please, would you have a suggestion for how I could replace the deprecated reference?"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1482356995, "post_id": 41269581, "comment_id": 69746359, "body": "You cannot directly use the C# version, but the wrapper will allow you to.  You just have to install the Assembly (DLL or EXE) and then make the calls via the wrapper they wrote."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1482357397, "post_id": 41269581, "comment_id": 69746551, "body": "I did find a C++ version on there, but that requires registering the DLL also.  A lot of .NET is COM compatible, it&#39;s just having a wrapper that takes into consideration that variable types changed between VBA and VB.NET/C#"}, {"owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1482776065, "post_id": 41269581, "comment_id": 69872174, "body": "I have looked at the post by Mikael Katajam&#228;ki and have amneded the code as follows. However, I get an &#39;Invalid procedure call or argument&#39; for the code line   Set bSecurities = bIteratorData.GetElement(&quot;securityData&quot;)   under the function getServerData_reference() in the BBCOM_wrapper.   Any ideas why?   ReDim securities(1 To UBound(dataa, 1)) For i = 1 To UBound(dataa, 1)   securities(i) = dataa(i, CISI) &amp; &quot;@IEHY ISIN&quot; &#39; IEHY=Iboxx quote   Next i   fields = Array(&quot;PX_BID&quot;)   data = b.GetData(securities, fields)   Get_BBG_Price = data   Set b = Nothing"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1482872359, "post_id": 41269581, "comment_id": 69906031, "body": "Just grasping at straws at moment, but if GetElement is the proper method, then I&#39;m wondering if &quot;securityData&quot; is not an element in your underlying dataset for Bloomberg?"}, {"owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 1, "creation_date": 1483785520, "post_id": 41269581, "comment_id": 70246743, "body": "Finally it works but every tenth security/dataset is empty. Any idea why?"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1484673226, "post_id": 41269581, "comment_id": 70602036, "body": "Sorry missed this update.  Is the 10th your last record or you&#39;re saying every 10 or so times you get nothing back?  We could be off by 1 somewhere, done that often here."}, {"owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1484749271, "post_id": 41269581, "comment_id": 70638124, "body": "Every 10 I get nothing back on my request"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "edited": false, "score": 0, "creation_date": 1484752811, "post_id": 41269581, "comment_id": 70640823, "body": "When this happens, does #11 come back with results?  Is this within a shorter time period when you&#39;re trying, so say you do it 9 times and wait 5 minutes, does #10 still do that?"}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1482345051, "creation_date": 1482345051, "answer_id": 41269581, "question_id": 41262939, "link": "https://stackoverflow.com/questions/41262939/bloomberg-api-reference/41269581#41269581", "title": "Bloomberg API reference", "body": "<p>I was taking a look and it looks like this version of the coding is deprecated.  I would figure you get errors along the line of \"cannot create object\", but it may be hiding that in 2016.</p>\n\n<p>You'd likely want to use the C# version they have here,\n<a href=\"https://www.bloomberglabs.com/api/libraries/\" rel=\"nofollow noreferrer\">https://www.bloomberglabs.com/api/libraries/</a></p>\n\n<p>To put it to use, I would use the code here, <a href=\"http://mikejuniperhill.blogspot.com/2013/06/bloomberg-v3com-api-wrapper-update-for.html\" rel=\"nofollow noreferrer\">http://mikejuniperhill.blogspot.com/2013/06/bloomberg-v3com-api-wrapper-update-for.html</a>  *The code is too lengthy or I'd post it here.</p>\n"}], "owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6366, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1525793458, "creation_date": 1482323643, "last_edit_date": 1483785550, "question_id": 41262939, "link": "https://stackoverflow.com/questions/41262939/bloomberg-api-reference", "title": "Bloomberg API reference", "body": "<p>I have the following code which works fine with Excel 2010 but due to updated API by Bloomberg this code will not work in Excel 2016. The reference BLP_DATA_CTRLLib.BlpData is outdated but I struggle to use the new API reference.</p>\n\n<p>Does anyone know how do update my Bloomberg reference in order to store the quotes?</p>\n\n<pre><code>Function Get_BBG_Price(dataa As Variant, CISI As Long)\n\n    Dim ReqSecurities As Variant, vtResult As Variant, ReqFields As Variant\n    Dim Arraystr As String\n    Dim oBlp As BLP_DATA_CTRLLib.BlpData\n\n    ReDim ReqSecurities(1 To UBound(dataa, 1))\n\n    For i = 1 To UBound(dataa, 1)\n\n        ReqSecurities(i) = dataa(i, CISI) &amp; \"@IEHY ISIN\" '  \n\n    Next i\n\n    Set oBlp = New BlpData\n\n   '\n   ReqFields = Array(\"PX_BID\")\n\n   With oBlp\n       .SubscriptionMode = ByRequest\n       .Subscribe ReqSecurities, 1, ReqFields, , , vtResult\n   End With\n\n   Get_BBG_Price = vtResult\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "vlookup"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1482322849, "post_id": 41262522, "comment_id": 69725841, "body": "VBA doesn&#39;t support multiple threads.  Am I right in thinking this is the problem line: <code>Sheets(&quot;Sheet2&quot;).Cells(counter, 13).Value = checker</code>?  It sources its data from Sheet2 column 3.  Does that column contain a formula or a value?"}, {"owner": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1482323590, "post_id": 41262522, "comment_id": 69726304, "body": "Yeah, tbh I was just guessing. No col 3 has the number stored as text. it produces the same result if it has .value or not."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1482326130, "post_id": 41262522, "comment_id": 69727924, "body": "Are any of the values in col C &gt; 32,767 ?"}, {"owner": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "edited": false, "score": 0, "creation_date": 1482326848, "post_id": 41262522, "comment_id": 69728403, "body": "no they are between 1000 -  5000. I am completely stumped by the issue, since it runs correctly when stepped into one line at a time."}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1482328995, "creation_date": 1482328995, "answer_id": 41264615, "question_id": 41262522, "link": "https://stackoverflow.com/questions/41262522/vba-macro-producing-incorrect-results-when-run-but-when-stepping-into-results/41264615#41264615", "title": "vba - Macro producing incorrect results when run, but when stepping into results are correct", "body": "<p>The following works for me with my test data, but you'll need to see if it works for you... (also are you turning off calculation or events? I don't know if this might have an issue?)</p>\n\n<p>I find it preferable to set a reference to the sheet you want to use rather than access it directly, and this may help?</p>\n\n<pre><code>Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet2\")\nDim VLURange As String, checker As Long\n\nFor counter = 2 To 200 ' NumRowsList\n    checker = CLng(ws.Cells(counter, 3).Value)\n    ws.Cells(counter, 13) = checker\n    VLURange = IIf(checker &lt; 4000, \"Sheet4!E2:F126\", \"Sheet5!B2:C200\")\n    ws.Cells(counter, 14) = \"=VLOOKUP(M\" &amp; counter &amp; \", \" &amp; VLURange &amp; \", 2, FALSE)\"\nNext counter\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1482330937, "post_id": 41264849, "comment_id": 69731214, "body": "The range alteration isn&#39;t dependent on the row number but the value in the row, so this approach wouldn&#39;t work."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1482331198, "post_id": 41264849, "comment_id": 69731399, "body": "what do you mean? Have you tested it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1482332187, "post_id": 41264849, "comment_id": 69732053, "body": "with <code>FormulaR1C1</code> notation, <code>RC3</code> means &quot;current row - column 3&quot;, hence written formulas will always reference the row index of the cell they are in"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1482332348, "post_id": 41264849, "comment_id": 69732167, "body": "@Flephal, my last two comments were for you"}, {"owner": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "edited": false, "score": 0, "creation_date": 1482400248, "post_id": 41264849, "comment_id": 69761991, "body": "Cheers for the input guys, I will see if I can implement this solution. So far I figured out a work around which was a little long but accomplished what I wanted."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "edited": false, "score": 0, "creation_date": 1482400583, "post_id": 41264849, "comment_id": 69762231, "body": "@Mojojojo, ok. but did you try this (short indeed) solution?"}, {"owner": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "edited": false, "score": 0, "creation_date": 1483540755, "post_id": 41264849, "comment_id": 70138351, "body": "@user3598756 I had already used the long work around before I had seen your comment, but just had an opportunity and your idea also would&#39;ve been sufficient. I have validated your response above to show this. Thanks."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483541001, "post_id": 41264849, "comment_id": 70138504, "body": "Thanks for the feedback. So, out of curiosity, what are you going to use in your code?"}, {"owner": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "edited": false, "score": 0, "creation_date": 1483630828, "post_id": 41264849, "comment_id": 70183316, "body": "It was just a 1 off macro I was writing that was for 20 or so projects, categorising rows based on a workitem column in order to attribute separate costs to those categories. All submitted now."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1482332857, "last_edit_date": 1482332857, "creation_date": 1482329701, "answer_id": 41264849, "question_id": 41262522, "link": "https://stackoverflow.com/questions/41262522/vba-macro-producing-incorrect-results-when-run-but-when-stepping-into-results/41264849#41264849", "title": "vba - Macro producing incorrect results when run, but when stepping into results are correct", "body": "<p>you can avoid looping, <code>checker</code> and all those <code>If-Then-Else</code>, like follows</p>\n\n<p><strong>edited</strong> to account for <code>VlookUp</code> range depending on <code>VlookUp</code> value</p>\n\n<pre><code>With Worksheets(\"Sheet2\")\n    .Range(\"N2\", .Cells(NumRowsList, 14)).FormulaR1C1 = \"=VLOOKUP(Value(RC3),IF(Value(RC3)&lt;4000,Sheet4!R2C5:R126C6,Sheet4!R2C2:R200C3),2,FALSE)\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3940667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27054eb585e4560afd5eb6658d094798?s=128&d=identicon&r=PG&f=1", "display_name": "Mojojojo", "link": "https://stackoverflow.com/users/3940667/mojojojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 41264849, "answer_count": 2, "score": 0, "last_activity_date": 1482400510, "creation_date": 1482322160, "last_edit_date": 1482400510, "question_id": 41262522, "link": "https://stackoverflow.com/questions/41262522/vba-macro-producing-incorrect-results-when-run-but-when-stepping-into-results", "title": "vba - Macro producing incorrect results when run, but when stepping into results are correct", "body": "<p>I have a macro that inserts a <code>VLOOKUP</code> into a column. The macro has to take a number stored as text and convert it to a number, before looking up that number in another sheet.</p>\n\n<p>The macro always produces the same results, such as reaching row 43 before starting to produce erroneous results however when using <code>F8</code> to step through the code, these incorrect results are not produced. </p>\n\n<p>The erroneous results are that the value placed into col 13 is not equal to the number stored as text. Mostly it seems as though values from rows above and below, sometimes 2 rows below are being inserted to col 13. Almost seems to me as if 2 different threads are running at 2 different speeds or something?</p>\n\n<p>If anyone could have a look at the loop causing the errors I would be grateful, thanks.</p>\n\n<pre><code>For counter = 2 To NumRowsList\n  checker = CInt(Sheets(\"Sheet2\").Cells(counter, 3)    \n  Sheets(\"Sheet2\").Cells(counter, 13).Value = checker\n\n  'Call WaitFor(0.5)\n  If checker &lt; 4000 Then\n    Sheets(\"Sheet2\").Cells(counter, 14) = \"=VLOOKUP(M\" &amp; counter &amp; \",Sheet4!E2:F126,2,FALSE)\"\n  Else\n    Sheets(\"Sheet2\").Cells(counter, 14) = \"=VLOOKUP(M\" &amp; counter &amp; \",Sheet5!B2:C200,2,FALSE)\"\n  End If        \nNext counter\n</code></pre>\n\n<p>I have tried a few similar variations of this code, such as using the value stored in col 13 directly rather than using the cell reference in the <code>VLOOKUP</code>, always producing the same results.</p>\n\n<p>I even used the waitfor function to try and create a delay hoping it may synchronise the operations, but it did not help and using a delay of more than 0.5 would cause the run time of the macro to be too big.</p>\n\n<p>UPDATE:\nI did not find a perfect solution, only a long hand work around. I simply combined the Vlookups onto a single sheet, and converted the numbers stored as text to numbers outside of the vba routine. This took the error away from the number calculation (just col C * 1), and then the vlookups were looking up the correct values. Thank you for the help, regardless. </p>\n"}, {"tags": ["vba", "custom-formatting"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482322430, "post_id": 41262459, "comment_id": 69725563, "body": "replace the 2 lines in your <code>With</code> with the following <code>.Value = &quot;Constantin&quot; &amp; Cells(4, 1).Value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482328735, "post_id": 41263509, "comment_id": 69729688, "body": "Ok, it seems to work now. One more question though - how can I reduce the number of decimals to one, for example? Now i get a number with 13 decimals. Thanks"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482328922, "post_id": 41263509, "comment_id": 69729835, "body": "<code>&quot;Constantin &quot; &amp; WorksheetFunction.Round(.Value * -1, 1)</code> should do the trick ;)"}, {"owner": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482330125, "post_id": 41263509, "comment_id": 69730628, "body": "i wrote my code in a module and this might be the reason i get this error &quot;invalid or unqualified reference&quot;, with the &quot;.value&quot; selected, when i try to compile the code with the line you sugested"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482330534, "post_id": 41263509, "comment_id": 69730926, "body": "The whole line would be <code>Range(&quot;A1&quot;).Value = &quot;Constantin &quot; &amp; WorksheetFunction.Round((.Value * -1), 1)</code> &lt;-- is that what you&#39;ve got?"}, {"owner": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482331726, "post_id": 41263509, "comment_id": 69731742, "body": "&#39;If Cells(4, 1).Value &lt; 0 Then          Range(&quot;A1&quot;).Value = &quot;Constantin &quot; &amp; WorksheetFunction.Round((.Value * -1), 1)      End If&#39; this is what i wrote and got the same error"}, {"owner": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482332848, "post_id": 41263509, "comment_id": 69732512, "body": "ok, seems like the problem was that it needed to be WorksheetFunction.Round((cells(4.1.Value * -1), 1) not just WorksheetFunction.Round((.Value * -1), 1)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482333654, "post_id": 41263509, "comment_id": 69733049, "body": "Are you using the <code>With</code> block? Or the first version?"}, {"owner": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482390431, "post_id": 41263509, "comment_id": 69756486, "body": "Hm, ok, i was using the simple version (the first one); i guess those lines would have worked inside the <code>with</code> block; so, it was just a misunderstanding; but it works in the end, thanks"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "edited": false, "score": 0, "creation_date": 1482392766, "post_id": 41263509, "comment_id": 69757689, "body": "No problem. Don&#39;t forget to mark as the answer if it helped :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1482325652, "creation_date": 1482325652, "answer_id": 41263509, "question_id": 41262459, "link": "https://stackoverflow.com/questions/41262459/vba-number-format-write-specific-text/41263509#41263509", "title": "vba number format write specific text", "body": "<p>It looks like you don't need the word as part of the actual format, in which case something like this will suffice:</p>\n\n<pre><code>If Cells(4, 1).Value &lt; 0 Then\n    Range(\"A1\").Value = \"Constantin \" &amp; (Cells(4, 1).Value * -1)\nEnd If\n</code></pre>\n\n<p>If you <em>really</em> wanted to use a <code>With</code> block then:</p>\n\n<pre><code>With Cells(4, 1)\n    If .Value &lt; 0 Then\n        Range(\"A1\").Value = \"Constantin \" &amp; (.Value * -1)\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7325479, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268615253185436/picture?type=large", "display_name": "Iv\u0103nescu Dorin", "link": "https://stackoverflow.com/users/7325479/iv%c4%83nescu-dorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 41263509, "answer_count": 1, "score": 0, "last_activity_date": 1482325652, "creation_date": 1482321946, "question_id": 41262459, "link": "https://stackoverflow.com/questions/41262459/vba-number-format-write-specific-text", "title": "vba number format write specific text", "body": "<p>i am pretty new in using VBA for Excel, but after some searching without result i guess i need some help from you. </p>\n\n<p>I am trying to format a specific cell so that, if one condition is met, it shows the value from another cell, but preceded by a specific text, like \"Constantin\". So, the displayed result would be, for example Constantin 80.25 . </p>\n\n<p>The code that i'm trying looks like this:</p>\n\n<pre><code>    If Cells(4, 1) &lt; 0 Then\n\n    With Range(\"A1\")\n    .NumberFormat = \"'Constantin' 0.00\"\n    .Value = - Cells(4, 1)\n\n    End With\n\n    End If\n</code></pre>\n\n<p>I know the syntax is not right, this is my problem, i guess i can't find the right syntax. I hope I'm not bothering you with this, probably, simple question, but i just couldn't find what i needed. Thanks a lot</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 7325434, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154589035800622/picture?type=large", "display_name": "Christoforos Westra", "link": "https://stackoverflow.com/users/7325434/christoforos-westra"}, "edited": false, "score": 0, "creation_date": 1482327235, "post_id": 41262029, "comment_id": 69728677, "body": "won&#39;t let me post more than 2 links, so second example isn&#39;t there but it&#39;s the same with the tables filled in in more places.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7325434, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154589035800622/picture?type=large", "display_name": "Christoforos Westra", "link": "https://stackoverflow.com/users/7325434/christoforos-westra"}, "edited": false, "score": 0, "creation_date": 1482408558, "post_id": 41262365, "comment_id": 69767333, "body": "provided an example of what I have so far above.. thanks!"}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1482321620, "creation_date": 1482321620, "answer_id": 41262365, "question_id": 41262029, "link": "https://stackoverflow.com/questions/41262029/how-to-automatically-adjust-rows-in-export-report-sheet-based-on-the-data-in-exc/41262365#41262365", "title": "How to automatically adjust rows in export/report sheet based on the data in Excel-VBA", "body": "<p>Please post what you have tried so far.</p>\n\n<p>Without fully understanding what you achieve, I assume you need two output areas, that are separated by a blank line.</p>\n\n<p>I suggest you look into the <code>Range.Offset</code>-property <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow noreferrer\">on MSDN</a>. </p>\n\n<p>You could then shift your output-area based on your starting cell and the number of transactions with something like </p>\n\n<pre><code>Dim r as Integer\nr = 'go get the number of transactions somewhere\n\nDim rngOut as Range\nSet rngOut = Sheets(\"Output\").Range(\"C10\").Offset(r + 2, 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1482321823, "creation_date": 1482321823, "answer_id": 41262427, "question_id": 41262029, "link": "https://stackoverflow.com/questions/41262029/how-to-automatically-adjust-rows-in-export-report-sheet-based-on-the-data-in-exc/41262427#41262427", "title": "How to automatically adjust rows in export/report sheet based on the data in Excel-VBA", "body": "<p>I hope this helps you write your code...</p>\n\n<pre><code>LastRow = Sheets(\"Sheetname\").Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>This function is very helpful when using VBA to get the range based on the data. It will return the number of the last cell that contains data on the specified column. In this case it will return the row number of the last cell that contains data on the 1st column (See the 1 argument in cells).</p>\n"}], "owner": {"reputation": 1, "user_id": 7325434, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154589035800622/picture?type=large", "display_name": "Christoforos Westra", "link": "https://stackoverflow.com/users/7325434/christoforos-westra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1526390264, "creation_date": 1482320567, "last_edit_date": 1526390264, "question_id": 41262029, "link": "https://stackoverflow.com/questions/41262029/how-to-automatically-adjust-rows-in-export-report-sheet-based-on-the-data-in-exc", "title": "How to automatically adjust rows in export/report sheet based on the data in Excel-VBA", "body": "<p>Basically I have data of multiple individuals, lets call them A, B and C, for which I have transaction information for each, which is updated regularly. For example, A has had 15 transactions since inceptions, B has had 10 and C has had 6. </p>\n\n<p>I have created a sheet that using a drop down list to select A, B or C will use their respective data to produce the report. However, in one section I produce a ledger which list all transactions by date with all relevant info. I have produced this with \"hard-coded\" ID numbers where I have a pre-defined area of 15 rows which is populated accordingly. I the case of A, no issue. But in the case of B or C, since they have less data, large blank spaces are left (if formula doesn't find data, then N/A turns to blank cell). </p>\n\n<p>In other words I need for example for person A, C10:E25 to be populated, leaving the next section starting at row 27 for example. For person B, C10:E20 with the next section starting at row 22, and similarly, person C, C10:E16 and row 18 respectively. </p>\n\n<p>I have been unable to find a question/answer that will help me do this. Over time, more data  will gather so it needs to be dynamic. I am new to VBA but have used it to create a simple \"print to PDF with name REPORTNAME_DATETODAY\" button. </p>\n\n<p>Thanks</p>\n\n<p>EDIT:</p>\n\n<p>I have made an excel file using random numbers and dates to illustrate my question.</p>\n\n<p>DATA Sheet</p>\n\n<p><img src=\"https://i.stack.imgur.com/nicEy.png\" alt=\"DATA Sheet\"></p>\n\n<p>Output Example</p>\n\n<p><img src=\"https://i.stack.imgur.com/AbMc3.png\" alt=\"Output Example 1\"></p>\n\n<p>As you can see, depending on the individual, there are more or less white \"blank\" spaces which I want removed (I have been doing manually per person so far...). </p>\n\n<p>Note 1:\nIn the output sheet, the ranges A5:A19 and A23:A37 are made invisible on the final report, I just left them there to make their use clear.</p>\n\n<p>Note 2:\nFormulas used in the tables are the following as arrays:\n{=IFNA(INDEX(DATA!$B$1:$B$33,MATCH(1,(DATA!$A$1:$A$33=$C$2)<em>(DATA!$D$1:$D$33=$A$4)</em>(DATA!$F$1:$F$32=$A5),0)),\" \")} </p>\n\n<p>Perhaps it isn't the most efficient way, but that's what I have managed so far. I'm open to suggestions!</p>\n\n<p>EDIT 2: Found this code on the internet which seems to work with regards to deleting empty rows (containing \" \") with one go. But it doesn't allow me to run the code, print to pdf, then CTRL-Z, change person, repeat. \nMy only workaround is to create a copy of the sheet, run the code, print to pdf, delete the sheet. Repeat by copying the main sheet again, change person, code, print.. etc.. </p>\n\n<p>Maybe there is a way make it easier... </p>\n\n<p>here's the code i found (courtesy of Ron de Bruin)</p>\n\n<pre><code>Sub Thing()\n Dim Firstrow As Long\n  Dim Lastrow As Long\n  Dim Lrow As Long\n  Dim CalcMode As Long\n  Dim ViewMode As Long\n\n  With Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n  End With\n\n'We use the ActiveSheet but you can replace this with\n'Sheets(\"MySheet\")if you want\nWith ActiveSheet\n\n    'We select the sheet so we can change the window view\n    .Select\n\n    'If you are in Page Break Preview Or Page Layout view go\n    'back to normal view, we do this for speed\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n\n    'Turn off Page Breaks, we do this for speed\n    .DisplayPageBreaks = False\n\n    'Set the first and last row to loop through\n    Firstrow = .UsedRange.Cells(1).Row\n    Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n    'We loop from Lastrow to Firstrow (bottom to top)\n    For Lrow = Lastrow To Firstrow Step -1\n\n        'We check the values in the A column in this example\n        With .Cells(Lrow, \"B\")\n\n            If Not IsError(.Value) Then\n\n                If .Value = \" \" Then .EntireRow.Delete\n                'This will delete each row with the Value \"ron\"\n                'in Column A, case sensitive.\n\n            End If\n\n        End With\n\n    Next Lrow\n\nEnd With\n\nActiveWindow.View = ViewMode\nWith Application\n    .ScreenUpdating = True\n    .Calculation = CalcMode\nEnd With\nEnd Sub\n</code></pre>\n\n<p>EDIT 3: Found a solution.. or workaround by hiding the rows that contain the \" \" instead of deleting. Created a macro to hide and one to unhide.. so each report's steps are hide, print, unhide... </p>\n"}, {"tags": ["arrays", "excel", "dynamic", "vba"], "comments": [{"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1482320518, "post_id": 41261642, "comment_id": 69724331, "body": "Not an answer, but <code>arrayC</code> isn&#39;t what you think it is - it has empty strings for the first 26 entries (it starts at index 0) and then <code>arrayC(26)</code> is the full string of the alphabet. I believe you want <code>Dim arrayC() As String</code> and <code>arrayC = Split(&quot;A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z&quot;, &quot;,&quot;)</code>"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1482321019, "post_id": 41261642, "comment_id": 69724641, "body": "What does the arrayC = Split(&quot;A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z&quot;, &quot;,&quot;) ?  As you said, arrayC starts at index 0, but if I am defining i = 1 it starts with the first entry, right?"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1482321233, "post_id": 41261642, "comment_id": 69724772, "body": "Try <code>Debug.Print (arrayC(26))</code> with your code and <code>Debug.Print (arrayC(25))</code> with my code to see the difference."}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482321986, "post_id": 41261642, "comment_id": 69725232, "body": "Thank guys. I will try and learn as well :D"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482324195, "post_id": 41261642, "comment_id": 69726666, "body": "bobajob, I think both are correct since it doesn&#39;t anything  and doesn&#39;t show any error."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482325506, "post_id": 41261642, "comment_id": 69727521, "body": "@vbalearner did you test the code in my answer below ?"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482325760, "post_id": 41261642, "comment_id": 69727700, "body": "Shai Rado I tried but its not printing on excel sheets. I am writing the respective code. By the way there is one thing to change in your code to work perfectly: &quot;ReDim Preserve arrayCont(0 To i - 1) &quot; instead of i-1 is i-2"}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482330966, "post_id": 41262201, "comment_id": 69731234, "body": "Shai Rado, I would like to print those values of arrayCont from Cells(9,3) to Cells(10,3) but it will do dynamically for other dimensions. The code I wrote:      While p &lt;= sh1.Range(&quot;D6&quot;).Value - 1     sh3.Cells(8 + i, 3) = arrayCont     If sh3.Cells(8 + i, 3) = arrayCont Then      Call DeleteElementArray(Application.Match(Cells(8 + i, 3).Value, arrayCont, 0) - 1, arrayCont)     End If     i = i + 1     p = p + 1    Wend  The defined p is your i."}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482331006, "post_id": 41262201, "comment_id": 69731263, "body": "When it has to put letter C in cells(10,3) it returns run time error type 13. Can you help me please?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482331273, "post_id": 41262201, "comment_id": 69731448, "body": "i&#39;m at home now, will try to look at it tonight, if not then tomorrow at work"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482346517, "post_id": 41262201, "comment_id": 69740826, "body": "@vbalearner see my <code>Edit 1</code> in my edited code (last 2 rows in &quot;Sub SubArrayfromArray&quot;)"}, {"owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "edited": false, "score": 0, "creation_date": 1482408762, "post_id": 41262201, "comment_id": 69767438, "body": "Thanks Shai Rado. It worked. I had to transpose the arrayCont to fill into a column"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1482346450, "last_edit_date": 1482346450, "creation_date": 1482321145, "answer_id": 41262201, "question_id": 41261642, "link": "https://stackoverflow.com/questions/41261642/vba-create-an-array-from-another-array/41262201#41262201", "title": "VBA - Create an array from another array", "body": "<p><strong>First</strong>, in order to add all the letters inside your brackets to elements in an array, the array need to be dynamic (<code>Dim arrayC As...</code>) , and not static (<code>Dim arrayC(26) As...</code>). Also, either you use <code>Split</code>, or you need to add <code>\"</code> before and after each element inside your brackets.</p>\n\n<p><strong>Second</strong>, in order to find if the value in \"C8\" is found inside the copied array (<code>arrayCont</code>) , which is <code>Redim</code> up to i (=3), we use the <code>Application.Match</code> to find the index of the matching element inside the array. If there is a \"match\" then we remove that element from the array.</p>\n\n<p><strong>Third</strong> I am using a <code>Sub</code> called <strong>\"DeleteElementAt\"</strong> which removes a certain element from an array, depeneds on the index of the array you want to remove.</p>\n\n<hr>\n\n<p><strong>My Code</strong> (Tested)</p>\n\n<pre><code>Option Explicit\n\nSub SubArrayfromArray()\n\nDim arrayC As Variant\nDim i As Integer 'Position in the arrayC(26)\nDim arrayCont As Variant\n\n' this is the way to put all the strings inside the brackets in an array (type Variant) in one line of code\narrayC = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\")\ni = 3 ' i is the value of another worksheet cell\n\n' copy original dynamic array to destination dynamic array\narrayCont = arrayC\n\n' redim the copied array up to 3 (from 0 to 2)\nReDim Preserve arrayCont(0 To i - 1)\n\n' value in Range C8  &gt;&gt; if \"B\" was found inside the arrayCont &gt;&gt; remove it from the array\nIf Not IsError(Application.Match(Range(\"C8\").Value, arrayCont, 0)) Then\n    Call DeleteElementAt(Application.Match(Range(\"C8\").Value, arrayCont, 0) - 1, arrayCont)\nEnd If\n' for debug only\n'For i = LBound(arrayCont) To UBound(arrayCont)\n'    MsgBox \"Array element \" &amp; i &amp; \" Value is \" &amp; arrayCont(i)\n'Next i\n\n' Edit 1: place arrayCont result in Cells(9, 3) &gt;&gt; Range(\"C9\")\nRange(\"C9\").Resize(UBound(arrayCont) + 1, 1).Value = Application.Transpose(arrayCont)\n\nEnd Sub\n</code></pre>\n\n<p><strong>Sub <em>DeleteElementAt</em> Code</strong>    </p>\n\n<pre><code>Public Sub DeleteElementAt(ByVal ArrIndex As Integer, ByRef myArr As Variant)\n\n' this sub removes a certain element from the array, then it shrinks the size of the array by 1    \nDim i As Integer\n\n' move all element back one position\nFor i = ArrIndex + 1 To UBound(myArr)\n    myArr(i - 1) = myArr(i)\nNext\n\n' shrink the array by one, removing the last one\nReDim Preserve myArr(UBound(myArr) - 1)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 7030836, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0040eb895caf4bd125c3853b6cecf9fc?s=128&d=identicon&r=PG", "display_name": "vbalearner", "link": "https://stackoverflow.com/users/7030836/vbalearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3274, "favorite_count": 0, "accepted_answer_id": 41262201, "answer_count": 1, "score": 0, "last_activity_date": 1482346450, "creation_date": 1482319383, "last_edit_date": 1531164843, "question_id": 41261642, "link": "https://stackoverflow.com/questions/41261642/vba-create-an-array-from-another-array", "title": "VBA - Create an array from another array", "body": "<p>I would like to know how to do this, if possible. I have defined the arrayC(26) as:</p>\n\n<pre><code>Dim arrayC(26) As String\narrayC(26) = \"A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z\"\nDim i As Integer 'Position in the arrayC(26)\ni = 1\n</code></pre>\n\n<p>Based on the value of another cell, if it has a value of 3 I want to go from A to C. If it has a value of 5, I want to go from A to E. And so on.</p>\n\n<pre><code>Dim j As Integer\nj = 1\nReDim arrayCont(j) As Variant\n</code></pre>\n\n<p>Let us assume it goes from A to C. So, I want that in arrayCont(j) I have the following values \"A,B,C\". Then I will go to Cells(8,\"C\") to check if it is equal to the value in the arrayCont(j). If so, I want to remove that value from the arrayCont(j). For instance, consider that Cells(8,\"C\") = \"B\". Then my arrayCont(j) will be \"A,C\". How can I do this? </p>\n\n<p>The code I have created is:</p>\n\n<pre><code>Do While p &lt;= sh1.Range(\"D6\").Value\n For p = 1 To sh1.Cells(6, \"D\").Value\n  If sh3.Cells(8, \"C\").Value = arrayC(p) Then\n   arrayCont(j) = arrayCont(j)\n  Else\n   arrayCont(j) = arrayC(p)\n  End If\n Next p\n j = j + 1\nLoop\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1482319576, "post_id": 41261604, "comment_id": 69723790, "body": "not sure I understand ? what is the error ? what are you trying to achieve ?"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482382332, "post_id": 41261604, "comment_id": 69753412, "body": "Respected Sir, Actually above mention code i am developing for over daily MIS. The challenge which i am facing with regards to the last no. ie. (11),(12) and so on, which is generated every time when the system generated Dump we have received. is there any way where the code help me out to ignore the last no. and consider the first line i.e. SECONDARY MIS MODULE only.as suggested even if i work out with &quot;For i = 11 to 15&quot;  statement the no ill increase every time and i will have to do editing with the code after every next 5 or 6 days."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1482381873, "post_id": 41262064, "comment_id": 69753263, "body": "Respected Sir, Actually above mention code i am developing for over daily MIS the change which i am facing with regards to the last no which is generated every time when the system genrated Dump we have received."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1482410727, "post_id": 41262064, "comment_id": 69768529, "body": "@sagar, I edited my answer. Hope that helps you out. On a different note, you need to be aware that almost everyone who read your question struggled to understand your point. Next time, please try to make your question more clear and more straight-forward so you can get help faster instead of getting downvotes. Good luck :)"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1482477372, "post_id": 41262064, "comment_id": 69796142, "body": "Thanks Sir for your help..next time i will ensure your guidelines as well."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "reply_to_user": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1482499445, "post_id": 41262064, "comment_id": 69806942, "body": "You&#39;re welcome :). If you think that helped you solving your problem, you might consider accepting the answer."}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1483954156, "post_id": 41262064, "comment_id": 70294034, "body": "Sir, when I am using your given code I am receiving Compile error: Sub or Function not defined.please help"}], "tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": false, "score": 0, "last_activity_date": 1482410318, "last_edit_date": 1482410318, "creation_date": 1482320675, "answer_id": 41262064, "question_id": 41261604, "link": "https://stackoverflow.com/questions/41261604/workbook-name-change-issue/41262064#41262064", "title": "Workbook name change issue", "body": "<p>If I understand you correctly, you want to be able to apply this code on multiple workbooks/worksheets. You can simply add workbook name and/or worksheet name as parameters of your method:</p>\n\n<pre><code>Sub MySub(wbName As String, wsName As String)\n    a = 6\n    b = 2\n\n    Do While ' ......\n        Z = WorksheetFunction.SumIf(Workbooks(wbName).Worksheets(wsName).Range(\"B5:K5\"), _\n            \"FRANCHISEE DEVELOPMENT\", Workbooks(wbName).Worksheets(wsName).Range(Cells(a, 2), Cells(a, 11)))\n        '\n        '\n        '\n    Loop\nEnd Sub\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>For i = 11 To 15\n    MySub \"SECONDARY MIS MODULE (\" &amp; i &amp; \").xlsx\", \"SECONDARY MIS MODULE (\" &amp; i &amp; \").xlsx\"\nNext\n</code></pre>\n\n<hr>\n\n<p><strong>Update 1:</strong></p>\n\n<p>If you don't know the numeric part of the workbook name, you can write a helper function that returns the actual workbook name, something like the following:</p>\n\n<pre><code>Function GetWorkbookNameByPartial(pattern As String) As String\n    For Each wb In Workbooks\n        If wb.Name Like pattern Then\n            GetWorkbookNameByPartial = wb.Name\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>Dim wbName As String\nwbName = GetWorkbookNameByPartial(\"SECONDARY MIS MODULE (*).xlsx\")\nIf Len(wbName) &gt; 0 Then\n    MySub wbName, wbName ' Only if worksheet name matches workbook name.\n                         ' Otherwise, you will need to change worksheet name.\nEnd If\n</code></pre>\n\n<p>Hope that helps :)</p>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482410318, "creation_date": 1482319249, "last_edit_date": 1531164843, "question_id": 41261604, "link": "https://stackoverflow.com/questions/41261604/workbook-name-change-issue", "title": "Workbook name change issue", "body": "<p>Below is my macro code just one issue is every time the dump which we will export the name of that file will get changed every time.</p>\n\n<p>The end number will always change: <code>\"SECONDARY MIS MODULE (11)\"</code>, <code>\"SECONDARY MIS MODULE (12)\"</code>, etc.</p>\n\n<pre><code>Sub MySub\n    a = 6\n    b = 2\n\n    Do While Workbooks(\"segment.xlsm\").Worksheets(\"Sheet4\").Cells(b, 1) &lt;&gt; \"\"\n        Z = WorksheetFunction.SumIf(Workbooks(\"SECONDARY MIS MODULE (11).xlsx\").Worksheets(\"SECONDARY MIS MODULE (11)\").Range(\"B5:K5\"), _\n            \"FRANCHISEE DEVELOPMENT\", Workbooks(\"SECONDARY MIS MODULE (11).xlsx\").Worksheets(\"SECONDARY MIS MODULE (11)\").Range(Cells(a, 2), Cells(a, 11)))\n\n        x = Application.SumIf(Workbooks(\"SECONDARY MIS MODULE (11).xlsx\").Worksheets(\"SECONDARY MIS MODULE (11)\").Range(\"B5:K5\"), _\n            \"PRIVATE WEALTH GROUP\", Workbooks(\"SECONDARY MIS MODULE (11).xlsx\").Worksheets(\"SECONDARY MIS MODULE (11)\").Range(Cells(a, 2), Cells(a, 11)))\n\n        Workbooks(\"segment.xlsm\").Worksheets(\"Sheet4\").Cells(b, 13).Value = x + Z\n        a = a + 1\n        b = b + 1\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1482318533, "post_id": 41261222, "comment_id": 69723166, "body": "Have a read of this link:  <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and also this one:  <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1482321637, "post_id": 41261222, "comment_id": 69725020, "body": "What have you tried?  Where have you run into problems.  We can help you with code you are trying to write, but this is not a free code-writing service. Please read the help articles referenced in the above comment."}], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1482320289, "creation_date": 1482320289, "answer_id": 41261949, "question_id": 41261222, "link": "https://stackoverflow.com/questions/41261222/excel-vba-strip-numbers-from-string/41261949#41261949", "title": "Excel vba strip numbers from string", "body": "<p>Put below formula to <code>B1</code> cell then Drag and down</p>\n\n<pre><code>=VALUE(IF(ISNUMBER(SEARCH(\"+\",A1)),MID(A1,SEARCH(\"+\",A1)+1,LEN(A1)-SEARCH(\"+\",A1)),IF(ISNUMBER(SEARCH(\"-\",A1)),MID(A1,SEARCH(\"-\",A1)+1,LEN(A1)-SEARCH(\"-\",A1)),\"\")))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/69lQb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/69lQb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 7324988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b5bb1e4e0caf7762c8ef918db6bed7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kuvvat Gitikov", "link": "https://stackoverflow.com/users/7324988/kuvvat-gitikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482320289, "creation_date": 1482318087, "last_edit_date": 1531161705, "question_id": 41261222, "link": "https://stackoverflow.com/questions/41261222/excel-vba-strip-numbers-from-string", "title": "Excel vba strip numbers from string", "body": "<p>Please help me write vba code for convert A column to B column like image, i have tried but can not do.</p>\n\n<p><img src=\"https://i.stack.imgur.com/aLmX3.png\" alt=\"enter image description here\"></p>\n\n<p>A column data 01A+00022.00 i want to convert to it 22 to B column </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 2, "creation_date": 1482318125, "post_id": 41261140, "comment_id": 69722919, "body": "Have you tried using a <code>VLOOKUP</code> on <code>name</code>?"}, {"owner": {"reputation": 212, "user_id": 4086818, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4a148908b620fcd91eb7a80322bb83c4?s=128&d=identicon&r=PG", "display_name": "awariat", "link": "https://stackoverflow.com/users/4086818/awariat"}, "edited": false, "score": 0, "creation_date": 1482321028, "post_id": 41261140, "comment_id": 69724649, "body": "No. I didn&#39;t. But I have code using application.match refer to please:<a href=\"http://stackoverflow.com/questions/41242554/vba-make-code-simplier\" title=\"vba make code simplier\">stackoverflow.com/questions/41242554/vba-make-code-si&zwnj;&#8203;mplier</a>"}], "answers": [{"tags": [], "owner": {"reputation": 212, "user_id": 4086818, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4a148908b620fcd91eb7a80322bb83c4?s=128&d=identicon&r=PG", "display_name": "awariat", "link": "https://stackoverflow.com/users/4086818/awariat"}, "is_accepted": false, "score": 1, "last_activity_date": 1482368966, "creation_date": 1482368966, "answer_id": 41274372, "question_id": 41261140, "link": "https://stackoverflow.com/questions/41261140/excel-vba-import-data-from-another-workbook-and-compare/41274372#41274372", "title": "Excel vba import data from another workbook and compare", "body": "<p>OK I managed to do it on my own.</p>\n\n<pre><code>Sub FBA_test_1()\n\nDim products As Variant\nDim productsWithParams As Variant\nLastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n'products = Array(\"one\", \"two\", \"three\")\nproducts =Workbooks(\"sourceFile.xlsx\").Worksheets(\"Sheet1\").Range(\"A2:A4\").Value\n\n'productsWithParams = Array(Array(\"one\", 10, 11), Array(\"two\", 20, 21), Array(\"three\", 30, 31))\nproductsWithParams = Workbooks(\"sourceFile.xlsx\").Worksheets(\"Sheet1\").Range(\"A2:C4\").Value\n\nFor x = LastRow To 1 Step -1\n\n    ' if value not found inside the array using the \"MATCH\" function\n    pos = Application.Match(Range(\"$A$\" &amp; x).Value, products, 0)\n    If IsError(pos) Then\n        Range(\"$B$\" &amp; x).Value = \"ERROR - \"\n    Else ' successful \"MATCH\" inside the array\n        Range(\"$B$\" &amp; x).Value = pos\n        Range(\"$C$\" &amp; x).Value = products(pos, 1) 'name\n        Range(\"$D$\" &amp; x).Value = productsWithParams(pos, 2) 'param1\n        Range(\"$E$\" &amp; x).Value = productsWithParams(pos, 3) 'param2\n\n   End If\nNext\nEnd Sub\n</code></pre>\n\n<p>I use two arrays one normal and one 2d because 2d doesn't work with Application.Match<br>\nRegards</p>\n"}], "owner": {"reputation": 212, "user_id": 4086818, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4a148908b620fcd91eb7a80322bb83c4?s=128&d=identicon&r=PG", "display_name": "awariat", "link": "https://stackoverflow.com/users/4086818/awariat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1614299747, "creation_date": 1482317917, "last_edit_date": 1531164843, "question_id": 41261140, "link": "https://stackoverflow.com/questions/41261140/excel-vba-import-data-from-another-workbook-and-compare", "title": "Excel vba import data from another workbook and compare", "body": "<p>I have one excel workbook \"source\" (with data parameters) like :</p>\n\n<p><strong>NAME</strong>    <strong>PARAMS1</strong>    <strong>PARAMS2</strong>   ...<br>\nname1   param1_1   param1_2  ...<br>\nname2   param2_1   param2_2  ...<br>\nname3   param3_1   param3_2  ...   </p>\n\n<p>In another workbook \"report\" I have column for example \"B\" where I have my \"names\" as well like:\n.A.....B.....C<br>\n....name1...<br>\n....name1...<br>\n....name2...<br>\n....name3...<br>\n....name2...<br>\n...<br>\nNow I want to:<br>\n1. Import data from \"source\" to \"report\"<br>\n2. Check in column if I have the same name<br>\n3. If I find the same name I put value(param) of corresponding name in column for example\"C\"    </p>\n\n<p>I have one big Please. I need working example not advice like I should learn about Vlookup or collections or arrays.<br>\nregards<br>\nJack</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1482315745, "post_id": 41260357, "comment_id": 69721209, "body": "Probably not the problem, but your error handler code should be outside the main body of the procedure - between  <code>Exit Sub</code> and <code>End Sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1482332996, "post_id": 41261075, "comment_id": 69732638, "body": "while you have a point, I recon he still has to use <code>.Copy</code> to copy the formats."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 1, "creation_date": 1482333124, "post_id": 41261075, "comment_id": 69732721, "body": "@Martin Dreher: yeah, possibly, I am zealot about some things. :) Hello to Freiburg, good place for cycling and ordoliberalism."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1482392494, "post_id": 41261075, "comment_id": 69757549, "body": "@S Meaden: true, but still a terrible place for finding a job... ;)"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1482317678, "creation_date": 1482317678, "answer_id": 41261075, "question_id": 41260357, "link": "https://stackoverflow.com/questions/41260357/excel-crashes-when-running-a-macro-that-loops-through-several-files/41261075#41261075", "title": "Excel crashes when running a macro that loops through several files", "body": "<p>Well, Excel should not crash but in the real world it does if you push it.  Instead of running experiments I'd rewrite the code to make it safer.</p>\n\n<p>So how to make your code safer.  Well, I'm guessing that perhaps you problem is you are thrashing the clipboard with your copy and pastes.  I almost never have copy and paste code in production.  If I want to copy cells from source to destination then I use the Range.Value2 bulk get/set.  So an example would be</p>\n\n<pre><code>Range(\"Destination\").Value2 = Range(\"Source\").Value2\n</code></pre>\n\n<p>You need to make sure the source and destination ranges are of exact same dimension.  So swap in this type of code for your copy and paste values.\nAlso, format the cells with VBA code rather than copying from clipboard.</p>\n\n<p>See if that fixes it.  Post feedback.</p>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1482334255, "last_edit_date": 1482334255, "creation_date": 1482333955, "answer_id": 41266282, "question_id": 41260357, "link": "https://stackoverflow.com/questions/41260357/excel-crashes-when-running-a-macro-that-loops-through-several-files/41266282#41266282", "title": "Excel crashes when running a macro that loops through several files", "body": "<p>@S Meaden is right in the regard that you should try to avoid <code>.Copy</code> + <code>.Paste</code> when possible.</p>\n\n<p>However, since you want the formats, I guess this is actually one of the rare cases where copy+pasting makes sense.</p>\n\n<p>I recon your problem is not the <code>.Copy</code> per se, but rather the repeated <code>.Open</code> + <code>.Close</code> of the OnePager-workbooks. </p>\n\n<p>When I encountered a similar problem, my Excel didn't exactly crash, the macro just stopped randomly without triggering the error handler.</p>\n\n<p>I would try the following:</p>\n\n<ul>\n<li>open a new Excel before entering the loop</li>\n<li>open your OnePager-files with that app, and paste into your existing Excel</li>\n</ul>\n\n<p>Hope that helps!</p>\n\n<p>Here's how you can adjust your code:</p>\n\n<pre><code>Private Sub GenerateReportOP()\n\n    '... your code\n\n    ' open a new Excel in which you open the files\n    Dim xlApp As New Excel.Application\n    i = 3\n    Do While i &lt;= LastRowMOP\n\n        '... your code\n\n        ' change: repeatedly open the files in your new excel app\n        Set OnePager = xlApp.Workbooks.Workbooks.Open(OPPath &amp; \"*One Pager*\" &amp; \".xlsx\")\n\n        '... your code\n\n        xlApp.CutCopyMode = False\n        OnePager.Close savechanges:=False\n\n        '... your code\n\n    i = i + 1\n    Loop\n\n    ' close the new excel after you're done looping. always close it (w/ errorhandler), so you dont have to shut it down with the task manager\n    xlApp.Quit\n    Set xlApp = Nothing\n\n    '... your code\n\n    MsgBox \"Finished. Please check \"\"One Pagers\"\" tab.\"\nEnd Sub\n</code></pre>\n\n<p>Also, reading <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">this</a> should speed up your coding quite a bit an will likely make your code more readable</p>\n"}, {"comments": [{"owner": {"reputation": 765, "user_id": 841151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be85efe6ae27bfc269c40dd063067a5f?s=128&d=identicon&r=PG", "display_name": "Marcos Lima", "link": "https://stackoverflow.com/users/841151/marcos-lima"}, "edited": false, "score": 0, "creation_date": 1592484722, "post_id": 41280820, "comment_id": 110446160, "body": "<code>Application.CutCopyMode = False</code> made all the difference to me. I wasn&#39;t copying anything, just dealing with a bunch of files, and after I included this line, Excel stopped crashing."}], "tags": [], "owner": {"reputation": 21, "user_id": 7323156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2cb4cd334bc0a3542611e4f6985cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7323156/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1482402099, "creation_date": 1482402099, "answer_id": 41280820, "question_id": 41260357, "link": "https://stackoverflow.com/questions/41260357/excel-crashes-when-running-a-macro-that-loops-through-several-files/41280820#41280820", "title": "Excel crashes when running a macro that loops through several files", "body": "<p>Thank you everyone for your help. I combined two advices of Darren and S Maeden.\nI changed my error handler and made macro to copy data direcly into cells avoiding usage of clipboard. I'm just working on formating part now</p>\n\n<pre><code>OPPath = ThisMacro.Range(\"B\" &amp; i) &amp; ThisMacro.Range(\"F1\") &amp; \"\\\" &amp; ThisMacro.Range(\"H1\") &amp; \"\\\"\n        'error handler if path is not correct\n        On Error Resume Next\n        Set OnePager = Workbooks.Open(OPPath &amp; \"*One Pager*\" &amp; \".xlsx\")\n        If Err.Number = 1004 Then\n            If ThisOnePage.Range(\"D\" &amp; LastRow1 + 1) = \"\" Then\n                ThisOnePage.Range(\"C\" &amp; LastRow1 + 1).Value = \"Unable to find One Pager, please check file or path!\"\n            End If\n        Else\n            Set OnePagerWS = OnePager.Worksheets(\"Check list\")\n            LastRow2 = OnePagerWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            LastRowZ = OnePagerWS.Range(\"Z\" &amp; Rows.Count).End(xlUp).Row\n            'check what rates is linked\n            Rates = OnePagerWS.Range(\"S9\").Formula\n            SubstrinLoc = InStr(1, Rates, \"FY\")\n            ThisOnePage.Range(\"D\" &amp; LastRow1 + 1) = Mid(Rates, SubstrinLoc + 6, 13)\n            ThisOnePage.Range(\"D\" &amp; LastRow1 + 1).Font.Bold = True\n            ThisOnePage.Range(\"D\" &amp; LastRow1 + 1).Font.Color = vbBlue\n            ThisOnePage.Range(\"D\" &amp; LastRow1 + 1).Font.Size = 14\n            'copy one pager\n            ThisOnePage.Range(\"I\" &amp; LastRow1 + 2).Value = OnePagerWS.Range(\"D4\").Value\n\n            ThisOnePage.Range(\"B\" &amp; LastRow1 + 2 &amp; \":B\" &amp; LastRow1 + LastRow2 - 4).Value = OnePagerWS.Range(\"A6:A\" &amp; LastRow2).Value\n\n            ThisOnePage.Range(\"C\" &amp; LastRow1 + 2 &amp; \":C\" &amp; LastRow1 + LastRow2 - 4).Value = OnePagerWS.Range(\"J6:J\" &amp; LastRow2).Value\n            ThisOnePage.Range(\"C\" &amp; LastRow1 + 2 &amp; \":C\" &amp; LastRow1 + LastRow2 - 4).NumberFormat = \"0\"\n            ThisOnePage.Range(\"D\" &amp; LastRow1 + 2 &amp; \":D\" &amp; LastRow1 + LastRow2 - 4).Value = OnePagerWS.Range(\"L6:L\" &amp; LastRow2).Value\n            ThisOnePage.Range(\"D\" &amp; LastRow1 + 2 &amp; \":C\" &amp; LastRow1 + LastRow2 - 4).NumberFormat = \"0\"\n            ThisOnePage.Range(\"E\" &amp; LastRow1 + 2 &amp; \":E\" &amp; LastRow1 + LastRow2 - 4).Value = OnePagerWS.Range(\"N6:N\" &amp; LastRow2).Value\n\n            ThisOnePage.Range(\"F\" &amp; LastRow1 + 2 &amp; \":F\" &amp; LastRow1 + LastRow2 - 4).Value = OnePagerWS.Range(\"Q6:Q\" &amp; LastRow2).Value\n\n            ThisOnePage.Range(\"G\" &amp; LastRow1 + 2 &amp; \":G\" &amp; LastRow1 + LastRow2 - 4).Value = OnePagerWS.Range(\"S6:S\" &amp; LastRow2).Value\n\n            ThisOnePage.Range(\"H\" &amp; LastRow1 + 2).Value = OnePagerWS.Range(\"T6:T\" &amp; LastRow2).Value\n\n            ThisOnePage.Range(\"J\" &amp; LastRow1 + 2).Value = OnePagerWS.Range(\"Z\" &amp; LastRowZ).Value\n\n            LastRow2 = ThisOnePage.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n            With ThisOnePage\n                .Range(.Cells(LastRow1 + 4, 1), .Cells(LastRow2, 1)) = ThisMacro.Range(\"A\" &amp; i)\n            End With\n            Application.CutCopyMode = False\n            OnePager.Close savechanges:=False\n        End If\n    End If\n\n    i = i + 1\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7323156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2cb4cd334bc0a3542611e4f6985cd1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/7323156/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3229, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1499944989, "creation_date": 1482315446, "question_id": 41260357, "link": "https://stackoverflow.com/questions/41260357/excel-crashes-when-running-a-macro-that-loops-through-several-files", "title": "Excel crashes when running a macro that loops through several files", "body": "<p>I have created a macro that opens few files and copies data from that files into one workbook. The way macro works is:\n1) There is a main workbook (target workbook) with few worksheets, one of the worksheets contains paths to the files in the column B. Cells F1 and H1 contains two subfolders that users specify and these two cells are added into the file path. Files are named differently, but all the files contain \"One pager\" in the name. So I use a file path and a wild card \"One pager*\" &amp; \".xlsx\" to open the file.\n2) Macro checks how many rows are filled with a path and loops through the rows with paths, opens each files (source workbook), copies specified fields into target worksheet in the main workbook and then closes source files.</p>\n\n<p>Macro works fine when I run it step by step or when I set a break point and run one loop at a time, but as soon as I run complete macro my Excel crashes after running through 5-6 files. I tried to run the same macro on 4 different computers, on two of them excel crashes while running macro, on two of them macro works fine. Two computers where macro crashes run windows 8.1 64bit professional and two where macro works fine run windows 7 64 and 32bit enterprise and all computers have Office 365. Could someone have a look into code, maybe there is somethign I can optimise to make it work on all computers?\nThank you in advance</p>\n\n<pre><code>    Private Sub GenerateReportOP()\n    Dim ThisWB As Workbook\n    Dim OnePager As Workbook\n    Dim ThisMacro As Worksheet\n    Dim ThisOnePage As Worksheet\n    Dim OnePagerWS As Worksheet\n    Dim LastRow1 As Long\n    Dim LastRow2 As Long\n    Dim LastRowZ As Long\n    Dim LastRowMOP As Long\n    Dim OPPath As String\n    Dim BSpath As String\n    Dim Rates As String\n    Dim i As Integer\n    Dim SubstrinLoc As Integer\n\n    Application.ScreenUpdating = False\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.Calculation = xlManual\n\n    Set ThisWB = ThisWorkbook\n    Set ThisMacro = ThisWB.Sheets(\"Macros\")\n    Set ThisOnePage = ThisWB.Sheets(\"One Pagers\")\n\n    ThisOnePage.Cells.Clear\n    LastRowMOP = ThisMacro.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    i = 3\n    Do While i &lt;= LastRowMOP\n    LastRow1 = ThisOnePage.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    If ThisMacro.Range(\"B\" &amp; i) &lt;&gt; \"\" Then\n    ThisOnePage.Range(\"B\" &amp; LastRow1 + 1) = ThisMacro.Range(\"A\" &amp; i)\n    ThisOnePage.Range(\"C\" &amp; LastRow1 + 1).Value = \"FX:\"\n    'just formating section\n    ThisOnePage.Range(\"B\" &amp; LastRow1 + 1).Font.Bold = True\n    ThisOnePage.Range(\"B\" &amp; LastRow1 + 1).Font.Color = vbRed\n    ThisOnePage.Range(\"B\" &amp; LastRow1 + 1).Font.Size = 14\n    ThisOnePage.Range(\"C\" &amp; LastRow1 + 1).Font.Bold = True\n    ThisOnePage.Range(\"C\" &amp; LastRow1 + 1).Font.Color = vbRed\n    ThisOnePage.Range(\"C\" &amp; LastRow1 + 1).Font.Size = 14\n    'Define one pager workbook\n    OPPath = ThisMacro.Range(\"B\" &amp; i) &amp; ThisMacro.Range(\"F1\") &amp; \"\\\" &amp; ThisMacro.Range(\"H1\") &amp; \"\\\"\n    'error handler if path is not correct\n    On Error GoTo Error_handler:\n    Set OnePager = Workbooks.Open(OPPath &amp; \"*One Pager*\" &amp; \".xlsx\")\n    Set OnePagerWS = OnePager.Worksheets(\"Check list\")\n    LastRow2 = OnePagerWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    LastRowZ = OnePagerWS.Range(\"Z\" &amp; Rows.Count).End(xlUp).Row\n    'check what ratees is linked\n    Rates = OnePagerWS.Range(\"S8\").Formula\n    SubstrinLoc = InStr(1, Rates, \"FY\")\n    ThisOnePage.Range(\"D\" &amp; LastRow1 + 1) = Mid(Rates, SubstrinLoc + 6, 13)\n    ThisOnePage.Range(\"D\" &amp; LastRow1 + 1).Font.Bold = True\n    ThisOnePage.Range(\"D\" &amp; LastRow1 + 1).Font.Color = vbBlue\n    ThisOnePage.Range(\"D\" &amp; LastRow1 + 1).Font.Size = 14\n    'copy one pager\n    OnePagerWS.Range(\"D4\").Copy\n    ThisOnePage.Range(\"I\" &amp; LastRow1 + 3).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"I\" &amp; LastRow1 + 3).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"A6:A\" &amp; LastRow2).Copy Destination:=ThisOnePage.Range(\"B\" &amp; LastRow1 + 2)\n    OnePagerWS.Range(\"J6:J\" &amp; LastRow2).Copy\n    ThisOnePage.Range(\"C\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"C\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"L6:L\" &amp; LastRow2).Copy\n    ThisOnePage.Range(\"D\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"D\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"N6:N\" &amp; LastRow2).Copy\n    ThisOnePage.Range(\"E\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"E\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"Q6:Q\" &amp; LastRow2).Copy\n    ThisOnePage.Range(\"F\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"F\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"S6:S\" &amp; LastRow2).Copy\n    ThisOnePage.Range(\"G\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"G\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"T6:T\" &amp; LastRow2).Copy\n    ThisOnePage.Range(\"H\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"H\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    OnePagerWS.Range(\"Z\" &amp; LastRowZ).Copy\n    ThisOnePage.Range(\"I\" &amp; LastRow1 + 2).PasteSpecial xlPasteValues\n    ThisOnePage.Range(\"I\" &amp; LastRow1 + 2).PasteSpecial xlPasteFormats\n    LastRow2 = ThisOnePage.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    With ThisOnePage\n        .Range(.Cells(LastRow1 + 4, 1), .Cells(LastRow2, 1)) = ThisMacro.Range(\"A\" &amp; i)\n    End With\n    Application.CutCopyMode = False\n    OnePager.Close savechanges:=False\n\n    'error handler if path is not correct\nError_handler:\n        If ThisOnePage.Range(\"D\" &amp; LastRow1 + 1) = \"\" Then\n            ThisOnePage.Range(\"C\" &amp; LastRow1 + 1).Value = \"Unable to find One Pager, please check file or path!\"\n        End If\n        Resume Next\n    End If\n\n    i = i + 1\n    Loop\n    ThisOnePage.Range(\"A:I\").EntireColumn.AutoFit\n    Application.AskToUpdateLinks = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.Calculation = xlAutomatic\n\n    MsgBox \"Finished. Please check \"\"One Pagers\"\" tab.\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1172, "user_id": 6620537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aaa970cbc84d400f2cc155d7af4254e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Bambury", "link": "https://stackoverflow.com/users/6620537/paul-bambury"}, "is_accepted": false, "score": 0, "last_activity_date": 1482315191, "creation_date": 1482315191, "answer_id": 41260261, "question_id": 41260051, "link": "https://stackoverflow.com/questions/41260051/barcode-font-ean-13-idautomationsupceanm-otf-shows-demo-on-right-corner-of-the/41260261#41260261", "title": "Barcode font EAN 13 IDAutomationSUPCEANM.otf shows &quot;DEMO&quot; on right corner of the barcode", "body": "<p>It's a demo font. Either use a licensed version or get your credit card out.</p>\n"}], "owner": {"reputation": 1, "user_id": 7324982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s_K9Mv7KOpM/AAAAAAAAAAI/AAAAAAAAAOU/WN_cdkInv74/photo.jpg?sz=128", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/7324982/ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482398076, "creation_date": 1482314608, "last_edit_date": 1482398076, "question_id": 41260051, "link": "https://stackoverflow.com/questions/41260051/barcode-font-ean-13-idautomationsupceanm-otf-shows-demo-on-right-corner-of-the", "title": "Barcode font EAN 13 IDAutomationSUPCEANM.otf shows &quot;DEMO&quot; on right corner of the barcode", "body": "<p><img src=\"https://i.stack.imgur.com/s0C42.jpg\" alt=\"Barcode sample\"></p>\n\n<p>Barcode font, EAN 13 IDAutomationSUPCEANM.otf , shows \"DEMO\" on right corner of the barcode. </p>\n\n<p>What is the right font? I use thermal printer to print barcode,\nand my barcode length will be always 13. I had tried many barcode fonts, but IDAutomation was able to decrypt the barcode script.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1482314734, "post_id": 41259992, "comment_id": 69720429, "body": "yes, but are we suppose to guess how your workbooks and worksheet data looks like ? structure ? what data goes to which row and column ? Also, SO is not a free coding service website, please upload your code attempt, and we will gladly assist you in resolving bugs or requests you have"}, {"owner": {"reputation": 1, "user_id": 6154778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476298ff631b06a5fe909fc85a3a583?s=128&d=identicon&r=PG&f=1", "display_name": "E Colley", "link": "https://stackoverflow.com/users/6154778/e-colley"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482316244, "post_id": 41259992, "comment_id": 69721614, "body": "Sorry, I often come here for help when I&#39;m coding, this is the first time i have asked a question, so wasn&#39;t really sure of the protocol."}], "owner": {"reputation": 1, "user_id": 6154778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476298ff631b06a5fe909fc85a3a583?s=128&d=identicon&r=PG&f=1", "display_name": "E Colley", "link": "https://stackoverflow.com/users/6154778/e-colley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482314442, "creation_date": 1482314442, "question_id": 41259992, "link": "https://stackoverflow.com/questions/41259992/update-a-spreadsheet-based-on-dates-in-a-different-workbook", "title": "Update a spreadsheet based on dates in a different workbook", "body": "<p>I have two spreadsheets - one that people record their own individual leave in and the second where all dates for leave are recorded across the team. I want to know if someone puts a date in their own sheet, can I get it to automatically fill this data in to the main sheet? </p>\n\n<p>The individual sheet works out the number of days between two dates then keeps a running total (using networkdays formula and not taking into account bank holidays) </p>\n\n<p>The main workbook has a front tab which calculates the overall number of days taken and a running total of leave left. </p>\n\n<p>I want to put a date into the individual one and update the main workbook - is this even possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1482313420, "post_id": 41258972, "comment_id": 69719436, "body": "Is there a specific line of code that is producing an error on one of the windows systems?"}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1482313754, "post_id": 41258972, "comment_id": 69719695, "body": "Well the problem is usually when data is imported by xml request and then used as a number in calculation. Convering to number gives also the same error. I get type errors. I tried also &quot;variable = CDbl(&quot;10.1&quot;)&quot; and got the same error. When I used &quot;10,1&quot; then no issue what so ever."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1482315253, "post_id": 41258972, "comment_id": 69720805, "body": "What happens in Windows 10, when you set the decimalseparator to &quot;.&quot; and then you debug.print it?"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1482315348, "post_id": 41258972, "comment_id": 69720873, "body": "I&#39;d imagine it would return &quot;.&quot; provided <code>UseSystemSeparators = False</code> but would return &quot;,&quot; if <code>UseSystemSeparators = True</code>?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482315630, "post_id": 41258972, "comment_id": 69721121, "body": "Is it <i>only</i> Windows version that had changed, or the office and Excel version as well? If so, which version are you using?"}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482318722, "post_id": 41258972, "comment_id": 69723279, "body": "I tried Debug.Print Application.DecimalSeparator = &quot;.&quot; while in Excel setting UseSystemSeparators is swhiched off and separator is set to &quot;.&quot; and it printed &quot;True&quot;. Then I added Debug.Print CDbl(&quot;10.1&quot;) and that gave Error: &quot;Type mismatch and higlighted the added row."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482319169, "post_id": 41258972, "comment_id": 69723547, "body": "Both computers have Excel 2016. Win 10 has version 15.0.4569.1504 and Win 7 has version 15.0.4884.1000. They seem close enough to me but I don&#39;t really know if this cane make that difference."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482319885, "post_id": 41258972, "comment_id": 69723963, "body": "Sorry, Excel 2013 I meant. :)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 4, "creation_date": 1482326653, "post_id": 41258972, "comment_id": 69728298, "body": "@codegenerator Is this data that has been generated as a non-Excel file, and then being imported into Excel?  If so, how do you get the data into Excel?  Using VBA, a better method would be to use the <code>Workbook.OpenText</code> method which will allow you to specify the thousands and decimal separators as it exists in the data being imported.  It seems to me that this will be a more bulletproof method, especially going forward."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482326890, "post_id": 41258972, "comment_id": 69728446, "body": "The data is taken from xml report. Anyhow. My point is that it works in windows 7 and it does not work in windows 10 and my question is that can Excel be put to use application setting also under windows 10 so I would not have to rewrite code in all of the tools."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482326999, "post_id": 41258972, "comment_id": 69728508, "body": "The question of @RonRosenfeld is important to proceed. Also, What happens if you try <code>Val(&quot;10.1&quot;)</code> instead of <code>CDbl</code>? <code>Val</code> has the distinction that it converts strings to numbers using <i>only</i> the US decimal separator <code>.</code>, so it might be an option. Problem is it stops at any other character, so it wont recognize commas as thousands separator..."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1482327665, "post_id": 41258972, "comment_id": 69728970, "body": "@codegenerator your test with cdbl does not show that Excel is not using a system separators.  Write the value  to a worksheet cell and see what happens. VBA is not Excel"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1482327743, "post_id": 41258972, "comment_id": 69729026, "body": "@codegenerator also, you may have to change the thousands separator"}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482328156, "post_id": 41258972, "comment_id": 69729289, "body": "It&#39;s good that I answered the question of @RonRosenfeld then. The data comes from a xml report. When I use Val(&quot;10.1&quot;) then it works and I get 10,1 as a number printed out(as system still uses &quot;,&quot;.  Problem is that using Val() function would still mean re-writing the code. I still would like to know if there is way to make Excel 2013 in Windows 10 work as it does in Windows 7 so it would not use system but excel separator."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482328314, "post_id": 41258972, "comment_id": 69729393, "body": "@RonRosenfeld - on excel sheet they both work the same in both Windows 7 and Windows 10. If UseSystemSeparators = True then 10.1 cannot be used in a calculation and 10,1 can be. If False then vice versa as Application.Decimalseparator = &quot;.&quot;."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482328502, "post_id": 41258972, "comment_id": 69729547, "body": "@RonRosenfeld - what do I have to change the thousands separator to?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1482328868, "post_id": 41258972, "comment_id": 69729799, "body": "#codegenerator I do not believe you can change the decimal separator in VBA. I don&#39;t know why it worked in 2007. Possibly something in your code or data that you&#39;re not sharing with us. As far as I know, maybe a has always used only the dot as a decimal separator"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1482328918, "post_id": 41258972, "comment_id": 69729832, "body": "That should read VBA and not maybe"}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482330348, "post_id": 41258972, "comment_id": 69730789, "body": "@RonRosenfeld - the code I have shared in original post is full code. Works in Win7, does not in Win10. Setting in both excel apps are same. File is exactly the same."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482330854, "post_id": 41258972, "comment_id": 69731156, "body": "@RonRosenfeld my point is that in Win10 vba says Type mismatch when dot is decimal separator and works when comma is. If I change System, not excel parameter into dot, then magically in Win10 vba works and gives Type mismatch with comma, not dot. Therefor I make a judgment that vba uses system separator for some reason in Win10 and in Win7 it uses how it is set in Excel."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1482338942, "post_id": 41258972, "comment_id": 69736593, "body": "@codegenerator I <b>cannot</b> reproduce your problem in W10 / Excel 2016 when I set my system separators to be comma for decimal and space for thousands (digits).  I copied/pasted your code and the MsgBox show <code>10,1</code>  There must be something different about your environment.  (If I use dot for the digit separators, then <code>10.1</code> gets interpreted as <code>101</code>; that&#39;s why I made it a <code>non-dot</code>).  What are your system regional decimal and digit separators when things don&#39;t work?"}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482498559, "post_id": 41258972, "comment_id": 69806505, "body": "@RonRosenfeld I tried German settings, US - chaning the separator makes sense and works. I also asked IT to put Excel 2016. Poblem is With Estonian format settings. I tried Microsoft support also but they had even hard time undestanding that EXCEL Visual Basic is not either Visio or Visual Studio. So no help from them."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1482501609, "post_id": 41258972, "comment_id": 69807905, "body": "@codegenerator OK, I <b>CAN</b> reproduce your problem with the Estonian language Windows regional settings. I don&#39;t know why it should occur there, and not with the same separators being used with a different locale, or with Excel 2007. However, if your code must handle input from non-Estonian locales, as well as Estonia, I suggest (unless someone comes up with a better idea) you will have to modify the code to become &quot;internationally aware&quot;. If you search with that term, you should get plenty of information.  It will take time, but may make maintenance simpler in the future."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1482501693, "post_id": 41258972, "comment_id": 69807934, "body": "@codegenerator you may need to only write a single routine to handle that, and then modify your 300 VBA routines to call that single routine first."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482830058, "post_id": 41258972, "comment_id": 69886527, "body": "@RonRosenfeld - could you hint me bit more what do you mean by internationally aware in one callable routine. I googled and find a lot of information but some say using Format function on a string will be solution and some suggested using &quot;|&quot; as decimal but I cannot figure out what could be the single callable solution and what is internationally aware in vba."}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482841344, "post_id": 41258972, "comment_id": 69892104, "body": "@RonRosenfeld the problem with the &quot;internationally aware&quot; is that the original data as string comes straight from XML file so it is difficult to change this. At the moment I can come up with making a replace function that checks the system separator and if it , it changes the . from string to , and then converts to double and else it just converts to double. And then one by one if the problem occures just change the tools. Not the best solution but I think it is some kind of Microsoft bug with Estonian setting and Microsoft support told me to go to social.msdn - why, I do not know."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1482842278, "post_id": 41258972, "comment_id": 69892569, "body": "@codegenerator If your tools assume the Estonian setting, then a possible solution would be to pre-process your xml file with a VBA routine that would convert relevant data from whatever settings were being used to generate the data, to something that can be understood by your existing tools.  Then pass that processed file to your tool.  Only the pre-processor would have to be aware of the settings used to generate the xml file."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482324895, "post_id": 41262784, "comment_id": 69727100, "body": "Thanks for the explanation. But the thing is that... in windows 7pc everything works. I set Application.UseSystemSeparators = False, Application.DecimalSeparator = &quot;.&quot; And I can convert string &quot;10.1&quot; with CDbl into a double. When I do the same in windows 10 pcs I get the Type error."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482325481, "post_id": 41262784, "comment_id": 69727505, "body": "The solutions shouldn&#39;t change, you&#39;ll just need to apply a <code>Replace</code> function to the strings which will stop the error from happening on Windows 10 and will not affect the Windows 7 PCs as they will still function as normal with the <code>Replace</code> functions"}, {"owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "edited": false, "score": 0, "creation_date": 1482326071, "post_id": 41262784, "comment_id": 69727882, "body": "As I said there ase so many different tools that I would really wish to avoid spending my next three months reprogramming them. I can figure out many workarounds, as I said in original post. What I wish to find out is how to make Excel work as it does under windows 7 or to find out if it really is not possible then I can let everyone know that all the projects in my worklist will be postponed three months."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1493795298, "post_id": 41262784, "comment_id": 74548272, "body": "I feel it should be emphasized more that <code>CDbl</code> was never meant to respect <code>Application.DecimalSeparator</code>. It either never did and generated slightly/not so slightly off values without the OP noticing, or there was <a href=\"http://stackoverflow.com/questions/41258972/i-cannot-make-excel-vba-to-use-application-separator-in-windows-10-while-i-can-i/43745727#comment69807905_41258972\">something really strange</a> happening, but the point is, <code>CDbl</code> only respects the system separators by design, and any code that assumes different must be changed."}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 1, "last_activity_date": 1482325400, "last_edit_date": 1592644375, "creation_date": 1482323108, "answer_id": 41262784, "question_id": 41258972, "link": "https://stackoverflow.com/questions/41258972/i-cannot-make-excel-vba-to-use-application-separator-in-windows-10-while-i-can-i/41262784#41262784", "title": "I cannot make excel vba to use application separator in windows 10 while I can in windows 7", "body": "<h2>This answer is based on your system (default) DecimalSeparator being a comma (,) and ThousandsSeparator being a point (.) - using Windows 10</h2>\n<p><strong>Explanation:</strong></p>\n<p>I've done a little testing and found that the following functions only change the <code>DecimalSeparator</code> within Excel, not within VBA:</p>\n<pre><code>Application.UseSystemSeparators = False\nApplication.DecimalSeparator = &quot;.&quot;\nApplication.ThousandsSeparator = &quot;,&quot;\n</code></pre>\n<p>This means that when you change the <code>DecimalSeparator</code> by using these lines of code, it will simply update the values in your workbooks to be displayed in the format you are specifying. For example if your system format is:</p>\n<pre><code>100.000.000,99\n</code></pre>\n<p>Then the lines of code above would convert the values to:</p>\n<pre><code>100,000,000.99\n</code></pre>\n<p>However, when you run the code above and try to use a string that uses the non-system format for the <code>DecimalSeparator</code> then VBA will not recognise it.</p>\n<p><strong>Example:</strong></p>\n<p>(Where <code>Application.DecimalSeparator = &quot;,&quot;</code> when <code>Application.UseSystemSeparators = True</code>)</p>\n<pre><code>Sub TestSeparator()\n\nApplication.UseSystemSeparators = False\nApplication.DecimalSeparator = &quot;.&quot;\nApplication.ThousandsSeparator = &quot;,&quot;\n\nDebug.Print CDbl(&quot;100.99&quot;)\n\nEnd Sub\n</code></pre>\n<p>This code will return <code>10099</code>, not the expected double of <code>100,99</code> (in your system format) because VBA does not see the <code>DecimalSeparator</code> of &quot;.&quot; as a <code>DecimalSeparator</code>.</p>\n<p><strong>Solution:</strong></p>\n<p>When referencing doubles within VBA you will need to always use the computer's system separators for thousands and decimals. If the doubles are being imported as strings you will need to use <a href=\"https://msdn.microsoft.com/en-us/library/bt3szac5(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Replace</a> to convert the string into a format that uses system separators.</p>\n<p><strong>Solution Example:</strong></p>\n<p>(Where <code>Application.DecimalSeparator = &quot;,&quot;</code> when <code>Application.UseSystemSeparators = True</code>)</p>\n<p>If you have the string of <code>&quot;100,000,000.99&quot;</code> in cell <code>A1</code> and use the following code:</p>\n<pre><code>CDbl(Range(&quot;A1&quot;).Value)\n</code></pre>\n<p>It will produce a &quot;Type mismatch&quot; error. However if you convert this into a string that uses your system separators then no error will be given. You will need to use two <code>Replace</code> functions though, one to remove the <code>ThousandsSeparators</code> and one to convert the <code>DecimalSeparators</code> to your system ones:</p>\n<pre><code>CDbl(Replace(Replace(Range(&quot;A1&quot;).Value, &quot;,&quot;, &quot;&quot;), &quot;.&quot;, &quot;,&quot;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7953893, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "TempGuest", "link": "https://stackoverflow.com/users/7953893/tempguest"}, "edited": false, "score": 0, "creation_date": 1493758568, "post_id": 43745727, "comment_id": 74537230, "body": "Mad Physicist Thank-you for formatting. I should have mentioned that to make Decimal and Thousand separators to work, I insert in ThisWorkbook module the following: Private Sub Workbook_Open(),  tmpBool = Application.UseSystemSeparators, Application.UseSystemSeparators = False, End Sub; tmpBool can be set as Boolean in a Main Module, and then:   Private Sub Workbook_BeforeClose(Cancel As Boolean), Application.UseSystemSeparators = tmpBool, End Sub"}, {"owner": {"reputation": 1, "user_id": 7953893, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "TempGuest", "link": "https://stackoverflow.com/users/7953893/tempguest"}, "edited": false, "score": 0, "creation_date": 1493759208, "post_id": 43745727, "comment_id": 74537554, "body": "If you put UseSystemSeparators inside a single Sub, it will revert to its original state once the Sub closes, not allowing your Decimal and Thousand separators changes to stay active."}], "tags": [], "owner": {"reputation": 1, "user_id": 7953893, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "TempGuest", "link": "https://stackoverflow.com/users/7953893/tempguest"}, "is_accepted": false, "score": -1, "last_activity_date": 1493754938, "last_edit_date": 1493754938, "creation_date": 1493753098, "answer_id": 43745727, "question_id": 41258972, "link": "https://stackoverflow.com/questions/41258972/i-cannot-make-excel-vba-to-use-application-separator-in-windows-10-while-i-can-i/43745727#43745727", "title": "I cannot make excel vba to use application separator in windows 10 while I can in windows 7", "body": "<p>Perhaps this:</p>\n\n<pre><code>Set ws = ThisWorkbook.Worksheets(\"Name of Worksheet\")\nws.Cells.Replace What:=\"\", Replacement:=\"\", LookAt:=xlPart, _ SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True\nSet ws = Nothing\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7321496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63905f51763ac7fd622a0ad068e2e604?s=128&d=identicon&r=PG&f=1", "display_name": "codegenerator", "link": "https://stackoverflow.com/users/7321496/codegenerator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2399, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1493754938, "creation_date": 1482311586, "last_edit_date": 1482333833, "question_id": 41258972, "link": "https://stackoverflow.com/questions/41258972/i-cannot-make-excel-vba-to-use-application-separator-in-windows-10-while-i-can-i", "title": "I cannot make excel vba to use application separator in windows 10 while I can in windows 7", "body": "<p>I've been searching for two days to solve my issue but so far nothing.</p>\n\n<p>There are many (Very many) vba excel tools developed where I work and our regional settings in PC-s determine comma as decimal separator but reports and data downloaded from our systems have dot as decimal separator. In these tools, when needed we just have set <code>UseSystemSeparators = False</code> then <code>DecimalSeparators = \".\"</code> and at the end of the macro reverted back.</p>\n\n<p>Now new people have been getting windows 10 pcs and some of the tools run into errors. I got a Win10 pcs from IT to test and found out that no matter how I set in Excel settings VBA Macro uses PC regional settings while on the sheet it still uses what is determined in Excel settings. Same file, same test in my win7 pc and if set then both on sheet and vba macro use local application settings.</p>\n\n<p>Does anyone know what is the reason and how it could be fixed? I can figure many workarounds but all of these mean that the tools need to be re-coded and there are just so many of these that I still keep finding out new tools used and what were developed before I joined the company in March. Changing all ~300 PC-s regional setting is not an option because it needs to be comma as decimal separator normally.</p>\n\n<p>Edit: just to make it bit more clear I'll add some code:</p>\n\n<pre><code>Sub test()\n    Application.UseSystemSeparators = False\n    Application.DecimalSeparator = \".\"\n    variable = \"10.1\"\n    MsgBox CDbl(variable)\nEnd Sub\n</code></pre>\n\n<p>Under Windows 7 - no problem. The variable containing a string can be converted.\nUnder Windows 10 - Run-time error, Type mismatch. Both PCs have \",\" as system separator. The funny thing is that when I change \"10.1\" to \"10,1\" then that works on both PC-s. Settings for both PC-s are same. System uses \",\" as separator and Excel is set to use \".\".</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1482308018, "post_id": 41257799, "comment_id": 69716146, "body": "I included it in the question- <code>Unable to set the Visible property of the PivotItem class</code>"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "edited": false, "score": 0, "creation_date": 1482308383, "post_id": 41258080, "comment_id": 69716324, "body": "this keeps always bringing this message box !"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "edited": false, "score": 0, "creation_date": 1482308577, "post_id": 41258080, "comment_id": 69716412, "body": "I updated the code to break the loop when it hits the point where it can&#39;t set any more items to hidden."}, {"owner": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "edited": false, "score": 0, "creation_date": 1482309182, "post_id": 41258080, "comment_id": 69716765, "body": "using this can will break the code before it gets and show me the column I want"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "edited": false, "score": 0, "creation_date": 1482309341, "post_id": 41258080, "comment_id": 69716852, "body": "In your example picture that you posted is <code>1601A</code> in the column axis? The error is caused because if <code>1601A</code> is not present then you will try and hide <i>all</i> the items on that axis."}, {"owner": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "edited": false, "score": 0, "creation_date": 1482309530, "post_id": 41258080, "comment_id": 69716959, "body": "yes its there, if its not there, it won&#39;t even pass the  Case Is = &quot;1601A&quot;"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 7, "last_activity_date": 1482308551, "last_edit_date": 1482308551, "creation_date": 1482308200, "answer_id": 41258080, "question_id": 41257799, "link": "https://stackoverflow.com/questions/41257799/unable-to-set-the-visible-property-of-the-pivotitem-class-when-setting-pivotitem/41258080#41258080", "title": "Unable to set the Visible property of the PivotItem class when setting PivotItem.Visible = false", "body": "<p>You will get this error if you attempt to hide all the items on any axis (rows, columns, filters). You can trap this error in your code by comparing the <code>HiddenItems.Count</code> property of your <code>PivotField</code> object to the <code>PivotItems.Count</code> property of the same object and make sure you are not trying to remove the last item of the collection from view:</p>\n\n<p>So in your case statement, you can replace with update with something like:</p>\n\n<pre><code>Select Case pi.Name\n    Case Is = \"1601A\"\n        pi.Visible = True\n    Case Else\n        If pf.HiddenItems.Count &lt; (pf.PivotItems.Count - 1) Then\n            pi.Visible = False \n        Else\n            MsgBox \"Cannot hide all the items on this axis\"\n            Exit For '&lt;~~ break the loop to stop the MsgBox popping up\n        End If\nEnd Select\n</code></pre>\n\n<p>Note that whilst manipulating the pivot table Excel won't allow you to remove the last item from an axis - the OK button will become disabled:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QEm8a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QEm8a.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "is_accepted": false, "score": 0, "last_activity_date": 1482310217, "last_edit_date": 1482310217, "creation_date": 1482309015, "answer_id": 41258292, "question_id": 41257799, "link": "https://stackoverflow.com/questions/41257799/unable-to-set-the-visible-property-of-the-pivotitem-class-when-setting-pivotitem/41258292#41258292", "title": "Unable to set the Visible property of the PivotItem class when setting PivotItem.Visible = false", "body": "<p>I added  </p>\n\n<blockquote>\n  <p>On Error Resume Next </p>\n</blockquote>\n\n<p>before </p>\n\n<blockquote>\n  <p>pi.Visible = False 'error</p>\n</blockquote>\n\n<p>it works now !</p>\n"}], "owner": {"reputation": 111, "user_id": 7062926, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e37e4967447e1758594cd4bfaffc4e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sabir Moglad", "link": "https://stackoverflow.com/users/7062926/sabir-moglad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4819, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1482310217, "creation_date": 1482307112, "last_edit_date": 1482307688, "question_id": 41257799, "link": "https://stackoverflow.com/questions/41257799/unable-to-set-the-visible-property-of-the-pivotitem-class-when-setting-pivotitem", "title": "Unable to set the Visible property of the PivotItem class when setting PivotItem.Visible = false", "body": "<p>I want to make <code>PivotItem.Visible = False</code> but I keep getting an error:</p>\n\n<blockquote>\n  <p>Unable to set the Visible property of the PivotItem class</p>\n</blockquote>\n\n<p>I tried all the solutions I found in the internet but none seems to work </p>\n\n<pre><code>Sub FloorCompareSetter()\n\n    Dim pt As PivotTable\n    Dim pf As PivotField\n    Dim pi As PivotItem\n    Dim PivotSheet As Worksheet\n\n    Set PivotSheet = ThisWorkbook.Worksheets(\"PIVOT\")\n    PivotSheet.PivotTables(\"PivotTable5\").RefreshTable\n\n    Set pt = PivotSheet.PivotTables(\"PivotTable5\")\n    pt.PivotCache.MissingItemsLimit = xlMissingItemsNone\n\n    Set pf = pt.PivotFields(\"Period\")\n\n    For Each pi In _\n        pt.PivotFields(\"Period\").PivotItems\n        Select Case pi.Name\n            Case Is = \"1601A\"\n                pi.Visible = True\n            Case Else\n                pi.Visible = False 'error\n        End Select\n    Next pi\n\nEnd Sub\n</code></pre>\n\n<p>I tried refreshing the table and this line but still not working:</p>\n\n<blockquote>\n  <p>pt.PivotCache.MissingItemsLimit = xlMissingItemsNone</p>\n</blockquote>\n\n<p>Here is a picture of my pivot table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mNJ0X.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mNJ0X.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What am i doing wrong and how can I solve this problem ?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1482315003, "post_id": 41257449, "comment_id": 69720621, "body": "Different Access version, but this post may help: <a href=\"http://stackoverflow.com/questions/11467746/return-without-gosub-when-using-subforms-in-access\" title=\"return without gosub when using subforms in access\">stackoverflow.com/questions/11467746/&hellip;</a>"}, {"owner": {"reputation": 135, "user_id": 6517901, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f8d204f422f2e34e5775f1c855dd81b6?s=128&d=identicon&r=PG", "display_name": "udidosa", "link": "https://stackoverflow.com/users/6517901/udidosa"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1482338697, "post_id": 41257449, "comment_id": 69736459, "body": "I&#39;ve tried and tested that method, Darren but it does not help me. Please advise if there&#39;s any other solution thanks!"}], "owner": {"reputation": 135, "user_id": 6517901, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f8d204f422f2e34e5775f1c855dd81b6?s=128&d=identicon&r=PG", "display_name": "udidosa", "link": "https://stackoverflow.com/users/6517901/udidosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594640801, "creation_date": 1482305766, "last_edit_date": 1594640801, "question_id": 41257449, "link": "https://stackoverflow.com/questions/41257449/access-2013-recurring-error-return-without-gosub", "title": "Access 2013: Recurring error: Return without Gosub", "body": "<p>so I am building a database and I always keep getting a recurring error 'return without goSub'. It is very frustrating and I really want to get rid of it for once and for all.</p>\n\n<p>The error itself occurs on a form and where clicking a button would go to another form, this time it displays the error message. </p>\n\n<p>I usually 'fix' this issue by copying and pasting everything to a new database.</p>\n\n<p>This error has occured on the front end of a split database, hence I am worried the above solution would not work.</p>\n\n<p>Can anyone suggest how I can go about solving this?</p>\n\n<p>compiling also does not work.</p>\n\n<p>I don't know if it's a problem with the primary key or relationships.</p>\n\n<p>Please help, thanks!</p>\n"}, {"tags": ["excel", "excel-formula", "ms-office", "vba"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1482304083, "post_id": 41256663, "comment_id": 69714206, "body": "You can just use this formula to get the values in the cell and apply conditional formatting as per your conditions. <code>=SUMPRODUCT(($G$2:$G$26=COLUMN()-3)*($H$2:$H$26=ROW()-3)*$I$&zwnj;&#8203;2:$I$26)</code>"}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1482305636, "post_id": 41256663, "comment_id": 69714972, "body": "You can also use <b>Conditional Formatting</b> which is available without the need of any coding except if your function is complex, in which case you could also invoke it from this option."}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 4554380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/315b74a086b3f1bb222dc68f6de9d894?s=128&d=identicon&r=PG&f=1", "display_name": "Charlton", "link": "https://stackoverflow.com/users/4554380/charlton"}, "is_accepted": false, "score": 0, "last_activity_date": 1482304136, "creation_date": 1482304136, "answer_id": 41257028, "question_id": 41256663, "link": "https://stackoverflow.com/questions/41256663/how-to-color-the-cell-based-on-2d-coordinate-and-its-value-new-excel-function/41257028#41257028", "title": "How to color the cell based on 2D coordinate and its value? New Excel Function", "body": "<p>The approach I would take would be with a sub routine rather than a function. Then iterate down cols G:I with some thing like <code>while not isempty (.cells (intRow,7).value)</code>.\nOn each row you could then set the relevant cells colour property using cols G and H coordinates using offsets from the origin. You can flip the direction by multiplying it by -1 if necessary.\nYou could use a private function to return the colour from col I value using a select case.\nSorry, not near a computer to write the code but should be easy enough if you know VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 3423, "user_id": 2028195, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/oEI3F.jpg?s=128&g=1", "display_name": "jhyap", "link": "https://stackoverflow.com/users/2028195/jhyap"}, "edited": false, "score": 0, "creation_date": 1482330369, "post_id": 41257322, "comment_id": 69730800, "body": "Can explain the equation?"}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "reply_to_user": {"reputation": 3423, "user_id": 2028195, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/oEI3F.jpg?s=128&g=1", "display_name": "jhyap", "link": "https://stackoverflow.com/users/2028195/jhyap"}, "edited": false, "score": 0, "creation_date": 1482371020, "post_id": 41257322, "comment_id": 69750669, "body": "Added the explanation. You can actually go to Formulas tab -&gt; Formula Auditing -&gt; Evaluate Formula to see the calculations in action."}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 1, "last_activity_date": 1482370922, "last_edit_date": 1482370922, "creation_date": 1482305322, "answer_id": 41257322, "question_id": 41256663, "link": "https://stackoverflow.com/questions/41256663/how-to-color-the-cell-based-on-2d-coordinate-and-its-value-new-excel-function/41257322#41257322", "title": "How to color the cell based on 2D coordinate and its value? New Excel Function", "body": "<p>use the below formula to populate the cells</p>\n\n<pre><code>=SUMPRODUCT(($G$2:$G$26=COLUMN()-3)*($H$2:$H$26=-ROW()+3)*$I$2:$I$26)\n</code></pre>\n\n<p>Use conditional formatting to get the desired color in the cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uMcWO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uMcWO.png\" alt=\"Conditional Formatting\"></a></p>\n\n<p><strong>Formula Explanation as requested:</strong></p>\n\n<p><code>COLUMN()-3</code> and <code>-ROW()+3</code> give you the correct (X,Y) pair in each cell.</p>\n\n<p><code>($G$2:$G$26=COLUMN()-3)</code> checks each cell in the Range G2:G26 and compares to the X value output by COLUMN()-3. this will output and array of TRUE(Where the values match) and FALSE.</p>\n\n<p><code>($H$2:$H$26=-ROW()+3)</code> checks for the Y values.</p>\n\n<p>the product of the above two array will result in an array of 1's and 0's (which is equivalent to TRUE and FALSE). There will be only one 1 in this array as there is only one X,Y pair matching.</p>\n\n<p>This array multiplied( and summed ) by the Values array gives you the final value in the cell.</p>\n"}, {"tags": [], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "is_accepted": false, "score": 0, "last_activity_date": 1482329110, "creation_date": 1482329110, "answer_id": 41264650, "question_id": 41256663, "link": "https://stackoverflow.com/questions/41256663/how-to-color-the-cell-based-on-2d-coordinate-and-its-value-new-excel-function/41264650#41264650", "title": "How to color the cell based on 2D coordinate and its value? New Excel Function", "body": "<p>your problem like as Battleship, \nmy solution is:</p>\n\n<pre><code>Sub Battleship()\nDim cc As Range 'set center cell\nDim arrVal() As Variant\nDim lrw As Integer\nlrw = ActiveSheet().Range(\"G2\").End(xlDown).Row\narrVal = Range(\"G2:I\" &amp; lrw)\nSet cc = Range(\"C3\")\n\nFor i = 1 To UBound(arrVal())\n    cc.Offset(arrVal(i, 1), arrVal(i, 2)).Select\n        Selection.Value = arrVal(i, 3)\n    Select Case arrVal(i, 3)\n    Case 0 To 0.000004\n        Selection.Interior.Color = 5296274\n    Case 0.000004 To 0.0000099\n        Selection.Interior.Color = 15773696\n    Case Is &gt; 0.0000099\n        Selection.Interior.Color = 255\n    End Select\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3423, "user_id": 2028195, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/oEI3F.jpg?s=128&g=1", "display_name": "jhyap", "link": "https://stackoverflow.com/users/2028195/jhyap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1482370922, "creation_date": 1482302611, "last_edit_date": 1531161705, "question_id": 41256663, "link": "https://stackoverflow.com/questions/41256663/how-to-color-the-cell-based-on-2d-coordinate-and-its-value-new-excel-function", "title": "How to color the cell based on 2D coordinate and its value? New Excel Function", "body": "<p>I am new to Excel EVB, I am just a normal excel user but intend to do some pro stuff. I did some google, yet, I have no clue to start with.</p>\n\n<p>I am trying to create a new excel function that allow user to color the cell based on the X,Y coordinate and its value.</p>\n\n<p>Firstly, I have a predefined X,Y mapping (see below Colum A:E) and Cell C3 is my origin point (0,0). </p>\n\n<p>Secondly, I have a X,Y data table which contain value for each of the (X,Y) coordinate.</p>\n\n<p><a href=\"https://i.stack.imgur.com/si3X2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/si3X2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now, I want to color the X,Y map based on the data from the table with multiple condition.</p>\n\n<p>If Value >= 0 AND &lt;=4E-06, color cell (map) = green, cell value = Value</p>\n\n<p>If Value >4E-06 AND &lt;=9.9E-06, color cell (map) = blue, cell value = Value</p>\n\n<p>If Value >9.9E-6, color cell (map) = red, cell value = Value</p>\n\n<p>Eg.    From the table, if X=1, Y=2, Value = 2.2E-05, the cell D1 will be colored in red and the call value will set to 2.2E-05</p>\n\n<p><a href=\"https://i.stack.imgur.com/knskx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/knskx.png\" alt=\"enter image description here\"></a></p>\n\n<p>The final result will be look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pXrv9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pXrv9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Question: How can I create a new excel function based on the above requirement? Any idea and input?</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 991, "user_id": 2169868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jBVS2.png?s=128&g=1", "display_name": "mad_manny", "link": "https://stackoverflow.com/users/2169868/mad-manny"}, "edited": false, "score": 2, "creation_date": 1482302497, "post_id": 41256457, "comment_id": 69713420, "body": "What did you try?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1482302818, "post_id": 41256457, "comment_id": 69713583, "body": "Is there part of your code that isn&#39;t working?  If so, paste your code into the question, tell us where you are having the problem, and we can possibly assist.  But without any clues as to what your issue is, there would be a <b>very</b> small chance of us guessing an answer that would help."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1482302881, "post_id": 41256457, "comment_id": 69713613, "body": "In addition to showing what you&#39;ve tried, <i>how</i> are you trying to send an email? With Outlook? Gmail? Hotmail? Yahoo? Lotus Notes? ...please see <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 1, "last_activity_date": 1482311146, "creation_date": 1482311146, "answer_id": 41258865, "question_id": 41256457, "link": "https://stackoverflow.com/questions/41256457/excel-vba-compose-email-for-multiple-tos-ccs-and-bccs/41258865#41258865", "title": "Excel VBA compose email for multiple To&#39;s, CC&#39;s and BCC&#39;s", "body": "<p>Here is a macro which should do what you want, of course adapt it to suit your specific needs as the question was quite vague...</p>\n\n<p>See the comments for explanation.</p>\n\n<pre><code>Sub sendEmail()\n\n' Set up outlook objects for emailing\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n' Body text for the email\nDim strbody As String\nstrbody = \"This text in the body of your email\"\n\n' Strings to contain the email addresses\nDim sendTo As String\nsendTo = \"\"\nDim sendCC As String\nsendCC = \"\"\nDim sendBCC As String\nsendBCC = \"\"\n\n' The cell containing the email address (loop variable)\nDim emailCell As Range\n\nWith ActiveSheet\n\n    ' Cycle through email addresses, from B3 to one before next blank cell in column\n    For Each emailCell In .Range(\"B3\", .Range(\"B3\").End(xlDown))\n\n        ' Check each TRUE/FALSE column in same row, add email addresses accordingly\n\n        If .Cells(emailCell.Row, \"D\").Text = \"TRUE\" Then\n\n            sendTo = sendTo &amp; \"; \" &amp; emailCell.Text\n\n        End If\n\n        If .Cells(emailCell.Row, \"F\").Text = \"TRUE\" Then\n\n            sendCC = sendCC &amp; \"; \" &amp; emailCell.Text\n\n        End If\n\n        If .Cells(emailCell.Row, \"H\").Text = \"TRUE\" Then\n\n            sendBCC = sendBCC &amp; \"; \" &amp; emailCell.Text\n\n        End If\n\n    Next emailCell\n\nEnd With\n\n' Generate email in outlook objects defined above\nOn Error Resume Next\nWith OutMail\n    .To = sendTo\n    .CC = sendCC\n    .BCC = sendBCC\n    .Subject = \"Subject Message Here\"\n    .HTMLBody = strbody\n    .Display \n    ' If you don't want to display the email before sending it, \n    ' simply use .Send instead of .Display\nEnd With\nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5636, "favorite_count": 0, "accepted_answer_id": 41258865, "answer_count": 1, "score": 2, "last_activity_date": 1482311146, "creation_date": 1482301718, "last_edit_date": 1482302956, "question_id": 41256457, "link": "https://stackoverflow.com/questions/41256457/excel-vba-compose-email-for-multiple-tos-ccs-and-bccs", "title": "Excel VBA compose email for multiple To&#39;s, CC&#39;s and BCC&#39;s", "body": "<p>I am trying to create a single email that sends to multiple people.\nRight now I have email addresses in one column and checkboxes for \"Send To\", \"CC\" or \"BCC\" to the right.</p>\n\n<pre><code>Emails address: B3 - B13 (this list will expand, i may end up using lastrow)\n\n\"True/False\" To: D3- D13\n\n\"True/False\" CC: F3- F13\n\n\"True/False\" BCC: H3- H13\n\nSend if TRUE, skip if FALSE.\n</code></pre>\n\n<p>I'm sure this is simple &amp; around already but I have looked and I am stuck.</p>\n\n<p>Thanks for any replies.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 3, "last_activity_date": 1482299574, "creation_date": 1482299574, "answer_id": 41256028, "question_id": 41255796, "link": "https://stackoverflow.com/questions/41255796/countif-is-not-counting-previous-years/41256028#41256028", "title": "Countif is not counting previous years", "body": "<p>You should not enclose the <code>\"Date(...)\"</code> with double quotes. This makes Excel take them as litterals, not as a function to generate a date. Try this:</p>\n\n<pre><code>=COUNTIFS(B2:B9,\"N/A\",A2:A9,\"&gt;=\" &amp; Date(2015,1,1),A2:A9,\"&lt;=\" &amp; Date(2015,1,30))\n</code></pre>\n\n<p>Also, it might be useful to format your <code>A</code> column as <code>Date</code>, which I am almost sure you did.</p>\n"}], "owner": {"reputation": 21, "user_id": 6648033, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EsKB8PybHgk/AAAAAAAAAAI/AAAAAAAAAEA/iNCqWM2Ujw4/photo.jpg?sz=128", "display_name": "Waleed Tubaileh", "link": "https://stackoverflow.com/users/6648033/waleed-tubaileh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1482302582, "creation_date": 1482298368, "last_edit_date": 1482302582, "question_id": 41255796, "link": "https://stackoverflow.com/questions/41255796/countif-is-not-counting-previous-years", "title": "Countif is not counting previous years", "body": "<p>I'm a newbie in Excel.  I have a an excel table that looks something like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MLrcy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MLrcy.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I'm trying to do is use countIF to count the date range within January.  My function is something like this:</p>\n\n<pre><code>=COUNTIFS(B2:B9,\"N/A\",A2:A9,\"&gt;= \"&amp;\"Date(2015,1,1)\",A2:A9,\"&lt;= \"&amp;\"Date(2015,1,30)\")\n</code></pre>\n\n<p>For some reason I'm getting the value 0.  </p>\n\n<p>I'm planning on incorporating it into VBA soon but if the function isn't working on excel, most likely it won't work in vba either.  Can please someone help with this?</p>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 17034, "user_id": 858913, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b5015a60c08feee1d8116be3dd70878d?s=128&d=identicon&r=PG", "display_name": "eLRuLL", "link": "https://stackoverflow.com/users/858913/elrull"}, "is_accepted": false, "score": 0, "last_activity_date": 1482297907, "creation_date": 1482297907, "answer_id": 41255694, "question_id": 41255666, "link": "https://stackoverflow.com/questions/41255666/vba-scraping-with-same-class-name-but-different-innertext/41255694#41255694", "title": "VBA scraping with same class name but different innertext", "body": "<p>Just assign the respective index in your extract call:</p>\n\n<pre><code>' for second tag\nIE.Document.getElementsByClassName(\"table_bdtext_style\")(2).innerText\n\n' for third tag\nIE.Document.getElementsByClassName(\"table_bdtext_style\")(3).innerText\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7323991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ed32923b3f7795cb4516ce5d4eda02?s=128&d=identicon&r=PG&f=1", "display_name": "Keen Hooi", "link": "https://stackoverflow.com/users/7323991/keen-hooi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612133729, "creation_date": 1482297738, "last_edit_date": 1612133729, "question_id": 41255666, "link": "https://stackoverflow.com/questions/41255666/vba-scraping-with-same-class-name-but-different-innertext", "title": "VBA scraping with same class name but different innertext", "body": "<p>Scraping value on a website but turned out the value that I need shared the same class name as the others.</p>\n<p>HTML code</p>\n<pre><code>&lt;tr class=&quot;table_bdrow1_style&quot;&gt;\n            &lt;td&gt;&lt;/td&gt;\n            &lt;td style=&quot;text-align:center&quot; class=&quot;table_bdtext_style&quot;&gt;1.&lt;/td&gt;\n            &lt;td style=&quot;text-align:center&quot; class=&quot;table_bdtext_style&quot;&gt;\n            &lt;div id=&quot;a&quot;&gt;\n                  &quot;0.8948&quot;                \n              &lt;/div&gt;\n            &lt;/td&gt;\n            &lt;td style=&quot;text-align:center&quot; class=&quot;table_bdtext_style&quot;&gt;December 19, 2016&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n<p>I need the value of second line (0.8948) and third line - the date value (December 19, 2016) but the code I am using only shows me the first value (1).</p>\n<pre><code>extract1 = IE.Document.getElementsByClassName(&quot;table_bdtext_style&quot;)(1).innerText\nCells(4, &quot;A&quot;).Value = extract1\n</code></pre>\n<p>Not sure how can I extract the second and third but not the first value. Anyone can help? Thanks a lot!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "edited": false, "score": 0, "creation_date": 1482296983, "post_id": 41254832, "comment_id": 69711414, "body": "Did you set OnClose event on the hidden form?"}, {"owner": {"reputation": 3, "user_id": 2454565, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/129ea30fc76003bbaa2e9de22a2718d4?s=128&d=identicon&r=PG", "display_name": "user2454565", "link": "https://stackoverflow.com/users/2454565/user2454565"}, "reply_to_user": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "edited": false, "score": 0, "creation_date": 1482307871, "post_id": 41254832, "comment_id": 69716089, "body": "How do you set that event? Maybe this is what I am missing."}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 2454565, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/129ea30fc76003bbaa2e9de22a2718d4?s=128&d=identicon&r=PG", "display_name": "user2454565", "link": "https://stackoverflow.com/users/2454565/user2454565"}, "edited": false, "score": 0, "creation_date": 1482311982, "post_id": 41256878, "comment_id": 69718472, "body": "Then something else is going on. If the property sheet shows <i>[Event Procedure]</i> for these events they will be called."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1482303529, "creation_date": 1482303529, "answer_id": 41256878, "question_id": 41254832, "link": "https://stackoverflow.com/questions/41254832/execute-code-when-access-database-is-closed-using-form-close/41256878#41256878", "title": "Execute code when Access database is closed using form close", "body": "<p>It is not always the better event as the form doesn't exist anymore.</p>\n\n<p>Often it is better to run such stuff before closing the form, at the unload event:</p>\n\n<pre><code>Private Sub Form_Unload(Cancel As Integer)\n    'do your stuff here \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2454565, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/129ea30fc76003bbaa2e9de22a2718d4?s=128&d=identicon&r=PG", "display_name": "user2454565", "link": "https://stackoverflow.com/users/2454565/user2454565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482303529, "creation_date": 1482292468, "question_id": 41254832, "link": "https://stackoverflow.com/questions/41254832/execute-code-when-access-database-is-closed-using-form-close", "title": "Execute code when Access database is closed using form close", "body": "<p>My AutoExec macro executes code that opens a hidden form</p>\n\n<pre><code>DoCmd.OpenForm \"frmAppClose\", , , , , acHidden\n</code></pre>\n\n<p>Now I want to catch when that form is closed to execute some cleanup code. All the documentation (and yes, posts here) show using a Sub like this</p>\n\n<pre><code>Private Sub Form_Close()\n    'do your stuff here '\nEnd Sub\n</code></pre>\n\n<p>However, I cannot get this to work. The Form_Close() is never entered. Any suggestions? I do realize this question has been asked a few times here but there is something rudimentary I must be missing.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1482288160, "post_id": 41254246, "comment_id": 69709209, "body": "What error are you seeing?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482288954, "post_id": 41254246, "comment_id": 69709376, "body": "I think you are updating column C with the email addresses for the people&#39;s name in column B (where each cell in column B has multiple people, comma-delimited).  So you need to (1) update <code>Sheet2!C</code> for a single row when the value in <code>Sheet2!B</code> for that row has changed and (2) update <code>Sheet2!C:C</code> when any cell in <code>Email!B:C</code> changes.  Is that correct?  What was your <code>Worksheet_Change</code> event code that didn&#39;t work, and which worksheet was it in?"}, {"owner": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1482289174, "post_id": 41254246, "comment_id": 69709419, "body": "I got this error &quot;Compile Error: Procedure declaration does not match description of event or procedure having same name&quot; @dgorti"}, {"owner": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "edited": false, "score": 0, "creation_date": 1482289270, "post_id": 41254246, "comment_id": 69709442, "body": "This code works fine, but I just want to automate it. I just change getEmails() to Private Sub Worksheet_Change(ByRef Target As Range)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1482289614, "post_id": 41254246, "comment_id": 69709519, "body": "You need to place the <code>Worksheet_Change</code> sub into the <code>Sheet2</code> code module, did you?"}, {"owner": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482289968, "post_id": 41254246, "comment_id": 69709586, "body": "I put this code at the Sheet 2 module code @A.S.H"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "edited": false, "score": 0, "creation_date": 1482292631, "post_id": 41254529, "comment_id": 69710222, "body": "I have already change to Private Sub Worksheet_SelectionChange(ByVal Target As Range) and got no error, but I cannot update a cell, it hanged the workbook"}, {"owner": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "edited": false, "score": 0, "creation_date": 1482292987, "post_id": 41254529, "comment_id": 69710306, "body": "It worked but it made the sheet froze for a couple of minutes. Anyway thanks"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "edited": false, "score": 0, "creation_date": 1482293260, "post_id": 41254529, "comment_id": 69710356, "body": "@gpsrosak This is expected since you are making all the updates for a single change. Your sub has a lot of room for optimization and speedup. At least we made it work atm."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "edited": false, "score": 0, "creation_date": 1482294818, "post_id": 41254529, "comment_id": 69710740, "body": "@gpsrosak please try the modified code, it should be faster."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1482301328, "last_edit_date": 1482301328, "creation_date": 1482290131, "answer_id": 41254529, "question_id": 41254246, "link": "https://stackoverflow.com/questions/41254246/excel-automate-vba-without-have-to-run-everytime/41254529#41254529", "title": "Excel - Automate VBA without have to run everytime", "body": "<blockquote>\n  <p><code>Private Sub Worksheet_Change(ByRef Target As Range)</code> &lt;-- ByRef: error </p>\n</blockquote>\n\n<p>It should be:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)  '&lt;-- ByVal\n</code></pre>\n\n<p>This should be the prototype of the sub and it should be placed in Sheet2 code module (as you already did).</p>\n\n<p><strong>Addendum</strong></p>\n\n<p>Here's a refactored version of your sub, should be faster and more maintainable. It triggers the operation only if something has changed in column B, and acts only on that part that has changed, updating the neighboring cell in column C.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim B As Range: Set B = Range(\"B2:B\" &amp; Cells(Rows.count, \"B\").End(xlUp).Row)\n    Dim r As Range: Set r = Intersect(B, Target)\n    If r Is Nothing Then Exit Sub\n\n    Dim findRange As Range, selectedEmails As String, i\n\n    On Error GoTo Finish\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Dim names As Range: Set names = Sheets(\"Email\").Range(\"B1:C23\")  ' names range from lookup table from    different worksheet\n    Dim cel As Range\n    For Each cel In r\n       Dim splitNames : splitNames = Split(cel.value, \",\")\n       For Each i In splitNames\n           ' find the range matching the name\n           Set findRange = names.Find(What:=Trim(i), LookIn:=xlFormulas, _\n               LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n               MatchCase:=False, SearchFormat:=False)\n\n            ' if match found, get the email and store to selected emails variable\n            If Not findRange Is Nothing Then\n                If selectedEmails = \"\" Then ' first email of this row\n                    selectedEmails = findRange.Offset(0, 1).Value\n                Else  ' add a \";\" to separate email addresses\n                    selectedEmails = selectedEmails &amp; \"; \" &amp; findRange.Offset(0, 1).Value\n                End If\n            End If\n        Next i\n        cel.Offset(, 1).Value = selectedEmails\n        selectedEmails = \"\"\n    Next cel\n\nFinish:\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7351900"}, "is_accepted": false, "score": 0, "last_activity_date": 1483015116, "creation_date": 1483015116, "answer_id": 41379904, "question_id": 41254246, "link": "https://stackoverflow.com/questions/41254246/excel-automate-vba-without-have-to-run-everytime/41379904#41379904", "title": "Excel - Automate VBA without have to run everytime", "body": "<p>Make sure your Worksheet_Change event is behind the sheet you are working with and not in a Module.  Right-click the sheet and select View Code.  Put your code into the window that opens.</p>\n\n<p>Check this out.</p>\n\n<p><a href=\"http://www.excel-easy.com/vba/events.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba/events.html</a></p>\n"}], "owner": {"reputation": 107, "user_id": 4943727, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/MkAbk.jpg?s=128&g=1", "display_name": "gpsrosak", "link": "https://stackoverflow.com/users/4943727/gpsrosak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 41254529, "answer_count": 2, "score": 0, "last_activity_date": 1483015116, "creation_date": 1482287904, "question_id": 41254246, "link": "https://stackoverflow.com/questions/41254246/excel-automate-vba-without-have-to-run-everytime", "title": "Excel - Automate VBA without have to run everytime", "body": "<p>I would like to automate my VBA without have to run the VBA every time someone change the cell. I try to use Worksheet_Change(ByRef Target As Range) but I got compiler error. Below is my code without using worksheet_change event. This is a shared excel workbook so I need it to be automated every time someone fill a new cell or make change.</p>\n\n<pre><code> Option Explicit\n\n Public Sub getEmails()\n\n Dim names As Range, findRange As Range\n Dim splitNames\n Dim selectedEmails As String, i As Long, lRow As Long\n\n Set names = Sheets(\"Email\").Range(\"B1:C23\") ' names range from lookup table from    different worksheet\n\n\nWith Sheets(\"Sheet2\")\n' loop column K untill last row with data (staring from row 2 &gt;&gt; modify where you data starts)\nFor lRow = 2 To .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    ' fill array directly from cell\n    splitNames = Split(.Range(\"B\" &amp; lRow), \",\")\n\n    For i = 0 To UBound(splitNames)\n        ' find the range matching the name\n        Set findRange = names.Find(What:=Trim(splitNames(i)), LookIn:=xlFormulas, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False)\n\n        ' if match found, get the email and store to selected emails variable\n        If Not findRange Is Nothing Then\n            If selectedEmails = \"\" Then ' first email of this row\n                selectedEmails = findRange.Offset(0, 1).Value\n            Else  ' add a \";\" to separate email addresses\n                selectedEmails = selectedEmails &amp; \"; \" &amp; findRange.Offset(0, 1).Value\n            End If\n\n        End If\n    Next i\n\n    .Range(\"C\" &amp; lRow) = selectedEmails\n    ' clrear all variables and arrays for next cycle\n    Erase splitNames\n    selectedEmails = \"\"\nNext lRow\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7323533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dff66fa18107be89acb8e8b48b0c729?s=128&d=identicon&r=PG&f=1", "display_name": "Semayah", "link": "https://stackoverflow.com/users/7323533/semayah"}, "edited": false, "score": 0, "creation_date": 1482289963, "post_id": 41254263, "comment_id": 69709585, "body": "Hey nightcrawler, how can I write the out put to a different worksheet in the same workbook so I can preserve the original data? I tried the worksheet.Activate...."}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": true, "score": 1, "last_activity_date": 1482290411, "last_edit_date": 1482290411, "creation_date": 1482287991, "answer_id": 41254263, "question_id": 41254084, "link": "https://stackoverflow.com/questions/41254084/concatenate-multiple-cells-in-a-selection-into-a-single-string-cell-with-newline/41254263#41254263", "title": "Concatenate multiple cells in a selection into a single string cell with newline/carriage returns", "body": "<p>I edited your code with For loops (not For Each) and it kinda works for me. Try.</p>\n\n<pre><code>Sub concat_3()\n    Dim c As Range\n    Dim txt As String\n\n    Dim i As Integer\n    Dim j As Integer\n\n    Set c = Selection\n    txt = \"\"\n    For i = 1 To c.Rows.Count\n        For j = 1 To c.Columns.Count\n            txt = txt &amp; c(i, j).Value\n        Next j\n        txt = txt &amp; vbCrLf\n    Next i\n\n    txt = Left(txt, Len(txt) - 2)\n    'to output in Sheet1 A1\n    Sheets(\"Sheet1\").Range(\"A1\") = txt\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1482289323, "post_id": 41254335, "comment_id": 69709452, "body": "This will work for 2 column selections, not any number of columns. :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1482288572, "creation_date": 1482288572, "answer_id": 41254335, "question_id": 41254084, "link": "https://stackoverflow.com/questions/41254084/concatenate-multiple-cells-in-a-selection-into-a-single-string-cell-with-newline/41254335#41254335", "title": "Concatenate multiple cells in a selection into a single string cell with newline/carriage returns", "body": "<p>Here is another go:</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CJTOY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CJTOY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Some code:</p>\n\n<pre><code>Sub fhuscvc()\n    Dim s As String, i As Long, a As Range\n    i = 0\n    s = \"\"\n\n    For Each a In Selection\n        s = s &amp; \"    \" &amp; a.Value\n        i = i + 1\n        If i = 2 Then\n            i = 0\n            s = s &amp; vbCrLf\n        End If\n    Next a\n\n    Selection.Clear\n    Selection(1).Value = s\nEnd Sub\n</code></pre>\n\n<p>And after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/C7WWr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C7WWr.png\" alt=\"enter image description here\"></a></p>\n\n<p>The fixed block of spaces separating each pair of items is not pretty....too bad the <em>TAB</em> character does not work inside cells.</p>\n"}], "owner": {"reputation": 3, "user_id": 7323533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dff66fa18107be89acb8e8b48b0c729?s=128&d=identicon&r=PG&f=1", "display_name": "Semayah", "link": "https://stackoverflow.com/users/7323533/semayah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 41254263, "answer_count": 2, "score": 0, "last_activity_date": 1556416346, "creation_date": 1482286499, "last_edit_date": 1556416346, "question_id": 41254084, "link": "https://stackoverflow.com/questions/41254084/concatenate-multiple-cells-in-a-selection-into-a-single-string-cell-with-newline", "title": "Concatenate multiple cells in a selection into a single string cell with newline/carriage returns", "body": "<p>I need to concatenate multiple cells in a selection of multiple rows into a single string cell with newline/carriage returns</p>\n\n<p>e.g. Selection image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RAnHe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RAnHe.png\" alt=\"enter image description here\"></a></p>\n\n<p>After concatenation it should look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/t6i7U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t6i7U.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code does the concatenating into one cell but not adding the newline:</p>\n\n<pre><code>Sub concat_3()\n    Dim row As Range\n    Dim cell As Range\n    Dim txt As String\n\n    For Each row In Selection\n        For Each cell In row.Cells\n            txt = txt &amp; cell.Value\n        Next cell\n        txt = txt &amp; vbCrLf\n    Next row\n    Selection.ClearContents\n    txt = Left(txt, Len(txt) - 2)\n    Selection(1).Value = txt\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 2, "creation_date": 1482306955, "post_id": 41252906, "comment_id": 69715657, "body": "Perhaps you can rethink your question and do some re-write on it. There is no actual question just a presentation of your thoughts on a potential solution. You should also include your VLOOKUP formula that is only giving you the &#39;marginal results&#39;."}, {"owner": {"reputation": 35, "user_id": 5245713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082964631733460/picture?type=large", "display_name": "Frethy", "link": "https://stackoverflow.com/users/5245713/frethy"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1482345217, "post_id": 41252906, "comment_id": 69740085, "body": "@Robin Mackenzie sorry you are absolutely right. In an effort to fully explain what I was working on I failed to actually ask a question. I&#39;ve updated my original post."}], "owner": {"reputation": 35, "user_id": 5245713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1082964631733460/picture?type=large", "display_name": "Frethy", "link": "https://stackoverflow.com/users/5245713/frethy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482367173, "creation_date": 1482276810, "last_edit_date": 1495542288, "question_id": 41252906, "link": "https://stackoverflow.com/questions/41252906/vba-comparative-list-return-updated-values", "title": "VBA Comparative List Return Updated Values", "body": "<p>This sort of goes along with an older question I had that was answered at <a href=\"https://stackoverflow.com/questions/41070532/vba-check-row-for-value-then-another-value-and-paste-if-true\">VBA Check Row For Value Then Another Value and Paste If True</a>. I'm looking for something along a similar thread but on a larger scale. </p>\n\n<p>Working with parts and pricing sheets I have two constant sheets, MAIN and LIQUIDATION. These two sheets have a master list of item SKU's. You can see a screenshot below.\n<a href=\"https://i.stack.imgur.com/4C30h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4C30h.png\" alt=\"Master List Layout\"></a></p>\n\n<p>The LIQUIDATION sheet has an identical layout but has a different set of master SKU's. Then I have a \"working\" sheet, currently titled UPDATES that I'm using as a sort of landing pad for places that I'm pulling updates from. I'm manually formatting the UPDATES sheet depending on where I'm pulling it from and what information is on it. Sometimes I just need to update pricing so I'm copying in a dataset that would have just a list of SKU's with updated pricing. Other times I might be pulling in titles or descriptions. You can see my current dataset in the UPDATES sheet below.\n<a href=\"https://i.stack.imgur.com/B6wbI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B6wbI.png\" alt=\"Sample Update Data\"></a> </p>\n\n<p>This update data may or may not have the full list of SKU's. Sometimes it only has 4 parts that it needs to update. Other times it may have 100. And sometimes the datasets in general might be different as the descriptions for parts and links for images are housed in other locations from the pricing. </p>\n\n<p>What I would like to do is use the UPDATES sheet to update the two master lists. It should match up a SKU from the first column on the master sheets with a SKU from the first column on the dataset sheet and fill out the following columns based on the data that is in the dataset. So the two master sheets would be filled out with data from the dataset sheet and in the future the two master sheets would be updated with data from the dataset sheet.</p>\n\n<p>I've been able to achieve marginal results manually with a VLOOKUP function copied down but I also want to be able to include future changes to the master sheet list of SKU's (if a part gets added or subtracted or moved from MAIN to LIQUIDATION).</p>\n\n<p>EDIT: I've been playing with VLOOKUP in the form of <code>=VLOOKUP(\"01-1129-12\",UPDATES!$A$2:$A$999,2,FALSE)</code> and then just copying down/over and for every part on the list. </p>\n\n<p>What I know (or think I know) is that the data in the rows from the dataset sheet would need to enter into an array of information. Then the lists on the master sheets could be filled out with array data if a matching part number is found. The SKU would always be the primary key and the layout on the sheets would remain constant but the list of SKU's on the two master sheets could change and the amount of information in the dataset could change but will always have a list of SKU's to use as a selector. It is also possible that the dataset has blank items on a row in the case of only needing to update pricing or descriptions (cells that don't have new data will be blank and SKU's that have no updated information will be excluded from the dataset completely). </p>\n\n<p>EDIT: The question is, is there a way to do this programmatically with VBA and achieve the complete result of pulling data from all the respective cells on the UPDATES sheet into the appropriate rows/cells on the two master sheets? Or rather, I know that it CAN be done. I just don't know how or what direction I should be headed in. </p>\n\n<p>UPDATE: Okay so, I have roughly what I'm looking for without using VLOOKUP. I doubt this is the most efficient way and I'll have to keep adding to it to accommodate other sheets but it's working:</p>\n\n<pre><code>    Sub mainUpdater()\n    Dim SourceRow As Long\n    Dim DestRow As Long\n\n    ScreenUpdating = False\n\n    For DestRow = 2 To 650\n          For SourceRow = 2 To 650\n\n                If VBA.Trim(VBA.UCase(Sheets(\"MAIN\").Cells(DestRow, 1))) = VBA.Trim(VBA.UCase(Sheets(\"UPDATES\").Cells(SourceRow, 1))) Then\n                Sheets(\"MAIN\").Cells(DestRow, 2) = Sheets(\"UPDATES\").Cells(SourceRow, 2)\n                Sheets(\"MAIN\").Cells(DestRow, 3) = Sheets(\"UPDATES\").Cells(SourceRow, 3)\n                Sheets(\"MAIN\").Cells(DestRow, 4) = Sheets(\"UPDATES\").Cells(SourceRow, 4)\n                Sheets(\"MAIN\").Cells(DestRow, 5) = Sheets(\"UPDATES\").Cells(SourceRow, 5)\n                Sheets(\"MAIN\").Cells(DestRow, 6) = Sheets(\"UPDATES\").Cells(SourceRow, 6)\n                Sheets(\"MAIN\").Cells(DestRow, 7) = Sheets(\"UPDATES\").Cells(SourceRow, 7)\n                Sheets(\"MAIN\").Cells(DestRow, 8) = Sheets(\"UPDATES\").Cells(SourceRow, 8)\n                Sheets(\"MAIN\").Cells(DestRow, 9) = Sheets(\"UPDATES\").Cells(SourceRow, 9)\n                Sheets(\"MAIN\").Cells(DestRow, 10) = Sheets(\"UPDATES\").Cells(SourceRow, 10)\n                      GoTo NextDestRow\n                End If\n          Next SourceRow\n\n    NextDestRow:\n    Next DestRow\n\n    ScreenUpdating = True\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482276803, "post_id": 41252640, "comment_id": 69706390, "body": "Difficult to guess. It is not coming from this code. Maybe some other code is triggered (i.e. some <code>Worksheet_Change</code> event) that resets <code>A1</code>..."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482277370, "post_id": 41252640, "comment_id": 69706544, "body": "Anyway you should be surely better off if you avoid activate and select stuff and work directly with qualified ranges. Try it, chances are it might solve the issue."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482280460, "post_id": 41252640, "comment_id": 69707383, "body": "If you move <code>BackgroundCalc.Activate</code> prior to the start of the loop, your problem should go away.  But I have posted an answer which includes a refactored version of the code, which should be more robust."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1482280321, "last_edit_date": 1482280321, "creation_date": 1482278745, "answer_id": 41253192, "question_id": 41252640, "link": "https://stackoverflow.com/questions/41252640/excel-vba-deletes-first-cell-copied-into-a-sheet/41253192#41253192", "title": "Excel VBA deletes first cell copied into a sheet?", "body": "<p><strong>If <code>CallCalculate</code> is active when the macro starts</strong>, your first copied cell is being written to that sheet (overwriting anything that may have been in its cell A1 previously) rather than to the <code>BackgroundCalc</code> sheet.  Therefore cell A1 on <code>BackgroundCalc</code> will still be unchanged from before the macro ran (and that was probably blank).</p>\n\n<p>A refactored version of your code (which will fix the bug at the same time) would be:</p>\n\n<pre><code>Dim Countrows As Integer\nDim k As Integer\nDim serialid As String\nDim backgrounddate As Date\n\nCountrows = 0\n'find last row in spreadsheet,\nFor k = 2 To Lastrow\n    If Not IsEmpty(CallCalculate.Cells(k, \"H\")) Then\n        Countrows = Countrows + 1\n\n        serialid = CallCalculate.Cells(k, \"B\").Value\n        BackgroundCalc.Cells(Countrows, \"A\").Value = serialid\n\n        'add date\n        backgrounddate = CDate(CallCalculate.Cells(k, \"I\").Value)\n        BackgroundCalc.Cells(Countrows, \"B\").NumberFormat = CallCalculate.Cells(k, \"I\").NumberFormat\n        BackgroundCalc.Cells(Countrows, \"B\").Value = backgrounddate\n    End If\nNext k\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7323202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/456b76c79056a9224593e408c63ab38b?s=128&d=identicon&r=PG&f=1", "display_name": "Bio", "link": "https://stackoverflow.com/users/7323202/bio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482280321, "creation_date": 1482275289, "last_edit_date": 1482276666, "question_id": 41252640, "link": "https://stackoverflow.com/questions/41252640/excel-vba-deletes-first-cell-copied-into-a-sheet", "title": "Excel VBA deletes first cell copied into a sheet?", "body": "<p>I have some code that copies specific cells to another sheet, with each new record receiving a new line. It appears to copy everything correctly when it is processing, as I can see the correct cells being copied across to the new sheet, including A1. However, when it completes this the first cell in the new sheet (A1) is always empty. \nNot sure what's gone wrong here, would be great if anyone has any ideas/suggestions?</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>Dim Countrows As Integer\nDim k As Integer\nDim serialid As String\nDim NextRow As Range\nDim backgrounddate As Date\n\nCountrows = 0\n'find last row in spreadsheet,\nFor k = 2 To Lastrow\n    If IsEmpty(CallCalculate.Cells(k, 8)) = False Then\n\n        Set NextRow = Range(\"A\" &amp; Countrows + 1)\n        CallCalculate.Cells(k, 2).Copy\n\n        BackgroundCalc.Activate\n        NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n\n        serialid = CallCalculate.Cells(k, 2)\n\n        'add date\n        Set NextRow = Range(\"B\" &amp; Countrows + 1)\n        CallCalculate.Cells(k, 9).Copy\n\n        BackgroundCalc.Activate\n        NextRow.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Transpose:=False\n\n        backgrounddate = CallCalculate.Cells(k, 9)\n        Set NextRow = Nothing\n        Countrows = Countrows + 1\n\n    End If\nNext k\n</code></pre>\n"}, {"tags": ["excel", "vba", "mobile", "numbers", "zero"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482273904, "post_id": 41252384, "comment_id": 69705502, "body": "Add &#39; in front of it or change cell format to text."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1482274003, "post_id": 41252384, "comment_id": 69705522, "body": "have you tried the format function? Format(VALUE,&quot;0000000000&quot;)"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482274041, "post_id": 41252384, "comment_id": 69705537, "body": "You can play around with formatting so that it always shows that leading zero but I imagine as these are dialing digits you should treat as text anyways so that it preserves any leading 0&#39;s. So agreed with @cyboashu to prepend with quote or format as text."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482274440, "post_id": 41252384, "comment_id": 69705673, "body": "I also suggest that you refactor your code somehow, using some loops and arrays. This not only improves readability, it also helps avoid errors. Notice, for example, that in the line before the last line, you are overwriting on <code>G &amp; i</code> twice..."}, {"owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "edited": false, "score": 0, "creation_date": 1482275317, "post_id": 41252384, "comment_id": 69705949, "body": "Yes I know, I&#39;m trying to get the result of two ComboBox in one cell on excel, but it doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 6598547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-YFeiJv6Z4Vk/AAAAAAAAAAI/AAAAAAAEWGc/WtoyqOy8Uso/photo.jpg?sz=128", "display_name": "Kerry White", "link": "https://stackoverflow.com/users/6598547/kerry-white"}, "is_accepted": true, "score": 3, "last_activity_date": 1482274114, "creation_date": 1482274114, "answer_id": 41252435, "question_id": 41252384, "link": "https://stackoverflow.com/questions/41252384/vba-excel-show-the-zero-in-left-on-mobile-number/41252435#41252435", "title": "VBA Excel : Show the zero in left on mobile number", "body": "<p>You need to run a format on the cells like this: </p>\n\n<pre><code>Sheets(\"Reservations\").Range(\"I\" &amp; i).NumberFormat = \"00 00 00 00 00\" \n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 41252435, "answer_count": 1, "score": 0, "last_activity_date": 1482274114, "creation_date": 1482273777, "question_id": 41252384, "link": "https://stackoverflow.com/questions/41252384/vba-excel-show-the-zero-in-left-on-mobile-number", "title": "VBA Excel : Show the zero in left on mobile number", "body": "<p>I'm working on a project with VBA Excel, and I have a problem with mobile number.\nWhen I insert the mobile number for example : 0762....... on excel we can see just 762...... without zero on the left.\nHow can I do that ?</p>\n\n<p>This is a part of my script :</p>\n\n<pre><code> If MsgBox(\"Confirmez-vous l\u2019insertion de ce nouveau contact ?\", vbYesNo, \"Demande de confirmation d\u2019ajout\") = vbYes Then\n\n    i = WorksheetFunction.CountA(Range(\"A:A\")) + 1 'Pour placer le nouvel enregistrement \u00e0 la premi\u00e8re ligne de tableau non vide\n\n    MsgBox i\n\n    Sheets(\"Reservations\").Range(\"A\" &amp; i).Value = UserForm1.TextBox1.Value\n\n    Sheets(\"Reservations\").Range(\"B\" &amp; i).Value = UserForm1.TextBox2.Value\n\n    Sheets(\"Reservations\").Range(\"C\" &amp; i).Value = UserForm1.TextBox3.Value\n\n    Sheets(\"Reservations\").Range(\"D\" &amp; i).Value = UserForm1.TextBox4.Value\n\n    Sheets(\"Reservations\").Range(\"E\" &amp; i).Value = UserForm1.TextBox5.Value\n\n    Sheets(\"Reservations\").Range(\"H\" &amp; i).Value = UserForm1.TextBox8.Value\n\n    Sheets(\"Reservations\").Range(\"F\" &amp; i).Value = UserForm1.ComboBox4.Value\n\n    Sheets(\"Reservations\").Range(\"G\" &amp; i).Value = UserForm1.ComboBox1.Value\n\n    Sheets(\"Reservations\").Range(\"G\" &amp; i).Value = UserForm1.ComboBox2.Value\n\n    Sheets(\"Reservations\").Range(\"I\" &amp; i).Value = UserForm1.TextBox9.Value\n\n\n\n\nEnd If\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "batch-file", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 4, "creation_date": 1482275709, "post_id": 41252363, "comment_id": 69706068, "body": "See <code>cd &#47;?</code> for why it doesn&#39;t work. Your <code>cd</code> command isn&#39;t doing what you think it is."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "edited": false, "score": 0, "creation_date": 1482284840, "post_id": 41253782, "comment_id": 69708403, "body": "Awesome, thanks, this works with both local and network folders."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482286306, "post_id": 41253782, "comment_id": 69708754, "body": "Is that <code>&#47;d</code> switch relatively new?  (i.e. added some time in the last 10 years?)  I don&#39;t remember that ever being available when I was using DOS commands many years ago."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1482287386, "post_id": 41253782, "comment_id": 69709001, "body": "There are two Windows&#39; versions of CMD. NT4 and earlier and Windows 2000 and later. It was developed on OS/2. It was originally CP/M compatible, Microsoft added Unix features (concept of handles and redirection) in MSDos V2, IBM OS/2 made it work identical to MSDos but overloaded most of the commands with lots of extra features so it&#39;s a hodge podge. MS was very VAX/VMS orientated when it arrived on Windows but it&#39;s very close to IBM&#39;s version. In Help all references to new behaviour are referring to NT4 to Win 2000 not MSDos to CMD."}, {"owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "edited": false, "score": 0, "creation_date": 1495644594, "post_id": 41253782, "comment_id": 75345122, "body": "@user6017774 I am getting &quot;CMD does not support UNC path as current directories&quot; error if I use a network shared drive, is there any work arround for that? Thinking to use PUSHD command but quite not sure how to integrate with this."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "is_accepted": true, "score": 2, "last_activity_date": 1482287023, "last_edit_date": 1482287023, "creation_date": 1482283539, "answer_id": 41253782, "question_id": 41252363, "link": "https://stackoverflow.com/questions/41252363/running-a-batch-file-in-a-network-directory-using-vba/41253782#41253782", "title": "Running a batch file in a network directory using VBA", "body": "<pre><code>errorCode = wsh.Run(\"cmd.exe /k cd /d \"\"\" &amp; \"H:\\scripts\\\" &amp; \"\"\" &amp;&amp; DeleteMatrix.bat\", WindowStyle, waitOnReturn)\n</code></pre>\n\n<p>Look at the extra <code>/d</code>.</p>\n\n<p>In MSDos each drive had a current directory.</p>\n\n<pre><code>C:\\&gt;cd D:\\dog\nC:\\&gt;Copy *.* D:\n</code></pre>\n\n<p>would copy files into the d:\\dog directory. This makes typing easier. There were no mouses or menus.</p>\n\n<p>Windows only has the concept of current directory (and it's per program).</p>\n\n<p>So MSDos batch files run unchanged in CMD you have to tell windows you don't want MSDos behaviour with the CD command by using <code>/d</code>. </p>\n\n<p>Likewise CMD simulates a default drive per directory.</p>\n\n<p>This is what it looks like in the process's environment block</p>\n\n<pre><code>=C:=C:\\Users\\David Candy\\Desktop\\Editor\\EditorSdi\n=D:=d:\\~MSSETUP.T\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 0, "accepted_answer_id": 41253782, "answer_count": 1, "score": 1, "last_activity_date": 1482287023, "creation_date": 1482273661, "last_edit_date": 1531164843, "question_id": 41252363, "link": "https://stackoverflow.com/questions/41252363/running-a-batch-file-in-a-network-directory-using-vba", "title": "Running a batch file in a network directory using VBA", "body": "<p>I have a .bat file calling from VBA, it is working when I use a local folder as path (example as C:\\Users\\cthoud01\\Desktop\\my scripts\\scripts).</p>\n\n<p>However, I got an error if I use a path from a network directory (example - H:\\scripts). I also tried replacing the path as \"\"\"H:\\scripts\\\"\"\" but continue to get the same error. I would like to hear from our experts if there is any way around to make this work.</p>\n\n<p>Below is the error message I receive:\n<a href=\"https://i.stack.imgur.com/rTxko.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rTxko.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>VBA Code I am using:</p>\n\n<pre><code>Sub test()\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim WindowStyle As Integer: WindowStyle = 1\nDim errorCode As Long\n\n\nDim pth As String\nerrorCode = wsh.Run(\"cmd.exe /k cd \"\"\" &amp; \"H:\\scripts\\\" &amp; \"\"\" &amp;&amp; DeleteMatrix.bat\", WindowStyle, waitOnReturn)\n\nIf errorCode &lt;&gt; 0 Then\n    MsgBox \"fail, please retry\"\n    End\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482273556, "post_id": 41252266, "comment_id": 69705388, "body": "FWIW <code>Cells</code> is implicitly referring to the active sheet. And why are you setting it thrice to the same object reference? Also, if &quot;Version Control&quot; is a <code>Worksheet</code> (...really? version control in a worksheet?), you should be querying the <code>Worksheets</code> collection instead."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1482273752, "post_id": 41252266, "comment_id": 69705446, "body": "<i>failing on this line</i> please specify &quot;failing&quot; : runtime error? just not providing the desired result? etc.."}], "answers": [{"tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 1, "last_activity_date": 1482274939, "creation_date": 1482274939, "answer_id": 41252575, "question_id": 41252266, "link": "https://stackoverflow.com/questions/41252266/how-to-fully-qualify-a-range-to-copy-from-sheet1-and-paste-to-sheet2/41252575#41252575", "title": "How to fully qualify a range to copy from Sheet1 and paste to Sheet2?", "body": "<p>You really could condense the code down to stop repeating the same code. But , I left it the way you have done it to illustrate a different way of doing what I think you are trying to do.</p>\n\n<pre><code>Dim i As Long\nDim j As Long\nDim sht As Worksheet\nDim LastRow As Long\nDim rng As Range\nDim str As String\nDim rng As Range\n\n'\nSet sht = ThisWorkbook.Worksheets(\"Version Control\")\nLRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row + 1\n\n    'k = 1\n    Set rc = Sheets(\"Cobrand Tasklist\").UsedRange\n    For i = 1 To rc.Rows.Count\n        For j = 1 To rc.Columns.Count\n\n            If Cells(i, j).Interior.ColorIndex = 6 Then\n\n                    If j = 2 Then\n                    Cells(i, j).Value = \"Task #\" &amp; Cells(i, j).Value\n                    If Not rng Is Nothing Then Set rng = Union(rng, Cells(i, j)) Else Set rng = Cells(i, j)\n                    End If\n\n                    If j = 3 Then\n                    Cells(i, j).Value = \"Task Title \" &amp; Cells(i, j).Value\n                    If Not rng Is Nothing Then Set rng = Union(rng, Cells(i, j)) Else Set rng = Cells(i, j)\n                    End If\n\n                    If j = 17 Then\n                    Cells(i, j).Value = \"Task Description \" &amp; Cells(i, j).Value\n                    If Not rng Is Nothing Then Set rng = Union(rng, Cells(i, j)) Else Set rng = Cells(i, j)\n                    End If\n\n                LRow = LRow + 1\n            End If\n        Next\n    Next\n    rng.Copy Sheets(\"Version Control\").Cells(LRow, 4)\n</code></pre>\n\n<p>Doing the copy and paste on one line instead of every time inside the loop will speed up your code enormously.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482278893, "creation_date": 1482273100, "last_edit_date": 1531164843, "question_id": 41252266, "link": "https://stackoverflow.com/questions/41252266/how-to-fully-qualify-a-range-to-copy-from-sheet1-and-paste-to-sheet2", "title": "How to fully qualify a range to copy from Sheet1 and paste to Sheet2?", "body": "<p>I want to run a script to find cells highlighted yellow, on Sheet1 and if yellow, copy/paste to Sheet2.  The code below seems like it should work, but it's failing on this line.</p>\n\n<pre><code>rc.Copy rd\n</code></pre>\n\n<p>Basically, I would like to concatenate values in Columns 2, 3, and 17, on Sheet1, and copy/paste everything to Sheet2.  I'm guessing that I'm missing some kind of Worksheet reference, but I don't know for sure, and so far nothing has worked for me.  But...I think this is pretty close!!  Any help is appreciated!</p>\n\n<pre><code>Sub ColorCopier()\nDim i As Long\nDim j As Long\nDim sht As Worksheet\nDim LastRow As Long\nSet sht = ThisWorkbook.Worksheets(\"Version Control\")\nLRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row + 1\n\n    'k = 1\n    Set rc = Sheets(\"Cobrand Tasklist\").UsedRange\n    For i = 1 To rc.Rows.Count\n        For j = 1 To rc.Columns.Count\n\n            If Cells(i, j).Interior.ColorIndex = 6 Then\n\n                    If j = 2 Then\n                    Set rc = Cells(i, j)\n                    Set rd = Sheets(\"Version Control\").Cells(LRow, 4)\n                        rc = \"Task #\" &amp; rc\n                        rc.Copy rd\n                    End If\n\n                    If j = 3 Then\n                    Set rc = Cells(i, j)\n                    Set rd = Sheets(\"Version Control\").Cells(LRow, 4)\n                        rc = \"Task Title \" &amp; rc\n                        rc.Copy rd\n                    End If\n\n                    If j = 17 Then\n                    Set rc = Cells(i, j)\n                    Set rd = Sheets(\"Version Control\").Cells(LRow, 4)\n                        rc = \"Task Description \" &amp; rc\n                        rc.Copy rd\n                    End If\n\n                LRow = LRow + 1\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482273051, "post_id": 41252200, "comment_id": 69705188, "body": "might be missing the ` &#39; ` (single quotes) that should enclose text values?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "edited": false, "score": 0, "creation_date": 1482327066, "post_id": 41252349, "comment_id": 69728555, "body": "Thanks for the answer! I tried that but now am receiving: &quot;Compile Error: Argument not optional&quot;. I also tried using sqlstr instead of str, but that gave me my original error. VAR1 and VAR2 will always be text values."}, {"owner": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "edited": false, "score": 0, "creation_date": 1482330440, "post_id": 41252349, "comment_id": 69730848, "body": "Using the above as a guide and enclosing in quotes and using sqlstr = I&#39;m not getting the error: Run-time error&#39;-2147467259 (80004005)&#39; An INSERT INTO query cannot contain a muli-value field... I&#39;m relatively new to VBA, is this correct? Is there another way to insert a multi-value field into a table?"}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "edited": false, "score": 0, "creation_date": 1482332595, "post_id": 41252349, "comment_id": 69732331, "body": "@AaronPujanandez, what is the database you are using?"}, {"owner": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "edited": false, "score": 0, "creation_date": 1482341004, "post_id": 41252349, "comment_id": 69737727, "body": "Access 2013. With tables linked to SharePoint lists."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "edited": false, "score": 0, "creation_date": 1482359386, "post_id": 41252349, "comment_id": 69747432, "body": "@AaronPujanandez, try this , <code>Set dataRst = myconn.Execute(&quot;INSERT INTO [NEW TABLE] ([Variable 1], [Variable 2]) VALUES (&#39;&quot; &amp; VAR1 &amp; &quot;&#39;,&#39;&quot; &amp; VAR2 &amp; &quot;&#39;)&quot;)</code>"}, {"owner": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "edited": false, "score": 0, "creation_date": 1482415966, "post_id": 41252349, "comment_id": 69771909, "body": "Same error: An INSERT INTO query cannot contain a muli-value field... Thanks for the help! I&#39;m thinking I&#39;m going to have to rethink my approach."}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 0, "last_activity_date": 1482273574, "creation_date": 1482273574, "answer_id": 41252349, "question_id": 41252200, "link": "https://stackoverflow.com/questions/41252200/using-insert-into-with-multiple-value-lookup-field/41252349#41252349", "title": "Using INSERT INTO with multiple value lookup field", "body": "<p>If that is your exact code you need to do something like this,</p>\n\n<p>Also this is assuming that these two variables will always be a text value.</p>\n\n<pre><code>myEmail.To = VAR1\nmyEmail.CC = VAR2\nstr = \"INSERT INTO [NEW TABLE] ([Variable 1], [Variable 2])\" _\n         &amp; \" VALUES ('\" &amp; VAR1 &amp; \"','\" &amp; VAR2 &amp; \"')\"\n</code></pre>\n\n<p>Obviously, I have just added the <code>str</code> variable to demonstrate how the string for the insert statement needs to looks in VBA.</p>\n"}], "owner": {"reputation": 41, "user_id": 7323095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f080cbbd221aaa5681657f767837092b?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Pujanandez", "link": "https://stackoverflow.com/users/7323095/aaron-pujanandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482279184, "creation_date": 1482272689, "last_edit_date": 1482279184, "question_id": 41252200, "link": "https://stackoverflow.com/questions/41252200/using-insert-into-with-multiple-value-lookup-field", "title": "Using INSERT INTO with multiple value lookup field", "body": "<p>I have a macro that populates a form with a drop down list from an Access table and then asks users to select multiple items:</p>\n\n<p>Code:</p>\n\n<pre><code>  With myconn\n  .Open (\"DATABASE\")\n  End With\n\nSet dataRst = myconn.Execute(\"SELECT ID, Name FROM [TABLE IN DATABASE] ORDER BY Name;\") 'WHERE variable = '\" &amp; x &amp; \"';\")\n\nDo While Not dataRst.EOF\n\ncboVAR1.AddItem x, x\ncboVAR1.Column(0, x) = dataRst!Name\ncboVAR1.Column(1, x) = dataRst!ID\n\ncboVAR2.AddItem x, x\ncboVAR2.Column(0, x) = dataRst!Name\ncboVAR2.Column(1, x) = dataRst!ID\n\nx = x + 1\ndataRst.MoveNext\nLoop\n</code></pre>\n\n<p>The form I'm using looks like this:\n<img src=\"https://i.stack.imgur.com/rCES5.png\" alt=\"Form\"></p>\n\n<p>I then want to take these selections and add them to the an email:</p>\n\n<pre><code>Set myEmail = myOlApp.CreateItem(olMailItem)\nmyEmail.BodyFormat = olFormatHTML\n\nmyEmail.To = Var1\nmyEmail.CC = Var2\n</code></pre>\n\n<p>And then update a new row into a new table with:</p>\n\n<pre><code>INSERT INTO [NEW TABLE] ([Variable 1], [Variable 2])\nVALUES (VAR1, VAR2)\n</code></pre>\n\n<p>I'm able to populate the email, but whenever I try and update the NEW TABLE I get:</p>\n\n<p>Run-Time error '-2147217900 (80040e14)':</p>\n\n<p>Syntax error (missing operator) in query expression 'VAR1 value1; VAR1 value2;'.</p>\n\n<p>I've tried reading up on that error, but just can't figure out what I'm missing. Any help is appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482272244, "post_id": 41251695, "comment_id": 69704875, "body": "I tried your code up to the line which you say is crashing, and it worked.  I just had a formula of <code>=A2</code> in the cell being copied.  (Excel 2013 32-bit 16Gb RAM)"}, {"owner": {"reputation": 3055, "user_id": 1700747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2ee9e3311d4c44b4d5a56c864f11807c?s=128&d=identicon&r=PG", "display_name": "blue piranha", "link": "https://stackoverflow.com/users/1700747/blue-piranha"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482283956, "post_id": 41251695, "comment_id": 69708219, "body": "Could it be possible that&#39;s its failing because of sheer amount of data? The text file from which I imported this sheet is 560 MB. If that&#39;s the case, can you please some other way?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482284698, "post_id": 41251695, "comment_id": 69708365, "body": "You could try <code>Range(Cells(4, Dest), Cells(3 + iCustomer, Dest)).FormulaR1C1 = Cells(2, Dest).FormulaR1C1</code> - that <b>might</b> be less stressful on memory, but I&#39;m not sure."}], "answers": [{"comments": [{"owner": {"reputation": 3055, "user_id": 1700747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2ee9e3311d4c44b4d5a56c864f11807c?s=128&d=identicon&r=PG", "display_name": "blue piranha", "link": "https://stackoverflow.com/users/1700747/blue-piranha"}, "edited": false, "score": 0, "creation_date": 1482271542, "post_id": 41251786, "comment_id": 69704592, "body": "Hi, thank you for sending the modified code. Unfortunately, it pops up displaying Copy method of Range class  failed. Any other suggestions"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 3055, "user_id": 1700747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2ee9e3311d4c44b4d5a56c864f11807c?s=128&d=identicon&r=PG", "display_name": "blue piranha", "link": "https://stackoverflow.com/users/1700747/blue-piranha"}, "edited": false, "score": 0, "creation_date": 1482271823, "post_id": 41251786, "comment_id": 69704723, "body": "hmm works for me. not sure whats happening. Put this much code in a new rokbbok, rename a sheet as INPUT and test."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482272342, "post_id": 41251786, "comment_id": 69704921, "body": "Always better to use the <code>Worksheets</code> collection when retrieving <code>Worksheet</code> objects ;-) ...and <code>Sheets</code> is implicitly referring to the active workbook too, so it&#39;s just <i>semi-qualified</i> ;0)"}, {"owner": {"reputation": 3055, "user_id": 1700747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2ee9e3311d4c44b4d5a56c864f11807c?s=128&d=identicon&r=PG", "display_name": "blue piranha", "link": "https://stackoverflow.com/users/1700747/blue-piranha"}, "edited": false, "score": 0, "creation_date": 1482283971, "post_id": 41251786, "comment_id": 69708221, "body": "Could it be possible that&#39;s its failing because of sheer amount of data? The text file from which I imported this sheet is 560 MB. If that&#39;s the case, can you please some other way?"}, {"owner": {"reputation": 3055, "user_id": 1700747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2ee9e3311d4c44b4d5a56c864f11807c?s=128&d=identicon&r=PG", "display_name": "blue piranha", "link": "https://stackoverflow.com/users/1700747/blue-piranha"}, "edited": false, "score": 0, "creation_date": 1482331721, "post_id": 41251786, "comment_id": 69731736, "body": "@cyboashu In the task manager I noticed that excel is taking 1.8 GB. Since its the 32 bit version, I am guessing that it doesn&#39;t have sufficient memory to perform the paste operation. I think with a 64 bit version, it might just work. Thoughts?"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1482270545, "creation_date": 1482270545, "answer_id": 41251786, "question_id": 41251695, "link": "https://stackoverflow.com/questions/41251695/paste-method-of-worksheet-class-failed/41251786#41251786", "title": "Paste method of worksheet class failed", "body": "<p>Always better to use fully qualified names instead of <code>ActiveSheet</code>.</p>\n\n<p>Try this</p>\n\n<pre><code> Private Sub Copy_Formula(Dest As Integer, iCustomer As Long)\n  Sheets(\"INPUT\").Cells(2, Dest).Copy Sheets(\"INPUT\").Range(Cells(4, Dest), Cells(3 + iCustomer, Dest))\n  Application.CutCopyMode = False\n  Calculate\n\n  Sheets(\"INPUT\").Range(Cells(4, Dest), Cells(3 + iCustomer, Dest)).Copy\n\n  Sheets(\"INPUT\").Range(Cells(4, Dest), Cells(3 + iCustomer, Dest)).Cells(1, 1).PasteSpecial _\n                            Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n  Application.CutCopyMode = False\n End Sub\n</code></pre>\n\n<p>Also 32 or 64 bit, its all the same for this code.</p>\n"}], "owner": {"reputation": 3055, "user_id": 1700747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2ee9e3311d4c44b4d5a56c864f11807c?s=128&d=identicon&r=PG", "display_name": "blue piranha", "link": "https://stackoverflow.com/users/1700747/blue-piranha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2088, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482270545, "creation_date": 1482270118, "last_edit_date": 1531164843, "question_id": 41251695, "link": "https://stackoverflow.com/questions/41251695/paste-method-of-worksheet-class-failed", "title": "Paste method of worksheet class failed", "body": "<p>Please consider the following Excel VBA code</p>\n\n<pre><code> Private Sub Copy_Formula(Dest As Integer, iCustomer As Long)\n  Sheets(\"INPUT\").Select\n  Cells(2, Dest).Select\n  Selection.Copy\n  Range(Cells(4, Dest), Cells(3 + iCustomer, Dest)).Select\n  ActiveSheet.Paste '&lt;------ Errors out\n  Application.CutCopyMode = False\n  Calculate\n  Range(Cells(4, Dest), Cells(3 + iCustomer, Dest)).Select\n  Selection.Copy\n  Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n  Application.CutCopyMode = False\n End Sub\n</code></pre>\n\n<p>When this sub is called, value of Dest is 84 and iCustomer is 1044770.</p>\n\n<p>I was just wondering if there is a solution to solve this paste operation? Is it possible to increase the buffer size somewhere to accommodate this massive data? We are using 32 bit Excel 2010 on a 32 GB RAM machine with a 64 bit OS.</p>\n\n<p>Would a 64 bit Excel work?</p>\n"}, {"tags": ["mysql", "vba", "excel", "macros"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1482270796, "post_id": 41251654, "comment_id": 69704247, "body": "error message??"}, {"owner": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 0, "creation_date": 1482272025, "post_id": 41251654, "comment_id": 69704789, "body": "In MYSQL, the database admin can restrict users based on the domain name also. Does both workstation is in the same domain? Your DB administrator will be able to help you."}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "edited": false, "score": 1, "creation_date": 1482272819, "post_id": 41251654, "comment_id": 69705097, "body": "Run-time error &#39;-2147457259 (800004005)&#39;:"}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 0, "creation_date": 1482272891, "post_id": 41251654, "comment_id": 69705127, "body": "@Barney my username in the DB can be run from any domain without restrictions. I checked already"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1482273872, "post_id": 41251654, "comment_id": 69705493, "body": "Try disabling offline files as per: <a href=\"http://dailydoseofexcel.com/archives/2011/09/01/odbc-microsoft-access-driver-is-not-a-valid-path/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2011/09/01/&hellip;</a>"}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1482275645, "post_id": 41251654, "comment_id": 69706051, "body": "@nbayly Thanks. I already sent the link to my IT department. However, I would think the problem is related to the MySQL Versions installed. The error continue as follows: &quot;Sepecified driver could not be loaded due to system error 126: The specified module could not be found. (MySQL OBDC 5.3 ANSI Driver, C:\\Program Files (x86)\\MySQL\\\\Connector ODBC 5.3\\myodbc5a.dll)."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1482314760, "post_id": 41251654, "comment_id": 69720443, "body": "Every machine attempting this connection must have the <a href=\"https://dev.mysql.com/downloads/connector/odbc/\" rel=\"nofollow noreferrer\">MySQL ODBC Driver</a> installed beforehand. Choose appropriate one for OS and bit version."}], "answers": [{"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1482306742, "post_id": 41253210, "comment_id": 69715566, "body": "I corrected that in the question as I noticed it too. I think this may just be a typo in the question as OP already states that connection string works on Workstation A."}], "tags": [], "owner": {"reputation": 341, "user_id": 4447282, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5TYVP.png?s=128&g=1", "display_name": "Shadow Fiend", "link": "https://stackoverflow.com/users/4447282/shadow-fiend"}, "is_accepted": false, "score": 0, "last_activity_date": 1482278919, "last_edit_date": 1495539944, "creation_date": 1482278919, "answer_id": 41253210, "question_id": 41251654, "link": "https://stackoverflow.com/questions/41251654/cannot-connect-to-mysql-server-from-workstation-in-different-region/41253210#41253210", "title": "Cannot connect to MySQL Server from workstation in different region", "body": "<p>take a look at this part that i copied in your MySQL Code <code>Port=3306Database=db</code> you forgot to add <code>;</code> between them. I think this is the cause of error</p>\n\n<p>and also to add based on link here <a href=\"https://stackoverflow.com/questions/31153613/vba-run-time-error-2147467259-80004005\">VBA Run-time error &#39;-2147467259 (80004005)</a></p>\n\n<p>Is the reference installed is the correct 32bit or 64bit as needed?</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "is_accepted": false, "score": 0, "last_activity_date": 1482330755, "last_edit_date": 1495540799, "creation_date": 1482330755, "answer_id": 41265213, "question_id": 41251654, "link": "https://stackoverflow.com/questions/41251654/cannot-connect-to-mysql-server-from-workstation-in-different-region/41265213#41265213", "title": "Cannot connect to MySQL Server from workstation in different region", "body": "<p>Thank you guys. After a lot of communication between my IT manager and I, we agreed that the problem was in the versions used for MySQL, 32B vs 64B. Workstation B  has a 64B OS system but a 32B Office Package.</p>\n\n<p>My recommendation is to install both MySQL drivers, 32B &amp; 64B. That solved my problem.</p>\n\n<p>For more valuable info follow this post:\n<a href=\"https://stackoverflow.com/questions/29736522/excel-vba-mysql-ado-connection\">excel vba mysql ado connection</a></p>\n"}], "owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482330755, "creation_date": 1482269889, "last_edit_date": 1482306610, "question_id": 41251654, "link": "https://stackoverflow.com/questions/41251654/cannot-connect-to-mysql-server-from-workstation-in-different-region", "title": "Cannot connect to MySQL Server from workstation in different region", "body": "<p>I have a macro that pulls information from a MySQL server. This macro is accessed from different workstations in different regions. When I run it from my computer (Workstation A) it works perfectly. However, we setup new computers in other regions (Workstation B) and here is giving me a <strong>Connection String</strong> problem. </p>\n\n<p>Workstation B is set up the same way Workstation A was set up. Using same Windows version (64 bit) and same Excel version (32 bit). Both Workstations have MySQL driver installed and ODBC connector, but still Workstation B is having issues to connect.</p>\n\n<p>This is the MySQL Connection String I'm using:</p>\n\n<pre><code>Driver={MySQL ODBC 5.3 ANSI Driver};Server=server.name.com;Port=3306;Database=db;User=macro;Password=********;\n</code></pre>\n\n<p>And this is the moment when it launches the error:</p>\n\n<pre><code>Set oConn = CreateObject(\"ADODB.Connection\")\n\nOn Error GoTo Error_Handler1\noConn.Open strConn\nOn Error GoTo 0\n</code></pre>\n\n<p>The error I get is:</p>\n\n<blockquote>\n  <p>Run-time error '-2147457259 (800004005) Specified driver could not be loaded due to system error 126: The specified module could not be found. (MySQL OBDC 5.3 ANSI Driver, C:\\Program Files (x86)\\MySQL\\Connector ODBC 5.3\\myodbc5a.dll</p>\n</blockquote>\n\n<p>This is the same Connection String I'm using in Workstation A and it's working.</p>\n\n<p>However, I test my connection using these parameters from the ODBC Data Source Administrator and it works just fine. The connection is perfect. </p>\n\n<p>Do you guys know a reason why this could not be working for some computers under the same configuration and others not?</p>\n\n<p>I would highly appreciate any ideas people may have - thanks.</p>\n"}, {"tags": ["ms-access", "sdk", "vba", "adobe"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482269961, "post_id": 41251601, "comment_id": 69703869, "body": "What type is your <code>jso</code> variable declared as? Which type has the <code>ButtonLayout</code> property?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482269961, "post_id": 41251601, "comment_id": 69703870, "body": "What type is your <code>jso</code> variable declared as? Which type has the <code>ButtonLayout</code> property?"}, {"owner": {"reputation": 1, "user_id": 6166768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b677a40704370253f330fc45b755fa22?s=128&d=identicon&r=PG&f=1", "display_name": "Nick T", "link": "https://stackoverflow.com/users/6166768/nick-t"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482272439, "post_id": 41251601, "comment_id": 69704947, "body": "@ThunderFrame I didn&#39;t declare jso as a certain type, I just used Dim jso. The Field Type has the ButtonLayour property so jso.getField(), I think, returns a Field Type."}], "owner": {"reputation": 1, "user_id": 6166768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b677a40704370253f330fc45b755fa22?s=128&d=identicon&r=PG&f=1", "display_name": "Nick T", "link": "https://stackoverflow.com/users/6166768/nick-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482269622, "creation_date": 1482269622, "question_id": 41251601, "link": "https://stackoverflow.com/questions/41251601/why-when-using-the-adobe-dc-sdk-the-fields-buttonlayout-property-is-unavailable", "title": "Why when using the Adobe DC SDK the Field&#39;s ButtonLayout property is unavailable in VBA?", "body": "<p>My code is fairly standard, if people need to see more I can provide but essentially I am just trying to access a field's ButtonLayout property. I know the field I am accessing is a button, b/c I Added it previously in the code and I can review it once the file saves. </p>\n\n<p>The last line below is the one that doesn't work. I get the error \"Object doesn't support this property or method\". I am using MS Access 2016 with the Adobe Acrobat 10.0 Type Library. In contrast I can access the Value, and the BorderStyle properties and set them just fine.</p>\n\n<pre><code>Set pdDoc = avDoc.GetPDDoc()\nSet jso = pdDoc.GetJSObject\njso.getField(\"buttonImage1\")..BorderStyle = \"beveled\"\njso.getField(\"buttonImage1\").buttonImportIcon CStr(photoSet!Photo)\njso.getField(\"caption1\").Value = CStr(photoSet!Caption)\njso.getField(\"buttonImage1\").ButtonLayout = \"1\" 'This is the only line that doesn't work\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "ms-query"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482269038, "post_id": 41251280, "comment_id": 69703477, "body": "Can&#39;t you scrap the <code>QueryTable</code> and re-generate it every time?"}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 0, "creation_date": 1482270510, "post_id": 41251280, "comment_id": 69704111, "body": "<i>Microsoft SQL database</i> - which one are you referring to?? Microsoft <b>SQL Server</b> - the RDBMS system from Microsoft - or MS Access with SQL as its query language. Not quite clear - please add a relevant tag - either <code>sql-server</code> or <code>ms-access</code> to clarify"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1482274272, "post_id": 41251280, "comment_id": 69705615, "body": "The order of the fields in your query determines the order of the output table. Why don&#39;t you just change the query to output in the order that you want?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 0, "creation_date": 1482293401, "post_id": 41251280, "comment_id": 69710392, "body": "@marc_s -- I believe he&#39;s using MS Query inside of Excel.  I added that as a tag."}, {"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "reply_to_user": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 0, "creation_date": 1482326083, "post_id": 41251280, "comment_id": 69727890, "body": "@marc_s I mean Microsoft SQL Server. I have updated it in my post. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "edited": false, "score": 0, "creation_date": 1482414139, "post_id": 41254944, "comment_id": 69770715, "body": "It seems solutions must be pretty limited haha. I greatly appreciate your answer as this has helped me resolve my issue. I ended up doing &quot;SELECT top 0 NULL;&quot; then a refresh, before each official select call."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 1, "last_activity_date": 1482293331, "creation_date": 1482293331, "answer_id": 41254944, "question_id": 41251280, "link": "https://stackoverflow.com/questions/41251280/change-column-location-of-sql-statement-in-excel/41254944#41254944", "title": "Change Column location of SQL statement in Excel", "body": "<p>You may already know this, but since Excel allows you to move the columns in a table / ListObject around, it seeks to preserve any changes you make.  So, if you run a query:</p>\n\n<pre><code>select one, two, three\n</code></pre>\n\n<p>And then move the column \"three\" in front of \"one,\" when you re-run your query, it will keep them in that order in the ListObject, even though the query said otherwise.</p>\n\n<p>This also means if you add a column, no matter where you add it, it will go to the end when MS Query renders the output.</p>\n\n<pre><code>select four, one, two three\n</code></pre>\n\n<p>(\"four\" goes to the end in Excel, even though it was listed first in SQL)</p>\n\n<p>In your example, the column \"person\" was common across the two queries, so Excel (MS Query) would move it to the first position and put all other columns after that.</p>\n\n<p>When Excel deletes the old columns, it leaves a tracer behind -- you may notice the columns that follow your table aren't the normal size; they are the size of the fields that were deleted.  I call them \"ghosts.\"</p>\n\n<p>This is a serious hack, but the only way I know of to alleviate this problem is to run a bogus query (ie <code>select 1</code>), delete the ghosts -- remove the entire columns, and then run your second query.  Here is some ugly code I use in VBA to do this:</p>\n\n<pre><code>Dim lo As ListObject\nSet lo = Sheets(\"Sheet1\").ListObjects(\"Table_ExternalData_1\")\n\nRange(lo.HeaderRowRange.Offset(0, lo.HeaderRowRange.Columns.Count), _\n  Range(\"XFD1\")).EntireColumn.Delete\n</code></pre>\n\n<p>Yes, this deletes every column after the table, which means if there is useful data above or below the table in columns after the table, those are wiped out.</p>\n\n<p>Maybe there is a better way -- I'm curious to see if you get any other solutions.</p>\n"}], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 41254944, "answer_count": 1, "score": 1, "last_activity_date": 1482337782, "creation_date": 1482268074, "last_edit_date": 1482337782, "question_id": 41251280, "link": "https://stackoverflow.com/questions/41251280/change-column-location-of-sql-statement-in-excel", "title": "Change Column location of SQL statement in Excel", "body": "<p>Within excel I have connected my Microsoft SQL Server database to it, to display results. The system I have set in place is built off of a form. If a user chooses option 1, the query results will show:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>Select person, car, house from mytable1\n</code></pre>\n\n<p>If the user chooses option 2, the query result will show:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Select job, person, land, truck from mytable2\n</code></pre>\n\n<p>The very first select statement will give me a table in the column order in which I would like it. However, as a user uses the form again, it will re-query it to use which ever select statement is requested. When the re-query happens the column order which items are shown are in different areas. Even if the select statment is stated within the same order. Is there a way in which I could order the columns in a specific order?</p>\n\n<p>I've attempted to unchecked \"Preserve Column Sort\" within the Data Range Properties, but ends up leaving empty columns. I.E. : <code>Column1, Column2, Column3, etc.</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1482268527, "post_id": 41251251, "comment_id": 69703243, "body": "If there is anything useful in that external link, please include it in the question itself.  Most users won&#39;t follow links to potentially virus-infected files.  (Or, at least, they <b>shouldn&#39;t</b>.)  And links get broken, which make them useless for people searching for solutions in the future."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 1, "creation_date": 1482268611, "post_id": 41251251, "comment_id": 69703290, "body": "do you want to copy the value and the format of the cell, or do you want to copy cells having specific format?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1482268707, "post_id": 41251251, "comment_id": 69703332, "body": "What formats are not being transferred?  Copy should transfer almost all that are attached to those cells."}, {"owner": {"reputation": 35, "user_id": 7282657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ab8ab1d8fe1615dedbf5abf05b74314?s=128&d=identicon&r=PG&f=1", "display_name": "smurf", "link": "https://stackoverflow.com/users/7282657/smurf"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482269596, "post_id": 41251251, "comment_id": 69703730, "body": "I would like to copy the cells having a specific format and order. Thank you for your feedback @YowE3K I will edit the question"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7282657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ab8ab1d8fe1615dedbf5abf05b74314?s=128&d=identicon&r=PG&f=1", "display_name": "smurf", "link": "https://stackoverflow.com/users/7282657/smurf"}, "edited": false, "score": 0, "creation_date": 1484250928, "post_id": 41253350, "comment_id": 70445030, "body": "Hi @YowE3K your answer has also provided to be very useful! My apologies in the delay in getting back to you."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1482282060, "last_edit_date": 1482282060, "creation_date": 1482279999, "answer_id": 41253350, "question_id": 41251251, "link": "https://stackoverflow.com/questions/41251251/excel-vba-how-to-extract-specific-rows/41253350#41253350", "title": "Excel VBA-How to Extract Specific Rows", "body": "<p>The following change to your code should do it:</p>\n\n<pre><code>Sub CopyManager()\n    Dim r As Long\n    Dim j As Long\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n\n    ' Change worksheet designations as needed\n    Set Source = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Set Target = ActiveWorkbook.Worksheets(\"Sheet2\")\n\n    J = 1     ' Start copying to row 1 in target sheet\n    For r = 1 To 1000   ' Do 1000 rows\n        Select Case Left(Trim(Source.Cells(r, 1).Value), 4)\n            Case \"Mana\", _\n                 \"Make\", _\n                 \"Room\", _\n                 \"Name\", _\n                 \"Lapt\"\n                Source.Rows(r).Copy Target.Rows(j)\n                j = j + 1\n        End Select\n    Next\nEnd Sub\n</code></pre>\n\n<p>I use a <code>Select Case</code> statement to save having to write a slightly longer <code>If</code> statement, and I just look at the first 4 characters of column A so that it handles <code>Room x#</code> type cells.</p>\n\n<hr>\n\n<p>If you needed blank rows after most of the values (except for \"Room\"), I would suggest a slight rework of my code above:</p>\n\n<pre><code>Sub CopyManager()\n    Dim r As Long\n    Dim j As Long\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n\n    ' Change worksheet designations as needed\n    Set Source = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Set Target = ActiveWorkbook.Worksheets(\"Sheet2\")\n\n    J = 1     ' Start copying to row 1 in target sheet\n    For r = 1 To 1000   ' Do 1000 rows\n        Select Case Left(Trim(Source.Cells(r, 1).Value), 4)\n            Case \"Mana\", _\n                 \"Make\", _\n                 \"Name\", _\n                 \"Lapt\"\n                Source.Rows(r &amp; \":\" &amp; (j + 1)).Copy Target.Rows(j &amp; \":\" &amp; (j + 1))\n                'or, if the \"|\" in your example is just signifying a new column, use the simpler\n                Source.Rows(r).Copy Target.Rows(j)\n\n                j = j + 2\n            Case \"Room\"\n                Source.Rows(r).Copy Target.Rows(j)\n                j = j + 1\n        End Select\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1482831520, "post_id": 41258639, "comment_id": 69887256, "body": "@smurf, did you get through it?"}, {"owner": {"reputation": 35, "user_id": 7282657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ab8ab1d8fe1615dedbf5abf05b74314?s=128&d=identicon&r=PG&f=1", "display_name": "smurf", "link": "https://stackoverflow.com/users/7282657/smurf"}, "edited": false, "score": 0, "creation_date": 1483910744, "post_id": 41258639, "comment_id": 70281336, "body": "This is working very well thank you! Is there anyway I can change the code in order to have a few blank rows after each room?"}, {"owner": {"reputation": 35, "user_id": 7282657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ab8ab1d8fe1615dedbf5abf05b74314?s=128&d=identicon&r=PG&f=1", "display_name": "smurf", "link": "https://stackoverflow.com/users/7282657/smurf"}, "edited": false, "score": 0, "creation_date": 1484191140, "post_id": 41258639, "comment_id": 70411407, "body": "Hi @user3598756 what would be the best way to allow for spacing between each copied row?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 35, "user_id": 7282657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ab8ab1d8fe1615dedbf5abf05b74314?s=128&d=identicon&r=PG&f=1", "display_name": "smurf", "link": "https://stackoverflow.com/users/7282657/smurf"}, "edited": false, "score": 0, "creation_date": 1484200772, "post_id": 41258639, "comment_id": 70414126, "body": "You could loop backwards through pasted rows with step -2 and insert a row. Or you could use a &quot;helper&quot; column where to put row indexes (pasted rows: from 1 onwards stepping 2; as many rows below pasted ones: from 2 onwards stepping 2) and then sort by it"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1482310230, "creation_date": 1482310230, "answer_id": 41258639, "question_id": 41251251, "link": "https://stackoverflow.com/questions/41251251/excel-vba-how-to-extract-specific-rows/41258639#41258639", "title": "Excel VBA-How to Extract Specific Rows", "body": "<p>Provided your Source sheet has a first riw for headers, you could use AutoFilter() method to filter only relevant records and paste them in one shot:</p>\n\n<pre><code>Sub CopyManager()\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n    Dim valsArray As Variant\n\n    valsArray = Array(\"Room*\", \"Name\", \"Laptops\", \"Make\",\"Manager\") '&lt;--| define your values to be filtered on Source sheet column A\n    ' Change worksheet designations as needed\n    Set Source = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Set Target = ActiveWorkbook.Worksheets(\"Sheet2\")\n\n    With Source  '&lt;--| reference Source sheet\n        With .Range(\"A1:A1000\")  '&lt;--| reference its range from A1 to A1000\n            .AutoFilter Field:=1, Criteria1:= valsArray, Operator:=xlFilterValues  '&lt;--| filter referenced range on its first column with values stored in valsArray\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then '&lt;--| if any cell filtered other than \n                .Resize(.Rows.count - 1, 2).Offset(1).SpecialCells(xlCellTypeVisible).Copy Target.Range(\"A1\") '&lt;--|copy filtered cells skipping headers and paste in target sheet from cell A1\n            End If\n        End With\n        .AutoFilterMode= False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7282657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ab8ab1d8fe1615dedbf5abf05b74314?s=128&d=identicon&r=PG&f=1", "display_name": "smurf", "link": "https://stackoverflow.com/users/7282657/smurf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3761, "favorite_count": 0, "accepted_answer_id": 41258639, "answer_count": 2, "score": 0, "last_activity_date": 1482310230, "creation_date": 1482267928, "last_edit_date": 1482273758, "question_id": 41251251, "link": "https://stackoverflow.com/questions/41251251/excel-vba-how-to-extract-specific-rows", "title": "Excel VBA-How to Extract Specific Rows", "body": "<p>I have multiple \"Rooms\" in an excel spread sheet and would like to extract the Room, Name, Laptops, Make and Manager while excluding Faculty and Budget.</p>\n\n<pre><code>   Room 1#  |\n   Name     |   Office2\n            |\n   Laptops  |   22\n            |\n   Make     |   Mac\n            |\n   People   |   17\n            |\n   Faculty  |   Accounts\n            |\n   Manager  |   John\n            |\n   Budget   |  xxxxx\n            |\n   Room 2#  |\n            |\n   Name     |   Office3\n            |\n   Laptops  |   22\n            |\n   Make     |   HP\n            |\n   People   |   20\n            |\n   Faculty  |   Marketimg\n            |\n   Manager  |   Jeff\n            |\n   Budget   |  xxxxx\n</code></pre>\n\n<p>I am trying to extract all the data I require by modifying the following code but am having difficulty in getting the data in the same order as it is in the sample.</p>\n\n<pre><code>Sub CopyManager()\n    Dim c As Range\n    Dim j As Integer\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n\n    ' Change worksheet designations as needed\n    Set Source = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Set Target = ActiveWorkbook.Worksheets(\"Sheet2\")\n\n    J = 1     ' Start copying to row 1 in target sheet\n    For Each c In Source.Range(\"A1:A1000\")   ' Do 1000 rows\n        If c = \"Manager\" Then\n           Source.Rows(c.Row).Copy Target.Rows(j)\n           j = j + 1\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for your help.</p>\n"}, {"tags": ["forms", "vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1482264955, "post_id": 41250479, "comment_id": 69701394, "body": "have you tried actually debugging the code line-by-line to see <i>why</i> it spits out the results its does and then tried to fix it yourself? Or do you expect us to do that for you? If the latter, you may not receive much help. If the former, narrow down your question to what you cannot get to work and you will have more willing help."}, {"owner": {"reputation": 113, "user_id": 7322732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z2Zhq.jpg?s=128&g=1", "display_name": "ShannonC", "link": "https://stackoverflow.com/users/7322732/shannonc"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1482265086, "post_id": 41250479, "comment_id": 69701457, "body": "The code runs with no error messages...it just comes out wonky in the sheet. I&#39;ve tried going through it line by line myself and tweaking things and Googling possible solutions, but it&#39;s not coming out right. Is there another type of debugging I can do?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1482265518, "post_id": 41250479, "comment_id": 69701672, "body": "Try adding <code>i = i - 1</code> just after the line <code>Wend</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482265537, "post_id": 41250479, "comment_id": 69701678, "body": "You say &quot;Joe&#39;s races are black and Asian, at agency B; Joanne&#39;s is white, and she&#39;s at agency C&quot; - are you sure that isn&#39;t meant to be &quot;Joe&#39;s race is black, at agency B; Joanne&#39;s races are Asian and white, and she&#39;s at agency C&quot;?  Your code specifically places the names and agencies one row below the last race."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1482265701, "post_id": 41250479, "comment_id": 69701771, "body": "@ShannonC - Fair enough. Is one name entered at a time (on a click, I mean)?"}, {"owner": {"reputation": 113, "user_id": 7322732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z2Zhq.jpg?s=128&g=1", "display_name": "ShannonC", "link": "https://stackoverflow.com/users/7322732/shannonc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482284752, "post_id": 41250479, "comment_id": 69708382, "body": "@YowE3K, I think you&#39;re right--my apologies!"}, {"owner": {"reputation": 113, "user_id": 7322732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z2Zhq.jpg?s=128&g=1", "display_name": "ShannonC", "link": "https://stackoverflow.com/users/7322732/shannonc"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1482284766, "post_id": 41250479, "comment_id": 69708385, "body": "@ScottHoltzman, yes, on a command button click."}], "answers": [{"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1482269796, "post_id": 41250863, "comment_id": 69703805, "body": "Instead of looping through <code>arr</code> to concatenate the selected entries, you could do a Join: <code>sRace = Join(arr, &quot;, &quot;)</code>, or alternately concatenate it to begin with on your loop through ListBox2 so you don&#39;t have to repeat work."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1482333770, "post_id": 41250863, "comment_id": 69733138, "body": "just to throw some really tiny details 1) you can use <code>If .Selected(i) Then</code> 2) you can avoid <code>ReDim Preserve arr(j)</code> and loop <code>For i = LBound(arr) To j-1</code>"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1482266199, "creation_date": 1482266199, "answer_id": 41250863, "question_id": 41250479, "link": "https://stackoverflow.com/questions/41250479/vba-userform-in-excel-mismatched-rows-on-spreadsheet-data-entry/41250863#41250863", "title": "VBA UserForm in Excel--mismatched rows on spreadsheet data entry", "body": "<p>If I understand the code appropriately, the refactored <code>CommandButton1_Click</code> procedure below should produce the preferred result for you.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim j As Long\nDim i As Integer\n\n'load races into array\nWith ListBox2\n\n    ReDim arr(.ListCount - 1)\n\n    For i = 0 To .ListCount - 1\n\n        If .Selected(i) = True Then\n            .Selected(i) = False\n            arr(j) = .List(i)\n            j = j + i\n        End If\n\n    Next i\n\nEnd With\n\nReDim Preserve arr(j)\n\n'build \",\" separated string of races\nFor i = LBound(arr) To UBound(arr)\n\n    Dim sRace As String\n    sRace = sRace &amp; \",\" &amp; arr(i)\n\nNext\nsRace = Mid(sRace, 2) 'to remove first comma\n\n'place info on next available line in sheet.\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim lRow As Long\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1).Row\n\n    .Range(\"A\" &amp; lRow).Value = TextBox1.Value\n    .Range(\"B\" &amp; lRow).Value = sRace\n    .Range(\"C\" &amp; lRow).Value = ListBox1.Value\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7322732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z2Zhq.jpg?s=128&g=1", "display_name": "ShannonC", "link": "https://stackoverflow.com/users/7322732/shannonc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482266199, "creation_date": 1482264531, "question_id": 41250479, "link": "https://stackoverflow.com/questions/41250479/vba-userform-in-excel-mismatched-rows-on-spreadsheet-data-entry", "title": "VBA UserForm in Excel--mismatched rows on spreadsheet data entry", "body": "<p>I have a userform created via VBA that is supposed to populate rows on an Excel sheet. It does, but they're one off:</p>\n\n<pre><code>Name   |   Race   |   Agency\n           Black\nJoe        Asian      B\n           White\nJoanne                C\n</code></pre>\n\n<p>Joe's races are black and Asian, at agency B; Joanne's is white, and she's at agency C. Somehow, the entries are staggered.</p>\n\n<p>Name is a textbox, race and agency are listboxes, with race as a multiselect and agency as a single select.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim j As Long\nDim i As Integer\nWith ListBox2\nReDim arr(.ListCount - 1)\n    For i = 0 To .ListCount - 1\n        If .Selected(i) = True Then\n        .Selected(i) = False\n        arr(j) = .List(i)\n        j = j + i\n        End If\n    Next i\nEnd With\nReDim Preserve arr(j)\nWith ActiveSheet\n.Range(\"B\" &amp; .Rows.Count).End(xlUp). _\nOffset(1, 0).Resize(j + 1, 1).Value = Application.Transpose(arr)\nEnd With\ni = 1\nWhile ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B\" &amp; i).Value &lt;&gt; \"\"\ni = i + 1\nWend\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"A\" &amp; i).Value = TextBox1.Value\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"C\" &amp; i).Value = ListBox1.Value\nEnd Sub\nPrivate Sub CommandButton2_Click()\nDim ctl As MSForms.Control\nFor Each ctl In Me.Controls\n    Select Case TypeName(ctl)\n        Case \"TextBox\"\n            ctl.Text = \"\"\n        Case \"CheckBox\", \"OptionButton\", \"ToggleButton\"\n            ctl.Value = False\n        Case \"ComboBox\", \"ListBox\"\n            ctl.ListIndex = -1\n    End Select\nNext ctl\nEnd Sub\nSub UserForm_Initialize()\nListBox1.List = Array(\"A\", \"B\", \"C\")\nWith ListBox2\n  .Clear\n  .AddItem \"White\"\n  .AddItem \"Black\"\n  .AddItem \"Asian\"\n  .AddItem \"Am Indian/Al Native\"\n  .AddItem \"Native Hawaiian/Pac Islander\"\n  .AddItem \"Other\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I would love any ideas ya'll have on how to fix that! Ideally, it would come out in one of the following ways:</p>\n\n<pre><code>Name   |   Race   |   Agency\nJoe        Black      B\n           Asian      B\nJoanne     White      C\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Name   |   Race          |   Agency\nJoe        Black, Asian      B\nJoanne     White             C\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Name   |   Race   |   Agency\nJoe        Black      B\nJoe        Asian      B\nJoanne     White      C\n</code></pre>\n\n<p>(I prefer the second, but any would work.)</p>\n"}, {"tags": ["vba", "excel", "imacros"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482265192, "post_id": 41250473, "comment_id": 69701505, "body": "Can you manually add a reference and early bind to it?"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482267458, "post_id": 41250473, "comment_id": 69702712, "body": "@comintern..........can you give me an example of what you mean?  Thanks"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482271605, "post_id": 41250473, "comment_id": 69704621, "body": "64-bit OS, or 64-bit Office?  If you need to run any kind of &quot;legacy&quot; code then you should stay with 32-bit Office."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1482272275, "post_id": 41250473, "comment_id": 69704893, "body": "<a href=\"http://wiki.imacros.net/Web_Scripting\" rel=\"nofollow noreferrer\">Here would help</a> regarding the references topic (early binding) browse for the path where iMacros is"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482273027, "post_id": 41250473, "comment_id": 69705175, "body": "...to expand you can run 32-bit Office on a 64-bit operating system, and that&#39;s what MS recommends, unless you really need 64-bit Office for some specific reason.  If you need to work with older add-ins or libraries, then they may not be compatible with 64-bit Office."}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1482345219, "creation_date": 1482264492, "question_id": 41250473, "link": "https://stackoverflow.com/questions/41250473/cant-open-imacros-on-a-64-bit-machine", "title": "Can&#39;t open iMacros on a 64 bit machine", "body": "<p>I have a macro that works fine on 32 bit machines.  When trying to run it on a 64 bit machine, I get a error message (ActiveX component can't create object) when it hits this line of code:</p>\n\n<pre><code>Set iim1 = CreateObject(\"iMacros\")\n</code></pre>\n\n<p>Up until now, all of these macros have been run on 32 bit machines.  64 machines are just begging to appear in our environment.  Any ideas or suggestions on how to resolve this issue would be greatly appreciated.  Thanks for the help........</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482264975, "post_id": 41250261, "comment_id": 69701401, "body": "<i>[...] to reference columns in that table even if the table name changes</i> - wait, if the table name changes, won&#39;t <code>Range(&quot;tLedgerData&quot;)</code> refer to nothing?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482265352, "post_id": 41250261, "comment_id": 69701584, "body": "Can you add an example of exactly what you&#39;re <i>actually</i> trying to accomplish, i.e. exactly what do you mean with &quot;reference columns in that table&quot;?"}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 1, "creation_date": 1482265924, "post_id": 41250261, "comment_id": 69701905, "body": "run-time error &#39;1004&#39;, perhaps you wrote the range name incorrectly, or the activesheet don&#39;t contain the named range. try to correct the name of the range, or try to add the sheet name before Range(&quot;tLedgerData&quot;), or be sure that to activate the sheet wish contains the named range."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482284566, "post_id": 41250261, "comment_id": 69708343, "body": "To clarify, I was looking for a way to reference table columns to, for example, add a calculation or change the auto-filter settings, without having to constantly refer to the table and column by name, and possible have to change every reference if the table column name changed.  @Mat&#39;s Mug your suggestion to use the <code>ListObject</code> nailed it!"}], "answers": [{"comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1482266949, "post_id": 41250923, "comment_id": 69702412, "body": "I agree.  However, if you do want to continue by calling the table name do the following: <code>Dim mainTableRange As ListObject</code> and then <code>Set mainTableRange = Worksheets(&quot;Sheet1&quot;).ListObjects(&quot;tLedgerData&quot;)</code>"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1482284247, "post_id": 41250923, "comment_id": 69708274, "body": "The <code>listobject</code> was the way to go!  Thanks Mat!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1482266558, "creation_date": 1482266558, "answer_id": 41250923, "question_id": 41250261, "link": "https://stackoverflow.com/questions/41250261/how-do-i-get-the-name-of-a-table-from-a-range-variable/41250923#41250923", "title": "How do I get the name of a table from a range variable?", "body": "<p>I think you're having an X-Y problem here: solving problem X when the solution is for problem Y.</p>\n\n<blockquote>\n  <p><em>[...]  to reference columns in that table even if the table name changes</em></p>\n</blockquote>\n\n<p>Have the table / <code>ListObject</code> alone on its own dedicated worksheet, and give the sheet a <code>CodeName</code>. That way you can do this:</p>\n\n<pre><code>Dim tbl As ListObject\nSet tbl = LedgerDataSheet.ListObjects(1)\n</code></pre>\n\n<p>And now you have the almighty power of the <code>ListObject</code> API to do whatever it is that you want to do. For example, retrieve the column names:</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To tbl.ListColumns.Count\n    Debug.Print tbl.ListColumns(i).Name\nNext\n</code></pre>\n\n<p>In other words, you <em>don't</em> need to care for the name of the table. What you want is to work with its <code>ListObject</code>. And since you never need to refer to it by name, the table's name is utterly irrelevant and the user can change it on a whim, your code won't even notice.</p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 4466402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7139b7ab17ebd71a9387eb4a6fd1c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Kellner", "link": "https://stackoverflow.com/users/4466402/lucas-kellner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482269411, "creation_date": 1482269411, "answer_id": 41251557, "question_id": 41250261, "link": "https://stackoverflow.com/questions/41250261/how-do-i-get-the-name-of-a-table-from-a-range-variable/41251557#41251557", "title": "How do I get the name of a table from a range variable?", "body": "<p>I believe an Excel table and named-range are two different things which is why the .name.name doesn't work.  A table is a ListObject and once you set a range equal to a table you should be able to continue to call that range without an error.</p>\n\n<p>Curious, what is the reason why your table might change unexpectedly?</p>\n\n<p>I wrote out some lines of code to show a couple things.  You can create tables and reuse the range variables after the table name changes.  You can also set AlternativeText for the table with some identifying string and use that to locate a particular table if you suspect the table name may change.</p>\n\n<pre><code>Option Explicit\nPublic TestTable As Range\nSub CreateTable()\n    ActiveSheet.ListObjects.Add(xlSrcRange, [$A$1:$C$4], , xlYes).name = \"Table1\"\n    ActiveSheet.ListObjects(\"Table1\").AlternativeText = \"Table1\"\nEnd Sub\nSub SetTableRange()\n    Set TestTable = Range(\"Table1\")\nEnd Sub\nSub SelectTable()\n    TestTable.Select\nEnd Sub\nSub RenameTable()\n    ActiveSheet.ListObjects(\"Table1\").name = \"Table2\"\n    [A1].Select\nEnd Sub\nSub SelectRenamedTable()\n    TestTable.Select\nEnd Sub\nSub ClearSelection()\n    [A1].Select\nEnd Sub\nSub FindTable1()\n    Dim obje As ListObject\n    For Each obje In ActiveSheet.ListObjects\n        If obje.AlternativeText = \"Table1\" Then\n        MsgBox \"Found \" &amp; obje.AlternativeText &amp; \". Its current name is: \" &amp; obje.name\n        End If\n    Next obje\nEnd Sub\nSub ConvertTablesToRanges()\n    ' I found this snippet in a forum post on mrexcel.com by pgc01 and modified\n    Dim rList As Range\n    On Error Resume Next\n    With ActiveSheet.ListObjects(\"Table1\")\n        Set rList = .Range\n        .Unlist                           ' convert the table back to a range\n    End With\n    With ActiveSheet.ListObjects(\"Table2\")\n        Set rList = .Range\n        .Unlist                           ' convert the table back to a range\n    End With\n    On Error GoTo 0\n    With rList\n        .Interior.ColorIndex = xlColorIndexNone\n        .Font.ColorIndex = xlColorIndexAutomatic\n        .Borders.LineStyle = xlLineStyleNone\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "accepted_answer_id": 41250923, "answer_count": 2, "score": 1, "last_activity_date": 1482269411, "creation_date": 1482263671, "last_edit_date": 1531164843, "question_id": 41250261, "link": "https://stackoverflow.com/questions/41250261/how-do-i-get-the-name-of-a-table-from-a-range-variable", "title": "How do I get the name of a table from a range variable?", "body": "<p>I dimmed the variable:</p>\n\n<pre><code>Dim mainTableRange As Range\n</code></pre>\n\n<p>Then gave it a value:</p>\n\n<pre><code>Set mainTableRange = Range(\"tLedgerData\") ' tLedgerData is an Excel table.\n</code></pre>\n\n<p>Now I'm trying to get the name of the table (which is \"tLedgerData\") from the variable to reference columns in that table even if the table name changes.</p>\n\n<p>I tried </p>\n\n<pre><code>mainTableRange.Name\n</code></pre>\n\n<p>and</p>\n\n<pre><code>mainTableRange.Name.Name\n</code></pre>\n\n<p>(See <a href=\"https://stackoverflow.com/questions/3630496/how-do-you-get-a-range-to-return-its-name\" title=\"how do you get a range to return its name\">how do you get a range to return its name</a>.)  Both threw run-time error '1004':  Application defined or object-defined error.</p>\n\n<p><code>mainTableRange.Select</code> selected all table data excluding the header and total rows.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1482263647, "post_id": 41250058, "comment_id": 69700705, "body": "Don&#39;t have time to answer fully, but your <code>destRange</code> is always assigned as column B, at the very least you&#39;ll need to increment that using <code>Offset</code> method (or some other approach using a loop counter).  This way, each pass will go successively in column C, D, etc."}, {"owner": {"reputation": 11, "user_id": 7322650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2bc48c725997c60bad356730f630d0?s=128&d=identicon&r=PG&f=1", "display_name": "Will Dub&#233;", "link": "https://stackoverflow.com/users/7322650/will-dub%c3%a9"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482263748, "post_id": 41250058, "comment_id": 69700771, "body": "Ok that helps. Where/how would I add that?"}], "owner": {"reputation": 11, "user_id": 7322650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2bc48c725997c60bad356730f630d0?s=128&d=identicon&r=PG&f=1", "display_name": "Will Dub&#233;", "link": "https://stackoverflow.com/users/7322650/will-dub%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487966208, "creation_date": 1482262854, "last_edit_date": 1487966208, "question_id": 41250058, "link": "https://stackoverflow.com/questions/41250058/output-data-from-multiple-sources-into-separate-rows", "title": "Output data from multiple sources into separate rows", "body": "<p>I am pulling data from multiple Excel files within a folder. It outputs all in one column. I wish to make each Excel file data-set its own column and transpose it into rows. How can I accomplish this within a sub?</p>\n\n<p>My thought is that it has something to do with that last if statement (with comments 'set the destrange' and 'we copy the values from the sourceRange to the destrange.' </p>\n\n<pre><code>Sub MergeAllWorkbooks()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, FNum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n    Dim FirstCell As String\n\n'FIND FOLDER *MAKE SURE TO ADD SLASH AT THE END\nMyPath = \"C:\\Users\\dube\\Desktop\\Test for Lease Comps\\\"\n\n'IF THERE ARE NO EXCEL FILES\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n'PULLING DATA FROM EXCEL FILES AND ADDING TO ARRAY\nFNum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve MyFiles(1 To FNum)\n    MyFiles(FNum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n\n'Change ScreenUpdating, Calculation and EnableEvents\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n'Add a new workbook with one sheet\nSet BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\nrnum = 1\n\n'Loop through all files in the array(myFiles)\nIf FNum &gt; 0 Then\n    For FNum = LBound(MyFiles) To UBound(MyFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n        On Error GoTo 0\n\n        If Not mybook Is Nothing Then\n\n            On Error Resume Next\n\n            With mybook.Worksheets(1)\n                Set sourceRange = .Range(\"C6:C32\")\n            End With\n\n            If Err.Number &gt; 0 Then\n                Err.Clear\n                Set sourceRange = Nothing\n            Else\n                'if SourceRange use all columns then skip this file\n                If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                    Set sourceRange = Nothing\n                End If\n            End If\n            On Error GoTo 0\n\n            If Not sourceRange Is Nothing Then\n\n                SourceRcount = sourceRange.Rows.Count\n\n                If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                    MsgBox \"Sorry there are not enough rows in the sheet\"\n                    BaseWks.Columns.AutoFit\n                    mybook.Close savechanges:=False\n                    GoTo ExitTheSub\n                Else\n\n                    'Set the destrange\n                    Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                    'we copy the values from the sourceRange to the destrange\n                    With sourceRange\n                        Set destrange = destrange. _\n                                        Resize(.Rows.Count, .Columns.Count)\n                    End With\n                    destrange.Value = sourceRange.Value\n\n                    rnum = rnum + SourceRcount\n\n                End If\n\n            End If                \n\n            mybook.Close savechanges:=False\n\n        End If\n\n    Next FNum\n    BaseWks.Columns.AutoFit\nEnd If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "jagged-arrays"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1482262953, "post_id": 41250034, "comment_id": 69700321, "body": "If it is jagged, the best approach might be to loop through the rows, assigning each row to a range in a single statement."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1482263455, "post_id": 41250034, "comment_id": 69700590, "body": "are you <i>doing</i> anything with <code>matrix</code> other than using it as an interim storage for the values? If not, the <code>ReDim Preserve</code> statement is almost certainly more expensive than simply dumping each row to the <code>wsSA</code> within your loop."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482264124, "post_id": 41250034, "comment_id": 69700963, "body": "How do you want the output to look when it is returned?  Are you wanting the first numeric item in each source column to be placed in row 3 of the destination, or do you want each row of source information returned as a row in the destination (but with leading non-numeric cells set to blank)?  Perhaps update your question to include a screen dump of your source data and your expected output."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482265772, "post_id": 41250034, "comment_id": 69701807, "body": "Based on that sample output, you really are better moving the writing of the output inside the loop and getting rid of <code>matrix</code>.  Is there a reason why you don&#39;t want to write it in the loop?"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1482266740, "creation_date": 1482266740, "answer_id": 41250962, "question_id": 41250034, "link": "https://stackoverflow.com/questions/41250034/vba-jagged-array-to-range/41250962#41250962", "title": "VBA Jagged Array to Range", "body": "<p>If you are you willing to forget the requirement that the output should not be written inside a loop, the following code would probably do what you are trying to do:</p>\n\n<pre><code>Sub MyMatrix()\n\n    Dim wb1 As Workbook\n    Set wb1 = ActiveWorkbook\n\n    Dim wsNSA As Worksheet\n    Set wsNSA = wb1.Worksheets(\"NSA\")\n\n    Dim wsSA As Worksheet\n    Set wsSA = wb1.Worksheets(\"SA\")\n\n    Dim c As Long\n    Dim LC As Long\n    Dim LR As Long\n    Dim num_linha As Long\n    Dim nsa As Variant\n\n    With wsNSA\n        'LR is the Last row and LC is the last column with data\n        '???? Is data1_linha declared anywhere and assigned a value? ????\n        LR = .Cells(data1_linha, 1).End(xlDown).Row\n        LC = .Cells(LR, 1).End(xlToRight).Column\n\n        'Loops through columns and finds the row where numeric data begins\n        For c = 2 To LC\n            nsa = .Range(.Cells(1, c), .Cells(LR, c))\n            num_linha = Application.Match(True, Application.Index(Application.IsNumber(nsa), 0), 0)\n            wsSA.Cells(3, c).Resize(LR - num_linha + 1, 1).Value = .Range(.Cells(num_linha, c), .Cells(LR, c)).Value\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1482266865, "creation_date": 1482266865, "answer_id": 41250993, "question_id": 41250034, "link": "https://stackoverflow.com/questions/41250034/vba-jagged-array-to-range/41250993#41250993", "title": "VBA Jagged Array to Range", "body": "<p>You can just copy all and delete the blank cells after:</p>\n\n<pre><code>Sheet1.Range(\"A3\").CurrentRegion.Copy Destination:= Sheet2.Range(\"A3\")\n\nSheet2.Range(\"A3\").CurrentRegion.SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n</code></pre>\n"}], "owner": {"reputation": 991, "user_id": 4300334, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/11efc6b94e12efa079e0b3c6cdbe2f8b?s=128&d=identicon&r=PG&f=1", "display_name": "MBBertolucci", "link": "https://stackoverflow.com/users/4300334/mbbertolucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484510180, "creation_date": 1482262733, "last_edit_date": 1531164843, "question_id": 41250034, "link": "https://stackoverflow.com/questions/41250034/vba-jagged-array-to-range", "title": "VBA Jagged Array to Range", "body": "<p>My macro goes through a range, looping by columns, finds where the numeric data starts in each column and stores the ranges in a jagged array (the \"matrix\" variant in the code).</p>\n\n<p>After that, I would like to return the entire matrix to a range in another worksheet. If I try to assign \"matrix(1)\" to the range where I want it to be put, it works fine, but if I try to assign the entire \"matrix\" to a range, I get blank cells.</p>\n\n<p>How could I return all of the values in \"matrix\" to a range at once, without using loops?</p>\n\n<p>This is the source data, through which the code loops:\n<a href=\"https://i.stack.imgur.com/vyg7C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vyg7C.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like that all of the rows of \"matrix\" would be returned as this:\n<a href=\"https://i.stack.imgur.com/HY5oy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HY5oy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my code:</p>\n\n<pre><code>       Sub MyMatrix()\n\n        Dim wb1 As Workbook\n        Set wb1 = ActiveWorkbook\n\n        Dim wsNSA As Worksheet\n        Set wsNSA = wb1.Worksheets(\"NSA\")\n\n        Dim wsSA As Worksheet\n        Set wsSA = wb1.Worksheets(\"SA\")\n\n        Dim col As Range\n\n        Dim matrix() As Variant\n\n\n        'LR is the Last row and LC is the last column with data\n        LR = wsNSA.Cells(1, 1).End(xlDown).Row\n        LC = wsNSA.Cells(LR, 1).End(xlToRight).Column\n\n        'Loops through columns and finds the row where numeric data begins\n        For Each col In wsNSA.Range(wsNSA.Cells(1, 2), wsNSA.Cells(LR, LC)).Columns\n        wsNSA.Activate\n        nsa = wsNSA.Range(wsNSA.Cells(1, col.Column), wsNSA.Cells(LR, col.Column))\n\n        num_linha = Application.Match(True, Application.Index(Application.IsNumber(nsa), 0), 0)\n        nsa = wsNSA.Range(wsNSA.Cells(num_linha, col.Column), wsNSA.Cells(LR, col.Column))\n\n    'The range starts in the column B in the worksheet, so the matrix ubound is 'col.column -1\n        ReDim Preserve matrix(1 To col.Column - 1)\n         matrix(col.Column - 1) = nsa\n\n        Next\n\n        wsSA.Range(wsSA.Cells(3, 2), wsSA.Cells(LR, LC)) = matrix\n\n\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1482264699, "post_id": 41249890, "comment_id": 69701267, "body": "What have you tried so far? What has worked, or hasn&#39;t worked? Do you want a formula, or VBA (or either?)"}, {"owner": {"reputation": 23, "user_id": 7322609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7635f340fc97e2b720025382197b2b7d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCross", "link": "https://stackoverflow.com/users/7322609/chriscross"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482266853, "post_id": 41249890, "comment_id": 69702367, "body": "So I have tried several different things. Copy &amp; paste special transpose. Does not automtically move the rows down and just erases the existing data unless manually moved down. Its a significant number of rows 800+ with up to 20 duplicate values. I also tried using Kutools for excel to transpose the range. I also used an index range formula to try and change the data. VBA or a formula is fine as long as it works and you can tell me how and why it works. Thanks in advance for your help."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7322609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7635f340fc97e2b720025382197b2b7d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCross", "link": "https://stackoverflow.com/users/7322609/chriscross"}, "edited": false, "score": 0, "creation_date": 1482421182, "post_id": 41268148, "comment_id": 69775441, "body": "You sir, are a gentleman and a scholar. Your praises will be sung in the halls of my children for generations to come. I cannot thank you enough. I do have one additional question. Can you run this on a spreadsheet that has more than three main columns as long as the last one is the one I wanted stacked?"}, {"owner": {"reputation": 16, "user_id": 7322032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3ksH.jpg?s=128&g=1", "display_name": "NewandForgiven", "link": "https://stackoverflow.com/users/7322032/newandforgiven"}, "reply_to_user": {"reputation": 23, "user_id": 7322609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7635f340fc97e2b720025382197b2b7d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCross", "link": "https://stackoverflow.com/users/7322609/chriscross"}, "edited": false, "score": 0, "creation_date": 1482424126, "post_id": 41268148, "comment_id": 69777521, "body": "It should work for any number of values and/or duplicates (although it will take longer the more it has to do). The only limiter will be if the duplicate columns in the first table have gaps in them. If they do, then the gaps will appear in the second table (but going down). If that doesn&#39;t answer your question, a diagram may help my limited mind understand."}], "tags": [], "owner": {"reputation": 16, "user_id": 7322032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o3ksH.jpg?s=128&g=1", "display_name": "NewandForgiven", "link": "https://stackoverflow.com/users/7322032/newandforgiven"}, "is_accepted": true, "score": 0, "last_activity_date": 1482339830, "creation_date": 1482339830, "answer_id": 41268148, "question_id": 41249890, "link": "https://stackoverflow.com/questions/41249890/how-can-i-convert-multiple-columns-to-a-single-row-and-keep-it-in-line-with-my-o/41268148#41268148", "title": "How can I convert multiple columns to a single row and keep it in line with my other data", "body": "<p>I trust this VBA code will meet your needs. It essentially does what a human would do manually, using B2 as a reference point for the first table. If your first tables top left cell isn't B2 then you will need to change all references to B2. By default the new table will appear 2 rows below the first. This could be changed changing the 'offset(j, 0)'. (e.g. offset(j+1, 2) would put the second table 3 down and 2 to the right).</p>\n\n<p>Also note, the area beneath the first table will need to be blank or the new table will appear under whatever is there.</p>\n\n<pre><code>Sub Very_special_transpose()\n\n'Calculates number of values\nDim Value1 As Integer 'row number of value 1\nDim LastValue As Integer 'row number of last value\nDim i As Integer 'number of values\nDim j As Integer\n\nRange(\"B2\").Offset(1, 0).Select\nValue1 = ActiveCell.Row\n\nRange(\"B2\").End(xlDown).Select\nLastValue = ActiveCell.Row\n\ni = LastValue - Value1 + 1\n\n'puts in headers under first table\nRange(\"B1048576\").End(xlUp).Offset(2, 0).Select\nActiveCell.FormulaR1C1 = \"Value\"\nActiveCell.Offset(0, 1).FormulaR1C1 = \"Reference value\"\nActiveCell.Offset(0, 2).FormulaR1C1 = \"Duplicates\"\n\n'Repeats copying process for each value\n\nFor j = 1 To i\n\nRange(\"B2:C2\").Offset(j, 0).Copy\nRange(\"D1048576\").End(xlUp).Offset(1, -2).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=False\nRange(\"B2\").Offset(j, 2).Select\nRange(ActiveCell, ActiveCell.End(xlToRight)).Copy\nRange(\"D1048576\").End(xlUp).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 4470901, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/17ac097036242d45d1da0598271fba8f?s=128&d=identicon&r=PG&f=1", "display_name": "snigdha", "link": "https://stackoverflow.com/users/4470901/snigdha"}, "is_accepted": false, "score": 0, "last_activity_date": 1541061219, "creation_date": 1541061219, "answer_id": 53097631, "question_id": 41249890, "link": "https://stackoverflow.com/questions/41249890/how-can-i-convert-multiple-columns-to-a-single-row-and-keep-it-in-line-with-my-o/53097631#53097631", "title": "How can I convert multiple columns to a single row and keep it in line with my other data", "body": "<p>You could also do this without a VBA code.\nJust use goto insert-> pivot tables.\nThen select design option in the tool bar above and select Report layout!! \nYou can select any of the layouts you wish.</p>\n"}], "owner": {"reputation": 23, "user_id": 7322609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7635f340fc97e2b720025382197b2b7d?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisCross", "link": "https://stackoverflow.com/users/7322609/chriscross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "accepted_answer_id": 41268148, "answer_count": 2, "score": 1, "last_activity_date": 1541061219, "creation_date": 1482262205, "last_edit_date": 1531161705, "question_id": 41249890, "link": "https://stackoverflow.com/questions/41249890/how-can-i-convert-multiple-columns-to-a-single-row-and-keep-it-in-line-with-my-o", "title": "How can I convert multiple columns to a single row and keep it in line with my other data", "body": "<p>I have a set of data which lists out duplicates for an initial value (column A) I want to take the columns of data that reference the value in the cell in the corresponding row and transpose them.</p>\n\n<p>Problem is there are multiple columns and the number of columns varies by the number of duplicates to the original value. So when I transpose I need it to essentially insert blank rows so all of the column data corresponds to the correct cell. Here is a screenshot with an:</p>\n\n<p><img src=\"https://i.stack.imgur.com/7Mib8.png\" alt=\"example\"></p>\n"}, {"tags": ["sql-server", "ms-access", "stored-procedures", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1482269969, "post_id": 41249658, "comment_id": 69703874, "body": "Where is loadAllocation being called from? What is <code>Me</code> in this context? Is frmTeamDashboardWorkstate a sub-form? Are you intending this recordset to be held open across the network for all the time that the form is open? If not then you should use a &#39;disconnected&#39; recordset. Use <code>rst.CursorLocation = adUseClient</code> before setting it (probably need to <code>Dim</code> it as <code>New ADODB.Recordset</code> to do this)."}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1482270119, "post_id": 41249658, "comment_id": 69703933, "body": "Side note: you should <b>not</b> use the <code>sp_</code> prefix for your stored procedures. Microsoft has <a href=\"http://msdn.microsoft.com/en-us/library/ms190669%28v=sql.105%29.aspx\" rel=\"nofollow noreferrer\">reserved that prefix for its own use (see <i>Naming Stored Procedures</i>)</a>, and you do run the risk of a name clash sometime in the future. <a href=\"http://www.sqlperformance.com/2012/10/t-sql-queries/sp_prefix\" rel=\"nofollow noreferrer\">It&#39;s also bad for your stored procedure performance</a>. It&#39;s best to just simply avoid <code>sp_</code> and use something else as a prefix - or no prefix at all!"}, {"owner": {"reputation": 43, "user_id": 5620517, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EVLph.jpg?s=128&g=1", "display_name": "Shallo", "link": "https://stackoverflow.com/users/5620517/shallo"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1482277101, "post_id": 41249658, "comment_id": 69706480, "body": "@Skippy Thank you for your response. Below are the clarifications..."}, {"owner": {"reputation": 43, "user_id": 5620517, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EVLph.jpg?s=128&g=1", "display_name": "Shallo", "link": "https://stackoverflow.com/users/5620517/shallo"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1482277622, "post_id": 41249658, "comment_id": 69706608, "body": "@Skippy Where is loadAllocation being called from?**from a OnChange Event Combo Box (ManagerID)** What is Me in this context? <b>Parent Form of frmTeamDashboardWorkstate</b>    Is frmTeamDashboardWorkstate a sub-form? <b>Yes</b> Are you intending this recordset to be held open across the network for all the time that the form is open? If not then you should use a &#39;disconnected&#39; recordset. <b>Not Sure but Only need to display data</b> Use rst.CursorLocation = adUseClient before setting it (probably need to Dim it as New ADODB.Recordset to do this).**Still No Luck**"}, {"owner": {"reputation": 43, "user_id": 5620517, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EVLph.jpg?s=128&g=1", "display_name": "Shallo", "link": "https://stackoverflow.com/users/5620517/shallo"}, "reply_to_user": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 0, "creation_date": 1482277749, "post_id": 41249658, "comment_id": 69706647, "body": "@marc_s Thank you for your suggestion and I shall make a quick CTRL + H thing as soon as i&#39;m done with this issue..."}], "answers": [{"tags": [], "owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "is_accepted": false, "score": 0, "last_activity_date": 1482358116, "creation_date": 1482358116, "answer_id": 41272743, "question_id": 41249658, "link": "https://stackoverflow.com/questions/41249658/stored-procedure-not-returning-recordset/41272743#41272743", "title": "Stored procedure not returning recordset", "body": "<p>OK, what I think you need to do is...</p>\n\n<p>Firstly, is your <code>Public Sub loadAllocation()</code> in a separate module or is it in the parent form's module? I would recommend having it as a <code>Private Sub</code> within the parent form's module.</p>\n\n<p>Secondly you need to declare rst as a module level variable in the parent form's module. It needs to stay in scope after <code>loadAllocation()</code> has run. So right at the top of the module, before any Sub or Function definitions, and just after the <code>Option Compare Database</code> and <code>Option Explicit</code>, add in</p>\n\n<pre><code>Private rst As ADODB.Recordset\n</code></pre>\n\n<p>Then I would re-code your procedure as</p>\n\n<pre><code>Private Sub loadAllocation()\nOn Error GoTo PROC_ERR\n\n    Dim objSS As New clsSQLServer\n\n    Set rst = New ADODB.Recordset\n    rst.CursorLocation = adUseClient\n    Set rst = objSS.getSPRecordset(Me.dtmReportDate, Me.managerID)\n    'You could put some Debug.Print statements in here just to check that rst has retrieved some data'\n    If rst.State = adStateOpen Then\n        Set Me.frmTeamDashboardWorkstate.Form.Recordset = rst\n        frmTeamDashboardWorkstate.Form.Requery\n        rst.ActiveConnection = Nothing\n    End If\n\nPROC_EXIT:\n    'Put any clean-up code in here'\n    Exit Sub\n\nPROC_ERR:\n    'Put your preferred error handling code in here'\n    Resume PROC_EXIT\n\nEnd Sub\n</code></pre>\n\n<p>Make sure to clean up and <code>Set rst = Nothing</code> as you close the parent form (in the Form_Unload event).</p>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": false, "score": 0, "last_activity_date": 1482871981, "creation_date": 1482871981, "answer_id": 41352089, "question_id": 41249658, "link": "https://stackoverflow.com/questions/41249658/stored-procedure-not-returning-recordset/41352089#41352089", "title": "Stored procedure not returning recordset", "body": "<p>Are you using 32 bit or 64 bit Access? If you are using 32 bit, then the bigint is 64 bit and 32 bit access cant handle it.</p>\n"}], "owner": {"reputation": 43, "user_id": 5620517, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EVLph.jpg?s=128&g=1", "display_name": "Shallo", "link": "https://stackoverflow.com/users/5620517/shallo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594640777, "creation_date": 1482261390, "last_edit_date": 1594640777, "question_id": 41249658, "link": "https://stackoverflow.com/questions/41249658/stored-procedure-not-returning-recordset", "title": "Stored procedure not returning recordset", "body": "<p>I'm stuck with the below. I have a stored procedure which takes a date and Manager ID as parameters to generate a Resultset </p>\n\n<pre><code>CREATE PROCEDURE[ACT].[sp_getAllocations]\n    @dtmReportDate DATE,\n    @ManagerID BIGINT,\n    @type nvarchar(MAX) OUTPUT\nAS\nBEGIN\n    SELECT \n        ARCVTADMIN.tblEmployee.strFirstName + ' ' + ARCVTADMIN.tblEmployee.strSurname AS Name, \n        COUNT(ACT.tblActivity.employeeID) AS Workstate, \n        SUM(CASE WHEN ACT.tblactivity.statusTypeID = 4 AND ACT.tblActivity.dtmCompletedDate = @dtmReportDate THEN 1 ELSE 0 END) AS Completed, \n        SUM(CASE WHEN ACT.tblActivity.statusReasonID = 1 THEN 1 ELSE 0 END) AS NewLeads, \n        SUM(CASE WHEN ACT.tblContact.dtmLoggedDate = @dtmReportDate THEN 1 ELSE 0 END) AS Worked\n    FROM            \n        ACT.tblContact \n    RIGHT OUTER JOIN\n        ACT.tblActivity ON ACT.tblContact.activityID = ACT.tblActivity.activityID \n    LEFT OUTER JOIN\n        ARCVTADMIN.tblEmployee ON ACT.tblActivity.employeeID = ARCVTADMIN.tblEmployee.employeeID \n                               AND ACT.tblActivity.employeeID = ARCVTADMIN.tblEmployee.employeeID \n                               AND ACT.tblActivity.employeeID = ARCVTADMIN.tblEmployee.employeeID\n                               AND ACT.tblActivity.employeeID = ARCVTADMIN.tblEmployee.employeeID\n    GROUP BY \n        ARCVTADMIN.tblEmployee.strFirstName + ' ' + ARCVTADMIN.tblEmployee.strSurname, \n        ARCVTADMIN.tblEmployee.managerID\n    HAVING        \n        (ARCVTADMIN.tblEmployee.managerID = @ManagerID)\nEND\n</code></pre>\n\n<p>NB: ARCVTADMIN, ACT are Schema names</p>\n\n<p>This stored procedure works fine when I run it within SQL Server like</p>\n\n<pre><code>Declare @D nVarchar(max);\nEXECUTE ACT.sp_getAllocations @dtmReportDate = '20161220', @ManagerID = 91, @type=@D out\nPrint @D\n</code></pre>\n\n<p>The below is the result produced by the stored procedure when I execute it within SQL Server</p>\n\n<pre><code>Name            Workstate   Completed    NewLeads    Worked\n===========================================================\nNikki Furnell     4999          0        3434           0\nHarriet Johnson     10          0           0           0\nClaire Rowe        138          0          17           0\nCarina Hughes        4          0           0           0\n</code></pre>\n\n<p>I have a function in a Class Module as below </p>\n\n<pre><code>Public Function getSPRecordset(dtmReportDate As String, managerID As Long) As ADODB.Recordset\nDim strType As String\nDim rst As ADODB.Recordset\nIf Not (isConnectionOpen()) Then\nOpenConnection\nEnd If\n\nSet ADOCom = New ADODB.Command\nADOCom.ActiveConnection = ADOConn\nADOCom.CommandType = adCmdStoredProc\nADOCom.CommandText = \"[ACT].[sp_getAllocations]\"\nADOCom.Parameters.Refresh\n\nADOCom.Parameters.Append ADOCom.CreateParameter(\"@dtmReportDate\", adDate,   adParamInput, 10, dtmReportDate)\nADOCom.Parameters.Append ADOCom.CreateParameter(\"@ManagerID\", adBigInt, adParamInput, 10, managerID)\nADOCom.Parameters.Append ADOCom.CreateParameter(\"@type\", adVarChar, adParamOutput, 10000, strType)\nSet rst = ADOCom.Execute\nSet getSPRecordset = rst\nEnd Function\n</code></pre>\n\n<p>I'm trying to retrieve the resultset and assign it to my form and I'm trying the below.</p>\n\n<pre><code>Public Sub loadAllocation()\nDim objSS As clsSQLServer\nDim rst As ADODB.Recordset\nSet objSS = New clsSQLServer\nSet rst = objSS.getSPRecordset(Me.dtmReportDate, Me.managerID)\nSet Me.frmTeamDashboardWorkstate.Form.Recordset = rst ***Error Line ****\nset rst=nothing\nEnd Sub\n</code></pre>\n\n<p>Any help will be appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1482261578, "post_id": 41249572, "comment_id": 69699614, "body": "<a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-Dictionary</a>"}, {"owner": {"reputation": 137, "user_id": 2748442, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0d727cec132cc8a3674d7f6ee94745b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond Dillon", "link": "https://stackoverflow.com/users/2748442/raymond-dillon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482261915, "post_id": 41249572, "comment_id": 69699786, "body": "The for each bug at <a href=\"https://github.com/VBA-tools/VBA-Dictionary/issues/17\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-Dictionary/issues/17</a> is preventing me from using this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1482262498, "post_id": 41249572, "comment_id": 69700093, "body": "If you want to use <code>For Each</code> then you can pull out either the keys or the values (as variant array) and iterate over those ?  I don&#39;t have a Mac to test though."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482262584, "post_id": 41249572, "comment_id": 69700143, "body": "Having to explicitly iterate the values is a minor hinderance IMO, not a showstopper at all. It even improves readability, by making your code more explicit about what&#39;s going on. I don&#39;t see how that issue could be &quot;preventing&quot; you from using it. Now looking at your code... what&#39;s the use of a dictionary, if the value you&#39;re storing is <code>Nothing</code>? Preventing duplicates in <code>cbMeal.List</code>? How many rows are being iterated, and how many different values are there (i.e. what&#39;s the size of the data)?"}], "owner": {"reputation": 137, "user_id": 2748442, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0d727cec132cc8a3674d7f6ee94745b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raymond Dillon", "link": "https://stackoverflow.com/users/2748442/raymond-dillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1374, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482261068, "creation_date": 1482261068, "question_id": 41249572, "link": "https://stackoverflow.com/questions/41249572/vba-scripting-dictionary-on-a-mac", "title": "VBA &#39;Scripting.Dictionary&#39; on a MAC", "body": "<p>I have the following code on a VBA spreadsheet (which works perfect on a PC):</p>\n\n<pre><code>With CreateObject(\"Scripting.Dictionary\")\nFor Each rCell In ws.Range(\"meals\", ws.Cells(Rows.Count, \"B\").End(xlUp))\n    If Not .Exists(rCell.value) Then\n        .Add rCell.value, Nothing\n    End If\nNext rCell\n\ncbMeal.List = .Keys\nEnd With\n</code></pre>\n\n<p>Is there a way to get it to work on the MAC? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1042, "user_id": 2023624, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YegJC.jpg?s=128&g=1", "display_name": "DaveU", "link": "https://stackoverflow.com/users/2023624/daveu"}, "edited": false, "score": 0, "creation_date": 1553568961, "post_id": 41249151, "comment_id": 97422921, "body": "Your first answer &quot;Remove All Borders&quot; does NOT remove diagonals."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1482259245, "creation_date": 1482259245, "answer_id": 41249151, "question_id": 41249100, "link": "https://stackoverflow.com/questions/41249100/removing-or-adding-diagonal-borders/41249151#41249151", "title": "Removing or Adding Diagonal Borders", "body": "<p>Remove All Borders: <code>Sheets(\"Southwood\").Range(\"M6:S9\").Borders.LineStyle = xlNone</code></p>\n\n<p>Remove only diagonal borders :</p>\n\n<pre><code>With Sheets(\"Southwood\").Range(\"M6:S9\")\n    .Borders(xlDiagonalDown).LineStyle = xlNone\n    .Borders(xlDiagonalUp).LineStyle = xlNone\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 1, "accepted_answer_id": 41249151, "answer_count": 1, "score": 0, "last_activity_date": 1563356187, "creation_date": 1482259010, "last_edit_date": 1563356187, "question_id": 41249100, "link": "https://stackoverflow.com/questions/41249100/removing-or-adding-diagonal-borders", "title": "Removing or Adding Diagonal Borders", "body": "<p>This macro is being used to empty cells: </p>\n\n<pre><code>Sub Southwood_Click()\nSheets(\"Southwood\").Range(\"C6:C8\") = \"\"\nSheets(\"Southwood\").Range(\"D9:F9\") = \"\"\nSheets(\"Southwood\").Range(\"F6:J8\") = \"\"\nSheets(\"Southwood\").Range(\"J9\") = \"\"\nSheets(\"Southwood\").Range(\"M6:S9\") = \"\"\nSheets(\"Southwood\").Range(\"C26:C28\") = \"\"\nSheets(\"Southwood\").Range(\"E26:E28\") = \"\"\nSheets(\"Southwood\").Range(\"H26:O28\") = \"\"\nSheets(\"Southwood\").Range(\"M29\") = \"\"\nSheets(\"Southwood\").Range(\"C52:M54\") = \"\"\nSheets(\"Southwood\").Range(\"C75:H77\") = \"\"\nSheets(\"Southwood\").Range(\"J75:J77\") = \"\"\nSheets(\"Southwood\").Range(\"L75:P77\") = \"\"\nMsgBox \"Southwood has been cleared.\"\nEnd Sub\n</code></pre>\n\n<p>I would also like to remove only diagonal borders for this line:</p>\n\n<pre><code>Sheets(\"Southwood\").Range(\"M6:S9\") = \"\"\n</code></pre>\n"}, {"tags": ["excel", "macos", "vba", "shell", "macros"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7322412"}, "edited": false, "score": 0, "creation_date": 1482277949, "post_id": 41251268, "comment_id": 69706718, "body": "Thanks for the answer! But whenever i try to run this Shell(&quot;open <a href=\"http://google.com/&quot;\" rel=\"nofollow noreferrer\">google.com/&quot;</a>) then it says &quot;path not found&quot;? Thanks! and it does not really work with my previous command either"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 1, "last_activity_date": 1482268030, "creation_date": 1482268030, "answer_id": 41251268, "question_id": 41248873, "link": "https://stackoverflow.com/questions/41248873/excel-vba-run-shell-command-on-mac/41251268#41251268", "title": "Excel VBA run shell command on mac?", "body": "<p>You will need to call the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278437.aspx\" rel=\"nofollow noreferrer\"><code>shell</code></a> function. So your code would be </p>\n\n<pre><code>Shell(\"chmod +x /Users/asdasd/Music/playlistLoad.sh\")\n</code></pre>\n\n<p>The shell function will work on any OS, however you need to adapt the  command you pass to it to the OS you are working on. In your exemple, you have the UNIX style, so it will work only on Linux/MacOs or other *NIX systems. Windows don't have the notion of executable in it's permissions so there is no equivalent for your command in Windows anyway.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7322412"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482268030, "creation_date": 1482258083, "last_edit_date": 1482261662, "question_id": 41248873, "link": "https://stackoverflow.com/questions/41248873/excel-vba-run-shell-command-on-mac", "title": "Excel VBA run shell command on mac?", "body": "<p>I was wondering about how I could run a shell command using macros in Excel?</p>\n\n<p>I want to run <code>chmod +x /Users/asdasd/Music/playlistLoad.sh</code> through the shell. I have achieved this using Python and <code>os.system(\"Command here\")</code> but is there anything like that for Excel VBA? It has to work on Mac as well... not just Windows.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 6, "creation_date": 1482256120, "post_id": 41248339, "comment_id": 69696760, "body": "this is wrong <code>range(&quot;(F13&quot;)</code> should be <code>range(&quot;F13&quot;)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1482256403, "post_id": 41248339, "comment_id": 69696899, "body": "Missing <code>On Error Goto ErrorHandler</code>..."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482257739, "post_id": 41248339, "comment_id": 69697588, "body": "I edited the corrections and now no runtime error but it isn&#39;t looping through my for loop. &quot;debug.print 1&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1482258165, "post_id": 41248339, "comment_id": 69697795, "body": "You&#39;re still missing the fix on the <code>+ (range(&quot;(F23&quot;).Value ...</code> Or is that corrected in your workbook? Also, add <code>Option Explicit</code> to the very top (even above <code>Priavet Sub ...</code> to force all variables to be declared.  You should add <code>Dim counter as Long</code>, and just quickly try <code>For counter = 1 to 5</code> and see if it loops then.  Also, while debugging, I suggest turning <i>off</i> (comment out) the error handling.  Also, I <i>think</i> <code>counter</code> is a reserved word. Change that to <code>i</code> for now and see if it works."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482259279, "post_id": 41248339, "comment_id": 69698379, "body": "oh BruceWayne, I only changed it on one. It was still wrong. That fixed Everything. The for is looping properly and the Cell filled in with the right number. I still used  debug.Print Counter; and it also displayed the numbers sequentially. Crazy how one can look and look at syntax and not see it. Thanks all"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482260618, "post_id": 41248958, "comment_id": 69699100, "body": "Spoke too soon. I edited my first post to reflect that I  assigned the calculation to a variable named amount. then assigned it to F17 after the for loop. F17 displays only the calculation after the first iteration. 172.50 ???"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482263256, "post_id": 41248958, "comment_id": 69700491, "body": "@geddeca oh wait, just realized you don&#39;t loop anything.  What&#39;s the lop supposed to do? Are you looking to loop through cells? Currently, the loop is pointless."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482266184, "post_id": 41248958, "comment_id": 69702028, "body": "I want it to keep adding the 15% of the original amount for as many iterations (years) as are selected in F16. Then after that assign the final amount to F17."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482266282, "post_id": 41248958, "comment_id": 69702081, "body": "Select Case Target.Address              Case &quot;$F$16&quot;            &#39;Recalculate as necessary            For counter = 1 To range(&quot;F16&quot;).Value              Debug.Print counter;             amount = range(&quot;F13&quot;).Value + (range(&quot;F13&quot;).Value * 0.15)            Next            range(&quot;F17&quot;).Value = amount     End Select"}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482266628, "post_id": 41248958, "comment_id": 69702260, "body": "OH, I see that it is only assigning the first iteration to amount. I think that I need to write amount = amount + range(&quot;F13&quot;).Value + (range(&quot;F13&quot;).Value * 0.15) or something like this. so that it keeps the 15% already added and then does it again and again."}, {"owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "edited": false, "score": 0, "creation_date": 1482267312, "post_id": 41248958, "comment_id": 69702621, "body": "OK Figured it out. Wish I could delete some of my silly comments but too late. I had to assign F13 Value to amount before the loop and then let it add the 15% to amount as many times as chosen."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1482263163, "last_edit_date": 1482263163, "creation_date": 1482258376, "answer_id": 41248958, "question_id": 41248339, "link": "https://stackoverflow.com/questions/41248339/runtime-error-1004-range-of-object-worksheet-failed/41248958#41248958", "title": "Runtime error 1004 &quot;range of object_worksheet failed", "body": "<p>Per the comments, this should work:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error GoTo ErrorHandler   '&lt;--| be sure to catch any error and enable   events handling back\nDim i As Long\n\nSelect Case Target.Address\n\nCase \"$F$16\"\n    'Recalculate as necessary\n    For i = 1 To Range(\"F16\").Value\n        Debug.Print i\n        Range(\"F17\").Value = Range(\"F13\").Value + (Range(\"F13\").Value * 0.15)\n    Next i\n\nEnd Select\nErrorHandler:\nApplication.EnableEvents = True    '&lt;--| enable events handling\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 4934785, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf4026ca29a3a238d6d38e538fc0d05b?s=128&d=identicon&r=PG&f=1", "display_name": "geddeca", "link": "https://stackoverflow.com/users/4934785/geddeca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 41248958, "answer_count": 1, "score": -1, "last_activity_date": 1482263163, "creation_date": 1482256033, "last_edit_date": 1482260327, "question_id": 41248339, "link": "https://stackoverflow.com/questions/41248339/runtime-error-1004-range-of-object-worksheet-failed", "title": "Runtime error 1004 &quot;range of object_worksheet failed", "body": "<p>Want to use a cell change to run this code: get a runtime error.</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As range)\nOn Error GoTo ErrorHandler '&lt;--| be sure to catch any error and enable   events handling back\nSelect Case Target.Address\n\n    Case \"$F$16\"\n       'Recalculate as necessary\n       For counter = 1 To range(\"F16\").Value\n         Debug.Print counter;\n        amount = range(\"F13\").Value + (range(\"F13\").Value * 0.15)\n       Next\n       range(\"F17\").Value = amount\n\nEnd Select\nErrorHandler:\nApplication.EnableEvents = True '&lt;--| enable events handling\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aiwEt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aiwEt.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1482265080, "creation_date": 1482265080, "answer_id": 41250599, "question_id": 41248083, "link": "https://stackoverflow.com/questions/41248083/how-to-create-combo-box-with-custom-category-headers/41250599#41250599", "title": "How to create combo box with custom category headers", "body": "<p>You can have it look like this example:</p>\n\n<pre><code>Fruits\n-Apples    \n-Bananas    \n-Pears\nMeat\n-Chicken    \n-Beef\nDairy\n-Milk    \n-Eggs\n</code></pre>\n\n<p>That about it. Then filter for selections not starting with a dash.</p>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1482876386, "post_id": 41352202, "comment_id": 69907435, "body": "&quot;<b>a</b> combo box with custom category header<b>s</b>&quot;"}, {"owner": {"reputation": 123, "user_id": 5496009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/56dc5a86da22dd00f11d27c87b72e8f8?s=128&d=identicon&r=PG&f=1", "display_name": "SikRikDaRula", "link": "https://stackoverflow.com/users/5496009/sikrikdarula"}, "edited": false, "score": 0, "creation_date": 1482939340, "post_id": 41352202, "comment_id": 69931667, "body": "I was able to achieve this by using multiple boxes with the first box being the category and filtered the second box based on the selection of the first combo box"}], "tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": true, "score": 1, "last_activity_date": 1482876606, "last_edit_date": 1482876606, "creation_date": 1482872590, "answer_id": 41352202, "question_id": 41248083, "link": "https://stackoverflow.com/questions/41248083/how-to-create-combo-box-with-custom-category-headers/41352202#41352202", "title": "How to create combo box with custom category headers", "body": "<p>If you have multiple combo boxes then you can. Just tell it that you have headers and the first entry will count as the header.</p>\n\n<p>EDIT: after reading that you want a single combo box, I don't know of a way to do it like you want it.</p>\n"}], "owner": {"reputation": 123, "user_id": 5496009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/56dc5a86da22dd00f11d27c87b72e8f8?s=128&d=identicon&r=PG&f=1", "display_name": "SikRikDaRula", "link": "https://stackoverflow.com/users/5496009/sikrikdarula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 41352202, "answer_count": 2, "score": 1, "last_activity_date": 1594640772, "creation_date": 1482254994, "last_edit_date": 1594640772, "question_id": 41248083, "link": "https://stackoverflow.com/questions/41248083/how-to-create-combo-box-with-custom-category-headers", "title": "How to create combo box with custom category headers", "body": "<p>Is it possible to create a combo box with custom category headers in access. The values for the combo box are not taken from a table, but the selected value will be stored in a table. </p>\n\n<p>I want the outcome of the combo box to look like this, for example:</p>\n\n<p><strong>Fruits</strong></p>\n\n<pre><code>Apples\n\nBananas\n\nPears\n</code></pre>\n\n<p><strong>Meat</strong></p>\n\n<pre><code>Chicken\n\nBeef\n</code></pre>\n\n<p><strong>Dairy</strong></p>\n\n<pre><code>Milk\n\nEggs\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1482254980, "post_id": 41248035, "comment_id": 69696149, "body": "<code>Sheets(&quot;Sheet1&quot;).Range(Sheets(&quot;Sheet1&quot;).Cells(I,&quot;L&quot;),Sheets(&zwnj;&#8203;&quot;Sheet1&quot;).Cells(I,&quot;M&zwnj;&#8203;&quot;)).ClearContents</code>"}, {"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1482273786, "post_id": 41248035, "comment_id": 69705456, "body": "Sheets(&quot;Sheet1&quot;).Range(&quot;L:M&quot;).Value = vbNullString"}, {"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1482274687, "post_id": 41248035, "comment_id": 69705738, "body": "<a href=\"http://stackoverflow.com/questions/38455405/what-is-the-difference-between-value-and-clearcontents\" title=\"what is the difference between value and clearcontents\">stackoverflow.com/questions/38455405/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6926516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432bf1e3eca4d814b94760c3deabb7e1?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchieRab", "link": "https://stackoverflow.com/users/6926516/frenchierab"}, "edited": false, "score": 0, "creation_date": 1482307138, "post_id": 41248952, "comment_id": 69715744, "body": "Thanks for the help SOLVED."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1482258350, "creation_date": 1482258350, "answer_id": 41248952, "question_id": 41248035, "link": "https://stackoverflow.com/questions/41248035/alternative-to-entirerow-clearcontents/41248952#41248952", "title": "Alternative to Entirerow.Clearcontents", "body": "<p>you could use </p>\n\n<pre><code>Intersect(Sheets(\"Sheet1\").Range(\"L:M\"), Sheets(\"Sheet1\").Rows(i)).ClearContents\n</code></pre>\n\n<p>but to speed up your code you could use <code>AutoFilter()</code> and not to loop through cells:</p>\n\n<pre><code>With Sheets(\"Sheet1\") '&lt;--1 reference your sheet\n    With .Range(\"M1\", .Cells(.Rows.Count, \"L\").End(xlUp)) '&lt;--| reference its column L:M cells from row 1 down to column \"L\" last not empty row\n        .AutoFilter field:=1, Criteria1:=Val4 '&lt;--| filter referenced range on its 1st column (i.e. column \"L\") with Val4\n        If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then '&lt;--| if any cell filtered other than header one (in row1)\n            .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).ClearContents '&lt;--|clear filtered referenced cells\n        End If\n    End With\n    .AutoFilterMode = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6926516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432bf1e3eca4d814b94760c3deabb7e1?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchieRab", "link": "https://stackoverflow.com/users/6926516/frenchierab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 41248952, "answer_count": 1, "score": 0, "last_activity_date": 1482444519, "creation_date": 1482254786, "last_edit_date": 1482444519, "question_id": 41248035, "link": "https://stackoverflow.com/questions/41248035/alternative-to-entirerow-clearcontents", "title": "Alternative to Entirerow.Clearcontents", "body": "<p>I am looking to find a row in my data which corresponds to a reference cell named Val4 and delete that range. I have this which works for deleting the entire Row or just the content of that row but I would like to delete range (\"L:M\") instead of the entire row. Here is a segment of my code:</p>\n\n<pre><code>    Sheets(\"Sheet1\").Select\n\n    Last = Cells(Rows.Count, \"L\").End(xlUp).Row\n    For I = Last To 1 Step -1\n        If (Cells(I, \"L\").Value) = Val4 Then\n   'Cells(I, \"L\").ClearContents ' USE THIS TO CLEAR CONTENTS BUT NOT DELETE ROW\n            'Cells(I, \"A\").EntireRow.Delete USE THIS TO DELETE ENTIRE ROW\n            GoTo NextSheet1\n        End If\n    Next I\n</code></pre>\n\n<p>Thanks for the help.</p>\n\n<p>Ross</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 1, "creation_date": 1482254934, "post_id": 41247972, "comment_id": 69696121, "body": "Just solved the randomising - do away with all the PI and just use <code>COS(MOD(original number, key))</code> and rank everything to generate the new location value. Provided key and original value aren&#39;t multiples of Pi, Cos should never give duplicate values."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1482256828, "post_id": 41247972, "comment_id": 69697141, "body": "It&#39;s difficult to tell whether your approach is appropriate when you&#39;ve not explained even briefly what the purpose of the whole exercise is."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482313925, "post_id": 41247972, "comment_id": 69719823, "body": "I see the problem, the purpose is to have a sort of document protection that is more physical than password protection/ locking cells. If I have a table of data say, I can shuffle the locations of cells within it so that the data becomes incomprehensible. Plus this approach is easy to implement based on workbook events, and doesn&#39;t involve saving a password anywhere (encrypted or not) as the key is mathematical, so any incorrect key should still &#39;work&#39; - it just won&#39;t get the correct shuffle"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1482254691, "creation_date": 1482254604, "last_edit_date": 1482254691, "question_id": 41247972, "link": "https://stackoverflow.com/questions/41247972/shuffle-and-unshuffle-sheet-with-key", "title": "Shuffle and unshuffle sheet with key", "body": "<p>Catchy title. I'm trying to write an excel macro to shuffle round the cells in a worksheet in a seemingly random way, but so that it can be unshuffled at a later date. However, the key feature here is that the shuffling is dictated by an input key, in my proposed solution this is a number, and the inverse/ unshuffling operation relies on this key too.</p>\n\n<p>My current approach is as follows: <em>And I summarise below if you don't want to read the details</em></p>\n\n<ul>\n<li><p>I input a number into a cell on the sheet. I take that number and convert it to something irrational (in my current approach it gets converted to PI() - or at least the correct key is, but another irrational number would do fine).</p></li>\n<li><p>Now, every cell in my shuffling array is assigned a unique integer value based on its location. This unique number is combined with the key to give some unique result that is dependant on the key. e.g. <code>=MID(PI()/10,3, UniqueValue)</code> - remember PI() was generated by the key, so is dependant on the key's value.</p></li>\n<li><p>So for an array <code>A1:A3</code> where the unique values are simply <code>{1,2,3}</code> then their unique results will be <code>{1,14,141}</code>. Those are still in ascending order, so to give a random spread I do <code>=COS(A1:A3)</code> or more specifically <code>=COS(MOD(A1:A3,2*PI()))</code> to account for numbers outside the range of COS in Excel. That gives me some well mixed up output values. </p></li>\n<li><p>Finally I rank output values against eachother to give a new list of unique integer numbers. These new values represent the new positions in the array. The calculation steps for <code>A1:A3</code> are from {1, 2, 3} to {0.5403\u2026 , 0.13674\u2026 , -0.93172} to {1, 2, 3}. Here no randomisation, but for 13 numbers: from from <code>{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13}</code> to <code>{0.5403\u2026 , 0.13674\u2026 , -0.93172\u2026 , 0.28355\u2026 , -0.98753\u2026 , 0.91345\u2026 , -0.72052\u2026 , 0.99538\u2026 , -0.6825\u2026 , 0.80817\u2026 , -0.15975\u2026 , 0.38126\u2026 , 0.99859}</code> to <code>{5, 8, 12, 7, 13, 3, 11, 2, 10, 4, 9, 6, 1}</code>. That has a nice low correlation between input and output. The only problem here is that PI() is only stored to 16ish dp meaning the <code>=MID(PI()/10,3, UniqueValue)</code> can run on at most 13 cells. Consequently I need some way of calculating n digits of PI(), I may have to employ a spigot algorithm.</p></li>\n<li><p>Then to unshuffle, simply go to each cell, work out where the cells contents would have been sent, and copy the value in that location back to the original cell</p></li>\n</ul>\n\n<p>Long story short, a cell has a unique value based on its location. It is assigned a new unique value which is a product of its original value and a separate user input key, and is designed not to correlate with the original value. The new value dictates the new place on the sheet.</p>\n\n<h2>Problems</h2>\n\n<p>As stated, my current approach for randomising requires a knowledge of more digits of PI() than Excel holds. Remember though, I am not just using PI() as a constant, it is a variable dictated by my input (likely via an acos() of the input value to get a multiple of PI()) - so I can't just get a text document with a million digits of Pi, I need to be able to calculate many d.p.s of whatever the variable is - I only choose Pi as the <em>correct key</em> as a spigot algorithm can be used to generate later digits of PI.</p>\n\n<p>But the randomisation can likely be readily improved. My issue is with the implementation: is generating a new number for each cell the right way to do this? Or is there a much simpler approach for shuffling the sheet that I'm overlooking? And my approach requires alot of temporary copying of values: if I want to shuffle the array but leave it in the same place on the sheet I need protect cells from being copied over as a new cell is moved to their location.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1482831569, "post_id": 41249543, "comment_id": 69887288, "body": "@Arvsden, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1482260879, "creation_date": 1482260879, "answer_id": 41249543, "question_id": 41247694, "link": "https://stackoverflow.com/questions/41247694/cut-rows-between-2-values-and-pasting-it-on-a-new-sheet/41249543#41249543", "title": "cut rows between 2 values and pasting it on a new sheet", "body": "<p>just be sure you have row 1 as a header row and then you can exploit <code>AutoFilter()</code> and <code>SpecialCells()</code> methods and <code>Areas()</code> property of <code>Range</code> object like follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim iArea As Long\n    Dim filteredRng As Range\n\n    With Worksheets(\"BRG_FILE\")\n        With .Range(\"A1\", .Cells(.Rows.count, 1).End(xlUp).Offset(1))\n            .Cells(.Rows.count) = \"REPORT\"\n            .AutoFilter field:=1, Criteria1:=\"REPORT\"\n            If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then\n                Set filteredRng = Intersect(.Parent.UsedRange, .Resize(.Rows.count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow)\n            End If\n            .Cells(.Rows.count).ClearContents\n        End With\n        .AutoFilterMode = False\n    End With\n\n    If Not filteredRng Is Nothing Then\n        With filteredRng\n            For iArea = 1 To .Areas.count - 1\n                Sheets.Add After:=Sheets(Sheets.count)\n                .Parent.Range(.Areas(iArea), .Areas(iArea + 1).Offset(-1)).Cut\n                ActiveSheet.Paste\n            Next\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7322004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92913df23f5a220f8b027e0403dba8eb?s=128&d=identicon&r=PG&f=1", "display_name": "Arvsden", "link": "https://stackoverflow.com/users/7322004/arvsden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482260879, "creation_date": 1482253656, "last_edit_date": 1482254186, "question_id": 41247694, "link": "https://stackoverflow.com/questions/41247694/cut-rows-between-2-values-and-pasting-it-on-a-new-sheet", "title": "cut rows between 2 values and pasting it on a new sheet", "body": "<p>I am new and I've been trying to work on this macro for a few days now. What I am trying to do is to search thru column A for the word \"REPORT\"; then cut and paste all rows in between \"report\" (including blanks rows) to a new sheet. It kinda works but it would not stop because it would continue to look for the \"REPORT\". Here's how my data looks like. Thanks.</p>\n\n<p><strong>Table:</strong></p>\n\n<pre><code>         A\n  ---------------\n 1| REPORT\n 2| SOLICITOR_ID\n 3| ISSUER:\n 4| CUSIP:\n 5| RECORD_DATE:\n 6| TOTAL\n 7|\n 8|\n 9|\n10|\n11|\n12| REPORT\n13| SOLICITOR_ID\n14| ISSUER:\n15| CUSIP:\n16| RECORD_DATE:\n17|\n18|\n19|\n20|\n21|\n22| REPORT\n23| SOLICITOR_ID\n24| ISSUER:\n25| CUSIP:\n26| RECORD_DATE:\n27|\n28|\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub BRGFileCleanup()\n\nDim rownum As Long\nDim colnum As Long\nDim startrow As Long\nDim endrow As Long \nDim lastrow As Long\n\nDo\n    rownum = 1\n    colnum = 1\n    lastrow = Worksheets(\"BRG_FILE\").Range(\"A65536\").End(xlUp).Row\n\n    With ActiveWorkbook.Worksheets(\"BRG_FILE\").Range(\"A1:A\" &amp; lastrow)\n\n    For rownum = 1 To lastrow\n\nDo\n    If .Cells(rownum, 1).Value = \"REPORT\" Then\n       startrow = rownum\n\n    End If\n\n    rownum = rownum + 1\n\n If (rownum &gt; lastrow) Then Exit For\n\n Loop Until .Cells(rownum, 1).Value = \"REPORT\"\n    endrow = rownum - 1\n    rownum = rownum + 1\n\n    Worksheets(\"BRG_FILE\").Range(startrow &amp; \":\" &amp; endrow).Cut\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n    Worksheets(\"BRG_FILE\").Range(startrow &amp; \":\" &amp; endrow).Delete\n\n Next rownum\n End With\n\nLoop Until ActiveSheet.Range(\"A1\").Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "loops", "count", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": true, "score": 1, "last_activity_date": 1482253847, "creation_date": 1482253847, "answer_id": 41247753, "question_id": 41247605, "link": "https://stackoverflow.com/questions/41247605/count-files-with-specific-file-name-in-specific-folder/41247753#41247753", "title": "Count Files with Specific File Name in Specific Folder", "body": "<p>Just reset the value of <code>NumFiles</code> at the beginning of your loop:</p>\n\n<pre><code>For i = 2 To x\n\n    NumFiles = 0 '&lt;-- Reset count\n\n    Folder = Sheets(\"Sheet1\").Range(\"AE\" &amp; i).Value &amp; \"\\\"\n    ExcelFN = Sheets(\"Sheet1\").Range(\"AH\" &amp; i).Value\n\n    Filename = Dir(Folder &amp; ExcelFN &amp; \"*\" &amp; \".xlsm\")\n\n    While Filename &lt;&gt; \"\"\n        NumFiles = NumFiles + 1\n        Filename = Dir()\n    Wend\n\n    Sheets(\"Sheet1\").Range(\"AI\" &amp; i) = NumFiles\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7075690, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/14fe15f0f9e5efee4c783fd419a457bc?s=128&d=identicon&r=PG&f=1", "display_name": "Finley", "link": "https://stackoverflow.com/users/7075690/finley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1822, "favorite_count": 0, "accepted_answer_id": 41247753, "answer_count": 1, "score": 2, "last_activity_date": 1502703103, "creation_date": 1482253380, "last_edit_date": 1531161705, "question_id": 41247605, "link": "https://stackoverflow.com/questions/41247605/count-files-with-specific-file-name-in-specific-folder", "title": "Count Files with Specific File Name in Specific Folder", "body": "<p>I will first describe the definitions of my code, next define my problem and finally display my current code.</p>\n\n<p><strong>DEFINITIONS:</strong></p>\n\n<p>I am trying to create a looped function that will count the number of files with a specific/defined name within a folder with a specific/defined name.</p>\n\n<p>Column AE defines the Folder Path (\"Folder\").\nColumn AH defines the File Name (\"ExcelFN\").</p>\n\n<p>Cell <code>AI1</code> defines how many rows this function should loop through (<code>AI1 = \"x\"</code>).</p>\n\n<p>I expect the function to (1) cycle through x number of rows, (2) count how many files with defined FileName (FileName = cell \"AH &amp; i\") are found within defined Folder (FolderPath = cell \"AE &amp; i\"), then (3) place the number of files into cell \"AI &amp; i\", and finally (4) move onto the next row \"i\" and repeat prior steps.</p>\n\n<p><strong>PROBLEM:</strong></p>\n\n<p>My PROBLEM is that my code is placing 1, 2, 3, 4, 5, etc...all the way down AI - As a note, I do not have consecutively larger file counts as I move down the list, as should be obvious that one cannot save multiple files with the same name.</p>\n\n<p>My guess is that my code is not refreshing NumFiles to zero before counting the number of files of the next row and just adding the current rows' file count to the previous's rows' file count.</p>\n\n<p><strong>CODE:</strong></p>\n\n<p>FINALLY - here is my code:</p>\n\n<pre><code>Sub CountFiles()\n\n    Sheets(\"Sheet1\").Activate\n\n    Dim i As Integer\n    Dim x As Integer\n    Dim Folder As String\n    Dim ExcelFN As String\n    Dim NumFiles As Integer\n\n    x = Sheets(\"Sheet1\").Range(\"AI1\").Value '====&gt;&gt; Define Number of Rows &lt;&lt;====\n\n    For i = 2 To x\n\n        Folder = Sheets(\"Sheet1\").Range(\"AE\" &amp; i).Value &amp; \"\\\"\n        ExcelFN = Sheets(\"Sheet1\").Range(\"AH\" &amp; i).Value\n\n        Filename = Dir(Folder &amp; ExcelFN &amp; \"*\" &amp; \".xlsm\")\n\n        While Filename &lt;&gt; \"\"\n            NumFiles = NumFiles + 1\n            Filename = Dir()\n        Wend\n\n        Sheets(\"Sheet1\").Range(\"AI\" &amp; i) = NumFiles\n\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482253057, "post_id": 41247434, "comment_id": 69695024, "body": "It happens when you select Yes on the messagebox?"}, {"owner": {"reputation": 11, "user_id": 7321978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410203cec8184e6b04b585c9d94f89e8?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Noob", "link": "https://stackoverflow.com/users/7321978/vba-noob"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482253244, "post_id": 41247434, "comment_id": 69695130, "body": "When I select No on my custom messagebox, the sub does what it&#39;s supposed to.  After completion, it then pops up the default &quot;Do you want to save changes&quot; box.  Clicking Save on THAT one then closes the workbook without firing the beforeclose event.  I thought that setting &quot;Activeworkbook.saved = true&quot; would suppress the 2nd message box, but it doesn&#39;t."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482256964, "post_id": 41247434, "comment_id": 69697200, "body": "Not the answer you were hoping to find, but glad you were able to identify the root cause. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7321978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410203cec8184e6b04b585c9d94f89e8?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Noob", "link": "https://stackoverflow.com/users/7321978/vba-noob"}, "edited": false, "score": 0, "creation_date": 1482253333, "post_id": 41247566, "comment_id": 69695190, "body": "I tried your suggestion and it&#39;s still showing the second dialogue box."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1482253455, "post_id": 41247566, "comment_id": 69695256, "body": "This seems to be working for me using either of <code>ThisWorkbook</code> or <code>Me</code> keyword."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1482253514, "post_id": 41247566, "comment_id": 69695289, "body": "Yeah for me too. VBA Noob , do you have any code on the other events such as BeforeSave?"}, {"owner": {"reputation": 11, "user_id": 7321978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410203cec8184e6b04b585c9d94f89e8?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Noob", "link": "https://stackoverflow.com/users/7321978/vba-noob"}, "edited": false, "score": 0, "creation_date": 1482253562, "post_id": 41247566, "comment_id": 69695315, "body": "The only other workbook level sub I have is   Private Sub Workbook_Open()     Call PullData End Sub"}, {"owner": {"reputation": 11, "user_id": 7321978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410203cec8184e6b04b585c9d94f89e8?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Noob", "link": "https://stackoverflow.com/users/7321978/vba-noob"}, "edited": false, "score": 1, "creation_date": 1482253773, "post_id": 41247566, "comment_id": 69695434, "body": "Perhaps it&#39;s an issue with a company-specific addon.  Even this still prompts the save box which will exit the workbook:  Private Sub Workbook_BeforeClose(Cancel As Boolean)       Cancel = true  end sub"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1482254156, "post_id": 41247566, "comment_id": 69695657, "body": "The <code>Cancel</code> parameter in <code>Workbook_BeforeClose</code> event doesn&#39;t suppress the &quot;Save&quot; dialog. It provides a means by which you can abort the <code>Close</code> operation. To suppress the &quot;Save&quot; dialog, you need to do that using the workbook&#39;s <code>.Saved</code> property per @cyboashu answer. This tricks Excel in to treating the workbook as though it is saved, even if it is not."}, {"owner": {"reputation": 11, "user_id": 7321978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410203cec8184e6b04b585c9d94f89e8?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Noob", "link": "https://stackoverflow.com/users/7321978/vba-noob"}, "edited": false, "score": 0, "creation_date": 1482254231, "post_id": 41247566, "comment_id": 69695691, "body": "I&#39;ve tried Me.Saved=True, ThisWorkbook.Saved=True and ActiveWorkbook.Saved = True.  None of those are preventing the save dialog box."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1482253235, "creation_date": 1482253235, "answer_id": 41247566, "question_id": 41247434, "link": "https://stackoverflow.com/questions/41247434/vba-workbook-beforeclose-still-prompts-the-save-window-after-setting-cancel-to-t/41247566#41247566", "title": "VBA Workbook_BeforeClose still prompts the Save window after setting Cancel to true. Clicking Save on that menu then closes the workbook", "body": "<p>Change <code>ActiveWorkbook</code> to <code>ThisWorkbook</code></p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    If ValidateData = True Then\n        Call SendAndSave\n    Else\n        Select Case MsgBox(\"There are some invalid entries on the worksheet (values can only be between 0 and 5) so the changes were NOT \" &amp; _\n            \"sent to the server.  Do you still want to close the tool?\", vbYesNo, \"Warning\")\n        Case vbYes\n            ThisWorkbook.Saved = True '/ won't ask the user to save\n            ' but will still close.\n        Case vbNo\n            ThisWorkbook.Saved = True ''/ won't ask the user to save\n            Cancel = True '/ Won't Close\n        End Select\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24, "user_id": 5343913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cfd005f7f821b78a24e253a0f523b9?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/5343913/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1482355108, "creation_date": 1482355108, "answer_id": 41272059, "question_id": 41247434, "link": "https://stackoverflow.com/questions/41247434/vba-workbook-beforeclose-still-prompts-the-save-window-after-setting-cancel-to-t/41272059#41272059", "title": "VBA Workbook_BeforeClose still prompts the Save window after setting Cancel to true. Clicking Save on that menu then closes the workbook", "body": "<p>You might try to block before_save, telling him \"i come from before_close\" just by adding a module global boolean.\nIf this boolean is true in before_save then cancel=true.</p>\n\n<pre><code>option explicit\nPrivate BlockNormalSave as boolean\n\nPrivate Sub Workbook_BeforeSave(Cancel As Boolean)\nif BlockNormalSave then Cancel=true\nend sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\nBlockNormalSave=true\napplication.displayalerts=false 'not sure if prevents save window\nthisworkbook.saved=true\n'thisworkbook.close save:=false 'not sure either\nend sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7321978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410203cec8184e6b04b585c9d94f89e8?s=128&d=identicon&r=PG&f=1", "display_name": "VBA Noob", "link": "https://stackoverflow.com/users/7321978/vba-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482355108, "creation_date": 1482252804, "last_edit_date": 1482256880, "question_id": 41247434, "link": "https://stackoverflow.com/questions/41247434/vba-workbook-beforeclose-still-prompts-the-save-window-after-setting-cancel-to-t", "title": "VBA Workbook_BeforeClose still prompts the Save window after setting Cancel to true. Clicking Save on that menu then closes the workbook", "body": "<p>EDIT:</p>\n\n<p>The issue is caused by a custom security addon that my company uses.  Nothing I can do about it and is a very select problem, so I'm deleting the question so I don't confuse anyone who finds this in the future.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482251174, "post_id": 41246896, "comment_id": 69693797, "body": "How did you declare <code>NBG_SourceRegionDataWorksheetName</code> and <code>Issue_SumofSharesWorksheetName</code>? Oh, also you&#39;re missing a row in <code>&quot;A2:AS&quot;</code> ...do you mean to like, <code>A2:A5</code>?  (Not <code>A2:A[letter &quot;S&quot;] </code>?)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482251411, "post_id": 41246896, "comment_id": 69693966, "body": "The <code>Goto</code> statements are completely pointless.  They basically just manually mark out an <code>Else</code> block."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482251528, "post_id": 41246896, "comment_id": 69694050, "body": "<code>Range(&quot;A2:AS&quot;)</code> is a 1004 error.  Is that a typo?"}, {"owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482252898, "post_id": 41246896, "comment_id": 69694907, "body": "@BruceWayne here is how i declared them , and when i meant the letter S but it didn&#39;t work ( I don&#39;t know why) but now the error is &quot;Type Mismatch&quot; , please help  /////Private Const NBG_SourceRegionDataWorksheetName = &quot;NBG_Data_Source_Region&quot; ////// Issue_SumofSharesWorksheetName = &quot;Issue_SumofShares&quot;    /////Repetition = Application.VLookup(Worksheets(NBG_RegionaDataWorksheetName)&zwnj;&#8203;\u200c\u200b.Cells(Row_T, ProjectID).Value, Worksheets(Issue_SumofSharesWorksheetName).Range(&quot;A3:A400&quot;), 1)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482253382, "post_id": 41246896, "comment_id": 69695218, "body": "(Can you please edit that into your original post, instead of a comment?)  Also, why have a variable name that&#39;s <i>longer</i> than the actual string you&#39;re storing in there? Just a comment."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "edited": false, "score": 0, "creation_date": 1482315628, "post_id": 41248637, "comment_id": 69721117, "body": "man something is wrong , all i want is if the Project ID is already in the Issue_SumofShares sheet (identical) that it skips the registering step and goes to NextRow_T , when i used ur code (which is really helpful) it skiped the registering step for all the rows , please help me"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1482257112, "creation_date": 1482257112, "answer_id": 41248637, "question_id": 41246896, "link": "https://stackoverflow.com/questions/41246896/vlookup-application-or-object-defined-error/41248637#41248637", "title": "VLookup Application or object defined error", "body": "<pre><code>Repetition = Application.WorksheetFunction.VLookup( _\n      Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, ProjectID).Value, _\n      Worksheets(Issue_SumofSharesWorksheetName).Range(\"A2:AS\"), 1)\n</code></pre>\n\n<p>This will throw a run-time error if the value being looked up is not found.  Safer to use this approach: </p>\n\n<pre><code>Repetition = Application.VLookup(...)\nIf Not IsError() Then\n   'was found\nElse\n   'not found\nEnd If\n</code></pre>\n\n<p>Omitting the <code>WorksheetFunction</code> means the function will instead return an error value which you can test for.  Also, you should always include the last argument <code>False</code>to VLookup unless you really want the default behavior.</p>\n\n<p>As a side note, your code will be significantly more readable if you use variables to refer to your sheets instead repeating the full path every time:</p>\n\n<pre><code>Dim wsISOS As Worksheet\nSet wsISOS = Worksheets(Issue_SumofSharesWorksheetName)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7178621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48725d9f1c220f6561194f3e5b5e7a87?s=128&d=identicon&r=PG&f=1", "display_name": "Nasser Al Fanek", "link": "https://stackoverflow.com/users/7178621/nasser-al-fanek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482257112, "creation_date": 1482251093, "question_id": 41246896, "link": "https://stackoverflow.com/questions/41246896/vlookup-application-or-object-defined-error", "title": "VLookup Application or object defined error", "body": "<p>I wanted to ask waht am i doing wrong here ?? i want the VLookup to find if the ProjectID is already there , and if it is, I want it to skip the registering step and immediately go to Next Row_T to see the next row of data , whenever i start the error \" Application-defined or object-defined error \" comes up on the line :</p>\n\n<pre><code> Repetition = Application.WorksheetFunction.VLookup(Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, ProjectID).Value, Worksheets(Issue_SumofSharesWorksheetName).Range(\"A2:AS\"), 1)\n</code></pre>\n\n<p>i don't know what is wrong , can you please help me ??</p>\n\n<pre><code>For Row_S = 2 To MAX_Row_S\n SourceYear = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, SOP).Value\n     SourceYear = DatePart(\"yyyy\", SourceYear)\n\n     SourceCarmaker = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, carmaker).Value\n     SourceProject = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Project).Value\n     SourceFamily = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Family).Value\n     SourceStatus = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Status).Value\n     SourceShare = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, Share).Value\n     SourceCst = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, \"A\").Value\n     SourcePID = Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, ProjectID).Value\n\n     ' Take the data from NBG_Data_Region sheet to be Sourceared with each row of the NBG_Data_Source_Region sheet\n\n    For Row_T = 2 To MAX_Row_T\n\n\n    If Row_T &gt;= MAX_Row_T Then\n      Exit For\n    End If\n\n\n    'NBGMonth = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, SOP).Value\n    'NBGMonth = DatePart(\"m\", NBGMonth)\n\n    NBGYear = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, SOP).Value\n    NBGYear = DatePart(\"yyyy\", NBGYear)\n\n    NBGCarmaker = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, carmaker).Value\n    NBGProject = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Project).Value\n    NBGFamily = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Family).Value\n    NBGStatus = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Status).Value\n    NBGShare = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Share).Value\n    NBGCst = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, \"A\").Value\n    NBGPID = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, ProjectID).Value\n\n\n\n 'Get the number of rows in Issue_SumofShares\n'SoS = SumofShares\nMAX_Row_inSoS = Worksheets(Issue_SumofSharesWorksheetName).UsedRange.RowS.Count\n\nS = MAX_Row_inSoS\n\n     Repetition = Application.WorksheetFunction.VLookup(Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, ProjectID).Value, Worksheets(Issue_SumofSharesWorksheetName).Range(\"A2:AS\"), 1)\n\n\n\n\n ' StatusBar Show\n\n Application.StatusBar = \"VerifySumofShares. Progress: \" &amp; Row_S &amp; \" of \" &amp; MAX_Row_S\n\n       'Check if any row with a SOP date in the previous or current years and if it is a D-IN or OPP is found and add it to the IssueSOP_Date sheet\n\n       ' NAF 20161208\n       'Test with Source of YEAR and MONTH\n       ' If (NBGMonth = SourceMonth And NBGYear = SourceYear And SourceCarmaker = NBGCarmaker And SourceProject = NBGProject And SourceFamily = NBGFamily And SourceShare + NBGShare &lt;&gt; 1 And NBGCst &lt;&gt; SourceCst) Then\n       ' With Year only\n        If (NBGYear = SourceYear And SourceCarmaker = NBGCarmaker And SourceProject = NBGProject And SourceFamily = NBGFamily And SourceShare + NBGShare &lt;&gt; 1 And NBGCst &lt;&gt; SourceCst) Then\n            If IsError(Repetition) = False Then\n            GoTo Line1\n\n              Else: GoTo Line2\n\n              End If\n\n\n\n       Line2:\n              'Customization of the Issue_SumofShares sheet to show the NBG Data Row , Cst, SOP , Product, Responsible,Family , Carmaker , Share , Status and the GeoRegion of the data which the condition applies to\n\n\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"A\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, ProjectID).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"B\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Customer).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"C\").Value = GetMonthAndQuarter(Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, SOP).Value)\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"D\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Product).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"E\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Family).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"F\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Project).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"G\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, carmaker).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"H\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Share).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"I\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Responsible).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"K\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, Status).Value\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"L\").Value = Worksheets(NBG_RegionaDataWorksheetName).Cells(Row_T, \"BO\").Value\n            ' Region As String\n            Region = \"\"\n\n            'Add any other GeoRegion which is also responsible in the recorded data\n\n\n            If Worksheets(NBG_DataWorksheetName).Cells(Row_T, \"BC\") Then\n            Region = Region + \"@EMEA\"\n            End If\n\n            If Worksheets(NBG_DataWorksheetName).Cells(Row_T, \"BD\") Then\n            Region = Region + \"@AMERICAS\"\n            End If\n\n            If Worksheets(NBG_DataWorksheetName).Cells(Row_T, \"BE\") Then\n            Region = Region + \"@GCSA\"\n            End If\n\n            If Worksheets(NBG_DataWorksheetName).Cells(Row_T, \"BF\") Then\n            Region = Region + \"@JAPAN&amp;KOREA\"\n            End If\n            Worksheets(Issue_SumofSharesWorksheetName).Cells(3 + Issue_SumofSharesCnt, \"J\").Value = Region\n\n\n\n\n\n            'Count the number of the cases recorded\n\n            Issue_SumofSharesCnt = Issue_SumofSharesCnt + 1\n\n            'If there is no items , the Message to show\n\n        ElseIf (Worksheets(NBG_SourceRegionDataWorksheetName).Cells(Row_S, SOP).Value = \"There are no items to show in this view.\") Then\n\n     End If\n\n  Line1:\n\n     Next Row_T\n\n     Next Row_S\n</code></pre>\n"}, {"tags": ["vba", "macros"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7321895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bc491f904d2705e517dc728d4a2920?s=128&d=identicon&r=PG&f=1", "display_name": "JakeJake", "link": "https://stackoverflow.com/users/7321895/jakejake"}, "edited": false, "score": 0, "creation_date": 1482308996, "post_id": 41252146, "comment_id": 69716666, "body": "Unfortunately, results are the same as in my example: - whole document gets Landscape margins - landscape page gets rotated back to portrait - section break is ignored"}], "tags": [], "owner": {"reputation": 1, "user_id": 7323113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a479ed2b5f19fcf5c3821dd954c0b80?s=128&d=identicon&r=PG&f=1", "display_name": "Xproto", "link": "https://stackoverflow.com/users/7323113/xproto"}, "is_accepted": false, "score": 0, "last_activity_date": 1482272336, "creation_date": 1482272336, "answer_id": 41252146, "question_id": 41246864, "link": "https://stackoverflow.com/questions/41246864/word-2007-10-vba-macro-to-change-pagesetup-with-regard-to-page-orientation/41252146#41252146", "title": "Word 2007/10 VBA macro to change PageSetup with regard to Page Orientation", "body": "<p>You can try with code found and adapted from <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-mso_other/macro-that-affects-margins-but-not-orientation/fd3b2788-2529-4f56-abee-e193eefd8b9f\" rel=\"nofollow noreferrer\">answers.microsoft.com</a>: </p>\n\n<pre><code>With ActiveDocument.PageSetup\n    If .Orientation = wdOrientPortrait Then\n        .PaperSize = wdPaperLetter\n        .TopMargin = CentimetersToPoints(2.23)\n        .LeftMargin = CentimetersToPoints(3.17)\n        .RightMargin = CentimetersToPoints(3.17)\n        .BottomMargin = CentimetersToPoints(2.21)\n    Else\n        .PaperSize = wdPaperLetter\n        .TopMargin = CentimetersToPoints(3.17)\n        .LeftMargin = CentimetersToPoints(2.21)\n        .RightMargin = CentimetersToPoints(2.23)\n        .BottomMargin = CentimetersToPoints(3.17)\n    End If\nEnd With\n</code></pre>\n\n<p>Let me know if that code works for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 7321895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bc491f904d2705e517dc728d4a2920?s=128&d=identicon&r=PG&f=1", "display_name": "JakeJake", "link": "https://stackoverflow.com/users/7321895/jakejake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1185, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1482272336, "creation_date": 1482250991, "question_id": 41246864, "link": "https://stackoverflow.com/questions/41246864/word-2007-10-vba-macro-to-change-pagesetup-with-regard-to-page-orientation", "title": "Word 2007/10 VBA macro to change PageSetup with regard to Page Orientation", "body": "<p>On my position we are likely to format check documents that contain numerous sections due to change of page orientation. There are given restrictions on what should be the dimensions of margins size for Portrait and Landscape orientation. \nWhat I want to achieve is a macro that would go through the currently opened document, check the orientation of each of the sections and adjust the Margins/Headers/Paper Size (which are different depending on whether the page is portrait or landscape)\nHere is what I got so far, but it does only change the Margins to ones from Landscape setup and disregards the header/footer:</p>\n\n<pre><code> If PageSetup.Orientation = wdOrientPortrait Then\n    PageSetup.LeftMargin = CentimetersToPoints(3.17)\n    PageSetup.RightMargin = CentimetersToPoints(3.17)\n    PageSetup.TopMargin = CentimetersToPoints(2.23)\n    PageSetup.BottomMargin = CentimetersToPoints(2.21)\n    PageSetup.PaperSize = wdPaperLetter\n    PageSetup.HeaderDistance = CentimetersToPoints(0.96)\n    PageSetup.FooterDistance = CentimetersToPoints(0.94)\nElseIf PageSetup.Orientation = wdLandscapeOrientation Then\n    PageSetup.LeftMargin = CentimetersToPoints(2.21)\n    PageSetup.RightMargin = CentimetersToPoints(2.23)\n    PageSetup.TopMargin = CentimetersToPoints(3.17)\n    PageSetup.BottomMargin = CentimetersToPoints(3.17)\n    PageSetup.PaperSize = wdPaperLetter\n    PageSetup.HeaderDistance = CentimetersToPoints(1.9)\n    PageSetup.FooterDistance = CentimetersToPoints(1.9)\n\nEnd If\nSelection.GoToNext wdGoToSection\n</code></pre>\n\n<p>Can you help me out with some examples or working code? The above shows my concept in the most simple way, but tbh I have no experience with creating word macros.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482250536, "post_id": 41246613, "comment_id": 69693423, "body": "<a href=\"http://www.java2s.com/Code/VBA-Excel-Access-Word/Excel/DoUntilloopandIsEmpty.htm\" rel=\"nofollow noreferrer\">java2s.com/Code/VBA-Excel-Access-Word/Excel/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1482250609, "post_id": 41246613, "comment_id": 69693470, "body": "This <a href=\"http://stackoverflow.com/documentation/excel-vba/918/methods-for-finding-the-last-used-row-or-column-in-a-worksheet#t=201612201616042176856\">Stack Overflow Excel-VBA documentation</a> on finding the last used row will help. Once you get the last row, you can loop from <code>3 to LastRow</code>"}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 6694700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U11Mp.jpg?s=128&g=1", "display_name": "Juuso Nyk&#228;nen", "link": "https://stackoverflow.com/users/6694700/juuso-nyk%c3%a4nen"}, "is_accepted": false, "score": 0, "last_activity_date": 1482307757, "creation_date": 1482307757, "answer_id": 41257960, "question_id": 41246613, "link": "https://stackoverflow.com/questions/41246613/do-while-loop-in-vba/41257960#41257960", "title": "do while loop in VBA", "body": "<p>Create an example of your desired end result, it is extremely unclear what you want to achieve at the moment. (Right now you are only describing a mess of implementation, not what the big picture is)</p>\n\n<p>Anyway I am assuming all you want to do is transpose your data, this code does the job:</p>\n\n<pre><code>Sub ASCVD()\n\n    Dim Data() As Variant\n    Dim nrow As Integer\n\n    Data() = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Value\n    nrow = UBound(Data(), 1)\n\n    ThisWorkbook.Sheets(\"Omnibus\").Activate\n    DoEvents \n    'Previous two lines needed so that the .Range(Cells(3.3), ... part works below\n\n    ThisWorkbook.Sheets(\"Omnibus\").Range(Cells(3, 3), Cells(16 + 2, nrow + 2)) = Application.WorksheetFunction.Transpose(Data()) \n    'Cells(rownumber, columnnumber). Cells(1,1) is cell A1\n    'Cells(3, 3) is same as cell C3.\n    'Cells(16 + 2, nrow + 2) in your example case will be cell F18, the last cell of your data.\n    '+2 because you want to start from C3, meaning all your data is shifted two cells down and two cells right\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 6694700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U11Mp.jpg?s=128&g=1", "display_name": "Juuso Nyk&#228;nen", "link": "https://stackoverflow.com/users/6694700/juuso-nyk%c3%a4nen"}, "is_accepted": false, "score": 0, "last_activity_date": 1482308399, "creation_date": 1482308399, "answer_id": 41258137, "question_id": 41246613, "link": "https://stackoverflow.com/questions/41246613/do-while-loop-in-vba/41258137#41258137", "title": "do while loop in VBA", "body": "<p>On second thought, what you are really asking is how to use a Do While loop:</p>\n\n<pre><code>Sub ASCVD()\n\n    Dim row As Integer\n    row = 2\n\n    Do While ThisWorkbook.Sheets(\"Sheet1\").Cells(row, 1) &lt;&gt; \"\" 'Loop until first cell is empty\n\n        ThisWorkbook.Sheets(\"Sheet1\").Range(\"A\" &amp; row &amp; \":I\" &amp; row).Select\n        Selection.Copy\n        Sheets(\"Omnibus\").Select\n        Range(\"C3\").Select\n        Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n            False, Transpose:=True\n        Range(\"B13\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Sheets(\"Sheet1\").Select\n        Range(\"J\" &amp; row).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n\n        row = row + 1\n    Loop\n\n\nEnd Sub\n</code></pre>\n\n<p>The code loops throw rows 2, 3, 4, 5 .... and stops when it finds a row where the first cell is empty</p>\n"}], "owner": {"reputation": 1, "user_id": 7321855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd63d90762bf0d6d37675ec7f2b8715?s=128&d=identicon&r=PG&f=1", "display_name": "Alyssa Chase", "link": "https://stackoverflow.com/users/7321855/alyssa-chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 973, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482308399, "creation_date": 1482250186, "last_edit_date": 1531164843, "question_id": 41246613, "link": "https://stackoverflow.com/questions/41246613/do-while-loop-in-vba", "title": "do while loop in VBA", "body": "<p>I have data that looks like the table shown below. The number of observations in this dataset varies each month. The columns remain the same. I would like to loop my code through each row until the row is empty. I think a do while loop would be appropriate, but I have not been successful in executing it thus far (of note, I am a complete VBA newbie.)</p>\n\n<p>A couple of other notes: The only thing that will change as the code runs through each observation of data is the Range selected in line 2 (I will want to move down to the next row of observations) and the final range selected for the Paste Special step in the final line of the code (again, I will want to move down to the next row of observations with each iteration).</p>\n\n<blockquote>\n<pre><code>Sample Data:\nSex   Age Race    Total Cholesterol   HDL-Cholesterol Systolic Blood Pressure Treatment for High Blood Pressure   Diabetes    Smoker  \nF 50  AA  300 90  200 Y   Y   Y   \nM 55  AA  290 90  200 Y   Y   Y   \nF 50  AA  300 90  200 N   N   N\n</code></pre>\n</blockquote>\n\n<p>Code that I need to loop through each non-empty row: </p>\n\n<pre><code>Sub ASCVD()\n\n    Sheets(\"Sheet1\").Select\n    Range(\"A2:I2\").Select\n    Selection.Copy\n    Sheets(\"Omnibus\").Select\n    Range(\"C3\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Range(\"B13\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"J2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thank you very much in advance for your help!!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1482249662, "post_id": 41246383, "comment_id": 69692837, "body": "just use <code>split(string,delimiter)(0)</code> and <code>(1)</code> why replace the space, just use that as the delim.  If Row # is in, then use (1) and (2), or you could consider <code>split(split(input,&quot;-&quot;),&quot; &quot;)</code> maybe a little faster, not sure though.  Also, once you&#39;re done no need to complete the loop, so consider, do until with flags rather than for next, although <code>exit for</code> is available"}], "answers": [{"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1482250257, "creation_date": 1482250257, "answer_id": 41246646, "question_id": 41246383, "link": "https://stackoverflow.com/questions/41246383/excel-vba-extract-numbers-from-cell-and-paste-into-two-different-columns/41246646#41246646", "title": "EXCEL vba - extract numbers from cell and paste into two different columns?", "body": "<p>If your PO and IN are always the same length in col B put</p>\n\n<pre><code>=MID(A2, 1, 12)\n</code></pre>\n\n<p>And in col C</p>\n\n<pre><code>=MID(A2, 14, 7)\n</code></pre>\n\n<p>However if your number change but are always the first two swap the above for,</p>\n\n<pre><code>=MID(A2,1,FIND(\" \",A2,1)-1)\n</code></pre>\n\n<p>And</p>\n\n<pre><code>=MID(A2, FIND(\" \", A2, 1)+1, 7)\n</code></pre>\n\n<p>Respectively.</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1482250464, "creation_date": 1482250464, "answer_id": 41246700, "question_id": 41246383, "link": "https://stackoverflow.com/questions/41246383/excel-vba-extract-numbers-from-cell-and-paste-into-two-different-columns/41246700#41246700", "title": "EXCEL vba - extract numbers from cell and paste into two different columns?", "body": "<p>just use <code>split(string,delimiter)(0)</code> and <code>(1)</code> why replace the space, just use that as the delim. If Row # is in, then use (1) and (2), or you could consider <code>split(split(input,\"-\"),\" \")</code> maybe a little faster, not sure though. Also, once you're done no need to complete the loop, so consider, do until with flags rather than for next, although <code>exit for</code> is available </p>\n\n<p>Formula wise, it could be done using something like this </p>\n\n<pre><code>=MID(D1,FIND(\"\u00e9\",SUBSTITUTE(D1,\" \",\"\u00e9\",3)),FIND(\"\u00e9\",SUBSTITUTE(D1,\" \",\"\u00e9\",4))-FIND(\"\u00e9\",SUBSTITUTE(D1,\" \",\"\u00e9\",3)))\n</code></pre>\n\n<p>and </p>\n\n<pre><code>=MID(D1,FIND(\"\u00e9\",SUBSTITUTE(D1,\" \",\"\u00e9\",4)),FIND(\"\u00e9\",SUBSTITUTE(D1,\" \",\"\u00e9\",5))-FIND(\"\u00e9\",SUBSTITUTE(D1,\" \",\"\u00e9\",4)))\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1332, "favorite_count": 0, "accepted_answer_id": 41246646, "answer_count": 2, "score": 0, "last_activity_date": 1482250959, "creation_date": 1482249458, "last_edit_date": 1482250959, "question_id": 41246383, "link": "https://stackoverflow.com/questions/41246383/excel-vba-extract-numbers-from-cell-and-paste-into-two-different-columns", "title": "EXCEL vba - extract numbers from cell and paste into two different columns?", "body": "<p>I have a spreadsheet with a load of random text and numbers in column A like so:</p>\n\n<pre><code>Column A\n\n    Row 1 = 471806121601 5205569 - 0007 Standard White Toilet Tissue 27 \n    Row 2 = 471814121601 5206177 - 0014 Premium White Toilet Tissue 6 \n    Row 3 = 471814121601 5206178 - 0007 Premium White Toilet Tissue 27\n    Row 4 = 471806121601 5206180 - 0014 Premium Kitchen Towel 2x75l 6 \n</code></pre>\n\n<p>I have about 2000 lines in total. In each cell, is a Purchase order number (12 digits) and an item number next to it (7 digits).</p>\n\n<p>I am trying to extract the po number and put it into column B and extract the item number and put it into column C</p>\n\n<pre><code>Column B        Column C\n471806121601    5205569 \n471814121601    5206177 \n471814121601    5206178 \n471806121601    5206180 \n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim cell As Range\nDim arr As Variant, arrElem As Variant\n\nWith Worksheets(\"Orders\") '&lt;--| change \"Strings\" to your actual worksheet name\n    For Each cell In .Range(\"A1\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        arr = Split(Replace(cell.Value, \"  \", \" \"), \" \") '&lt;--| change \"A\"'s to your actual relevant column index\n        For Each arrElem In arr\n          If IsNumeric(arrElem) Then\n            If Len(arrElem) = 12 Then cell.Offset(0, 1).Value = arrElem\n          End If\n        Next arrElem\n    Next cell\nEnd With\n\nDim cell2 As Range\nDim arr2 As Variant, arrElem2 As Variant\n\nWith Worksheets(\"Orders\") '&lt;--| change \"Strings\" to your actual worksheet name\n    For Each cell2 In .Range(\"A1\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        arr2 = Split(Replace(cell2.Value, \"  \", \" \"), \" \") '&lt;--| change \"A\"'s to your actual relevant column index\n        For Each arrElem2 In arr2\n          If IsNumeric(arrElem2) Then\n            If Len(arrElem2) = 7 Then cell2.Offset(0, 3).Value = arrElem2\n          End If\n        Next arrElem2\n    Next cell2\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This code does work. However it takes absolutely ages and only does one line at a time...Slowly.</p>\n\n<p>Is there a quicker way of doing this? Thanks</p>\n"}]