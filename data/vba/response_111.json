[{"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487805397, "post_id": 42404030, "comment_id": 71955026, "body": "Remove the <code>With</code> and <code>End With</code> and replace <code>ActiveSheet</code> with <code>ws</code>."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487805421, "post_id": 42404030, "comment_id": 71955036, "body": "Looping over sheets doesn&#39;t make them active. That is, the activesheet will remain the same <i>unless</i> you activate each sheet that you want. But you needn&#39;t do that. Just change your usage of <code>ActiveSheet</code> to the worksheet variable <code>ws</code>, and your code should work."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487805647, "post_id": 42404030, "comment_id": 71955135, "body": "You&#39;re also using an implicit call to ActiveSheet with <code>Cells</code>. You&#39;ll need to chage that to <code>ws.Cells</code>, or use <code>.Cells</code> (if you choose to exploit the <code>With ws</code> block)"}, {"owner": {"reputation": 3, "user_id": 7607787, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iar-uo_B5KI/AAAAAAAAAAI/AAAAAAAAAiU/RyCcdwiun6w/photo.jpg?sz=128", "display_name": "Liam Hendricken", "link": "https://stackoverflow.com/users/7607787/liam-hendricken"}, "edited": false, "score": 0, "creation_date": 1487805874, "post_id": 42404030, "comment_id": 71955204, "body": "Updated, but still can&#39;t get it; did I miss something?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487807365, "post_id": 42404030, "comment_id": 71955828, "body": "@LiamHendricken yes, there&#39;s also an implicit ActiveSheet reference in <code>Rows</code>, which needs to be <code>ws.Rows</code>."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 2, "creation_date": 1487807469, "post_id": 42404030, "comment_id": 71955861, "body": "My, look how much more amazingly readable and maintainable the code that I indented for you is. If you installed Rubberduck for indenting, you&#39;d be amazed all day long - you&#39;d get indenting and implicit ActiveSheet inspections for free."}], "answers": [{"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487807527, "post_id": 42404322, "comment_id": 71955884, "body": "still has an implicit reference to Activesheet <code>Rows</code>, so this code is buggy."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487829196, "post_id": 42404322, "comment_id": 71962681, "body": "@ThunderFrame I presume the OP wants to be able to run it on what ever the <b>ActiveWorkbook</b> is. If OP only wants to do it on the Workbook this macro resides, the <code>ActiveWorkbook</code> should be replaced by <code>ThisWorkbook</code>. Where do you see Activesheet? Anyway, <code>Rows.Count</code> is same independent of which worksheet (application limit)."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487831197, "post_id": 42404322, "comment_id": 71963459, "body": "@Patrick The For Loop is looping over Worksheets of the ActiveWorkbook <i>without</i> activating them. Calling <code>Rows</code> will be called against the ActiveSheet of the ActiveWorkbook, not the sheet that you&#39;re currently enumerating. In this particular instance, Rows is returning the Count, and as you point out, that will be the same for all Worksheets, but it would be better if the sheet reference was made explicit, or you could end up performing actions on rows on the wrong sheet."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1487807959, "last_edit_date": 1487807959, "creation_date": 1487806361, "answer_id": 42404322, "question_id": 42404030, "link": "https://stackoverflow.com/questions/42404030/looping-through-active-sheets-ignoring-particular-sheets/42404322#42404322", "title": "Looping through active sheets ignoring particular sheets", "body": "<p>You are missing the ws object. Try this (you also forgot to enable ScreenUpdate at the end):</p>\n\n<pre><code>Sub CleanRegionalSheets()\n    Application.ScreenUpdating = False\n    Dim ws As Worksheet\n    Dim lngx As Long\n\n    For Each ws In ActiveWorkbook.Worksheets\n        Select Case ws.Name\n            Case \"Raw Data\", \"Building Status\", \"Clean Data\"\n            Case Else\n                With ws\n                    For lngx = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 3 Step -1\n                        If .Cells(lngx, \"A\").Value &lt;&gt; .Name Then\n                            .Rows(lngx).Delete Shift:=xlUp\n                        End If\n                    Next\n                End With\n        End Select\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7607787, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iar-uo_B5KI/AAAAAAAAAAI/AAAAAAAAAiU/RyCcdwiun6w/photo.jpg?sz=128", "display_name": "Liam Hendricken", "link": "https://stackoverflow.com/users/7607787/liam-hendricken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 42404322, "answer_count": 1, "score": 0, "last_activity_date": 1561930947, "creation_date": 1487804972, "last_edit_date": 1561930947, "question_id": 42404030, "link": "https://stackoverflow.com/questions/42404030/looping-through-active-sheets-ignoring-particular-sheets", "title": "Looping through active sheets ignoring particular sheets", "body": "<p>I'm trying to loop through sheets, and remove row entries that are not equal to sheet name.</p>\n\n<p>I've if statements to ignore particular sheets.</p>\n\n<p>It will only work on one sheet and won't loop through all.</p>\n\n<pre><code>Sub CleanRegionalSheets()\n    Application.ScreenUpdating = False\n    Dim ws As Worksheet\n    Dim lngx As Long\n\n    With ws\n        For Each ws In ActiveWorkbook.Worksheets\n            If ActiveSheet.Name = \"Raw Data\" Then\n            ElseIf ActiveSheet.Name = \"Building Status\" Then\n            ElseIf ActiveSheet.Name = \"Clean Data\" Then\n            Else\n                For lngx = Cells(Rows.Count, \"A\").End(xlUp).Row To 3 Step -1\n                    If Cells(lngx, \"A\").Value &lt;&gt; ActiveSheet.Name Then\n                        Cells(lngx, \"A\").EntireRow.Delete Shift:=xlUp\n                    End If\n                Next\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Updated code, still not working:</p>\n\n<pre><code>Sub CleanRegionalSheets()\nApplication.ScreenUpdating = False\nDim ws As Worksheet\nDim lngx As Long\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name = \"Raw Data\" Then\n    ElseIf ws.Name = \"Building Status\" Then\n    ElseIf ws.Name = \"Clean Data\" Then\n    Else\n        For lngx = Cells(Rows.Count, \"A\").End(xlUp).Row To 3 Step -1\n            If Cells(lngx, \"A\").Value &lt;&gt; ws.Name Then\n                Cells(lngx, \"A\").EntireRow.Delete Shift:=xlUp\n            End If\n        Next\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487806953, "post_id": 42404001, "comment_id": 71955665, "body": "I&#39;m not sure I understand what this code is supposed to do. If the code adds &quot;the information one underneath the other&quot;, how is it &quot;simply replacing the cell that was previously saved&quot;? I suspect that you&#39;d have much better luck connecting with Excel via ADO.NET instead of using the object model.  It looks like you&#39;re using it more like a database anyway."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1487807505, "post_id": 42404001, "comment_id": 71955872, "body": "<code>oBook = oExcel.Workbooks.add</code> Every time you press the button you&#39;re creating a new workbook and saving it over the existing one.  You should be opening the existing workbook and just adding a line..."}, {"owner": {"reputation": 11, "user_id": 7607756, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NmZWGgna_64/AAAAAAAAAAI/AAAAAAAAT08/b9kr58mt8Pg/photo.jpg?sz=128", "display_name": "EDUARDO RIVAS", "link": "https://stackoverflow.com/users/7607756/eduardo-rivas"}, "edited": false, "score": 0, "creation_date": 1487809278, "post_id": 42404001, "comment_id": 71956441, "body": "Perfect, thank you, I&#39;ll try it"}, {"owner": {"reputation": 11, "user_id": 7607756, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NmZWGgna_64/AAAAAAAAAAI/AAAAAAAAT08/b9kr58mt8Pg/photo.jpg?sz=128", "display_name": "EDUARDO RIVAS", "link": "https://stackoverflow.com/users/7607756/eduardo-rivas"}, "edited": false, "score": 0, "creation_date": 1487809581, "post_id": 42404001, "comment_id": 71956527, "body": "Ready works very well, excellent thanks"}], "owner": {"reputation": 11, "user_id": 7607756, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NmZWGgna_64/AAAAAAAAAAI/AAAAAAAAT08/b9kr58mt8Pg/photo.jpg?sz=128", "display_name": "EDUARDO RIVAS", "link": "https://stackoverflow.com/users/7607756/eduardo-rivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487804991, "creation_date": 1487804842, "last_edit_date": 1487804991, "question_id": 42404001, "link": "https://stackoverflow.com/questions/42404001/save-in-excel-from-visual-basic-studio", "title": "Save in excel from visual basic studio", "body": "<p>I need to save from Visual Studio 2015 in Excel, the routine I have currently works for me but does not save the information as required, ie every time I press the save button you must add the information one underneath the other, which makes the code Is simply replacing the cell that was previously saved. Copy the code I use to save. I hope you can help me.</p>\n\n<pre><code>Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n\n    Dim oExcel As Object\n    Dim oBook As Object\n    Dim oSheet As Object\n\n    oExcel = CreateObject(\"Excel.Application\")\n    oBook = oExcel.Workbooks.add                   \n    oSheet = oBook.WorkSheets(1)\n\n     oSheet.Range(\"A9\").Value = \"Supply Ducts\"\n\n        oSheet. Range(\"C5:E5\"). Merge(True)\n        oSheet. Range(\"A5:B5\"). Merge(True)\n        oSheet.Range(\"A5\").Value = \"Project Name:\"\n\n        oSheet. Range(\"C6:E6\"). Merge(True)\n        oSheet. Range(\"A6:B6\"). Merge(True)\n        oSheet.Range(\"A6\").Value = \"Engineering Name:\"\n\n        oSheet. Range(\"C7:E7\"). Merge(True)\n        oSheet. Range(\"A7:B7\"). Merge(True)\n        oSheet.Range(\"A7\").Value = \"Company Name:\"\n\n        oSheet.Range(\"A10\").Value = \"tramo\"\n        oSheet.Range(\"B10\").Value = \"Caudal de Dise\u00f1o     PCM\"\n        oSheet.Range(\"C10\").Value = \"Velocidad de Dise\u00f1o     pie/min\"\n        oSheet.Range(\"D10\").Value = \"Factor de Fricci\u00f3n\"\n        oSheet.Range(\"E10\").Value = \"Di\u00e1metro Equivalente     in\"\n        oSheet.Range(\"F10\").Value = \"Alto del Ducto     in\"\n        oSheet.Range(\"G10\").Value = \"Ancho del Ducto     in\"\n        oSheet.Range(\"H10\").Value = \"Longitud del Ducto      mts\"\n        oSheet.Range(\"I10\").Value = \"Longitud del Ducto Equivalente     ft\"\n        oSheet.Range(\"J10\").Value = \"Espesor\"\n        oSheet.Range(\"K10\").Value = \"Calibre\"\n        oSheet.Range(\"L10\").Value = \"Kg Ductos\"\n        oSheet.Range(\"M10\").Value = \"M2 Aislante\"\n        oSheet.Range(\"N10\").Value = \"Delpa P    in.c.a.\"\n\n\n            oSheet.Range(\"A09\").End(XlDirection.xlDown).Offset(1, 0) = Tramo\n            oSheet.Range(\"B09\").End(XlDirection.xlDown).Offset(1, 0) = Qdise\u00f1o\n            oSheet.Range(\"C09\").End(XlDirection.xlDown).Offset(1, 0) = Velocidad2\n            oSheet.Range(\"D09\").End(XlDirection.xlDown).Offset(1, 0) = FactorFriccion\n            oSheet.Range(\"E09\").End(XlDirection.xlDown).Offset(1, 0) = Diameduct\n            oSheet.Range(\"F09\").End(XlDirection.xlDown).Offset(1, 0) = Larcduct\n            oSheet.Range(\"G09\").End(XlDirection.xlDown).Offset(1, 0) = Anchduct\n            oSheet.Range(\"H09\").End(XlDirection.xlDown).Offset(1, 0) = Longducto\n            oSheet.Range(\"I90\").End(XlDirection.xlDown).Offset(1, 0) = (Longducto * 3.28084)\n            oSheet.Range(\"J90\").End(XlDirection.xlDown).Offset(1, 0) = espesor\n            oSheet.Range(\"K09\").End(XlDirection.xlDown).Offset(1, 0) = calibre\n            oSheet.Range(\"L09\").End(XlDirection.xlDown).Offset(1, 0) = (Anchduct + Larcduct) * espesor * Longducto * 11.64\n            oSheet.Range(\"M09\").End(XlDirection.xlDown).Offset(1, 0) = (Anchduct + Larcduct + 4) * Longducto * 0.1016\n            oSheet.Range(\"N09\").End(XlDirection.xlDown).Offset(1, 0) = ((Longducto * 3.28084 * FactorFriccion) / 100) * 1.05\n\n\n            oExcel.Visible = True\n            oExcel.UserControl = True\n\n            oBook.SaveAs(Environ(\"UserProfile\") &amp; \"\\desktop\\Ductos1.xls\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "foreach"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487804708, "post_id": 42403583, "comment_id": 71954781, "body": "<code>For Each Object in Objects</code> dim as Object"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1487807868, "creation_date": 1487807868, "answer_id": 42404593, "question_id": 42403583, "link": "https://stackoverflow.com/questions/42403583/how-do-you-declare-a-for-each-loop-in-ms-access-database-relationships-in-vba/42404593#42404593", "title": "How do you declare a FOR EACH loop in MS Access database relationships in VBA?", "body": "<p>Can you try like this? It may work :) (without the rest of the code and not knowing what exactly is family it is hard to say):</p>\n\n<pre><code>DoCmd.OpenForm \"CheckIn\"\n\nDim person As variant\nDim family As variant\n\n'you should assign person to something actually.\n\n    FOR EACH person IN family\n\n        Forms!CheckIn![PASSHOLDER] = Me![BARCODE]\n        Forms!CheckIn![CHECKINTIME] = Now()\n        DoCmd.GoToRecord , , acNewRec\n\n    NEXT\n\n    DoCmd.Close acForm, \"CheckIn\", acSaveYes\n</code></pre>\n\n<p>This is how you iterate over a collection:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/y0e76axa(v=vs.100).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/y0e76axa(v=vs.100).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1487808418, "creation_date": 1487808418, "answer_id": 42404676, "question_id": 42403583, "link": "https://stackoverflow.com/questions/42403583/how-do-you-declare-a-for-each-loop-in-ms-access-database-relationships-in-vba/42404676#42404676", "title": "How do you declare a FOR EACH loop in MS Access database relationships in VBA?", "body": "<p>Assuming the normalized structure below between tables, simply use SQL. Recall forms are just visual representation of tables usually for data management (add, edit, save, delete). Since you know what to <em>add</em>, automate the data entry with backend querying.</p>\n\n<p>Family Details</p>\n\n<pre><code>FamilyID ...\n</code></pre>\n\n<p>Individual Members</p>\n\n<pre><code>MemberID, FamilyID ...\n</code></pre>\n\n<p>CheckIns</p>\n\n<pre><code>MemberID, PASSHOLDER, CHECKINTIME ...\n</code></pre>\n\n<p>So in VBA, if a family checks in press the button and run an append query which after refresh will show as individual records in the <em>CheckIn</em> form. This assumes some <em>Family</em> identifier textbox resides on form to be used in <code>WHERE</code> clause and in this case make it an unbound textbox including bar code since these fields will not be used for <em>user data entry</em> but <em>SQL-automated data entry</em>. Even consider an unbound form apart from actual <em>CheckIn</em> for this particular automation.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub FamilyCheckinCommand_Click()\n\n    If Not IsNull(Forms!CheckIn![FamilyID]) Then\n        strSQL = \"INSERT INTO CheckIn (MemberID, PASSHOLDER, CHECKINTIME)\" _\n                   &amp; \" SELECT m.MemberID,'\" &amp; Forms!CheckIn![BarCode] &amp; \"', Now()\" _\n                   &amp; \" FROM IndividualMembers m\" _\n                   &amp; \" WHERE m.FamilyID = \" &amp; Forms!CheckIn![FamilyID]\n\n        ' RUNS QUERY\n        CurrentDb.Execute strSQL, dbFailOnError\n\n        ' REFRESHES FORM\n        Me.Form.Requery\n    Else\n        Msgbox \"Please enter a family!\", vbExclamation, \"MISSING FAMILY\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 3842381, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/Lh15o.png?s=128&g=1", "display_name": "Lei-Lonnie", "link": "https://stackoverflow.com/users/3842381/lei-lonnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3599, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487808418, "creation_date": 1487802893, "question_id": 42403583, "link": "https://stackoverflow.com/questions/42403583/how-do-you-declare-a-for-each-loop-in-ms-access-database-relationships-in-vba", "title": "How do you declare a FOR EACH loop in MS Access database relationships in VBA?", "body": "<p>I have a database for tracking family passes and member usage at our pool. I have 3 tables, one for family details, one for every individual member, and one for tracking check-ins. </p>\n\n<p>There's a relationship that connects each individual record is appropriate family pass. Each individual is issued a pass that is scanned by a barcode scanner and checks them in using a simple form, I want to write a loop for a button that will check in every member of the family when they show up together, instead of having each individual scan their card. </p>\n\n<pre><code>DoCmd.OpenForm \"CheckIn\"\n\nDim person As ?\nDim family As ?\n\nFOR EACH person IN family\n\n    Forms!CheckIn![PASSHOLDER] = Me![BARCODE]\n    Forms!CheckIn![CHECKINTIME] = Now()\n    DoCmd.GoToRecord , , acNewRec\n\nNEXT\n\nDoCmd.Close acForm, \"CheckIn\", acSaveYes\n</code></pre>\n\n<p>Problem is I don't know enough about VBA to figure out how to accomplish this. Do I need to create an array first? How do I prepare my data from my relationships in order to execute my loop?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1487802303, "creation_date": 1487802303, "answer_id": 42403440, "question_id": 42403379, "link": "https://stackoverflow.com/questions/42403379/looping-through-each-column-and-finding-highlighted-cell/42403440#42403440", "title": "looping through each COLUMN and finding highlighted cell", "body": "<p>You're mixing the types. </p>\n\n<p>It looks like you just want to use the Row that the Header data ends on. </p>\n\n<p>Take out the <code>.Row</code> there, since you're setting <code>headerend</code> to be a cell address, not a specific value.  Then change <code>For row = 7 To headerend</code> to <code>For row = 7 To headerend.Row</code></p>\n\n<p>Or, change <code>Dim Headerend as Range</code> to <code>...as Long</code> and just do <code>headerEnd = header.End(xlDown).Row</code> (don't use <code>Set</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1487803957, "post_id": 42403535, "comment_id": 71954520, "body": "some color constants that might be useful are <a href=\"https://msdn.microsoft.com/en-us/library/aa265064\" rel=\"nofollow noreferrer\"><code>vbWhite</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197459\" rel=\"nofollow noreferrer\"><code>rgbWhite</code></a>"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 0, "last_activity_date": 1487837163, "last_edit_date": 1487837163, "creation_date": 1487802692, "answer_id": 42403535, "question_id": 42403379, "link": "https://stackoverflow.com/questions/42403379/looping-through-each-column-and-finding-highlighted-cell/42403535#42403535", "title": "looping through each COLUMN and finding highlighted cell", "body": "<p>You should be able to adapt this to suit your workbooks, see the comments for details</p>\n\n<pre><code>Dim aCell as Range\n' Use UsedRange to get the variable number of rows, \n' cycle through all the cells in that range\nFor Each aCell In ActiveSheet.Range(\"A1:K\" &amp; ActiveSheet.UsedRange.Rows.Count)\n    ' Test if fill colour is white (none)\n    If Not aCell.Interior.Color = RGB(255,255,255) Then\n        ' Insert new row in target sheet (could find last row instead)\n        ActiveWorkbook.Sheets(\"ThisOtherSheet\").Range(\"A1\").EntireRow.Insert\n        ' Paste entire row into target sheet\n        aCell.EntireRow.Copy Destination:=ActiveWorkbook.Sheets(\"ThisOtherSheet\").Range(\"A1\")\n    End If\nNext aCell\n</code></pre>\n\n<p>Alternatively to find the last row, if you know the range is continuous (no blanks) then you can use <code>End(xlDown)</code> like you had done, and like below</p>\n\n<pre><code>For Each aCell In ActiveSheet.Range(\"A1:K\" &amp; ActiveSheet.Range(\"K1\").End(xlDown))\n</code></pre>\n\n<p>I'd guess you don't want to copy the same row multiple times if you've already copied it. You could do this by keeping an array or string with previously copied row numbers and checking before copying again, or use Excel's unique functions to strip the list down after copying.</p>\n\n<p>Hope this helps.</p>\n\n<p>Aside:</p>\n\n<p>You're using a <code>With</code> block but not taking advantage of it, you need to put a dot <code>.</code> before your <code>Range</code> objects to specify that they're in your <code>With</code> sheet. Like so</p>\n\n<pre><code>Dim myRange as Range\nWith ActiveSheet\n    Set myRange = .Range(\"A1:C10\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 42403535, "answer_count": 2, "score": 0, "last_activity_date": 1487837163, "creation_date": 1487801999, "question_id": 42403379, "link": "https://stackoverflow.com/questions/42403379/looping-through-each-column-and-finding-highlighted-cell", "title": "looping through each COLUMN and finding highlighted cell", "body": "<p>I am having difficulty looping through each column before looping through the next row. The number of columns is fixed (A:K) with an unknown number of rows. The goal is to find highlighted cells (no distinct color.. and I figured the best way to do this is to code \"If Not No Fill\") and copy that whole row to another workbook. This is what I have so far and I am stuck:</p>\n\n<pre><code>Option Explicit\nSub Approval_Flow()\nDim AppFlowWkb As Workbook, ConfigWkb As Workbook\nDim AppFlowWkst As Worksheet, ConfigWkst As Worksheet\nDim header As Range, headerend As Range\nDim row As Long, column As Long\n\nSet AppFlowWkb = Workbooks.Open(\"C:\\Users\\clara\\Documents\\Templates and Scripts\\Approval Flow Change Log.xlsx\")\nSet ConfigWkb = ThisWorkbook\nSet AppFlowWkst = AppFlowWkb.Sheets(\"Editor\")\nSet ConfigWkst = ConfigWkb.Worksheets(\"Approval Flows\")\n\nWith ConfigWkb\n    Set header = Range(\"A7\").Cells\n    If Not header Is Nothing Then\n        Set headerend = header.End(xlDown).row\n    For row = 7 To headerend\n        For j = 1 To 11\n            'if cell is filled (If Not No Fill), copy that whole row to another workbook\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>I am getting an error with the Set headerend line, but I am trying to select the last row to use it in my for loop. I appreciate any help and guidance. Thanks in advance! </p>\n"}, {"tags": ["vba", "excel-2010", "internet-explorer-11"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1487801421, "post_id": 42403210, "comment_id": 71953473, "body": "looks like maybe you need a ready/waiting loop? (Search that term here on SO I&#39;m sure you&#39;ll find exmaples of implementing that) The idea is that <i>navigate</i> doesn&#39;t happen instantly, and while the page is loading, the browser may not be available for automation requests, etc."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487802060, "post_id": 42403210, "comment_id": 71953768, "body": "Not in the above sample code, but I did have the following in the code: &quot;Do&lt;cr&gt;DoEvents&lt;cr&gt;Loop Until ie.ReadyState = READYSTATE_COMPLETE&quot; and it gives me the same error on the Loop Until line."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487802337, "post_id": 42403210, "comment_id": 71953884, "body": "And if I run debug and just let it sit (I can see it brought up on IE, I still get the error anyway)."}], "answers": [{"comments": [{"owner": {"reputation": 13017, "user_id": 2103202, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6559847a5794fb0c52402841b76db522?s=128&d=identicon&r=PG", "display_name": "Anmol Saraf", "link": "https://stackoverflow.com/users/2103202/anmol-saraf"}, "edited": false, "score": 0, "creation_date": 1509435444, "post_id": 42404064, "comment_id": 81006642, "body": "Worked for me. Awesome. Thanks. Just curious to know how did you figured it out? Let me know please :)"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 13017, "user_id": 2103202, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6559847a5794fb0c52402841b76db522?s=128&d=identicon&r=PG", "display_name": "Anmol Saraf", "link": "https://stackoverflow.com/users/2103202/anmol-saraf"}, "edited": false, "score": 0, "creation_date": 1509462584, "post_id": 42404064, "comment_id": 81023814, "body": "I kept on searching for answers on the web. I don&#39;t remember if I found it here or elsewhere, but I saw someone else had done their code using the above lines and so I tried it and it worked."}], "tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": true, "score": 9, "last_activity_date": 1487805171, "creation_date": 1487805171, "answer_id": 42404064, "question_id": 42403210, "link": "https://stackoverflow.com/questions/42403210/internet-explorer-vba-automation-error-the-object-invoked-has-disconnected-from/42404064#42404064", "title": "Internet Explorer VBA Automation Error: The object Invoked has disconnected from its clients", "body": "<p>Changing to:</p>\n\n<pre><code>Dim ie As InternetExplorer\nSet ie = New InternetExplorerMedium\n...\n</code></pre>\n\n<p>Solved the problem. Plus I did need to add back the Do loop mentioned in the comments:</p>\n\n<pre><code>Do\n    DoEvents\nLoop Until ie.ReadyState = READYSTATE_COMPLETE\n</code></pre>\n"}], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16266, "favorite_count": 2, "accepted_answer_id": 42404064, "answer_count": 1, "score": 6, "last_activity_date": 1591102280, "creation_date": 1487801244, "last_edit_date": 1571839758, "question_id": 42403210, "link": "https://stackoverflow.com/questions/42403210/internet-explorer-vba-automation-error-the-object-invoked-has-disconnected-from", "title": "Internet Explorer VBA Automation Error: The object Invoked has disconnected from its clients", "body": "<p>I'm trying to write code that will read a value from Excel, look it up in an internal web based system and store the results back in the Excel. It reads the Excel with no problem, opens Internet Explorer with no problem, but when I then try to reference what's been opened, I get the above error. The line \"ie.Navigate url\" works, but the next line \"Set DOC = ie.Document\" generates the error. Any ideas on what's causing this? Here's my code:</p>\n\n<pre><code>Public Sub getClient()\n  Dim xOpen As Boolean\n  xOpen = False\n  Dim row As Long\n\n  Dim xL As Excel.Application\n  Set xL = New Excel.Application\n  xL.Visible = False\n  Dim wb As Excel.Workbook\n  Dim sh As Excel.Worksheet\n\n  'Change the name as needed, out put in some facility to input it or \n  'process multiples...\n  Dim filename As String\n  filename = \"auditLookup.xlsx\"\n  Set wb = xL.Workbooks.Open(getPath(\"Audit\") + filename)\n  xOpen = True\n  Set sh = wb.Sheets(1)\n\n  Dim ie As Variant\n  Set ie = CreateObject(\"InternetExplorer.Application\")\n  ie.Visible = True\n\n  Dim DOC As HTMLDocument\n  Dim idx As Integer\n  Dim data As String\n\n  Dim links As Variant\n  Dim lnk As Variant\n  Dim iRow As Long\n  iRow = 2            'Assume headers\n\n  Dim clientName As String\n  Dim clientID As String\n  Dim nameFound As Boolean\n  Dim idFound As Boolean\n  Dim url As String\n\n  While sh.Cells(iRow, 1) &lt;&gt; \"\"\n    'Just in case these IDs are ever prefixed with zeroes, I'm inserting \n    'some random character in front, but removing it of course when \n    'processing.\n    url = \"https://.../\" +  mid(sh.Cells(iRow, 1), 2)\n    ie.navigate url\n    Set DOC = ie.Document\n\n    'Search td until we find \"Name:\" then the next td will be the name. \n    'Then search for \"P1 ID (ACES):\" and the next td with be that.\n    Set links = DOC.getElementsByTagName(\"td\")\n    clientName = \"\"\n    clientID = \"\"\n    nameFound = False\n    idFound = False\n    For Each lnk In links\n        data = lnk.innerText\n        If nameFound Then\n            clientName = data\n        ElseIf idFound Then\n            clientID = data\n        End If\n        If nameFound And idFound Then\n            Exit For\n        End If\n\n        If data = \"Name:\" Then\n            nameFound = True\n        ElseIf data = \"P1 ID (ACES):\" Then\n            idFound = True\n        End If\n    Next\n    sh.Cells(iRow, 2) = clientName\n    sh.Cells(iRow, 2) = clientID\n    iRow = iRow + 1\n  Wend\n\n  Set ie = Nothing\n  If xOpen Then\n    wb.Save\n    Set wb = Nothing\n    xL.Quit\n    Set xL = Nothing\n    Set sh = Nothing\n    xOpen = False\n  End If\nExit Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1487804848, "post_id": 42402919, "comment_id": 71954825, "body": "If the Theme Colors was exported to a <i>.xml</i> file, you can simply set (load) the presentation SlideMaster to it: <code>ActivePresentation.SlideMaster.Theme.ThemeColorScheme.Load &quot;C:\\Theme Colors\\Office 2007 - 2010.xml&quot;</code> Change the path to where you store the xml file."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1487805938, "post_id": 42402919, "comment_id": 71955231, "body": "You should be able to find the custom color xml file in <code>%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Templates\\Document Themes\\Theme Colors</code>."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1487860836, "post_id": 42402919, "comment_id": 71982864, "body": "The question&#39;s been answered below, but it&#39;s worth pointing out that ColorSchemes are there only for backward compatibility with PPT versions before 2007. For PPT 2007 and onward, you want to work with ColorThemes."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1487803122, "last_edit_date": 1487803122, "creation_date": 1487802693, "answer_id": 42403536, "question_id": 42402919, "link": "https://stackoverflow.com/questions/42402919/powerpoint-vba-change-color-scheme/42403536#42403536", "title": "Powerpoint VBA - Change Color Scheme", "body": "<p>Changing color schemes in PowerPoint should be like this:</p>\n\n<p><code>ActivePresentation.SlideMaster.Theme.ThemeColorScheme(msoThemeAccent1) = RGB(1, 2, 3)</code> </p>\n\n<p>There is a whole answer here:</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_powerpoint-mso_winother/change-color-theme-using-vba-in-powerpoint/0efe38ad-36cb-4df7-b6e6-ed389c364f53\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_powerpoint-mso_winother/change-color-theme-using-vba-in-powerpoint/0efe38ad-36cb-4df7-b6e6-ed389c364f53</a></p>\n\n<pre><code>Sub mkThemeCols()\nWith ActivePresentation.SlideMaster.Theme\n.ThemeColorScheme(msoThemeAccent1) = RGB(255, 0, 0)\n.ThemeColorScheme(msoThemeAccent2) = RGB(0, 255, 0)\n.ThemeColorScheme(msoThemeAccent3) = RGB(0, 255, 255)\n.ThemeColorScheme(msoThemeAccent4) = RGB(255, 255, 0)\n.ThemeColorScheme(msoThemeAccent5) = RGB(23, 255, 10)\n.ThemeColorScheme(msoThemeAccent6) = RGB(23, 255, 100)\n.ThemeColorScheme(msoThemeDark1) = RGB(23, 0, 0)\n.ThemeColorScheme(msoThemeDark2) = RGB(23, 23, 23)\n.ThemeColorScheme.Save Environ(\"APPDATA\") &amp; \"\\Microsoft\\Templates\\Document Themes\\Theme Colors\\myNew Theme.xml\"\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1232, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1487803122, "creation_date": 1487800067, "question_id": 42402919, "link": "https://stackoverflow.com/questions/42402919/powerpoint-vba-change-color-scheme", "title": "Powerpoint VBA - Change Color Scheme", "body": "<p>I need to change color scheme of presentation to Office 2007-2010 though VBA code. How can I do that?</p>\n\n<p><a href=\"https://i.stack.imgur.com/PVHXX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PVHXX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried something like below but doesn't seem to work.</p>\n\n<pre><code>ActivePresentation.ColorSchemes.Add\nActivePresentation.ColorSchemes(1).Colors(ppAccent1).RGB = RGB(0, 0, 1)\nActivePresentation.ColorSchemes(1).Colors(ppAccent1).RGB = RGB(0, 0, 2)\n</code></pre>\n"}, {"tags": ["vba", "fonts", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7607292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9016b97d58c4554ba488da9f5a73a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7607292/joe"}, "edited": false, "score": 0, "creation_date": 1487902935, "post_id": 42412350, "comment_id": 72004664, "body": "This was perfect. Thanks! I used both because I had books inside the book."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 0, "last_activity_date": 1487843856, "creation_date": 1487843856, "answer_id": 42412350, "question_id": 42402385, "link": "https://stackoverflow.com/questions/42402385/two-fonts-in-the-header-using-vba/42412350#42412350", "title": "Two fonts in the header using VBA", "body": "<p>By extending the Selection to the end of the Header you include the paragraph mark. Setting the Font then changes the font for the entire paragraph.</p>\n\n<p>When coding in Word you should avoid using the Selection object as far as possible, especially when working with Headers and Footers. The code below should work for you.</p>\n\n<pre><code>Sub SetHeaderText()\n    Dim text1 As String\n    Dim text2 As String\n    Dim rng As Range\n\n    With ActiveDocument.Sections(1)\n        'Changing the text\n        text1 = \"English Chapter 1\"\n        text2 = \"Korean Chapter 1\"\n        Set rng = .Headers(wdHeaderFooterPrimary).Range\n        rng.Text = text1 &amp; vbTab &amp; text2\n        rng.MoveStart Unit:=wdCharacter, Count:=Len(text1) + 1\n        rng.Font.Name = \"Batang\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>If the text that you are adding to the header really is just the chapter number then you could simplify your code and really speed things up by doing something like this:</p>\n\n<pre><code>Sub SetHeaderText()\n    Dim text1 As String\n    Dim text2 As String\n    Dim rng As Range\n    Dim sec As Section\n    Dim num As Integer\n\n    num = 1\n    For Each sec In ActiveDocument.Sections\n        'Changing the text\n        text1 = \"English Chapter \" &amp; num\n        text2 = \"Korean Chapter \" &amp; num\n        Set rng = .Headers(wdHeaderFooterPrimary).Range\n        rng.Text = text1 &amp; vbTab &amp; text2\n        rng.MoveStart Unit:=wdCharacter, Count:=Len(text1) + 1\n        rng.Font.Name = \"AR Julian\"\n        num = num + 1\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7607292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9016b97d58c4554ba488da9f5a73a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7607292/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 42412350, "answer_count": 1, "score": 0, "last_activity_date": 1487843856, "creation_date": 1487797964, "last_edit_date": 1487801068, "question_id": 42402385, "link": "https://stackoverflow.com/questions/42402385/two-fonts-in-the-header-using-vba", "title": "Two fonts in the header using VBA", "body": "<p>My Word document has about 260 sections with unique headers per section. Each header needs to have the left side in one text/font and the right side in another. It is for a series of bilingual books I'm making in different languages. Here is the code I've attempted to do, but it isn't changing the font for the second half of the header. The first 4 lines of code successfully change the header text, but the next part of code does not change the font. As an FYI, the part that says \"Korean Chapter 1\" will be in Korean and use Korean fonts.</p>\n\n<pre><code>Dim text1 As String\nDim text2 As String\n\nWith ActiveDocument.Sections(1)\n'Changing the text\ntext1 = \"English Chapter 1\"\ntext2 = \"Korean Chapter 1\"\n.Headers(wdHeaderFooterPrimary).Range.Text = text1 &amp; vbTab &amp; text2\n'Changing the font\nActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\nSelection.MoveRight Unit:=wdCharacter, Count:=Len(text1)\nSelection.EndKey Unit:=wdStory, Extend:=wdExtend\nSelection.Font.Name = \"Batang\"\nEnd With\n\nWith ActiveDocument.Sections(2)\n'Changing the text\ntext1 = \"English Chapter 2\"\ntext2 = \"Korean Chapter 2\"\n.Headers(wdHeaderFooterPrimary).Range.Text = text1 &amp; vbTab &amp; text2\n'Changing the font\nSeekView = wdSeekCurrentPageHeader\nSelection.MoveRight Unit:=wdCharacter, Count:=Len(text1)\nSelection.EndKey Unit:=wdStory, Extend:=wdExtend\nSelection.Font.Name = \"Batang\"\nEnd With\n\nWith ActiveDocument.Sections(3)... continuing until the last section\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 2, "creation_date": 1487798766, "post_id": 42402336, "comment_id": 71952157, "body": "How the userform is showing, modal or not? Use &quot;userformName.Show 0&quot; to be able to work in another workbook or worksheet."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487799002, "post_id": 42402336, "comment_id": 71952292, "body": "do you disable <code>application.screenupdating = false</code> and not re-enable it again?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487800280, "post_id": 42402336, "comment_id": 71952937, "body": "Can you show your code?"}, {"owner": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "edited": false, "score": 0, "creation_date": 1487807332, "post_id": 42402336, "comment_id": 71955811, "body": "I edit my question in order to add the code"}], "owner": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487803450, "creation_date": 1487797806, "last_edit_date": 1487803450, "question_id": 42402336, "link": "https://stackoverflow.com/questions/42402336/how-to-show-on-top-one-workbook-after-a-filter-in-vba", "title": "How to show on top one workbook after a filter in vba", "body": "<p>I have a code that do a filter on vba and in order to put the data that is going to use in the filter i use an userform, that part is working (in part thanks to the users of this page so thanks again.. :P) but the issue now is that if there is another book already open it doesn't bring the one i'm using to the top.\nAnother issue is that i use the <code>Workbooks(\"Database 2017 plus\").Windows(1).Visible = True/False</code> in order to hide the book when the userform is shown but at the same time don't hide others books that were open in that moment and it work but as long as the userform is active i can't use those other books and i' d like to if its possible.</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>Private Sub AllIssues_Click()\nUnload Me\nWorkbooks(\"Database 2017 plus\").Windows(1).Visible = True\n\nWith Workbooks(\"Database 2017 plus\")\n\nsheets(\"reported\").Visible = True\nsheets(\"reported\").Select\nsheets(\"datos\").Unprotect\nsheets(\"datos\").Visible = True\nsheets(\"principal\").Visible = True\nsheets(\"History slot\").Unprotect\nsheets(\"history slot\").Visible = True\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And about the other issue with show 0 works thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487800404, "post_id": 42402192, "comment_id": 71952989, "body": "One quick way is to put this in a cell, say <code>A1</code> <code>=&quot;Total items for Alan: &quot; &amp; [sum of values to equal 15]</code>. Then click the Chart Title box, and just type <code>=A1</code>.  Then whatever <code>A1</code> says, the chart Title will update to that.  AFAIK you can&#39;t save a step and put <code>=&quot;Total Items for Alan: &quot; &amp; B1</code> in the chart title formula, it&#39;ll throw an error."}, {"owner": {"reputation": 729, "user_id": 5248324, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/OfvTl.jpg?s=128&g=1", "display_name": "ToMakPo", "link": "https://stackoverflow.com/users/5248324/tomakpo"}, "edited": false, "score": 0, "creation_date": 1487800702, "post_id": 42402192, "comment_id": 71953137, "body": "Can you add a screen shot of what it currently looks like and then what you want it to look like?"}, {"owner": {"reputation": 13, "user_id": 5623840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/964af61405872188229f498fb659ceda?s=128&d=identicon&r=PG&f=1", "display_name": "AlanGrant", "link": "https://stackoverflow.com/users/5623840/alangrant"}, "edited": false, "score": 0, "creation_date": 1487819740, "post_id": 42402192, "comment_id": 71959442, "body": "Thank you for your quick reply. You gave me a good idea with the A1 cell suggestion and it works great (I should have thought of that too). Thanks again."}], "owner": {"reputation": 13, "user_id": 5623840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/964af61405872188229f498fb659ceda?s=128&d=identicon&r=PG&f=1", "display_name": "AlanGrant", "link": "https://stackoverflow.com/users/5623840/alangrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487797206, "creation_date": 1487797206, "question_id": 42402192, "link": "https://stackoverflow.com/questions/42402192/total-label-on-chart-x-axis", "title": "Total label on chart x-axis", "body": "<p>I have a pivot table containing a user name with item names and quantity within it (eg: User \"Alan\" has 10 of \"Hat\" and 5 of \"Coat\", to keep it simple).</p>\n\n<p>In the generated pivot chart column graph, instead of just the x-axis label \"Alan\",  is it possible to display \"Total items for Alan: 15\"? How would this be coded?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "edited": false, "score": 0, "creation_date": 1487798692, "post_id": 42402263, "comment_id": 71952113, "body": "That is ideal. Thank you. It automatically saves them into documents, which is fine as there will be several different users of the workbook on several different computers, and they will all have such a folder."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "edited": false, "score": 0, "creation_date": 1487798839, "post_id": 42402263, "comment_id": 71952194, "body": "Glad it worked. I would say it&#39;s better practice to specify a path too."}, {"owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "edited": false, "score": 0, "creation_date": 1487875601, "post_id": 42402263, "comment_id": 71993060, "body": "Thanks, yes, I agree. But the teachers will likely do their classes&#39; reports at home, or at different centers around the city, and I couldn&#39;t expect them to edit the module."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1487797539, "creation_date": 1487797539, "answer_id": 42402263, "question_id": 42402008, "link": "https://stackoverflow.com/questions/42402008/splitting-sheets-into-separate-workbooks/42402263#42402263", "title": "Splitting Sheets into Separate Workbooks", "body": "<p>Maybe this will start you off, just some simple code to save each sheet as a new workbook. You would probably need some check that the sheet name is a valid file name.</p>\n\n<pre><code>Sub x()\n\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Sheets\n    ws.Copy\n    ActiveWorkbook.Close SaveChanges:=True, Filename:=ws.Name &amp; \".xlsx\"\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 42402263, "answer_count": 1, "score": 0, "last_activity_date": 1487797539, "creation_date": 1487796620, "question_id": 42402008, "link": "https://stackoverflow.com/questions/42402008/splitting-sheets-into-separate-workbooks", "title": "Splitting Sheets into Separate Workbooks", "body": "<p>I have a workbook with a master sheet for school report cards. I have a macro applied to a button for exporting information from the master sheet to separate, newly-generated sheets in the same workbook. A1:C71 is the template and goes to every new sheet, and the following columns of info, from D1:71 to Q1:71, each appear in separate sheets (always in D1:71).</p>\n\n<p>Here's the screenshot (<a href=\"https://imgur.com/a/ZDOVb\" rel=\"nofollow noreferrer\">http://imgur.com/a/ZDOVb</a>), and here's the code:</p>\n\n<pre><code>`Option Explicit\n\nSub parse_data()\n    Dim studsSht As Worksheet\n    Dim cell As Range\n    Dim stud As Variant\n\n    Set studsSht = Worksheets(\"Input\") \n    With CreateObject(\"Scripting.Dictionary\")\n        For Each cell In studsSht.Range(\"D7:Q7\").SpecialCells(xlCellTypeConstants, xlTextValues) \n            .Item(cell.Value) = .Item(cell.Value) &amp; cell.EntireColumn.Address(False, False) &amp; \",\" \n        Next\n        For Each stud In .keys \n            Intersect(studsSht.UsedRange, studsSht.Range(Left(.Item(stud), Len(.Item(stud)) - 1))).Copy Destination:=GetSheet(CStr(stud)).Range(\"D1\") \n        Next\n    End With\n\n    studsSht.Activate\nEnd Sub\n\nFunction GetSheet(shtName As String) As Worksheet\nOn Error Resume Next\nSet GetSheet = Worksheets(shtName)\nIf GetSheet Is Nothing Then\n    Set GetSheet = Sheets.Add(after:=Worksheets(Worksheets.Count))\n    GetSheet.Name = shtName\n    Sheets(\"Input\").Range(\"A1:C71\").Copy\n    GetSheet.Range(\"A1:D71\").PasteSpecial xlAll\n    GetSheet.Range(\"A1:B71\").EntireColumn.ColumnWidth = 17.57\n    GetSheet.Range(\"C1:C71\").EntireColumn.ColumnWidth = 54.14\n    GetSheet.Range(\"D1:D71\").EntireColumn.ColumnWidth = 22\nEnd If\nEnd Function`\n</code></pre>\n\n<p>I would now like to create a separate button to split the sheets into separate workbooks so that the master sheet can be kept for record keeping and the individual workbooks can be shared with parents online (without divulging the info of any kid to parents other than their own). I would like the workbooks to be saved with the existing name of the sheet, and wonder if there's a way to have the new workbooks automatically saved in the same folder as the original workbook without having to input a path name? (It does not share the same filename as any of the sheets).</p>\n\n<p>I tried finding other code and modifying it, but I just get single blank workbooks and I need as many as have been generated (preferably full of data!), which varies depending on the class size. Here's the pathetic attempt:</p>\n\n<pre><code>`Sub split_Reports()\n\nDim splitPath As String\n\nDim w As Workbook\nDim ws As Worksheet\n\nDim i As Long, j As Long\nDim lastr As Long\nDim wbkName As String\nDim wksName As String\n\nSet wsh = ThisWorkbook.Worksheets(1)\nsplitPath = \"G:\\splitWb\\\"\nSet w = Workbooks.Add\n\nFor i = 1 To lastr\n  wbkName = ws\n  w.Worksheets.Add(After:=w.Worksheets(Worksheets.Count)).Name = ws\n    w.SaveAs splitPath\n    w.Close\n    Set w = Workbooks.Add\nNext i\n\nEnd Sub`\n</code></pre>\n\n<p>I have learned so much, and yet I know so little.</p>\n"}, {"tags": ["c#", "sql", "oracle", "vba"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1487796406, "post_id": 42401871, "comment_id": 71950755, "body": "Are you saying you want your C# variable name <code>trainDate</code> to change according to the value of <code>trainType</code>? That would be terrible idea if it were possible, but it isn&#39;t. Or do I misunderstand you?"}, {"owner": {"reputation": 3, "user_id": 7606884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HmopwVzvXI0/AAAAAAAAAAI/AAAAAAAAB_I/wRG5yrK0Zgs/photo.jpg?sz=128", "display_name": "Ory Weaver", "link": "https://stackoverflow.com/users/7606884/ory-weaver"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1487854046, "post_id": 42401871, "comment_id": 71977599, "body": "I guess I really should have asked what would be the most efficient way to do the comparison of the dates of the different training types. I apologize I&#39;m really new at this."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1487859531, "post_id": 42401871, "comment_id": 71981823, "body": "I wouldn&#39;t worry about efficiency. Clarity is much more important. My first guess about what&#39;s going on here is that in Access, <code>RWT010</code> etc. are all date fields in a single row, but in Oracle you have multiple rows, and each row has a name field plus a single date field. And the name field is a string that could be <code>&quot;RWT010&quot;</code>, <code>&quot;RWT010BP&quot;</code>, or <code>&quot;RWP000&quot;</code>, Is that correct?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7606884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HmopwVzvXI0/AAAAAAAAAAI/AAAAAAAAB_I/wRG5yrK0Zgs/photo.jpg?sz=128", "display_name": "Ory Weaver", "link": "https://stackoverflow.com/users/7606884/ory-weaver"}, "edited": false, "score": 0, "creation_date": 1487970858, "post_id": 42419773, "comment_id": 72040411, "body": "Wow, that&#39;s a really good explanation and solution to my code. I got confused about how I got the training types and dates in the first place and then realized I had written the subqueries to handle each type. Good point about the injection vulnerability. There is a lot someone could do with that."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "reply_to_user": {"reputation": 3, "user_id": 7606884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HmopwVzvXI0/AAAAAAAAAAI/AAAAAAAAB_I/wRG5yrK0Zgs/photo.jpg?sz=128", "display_name": "Ory Weaver", "link": "https://stackoverflow.com/users/7606884/ory-weaver"}, "edited": false, "score": 0, "creation_date": 1487981935, "post_id": 42419773, "comment_id": 72044665, "body": "@OryWeaver Thanks. If it resolved the issue, you can mark it as the answer."}], "tags": [], "owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "is_accepted": true, "score": 0, "last_activity_date": 1487863411, "last_edit_date": 1495542309, "creation_date": 1487863411, "answer_id": 42419773, "question_id": 42401871, "link": "https://stackoverflow.com/questions/42401871/name-variable-from-oracle-sql-string-value-in-c/42419773#42419773", "title": "name variable from oracle sql string value in c#", "body": "<p>It looks like the original Access logic has one DB row with three date fields, <code>[RWT010]</code>, <code>[RWT010BP]</code>, and <code>[RWP000]</code>. But in Oracle that's been normalized so you're getting back multiple rows, each of which has a a datetime field named <code>[DATE_LATEST]</code>, and then name field called <code>[TYPE]</code> that's equal to <code>\"RWT010\"</code>, <code>\"RWT010BP\"</code>, or <code>\"RWP000\"</code>. </p>\n\n<p>And you were thinking, you want to handle those <code>RWP000</code> date values by name, just like in Access. You were right, that's the clearest way to do it, and I'll show you how. I misunderstood what you were asking. </p>\n\n<p>One way to do this would be to write an Oracle stored procedure that duplicates the Access logic. That's not the question you asked, but it's a legitimate way to do it. However, it would be more complicated than the Access version due to the change in the database, and anyway I haven't written Oracle SQL in years and I don't have an Oracle server handy to give me arbitrary, cryptic syntax errors about semicolons and whitespace. </p>\n\n<p>So what I'm going to do is write a loop in C# to grab the datetimes from the DB rows and put them in local variables, and then duplicate the Access logic in C# using those variables instead of fields. It'll be a little verbose compared to the Access version, but sometimes that's how it goes. </p>\n\n<pre><code>int idnum = Convert.ToInt32(Console.ReadLine());\n\nstring sql = \"SELECT EXPID, TYPE, DATE_LATEST FROM TRAINING_TABLE where expid =\" + idnum;\n\n//  I don't know how you're using this so I'll just declare it here \n//  and leave that to you.\nString dateLabel = \"\";\n\nOracleCommand cmd = new OracleCommand();\n\ncmd.Connection = conn;\n\ncmd.CommandText = sql;\n\nusing (DbDataReader reader = cmd.ExecuteReader())\n{\n    DateTime? RWT010 = null;\n    DateTime? RWT010BP = null;\n    DateTime? RWP000 = null;\n\n    //  No need to check reader.HasRows. If it has no rows, reader.Read()\n    //  will return false the first time, that's all. \n\n    while (reader.Read())\n    {\n        //  Doesn't look to me like expid is used\n        //int expid = reader.GetInt32(0);\n        string trainType = reader.GetString(1);\n        DateTime trainDate = reader.GetDateTime(2);\n\n        switch (trainType) {\n            case \"RWT010\":\n                RWT010 = trainDate;\n                break;\n            case \"RWT010BP\":\n                RWT010BP = trainDate;\n                break;\n            case \"RWP000\":\n                RWP000 = trainDate;\n                break;\n        }\n    }\n\n    if (RWT010 == null || RWT010BP &gt; RWT010) {\n        dateLabel = String.Format(\"RWT010BP: {0:d}\", RWT010BP);\n    } else {\n        dateLabel = String.Format(\"RWT010: {0:d} &amp; RWP000: {1:d}\", RWT010, RWP000); \n    }\n}\n</code></pre>\n\n<p>The original logic was this:</p>\n\n<pre><code>  If RWT010 isn't null, \n      Do A\n  Otherwise, if RWT010BP &gt; RWT010\n      ALSO do A\n  But if none of the above, \n      Do B\n</code></pre>\n\n<p>The first two branches do the exact same thing, so we can condense them both into one branch.</p>\n\n<p>\"Don't Repeat Yourself\", as they say. You don't want to return to this code a year from now, wonder if those two lines were required to be the same, and then guess wrong or else not notice that they are the same, and only change one or the other. It's just a mess. </p>\n\n<p>If you're not <a href=\"https://msdn.microsoft.com/en-us/library/system.string.format(v=vs.110).aspx\" rel=\"nofollow noreferrer\">familiar with String.Format()</a>, there's a lot to it. In the first argument string, <code>{0}</code> means \"insert the second argument here\"; <code>{1}</code> means \"insert the third\", and so on. The \":d\" inside the curly braces is optional; it means to pass \"d\" as format information to the value its inserting. <code>DateTime</code> will interpret that \"d\" to mean \"Short Date\". You could also do it like this:</p>\n\n<pre><code>dateLabel = String.Format(\"RWT010BP: {0}\", RWT010BP.Value.ToShortDateString());\n</code></pre>\n\n<p>Or like this:</p>\n\n<pre><code>dateLabel = \"RWT010BP: \" + RWT010BP.Value.ToShortDateString();\n</code></pre>\n\n<p>I have to use <code>RWT010BP.Value</code> in that line instead of just <code>RWT010BP</code> because <code>RWT010BP</code> is declared with a <code>?</code> after it. That makes it a \"nullable\" value. A regular <code>DateTime</code> can't be null, but we need to accommodate nulls here. </p>\n\n<p>If you're using C#6, you can do it like this, which I prefer. I didn't use it above because I don't know what version of C# you're on. Always prefer the least amount of \"noise\" cluttering up the code. </p>\n\n<pre><code>dateLabel = $\"RWT010BP: {RWT010BP:d}\";\n</code></pre>\n\n<p>That's the same \":d\" as in <code>String.Format(\"{0:d}\", ...)</code> above. </p>\n\n<p><strong>One more thing:</strong> <code>idnum</code> is an int, but don't ever concatenate a string value into a SQL string. That's a massive security vulnerability and people here will (rightly, I'm afraid) give you a very hard time for even contemplating it. </p>\n\n<p>Use <code>OracleCommand.Parameters</code> instead, <a href=\"https://stackoverflow.com/a/11048965/424129\">as shown in this answer</a>. I would have used that even in this case, personally, just as a conditioned reflex. </p>\n"}], "owner": {"reputation": 3, "user_id": 7606884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HmopwVzvXI0/AAAAAAAAAAI/AAAAAAAAB_I/wRG5yrK0Zgs/photo.jpg?sz=128", "display_name": "Ory Weaver", "link": "https://stackoverflow.com/users/7606884/ory-weaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 42419773, "answer_count": 1, "score": 0, "last_activity_date": 1487863411, "creation_date": 1487796169, "last_edit_date": 1487798956, "question_id": 42401871, "link": "https://stackoverflow.com/questions/42401871/name-variable-from-oracle-sql-string-value-in-c", "title": "name variable from oracle sql string value in c#", "body": "<p>This is my first project in c#. I have a little experience in Access VBA. I would like to move my apps over to be stand alone programs. I'm querying a table that has training types and dates. I would like to compare some of the types of training against each other based on the dates they were performed. The three training types are RWT010, RWP000, and RWT010BP. If RWT010BP exists and is newer it is the only one I need. Otherwise I need RWT010 and RWP000. I have figured out how to load the values into variables, but I need to be able to work with them. I would like the name of the dateTime value to be the trainType for the same row. That way I can compare them and output the right combination. </p>\n\n<p>My old Access logic looked like this:</p>\n\n<pre><code>LABEL_DATE: IIf(IsNull([RWT010]),\"RWT010BP: \" &amp; _\n     Format([RWT010BP],\"Short Date\"),IIf([RWT010BP]&gt;[RWT010],\"RWT010BP: \" &amp; _\n     Format([RWT010BP],\"Short Date\"),\"RWT010: \" &amp; _\n     Format([RWT010],\"Short Date\") &amp; \" &amp; \" &amp; \"RWP000: \" &amp; _\n     Format([RWP000],\"Short Date\")))\n</code></pre>\n\n<p>This is how far I've gotten in c#:</p>\n\n<pre><code>Console.Write(\"Enter ID: \");\n        int idnum = Convert.ToInt32(Console.ReadLine());\n        string sql = \"SELECT EXPID, TYPE, DATE_LATEST FROM TRAINING_TABLE where expid =\" + idnum;\n\n\n\n        OracleCommand cmd = new OracleCommand();\n\n       cmd.Connection = conn;\n\n        cmd.CommandText = sql;\n\n        using (DbDataReader reader = cmd.ExecuteReader())\n        {\n            if (reader.HasRows)\n            {\n\n                while (reader.Read())\n                {\n\n                    int expid = reader.GetInt32(0);\n                    string trainType = reader.GetString(1);\n                    DateTime trainDate = reader.GetDateTime(2); \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1506028743, "last_edit_date": 1506028743, "creation_date": 1487794565, "answer_id": 42401398, "question_id": 42401022, "link": "https://stackoverflow.com/questions/42401022/macro-changes-data-to-overwrite-previous-data/42401398#42401398", "title": "Macro changes data to overwrite previous data", "body": "<p>With a big sign, like in the World Wrestling Federation - <code>do not do this at home</code> - you may try like this:</p>\n\n<pre><code>Sub ttt()\n'\n' ttt Macro\n' top ten trades output\n'\n' Keyboard Shortcut: Ctrl+Shift+T\n\n\n' buys\n\n    Rows(\"3:3\").Select\n    Selection.AutoFilter\n\n    ActiveSheet.AutoFilter.Sort.SortFields.Add Key:=Range(\"D3\" _\n        ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveSheet.AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"A5:I14\").Select\n    Selection.Copy\n    Range(\"K3\").Select\n    ActiveSheet.paste\n    Application.CutCopyMode = False\n\n\n' sells\n\n    Rows(\"3:3\").AutoFilter\n    Rows(\"3:3\").AutoFilter\n\n\n\n    ActiveSheet.AutoFilter.Sort.SortFields.Add Key:=Range(\"E3\" _\n        ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveSheet.AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"A5:I14\").Select\n    Selection.Copy\n    Range(\"u3\").Select\n    ActiveSheet.paste\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>I have added and removed the autofilter, so it should be working. </p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1487795184, "creation_date": 1487795184, "answer_id": 42401584, "question_id": 42401022, "link": "https://stackoverflow.com/questions/42401022/macro-changes-data-to-overwrite-previous-data/42401584#42401584", "title": "Macro changes data to overwrite previous data", "body": "<p>If you record these steps using the Macro Recorder, you will find that it achieves it by simply including the following line between the two sorts:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\n</code></pre>\n\n<p>In your case that would be </p>\n\n<pre><code>Activesheet.AutoFilter.Sort.SortFields.Clear\n</code></pre>\n\n<p>and should be placed just before trying to <code>.Add</code> the new <code>SortField</code>, i.e. the one for column E.  (The Macro Recorder also inserts the line before the first <code>Add</code>, just to be safe.)</p>\n"}], "owner": {"reputation": 59, "user_id": 7038697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c7baf40e367e46751fb10671a52a4?s=128&d=identicon&r=PG&f=1", "display_name": "Matt G", "link": "https://stackoverflow.com/users/7038697/matt-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 42401584, "answer_count": 2, "score": 0, "last_activity_date": 1506028743, "creation_date": 1487793297, "last_edit_date": 1487793964, "question_id": 42401022, "link": "https://stackoverflow.com/questions/42401022/macro-changes-data-to-overwrite-previous-data", "title": "Macro changes data to overwrite previous data", "body": "<p>I recorded a macro to pick the top ten largest trades sorted first by ten buys then by ten sells.  After sorting data according to column D it copies the trade information and pastes it in another cell.<br>\nThen it sorts by column E to get the largest sells, and copies the same data range to paste in another cell.<br>\nThe problem is that it will copy the wrong information because it can't sort the data by column D and E at the same time.  How do I get the macro to copy and paste the correct info?</p>\n\n<pre><code>Sub ttt()\n'\n' ttt Macro\n' top ten trades output\n'\n' Keyboard Shortcut: Ctrl+Shift+T\n\n\n' buys\n\n    Rows(\"3:3\").Select\n    Selection.AutoFilter\n\n    ActiveSheet.AutoFilter.Sort.SortFields.Add Key:=Range(\"D3\" _\n        ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveSheet.AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"A5:I14\").Select\n    Selection.Copy\n    Range(\"K3\").Select\n    ActiveSheet.paste\n    Application.CutCopyMode = False\n\n\n' sells\n\n\n\n    ActiveSheet.AutoFilter.Sort.SortFields.Add Key:=Range(\"E3\" _\n        ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveSheet.AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"A5:I14\").Select\n    Selection.Copy\n    Range(\"u3\").Select\n    ActiveSheet.paste\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1487794578, "post_id": 42400968, "comment_id": 71949754, "body": "I believe you mean &#39;ComboBox&#39; or &#39;ListBox&#39; instead of &#39;pulldown text&#39;? Which is it? Does it allow multi-select?"}, {"owner": {"reputation": 57, "user_id": 1899040, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/69cca9172691e34b585acf66505894e3?s=128&d=identicon&r=PG", "display_name": "NewbieVBA", "link": "https://stackoverflow.com/users/1899040/newbievba"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1487812483, "post_id": 42400968, "comment_id": 71957382, "body": "Sorry, ComboBox is correct."}, {"owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "edited": false, "score": 0, "creation_date": 1487824862, "post_id": 42400968, "comment_id": 71960927, "body": "Can you give details of what is there at the RowSource of combobox ColourPackage ? There must a table being used for the SQL of RowSource, can you provide some sample data in the fields....the fields in the table might be blank, so they are not bringing data....So you mean the Br"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 1899040, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/69cca9172691e34b585acf66505894e3?s=128&d=identicon&r=PG", "display_name": "NewbieVBA", "link": "https://stackoverflow.com/users/1899040/newbievba"}, "edited": false, "score": 0, "creation_date": 1487812555, "post_id": 42401722, "comment_id": 71957403, "body": "I will give it a shot.  Funny enough, if I change the ComboBox item from Package 10 to Package10 (removing the space), it will work.  But, I can leave Package 9 with a space and it will work."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1487843873, "post_id": 42401722, "comment_id": 71970625, "body": "Why put spaces in control names, fields or table names - it just makes you have to surround references to controls and field names with brackets all the time leading to typo&#39;s and difficult to read code."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1487795686, "creation_date": 1487795686, "answer_id": 42401722, "question_id": 42400968, "link": "https://stackoverflow.com/questions/42400968/strange-issue-with-me-statement-in-access-stopping-after-10th-option/42401722#42401722", "title": "Strange issue with me. statement in Access - Stopping after 10th option", "body": "<p>Use the <em>AfterUpdate</em> event:</p>\n\n<pre><code>Private Sub ColourPackage_AfterUpdate()\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1899040, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/69cca9172691e34b585acf66505894e3?s=128&d=identicon&r=PG", "display_name": "NewbieVBA", "link": "https://stackoverflow.com/users/1899040/newbievba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 42401722, "answer_count": 1, "score": 0, "last_activity_date": 1594022757, "creation_date": 1487793118, "last_edit_date": 1594022757, "question_id": 42400968, "link": "https://stackoverflow.com/questions/42400968/strange-issue-with-me-statement-in-access-stopping-after-10th-option", "title": "Strange issue with me. statement in Access - Stopping after 10th option", "body": "<p>I have a pulldown text field with 15 options - Package 1, Package 2, through to Package 15.</p>\n\n<p>Once a user selects a pulldown, the on change procedure is such that it populates the the fields in the form with the cooresponding data pulled in the select statement as the source of the pull down.</p>\n\n<p>It works great until the user selects Package 10 or greater.  the result is blank fields.  Not exactly sure why and how to fix this.</p>\n\n<pre><code>Private Sub ColourPackage_Change()\nMe.Brick.Value = Me.ColourPackage.Column(1)\nMe.Stone.Value = Me.ColourPackage.Column(2)\nMe.Shingles.Value = Me.ColourPackage.Column(3)\nMe.Windows.Value = Me.ColourPackage.Column(4)\nMe.GarageDoors.Value = Me.ColourPackage.Column(5)\nMe.BoardBatton.Value = Me.ColourPackage.Column(6)\nMe.Alluminum.Value = Me.ColourPackage.Column(7)\nMe.Stucco.Value = Me.ColourPackage.Column(8)\nMe.Shakes.Value = Me.ColourPackage.Column(9)\nMe.Railing.Value = Me.ColourPackage.Column(10)\nEnd Sub\n</code></pre>\n\n<p>Any help is greatly appreciated.  </p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1487861734, "post_id": 42415565, "comment_id": 71983602, "body": "The statement executes file but bullet still remains. You won&#39;t be able to remove it manually as well so I though of moving it to little bit on left side."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1488023514, "post_id": 42415565, "comment_id": 72053895, "body": "When I run your code, replacing the line where you move the shape with the code to remove the bullets, the bullets disappear. The bullets in that SmartArt layout can also be removed manually. If that is not working for you then you have some other issue."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1488024268, "post_id": 42415565, "comment_id": 72054056, "body": "Which version of PPT are you using?"}, {"owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1488054109, "post_id": 42415565, "comment_id": 72064505, "body": "I use Office 2013. I will check again at my end"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "edited": false, "score": 0, "creation_date": 1488097379, "post_id": 42415565, "comment_id": 72074041, "body": "That may well be the problem. SmartArt has been improved in O365. I don&#39;t have a copy of Office 2013 to test but I do recall that object model support for SmartArt was patchy at best. Ungrouping it won&#39;t help either as it will turn it into standard shapes. Looks like you&#39;ll have to learn to like the bullets!"}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 2, "last_activity_date": 1487852265, "creation_date": 1487852265, "answer_id": 42415565, "question_id": 42400785, "link": "https://stackoverflow.com/questions/42400785/powerpoint-vba-move-chldnode-of-vertical-block-list-to-the-left/42415565#42415565", "title": "Powerpoint VBA - Move chldnode of Vertical Block List to the left", "body": "<p>No need to move the shape, you can just remove the bullets:</p>\n\n<pre><code>        .Nodes(1).Shapes(2).TextFrame2.TextRange.ParagraphFormat.Bullet.Type = msoBulletNone\n</code></pre>\n"}], "owner": {"reputation": 2052, "user_id": 285246, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a4f6c2e8a146f19f210a10e624f57164?s=128&d=identicon&r=PG", "display_name": "Tejas", "link": "https://stackoverflow.com/users/285246/tejas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487852265, "creation_date": 1487792499, "question_id": 42400785, "link": "https://stackoverflow.com/questions/42400785/powerpoint-vba-move-chldnode-of-vertical-block-list-to-the-left", "title": "Powerpoint VBA - Move chldnode of Vertical Block List to the left", "body": "<p>Please check below screenshot &amp; code. It has my questions and code I have written so far (which is failing)</p>\n\n<p><a href=\"https://i.stack.imgur.com/K4oBj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K4oBj.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Below is my code:</p>\n</blockquote>\n\n<pre><code>Private Sub VerticalBlockList()\n    Dim oPPT As PowerPoint.Application\n    Dim oPres As PowerPoint.Presentation\n    Const ppLayoutTitleAndContent As Byte = 32\n\n    Set oPPT = CreateObject(\"Powerpoint.Application\")\n    Set oPres = oPPT.Presentations.Add()\n\n    Dim layout As SmartArtLayout\n    Set layout = Application.SmartArtLayouts(26)\n\n    With oPres.Slides.Add(oPres.Slides.Count + 1, ppLayoutTitleAndContent)\n        With .Shapes.AddSmartArt(layout, 30, 180, 318, 252)\n            With .SmartArt\n                .Nodes(1).Shapes(1).TextFrame2.TextRange.Text = \"Sample-1\"\n                .Nodes(1).Shapes(2).TextFrame2.TextRange.Text = \"Sample-2\"\n\n                ' Below statement throws error.\n                ' basically I want to move the bullet section to little bit on left so that the bullet points doesn't show up\n                ' P.S. there is no way I can remove that bullet in a Vertical Block List\n\n                .Nodes(1).Shapes(2).left = .Nodes(1).Shapes(2).left - 30\n\n            End With\n        End With\n    End With    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 5, "creation_date": 1487791425, "post_id": 42400444, "comment_id": 71947942, "body": "Try: <code>Rows(finishedStartRow).Select</code>."}, {"owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1487791750, "post_id": 42400444, "comment_id": 71948138, "body": "That worked. Thank you!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1487791758, "last_edit_date": 1495535385, "creation_date": 1487791758, "answer_id": 42400575, "question_id": 42400444, "link": "https://stackoverflow.com/questions/42400444/selecting-row-using-long-variable-excel-vba/42400575#42400575", "title": "Selecting row using long variable (Excel VBA)", "body": "<p>The dim'med var should not be included in quotes.</p>\n\n<pre><code>Dim startStartRow As Long\nDim finishedStartRow As Long\n\nstartStartRow = 2\nfinishedStartRow = 481805\n\n'all of these are valid for variations on selection\u00b9\nRows(finishedStartRow).Select\nRows(finishedStartRow &amp; \":\" &amp; finishedStartRow).Select\nRows(startStartRow &amp; \":\" &amp; finishedStartRow).Select\n</code></pre>\n\n<hr>\n\n<p>\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 323, "user_id": 5171347, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207648253115301/picture?type=large", "display_name": "Gary Dorman", "link": "https://stackoverflow.com/users/5171347/gary-dorman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2448, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487791758, "creation_date": 1487791292, "last_edit_date": 1487791442, "question_id": 42400444, "link": "https://stackoverflow.com/questions/42400444/selecting-row-using-long-variable-excel-vba", "title": "Selecting row using long variable (Excel VBA)", "body": "<pre><code>Dim finishedStartRow As Long\nRows(\"finishedStartRow:finishedStartRow\").Select\n</code></pre>\n\n<p>I'm trying to select the row 481805 using the finishedStartRow variable. I'm getting a type mismatch error because .Select can only handle Integers. Is there a workaround? Thanks!</p>\n"}, {"tags": ["vba", "internet-explorer", "login"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1487792009, "post_id": 42400270, "comment_id": 71948287, "body": "I&#39;d guess there is some event handler attached to the inputs which is causing that problem - it&#39;s expecting users to type, and you&#39;re not typing...  Without a URL though it&#39;s difficult to make useful suggestions."}, {"owner": {"reputation": 43, "user_id": 6735363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa1fe43a7a2e7d48e925141c5f14076?s=128&d=identicon&r=PG&f=1", "display_name": "nwtn", "link": "https://stackoverflow.com/users/6735363/nwtn"}, "edited": false, "score": 0, "creation_date": 1487792120, "post_id": 42400270, "comment_id": 71948357, "body": "tried. Does not work. give me an error saying that method or property is not supported by the object"}, {"owner": {"reputation": 43, "user_id": 6735363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa1fe43a7a2e7d48e925141c5f14076?s=128&d=identicon&r=PG&f=1", "display_name": "nwtn", "link": "https://stackoverflow.com/users/6735363/nwtn"}, "edited": false, "score": 0, "creation_date": 1487792167, "post_id": 42400270, "comment_id": 71948382, "body": "URL is here        <a href=\"http://my.nuvap.com/home.html#/login\" rel=\"nofollow noreferrer\">my.nuvap.com/home.html#/login</a>"}, {"owner": {"reputation": 43, "user_id": 6735363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa1fe43a7a2e7d48e925141c5f14076?s=128&d=identicon&r=PG&f=1", "display_name": "nwtn", "link": "https://stackoverflow.com/users/6735363/nwtn"}, "edited": false, "score": 0, "creation_date": 1487793881, "post_id": 42400270, "comment_id": 71949333, "body": "anyone can help, please?"}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 3657197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trSj0.jpg?s=128&g=1", "display_name": "Pupa Rebbe", "link": "https://stackoverflow.com/users/3657197/pupa-rebbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1487796060, "creation_date": 1487796060, "answer_id": 42401835, "question_id": 42400270, "link": "https://stackoverflow.com/questions/42400270/login-to-a-website-with-vba-ie/42401835#42401835", "title": "login to a website with VBA ie", "body": "<p>this website wants you to actually type your username/password and actually press the \"Confirm\" button, you can imitate it with <code>SendKeys</code></p>\n\n<p>so instead of setting the <code>value</code> and looping for the button element, use this code:</p>\n\n<pre><code>.Document.all.Item(\"login\").focus\nSendKeys \"username\", True\n.Document.all.Item(\"password\").focus\nSendKeys \"password\", True\nSendKeys \"{TAB}\", True\nSendKeys \"~\", True\n</code></pre>\n\n<p>hope this helps.</p>\n"}], "owner": {"reputation": 43, "user_id": 6735363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa1fe43a7a2e7d48e925141c5f14076?s=128&d=identicon&r=PG&f=1", "display_name": "nwtn", "link": "https://stackoverflow.com/users/6735363/nwtn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1620, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487796060, "creation_date": 1487790692, "last_edit_date": 1487792227, "question_id": 42400270, "link": "https://stackoverflow.com/questions/42400270/login-to-a-website-with-vba-ie", "title": "login to a website with VBA ie", "body": "<p>I need to login in a website.\nEvery time I make the credential insterted with VBA, after the click event, It say that the password is not correct.</p>\n\n<p>If I make the credential inserted by VBA and if I manually cancel one letter of the username and I rewrite it and if I manually cancel one letter of the password and I rewrite it, after I send the click event with VBA it works.</p>\n\n<p>which is the reason? Shound I insert the credential using kinda keypress event? Which is the correct syntax for that?</p>\n\n<p>thanks</p>\n\n<p>please see below HTML code and what I wrote in VBA</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .navigate \"sss.html\"\n\n    Do Until .ReadyState = 4\n        DoEvents\n    Loop\n    .Document.all.Item(\"login\").Value = \"username\"\n    .Document.all.Item(\"password\").Value = \"password\"\nSet elems = ie.Document.getElementsByTagName(\"button\")\nFor Each e In elems\n    If (e.innerHTML = \"Confirm\") Then\n        e.Click\n        Exit For\n    End If\nNext e\n\n&lt;input type=\"text\" ng-model=\"login\" class=\"form-control ng-pristine ng-valid ng-touched\" id=\"login\" placeholder=\"Enter login (email)\"&gt;\n&lt;input type=\"password\" ng-model=\"password\" class=\"form-control ng-pristine ng-valid ng-touched\" id=\"password\" placeholder=\"Password\"&gt;\n&lt;button class=\"btn btn-default\" ng-click=\"authenticate()\" notranslate=\"\"&gt;Confirm&lt;/button&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1487791352, "post_id": 42400032, "comment_id": 71947903, "body": "How big is the text file? Can you provide a short sample of what would be in it?"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1487792048, "post_id": 42400032, "comment_id": 71948311, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/7af2feyt(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Seek</a> and ye shall <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Find</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1487792064, "post_id": 42400032, "comment_id": 71948326, "body": "The <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1.aspx\" rel=\"nofollow noreferrer\">InStr function</a>  allows for a place to start your search. Record the position of <code>:60F</code> (into a long perhaps) and use it as the point to start looking for <code>:61:</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7606784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ac8396645d413f78b7385694690f09?s=128&d=identicon&r=PG&f=1", "display_name": "Eszter", "link": "https://stackoverflow.com/users/7606784/eszter"}, "edited": false, "score": 0, "creation_date": 1487868948, "post_id": 42405658, "comment_id": 71989025, "body": "Thank you very much, brettdj! You really helped me a lot."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 0, "last_activity_date": 1487814844, "creation_date": 1487814844, "answer_id": 42405658, "question_id": 42400032, "link": "https://stackoverflow.com/questions/42400032/extract-string-from-txt-file/42405658#42405658", "title": "extract string from txt file", "body": "<p>A <code>Regexp</code> option:</p>\n\n<blockquote>\n  <p>random stuff<br>\n  random guy<br>\n  Stuff :60F:stuff<br>\n  other stuff 61:getme<br>\n  60F more  </p>\n</blockquote>\n\n<p>returns alphanumerics after <em>61:</em> (preceded by <em>:60F:</em>), ie <em>getme</em> in this example</p>\n\n<pre><code>Sub GetMe()\n\nDim FSO As Object\nDim FH As Object\nDim objRegex As Object\nDim objRegexMC As Object\nDim strIn As String\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet FH = FSO.OpenTextFile(\"c:\\temp\\test.txt\")\nSet objRegex = CreateObject(\"vbscript.regexp\")\nstrIn = FH.readall\nstrIn = Replace(strIn, vbNewLine, Chr(32))\n\nWith objRegex\n    .Pattern = \":60F.*61:(\\w+)\"\n    If .Test(strIn) Then\n        Set objRegexMC = .Execute(strIn)\n        MsgBox objRegexMC(0).submatches(0)\n    Else\n        MsgBox \"text not found\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7606784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ac8396645d413f78b7385694690f09?s=128&d=identicon&r=PG&f=1", "display_name": "Eszter", "link": "https://stackoverflow.com/users/7606784/eszter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 42405658, "answer_count": 1, "score": 1, "last_activity_date": 1487894941, "creation_date": 1487789959, "last_edit_date": 1531161705, "question_id": 42400032, "link": "https://stackoverflow.com/questions/42400032/extract-string-from-txt-file", "title": "extract string from txt file", "body": "<p><em>background</em></p>\n\n<p>I have to create a code in Excel VBA which opens a text file and writes a specific part of some of its strings beginning with \":60F\" into a specific cell of the Excel sheet. </p>\n\n<p>This part of the code already works.</p>\n\n<p><em>issue</em></p>\n\n<p>However, I\u00b4m struggling with the second part of the task. I have to write into another cell of the Excel document a part of a specific string beginning with \":61:\". </p>\n\n<p>The problem is, that there are many strings in the text file beginning with \"61:\", but I need the one which occurs right after the string beginning with \"60F:\".</p>\n\n<p>I would be extremely grateful if you could help me with this. Thank you very much in advance!</p>\n\n<p>Kind regards</p>\n\n<p>Here is the code I wrote so far:</p>\n\n<p><em>code</em></p>\n\n<pre><code>Function extract_opening_balance(ByVal filename As String, subfield_61 As String) As String\n\nDim i As Integer\nDim pos1 As Integer\n\nstrPath = ActiveWorkbook.Path &amp; \"\\Data of Reporting Month\\\"\nfilename = strPath &amp; \"MT940_T2_\" &amp; main_menu.cbo_Year &amp; Left(main_menu.cbo_Month, 2) &amp; Format(day(CDate(Right(main_menu.lst_Date.List(i), 10))), \"00\") &amp; \".txt\"\n\nOpen filename For Input As #1\n    For i = 3 To 13\n        Do Until EOF(1)\n            Line Input #1, textline\n\n                        If InStr(textline, \":60F:\") &gt; 0 Then\n\n\n                    If InStr(textline, \"EUR\") = 13 And InStr(textline, 0) &lt;&gt; 16 Then\n                        'For j = 1 To String(\":60F:\").Count\n\n                            pos1 = InStr(subfield_61, \"//\") + 30\n\n                            'time_str = Mid(subfield_61, pos1, 6)\n                            'time_str = Mid(time_str, 1, 2) &amp; \":\" &amp; Mid(time_str, 3, 2) &amp; \":\" &amp; Mid(time_str, 5, 2)\n\n                            Sheets(\"op_balance\").Range(\"B\" &amp; i).Value = Mid(textline, 6, 1)\n                            Sheets(\"op_balance\").Range(\"C\" &amp; i).Value = Mid(textline, 16, 20)\n                            Sheets(\"op_balance\").Range(\"D\" &amp; i).Value = subfield_61\n                            Sheets(\"op_balance\").Range(\"E\" &amp; i).FormulaR1C1 = \"=IF(RC[-3]=\"\"D\"\",(-1)*RC[-2],RC[-2])\"\n\n\n                       'Next j\n                    End If\n            End If\n        Loop\n    Next i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487809156, "post_id": 42399989, "comment_id": 71956399, "body": "Have you tried <code>vbNewLine </code> ?"}, {"owner": {"reputation": 68, "user_id": 7606633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObuaE.png?s=128&g=1", "display_name": "Douille", "link": "https://stackoverflow.com/users/7606633/douille"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487848086, "post_id": 42399989, "comment_id": 71973432, "body": "vbNewLine does not work as it is not part of a text or text box."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487848319, "post_id": 42399989, "comment_id": 71973582, "body": "Can you add an image of what you trying to copy and what result you expecting?"}, {"owner": {"reputation": 68, "user_id": 7606633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObuaE.png?s=128&g=1", "display_name": "Douille", "link": "https://stackoverflow.com/users/7606633/douille"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487851985, "post_id": 42399989, "comment_id": 71976171, "body": "<a href=\"https://i.imgsafe.org/ed18c2aa93.png\" rel=\"nofollow noreferrer\">i.imgsafe.org/ed18c2aa93.png</a> In this image, Figure 1 is what I need in the mail and is what it looks like in excel. Charts C &amp; D, E &amp; F, G &amp; H and I &amp; J needs to be on the same line as they are pairs. when I execute the code above, it puts chart C,D and E on the same line and breaks the E &amp; F pair as seen in figure 2."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1488007671, "post_id": 42399989, "comment_id": 72049785, "body": "Why not copy the whole thing one time?"}, {"owner": {"reputation": 68, "user_id": 7606633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObuaE.png?s=128&g=1", "display_name": "Douille", "link": "https://stackoverflow.com/users/7606633/douille"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1488217418, "post_id": 42399989, "comment_id": 72123951, "body": "because that would include the cells and would makes things more complicated for the person filling text between categories and makes things very bad when viewed on a cell phone."}], "owner": {"reputation": 68, "user_id": 7606633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObuaE.png?s=128&g=1", "display_name": "Douille", "link": "https://stackoverflow.com/users/7606633/douille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488264768, "creation_date": 1487789834, "last_edit_date": 1488264768, "question_id": 42399989, "link": "https://stackoverflow.com/questions/42399989/adding-line-breaks-between-charts", "title": "Adding line breaks between charts", "body": "<p>I am trying to copy 60 charts from an excel sheet to a mail.</p>\n\n<p>I have a working macro but it puts some charts on the same line and adds confusion to the mail.\nI would like the macro to insert Line Breaks where I want them.\nI have shortened the code below because it is very long but it includes all that is needed to solve this problem.</p>\n\n<p>I've tried several \"solution\" but most of what I find is using .body which I don't need in my macro as text will be put manually between charts and I believe it wouldn't work with the way I grab the charts.</p>\n\n<pre><code>Sub Mail()\n\nSet mailApp = CreateObject(\"Outlook.Application\")\nSet Mail = mailApp.CreateItem(olMailItem)\nMail.Display\nSet wEditor = mailApp.ActiveInspector.WordEditor\n\nActiveSheet.ChartObjects(\"Chart 152\").Activate\nActiveChart.ChartArea.Copy\nwEditor.Application.selection.Paste\n\nActiveSheet.ChartObjects(\"Chart 154\").Activate\nActiveChart.ChartArea.Copy\nwEditor.Application.selection.Paste\n\nActiveSheet.ChartObjects(\"Chart 6\").Activate\nActiveChart.ChartArea.Copy\nwEditor.Application.selection.Paste\n\nActiveSheet.ChartObjects(\"Chart 14\").Activate\nActiveChart.ChartArea.Copy\nwEditor.Application.selection.Paste\n\n*Line break here*\n\nActiveSheet.ChartObjects(\"Chart 15\").Activate\nActiveChart.ChartArea.Copy\nwEditor.Application.selection.Paste\n\nEnd Sub\n</code></pre>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487788790, "post_id": 42399442, "comment_id": 71946402, "body": "I think you could just use <code>Offset</code>, e.g. <code>Offset(,1)</code> if Action were the next column to the right.."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1487789130, "post_id": 42399678, "comment_id": 71946597, "body": "Would you care to elaborate? Like I said I&#39;m just learning and I&#39;m not familiar with <code>ListObject</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1487789283, "post_id": 42399678, "comment_id": 71946689, "body": "If you want to learn about <code>ListObject</code> object you have plenty of resources in the web, just a google away from you. But does the code I provided work for you?"}, {"owner": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1487792320, "post_id": 42399678, "comment_id": 71948466, "body": "No, it&#39;s not working. I adjusted your code for some typos and for what I&#39;m looking for and have this:  <code>If char = Range(&quot;Active_Player&quot;) Then Range(&quot;Table1[Action]&quot;).Rows(char.Row-1).Value = Range(&quot;period_selected&quot;)</code>  But when I run that nothing happens. If I take the -1 out, it enters the value 2 rows below where I expect it to."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1487833695, "post_id": 42399678, "comment_id": 71964581, "body": "I think your table&#39;s header is not in row 1 as mine test one was. See edited answer for a <i>general</i> code"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1488526654, "post_id": 42399678, "comment_id": 72279593, "body": "@Awspry, did you get through it?"}, {"owner": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1488903937, "post_id": 42399678, "comment_id": 72432607, "body": "Kind of. I found an issue in my logic and had to rework how I was going about things. But your script eventually worked. Thank you. :)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "edited": false, "score": 0, "creation_date": 1488911310, "post_id": 42399678, "comment_id": 72436909, "body": "You are welcome. Then I&#39;d appreciate your accepting my answer by clicking on the check mark beside the answer to toggle it from greyed out to filled in. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1487833624, "last_edit_date": 1487833624, "creation_date": 1487788780, "answer_id": 42399678, "question_id": 42399442, "link": "https://stackoverflow.com/questions/42399442/trying-to-enter-a-value-in-a-range-based-on-the-value-of-a-different-range/42399678#42399678", "title": "Trying to enter a value in a range based on the value of a different range", "body": "<p>a possible way:</p>\n\n<pre><code>If char.Value = Range(\"Active_Player\") Then Intersect(Range(\"Table1[Action]\"), char.EntireRow).Value = \"period_selected\" '         \n</code></pre>\n\n<p>while a more elegant way would be using <code>ListObject</code> object</p>\n"}], "owner": {"reputation": 3, "user_id": 6471830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e059d3edaab4bc6ac58968578aa7407?s=128&d=identicon&r=PG&f=1", "display_name": "Awspry", "link": "https://stackoverflow.com/users/6471830/awspry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487833624, "creation_date": 1487788017, "last_edit_date": 1531164843, "question_id": 42399442, "link": "https://stackoverflow.com/questions/42399442/trying-to-enter-a-value-in-a-range-based-on-the-value-of-a-different-range", "title": "Trying to enter a value in a range based on the value of a different range", "body": "<p>I have a table with a column named \"Character\" consisting of a list of names. I have a constant that's outside of the table I want to check this against, and if it matches I want to put a constant named \"period_selected\" in a column named \"Action\".</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub Action()\n   ' Set objects\n   Dim rng As Range, char As Range\n   Set rng = Range(\"Table1[Character]\")\n\n   ' Loop through Character column\n   For Each char In rng\n         'If character is the Active Player, \n      If char = Range(\"Active_Player\") Then\n         'enter the period_selected value in Action column               \n         Else\n      End If\n   Next char\nEnd Sub\n</code></pre>\n\n<p>So the part I can't figure out is how to apply the value in the Action column while looping through the Character column.</p>\n\n<p>This is my first attempt at writing something this in depth so I feel like I'm in a little over my head. All help is appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "formula"], "owner": {"reputation": 13, "user_id": 6575432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94ca74578750f899b5dab2aa4da93c3b?s=128&d=identicon&r=PG&f=1", "display_name": "RHG", "link": "https://stackoverflow.com/users/6575432/rhg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487833084, "creation_date": 1487787959, "last_edit_date": 1487833084, "question_id": 42399417, "link": "https://stackoverflow.com/questions/42399417/vba-calculate-row-with-formulas-and-paste-answers-as-values-in-another-row", "title": "VBA Calculate row with Formulas and paste answers as Values in another row", "body": "<p>Now I am using the bellow code to generate all dates by hours between given date range. And after that there are formulas in Row 16 which are copied to Row 18 and then each formula is auto-filled down till the last date in column \u0410. The date is used in the formulas. \u0422he code is working fine but it is working very slow to calculate and update all formulas at once. I suppose that the problem is because each cell after row 17 is a formula. So now I am wondering is there a way to edit the code to calculate each formula in row 16 by each time interval and the result to be copied as a value from row 18 down to the last row with date in column A. </p>\n\n<pre><code>Option Explicit\nSub TEST()\n'Updated on 02-10-2017\nApplication.Calculation = xlManual\n    Application.StatusBar = \"Getting Daily Results....\"\n    Application.ScreenUpdating = False\nActiveSheet.Rows(18 &amp; \":\" &amp; ActiveSheet.Rows.Count).ClearContents\nRows(\"16:16\").Copy Destination:=Rows(\"18:18\")\nRange(\"A18\", Range(\"A18\").End(xlDown)).Clear\nDim rng As Range\nDim StartRng As Range\nDim EndRng As Range\nDim OutRng As Range\nDim IntvlHrsRng As Range\nDim IntvlHrs As Long\nDim StartValue As Variant\nDim EndValue As Variant\nConst xTitleId As String = \"KutoolsforExcel\"\nDim ColIndex As Long\nDim I As Long\nDim ic As Long\nDim LastRow As Long\nDim LastRowDB As Long\nSet StartRng = Application.Selection\nSet StartRng = Range(\"B3\")\nSet EndRng = Range(\"B4\")\nSet IntvlHrsRng = Range(\"B5\")\nSet OutRng = Range(\"A18\")\nSet OutRng = OutRng.Range(\"A1\")\nStartValue = StartRng.Range(\"A1\").Value\nEndValue = EndRng.Range(\"A1\").Value\nIntvlHrs = IntvlHrsRng.Range(\"A1\").Value\n    If IntvlHrs = 0 Then IntvlHrs = 24\n\nIf EndValue - StartValue &lt;= 0 Then\n    Exit Sub\n    End If\n    ColIndex = 0\n\n    For I = StartValue * 24 To EndValue * 24 Step IntvlHrs\n        OutRng.Offset(ColIndex, 0) = I / 24\n        OutRng.Offset(ColIndex, 0).NumberFormat = \"dd/mm/yyyy hh:mm\"\n        ColIndex = ColIndex + 1\n    Next I\n\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nLastRowDB = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nIf LastRowDB &gt;= LastRow Then\n    Exit Sub\n    End If\n\nFor ic = 2 To 99\n\n    Cells(LastRowDB, ic).AutoFill Destination:=Range(Cells(LastRowDB, ic), Cells(LastRow, ic))\n\nNext ic\n\nActiveSheet.Calculate\n    Application.StatusBar = \"Ready\"\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "base", "alphabetical"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 3, "creation_date": 1487787931, "post_id": 42399331, "comment_id": 71945917, "body": "You could use <code>ASC()</code>. Feed this your letters and it will return the ASCII character number. For instance <code>ASC(&quot;A&quot;)</code> will return 65. <code>ASC(&quot;a&quot;)</code> will return 97. You should be able to create logic with that."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487789909, "post_id": 42399331, "comment_id": 71947035, "body": "Look at using <code>.Column</code>,<code>.Row</code> and <code>.Offset</code> or something along these lines <code>split(format(range(&quot;x225&quot;).Address(true,false)),&quot;$&quot;)(0)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487796632, "post_id": 42399331, "comment_id": 71950888, "body": "Along with <code>Asc</code>, you probably will also need <code>Chr</code> - to convert the ASCII code back to a letter.  (E.g. <code>Chr(5 + Asc(&quot;A&quot;))</code> will give <code>&quot;F&quot;</code>.)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487838020, "post_id": 42399331, "comment_id": 71966869, "body": "Apologies, my comment should of read <code>split(format(cells(y,x).Address(true,false)),&quot;$&quot;)(0)</code>"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487787598, "creation_date": 1487787598, "question_id": 42399331, "link": "https://stackoverflow.com/questions/42399331/counting-with-the-alphabet", "title": "Counting with the Alphabet", "body": "<p>So I have a range of cells that I'd like to copy paste and then change the values of several of the cells within them. I'd add a picture of the section but I don't have enough reputation yet... But basically it's 1-5 going down on the left, and A-E in a row on top going to the right.</p>\n\n<p>So right now, I use this code to copy paste them and then change the letters to the next 5 in the alphabet.</p>\n\n<pre><code>Range(\"B9:G16\").Select\nSelection.Copy\nRange(\"B18\").Select\nActiveSheet.Paste\nRange(\"C19\").Select\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"Seg. \"\nRange(\"C19\").Select\nActiveCell.FormulaR1C1 = \"Seg. F\"\nRange(\"D19\").Select\nActiveCell.FormulaR1C1 = \"Seg. G\"\nRange(\"E19\").Select\nActiveCell.FormulaR1C1 = \"Seg. H\"\nRange(\"F19\").Select\nActiveCell.FormulaR1C1 = \"Seg. I\"\nRange(\"G19\").Select\nActiveCell.FormulaR1C1 = \"Seg. J\"\nRange(\"C25\").Select\n</code></pre>\n\n<p>This macro is assigned to a \"Add 2nd Section\" button. An \"Add 3rd Section\" button does the same thing, just shifted down and five letter forward in the alphabet.</p>\n\n<pre><code>Range(\"B18:G25\").Select\nSelection.Copy\nRange(\"B27\").Select\nActiveSheet.Paste\nActiveWindow.SmallScroll Down:=7\nRange(\"C28\").Select\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"Seg. K\"\nRange(\"D28\").Select\nActiveCell.FormulaR1C1 = \"Seg. L\"\nRange(\"E28\").Select\nActiveCell.FormulaR1C1 = \"Seg. M\"\nRange(\"F28\").Select\nActiveCell.FormulaR1C1 = \"Seg. N\"\nRange(\"G28\").Select\nActiveCell.FormulaR1C1 = \"Seg. O\"\nRange(\"K25\").Select\n</code></pre>\n\n<p>I would love to just simplify this into one button that just counts the cells, shifts the copied section down, and automatically changes the letters to the next five in the set. This way you could add as many sections as you want without me having to add a bunch of buttons for each section.</p>\n\n<p>I know there's a way to use Base26toBaseLetter, and I'd be more than happy to get rid of \"Seg.\" and just have the letter in that row. I'm befuddled with the syntax. </p>\n\n<p><strong>Note:</strong> There are formulas in the bottom row that calculates the average. I need that to remain in the new sections as well.</p>\n\n<p>Thanks everyone!</p>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1487787398, "creation_date": 1487787398, "answer_id": 42399279, "question_id": 42398969, "link": "https://stackoverflow.com/questions/42398969/vba-chart-ranges-until-last-non-empty-row-as-source-data/42399279#42399279", "title": "VBA Chart: Ranges until last non-empty row as source data", "body": "<p>I prefer to use the <code>ChartObject</code> instead of the <code>Chart</code>, I find it easier to nest underneath for all properties, than to use <code>Chart.Parent</code>.</p>\n\n<p>The code below will create your chart, and afterwards it adds a <code>Series</code> with defined <code>Range</code> (fully qualified <code>Range</code>) for <code>Values</code>, and Column \"I\" as the <code>Range</code> for <code>XValues</code> (X-Axis).</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton2_Click()\n\nDim MyEmbeddedChart As ChartObject\nDim Sht As Worksheet\n\nSet Sht = Worksheets(\"Analysis\")\n\nSet MyEmbeddedChart = Sht.ChartObjects.Add(100, 100, 634, 250)\n\nWith MyEmbeddedChart\n    With .Chart\n        .ChartType = xlBarClustered\n        .ChartStyle = 339\n        .Legend.Delete\n        .Axes(xlValue).Delete\n        .Axes(xlValue).MajorGridlines.Format.Line.Visible = msoFalse\n        .ApplyDataLabels\n    End With\n\n    ' this is for one series , you need to do this for every series collection\n    With .Chart.SeriesCollection.NewSeries\n        .Name = \"ser\" &amp; MyEmbeddedChart.Chart.SeriesCollection.Count\n        .Values = Sht.Range(\"AF2\", Sht.Cells(Sht.Rows.Count, \"AF\").End(xlUp))\n        .XValues = Sht.Range(\"I2\", Sht.Cells(Sht.Rows.Count, \"I\").End(xlUp))\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6302050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90de668b232875f67888ddefa5dc9aa7?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doeey737", "link": "https://stackoverflow.com/users/6302050/j-doeey737"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 1, "accepted_answer_id": 42399279, "answer_count": 1, "score": 0, "last_activity_date": 1487787994, "creation_date": 1487786312, "last_edit_date": 1487787994, "question_id": 42398969, "link": "https://stackoverflow.com/questions/42398969/vba-chart-ranges-until-last-non-empty-row-as-source-data", "title": "VBA Chart: Ranges until last non-empty row as source data", "body": "<p>So I have a spreadsheet with data spanning A2 to AF17, I hid the majority of columns such that now only columns: I, AB, AD, AF are showing, where column I is the range I want as axis labels range, and column AF as the value range.</p>\n\n<p>I coded the following to create a graph that dynamically uses range until last non-empty row as Values:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim MyEmbeddedChart As Chart\n\nSet MyEmbeddedChart = Sheets(\"Analysis\").Shapes.AddChart(Width:=634, Height:=250).Chart\n\nWith MyEmbeddedChart\n    .ChartType = xlBarClustered\n    .ChartStyle = 339\n    .SetSourceData Source:=Sheets(\"Analysis\").Range(\"AF2\", Cells(Rows.Count,  1).End(xlUp))\n    .Legend.Delete\n    .Axes(xlValue).Delete\n    .Axes(xlValue).MajorGridlines.Format.Line.Visible = msoFalse\n    .ApplyDataLabels\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Now even though the resulting graph automatically shows column I as axis labels range, it is only because column I is the leftmost visible column right now. That is, in actuality the source data range is A2:AF17, and the axis labels range is actually A2:AD17. And as soon as I unhide the columns, naturally the axis labels got messed up.</p>\n\n<p>Even though the current graph serves my purpose, it is definitely not ideal. So how do I set the source data to be precisely column I as the axis label range and column AF as the value range while keep using the last non-empty row method?</p>\n\n<p>I am still relatively new to VBA, any help is appreciated.</p>\n"}, {"tags": ["excel", "find", "range", "offset", "vba"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "edited": false, "score": 0, "creation_date": 1487801822, "post_id": 42399208, "comment_id": 71953655, "body": "Thank you very much! One little tweak and it did exactly what I was hoping it would do! Now, I can move onto something else! Thanks again!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1487787116, "creation_date": 1487787116, "answer_id": 42399208, "question_id": 42398892, "link": "https://stackoverflow.com/questions/42398892/findnext-wont-work-with-multiple-dynamic-ranges/42399208#42399208", "title": "FindNext Won&#39;t Work With Multiple Dynamic Ranges", "body": "<p>Can you give this a try? I don't think the shaded range is correct but that can be easily rectified.</p>\n\n<pre><code>Sub findMaterials()\n\nDim cRange As Range, cFound As Range\nDim firstAddress As String\n\nSet cRange = Columns(2).Find(What:=\"Materials\", LookIn:=xlValues, _\n             LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection _\n             :=xlNext, MatchCase:=False, SearchFormat:=False)\nIf Not cRange Is Nothing Then\n    firstAddress = cRange.Address\n    Do\n        Set cFound = cRange.End(xlDown).Offset(1, 5)\n        With cFound\n            .Interior.Color = RGB(149, 179, 215)\n            .Font.Color = vbWhite\n            .Font.Bold = True\n            .Font.Size = 11\n            .MergeCells = True\n            .HorizontalAlignment = xlRight\n        End With\n        Set cRange = Columns(2).FindNext(cRange)\n    Loop While cRange.Address &lt;&gt; firstAddress\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 42399208, "answer_count": 1, "score": 0, "last_activity_date": 1487833371, "creation_date": 1487786084, "last_edit_date": 1531161705, "question_id": 42398892, "link": "https://stackoverflow.com/questions/42398892/findnext-wont-work-with-multiple-dynamic-ranges", "title": "FindNext Won&#39;t Work With Multiple Dynamic Ranges", "body": "<p>What I'm trying to do is add some cell formatting underneath each of my dynamic ranges. I figured I could use a <code>Find</code> and <code>FindNext</code> but the code I've come up with only works for the 1st Dynamic Range. I think the problem that is giving me grief is that the constant I'm using for my <code>Find</code>/<code>FindNext</code> is at the top of my Dynamic Ranges. I then use a <code>End(xlDown).Offset()</code> to get to the cells I want to format. </p>\n\n<p>Here's an example of what I'm starting with for the spreadsheet. Some of the constants are the word \"Material\" in column B above each section and that the 1st instance will always be in Cell B13 and that the data will never expand beyond Column H. The number of rows in each section will change and the number of sections will change.\n<a href=\"https://i.stack.imgur.com/K5yRm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K5yRm.png\" alt=\"before macro\"></a></p>\n\n<p>This is what I would like it to look like after running the macro!\n<a href=\"https://i.stack.imgur.com/aU5jS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aU5jS.png\" alt=\"after macro\"></a></p>\n\n<p>And here is the code that I've managed to put together. </p>\n\n<pre><code>Option Explicit\nSub findMaterials()\n\nDim cRange As Range, cFound As Range\nDim firstAddress As String\n\nApplication.ScreenUpdating = False\n\nSet cRange = Cells.Find(What:=\"Materials\", LookIn:=xlValues, _\n             LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection _\n             :=xlNext, MatchCase:=False, SearchFormat:=False) _\n             .End(xlDown).Offset(1, 1)\nFor Each cFound In cRange\n    If cFound = cRange Then\n\n    Do\n\n    firstAddress = cRange.Address\n    With Range(cRange, cRange.Offset(0, 5))\n        .Interior.Color = RGB(149, 179, 215)\n        .Font.Color = vbWhite\n        .Font.Bold = True\n        .Font.Size = 11\n    End With\n    With Range(cRange, cRange.Offset(0, 4))\n        .MergeCells = True\n        .HorizontalAlignment = xlRight\n    End With\n\n    Set cFound = Cells.FindNext(cFound.End(xlDown).Offset(1, 1))\n    Loop While Not cFound Is Nothing And cRange.Address &lt;&gt; firstAddress\n\n    End If\n\nNext cFound\nEnd Sub\n</code></pre>\n\n<p>I've tried multiple variations that I've found online such as starting with a <code>For i = 12 to lRow</code> above the <code>Set cRange</code> but that didn't seem to work either. So far, I've only gotten the code to find the 1st instance of \"Materials\" and apply the formatting below the 1st section. Each section has a Header above the word \"Materials\" that I would like to be in the Subtotal row as well. I imagine I could do that with an array but haven't gotten that far yet and if I have to do some manual entries here and there, I am completely ok with that! Thanks for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 606, "user_id": 8418085, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-wgKLCdJPlCI/AAAAAAAAAAI/AAAAAAAAAB8/F2Q9FAGsmGc/photo.jpg?sz=128", "display_name": "Yin Cognyto", "link": "https://stackoverflow.com/users/8418085/yin-cognyto"}, "edited": false, "score": 0, "creation_date": 1575337463, "post_id": 42398363, "comment_id": 104523662, "body": "I&#39;m also using an InkPicture cotrol to detect changes in the active window&#39;s zoom level. My control is not manually created through code though, so I can&#39;t offer any advice on that. It worked great (I used its <code>SizeChanged</code> and, recently, <code>Click</code> events in my case, no painting, etc.), until I noticed that after switching from one sheet to another (I have 2 sheets in my workbook), when returning to the sheet with the ink picture control on it, the cursor became the same as if I was hovering on a regular cell. Needless to say, the code in its events became useless because they were not firing..."}], "owner": {"reputation": 21, "user_id": 7606268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mt5tz.jpg?s=128&g=1", "display_name": "debling", "link": "https://stackoverflow.com/users/7606268/debling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1487803863, "creation_date": 1487784434, "last_edit_date": 1531161705, "question_id": 42398363, "link": "https://stackoverflow.com/questions/42398363/excel-vba-ink-picture-events-fail-to-fire", "title": "Excel VBA: Ink Picture Events Fail to Fire", "body": "<p>I am trying to write a VBA script to allow an Excel sheet to scroll down a few rows normally before freezing panes at a certain point. Here is the code I would like to run whenever the user scrolls the page:</p>\n\n<pre><code>Sub FreezeView()\n    Dim lngTopRow As Long\n    With ActiveWindow.VisibleRange\n        lngTopRow = .Row\n    End With\n    If ((lngTopRow &gt;= 7) And (ActiveWindow.FreezePanes = False)) Then\n        ActiveSheet.Range(\"B10\").Select\n        ActiveWindow.FreezePanes = True\n    Else\n        If ((lngTopRow = 10) And (ActiveWindow.FreezePanes = True)) Then\n            ActiveWindow.FreezePanes = False\n        End If\n    End If\n'    MsgBox (lngTopRow)\nEnd Sub\n</code></pre>\n\n<p>To my knowledge, Excel VBA doesn't have any direct events to detect scrolling; however, based on <a href=\"https://www.mrexcel.com/forum/excel-questions/287154-worksheet-onscroll-event-how-cool.html\" rel=\"nofollow noreferrer\">This Article</a>, this is supposedly possible through the use of an InkPicture object. Unfortunately, the example sheet on this page is no longer hosted. I have attempted to access the InkPicture's _Painting event (and other events) to make this work, but haven't been able to get any of these events to \"fire.\" Here is the code I have been using to try to accomplish this:</p>\n\n<p>First, I have created a class module with the name \"<strong>clsInkPicEvents</strong>\" with the following code:</p>\n\n<pre><code>Public WithEvents InkPicEvents As InkPicture\n\nPrivate Sub Class_Initialize()\n    MsgBox (\"Initialized\")\nEnd Sub\n\nPrivate Sub InkPicEvents_Click()\n    MsgBox (\"Click\")\nEnd Sub\n\nPrivate Sub InkPicEvents_Painted(ByVal hDC As Long, ByVal Rect As MSINKAUTLib.IInkRectangle)\n    MsgBox (\"Painted\")\nEnd Sub\n\nPrivate Sub InkPicEvents_Painting(ByVal hDC As Long, ByVal Rect As MSINKAUTLib.IInkRectangle, Allow As Boolean)\n    MsgBox (\"Painting\")\nEnd Sub\n\nPrivate Sub InkPicEvents_Resize(Left As Long, Top As Long, Right As Long, Bottom As Long)\n    MsgBox (\"Resize\")\nEnd Sub\n\nPrivate Sub InkPicEvents_Stroke(ByVal Cursor As MSINKAUTLib.IInkCursor, ByVal Stroke As MSINKAUTLib.IInkStrokeDisp, Cancel As Boolean)\n    MsgBox (\"Stroke\")\nEnd Sub\n</code></pre>\n\n<p>Then, in \"<strong>Module 1</strong>\" I have the following script to create the InkPicture object and instantiate the class. I'm really not too familiar with this so I'm not certain I am doing this correctly:</p>\n\n<pre><code>Private Sub AddInkPic()\n    Set oInkPic1 = Sheets(\"Sheet1\").OLEObjects.Add _\n    (ClassType:=\"msinkaut.InkPicture.1\", Left:=Sheets(\"Sheet1\").Range(\"V12\").Left, Top:=Sheets(\"Sheet1\").Range(\"V12\").Top, _\n    Width:=100, Height:=100)\nEnd Sub\n\nPrivate Sub Class_Initialize1()\n    Dim clsInkPic1 As clsInkPicEvents\n    Set clsInkPic1 = New clsInkPicEvents\n    Set clsInkPic1.InkPicEvents = Sheets(\"Sheet1\").OLEObjects(\"InkPicture1\").Object\n    clsInkPic1.InkPicEvents.SetEventInterest ICEI_Painting, True\n    MsgBox (clsInkPic1.InkPicEvents.GetEventInterest(ICEI_Painting))\nEnd Sub\n</code></pre>\n\n<p>I attempted to manually set the event interest to true for the _Painting event as I was suspicious that it was set to false by default, but that doesn't seem to have worked. I was also suspicious that one of the properties of the InkPicture object may be the cause, so attempted to change different properties such as:</p>\n\n<pre><code>Private Sub EditVals()\n    Sheets(\"Sheet1\").OLEObjects(\"InkPicture1\").Object.Enabled = True\n    Sheets(\"Sheet1\").OLEObjects(\"InkPicture1\").Object.InkEnabled = True\n    Sheets(\"Sheet1\").OLEObjects(\"InkPicture1\").Object.AutoRedraw = True\n    Sheets(\"Sheet1\").OLEObjects(\"InkPicture1\").Object.CollectionMode = 2\n    Sheets(\"Sheet1\").OLEObjects(\"InkPicture1\").Object.EditingMode = 0\nEnd Sub\n</code></pre>\n\n<p>But that didn't seem to change anything. Now I'm wondering if it has something to do with the Design Mode, because I notice that I can't ink the InkPicture object after it is created until I click Design Mode on and off again, so I'm wondering if the object isn't \"active\" until I do that, and if enabling and then disabling Design Mode might somehow \"clear\" the class instance or something? Really not sure. Anyway, any help would be appreciated! Thanks.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "edited": false, "score": 1, "creation_date": 1487784296, "post_id": 42398231, "comment_id": 71943547, "body": "Take a look here and see if this helps.  It shows first how to do it through GUI, but then how to do it through VBA (scroll down a little): <a href=\"http://www.makeuseof.com/tag/excel-quick-tips-flip-cells-switch-rows-columns/\" rel=\"nofollow noreferrer\">makeuseof.com/tag/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "is_accepted": false, "score": 0, "last_activity_date": 1487785030, "last_edit_date": 1487785030, "creation_date": 1487784492, "answer_id": 42398384, "question_id": 42398231, "link": "https://stackoverflow.com/questions/42398231/excel-simple-reverse-equation/42398384#42398384", "title": "Excel, simple reverse equation", "body": "<p><strong>Using VBA:</strong></p>\n\n<pre><code>Sub FlipColumns()\n    Dim Rng As Range\n    Dim WorkRng As Range\n    Dim Arr As Variant\n    Dim i As Integer, j As Integer, k As Integer\n\n    On Error Resume Next\n\n    xTitleId = \"Tools4Excel\"\n\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n\n    Arr = WorkRng.Formula\n\n    For j = 1 To UBound(Arr, 2)\n        k = UBound(Arr, 1)\n        For i = 1 To UBound(Arr, 1) / 2\n            xTemp = Arr(i, j)\n            Arr(i, j) = Arr(k, j)\n            Arr(k, j) = xTemp\n            k = k - 1\n        Next\n    Next\n    WorkRng.Formula = Arr\nEnd Sub\n</code></pre>\n\n<p>When you execute this macro, it will ask you which column range you want to rewrite in the inverse order.</p>\n\n<hr>\n\n<p><strong>Using Formulas:</strong></p>\n\n<p>You can use <a href=\"https://support.office.com/en-us/article/OFFSET-function-c8de19ae-dd79-4b9b-a14e-b4d906d11b66\" rel=\"nofollow noreferrer\"><code>OFFSET()</code></a>, <a href=\"https://support.office.com/en-us/article/COUNTA-function-7dc98875-d5c1-46f1-9a82-53f3219e2509\" rel=\"nofollow noreferrer\"><code>COUNTA()</code></a> and <a href=\"https://support.office.com/en-us/article/ROW-function-3a63b74a-c4d0-4093-b49a-e76eb49a6d8d\" rel=\"nofollow noreferrer\"><code>ROW()</code></a> to achieve this.</p>\n\n<p>Example of formulas:</p>\n\n<pre><code>cell B1    =OFFSET($A$1;COUNTA(A:A)-ROW(A1);0)\ncell B2    =OFFSET($A$1;COUNTA(A:A)-ROW(A2);0)\ncell B3    =OFFSET($A$1;COUNTA(A:A)-ROW(A3);0)\ncell B4    =OFFSET($A$1;COUNTA(A:A)-ROW(A4);0)\ncell B5    =OFFSET($A$1;COUNTA(A:A)-ROW(A5);0)\n</code></pre>\n\n<p>Just put <code>=OFFSET($A$1;COUNTA(A:A)-ROW(A1);0)</code> at cell b2 and drag down.</p>\n\n<p><a href=\"https://support.office.com/en-us/article/OFFSET-function-c8de19ae-dd79-4b9b-a14e-b4d906d11b66\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5qQnh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1487784853, "creation_date": 1487784853, "answer_id": 42398491, "question_id": 42398231, "link": "https://stackoverflow.com/questions/42398231/excel-simple-reverse-equation/42398491#42398491", "title": "Excel, simple reverse equation", "body": "<pre><code>Sub ReverseRange()\n\nFor i = 1 To 5\n    Range(\"b\" &amp; i).Value = Range(\"a5\").Offset(0 - (i - 1), 0).Value\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1487785031, "creation_date": 1487785031, "answer_id": 42398539, "question_id": 42398231, "link": "https://stackoverflow.com/questions/42398231/excel-simple-reverse-equation/42398539#42398539", "title": "Excel, simple reverse equation", "body": "<p>Put this one formula in B1 and copy/drag down:</p>\n\n<pre><code>=INDEX(A:A,AGGREGATE(14,6,ROW($A$1:INDEX(A:A,MAX(IFERROR(MATCH(1E+99,A:A),0),IFERROR(MATCH(\"ZZZ\",A:A),0)))),ROW(1:1)))\n</code></pre>\n\n<p>It is dynamic and does not care how many values are in A, it will resize as needed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/h5l1R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h5l1R.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1487788420, "creation_date": 1487788420, "answer_id": 42399571, "question_id": 42398231, "link": "https://stackoverflow.com/questions/42398231/excel-simple-reverse-equation/42399571#42399571", "title": "Excel, simple reverse equation", "body": "<p>with VBA</p>\n\n<pre><code>Range(\"B1:B5\").Value = Application.Transpose(Split(StrReverse(Join(Application.Transpose(Range(\"A1:A5\").Value), \"|\")), \"|\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1487789149, "creation_date": 1487789149, "answer_id": 42399782, "question_id": 42398231, "link": "https://stackoverflow.com/questions/42398231/excel-simple-reverse-equation/42399782#42399782", "title": "Excel, simple reverse equation", "body": "<p>In <strong>B1</strong> enter:</p>\n\n<pre><code>=INDEX(A:A,6-ROW())\n</code></pre>\n\n<p>and copy down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SzHBb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SzHBb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 7606364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0110b20be705b6c95737730acdea88a?s=128&d=identicon&r=PG&f=1", "display_name": "FriedEgg", "link": "https://stackoverflow.com/users/7606364/friedegg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1487813825, "accepted_answer_id": 42399782, "answer_count": 5, "score": 0, "last_activity_date": 1487813846, "creation_date": 1487784057, "last_edit_date": 1487813846, "question_id": 42398231, "link": "https://stackoverflow.com/questions/42398231/excel-simple-reverse-equation", "closed_reason": "Needs more focus", "title": "Excel, simple reverse equation", "body": "<p>I'd like the Data that is in (A1:A:5) to be displayed in (B1:B5) in reverse order. The bottom one in A5 to appear in B1 and so on. Please and thanks</p>\n"}, {"tags": ["json", "excel", "vba", "web-services", "rest"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1487791260, "post_id": 42397903, "comment_id": 71947855, "body": "Have a look <a href=\"http://stackoverflow.com/questions/14075422/post-request-with-multiple-parameters-json-and-string-on-jackson-jersey-java\">here</a>. Maybe you should use <code>java</code> tag on this question?"}], "owner": {"reputation": 75, "user_id": 7545379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abe02e02d59212408ac9b9fe8422fe5?s=128&d=identicon&r=PG&f=1", "display_name": "mgerbracht", "link": "https://stackoverflow.com/users/7545379/mgerbracht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487783121, "creation_date": 1487783121, "question_id": 42397903, "link": "https://stackoverflow.com/questions/42397903/how-to-use-vba-to-send-a-json-file-and-parameters-to-a-rest-webservice", "title": "How to use VBA to send a json file and parameters to a REST WebService", "body": "<p>I would like to use Excel/VBA to POST a json file and several parameters to a REST WebService. I managed to send the json file but I don't know how to include additional parametes. Is there a way to do this?</p>\n\n<p>The VBA code I use looks like this:</p>\n\n<blockquote>\n<pre><code>Dim URL As String, objHTTP As Object\n\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"http://localhost:8080/services/data/\"\nobjHTTP.Open \"POST\", URL, False\nobjHTTP.SetRequestHeader \"Content-type\", \"application/json\"\nobjHTTP.SetRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n'objHTTP.SetRequestHeader \"id\", \"1234\"\nobjHTTP.Send json_table\n</code></pre>\n</blockquote>\n\n<p>As you see in the line which is commented out I tried to send the parameter as RequestHeader, but this also did not work. </p>\n\n<p>I am also responsible for the WebService so that I can change the REST interface there. Using Java I would like to read the parameters by using @QueryParam(\"id\") or similar.</p>\n\n<p>I would not like to include the parameter inside the json \"file\" because its structure matches an entity I'm using.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1487785204, "post_id": 42397897, "comment_id": 71944149, "body": "How is the address displayed on the &#39;main&#39; form? Is it actually on a subform? Or is it just part of the main form? How is the address linked to the main form... by ID number? What is the recordsource for the main form (and if present, subform?)"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1487786892, "post_id": 42397897, "comment_id": 71945252, "body": "@WayneG.Dunn I found a solution. I re-queried the subform in an On_Close event of the Entry form. I had originally written it to take place on click of the save button, but I guess it was re-querying before the record was actually updated"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1487789058, "post_id": 42397897, "comment_id": 71946554, "body": "Yes, depending on  what code you have in your &#39;Close&#39; event, you could get into trouble. If you explicitly saved the new record before executing the requery, then it should work."}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487783099, "creation_date": 1487783099, "question_id": 42397897, "link": "https://stackoverflow.com/questions/42397897/access-vba-query-is-working-properly-but-the-form-isnt-filtering-new-record-c", "title": "Access VBA Query is working properly, but the Form isn&#39;t filtering. New Record causing issue?", "body": "<p>I have an Address form assigned to a Customer. The user may change the Address by opening a Form. This Form first has them search for a pre-existing Address (In the DB) and if none exists, they can define a new Address.</p>\n\n<p>If they search and find one that already exists, they can double click the ID and the Address is assigned to the Customer. The form closes and the previous form re-queries, showing the updated address. That works fine.</p>\n\n<p>However, when I allow them to key in a new address and use that one in the same way, the original form isn't re-querying or filtering properly. I have to re-open the form to see the updated address.</p>\n\n<p>So the query to update it is working, I just can't get the address to display in the original form.</p>\n\n<p>I'm setting the New_Address Form to DataEntry Enabled and On_Click of a Save button, I run the Update query, set the filter and close the form. Literally the exact same code I use on the Search_Address form...but it doesn't work.</p>\n\n<p>Help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 1, "creation_date": 1487782976, "post_id": 42397791, "comment_id": 71942660, "body": "<a href=\"http://stackoverflow.com/a/8906912/4425957\">http://stackoverflow.com/a/8906912/4425957</a>"}, {"owner": {"reputation": 1, "user_id": 7344271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b98d65ce8157d53bf46e1318f646da?s=128&d=identicon&r=PG&f=1", "display_name": "Boris", "link": "https://stackoverflow.com/users/7344271/boris"}, "reply_to_user": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1487783022, "post_id": 42397791, "comment_id": 71942692, "body": "Sorry, there was a mistype. Correct is     ABC = Shell(Directory &amp; &quot;\\VTFeV4.exe&quot;, 0)"}], "owner": {"reputation": 1, "user_id": 7344271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b98d65ce8157d53bf46e1318f646da?s=128&d=identicon&r=PG&f=1", "display_name": "Boris", "link": "https://stackoverflow.com/users/7344271/boris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487782839, "creation_date": 1487782839, "last_edit_date": 1531164843, "question_id": 42397791, "link": "https://stackoverflow.com/questions/42397791/vba-excel-shell-function", "title": "VBA Excel Shell function", "body": "<p>I have a Fortran routine which reads the data from a file, processes the data, and records the results in few *.csv files. It has perfectly worked for years.\nNow I made a VBA Excel Macro which prepares the data files, calls the Fortran routine</p>\n\n<pre><code>TemporFile = Directory &amp; \"\\\" &amp; \"VTFeV4.exe\"\nCall Shell(TemporFile, 0)\n</code></pre>\n\n<p>, and forms an Excel workbook using the *.csv files generated by the Fortran routine VTFeV4.exe.\nThe problem is, it doesn't work consistently. Sometimes, the resulting files do not appear, the VBA Macro indeed canot find the file, and interrups. The Windows' Start Task Manager shows that the EXE file is still running.\n(Please note, \"Directory\" is the correct Path).\nI found that if to run the Macro stepwisely (F8), it works better. So I added time delay</p>\n\n<pre><code>Dim PauseTime, Start, Finish, TotalTime\nPauseTime = pt \nStart = Timer\nDo While Timer &lt; Start + PauseTime\n    DoEvents\nLoop\n</code></pre>\n\n<p>which worked well with pt=10 until TODAY (02/22/17) when it stopped working at all even when pt=20s though the EXE file works well and fast (apparently much quicker than 10s, less to say!).\nI also tried </p>\n\n<pre><code>ABC = Shell(Directory &amp; \"\\NewVTF1.exe\", 1)\n</code></pre>\n\n<p>with same result.\nWhat is the problem with Shell? Please help!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 49560, "user_id": 119477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/838f94e4247f0740e8be0cc6a9900278?s=128&d=identicon&r=PG", "display_name": "Conrad Frix", "link": "https://stackoverflow.com/users/119477/conrad-frix"}, "is_accepted": false, "score": 2, "last_activity_date": 1487783050, "last_edit_date": 1487783050, "creation_date": 1487782621, "answer_id": 42397722, "question_id": 42397449, "link": "https://stackoverflow.com/questions/42397449/copying-one-excel-sheet-for-the-whole-year/42397722#42397722", "title": "Copying one Excel Sheet for the whole year", "body": "<p>Short answer don't use <code>Year(2018)</code> just use <code>DateSerial(2018, mth + 1, 1)</code></p>\n\n<p>If you look at the <a href=\"https://msdn.microsoft.com/en-us/library/88k2aec8(v=vs.90).aspx\" rel=\"nofollow noreferrer\">documentation for year</a> you'll see it defined as </p>\n\n<pre><code> Public Function Year(ByVal DateValue As DateTime) As Integer \n</code></pre>\n\n<p>This means when <code>Year(2018)</code> is evaluated it must convert the integer 2018 to a DateTime. It does this by adding 2018 days to the epoch which gives you 7/10/1905. So <code>Year(2018)</code> returns 1905.</p>\n\n<p>It just so happens that <code>Format(DateSerial(2017, mth, dy), \"ddd mmm d\")</code> and  <code>Format(DateSerial(1905, mth, dy), \"ddd mmm d\")</code> return the same value because Jan, 1 1905 and 2017 were both Sundays. This is why you're confused by the output of <code>Format(DateSerial(Year(2018), mth, dy), \"ddd mmm d\")</code></p>\n"}], "owner": {"reputation": 11, "user_id": 7606183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60a19413bc857a61dfae451cdb2e3760?s=128&d=identicon&r=PG&f=1", "display_name": "J.P", "link": "https://stackoverflow.com/users/7606183/j-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487783050, "creation_date": 1487781926, "last_edit_date": 1531164843, "question_id": 42397449, "link": "https://stackoverflow.com/questions/42397449/copying-one-excel-sheet-for-the-whole-year", "title": "Copying one Excel Sheet for the whole year", "body": "<p>I am trying to do this for the whole year for 2018 and when I run my code I get 2017 instead. Here is my code below</p>\n\n<pre><code>Sub MakeSheetForEachDay()\n'Will copy the sheet named \"START\" and rename as\n'as a date, 1-Jan, 2-Jan, etc.\n'\n    Dim wsStart As Worksheet\n    Dim strDate As String\n    Dim mth As Long, dy As Long\n\n    Set wsStart = Sheets(\"START\")\n    For mth = 1 To 12\n        For dy = 1 To Day(DateSerial(Year(2018), mth + 1, 1) - 1)\n            strDate = Format(DateSerial(Year(2018), mth, dy), \"ddd mmm d\")\n            wsStart.Copy after:=Sheets(Sheets.Count)\n            Sheets(Sheets.Count).Name = strDate\n        Next dy\n    Next mth\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487784853, "post_id": 42397191, "comment_id": 71943933, "body": "You dont need to copy the <code>array</code> if all what you want is to change the <code>values</code>."}, {"owner": {"reputation": 75, "user_id": 7389590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee3be1fcf5ba6deaed7ff9b9a1a341c?s=128&d=identicon&r=PG&f=1", "display_name": "Theaetetos", "link": "https://stackoverflow.com/users/7389590/theaetetos"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487787930, "post_id": 42397191, "comment_id": 71945914, "body": "@A.S.H See edit. I hope I&#39;ve made myself clearer."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487789264, "post_id": 42397191, "comment_id": 71946681, "body": "So your custom class has only methods that return or set entire arrays? And you dont own its code I guess..."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 7389590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee3be1fcf5ba6deaed7ff9b9a1a341c?s=128&d=identicon&r=PG&f=1", "display_name": "Theaetetos", "link": "https://stackoverflow.com/users/7389590/theaetetos"}, "is_accepted": true, "score": 0, "last_activity_date": 1487958987, "creation_date": 1487958987, "answer_id": 42445271, "question_id": 42397191, "link": "https://stackoverflow.com/questions/42397191/edit-array-within-a-collection-excel-vba/42445271#42445271", "title": "Edit array within a collection Excel VBA", "body": "<p>It turns out that <a href=\"http://excelmacromastery.com/excel-vba-collections/#Collections_Vs_Arrays\" rel=\"nofollow noreferrer\">collections are read-only</a>, so there is no solution of the type I was looking for. I chose to rethink the problem instead.</p>\n"}], "owner": {"reputation": 75, "user_id": 7389590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ee3be1fcf5ba6deaed7ff9b9a1a341c?s=128&d=identicon&r=PG&f=1", "display_name": "Theaetetos", "link": "https://stackoverflow.com/users/7389590/theaetetos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "accepted_answer_id": 42445271, "answer_count": 1, "score": 0, "last_activity_date": 1487958987, "creation_date": 1487781229, "last_edit_date": 1531164843, "question_id": 42397191, "link": "https://stackoverflow.com/questions/42397191/edit-array-within-a-collection-excel-vba", "title": "Edit array within a collection Excel VBA", "body": "<p>I have a collection of arrays and need to edit automatically some of the values within some of the arrays. However, some of them are so large that copying the array to a new variable, deleting the collection item, editing the copy, and then putting it back into the collection is not only inelegant but also very slow at best. Does anyone know of any other ways to accomplish this?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I should have specified that the collection exists within a custom class and so the array variables are not directly accessible. An illustration of my problem:</p>\n\n<pre><code>Sub illustration()\n\nDim coll As New Collection\nDim arr As Variant\nReDim arr(0 To 1)\narr(0) = \"hello\"\narr(1) = \"world\"\ncoll.Add arr\n\ncoll(1)(0) = \"goodbye\"\n\nDebug.Print Join(arr)\nDebug.Print Join(coll(1))\n\nslowMethod coll, 1\n\nDebug.Print Join(arr)\nDebug.Print Join(coll(1))\n\nEnd Sub\n\nSub slowMethod(ByRef edit_coll As Collection, index As Integer)\n\nDim return_arr As Variant\nreturn_arr = edit_coll(index) '&lt;--this will take up a lot of memory if the array has, say, 300,000 records\n\nedit_coll.Remove index\n\nreturn_arr(LBound(return_arr)) = \"goodbye\"\n\nedit_coll.Add return_arr\n\nEnd Sub\n</code></pre>\n\n<p>The desired output \"goodbye world\" will only occur (to my knowledge) using the method I don't want to use.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1487780551, "post_id": 42396872, "comment_id": 71940968, "body": "The reference follows the document, not the Word installation. Do the other users not have Word <i>installed</i>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 5, "creation_date": 1487780940, "post_id": 42396872, "comment_id": 71941244, "body": "You&#39;ve used <i>early binding</i> by declaring your objects as <code>Word.__something__</code>. Instead, declare them as generic <code>As Object</code> type. Also, watch out for enumerated constants which you&#39;d need to explicitly declare in your code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487786418, "post_id": 42396872, "comment_id": 71944973, "body": "If your users don&#39;t have Word installed, exactly what do you expect <code>CreateObject(&quot;Word.Application&quot;)</code> to do?"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487780824, "post_id": 42396999, "comment_id": 71941157, "body": "shouldn&#39;t <code>ExportFormat:=wdExportFormatPDF</code> result with an error when using late binding ? shouldn&#39;t it be <code>ExportFormat:=17</code> ? Also <code>objWord.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges</code> ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 7, "creation_date": 1487780880, "post_id": 42396999, "comment_id": 71941204, "body": "@ShaiRado Nope - I declared the constants in the code. I prefer that to just putting literal values in the code lines."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 9, "last_activity_date": 1487785477, "last_edit_date": 1487785477, "creation_date": 1487780707, "answer_id": 42396999, "question_id": 42396872, "link": "https://stackoverflow.com/questions/42396872/vba-late-binding-for-userforms-based-on-user-computers-that-do-not-have-word-r/42396999#42396999", "title": "VBA Late Binding - For userforms based on user computers that do not have Word References", "body": "<p>If the other users all have the same version of Office as you do, you don't have a problem. If they have different versions, you do need to late bind, which only involves declaring the variables as Object and declaring any constants you use from Word's library:</p>\n\n<pre><code>Dim objWord As Object\nDim docWord As Object\nconst wdExportFormatPDF as long = 17\nconst wdDoNotSaveChanges as long = 0\n\nSet objWord = CreateObject(\"Word.Application\")\nSet docWord = objWord.Documents.Open(ThisWorkbook.Path &amp; \"\\MyNewWordDocument.doc\")\n\ndocWord.ExportAsFixedFormat OutputFileName:=ThisWorkbook.Path &amp; \"\\\" + _ Cells(1, 6) + \" - Offer Letter.pdf\", _\nExportFormat:=wdExportFormatPDF\n\nobjWord.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\nobjWord.Quit\n</code></pre>\n\n<p>You should also remove the Word reference.</p>\n\n<p>Might as well add a plug: <a href=\"http://excelmatters.com/2013/09/23/vba-references-and-early-binding-vs-late-binding/\" rel=\"nofollow noreferrer\">http://excelmatters.com/2013/09/23/vba-references-and-early-binding-vs-late-binding/</a></p>\n"}], "owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 42396999, "answer_count": 1, "score": 4, "last_activity_date": 1487785477, "creation_date": 1487780354, "question_id": 42396872, "link": "https://stackoverflow.com/questions/42396872/vba-late-binding-for-userforms-based-on-user-computers-that-do-not-have-word-r", "title": "VBA Late Binding - For userforms based on user computers that do not have Word References", "body": "<p>I have an excel userform/worksheet that opens a Word document/template and saves that Word doc as a PDF, with a specific filename, in the same folder.</p>\n\n<p>In my references on Excel I have Word Object Library enabled. My userform will be for use on other users computers which will not have these references enabled (and will be too troublesome to enable for all users).</p>\n\n<p>My understanding is that the code I have is \"early binding\" and it needs to be \"late binding\" to bypass the need for other users to enable the reference to Word.</p>\n\n<p>My problem is I do not know or understand how to do this with my code:</p>\n\n<pre><code> Dim objWord As Word.Application\n Dim docWord As Word.Document\n\n Set objWord = CreateObject(\"Word.Application\")\n Set docWord = objWord.Documents.Open(ThisWorkbook.Path &amp; \"\\MyNewWordDocument.doc\")\n\n docWord.ExportAsFixedFormat OutputFileName:=ThisWorkbook.Path &amp; \"\\\" + Cells(1, 6) + \" - Offer Letter.pdf\", _\n ExportFormat:=wdExportFormatPDF\n\n objWord.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n objWord.Quit\n</code></pre>\n\n<p>This code is fully functional for myself. However, as stated, it does not work for others due to the reference to Word not enabled.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1487779962, "post_id": 42396620, "comment_id": 71940552, "body": "Try <code>Application.DisplayAlerts = False</code> before the <code>sh.Copy</code> statement, and then make sure to do <code>Application.DisplayAlerts = True</code> after that statement."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5dd78ed1708a5411d57498f81a0c3?s=128&d=identicon&r=PG&f=1", "display_name": "OB2013", "link": "https://stackoverflow.com/users/7569888/ob2013"}, "edited": false, "score": 0, "creation_date": 1487881964, "post_id": 42396721, "comment_id": 71996599, "body": "I&#39;m trying to see if this solution works, but I&#39; now getting a runtime error &#39;1004&#39; stating &quot;That name is already taken. Try a different one.&quot;  on the line reading:          sh.Copy After:=b1.Sheets(b1.Sheets.Count). Any idea what it means?"}], "tags": [], "owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "is_accepted": false, "score": 1, "last_activity_date": 1487779970, "creation_date": 1487779970, "answer_id": 42396721, "question_id": 42396620, "link": "https://stackoverflow.com/questions/42396620/i-need-an-excel-macro-that-will-automatically-select-yes-for-a-pop-up-window-r/42396721#42396721", "title": "I need an Excel Macro that will automatically select &quot;Yes&quot; for a pop-up window regarding a name that already exists", "body": "<p>You can insert:</p>\n\n<pre><code>Application.DisplayAlerts = False \n</code></pre>\n\n<p>before the copying, and </p>\n\n<pre><code>Application.DisplayAlerts = True \n</code></pre>\n\n<p>after.</p>\n\n<p>This way you'll turn off the alerts before copying and will turn them on after.</p>\n"}], "owner": {"reputation": 11, "user_id": 7569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5dd78ed1708a5411d57498f81a0c3?s=128&d=identicon&r=PG&f=1", "display_name": "OB2013", "link": "https://stackoverflow.com/users/7569888/ob2013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586363564, "creation_date": 1487779673, "last_edit_date": 1531161705, "question_id": 42396620, "link": "https://stackoverflow.com/questions/42396620/i-need-an-excel-macro-that-will-automatically-select-yes-for-a-pop-up-window-r", "title": "I need an Excel Macro that will automatically select &quot;Yes&quot; for a pop-up window regarding a name that already exists", "body": "<p>I've built a Macro that will copy all of the sheets in one workbook and paste them into another workbook. So far it works just fine, but while the macro is in the midst of copying and pasting each sheet, excel flashes a pop up window that reads \"The name '(insert any name here)' already exists. Click Yes to use that version of the name, or click No to rename the version of '(insert any name here)' you're moving or copying.\" </p>\n\n<p>It does this for multiple named items that have the same name in the sheets that I'm copying and pasting to the new workbook, so this window pops up a lot (about 30 times!). Is there a Macro that will automatically select \"Yes\" so I don't have to keep selecting yes over and over again? I've listed the macro for copying and pasting all worksheets into another workbook of mine below for reference.</p>\n\n<pre><code>Sub Copy_Sheets()\n\nDim b1 As Workbook, b2 As Workbook\nDim sh As Worksheet\n\nWorkbooks.Open Filename:=\"C:\\Users\\Documents\\Test.xlsx\"\nSet b1 = ActiveWorkbook\nWorkbooks.Open Filename:=\"C:\\Users\\Experiment.xlsx\"\nSet b2 = ActiveWorkbook\n\nFor Each sh In b2.Sheets\n sh.Copy After:=b1.Sheets(b1.Sheets.Count)\nNext sh\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 3, "creation_date": 1487779756, "post_id": 42396598, "comment_id": 71940381, "body": "There are ways to do it. Show us what have you tried so far and where you stuck."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487782678, "post_id": 42396598, "comment_id": 71942434, "body": "This question confused the mass. Are you looking for &quot;any numbers&quot; with that pattern? You should be more specific, and moreover, the only &quot;code&quot; you provided is the keyword <code>InStr</code>. That&#39;s not enough, neither as code nor as a description of the problem..."}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487781975, "post_id": 42397402, "comment_id": 71941927, "body": "OP wants to match a pattern, not an exact string."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487782328, "post_id": 42397402, "comment_id": 71942176, "body": "@A.S.H The OP says they have &quot;A string in a cell&quot; and they &quot;want to search for this&quot;... I&#39;ve added an example to my code so that it doesn&#39;t have to be an underscore, but it does match their request..."}, {"owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487837997, "post_id": 42397402, "comment_id": 71966853, "body": "1st of all Thks so much for the aswers and sry for my late reply!About the topic, forgot to say that i wanted for to copy the found &quot;Result&quot; to another cell in the same sheet. Wolfie thks so much also for the code, however, the only difference is that I cannot define what I&#39;m searching for, what I mean is, I only know that I need to be looking for 2 numbers followed by  _ (underscore) or any letter and then 3 more numbers. Jeeped, also thks so much. My only questions for the part you provided, is there any way to add the condition 1 letter to the same part of the _(underscore)?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487844925, "post_id": 42397402, "comment_id": 71971321, "body": "Hi @EdN, I have made a large edit to use Regular Expressions. I believe this now suits your needs."}, {"owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487845729, "post_id": 42397402, "comment_id": 71971894, "body": "@Wolfie Thks!!! it did the trick, and it ignores the one&#39;s that do not correspond and jumps to next row.... will the screenupdate function help improve speed, cause I&#39;ve been tempering a bit and with a lot of entry&#39;s it will be a bit slow."}, {"owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487847691, "post_id": 42397402, "comment_id": 71973210, "body": "@Wolfie, sry to bother but how can i start in row 2 if i have headers? Thks"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1487848821, "post_id": 42397402, "comment_id": 71973970, "body": "At this stage you should be trying to understand the code and looking how you can adapt it. I&#39;m cycling through all cells in the used range of column A: <code>Intersect(ActiveSheet.Columns(&quot;A&quot;), ActiveSheet.UsedRange)</code>. You can change this range to any range! So just use <code>ActiveSheet.Range(&quot;A2:A&quot; &amp; ActiveSheet.UsedRange.Rows.Count)</code>"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487849141, "post_id": 42397402, "comment_id": 71974192, "body": "@EdN If this answers your question and you&#39;re still having problems with the accepted answer, then accept this one..."}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 2, "last_activity_date": 1487858572, "last_edit_date": 1495541354, "creation_date": 1487781804, "answer_id": 42397402, "question_id": 42396598, "link": "https://stackoverflow.com/questions/42396598/loop-through-column-and-check-if-cell-contains-specific-chars/42397402#42397402", "title": "Loop through column and check if cell contains specific chars", "body": "<p><strong>Edit</strong> - Using Regular expressions for generic match, solution to clarified problem.</p>\n\n<p>Using Regular Expressions (RegExp) to match the pattern \"2 digits, 1 non-digit, 3 digits\". You will need to add the Regex reference. In the VBA editor, go to <code>Tools</code>><code>References</code> and tick </p>\n\n<pre><code>Microsoft VBScript Regular Expressions 5.5 \n</code></pre>\n\n<p>Then add the following function to your module:</p>\n\n<pre><code>Function RegexMatch(Myrange As Range) As String\n    RegexMatch = \"\"\n\n    Dim strPattern As String: strPattern = \"[0-9]{2}[a-zA-Z_\\-]{1}[0-9]{3}\"\n    Dim regEx As New RegExp\n    Dim strInput As String\n    strInput = Myrange.Value\n\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    If regEx.Test(strInput) Then\n        RegexMatch = regEx.Execute(strInput)(0)\n    End If\nEnd Function\n</code></pre>\n\n<p>And use it like so:</p>\n\n<pre><code>Dim myCell As Range\nDim matchString As String\nFor Each myCell In Intersect(ActiveSheet.Columns(\"A\"), ActiveSheet.UsedRange)\n    matchString = RegexMatch(myCell)\n    ' Copy matched value to another column\n    myCell.Offset(0, 1).Value = matchString\nNext myCell\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w6Loa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w6Loa.png\" alt=\"Regexp\"></a></p>\n\n<p>For more on VBA RegExp, see this SO question: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n\n<hr>\n\n<p><strong>Original</strong> - using <code>Instr</code> for search string match.</p>\n\n<p>You're right, the <code>Instr</code> function is what you want, it returns <code>0</code> if the string isn't in the string and the index greater than <code>0</code> otherwise.</p>\n\n<pre><code>Dim myString as String\nmyString = \"Overlay 700 MHz - 06_469\"\nDim myDigitString as String\n' Use RIGHT to get the last 6 characters (your search string)\nmyDigitString = Right(myString, 6)\n\nDim myCell as Range\n' Cycle through cells in column A, which are also in the sheet's used range\nFor each myCell in Intersect(ActiveSheet.Columns(\"A\"), ActiveSheet.UsedRange)\n\n    If Instr(myCell.Value, myDigitString) &gt; 0 Then\n\n        ' Copy cell to another sheet\n        myCell.copy Desination:=ActiveWorkbook.Sheets(\"PasteToThisSheet\").Range(\"A1\")\n\n        ' If you only want to get the first instance then...\n        Exit For\n\n    End If\n\nNext myCell\n</code></pre>\n\n<p>To match the pattern \"2 digits, another character, 3 digits\" you could use:</p>\n\n<pre><code>For each myCell in Intersect(ActiveSheet.Columns(\"A\"), ActiveSheet.UsedRange)\n\n    ' Check that first 2 digits and last 3 digits are in cell value\n    ' Also check that they are separated by 1 character\n    If Instr(myCell.Value, Left(myDigitString,2)) &gt; 0 And _\n       Instr(myCell.Value, Right(myDigitString,3)) &gt; 0 And\n       Instr(myCell.Value, Right(myDigitString,3)) - Instr(myCell.Value, Left(myDigitString,2)) = 3 Then\n\n        ' Copy cell to another sheet\n        myCell.copy Desination:=ActiveWorkbook.Sheets(\"PasteToThisSheet\").Range(\"A1\")\n\n        ' If you only want to get the first instance then...\n        Exit For\n\n    End If\n\nNext myCell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487782225, "post_id": 42397471, "comment_id": 71942112, "body": "Excellent. At first I thought you assumed the pattern is at the end. :)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487782314, "post_id": 42397471, "comment_id": 71942164, "body": "The only remaining issue is if the &quot;_&quot; appears also elsewhere in the text ;)"}, {"owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487839824, "post_id": 42397471, "comment_id": 71967891, "body": "@Gary&#39;s Student is there a way of searching also instead of the underscore a letter? Any letter from A-Z ?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1487782501, "last_edit_date": 1487782501, "creation_date": 1487781999, "answer_id": 42397471, "question_id": 42396598, "link": "https://stackoverflow.com/questions/42396598/loop-through-column-and-check-if-cell-contains-specific-chars/42397471#42397471", "title": "Loop through column and check if cell contains specific chars", "body": "<p>With data in column <strong>D</strong>:</p>\n\n<pre><code>Sub marine()\n    Dim r As Range\n\n    For Each r In Intersect(Range(\"D:D\"), ActiveSheet.UsedRange)\n        s = r.Value\n        If s &lt;&gt; \"\" And InStr(s, \"_\") &lt;&gt; 0 Then\n            ary = Split(s, \"_\")\n            r.Offset(0, 1).Value = Right(ary(0), 2) &amp; \"_\" &amp; Left(ary(1), 3)\n            End If\n    Next r\nEnd Sub\n</code></pre>\n\n<p>There are several issues with this approach:</p>\n\n<ul>\n<li>an underscore at the beginning or end of the text</li>\n<li>more than one underscore in the string</li>\n<li>an underscore surrounded with letters.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487842635, "post_id": 42398975, "comment_id": 71969749, "body": "Thks @Jeeped, managed to get the _(underscore) and letter with the \\w sintax ... good way to learn about Regular Expressions <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>    BTW, is there any way to say if it doesnt find any value go to next cell? Thks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487861071, "post_id": 42398975, "comment_id": 71983065, "body": "I&#39;m unclear on what you mean. It loops through the cells already. Each is tested. It only adds to the results if something matching the pattern is found."}, {"owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "edited": false, "score": 0, "creation_date": 1487920056, "post_id": 42398975, "comment_id": 72010142, "body": "When it doesnt find the value on the left, on the right column it doesnt leaves a blank cell, instead it shifts it up."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1487786340, "creation_date": 1487786340, "answer_id": 42398975, "question_id": 42396598, "link": "https://stackoverflow.com/questions/42396598/loop-through-column-and-check-if-cell-contains-specific-chars/42398975#42398975", "title": "Loop through column and check if cell contains specific chars", "body": "<p>Use [regex] to look for a 'two number-underscore-three number' pattern.</p>\n\n<pre><code>Option Explicit\n\nSub pullSerialNumbers()\n    Dim n As Long, strs() As Variant, nums() As Variant\n    Dim rng As Range, ws As Worksheet\n    Dim rgx As Object, cmat As Object\n\n    Set rgx = CreateObject(\"VBScript.RegExp\")\n    Set cmat = Nothing\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    ReDim Preserve nums(0)\n\n    With ws\n        strs = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp)).Value2\n    End With\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"[0-9]{2}\\_[0-9]{3}\"\n        For n = LBound(strs, 1) To UBound(strs, 1)\n            If .Test(strs(n, 1)) Then\n                Set cmat = .Execute(strs(n, 1))\n                'resize the nums array to accept the matches\n                ReDim Preserve nums(UBound(nums) + 1)\n                'populate the nums array with the match\n                nums(UBound(nums) - 1) = cmat.Item(cmat.Count - 1)\n            End If\n        Next n\n        ReDim Preserve nums(UBound(nums) - 1)\n    End With\n\n    With ws\n        .Cells(2, \"C\").Resize(.Rows.Count - 1).Clear\n        .Cells(2, \"C\").Resize(UBound(nums) + 1, 1) = _\n            Application.Transpose(nums)\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This assumes that only one match could be found in any one cell. If there could be more then loop through the matches and add each one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oNszR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oNszR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 6463612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dbab21b43e99ade863861be48906c1f?s=128&d=identicon&r=PG&f=1", "display_name": "EdN", "link": "https://stackoverflow.com/users/6463612/edn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 42398975, "answer_count": 3, "score": 0, "last_activity_date": 1487858572, "creation_date": 1487779609, "last_edit_date": 1487786542, "question_id": 42396598, "link": "https://stackoverflow.com/questions/42396598/loop-through-column-and-check-if-cell-contains-specific-chars", "title": "Loop through column and check if cell contains specific chars", "body": "<p>I'm in need of help trying to figure if Instr function will do this trick.<br>\nIn a cell i have some text and numbers  (ex: <code>Overlay 700 MHz - 06_469</code>)<br>\nSee the final numbers? 2 numbers followed by <strong>_</strong> (underscore) or any letter and then 3 more numbers.</p>\n\n<p>Is there any way of searching for this in a specific column and if found, copy only these specific combination? NOTE: it can be anywhere in the cell, in beginning, end, middle, etc.....  </p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "edited": false, "score": 0, "creation_date": 1487782180, "post_id": 42396479, "comment_id": 71942082, "body": "Worked really well. Thank you."}], "tags": [], "owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "is_accepted": true, "score": 2, "last_activity_date": 1487779334, "creation_date": 1487779334, "answer_id": 42396479, "question_id": 42396284, "link": "https://stackoverflow.com/questions/42396284/importing-file-to-access-via-vba-with-wildcard-on-name/42396479#42396479", "title": "Importing file to Access via VBA with wildcard on name", "body": "<p>\"There is always just one file\" -> So get the filename with <code>Dir()</code> and put a variable in your arguments</p>\n\n<p>see <a href=\"https://msdn.microsoft.com/fr-fr/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/fr-fr/library/dk008ty4(v=vs.90).aspx</a></p>\n"}], "owner": {"reputation": 175, "user_id": 3993827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4fe8aa4f7628700a6ed3942dd6ffebdd?s=128&d=identicon&r=PG&f=1", "display_name": "Vitor Barreto", "link": "https://stackoverflow.com/users/3993827/vitor-barreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "accepted_answer_id": 42396479, "answer_count": 1, "score": 0, "last_activity_date": 1593956584, "creation_date": 1487778826, "last_edit_date": 1593956584, "question_id": 42396284, "link": "https://stackoverflow.com/questions/42396284/importing-file-to-access-via-vba-with-wildcard-on-name", "title": "Importing file to Access via VBA with wildcard on name", "body": "<p>Is there anyway i can use an wildcard when importing a file (excel spreadsheet for example) via VBA in Access?</p>\n\n<p>I have the following code:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9,    \"Table\", \"C:\\Files\\Process A\\1.Input\\*.XLSX\", True\n</code></pre>\n\n<p>There is always just one file in the above folder, but with different names everyday, so i need some sort of wildcard.</p>\n\n<p>Is there anyway to do it?</p>\n\n<p>Thank you,\nV\u00edtor</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1487778813, "post_id": 42396106, "comment_id": 71939610, "body": "read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a> and edit your question. Basically, show us your current effort to receive some help. Without that, you&#39;ll like get no response."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 4, "creation_date": 1487778827, "post_id": 42396106, "comment_id": 71939622, "body": "You&#39;ve labelled this question as Excel-vba, but to be honest what you&#39;re describing sounds more like a VLOOKUP or MATCH/INDEX formula set up. If you&#39;re looking at doing something in VBA then post what you&#39;ve got so far and what&#39;s failing and we&#39;ll help you with that."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1487859837, "creation_date": 1487859837, "answer_id": 42418428, "question_id": 42396106, "link": "https://stackoverflow.com/questions/42396106/excel-vba-matching-record-copy-data-between-worksheets/42418428#42418428", "title": "Excel VBA matching record copy data between worksheets", "body": "<p>You can do this without VBA.\nIn worksheet 2 column C use the following formula</p>\n\n<pre><code>=VLOOKUP(A:A,Sheet1!B:C,2,false)\n</code></pre>\n\n<p>Replace <code>Sheet1</code> with your sheet name.</p>\n"}], "owner": {"reputation": 1, "user_id": 7605761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7f9edd1d624528a0c934338874bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7605761/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487859837, "creation_date": 1487778397, "last_edit_date": 1531161705, "question_id": 42396106, "link": "https://stackoverflow.com/questions/42396106/excel-vba-matching-record-copy-data-between-worksheets", "title": "Excel VBA matching record copy data between worksheets", "body": "<p>I have spent the last week trying to find a solution to this. I'm a total novice in VBA and I need to match a name in column B of worksheet 1 with column A of worksheet 2 and then copy column C of worksheet 1 to the matched row in worksheet 2. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487778955, "post_id": 42396039, "comment_id": 71939722, "body": "Which line is the problematic one? the <code>sFormulaText</code> assignment? It&#39;s usually a good idea to minimize the amount of code you put up in your post. Side note, you should probably fetch the <i>list separator</i> character from the environment settings rather than hard-coding it - that hard-coded comma makes your code fail if the <i>list separator</i> is ever changed to anything other than a comma on the machine that runs this macro."}, {"owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487779436, "post_id": 42396039, "comment_id": 71940125, "body": "Thanks @Mat&#39;s Mug. It&#39;s the the sFormulaText assignment. Where can I find your original answer?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487779489, "post_id": 42396039, "comment_id": 71940164, "body": "There&#39;s a link at the top of the question. Also JiheL&#39;s answer is correct, just not his code (see my comment under it)."}, {"owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487779751, "post_id": 42396039, "comment_id": 71940373, "body": "Thanks @Mats Mug. Copy &amp; Pasting that gives&#39; a Compile error - Expected end of statement at the first occurrence of &quot;&quot;-&quot;&quot;&quot;,"}, {"owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "edited": false, "score": 0, "creation_date": 1487779773, "post_id": 42396039, "comment_id": 71940391, "body": "@Paul_S I just changed it again and tested it! Works now"}, {"owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "reply_to_user": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "edited": false, "score": 0, "creation_date": 1487780160, "post_id": 42396039, "comment_id": 71940685, "body": "Thank you both. @Jihel. It works now. I new it was just the syntax."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "edited": false, "score": 0, "creation_date": 1487779323, "post_id": 42396328, "comment_id": 71940032, "body": "Thanks @Jihel. I had tried that but it comes up with a Type mismatch error"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487779440, "post_id": 42396328, "comment_id": 71940129, "body": "The quotes are mismatched. Should be <code>sFormulaText = &quot;=CONCATENATE(SUMMARY!L&quot; &amp; iOffset &amp; &quot;,&quot;&quot;&quot;-&quot;&quot;&quot;,&quot;SUMMARY!M&quot; &amp; iOffset &amp; &quot;, &quot;&quot;&quot;:&quot;&quot;&quot;,&quot;SUMMARY!N&quot; &amp; iOffset &amp; &quot;)&quot;</code>"}], "tags": [], "owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "is_accepted": true, "score": 1, "last_activity_date": 1487779745, "last_edit_date": 1487779745, "creation_date": 1487778952, "answer_id": 42396328, "question_id": 42396039, "link": "https://stackoverflow.com/questions/42396039/excel-vba-coincatenate-cells-containing/42396328#42396328", "title": "Excel VBA Coincatenate Cells containing - &amp; :", "body": "<p>Use twice double quotes inside double quotes to make one double quotes appear</p>\n\n<pre><code>sFormulaText = \"=CONCATENATE(SUMMARY!L\" &amp; iOffset &amp; \",\"\"-\"\",SUMMARY!M\" &amp; iOffset &amp; \", \"\":\"\",SUMMARY!N\" &amp; iOffset &amp; \")\"\n</code></pre>\n\n<p>Not sure if you need space between double quotes and dash / dots but you can add it yourself :)</p>\n\n\n"}], "owner": {"reputation": 27, "user_id": 3450435, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d672e25e46e6fc0df888e48bf90234f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul_S", "link": "https://stackoverflow.com/users/3450435/paul-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1487779031, "accepted_answer_id": 42396328, "answer_count": 1, "score": 0, "last_activity_date": 1487779745, "creation_date": 1487778219, "question_id": 42396039, "link": "https://stackoverflow.com/questions/42396039/excel-vba-coincatenate-cells-containing", "closed_reason": "Duplicate", "title": "Excel VBA Coincatenate Cells containing - &amp; :", "body": "<p>I'm modifying some code which adds links between a Summary Sheet and costing sheets. I'm trying to code the following formula to every CS sheet in cell C1.\n=CONCATENATE(SUMMARY!L9,\" - \",SUMMARY!M9,\" : \",SUMMARY!N9), where the row will change. I'm having trouble with the syntax. What is the easiest way to achieve this?</p>\n\n<p>Code below (which almost works but does not put the required \" into the formula</p>\n\n<pre><code>Sub CSrefs()\n'\n' Adds links from Summary Sheet to CS Sheets: - Updated 29/09/15 PRS\n\nDim i As Integer, iOffset As Integer, intCount As Integer\nDim intCS1_Index As Integer, intCSCount As Integer, nonCSSheets As Integer\nDim sFormulaText As String, sDash As String, sDots As String\n\nApplication.ScreenUpdating = False\n\n    intCount = ActiveWorkbook.Sheets.Count      'Find total number of workbook sheets\n    intCS1_Index = Sheets(\"CS1\").Index          'CS1 Sheet index\n    intCSCount = intCount - (intCS1_Index - 1)  'Find total number of CS sheets\n    nonCSSheets = intCount - intCSCount         'Find total number of Non-CS sheets\n    sDash = \" - \"\n    sDots = \" : \"\n\nFor i = 1 To intCSCount 'number of sheets\n\n    iOffset = i + 8    'Start of Summary Sheet CS Rows\n        With Sheets(\"CS\" &amp; i)\n            sFormulaText = \"=CONCATENATE(SUMMARY!L\" &amp; iOffset &amp; \",\" &amp; sDash &amp; \",SUMMARY!M\" &amp; iOffset &amp; \",\" &amp; sDots &amp; \",SUMMARY!N\" &amp; iOffset &amp; \")\"\n'            .Range(\"B1\").Formula = sFormulaText\n            .Range(\"A1\").Hyperlinks.Add Anchor:=.Range(\"A1\"), Address:=\"\", SubAddress:=\"Summary!D\" &amp; iOffset, TextToDisplay:=\"SUMMARY\" 'Go to Summary Sheet hyperlink\n            .Range(\"A1\").Font.Size = 8\n            .Range(\"G1\").Formula = \"=SUMMARY!O\" &amp; iOffset ' UOM\n            .Range(\"E1\").Formula = \"=SUMMARY!P\" &amp; iOffset 'SOR Qty\n            .Range(\"I1\").Formula = \"=SUMMARY!R\" &amp; iOffset 'Cable Average\n'            .Range(\"H10\").Formula = \"=SUMMARY!C\" &amp; iOffset 'Sage Code\n            .Range(\"N17\").Formula = \"=SUMMARY!AC\" &amp; iOffset 'Materials GP%\n            .Range(\"P17\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'Materials MCD GP%\n            .Range(\"N42\").Formula = \"=SUMMARY!AD\" &amp; iOffset 'Misc GP%\n            .Range(\"P42\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'Misc MCD GP%\n            .Range(\"N67\").Formula = \"=SUMMARY!AE\" &amp; iOffset 'Labour GP\n            .Range(\"P67\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'Labour MCD GP%\n            .Range(\"N92\").Formula = \"=SUMMARY!AF\" &amp; iOffset '3rd Party GP%\n            .Range(\"P92\").Formula = \"=SUMMARY!AP\" &amp; iOffset '3rd Party MCD GP%\n            .Range(\"N117\").Formula = \"=SUMMARY!AG\" &amp; iOffset 'PM&amp;PL GP%\n            .Range(\"P117\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'PM&amp;PL MCD GP%\n            .Range(\"N142\").Formula = \"=SUMMARY!AH\" &amp; iOffset 'Bond GP%\n            .Range(\"P142\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'Bond MCD GP%\n            .Range(\"N152\").Formula = \"=SUMMARY!AG\" &amp; iOffset 'Support GP%\n            .Range(\"P152\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'Support MCD GP%\n            .Range(\"N177\").Formula = \"=SUMMARY!AH\" &amp; iOffset 'Day Works GP%\n            .Range(\"P177\").Formula = \"=SUMMARY!AP\" &amp; iOffset 'Day Works MCD GP%\n        End With\n\nNext i\n\n    Sheets(\"Summary\").Select\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["windows", "vba", "excel", "zip", "directory"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1488239423, "post_id": 42395583, "comment_id": 72134901, "body": "Perhaps you store the items before creating the new zip file?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1488273843, "post_id": 42395583, "comment_id": 72147264, "body": "Some great answers below that are VBA based but be aware the VBA will take long time to run because all file ops do, especially archiving.  You might want to consider shelling out to a command line and having a batch file do this <a href=\"http://stackoverflow.com/questions/17546016/how-can-you-zip-or-unzip-from-the-command-prompt-using-only-windows-built-in-ca\" title=\"how can you zip or unzip from the command prompt using only windows built in ca\">stackoverflow.com/questions/17546016/&hellip;</a>  The VBA environment will stay responsive whilst this completes."}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1488879014, "post_id": 42481363, "comment_id": 72415974, "body": "&quot;Chr(80) &amp; Chr(75) &amp; Chr(5) &amp; Chr(6) &amp; String(18, 0)&quot; - what does this do? It returns PK|- with 18 trailing whitespaces."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1488887234, "post_id": 42481363, "comment_id": 72421207, "body": "It&#39;s a required headline for a zip, theres some info here: <a href=\"http://www.excelforum.com/excel-general/881600-function-of-print-1-chr-80-and-chr-75-and-chr-5-and-chr-6-and-string-18-0-a.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-general/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 6, "last_activity_date": 1488185588, "creation_date": 1488185588, "answer_id": 42481363, "question_id": 42395583, "link": "https://stackoverflow.com/questions/42395583/zip-all-files-in-folder-except-the-zip-archive-itself/42481363#42481363", "title": "Zip all files in folder except the zip archive itself", "body": "<p>Rather than add all files at once, which will include the zip file you create, loop through the files with the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278516.aspx\" rel=\"noreferrer\">FileSystemObject</a> and compare their names against the zip file name before adding to the zip:</p>\n\n<pre><code>Sub AddFilesToZip()\n\nDim fso As Object, zipFile As Object, objShell As Object\nDim fsoFolder As Object, fsoFile As Object\nDim timerStart As Single\nDim folderPath As String, zipName As String\n\nfolderPath = \"C:\\Users\\darre\\Desktop\\New folder\\\" ' folder to zip\nzipName = \"myzipfile.zip\" ' name of the zip file\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\") ' create an fso to loop through the files\n\nSet zipFile = fso.CreateTextFile(folderPath &amp; zipName) ' create the zip file\nzipFile.WriteLine Chr(80) &amp; Chr(75) &amp; Chr(5) &amp; Chr(6) &amp; String(18, 0)\nzipFile.Close\n\nSet objShell = CreateObject(\"Shell.Application\")\nSet fsoFolder = fso.GetFolder(folderPath)\n\nFor Each fsoFile In fsoFolder.Files ' loop through the files...\n\n    Debug.Print fsoFile.name\n    If fsoFile.name &lt;&gt; zipName Then ' and check it's not the zip file before adding them\n\n        objShell.Namespace(\"\" &amp; folderPath &amp; zipName).CopyHere fsoFile.Path\n\n        timerStart = Timer\n        Do While Timer &lt; timerStart + 2\n            Application.StatusBar = \"Zipping, please wait...\"\n            DoEvents\n        Loop\n\n    End If\n\nNext\n\n' clean up\nApplication.StatusBar = \"\"\nSet fsoFile = Nothing\nSet fsoFolder = Nothing\nSet objShell = Nothing\nSet zipFile = Nothing\nSet fso = Nothing\n\nMsgBox \"Zipped\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 2, "creation_date": 1488272008, "post_id": 42492576, "comment_id": 72146068, "body": "Worth documenting <code>Name tempZip As targetZip</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264639(v=office.15).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>  Personally never seen that before.  Thanks for teaching me something new."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1488273637, "post_id": 42492576, "comment_id": 72147129, "body": "wow, is there a documentation link for creating a zip with these leading ASCII codes?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1488275870, "post_id": 42492576, "comment_id": 72148679, "body": "@SMeaden you&#39;re welcome, I learn something new everyday on SO :). OP used the <code>newZip</code> function which does exactly this and the sequence was long known on the net. <a href=\"https://www.codeproject.com/articles/280650/zip-unzip-using-windows-shell\" rel=\"nofollow noreferrer\">Here&#39;s a good place to start</a>."}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1488893510, "post_id": 42492576, "comment_id": 72425303, "body": "This generates &quot;Compile error: User-defined type not defined&quot; highlighting New Shell. Should it be &quot;NewShell&quot; and defined as variable earlier on?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1488894001, "post_id": 42492576, "comment_id": 72425634, "body": "@jacek_wi as I said you should <i>Add a reference to Microsoft Shell Controls and Automation</i> in the VB Editor. Otherwise you can use late binding instead: <code>With CreateObject(&quot;Shell32.Application&quot;)</code>"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 5, "last_activity_date": 1488567021, "last_edit_date": 1488567021, "creation_date": 1488218145, "answer_id": 42492576, "question_id": 42395583, "link": "https://stackoverflow.com/questions/42395583/zip-all-files-in-folder-except-the-zip-archive-itself/42492576#42492576", "title": "Zip all files in folder except the zip archive itself", "body": "<p>I would create the zip file in the temporary folder and finally move it to the destination folder. Two notes worth mentioning:</p>\n\n<p>1- The approach of looping until the Item counts are the same in the folder and the zip file is risky, because if the zipping fails for an individual item, it results in an infinite loop. For this reason it's preferable to loop as long as the zip file is locked by the shell.</p>\n\n<p>2- I will use early binding with the <code>Shell</code> because late-binding the <code>Shell32.Application</code> seems to have issues on some installations. Add a reference to <code>Microsoft Shell Controls and Automation</code></p>\n\n<pre><code>Sub compressFolder(folderToCompress As String, targetZip As String)\n    If Len(Dir(targetZip)) &gt; 0 Then Kill targetZip\n\n    ' Create a temporary zip file in the temp folder\n    Dim tempZip As String: tempZip = Environ$(\"temp\") &amp; \"\\\" &amp; \"tempzip1234.zip\"\n   CreateObject(\"Scripting.FileSystemObject\").CreateTextFile(tempZip, True).Write _\n        Chr$(80) &amp; Chr$(75) &amp; Chr$(5) &amp; Chr$(6) &amp; String(18, 0)\n\n    ' compress the folder into the temporary zip file\n    With New Shell ' For late binding: With CreateObject(\"Shell32.Application\")\n        .Namespace(tempZip).CopyHere .Namespace(folderToCompress).Items\n    End With\n\n    ' Move the temp zip to target. Loop until the move succeeds. It won't\n    ' succeed until the zip completes because zip file is locked by the shell\n    On Error Resume Next\n    Do Until Len(Dir(targetZip)) &gt; 0\n        Application.Wait Now + TimeSerial(0, 0, 1)\n        Name tempZip As targetZip\n    Loop\nEnd Sub\n\nSub someTest()\n   compressFolder \"C:\\SO\\SOZip\", \"C:\\SO\\SOZip\\Test.zip\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1488447364, "creation_date": 1488447364, "answer_id": 42551640, "question_id": 42395583, "link": "https://stackoverflow.com/questions/42395583/zip-all-files-in-folder-except-the-zip-archive-itself/42551640#42551640", "title": "Zip all files in folder except the zip archive itself", "body": "<p>I found zipping via VBA to be hard to control without third party tools, the below may not be a direct answer but may aid as a solution. The below is an excerpt of the code I used to generate epubs which are not much more than zip files with a different extension. This zipping section never failed in hundreds of runs.</p>\n\n<pre><code>Public Function Zip_Create(ByVal StrFilePath As String) As Boolean\nDim FSO         As New FileSystemObject\nDim LngCounter  As Long\n\nIf Not FSO.FileExists(StrFilePath) Then\n    'This makes the zip file, note the FilePath also caused issues\n    'it should be a local file, suggest root of a drive and then use FSO\n    'to open it\n    LngCounter = FreeFile\n    Open StrFilePath For Output As #LngCounter\n    Print #LngCounter, \"PK\" &amp; Chr(5) &amp; Chr(6) &amp; String(18, vbNullChar)\n    Close #LngCounter\nEnd If\n\nZip_Create = True\n\nEnd Function\n\nPublic Function Zip_Insert(ByVal StrZipFilePath As String, ByVal StrObject As String) As Boolean\nDim BlnYesNo            As Boolean\nDim LngCounter          As Long\nDim LngCounter2         As Long\nDim ObjApp              As Object\nDim ObjFldrItm          As Object\nDim ObjFldrItms         As Object\nDim StrContainer        As String\nDim StrContainer2       As String\n\nIf Procs.Global_IsAPC Then\n\n    'Create the zip if needed\n    If Not FSA.File_Exists(StrZipFilePath) Then\n        If Not Zip_Create(StrZipFilePath) Then\n            Exit Function\n        End If\n    End If\n\n    'Connect to the OS Shell\n    Set ObjApp = CreateObject(\"Shell.Application\")\n\n        'Pause, if it has just been created the next piece of\n        'code may not see it yet\n        LngCounter2 = Round(Timer) + 1\n        Do Until CLng(Timer) &gt; LngCounter2\n            DoEvents\n        Loop\n\n        'Divide the path and file\n        StrContainer = Right(StrObject, Len(StrObject) - InStrRev(StrObject, \"\\\"))\n        StrObject = Left(StrObject, Len(StrObject) - Len(StrContainer))\n\n        'Connect to the file (via the path)\n        Set ObjFldrItm = ObjApp.NameSpace(CVar(StrObject)).Items.Item(CVar(StrContainer))\n\n            'Pauses needed to avoid all crashes\n            LngCounter2 = CLng(Timer) + 1\n            Do Until CLng(Timer) &gt; LngCounter2\n                DoEvents\n            Loop\n\n            'If it is a folder then check there are items to copy (so as to not cause and error message\n            BlnYesNo = True\n            If ObjFldrItm.IsFolder Then\n                If ObjFldrItm.GetFolder.Items.Count = 0 Then BlnYesNo = False\n            End If\n\n            If BlnYesNo Then\n\n                'Take note of how many items are in the Zip file\n\n                'Place item into the Zip file\n                ObjApp.NameSpace(CVar(StrZipFilePath)).CopyHere ObjFldrItm\n\n                'Pause to stop crashes\n                LngCounter2 = CLng(Timer) + 1\n                Do Until CLng(Timer) &gt; LngCounter2\n                    DoEvents\n                Loop\n\n                'Be Happy\n                Zip_Insert = True\n\n            End If\n\n        Set ObjFldrItm = Nothing\n\n    Set ObjApp = Nothing\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2235, "favorite_count": 0, "answer_count": 3, "score": 9, "last_activity_date": 1488567021, "creation_date": 1487777031, "last_edit_date": 1488318713, "question_id": 42395583, "link": "https://stackoverflow.com/questions/42395583/zip-all-files-in-folder-except-the-zip-archive-itself", "title": "Zip all files in folder except the zip archive itself", "body": "<p>I am using this code to zip all files in a folder into a newly created <code>.zip</code> file:</p>\n\n<pre><code>Dim FileNameZip, FolderName\nDim filename As String, DefPath As String\nDim oApp As Object\n\n(defining all paths needed)\n\n'Create empty Zip File\nNewZip (FileNameZip)\n\nSet oApp = CreateObject(\"Shell.Application\")\n'Copy the files to the compressed folder\noApp.Namespace(FileNameZip).CopyHere oApp.Namespace(FolderName).items\n\n'Keep script waiting until Compressing is done\nOn Error Resume Next\nDo Until oApp.Namespace(FileNameZip).items.Count = oApp.Namespace(FolderName).items.Count\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\nLoop\n</code></pre>\n\n<p>This <strong>works without problems</strong> as long as my <strong>target folder is different from the folder where my files are</strong>.</p>\n\n<p>But I have a <strong>problem</strong> when I try to take <strong>all files from a folder</strong>, put them into <code>.zip</code> and have the <strong>archive generated in the same folder</strong> - it creates the archive and then tries to put it into itself, which of course fails.</p>\n\n<p>I am looking for a way to zip all files from a folder except this one newly created.</p>\n\n<p>I looked here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869597.aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff869597.aspx</a> but this looks very Outlook-specific and I have no idea how to apply this to a Windows folder.</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487776986, "post_id": 42395505, "comment_id": 71938201, "body": "try <code>sPath &amp; &quot;\\&quot; &amp; &quot;*.xl*&quot;</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487777155, "post_id": 42395505, "comment_id": 71938332, "body": "use <code>Set wBk = Workbooks.Open(sPath &amp; &quot;\\&quot; &amp; MyFile)</code>"}, {"owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "edited": false, "score": 0, "creation_date": 1487777189, "post_id": 42395505, "comment_id": 71938355, "body": "Did you make sure your <code>sPath</code> doesn&#39;t already contain the backslash character?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1487777658, "post_id": 42395505, "comment_id": 71938736, "body": "Step through it with a debugger.  What is the value of <code>MyFile</code> when the error gets thrown?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1487788474, "post_id": 42395505, "comment_id": 71946242, "body": "Is the workbook you are in (i.e. the xlsm file) located in the same directory as the others?  If it is, your code will crash when it tries to open the already open file or, if it survives that, will definitely die when it gets to the next file and tries to copy a sheet after the (now closed) <code>ThisWorkbook</code>&#39;s <code>Sheets(1)</code>."}, {"owner": {"reputation": 11, "user_id": 7605553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jTsjy.jpg?s=128&g=1", "display_name": "Bocephus480", "link": "https://stackoverflow.com/users/7605553/bocephus480"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487868266, "post_id": 42395505, "comment_id": 71988501, "body": "@CallumDA    Moving the backslash did it.  Weird that it worked before then just stopped."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1487777505, "creation_date": 1487777505, "answer_id": 42395764, "question_id": 42395505, "link": "https://stackoverflow.com/questions/42395505/excel-2016-vba-asterisk-wildcard-causing-1004-application-defined-or-object-defi/42395764#42395764", "title": "excel 2016 VBA asterisk wildcard causing 1004 application defined or object defined error", "body": "<p>I think the backslash ambiguity is causing the problem here.</p>\n\n<p>I'd suggest removing it if it's there and then adding it in manually where the code requires it:</p>\n\n<pre><code>Sub MergeDataFiles()\n\nDim sPath As String\nDim MyFile As String\nDim wBk As Workbook\nsPath = InputBox(\"Paste File Path Here\")\n\nIf Right(sPath, 1) = \"\\\" Then sPath = Left(sPath, Len(sPath) - 1) ' strip away last backslash if present\n\nMyFile = Dir(sPath &amp; \"\\*.xl*\")\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nDo While Len(MyFile) &gt; 0\nSet wBk = Workbooks.Open(sPath &amp; \"\\\" &amp; MyFile) ' include backslash to keep full path correct\nwBk.Sheets(1).Copy After:=ThisWorkbook.Sheets(1)\nwBk.Close True\nMyFile = Dir()\nLoop\n\nActiveWorkbook.Save\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7605553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jTsjy.jpg?s=128&g=1", "display_name": "Bocephus480", "link": "https://stackoverflow.com/users/7605553/bocephus480"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487779865, "creation_date": 1487776825, "last_edit_date": 1487779865, "question_id": 42395505, "link": "https://stackoverflow.com/questions/42395505/excel-2016-vba-asterisk-wildcard-causing-1004-application-defined-or-object-defi", "title": "excel 2016 VBA asterisk wildcard causing 1004 application defined or object defined error", "body": "<p>I am trying to figure out what suddenly changed in excel to make my code stop working specifically because of the asterisk wildcard.  I had this code as a front end to combine data files (both <strong>.xls</strong> and .<strong>xlsx</strong>) into a blank file that contained the code shown below.  This was working fine and used numerous times without a problem.  The file itself and the code were done on Excel 2016 a few weeks ago.  </p>\n\n<p>Now when it runs, I am receiving <strong>\"run time error 1004 application defined or object defined error\"</strong> and I have no clue why.  I tinkered with the text on every line and I am pretty sure it is \"<em>.xl</em>\" that is causing the error.  </p>\n\n<p>I replaced the \"<em>.xl</em>\" with an actual file name from a destination folder and it worked no problem.  Why would using asterisk suddenly cause this error?  </p>\n\n<p>Has anyone ran accross this before ?  I have searched high and low and could not find anyone reporting something exactly the same.  Here is what I have been using, and again, it was working fine for a couple weeks now.</p>\n\n<pre><code>Sub MergeDataFiles()\n\nDim sPath As String\nDim MyFile As String\nDim wBk As Workbook\nsPath = InputBox(\"Paste File Path Here\")\nMyFile = Dir(sPath &amp; \"\\*.xl*\")\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nDo While Len(MyFile) &gt; 0\nSet wBk = Workbooks.Open(sPath &amp; MyFile)\nwBk.Sheets(1).Copy After:=ThisWorkbook.Sheets(1)\nwBk.Close True\nMyFile = Dir()\nLoop\n\nActiveWorkbook.Save\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "dll", "vb6"], "comments": [{"owner": {"reputation": 3739, "user_id": 1268048, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/naEf9.jpg?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/1268048/phil"}, "edited": false, "score": 2, "creation_date": 1487776942, "post_id": 42395442, "comment_id": 71938170, "body": "You are mixing architectures, you can not run 32-bit code inside of a 64 application.  AFAIK."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487777180, "post_id": 42395442, "comment_id": 71938348, "body": "<a href=\"http://stackoverflow.com/questions/1076414/c-sharp-directive-to-indicate-32-bit-or-64-bit-build\" title=\"c sharp directive to indicate 32 bit or 64 bit build\">stackoverflow.com/questions/1076414/&hellip;</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ee691831(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a> may help"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1487778297, "post_id": 42395442, "comment_id": 71939195, "body": "If your DLL already works with both 32-bit and 64-bit callers, IMO you&#39;ve done the hard part already; I&#39;d think all that&#39;s missing is the 32-bit registry keys for it. The machine running 64-bit apps must have your DLL registered under the 64-bit hive; I&#39;d try <i>also</i> registering the DLL under the 32-bit one, using 32-bit <code>regasm.exe</code>. Failing that, create the keys manually (or script them). You might want the .tlb to be in a separate folder though."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487792075, "post_id": 42395442, "comment_id": 71948329, "body": "Microsoft doesn&#39;t support installing 32-bit and 64-bit versions of Office on the same PC, but you can have 32-bit Office and a 64-bit version of some other VBA host, or vice versa. If your Project&#39;s build settings specify &quot;Any CPU&quot;, then your dll should work under 32-bit and 64-bit - You just need to ensure you have both sets of registry keys present and that you&#39;ve registered the dll with the respective bit-specific <code>regasm</code>."}, {"owner": {"reputation": 79, "user_id": 7605388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaf9b2d246575c446b009fd773cdcb0?s=128&d=identicon&r=PG&f=1", "display_name": "S Stuart", "link": "https://stackoverflow.com/users/7605388/s-stuart"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487879035, "post_id": 42395442, "comment_id": 71994912, "body": "@ThunderFrame, that is my situation. I have 32 bit VB6, 32 bit Office VBA, and 64 bit SolidWorks VBA. I was trying to compile x86 and x64, so the tip about Any CPU was helpful. And I didn&#39;t realize there were 32 and 64 bit versions of regasm, so that was also part of my problem. The last piece of the puzzle was using the /codebase switch with regasm. I didn&#39;t think I needed it because I don&#39;t have a signed or strong named dll, but for whatever reason I did need it. Everything is working now. Thanks all."}], "owner": {"reputation": 79, "user_id": 7605388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaf9b2d246575c446b009fd773cdcb0?s=128&d=identicon&r=PG&f=1", "display_name": "S Stuart", "link": "https://stackoverflow.com/users/7605388/s-stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487863318, "creation_date": 1487776652, "last_edit_date": 1487863318, "question_id": 42395442, "link": "https://stackoverflow.com/questions/42395442/vb-net-dll-for-use-with-vba-vb6-32bit-and-vba-64bit", "title": "VB.NET dll for use with VBA / VB6 (32bit) and VBA (64bit)", "body": "<p>I am attempting to write a dll in VB.NET for use with our various in-house apps and macros, to simplify maintenance of code that is duplicated across the various apps.</p>\n\n<p>These legacy programs range from 32 bit VB6 and VBA to newer 64 bit VBA. Based on answers I found here and elsewhere I have been able to make a COM-visible dll work in either the 32 bit apps or the 64 bit apps, but I cannot figure out how to make both work at the same time on the same machine.</p>\n\n<p>Can anyone explain the steps involved? Layman's terms, please, as I am not a professional programmer and am new to .NET.</p>\n"}, {"tags": ["vba", "excel", "sap"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1487779898, "post_id": 42395337, "comment_id": 71940505, "body": "Please, allow me to introduce you to my Rubberduck and its <a href=\"http://www.rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Smart Indenter</a> tool. Load that ducky into your IDE, then go <i>Rubberduck &gt; Indent &gt; Current Module</i>. Or bring up the <i>Code Explorer</i> and right-click the project node and select <i>Indent</i> to auto-indent the entire project. Thank yourself later."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1487777540, "creation_date": 1487777540, "answer_id": 42395782, "question_id": 42395337, "link": "https://stackoverflow.com/questions/42395337/on-error-goto-in-loop-with-2x-next-1x-on-error-1x-on-normal-procedure/42395782#42395782", "title": "On Error GoTo in loop with 2x next (1x on error, 1x on normal procedure)", "body": "<p>Just test to see if you reached that code due to an error:</p>\n\n<pre><code>        'If an error occurs, show that in the sheet, macro now crashes when there is a second error, still needs fix\nerr_handling:                                    'report the orderstatus back to excel\n        If Err.Number &lt;&gt; 0 Then  '&lt;-- Test for error.\n            m_status = session.findById(\"wnd[0]/sbar\").Text\n            aSheet.Cells(i, 13) = m_status\n            aSheet.Cells(i, 14) = \"Error\"\n            'open new order\n            session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva01\"\n            session.findById(\"wnd[0]\").sendVKey 0\n            Err.Clear\n        End If\n    Next\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1488526745, "post_id": 42398761, "comment_id": 72279642, "body": "@Thijsk, did you get through it?"}, {"owner": {"reputation": 103, "user_id": 4887991, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/chlAy.jpg?s=128&g=1", "display_name": "Thijsk", "link": "https://stackoverflow.com/users/4887991/thijsk"}, "edited": false, "score": 0, "creation_date": 1488546423, "post_id": 42398761, "comment_id": 72291828, "body": "Hi @user3598756 , thanks for your input. Did not work the first time, then I realized I made a mistake myself in putting the codes somewhere. Now it worked like a charm!!! Thank you a lot :)!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1487785710, "creation_date": 1487785710, "answer_id": 42398761, "question_id": 42395337, "link": "https://stackoverflow.com/questions/42395337/on-error-goto-in-loop-with-2x-next-1x-on-error-1x-on-normal-procedure/42398761#42398761", "title": "On Error GoTo in loop with 2x next (1x on error, 1x on normal procedure)", "body": "<p>I think you may be after the following \"architecture\":</p>\n\n<pre><code>Sub CREATE_Sales_Order()\n\n    Set SapGuiAuto = GetObject(\"SAPGUI\")  'Get the SAP GUI Scripting object\n    ' ...\n    ' your \"Setting\" code section\n    ' ...\n\n    On Error GoTo err_handling\n\n    session.findById(\"wnd[0]\").maximize\n    session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva01\"\n    session.findById(\"wnd[0]\").sendVKey 0\n\nbegin_Loop: '&lt;--|place this label to be referenced by 'err_handling' code should this latter be reached before entering the loop\n\n    For i = 2 To aSheet.UsedRange.Rows.Count\n        If aSheet.Cells(i, 12).Value &lt;&gt; \"UPDATED\" Then\n            '...\n            '... your code inside If-Then-EndIf \n            '    you can take 'On Error GoTo err_handling' statement off it\n            '...\n        End If\n\nnext_SAP_Line: '&lt;--|place this label to be referenced by 'err_handling' code should this latter be reached while inside the loop\n\n        'open new order\n        session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva01\"\n        session.findById(\"wnd[0]\").sendVKey 0\n    Next\n\n    MsgBox \"All orders have been entered into SAP\"\n    Exit Sub '&lt;--| exit sub not to reach the subsequent 'err_handling' code \n\n\n    'If an error occurs, show that in the sheet, macro now crashes when there is a second error, still needs fix\nerr_handling:    'report the orderstatus back to excel\n    m_status = session.findById(\"wnd[0]/sbar\").Text\n    aSheet.Cells(i, 13) = m_status\n    aSheet.Cells(i, 14) = \"Error\"\n\n    If i = 0 Then Resume begin_Loop '&lt;--| if error happend before entering loop, the resume at loop start\n    Resume next_SAP_Line '&lt;--| if error happend inside loop, then resume at loop next itaration\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4887991, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/chlAy.jpg?s=128&g=1", "display_name": "Thijsk", "link": "https://stackoverflow.com/users/4887991/thijsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 42398761, "answer_count": 2, "score": 0, "last_activity_date": 1487785710, "creation_date": 1487776400, "question_id": 42395337, "link": "https://stackoverflow.com/questions/42395337/on-error-goto-in-loop-with-2x-next-1x-on-error-1x-on-normal-procedure", "title": "On Error GoTo in loop with 2x next (1x on error, 1x on normal procedure)", "body": "<p>Currently trying to build a VBA where data from Excel gets migrated into SAP. What I want is the following:\nIf no error occurs, save the order number (generated by SAP) and fill the cell next to it with \"UPDATED\", then go to the next line in SAP. If an error occurs, go to the err_handler, save the error status (generated by SAP) and fill the cell next to it with \"ERROR\", then go to the next line in SAP.\nHowever, for both codes, I need to use \"next\", and I only have 1 \"For\". The problem is, that the err_handling lines are being picked up (end of the code), even though the order went fine. What am I doing wrong here? Should I put the err_handling somewhere else?</p>\n\n<p>Besides, one more question, the pop-up windows is now called wnd[1], but is there a way to find the real name of the pop-up window, so that the macro not just automatically clicks away every popup?</p>\n\n<pre><code>Sub CREATE_Sales_Order()\n\nSet SapGuiAuto = GetObject(\"SAPGUI\")  'Get the SAP GUI Scripting object\nSet sapapp = SapGuiAuto.GetScriptingEngine 'Get the currently running SAP GUI\nSet sapCon = sapapp.Children(0) 'Get the first system that is currently connected\nSet session = sapCon.Children(0) 'Get the first session (window) on that connection\nSet aSheet = ActiveSheet\n\nOn Error GoTo err_handling\n\nsession.findById(\"wnd[0]\").maximize\nsession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva01\"\nsession.findById(\"wnd[0]\").sendVKey 0\n\nFor i = 2 To aSheet.UsedRange.Rows.Count\nIf aSheet.Cells(i, 12).Value &lt;&gt; \"UPDATED\" Then\ncol1 = Trim(CStr(aSheet.Cells(i, 1).Value))   'Column1 Order type\ncol2 = Trim(CStr(aSheet.Cells(i, 2).Value))   'Column2 Sales Org\ncol3 = Trim(CStr(aSheet.Cells(i, 3).Value))   'Column3 Distribution Channel\ncol4 = Trim(CStr(aSheet.Cells(i, 4).Value))   'Column4 Division\ncol5 = Trim(CStr(aSheet.Cells(i, 5).Value))   'Column5 Customer order number\ncol6 = Trim(CStr(aSheet.Cells(i, 6).Value))   'Column6 Sold-to\ncol7 = Trim(CStr(aSheet.Cells(i, 7).Value))   'Column7 Ship-to\ncol8 = Trim(CStr(aSheet.Cells(i, 8).Value))   'Column8 Requested Delivery Date\ncol9 = Trim(CStr(aSheet.Cells(i, 9).Value))   'Column9 Material Number\ncol10 = Trim(CStr(aSheet.Cells(i, 10).Value)) 'Column10 Material Quantity\ncol11 = Trim(CStr(aSheet.Cells(i, 11).Value))  'Column11 Price\ncol12 = Trim(CStr(aSheet.Cells(i, 12).Value)) 'Column12 KG\n\nOn Error GoTo err_handling\n\n'First entry screen\nsession.findById(\"wnd[0]/usr/ctxtVBAK-AUART\").Text = col1 \nsession.findById(\"wnd[0]/usr/ctxtVBAK-VKORG\").Text = col2 \nsession.findById(\"wnd[0]/usr/ctxtVBAK-VTWEG\").Text = col3 \nsession.findById(\"wnd[0]/usr/ctxtVBAK-SPART\").Text = col4 \n'Session.findbyid(\"wnd[0]/usr/ctxtVBAK-SPART\").SetFocus\n'Session.findbyid(\"wnd[0]/usr/ctxtVBAK-SPART\").caretPosition = 2\nsession.findById(\"wnd[0]\").sendVKey 0\n\n'Second entry screen (actual order)\nsession.findById(\"wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/txtVBKD-BSTKD\").Text = col5 '\nsession.findById(\"wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/subPART-SUB:SAPMV45A:4701/ctxtKUAGV-KUNNR\").Text = col6 \nsession.findById(\"wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/subPART-SUB:SAPMV45A:4701/ctxtKUWEV-KUNNR\").Text = col7 \nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/ssubHEADER_FRAME:SAPMV45A:4440/ctxtRV45A-KETDAT\").Text = col8 \nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/ctxtRV45A-MABNR[1,0]\").Text = col9 \nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/txtRV45A-KWMENG[2,0]\").Text = col10 '\"20000\"\n'Session.findbyid(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/txtRV45A-KWMENG[2,0]\").SetFocus\n'Session.findbyid(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/tblSAPMV45ATCTRL_U_ERF_AUFTRAG/txtRV45A-KWMENG[2,0]\").caretPosition = 19\nsession.findById(\"wnd[0]\").sendVKey 0\n'If the bill-to pop-up exists, automatically click it away\nIf session.ActiveWindow.Name = \"wnd[1]\" Then\n'session.findById(\"wnd[1]/usr/btnSPOP-OPTION1\").press\nsession.findById(\"wnd[1]\").sendVKey 0\nEnd If\n'Continue the scheduling window\nsession.findById(\"wnd[0]/shellcont/shell/shellcont[0]/shell\").pressButton \"CONT\"\n'If the price needs to be changed, do this\nIf aSheet.Cells(i, 11).Value &lt;&gt; \"\" Then\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/subSUBSCREEN_BUTTONS:SAPMV45A:4050/btnBT_PKON\").press\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\05/ssubSUBSCREEN_BODY:SAPLV69A:6201/tblSAPLV69ATCTRL_KONDITIONEN/ctxtKOMV-KSCHL[1,20]\").Text = \"YMCP\"\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\05/ssubSUBSCREEN_BODY:SAPLV69A:6201/tblSAPLV69ATCTRL_KONDITIONEN/txtKOMV-KBETR[3,20]\").Text = col11 \nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\05/ssubSUBSCREEN_BODY:SAPLV69A:6201/tblSAPLV69ATCTRL_KONDITIONEN/ctxtRV61A-KOEIN[4,20]\").Text = \"USD\"\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\05/ssubSUBSCREEN_BODY:SAPLV69A:6201/tblSAPLV69ATCTRL_KONDITIONEN/txtKOMV-KPEIN[5,20]\").Text = col12 \nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\05/ssubSUBSCREEN_BODY:SAPLV69A:6201/tblSAPLV69ATCTRL_KONDITIONEN/ctxtKOMV-KMEIN[6,20]\").Text = \"KG\"\nsession.findById(\"wnd[0]\").sendVKey 0\nEnd If\nsession.findById(\"wnd[0]/tbar[0]/btn[11]\").press\n'If the Dynamic credit check pop-up exists, automatically click it away\nIf session.ActiveWindow.Name = \"wnd[1]\" Then\nsession.findById(\"wnd[1]\").sendVKey 0\nEnd If\n\n'report the orderstatus back to excel\nm_status = session.findById(\"wnd[0]/sbar\").Text\nIf m_status &lt;&gt; \"\" Then\n    aSheet.Cells(i, 13) = m_status\n\naSheet.Cells(i, 14) = \"UPDATED\"\nEnd If\n\nsession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva01\"\nsession.findById(\"wnd[0]\").sendVKey 0\nEnd If\n\n\n'If an error occurs, show that in the sheet, macro now crashes when there is a second error, still needs fix\nerr_handling: 'report the orderstatus back to excel\nm_status = session.findById(\"wnd[0]/sbar\").Text\naSheet.Cells(i, 13) = m_status\naSheet.Cells(i, 14) = \"Error\"\n'open new order\nsession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva01\"\nsession.findById(\"wnd[0]\").sendVKey 0\n\nNext\n\nMsgBox \"All orders have been entered into SAP\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1487776308, "creation_date": 1487776308, "answer_id": 42395291, "question_id": 42395290, "link": "https://stackoverflow.com/questions/42395290/table-can-be-filtered-on-date-from-the-gui-but-not-vba/42395291#42395291", "title": "Table can be filtered on date from the GUI, but not VBA", "body": "<p>The answer seems to be that VBA is <em>really</em> particular about its dateformats.</p>\n\n<p>This code works, when none of the ones in the question does.</p>\n\n<pre><code>tbl.Range.AutoFilter Field:=9, _\n    Criteria1:=\"&gt;=\" &amp; CStr(Format(DateAdd(\"m\", -6, Now()), \"yyyy-mm-dd\")), _ \n    Operator:=xlAnd, _\n    Criteria2:=\"&lt;=\" &amp; CStr(Format(Now(), \"yyyy-mm-dd\"))\n</code></pre>\n\n<p>As a closer, I can only conclude that I get no results using the previously tried code because VBA doesn't always play well with other dateformats, but it willingly entered the strings into the table anyway. When I then inspect the table's filter using the GUI and press <code>Enter</code>, Excel recognizes the dateformat because it's not as difficult as the VBA engine, and wham, filter applied successfully.</p>\n"}], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 42395291, "answer_count": 1, "score": 0, "last_activity_date": 1487776308, "creation_date": 1487776308, "last_edit_date": 1531164843, "question_id": 42395290, "link": "https://stackoverflow.com/questions/42395290/table-can-be-filtered-on-date-from-the-gui-but-not-vba", "title": "Table can be filtered on date from the GUI, but not VBA", "body": "<p>I have a table, where one of the columns is filled with dates. I want to add dynamic sorting on this list every time it is opened, so I made a macro to trigger a date filter update on <code>Workbook_Open</code>.</p>\n\n<p>The problem is that the <strong>filter does not show any results when entered through VBA, even if I manually verify in the GUI that the code has entered the right dates</strong>. What's more, if I simply press <code>Enter</code> after verifying the dates in the GUI (that is, not changing <em>anything</em>), suddenly the filter works.</p>\n\n<p>Here is the code, the out-commented lines are things I have tried. The last line is the EXACT code the macro-recorder gave me when I recorded the GUI-process (the manual process displaying the desired results while the code for it does not):</p>\n\n<pre><code>Sub FixSortings\n    tbl.Sort.SortFields.Clear\n    tbl.Sort.SortFields.Add Key:=Range(\"Tabell2[[#All],[Ref dato]]\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n\n    With tbl.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    tbl.ShowAutoFilter = False\n\n    'tbl.Range.AutoFilter Field:=9, Criteria1:=\"&gt;=\" &amp; CStr(Format(DateAdd(\"m\", -6, Now()), \"dd.mm.yy\")), Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; CStr(Format(Now(), \"dd.mm.yy\"))\n    'tbl.Range.AutoFilter Field:=9, Criteria1:=\"&gt;=\" &amp; CStr(Format(DateAdd(\"m\", -6, Now()), \"mm.dd.yy\")), Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; CStr(Format(Now(), \"mm.dd.yy\"))\n    'tbl.Range.AutoFilter Field:=9, Criteria1:=\"&gt;=22.08.2016\", Operator:=xlAnd, Criteria2:=\"&lt;=22.02.2017\"\n    ActiveSheet.ListObjects(\"Tabell2\").Range.AutoFilter Field:=9, Criteria1:=\"&gt;=22.08.2016\", Operator:=xlAnd, Criteria2:=\"&lt;=22.02.2017\"\nEnd Sub\n</code></pre>\n\n<p>The <code>tbl</code> declaration is correct, and I know that for a fact because the sort is added as should.. and the filters are added as well in some way (since I can find the entered dates when I inspect the table from the dropdown buttons in the GUI), it just seems that while the criteria for the filter are added, it isn't executed... or something of the sort.</p>\n\n<p>I have an idea that it may be related to the localization of date formats. You can see in my code that I am using a European dateformat (dd.mm.yy), and I have previously had issues with datestamps in VBA because it seems that VBA prefers US date format. </p>\n\n<p>However, as you can also see in my code, I have tried applying the mm.dd.yy format - with no success.</p>\n"}, {"tags": ["javascript", "vb.net", "vba", "visual-studio-2013"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1487788465, "post_id": 42395054, "comment_id": 71946237, "body": "IIRC, it is: <code>WebBrowser1.Document.Window.DomWindow.execscript(Script, &quot;JavaScript&quot;)</code>"}, {"owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1487949804, "post_id": 42395054, "comment_id": 72028291, "body": "It worked perfectly, thank you sir! :)"}], "owner": {"reputation": 291, "user_id": 2337922, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5075f986b54602d68419acf1fc22ddd9?s=128&d=identicon&r=PG", "display_name": "Singularity20XX", "link": "https://stackoverflow.com/users/2337922/singularity20xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487775706, "creation_date": 1487775706, "question_id": 42395054, "link": "https://stackoverflow.com/questions/42395054/vba-versus-vb-net-triggering-javascript-functions", "title": "VBA versus VB.NET - triggering Javascript functions", "body": "<p>I'm fairly experienced in VBA and automating various applications; Internet Explorer being one of them. I recently made the jump to VB.NET / Visual Studio (2013). When it comes to automating with VBA / VB.NET one will sometimes need to trigger certain JavaScript functions in order to interact with a webpage.</p>\n\n<p>In VBA this is done by first enabling the \"JScript\" Reference. Below is an example of how to trigger a JavaScript function:</p>\n\n<pre><code>Call ie.Document.parentWindow.execScript(\"someFunction();\", \"JavaScript\")\n</code></pre>\n\n<p>I have attempted to accomplish the same in Visual Studio using the invokeScript and execCommand methods to no avail. The function is valid as I am able to trigger it via the developer console (F12). Is there a different method I should be using? Any help is greatly appreciated, thanks!</p>\n\n<p>unsuccessful example:</p>\n\n<pre><code>webbrowser1.document.invokeScript(\"someFunction\")\n</code></pre>\n"}, {"tags": ["vba", "visio", "visual-studio-macros"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 1, "creation_date": 1487776022, "post_id": 42395026, "comment_id": 71937547, "body": "Why are you using <code>oItem.Item</code> and not just <code>oItem</code> ?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487776102, "post_id": 42395026, "comment_id": 71937601, "body": "Visio object model dox: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff765377.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff765377.aspx</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487776170, "post_id": 42395026, "comment_id": 71937656, "body": "This is a shot in the dark, and maybe a little clunky, but try: <code>vsoDocument.Application.ActiveWindow.Select oItem, visSelect</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1487776262, "post_id": 42395026, "comment_id": 71937723, "body": "Also, it&#39;s not clear from the code you&#39;ve provided: why do you need to <code>Select</code> the shape?  Usually this is not necessary..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487868965, "post_id": 42395026, "comment_id": 71989037, "body": "when you edit a question, especially when you edit it in response to a comment or answer, you should probably mention/tag the person who answered already, otherwise we&#39;ve no way of knowing you&#39;ve made the revision."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1487869226, "last_edit_date": 1487869226, "creation_date": 1487776473, "answer_id": 42395378, "question_id": 42395026, "link": "https://stackoverflow.com/questions/42395026/using-excel-to-generate-a-visio-diagram-using-select-method-in-if-statement/42395378#42395378", "title": "Using Excel to generate a Visio diagram - using &#39;select&#39; method in IF statement", "body": "<blockquote>\n  <p>the .Select line fails, and I'm pretty sure it's the oItem.Item call that's failing as</p>\n</blockquote>\n\n<p>The <code>Select</code> line fails because the <code>Page</code> object doesn't have a <code>Select</code> method. That pertains to the <code>Window</code> object. From the dox, it looks like <code>oItem.Item</code> will also fail, so you can probably just use the <code>oItem</code> which itself is a <code>Shape</code> object.</p>\n\n<blockquote>\n  <p>What is the correct syntax for this command in this loop?</p>\n</blockquote>\n\n<p>Possibly as follows: </p>\n\n<pre><code>vsoDocument.Application.ActiveWindow.Select oItem, visSelect \n</code></pre>\n\n<p>However, it's not clear from the code you've provided: <strong>why do you need to <code>Select</code> the shape?</strong> Usually this is not necessary. It may be possible to do what you're trying to do without relying on <code>Select</code> at all.</p>\n\n<blockquote>\n  <p>Is there a way I could have fished for this information myself? e.g. can I reveal methods associated with the oItem definition, like \"Name\"?</p>\n</blockquote>\n\n<p>You can view the properties associated with each object using the Locals pane in the VBE, and you can view properties &amp; methods from either the documentation (which usually includes syntax examples &amp; use) or from within the VBE press <kbd>F2</kbd> to bring up the Object Browser.</p>\n\n<p>You can browse the Visio object model, here:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/ff765377.aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/office/ff765377.aspx</a> </p>\n\n<p>Navigating that hierarchy, you can browse the events, properties and methods of the <code>Shape</code> object:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff768546.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff768546.aspx</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>ALWAYS when you are deleting elements from a collection, you must do this by index, and in reverse order. </p>\n\n<pre><code>Dim i as Long\nFor i = vsoDocument.Pages(sitePage).Shapes.Count to 1 Step - 1\n    Set oItem = vsoDocument.Pages(sitePage).Shapes(i)\n    If oItem.Name &lt;&gt; \"Sheet.2\" Then\n        Debug.Print oItem.Name\n        oItem.DeleteEx (visDeleteNormal)\n    End If\nNext oItem\n</code></pre>\n\n<p>The reason this is necessary, is that when you <code>Delete</code> an item, the collection re-indexes itself, so when you delete Item #1, then Item #2 becomes the first index, but your loop takes you to the <em>next</em> item, which is now Item #3.  Forcing the loop by index, and in reverse order, prevents this undesired behavior.</p>\n"}], "owner": {"reputation": 443, "user_id": 2135406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ca8336a4e089cef9bf576bea05c791b3?s=128&d=identicon&r=PG", "display_name": "fileinster", "link": "https://stackoverflow.com/users/2135406/fileinster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "accepted_answer_id": 42395378, "answer_count": 1, "score": -1, "last_activity_date": 1593542107, "creation_date": 1487775633, "last_edit_date": 1593542107, "question_id": 42395026, "link": "https://stackoverflow.com/questions/42395026/using-excel-to-generate-a-visio-diagram-using-select-method-in-if-statement", "title": "Using Excel to generate a Visio diagram - using &#39;select&#39; method in IF statement", "body": "<p>I am currently integrating Excel with Visio to auto-populate some elements diagrammatically. I have got so far with this effort but have got stuck between the documentation, macro recordings and actually doing what I want.</p>\n\n<p>By recording macros I have found a way of selecting individual elements like so:\n<code>ActiveWindow.Select Application.ActiveWindow.Page.Shapes.ItemFromID(216), visSelect</code></p>\n\n<p>I have a loop in my script as follows:</p>\n\n<pre><code>For Each oItem In vsoDocument.Pages(sitePage).Shapes\n    If oItem.Name &lt;&gt; \"Sheet.2\" Then\n        'vsoDocument.Pages(sitePage).Select oItem.Item, visSelect ' NOW REMOVED\n        oItem.DeleteEx (visDeleteNormal)\n        Debug.Print oItem.Name\n    End If\nNext oItem\n</code></pre>\n\n<p>UPDATE: Following from your responses and sanity checks you are right that I don't need to select the shape. I have amended the code to simply show <code>oItem.DeleteEx (visDeleteNormal)</code> now and this works as expected. However I am left with a number of shapes on my sheet, such as a shape with the name \"Ethernet.46\". I don't know why some shapes were deleted and also why the page background was removed. I've found if I run my For loop once, add the background back in WITH <code>vsoDocument.Pages(sitePage).BackPage</code>, then run my For loop again another 5 times in succession it finally removes all shapes.</p>\n\n<p>QUESTION: Why is my For loop behaving unreliably?</p>\n"}, {"tags": ["r", "excel", "vba", "password-protection"], "comments": [{"owner": {"reputation": 1195, "user_id": 5043312, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-nMccE74lz4w/AAAAAAAAAAI/AAAAAAAAAFA/a7xPNweGjxU/photo.jpg?sz=128", "display_name": "Karthik Arumugham", "link": "https://stackoverflow.com/users/5043312/karthik-arumugham"}, "edited": false, "score": 0, "creation_date": 1487775111, "post_id": 42394685, "comment_id": 71936835, "body": "Try this <a href=\"http://stackoverflow.com/questions/13996740/import-password-protected-xlsx-workbook-into-r\" title=\"import password protected xlsx workbook into r\">stackoverflow.com/questions/13996740/&hellip;</a>"}, {"owner": {"reputation": 16813, "user_id": 4470365, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/FrDZc.jpg?s=128&g=1", "display_name": "Sam Firke", "link": "https://stackoverflow.com/users/4470365/sam-firke"}, "edited": false, "score": 0, "creation_date": 1487775286, "post_id": 42394685, "comment_id": 71936983, "body": "In R you could use <code>xl.read.file</code> from <code>excel.link</code>, for reading password-protected spreadsheets.  <a href=\"http://stackoverflow.com/questions/34233738/how-to-read-an-xls-file-that-is-encrypted-with-r\" title=\"how to read an xls file that is encrypted with r\">stackoverflow.com/questions/34233738/&hellip;</a>"}, {"owner": {"reputation": 2608, "user_id": 3507584, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4566e93d939844b0ee480c2a23e29aab?s=128&d=identicon&r=PG&f=1", "display_name": "user3507584", "link": "https://stackoverflow.com/users/3507584/user3507584"}, "reply_to_user": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "edited": false, "score": 1, "creation_date": 1487775554, "post_id": 42394685, "comment_id": 71937195, "body": "@Brad Your link is about protecting, not UNprotecting. Please withdraw the duplicate sign."}, {"owner": {"reputation": 2608, "user_id": 3507584, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4566e93d939844b0ee480c2a23e29aab?s=128&d=identicon&r=PG&f=1", "display_name": "user3507584", "link": "https://stackoverflow.com/users/3507584/user3507584"}, "reply_to_user": {"reputation": 16813, "user_id": 4470365, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/FrDZc.jpg?s=128&g=1", "display_name": "Sam Firke", "link": "https://stackoverflow.com/users/4470365/sam-firke"}, "edited": false, "score": 0, "creation_date": 1487775707, "post_id": 42394685, "comment_id": 71937313, "body": "@SamFirke the <code>excel.link</code> does not work with .xlsb"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1487777565, "post_id": 42394685, "comment_id": 71938670, "body": "Have you tried anything yourself? Sounds like you just found code on the internet, it didn&#39;t work, so came asking here."}], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 0, "last_activity_date": 1487778087, "last_edit_date": 1487778087, "creation_date": 1487777357, "answer_id": 42395711, "question_id": 42394685, "link": "https://stackoverflow.com/questions/42394685/unprotect-all-sheets-in-all-binary-workbooks-in-a-folder-and-save-them-unprotect/42395711#42395711", "title": "Unprotect all sheets in all binary workbooks in a folder and save them unprotected", "body": "<p>Something like this:</p>\n\n<p>Any fails to unprotect the sheets are reported in the immediate window</p>\n\n<pre><code>Sub LoopThroughFiles()\n    Dim StrFile As String\n    Dim Wb As Workbook\n    Dim ws As Worksheet\n    Dim strFol As String\n    Dim strPass As String\n\n    'password\n    strPass = \"tested\"\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n    End With\n\n    'folder to work in\n    strFol = \"c:\\temp\\\"\n\n    StrFile = Dir(strFol &amp; \"*.xls*\")\n    Do While Len(StrFile) &gt; 0\n        Set Wb = Workbooks.Open(strFol &amp; StrFile)\n            For Each ws In Wb.Worksheets\n            On Error Resume Next\n            ws.Unprotect strPass\n            If Err.Number &lt;&gt; 0 Then Debug.Print strFol &amp; StrFile &amp; \" \" &amp; ws.Name\n            On Error GoTo 0\n\n        Next\n        Wb.Save\n        Wb.Close\n        StrFile = Dir\n    Loop\n\n     With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .DisplayAlerts = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2608, "user_id": 3507584, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4566e93d939844b0ee480c2a23e29aab?s=128&d=identicon&r=PG&f=1", "display_name": "user3507584", "link": "https://stackoverflow.com/users/3507584/user3507584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 42395711, "answer_count": 1, "score": 0, "last_activity_date": 1487778087, "creation_date": 1487774763, "last_edit_date": 1487777519, "question_id": 42394685, "link": "https://stackoverflow.com/questions/42394685/unprotect-all-sheets-in-all-binary-workbooks-in-a-folder-and-save-them-unprotect", "title": "Unprotect all sheets in all binary workbooks in a folder and save them unprotected", "body": "<ul>\n<li>I have a folder with <em>.xlsb</em> workbooks.</li>\n<li>Each workbooks has 5 sheets, all of them protected with a password.</li>\n<li>The password is common for all sheets, for all workbooks. </li>\n<li>The workbooks themselves have no password.</li>\n</ul>\n\n<p>How can I unprotect all the sheets of all the workbooks and saved them as unprotected?</p>\n\n<p>I found the following code but it fails to do what I need (it works for only the active workbook).</p>\n\n<pre><code>Sub unprotect_all_sheets() \nOn Error Goto booboo \nunpass = InputBox(\"password\") \nFor Each Worksheet In ActiveWorkbook.Worksheets \nWorksheet.Unprotect Password:=unpass\nNext\nExit Sub\nbooboo: MsgBox \"There is s problem - check your password, capslock, etc.\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487775529, "post_id": 42394562, "comment_id": 71937170, "body": "Assuming the addin is loaded by default, just use <code>xlApp.Run &quot;ExportModules&quot;</code>"}, {"owner": {"reputation": 45, "user_id": 1769597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b4b0a65c6e40a117d3f00b451c0e499?s=128&d=identicon&r=PG", "display_name": "user1769597", "link": "https://stackoverflow.com/users/1769597/user1769597"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487776053, "post_id": 42394562, "comment_id": 71937572, "body": "@Comintern - yes, the add-in is loaded by default.  I tried that and get the error &quot;Cannot run the macro &#39;ExportModules&#39;.  The macro may not be available in this workbook or all macros may be disabled.&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487776270, "post_id": 42394562, "comment_id": 71937730, "body": "Try replacing all of the code below the line <code>Set xlBook = xlApp.Workbooks.Add</code> with <code>xlApp.Visible = True</code>.  When the Excel instance loads up, check to see if the addin is loaded. If not, you might just need to load it manually."}, {"owner": {"reputation": 45, "user_id": 1769597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b4b0a65c6e40a117d3f00b451c0e499?s=128&d=identicon&r=PG", "display_name": "user1769597", "link": "https://stackoverflow.com/users/1769597/user1769597"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487778397, "post_id": 42394562, "comment_id": 71939289, "body": "@Comintern - yeah, you&#39;re right - it doesn&#39;t load them when Excel opens this way.  When I open a blank worksheet, it does load the addins.  I guess I&#39;ll have to find another way, as loading it manually defeats the purpose of this script.  Thanks"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487778704, "post_id": 42394562, "comment_id": 71939511, "body": "You might want to try <code>xlApp.Addins(&quot;atpbgc2007&quot;).IsLoaded = True</code> to see if it will load dynamically at runtime. I&#39;ve had various luck in calling that  via VB though."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1578612682, "post_id": 42394562, "comment_id": 105505789, "body": "Did u ever resolve this? I&#39;m trying to do the same thing and no luck, works fine if I call <code>xlsm</code> and the macro inside that file, but not external <code>xlam</code> add-in."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3144385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251ee8ffc3d4bec53a262fc18c2b67ec?s=128&d=identicon&r=PG&f=1", "display_name": "user3144385", "link": "https://stackoverflow.com/users/3144385/user3144385"}, "is_accepted": false, "score": 0, "last_activity_date": 1588983378, "creation_date": 1588983378, "answer_id": 61690144, "question_id": 42394562, "link": "https://stackoverflow.com/questions/42394562/vbscript-to-call-macro-not-stored-within-excel-file-but-in-a-xlam-add-in/61690144#61690144", "title": "VBScript to call macro not stored within Excel file, but in a XLAM add-in", "body": "<pre><code>xlApp.open \"myfile.xlsm\"\nxlApp.open \"myaddin.xlam\"\nxlApp.run \"mymacro\"\n</code></pre>\n\n<p>Worked for me. Make sure your macro has a stop to be able to edit it.</p>\n"}], "owner": {"reputation": 45, "user_id": 1769597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b4b0a65c6e40a117d3f00b451c0e499?s=128&d=identicon&r=PG", "display_name": "user1769597", "link": "https://stackoverflow.com/users/1769597/user1769597"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 716, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1588983378, "creation_date": 1487774447, "last_edit_date": 1495535389, "question_id": 42394562, "link": "https://stackoverflow.com/questions/42394562/vbscript-to-call-macro-not-stored-within-excel-file-but-in-a-xlam-add-in", "title": "VBScript to call macro not stored within Excel file, but in a XLAM add-in", "body": "<p>I've found a few threads that are similar to what I'm trying to do, but I need to call a macro stored in an XLAM add-in.</p>\n\n<p>I have an XLAM which contains custom add-in functions available to any Excel file.  I am trying to call a macro within that XLAM.  I am using the <code>Workbooks.Add</code> rather than opening a specific file.  Below is the code I'm using:</p>\n\n<pre><code>Option Explicit\n\nRunMacro\n\nSub RunMacro()\n\n  Dim xlApp\n  Dim xlBook\n\n  Set xlApp = CreateObject(\"Excel.Application\")\n  Set xlBook = xlApp.Workbooks.Add\n  xlApp.Run \"C:\\ATPBGC97\\atpbgc2007.xlam\\ExportModules\"\n  xlApp.DisplayAlerts = False\n  xlBook.Saved = False\n  xlApp.ActiveWorkbook.Close\n\n  Set xlBook = Nothing\n  Set xlApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I used the thread <a href=\"https://stackoverflow.com/questions/10232150/run-excel-macro-from-outside-excel-using-vbscript-from-command-line\">Run Excel Macro from Outside Excel Using VBScript From Command Line</a> to get this far.  When I run the script, I get a 'Cannot run the macro' error.  I'm not exactly sure what the syntax should be in my case or if I should just open a dummy file to gain access to the XLAM.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "is_accepted": false, "score": 0, "last_activity_date": 1487777508, "last_edit_date": 1487777508, "creation_date": 1487775427, "answer_id": 42394950, "question_id": 42394338, "link": "https://stackoverflow.com/questions/42394338/reset-value-only-if-it-contains-a-certain-value/42394950#42394950", "title": "Reset value only if it contains a certain value", "body": "<p>The following code should put you on the correct path:</p>\n\n<pre><code>Dim Sh As WorkSheet\nSet Sh = Sheet(\"Sheet1\")\n\nDim R As Integer\nFor R = 1 To Sh.UsedRange.Rows.Count\n  If Sh.Cells(R, 2) = \"x\" Then Sh.Cells(R, 2) = \"-\"\nNext R\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487921539, "post_id": 42399034, "comment_id": 72010762, "body": "@GuillaumeMille, did you get through it?"}, {"owner": {"reputation": 33, "user_id": 7605342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae5a18c803eaaf4dc7847b4fefc4819?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Mille", "link": "https://stackoverflow.com/users/7605342/guillaume-mille"}, "edited": false, "score": 0, "creation_date": 1488929310, "post_id": 42399034, "comment_id": 72446484, "body": "Sorry for the extremely late reply, couldnt upvote as i was new. I did get throught it and tweeked a bit as well. Thank you for your help!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1487786551, "creation_date": 1487786551, "answer_id": 42399034, "question_id": 42394338, "link": "https://stackoverflow.com/questions/42394338/reset-value-only-if-it-contains-a-certain-value/42399034#42399034", "title": "Reset value only if it contains a certain value", "body": "<p>use <code>Replace()</code> method of <code>Range</code> object:</p>\n\n<p>if you want a <em>full</em> match:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"B:B\").SpecialCells(xlCellTypeConstants, xlTextValues).Replace what:=\"x\", replacement:=\"-\", lookat:=xlWhole\n</code></pre>\n\n<p>if you want a <em>partial</em> match:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"B:B\").SpecialCells(xlCellTypeConstants, xlTextValues).Replace what:=\"x\", replacement:=\"-\", lookat:=xlPart\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7605342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae5a18c803eaaf4dc7847b4fefc4819?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Mille", "link": "https://stackoverflow.com/users/7605342/guillaume-mille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 42399034, "answer_count": 2, "score": 0, "last_activity_date": 1487972721, "creation_date": 1487773886, "last_edit_date": 1487972721, "question_id": 42394338, "link": "https://stackoverflow.com/questions/42394338/reset-value-only-if-it-contains-a-certain-value", "title": "Reset value only if it contains a certain value", "body": "<p>I want to make a button where if i press it goes down the entire column (eg B) and where it says \"x\" replace it by \"-\" and then follows up the already set conditional formatting. Thanks (new to this kind of programming, already tried couple of things but don't function)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Item = Sheets(\"Sheet1\").Range(\"B:B\")\n\n    If (StrComp(Items, \"x\") = 0) Then\n        Items = \"-\"\n    End If\nEnd Sub    \n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1487786273, "post_id": 42394220, "comment_id": 71944896, "body": "do you have to use Gmail only? Can you use Outlook?"}, {"owner": {"reputation": 17, "user_id": 3965884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0db50a964e2e2504afe3079365c12b10?s=128&d=identicon&r=PG&f=1", "display_name": "James Laguerre", "link": "https://stackoverflow.com/users/3965884/james-laguerre"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1487789995, "post_id": 42394220, "comment_id": 71947093, "body": "yes i can use both"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1487883006, "post_id": 42394220, "comment_id": 71997200, "body": "the only thing that I cannot understand is what will be in the pdf report? Is it a specific table in your access database? You can create a pdf report from access tables and send it as an attachment via outlook easily. Also, you can populate the fields in outlook if you already know that. Plus, how are you going to run the macro? do you want to use a button or you want to run it some other way?"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "is_accepted": false, "score": 0, "last_activity_date": 1487886936, "last_edit_date": 1487886936, "creation_date": 1487802156, "answer_id": 42403411, "question_id": 42394220, "link": "https://stackoverflow.com/questions/42394220/access-2010-pdf-save-and-email-a-report-using-vba-code/42403411#42403411", "title": "Access 2010 PDF, Save and Email a Report Using VBA Code", "body": "<p>looks like you can create a macro that just runs the ribbon command</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff862419.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff862419.aspx</a></p>\n\n<p><a href=\"http://www.ribboncreator2010.de/Onlinehelp/EN/_2el0osmon.htm\" rel=\"nofollow noreferrer\">http://www.ribboncreator2010.de/Onlinehelp/EN/_2el0osmon.htm</a></p>\n\n<p>you'll need to find the right idMso for the ribbon function you're trying to use.</p>\n\n<pre><code>Sub SendToEmailAsPDF()\n\nApplication.CommandBars.ExecuteMso \"FileSendAsAttachment\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3965884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0db50a964e2e2504afe3079365c12b10?s=128&d=identicon&r=PG&f=1", "display_name": "James Laguerre", "link": "https://stackoverflow.com/users/3965884/james-laguerre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956569, "creation_date": 1487773569, "last_edit_date": 1593956569, "question_id": 42394220, "link": "https://stackoverflow.com/questions/42394220/access-2010-pdf-save-and-email-a-report-using-vba-code", "title": "Access 2010 PDF, Save and Email a Report Using VBA Code", "body": "<p>I'm using Access 2010 and found the Send to Email as PDF command indispensable. However, I have a problem in that I've hidden the main ribbon from my users which means they can't actually click that button.</p>\n\n<p>Can anyone tell me the VBA code that will let me PDF, save the file and email via Gmail an individual report based on a given unique ID? I am happy for the user to add the email address, subject and message body and for them to click send.</p>\n\n<p>I begin with the following code, but it doesn't work.</p>\n\n<pre><code>Dim myPath As String\nDim strReportName As String\n\nDoCmd.OpenReport \"rptsuivi\", acViewPreview, , \"tblsuivi.[N\u00b0Suivi] = '\" &amp; Me.[CompanyName] &amp; \"' \"\n\nmyPath = \"C:\\\"\nstrReportName = \"Raport de suivi\" + \"-\" + \".pdf\"\n\nDoCmd.OutputTo acOutputReport, acFormatPDF, , myPath + strReportName, True\nDoCmd.Close acReport, \"rptsuivi\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1487776915, "post_id": 42394215, "comment_id": 71938144, "body": "I don&#39;t believe warnings have a number or any other property you can examine programmatically (I&#39;ve never seen anyone attempt to &quot;trap&quot; warnings the way we trap errors). Generally, you would need to write logic to check for the condition which raises the warning (e.g., within an <code>If</code> block) and handle the code that way."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487777849, "post_id": 42394820, "comment_id": 71938856, "body": "That. And ditto for any other host-specific &quot;warnings&quot; (an application implementation detail), which have absolutely nothing to do with run-time errors (a VBA runtime mechanism)."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1487775110, "creation_date": 1487775110, "answer_id": 42394820, "question_id": 42394215, "link": "https://stackoverflow.com/questions/42394215/excel-vba-do-warnings-have-a-number/42394820#42394820", "title": "Excel VBA, Do warnings have a number", "body": "<p>Instead of checking the warnings, you can check directly if a cell is part of a merged cell range:</p>\n\n<pre><code>Sub testMerge(cell as Range)\n    If cell.MergeCells Then\n        Debug.Print cell.Address &amp; \" is within Merged Range.\"\n        If cell.MergeArea.Cells(1, 1).Address = cell.Address Then\n            Debug.Print cell.Address &amp; \" is first cell of Merged Range\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6038249, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb6939bf21373e9186ab9bbe6e92fa62?s=128&d=identicon&r=PG&f=1", "display_name": "Flippowitsch", "link": "https://stackoverflow.com/users/6038249/flippowitsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 42394820, "answer_count": 1, "score": 1, "last_activity_date": 1487776786, "creation_date": 1487773534, "last_edit_date": 1487776786, "question_id": 42394215, "link": "https://stackoverflow.com/questions/42394215/excel-vba-do-warnings-have-a-number", "title": "Excel VBA, Do warnings have a number", "body": "<p>When I merge cells and more than one cell contains values there is a warning that says, that only the upper left value of the range is kept. I know that I can avoid this warning by using:</p>\n\n<pre><code>Application.Display = False\n</code></pre>\n\n<p>But I would also like to execute some code when the warning would have appeared.\nI once did that for errors with:</p>\n\n<pre><code>On Error Resume Next\nIf Err.Number = 424 Then\n...\n</code></pre>\n\n<p>Is there a way to do the same for warnings?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1487770628, "post_id": 42392939, "comment_id": 71933473, "body": "You need application events: <a href=\"http://www.cpearson.com/Excel/AppEvent.aspx\" rel=\"nofollow noreferrer\">cpearson.com/Excel/AppEvent.aspx</a> specifically you want to trap the Application&#39;s <code>WorkbookOpen</code> event which will trigger for any workbook opening."}, {"owner": {"reputation": 17, "user_id": 7127147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39943d9d9a6f5f7116b49ed5c85a3f5?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hodge", "link": "https://stackoverflow.com/users/7127147/j-hodge"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1487771095, "post_id": 42392939, "comment_id": 71933793, "body": "Perfect, that&#39;s just what I wanted."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7127147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39943d9d9a6f5f7116b49ed5c85a3f5?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hodge", "link": "https://stackoverflow.com/users/7127147/j-hodge"}, "edited": false, "score": 0, "creation_date": 1487782417, "post_id": 42393828, "comment_id": 71942251, "body": "Perfect, that&#39;s just what I wanted."}], "tags": [], "owner": {"reputation": 142, "user_id": 7533979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98522f0d4a1596fd621996f52659f04f?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius B", "link": "https://stackoverflow.com/users/7533979/vinicius-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1487773782, "last_edit_date": 1487773782, "creation_date": 1487772575, "answer_id": 42393828, "question_id": 42392939, "link": "https://stackoverflow.com/questions/42392939/running-vba-code-whenever-a-workbook-is-opened/42393828#42393828", "title": "Running vba code whenever a workbook is opened", "body": "<p>You can create an Add-in that runs whenever a workbook is open</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg597509(v=office.14).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg597509(v=office.14).aspx</a></p>\n\n<p>this tool may help to create the Add in <a href=\"http://www.andypope.info/vba/ribboneditor.htm\" rel=\"nofollow noreferrer\">http://www.andypope.info/vba/ribboneditor.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1487788224, "creation_date": 1487788224, "answer_id": 42399514, "question_id": 42392939, "link": "https://stackoverflow.com/questions/42392939/running-vba-code-whenever-a-workbook-is-opened/42399514#42399514", "title": "Running vba code whenever a workbook is opened", "body": "<p>You should be able to use the Application.OnWindow event to trigger a macro when a file is opened or closed.</p>\n\n<blockquote>\n  <p>In ThisWorkbook</p>\n</blockquote>\n\n<pre><code>Private Sub Workbook_Open()\n    Call StartTracking\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Call StopTracking\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>In a Module</p>\n</blockquote>\n\n<pre><code>Function StartTracking()\n    Application.OnWindow = \"AutoRunOnWindowChange\"\nEnd Function\n\nFunction StopTracking()\n    Application.OnWindow = \"\"\nEnd Function\n\nFunction AutoRunOnWindowChange()\n    If Left(ActiveWorkbook.Name, 3) = \"EDN\" Then\n        Call Data_generator\n        Application.DisplayAlerts = False\n        ThisWorkbook.Save\n        Application.DisplayAlerts = True\n        Application.Quit\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7127147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39943d9d9a6f5f7116b49ed5c85a3f5?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hodge", "link": "https://stackoverflow.com/users/7127147/j-hodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2099, "favorite_count": 1, "accepted_answer_id": 42393828, "answer_count": 2, "score": 0, "last_activity_date": 1487788224, "creation_date": 1487770375, "last_edit_date": 1487770432, "question_id": 42392939, "link": "https://stackoverflow.com/questions/42392939/running-vba-code-whenever-a-workbook-is-opened", "title": "Running vba code whenever a workbook is opened", "body": "<p>I'm writing vba which manipulates data within a worksheet however I'm trying to make it run whenever a workbook is opened.</p>\n\n<p>The problem I'm having is that due to the workbook (that the code needs to run on) is different/new every time, I need the auto_open code to be within a personal macro workbook.</p>\n\n<pre><code>Sub Auto_Open()\nDim bookname As String\nDim checkbook As String\nDim Workbook As Workbook\n\nFor Each Workbook In Application.Workbooks\nbookname = Workbook.Name\ncheckbook = Left(bookname, 3)\n   If checkbook = \"EDN\" Then\n     Data_generator\n     Application.DisplayAlerts = False\n     ThisWorkbook.Save\n     Application.DisplayAlerts = True\n     Application.Quit\n  Else\n  End If\nNext Workbook\nEnd Sub\n</code></pre>\n\n<p>When this code runs it checks all open workbooks and sees if the first 3 letters of it are 'EDN', if it is then run the public sub called 'Data_generator', save it and quit.  If it isn't check the next open workbook, etc.</p>\n\n<p>When a file is opened from windows explorer, excel launches (with both the desired workbook and the personal macro workbook) however because excel opens the personal macro workbook first and runs the code before opening the desired workbook it doesn't find a workbook called 'EDN'.</p>\n\n<p>If the above code is ran after both workbooks have opened then the code works as intended and cycles through each open workbook to see if there's one called 'EDN' (this was proved by putting a messagebox after the 'then' and running the code), if so run the sub.</p>\n\n<p>I've proved this by putting a messagebox after the 'else', when this is done it displays the messagebox with the workbook I want, not open.  After the message box is cleared, the workbook then opens.</p>\n\n<p>Is there any way to make the desired workbook open first or any other work around for this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7409914, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15ab88b0b8b980142d8bf27a13bd15cc?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7409914/daniel"}, "edited": false, "score": 0, "creation_date": 1487771687, "post_id": 42393201, "comment_id": 71934284, "body": "And how can i give the value of the ActiveCell.Validation.Formula1 to a variable ( range variable )?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1487771049, "creation_date": 1487771049, "answer_id": 42393201, "question_id": 42392921, "link": "https://stackoverflow.com/questions/42392921/how-to-get-the-address-of-validation/42393201#42393201", "title": "How to get the address of validation?", "body": "<p>This little sub tests the active cell and gives the range of the <em>DV</em> list or lists the <em>DV</em> items or tells you there is no <em>DV</em>:</p>\n\n<pre><code>Sub IsIt()\n    On Error GoTo trap\n        MsgBox ActiveCell.Validation.Formula1\n    On Error GoTo 0\n    Exit Sub\ntrap:\n    MsgBox \"no data validation\"\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7409914, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15ab88b0b8b980142d8bf27a13bd15cc?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7409914/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 42393201, "answer_count": 1, "score": 0, "last_activity_date": 1487771049, "creation_date": 1487770320, "last_edit_date": 1531164843, "question_id": 42392921, "link": "https://stackoverflow.com/questions/42392921/how-to-get-the-address-of-validation", "title": "How to get the address of validation?", "body": "<p>There are some validated cells. I should check that a cells has validation or not. If it has validation i should get the range of its validation.\nAre there any method for it?\nI'ce tried a lot of formulas but it was unsuccessfull. </p>\n\n<pre><code>Sub checkForValidation()\nDim cell As Range, v As Long\nadatOszlop = 9\ntodoszamlalo = 0\ncelOszlop = 15\nSet lista = Sheets(\"Munka1\").Range(\"R:R\")\n\n    lista.Name = \"Szamok\"\n    For szamlalo = 4 To 25\n        v = 0\n        On Error Resume Next\n\n        v = Cells(szamlalo, celOszlop).SpecialCells(xlCellTypeSameValidation).Count\n        On Error GoTo 0\n\n        If v = 0 Then\n            Debug.Print \"No validation\"\n            Cells(szamlalo, 10) = \"No validation\"\n        Else\n            Debug.Print \"Has validation\"\n            Cells(szamlalo, 10) = \"Has validation\"\n\n                If Not lista.Find(Cells(szamlalo, adatOszlop).Value) Is Nothing Then\n                    Dim rng As Range\n                    Dim ws As Worksheet\n\n                    Sheets(\"Munka1\").Cells(szamlalo, 14) = \"ok\"\n                    Sheets(\"Munka1\").Cells(szamlalo, celOszlop) = Cells(szamlalo, adatOszlop).Value\n                Else\n                     Call selectsub(Cells(szamlalo, adatOszlop).Value)\n                End If\n        End If\n    Next\n    'End\nEnd Su\n</code></pre>\n\n<p>b</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1487772190, "post_id": 42392773, "comment_id": 71934679, "body": "I won&#39;t add as an answer as it&#39;s a link to an external site.   This outlines how to reference different parts of a pivot table:  <a href=\"http://peltiertech.com/referencing-pivot-table-ranges-in-vba/\" rel=\"nofollow noreferrer\">peltiertech.com/referencing-pivot-table-ranges-in-vba</a>"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 2317071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8415013a9ea3fe37b5434f016df5e85?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/2317071/scott"}, "edited": false, "score": 0, "creation_date": 1487779450, "post_id": 42393875, "comment_id": 71940141, "body": "Still looking for more ideas on this one - if I have Case_Ref shown on the pivots, it makes the chart labels very ugly. If I have it hidden, this macro doesn&#39;t work...."}], "tags": [], "owner": {"reputation": 103, "user_id": 2317071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8415013a9ea3fe37b5434f016df5e85?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/2317071/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1487777105, "last_edit_date": 1487777105, "creation_date": 1487772680, "answer_id": 42393875, "question_id": 42392773, "link": "https://stackoverflow.com/questions/42392773/excel-vba-to-get-item-detail-of-selected-pivot-table-row/42393875#42393875", "title": "Excel VBA to get item detail of selected Pivot Table row", "body": "<p>Ok, managed to crack it. Found another example showing how to loop through the items and extrapolated that. It was initially a bit confusing because the item number is not the order in the table so didn't correlate to the selected row.</p>\n\n<p>Revision to previous answer: If an item wasn't visible (hidden by active filter), then PivotItem.DataRange.Row threw an error. Now use error testing to see if row is visible:</p>\n\n<pre><code> Sub Pivot_Detail_By_Case__Customer_Contacts_By_Case()\n    'CCBC = Customer Contacts By Case\n    Set CCBC_PivotTable = Worksheets(\"Customer contacts by case\").PivotTables(1)\n    HeaderRow = CCBC_PivotTable.RowRange.Row\n    RowCount = CCBC_PivotTable.RowRange.Count\n\n   'Confirm limits of row range\n   'Range(Cells(HeaderRow + 1, 1), Cells(HeaderRow + RowCount - 2, 1)).Select\n\n    PivotDataStartRow = HeaderRow + 1\n    PivotDataEndRow = HeaderRow + RowCount - 2\n\n\n    If ActiveCell.Row &gt;= PivotDataStartRow And ActiveCell.Row &lt;= PivotDataEndRow Then\n        For Each PivotItem In CCBC_PivotTable.PivotFields(\"Case_Ref\").PivotItems\n            'Debug.Print PivotItem.DataRange.Row\n            'PivotItem.DataRange.Row throws an error if the item is hidden by the active filter\n            Err.Number = 0\n            'Debug.Print Err.Number\n            TestIfVisible = PivotItem.DataRange.Row\n            'Debug.Print Err.Number\n            If Err.Number = 0 Then 'Last line didn't cause an error, i.e. item is visible\n                If PivotItem.DataRange.Row = ActiveCell.Row Then\n                    SelectedCallRef = PivotItem.Value\n                    GoTo RowFound\n                End If\n            End If\n        Next\nRowFound:\n    End If\n\n    MsgBox SelectedCaseRef\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 2317071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8415013a9ea3fe37b5434f016df5e85?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/2317071/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4885, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1487777105, "creation_date": 1487769932, "question_id": 42392773, "link": "https://stackoverflow.com/questions/42392773/excel-vba-to-get-item-detail-of-selected-pivot-table-row", "title": "Excel VBA to get item detail of selected Pivot Table row", "body": "<p>OK, I've been digging through a lot of resources, but I can't find any clues on how to achieve this. I've dug through the object model but none of the properties or methods appear to give me what I need.</p>\n\n<p>I want to get the row data of the selected row. I don't want to extract the data onto a new sheet, I just want to get the Row Label of the active row. I then put that row data into a sheet that displays the details in a better format than just the extracted method.</p>\n\n<p>To simplify the example, my pivot has:</p>\n\n<ul>\n<li>Row Labels: Case_Name, Case_Ref (1:1 relationship)</li>\n<li>Column Labels: Status</li>\n<li>Values: Count of Calls</li>\n</ul>\n\n<p>Ideally, I'd like to have Case_Ref hidden from view in the Pivot, but it is the key I need to extract for the next step.</p>\n\n<p>I want the user to select one item (row) in the pivot, then press my button and have the macro return the Case_Ref of the selected row.</p>\n\n<p>My (unsuccessful) code so far looks like this:</p>\n\n<pre><code>Sub Pivot_Detail_By_Case__Customer_Contacts_By_Case()\n    'CCBC = Customer Contacts By Case\n    Set CCBC_PivotTable = Worksheets(\"Customer contacts by case\").PivotTables(1)\n    HeaderRow = CCBC_PivotTable.RowRange.Row\n    RowCount = CCBC_PivotTable.RowRange.Count\n\n    'Confirm limits of row range\n    'Range(Cells(HeaderRow + 1, 1), Cells(HeaderRow + RowCount - 2, 1)).Select\n\n    PivotDataStartRow = HeaderRow + 1\n    PivotDataEndRow = HeaderRow + RowCount - 2\n\n    If ActiveCell.Row &gt;= PivotDataStartRow And ActiveCell.Row &lt;= PivotDataEndRow Then\n        ItemNumber = ActiveCell.Row - PivotDataStartRow\n        'SelectedField = CCBC_PivotTable.DataPivotField.PivotItems(ItemNumer)\n        'pvt_InnerDetail = CCBC_PivotTable.InnerDetail\n        'SelectedField = CCBC_PivotTable.RowFields(\"Case_Ref\")\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The ItemNumber appears to work, but how do I get the Case_Ref from there?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba", "counter"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1487769413, "creation_date": 1487769413, "answer_id": 42392579, "question_id": 42392500, "link": "https://stackoverflow.com/questions/42392500/vba-i-i-1-counter-not-working/42392579#42392579", "title": "VBA : i = i + 1 counter not working", "body": "<p><code>i</code> is an <code>Integer</code> so comparison to an empty <code>String</code> is not valid.</p>\n\n<p>The closest thing you can do is</p>\n\n<p><code>If i = 0 Then</code></p>\n\n<p>But if you want the value to <code>i</code> to <em>persist</em> when you save the workbook, the simplest thing to do is to read its value from the workbook.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1487775311, "last_edit_date": 1487775311, "creation_date": 1487773942, "answer_id": 42394363, "question_id": 42392500, "link": "https://stackoverflow.com/questions/42392500/vba-i-i-1-counter-not-working/42394363#42394363", "title": "VBA : i = i + 1 counter not working", "body": "<p>Of course you cannot assign a string to an integer. This is a <code>type mismatch</code> error.</p>\n\n<p>What you need is to fetch the last cell in the column and then increment it.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    ' Fetch the last cell from column 1\n    Dim r As Range\n    With ThisWorkbook.Worksheets(\"Feuil1\")\n        Set r = .Cells(.Rows.Count, 1).End(xlUp)\n    End With\n\n    ' Get the last session number, or 0 if not present or doesn't match\n    Dim lastSession As Long: lastSession = 0\n    If Not IsEmpty(r) Then\n        Dim p As Long: p = InStr(1, Trim(r.value), \"Session \")\n        If p = 1 Then\n            lastSession = CLng(Mid(r.value, p + Len(\"Session \"), 10000))\n        End If\n    End If\n    r.Offset(1).value = \"Session \" &amp; (lastSession + 1)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487789073, "post_id": 42399292, "comment_id": 71946562, "body": "@Joliba, just curious if this code would have suited you"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1488526710, "post_id": 42399292, "comment_id": 72279624, "body": "@Joliba, doesn&#39;t matter, I will survive without your feedback as well!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1487787441, "creation_date": 1487787441, "answer_id": 42399292, "question_id": 42392500, "link": "https://stackoverflow.com/questions/42392500/vba-i-i-1-counter-not-working/42399292#42399292", "title": "VBA : i = i + 1 counter not working", "body": "<p>I'd go like follows</p>\n\n<pre><code>Private Sub Workbook_Open()\n    With Worksheets(\"Feuil1\")\n        With .Cells(.Rows.Count, 1).End(xlUp)\n            .Offset(1) = \"Session \" &amp; Val(Replace(.Value, \"Session \", \"\")) + 1\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7603393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15040d51736cf8efe7fd878db66d098?s=128&d=identicon&r=PG&f=1", "display_name": "Joliba", "link": "https://stackoverflow.com/users/7603393/joliba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 42394363, "answer_count": 3, "score": 0, "last_activity_date": 1487787441, "creation_date": 1487769217, "last_edit_date": 1487773668, "question_id": 42392500, "link": "https://stackoverflow.com/questions/42392500/vba-i-i-1-counter-not-working", "title": "VBA : i = i + 1 counter not working", "body": "<p>I'am on VBA trying to create a macro that record in different cell the number of times the workbook is open. Each time it is open, it creates a new cell with the number of the opening. So I created a counter for that.</p>\n\n<pre><code>   Option Explicit \n\n   Dim i As Integer  \n\n   Private Sub Workbook_Open() \n     If i = \"\" Then \n       i = 1 \n     End If  \n\n     ThisWorkbook.Worksheets(\"Feuil1\").Cells(i, 1).Value = \"Session \" &amp; i  \n     i = i + 1\n     Debug.Print i  \n   End Sub\n</code></pre>\n\n<p>However, the statement If i = \"\" remains highlighted in yellow, and I don't understand why...\nWould someone have a solution?</p>\n\n<p>Thank you !</p>\n"}, {"tags": ["vba", "algorithm", "visual-studio"], "comments": [{"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 6, "creation_date": 1487766285, "post_id": 42391303, "comment_id": 71930201, "body": "Isn&#39;t that simple division?"}, {"owner": {"reputation": 741, "user_id": 1200847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jV1N6.jpg?s=128&g=1", "display_name": "Georg Jung", "link": "https://stackoverflow.com/users/1200847/georg-jung"}, "edited": false, "score": 0, "creation_date": 1487766512, "post_id": 42391303, "comment_id": 71930373, "body": "Please clarify if you use vba (i.e. in an Excel macro) or vb.net (you tagged visual-studio)."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1487783210, "post_id": 42391303, "comment_id": 71942822, "body": "To explain what everyone is saying about division: in the mathematical formula <code>a &#47; b = c</code>, c is the <i>number of times b goes into a</i>. So for example, <code>13 &#47; 6 = 2.16666...</code>, so <code>6</code> goes into <code>13</code> <code>2.16666...</code> times. If you don&#39;t care about the fractional part, you can use &quot;integer division&quot; (the \\ operator instead of the / operator) to get the result truncated to a whole integer. In this case, <code>13 \\ 6 = 2</code>."}], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 1200847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jV1N6.jpg?s=128&g=1", "display_name": "Georg Jung", "link": "https://stackoverflow.com/users/1200847/georg-jung"}, "is_accepted": false, "score": 3, "last_activity_date": 1487766151, "creation_date": 1487766151, "answer_id": 42391388, "question_id": 42391303, "link": "https://stackoverflow.com/questions/42391303/visual-basic-how-to-check-how-many-times-a-number-goes-into-another/42391388#42391388", "title": "Visual Basic - How to check how many times a number goes into another", "body": "<p>You want to do an integer division. See the MSDN page about <a href=\"https://msdn.microsoft.com/en-us/library/b6ex274z.aspx\" rel=\"nofollow noreferrer\">arithmetic operators</a> or the MSDN page about the <a href=\"https://msdn.microsoft.com/en-us/library/0e16fywh.aspx\" rel=\"nofollow noreferrer\">\\ Operator</a>:</p>\n\n<pre><code>Dim k As Integer\nk = 23 \\ 5\n' The preceding statement sets k to 4.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7598104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6efa8cfa3eb39319f08bbe17eee1eb?s=128&d=identicon&r=PG&f=1", "display_name": "Phill", "link": "https://stackoverflow.com/users/7598104/phill"}, "is_accepted": false, "score": 2, "last_activity_date": 1487766850, "last_edit_date": 1487766850, "creation_date": 1487766537, "answer_id": 42391537, "question_id": 42391303, "link": "https://stackoverflow.com/questions/42391303/visual-basic-how-to-check-how-many-times-a-number-goes-into-another/42391537#42391537", "title": "Visual Basic - How to check how many times a number goes into another", "body": "<p>if you need that, simply divide one by the other and change to integer:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/se0w9esz.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/se0w9esz.aspx</a> says </p>\n\n<pre><code> number1 \\ number2\n</code></pre>\n\n<p>returns the value you desire for VB, I presume it carries over to VBA.</p>\n\n<p>Otherwise, you can use</p>\n\n<pre><code>CInt(Fix(number1/number2))\n</code></pre>\n\n<p>(from <a href=\"https://msdn.microsoft.com/en-us/library/xh29swte(v=vs.90).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/xh29swte(v=vs.90).aspx</a>)</p>\n"}], "owner": {"reputation": 163, "user_id": 7338712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2GI0C.jpg?s=128&g=1", "display_name": "lightningC00kie", "link": "https://stackoverflow.com/users/7338712/lightningc00kie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1487766850, "creation_date": 1487765967, "last_edit_date": 1487766195, "question_id": 42391303, "link": "https://stackoverflow.com/questions/42391303/visual-basic-how-to-check-how-many-times-a-number-goes-into-another", "title": "Visual Basic - How to check how many times a number goes into another", "body": "<p>I need to check how many sixes can fit into a number entered by the user to be able to use it in my program later on. So for example, two sixes can fit into 13. I was wondering if there's an algorithm I can use for this.</p>\n"}, {"tags": ["json", "vba", "excel", "curl", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1488412626, "creation_date": 1488412626, "answer_id": 42544414, "question_id": 42391130, "link": "https://stackoverflow.com/questions/42391130/convert-cmd-curl-to-excel-vba-code-in-order-to-fetch-json-data-in-an-https-site/42544414#42544414", "title": "Convert CMD cURL to Excel VBA code in order to fetch JSON data in an HTTPS site?", "body": "<p>Try something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With CreateObject(\"MSXML2.ServerXMLHTTP\")\n    .Open \"GET\", \"https://&lt;host&gt;/appserver/portal/api/1.0/apps\", False\n    .SetRequestHeader \"Accept\", \"application/json, text/javascript, */*; q=0.01\"\n    .SetRequestHeader \"Accept-Encoding\", \"gzip, deflate, sdch, br\"\n    .SetRequestHeader \"Accept-Language\", \"en-US,en;q=0.8\"\n    .SetRequestHeader \"Upgrade-Insecure-Requests\", \"1\"\n    .SetRequestHeader \"User-Agent\", \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36\"\n    .SetRequestHeader \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\"\n    .SetRequestHeader \"Referer\", \"https://&lt;host&gt;/appserver/portal/login;jsessionid=A7DE3EB54B8E5151DA304D90DB48DF2E\"\n    .SetRequestHeader \"Cookie\", \"JSESSIONID=952E2B1F8E714BE302CA902469DB0781\"\n    .SetRequestHeader \"Connection\", \"keep-alive\"\n    .SetRequestHeader \"Cache-Control\", \"max-age=0\"\n    .Send\n    sHeaders = .getAllResponseHeaders\n    sContent = .responseText\nEnd With\n</code></pre>\n\n<p>You may try <code>MSXML2.ServerXMLHTTP</code> or <code>MSXML2.XMLHTTP</code> with a particular website. Note that <code>MSXML2.XMLHTTP</code> will send saved cookies regardless you add the cookie header or not.</p>\n"}], "owner": {"reputation": 101, "user_id": 6609543, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-QlmLJZGdeak/AAAAAAAAAAI/AAAAAAAAACA/5HR3Jir1hi4/photo.jpg?sz=128", "display_name": "Mark Toledo", "link": "https://stackoverflow.com/users/6609543/mark-toledo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "accepted_answer_id": 42544414, "answer_count": 1, "score": 1, "last_activity_date": 1530714255, "creation_date": 1487765526, "last_edit_date": 1530714255, "question_id": 42391130, "link": "https://stackoverflow.com/questions/42391130/convert-cmd-curl-to-excel-vba-code-in-order-to-fetch-json-data-in-an-https-site", "title": "Convert CMD cURL to Excel VBA code in order to fetch JSON data in an HTTPS site?", "body": "<p>I need to get a JSON from this URL \"<a href=\"https://localhost/appserver/portal/api/1.0/apps\" rel=\"nofollow noreferrer\">https://localhost/appserver/portal/api/1.0/apps</a>\" and I can do that using CMD cURL.</p>\n\n<pre><code>curl 'https://&lt;host&gt;/appserver/portal/api/1.0/apps' \n-H 'Accept-Encoding: gzip, deflate, sdch, br' \n-H 'Accept-Language: en-US,en;q=0.8' \n-H 'Upgrade-Insecure-Requests: 1' \n-H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36' \n-H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' \n-H 'Referer:     https://&lt;host&gt;/appserver/portal/login;jsessionid=A7DE3EB54B8E5151DA304D90DB48DF2E' \n-H 'Cookie: JSESSIONID=952E2B1F8E714BE302CA902469DB0781' \n-H 'Connection: keep-alive' \n-H 'Cache-Control: max-age=0' \n--compressed \n--insecure\n</code></pre>\n\n<p>I am trying to fetch the JSON using Excel VBA. What is the proper way fetch JSON data using VBA in an HTTPS site?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487774697, "post_id": 42390893, "comment_id": 71936529, "body": "When asking a question make sure you put in all required information, Scotts is the best answer for your question, however your edit changed the question enough to make the others answers worthless. In cases like this consider asking a separate question."}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487776379, "post_id": 42390893, "comment_id": 71937791, "body": "Ah alright! Thanks for the critics! Im new to this so in the future i will take ur tips to use!"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1487770091, "post_id": 42390982, "comment_id": 71933075, "body": "This works like a charm! I saw altough that i was stupid and hadnt printed my collumns correctly! I have some diffrent values in column A but only some numbers has both D and I. SUch as in abowe example, D3874 BGE XS I3874 BGE XS"}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 3, "last_activity_date": 1487765130, "creation_date": 1487765130, "answer_id": 42390982, "question_id": 42390893, "link": "https://stackoverflow.com/questions/42390893/look-for-values-in-column-and-match/42390982#42390982", "title": "Look for values in column and match", "body": "<p>Use a combination of <code>IF</code> and <code>LEFT</code> to pull the first character and check if its <code>D</code> or <code>I</code></p>\n\n<pre><code>=IF(OR(LEFT(A1, 1)=\"D\", LEFT(A1, 1)=\"I\"), \"Approved\", \"Not Approved\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 0, "creation_date": 1487765995, "post_id": 42391159, "comment_id": 71930006, "body": "Lol Tim beat me and used a more efficient method."}], "tags": [], "owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "is_accepted": false, "score": 2, "last_activity_date": 1487765611, "creation_date": 1487765611, "answer_id": 42391159, "question_id": 42390893, "link": "https://stackoverflow.com/questions/42390893/look-for-values-in-column-and-match/42391159#42391159", "title": "Look for values in column and match", "body": "<p>You could use something like this:</p>\n\n<p>In Cell B1:</p>\n\n<pre><code>=IF(LEFT(A1,1)=\"D\",\"Approved\",IF(LEFT(A1,1)=\"I\",\"Approved\",\"Not Approved\"))\n</code></pre>\n\n<p>The result will be:</p>\n\n<p>If the Text in A1 starts with D or I, B1 will say \"Approved\", otherwise, you guessed it, \"Not Approved\". Just drag down to reach all required cells. Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1487770367, "post_id": 42391559, "comment_id": 71933287, "body": "This allso works like a charm! U are pros! But i am sorry and i needed to edit my question alittle bit. Some values in the column are diffrent and i would like to check one row value in column to see if it has a I before aswell. Only some rows have both D and I so i would need to look at one row in Column A and see if the value after D can be find with in the column and starts with I. IS it possible?"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1487767194, "last_edit_date": 1487767194, "creation_date": 1487766612, "answer_id": 42391559, "question_id": 42390893, "link": "https://stackoverflow.com/questions/42390893/look-for-values-in-column-and-match/42391559#42391559", "title": "Look for values in column and match", "body": "<p>Here is another way to achieve the same thing. Although if you ever intend to add more than just two conditions (<code>I and D</code>) then I'd go with this:</p>\n\n<pre><code>=IF(ISNA(MATCH(LEFT(A1),{\"D\",\"I\"},0)),\"Not Approved\",\"Approved\")\n</code></pre>\n\n<p>Which you could extend, to include more conditions, in either of these ways</p>\n\n<pre><code>=IF(ISNA(MATCH(LEFT(A1),{\"D\",\"I\",\"A\",\"B\"},0)),\"Not Approved\",\"Approved\")\n=IF(ISNA(MATCH(LEFT(A1),A1:A4,0)),\"Not Approved\",\"Approved\")\n</code></pre>\n\n<p>Where <code>A1:A4</code> contains your conditions in the last example.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1487772264, "creation_date": 1487772264, "answer_id": 42393707, "question_id": 42390893, "link": "https://stackoverflow.com/questions/42390893/look-for-values-in-column-and-match/42393707#42393707", "title": "Look for values in column and match", "body": "<p>This will find if the same number is found with both an I and a D prefix, if so it will return <code>Approved</code> if not <code>Not Approved</code>:</p>\n\n<pre><code>=IF(COUNTIF(A:A,IF(LEFT(A1,1)=\"D\",\"I\",\"D\")&amp;MID(A1,2,LEN(A1))),\"Approved\",\"Not Approved\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yzMRJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yzMRJ.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>NOTE:</p>\n\n<p>This only works if <code>I</code> and <code>D</code> are the only prefixes, or you will get false positives.</p>\n"}], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 42393707, "answer_count": 4, "score": 0, "last_activity_date": 1487772264, "creation_date": 1487764938, "last_edit_date": 1487770611, "question_id": 42390893, "link": "https://stackoverflow.com/questions/42390893/look-for-values-in-column-and-match", "title": "Look for values in column and match", "body": "<p>Got damn it! Im stuck again. </p>\n\n<p>I have tried to do some helper columns to sort out information from 1 column and then show me if there is a similiarity in the value. </p>\n\n<p>What I have now is, </p>\n\n<p>values in column A</p>\n\n<pre><code>D3875 HMG XS\nD3875 BGE XS\nD3874 BGE XS\nI3874 BGE XS\n</code></pre>\n\n<p>I want to use to number to see if I have both D and I at the beginning of string because this means that my value is approved. </p>\n\n<p>Edit- There are only some cells in the column that has the same value exept D and I at the beginning. In abowe example it is </p>\n\n<pre><code>D3874 BGE XS\nI3874 BGE XS\n</code></pre>\n\n<p>Could i somehow ( dont know how right now) lets say make a loop where i take the first value in column A such as D3875 HMG XS and use 3875 HMG XS too loop in the column untill i find a cell with the same value exept that it holds a I instead of D at the beginning?</p>\n"}, {"tags": ["excel", "vba", "recursion"], "comments": [{"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487767228, "post_id": 42390675, "comment_id": 71930902, "body": "Hey @dc2 , if this is in excel you can use =min(cell1,cell2,cellAbove)... does that work?"}, {"owner": {"reputation": 13, "user_id": 5044495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65681b872ce270a21590e44eadc1f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "DC2", "link": "https://stackoverflow.com/users/5044495/dc2"}, "reply_to_user": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487768462, "post_id": 42390675, "comment_id": 71931830, "body": "No, I need it coded in VBA, as the values change."}, {"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487768564, "post_id": 42390675, "comment_id": 71931899, "body": "So I guess I don&#39;t understand what you are doing then- is your data in excel? Both current and desired? So you are writing a UDF or a sub? Just unclear on what you are trying to do..."}, {"owner": {"reputation": 13, "user_id": 5044495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65681b872ce270a21590e44eadc1f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "DC2", "link": "https://stackoverflow.com/users/5044495/dc2"}, "reply_to_user": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487768728, "post_id": 42390675, "comment_id": 71932033, "body": "Hi, the data is being output by another function I have written in VBA. The result is the output of that function  (function1). The current column is the current output with my code trying to fix the problem. I need the the output to look like the desired column however."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487771185, "post_id": 42390675, "comment_id": 71933849, "body": "I&#39;m not sure I understand what you mean by &quot;the result is capped at the lowest point&quot;.  The lowest point of what?  Also, is this being <i>used</i> as a UDF - i.e. do you have cells where you&#39;ve used <code>function2</code> in the cell&#39;s formula?"}, {"owner": {"reputation": 13, "user_id": 5044495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65681b872ce270a21590e44eadc1f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "DC2", "link": "https://stackoverflow.com/users/5044495/dc2"}, "edited": false, "score": 0, "creation_date": 1487771294, "post_id": 42390675, "comment_id": 71933928, "body": "Yes, it is being used as a UDF. Basically these points create a curve, and I don&#39;t want the curve to start increasing. I want it to stay flat. So the function once it outputs 2.170 shouldn&#39;t then increase to 2.182, but stay flat thereafter at 2.170."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1487776964, "post_id": 42390675, "comment_id": 71938187, "body": "I don&#39;t see why you need recursion - Assuming the results column starts in C2 then enter =Function1(var1,var2,var3,var4) in C2 and then enter =MIN(C2,Function1(var1,var2,var3,var4)) in C3 and copy down"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5044495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65681b872ce270a21590e44eadc1f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "DC2", "link": "https://stackoverflow.com/users/5044495/dc2"}, "edited": false, "score": 0, "creation_date": 1487770861, "post_id": 42393081, "comment_id": 71933624, "body": "Right, I would do that, except the minimum changes and there is no way to calculate the minimum. The formula has 4 inputs, so the minimum changes depending upon the inputs."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0bcf144c93eee31749c6bdd09eb4ce?s=128&d=identicon&r=PG&f=1", "display_name": "John Phillips", "link": "https://stackoverflow.com/users/5910439/john-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1487770740, "creation_date": 1487770740, "answer_id": 42393081, "question_id": 42390675, "link": "https://stackoverflow.com/questions/42390675/recursive-vba-function/42393081#42393081", "title": "Recursive VBA Function", "body": "<p>Just create a variable that can hold the minimum value? Let's say, minVar.</p>\n\n<p>If the result is larger than the minimum, then use the minVar.\nIf the result is lower than the minimum, then use the value and overwrite the minVar.</p>\n\n<pre><code>Dim minVar as double\nminVar = 999999    \nIf function_temp &lt; function1(var1, var2, var3, var4) \n        Then  if function_temp &lt; minVar\n                 Then minVar = function_temp\n               end if\n         temp function2= function_temp\n end if\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5044495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65681b872ce270a21590e44eadc1f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "DC2", "link": "https://stackoverflow.com/users/5044495/dc2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487770740, "creation_date": 1487764457, "last_edit_date": 1487764515, "question_id": 42390675, "link": "https://stackoverflow.com/questions/42390675/recursive-vba-function", "title": "Recursive VBA Function", "body": "<p>I am trying to program a recursive function in VBA so that once the function I have created starts increasing, the result is capped at the lowest point. </p>\n\n<p>The code I have written so far is:</p>\n\n<pre><code>Public Function function2(var1, var2, var3, var4)\n\ntemp = Application.WorksheetFunction.Max(var3- 1, 2)\n\nfunction_temp = function1(var1,var2, temp, var4)\n\n\nIf function_temp &lt; function1(var1, var2, var3, var4) Then function2= function_temp \n\nIf function_temp &gt;= function1(var1, var2, var3, var4) Then function2= function1(var1, var2, var3, var4)\n\nEnd Function\n</code></pre>\n\n<p>Here is what the numbers look like, with the Desired column what I want ultimately. </p>\n\n<pre><code>Duration    Result  Current Desired\n\n2   2.845   2.845   2.845\n\n3   2.563   2.563   2.563\n\n4   2.371   2.371   2.371\n\n5   2.252   2.252   2.252\n\n6   2.189   2.189   2.189\n\n7   2.170   2.170   2.170\n\n8   2.182   2.170   2.170\n\n9   2.213   2.182   2.170\n\n10  2.246   2.213   2.170\n\n11  2.259   2.246   2.170\n\n12  2.241   2.241   2.170\n</code></pre>\n\n<p>I realize I need to use a recursive function, but I can't sort it out. Any thoughts? thanks. </p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487764375, "post_id": 42390611, "comment_id": 71928765, "body": "Is your fill arrays using for x=1 to y on the range or does it populate using arr=range(x), can you put a touch more code around what you have to?"}, {"owner": {"reputation": 15, "user_id": 7410051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/G9ISF.jpg?s=128&g=1", "display_name": "SmartSolid", "link": "https://stackoverflow.com/users/7410051/smartsolid"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487767359, "post_id": 42390611, "comment_id": 71930999, "body": "Hi Nathan, I have: <code>Public Sub FillArray(ByRef data As Variant, sRange As String)</code> <code>data = oCurrentWs.Range(sRange)</code> <code>End Sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7410051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/G9ISF.jpg?s=128&g=1", "display_name": "SmartSolid", "link": "https://stackoverflow.com/users/7410051/smartsolid"}, "edited": false, "score": 0, "creation_date": 1487780214, "post_id": 42390890, "comment_id": 71940718, "body": "Whilst I appreciate the reply it doesn&#39;t relate to the issue I&#39;ve described as there is no problem with the LBound and UBound of the variant. Refer to the image at the following link which shows the problem: <a href=\"http://i.imgur.com/J7uzspf.png\" rel=\"nofollow noreferrer\">i.imgur.com/J7uzspf.png</a>"}], "tags": [], "owner": {"reputation": 3577, "user_id": 1328605, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e9acb25cf8f950bf366c68daf06eac7b?s=128&d=identicon&r=PG", "display_name": "Anil", "link": "https://stackoverflow.com/users/1328605/anil"}, "is_accepted": false, "score": 1, "last_activity_date": 1487826625, "last_edit_date": 1487826625, "creation_date": 1487764931, "answer_id": 42390890, "question_id": 42390611, "link": "https://stackoverflow.com/questions/42390611/lbound-of-arrays-stored-inside-variant/42390890#42390890", "title": "LBound of arrays stored inside variant", "body": "<p>Variant arrays are dynamic arrays of the Variant type\nthese are initialized using \"<code>= Array(</code>)\". </p>\n\n<p><strong>Advantage</strong> </p>\n\n<p>as they are initialized using \"<code>= Array()</code>\", <code>LBound</code> and <code>UBound</code> functions work with them even when they have no elements:</p>\n\n<pre><code>Dim varr As Variant\n\n  varr = Array()\n\n  Debug.Print LBound(varr) 'Prints 0\n  Debug.Print UBound(varr) 'Prints -1\n</code></pre>\n\n<p>Now we can also add an element without checking for UBound failure</p>\n\n<p><strong>Excel Ranges Use Base 1</strong></p>\n\n<p>When an array is populated straight from a range the array will start at 1 and not 0.</p>\n\n<p>For more information refer to the <a href=\"http://bettersolutions.com/excel/cells-ranges/vba-working-with-arrays.htm\" rel=\"nofollow noreferrer\">Cells &amp; Ranges > Working With Arrays</a></p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7410051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/G9ISF.jpg?s=128&g=1", "display_name": "SmartSolid", "link": "https://stackoverflow.com/users/7410051/smartsolid"}, "edited": false, "score": 0, "creation_date": 1488367333, "post_id": 42409961, "comment_id": 72196435, "body": "Only just getting back to this. Thanks for the explanation and sample code. I&#39;ve tested it and it works great, many thanks."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1487836435, "creation_date": 1487836435, "answer_id": 42409961, "question_id": 42390611, "link": "https://stackoverflow.com/questions/42390611/lbound-of-arrays-stored-inside-variant/42409961#42409961", "title": "LBound of arrays stored inside variant", "body": "<p>it's because the assignment of a <code>Range</code> to a <code>Variant</code> would always result in a 1-lowerbounded array, regardless of any <code>Option Base</code> setting.</p>\n\n<p>as you can see with this test:</p>\n\n<pre><code>    Public Sub FillArray(ByRef data As Variant, sRange As String)\n        With oCurrentWs.Range(sRange)\n            ReDim data(0 To .Rows.Count - 1, 0 To .Columns.Count - 1) '&lt;--| this dims 'data' as a 0-based array\n            data = .Value '&lt;--| this redims 'data' as a 1-based array\n        End With\n    End Sub\n</code></pre>\n\n<p>so if you <em>really</em> need to have 0-based arrays you have to code like follows:</p>\n\n<pre><code>Public Sub FillArray(ByRef data As Variant, sRange As String)\n    Dim i As Long, j As Long\n    With oCurrentWs.Range(sRange)\n        ReDim data(0 To .Rows.Count - 1, 0 To .Columns.Count - 1) '&lt;--| dim 'data' as a zero-based array\n        For i = 1 To .Rows.Count '&lt;--| loop through referenced range rows\n            For j = 1 To .Columns.Count '&lt;--| loop through referenced range columns\n                data(i - 1, j - 1) = .Cells(i, j) '&lt;--| fill each array element individually\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7410051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/G9ISF.jpg?s=128&g=1", "display_name": "SmartSolid", "link": "https://stackoverflow.com/users/7410051/smartsolid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 42409961, "answer_count": 2, "score": 0, "last_activity_date": 1487856205, "creation_date": 1487764302, "last_edit_date": 1495539974, "question_id": 42390611, "link": "https://stackoverflow.com/questions/42390611/lbound-of-arrays-stored-inside-variant", "title": "LBound of arrays stored inside variant", "body": "<p>In this <a href=\"https://stackoverflow.com/questions/41901482/how-to-add-loop-counter-value-as-array-name-suffix\">question</a> I was given an answer which solved my problem but as I have been going through my code I have noticed something odd. When I assign the 3 arrays to the arrays variant, I can see in the locals window that the LBound of the variant starts at 0 (as expected) however the individual arrays LBound starts at 1 even though I have written <code>Option Base 0</code> at the top of the module. Is this correct?</p>\n\n<p>Code to populate array</p>\n\n<pre><code>Public Sub FillArray(ByRef data As Variant, \n                    sRange As String) \ndata = oCurrentWs.Range(sRange) End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 1909504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ad1ff603c41eb28fa4106e8f7ead6283?s=128&d=identicon&r=PG", "display_name": "Ingeborg", "link": "https://stackoverflow.com/users/1909504/ingeborg"}, "edited": false, "score": 0, "creation_date": 1487801843, "post_id": 42399421, "comment_id": 71953666, "body": "Thank you very much! But I&#39;m afraid I don&#39;t know how to use this code. Is the array like a table with two columns? 1. Name of style used in paragraph 2. Number of characters in that paragraph  How do I summarize the numbers in column 2 and populate my variables?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 189, "user_id": 1909504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ad1ff603c41eb28fa4106e8f7ead6283?s=128&d=identicon&r=PG", "display_name": "Ingeborg", "link": "https://stackoverflow.com/users/1909504/ingeborg"}, "edited": false, "score": 0, "creation_date": 1487801979, "post_id": 42399421, "comment_id": 71953731, "body": "You can think of it as a table with two columns. It&#39;s one more dimension than your use of <code>Dim mlm(10) As String</code>"}, {"owner": {"reputation": 189, "user_id": 1909504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ad1ff603c41eb28fa4106e8f7ead6283?s=128&d=identicon&r=PG", "display_name": "Ingeborg", "link": "https://stackoverflow.com/users/1909504/ingeborg"}, "edited": false, "score": 0, "creation_date": 1487815383, "post_id": 42399421, "comment_id": 71958287, "body": "Thank you, I finnaly figured it out :-) I&#39;ll post the code here as soon as I have tidyed it up!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1487787969, "creation_date": 1487787969, "answer_id": 42399421, "question_id": 42390551, "link": "https://stackoverflow.com/questions/42390551/vba-slow-macro-looping-through-paragraphs/42399421#42399421", "title": "VBA: Slow macro looping through paragraphs", "body": "<p>Try loading it into memory first, then taking action after the data has been loaded to an array. I just did a test with about 60 pages, it is taking about 8 seconds to populate the various attributes to an array. Once it's in the array, then manipulate it from there.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    Debug.Print Now()\n    Dim doc     As Document: Set doc = ActiveDocument\n    Dim i       As Long\n    Dim myArr   As Variant: ReDim myArr(1, 0 To doc.Paragraphs.Count - 1)\n    Dim para    As Paragraph\n\n    For Each para In doc.Paragraphs\n        myArr(0, i) = para.Style\n        myArr(1, i) = para.Range.Characters.Count\n        i = i + 1\n    Next\n\n    Debug.Print Now()\n    Debug.Print myArr(0, 0), myArr(1, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 189, "user_id": 1909504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ad1ff603c41eb28fa4106e8f7ead6283?s=128&d=identicon&r=PG", "display_name": "Ingeborg", "link": "https://stackoverflow.com/users/1909504/ingeborg"}, "is_accepted": false, "score": 0, "last_activity_date": 1487847234, "creation_date": 1487847234, "answer_id": 42413701, "question_id": 42390551, "link": "https://stackoverflow.com/questions/42390551/vba-slow-macro-looping-through-paragraphs/42413701#42413701", "title": "VBA: Slow macro looping through paragraphs", "body": "<p>I'm not sure if this is the proper way of doing this, but at least it works! I hope this code may help someone else looking for a way to loop through paragraphs and count the characters. Thank you Ryan!</p>\n\n<pre><code>            Option Explicit\n\n            Public Sub avsnittsteller()\n            'http://stackoverflow.com/questions/42390551/vba-slow-macro-looping-through-paragraphs\n            Debug.Print Now()\n            Application.ScreenUpdating = True\n\n            'Rydd opp i formateringen\n            Call stilFinner\n                'deklarere variablene\n                Dim doc     As Document: Set doc = ActiveDocument\n                Dim i       As Long\n                Dim j       As Long\n                Dim k       As Long\n                Dim H1       As Long\n                Dim H2       As Long\n                Dim H3       As Long\n                Dim N       As Long\n                Dim myArr   As Variant: ReDim myArr(1, 0 To doc.Paragraphs.Count - 1)\n                Dim mlm(10) As String\n                Dim para    As Paragraph\n                'Hent fram verdier i globale variabler som angir riktig lengde\n                intTittel = ActiveDocument.CustomDocumentProperties(\"malTittel\").Value\n                intTittelI = ActiveDocument.CustomDocumentProperties(\"malTittelI\").Value\n                intTittelX = ActiveDocument.CustomDocumentProperties(\"malTittelX\").Value\n                intIngress = ActiveDocument.CustomDocumentProperties(\"malIngress\").Value\n                intNormal = ActiveDocument.CustomDocumentProperties(\"malNormal\").Value\n\n                'sett variablene til 0 f\u00f8r de avsnittene telles\n                tittel = 0\n                ingress = 0\n                mlm(1) = 0\n                mlm(2) = 0\n                mlm(3) = 0\n                mlm(4) = 0\n                mlm(5) = 0\n                mlm(6) = 0\n                mlm(7) = 0\n\n                'Lag en matrise (array) i minnet og kj\u00f8r s\u00f8ket fra den\n            'Debug.Print doc.Paragraphs.Count\n                For Each para In doc.Paragraphs\n                    myArr(0, i) = para.Style\n                    myArr(1, i) = para.Range.Characters.Count - 1 'ComputeStatistics(wdStatisticCharacters)\n                    i = i + 1\n                Next\n                'For hvert avsnitt fra 0 til antall avsnitt i dokumentet\n                   For j = 0 To doc.Paragraphs.Count - 1\n                        'Hvis avsnittets stil er Normal eller en av overskriftene s\u00e5 legg sammen alle tegnene\n                        If myArr(0, j) = \"Normal\" Then\n                            N = N + myArr(1, j)\n                        'Debug.Print j, myArr(0, j), myArr(1, j)\n                        End If\n                        If myArr(0, j) = \"Overskrift 1\" Or myArr(0, j) = \"Heading 1\" Then\n                            H1 = H1 + myArr(1, j)\n                        'Debug.Print j, myArr(0, j), myArr(1, j)\n                        End If\n                        If myArr(0, j) = \"Overskrift 2\" Or myArr(0, j) = \"Heading 2\" Then\n                            H2 = H2 + myArr(1, j)\n                        'Debug.Print j, myArr(0, j), myArr(1, j)\n                        End If\n                        If myArr(0, j) = \"Overskrift 3\" Or myArr(0, j) = \"Heading 3\" Then\n                            'Alle avsnitt med H3 telles ett og ett, summeres ikke\n                            k = k + 1\n                            mlm(k) = myArr(1, j)\n                        Debug.Print j, myArr(0, j), myArr(1, j)\n                        End If\n                    Next j 'Neste avsnitt\n            'Debug.Print N &amp; \" \" &amp; H1 &amp; \" \" &amp; H2\n            'Debug.Print mlm(1) &amp; \" \" &amp; mlm(2) &amp; \" \" &amp; mlm(3) &amp; \" \" &amp; mlm(4) &amp; \" \" &amp; mlm(5)\n\n                        'DEFINER DOC PROPERTIES VARIABLENE\n                        ActiveDocument.CustomDocumentProperties(\"tittel\").Value = H1\n                        ActiveDocument.CustomDocumentProperties(\"ingress\").Value = H2\n                        ActiveDocument.CustomDocumentProperties(\"mlm1\").Value = mlm(1)\n                        ActiveDocument.CustomDocumentProperties(\"mlm2\").Value = mlm(2)\n                        ActiveDocument.CustomDocumentProperties(\"mlm3\").Value = mlm(3)\n                        ActiveDocument.CustomDocumentProperties(\"mlm4\").Value = mlm(4)\n                        ActiveDocument.CustomDocumentProperties(\"mlm5\").Value = mlm(5)\n                        ActiveDocument.CustomDocumentProperties(\"mlm6\").Value = mlm(6)\n                        ActiveDocument.CustomDocumentProperties(\"mlm7\").Value = mlm(7)\n                        ActiveDocument.CustomDocumentProperties(\"normal\").Value = N\n\n                        ActiveDocument.Fields.Update 'OPPDATER ALLE FELT nb, virker ikke i bunn og topptekst\n\n                        'Farg tittel og ingress r\u00f8d om de er for lange, bl\u00e5 om de er passe korte\n                        If tittel &gt; intTittelX Then\n                            With ActiveDocument.Styles(wdStyleHeading1).Font\n                                .Color = wdColorRed\n                            End With\n                        Else\n                            With ActiveDocument.Styles(wdStyleHeading1).Font\n                                .Color = -738148353\n                            End With\n                        End If\n\n                        If ingress &gt; intIngress Then\n                            With ActiveDocument.Styles(wdStyleHeading2).Font\n                                .Color = wdColorRed\n                            End With\n                        Else\n                            With ActiveDocument.Styles(wdStyleHeading2).Font\n                                .Color = -738148353\n                            End With\n                        End If\n\n            Application.ScreenUpdating = True\n            Debug.Print Now()\n            End Sub\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 1909504, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ad1ff603c41eb28fa4106e8f7ead6283?s=128&d=identicon&r=PG", "display_name": "Ingeborg", "link": "https://stackoverflow.com/users/1909504/ingeborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 42399421, "answer_count": 2, "score": 0, "last_activity_date": 1487847234, "creation_date": 1487764156, "last_edit_date": 1487806280, "question_id": 42390551, "link": "https://stackoverflow.com/questions/42390551/vba-slow-macro-looping-through-paragraphs", "title": "VBA: Slow macro looping through paragraphs", "body": "<p>My macro in VBA Word 2016 (Win10) is verys slow for a 3-page document. What can I do to make it faster? Or is there another way I may count characters in paragraphs of different styles? I need to know how many characters are written in Normal style, H1-style etc.</p>\n\n<pre><code>Sub avsnittsteller()\n\n'Optimize Code\nApplication.ScreenUpdating = False\n\n'Rydd opp i formateringen\n'Call stilFinner\n\nintTittel = ActiveDocument.CustomDocumentProperties(\"malTittel\").Value\nintTittelI = ActiveDocument.CustomDocumentProperties(\"malTittelI\").Value\nintTittelX = ActiveDocument.CustomDocumentProperties(\"malTittelX\").Value\nintIngress = ActiveDocument.CustomDocumentProperties(\"malIngress\").Value\nintNormal = ActiveDocument.CustomDocumentProperties(\"malNormal\").Value\n\n'sett variablene til 0 f\u00f8r de avsnittene telles\nDim mlm(10) As String\ntittel = 0\ningress = 0\nmlm(1) = 0\nmlm(2) = 0\nmlm(3) = 0\nmlm(4) = 0\nmlm(5) = 0\nmlm(6) = 0\nmlm(7) = 0\n\n' TELLE TEGN I ALLE AVSNITT\nDim Doc As Document\nSet Doc = ActiveDocument\nDim para As Paragraph\nDim i As Long: i = 0\nDim j As Long: j = 0\nDim k As Long: k = 0\n\nFor Each para In Doc.Paragraphs\n    If para.Style = Doc.Styles(\"instruksjon\") Or _\n    para.Style = Doc.Styles(\"Bildetekst\") Or _\n    para.Style = Doc.Styles(\"Byline\") Or _\n    para.Style = Doc.Styles(\"Byline email\") Or _\n    para.Style = Doc.Styles(\"Fakta punkt\") Or _\n    para.Style = Doc.Styles(\"tittel\") Then\n    Else\n    If para.Style = Doc.Styles(wdStyleHeading1) Then\n        tittel = para.Range.Characters.Count - 1\n    Else\n        If para.Style = Doc.Styles(wdStyleHeading2) Then\n            ingress = para.Range.Characters.Count - 1\n        Else\n            If para.Style = Doc.Styles(wdStyleHeading3) Then\n                i = i + 1\n                mlm(i) = para.Range.Characters.Count - 1\n            Else\n                If para.Style = Doc.Styles(wdStyleNormal) Then\n                    j = j + para.Range.Characters.Count - 1\n                End If 'N\n            End If 'H3\n        End If 'H2\n    End If 'H1\n    End If 'alle andre stiler\nNext para\nnormal = j\n'MsgBox \"Tittelen din har \" &amp; tittel &amp; \" tegn\" &amp; vbCrLf &amp; \" ingress \" &amp; ingress &amp; vbCrLf &amp; \" mlm-3 \" &amp; mlm(3) &amp; vbCrLf &amp; \" mlm-4 \" &amp; mlm(4) &amp; vbCrLf &amp; \"Alle normal \" &amp; normal\n'MsgBox \"Dokumentet blir n\u00e5 lagret og antall tegn du har skrevet blir oppdatert \u00f8verst i dokumentet.\"\n'MsgBox ActiveDocument.Paragraphs.Count\n\n'DEFINER DOC PROPERTIES VARIABLENE\nActiveDocument.CustomDocumentProperties(\"tittel\").Value = tittel\nActiveDocument.CustomDocumentProperties(\"ingress\").Value = ingress\nActiveDocument.CustomDocumentProperties(\"mlm1\").Value = mlm(1)\nActiveDocument.CustomDocumentProperties(\"mlm2\").Value = mlm(2)\nActiveDocument.CustomDocumentProperties(\"mlm3\").Value = mlm(3)\nActiveDocument.CustomDocumentProperties(\"mlm4\").Value = mlm(4)\nActiveDocument.CustomDocumentProperties(\"mlm5\").Value = mlm(5)\nActiveDocument.CustomDocumentProperties(\"mlm6\").Value = mlm(6)\nActiveDocument.CustomDocumentProperties(\"mlm7\").Value = mlm(7)\nActiveDocument.CustomDocumentProperties(\"normal\").Value = j\n\nActiveDocument.Fields.Update 'OPPDATER ALLE FELT nb, virker ikke i bunn og topptekst\n\n 'MsgBox intTittelX\n\n'Farg tittel og ingress r\u00f8d om de er for lange, bl\u00e5 om de er passe korte\nIf tittel &gt; intTittelX Then\n    With ActiveDocument.Styles(wdStyleHeading1).Font\n        .Color = wdColorRed\n    End With\nElse\n    With ActiveDocument.Styles(wdStyleHeading1).Font\n        .Color = -738148353\n    End With\nEnd If\n\nIf ingress &gt; intIngress Then\n    With ActiveDocument.Styles(wdStyleHeading2).Font\n        .Color = wdColorRed\n    End With\nElse\n    With ActiveDocument.Styles(wdStyleHeading2).Font\n        .Color = -738148353\n    End With\nEnd If\n\n\n'Optimize Code\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487764775, "post_id": 42390449, "comment_id": 71929086, "body": "Are you creating just 1 chart per sheet or multiple charts?"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487765542, "post_id": 42390449, "comment_id": 71929664, "body": "it&#39;s up to the user."}], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487764499, "post_id": 42390648, "comment_id": 71928867, "body": "maybe my question was not clear. I am editing it for the purpose."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487764572, "post_id": 42390648, "comment_id": 71928917, "body": "@L.Dutch what are you trying to do ? I guess I didn&#39;t understand what you are trying to achieve ?"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487764614, "post_id": 42390648, "comment_id": 71928955, "body": "I want the macro to work on the chart it creates, independently from its name"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487766146, "post_id": 42390648, "comment_id": 71930110, "body": "yes, now it creates the chart, but then it messes up the rest of the recorded macro, where all the ActiveChart fail"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487766333, "post_id": 42390648, "comment_id": 71930239, "body": "@L.Dutch why do you want to use <code>ActiveChart</code> ?"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487766381, "post_id": 42390648, "comment_id": 71930274, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/136354/discussion-between-l-dutch-and-shai-rado\">continue this discussion in chat</a>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1487767475, "post_id": 42390648, "comment_id": 71931085, "body": "@L.Dutch see edited code under <b>Edit 1</b> to modify more of the chart&#39;s settings, like series and datalabels"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1487767364, "last_edit_date": 1487767364, "creation_date": 1487764403, "answer_id": 42390648, "question_id": 42390449, "link": "https://stackoverflow.com/questions/42390449/get-chart-name-with-vba/42390648#42390648", "title": "Get chart name with VBA", "body": "<p>Try the code below, it will loop through all existing <code>ChartObjects</code> in \"statistics\" worksheet, and if it finds a chartobject with a name of \"Chart 9\" it will rename it to \"waterfall\".</p>\n\n<p><strong>Note</strong>: you could use a similar approach to create the chart, without the need to use <code>Select</code>, <code>ActiveSheet</code> and <code>ActiveChart</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub RenameExistingChart()\n\nDim ChtObj As ChartObject\n\nFor Each ChtObj In Worksheets(\"statistics\").ChartObjects\n    If ChtObj.Name = \"Chart 9\" Then\n        ChtObj.Name = \"waterfall\"\n    End If\nNext ChtObj\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit 1</strong>: create the chart with <code>ChtObj</code>:</p>\n\n<pre><code>Set ChtObj = Worksheets(\"statistics\").ChartObjects.Add(Left:=100, Top:=100, _\n                                    Width:=100, Height:=100) ' &lt;-- just default settings , modify later    \nWith ChtObj\n    .Chart.ChartType = xlColumnStacked\n    .Chart.SetSourceData Source:=range(\"statistics!$A$101:$C$106\")\n    .Name = \"waterfall\"\n\n    With .Chart.SeriesCollection(2).Format.Fill ' modify fill for series (2)\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent3\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = 0\n        .Solid\n    End With\n\n    .Chart.SeriesCollection(1).ApplyDataLabels ' add data lables to series (1)\n\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 2, "creation_date": 1487765638, "post_id": 42390894, "comment_id": 71929737, "body": "What if there is more than one chart per sheet?"}], "tags": [], "owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "is_accepted": false, "score": 1, "last_activity_date": 1487764945, "creation_date": 1487764945, "answer_id": 42390894, "question_id": 42390449, "link": "https://stackoverflow.com/questions/42390449/get-chart-name-with-vba/42390894#42390894", "title": "Get chart name with VBA", "body": "<p>You could use something like this:</p>\n\n<pre><code>Sub ChartStuff()\nDim cht As Shape\nRange(\"A101:A106\").Select\nActiveSheet.Shapes.AddChart.Select\nSet cht = ActiveSheet.Shapes(1)\ncht.Name = \"waterfall\"\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1487770452, "post_id": 42391298, "comment_id": 71933346, "body": "It&#39;s actually very easy to get a reference to the chart directly: <code>Set ch = ActiveSheet.Shapes.AddChart.Chart</code>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1487775390, "post_id": 42391298, "comment_id": 71937063, "body": "You&#39;re right. It&#39;s confusing that the return value is a <code>Chart</code> while the Selection is a <code>ChartArea</code>..."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1487765956, "creation_date": 1487765956, "answer_id": 42391298, "question_id": 42390449, "link": "https://stackoverflow.com/questions/42390449/get-chart-name-with-vba/42391298#42391298", "title": "Get chart name with VBA", "body": "<p>Dealing with charts in VBA is a little complicated.\nWhen you use <code>Addchart</code>, Selection will be a <code>ChartArea</code>\nA <code>ChartArea</code> is part of a Chart which is part of a <code>ChartObject</code>\nThe name of a chart you see is in fact the name of the <code>ChartObject</code></p>\n\n<p>You can do something like this:</p>\n\n<pre><code>Range(\"A101:A106\").Select\nActiveSheet.Shapes.AddChart.Select\n\nDim ca As ChartArea, ch As Chart, co As ChartObject\nSet ca = Selection \nSet ch = ca.Parent\nch.ChartType = xl3DColumn\nSet co = ch.Parent\nco.Name = \"waterfall\"\nDebug.Print ca.Name, ch.Name, co.Name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10769473, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ud0EvNs72Hk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gHceVk0YTHUaXSM-SEbAGNrJzagg/mo/photo.jpg?sz=128", "display_name": "Bonny", "link": "https://stackoverflow.com/users/10769473/bonny"}, "is_accepted": false, "score": 0, "last_activity_date": 1544446053, "last_edit_date": 1544446053, "creation_date": 1544445689, "answer_id": 53705883, "question_id": 42390449, "link": "https://stackoverflow.com/questions/42390449/get-chart-name-with-vba/53705883#53705883", "title": "Get chart name with VBA", "body": "<p>Create a function that you call from within the sub, that sends the name of the active chart, for example:</p>\n\n<pre><code>Function actchart(ActiveChart As String) As String\n  actchart = ActiveChart\nEnd Function\n</code></pre>\n\n<p>And then from within your sub, you can replace, as an example, where you have:</p>\n\n<pre><code>ActiveSheet.Shapes(\"Chart 9\").Name = \"waterfall\" \n</code></pre>\n\n<p>with </p>\n\n<pre><code>ActiveSheet.Shapes(actchart(ActiveChart.Parent.Name)).Name = \"waterfall\"\n</code></pre>\n\n<p>This worked for me with the same issue! Hope it helps.</p>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25491, "favorite_count": 0, "accepted_answer_id": 42390648, "answer_count": 4, "score": 1, "last_activity_date": 1544446053, "creation_date": 1487763932, "last_edit_date": 1487766479, "question_id": 42390449, "link": "https://stackoverflow.com/questions/42390449/get-chart-name-with-vba", "title": "Get chart name with VBA", "body": "<p>I am setting up a macro to generate a chart. I have recorded a macro while I was generating the sample chart, but now I need to have the macro working independently from the name of the chart (<code>Chart 9</code> in this case) </p>\n\n<pre><code>Sheets(\"statistics\").Select\nSheets(\"statistics\").Range(\"A101:C106\").Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlColumnStacked\nActiveChart.SetSourceData Source:=Range(\"statistics!$A$101:$C$106\")\nActiveChart.ChartArea.Select\nActiveSheet.Shapes(\"Chart 9\").Name = \"waterfall\"\nActiveChart.Location Where:=xlLocationAsObject, Name:=\"summary\"\nActiveSheet.ChartObjects(\"waterfall\").Activate\nActiveSheet.Shapes(\"waterfall\").IncrementLeft 80\nActiveSheet.Shapes(\"waterfall\").IncrementTop -2200\nActiveSheet.ChartObjects(\"waterfall\").Activate\nActiveSheet.Shapes(\"waterfall\").ScaleWidth 1.6025463692, msoFalse, msoScaleFromTopLeft\nActiveSheet.Shapes(\"waterfall\").ScaleHeight 1.6084106153, msoFalse, msoScaleFromTopLeft\nActiveSheet.ChartObjects(\"waterfall\").Activate\nActiveChart.Legend.Select\nSelection.Delete\nActiveSheet.ChartObjects(\"waterfall\").Activate\nActiveChart.SeriesCollection(1).Select\nSelection.Format.Fill.Visible = msoFalse\nActiveChart.SeriesCollection(2).Select\nActiveChart.SeriesCollection(2).Points(6).Select\nWith Selection.Format.Fill\n    .Visible = msoTrue\n    .ForeColor.ObjectThemeColor = msoThemeColorAccent3\n    .ForeColor.TintAndShade = 0\n    .ForeColor.Brightness = 0\n    .Solid\nEnd With\nActiveChart.SeriesCollection(2).Points(1).Select\nWith Selection.Format.Fill\n    .Visible = msoTrue\n    .ForeColor.ObjectThemeColor = msoThemeColorAccent3\n    .ForeColor.TintAndShade = 0\n    .ForeColor.Brightness = 0\n    .Solid\nEnd With\nWith Selection.Format.Fill\n    .Visible = msoTrue\n    .ForeColor.ObjectThemeColor = msoThemeColorAccent1\n    .ForeColor.TintAndShade = 0\n    .ForeColor.Brightness = 0\n    .Transparency = 0\n    .Solid\nEnd With\nActiveChart.SeriesCollection(2).Points(5).Select\nWith Selection.Format.Fill\n    .Visible = msoTrue\n    .ForeColor.ObjectThemeColor = msoThemeColorAccent1\n    .ForeColor.TintAndShade = 0\n    .ForeColor.Brightness = 0\n    .Solid\nEnd With\nWith Selection.Format.Fill\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(255, 0, 0)\n    .Transparency = 0\n    .Solid\nEnd With\nActiveChart.SetElement (msoElementDataLabelCenter)\nActiveChart.SeriesCollection(2).Points(1).Select\nActiveChart.ChartArea.Select\nActiveChart.ChartArea.Select\nActiveChart.SeriesCollection(2).Points(1).Select\nActiveChart.PlotArea.Select\nActiveChart.SeriesCollection(2).Select\nActiveChart.SetElement (msoElementDataLabelCenter)\nActiveChart.SetElement (msoElementPrimaryValueAxisTitleHorizontal)\nSelection.Caption = \"hrs\"\nActiveChart.Axes(xlValue).AxisTitle.Select\nSelection.Left = 7\nSelection.Top = 13.028\n</code></pre>\n\n<p>I have tried</p>\n\n<pre><code>Sheets(\"statistics\").Range(\"A101:C106\").Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlColumnStacked\nActiveChart.SetSourceData Source:=Range(\"statistics!$A$101:$C$106\")\nActiveChart.ChartArea.Select\nSet ThisChart = ActiveChart\nActiveSheet.Shapes(ThisChart).Name = \"waterfall\"\n</code></pre>\n\n<p>but it is not working</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 741, "user_id": 1200847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jV1N6.jpg?s=128&g=1", "display_name": "Georg Jung", "link": "https://stackoverflow.com/users/1200847/georg-jung"}, "edited": false, "score": 0, "creation_date": 1487766715, "post_id": 42390377, "comment_id": 71930533, "body": "Are you using vb.net (the .Net Framework, maybe Visual Studio) or VBA (within office, maybe an access macro)?"}, {"owner": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "reply_to_user": {"reputation": 741, "user_id": 1200847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jV1N6.jpg?s=128&g=1", "display_name": "Georg Jung", "link": "https://stackoverflow.com/users/1200847/georg-jung"}, "edited": false, "score": 0, "creation_date": 1487768773, "post_id": 42390377, "comment_id": 71932061, "body": "I&#39;m using Access 2010 as the front end and SQL Express for the DB"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "edited": false, "score": 0, "creation_date": 1487782730, "post_id": 42392884, "comment_id": 71942474, "body": "Thanks for your reply Fionnuala. Unfortunately I&#39;m really stretching my capabilities here and I&#39;m not really understanding the aim of the code. I tried assigning a modified version of this to a button, selecting some records and clicking the button but it had no effect. I&#39;m assuming it should have msgbox&#39;ed me a message?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "edited": false, "score": 0, "creation_date": 1487783884, "post_id": 42392884, "comment_id": 71943272, "body": "Did you change all the forms and column names to match your situation? Did you get an error message?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "edited": false, "score": 0, "creation_date": 1487784017, "post_id": 42392884, "comment_id": 71943368, "body": "The important bits are seltop and selheight."}, {"owner": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "edited": false, "score": 0, "creation_date": 1487785125, "post_id": 42392884, "comment_id": 71944104, "body": "I put a button on the form with the code as below but get an error saying &quot;Procedure declaration does not match description of event or procedure having the same name.&quot; FYI the Form Name is F_SalesOrders_ItemsInStock and the  Record Source: v_ItemsInStock (which is an SQL view)"}, {"owner": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "edited": false, "score": 0, "creation_date": 1487785220, "post_id": 42392884, "comment_id": 71944162, "body": "Function cmdReserve_Click()  Dim i As Long  Dim frm As Form  Dim rs As DAO.Recordset   Set frm = Forms![F_SalesOrders_ItemsInStock]  Set rs = frm.RecordsetClone   rs.MoveFirst   rs.Move frm.SelTop - 1   For i = 1 To frm.SelHeight    MsgBox rs![ItemID]    rs.MoveNext  Next i  End Function"}], "tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": false, "score": 1, "last_activity_date": 1487770203, "creation_date": 1487770203, "answer_id": 42392884, "question_id": 42390377, "link": "https://stackoverflow.com/questions/42390377/how-to-update-a-selection-of-sql-records-from-access-vb/42392884#42392884", "title": "How to update a selection of SQL records from Access VB?", "body": "<p>Consider a linked table and walking the record set.</p>\n\n<pre><code>Function DisplaySelectedCompanyNames()\n Dim i As Long\n Dim frm As Form\n Dim rs As DAO.Recordset\n\n ' Get the form and its recordset.\n Set frm = Forms![Customers]\n Set rs = frm.RecordsetClone\n\n ' Move to the first record in the recordset.\n rs.MoveFirst\n\n ' Move to the first selected record.\n rs.Move frm.SelTop - 1\n\n ' Enumerate the list of selected records presenting\n ' the CompanyName field in a message box.\n For i = 1 To frm.SelHeight\n   MsgBox rs![CompanyName]\n   rs.MoveNext\n Next i\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 2971585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71cd35d244a2b6feb06a0c9c3483ec9?s=128&d=identicon&r=PG&f=1", "display_name": "PaulStephen", "link": "https://stackoverflow.com/users/2971585/paulstephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487837712, "creation_date": 1487763755, "last_edit_date": 1487837712, "question_id": 42390377, "link": "https://stackoverflow.com/questions/42390377/how-to-update-a-selection-of-sql-records-from-access-vb", "title": "How to update a selection of SQL records from Access VB?", "body": "<p>I'm looking for help in creating the simplest method of doing the following update on a selection of items.</p>\n\n<p>I have a table in SQL called Item with field ReservationID</p>\n\n<p>I have a list of items in Access and what I'd like to do is select items using the record selectors in the Access form and update those items with the ReservationID using an SQL Update command.</p>\n\n<p>I read somewhere that only adjacent record selectors could be selected which is fine but I don't really know where to begin.</p>\n\n<p>Any pointers would be gratefully received. Thanks.\n---23/02/2017---\nOk I changed it from a function to a Private Sub thus:</p>\n\n<pre><code>Private Sub cmdReserve_Click()\n Dim i As Long\n Dim frm As Form\n Dim rs As DAO.Recordset\n ' Get the form and its recordset.\n Set frm = Forms![F_SalesOrders_ItemsInStock]\n Set rs = frm.RecordsetClone\n ' Move to the first record in the recordset.\n rs.MoveFirst\n ' Move to the first selected record.\n rs.Move frm.SelTop - 1\n ' Enumerate the list of selected records \n ' presenting the field contents in a message box.\n For i = 1 To frm.SelHeight\n   MsgBox rs![ItemID]\n   rs.MoveNext\n Next i\nEnd Sub\n</code></pre>\n\n<p>but when I select records and hit the button nothing happens</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487764501, "post_id": 42390205, "comment_id": 71928868, "body": "Btw, please don&#39;t use <a href=\"https://stackoverflow.com/questions/tagged/macros\">macros</a> tag that isn&#39;t for VBA."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1487764457, "creation_date": 1487764457, "answer_id": 42390676, "question_id": 42390205, "link": "https://stackoverflow.com/questions/42390205/vba-setting-value-of-cell-does-not-change-cell-contents-in-unprotected-sheet/42390676#42390676", "title": "VBA Setting value of cell does not change cell contents in unprotected sheet", "body": "<p>With your loop, you are putting every surname in the same column, use a Range object to move it :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim Mrn As String\n    Dim RgToFill As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set KeyCells = Me.Range(\"C10:C29\")\n    Set RgToFill = Target.Offset(0, 1)\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        Set cn = New ADODB.Connection\n        Mrn = Target.Text\n\n        If Mrn = vbNullString Then\n            RgToFill.Value = vbNullString\n        Else\n            cn.ConnectionString = \"MyConnectionString\"\n            cn.Open\n            Set rs = cn.Execute(\"Select nhs_surname From nhs_patient_s Where UPPER(nhs_patientid) = '\" + UCase(Mrn) + \"'\")\n\n            If rs.EOF Then\n                RgToFill.Value = \"UNKNOWN\"\n            Else\n                Do While Not rs.EOF\n                    Dim surname As String\n                    surname = rs(\"nhs_surname\")\n                    RgToFill.Value = surname\n                    '''Move the range to fill to the next column\n                    Set RgToFill = RgToFill.Offset(0, 1)\n                    rs.MoveNext\n                Loop\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487835939, "post_id": 42391396, "comment_id": 71965755, "body": "Please accept an answer if your issue is solved, and a little upvote for the other nice answers is always welcome! ;)"}], "tags": [], "owner": {"reputation": 686, "user_id": 464796, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Fvt6w.jpg?s=128&g=1", "display_name": "Paul S Chapman", "link": "https://stackoverflow.com/users/464796/paul-s-chapman"}, "is_accepted": true, "score": 0, "last_activity_date": 1487766182, "creation_date": 1487766182, "answer_id": 42391396, "question_id": 42390205, "link": "https://stackoverflow.com/questions/42390205/vba-setting-value-of-cell-does-not-change-cell-contents-in-unprotected-sheet/42391396#42391396", "title": "VBA Setting value of cell does not change cell contents in unprotected sheet", "body": "<p>It turned out that the column where the surname was being put was a merged cell and this affected the offset for the Discharge Date column. </p>\n\n<p>So the solution was simply to use the number 6 rather than 3</p>\n\n<pre><code>Target.Offset(, 6).Value = \"Now here!!!!\"\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 464796, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Fvt6w.jpg?s=128&g=1", "display_name": "Paul S Chapman", "link": "https://stackoverflow.com/users/464796/paul-s-chapman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 42391396, "answer_count": 2, "score": 0, "last_activity_date": 1487766182, "creation_date": 1487763295, "last_edit_date": 1487764072, "question_id": 42390205, "link": "https://stackoverflow.com/questions/42390205/vba-setting-value-of-cell-does-not-change-cell-contents-in-unprotected-sheet", "title": "VBA Setting value of cell does not change cell contents in unprotected sheet", "body": "<p>I have the following macro in an Excel Sheet - which retrieves the patient identified by their hospital number and puts there surname in one column and this works fine.</p>\n\n<p>I now need to insert more data in the sheet, but while the surname appears, the other data does not.</p>\n\n<p>I have no problems writing to the same cell, to cells to the left, but when ever I try and write to the columns on the right nothing happens.</p>\n\n<p>The sheet is unprotected, it is not a case of the font and cell background being white. Any ideas?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim Mrn As String\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed. \n    Set KeyCells = Range(\"C10:C29\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        Set cn = New ADODB.Connection\n        Mrn = Target.Text\n\n        If Mrn = \"\" Then\n            Target.Offset(0, 1).Value = \"\"\n        Else\n            cn.ConnectionString = \"MyConnectionString\"\n            cn.Open\n            Set rs = cn.Execute(\"Select nhs_surname From nhs_patient_s Where UPPER(nhs_patientid) = '\" + UCase(Mrn) + \"'\")\n\n            If rs.EOF Then\n                Target.Offset(0, 1).Value = \"UNKNOWN\"\n            Else\n                Do While Not rs.EOF\n                    Dim surname As String\n                    surname = rs(\"nhs_surname\")\n                    Target.Offset(0, 1).Value = surname\n                    Target.Offset(, 3).Value = \"Now here!!!!\"\n                    rs.MoveNext\n                Loop\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "for-loop", "sum", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1487763511, "post_id": 42390121, "comment_id": 71928158, "body": "You should be getting <code>Sub or Function not defined</code> on <code>Cell</code>.  Use <code>Cells</code>, also do you have <code>Option Explicit</code> at the top of the module as you&#39;ve not declared your variables."}, {"owner": {"reputation": 21, "user_id": 5755020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ac94ba72afa861687f2513faa7b02dc?s=128&d=identicon&r=PG&f=1", "display_name": "Robot_enthusiast", "link": "https://stackoverflow.com/users/5755020/robot-enthusiast"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1487763692, "post_id": 42390121, "comment_id": 71928272, "body": "i have declared addRange1 and myCount2, just didnt include it in the post"}, {"owner": {"reputation": 21, "user_id": 5755020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ac94ba72afa861687f2513faa7b02dc?s=128&d=identicon&r=PG&f=1", "display_name": "Robot_enthusiast", "link": "https://stackoverflow.com/users/5755020/robot-enthusiast"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1487764068, "post_id": 42390121, "comment_id": 71928543, "body": "@DarrenBartrup-Cook this code snippet is within sub btw"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1487765511, "creation_date": 1487765511, "answer_id": 42391123, "question_id": 42390121, "link": "https://stackoverflow.com/questions/42390121/looping-through-rows-and-adding-values/42391123#42391123", "title": "looping through rows and adding values", "body": "<p>This would be correct:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    For x = 5 To 30\n        Set addRange1 = .Range(.Cells(x, 4), .Cells(x, myCount2))\n        Cells(x, myCount2 + 2).Value = Application.Sum(addRange1)\n    Next\nEnd With\n</code></pre>\n\n<p>The <code>For ... Next</code> was incorrect. Instead of <code>To x = 30</code> it has to be <code>To 30</code>. </p>\n\n<blockquote>\n  <p>Info what happened here: If you walked through your code step-by-step you would have noticed that everything inside your <code>For ... Next</code> is never executed. This is because x = 30 in the <code>For</code> sets <code>x</code> to the value <code>30</code> and this is the end of the <code>For</code> so the <code>For</code> gets never executed.</p>\n</blockquote>\n\n<p>The <code>Step 1</code> isn't necessary, it is <code>1</code> by default you may remove it or keep it but it is not necessary.</p>\n\n<p>And as Darren Bartrup-Cook mentioned it has to be <code>Cells</code> instead of <code>Cell</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 5755020, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ac94ba72afa861687f2513faa7b02dc?s=128&d=identicon&r=PG&f=1", "display_name": "Robot_enthusiast", "link": "https://stackoverflow.com/users/5755020/robot-enthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487765511, "creation_date": 1487763114, "last_edit_date": 1531164843, "question_id": 42390121, "link": "https://stackoverflow.com/questions/42390121/looping-through-rows-and-adding-values", "title": "looping through rows and adding values", "body": "<p>Here is my code</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n  For x = 5 To x = 30 Step 1\n    Set addRange1 = .Range(.Cells(x, 4), .Cells(x, myCount2))\n    cell(x, myCount2 + 2).Value = Application.Sum(addRange1)\nNext\nEnd With\n</code></pre>\n\n<p>First row would be cell(5,4) to cell(5, 20) or something. Sum the values of that row and display it in cell (5,22)\nRepeat up to x = 30</p>\n\n<p>Hope that is clear\nGetting blank cells where sum value should be</p>\n"}, {"tags": ["excel", "vba", "operator-keyword"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487767936, "post_id": 42390050, "comment_id": 71931408, "body": "Please can you add an example input string, or is xx/xx/xx the full input string to look at?"}], "answers": [{"comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1487767565, "post_id": 42390521, "comment_id": 71931155, "body": "This will replace slashes also in the middle of the string."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1487765591, "last_edit_date": 1487765591, "creation_date": 1487764078, "answer_id": 42390521, "question_id": 42390050, "link": "https://stackoverflow.com/questions/42390050/operator-not-followed-by-a-character/42390521#42390521", "title": "Operator not followed by a character", "body": "<p>You could use regular expressions, a wealth of stuff on the net about that.</p>\n\n<p>Or something in VBA like so, no real need for a2, could grab the last of a1 before hand, but just to show you difference in the arrays in the locals window.</p>\n\n<pre><code>Function test(strInput As String)\n\nDim a1() As String\nDim a2() As String\n\na1 = Split(strInput, \"/\")\na2 = a1\n\nReDim Preserve a2(UBound(a1) - 1)\n\ntest = Join(a2, \"/\") &amp; \".\" &amp; a1(UBound(a1))\n\nEnd Function\n</code></pre>\n\n<p>or it can be done using a formula</p>\n\n<p><code>=SUBSTITUTE(A1,\"/\",\".\",(LEN(A1)-LEN(SUBSTITUTE(A1,\"/\",\"\"))))</code></p>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1487767418, "creation_date": 1487767418, "answer_id": 42391844, "question_id": 42390050, "link": "https://stackoverflow.com/questions/42390050/operator-not-followed-by-a-character/42391844#42391844", "title": "Operator not followed by a character", "body": "<p>I think you should use the function Right for this, to avoid replacing the \"/15\" in the middle of the string.</p>\n\n<pre><code>Public Function ReplaceRight(strInput As String) As String\n    If Right(strInput, 3) = \"/15\" Then\n        ReplaceRight = Left(strInput, Len(strInput) - 3) &amp; \".15\"\n    Else\n        ReplaceRight = strInput\n    End If\nEnd Function\n</code></pre>\n\n<p>With Excel Formula:</p>\n\n<pre><code>=IF(RIGHT(F215,3)=\"/15\",LEFT(F215,LEN(F215)-3)&amp;\".15\",F215)\n</code></pre>\n"}], "owner": {"reputation": 1623, "user_id": 3080315, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dca9f77ce600fbae2b1cd16df56dba3e?s=128&d=identicon&r=PG&f=1", "display_name": "jz22", "link": "https://stackoverflow.com/users/3080315/jz22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487767418, "creation_date": 1487762960, "last_edit_date": 1487763034, "question_id": 42390050, "link": "https://stackoverflow.com/questions/42390050/operator-not-followed-by-a-character", "title": "Operator not followed by a character", "body": "<p>I am using the find and replace function and a vba code in Excel. I want to replace all strings like \"/15\" by \".15\" but only if \"/15\" is not followed by any other characters. Is there an operator for my need?</p>\n\n<p>For example if I replace all \"/15\" it also replaces this string if it is followed by other characters.</p>\n\n<p>10/15/15 -> 10.15.15</p>\n\n<p>But what I want is</p>\n\n<p>10/15/15 -> 10/15.15</p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "edited": false, "score": 0, "creation_date": 1588084249, "post_id": 42390018, "comment_id": 108760139, "body": "My decision was. 1. In text mark format insert before and and of format some characters like this %%% <b>bold</b> %%% (was <b>bold</b>) 2. Copy and paste as text 3. Find and replece text between %% ... %% as you need format"}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1488002233, "last_edit_date": 1488002233, "creation_date": 1488001912, "answer_id": 42452480, "question_id": 42390018, "link": "https://stackoverflow.com/questions/42390018/using-vba-to-remove-formatting-but-keep-bold-text/42452480#42452480", "title": "Using VBA to remove formatting but keep bold text", "body": "<p><strong>remove all formatting</strong> is <strong>impossible</strong> but set <strong>style</strong> to <strong>normal</strong> can. </p>\n\n<pre><code> Selection.Copy\n Windows(1).Activate\n Windows(1).Document.Bookmarks.Add (\"xx\")\n Selection.PasteAndFormat (wdFormatPlainText)\n Windows(1).Document.Bookmarks.Add (\"xxx\")\n Selection.Start = Windows(1).Document.Bookmarks.Item(1).Start\n Selection.End = Windows(1).Document.Bookmarks.Item(2).Start\n Selection.Style = wdStyleNormal\n Selection.Font.Bold = True\n Selection.Font.Color = wdColorRed\n Windows(1).Document.Bookmarks.Item(1).Delete\n Windows(1).Document.Bookmarks.Item(1).Delete\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7604327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e36ad43c94aed7c1a2765cfe20ece34?s=128&d=identicon&r=PG&f=1", "display_name": "yosh", "link": "https://stackoverflow.com/users/7604327/yosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 601, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488002233, "creation_date": 1487762875, "last_edit_date": 1487808057, "question_id": 42390018, "link": "https://stackoverflow.com/questions/42390018/using-vba-to-remove-formatting-but-keep-bold-text", "title": "Using VBA to remove formatting but keep bold text", "body": "<p>I'm using this macro to clear all text format and paste it to another document:</p>\n\n<pre><code>Selection.Copy\nWindows(1).Activate\nSelection.PasteAndFormat (wdFormatPlainText)\n</code></pre>\n\n<p>It works fine, but I need plain text with information about bolded characters as red color. In other words - I need to remove all text formatting but make bolded characters red.\nI was trying to iterate Selection char by char, but without success.</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 1343, "user_id": 5478049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d54b609773fe17890dac8e1bc6b96ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Shiran Dror", "link": "https://stackoverflow.com/users/5478049/shiran-dror"}, "edited": false, "score": 0, "creation_date": 1487763540, "post_id": 42389868, "comment_id": 71928180, "body": "please show the relevant script code"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487765282, "post_id": 42389868, "comment_id": 71929483, "body": "use something like <code>document.getelementsbyclassname(&quot;rightToolbarButtons&quot;)(0).ge&zwnj;&#8203;telementsbytagname(&quot;&zwnj;&#8203;input&quot;)(0)</code> or maybe (&quot;button&quot;) not 100%"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529845450, "creation_date": 1529845450, "answer_id": 51010213, "question_id": 42389868, "link": "https://stackoverflow.com/questions/42389868/vba-click-on-a-web-page-element-with-no-id-only-class-name/51010213#51010213", "title": "VBA - Click on a web page element with no id only class name", "body": "<p>Assuming no other search buttons you can use a CSS selector of </p>\n\n<pre><code>button[title*='Search']\n</code></pre>\n\n<p>Which is <code>button</code> tag with attribute <code>title</code> containing string <code>'search'</code>. \nThe <code>\"*\"</code> indicates <em>contains</em> and <code>\"[]\"</code> <em>attribute</em>.</p>\n\n<p>On your HTML:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RxLmH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RxLmH.png\" alt=\"css selector\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>You apply the css selector via the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\"><code>.selector</code></a> method of <code>document</code>.</p>\n\n<pre><code>.document.querySelector(\"button[title*='Search']\").Click\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7604340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ffb6cb2704659806ddb751e05d715?s=128&d=identicon&r=PG&f=1", "display_name": "ciaran", "link": "https://stackoverflow.com/users/7604340/ciaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529845450, "creation_date": 1487762537, "question_id": 42389868, "link": "https://stackoverflow.com/questions/42389868/vba-click-on-a-web-page-element-with-no-id-only-class-name", "title": "VBA - Click on a web page element with no id only class name", "body": "<pre><code>&lt;div class=\"rightToolbarButtons\"&gt;\n&lt;!--ko template: 'rightSearchDialogToolbarButtons' --&gt;\n&lt;button class=\"main ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\" type=\"button\" data-bind=\"jqueryui: {widget: 'button',options: {label: DWResources.WebClient.SearchText}},command: commands.searchCommand, attr: { title: DW.Utils.format(DWResources.WebClient.SearchDialog_SearchButtonTooltip, $data.fileCabinetName()) }\" role=\"button\" aria-disabled=\"false\" title=\"Search in file cabinet INVOICE  (Enter)\"&gt;&lt;span class=\"ui-button-text\"&gt;Search&lt;/span&gt;   &lt;/button&gt;\n</code></pre>\n\n\n\n<p>Please see the above HTML extract i am trying to click on a \"search button\".\ni have no difficulty with clicking on buttons with ID but i am having difficulty with tag name and unsure which tag and name i should be using.\nAny help would be much appreciated.\nthanks in advance</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 1, "creation_date": 1487763232, "post_id": 42389729, "comment_id": 71927931, "body": "To append to an existing file, use <code>OpenTextFile</code> with parameter <code>ForAppending</code> as explained <a href=\"https://msdn.microsoft.com/en-us/library/aa265347(v=vs.60).aspx\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1487806373, "post_id": 42389729, "comment_id": 71955418, "body": "Do you expect emails to be sitting in the Outbox waiting for delivery? Or do you want to catch emails that are being delivered as they are sent?"}, {"owner": {"reputation": 11, "user_id": 7604254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1210226e9a3a5f406104c62f44284bb?s=128&d=identicon&r=PG&f=1", "display_name": "ondas", "link": "https://stackoverflow.com/users/7604254/ondas"}, "edited": false, "score": 0, "creation_date": 1487853887, "post_id": 42389729, "comment_id": 71977475, "body": "Oh sorry, I made a mistake - actually I want to log emails that have already been sent - not waiting for delivery or logging them on the fly. So basically to go through sent emails once a day and log items matching the criteria to a file..."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487918875, "post_id": 42389729, "comment_id": 72009629, "body": "Where you running the code from? Excel or Outlook?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1487935635, "post_id": 42389729, "comment_id": 72018949, "body": "To get to the correct folder change &quot;Outbox&quot; to &quot;Sent Items&quot;. To get information from individual items this may be helpful <a href=\"http://stackoverflow.com/questions/21556389/iterate-all-email-items-in-a-specific-outlook-folder\" title=\"iterate all email items in a specific outlook folder\">stackoverflow.com/questions/21556389/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7604254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1210226e9a3a5f406104c62f44284bb?s=128&d=identicon&r=PG&f=1", "display_name": "ondas", "link": "https://stackoverflow.com/users/7604254/ondas"}, "edited": false, "score": 0, "creation_date": 1487853595, "post_id": 42390763, "comment_id": 71977250, "body": "Being in corporate environment I don&#39;t have access to Visual Studio (nor the experience). I was hoping there would be a simple way to expand vba code above to include sender address and recipient&#39;s domain and I am just missing it...?"}], "tags": [], "owner": {"reputation": 66, "user_id": 7490123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e12631fe9e16d75a2483c3404fa0a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp M&#252;ller", "link": "https://stackoverflow.com/users/7490123/philipp-m%c3%bcller"}, "is_accepted": false, "score": 0, "last_activity_date": 1487767110, "last_edit_date": 1487767110, "creation_date": 1487764655, "answer_id": 42390763, "question_id": 42389729, "link": "https://stackoverflow.com/questions/42389729/counting-outlook-outbox-items-and-logging-to-a-file/42390763#42390763", "title": "Counting Outlook outbox items and logging to a file", "body": "<p>Why don't you create a VSTO Add-In? I think this isn't a VSTO Add-In, isn't it?\nAs I remember you can access much more objects this way. If I'm wrong please correct me.</p>\n\n<p><a href=\"https://msdn.microsoft.com/de-de/library/cc668191.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/de-de/library/cc668191.aspx</a> (German version).</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/uk-uk/library/cc668191.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/uk-uk/library/cc668191.aspx</a> (English version).</p>\n"}, {"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1487985710, "creation_date": 1487985710, "answer_id": 42450848, "question_id": 42389729, "link": "https://stackoverflow.com/questions/42389729/counting-outlook-outbox-items-and-logging-to-a-file/42450848#42450848", "title": "Counting Outlook outbox items and logging to a file", "body": "<p>To access the data for the sender, look at the MailItem.SenderName and .SenderEmailAddress properties (or .Sender for more details). For recipients, you'll have to access Recipient objects in the MailItem.Recipients collection.</p>\n\n<p>See these articles for helpful walkthroughs for all of that:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff866259.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff866259.aspx</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868695.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff868695.aspx</a></p>\n\n<p>For recipients</p>\n"}], "owner": {"reputation": 11, "user_id": 7604254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1210226e9a3a5f406104c62f44284bb?s=128&d=identicon&r=PG&f=1", "display_name": "ondas", "link": "https://stackoverflow.com/users/7604254/ondas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1149, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1593155107, "creation_date": 1487762173, "last_edit_date": 1593155107, "question_id": 42389729, "link": "https://stackoverflow.com/questions/42389729/counting-outlook-outbox-items-and-logging-to-a-file", "title": "Counting Outlook outbox items and logging to a file", "body": "<p>I need a macro that would count the number of sent emails (all in one sent folder, no subfolders) and log the result to a file (csv or txt). The output should file should state number of emails per date, sender address/name and recipient's domain (@company.com). </p>\n\n<p>I was able to get this code to work partially, but it only shows date and number of emails in the output file. </p>\n\n<p>Also - is there a way to append new data to the file, not to overwrite it?</p>\n\n<p>Message Box in Outlook is really optional, output file is the critical part.</p>\n\n<pre><code>Sub HowManyEmails()\n\n    Dim objOutlook As Object, objnSpace As Object, objFolder As MAPIFolder\n    Dim EmailCount As Integer\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objnSpace = objOutlook.GetNamespace(\"MAPI\")\n\n    On Error Resume Next\n    Set objFolder = objnSpace.Folders(\"xxx@company.com\").Folders(\"Outbox\")\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        MsgBox \"No such folder.\"\n        Exit Sub\n    End If\n\n    EmailCount = objFolder.Items.Count\n\n    MsgBox \"Number of emails in the folder: \" &amp; EmailCount, , \"email count\"\n\n    Dim dateStr As String\n    Dim myItems As Outlook.Items\n    Dim dict As Object\n    Dim msg As String\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Set myItems = objFolder.Items\n    myItems.SetColumns (\"ReceivedTime\")\n    ' Determine date of each message:\n    For Each myItem In myItems\n        dateStr = GetDate(myItem.ReceivedTime)\n        If Not dict.Exists(dateStr) Then\n            dict(dateStr) = 0\n        End If\n        dict(dateStr) = CLng(dict(dateStr)) + 1\n    Next myItem\n\n    ' Output counts per day:\n    msg = \"\"\n    For Each o In dict.Keys\n        msg = msg &amp; o &amp; \": \" &amp; dict(o) &amp; \" items\" &amp; vbCrLf\n    Next\n\n    Dim fso As Object\n    Dim fo As Object\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set fo = fso.CreateTextFile(\"C:\\Users\\xxx\\Documents\\outlook_test_log.txt\")\n    fo.Write msg\n    fo.Close\n\n    Set fo = Nothing\n    Set fso = Nothing\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\nEnd Sub\n\nFunction GetDate(dt As Date) As String\n    GetDate = Year(dt) &amp; \"-\" &amp; Month(dt) &amp; \"-\" &amp; Day(dt)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7621160, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9f64f50b28d1a24333e0b61e8b00bbb1?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/7621160/igor"}, "is_accepted": false, "score": 0, "last_activity_date": 1488018247, "creation_date": 1488018247, "answer_id": 42454780, "question_id": 42389043, "link": "https://stackoverflow.com/questions/42389043/how-create-editable-field-more-then-255-characters-in-word-vba/42454780#42454780", "title": "How create editable field more then 255 characters in Word-VBA?", "body": "<p>Just use text form</p>\n\n<p><a href=\"https://i.stack.imgur.com/7qjy0.jpg\" rel=\"nofollow noreferrer\">word_dev_tools</a></p>\n\n<p>And fill this form</p>\n\n<pre><code>ActiveDocument.Bookmarks(g_name).Range.Fields(1).Result.Text = g_value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7604073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90059c0f3780bbd82cfba44428076c1b?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/7604073/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488018247, "creation_date": 1487760446, "question_id": 42389043, "link": "https://stackoverflow.com/questions/42389043/how-create-editable-field-more-then-255-characters-in-word-vba", "title": "How create editable field more then 255 characters in Word-VBA?", "body": "<p>I am trying create editable field in Word document:</p>\n\n<pre><code>Dim bm As Bookmark\n\nIf ActiveDocument.Bookmarks.Exists(g_name) = True Then\n    Set bm = ActiveDocument.Bookmarks(g_name)\nEnd If\n\nIf g_var = \"DETAILS\" Then\n    bm.Range.Select\n    With Selection\n     .Font.Underline = wdUnderlineNone\n     .FormFields.Add Range:=Selection.Range, Type:= _\n         wdFieldFormTextInput\n         Selection.PreviousField.Select\n         With Selection.FormFields(1)\n         .Name = g_name\n         .EntryMacro = \"\"\n         .ExitMacro = \"\"\n         .Enabled = True\n         .OwnHelp = False\n         .HelpText = \"\"\n         .OwnStatus = False\n         .StatusText = \"\"\n         With .TextInput\n             .EditType Type:=wdRegularText, Default:=g_value, Format:=\"\"\n         End With\n      End With\n  End With\nEnd If\n\nActiveDocument.Protect Password:=\"mypass\", NoReset:=False, Type:=wdAllowOnlyFormFields\n</code></pre>\n\n<p>g_name contain the name of bookmark where some text had to be inserted,</p>\n\n<p>g_value contain the text that had to be inserted in bookmark g_name. </p>\n\n<p>This code is working, but only if g_value length less then 255 characters. If g_value length more then 255 the macros return error \"String too long\". </p>\n\n<p>I've tryed insert text like this:</p>\n\n<pre><code>bm.Range.Select\nWith Selection\n    .Text = g_value\n    .Font.Underline = wdUnderlineNone\n    .Collapse wdCollapseEnd\nEnd With\n</code></pre>\n\n<p>And this work, but text field are non-editable.</p>\n\n<p>How resolve this issue?</p>\n"}, {"tags": ["sql", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487758411, "post_id": 42388560, "comment_id": 71925279, "body": "What&#39;s the copyfromrecordset line of vba? to a single cell?"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1487759868, "post_id": 42388560, "comment_id": 71925590, "body": "I would have to assume this is a difference in the interpretation of the criteria. Short of having your data to actually look at I think we&#39;ll be clutching at straws to be honest. Re-run with just one criteria statement in both access and excel and see if the differences are maintained / worse or better."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487760244, "post_id": 42388560, "comment_id": 71925844, "body": "What happens if you directly connect to the query from Excel?"}, {"owner": {"reputation": 49, "user_id": 6444824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3e0eea43f9fb27b476753a169bb24e?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart", "link": "https://stackoverflow.com/users/6444824/stuart"}, "edited": false, "score": 0, "creation_date": 1487760535, "post_id": 42388560, "comment_id": 71926055, "body": "Hi Guys, Thank you for replying. The CopyFromRecordset is the following code: Range(&quot;A2&quot;).CopyFromRecordset objRS. Not sure what you mean by directly connecting to the query from Excel. Usually I always connect to MS Access via VBA."}, {"owner": {"reputation": 49, "user_id": 6444824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3e0eea43f9fb27b476753a169bb24e?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart", "link": "https://stackoverflow.com/users/6444824/stuart"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1487761037, "post_id": 42388560, "comment_id": 71926423, "body": "@Minty. Thank you for the suggestion, I took your advice and tried a new very basic query. I got the same results as before so I am guessing there is an issue somewhere in my code that is causing this issue."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1487761158, "post_id": 42388560, "comment_id": 71926498, "body": "Have you compared the 67 to the 400? Are you getting just the first 67 of the 400, or is there something in the data that could explain the 67 as a sub-set of the 400?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1487761163, "post_id": 42388560, "comment_id": 71926501, "body": "Just to be safe, are you sure you are connecting to the same Access database from Excel as when you try the query directly?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1487761171, "post_id": 42388560, "comment_id": 71926509, "body": "Do you get the same results if you use <code>&quot;</code> quotes to delimit strings instead of <code>&#39;</code> quotes? Do you get different results if you use a DAO Recordset instead of an ADO Recordset? And is there a setting that is forcing binary compare on <code>tbJobStatus.statusDes &lt;&gt; &#39;Deleted&#39; </code>"}, {"owner": {"reputation": 49, "user_id": 6444824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3e0eea43f9fb27b476753a169bb24e?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart", "link": "https://stackoverflow.com/users/6444824/stuart"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1487761402, "post_id": 42388560, "comment_id": 71926664, "body": "@Andre, you are spot on, I forgot I was connected to a test database versus prod...apologies guys."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1487761409, "post_id": 42388560, "comment_id": 71926670, "body": "Ah - ye Olde wrong database issue. Glad you sorted it."}], "owner": {"reputation": 49, "user_id": 6444824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3e0eea43f9fb27b476753a169bb24e?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart", "link": "https://stackoverflow.com/users/6444824/stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "closed_date": 1488366766, "answer_count": 0, "score": 4, "last_activity_date": 1488359400, "creation_date": 1487758243, "last_edit_date": 1487758520, "question_id": 42388560, "link": "https://stackoverflow.com/questions/42388560/record-count-different-in-vba-versus-access", "closed_reason": "Not suitable for this site", "title": "Record Count Different in VBA Versus Access", "body": "<p>I have an Excel VBA workbook that generates a SQL statement in the form of a string. I pass this SQL into a recordset object and use the CopyFromRecordSet function to dump out the data into an Excel worksheet.</p>\n\n<p>The above method gives me 67 records. If I take the exact SQL generated in VBA and paste into a new query within Access it provides 400 records.</p>\n\n<p>SQL is the following: </p>\n\n<pre><code>SELECT  tbJob.jobID, \n        tbTasks.tskName, \n        tbTaskCat.catName, \n        tbTasks.tskActivity, \n        tbJob.JobDueDate, \n        tbJob.jobCompletedDate, \n        tbJob.jobCreatedOn, \n        tbJobStatus.statusDes, \n        tbStaff.staffForename &amp; ' ' &amp; tbStaff.staffSurname AS Assignee \nFROM    tbJobStatus \n        INNER JOIN (tbStaff \n            INNER JOIN (tbTaskCat \n                INNER JOIN (tbTasks \n                    INNER JOIN tbJob \n                    ON tbTasks.tskID = tbJob.jobTaskID) \n                ON tbTaskCat.catID = tbTasks.tskCatID) \n            ON tbStaff.staffID = tbJob.jobAssignedToID) \n        ON tbJobStatus.statusID = tbJob.jobStatusID \nWHERE   tbJob.jobStatusID = 4 \nAND     tbJobStatus.statusDes &lt;&gt; 'Deleted' \nORDER BY tbJob.jobID;\n</code></pre>\n\n<p>I am struggling to explain why the difference occurs.\nAny help would be appreciated. I have searched around the web but couldn't find a solution, if you know of one please post the link.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Stuart</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1487762033, "post_id": 42388465, "comment_id": 71927145, "body": "Looks like this has been noticed before: (<a href=\"http://stackoverflow.com/questions/29832281/vba-range-function-suddenly-accepts-only-localized-arguments-pt-br\" title=\"vba range function suddenly accepts only localized arguments pt br\">stackoverflow.com/questions/29832281/&hellip;</a>)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487762206, "post_id": 42388465, "comment_id": 71927267, "body": "My Excel UI uses semicolons, too. but your code works flawlessly for me. When you get error click Debug button and use Immediate Window to query relevant variables"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487770273, "post_id": 42388465, "comment_id": 71933213, "body": "The German version of Excel uses the <code>;</code> instead of <code>,</code> as a separator in lists because the <code>,</code> is already taken as a decimal separator in Germany since <code>one half</code> is written <code>0,5</code> instead of <code>0.5</code>. I am mentioning this because you are saying that <i>sometimes</i> this is happening. So, I&#39;d like to ask you to check the <code>Application.DecimalSeparator</code> whenever this happens. If the <code>,</code> works the <code>Application.DecimalSeparator</code> should be <code>.</code>. But if it doesn&#39;t work anymore and instead requires a <code>;</code> I am assuming that the <code>DecimalSeparator</code> also changed to <code>,</code>."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487770314, "post_id": 42388465, "comment_id": 71933248, "body": "If that&#39;s the case then you could just switch it back to solve the problem. <a href=\"http://stackoverflow.com/questions/20652409/using-vba-to-detect-which-decimal-sign-the-computer-is-using\" title=\"using vba to detect which decimal sign the computer is using\">stackoverflow.com/questions/20652409/&hellip;</a>"}, {"owner": {"reputation": 100, "user_id": 7176707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6174776c4dbfbb74d21e08c4ccae1a9b?s=128&d=identicon&r=PG&f=1", "display_name": "JackTheFruit", "link": "https://stackoverflow.com/users/7176707/jackthefruit"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487771760, "post_id": 42388465, "comment_id": 71934348, "body": "Ok thank you already for your suggestions @Ralph . The <i>sometimes</i> means that it is hard to replicate the error. <code>Application.DecimalSeparator</code> did not change and was always set to <code>,</code>. I did not try to temporarily change the decimal separator though. @user3598756 Essentially the <code>Range(&quot;A1,A3,A5&quot;)</code> part cannot be evaluated."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487774074, "post_id": 42388465, "comment_id": 71936103, "body": "Why don&#39;t you just <code>split</code> all strings in the array on <code>,</code> to avoid all problems? Of course, these ranges are later used in the code some place and hence the access to the sheets would be greatly increased. But with <code>Application.ScreenUpdating</code> it might not be that bad."}, {"owner": {"reputation": 100, "user_id": 7176707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6174776c4dbfbb74d21e08c4ccae1a9b?s=128&d=identicon&r=PG&f=1", "display_name": "JackTheFruit", "link": "https://stackoverflow.com/users/7176707/jackthefruit"}, "edited": false, "score": 1, "creation_date": 1487781832, "post_id": 42388465, "comment_id": 71941832, "body": "I loop through the array and I don&#39;t want to implement another loop inside to keep the code simple. Splitting the array in advance will also not help because the range strings are related to another array which determines what to do with the corresponding range. But I also want to understand what is happening there. I will try <code>Application.International(xlAlternateArraySeparator)</code> and all other separators next time the error occurs and compare it with the standard adjustment when starting Excel."}, {"owner": {"reputation": 100, "user_id": 7176707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6174776c4dbfbb74d21e08c4ccae1a9b?s=128&d=identicon&r=PG&f=1", "display_name": "JackTheFruit", "link": "https://stackoverflow.com/users/7176707/jackthefruit"}, "edited": false, "score": 0, "creation_date": 1487858651, "post_id": 42388465, "comment_id": 71981106, "body": "Also no change in any <code>Application.International</code> separators. Seems like an Excel bug..."}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1488556278, "post_id": 42388465, "comment_id": 72298765, "body": "Stealing @JackTheFruit thought.  Maybe you can split your array using <code>Application.International(xlListSeparator)</code> instead of an explicit <code>,</code> This returns a comma &quot;,&quot; in my US version of excel.  Perhaps it will return a semi-colon &quot;;&quot; in the German version."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1513156567, "post_id": 42388465, "comment_id": 82539682, "body": "Can you write what is expected results after running your code. When I run it nothing happens. Can you write if you feel that the problem is with list separator in VBA array or in list separator in &quot;A1,A3,A5&quot; part?"}], "answers": [{"tags": [], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "is_accepted": false, "score": 0, "last_activity_date": 1513091494, "creation_date": 1513091494, "answer_id": 47775807, "question_id": 42388465, "link": "https://stackoverflow.com/questions/42388465/range-accepts-sometimes-only-semicolons-instead-of-commas/47775807#47775807", "title": "Range accepts sometimes only semicolons instead of commas", "body": "<p>If you want to control it, check first what separator is currently in use. What I guess is that you want to know the list separator:</p>\n\n<pre><code>Application.International(xlListSeparator)\n</code></pre>\n\n<p>Check other separators here:\n<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-international-property-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-international-property-excel</a></p>\n\n<p>The other time I had a problem with identifying decimal separator in VBA. Finnally I was able to get it in this way:</p>\n\n<pre><code>Function GetVBAdecimalSep()\n    Dim a(0) As Variant\n    a(0) = 1 / 2\n    GetVBAdecimalSep = Mid(a(0), 2, 1)\nEnd Function\n</code></pre>\n\n<p>Changing separator not always works. Please see this: <a href=\"https://stackoverflow.com/q/29131805/1903793\">Changing decimal separator in VBA (not only in Excel)</a></p>\n\n<p>The best solution is to check/change locale, even temporary.</p>\n\n<p><code>Application.LanguageSettings.LanguageID(msoLanguageIDUI)</code> </p>\n\n<p>gives the LCID which would be 1033 for English (US)</p>\n"}], "owner": {"reputation": 100, "user_id": 7176707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6174776c4dbfbb74d21e08c4ccae1a9b?s=128&d=identicon&r=PG&f=1", "display_name": "JackTheFruit", "link": "https://stackoverflow.com/users/7176707/jackthefruit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1104, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1513091494, "creation_date": 1487758019, "last_edit_date": 1531164843, "question_id": 42388465, "link": "https://stackoverflow.com/questions/42388465/range-accepts-sometimes-only-semicolons-instead-of-commas", "title": "Range accepts sometimes only semicolons instead of commas", "body": "<p>I have reduced my problem to the following code example. I am using a German Excel version in which separators in normal Excel formulas are semicolons \";\" instead of \",\" (e.g. <code>=SUMME(A1;A3)</code> instead of <code>=SUM(A1,A3)</code>). <br> \nNow the code which works different from time to time:</p>\n\n<pre><code>Sub CommasDoNotWorkAnymore()\n\nDim a()\nDim i%\n\na = Array(\"A1,A3,A5\", \"B1\", \"B2\")\ni = 0\n\nDebug.Print Sheets(1).Range(a(i)).Address\nEnd Sub\n</code></pre>\n\n<p>Normally, when starting Excel, this code works. But sometimes Excel seem to switch the accepted separators used in the <code>Range()</code> to semicolons untill I restart Excel. This occurs most times when rerunning the code after a runtime error.</p>\n\n<p>Is this a general Excel bug? Does anybody know what is behind this behaviour? Is there some Excel-wide \"local option\" for the <code>Range</code> class?</p>\n\n<p>EDIT: I just tried to convert the <code>a(i)</code> with <code>CStr(a(i)</code> but this does also not work. So no ByRef kind of problem...</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487757651, "post_id": 42388259, "comment_id": 71924716, "body": "Which line is the error and what is the error"}, {"owner": {"reputation": 800, "user_id": 1934111, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/jrGoS.jpg?s=128&g=1", "display_name": "VijayD", "link": "https://stackoverflow.com/users/1934111/vijayd"}, "edited": false, "score": 0, "creation_date": 1487757796, "post_id": 42388259, "comment_id": 71924817, "body": "Please share the error log."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487757935, "post_id": 42388259, "comment_id": 71924926, "body": "does <code>&quot;INSERT INTO test(uname) VALUES(&#39;john&#39;)&quot;</code> work?"}, {"owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "edited": false, "score": 0, "creation_date": 1487757991, "post_id": 42388259, "comment_id": 71924963, "body": "Sorry i&#39;m using excel chinese version,so the error message is chinese.it mainly said that the field &quot;tid&quot; is need.so i need to write the statement like this:strSQL = &quot;INSERT INTO test VALUES(1, &#39;john&#39;)&quot;"}, {"owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "edited": false, "score": 0, "creation_date": 1487766226, "post_id": 42388259, "comment_id": 71930168, "body": "this statement works.what if there are many columns?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "edited": false, "score": 0, "creation_date": 1487765991, "post_id": 42388527, "comment_id": 71930002, "body": "yes it works,thanks so much.but what if there are many columns?my table have 20 more fields,i think that&#39;s not so convenience to write them down all."}], "tags": [], "owner": {"reputation": 28, "user_id": 7603916, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wAD3qJiAN-Q/AAAAAAAAAAI/AAAAAAAAABs/t4FbZYgDtMQ/photo.jpg?sz=128", "display_name": "Boris", "link": "https://stackoverflow.com/users/7603916/boris"}, "is_accepted": true, "score": 0, "last_activity_date": 1487758168, "creation_date": 1487758168, "answer_id": 42388527, "question_id": 42388259, "link": "https://stackoverflow.com/questions/42388259/how-to-insert-values-to-access-through-sql-and-adodb-object-when-the-table-has-a/42388527#42388527", "title": "how to insert values to Access through SQL and ADODB object when the table has an autoincrement field?", "body": "<p>This should work, if tid is auto increment:</p>\n\n<pre><code>strSQL = \"INSERT INTO test (uname) VALUES ('john')\";\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 42388527, "answer_count": 1, "score": 0, "last_activity_date": 1594640376, "creation_date": 1487757551, "last_edit_date": 1594640376, "question_id": 42388259, "link": "https://stackoverflow.com/questions/42388259/how-to-insert-values-to-access-through-sql-and-adodb-object-when-the-table-has-a", "title": "how to insert values to Access through SQL and ADODB object when the table has an autoincrement field?", "body": "<p>i got a question when insert values to Access through SQL statements and ADODB object.\nthis is my Access table \"test\"\n<a href=\"https://i.stack.imgur.com/yndcN.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>the primary field \"tid\" is an autoincrement field,when i insert new values by SQL statements </p>\n\n<pre><code>strSQL = \"INSERT INTO test VALUES('john')\"\n\nadoConn.Execute CommandText:=strSQL\n</code></pre>\n\n<p>i got an exception that i have to write my statement like this </p>\n\n<pre><code>strSQL = \"INSERT INTO test VALUES(1, 'john')\"\n</code></pre>\n\n<p>How can i solve this problem?</p>\n"}, {"tags": ["vba", "excel", "variables"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487757392, "post_id": 42388089, "comment_id": 71924550, "body": "You have 2 options: <b>Option 1:</b> (safer but not best as CPU and memory consuming). Add another module, dedicated only for <code>Global</code> vairables, and inside it declare <code>Option Explicit</code> , and underneath <code>Global pathS As String</code>, this will allow all modules to recognize this variable. However, if you don&#39;t run <code>Sub</code>Counter` first, you will get an error.  <b>Option 2:</b> change to <code>Public pathS As String</code>."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487757669, "post_id": 42388089, "comment_id": 71924726, "body": "@ShaiRado Explicitly speaking, what is the practical difference between using public and global in this case?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487757728, "post_id": 42388089, "comment_id": 71924773, "body": "@ShaiRado Option 1 doesn&#39;t make sense because he already declared the variable as global in module 1. @DGMS89 instead of <code>Workbooks.Open Filename:=pathS &amp; ThisWorkbook.Sheets(&quot;FILES&quot;).Cells(i, 1).Value</code> use <code>msgbox pathS &amp; ThisWorkbook.Sheets(&quot;FILES&quot;).Cells(i, 1).Value</code> to see what the path looks like. I guess there is a missing backslash or something."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1487757909, "post_id": 42388089, "comment_id": 71924901, "body": "@Peh That is what i am currently trying to do, but there is this strange behavior: when I open the workbook and run the macros for the first time, module 2 is giving me the error (not finding the file). If I end the break mode and run it again, it works normally. Any idea why this might be happening?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1487758314, "post_id": 42388089, "comment_id": 71925213, "body": "You can try to monitor the variable <code>pathS</code> to see whats happening on the first run and go through it step by step. Hard to say whats wrong there. Make sure <code>pathS</code> is not empty on the first run."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1487758404, "post_id": 42388089, "comment_id": 71925271, "body": "@Peh Found it. For some reason, on the first run, it is putting a &quot;.&quot; before the file name, which does not happen on the subsequent runs. Quite a peculiar behavior."}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1487757995, "creation_date": 1487757995, "answer_id": 42388456, "question_id": 42388089, "link": "https://stackoverflow.com/questions/42388089/using-a-public-variable-to-store-a-path-and-using-it-in-another-module/42388456#42388456", "title": "Using a public variable to store a path, and using it in another module", "body": "<p>You can prefix the module name to the variable to be sure about which varaiable you are trying to access and also whether you have access to it.</p>\n\n<p>Example works fine:</p>\n\n<h2>Module1</h2>\n\n<pre><code>Option Explicit\n\nPublic foo As String\n\nSub Test1()\n\n    Module1.foo = \"bar\"\n    Module2.Test2\n\nEnd Sub\n</code></pre>\n\n<h2>Module2</h2>\n\n<pre><code>Option Explicit\n\nSub Test2()\n\n    MsgBox Module1.foo\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 42388456, "answer_count": 1, "score": 1, "last_activity_date": 1487757995, "creation_date": 1487757067, "question_id": 42388089, "link": "https://stackoverflow.com/questions/42388089/using-a-public-variable-to-store-a-path-and-using-it-in-another-module", "title": "Using a public variable to store a path, and using it in another module", "body": "<p>I have a workbook with different modules, each with a different purpose. </p>\n\n<p><strong>What the code does:</strong> \nThe <strong>first module</strong> opens a FileDialog box that requires the user to select the path where the source files (.csv) are, then it searches and pastes the names of each source file into the main workbook.</p>\n\n<p>The <strong>second module</strong> reads the file names and using the \"pathS\" variable; from the first module, gets the information from the source workbooks.</p>\n\n<p>The <strong>third module</strong> cleans all the information and outputs it to new workbooks.</p>\n\n<p><strong>What I already tried:</strong> The variable pathS is defined in the first module as the location of the source files, and it is then used in module 2 to locate the files (for info extraction). I declared it as public in module 1, outside the sub. </p>\n\n<p><strong>The Problem:</strong> When I run the module 2, it cannot find the source files.</p>\n\n<p><strong>Question:</strong> Is there anything wrong with the way I am using the variable?</p>\n\n<p><strong>Relevant Code:</strong></p>\n\n<p><strong>Module 1:</strong></p>\n\n<pre><code>Option Explicit\n\nGlobal pathS As String\n\nSub Counter()\n\nDim count As Integer, i As Long, var As Integer\nDim ws As Worksheet\nDim w As Workbook\nDim Filename As String\nDim FileTypeUserForm As UserForm\nDim x As String\nDim varResult As Variant\nDim OutPath As String, OutPathS As String, wPos As Long\n\nSet w = ThisWorkbook\n\nApplication.Calculation = xlCalculationManual\n\n 'source input by user\n\n        varResult = Application.GetSaveAsFilename(FileFilter:=\"Comma Separated Values Files\" &amp; \"(*.csv), *.csv\", Title:=\"OutPath\", InitialFileName:=\"D:StartingPath\")\n\n        If varResult &lt;&gt; False Then\n            OutPath = varResult\n            w.Worksheets(\"FILES\").Cells(1, 4) = varResult\n\n        Else\n\n            Exit Sub\n\n        End If\n\n\nwPos = InStr(OutPath, \"\\StartingPath\")\nOutPathS = Mid(OutPath, 1, wPos - 1)\n\npathS = OutPathS &amp; \"\\*.*\"\n\nFilename = Dir(pathS)\n\nThisWorkbook.Sheets(\"FILES\").Range(\"A:A\").ClearContents\n\n\nx = GetValue\nIf x = \"EndProcess\" Then Exit Sub\n\n\nSet ws = ThisWorkbook.Sheets(\"FILES\")\ni = 0\nDo While Filename &lt;&gt; \"\"\n    var = InStr(Filename, x)\n\n    If var &lt;&gt; 0 Then\n        i = i + 1\n        ws.Cells(i + 1, 1) = Filename\n        Filename = Dir()\n\n    Else: Filename = Dir()\n    End If\n\nLoop\n\nRange(\"A2:A\" &amp; i).Sort key1:=Range(\"A2\"), order1:=xlAscending, Header:=xlNo 'this will sort the names directly in the \"FILES\" sheet\n\nApplication.Calculation = xlCalculationAutomatic\n\nws.Cells(1, 2) = i\n\nMsgBox i &amp; \" : files found in folder\"\nEnd Sub\n</code></pre>\n\n<p><strong>Module 2 (only until the error line):</strong></p>\n\n<pre><code>Sub Gatherer()\nDim w As Workbook\nDim w2 As Workbook\nDim start1 As Long, end1 As Long, end2 As Long, i As Long, lRow As Long, lColumn As Long, t As Long, k As Long, position As Long, g As Long, C As Long\nDim WBArray() As Variant\nDim Cell As Range\nDim ws As Worksheet\n\nDim MyFolder As String\nDim MyFile As String\n\nSet w = ThisWorkbook\n\n'clean all worksheets in the main file (except FILES), and set date format\nFor Each ws In w.Worksheets\n    If ws.Name &lt;&gt; \"FILES\" Then\n        ws.UsedRange.ClearContents\n        ws.Range(\"D1\", \"XFD1\").NumberFormat = \"yyyy-mm-dd\"\n    End If\nNext ws\n\n'Optimize Macro Speed Start\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual  \n\n'opens the first workbook file\nFor i = 2 To ThisWorkbook.Sheets(\"FILES\").Cells(1, 2).Value + 1 'has to be +1, otherwise the last source file is not accounted for\n\n'error is in this next line, it does not find the file\n    Workbooks.Open Filename:=pathS &amp; ThisWorkbook.Sheets(\"FILES\").Cells(i, 1).Value \n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487757111, "post_id": 42387931, "comment_id": 71924340, "body": "gsCartes is a property returning the collection, the actual variable that is holding it.  The colCartes wont be visible from outside the class, due to private declaration"}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487759716, "post_id": 42387931, "comment_id": 71925495, "body": "Ok so if it was public i won&#39;t need the get and set ? And is <code>For Each cid In colCartesID.gsCartesID</code> correct ?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487760881, "post_id": 42387931, "comment_id": 71926308, "body": "Yes, but it&#39;s good practice to do public accessors and private variables.  The property let/get/set allow you to add some validation code.  So if you allowed all but dates, you could say <code>if not(typename(value)=&quot;date&quot;) then varContents=value</code> to validate passing to a variant, varConents, but not allowing dates (not accurate VBA, just example)  As that procedure is in the class, then it&#39;s acceptable to use the col, but making it private would still be of use in the class, but not visible to o/s the class, i.e. when using it."}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487768973, "post_id": 42387931, "comment_id": 71932197, "body": "Ok got it, thanks !"}], "owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487756670, "creation_date": 1487756670, "last_edit_date": 1495542309, "question_id": 42387931, "link": "https://stackoverflow.com/questions/42387931/misunderstanding-of-collection", "title": "Misunderstanding of collection", "body": "<p>Based on this post <a href=\"https://stackoverflow.com/questions/2161666/what-are-the-benefits-of-using-classes-in-vba\">What are the benefits of using Classes in VBA?</a> I've made a bit of code.\nThe first class <strong>CarteID</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate agePersonne As Long\nPrivate nomPersonne As String\n\nPublic Property Get glAgePersonne() As Long\n    glAgePersonne = agePersonne\nEnd Property\n\nPublic Property Let glAgePersonne(lAgePersonne As Long)\n    agePersonne = lAgePersonne\nEnd Property\n\nPublic Property Get glNomPersonne() As String\n    glNomPersonne = nomPersonne\nEnd Property\n\nPublic Property Let glNomPersonne(lNomPersonne As String)\n    nomPersonne = lNomPersonne\nEnd Property\n</code></pre>\n\n<p>Then the second class <strong>ProcessCarteID</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate colCartesID As Collection\n\nPublic Property Get gsCartesID() As Collection\n    Set gsCartesID = colCartesID\nEnd Property\n\nPublic Property Set gsCartesID(sCartesID As Collection)\n    Set colCartesID = sCartesID\nEnd Property\n\nFunction RecupAgeMoyen() As Double\n\n    Dim cid As CarteID\n    Dim moyenneAge As Double\n    moyenneAge = 0\n\n    For Each cid In colCartesID\n            moyenneAge = moyenneAge + cid.glAgePersonne\n    Next cid\n\n    moyenneAge = moyenneAge / colCartesID.Count\n\n    RecupAgeMoyen = moyenneAge\n\nEnd Function\n</code></pre>\n\n<p>And the module :</p>\n\n<pre><code>Option Explicit\n\nFunction PopulateArray() As Collection\n\n    Dim colInfos As New Collection\n    Dim cid As CarteID\n\n    Set cid = New CarteID\n    cid.glNomPersonne = \"Fred\"\n    cid.glAgePersonne = 21\n    colInfos.Add cid\n\n    Set cid = New CarteID\n    cid.glNomPersonne = \"Julie\"\n    cid.glAgePersonne = 18\n    colInfos.Add cid\n\n    Set cid = New CarteID\n    cid.glNomPersonne = \"Jean\"\n    cid.glAgePersonne = 25\n    colInfos.Add cid\n\n    Set PopulateArray = colInfos\n\nEnd Function\n\nSub TestAgeMoyen()\n\n    Dim pci As ProcessCarteID\n\n    Set pci = New ProcessCarteID\n    Set pci.gsCartesID = PopulateArray()\n\n    Debug.Print pci.RecupAgeMoyen()\n\nEnd Sub\n</code></pre>\n\n<p>In the function <code>RecupAgeMoyen()</code> I tried <code>For Each cid In colCartesID</code> and <code>For Each cid In gsCartesID</code>. Both worked.</p>\n\n<p>I just wanted to know why it worked also with <code>gsCartesID</code> because I am not sure to understand.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487760459, "post_id": 42387515, "comment_id": 71926003, "body": "Intersect(ActiveSheet.UsedRange.Offset(1), Range(&quot;T:T&quot;)).Resize(ActiveSheet.UsedRange.Rows.Count - 1, ActiveSheet.UsedRange.Columns.Count)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7604228, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e4b6e9590e23c510a537b72e197ec56c?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/7604228/guest"}, "is_accepted": false, "score": 0, "last_activity_date": 1487770659, "last_edit_date": 1487770659, "creation_date": 1487760685, "answer_id": 42389147, "question_id": 42387515, "link": "https://stackoverflow.com/questions/42387515/exclude-header-row-in-macro/42389147#42389147", "title": "Exclude header row in Macro", "body": "<p>Add  <code>i = Range(\"a1048576\").End(xlUp).Row</code> to find the lowest filled row in your data, \nand change the <code>(\"T:T\")</code> to <code>(\"T1:T\" &amp; i)</code>.</p>\n\n<p>This works at my end, do try and let me know.</p>\n"}], "owner": {"reputation": 11, "user_id": 7603773, "user_type": "registered", "profile_image": "https://graph.facebook.com/1237848102937379/picture?type=large", "display_name": "Roy Dijkshoorn", "link": "https://stackoverflow.com/users/7603773/roy-dijkshoorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487770659, "creation_date": 1487755613, "last_edit_date": 1487756064, "question_id": 42387515, "link": "https://stackoverflow.com/questions/42387515/exclude-header-row-in-macro", "title": "Exclude header row in Macro", "body": "<p>I've been looking for this for quite some time now but I don't have enough understanding of the macro's to adjust and implement other solutions I found on here.</p>\n\n<p>I am using Macro's to do a certain amount of actions on a sheet. The first row of the sheet contains headers, so I need to exclude the first row from some of the actions.</p>\n\n<p>I will paste my code below, I understand this is not the best way to do this (would probably be better with an IF function) but this is how far I got up till now. Is there a way to simply exclude the entire header Row in the macros? Or just exclude T1 in these 3 steps where I populate column T?</p>\n\n<pre><code>Sub TASKDUESTATUS()\n'\n' TASKDUESTATUS Macro\n'\n\n'\n\n\n\n'Filter Completed and In Progress\n    ActiveSheet.UsedRange.AutoFilter Field:=21, Criteria1:= _\n        \"=Completed\", Operator:=xlOr, Criteria2:=\"=In Progress\"\n 'Fill Column T with 3\n    Dim rX As Range\n    Set rX = Intersect(ActiveSheet.UsedRange, Range(\"T:T\")).Cells.SpecialCells(xlCellTypeVisible)\n    rX.Value = \"3\"\n\n'Filter Not Started\n    ActiveSheet.UsedRange.AutoFilter Field:=21, Criteria1:= _\n        \"Not Started\"\n\n 'Filter Date up till todays date with today INCLUDED\n    ActiveSheet.UsedRange.AutoFilter Field:=19, Criteria1:=\"&lt;=\" &amp; Date\n\n'Fill Column T with 2\n    Dim rX2 As Range\n    Set rX2 = Intersect(ActiveSheet.UsedRange, Range(\"T:T\")).Cells.SpecialCells(xlCellTypeVisible)\n    rX2.Value = \"2\"\n\n'Filter Not Started\n        ActiveSheet.UsedRange.AutoFilter Field:=21, Criteria1:= _\n        \"Not Started\"\n\n'Filter date after todays date with today EXCLUDED\n    ActiveSheet.UsedRange.AutoFilter Field:=19, Criteria1:=\"&gt;\" &amp; Date\n\n'Fill Column T with 1\n    Dim rX3 As Range\n    Set rX3 = Intersect(ActiveSheet.UsedRange, Range(\"T:T\")).Cells.SpecialCells(xlCellTypeVisible)\n    rX3.Value = \"1\"\n\n'Add conditional formatting\n    Columns(\"T:T\").Select\n    Selection.FormatConditions.AddIconSetCondition\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1)\n        .ReverseOrder = False\n        .ShowIconOnly = False\n        .IconSet = ActiveWorkbook.IconSets(xl3TrafficLights1)\n    End With\n    With Selection.FormatConditions(1).IconCriteria(2)\n        .Type = xlConditionValuePercent\n        .Value = 33\n        .Operator = 7\n    End With\n    With Selection.FormatConditions(1).IconCriteria(3)\n        .Type = xlConditionValuePercent\n        .Value = 67\n        .Operator = 7\n    End With\n\n'Clear filters\n    ActiveSheet.UsedRange.AutoFilter Field:=21\n    ActiveSheet.UsedRange.AutoFilter Field:=19\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "list", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1487761738, "post_id": 42389295, "comment_id": 71926914, "body": "Thanks for the reply KoderM16, I will end up doing that if the it turns out to be more hassle then it&#39;s worth haha. It&#39;s just because the fields on sheet 1 are clearer to read and update than on sheet 2 which would make the amending a bit easier if I could do this"}], "tags": [], "owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "is_accepted": false, "score": 2, "last_activity_date": 1487761077, "creation_date": 1487761077, "answer_id": 42389295, "question_id": 42387332, "link": "https://stackoverflow.com/questions/42387332/export-data-from-one-sheet-to-another-via-drop-down-list-vba-excel-macro/42389295#42389295", "title": "Export data from one sheet to another via drop down list - VBA Excel Macro", "body": "<p>Instead of bringing the data back to sheet 1, in sheet 2, you can turn on \"Filters\" and in the unique numbers column, filter/search for the number whose data you want to change. It will then only show the entry of data corresponding to that number. Then make the edits on sheet 2.</p>\n\n<p>Hope this is useful.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491226764, "post_id": 42424511, "comment_id": 73445402, "body": "Thank you Majjam, I have only just seen this response so my apologies for my late reply. I shall have a look in to your comment and let you know how I get on. Thanks again"}, {"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "reply_to_user": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491226874, "post_id": 42424511, "comment_id": 73445482, "body": "No problem @Grigson, all the best and let me know if you have any questions"}, {"owner": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491229732, "post_id": 42424511, "comment_id": 73447731, "body": "sorry to be a pain @Majjam I cannot get the file as it is rar&#39;d and I don&#39;t have winrar on my work laptop. I can create a validation dropdown but I am unsure where the &#39;Worksheet change&#39; code goes / how it gets activated? Do I need to create a button to get VBA up? sorry for my ignorance :)"}, {"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "reply_to_user": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491231534, "post_id": 42424511, "comment_id": 73449045, "body": "@Grigson, something weird happened there, I&#39;ve replaced the link with a dropbox one, that should be ok now"}, {"owner": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491234427, "post_id": 42424511, "comment_id": 73451035, "body": "Thanks @Majjam I can retrieve it now, I shall look in to it more when I&#39;m back at work tomorrow."}, {"owner": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491298589, "post_id": 42424511, "comment_id": 73478605, "body": "@Marjjam - your example was brilliant thank you ever so much, it really helped me with what I was after."}, {"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "reply_to_user": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "edited": false, "score": 0, "creation_date": 1491308917, "post_id": 42424511, "comment_id": 73485889, "body": "@Grigson, glad to hear it :)"}], "tags": [], "owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "is_accepted": true, "score": 2, "last_activity_date": 1491231500, "last_edit_date": 1491231500, "creation_date": 1487878098, "answer_id": 42424511, "question_id": 42387332, "link": "https://stackoverflow.com/questions/42387332/export-data-from-one-sheet-to-another-via-drop-down-list-vba-excel-macro/42424511#42424511", "title": "Export data from one sheet to another via drop down list - VBA Excel Macro", "body": "<p>I've put together a quick example demoing what you requested, it can be downloaded <a href=\"https://www.dropbox.com/s/nb3lwrfh2gq2zhv/Form.xlsm?dl=0\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I did the following:</p>\n\n<ol>\n<li>Added Form (with a few data editing fields) and Data (with example data) worksheets.</li>\n<li>Added a validation dropdown to the datasheet showing the ID + Name data from your Data worksheet.</li>\n<li><p>When the selected option in the validation dropdown is changed it triggers the Worksheet_Change event, running the following code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'check that the Target cell is our dropdown\n    If Target.Address = \"$C$2\" Then\n        'get the value of the dropdown using the range method\n        Dim dropDownValue As String\n        dropDownValue = CStr(wsForm.Range(Target.Address).Value)\n\n        'if that dropdown value exists (has a length of more than zero)\n        If Len(dropDownValue) &gt; 0 Then\n            'get the corresponding record from the data sheet\n            Dim index As Integer\n            index = Left(dropDownValue, 1)\n\n            wsForm.Range(\"C3\").Value = index\n            wsForm.Range(\"C4\").Value = Application.WorksheetFunction.VLookup(index, wsData.Range(\"A:E\"), 2, False)\n            wsForm.Range(\"C5\").Value = Application.WorksheetFunction.VLookup(index, wsData.Range(\"A:E\"), 3, False)\n            wsForm.Range(\"C6\").Value = Application.WorksheetFunction.VLookup(index, wsData.Range(\"A:E\"), 4, False)\n        End If\n End If\nEnd Sub\n</code></pre>\n\n<p>Which uses vlookups to retrieve the information from the datasheet to populate the editing form.</p></li>\n<li><p>When the save button is clicked, the following code is run:</p>\n\n<pre><code>Sub Button4_Click()\n    Dim index As Integer\n    index = wsForm.Range(\"C3\")\n\n    If index &gt; 0 Then\n        Dim foundIndexRange As Range\n        Set foundIndexRange = wsData.Range(\"A:A\").Find(index)\n\n        If (Len(foundIndexRange.Value) &gt; 0) Then\n            foundIndexRange.Offset(0, 1).Value = wsForm.Range(\"C4\").Value\n            foundIndexRange.Offset(0, 2).Value = wsForm.Range(\"C5\").Value\n            foundIndexRange.Offset(0, 3).Value = wsForm.Range(\"C6\").Value\n        End If\n        MsgBox \"Record saved\"\n    Else\n        MsgBox \"Please choose from the dropdown\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Which uses the range.Find method to locate the range where our index is on the data sheet, then offset to overwrite our new values.</p></li>\n</ol>\n\n<p>I hope that makes sense, please ask if you have any questions.</p>\n"}], "owner": {"reputation": 27, "user_id": 3780190, "user_type": "registered", "profile_image": "https://graph.facebook.com/753290626/picture?type=large", "display_name": "Grigson", "link": "https://stackoverflow.com/users/3780190/grigson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "accepted_answer_id": 42424511, "answer_count": 2, "score": 1, "last_activity_date": 1491231500, "creation_date": 1487755259, "last_edit_date": 1487756074, "question_id": 42387332, "link": "https://stackoverflow.com/questions/42387332/export-data-from-one-sheet-to-another-via-drop-down-list-vba-excel-macro", "title": "Export data from one sheet to another via drop down list - VBA Excel Macro", "body": "<p>I have an Excel workbook with two worksheets on.\nSheet 1 is a form which gets filled in and it has a submit button (created with VBA) which takes the data and adds it to the next empty line on sheet 2.\nSo sheet 2 is filled with previously submitted form information and sheet 1 can be cleared (again via a button created with VBA) ready for the next lot of information. </p>\n\n<p>Each entry has a unique number for reference purposes, but what I would like to do is on sheet 1(the form) to have a drop down list of all the unique numbers which I can select one and for it to bring all the relevant information back in to the form so any edits can be made and a button to be able to save/overwrite the data instead of saving it as a new line.</p>\n\n<p>So would like to be able to bring the data back to sheet 1 to edit/amend/save/overwrite.</p>\n\n<p>My VBA knowledge is limited as this is the first project I have dealt with it on so I'm still learning the basics as I go.</p>\n\n<p>Any advice or suggestions would be gratefully appreciated.</p>\n\n<p>Many Thanks</p>\n\n<p>Rachael. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1487934759, "post_id": 42387209, "comment_id": 72018398, "body": "The bit of code you have posted possibly works.  Without seeing the rest of the Sub, it&#39;s hard to tell what you problem is from what you have posted."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1487763057, "creation_date": 1487763057, "answer_id": 42390094, "question_id": 42387209, "link": "https://stackoverflow.com/questions/42387209/vba-filter-cut-paste/42390094#42390094", "title": "VBA - Filter/Cut/Paste", "body": "<p>Try the code below (modify \"Sheet6\" to your sheet's name) :</p>\n\n<pre><code>Option Explicit\n\nSub CopyFiltResults()\n\nDim FiltRng As Range\n\nWith Worksheets(\"Sheet6\") ' modify \"Sheet6\" to your sheet's name\n    With .Range(\"A1:J\" &amp; .Cells(.Rows.Count, \"I\").End(xlUp).Row)\n        ' set range filter column I to \"Gross Sale\"\n        .AutoFilter Field:=9, Criteria1:=\"Gross Sale\"\n\n        Set FiltRng = .Columns(9).SpecialCells(xlCellTypeVisible)\n        FiltRng.Copy .Range(\"K1\") '&lt;-- only copy visible cells to Column K\n        Set FiltRng = Nothing '&lt;-- clear range variable\n\n        ' set range filter column I to \"Net Sales\"\n        .AutoFilter Field:=9, Criteria1:=\"Net Sales\"\n        Set FiltRng = .Columns(9).SpecialCells(xlCellTypeVisible)\n        FiltRng.Copy .Range(\"L1\") '&lt;-- only copy visible cells to Column L\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7587789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89cd8da8e16bff8fc8f5e23cb8a990b?s=128&d=identicon&r=PG&f=1", "display_name": "SortSort", "link": "https://stackoverflow.com/users/7587789/sortsort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487763057, "creation_date": 1487754955, "last_edit_date": 1531164843, "question_id": 42387209, "link": "https://stackoverflow.com/questions/42387209/vba-filter-cut-paste", "title": "VBA - Filter/Cut/Paste", "body": "<p>I would like to know how to write the VBA statement to </p>\n\n<ol>\n<li>Filter Criteria1 (Gross Sales) in column <code>I</code></li>\n<li>Copy Criteria1</li>\n<li>Paste data to column <code>K</code></li>\n<li>Filter Criteria2 in (Net Sales) column <code>I</code></li>\n<li>Copy Criteria2</li>\n<li>Paste data to column <code>L</code></li>\n</ol>\n\n<p>Currently my code looks like this:</p>\n\n<pre><code>Range(\"A1:J1\").AutoFilter Field:=9, Criteria1:=\"Gross Sale\"\nColumns(\"2\" &amp; \":\" &amp; Range(\"J70000\").End(xlUp).Row).Copy\n</code></pre>\n\n<p>Thanks in advance folks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IlNmB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IlNmB.jpg\" alt=\"Screenshot of Data\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "edited": false, "score": 0, "creation_date": 1487762636, "post_id": 42387029, "comment_id": 71927547, "body": "what object are you trying to print? your code snipet is incomplete"}], "owner": {"reputation": 37, "user_id": 5994316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e59b73a36d87f3104b846b9ad7b34e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley Thomson", "link": "https://stackoverflow.com/users/5994316/ashley-thomson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487754411, "creation_date": 1487754411, "question_id": 42387029, "link": "https://stackoverflow.com/questions/42387029/printout-in-vba-code-is-printing-before-pagesetup", "title": ".PrintOut in Vba - Code is printing before .pagesetup", "body": "<p>I have a small piece of vba code that copies the data in a pivot table into a new workbook and then is supposed to set up the page so that it fits onto 1 page width wise. However the code seems to be printing then doing the setup. so what should be 2 pages turns into 12. </p>\n\n<p>Its probably just the ordering of my code being wrong - I'm still learning VBA. Any help would be great - section of code below</p>\n\n<pre><code>With ActiveWorkbook\n\n                .Sheets(1).Cells(1).PasteSpecial _\n                Paste:=xlPasteValuesAndNumberFormats\n                Worksheets(\"Sheet1\").Columns(\"A:O\").AutoFit\n                ActiveSheet.Range(\"A2\").AutoFilter\n\n\n                Columns(2).EntireColumn.Delete\n                Columns(3).EntireColumn.Delete\n                Columns(9).EntireColumn.Delete\n\n                    With ActiveSheet.PageSetup\n                        .FitToPagesWide = 1\n                        .FitToPagesTall = False\n                        .Orientation = xlLandscape\n                        .PrintGridlines = True\n                    End With\n\n End With\n    .PrintOut\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "min"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487755013, "post_id": 42387178, "comment_id": 71922620, "body": "use the <code>Find</code> to look where <code>MaxValue</code> is found"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487755159, "post_id": 42387178, "comment_id": 71922725, "body": "@ShaiRado - wanted to return the cell, so the user can take the address, the column and the row later from it."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1487754856, "creation_date": 1487754856, "answer_id": 42387178, "question_id": 42386830, "link": "https://stackoverflow.com/questions/42386830/getting-the-cell-of-value-of-the-cell-with-min-value-in-a-range/42387178#42387178", "title": "Getting the cell of value of the Cell with Min Value in a Range", "body": "<p>This is something with your code, that should work:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim Rng         As Range\n    Dim Ray         As Variant\n    Dim MaxValue    As Double\n    Dim MaxCell     As Range\n    Dim cell        As Range\n\n    Set Rng = ActiveSheet.Range(Range(\"B2\"), Range(\"E2\").End(xlUp))\n    Ray = Rng.value\n    MaxValue = Application.Max(Ray)\n\n    For Each cell In Rng\n        If cell = MaxValue Then\n            Set MaxCell = cell\n            Exit For\n        End If\n    Next cell\n\n    Debug.Print MaxCell.Address\n    Debug.Print MaxCell.Column\n    Debug.Print MaxCell.row\n\nEnd Sub\n</code></pre>\n\n<p>There are other ways, probably better to do it - e.g. make a separate function, giving you the column with a given value in a row. This one you would be able to use a lot.</p>\n"}, {"tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1487755357, "creation_date": 1487755357, "answer_id": 42387389, "question_id": 42386830, "link": "https://stackoverflow.com/questions/42386830/getting-the-cell-of-value-of-the-cell-with-min-value-in-a-range/42387389#42387389", "title": "Getting the cell of value of the Cell with Min Value in a Range", "body": "<pre><code>Option Explicit\n\nSub TestMax()\n    Dim oSheet As Worksheet\n    Dim oRange As Range      \n    Dim maxValue As Integer\n    Dim oMaxCell As Range\n\n    Set oSheet = ActiveSheet\n\n    Set oRange = oSheet.Range(\"B2:E2\")\n\n    maxValue = Application.Max(oRange.Value)\n\n    For Each oMaxCell In oRange.Cells\n        If CInt(oMaxCell.Value) = maxValue Then\n            Exit For\n        End If\n    Next oMaxCell\n\n    Debug.Print oMaxCell.Column\n\nEnd Sub\n</code></pre>\n\n<p>Depending on the other data, you might not want to work with integers though</p>\n\n<p>Edit: Oops someone was faster</p>\n"}], "owner": {"reputation": 13, "user_id": 5017205, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ED7iiye2qCI/AAAAAAAAAAI/AAAAAAAAAAA/vC8qoatCbb4/photo.jpg?sz=128", "display_name": "Samuel Martin", "link": "https://stackoverflow.com/users/5017205/samuel-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 42387178, "answer_count": 2, "score": 1, "last_activity_date": 1518801523, "creation_date": 1487753938, "last_edit_date": 1518801523, "question_id": 42386830, "link": "https://stackoverflow.com/questions/42386830/getting-the-cell-of-value-of-the-cell-with-min-value-in-a-range", "title": "Getting the cell of value of the Cell with Min Value in a Range", "body": "<p>I have a table with data similar to below</p>\n\n<pre><code>      A             B       C     D     E      \n1                 London    NY    LA  Chicago\n2 Population      11        18    16    12\n</code></pre>\n\n<p>I have the following code to get Max Value: (Sucessfully)</p>\n\n<pre><code>Dim Rng As Range\nDim Ray\nDim Max As Integer\nSet Rng = Range(Range(\"B2\"), Range(\"E2\").End(xlUp))\nRay = Rng.Value\nMax = Application.Max(Ray)\n</code></pre>\n\n<p>Then, I\u00b4m trying to get the column with the Max Value. My goal is to get \"C\" or C1 to be able to know that NY (C1) is the one with Max Value.</p>\n\n<p>I\u00b4ll try the following but it is not working</p>\n\n<pre><code>For Each cell In Rng\n If cell.Value = Max Then\n    MaxAddress = cell.Address\n    Exit For\n End If\nNext cell\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1487754147, "post_id": 42386793, "comment_id": 71922025, "body": "It is built in function or custom function? If it is custom function then use <code>Application.Volatile</code> beginning of the function. Better place your sample data and formula you used, then we can suggest you."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1487754129, "creation_date": 1487754129, "answer_id": 42386911, "question_id": 42386793, "link": "https://stackoverflow.com/questions/42386793/excel-formula-will-not-work-until-i-acess-a-cell-and-press-enter/42386911#42386911", "title": "Excel formula will not work until I acess a cell and press enter", "body": "<p>You could select the cells and use this:</p>\n\n<pre><code>Sub makeNumbersText()\n    With Selection\n        .Value2 = Evaluate(\"INDEX(\"\"'\"\"&amp;\" &amp; .Address &amp; \",)\")\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 108, "user_id": 7544899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a08095de2214b5b1391c057289eb4faa?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Vannier", "link": "https://stackoverflow.com/users/7544899/nicolas-vannier"}, "is_accepted": false, "score": 0, "last_activity_date": 1487754164, "creation_date": 1487754164, "answer_id": 42386927, "question_id": 42386793, "link": "https://stackoverflow.com/questions/42386793/excel-formula-will-not-work-until-i-acess-a-cell-and-press-enter/42386927#42386927", "title": "Excel formula will not work until I acess a cell and press enter", "body": "<p>This is because Excel is not handling your values as you want.</p>\n\n<p>In A1 cell, Excel is thinking that your value is a number, and the lookup formula is searching in a range where the key is a text.</p>\n\n<p>When you add an apostrophe, you are forcing the value to be handled as text, and the lookup is functioning well.</p>\n\n<p>You can try to use the \"convert\" feature in Excel to convert all keys to numbers in the lookup range.</p>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 42386911, "answer_count": 2, "score": 0, "last_activity_date": 1487754723, "creation_date": 1487753828, "question_id": 42386793, "link": "https://stackoverflow.com/questions/42386793/excel-formula-will-not-work-until-i-acess-a-cell-and-press-enter", "title": "Excel formula will not work until I acess a cell and press enter", "body": "<p>I have a funny problem in Excel. I have a cells (A1) with a number but with the cell formatted as text value. I have a cell (A2) with a lookup formula using A1 as a reference. The formula gives an error. To remove the error I find that I can do two things:</p>\n\n<p>1- I enter into A1 cells, I put the cursor at the end of the number and I press enter\n2- I add an apostrophe at the beginning of the number</p>\n\n<p>I tried other things, like changing the cell to number and back to text, copy and paste special, but I can not find another way to resolve this issue.</p>\n\n<p>I have hundreds of cells with this problem, therefore I would like to find a solution that prevents me to go into each cell to correct it manually</p>\n\n<p>Any ideas on how to overcome this problem? Is there any macro I could use?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1487754211, "post_id": 42386637, "comment_id": 71922064, "body": "When you select all the cells, there should be a little popup that alerts you that the numbers are stored as text (since the first cell is) and has an option to convert to numbers."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1487754382, "post_id": 42386637, "comment_id": 71922184, "body": "You can use function or copy and then paste special."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1487754692, "post_id": 42386637, "comment_id": 71922393, "body": "But if these are contract numbers (identifiers) then it may be better to store them as text, e.g. you may need the leading zeros in comparisons with data from other sources, and you are not going to add, subtract, multiply, divide and raise to power these numbers."}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "is_accepted": false, "score": 3, "last_activity_date": 1487754198, "creation_date": 1487754198, "answer_id": 42386938, "question_id": 42386637, "link": "https://stackoverflow.com/questions/42386637/column-type-conversion-in-excel-vba/42386938#42386938", "title": "Column Type Conversion in Excel VBA", "body": "<p>Try this</p>\n\n<pre><code>Sub ShivaGupta ()\n\n        Columns(\"nameofcolumn\").NumberFormat = \"0.00\"\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 1, "last_activity_date": 1487754490, "creation_date": 1487754490, "answer_id": 42387052, "question_id": 42386637, "link": "https://stackoverflow.com/questions/42386637/column-type-conversion-in-excel-vba/42387052#42387052", "title": "Column Type Conversion in Excel VBA", "body": "<p>If you are looking for an Excel formula, you may try this one:</p>\n\n<pre><code>=VALUE(A1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "is_accepted": false, "score": 1, "last_activity_date": 1487754671, "creation_date": 1487754671, "answer_id": 42387104, "question_id": 42386637, "link": "https://stackoverflow.com/questions/42386637/column-type-conversion-in-excel-vba/42387104#42387104", "title": "Column Type Conversion in Excel VBA", "body": "<p>tombata's answer seems a good way to go, however, you might also go through each with a <em>for</em> loop and convert each cell's <code>.value</code> using CInt() or CDouble() depending on your needs.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/s2dy91zy.aspx\" rel=\"nofollow noreferrer\">Type Conversion Functions</a></p>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 5182777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7826204353d38e61aa39839183a355e4?s=128&d=identicon&r=PG&f=1", "display_name": "Docmarti", "link": "https://stackoverflow.com/users/5182777/docmarti"}, "is_accepted": true, "score": 2, "last_activity_date": 1487757113, "creation_date": 1487757113, "answer_id": 42388100, "question_id": 42386637, "link": "https://stackoverflow.com/questions/42386637/column-type-conversion-in-excel-vba/42388100#42388100", "title": "Column Type Conversion in Excel VBA", "body": "<p>You can change the cells format to General before re-entering the values.</p>\n\n<pre><code> Sub tt()\n  col = \"A\"\n  lastRowIndex = Cells(Rows.Count, col).End(xlUp).Row\n  Set c = Range(Cells(1, col), Cells(lastRowIndex, col))\n  c.NumberFormat = \"\"\n  c.FormulaLocal = c.Value\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6769489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7204eec9abb45d918430b5afd4c9a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Gupta", "link": "https://stackoverflow.com/users/6769489/shiva-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4273, "favorite_count": 0, "accepted_answer_id": 42388100, "answer_count": 4, "score": 1, "last_activity_date": 1487757113, "creation_date": 1487753365, "last_edit_date": 1487753661, "question_id": 42386637, "link": "https://stackoverflow.com/questions/42386637/column-type-conversion-in-excel-vba", "title": "Column Type Conversion in Excel VBA", "body": "<p>I Want to convert entire column to the type(number)</p>\n\n<p><a href=\"https://i.stack.imgur.com/aqUql.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aqUql.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Example In the above image the some data are of type string and some are of type number I want all the data in the entire column as a type number.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1487752429, "post_id": 42386246, "comment_id": 71920856, "body": "Stack Overflow is not a code writing service. People come here with specific problems they have with their code. There are other sites which help you to learn how to code VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7603496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0b30912b433d2384cb08597c850d13?s=128&d=identicon&r=PG&f=1", "display_name": "skip", "link": "https://stackoverflow.com/users/7603496/skip"}, "edited": false, "score": 0, "creation_date": 1487870951, "post_id": 42390247, "comment_id": 71990395, "body": "Thanks for the help. I am new and apologise for misusing the website."}, {"owner": {"reputation": 1, "user_id": 7603496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0b30912b433d2384cb08597c850d13?s=128&d=identicon&r=PG&f=1", "display_name": "skip", "link": "https://stackoverflow.com/users/7603496/skip"}, "edited": false, "score": 1, "creation_date": 1487871362, "post_id": 42390247, "comment_id": 71990665, "body": "Thanks for the help. I am new and apologise for misusing the website. I have tried googling the different parts of the macro i require and unfortunately cannot find what I am looking for as all i find in google is how to copy and paste. I would have posted the code that ive tried typing but feared there were so many mistakes with it that it would be a waste of everyones time trying to decipher it.     I have tried the code you have so kindly provided for me and found that it does not work. i get error 1004. not sure exactly what this means."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1487904658, "post_id": 42390247, "comment_id": 72005115, "body": "Don&#39;t use select. I will post a change below regarding this but mark KoderM16&#39;s as correct as he helped you out first, I just pulled the select out and cleaned up the code."}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "reply_to_user": {"reputation": 1, "user_id": 7603496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0b30912b433d2384cb08597c850d13?s=128&d=identicon&r=PG&f=1", "display_name": "skip", "link": "https://stackoverflow.com/users/7603496/skip"}, "edited": false, "score": 0, "creation_date": 1487918995, "post_id": 42390247, "comment_id": 72009677, "body": "@skip just keep on working with vba and coding and soon you will start to read code like you read a book. I have only been in it for over a month or so and its starting to get easier."}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1487919055, "post_id": 42390247, "comment_id": 72009707, "body": "@DanDonoghue Thanks man! I saw the Select and Selection.PasteSpecial method somewhere else early on and I haven&#39;t been able to kick the habit lol"}], "tags": [], "owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "is_accepted": false, "score": 0, "last_activity_date": 1487763397, "creation_date": 1487763397, "answer_id": 42390247, "question_id": 42386246, "link": "https://stackoverflow.com/questions/42386246/cut-and-paste-values-from-sheet-1-to-the-next-available-row-on-sheet-2/42390247#42390247", "title": "Cut and paste values from sheet 1 to the next available row on sheet 2", "body": "<p>The below code will copy your range and look for the 1st empty cell (from the bottom up) in column E, Sheet 2, to paste. Hope this helps.</p>\n\n<pre><code>Sub CutPaste()\n\nDim Lastrow As Long\n\nThisWorkbook.Sheets(\"Sheet1\").Range(\"E5:H5\").Copy\nLastrow = Sheets(\"Sheet2\").Cells(Rows.Count, 5).End(xlUp).Offset(1, 0).Select\nSelection.PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>As you are new to Stack Overflow and probably vba as well, just try to adhere to the comment above by Peh. Your question, while not specifically, is easily googlable in parts. Also, if this answers your question, please tick it. </p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1487904900, "creation_date": 1487904900, "answer_id": 42429951, "question_id": 42386246, "link": "https://stackoverflow.com/questions/42386246/cut-and-paste-values-from-sheet-1-to-the-next-available-row-on-sheet-2/42429951#42429951", "title": "Cut and paste values from sheet 1 to the next available row on sheet 2", "body": "<p>Don't select. I post this answer more to help @KoderM16 improve their methods than to answer the original question:</p>\n\n<pre><code>Sub CutPaste()\nThisWorkbook.Sheets(\"Sheet1\").Range(\"E5:H5\").Copy\nSheets(\"Sheet2\").Cells(Rows.Count, 5).End(xlUp).Offset(1, 0).PasteSpecial\nEnd Sub\n</code></pre>\n\n<p>Also this doesn't make sense as it returns true or false (will most likely always be true because it can in fact select that address):</p>\n\n<pre><code>Lastrow = Sheets(\"Sheet2\").Cells(Rows.Count, 5).End(xlUp).Offset(1, 0).Select\n</code></pre>\n\n<p>You would want .row on the end instead of .select if you want to assign the row to <code>Lastrow</code>, you don't however then use <code>lastrow</code>.</p>\n\n<p>With your code as it is, lastrow would most likely always be -1 as that is the value for True</p>\n"}], "owner": {"reputation": 1, "user_id": 7603496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0b30912b433d2384cb08597c850d13?s=128&d=identicon&r=PG&f=1", "display_name": "skip", "link": "https://stackoverflow.com/users/7603496/skip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1487904900, "creation_date": 1487752094, "last_edit_date": 1487904342, "question_id": 42386246, "link": "https://stackoverflow.com/questions/42386246/cut-and-paste-values-from-sheet-1-to-the-next-available-row-on-sheet-2", "title": "Cut and paste values from sheet 1 to the next available row on sheet 2", "body": "<p>I am trying to cut and past values from a range of cells on sheet 1 to the next available row on sheet 2. All guides and advice I've seen has been for copying and pasting and for same sheet.</p>\n\n<p>Range on sheet 1 is E5-H5 to be cut, not copied, and then pasted to sheet 2, cells E7-H7 or the next available row below that as each time someone enters data I need sheet 2 to keep it.</p>\n"}, {"tags": ["vba", "excel", "keypress"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 23, "user_id": 7603393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15040d51736cf8efe7fd878db66d098?s=128&d=identicon&r=PG&f=1", "display_name": "Joliba", "link": "https://stackoverflow.com/users/7603393/joliba"}, "edited": false, "score": 0, "creation_date": 1487776671, "post_id": 42387549, "comment_id": 71937990, "body": "@Joliba Please mark this answer as solution, so other people can see that this question is solved."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1487756025, "last_edit_date": 1487756025, "creation_date": 1487755705, "answer_id": 42387549, "question_id": 42385854, "link": "https://stackoverflow.com/questions/42385854/vba-application-onkey-not-working/42387549#42387549", "title": "VBA: application.onkey not working", "body": "<p>You need to specify a key:</p>\n\n<ul>\n<li>For Enter on the numeric keypad use <code>Application.OnKey \"{ENTER}\", \"pressEnter\"</code></li>\n<li>For the normal Enter use <code>Application.OnKey \"~\", \"pressEnter\"</code> </li>\n</ul>\n\n<p>see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197461.aspx\" rel=\"nofollow noreferrer\">Application.OnKey Method (Excel)</a></p>\n\n<p>Be aware that other keys like <code>^+b</code> means <kbd>ctrl</kbd>+<kbd>shift</kbd>+<kbd>b</kbd>. Make sure that <code>Public Sub pressEnter()</code> is in a <strong>module</strong> and not in <code>ThisWorkbook</code>. If it doesn't work in <code>Workbook_Open()</code> try <code>Workbook_Activate()</code> instead.</p>\n"}], "owner": {"reputation": 23, "user_id": 7603393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15040d51736cf8efe7fd878db66d098?s=128&d=identicon&r=PG&f=1", "display_name": "Joliba", "link": "https://stackoverflow.com/users/7603393/joliba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1830, "favorite_count": 0, "accepted_answer_id": 42387549, "answer_count": 1, "score": 0, "last_activity_date": 1487756025, "creation_date": 1487750821, "last_edit_date": 1531164843, "question_id": 42385854, "link": "https://stackoverflow.com/questions/42385854/vba-application-onkey-not-working", "title": "VBA: application.onkey not working", "body": "<p>I'm on VBA with an apparently simple code, trying to create an event triggered by pressing Enter.\nSo here is my code in the workbook: </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n\n    Application.OnKey \"\", \"pressEnter\"\n\nEnd Sub\n</code></pre>\n\n<p>And what should be happen in the module:</p>\n\n<pre><code>Public Sub pressEnter()\n\n    ThisWorkbook.Worksheets(1).Cells(1, 1).Value = 20\n\nEnd Sub\n</code></pre>\n\n<p>However, when I press Enter/Return key, nothing happens. Just as with a normal Enter, it selects the cell inferior to the active one. I tried with other keys, such as <code>^+b</code> or <code>^+a</code>, and I have the same problem.</p>\n\n<p>Does someone see any solution ?</p>\n"}, {"tags": ["excel", "vba", "multiscreen"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1487752155, "post_id": 42385598, "comment_id": 71920690, "body": "I think it would be possible using Windows APIs to get this done but there is no VBA built in way to do this. <code>.WindowState = xlMaximized</code> always maximizes Excel on the Monitor which the window is placed. So you need to decide first if this is &quot;nice to have&quot; feature or a &quot; must have&quot; because there is no easy way."}, {"owner": {"reputation": 69, "user_id": 7374376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8512f4e50f5364749183384fe9e9510b?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/7374376/stefan"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1487752852, "post_id": 42385598, "comment_id": 71921107, "body": "Unfortunately that&#39;s a &quot;must have&quot;. But would be fine with a somehow &quot;quick and dirty&quot; solution.:-)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1487754451, "post_id": 42385598, "comment_id": 71922243, "body": "Thats what I tried to say there is no &quot;quick and dirty&quot;. But have a look at this answer <a href=\"http://stackoverflow.com/a/7241038/3219613\">stackoverflow.com/a/7241038/3219613</a> there are several code snippets for getting monitor information via Windows API."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1496588075, "creation_date": 1496588075, "answer_id": 44355394, "question_id": 42385598, "link": "https://stackoverflow.com/questions/42385598/how-to-maximize-a-window-on-a-specific-monitor-with-excel-vba/44355394#44355394", "title": "How to maximize a window on a specific monitor with Excel VBA?", "body": "<p>As mentioned in the comments you need to use Windows APIs; this is another (relatively simple to use) API that helped me determine if a user form was moved off the visible area of the screen(s): <strong>GetSystemMetrics</strong> Lib \"User32\"</p>\n\n<p>to declare the function based on the version of Office:</p>\n\n<pre><code>#If Win64 Then  'Win64=true, Win32=true, Win16= false\n    Private Declare PtrSafe Function apiGetSystemMetrics Lib \"User32\" Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n    Private Declare PtrSafe Function apiGetSystemMetrics32 Lib \"User32\" Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n#ElseIf Win32 Then  'Win32=true, Win16=false\n    Private Declare Function apiGetSystemMetrics Lib \"User32\" Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n#Else   ' Win16=true\n#End If\n</code></pre>\n\n<p>generic functions:</p>\n\n<pre><code>Public Function dllGetMonitors() As Long\n    Const SM_CMONITORS = 80\n    dllGetMonitors = apiGetSystemMetrics(SM_CMONITORS)\nEnd Function\n\n\n'The width of the virtual screen, in pixels.\n'The virtual screen is the bounding rectangle of all display monitors\n\nPublic Function dllGetHorizontalResolution() As Long\n    Const SM_CXVIRTUALSCREEN = 78\n    dllGetHorizontalResolution = apiGetSystemMetrics(SM_CXVIRTUALSCREEN)\nEnd Function\n\nPublic Function dllGetVerticalResolution() As Long\n    Const SM_CYVIRTUALSCREEN = 79\n    dllGetVerticalResolution = apiGetSystemMetrics(SM_CYVIRTUALSCREEN)\nEnd Function\n</code></pre>\n\n<p>.</p>\n\n<p>more info: <a href=\"http://msdn.microsoft.com/en-us/library/ms724385(VS.85).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ms724385(VS.85).aspx</a></p>\n\n<p>The function I used to determine if the form is off screen:</p>\n\n<pre><code>Private Sub checkOffScreen(ByRef frm)\n    Dim maxTop As Long, minLeft As Long, maxLeft As Long\n    Dim defaultOffset As Byte, monitors As Byte\n\n    monitors = celTotalMonitors.Value\n    defaultOffset = 11\n    minLeft = 0 - (frm.Width - defaultOffset)\n    If monitors = 1 And celScreenResolutionX.Value &gt; 1280 Then\n        maxTop = 1180 - defaultOffset\n        maxLeft = 1900 - defaultOffset\n    Else\n        maxTop = 750 - defaultOffset\n        maxLeft = (960 * monitors) - defaultOffset\n    End If\n    With frm\n        'If (celFormTop.Value &lt; 0 Or celFormTop.Value &gt; maxTop) Or _\n            (celFormLeft.Value &lt; minLeft Or celFormLeft.Value &gt; maxLeft) Then\n        'If .top &lt; 0 Or .top &gt; maxTop Or .Left &lt; minLeft Or .Left &gt; maxLeft Then\n        If celFormTop.Value &gt; maxTop Or celFormLeft.Value &gt; maxLeft Then\n            celFormTop = defaultOffset\n            celFormLeft = defaultOffset\n        End If\n        If .Top &gt; maxTop Or .left &gt; maxLeft Then\n            .Top = defaultOffset\n            .left = defaultOffset\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 9911121, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O2H1Mu4puDI/AAAAAAAAAAI/AAAAAAAADWc/AICL1MJZfD8/photo.jpg?sz=128", "display_name": "Eric Vaughn-Shobey", "link": "https://stackoverflow.com/users/9911121/eric-vaughn-shobey"}, "is_accepted": false, "score": 0, "last_activity_date": 1556129986, "creation_date": 1556129986, "answer_id": 55836327, "question_id": 42385598, "link": "https://stackoverflow.com/questions/42385598/how-to-maximize-a-window-on-a-specific-monitor-with-excel-vba/55836327#55836327", "title": "How to maximize a window on a specific monitor with Excel VBA?", "body": "<p>I don't know if Application.Right is an option, but I replaced 1200 with -1200 and that worked for me.</p>\n\n<pre><code>Application.WindowState = xlNormal\nApplication.Left = -1200\nApplication.WindowState = xlMaximized\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7374376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8512f4e50f5364749183384fe9e9510b?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/7374376/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5393, "favorite_count": 0, "accepted_answer_id": 44355394, "answer_count": 2, "score": 3, "last_activity_date": 1558678828, "creation_date": 1487749927, "last_edit_date": 1558678828, "question_id": 42385598, "link": "https://stackoverflow.com/questions/42385598/how-to-maximize-a-window-on-a-specific-monitor-with-excel-vba", "title": "How to maximize a window on a specific monitor with Excel VBA?", "body": "<p>I want to maximize a window on a specific screen using Excel VBA.</p>\n\n<p>I used this code:</p>\n\n<pre><code>With ActiveWindow\n    .WindowState = xlNormal\n    .Left = 1200\n    .WindowState = xlMaximized       \nEnd With\n</code></pre>\n\n<p>The code works if monitor 2 is right-hand to monitor 1. If it's the other way around, the approach fails (then I have to use -1200).</p>\n\n<p>This macro should work on different PCs, where I don't know how the systems are configured. Is there any possibility to detect how many monitors are attached and to directly address the respective monitor on which I want to maximize the window?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487750124, "post_id": 42385332, "comment_id": 71919607, "body": "Please put your code in <code>code</code> tags and start them on a new line when needed. This is very hard to read. Plus, I don&#39;t really see the relation between your input and output, <code>500</code> becomes <code>05:00</code> and <code>100</code> becomes <code>-50</code>? And do you use vb.net (as a vsto add-in) or excel vba?"}, {"owner": {"reputation": 1, "user_id": 7603257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jHJVzFewPzA/AAAAAAAAAAI/AAAAAAAAABk/jOF2gCb9cgs/photo.jpg?sz=128", "display_name": "Satyendra Babu", "link": "https://stackoverflow.com/users/7603257/satyendra-babu"}, "reply_to_user": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487750635, "post_id": 42385332, "comment_id": 71919862, "body": "sir, i am using excel vba and this is the requirement where input is 500 and output should be 05:00"}, {"owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487750929, "post_id": 42385332, "comment_id": 71920011, "body": "What problems do you get with your current code? What errors? What is the output now?"}, {"owner": {"reputation": 1, "user_id": 7603257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jHJVzFewPzA/AAAAAAAAAAI/AAAAAAAAABk/jOF2gCb9cgs/photo.jpg?sz=128", "display_name": "Satyendra Babu", "link": "https://stackoverflow.com/users/7603257/satyendra-babu"}, "reply_to_user": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487755742, "post_id": 42385332, "comment_id": 71923198, "body": "I am not able to find the logic for this time format pls help.."}, {"owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487756180, "post_id": 42385332, "comment_id": 71923590, "body": "If you convert the time you want to write to a DateTime object, then you can use this approach: <a href=\"http://stackoverflow.com/questions/5457069/excel-macro-how-can-i-get-the-timestamp-in-yyyy-mm-dd-hhmmss-format\" title=\"excel macro how can i get the timestamp in yyyy mm dd hhmmss format\">stackoverflow.com/questions/5457069/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7603257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jHJVzFewPzA/AAAAAAAAAAI/AAAAAAAAABk/jOF2gCb9cgs/photo.jpg?sz=128", "display_name": "Satyendra Babu", "link": "https://stackoverflow.com/users/7603257/satyendra-babu"}, "reply_to_user": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487758150, "post_id": 42385332, "comment_id": 71925080, "body": "sir provide me the separate method for this problem so that i can embed this method in my code"}, {"owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "edited": false, "score": 0, "creation_date": 1487758514, "post_id": 42385332, "comment_id": 71925360, "body": "No, I will not write your code for you. I can help you find the right way to do it, but you have to write it yourself, that is the only way to get better."}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "is_accepted": false, "score": 0, "last_activity_date": 1487760152, "creation_date": 1487760152, "answer_id": 42388921, "question_id": 42385332, "link": "https://stackoverflow.com/questions/42385332/split-the-numbers-into-time-block-format-in-vba-excel/42388921#42388921", "title": "Split the numbers into time block format in vba excel", "body": "<p>Sorry, I didn't see that excel does not provide it's own method to convert a string to a dateTime, but you can do this:</p>\n\n<p>To write the first to columns</p>\n\n<pre><code>private Sub getColStr(in as String) as string\n    return in(0)+in(1)+\":\"+in(2)+in(3)\nEnd Sub\n</code></pre>\n\n<p>The last two columns should be easy.</p>\n"}], "owner": {"reputation": 1, "user_id": 7603257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jHJVzFewPzA/AAAAAAAAAAI/AAAAAAAAABk/jOF2gCb9cgs/photo.jpg?sz=128", "display_name": "Satyendra Babu", "link": "https://stackoverflow.com/users/7603257/satyendra-babu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1487760152, "creation_date": 1487748972, "last_edit_date": 1531161705, "question_id": 42385332, "link": "https://stackoverflow.com/questions/42385332/split-the-numbers-into-time-block-format-in-vba-excel", "title": "Split the numbers into time block format in vba excel", "body": "<p>I have the the problem, like this</p>\n\n<pre><code>0    500   100   1.8\n500  800   50    1.6\n800  2300  125   3.2\n</code></pre>\n\n<p>*I want this format (<em>Split the numbers into time block format</em>) in given below:*</p>\n\n<pre><code>00:00  05:00  -50  1800\n00:00  05:00  -50  1800\n05:00  08:00  -50  1600\n\n08:00  23:00  -50  3200\n08:00  23:00  -50  3200\n08:00  23:00  -25  3200\n</code></pre>\n\n<p>and the code is given below:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim data As Variant\n    Dim iData As Long, datum As Long, iRow As Long\n    On Error Resume Next\n    With Range(\"A2\", Cells(Rows.Count, 1).End(xlUp))\n        data = .Resize(, 4).Value\n        iData = LBound(data)\n        Do\n            datum = data(iData, UBound(data, 2) - 1)\n            Do While datum &gt; 0\n                iRow = iRow + 1\n                .Cells(iRow).Resize(, 4) = Application.Index(data, iData, 0)\n                .Cells(iRow).Offset(, 3).Value = .Cells(iRow).Offset(, 3).Value * 1000\n                .Cells(iRow, UBound(data, 2) - 1).Value = -WorksheetFunction.Min(50, datum)\n                datum = datum - 50\n            Loop\n            iData = iData + 1\n        Loop While iData &lt;= UBound(data)\n        .Resize(1, 4).Copy\n        .Resize(iRow, 4).PasteSpecial xlPasteFormats\n        Application.CutCopyMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "average"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487747063, "post_id": 42384349, "comment_id": 71917961, "body": "Your line <code>dBT(k) = Application.AverageIf(d(r, COL_FT), (d(r, COL_AOI) = &quot;AOI Entry&quot;))</code> is taking the average of the value in the cell located in row <code>r+6</code>, column R, if that value is <code>True</code> (if the value in row <code>r+6</code>, column I, is <code>&quot;AOI Entry&quot;</code>) or <code>False</code> (if the value in row <code>r+6</code>, column I, is not <code>&quot;AOI Entry&quot;</code>).  That is always going to generate a division by zero error (as you have no <code>True</code> or <code>False</code> values), so that is undoubtedly creating your <code>#VALUE</code> error.  Usually an average is performed over more than one value - which values are you trying to average?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487747614, "post_id": 42384349, "comment_id": 71918243, "body": "Are you just trying to generate a VBA equivalent of a formula (in cell T7 for instance) of <code>=AVERAGEIFS($R:$R,$I:$I,&quot;AOI Entry&quot;,$B:$B,$B7,$C:$C,$C7)</code>?"}, {"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487748076, "post_id": 42384349, "comment_id": 71918478, "body": "@YowE3K I want the average of the values in Column R, but only those that are in rows that have &quot;AOI Entry&quot; in Column I. Are you saying the problem is with how I&#39;ve defined the inclusion criterion?"}, {"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487749065, "post_id": 42384349, "comment_id": 71919023, "body": "@YowE3K I don&#39;t want the formula in a cell, I want it to be keyed to the dictionary object, and the dictionary key should define which rows are included in the average."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487749403, "post_id": 42384349, "comment_id": 71919212, "body": "If you want to calculate the average in VBA (without referring back to the ranges in the worksheet), I think you will need to either calculate it manually (i.e. sum the values you need and divide by how many values you summed) or use an <code>Application.AverageIfs</code> using similar parameters to what you would use in Excel - but with each range (e.g. <code>R:R</code>) having to be a one-dimensional array - i.e. you won&#39;t be able to just use one &quot;slice&quot; of the <code>d</code> array, you will have to create the &quot;slice&quot; as a separate array."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487749542, "post_id": 42384349, "comment_id": 71919292, "body": "But if you were willing to refer back to the ranges in the worksheet, you could just use an <code>Application.AverageIfs</code> replacing the ranges in my sample formula with <code>Range(&quot;R:R&quot;)</code> instead of <code>R:R</code>, etc, and the first part of your key instead of <code>B7</code>, and the second part of your key instead of <code>C7</code>."}, {"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487749737, "post_id": 42384349, "comment_id": 71919408, "body": "@YowE3K The first option is not practical, as I have 35 such sheets to calculate, with varying numbers of rows. I don&#39;t know how to set up the ranges as you describe."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "edited": false, "score": 0, "creation_date": 1487823835, "post_id": 42400704, "comment_id": 71960567, "body": "Great answer and the code works. Except I want it to still print 0 if there are no AOI entries, so I&#39;ve changed  <code>If d(r, COL_AOI) = &quot;AOI Entry&quot; Then                 dBT(k(r)) = dBT(k(r)) + 1     &#39;get count                 Cnts(k(r)) = Cnts(k(r)) + 1   &#39;get count                 Sums(k(r)) = Sums(k(r)) + d(r, COL_FT)   &#39;sum column R</code> to  <code>If d(r, COL_AOI) = &quot;AOI Entry&quot; Then                 dBT(k(r)) = dBT(k(r)) + 1     &#39;get count             Else                 dBT(k(r)) = dBT(k(r)) + 0     &#39;get count</code> and now many averages are negative numbers. Not sure why."}, {"owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "edited": false, "score": 0, "creation_date": 1487828747, "post_id": 42400704, "comment_id": 71962476, "body": "nvm I think I fixed it. I put in an else statement for the average <code>&#39;Else                 &#39;Cnts(k(r)) = Cnts(k(r)) + 0   &#39;get count                 &#39;Sums(k(r)) = Sums(k(r)) + d(r, COL_FT)   &#39;sum column R</code> that I think was the cause. It&#39;s working alright without it."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1487792184, "creation_date": 1487792184, "answer_id": 42400704, "question_id": 42384349, "link": "https://stackoverflow.com/questions/42384349/averageif-function-results-in-value/42400704#42400704", "title": "AverageIf function results in &quot;#VALUE!&quot;", "body": "<p>Your current issue with the line</p>\n\n<pre><code>dBT(k) = Application.AverageIf(d(r, COL_FT), (d(r, COL_AOI) = \"AOI Entry\"))\n</code></pre>\n\n<p>is due to the fact that you are trying to take the average of a single value, and only if that value is <code>True</code> or <code>False</code>.  E.g. when <code>r</code> is 1, your code equates to</p>\n\n<pre><code>dbt(\"Block 1|Trial, 8\") = Application.AverageIf(-2484, (\"\" = \"AOI Entry\"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>dbt(\"Block 1|Trial, 8\") = Application.AverageIf(-2484, False)\n</code></pre>\n\n<p>As none of the values in the average range (i.e. the value <code>-2484</code>) matches the criteria (i.e. <code>False</code>), the function attempts to divide the sum of matching values (i.e. <code>0</code>) by the count of matching values (i.e. <code>0</code>) and errors out.</p>\n\n<p>Similarly, when <code>r</code> is 2, the code equates to</p>\n\n<pre><code>dbt(\"Block 1|Trial, 1\") = Application.AverageIf(31, (\"AOI Entry\" = \"AOI Entry\"))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>dbt(\"Block 1|Trial, 1\") = Application.AverageIf(31, True)\n</code></pre>\n\n<p>Again, <code>31</code> does not equal <code>True</code>, and you end up trying to divide 0 by 0.</p>\n\n<hr>\n\n<p>You would have got an answer (although not a meaningful answer) if you had used a formula of</p>\n\n<pre><code>dBT(k) = Application.AverageIf(d(r, COL_AOI), \"AOI Entry\", d(r, COL_FT))\n</code></pre>\n\n<p>which would have summed <code>d(r, COL_FT)</code> (the average range) if <code>d(r, COL_AOI)</code> (the range to test against the criteria) matched <code>AOI Entry\"</code> (the criteria).  (Summing a single number is a bit pointless, but it would still have done it.)  However, this would still have given a division by zero error when <code>d(r, COL_AOI)</code> was not <code>\"AOI Entry\"</code>, and would give a meaningless answer in the cases when it did work.</p>\n\n<hr>\n\n<p>To get a meaningful average, you need to divide a sum of values by a count of values.  Your code is not set up in a way that makes it easy to use Excel's built-in functions to calculate the sum and count, so you will need to calculate the sum and count yourself.</p>\n\n<p>In the following code I have added two dictionaries (one called <code>Sums</code>, and the other called <code>Cnts</code>) to keep track of those numbers.  The average can then be easily derived by dividing <code>Sums(k)</code> by <code>Cnts(k)</code>.</p>\n\n<p>I have also taken the liberty of changing your variable <code>k</code> to be an array.  Your current code was calculating the key in at least 8 positions, so I changed it to calculate it once, and then use the same value in each other position.</p>\n\n<pre><code>Dim dBT As Object 'global dictionary\n\nSub buttonpresscount()\n    Dim Sums As Object\n    Dim Cnts As Object\n\n    'constants for column positions\n    Const COL_BLOCK As Long = 1\n    Const COL_TRIAL As Long = 2\n    Const COL_ACT As Long = 7\n    Const COL_AOI As Long = 8\n    Const COL_RT As Long = 16\n    Const COL_FT As Long = 17\n\n    Dim rng As Range, lastrow As Long, sht As Worksheet\n    Dim d, r As Long, resBT()\n    Dim k() As String\n\n    Set sht = Worksheets(\"full test\")\n    lastrow = sht.Cells(Rows.Count, 3).End(xlUp).Row\n    Set dBT = CreateObject(\"scripting.dictionary\")\n    Set Sums = CreateObject(\"scripting.dictionary\")\n    Set Cnts = CreateObject(\"scripting.dictionary\")\n\n    Set rng = sht.Range(\"B7:T\" &amp; lastrow)\n\n    d = rng.Value  'get the data into an array\n\n    ReDim resBT(1 To UBound(d), 1 To 1) 'resize the array which will\n                                        '  be placed in ColT\n    ReDim k(1 To UBound(d, 1)) As String\n\n    'get unique combinations of Block and Trial and pressedcounts for each\n    For r = 1 To UBound(d, 1)\n        'Calculate the key once, then it can be used in every other loop\n        k(r) = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        dBT(k(r)) = dBT(k(r)) + IIf(d(r, COL_ACT) &lt;&gt; \"\", 1, 0)\n    Next r\n\n    'populate array with appropriate counts for each row\n    For r = 1 To UBound(d, 1)\n        resBT(r, 1) = dBT(k(r))        'get the count\n    Next r\n\n    'place array to sheet\n    sht.Range(\"T7\").Resize(UBound(resBT, 1), 1) = resBT\n\n    'clear dictionary\n    dBT.RemoveAll\n\n    'count AOI entries\n    For r = 1 To UBound(d, 1)\n        If resBT(r, 1) = 1 Then    'only proceed with trials with 1 button press\n            If d(r, COL_AOI) = \"AOI Entry\" Then\n                dBT(k(r)) = dBT(k(r)) + 1     'get count\n                Cnts(k(r)) = Cnts(k(r)) + 1   'get count\n                Sums(k(r)) = Sums(k(r)) + d(r, COL_FT)   'sum column R\n            End If\n        Else\n            dBT(k(r)) = \"\"\n        End If\n    Next r\n\n    'populate array with appropriate counts for each row\n    For r = 1 To UBound(d, 1)\n        resBT(r, 1) = dBT(k(r))          'get the count\n    Next r\n\n    'place array to sheet\n    sht.Range(\"U7\").Resize(UBound(resBT, 1), 1) = resBT\n\n    createsummarytable\n    PopSummaryAOI dBT\n\n    dBT.RemoveAll\n\n    'retrieve and print reaction times to data summary sheet\n    For r = 1 To UBound(d, 1)\n        If resBT(r, 1) &lt;&gt; \"\" Then 'if buttonpresscount = 1 and AOI count exists\n            dBT(k(r)) = d(r, COL_RT)\n        End If\n    Next r\n\n    'Populate array with last row reaction time for each trial\n    For r = 1 To UBound(d, 1)\n        resBT(r, 1) = dBT(k(r))          'get the count\n    Next r\n\n    PopSummaryRT dBT\n\n    dBT.RemoveAll\n\n    'work out avg fixation time per trial\n    For r = 1 To UBound(d, 1)\n        If resBT(r, 1) &lt;&gt; \"\" Then\n            If Cnts(k(r)) &lt; 1 Then\n                'Error if no results\n                dBT(k(r)) = CVErr(xlErrDiv0)\n            Else\n                'Determine average\n                dBT(k(r)) = Sums(k(r)) / Cnts(k(r))\n            End If\n        End If\n    Next r\n\n    'populate array\n    For r = 1 To UBound(d, 1)\n        resBT(r, 1) = dBT(k(r))          'get the count\n    Next r\n\n    PopSummaryFT dBT\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 6812290, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53873943d95d165ea7eb673dac492c48?s=128&d=identicon&r=PG&f=1", "display_name": "shecodes", "link": "https://stackoverflow.com/users/6812290/shecodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 42400704, "answer_count": 1, "score": 1, "last_activity_date": 1487792184, "creation_date": 1487745489, "question_id": 42384349, "link": "https://stackoverflow.com/questions/42384349/averageif-function-results-in-value", "title": "AverageIf function results in &quot;#VALUE!&quot;", "body": "<p>This is a screenshot of my data.<a href=\"https://i.stack.imgur.com/44pUN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/44pUN.png\" alt=\"data screenshot\"></a></p>\n\n<pre><code>Dim dBT As Object 'global dictionary\n\nSub buttonpresscount()\n\n    'constants for column positions\n    Const COL_BLOCK As Long = 1\n    Const COL_TRIAL As Long = 2\n    Const COL_ACT As Long = 7\n    Const COL_AOI As Long = 8\n    Const COL_RT As Long = 16\n    Const COL_FT As Long = 17\n\n    Dim rng As Range, lastrow As Long, sht As Worksheet\n    Dim d, r As Long, k, resBT()\n\n    Set sht = Worksheets(\"full test\")\n    lastrow = sht.Cells(Rows.Count, 3).End(xlUp).Row\n    Set dBT = CreateObject(\"scripting.dictionary\")\n\n    Set rng = sht.Range(\"B7:T\" &amp; lastrow)\n\n    d = rng.Value  'get the data into an array\n\n    ReDim resBT(1 To UBound(d), 1 To 1) 'resize the array which will\n                                        '  be placed in ColT\n\n    'get unique combinations of Block and Trial and pressedcounts for each\n    For r = 1 To UBound(d, 1)\n        k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        dBT(k) = dBT(k) + IIf(d(r, COL_ACT) &lt;&gt; \"\", 1, 0)\n    Next r\n\n    'populate array with appropriate counts for each row\n    For r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)         'get the count\n    Next r\n\n    'place array to sheet\n    sht.Range(\"T7\").Resize(UBound(resBT, 1), 1) = resBT\n\n    'clear dictionary\n    dBT.RemoveAll\n\n'count AOI entries\n For r = 1 To UBound(d, 1)\n        k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        If resBT(r, 1) = 1 Then    'only proceed with trials with 1 button press\n        dBT(k) = dBT(k) + IIf(d(r, COL_AOI) = \"AOI Entry\", 1, 0)    'get count\n        Else: dBT(k) = \"\"\n        End If\n    Next r\n\n    'populate array with appropriate counts for each row\n    For r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)          'get the count\n    Next r\n\n    'place array to sheet\n    sht.Range(\"U7\").Resize(UBound(resBT, 1), 1) = resBT\n\nCall createsummarytable\nCall PopSummaryAOI(dBT)\n\ndBT.RemoveAll\n\n'retrieve and print reaction times to data summary sheet\n   For r = 1 To UBound(d, 1)\n        If resBT(r, 1) &lt;&gt; \"\" Then 'if buttonpresscount = 1 and AOI count exists\n        k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n        dBT(k) = d(r, COL_RT)\n        End If\n    Next r\n\n 'Populate array with last row reaction time for each trial\n    For r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)          'get the count\n    Next r\n\nCall PopSummaryRT(dBT)\n\ndBT.RemoveAll\n\n'work out avg fixation time per trial\nFor r = 1 To UBound(d, 1)\n    If resBT(r, 1) &lt;&gt; \"\" Then\n    k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n    dBT(k) = Application.AverageIf(d(r, COL_FT), (d(r, COL_AOI) = \"AOI Entry\"))\n    End If\nNext r\n\n'populate array\nFor r = 1 To UBound(d, 1)\n        k = d(r, 1) &amp; \"|\" &amp; d(r, 2)   'create key\n        resBT(r, 1) = dBT(k)          'get the count\nNext r\n\nCall PopSummaryFT(dBT)\n\nEnd Sub\n</code></pre>\n\n<p>Referring to the above macro, the following lines of code are meant to work out an average of values in Column R per dict(key) (read: per trial):</p>\n\n<pre><code>For r = 1 To UBound(d, 1)\n    If resBT(r, 1) &lt;&gt; \"\" Then\n    k = d(r, COL_BLOCK) &amp; \"|\" &amp; d(r, COL_TRIAL) 'create key\n    dBT(k) = Application.AverageIf(d(r, COL_FT), (d(r, COL_AOI) = \"AOI Entry\"))\n    End If\nNext r\n</code></pre>\n\n<p>This is resulting in <code>#VALUE!</code> being printed in the relevant cells, rather than the expected number.</p>\n\n<p>screenshot:\n<a href=\"https://i.stack.imgur.com/aqeTV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aqeTV.png\" alt=\"enter image description here\"></a></p>\n\n<p>What is causing this? What is the correct way to code this formula?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1487745759, "post_id": 42384334, "comment_id": 71917283, "body": "When you close Excel then the connection object will go out of scope, but it&#39;s good practice to explicitly close it in your code."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1487752280, "post_id": 42384334, "comment_id": 71920766, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/19038350/11683\">When should an Excel VBA variable be killed or set to Nothing?</a>"}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1487755137, "post_id": 42384334, "comment_id": 71922707, "body": "This might interesting for you... <a href=\"http://stackoverflow.com/questions/3217014/how-to-securely-store-connection-string-details-in-vba?noredirect=1&amp;lq=1\" title=\"how to securely store connection string details in vba\">stackoverflow.com/questions/3217014/&hellip;</a> I use this method to connect to ADODB.Connection"}, {"owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "edited": false, "score": 0, "creation_date": 1487755440, "post_id": 42384334, "comment_id": 71922954, "body": "OK,thanks very much for your answers."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1487752447, "post_id": 42386193, "comment_id": 71920868, "body": "<code>Unfortunately VBA is not that intelligent to close every connection etc when an object goes out of scope</code> - on contrary, that is <a href=\"http://stackoverflow.com/a/19038890/11683\">exactly what VBA does</a>."}, {"owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "edited": false, "score": 0, "creation_date": 1487755548, "post_id": 42386193, "comment_id": 71923055, "body": "Thanks :) i think now i got the idea."}], "tags": [], "owner": {"reputation": 1320, "user_id": 2315991, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6e307d234c7226b7d0c1198236f21c31?s=128&d=identicon&r=PG", "display_name": "ThomasMX", "link": "https://stackoverflow.com/users/2315991/thomasmx"}, "is_accepted": true, "score": -1, "last_activity_date": 1487752417, "last_edit_date": 1487752417, "creation_date": 1487751932, "answer_id": 42386193, "question_id": 42384334, "link": "https://stackoverflow.com/questions/42384334/will-an-adodb-connection-be-closed-when-excel-is-closed/42386193#42386193", "title": "Will an ADODB connection be closed when Excel is closed?", "body": "<p>I believe if you don't explicitly close the connection, the connection will stay open even if excel exits.</p>\n\n<p>Unfortunately VBA is not that intelligent to close every connection etc when an object goes out of scope. But still, it it was, the best practice is to close every stream and connection, whenever you don't need it anymore, and of course, upon exiting/closing the workbook, it is a good idea to double-check whether the connection is open, and if so, close it. That just makes your application even more robust and reliable. </p>\n\n<p>So what I suggest to you is that you close the connection whenever some r/w operation is done. Don't just leave a connection open while the app is idle (because what if excel or the system freezes?). So keep it open just as long as necessarily needed, but to be sure make double-check in the <code>Workbook_BeforeClose</code> eventhandler. </p>\n"}], "owner": {"reputation": 59, "user_id": 7603027, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d33ecfb447ca6dcf76e598fe77fec8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Guoliangcai", "link": "https://stackoverflow.com/users/7603027/guoliangcai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 42386193, "answer_count": 1, "score": 0, "last_activity_date": 1487752417, "creation_date": 1487745407, "last_edit_date": 1531164843, "question_id": 42384334, "link": "https://stackoverflow.com/questions/42384334/will-an-adodb-connection-be-closed-when-excel-is-closed", "title": "Will an ADODB connection be closed when Excel is closed?", "body": "<p>I have a question about the ADODB.connection.</p>\n\n<p>I use ADODB connection to connect to Access in my Excel application. Do I need to close the connection manually, or will it be closed automatically when my Excel application is closed?</p>\n\n<p>If I need to do it manually, then when and where? Can I write the code in the Workbook_BeforeClose event? I open the connection in the Workbook_Open event, and the connection object is declared to be a global var.</p>\n\n<p><img src=\"https://i.stack.imgur.com/r9ZBH.png\" alt=\"\"></p>\n"}, {"tags": ["vba", "excel", "copy", "data-cleaning"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7602693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9cA4Ysc2f6M/AAAAAAAAAAI/AAAAAAAAFVo/KgfZ0xy75m0/photo.jpg?sz=128", "display_name": "Karan Thukral", "link": "https://stackoverflow.com/users/7602693/karan-thukral"}, "edited": false, "score": 0, "creation_date": 1487789766, "post_id": 42385034, "comment_id": 71946946, "body": "Thank you ClintB for the answer.  This is range of cells, This pattern will go on for 8000+ stations  (Station,B, AC)(1, 1, 27)(2,4696,4722)(3,9391,9417)(4,14086,14112)(5,18781,18807)(&zwnj;&#8203;6,23476,23502)(7,281&zwnj;&#8203;71,28197)......\t\t\t \t\t\t\t Is it possible to code the series like a loop or something?"}, {"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "reply_to_user": {"reputation": 1, "user_id": 7602693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9cA4Ysc2f6M/AAAAAAAAAAI/AAAAAAAAFVo/KgfZ0xy75m0/photo.jpg?sz=128", "display_name": "Karan Thukral", "link": "https://stackoverflow.com/users/7602693/karan-thukral"}, "edited": false, "score": 0, "creation_date": 1487804767, "post_id": 42385034, "comment_id": 71954806, "body": "You need some sort of identifier that a new station is starting. Is there a column that always has &quot;Station name:&quot; or something similar, you can then search for that. Work out the range between the first found station and the second found station, then set the range equal to the station name."}], "tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": false, "score": 0, "last_activity_date": 1487748005, "creation_date": 1487748005, "answer_id": 42385034, "question_id": 42384115, "link": "https://stackoverflow.com/questions/42384115/vba-copy-one-value-paste-it-down-the-row-for-fixed-number-of-times-and-then-re/42385034#42385034", "title": "VBA: Copy one value, paste it down the row for fixed number of times and then repeat", "body": "<p>To input the value all you need to do is:</p>\n\n<pre><code>Range(\"AC27:AC4720\") = Range(\"B1\")\n</code></pre>\n\n<p>No need to iterate over each row. </p>\n\n<p>The hardest part is working out the range that you need to copy it to. Which can be done many ways depending on how your file looks.</p>\n"}], "owner": {"reputation": 1, "user_id": 7602693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9cA4Ysc2f6M/AAAAAAAAAAI/AAAAAAAAFVo/KgfZ0xy75m0/photo.jpg?sz=128", "display_name": "Karan Thukral", "link": "https://stackoverflow.com/users/7602693/karan-thukral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487830394, "creation_date": 1487744577, "last_edit_date": 1531164843, "question_id": 42384115, "link": "https://stackoverflow.com/questions/42384115/vba-copy-one-value-paste-it-down-the-row-for-fixed-number-of-times-and-then-re", "title": "VBA: Copy one value, paste it down the row for fixed number of times and then repeat", "body": "<p>I am working on cleaning weather data available online on Canadian Government website. The problem sounds simple but unfortunately I couldn't get what I want via VBA.</p>\n\n<p>WHY DO I HAVE A PROBLEM?</p>\n\n<p>To clean data, I want to see if there is relationship between weather and moods.</p>\n\n<p>The data is divided in sections (i.e one section by station for one year). Each section of the data has daily weather information (365 rows, 366 for leap year) in tabular form. The station name is nowhere mentioned in that data. It is only mentioned in one cell at top of each section. So I want to copy the station name from the header section and paste it down the row for all the days.</p>\n\n<p>For-example:\nIf there are 8000 stations in canada that are monitoring weather data daily, then there will be 8000 sections of tables, each section will have daily weather data. </p>\n\n<p>Here's my query in steps:</p>\n\n<p>1) Copy one value of cell(cell B1) and paste it down the row 4694 times range(AC27:AC4720). 4694 covers 10 years +section headers, empty spaces.\n2) Move down one extra row (so leave AC4721 blank)\n3) Start the process again.\n     The function has repeat the process till the end of the file.</p>\n\n<p>Formula in simple language:</p>\n\n<p>continuing after blank space....</p>\n\n<p>the cell is at AC4722 now, relative to this cell the formula has to copy the value of B4696, repeat step (1) and step (2) of the query.</p>\n\n<p>In this way the next will AC9417, relative to this cell the formula has to copy the value of B9391, repeat step (1) and step (2) of the query.</p>\n\n<p>The difference between relation positions (AC27,B1), (AC4722,B4696), (AC9417,B9391) is always 26</p>\n\n<p>Please help.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1487744718, "post_id": 42383612, "comment_id": 71916767, "body": "Select the four rows and then use <code>Union select &#39;dummy &#39; + A, &#39;IDE&#39;, &#39;TRUE&#39;, &#39;FALSE&#39;</code>to add in the modified rows"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1487747495, "post_id": 42383612, "comment_id": 71918181, "body": "CopyFromRecordset is the quickest."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": false, "score": 2, "last_activity_date": 1487747051, "creation_date": 1487747051, "answer_id": 42384770, "question_id": 42383612, "link": "https://stackoverflow.com/questions/42383612/export-values-to-excel-ms-access/42384770#42384770", "title": "Export values to Excel MS Access", "body": "<p>I would suggest writing a query to select the data then union to that query the second dataset you want. Would look something like</p>\n\n<pre><code>SELECT A, B, C, D FROM tble\nUNION ALL\nSELECT \"PREFIX \" &amp; A, \"IDE\", TRUE, FALSE FROM table\n</code></pre>\n\n<p>Then output the result of this query to excel.</p>\n"}], "owner": {"reputation": 79, "user_id": 6346739, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1448060655502250/picture?type=large", "display_name": "Davey_31", "link": "https://stackoverflow.com/users/6346739/davey-31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487747051, "creation_date": 1487742388, "last_edit_date": 1487743612, "question_id": 42383612, "link": "https://stackoverflow.com/questions/42383612/export-values-to-excel-ms-access", "title": "Export values to Excel MS Access", "body": "<p>I have a table in MS Access having 4 rows with four columns A, B, C, D</p>\n\n<p>I want to export this records into an Excel sheet as follows,<br>\n<strong>Expected Output :</strong><br>\n8 rows in Excel<br>\n<strong>How Excel should be like</strong><br>\n4 rows will be queried from table<br>\nA clone of each row but with Column A prefixed with text 'Dummy'<br>\nOther column values for the cloned rows are constant<br>\n<strong>Example :</strong>  </p>\n\n<ul>\n<li>Table :</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/1YSN9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1YSN9.png\" alt=\"Table\"></a>    </p>\n\n<ul>\n<li>How Excel to be exported :</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/1HCZi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1HCZi.png\" alt=\"Expected outcome\"></a>  </p>\n\n<p>Each row has been cloned with only column A prefixed with text and rest of the column values are constant  </p>\n\n<p>I have few options to achieve in form through VBA and would like to hear which one would be optimised way  </p>\n\n<ol>\n<li>-Write a Query to select table values,<br>\n-Create a temp table (clone the structure of existing table)<br>\n-Loop through the Record-set which has queried values<br>\n-Fill the Temp table's first column value with Record-set's A column value with prefixed harcoded text and other column values are hardcoded as well<br>\n-append two table and export into Excel  </li>\n<li><p>-Query from table and export into Excel<br>\n-Loop through table and fill Excel cell A6 with tables field(1) with prefix  </p></li>\n<li><p>-Query from table and export into Excel<br>\n-Append the excel with hardcoded values for additional 4 rows (not sure append is possible)  </p></li>\n</ol>\n\n<p>Please suggest which way is possible and happy to hear other options I miss.(Never used MS Access before and this is my first hands on. Based on tutorials I got through, I come with above options)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1132, "user_id": 6670570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EP3bp.jpg?s=128&g=1", "display_name": "Matts", "link": "https://stackoverflow.com/users/6670570/matts"}, "edited": false, "score": 0, "creation_date": 1487744737, "post_id": 42383457, "comment_id": 71916778, "body": "You could use Split to separate the multiline text, and Left to get the first 2 letters. To find the prefix you could use the Select ... Case function or multiple if statements if you prefer."}, {"owner": {"reputation": 13, "user_id": 7602754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lBEZZ.jpg?s=128&g=1", "display_name": "sapna", "link": "https://stackoverflow.com/users/7602754/sapna"}, "reply_to_user": {"reputation": 1132, "user_id": 6670570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EP3bp.jpg?s=128&g=1", "display_name": "Matts", "link": "https://stackoverflow.com/users/6670570/matts"}, "edited": false, "score": 0, "creation_date": 1487745319, "post_id": 42383457, "comment_id": 71917049, "body": "thanks matts, I am novice to macro making could you please help me out"}, {"owner": {"reputation": 1132, "user_id": 6670570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EP3bp.jpg?s=128&g=1", "display_name": "Matts", "link": "https://stackoverflow.com/users/6670570/matts"}, "edited": false, "score": 0, "creation_date": 1487746031, "post_id": 42383457, "comment_id": 71917428, "body": "sure I can help, but please research and attempt to write the code yourself."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7602754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lBEZZ.jpg?s=128&g=1", "display_name": "sapna", "link": "https://stackoverflow.com/users/7602754/sapna"}, "edited": false, "score": 0, "creation_date": 1487750775, "post_id": 42384382, "comment_id": 71919933, "body": "thanks Fadi what to use in case if none of my selection is present in mutliline text and I want first line to be pasted in NEW column"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1487745605, "creation_date": 1487745605, "answer_id": 42384382, "question_id": 42383457, "link": "https://stackoverflow.com/questions/42383457/excel-macro-multiline-find-condition-and-insert/42384382#42384382", "title": "Excel Macro multiline find-condition-and insert", "body": "<p>Try:</p>\n\n<pre><code>Sub test()\n\nDim colNum As Long\n   colNum = ActiveSheet.Rows(1).Find(What:=\"Range\", LookAt:=xlWhole).Column\n    ActiveSheet.Columns(colNum + 1).Insert\n    ActiveSheet.Cells(1, colNum + 1).Value = \"NEW\"          \n\n\n Dim Arr As Variant\n Dim Lr As Long, R As Long\n Dim i As Long, n As Long\n Dim V As String, F As String\n\n Lr = Cells(Rows.Count, colNum).End(xlUp).Row     \n Arr = Array(\"DS\", \"FP\", \"NP\", \"HE\")\n\n For R = 2 To Lr\n    V = Cells(R, colNum).Value\n    For i = 0 To UBound(Arr)\n     n = InStr(V, Arr(i))\n     If n &lt;&gt; 0 Then\n      F = Mid(V, n)\n      If InStr(F, vbLf) &lt;&gt; 0 Then F = Split(F, vbLf)(0)\n      Cells(R, colNum + 1).Value = F\n      Exit For\n     End If\n    Next\n Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7602754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lBEZZ.jpg?s=128&g=1", "display_name": "sapna", "link": "https://stackoverflow.com/users/7602754/sapna"}, "edited": false, "score": 0, "creation_date": 1487750762, "post_id": 42385098, "comment_id": 71919927, "body": "thanks mohit what to use in case if none of my selection is present in mutliline text and I want first line to be pasted in NEW column"}, {"owner": {"reputation": 588, "user_id": 6897492, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50889f9fb83f9a62eaec9df63aeb726?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/6897492/mohit"}, "reply_to_user": {"reputation": 13, "user_id": 7602754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lBEZZ.jpg?s=128&g=1", "display_name": "sapna", "link": "https://stackoverflow.com/users/7602754/sapna"}, "edited": false, "score": 0, "creation_date": 1487754116, "post_id": 42385098, "comment_id": 71922000, "body": "I have edited the code above for this only u need to set the 1st line in the starting only so if match is found then the col value will change otherwise it will be the 1st line from Range"}], "tags": [], "owner": {"reputation": 588, "user_id": 6897492, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50889f9fb83f9a62eaec9df63aeb726?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/6897492/mohit"}, "is_accepted": true, "score": 1, "last_activity_date": 1487754060, "last_edit_date": 1487754060, "creation_date": 1487748185, "answer_id": 42385098, "question_id": 42383457, "link": "https://stackoverflow.com/questions/42383457/excel-macro-multiline-find-condition-and-insert/42385098#42385098", "title": "Excel Macro multiline find-condition-and insert", "body": "<p>You can use the below code which I have tested on the test case you provided and its working fine.</p>\n\n<pre><code>Sub Test()\n    Dim colNum As Integer\n    colNum = ActiveSheet.Rows(1).Find(What:=\"Range\", LookAt:=xlWhole).Column\n    ActiveSheet.Columns(colNum + 1).Insert\n    ActiveSheet.Cells(1, colNum + 1).Value = \"NEW\"\n\n    'counting no of rows\n    Dim No_Of_Rows As Long\n    No_Of_Rows = ActiveSheet.UsedRange.Rows.Count\n\n    Dim Range_col_val As Variant\n    Dim split_Range_col As Variant\n    Dim Range_splited_cell_val As Variant\n    Dim Prefix As Variant\n        Prefix = Array(\"DS\", \"FP\", \"NP\", \"HE\")\n    Dim FLAG As Boolean\n    Dim j As Integer\n\n\n\n    'Looping for rows\n\n    For i = 2 To No_Of_Rows\n\n        'Extracting Data from col Range\n\n        Range_col_val = Cells(i, colNum).Value\n        split_Range_col = Split(Range_col_val, vbLf)\n        j = 0\n        ActiveSheet.Cells(i, colNum + 1).Value = split_Range_col(0)\n        FLAG = False\n        While FLAG = False And j &lt; 5\n            'Looping for Each Line in Col Range\n            For k = LBound(split_Range_col) To UBound(split_Range_col)\n                Range_splited_cell_val = split_Range_col(k)\n                If (Range_splited_cell_val Like Prefix(j) &amp; \"*\") Then\n                    ActiveSheet.Cells(i, colNum + 1).Value = Range_splited_cell_val\n                    FLAG = True\n                End If\n            Next k\n            j = j + 1\n        Wend\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Edited the code to write 1st line if none of the selections work. </p>\n"}], "owner": {"reputation": 13, "user_id": 7602754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lBEZZ.jpg?s=128&g=1", "display_name": "sapna", "link": "https://stackoverflow.com/users/7602754/sapna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 42385098, "answer_count": 2, "score": 2, "last_activity_date": 1487754060, "creation_date": 1487741680, "last_edit_date": 1487746597, "question_id": 42383457, "link": "https://stackoverflow.com/questions/42383457/excel-macro-multiline-find-condition-and-insert", "title": "Excel Macro multiline find-condition-and insert", "body": "<p>i have an excelsheet column 'Ranges' wherein i have multiline text in random order. I need to find specific prefix in multiline text and paste it next column.</p>\n\n<p>Objective is to find Prefix in order of DS>FP>NP>HE and so on wherein if DS prefix is not present FP is taken and so on.</p>\n\n<p>Sample sheet result looks like following:-</p>\n\n<p><a href=\"https://i.stack.imgur.com/xHBVW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xHBVW.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have following code till now please help me to solve this assignment:-</p>\n\n<pre><code>Sub Rangess()\n\n   Dim colNum As Integer\n   colNum = ActiveSheet.rows(1).Find(What:=\"Range\", LookAt:=xlWhole).Column\n    ActiveSheet.Columns(colNum + 1).Insert\n    ActiveSheet.Cells(1, colNum + 1).Value = \"NEW\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "reference", "row"], "answers": [{"comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1487736531, "post_id": 42382534, "comment_id": 71913847, "body": "This sub will select rows taking input from <code>Inputbox()</code> Then adjust this sub with your codes."}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1487736449, "creation_date": 1487736449, "answer_id": 42382534, "question_id": 42382405, "link": "https://stackoverflow.com/questions/42382405/row-reference-in-inputbox/42382534#42382534", "title": "Row reference in InputBox?", "body": "<p>Use following sub to select rows using <code>inputbox</code></p>\n\n<pre><code>Sub SelectRow()\n    Dim lnRow As Long\n     lnRow = InputBox(\"Enter Row number.\", \"Row Input\")\n    Rows(lnRow &amp; \":\" &amp; lnRow).Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1487736654, "creation_date": 1487736654, "answer_id": 42382566, "question_id": 42382405, "link": "https://stackoverflow.com/questions/42382405/row-reference-in-inputbox/42382566#42382566", "title": "Row reference in InputBox?", "body": "<p>If you need a <code>Range</code> from user input, the simplest way is to use the Excel version <code>Application.InputBox</code> with a type of '8' (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839468.aspx\" rel=\"nofollow noreferrer\">see the documentation here</a>).</p>\n\n<pre><code>Dim TargetRow As Range\nSet TargetRow = Application.InputBox(\"Select the row where data should be inserted.\", _\n                                     \"All Industries Row\", , , , , , 8)\nDebug.Print TargetRow.Address\n</code></pre>\n\n<p>Note that you should probably also get rid of the <code>Select</code> and <code>Activate</code> calls and use your object references directly.</p>\n"}], "owner": {"reputation": 23, "user_id": 7602432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8e637f7739d7fba79aaccd9af64eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Luke L", "link": "https://stackoverflow.com/users/7602432/luke-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1487736654, "creation_date": 1487735621, "question_id": 42382405, "link": "https://stackoverflow.com/questions/42382405/row-reference-in-inputbox", "title": "Row reference in InputBox?", "body": "<p>here's the code I currently have in VBA (Excel) at the moment. Most of it has come from macro recordings that I've made. What I'm looking for is to be able to insert for example, row 10 as just 10 in the inputbox without having to put it in as 10:10. Is there a way for me to edit my current code to allow this? I've tried using Rows(\"TargetRow:TargetRow\") but that gives odd results.</p>\n\n<pre><code>Dim TargetRow As Variant\nTargetRow = InputBox(\"Insert row # where data should be inserted. This should take the format XX:XX (e.g. 90:90 for row 90)\", \"All Industries Row\", \"XX:XX\")\n\nwbThis = ThisWorkbook.Name\nWindows(wbThis).Activate\n    Rows(TargetRow).Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromAbove\n\nWindows(\"otherworksheet.xlsx\").Activate\n    Range(\"A119:J119\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(wbThis).Activate\n    Range(TargetRow).Select\n    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n        xlNone, SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1487766506, "post_id": 42384183, "comment_id": 71930369, "body": "I believe this will work.  I&#39;ll try it when I get to the office.  Thanks!!"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1487782985, "post_id": 42384183, "comment_id": 71942668, "body": "You know, that worked fine in my test sample, but I can&#39;t get it working in my actual SharePoint site.  The HTMLDoc_Main.body.innerHTML is too big to fit in a cell and way to big to view in the Immediate Window.  I want to look for this text in the parent URL: &#39;Upload Questionnaire&#39; and copy/paste the following into cell C2:  href=&quot;<a href=\"https://blah_blah/SitePages/blah_blah_blah_TaskListHome.aspx\" rel=\"nofollow noreferrer\">blah_blah/SitePages/blah_blah_blah_TaskListHome.aspx</a>&quot;. It should be &#39;TD class=ms-vb&#39;, but it seems like the script can&#39;t find that..  Any ideas?"}], "tags": [], "owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "is_accepted": false, "score": 2, "last_activity_date": 1487744854, "creation_date": 1487744854, "answer_id": 42384183, "question_id": 42382006, "link": "https://stackoverflow.com/questions/42382006/how-can-i-import-data-from-a-child-url/42384183#42384183", "title": "How can I import data from a child URL?", "body": "<p>Good try on the code, got it pretty close- the one area that needs some fixing is when you try and get the list of items and loop it. You had the right idea on how it would work, but the HTML element syntaxes a little off so looks like just need some more experience using HTML objects... see sample code below:</p>\n\n<pre><code>Public Sub sampleCode()\nDim URL As String\nDim XMLHTTP As MSXML2.XMLHTTP60\nDim HTMLDoc_Main As HTMLDocument\nDim HTMLDoc_Secondary As HTMLDocument\nDim targetTable As HTMLObjectElement\nDim links As IHTMLElementCollection\nDim linkCounter As Long\n\nDim searchText As String\n\nURL = \"http://www.sharenet.co.za/v3/q_sharelookup.php\"\nsearchText = \"Building &amp; Construction Materials\"\n\nSet XMLHTTP = New MSXML2.XMLHTTP60\nSet HTMLDoc_Main = New HTMLDocument\nWith XMLHTTP\n    .Open \"GET\", URL, False\n    .send\n    While .readyState &lt;&gt; 4: Wend\n    HTMLDoc_Main.body.innerHTML = .responseText\nEnd With\n\nSet targetTable = HTMLDoc_Main.getElementsByClassName(\"dataTable\")(0)\nSet links = targetTable.getElementsByTagName(\"a\")\nFor linkCounter = 0 To links.Length - 1\n    With links(linkCounter)\n        If InStr(1, .innerText, searchText) &gt; 0 Then\n            Set XMLHTTP = New MSXML2.XMLHTTP60\n            Set HTMLDoc_Secondary = New HTMLDocument\n            XMLHTTP.Open \"GET\", .href, False\n            XMLHTTP.send\n            While XMLHTTP.readyState &lt;&gt; 4: Wend\n            HTMLDoc_Secondary.body.innerHTML = XMLHTTP.responseText\n            'Parse HTMLDoc_Secondary\n        End If\n    End With\nNext\n\nSet XMLHTTP = Nothing\nSet HTMLDoc_Main = Nothing\nSet HTMLDoc_Secondary = Nothing\nEnd Sub\n</code></pre>\n\n<p>Couple notes- 1) I used XMLHTTPRequest instead of IE as it is faster so 2) you are going to need to add 'Microsoft HTML Object Library' and 'Microsoft XML, v6.0' to your references and 3) I can see you are outputting to ranges in your original code- if at all possible this should be avoided. Populate an array and then dump its entire contents out into your target sheet all at once to save time...</p>\n\n<p>Hope this helps,\nTheSilkCode</p>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487778657, "creation_date": 1487733109, "last_edit_date": 1531164843, "question_id": 42382006, "link": "https://stackoverflow.com/questions/42382006/how-can-i-import-data-from-a-child-url", "title": "How can I import data from a child URL?", "body": "<p>I thought I figured this out over the weekend, but it actually doesn't work the way I thought it would.  I have a confidential corporate SharePoint site that I work with.  I can't post the link here, or any specific data, but the concept below will illustrate the point fine.</p>\n\n<p>I have a parent URL that I want to import data from.  Let's say this is the parent URL.</p>\n\n<p><a href=\"http://www.sharenet.co.za/v3/q_sharelookup.php\" rel=\"nofollow noreferrer\">http://www.sharenet.co.za/v3/q_sharelookup.php</a></p>\n\n<p>From there, I want to import data from a specific link.  Let's say this is the link:  'Building &amp; Construction Materials'</p>\n\n<p>I think the best way to do this is some kind of InStr() function and search for the string.  Then, if found, click the link and open the child URL.  When the child URL opens, it looks something like this:</p>\n\n<p><a href=\"http://www.sharenet.co.za/v3/sharesfound.php?ssector=2353&amp;exch=JSE&amp;bookmark=Building%20&amp;%20Construction%20Materials&amp;scheme=default\" rel=\"nofollow noreferrer\">http://www.sharenet.co.za/v3/sharesfound.php?ssector=2353&amp;exch=JSE&amp;bookmark=Building%20&amp;%20Construction%20Materials&amp;scheme=default</a></p>\n\n<p>I can't tell what the sector numbers will be ahead of time, so I can't use a specific URL.  I need to reference it as the parent and child, or maybe IE1 and IE2.  I want to import all data from the child URL, which in this example, looks like this.</p>\n\n<pre><code>Name    Full Name   Code    Sector\n BUILDMX     BUILDMAX LIMITED       BDM     2353\n KAYDAV      KAYDAV GROUP LTD       KDV     2353\n AFRIMAT     AFRIMAT LTD    AFT     2353\n Trellidor       Trellidor Hldgs Ltd    TRL     2353\n MASONITE    MASONITE (AFRICA) LIMITED      MAS     2353\n DAWN    DISTRIBUTION AND WAREHOUSING NETWORK LIMITED       DAW     2353\n MAZOR       MAZOR GROUP LTD    MZR     2353\n PPC     PPC LIMITED    PPC     2353\n PPCN    PPC Limited NPL    PPCN    2353\n</code></pre>\n\n<p>Just to demonstrate how I tried to solve this, I tried the script below.  </p>\n\n<pre><code>Sub ListLinks()\n\n'Set a reference to microsoft Internet Controls\nDim IeApp As InternetExplorer\nDim sURL As String\nDim IeDoc As Object\nDim i As Long\n\nSet IeApp = New InternetExplorer\n\nIeApp.Visible = True\n\nsURL = \"http://www.sharenet.co.za/v3/q_sharelookup.php\"\n\nIeApp.Navigate sURL\n\nDo\nLoop Until IeApp.ReadyState = READYSTATE_COMPLETE\nSet IeDoc = IeApp.Document\n\nFor i = 0 To IeDoc.Links.Length - 1\n    Cells(i + 1, 1).Value = IeDoc.Links(i).href\nNext i\n\nSet IeApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>I thought it would work fine, to list all URLs, and then loop through each to import data, but the problem on my SharePoint site is that the href doesn't appear to have any relevance to the name of the hyperlink.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/VWx1e.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VWx1e.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>In the picture above you can see 'Building &amp; Construction Materials' in the TD element.  If I can reference that in the 1st browser, and click the correct link to open a 2nd browser, and then reference that 2nd browser and scrape all TD elements from that, everything should work fine.  Does anyone here know how to do that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1487731699, "post_id": 42381302, "comment_id": 71912535, "body": "you can Group the controls <a href=\"http://www.excelforcommerce.com/grouping-checkboxes-in-excel/\" rel=\"nofollow noreferrer\">excelforcommerce.com/grouping-checkboxes-in-excel</a> (or put them in a Group Box control) and then something like <code>ActiveSheet.Shapes(&quot;Group 1&quot;).Visible = (ActiveSheet.OptionButtons(&quot;FU_PA_NotAttendingEAL&quot;).Value = 1)</code>"}, {"owner": {"reputation": 11, "user_id": 5451095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd878121aecfb7f48baecdb5a50f749?s=128&d=identicon&r=PG&f=1", "display_name": "J.P.M.", "link": "https://stackoverflow.com/users/5451095/j-p-m"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1487783867, "post_id": 42381302, "comment_id": 71943264, "body": "Perfect! That did the trick, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5451095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd878121aecfb7f48baecdb5a50f749?s=128&d=identicon&r=PG&f=1", "display_name": "J.P.M.", "link": "https://stackoverflow.com/users/5451095/j-p-m"}, "edited": false, "score": 0, "creation_date": 1487782811, "post_id": 42381432, "comment_id": 71942537, "body": "You&#39;re right, I meant for the second half of the IF statement to toggle the checkboxes to False. edited the original."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1487783076, "last_edit_date": 1487783076, "creation_date": 1487729304, "answer_id": 42381432, "question_id": 42381302, "link": "https://stackoverflow.com/questions/42381302/for-each-checkbox-in-array/42381432#42381432", "title": "For each Checkbox in Array", "body": "<p>EDIT: updated to reflect your changes</p>\n\n<pre><code>Sub FU_EAL_PA_Toggle()\n\n    Dim cb As CheckBox\n    Dim bOK as Boolean\n    Dim MyCheckboxes As Variant\n    MyCheckboxes = Array( _\n        \"FU_EAL_PA1\", _\n        \"FU_EAL_PA2\", _\n        \"FU_EAL_PA3\", _\n        \"FU_EAL_PA4\", _\n        \"FU_EAL_PA5\", _\n        \"FU_EAL_PA6\", _\n        \"FU_EAL_PA7\", _\n        \"FU_EAL_PA8\", _\n        \"FU_EAL_PA8\", _\n        \"FU_EAL_PA9\", _\n        \"FU_EAL_PA10\")\n\n    bOK = (ActiveSheet.OptionButtons(\"FU_PA_NotAttendingEAL\").Value = 1)\n\n    For Each cb In MyCheckboxes\n        With ActiveSheet.CheckBoxes(cb)\n                .Enabled = bOK\n                .Visible = bOK\n        End With\n    Next cb\n\n    'or without the array...\n    For x = 1 To 10\n        With ActiveSheet.CheckBoxes(\"FU_EAL_PA\" &amp; x)\n                .Enabled = bOK\n                .Visible = bOK\n        End With\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5451095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd878121aecfb7f48baecdb5a50f749?s=128&d=identicon&r=PG&f=1", "display_name": "J.P.M.", "link": "https://stackoverflow.com/users/5451095/j-p-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1487784169, "creation_date": 1487784169, "answer_id": 42398269, "question_id": 42381302, "link": "https://stackoverflow.com/questions/42381302/for-each-checkbox-in-array/42398269#42398269", "title": "For each Checkbox in Array", "body": "<p>I was able to find a workaround (BUT: Read to the bottom, because there's an easier way):</p>\n\n<p>Rather than build an array to manage my grouping, I realized my naming convention was sufficient to allow for grouping: </p>\n\n<pre><code>Public Sub FU_EAL_PA_ToggleNew()\n\nDim cb As CheckBox\n\nIf ActiveSheet.OptionButtons(\"FU_PA_NotAttendingEAL\").Value = 1 Then\n    For Each cb In ActiveSheet.CheckBoxes\n        If Left(cb.Name, 9) = \"FU_EAL_PA\" Then\n            cb.Visible = True\n            cb.Enabled = True\n        End If\n    Next cb\nElse\n    For Each cb In ActiveSheet.CheckBoxes\n        If Left(cb.Name, 9) = \"FU_EAL_PA\" Then\n            cb.Visible = False\n            cb.Enabled = False\n        End If\n    Next cb\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>BUT, Slai's response above was WAY simpler:</p>\n\n<blockquote>\n  <p>you can Group the controls [excelforcommerce.com/grouping-checkboxes-in-excel][1] (or put them in a Group Box control) and then something like:</p>\n</blockquote>\n\n<pre><code>ActiveSheet.Shapes(\"FU_EAL_PA\").Visible = _\n(ActiveSheet.OptionButtons(\"FU_PA_NotAttendingEAL\").Value = 1)\n</code></pre>\n\n<p>Which I did, and it worked exactly as intended. </p>\n\n<p>Thank you!</p>\n"}], "owner": {"reputation": 11, "user_id": 5451095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd878121aecfb7f48baecdb5a50f749?s=128&d=identicon&r=PG&f=1", "display_name": "J.P.M.", "link": "https://stackoverflow.com/users/5451095/j-p-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487784169, "creation_date": 1487728455, "last_edit_date": 1531164843, "question_id": 42381302, "link": "https://stackoverflow.com/questions/42381302/for-each-checkbox-in-array", "title": "For each Checkbox in Array", "body": "<p>I'm trying to hide a bunch of checkboxes based on an option button, but I keep getting \"error 1004: Application-defined or object-defined error\":</p>\n\n<pre><code>Sub FU_EAL_PA_Toggle()\nDim cb As CheckBox\nDim MyCheckboxes As Variant\nMyCheckboxes = Array( _\n    \"FU_EAL_PA1\", _\n    \"FU_EAL_PA2\", _\n    \"FU_EAL_PA3\", _\n    \"FU_EAL_PA4\", _\n    \"FU_EAL_PA5\", _\n    \"FU_EAL_PA6\", _\n    \"FU_EAL_PA7\", _\n    \"FU_EAL_PA8\", _\n    \"FU_EAL_PA8\", _\n    \"FU_EAL_PA9\", _\n    \"FU_EAL_PA10\")\n\nIf ActiveSheet.OptionButtons(\"FU_PA_NotAttendingEAL\").Value = 1 Then\n    For Each cb In ActiveSheet.CheckBoxes(MyCheckboxes)\n        With ActiveSheet.CheckBoxes(MyCheckboxes)\n            .Enabled = True\n            .Visible = True\n        End With\n    Next cb\nElse\n    For Each cb In ActiveSheet.CheckBoxes(MyCheckboxes)\n        With ActiveSheet.CheckBoxes(MyCheckboxes)\n            .Enabled = False\n            .Visible = False\n        End With\n    Next cb\nEnd If\n\nEnd Sub\n</code></pre>\n\n<ol>\n<li>Is there a better way of doing this? (Note that I will be repeating this code for another subset of buttons, so I can't just cycle through all the controls on the sheet).</li>\n<li>What am I doing wrong here? </li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487729100, "post_id": 42381241, "comment_id": 71911838, "body": "How far do numbers extend? Hundreds? Thousands?"}, {"owner": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487730037, "post_id": 42381241, "comment_id": 71912066, "body": "@parfait At most 10!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487731741, "post_id": 42381241, "comment_id": 71912549, "body": "Do you use Excel for Windows?"}, {"owner": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487732099, "post_id": 42381241, "comment_id": 71912638, "body": "@parfait yes I do!"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1487734437, "post_id": 42381241, "comment_id": 71913274, "body": "you can sort by column headers from left to right <a href=\"https://www.extendoffice.com/documents/excel/897-excel-sort-columns.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/897-excel-sort-columns.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "edited": false, "score": 0, "creation_date": 1487735817, "post_id": 42382097, "comment_id": 71913653, "body": "thank you for your work! What if it does not always have 10 sets?  The system generates 3-10 sets, it is not fixed always. Does the code still work?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "edited": false, "score": 0, "creation_date": 1487737029, "post_id": 42382097, "comment_id": 71913979, "body": "As mentioned, adjust the query&#39;s columns. Specifically, remove the items in <code>SELECT</code> clause. Do you know in advance the set number?"}, {"owner": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "edited": false, "score": 0, "creation_date": 1487751909, "post_id": 42382097, "comment_id": 71920557, "body": "@parfair Nope, I will not know in advance! The set number is generated by another system and then this code will run"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "edited": false, "score": 0, "creation_date": 1487771499, "post_id": 42382097, "comment_id": 71934106, "body": "See update with SQL being dynamically built from finding highest number in column header (extracted using RegEx). And congrats as you just learned of two special purpose languages: SQL and RegEx! May seem overkill but you avoid cutting and pasting columns."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1487771241, "last_edit_date": 1487771241, "creation_date": 1487733732, "answer_id": 42382097, "question_id": 42381241, "link": "https://stackoverflow.com/questions/42381241/rearranging-columns-in-vba/42382097#42382097", "title": "Rearranging columns in VBA", "body": "<p>Consider an SQL and RegEx solution to select columns in a specified arrangement. SQL works in Excel for PC which can access Windows' Jet/ACE SQL Engine to query its own workbook like a database table. </p>\n\n<p>Due to the variable nature of sets ranging 3-10, consider finding the highest number set by extracting the numbers from column headers with RegEx using the defined function, <code>FindHighestNumberSet</code>. Then have <code>RunSQL</code> subroutine call the function to build SQL string dynamically.</p>\n\n<p>Below assumes you have data currently in a tab named <em>DATA</em> with an empty tab named <em>RESULTS</em> which will output query results. Two ADO connection strings are available.</p>\n\n<p><strong>Function</strong> <em>(iterating across column headers to extract highest number)</em></p>\n\n<pre><code>Function FindHighestNumberSet() As Integer\n    Dim lastcol As Integer, i As Integer\n    Dim num As Integer: num = 0\n    Dim regEx As Object\n\n    ' CONFIGURE REGEX OBJECT\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n    With regEx\n       .Global = True\n       .MultiLine = True\n       .IgnoreCase = False\n       .Pattern = \"[^0-9]\"\n    End With\n\n    With Worksheets(\"DATA\")\n       lastcol = .Cells(7, .Columns.Count).End(xlToLeft).Column\n\n       For i = 1 To lastcol\n         ' EXTRACT NUMBERS FROM COLUMN HEADERS\n         num = Application.WorksheetFunction.Max(num, CInt(regEx.Replace(.Cells(1, i), \"\")))\n       Next i\n\n    End With\n\n    FindHighestNumberSet = num\nEnd Function\n</code></pre>\n\n<p><strong>Macro</strong> <em>(main module looping through result of above function)</em></p>\n\n<pre><code>Sub RunSQL()\nOn Error GoTo ErrHandle\n    Dim conn As Object, rst As Object\n    Dim strConnection As String, strSQL As String\n    Dim i As Integer\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n\n    ' DRIVER AND PROVIDER CONNECTION STRINGS\n'    strConnection = \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n'                      &amp; \"DBQ=\" &amp; Activeworkbook.FullName &amp; \";\"\n    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" _\n                       &amp; \"Data Source='\" &amp; ActiveWorkbook.FullName &amp; \"';\" _\n                       &amp; \"Extended Properties=\"\"Excel 8.0;HDR=YES;\"\";\"\n\n    ' FIRST THREE SETS\n    strSQL = \" SELECT t.[V-d(1)], t.[I-d(1)], t.[I-g(1)],\" _\n                  &amp; \" t.[V-d(2)], t.[I-d(2)], t.[I-g(2)],\" _\n                  &amp; \" t.[V-d(3)], t.[I-d(3)], t.[I-g(3)]\"\n\n    ' VARIABLE 4+ SETS\n    For i = 4 To FindHighestNumberSet\n        strSQL = strSQL &amp; \", t.[V-d(\" &amp; i &amp; \")], t.[I-d(\" &amp; i &amp; \")], t.[I-g(\" &amp; i &amp; \")]\"\n    Next i\n\n    ' FROM CLAUSE\n    strSQL = strSQL &amp; \" FROM [DATA$] t\"\n\n    ' OPEN DB CONNECTION\n    conn.Open strConnection\n    rst.Open strSQL, conn\n\n    ' COLUMN HEADERS\n    For i = 1 To rst.Fields.Count\n        Worksheets(\"RESULTS\").Cells(1, i) = rst.Fields(i - 1).Name\n    Next i\n\n    ' DATA ROWS\n    Worksheets(\"RESULTS\").Range(\"A2\").CopyFromRecordset rst\n\n    rst.Close: conn.Close\n    Set rst = Nothing: Set conn = Nothing\n\n    MsgBox \"Successfully ran SQL query!\", vbInformation\n    Exit Sub\n\nErrHandle:\n    Set rst = Nothing: Set conn = Nothing\n    MsgBox Err.Number &amp; \" = \" &amp; Err.Description, vbCritical\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1487781440, "creation_date": 1487781440, "answer_id": 42397270, "question_id": 42381241, "link": "https://stackoverflow.com/questions/42381241/rearranging-columns-in-vba/42397270#42397270", "title": "Rearranging columns in VBA", "body": "<p>You can sort vertically by a helper row with something like this (tested):</p>\n\n<pre><code>Sub test() ': Cells.Delete: [b2:d8] = Split(\"V-d(10) V-d(2) V-d(1)\") ' used for testing\n    Dim r As Range: Set r = ThisWorkbook.Worksheets(\"Sheet1\").UsedRange  ' specify the range to be sorted here\n\n    r.Rows(2).Insert xlShiftDown ' insert helper row to sort by. (used 2nd row instead 1st so that it is auto included in the range)\n    r.Rows(2).FormulaR1C1 = \"=-RIGHT(R[-1]C,LEN(R[-1]C)-3)\" ' to get the numbers from the column header cells above, so adjust if needed\n\n    r.Sort r.Rows(2) ' sort vertically by the helper row\n    r.Rows(2).Delete xlShiftUp ' delete the temp row\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7412573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64bac5b34c0b9965e8c5bf90fcd77d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/7412573/jane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1487781440, "creation_date": 1487728030, "question_id": 42381241, "link": "https://stackoverflow.com/questions/42381241/rearranging-columns-in-vba", "title": "Rearranging columns in VBA", "body": "<p>The current codes I am working on requires me to rearrange the columns in VBA. It has to arranged according to the header, and the headers are <strong>\"V-d(1)\", \"V-g(1)\", \"I-d(1)\", \"I-g(1)\"</strong>, and this set repeats for numbers 2, 3, etc etc. (e.g <strong>V-d(2), I-g(4)</strong>). These data are usually jumbled up and I have to arrange them in ascending numbers.<br><br> </p>\n\n<p>It does not matter if V-g, V-d, I-d or I-g comes first.</p>\n\n<pre><code>Dim num, numadj As Integer\nDim colu, coladj\nRange(\"A1\").Select\nDo While Range(\"A1\").Offset(0, i - 1).Value &lt;&gt; \"\"\n    colu = ActiveCell.Value\n    coladj = ActiveCell.Offset(0, 1).Value\n    num = Left(Right(colu.Text, 2), 1)\n    numadj = Left(Right(coladj.Text, 2), 1)\n    If num &gt; numadj Then\n        colu.EntireColumn.Cut Destination:=Columns(\"Z:Z\")\n        coladj.EntireColumn.Cut Destination:=colu\n        Columns(\"Z:Z\").Select.Cut Destination:=coladj\n        i = i + 1\n    Else\n    i = i + 1\n    End If\nLoop\n</code></pre>\n\n<p>I am very new to VBA so please forgive me for any dumb codes that I have created!!! Thank you in advance everyone!</p>\n"}, {"tags": ["vba", "ms-access", "dao"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487725457, "post_id": 42380818, "comment_id": 71910864, "body": "You&#39;ll need some more code than that - your <code>GoTo</code> label isn&#39;t included at very least."}, {"owner": {"reputation": 3, "user_id": 6844075, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153755328201610/picture?type=large", "display_name": "Patrick Meiler", "link": "https://stackoverflow.com/users/6844075/patrick-meiler"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487725951, "post_id": 42380818, "comment_id": 71911002, "body": "It is in my code, somehow it&#39;s gone here...I&#39;ll just update it :-/"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487729531, "post_id": 42380818, "comment_id": 71911940, "body": "Check if any field disallows duplicates or has other validation rules that would prohibit inserts."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1487738516, "post_id": 42380818, "comment_id": 71914369, "body": "What does <i>By using an SQL Query, I get an error, because I used multi-valued fields</i> mean? I don&#39;t see anything in your VB that can&#39;t be done ten times faster and more reliably in T-SQL"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1487753655, "post_id": 42380818, "comment_id": 71921670, "body": "@Nick.McDermaid: This is Access, not SQL Server."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1487753806, "post_id": 42380818, "comment_id": 71921783, "body": "<i>I cannot change the data structure</i> - but you should. Those multi-valued fields will cause you nothing but trouble; it is starting now, as you can see, and won&#39;t go away."}, {"owner": {"reputation": 3, "user_id": 6844075, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153755328201610/picture?type=large", "display_name": "Patrick Meiler", "link": "https://stackoverflow.com/users/6844075/patrick-meiler"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1488005469, "post_id": 42380818, "comment_id": 72049280, "body": "@Gustav OK I changed it and it works like a charm! Thank you!"}], "owner": {"reputation": 3, "user_id": 6844075, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153755328201610/picture?type=large", "display_name": "Patrick Meiler", "link": "https://stackoverflow.com/users/6844075/patrick-meiler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487904593, "creation_date": 1487724955, "last_edit_date": 1487904593, "question_id": 42380818, "link": "https://stackoverflow.com/questions/42380818/syncing-two-access-databases-i-cant-see-the-data-on-the-master-db", "title": "Syncing two Access databases - I can&#39;t see the data on the Master DB", "body": "<p>I have one master db and slave dbs. I would like to sync those database, but two tables make lots of troubles. </p>\n\n<p>By using an SQL Query, I get an error, because I used multi-valued fields. I cannot change the data structure and therefore I decided to \"manually\" loop through the recordsets and sync the tables. My code looks like this:</p>\n\n<pre><code>    sub UpdateTable()...\n    .....\n    Dim rstSlave, rstMaster as DAO.Recordset\n    Dim fld as DAO.Field\n\n    Set dbSlave = currentDB\n    Set dbMaster = OpenDatabse(\"C:\\Users\\MyFile\\Master_DB.accdb\")\n    Set rstSlave = dbSlave.OpenRecordset(\"tbl_Candidate\")\n    Set rstMaster = dbMaster.OpenRecordset(\"tbl_Candidate\")\n    Set rstSlave = dbSlave.OpenRecordset(\"tbl_Candidate\")\n\n    rstSlave.MoveFirst\n    While Not rstSlave.EOF\n       rstMaster.MoveFirst\n\n       Do While Not rstMaster.EOF\n          If rstMaster![ID] = rstSlave![ID] Then GoTo nextRecord\n          rstMaster.MoveNext\n       Loop\n\n    With rstMaster\n        .AddNew\n        For Each fld in .Fields\n            strFieldName = fld.Name\n            fld.Value = rstSlave.Fields(strFieldName).Value\n        Next fld\n        .Update\n    End With\n   nextRecord:\n   rstSlave.MoveNext\n   Wend\n\n   rstSlave.Close   \n   rstMaster.Close\n\n   Set rstSlave = Nothing\n   Set rstMaster = Nothing\n</code></pre>\n\n<p>I cannot see the record in the master db. When debugging, I see that the ID of the record which was supposed to be transferred to the master db, already existed. Still couldn't find it in the master db when I opened the file.</p>\n\n<p>Strangely it works the other way around. If I change something on the master db and sync it, I can see the changes on my slavedb.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1487726370, "post_id": 42380684, "comment_id": 71911098, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838320\" rel=\"nofollow noreferrer\">Recording a Macro to Generate Code</a> You can add samle example of before and after to make the question easier to understand."}, {"owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1488243171, "post_id": 42380684, "comment_id": 72136022, "body": "Ok, I edited my original post to include a recorded macro that sorta does what I need it to."}], "owner": {"reputation": 121, "user_id": 4907546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bbd2b66a7945098fd3418dc97c6e6af9?s=128&d=identicon&r=PG", "display_name": "user4907546", "link": "https://stackoverflow.com/users/4907546/user4907546"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488241326, "creation_date": 1487724097, "last_edit_date": 1488241326, "question_id": 42380684, "link": "https://stackoverflow.com/questions/42380684/import-rows-from-table-in-word-document-to-another-word-document", "title": "Import rows from table in Word document to another Word document", "body": "<p>I have a form letter for my job that has all citation reasons listed in row after row of a 25 page letter. We find the citations we need, and delete all the other rows so that only the two or three rows we actually need are left. As you can imagine, this is particularly frustrating. If I place that whole table into a new Word, or Excel, document, is there a way to name each row (maybe with Alt Text) by citation number, and then use a macro to search for just the citation numbers we need and import those rows into a table on the form letter? I have no idea what the code for this would look like, especially as I've never used VBA with Word, only with Excel. </p>\n\n<p>Ok, I've tried to do this with a recorded macro, and it does at least some of what I want it to do. My code is:</p>\n\n<pre><code>Sub Bookmark()\n\n Copy table from source document and add to table in target document\n\n  Dim TarDoc As Document, SourceDoc As Document\n  Set SourceDoc = Documents.Open(\"H:\\Test Documents\\English Violations.docx\")\n  Set TarDoc = Documents.Open(\"H:\\Test Documents\\Test Doc.docm\")\n\n  Application.ScreenUpdating = False\n\n    SourceDoc.Activate\n    Selection.GoTo What:=wdGoToBookmark, Name:=\"C119f\"\n    With SourceDoc.Bookmarks\n        .DefaultSorting = wdSortByName\n        .ShowHidden = False\n    End With\n    Selection.Tables(1).Select\n    Selection.Copy\n    TarDoc.Activate\n    Selection.PasteAndFormat (wdSingleCellText)\n    Selection.MoveRight Unit:=wdCell\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I realize this is pretty clunky code, especially as its basically just a recorded macro I edited a bit. I need to be able to generate a prompt box into which you can type the bookmark name to copy from the source document, as that changes based upon the violation. I also need it to paste the contents of the table from the source document into the next blank row on the target document, as that might not be the row currently selected. One more thing, the bookmark listed in my code is \"C119c\", but I need the initial \"C\" in that to autopopulate in the code. There will always be an initial \"C\" (because bookmarks have to begin with a letter), but the user won't input that. </p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3413386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32518dd6e56b2ef5b9291dbfea43ec1d?s=128&d=identicon&r=PG&f=1", "display_name": "ezybusy", "link": "https://stackoverflow.com/users/3413386/ezybusy"}, "edited": false, "score": 0, "creation_date": 1487753999, "post_id": 42386078, "comment_id": 71921922, "body": "Thx Gustav. But I might need to modify this path anytime I need to used the db on another computer. Especially if there is no drive f:\\. Is there a way to let the system identify the path on its own, so that there won&#39;t be a need to always modify the vba code?"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1487751574, "creation_date": 1487751574, "answer_id": 42386078, "question_id": 42380336, "link": "https://stackoverflow.com/questions/42380336/autobackup-access-database/42386078#42386078", "title": "Autobackup access database", "body": "<p>Replace </p>\n\n<pre><code>Target = \"d:\\\"\nTarget = Target &amp; Format(Date, \"mm-dd-yyyy\") &amp; \"  \" \nTarget = Target &amp; Format(Time, \"hh-mm\") &amp; \".accdb\" \n</code></pre>\n\n<p>with this where <code>f:\\databasefolder</code> is the drive/folder holding your backend database file:</p>\n\n<pre><code>Target = \"f:\\databasefolder\\backups\\\" \nTarget = Target &amp; Format(Now, \"yyyymmdd-hhnn\") &amp; \".accdb\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1487764619, "creation_date": 1487764619, "answer_id": 42390742, "question_id": 42380336, "link": "https://stackoverflow.com/questions/42380336/autobackup-access-database/42390742#42390742", "title": "Autobackup access database", "body": "<p>Use CurrentProject.path to return where the database is being used from. </p>\n"}], "owner": {"reputation": 29, "user_id": 3413386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32518dd6e56b2ef5b9291dbfea43ec1d?s=128&d=identicon&r=PG&f=1", "display_name": "ezybusy", "link": "https://stackoverflow.com/users/3413386/ezybusy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 912, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594549426, "creation_date": 1487722009, "last_edit_date": 1594549426, "question_id": 42380336, "link": "https://stackoverflow.com/questions/42380336/autobackup-access-database", "title": "Autobackup access database", "body": "<p>i have this code which i got somewhere (credit to the author) and modified a bit in order to make an automated backup of my database every 7 days.</p>\n<pre><code>Function fMakeBackup() As Boolean\n\n    Dim Source As String\n    Dim Target As String\n    Dim retval As Integer\n    \nOn Error GoTo sysBackup_Err\n\n    Source = CurrentDb.name\n\n    Target = &quot;d:\\&quot; \n    Target = Target &amp; Format(Date, &quot;mm-dd-yyyy&quot;) &amp; &quot;  &quot; \n    Target = Target &amp; Format(Time, &quot;hh-mm&quot;) &amp; &quot;.accdb&quot; \n\n  If DateDiff(&quot;d&quot;, DLookup(&quot;[BackupDate]&quot;, &quot;WinAutoBackup&quot;, &quot;[BckID] =1&quot;), Date) = 7 Then\n\n    retval = 0\n    Dim objFSO As Object\n    Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n    retval = objFSO.CopyFile(Source, Target, True)\n    Set objFSO = Nothing\n    \n    DoCmd.SetWarnings False\n       DoCmd.RunSQL &quot;UPDATE WinAutoBackup SET WinAutoBackup.BackupDate = Date();&quot;\n    DoCmd.SetWarnings True\n    \n    MsgBox &quot;Backup successfull. Next auto backup in 7 days&quot;\n\n  Else\n    Exit Function\n  End If\n  \nsysBackup_Exit:\nExit Function\n\nsysBackup_Err:\nMsgBox Err.Description, , &quot;sysBackup()&quot;\nResume sysBackup_Exit\nEnd Function\n</code></pre>\n<p>how can i modify the path, so that all backup files go into a folder called backups inside the\nsame directory as the main backend database file?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487719460, "post_id": 42379799, "comment_id": 71909003, "body": "<code>s1</code> is never declared or assigned.  Is it a global somewhere?  You also never use the variable <code>c</code>."}, {"owner": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487719844, "post_id": 42379799, "comment_id": 71909124, "body": "no it is not declared as global variable"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487719888, "post_id": 42379799, "comment_id": 71909134, "body": "Is it supposed to be something else then?  Right now it&#39;s just an empty <code>Variant</code>."}], "owner": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487719115, "creation_date": 1487718879, "last_edit_date": 1487719115, "question_id": 42379799, "link": "https://stackoverflow.com/questions/42379799/copying-data-from-master-sheet-to-other-sheets-in-workbook-by-vba-code", "title": "Copying data from master sheet to other sheets in workbook by vba code", "body": "<p>Hi I am using below code to copy data conditionally from one sheet to other sheets in a workbook. There are different conditions for each sheet. For sheet updated if column AQ4 in sheet employee data is blank and column BA4 contains text as \"working\" then copy data of that row from sheet employee data to sheet updated. For sheet executive if column G4 contains text as \"executive\" and column BA4 contains text as \"working\" then copy data of that row from sheet employee data to sheet executive. For sheet supervisor if column G4 contains text as \"supervisor\" and column BA4 contains text as \"working\" then copy data of that row from sheet employee data to sheet supervisor. For sheet workmen if column G4 contains text  as \"workmen\" and column BA4 contains text as \"working\" then copy data of that row from sheet employee data to sheet workmen. For sheet transferred if column AQ is non blank and column BA4 contains text as \"transferred\" then copy data from sheet employee data to sheet transferred.</p>\n\n<p>This code is neither working nor displaying any error.</p>\n\n<pre><code>Sub Main()\n    Dim sh As Worksheet, str1 As Variant, str2 As Variant, shAry As Variant, c As Range, i As Long, rng As Range\n    Set sh = Sheets(\"Employee Data\")\n    str1 = Array(\"\", \",\", \"Executive\", \"Supervisor\", \"Workmen\")\n    str2 = Array(\"Working\", \"Transferred\", \"Working\", \"Working\", \"Working\")\n    shAry = Array(\"Updated\", \"Transferred\", \"Executive\", \"Supervisor\", \"Workmen\")\n    For i = LBound(str1) To UBound(str1)\n        If i = 0 Or i = s1 Then\n            Sheets(shAry(i)).Range(\"B4:AX20000\").ClearContents\n            With sh.UsedRange.Offset(2).Resize(sh.UsedRange.Rows.Count - 2)\n                .AutoFilter 51, str2(i)\n                .AutoFilter 41, str1(i)\n            End With\n        Else\n            Sheets(shAry(i)).Range(\"B4:AX20000\").ClearContents\n            With sh.UsedRange.Offset(2).Resize(sh.UsedRange.Rows.Count - 2)\n                .AutoFilter 51, str2(i)\n                .AutoFilter 6, str1(i)\n            End With\n        End If\n        Set rng = Intersect(sh.Range(\"B:AX\"), sh.UsedRange.Offset(3)).Resize(sh.UsedRange.Rows.Count - 3)\n        On Error Resume Next\n        rng.SpecialCells(xlCellTypeVisible).Copy Sheets(shAry(i)).Cells(Rows.Count, 2).End(xlUp)(2)\n        On Error GoTo 0\n        sh.AutoFilterMode = False\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1487716668, "post_id": 42378867, "comment_id": 71907902, "body": "How do you define &quot;Similar name&quot;?  &quot;Findings&quot; similar to &quot;Visual Findings&quot;?  Perhaps it might be better stated that you want a certain page (&quot;Final Results&quot;?) <i>after</i> all other sheets?"}, {"owner": {"reputation": 1, "user_id": 7601380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0783aed6a1aec46f3bec7dcaffcbbd57?s=128&d=identicon&r=PG&f=1", "display_name": "El_Redd", "link": "https://stackoverflow.com/users/7601380/el-redd"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487725828, "post_id": 42378867, "comment_id": 71910970, "body": "The data collection pages created by the user needs to go near the beginning of the report.  There are other pages before and after the created pages not tied to this.  I am trying to direct all of the data collection pages to the beginning so my users can fill them out without having to go through the whole report."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7601380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0783aed6a1aec46f3bec7dcaffcbbd57?s=128&d=identicon&r=PG&f=1", "display_name": "El_Redd", "link": "https://stackoverflow.com/users/7601380/el-redd"}, "edited": false, "score": 0, "creation_date": 1487784702, "post_id": 42385072, "comment_id": 71943840, "body": "I figured it out going another direction:"}, {"owner": {"reputation": 1, "user_id": 7601380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0783aed6a1aec46f3bec7dcaffcbbd57?s=128&d=identicon&r=PG&f=1", "display_name": "El_Redd", "link": "https://stackoverflow.com/users/7601380/el-redd"}, "edited": false, "score": 0, "creation_date": 1487784847, "post_id": 42385072, "comment_id": 71943928, "body": "Dim numtimes As Integer     Dim x As Integer     Dim y As String     x = InputBox(&quot;Enter Number of Additional Features&quot;)     For numtimes = 1 To x     ActiveWorkbook.Sheets(Array(&quot;Data Collection&quot;, &quot;ILI vs NDE&quot;,       &quot;Screen Shot&quot;)).Copy _     Before:=ActiveWorkbook.Sheets(&quot;MPI&quot;)      If numtimes &gt; 1 Then     y = &quot;Data Collection (&quot; &amp; numtimes &amp; &quot;)&quot;     Else: y = &quot;Data Collection&quot;     End If      Worksheets(&quot;Data Collection (&quot; &amp; numtimes + 1 &amp; &quot;)&quot;).Move _     After:=Worksheets(y)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1487748110, "creation_date": 1487748110, "answer_id": 42385072, "question_id": 42378867, "link": "https://stackoverflow.com/questions/42378867/move-pages-with-similar-name-within-workbook/42385072#42385072", "title": "Move pages with similar name within workbook", "body": "<p>You may use:</p>\n\n<pre><code>Dim sheetNames As String\nDim ws As Worksheet, flg As Boolean\nFor Each ws In Worksheets\n    If ws.Name Like \"*Data Collection*\" Then sheetNames = sheetNames &amp; \"|\"\nNext\n\nIf sheetNames &lt;&gt;\"\" Then ActiveWorkbook.Sheets(Split(Left(sheetNames, Len(sheetNames) - 1),\"|\").Move Before:=ActiveWorkbook.Sheets(\"Final Results\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7601380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0783aed6a1aec46f3bec7dcaffcbbd57?s=128&d=identicon&r=PG&f=1", "display_name": "El_Redd", "link": "https://stackoverflow.com/users/7601380/el-redd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487748110, "creation_date": 1487714610, "question_id": 42378867, "link": "https://stackoverflow.com/questions/42378867/move-pages-with-similar-name-within-workbook", "title": "Move pages with similar name within workbook", "body": "<p>So I'm trying to finish a macro that selects all worksheets with similar names and moves them before a certain sheet in a workbook.  The user can add as many pages with these names so i couldn't just use an array function to move them. This is what I have so far:</p>\n\n<pre><code>Sub Copier()\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\n\nDim x As Integer\nx = InputBox(\"Enter Number of Additional Features\")\nFor numtimes = 1 To x\nActiveWorkbook.Sheets(Array(\"Data Collection\", \"Findings\", \"Visual Findings\")).Copy _\nBefore:=ActiveWorkbook.Sheets(\"Final Results\")\n  'Allows user to create as many pages as necessary\n\nDim ws As Worksheet, flg As Boolean\nFor Each ws In Worksheets\n    If (ws.Name) Like \"*Data Collection*\" Then\n        ws.Select Not flg\n        flg = True\n End If\n Next\n'Selects all sheets for \"Data Collection\"\n'Now I need to move all of those selected before a certain sheet at the \n  beginning of the workbook\n'I cant seperate the copy functions because some formulas from data collection have to carry \nover to the other copied sheets\n\n'Sheet2.Activate\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1487715763, "post_id": 42378690, "comment_id": 71907536, "body": "It sounds like you need to size the array. You can achieve this by using <code>Redim</code>. Something like <code>Redim Arr(99)</code> would size a 1-dimensional array 100 empty elements. Did you want enough space for each row? If so, you can use LastRow, although I don&#39;t see where that is declared."}, {"owner": {"reputation": 135, "user_id": 4067977, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e446a8a66548d6f19a8583890724778?s=128&d=identicon&r=PG&f=1", "display_name": "Dalton", "link": "https://stackoverflow.com/users/4067977/dalton"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1487768787, "post_id": 42378690, "comment_id": 71932067, "body": "Hey Ryan. Yes, I did see how to resize it. I could use Redim Preserve Arr. I&#39;m not saving each row. I&#39;m totaling each list and saving the total in the array. The idea was that I could loop through the array and display each total. So if I had 3 lists, I could do a loop where I get the ubound of the array and say from j=1 to ubound, msgbox &quot;The total is: &quot; &amp; arr(j)."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4067977, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e446a8a66548d6f19a8583890724778?s=128&d=identicon&r=PG&f=1", "display_name": "Dalton", "link": "https://stackoverflow.com/users/4067977/dalton"}, "edited": false, "score": 0, "creation_date": 1487789591, "post_id": 42396301, "comment_id": 71946852, "body": "Ryan, my ranges are variable. The list lengths vary."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 135, "user_id": 4067977, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e446a8a66548d6f19a8583890724778?s=128&d=identicon&r=PG&f=1", "display_name": "Dalton", "link": "https://stackoverflow.com/users/4067977/dalton"}, "edited": false, "score": 0, "creation_date": 1487789643, "post_id": 42396301, "comment_id": 71946874, "body": "Ranges can be variables too."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1487779238, "last_edit_date": 1487779238, "creation_date": 1487778877, "answer_id": 42396301, "question_id": 42378690, "link": "https://stackoverflow.com/questions/42378690/dynamic-array-with-1-value-vba-excel/42396301#42396301", "title": "Dynamic Array with (1) Value - VBA Excel", "body": "<p>An approach I'd use is to store the data in a dictionary instead of an array. </p>\n\n<p>Using a dictionary will be fast to perform lookups based on a key, and you can make the key almost whatever you want to uniquely identify the totals. This will likely (I think) be more symbolic and easy to understand than an index number in an array.</p>\n\n<p>The sheet I've setup as a test (on Sheet1):</p>\n\n<p><a href=\"https://i.stack.imgur.com/DOj8Q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DOj8Q.jpg\" alt=\"Spreadsheet\"></a></p>\n\n<p>Here's the example code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Example()\n    Dim myDict As Object: Set myDict = CreateObject(\"Scripting.Dictionary\")\n    Dim i As Long\n\n    'Add data to a dictionary\n    With myDict\n        'the first parameter is a unique key that identifies the record\n        'the second parameter is the value\n        'Remember to change the range reference\n        .Add \"the Range A1:A5\", WorksheetFunction.Sum(Range(\"Sheet1!A1:A5\"))\n        .Add \"the Range B1:B5\", WorksheetFunction.Sum(Range(\"Sheet1!B1:B5\"))\n        .Add \"the Range C1:C5\", WorksheetFunction.Sum(Range(\"Sheet1!C1:C5\"))\n    End With\n\n    'Iterate the dictionary and return the key and value\n    For i = 0 To myDict.Count - 1\n        Debug.Print \"The sum is: \" &amp; myDict.items()(i) &amp; \" for Key: \" &amp; myDict.keys()(i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Results in the Immediate Window:</p>\n\n<pre><code>The sum is: 6 for Key: the Range A1:A5\nThe sum is: 5 for Key: the Range B1:B5\nThe sum is: 12 for Key: the Range C1:C5\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4067977, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e446a8a66548d6f19a8583890724778?s=128&d=identicon&r=PG&f=1", "display_name": "Dalton", "link": "https://stackoverflow.com/users/4067977/dalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 823, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487779238, "creation_date": 1487713928, "last_edit_date": 1487714561, "question_id": 42378690, "link": "https://stackoverflow.com/questions/42378690/dynamic-array-with-1-value-vba-excel", "title": "Dynamic Array with (1) Value - VBA Excel", "body": "<p>I have a quick question that I hope will be easy for anyone familiar with arrays to answer.</p>\n\n<p>I've got a single column with a varying number of lists separated by a space. I have the program adding the numbers up. When it hits an empty cell, it should add that number to an array, increase the number of spaces in the array by (1) and, set the total counter back to zero, and skip to the next iteration of the loop its in and begin counting till it hits a space again. Over time there will be varying amounts of lists. I don't imagine that there will ever be more than 3-4, but I'd like to program it to handle it if there are more than that in the future.</p>\n\n<p>So, for instance, cells C4:C10 contain numbers adding up to 200, then cell C11 is empty. Cells C12:C14 contain numbers adding up to 150. I'd like the array to store 200 in the first spot and 150 in the second spot. Then I'd like message boxes to pop up telling me \"List 1 is 200\", List 2 is 150\", etc... </p>\n\n<p>Right now, I'm getting subscript out of bounds, but I think it's because I didn't declare an array size. I'd like for it to be dynamic, but I didn't know how to have an array only contain (1) slot. It's always something like arr(0 to 1). I don't just see a single value in the examples I'm looking at and since it's in a for loop, if I did a loop for lbound to ubound, I think it would say something like \"List 1 is 200\", \"List 2 is \" with no value on the second one, because didn't have data if there is only one list.</p>\n\n<p>I may be over thinking this or going about it the wrong way, but I've never really used arrays before. I think it will be helpful in this program. Thanks for any help you can provide.</p>\n\n<p>I'm going to provide the mess I have below. I haven't cleaned this up and commented it well, yet, so you can ask if you have questions. I'm sure I'm doing it wrong, I'm just trying to give you an idea of where I'm going.</p>\n\n<pre><code>Private Sub cmdTest_Click()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim intCounter As Integer\n    Dim intValue As Integer\n    Dim strCell As String\n    Dim arr() As Long\n    Dim intArr As Integer\n\n    Set wb = Application.Workbooks(\"ListTotal.xlsm\")\n    Set ws = wb.Worksheets(\"Main\")\n\n    Call LastRowWithData_xlUp_1(lastColRow)\n\n    MsgBox \"Number of lists is: \" &amp; WorksheetFunction.CountIf(Range(\"C3:C\" &amp; lastColRow), \"\") + 1\n\n    Call FindLastRow(LastRow)\n\n    'Count pages left in each series\n    intValue = 0\n\n    'set number of values in array\n    intArr = 1\n\n    For i = 3 To LastRow\n\n            strCell = \"C\" &amp; i\n\n        If Range(strCell) = \"\" Then\n            arr(0) = intValue\n            intValue = 0\n            GoTo NextIteration\n        End If\n\n                openingParen = InStr(Range(strCell), \"[\")\n                closingParen = InStr(Range(strCell), \"]\")\n                enclosedvalue = Mid(Range(strCell), openingParen + 1,              closingParen - openingParen - 1)\n                intValue = intValue + enclosedvalue\n                MsgBox \"The number of pages in this book is: \" &amp; enclosedvalue\n\n        NextIteration:\n        MsgBox \"The total pages left in the series is: \" &amp; intValue\n\n    Next\n\n    For i = LBound(arr) To UBound(arr)\n        MsgBox (\"The number of pages left in Series \" &amp; j &amp; \" is:\")  'arr(i))\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1487711573, "creation_date": 1487711573, "answer_id": 42378084, "question_id": 42377952, "link": "https://stackoverflow.com/questions/42377952/microsoft-access-dlookup-with-multiple-criteria-from-different-tables/42378084#42378084", "title": "Microsoft Access - Dlookup with multiple criteria from different tables", "body": "<p>You have to nest the <code>DLookups</code> like this:</p>\n\n<pre><code>DLookup(\"[Name]\",\"Product\",\"[Name]='\" &amp; me.txtName.value &amp; \"' AND Manufacture_Number=\" &amp; Nz(DLookup(\"Number\",\"Manufacture\",\"[Name]='\" &amp; me.txtManufactureName.value &amp; \"'\" ,0)))\n</code></pre>\n\n<p>I am using <code>Nz</code> to avoid errors when<code>DLookup</code> returns null.</p>\n"}, {"tags": [], "owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "is_accepted": true, "score": 2, "last_activity_date": 1487711893, "creation_date": 1487711893, "answer_id": 42378174, "question_id": 42377952, "link": "https://stackoverflow.com/questions/42377952/microsoft-access-dlookup-with-multiple-criteria-from-different-tables/42378174#42378174", "title": "Microsoft Access - Dlookup with multiple criteria from different tables", "body": "<p>I suspect that you don't really want to look across different tables. You want to prevent adding a product with the same name and manufacturer as an existing product, so you want to check both fields in the <code>Product</code> table:</p>\n\n<pre><code>DLookup(\"[Name]\", \"[Product]\", \"[Name] = '\" &amp; me.txtName &amp; \"' And Manufacture_Number = \" &amp; me.txtMfrNumber)\n</code></pre>\n\n<p>It's more likely that your input control for the manufacturer is going to be a combo box, but that works too - just replace <code>txtMfrNumber</code> with the name of the control that you're using to get this number.</p>\n\n<p>Note that you don't need to specify the <code>.Value</code> on the end of <code>me.txtName</code> as <code>Value</code> is the default property of your text box.</p>\n"}], "owner": {"reputation": 193, "user_id": 4012131, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1628941010/picture?type=large", "display_name": "Bruno Sousa", "link": "https://stackoverflow.com/users/4012131/bruno-sousa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1797, "favorite_count": 0, "accepted_answer_id": 42378174, "answer_count": 2, "score": 0, "last_activity_date": 1513002441, "creation_date": 1487711083, "last_edit_date": 1513002441, "question_id": 42377952, "link": "https://stackoverflow.com/questions/42377952/microsoft-access-dlookup-with-multiple-criteria-from-different-tables", "title": "Microsoft Access - Dlookup with multiple criteria from different tables", "body": "<p>I have 2 tables in my DB. One called Manufacture and the other Product.</p>\n\n<p>The Manufacture table has 2 fields:</p>\n\n<ul>\n<li>Number </li>\n<li>Name</li>\n</ul>\n\n<p>The Product table has 3 fields:</p>\n\n<ul>\n<li>Number</li>\n<li>Name</li>\n<li>Manufacture_Number</li>\n</ul>\n\n<p>What I want is When I create a new product, it shows me if the product already exists. I'm currently using this code:</p>\n\n<pre><code>DLookup(\"[Name]\", \"Product\", \"[Name] = '\" &amp; me.txtName.value &amp; \"'\")\n</code></pre>\n\n<p>It works just fine, but once happened that a product with the same name but different manufacture. I could not create a record because of that.</p>\n\n<p>I only could not create a new record if the is the same product and the same manufacture as already created.</p>\n\n<p>How do I create one Dlookup for multiple criteria in different tables?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487711180, "post_id": 42377897, "comment_id": 71904957, "body": "By far the easiest way is to create an empty &quot;template&quot; worksheet, hide it, and then copy the hidden template when you add new ones."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1487711476, "post_id": 42377897, "comment_id": 71905131, "body": "If you really want to copy the image then the TopLeftCell Property of the image might help."}, {"owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "edited": false, "score": 0, "creation_date": 1487712338, "post_id": 42377897, "comment_id": 71905660, "body": "Thanks. Unfortunately I understand the concept, but lack the skills to carry it out. Forgive me for being dense, but how would I link the template to the functionality of the worksheet? I mean, is there a way to place the logos on a hidden sheet in the position I need them (I can do that bit) and layer them over the new sheets as they are generated, all as part of the macro? I don&#39;t mind if you send me somewhere else to find out. I want to learn how, not have someone do it for me."}, {"owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "edited": false, "score": 0, "creation_date": 1487712709, "post_id": 42377897, "comment_id": 71905864, "body": "Actually, I found this. I think I can modify it to work <code>ActiveSheet.Shapes(&quot;Your Chart&quot;).Left = Sheet1.Cells(3, 2).Left ActiveSheet.Shapes(&quot;Your Chart&quot;).Top = Sheet1.Cells(3, 2).Top ActiveSheet.Shapes(&quot;Your Chart&quot;).Height = Sheet1.Range(&quot;G3:G7&quot;).Height ActiveSheet.Shapes(&quot;Your Chart&quot;).Width = Sheet1.Range(&quot;B7:G7&quot;).Width</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487713512, "post_id": 42377897, "comment_id": 71906347, "body": "Instead of <code>Sheets.Add</code>, use <code>HiddenSheet.Copy</code> where <code>HiddenSheet</code> is the code name of your template."}, {"owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "edited": false, "score": 0, "creation_date": 1487716112, "post_id": 42377897, "comment_id": 71907670, "body": "I tried that, and it bugged. In fact, the current macro basically copies the input page and the logos don&#39;t go, so I don&#39;t see how copying a hidden sheet would help."}], "owner": {"reputation": 7, "user_id": 7585839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7de684bdbf8533f9b8bd258a42ab67c?s=128&d=identicon&r=PG", "display_name": "Davie", "link": "https://stackoverflow.com/users/7585839/davie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529059251, "creation_date": 1487710894, "last_edit_date": 1529059251, "question_id": 42377897, "link": "https://stackoverflow.com/questions/42377897/copying-images-logos-objects-to-new-sheets-with-vba", "title": "Copying images, logos, objects to new sheets with VBA", "body": "<p>I have created (with some considerable help from superior programmers) a workbook with a master sheet for inputting grades, and a macro for exporting the template (A1:C63), along with separate columns of information (D to Q) to separate sheets (which always appear in D1:D63 of the new sheet along side the template). The new sheets are named after the student names in row 7 of their respective columns in the master sheet.</p>\n\n<p>Here's the screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SsPzy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SsPzy.jpg\" alt=\"screenshot\"></a></p>\n\n<p>Here's the code:</p>\n\n<pre><code>Option Explicit\n\nSub parse_data()\n    Dim studsSht As Worksheet\n    Dim cell As Range\n    Dim stud As Variant\n\n    Set studsSht = Worksheets(\"Input\") '&lt;--| change \"Sheet1\" to your actual students grades sheet\n    With CreateObject(\"Scripting.Dictionary\") '&lt;--| instantiate a Dictionary object\n        For Each cell In studsSht.Range(\"D7:Q7\").SpecialCells(xlCellTypeConstants, xlTextValues) '&lt;--| loop through students names (change \"D7:Q7\" to your actual range with students names)\n            .Item(cell.Value) = .Item(cell.Value) &amp; cell.EntireColumn.Address(False, False) &amp; \",\" '&lt;--| add or update the dictionary entry whose key is the current student name with its corresponding column address\n        Next\n        For Each stud In .keys '&lt;--| loop through unique students names\n            Intersect(studsSht.UsedRange, studsSht.Range(Left(.Item(stud), Len(.Item(stud)) - 1))).Copy Destination:=GetSheet(CStr(stud)).Range(\"D1\") '&lt;--| copy its columns to correspondingly named sheet starting from cell A1\n        Next\n    End With\n\n    studsSht.Activate\nEnd Sub\n\nFunction GetSheet(shtName As String) As Worksheet\nOn Error Resume Next\nSet GetSheet = Worksheets(shtName)\nIf GetSheet Is Nothing Then\n    Set GetSheet = Sheets.Add(after:=Worksheets(Worksheets.Count))\n    GetSheet.Name = shtName\n    Sheets(\"Input\").Range(\"A1:C63\").Copy\n    GetSheet.Range(\"A1:D63\").PasteSpecial xlAll\nEnd If\nEnd Function\n</code></pre>\n\n<p>What I would like to know is if I can add to the code a way to carry over images (school logos, in fact) from the master sheet to the same location in the new sheets? I assume, since images are not attached to cells, that it makes no difference where they're located on the master sheet and that some other way of locating/identifying them must be necessary.</p>\n\n<p>I thought, since all my sheets are formatted in the same way, there was a way to use a distance measuring system within excel for this. I've heard mention of such a thing but I'll be damned if I can find out anything about it.</p>\n\n<p>Any help would be appreciated.</p>\n"}]