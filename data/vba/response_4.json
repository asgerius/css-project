[{"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "is_accepted": false, "score": 1, "last_activity_date": 1423093001, "last_edit_date": 1423093001, "creation_date": 1423089718, "answer_id": 28332964, "question_id": 28332764, "link": "https://stackoverflow.com/questions/28332764/creating-a-udf-that-returns-that-returns-a-formula/28332964#28332964", "title": "Creating a UDF that returns that returns a formula", "body": "<p>You can call the other function using <code>Application.Run</code>:</p>\n\n<pre><code>Public Function MyUDF(Value As Variant) As Variant\n    MyUDF = Application.Run(\"ABC\", Value, \"Value_Name\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4530609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3df81d442f93033cc7c97ece7c4a9f?s=128&d=identicon&r=PG&f=1", "display_name": "ractamp", "link": "https://stackoverflow.com/users/4530609/ractamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1423093001, "creation_date": 1423088933, "last_edit_date": 1423090298, "question_id": 28332764, "link": "https://stackoverflow.com/questions/28332764/creating-a-udf-that-returns-that-returns-a-formula", "title": "Creating a UDF that returns that returns a formula", "body": "<p>I'm new to VBA and have been reading all about user defined functions and macros. I'm hoping someone could help me out with a project. </p>\n\n<p>I have a subscription to a service that pulls information into excel using an add-in in the ribbon. The only way to pull in the formula is to either 1) use the ribbon which involves a lot of clicking and waiting or 2)type in the formula into the cell with also takes times. </p>\n\n<p>On excel, for normal functions (i.e. if, find, text), I often use the tab shortcut to fill out the formulas. I would like to to create a formula in excel (using VBA) so that I can write \"=\" -then hit tab - then reference a cell - and then the formula takes the referenced cell and returns a formula. </p>\n\n<p>FYI - I am using Windows 7 and Office 2013</p>\n\n<p>For example:</p>\n\n<ul>\n<li>IF cell A1 the input number = 12345</li>\n<li>In Cell B1 I enter the Comm formula that pulls in the data = \"=ABC(A1,\"Value_Name\")</li>\n<li>Cell B1 will display = ZYZYZYZY (which comes from the subscription database) </li>\n</ul>\n\n<p>How do I write a VBA code that basically does:</p>\n\n<pre><code>Function (Value)\nReturns =ABC(Value,\"Value_Name\") \n: Which then calls the comm function and returns ZYZYZYZY\nEnd Function\n</code></pre>\n\n<p>I tried my best to explain what I am trying to do - apologies if it was difficult to follow. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", ".net", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1440, "user_id": 4281149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25Jjy.png?s=128&g=1", "display_name": "jlee-tessik", "link": "https://stackoverflow.com/users/4281149/jlee-tessik"}, "is_accepted": true, "score": 1, "last_activity_date": 1423089790, "creation_date": 1423089790, "answer_id": 28332986, "question_id": 28332751, "link": "https://stackoverflow.com/questions/28332751/adding-microsoft-office-interop-excel-reference/28332986#28332986", "title": "adding Microsoft.Office.Interop.Excel reference", "body": "<p>I see a copy under C:\\Windows\\assembly\\GAC_MSIL. Is it there for you?</p>\n\n<p>If that doesn't work, open Windows Command Processor and use</p>\n\n<pre><code>dir /s microsoft.office.interop.excel.*\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1439, "user_id": 2210274, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a30ce642f529f9eafabc95610aaff2f7?s=128&d=identicon&r=PG", "display_name": "andrsnn", "link": "https://stackoverflow.com/users/2210274/andrsnn"}, "edited": false, "score": 0, "creation_date": 1423090638, "post_id": 28332987, "comment_id": 45013239, "body": "this works.  I did see that post, now I see several of the answers BELOW the ones I was attempting were correct. I was following <code>Add reference &gt; Browse &gt; C: &gt; Windows &gt; assembly &gt; GAC &gt; Microsoft.Office.Interop.Excel &gt; 12.0.0.0_etc &gt; Microsoft.Office.Interop.Excel.dll</code>"}], "tags": [], "owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "is_accepted": false, "score": 1, "last_activity_date": 1423090112, "last_edit_date": 1495539812, "creation_date": 1423089790, "answer_id": 28332987, "question_id": 28332751, "link": "https://stackoverflow.com/questions/28332751/adding-microsoft-office-interop-excel-reference/28332987#28332987", "title": "adding Microsoft.Office.Interop.Excel reference", "body": "<p>In my <code>C#</code> project, the path is</p>\n\n<pre><code>C:\\Windows\\assembly\\GAC_MSIL\\Microsoft.Office.Interop.Excel\\14.0.0.0__71e9bce111e9429c\\Microsoft.Office.Interop.Excel.dll\n</code></pre>\n\n<p>I am using <code>Excel 2010</code> </p>\n\n<p>You might want to have a look at a <a href=\"https://stackoverflow.com/questions/10477977/what-reference-do-i-need-to-use-microsoft-office-interop-excel-in-net\">related post</a>.</p>\n"}], "owner": {"reputation": 1439, "user_id": 2210274, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a30ce642f529f9eafabc95610aaff2f7?s=128&d=identicon&r=PG", "display_name": "andrsnn", "link": "https://stackoverflow.com/users/2210274/andrsnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1901, "favorite_count": 0, "accepted_answer_id": 28332986, "answer_count": 2, "score": 0, "last_activity_date": 1423090112, "creation_date": 1423088867, "question_id": 28332751, "link": "https://stackoverflow.com/questions/28332751/adding-microsoft-office-interop-excel-reference", "title": "adding Microsoft.Office.Interop.Excel reference", "body": "<p>I am attempting to write a c# script that performs work on an excel spreadsheet. (Rather then a VBA macro).  I am trying to add the reference to the <code>Microsoft.Office.Interop.Excel</code> assembly.  I cannot find any reference to said assembly in the Add Reference... Window or by browsing to <code>C:\\Windows\\assembly\\GAC</code>.  It does not exist.  I uninstalled and reinstalled office, and I also downloaded and installed the PIA redistributable located <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=3508\" rel=\"nofollow\">here</a>.  The Microsoft.Office.Core is the closest assembly I found, added via COM -> Microsoft Office 14 / 15 Object Library. Any comments or advice appreciated.</p>\n"}, {"tags": ["excel", "vba", "events", "activation"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1578696521, "post_id": 28332443, "comment_id": 105536478, "body": "Old post, but if someone looks for this, a recommended reading is <a href=\"https://pixcels.nl/events-in-workbooks/\" rel=\"nofollow noreferrer\">this article</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4530525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5461e10d6b78b26221ba90ef749f6c?s=128&d=identicon&r=PG&f=1", "display_name": "jaegee", "link": "https://stackoverflow.com/users/4530525/jaegee"}, "edited": false, "score": 0, "creation_date": 1423098736, "post_id": 28332562, "comment_id": 45015659, "body": "Thank you so much, that seems to have resolved the issue! Are you able to explain why/how the resolution works? That is, what is the cause of the problem, why did it suddenly eventuate? Thanks again!"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 43, "user_id": 4530525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5461e10d6b78b26221ba90ef749f6c?s=128&d=identicon&r=PG&f=1", "display_name": "jaegee", "link": "https://stackoverflow.com/users/4530525/jaegee"}, "edited": false, "score": 1, "creation_date": 1423143666, "post_id": 28332562, "comment_id": 45035040, "body": "@jaegee, the activate event will not happen if the sheet is the one currently active.  It&#39;s just a bug in Excel.  Also, please mark my answer as correct with the green checkmark."}], "tags": [], "owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "is_accepted": true, "score": 2, "last_activity_date": 1423088227, "creation_date": 1423088227, "answer_id": 28332562, "question_id": 28332443, "link": "https://stackoverflow.com/questions/28332443/worksheet-activate-not-triggering-when-workbook-opened/28332562#28332562", "title": "Worksheet_Activate not triggering when workbook opened", "body": "<p>In your <code>Workbook_Open</code> event turn off <code>ScreenUpdating</code>, activate a different sheet, activate the sheet you want the event to fire, turn <code>ScreenUpdating</code> back on.</p>\n"}, {"comments": [{"owner": {"reputation": 756, "user_id": 2040023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3781c26eee05ffc874b134ea0e55762f?s=128&d=identicon&r=PG", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/2040023/john-joseph"}, "edited": false, "score": 0, "creation_date": 1580760065, "post_id": 39527853, "comment_id": 106196023, "body": "Just underscoring/restating that it&#39;s important to change the Activate subroutine declaration from private (the default) to public.  e.g. &quot;Private Sub Worksheet_Activate()&quot; should be changed to &quot;Public Sub Worksheet_Activate()&quot; Otherwise, this won&#39;t work."}, {"owner": {"reputation": 115, "user_id": 6838748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7c6dc6275dd8fc484957f659aa942b?s=128&d=identicon&r=PG", "display_name": "Wim", "link": "https://stackoverflow.com/users/6838748/wim"}, "reply_to_user": {"reputation": 756, "user_id": 2040023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3781c26eee05ffc874b134ea0e55762f?s=128&d=identicon&r=PG", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/2040023/john-joseph"}, "edited": false, "score": 0, "creation_date": 1580896840, "post_id": 39527853, "comment_id": 106245591, "body": "@JohnJoseph: that&#39;s exactly what I wrote in the comments of the Workbook_Open() sub in my answer. The error handler is just there to catch the &quot;Object doesn&#39;t support this property or method&quot;-error that would be raised by calling a private or non-existing Worksheet_Activate() routine."}, {"owner": {"reputation": 756, "user_id": 2040023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3781c26eee05ffc874b134ea0e55762f?s=128&d=identicon&r=PG", "display_name": "John Joseph", "link": "https://stackoverflow.com/users/2040023/john-joseph"}, "edited": false, "score": 0, "creation_date": 1581012339, "post_id": 39527853, "comment_id": 106296889, "body": "yep, I know - that&#39;s why I said &quot;underscoring/restating&quot; - it&#39;s important but easy to miss. Great answer - it helped me! I up-voted it."}], "tags": [], "owner": {"reputation": 115, "user_id": 6838748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7c6dc6275dd8fc484957f659aa942b?s=128&d=identicon&r=PG", "display_name": "Wim", "link": "https://stackoverflow.com/users/6838748/wim"}, "is_accepted": false, "score": 11, "last_activity_date": 1474017595, "last_edit_date": 1495542649, "creation_date": 1474017595, "answer_id": 39527853, "question_id": 28332443, "link": "https://stackoverflow.com/questions/28332443/worksheet-activate-not-triggering-when-workbook-opened/39527853#39527853", "title": "Worksheet_Activate not triggering when workbook opened", "body": "<p>I know this is an older question, but there is no need to first activate another worksheet and then re-activate the one you want:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    ' Bug in Excel:\n    ' The Worksheet_Activate event does not fire for the sheet that is active\n    ' when the workbook is opened, so call it explicitely. Make sure that\n    ' Worksheet_Activate() is declared as Public.\n    ' Ignore ActiveSheets without (Public) Worksheet_Activate()\n    On Error Resume Next\n    Call ActiveSheet.Worksheet_Activate\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>It's also not good practice to reference a worksheet by <em>Name</em> like in <code>Worksheets(\"Sheet1\")</code>, unless you have a very good reason to do so. Better is to use the <em>CodeName</em>. For details, see <a href=\"https://stackoverflow.com/questions/2649844/excel-tab-sheet-names-vs-visual-basic-sheet-names\">this post</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 4530525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d5461e10d6b78b26221ba90ef749f6c?s=128&d=identicon&r=PG&f=1", "display_name": "jaegee", "link": "https://stackoverflow.com/users/4530525/jaegee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14727, "favorite_count": 1, "accepted_answer_id": 28332562, "answer_count": 2, "score": 4, "last_activity_date": 1474017595, "creation_date": 1423087779, "question_id": 28332443, "link": "https://stackoverflow.com/questions/28332443/worksheet-activate-not-triggering-when-workbook-opened", "title": "Worksheet_Activate not triggering when workbook opened", "body": "<p>Two days ago my code to populate ActiveX combo boxes in my Excel sheets stopped functioning when I open the document. I have since discovered that the Worksheet_Activate() no longer triggers when I open sheets.</p>\n\n<p>Now even if I create a simple workbook with only the following code in Sheet 1, it doesn't trigger when I open the workbook.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n   MsgBox (\"Worksheet has been activated\")\nEnd Sub\n</code></pre>\n\n<p>However, if I click on another tab and click back to the sheet containing the code, it does trigger.</p>\n\n<p>I have tried playing with adding Application.EnableEvents = True and Worksheets(\"Sheet1\").Activate to the Workbook_Open (which does trigger) but still no luck.</p>\n\n<p>We're running Excel 2010 and the same problem is occurring on my colleagues' machines as well. Any ideas?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1423087000, "post_id": 28332188, "comment_id": 45011558, "body": "Why do you want to? Personally, I think it sounds like a flawed design if you need to <i>force</i> the user&#39;s focus to a specific area. Can you give more background as to why you need this functionailty?"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1423087193, "post_id": 28332188, "comment_id": 45011650, "body": "You will have to specify the record as well as the control (fieldbox).  I agree with the comment that more info will prolly help us."}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "edited": false, "score": 1, "creation_date": 1423087467, "post_id": 28332188, "comment_id": 45011790, "body": "If you enter bad data, force the user back to the fieldbox for correction before any other events occur."}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "reply_to_user": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1423087704, "post_id": 28332188, "comment_id": 45011897, "body": "@smandoli, do you have any code examples for specifying the record and control? are they currentRecord and gotoRecord?"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1423091243, "post_id": 28332188, "comment_id": 45013499, "body": "Having learned that data-validation is the goal, my advice to specify-the-record isn&#39;t applicable."}], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423088156, "post_id": 28332420, "comment_id": 45012107, "body": "He might be able to do similar with <code>Me.fieldbox</code>&#39;s Before Update."}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "edited": false, "score": 0, "creation_date": 1423088227, "post_id": 28332420, "comment_id": 45012147, "body": "yea I was afraid you lead into beforeUpdate with a me.undo ultimatum. What I was trying to set up was a complete workaround to beforeUpdate cancle = true not working, and me.undo completely wiping out changes made. I hate this approach because a number of things can occur before beforeUpdate happens. In which case if the field in question was wrong, it wipes out all changes that could have happened afterwards. Hence why I&#39;m trying to put the attention immediately to the bad entry."}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423089051, "post_id": 28332420, "comment_id": 45012503, "body": "@HansUp trying beforeUpdate for the fieldbox produces error 2108. you must save the field before you execute ... the setfocus method."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "edited": false, "score": 0, "creation_date": 1423089289, "post_id": 28332420, "comment_id": 45012603, "body": "@thomas Perhaps I overlooked some details because I&#39;m unsure whether I&#39;m on the same page as you.  But I can tell you that when you set <code>Cancel = True</code> in <code>Me.fieldbox</code>&#39;s Before Update event procedure, the focus remains on <code>Me.fieldbox</code> ... so <code>SetFocus</code> not needed there."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423089564, "post_id": 28332420, "comment_id": 45012719, "body": "Thank you @HansUp.  My sample code needs your insights."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1423089738, "post_id": 28332420, "comment_id": 45012799, "body": "@Smandoli I still don&#39;t understand exactly what thomas wants.  ;-)"}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423089869, "post_id": 28332420, "comment_id": 45012868, "body": "@hansup I just tried cancle = true without setfocus on the fieldbox. it doesn&#39;t work, I can click out of it no problem. In my experience, cancel=true has not worked for me with anything. If it did, I wouldn&#39;t have to be jumping hoops for this and I&#39;d just use the form&#39;s beforeUpdate to control everything. But as it stands, it doesn&#39;t work for me. Thanks for the help"}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "edited": false, "score": 0, "creation_date": 1423090799, "post_id": 28332420, "comment_id": 45013313, "body": "@Smandoli  I want Access&#39; front end to prevent users from entering bad data. Of course users can enter bad data a long with other fields/subforms. A number of edits (without save) can occur, before user decides to hit save. I&#39;d love form beforeUpdate to check against everything, but since cancel = true still proceeds to update/afterUpdate, it doesn&#39;t do me any good. And the only answer I&#39;ve gotten was me.undo, which wipes out all user&#39;s recent edits. If cancel = true for the form&#39;s beforeUpdate worked, I wouldn&#39;t need to be doing this."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 1, "creation_date": 1423091119, "post_id": 28332420, "comment_id": 45013461, "body": "I empathize because I&#39;ve been in the same kind of spot: form-automation can be very frustrating.  I&#39;m sure this general approach is what you need.  You have to try and test until you get to the desired result."}, {"owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "edited": false, "score": 0, "creation_date": 1423091944, "post_id": 28332420, "comment_id": 45013758, "body": "Access is just clunky, I&#39;ve tested so many options as work around. A lot of times I just let the regular error go up as it handles exactly what I&#39;d want it to do. It&#39;s just ugly for users and when they see it they panic so much."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1423143911, "post_id": 28332420, "comment_id": 45035236, "body": "You say the regular error &quot;handles exactly what you&#39;d want it to do&quot;.  But in this case, it still leaves the control focus problem, does it not?"}], "tags": [], "owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "is_accepted": false, "score": 1, "last_activity_date": 1423090035, "last_edit_date": 1423090035, "creation_date": 1423087667, "answer_id": 28332420, "question_id": 28332188, "link": "https://stackoverflow.com/questions/28332188/how-to-set-focus-in-access-continuous-form-vba/28332420#28332420", "title": "How to Set Focus in Access Continuous Form (VBA)", "body": "<p>You need to use the form's <code>BeforeUpdate()</code> event instead of focus:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel as Integer)\nIf RecordOK = False Then\n  Dim response, strMsg as String\n  strMsg = \"There is data missing from the record.  \" _\n    &amp; vbCrLf &amp; \"Press Yes to continue, editing.  \" _\n    &amp; vbCrLf &amp; \"Press No to discard all changes.\"\n  Cancel = True\n  response = MsgBox(strMsg, vbYesNo)\n  If response &lt;&gt; vbYes\n    Me.Undo\n  End If\nEnd If\n</code></pre>\n\n<p>Code above is not tested, may need some tweaks, paste and see.  My recent update provides cleaner handling of the user's response to the dialog box.  (You do have <code>Option Explicit</code> set, don't you?!)</p>\n\n<p>A good explanation of this method at the <strong>control</strong> level is found <a href=\"http://www.blueclaw-db.com/access_event_programming/beforeupdate.htm\" rel=\"nofollow\">here</a>.  But you may want to use the <strong>form</strong> event, as above.  Sometimes I just temporarily insert <code>Msgbox</code> cues in the events so I can see what is firing when.</p>\n\n<p>Note the dialog box should provide clues on how to avoid wiping the work done so far by a user.</p>\n"}], "owner": {"reputation": 51, "user_id": 4028969, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9a7bff969c1ee5b4aa4c83372cc3fb9b?s=128&d=identicon&r=PG&f=1", "display_name": "thomas", "link": "https://stackoverflow.com/users/4028969/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1744, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1423090035, "creation_date": 1423086744, "question_id": 28332188, "link": "https://stackoverflow.com/questions/28332188/how-to-set-focus-in-access-continuous-form-vba", "title": "How to Set Focus in Access Continuous Form (VBA)", "body": "<p>Right now it's being ignored. Here's the code at it's most basic, it causes an inescapable scenario currently, but I plan to condition these out. Just need to get the basic setFocus working.</p>\n\n<pre><code>Private Sub fieldbox_LostFocus() \nMe.fieldbox.SetFocus\nEnd Sub\n</code></pre>\n\n<p>In a regular form, it works as expected. When fieldbox loses focus, the focus is set back onto fieldbox.</p>\n\n<p>In a continuous form, it does not work, and the set focus does not happen. This is possibly due to multiple instances of fieldbox existing for each record.</p>\n\n<p>What I'd like is if fieldbox1, 2 and 3 exist on the continuous form, and you click out of fieldbox2, how do I set focus back to fieldbox2?</p>\n"}, {"tags": ["excel", "vba", "listobject"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1423087823, "post_id": 28331937, "comment_id": 45011952, "body": "Perhaps you can copy the .DataBodyRange in a single step."}, {"owner": {"reputation": 15, "user_id": 4680747, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-mSypH1NQSfM/AAAAAAAAAAI/AAAAAAAAADU/OrY_bITGeFI/photo.jpg?sz=128", "display_name": "Joe Noble", "link": "https://stackoverflow.com/users/4680747/joe-noble"}, "edited": false, "score": 0, "creation_date": 1556207870, "post_id": 28331937, "comment_id": 98371890, "body": "Ron Rosenfield&#39;s response above worked for me AFTER I removed the totals rows. Maybe that&#39;s why Schmalls couldn&#39;t get it to work. I would add this as a comment, but I don&#39;t have the reputation."}], "answers": [{"tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 1, "last_activity_date": 1423086972, "creation_date": 1423086972, "answer_id": 28332248, "question_id": 28331937, "link": "https://stackoverflow.com/questions/28331937/how-do-i-append-multiple-rows-from-one-excel-table-listobject-to-another/28332248#28332248", "title": "How do I Append Multiple Rows from one Excel Table (ListObject) to Another?", "body": "<p>Try using the SQL union statement for fast table joining (ODBC):</p>\n\n<pre><code>SELECT * FROM [Sheet1$] UNION SELECT * FROM [Sheet2$]\n</code></pre>\n\n<p>where Table 1 is on a sheet named \"Sheet1\" and Table 2 on \"Sheet2\".</p>\n\n<p>Do this by going to \"Data->From other sources->From Microsoft Query\"</p>\n"}, {"comments": [{"owner": {"reputation": 1284, "user_id": 351251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345b240a05deeafcdb22be96c45a2275?s=128&d=identicon&r=PG", "display_name": "Schmalls", "link": "https://stackoverflow.com/users/351251/schmalls"}, "edited": false, "score": 1, "creation_date": 1433533006, "post_id": 28332430, "comment_id": 49410673, "body": "This sent me in the correct direction. It however did not append the rows to the table, it just pasted them after the table. I had to add the step of creating a new table row at the bottom of the table and using that as the destination for my copy. For example, the last line would be replaced with: <code>LO2.DataBodyRange.Copy Destination:=LO1.DataBodyRange.ListRows.Add.Resize(1, 1)</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1284, "user_id": 351251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345b240a05deeafcdb22be96c45a2275?s=128&d=identicon&r=PG", "display_name": "Schmalls", "link": "https://stackoverflow.com/users/351251/schmalls"}, "edited": false, "score": 0, "creation_date": 1433534298, "post_id": 28332430, "comment_id": 49411361, "body": "@Schmalls  It works properly without those changes here (Excel 2007), so I&#39;m guessing there&#39;s something different about either your environment or your data."}, {"owner": {"reputation": 1284, "user_id": 351251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345b240a05deeafcdb22be96c45a2275?s=128&d=identicon&r=PG", "display_name": "Schmalls", "link": "https://stackoverflow.com/users/351251/schmalls"}, "edited": false, "score": 0, "creation_date": 1433539033, "post_id": 28332430, "comment_id": 49413648, "body": "That is weird that I had that output then. I guess mine can just be an alternate version if anyone runs into the same issue."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 4, "last_activity_date": 1423186269, "last_edit_date": 1423186269, "creation_date": 1423087717, "answer_id": 28332430, "question_id": 28331937, "link": "https://stackoverflow.com/questions/28331937/how-do-i-append-multiple-rows-from-one-excel-table-listobject-to-another/28332430#28332430", "title": "How do I Append Multiple Rows from one Excel Table (ListObject) to Another?", "body": "<p>Perhaps this, changing the worksheet appropriately:</p>\n\n<pre><code>Option Explicit\nSub CombineTables()\n    Dim LO1 As ListObject, LO2 As ListObject\n\nWith Sheet3\n    Set LO1 = .ListObjects(\"Table_1\")\n    Set LO2 = .ListObjects(\"Table_2\")\nEnd With\n\nLO2.DataBodyRange.Copy Destination:= _\n    LO1.DataBodyRange.Offset(LO1.DataBodyRange.Rows.Count).Resize(1, 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5514955, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0d4b5eae0706fd784264bb19cc65b37a?s=128&d=identicon&r=PG", "display_name": "icek", "link": "https://stackoverflow.com/users/5514955/icek"}, "is_accepted": false, "score": 0, "last_activity_date": 1446453214, "last_edit_date": 1446453214, "creation_date": 1446451616, "answer_id": 33473123, "question_id": 28331937, "link": "https://stackoverflow.com/questions/28331937/how-do-i-append-multiple-rows-from-one-excel-table-listobject-to-another/33473123#33473123", "title": "How do I Append Multiple Rows from one Excel Table (ListObject) to Another?", "body": "<p>Copy the Source table and Special paste Values + formating in temp range</p>\n\n<ul>\n<li>Cut the temp range</li>\n<li>Add a last row to the Destination Table</li>\n<li>Select the Last Row</li>\n<li>Insert the Cut selection into the Destination Table with Shift:=xlDown</li>\n<li>Delete the last row it you don't want it</li>\n</ul>\n"}], "owner": {"reputation": 305, "user_id": 2271875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a31d8ac2c9c4a637e3da857bf8698cd7?s=128&d=identicon&r=PG", "display_name": "user2271875", "link": "https://stackoverflow.com/users/2271875/user2271875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7368, "favorite_count": 2, "answer_count": 3, "score": 5, "last_activity_date": 1556207870, "creation_date": 1423085826, "last_edit_date": 1423086197, "question_id": 28331937, "link": "https://stackoverflow.com/questions/28331937/how-do-i-append-multiple-rows-from-one-excel-table-listobject-to-another", "title": "How do I Append Multiple Rows from one Excel Table (ListObject) to Another?", "body": "<p>I have two tables:</p>\n\n<pre><code>    Table_1         Table_2\n   A   B   C       A   B   C\n -------------   -------------\n1| A1| B1| C1|  1| A2| B2| C2|\n2| A1| B1| C1|  2| A2| B2| C2|\n3| A1| B1| C1|  3| A2| B2| C2|\n</code></pre>\n\n<p>Resulting table:</p>\n\n<pre><code>    Table_1   \n   A   B   C  \n -------------\n1| A1| B1| C1|\n2| A1| B1| C1|\n3| A1| B1| C1|\n4| A2| B2| C2|\n5| A2| B2| C2|\n6| A2| B2| C2|\n</code></pre>\n\n<p>Table_2 is a temporary table (ListObject) that queries a database for entries using data connection.</p>\n\n<p>Table_1 is a table (ListObject) that acts as a collective list of entries.  It is kept separate because it (1) shortens the query time in Table_2 and (2) has some programmatic edits.</p>\n\n<p>I have VBA code that copies Table_2 to Table_1 and then updates the connection string for Table_2 to not include entries with dates within the range of Table_1.  The result is that Table_2 only pulls new data.</p>\n\n<p>My code (correctly) copies data from Table_2 to Table_1:</p>\n\n<pre><code>For Each temprow in Table_2.ListRows\n  Set newRow = table_1.ListRows.Add\n  tempRow.Range.Copy\n  newRow.Range.PasteSpecial xlPasteValues\nNext\n</code></pre>\n\n<p>This works great if Table_2 (new entries) only has a dozen entries. Occasionally, Table_2 will have a couple hundred entries, which will literally take 20 minutes to complete.  I suspect it's because I'm doing a couple hundred iterations of .Copy and .Paste.</p>\n\n<p>Is there a way I can do it wholesale: copy ALL of Table_2 and just make it part of Table_1? I feel like what I want to do should only take 1 second to execute programmatically, not 20 minutes.  I have no conditions or exceptions.  I want EVERYTHING from Table_2, which should make it easy.  I'm probably going about it the wrong way.  Any help is appreciated.  Thanks.</p>\n"}, {"tags": ["vba", "excel", "import", "copy"], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1423091071, "post_id": 28332302, "comment_id": 45013437, "body": "Thanks for the help. I have put that line into my code but I am getting a Type Mismatch error (Office 2013 doesn&#39;t tell me where specifically this is happening). When I was at work and getting this error on an older version, I think it highlighted the &quot;If OpenFileName = False Then&quot; line as where it would stop. I&#39;ve never had to deal with this before."}, {"owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "reply_to_user": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "edited": false, "score": 0, "creation_date": 1423127719, "post_id": 28332302, "comment_id": 45025269, "body": "Replace <code>Dim OpenFileName As String</code> with <code>Dim OpenFileName As Variant</code>. The function Application.GetOpenFilename returns a Variant type."}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": true, "score": 0, "last_activity_date": 1423087207, "creation_date": 1423087207, "answer_id": 28332302, "question_id": 28331339, "link": "https://stackoverflow.com/questions/28331339/copy-import-cells-from-another-spreadsheet-into-active-sheet/28332302#28332302", "title": "Copy (Import) cells from another spreadsheet into active sheet", "body": "<p>Your code isn't bad at all for a beginner. Assuming you are copying to the same range in the other sheet you only need one line in your for loop.</p>\n\n<pre><code>myRng.Copy Destination:=MyWB.Worksheets(myRng.Name).Range(\"A6:AV45\")\n</code></pre>\n\n<p>This will copy everything including the formatting.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 4455912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d931ddbf0d8db7c527bcdb642f05e35f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomson Tam", "link": "https://stackoverflow.com/users/4455912/thomson-tam"}, "is_accepted": false, "score": 0, "last_activity_date": 1423107391, "creation_date": 1423107391, "answer_id": 28335766, "question_id": 28331339, "link": "https://stackoverflow.com/questions/28331339/copy-import-cells-from-another-spreadsheet-into-active-sheet/28335766#28335766", "title": "Copy (Import) cells from another spreadsheet into active sheet", "body": "<p>Please try the following: </p>\n\n<pre><code>If OpenFileName = \"False\" then\n</code></pre>\n\n<p>I tested from my machine and if you DIM OpenFileName as String than it will pass \"False\" into OpenFileName if you select nothing.</p>\n\n<p>PS: Both OpenFileName = False and OpenFileName = \"False\" work on my end, so do anyone got the answer?</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "is_accepted": false, "score": 0, "last_activity_date": 1423916625, "creation_date": 1423916625, "answer_id": 28515592, "question_id": 28331339, "link": "https://stackoverflow.com/questions/28331339/copy-import-cells-from-another-spreadsheet-into-active-sheet/28515592#28515592", "title": "Copy (Import) cells from another spreadsheet into active sheet", "body": "<p>Apologies that I have not been on to respond to the suggestions that you have given me. Everything that was said helped.</p>\n\n<p>Paul, listing as a Variant was the right way to go, and Thomas, the \"\" also helped get past the error. Unfortunately after I had done these I was met with a 400 error so there was an issue with something I had done.</p>\n\n<p>In the end I was able to figure it out and the following code works... In a very crude way:</p>\n\n<pre><code>'Import Incident\nSub ImportIncidents()\n\nDim OpenFileName As Variant\nDim wb As Workbook\nDim ws As Worksheet\nDim myRng As Range\nDim MyWB As Workbook\n\n'store the current workbook in a variable\nSet MyWB = ActiveWorkbook\n\n'Select and Open workbook\nOpenFileName = Application.GetOpenFilename\n\nIf OpenFileName = False Then\n    MsgBox (\"Import Failed!\")\n    Exit Sub\nEnd If\n\nSet wb = Workbooks.Open(OpenFileName, UpdateLinks:=0)\n\n'Import Data\nwb.Activate\nApplication.DisplayAlerts = False\nFor Each ws In wb.Worksheets\n\n\n                Set myRng = ws.Range(\"A6:AV45\")\n                    myRng.Copy Destination:=MyWB.Worksheets(myRng.Parent.Name).Range(\"A6:AV45\")\n                    'ActiveWorkbook.Close = False\n                    MyWB.Activate\n\nNext\nApplication.DisplayAlerts = True\n    MsgBox (\"Import Complete!\")\n\nEnd Sub\n</code></pre>\n\n<p>This is a great start and I am now working on having it only go through the sheets I want it to by using a for loop linked to the months of the year (which is how the sheets are laid out. I dont need to copy the data sheets after all as that may cause problems).</p>\n\n<p>Thanks for all your help</p>\n"}], "owner": {"reputation": 136, "user_id": 4530363, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w66fS.jpg?s=128&g=1", "display_name": "JaayB", "link": "https://stackoverflow.com/users/4530363/jaayb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3265, "favorite_count": 0, "accepted_answer_id": 28332302, "answer_count": 3, "score": 0, "last_activity_date": 1443210676, "creation_date": 1423083621, "last_edit_date": 1443210676, "question_id": 28331339, "link": "https://stackoverflow.com/questions/28331339/copy-import-cells-from-another-spreadsheet-into-active-sheet", "title": "Copy (Import) cells from another spreadsheet into active sheet", "body": "<p>I'm a very novice VBA programmer. I only get to do it in my downtime between work things. Anyways I have been working on an incident tracker for myself and colleagues and to help them out when I update it with new features I have been trying to add an \"Import\" feature. </p>\n\n<p>The thing is there is a separate worksheet for each month (Jan to Dec and another sheet for overtime called OT). The code needs to copy from the correct sheet and paste into the sheet with the same name.</p>\n\n<p>I can't quite get it to work though. This is what I have so far:</p>\n\n<pre><code>'Import Incident\nSub ImportIncidents()\n\nDim OpenFileName As String\nDim wb As Workbook\nDim ws As Worksheet\nDim myRng As Range\nDim MyWB As Workbook\n\n'store the current workbook in a variable\nSet MyWB = ActiveWorkbook\n\n'Select and Open workbook\nOpenFileName = Application.GetOpenFilename\n\nIf OpenFileName = False Then\n    MsgBox (\"Import Failed!\")\n    Exit Sub\nEnd If\n\nSet wb = Workbooks.Open(OpenFileName, UpdateLinks:=0)\n\n'Get data\nwb.Activate\nFor Each ws In wb.Worksheets\n\n                Set myRng = ws.Range(\"A6:AV45\")\n                myRng.Copy\n                MyWB.Activate\n\n\n                Set myRng =\n\n                wb.Activate\n\nNext\n\n\nMsgBox (\"Import Complete!\")\n\nEnd Sub\n</code></pre>\n\n<p>If anyone could help me out that would be amazing. I am sure I will be able to get the hang of it after I work through my VBA book properly (VBA for Dummies, ahah!) But I am having trouble finding a weekend to sit down and do it when I do a lot of overtime.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423082056, "post_id": 28330760, "comment_id": 45008939, "body": "When you say <i>essentially</i> - is actually a range OR an array?"}, {"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423082234, "post_id": 28330760, "comment_id": 45009036, "body": "I have been experimenting with using an actual range, and then use the values of that range to populate an array.  I am not sure which is the better approach for what I want to do."}, {"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423082456, "post_id": 28330760, "comment_id": 45009157, "body": "Let me work up a quick summary of what I am trying to do because maybe I am going about this wrong."}, {"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423083593, "post_id": 28330760, "comment_id": 45009787, "body": "Edited my question and added more detail on what I am doing."}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1423082793, "post_id": 28330903, "comment_id": 45009360, "body": "Nice example for tutorial purposes (+1)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1423084732, "last_edit_date": 1423084732, "creation_date": 1423082006, "answer_id": 28330903, "question_id": 28330760, "link": "https://stackoverflow.com/questions/28330760/vba-arrays-and-variants/28330903#28330903", "title": "VBA arrays and variants", "body": "<p>This illustrates use of 1-D or 2-D arrays from a range</p>\n\n<pre><code>Sub GetCellDataInArrays()\n\n    Dim rng As Range, a, a2, data, r, c\n\n    Set rng = ActiveSheet.Range(\"A1:D12\")\n\n    'get a column: Transpose creates a 1-D array\n    a = Application.Transpose(rng.Columns(2).Value)\n\n    Debug.Print \"Column 2: \", Join(a, \",\")\n\n    'get a row - note the double Transpose\n    a2 = Application.Transpose(Application.Transpose( _\n                 rng.Rows(3).Value))\n\n    Debug.Print \"Row 3:\", Join(a2, \",\")\n\n\n    'EDIT: how to loop over a 2-D array obtained from a worksheet range\n    data = rng.Value 'data is a 2-d 1-based array\n    For r = 1 To UBound(data, 1)\n        For c = 1 To UBound(data, 2)\n            Debug.Print \"Row \" &amp; r &amp; \":Col \" &amp; c &amp; \" = \", data(r, c)\n        Next c\n    Next r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423084703, "post_id": 28331473, "comment_id": 45010342, "body": "Thanks, I didn&#39;t even think of using the .Columns property.  That will definitely help some of my issues.  I think that some of my VBA problems comes about from confusion about range datatypes.  I mean what is a range?  I would have expected a range to be a collections of cells and that I could somehow access a single cell and I could then use TypeName() on it to return a type of cell.  Instead, I seem to still get a type of range!  It gets confusing!"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423085191, "post_id": 28331473, "comment_id": 45010593, "body": "@TimothyBramlett, in Excel, a cell is a range.  It is simply a 2-dimensional array with only 1 member in each dimension.  It&#39;s really flexible in VBA.  You can use <code>Range(&quot;range&quot;).Cells(row,col)</code> or <code>Range(x).Column(y).Cells(row,col)</code>, etc."}, {"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423085560, "post_id": 28331473, "comment_id": 45010781, "body": "Ok, so that is really interesting then.  So, when I declare something as a range, then I am not giving it a location, I am actually declaring it as a collection of cells and it has all the normal properties that a cell/range would.  See, I was thinking of a range as like a location or address that referred to some group of other objects."}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423085850, "post_id": 28331473, "comment_id": 45010949, "body": "I can see how it would be confusing for someone used to the complexity of C/C++ or Java, etc.  You can get a Python library to work with excel files if all you need are the values."}, {"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423086368, "post_id": 28331473, "comment_id": 45011219, "body": "Well and C is more precise to me in some ways.  It doesn&#39;t usually do things to help me that cause me to not understand what is going on later on down the road.  But then again it takes forever to develop in C.  Python  would be fantastic to work in for this, but unfortunately I need VBA because I am building a small application that is actually in Excel.  Still, I am probably just having these problems because I don&#39;t have that much experience in VB/VBA.  I always heard that VBA is a nightmare but I have found that it is not too bad to work in! :)"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423086886, "post_id": 28331473, "comment_id": 45011489, "body": "@TimothyBramlett, VBA the language is not bad... interfacing with Office products is where you&#39;ll find the problems."}, {"owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423236354, "post_id": 28331473, "comment_id": 45078907, "body": "I keep getting a type mismatch when I try to debug.print the contents of a column by using range.columns.  Any ideas?"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "edited": false, "score": 0, "creation_date": 1423237695, "post_id": 28331473, "comment_id": 45079721, "body": "You have to use the Join function to convert and array to a string."}], "tags": [], "owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "is_accepted": true, "score": 1, "last_activity_date": 1423085975, "last_edit_date": 1423085975, "creation_date": 1423084090, "answer_id": 28331473, "question_id": 28330760, "link": "https://stackoverflow.com/questions/28330760/vba-arrays-and-variants/28331473#28331473", "title": "VBA arrays and variants", "body": "<p>Range objects are quite flexible in Excel.  You can do what you want in many ways.  I'll give two examples:</p>\n\n<pre><code>For i = 1 to 10\n     b = Range(\"yourRange\").Cells(i, yourColumn) + 1\n Next i\n</code></pre>\n\n<p>If you assign a constant value to the column you can easily loop through the rows as shown.  Or if you're more comfortable with a For Each loop:</p>\n\n<pre><code>For each c in Range(\"yourRange\").Columns(1)\n     b = c + 1\nNext\n</code></pre>\n\n<p>VBA treats every Excel range as a 2-Dimensional array in any case.  You can even use normal array syntax like: <code>Range(\"yourRange\")(row, col)</code></p>\n"}], "owner": {"reputation": 1637, "user_id": 3724464, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/TwFbe.jpg?s=128&g=1", "display_name": "timbram", "link": "https://stackoverflow.com/users/3724464/timbram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 1, "accepted_answer_id": 28331473, "answer_count": 2, "score": 1, "last_activity_date": 1423085975, "creation_date": 1423081496, "last_edit_date": 1531164843, "question_id": 28330760, "link": "https://stackoverflow.com/questions/28330760/vba-arrays-and-variants", "title": "VBA arrays and variants", "body": "<p>VBA arrays and variant arrays are confusing me!</p>\n\n<p>If I have a two dimensional array that is essentially a range on a spreadsheet, is there a way to set a 1 dimensional new array that is equal to just one of those columns in the 2 dimensional array?</p>\n\n<p>Does that make sense?   </p>\n\n<p>Edit:</p>\n\n<p>I have a spreadsheet that is a quote template.  Some of these products that I am quoting are products that we do not want to quote because they do not meet our guidelines.  </p>\n\n<p>I want to go through these rows of products and identify which ones are bad by checking if the product has a field that says \u201ckick\u201d.  If it does, then I am going to make other fields for that row (product) a kick as well.  Simple macro.  The problem is that I come from Python and C and I tend to think of these spreadsheets as a bunch of 1 dimensional arrays and I usually write loops to go through them.</p>\n\n<p>What I have done in the past is take that range and I just create a bunch of 1 dimensional arrays that I then loop through with a \u201cfor loop\u201d or a \u201cfor each loop\u201d.  That approach works fine, but it is a pain to assign all the 1dimensional arrays.  Today I thought, well maybe there is a way I just do the same thing but with a 2 dimensional array, since it would be easy to quickly assign a whole range as a 2 dimensional array.</p>\n\n<p>Anyway, the problem I am having is that I do not know how to reference just one dimension(col) of a two dimensional array.</p>\n\n<p>Can I do a for each loop on one column of a 2D array?</p>\n"}, {"tags": ["vba", "excel", "reflection", "parameters"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 4, "creation_date": 1423082009, "post_id": 28330713, "comment_id": 45008913, "body": "Put simply, you can&#39;t - VBA doesn&#39;t support this."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1423083196, "post_id": 28330713, "comment_id": 45009581, "body": "VBA doesn&#39;t support any sort of reflection."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1423083396, "post_id": 28330713, "comment_id": 45009685, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/14200535/parsing-vba-module-function-parameters-via-reflection\">Parsing VBA Module function parameters via reflection</a>"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 3, "creation_date": 1423084353, "post_id": 28330713, "comment_id": 45010179, "body": "Someday I&#39;m going to blow through all of the vba + reflection questions and give answers to them all. Mark my words. I&#39;ll make it possible."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1423084767, "post_id": 28330713, "comment_id": 45010381, "body": "@RubberDuck <a href=\"https://github.com/retailcoder/Rubberduck/blob/master/README.md\" rel=\"nofollow noreferrer\">I know you will</a>!"}], "answers": [{"tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1423163593, "last_edit_date": 1423163593, "creation_date": 1423162370, "answer_id": 28351805, "question_id": 28330713, "link": "https://stackoverflow.com/questions/28330713/how-to-return-name-of-parameter-in-vba/28351805#28351805", "title": "How to return name of parameter in VBA", "body": "<p>I believe I have accomplished what you are looking to do here. However, please note that this will currently only work for your first parameter in a macro assigned to a Form control:</p>\n\n<p><strong>Step 1</strong></p>\n\n<p>Add the following code, adapted from <a href=\"http://www.rondebruin.nl/win/s9/win002.htm\" rel=\"nofollow\">here</a>, to a new Module:</p>\n\n<pre><code>Public Function ExportModules(ModuleName As String) As String\n    Dim bExport As Boolean\n    Dim wkbSource As Excel.Workbook\n    Dim szSourceWorkbook As String\n    Dim szExportPath As String\n    Dim szFileName As String\n    Dim cmpComponent As VBIDE.VBComponent\n\n    ''' The code modules will be exported in a folder named.\n    ''' VBAProjectFiles in the Documents folder.\n    ''' The code below create this folder if it not exist\n    ''' or delete all files in the folder if it exist.\n    If FolderWithVBAProjectFiles = \"Error\" Then\n        MsgBox \"Export Folder not exist\"\n        Exit Function\n    End If\n\n    On Error Resume Next\n        Kill FolderWithVBAProjectFiles &amp; \"\\*.*\"\n    On Error GoTo 0\n\n    ''' NOTE: This workbook must be open in Excel.\n    szSourceWorkbook = ActiveWorkbook.Name\n    Set wkbSource = Application.Workbooks(szSourceWorkbook)\n\n    If wkbSource.VBProject.Protection = 1 Then\n    MsgBox \"The VBA in this workbook is protected,\" &amp; _\n        \"not possible to export the code\"\n    Exit Function\n    End If\n\n    szExportPath = FolderWithVBAProjectFiles &amp; \"\\\"\n\n    Set cmpComponent = wkbSource.VBProject.VBComponents(ModuleName)\n\n        bExport = True\n        szFileName = cmpComponent.Name\n\n        ''' Concatenate the correct filename for export.\n        Select Case cmpComponent.Type\n            Case vbext_ct_ClassModule\n                szFileName = szFileName &amp; \".cls\"\n            Case vbext_ct_MSForm\n                szFileName = szFileName &amp; \".frm\"\n            Case vbext_ct_StdModule\n                szFileName = szFileName &amp; \".bas\"\n            Case vbext_ct_Document\n                ''' This is a worksheet or workbook object.\n                ''' Don't try to export.\n                bExport = False\n        End Select\n\n        If bExport Then\n            ''' Export the component to a text file.\n            cmpComponent.Export szExportPath &amp; szFileName\n\n        ''' remove it from the project if you want\n        '''wkbSource.VBProject.VBComponents.Remove cmpComponent\n\n        End If\n\n    ExportModules = szExportPath &amp; szFileName\nEnd Function\n\nFunction FolderWithVBAProjectFiles() As String\n    Dim WshShell As Object\n    Dim FSO As Object\n    Dim SpecialPath As String\n\n    Set WshShell = CreateObject(\"WScript.Shell\")\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n    SpecialPath = WshShell.SpecialFolders(\"MyDocuments\")\n\n    If Right(SpecialPath, 1) &lt;&gt; \"\\\" Then\n        SpecialPath = SpecialPath &amp; \"\\\"\n    End If\n\n    If FSO.FolderExists(SpecialPath &amp; \"VBAProjectFiles\") = False Then\n        On Error Resume Next\n        MkDir SpecialPath &amp; \"VBAProjectFiles\"\n        On Error GoTo 0\n    End If\n\n    If FSO.FolderExists(SpecialPath &amp; \"VBAProjectFiles\") = True Then\n        FolderWithVBAProjectFiles = SpecialPath &amp; \"VBAProjectFiles\"\n    Else\n        FolderWithVBAProjectFiles = \"Error\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p><strong>Step 2</strong></p>\n\n<p>Add the following code, adapted from answer #7 <a href=\"http://www.mrexcel.com/forum/excel-questions/442252-visual-basic-applications-get-module-name.html\" rel=\"nofollow\">here</a>, and from <a href=\"http://www.excel-easy.com/vba/examples/read-data-from-text-file.html\" rel=\"nofollow\">here</a>, along with my own function, to a new module (it could be the same module as the first if preferred):</p>\n\n<pre><code>Public Function MyMacroInfo() As String\n\nDim MacroName$, SubName$, ModArr As Variant\nDim ModName As Object, strModName$, i&amp;, j&amp;\n\nMacroName = ActiveSheet.Buttons(Application.Caller).OnAction\nSubName = Application.Replace(MacroName, 1, Application.Search(\"!\", MacroName), \"\")\nModArr = Array(0, 1, 2, 3)\n\nFor Each ModName In ActiveWorkbook.VBProject.VBComponents\n    For j = LBound(ModArr) To UBound(ModArr)\n        i = 0\n        On Error Resume Next\n        i = ModName.CodeModule.ProcStartLine(SubName, CLng(ModArr(j)))\n        Err.Clear\n        If i &gt; 0 Then\n            strModName = ModName.Name\n            Exit For\n        End If\n    Next j\nNext ModName\n\nMyMacroInfo = strModName\nEnd Function\n\nPublic Function GetParamName(ModulePath As String) As String\n\nDim text As String\nDim textline As String\nDim ParamStartLocation As Long\nDim ParamEndLocation As Long\nDim ParamLength As Long\nDim i As Long\n\nOpen ModulePath For Input As #1\n\nDo Until EOF(1)\n    Line Input #1, textline\n    text = text &amp; textline\nLoop\n\nClose #1\n\nParamStartLocation = 0\nFor i = 1 To 3\n    ParamStartLocation = InStr(ParamStartLocation + 1, text, \"Dim \")\nNext i\n\nParamEndLocation = InStr(ParamStartLocation, text, \" As \")\nParamLength = ParamEndLocation - ParamStartLocation\n\nGetParamName = Left(Right(text, Len(text) - ParamStartLocation - 3), ParamLength - 4)\n\nEnd Function\n</code></pre>\n\n<p><strong>Step 3</strong></p>\n\n<p>Change your sub to the following:</p>\n\n<pre><code>Sub Main()\n\n'--------Leave this section at the top of your sub---------\nDim strExportedModule As String\nDim strParamName As String\n\nstrExportedModule = ExportModules(MyMacroInfo)\nstrParamName = GetParamName(strExportedModule)\n'-----------------Start your code here---------------------\n\nDim MyString As String\n\nMyString = \"Hello World\"\nMsgBox strParamName &amp; \" says \" &amp; MyString\n\nEnd Sub\n</code></pre>\n\n<p><strong>Step 4</strong></p>\n\n<p>Assign <code>Main</code> to a Form Button.</p>\n\n<p><strong>Notes</strong></p>\n\n<p><ol>\n<li>As noted above, this will only get the first parameter that you dimension in the macro assigned to the Form Button. If this is not acceptable, I'll have to take a look at it to see if it can be modified to meet your needs.</li>\n<li>As Ron de Bruin notes on his site, you'll need to do the following:</p>\n\n<blockquote>\n  <p>In the VBE Editor set a reference to \"Microsoft Visual Basic For\n  Applications Extensibility 5.3\" and to \"Microsoft Scripting Runtime\"\n  and then save the file.</li>\n  <li>This code will export the module to a folder named \"VBAProjectFiles\" in your My Documents folder. If you happen to have a folder saved there with the same name (as unlikely as that is), it will delete all the files in that folder.</li>\n  </ol></p>\n</blockquote>\n"}], "owner": {"reputation": 9, "user_id": 4530266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fe71c18d703c83eb7545ba1ae338a8?s=128&d=identicon&r=PG&f=1", "display_name": "gullit", "link": "https://stackoverflow.com/users/4530266/gullit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 790, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1423163593, "creation_date": 1423081311, "last_edit_date": 1423084308, "question_id": 28330713, "link": "https://stackoverflow.com/questions/28330713/how-to-return-name-of-parameter-in-vba", "title": "How to return name of parameter in VBA", "body": "<p>Does anyone have an idea how to return parameter name in VBA?</p>\n\n<p>This is what I have:</p>\n\n<pre><code>Sub Main()\nDim MyString As String\nMyString = \"Hello World\"\nMsgBox MyString\nEnd Sub\n</code></pre>\n\n<p>It shows only \"Hello World\". I would like to have it \"MyString says Hello World\", but dynamically, not by entering</p>\n\n<pre><code>MsgBox \"MyString says \" &amp; MyString\n</code></pre>\n\n<p>I would prefer something like</p>\n\n<pre><code>MsgBox ParamName(MyString) &amp; \" says \" &amp; MyString\n</code></pre>\n\n<p>but it actually won't work... Could anyone help?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1423080912, "post_id": 28330536, "comment_id": 45008357, "body": "what kind of button do you have- <code>CommandButton</code> or a simple <code>form button</code> or maybe some other shape working like button? Show us the beginning of your code which starts recording..."}, {"owner": {"reputation": 1, "user_id": 4530228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489825b196ac8bca9b6190e9da5c15a?s=128&d=identicon&r=PG&f=1", "display_name": "sta008", "link": "https://stackoverflow.com/users/4530228/sta008"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423243110, "post_id": 28330536, "comment_id": 45082950, "body": "It is actually a Command Button. Do you know if it is possible?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4530228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489825b196ac8bca9b6190e9da5c15a?s=128&d=identicon&r=PG&f=1", "display_name": "sta008", "link": "https://stackoverflow.com/users/4530228/sta008"}, "edited": false, "score": 0, "creation_date": 1423243190, "post_id": 28335380, "comment_id": 45082989, "body": "Thank you for the link. It is actually quite interesting but do you know if it possible to reflect the state of the button by changing its color without having to be in the ribbon?"}, {"owner": {"reputation": 33, "user_id": 4518589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/v9Ikv.gif?s=128&g=1", "display_name": "Mohankumar", "link": "https://stackoverflow.com/users/4518589/mohankumar"}, "reply_to_user": {"reputation": 1, "user_id": 4530228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489825b196ac8bca9b6190e9da5c15a?s=128&d=identicon&r=PG&f=1", "display_name": "sta008", "link": "https://stackoverflow.com/users/4530228/sta008"}, "edited": false, "score": 0, "creation_date": 1423468603, "post_id": 28335380, "comment_id": 45144568, "body": "Yes, you can also set one color of the button during click event and another color after the event is completed."}], "tags": [], "owner": {"reputation": 33, "user_id": 4518589, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/v9Ikv.gif?s=128&g=1", "display_name": "Mohankumar", "link": "https://stackoverflow.com/users/4518589/mohankumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1423104715, "creation_date": 1423104715, "answer_id": 28335380, "question_id": 28330536, "link": "https://stackoverflow.com/questions/28330536/designable-macro-on-word/28335380#28335380", "title": "Designable Macro on Word", "body": "<p>you can add you custom task/events to the office UI ribbon. I've mentioned a link where the use can manipulate/change the icons when a function/task is in execution.</p>\n\n<p>Link:\n<a href=\"http://gregmaxey.mvps.org/word_tip_pages/ribbon_images_labels_part_IV.html\" rel=\"nofollow\">http://gregmaxey.mvps.org/word_tip_pages/ribbon_images_labels_part_IV.html</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 4530228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489825b196ac8bca9b6190e9da5c15a?s=128&d=identicon&r=PG&f=1", "display_name": "sta008", "link": "https://stackoverflow.com/users/4530228/sta008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423136661, "creation_date": 1423080660, "last_edit_date": 1423136661, "question_id": 28330536, "link": "https://stackoverflow.com/questions/28330536/designable-macro-on-word", "title": "Designable Macro on Word", "body": "<p>I am currently developing custom macros for recording interviews. \nThese macros are placed on the interview minutes. </p>\n\n<p>The macros have the standard picture of recording/play/pause. But I would like to be able to distinguish when the record is active or inactive by looking at the macro buttons. </p>\n\n<p>Do you know if it is possible to have a pushbutton with two differents photos:</p>\n\n<ul>\n<li>one when it is pushed</li>\n<li>another one when it is not activated</li>\n</ul>\n\n<p>OR If it is possible to modify the colors of the pushbutton when its status changes. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1423080361, "post_id": 28329917, "comment_id": 45008019, "body": "these are not numbers so why can they not be formatted as strings? also can you use the apostrophe as the initial character?"}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1423080538, "post_id": 28329917, "comment_id": 45008130, "body": "Please share the code you are working with. This will help get a better answer for the issue you are seeing. For example, it&#39;s important to know how the macro is separating the data."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423081145, "post_id": 28329917, "comment_id": 45008478, "body": "Prepend each of the values with <code>&#39;</code>"}, {"owner": {"reputation": 25, "user_id": 4390045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acf80d6687f7849d95b829dd6f3d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "cornking", "link": "https://stackoverflow.com/users/4390045/cornking"}, "edited": false, "score": 0, "creation_date": 1423148123, "post_id": 28329917, "comment_id": 45038268, "body": "Code posted.  How would I prepend the apostrophe? Something like:    &quot;&#39;&quot; &amp; tempArray(i)  ?"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 4390045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acf80d6687f7849d95b829dd6f3d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "cornking", "link": "https://stackoverflow.com/users/4390045/cornking"}, "is_accepted": true, "score": 0, "last_activity_date": 1423155379, "creation_date": 1423155379, "answer_id": 28349695, "question_id": 28329917, "link": "https://stackoverflow.com/questions/28329917/prevent-string-array-from-being-reformatted-to-scientific/28349695#28349695", "title": "Prevent string array from being reformatted to scientific", "body": "<p>Instead of prepending each value with <code>'</code>, I ended up formatting the destination range for text <em>before</em> putting the array into the destination range instead of afterwards.  I used <code>Range(rListPaste, rListPaste.Offset(lLoop - 1)).NumberFormat = \"@\"</code>. This will eleminate the need for another looped step.  Thank you for the help!</p>\n"}], "owner": {"reputation": 25, "user_id": 4390045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acf80d6687f7849d95b829dd6f3d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "cornking", "link": "https://stackoverflow.com/users/4390045/cornking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 28349695, "answer_count": 1, "score": 0, "last_activity_date": 1423155379, "creation_date": 1423078611, "last_edit_date": 1531164843, "question_id": 28329917, "link": "https://stackoverflow.com/questions/28329917/prevent-string-array-from-being-reformatted-to-scientific", "title": "Prevent string array from being reformatted to scientific", "body": "<p>I am working on a macro that takes a column of cells with a list of standards delimited by a \" \" and adds them to an array if they are a unique value.  I ask the user where they would like to put the array that was created and then paste it at the specified location.  </p>\n\n<p>The problem - almost all of the standards start with \"1E\" and whenever the array is pasted into the sheet, any values that don't have a letter at the end are converted into scientific notation.  I can't format them as text afterward because it destroys the original value.  For example \"1E0011\" in the array is pasted as \"1.00E+11\".  If I format this as text (after it has been pasted), it reads \"1E+11\".  The array is Dim'd as a string.  </p>\n\n<pre><code>Sub Remove_1E_Duplicates()\n'Looks at every \"1E\" standard in a column and puts every unique value in an array at a user-selected destination\n\nDim CurrentCell As String               'Used to temporarily store active cell's values\nDim strArray() As String                'Final string with only unique values\nDim tempArray() As String               'Temp array created by splitting CurrentCell's values\nDim i As Integer                        'Counter used for each value in tempArray\nDim elem As Integer                     'Counter for each element in strArray\nDim lLoop As Long, lLoop2 As Long       'Counter for sorted array (ex: if lLoop=5, each element 0-4 is already sorted and 5+ needs to be sorted)\nDim str1 As String, str2 As String      'Place holder for switching two elements' positions in an array when one has a lower sorted value\nDim rListPaste As Range                 'Stores location of the user-input destination\n\nReDim Preserve strArray(0)\n\nDo While ActiveCell &lt;&gt; vbnullvalue\n\n    If ActiveCell.Value = \"Access Denied\" Then\n        GoTo Denied\n    End If\n\n    CurrentCell = ActiveCell.Value\n    tempArray = Split(CurrentCell, \" \")\n\n    For i = LBound(tempArray) To UBound(tempArray)\n\n        For elem = LBound(strArray) To UBound(strArray)\n            'Used if strArray is empty\n            If strArray(elem) = \"\" Then\n                strArray(elem) = tempArray(i)\n                GoTo NextTemp\n\n            'If the current element in tempArray is already in strArray, go to next element in tempArray\n            ElseIf InStr(tempArray(i), strArray(elem)) Then\n                GoTo NextTemp\n\n            'If all the elements in strArray have been searched and the element in tempArray is longer than 2 characters, _\n            'then resize strArray and add the current tempArray element to strArray (after trimming extra spaces and returns)\n            ElseIf elem = UBound(strArray) And Len(tempArray(i)) &gt; 2 And tempArray(i) &lt;&gt; Chr(13) Then\n                ReDim Preserve strArray(LBound(strArray) To UBound(strArray) + 1) As String\n                strArray(UBound(strArray)) = Replace(Trim(tempArray(i)), vbLf, \"\")\n            End If\n\n        Next elem\n\nNextTemp:       'Goes to next element in tempArray\n    Next i\n\nDenied:         'After both arrays have been compared, goto next cell below current active cell\n    ActiveCell.Offset(1, 0).Select\n\nLoop\n\n'This loop sorts the strArray array\nFor lLoop = 0 To UBound(strArray)\n\n    For lLoop2 = lLoop To UBound(strArray)\n\n         If UCase(strArray(lLoop2)) &lt; UCase(strArray(lLoop)) Then\n             str1 = strArray(lLoop)\n             str2 = strArray(lLoop2)\n             strArray(lLoop) = str2\n             strArray(lLoop2) = str1\n         End If\n\n    Next lLoop2\n\nNext lLoop\n\nSet rListPaste = Application.InputBox _\n    (prompt:=\"Please select destination cell\", Type:=8)\n\ni = UBound(strArray) + 1\nRange(rListPaste, rListPaste.Offset(i)).Value2 = WorksheetFunction.Transpose(strArray)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "json", "excel", "web-scraping", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1423086484, "creation_date": 1423086484, "answer_id": 28332115, "question_id": 28329807, "link": "https://stackoverflow.com/questions/28329807/extracting-fields-from-a-javascript-section-of-an-html-document-into-tables-geo/28332115#28332115", "title": "Extracting fields from a javascript section of an HTML document into tables? Geographic coordinates", "body": "<p>Sure it's possible. But here at StackOverflow we solve issues not write code for existing solutions.</p>\n\n<p>However I would start by analyzing this link:\n<a href=\"https://maps.googleapis.com/maps/api/js/ViewportInfoService.GetViewportInfo?1m6&amp;1m2&amp;1d12.821947129167481&amp;2d-175.06889349440217&amp;2m2&amp;1d28.109653321636404&amp;2d-140.54826660818202&amp;2u7&amp;4spl-PL&amp;5e0&amp;6sm%40290000000&amp;7b0&amp;8e0&amp;9b0&amp;callback=_xdc_._48sez1&amp;token=119313\" rel=\"nofollow\">https://maps.googleapis.com/maps/api/js/ViewportInfoService.GetViewportInfo?1m6&amp;1m2&amp;1d12.821947129167481&amp;2d-175.06889349440217&amp;2m2&amp;1d28.109653321636404&amp;2d-140.54826660818202&amp;2u7&amp;4spl-PL&amp;5e0&amp;6sm%40290000000&amp;7b0&amp;8e0&amp;9b0&amp;callback=<em>xdc</em>._48sez1&amp;token=119313</a></p>\n\n<p>From it you will get the JSON with the lats and longs. You can use many solutions out there. I personally made a simple <a href=\"http://blog.tkacprow.pl/excel-tools/excel-scrape-html-add/\" rel=\"nofollow\">Scrape HTML Add-In</a> to Excel myself. All you need to learn is regular expressions.</p>\n"}, {"comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1510240705, "post_id": 28377215, "comment_id": 81359535, "body": "Some improvements regarding <a href=\"https://stackoverflow.com/a/47111556/2165759\">WSH VBS GUI</a> solution."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1483740090, "last_edit_date": 1483740090, "creation_date": 1423269980, "answer_id": 28377215, "question_id": 28329807, "link": "https://stackoverflow.com/questions/28329807/extracting-fields-from-a-javascript-section-of-an-html-document-into-tables-geo/28377215#28377215", "title": "Extracting fields from a javascript section of an HTML document into tables? Geographic coordinates", "body": "<p>Try this VBScript solution based on XMLHTTP requests. Just copy the code below, paste to text file, save it as <code>.vbs</code> and run it. Script hasn't been optimized, all requests are not async, so it takes about 40 seconds on my PC to get all data.</p>\n\n<pre><code>Option Explicit\nDim arrCells(), arrList, arrTmp, sRespHeaders, sRespText, arrSetHeaders, i, j, iTotal, oApp, oWB, oWS, oOutput\n\n' Create output window\nOutput oOutput\n\n' Get cookies\noOutput.write \"Get cookies\"\nXmlHttpGet \"https://energy.ehawaii.gov/epd/public/energy-projects-map.html\", Array(), sRespHeaders, sRespText\nParseResponse \"^Set-(Cookie): ([\\S]*?=[\\S]*?);[\\s\\S]*?$\", sRespHeaders, arrSetHeaders\n\n' Get project list\noOutput.write \"Get project list\"\narrList = Array()\nXmlHttpGet \"https://energy.ehawaii.gov/epd/public/energy-projects-list.json?sEcho=2&amp;iColumns=5&amp;sColumns=&amp;iDisplayStart=1&amp;iDisplayLength=0&amp;mDataProp_0=0&amp;mDataProp_1=1&amp;mDataProp_2=2&amp;mDataProp_3=3&amp;mDataProp_4=4&amp;sSearch=&amp;bRegex=false&amp;sSearch_0=&amp;bRegex_0=false&amp;bSearchable_0=true&amp;sSearch_1=&amp;bRegex_1=false&amp;bSearchable_1=true&amp;sSearch_2=&amp;bRegex_2=false&amp;bSearchable_2=true&amp;sSearch_3=&amp;bRegex_3=false&amp;bSearchable_3=true&amp;sSearch_4=&amp;bRegex_4=false&amp;bSearchable_4=true&amp;iSortCol_0=0&amp;sSortDir_0=asc&amp;iSortingCols=1&amp;bSortable_0=true&amp;bSortable_1=true&amp;bSortable_2=true&amp;bSortable_3=true&amp;bSortable_4=true\", arrSetHeaders, \"\", sRespText\nParseProjects sRespText, arrList, iTotal\noOutput.write \"Get project list: \" &amp; (UBound(arrList) + 1) &amp; \" of \" &amp; iTotal\n\n' Rearrange to 2-dimensional array, get LatLng\nReDim arrCells(UBound(arrList), 8) ' Name, Technology, Island, Capacity, Location, RID, Type, Lat, Lng\nFor i = 0 To UBound(arrList)\n    For j = 0 To 6\n        arrCells(i, j) = arrList(i)(j)\n    Next\n    oOutput.write \"Get LatLng: \" &amp; (i + 1) &amp; \" of \" &amp; iTotal\n    arrTmp = RequestLatLng(arrList(i)(5))\n    arrCells(i, 7) = arrTmp(0)\n    arrCells(i, 8) = arrTmp(1)\nNext\n\n' Create Excel worksheet, output data\noOutput.write \"Export to Excel\"\nSet oApp = CreateObject(\"Excel.Application\")\noApp.Visible = True\nSet oWB = oApp.Workbooks.Add(-4167) ' xlWBATWorksheet\nSet oWS = oWB.Worksheets(1)\noWS.Range(oWS.Cells(1, 1), oWS.Cells(UBound(arrCells) + 1, 9)).Value = arrCells\noWS.Columns.AutoFit\noWB.Saved = True\noOutput.write \"Completed\"\n\nSub XmlHttpGet(sQuery, arrSetHeaders, sRespHeaders, sRespText)\n    Dim arrHeader\n    With CreateObject(\"MSXML2.ServerXMLHTTP\")\n        .SetOption 2, 13056 ' SXH_SERVER_CERT_IGNORE_ALL_SERVER_ERRORS\n        .Open \"GET\", sQuery, False\n        For Each arrHeader In arrSetHeaders\n            .SetRequestHeader arrHeader(0), arrHeader(1)\n        Next\n        .Send \"\"\n        sRespHeaders = .GetAllResponseHeaders\n        sRespText = .ResponseText\n    End With\nEnd Sub\n\nSub ParseResponse(sPattern, sResponse, aData)\n    Dim oMatch, aTmp, sSubMatch\n    aData = Array()\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .MultiLine = True\n        .Pattern = sPattern\n        For Each oMatch In .Execute(sResponse)\n            If oMatch.SubMatches.Count = 1 Then\n                PushItem aData, oMatch.SubMatches(0)\n            Else\n                aTmp = Array()\n                For Each sSubMatch In oMatch.SubMatches\n                    PushItem aTmp, sSubMatch\n                Next\n                PushItem aData, aTmp\n            End If\n        Next\n    End With\nEnd Sub\n\nSub PushItem(aList, vItem)\n    ReDim Preserve aList(UBound(aList) + 1)\n    aList(UBound(aList)) = vItem\nEnd Sub\n\nSub ParseProjects(sJson, arrProj, iTotalRecords)\n    Dim i, q\n    With CreateObject(\"htmlfile\")\n        With .parentwindow\n            .execscript \";\", \"jscript\"\n            .eval (\"json = \" &amp; sJson &amp; \";\")\n            iTotalRecords = CInt(.json.iTotalRecords)\n            Do While .json.aaData.Length\n                ReDim Preserve arrProj(UBound(arrProj) + 1)\n                With .json.aaData.Shift()\n                    arrProj(UBound(arrProj)) = Array(.Shift(), .Shift(), .Shift(), .Shift(), .Shift(), .Shift(), .Shift())\n                End With\n            Loop\n        End With\n    End With\nEnd Sub\n\nFunction RequestLatLng(sRid)\n    Dim sRespText, arrTmp, sTmp\n    XmlHttpGet \"https://energy.ehawaii.gov/epd/public/energy-project-details.html?rid=\" &amp; sRid, Array(), \"\", sRespText\n    arrTmp = Split(sRespText, \"google.maps.LatLng(\")\n    If UBound(arrTmp) &gt;= 1 Then\n        sTmp = arrTmp(1)\n        arrTmp = Split(sTmp, \"),\")\n        If UBound(arrTmp) &gt;= 1 Then\n            RequestLatLng = Split(arrTmp(0), \", \")\n            Exit Function\n        End If\n    End If\n    RequestLatLng = Array(\"#\", \"#\")\nEnd Function\n\nSub Output(oWnd)\n    Set oWnd = ShowWindow(\"energy.ehawaii.gov\", \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWIAAAB2CAYAAADybJlDAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAUjSURBVHja7N05ztxGEIBRjqHciZ34Bn3/w9QNnPsE49QwtPwc9lLd9V4kAdKwyQE+Fjnb6/1+XwCs85tDACDEAEIMgBADCDEAQgwgxAAIMYAQAyDEAEIMgBADCDEAQgwgxACM980hgD28Xq/Td7Hd/PdxzHPri+FBiBPH9hPbBVqIQYh3D+/2YRZiEOIT47tVmIUYhLhCfFMHWYhBiKsFOF2UhRiEuHKAUwRZiEGIBXhxkIUYhFiAFwdZiEGIBXhxjIUYhDhLhCP5OocFWYhBiGeHLaxdiEGI54YsNljj0n0SYhDiEYGLhGtKG2MhBiHOFuCdXiDsEmMhhtoh7hW9SLKOLWMsxFA3xD3iVznA3Y6FEEPNED8NoAB3PC5CDPVCvDLCFT4gcvv4CDHUCvGTEFYKcMw8Vn48FOpYEeG28RQ87cRjIoYaE/GnMdxpCo7O2336eH9f1/WPEIMQr4jwyo8Zt4HbaqOOoRCDEGePcCzc9pQYCzGcHeJZER45ia6ewmP0MfViHZxrxwjHle9XltvoYyTEIMIZIvwkwDNvvfT6/0IMpInw0wn4SYTj4Xa63T4RYjANr4hwj1sQKybhIc+NEIMIz4xwr3vAvSI8eyo2EQNLAphhGo1Ej92EGESyW0AWhbD3fkaHbT86lkIMNc2KcO+3ox3500lCDPWm4ZkRXjnx31lDTDgeP3wcIYZaEZ712Bk+lBG7bFOIoZbYdBsz3g0SC/a/CTGw6lZAlok/xZqEGGrFsg163FW3AnqvY8lULMQg3pkj3JKsYyghhjrT8KhL66oRbr3WI8Qg5OUm0Gz7JMQgxhmDdcoJ4UvrEmKoF9AfPVbbdN+2n8qFGNg5fkfcGhFiIFP82mb72Ho8lhDD+dOrqdxEDCyc6mLAY54+lQsxkDrspvwBx06IQUDtj4kYGDA5xnf+Hpvv07GEGEzHd4LZO5qVXqALIQZ6xaxtuu602xNiYNV03A46FkIM7BuhpNPwVEIM50VvxddBjvqC+hKEGAQ9++PG6U+IEAOzp+M7wS7xHmghBnaajk3EgEA+nI4rT8NCDNy+hO4VQtPxL3xzCIAvTKWz3zOcYRr+a9ZaTcSA2wTf9/usDQkxcCfGMWk7pQgx1PGHUAoxsNafHUM7ajouGXkhBjKFc8RXbQoxUCLGgizEgCB33+60KwIhBgR5ceB9oAPYNWTHvLBnIoa9Js2el9UnRPmIfRViYNol+CZBnh53tyaAE+O/1ScAhRgQ5cWEGBgZwa9OlW3SeqLj2rsdF/eIQQxXif/9OSYdlx73lLuuVYhhL9kvs3sELiau9b9RXnbyEmIg6wln5kln6U84CTGcK/Ptibjx72ZHefpz4cU6YJfwx6Tt3NnPLicIIYY9L9vb5us/Icg/W8OtfRRiOH9KPfXL1mPiND706kCIgenhKRblX/JiHdS5vM/wpUGzPnq81Qt8Qgym1dNPWOmjLMRQayquHPq0URZiMBVXO3GYiIEtYnjy7Yxs+xZCDDXCOipAuwW7fXB8h0/y3r4GZDthZIrwz9bfeh0XIYYzIvfVKNyJx0kfBmmDjnuXbbk1AZzukwjHhG2FEINL/4xTZpUIm4hBjKfGdtXtjZZ4WyHEwOk+jfCSk4YQg6k402S5Y4Tb0+0IMTAyPpF0XWkiLMRgKj5lKn7yy8yx+pgIMYhxlel8dYRDiEGMT5uK23VAhIUYqDgFp4rwdV3X6/1+e0phA6/Xa7dJ9rT3NQ+7B/0vAAAA//8DAERsQ7O6796eAAAAAElFTkSuQmCC\", 354, 118)\nEnd Sub\n\nFunction ShowWindow(sTitle, sBG, iWidth, iHeight)\n    Set ShowWindow = CreateWindow()\n    With ShowWindow\n        With .document\n            .title = sTitle\n            .getElementsByTagName(\"head\")(0).appendChild .createElement(\"style\")\n            .styleSheets(0).cssText = \"* {font: 8pt tahoma; margin: 5px;}\"\n            .body.style.background = \"buttonface\"\n            .body.style.backgroundRepeat = \"no-repeat\"\n            .body.style.backgroundImage = \"url(\" &amp; sBG &amp; \")\"\n            .body.innerHTML = \"\"\n        End With\n        .resizeTo .screen.availWidth, .screen.availHeight\n        .resizeTo iWidth + .screen.availWidth - .document.body.offsetWidth, iHeight + .screen.availHeight - .document.body.offsetHeight\n        .moveTo CInt((.screen.availWidth - iWidth) / 2), CInt((.screen.availHeight - iHeight) / 2)\n        .execScript \"var handlers, thunks = {body_onunload: function() {handlers.WSHQuit()}};\"\n        Execute \"Class clsHandlers: Public Sub WSHQuit(): WScript.Quit: End Sub: End Class\"\n        Set .handlers = New clsHandlers\n        Set .document.body.onunload = .thunks.body_onunload\n        .execScript \"var write = function(t) {document.body.innerHTML = t};\"\n    End With\nEnd Function\n\nFunction CreateWindow()\n    ' source http://forum.script-coding.com/viewtopic.php?pid=75356#p75356\n    Dim sSignature, oShellWnd, oProc\n    On Error Resume Next\n    sSignature = Left(CreateObject(\"Scriptlet.TypeLib\").Guid, 38)\n    Do\n        Set oProc = CreateObject(\"WScript.Shell\").Exec(\"mshta \"\"about:&lt;head&gt;&lt;script&gt;moveTo(-32000,-32000);document.title=' '&lt;/script&gt;&lt;hta:application id=app border=thick minimizebutton=no maximizebutton=no scroll=no showintaskbar=yes contextmenu=no selection=no innerborder=no icon=\"\"\"\"/&gt;&lt;object id='shell' classid='clsid:8856F961-340A-11D0-A96B-00C04FD705A2'&gt;&lt;param name=RegisterAsBrowser value=1&gt;&lt;/object&gt;&lt;script&gt;shell.putproperty('\" &amp; sSignature &amp; \"',document.parentWindow);&lt;/script&gt;&lt;/head&gt;\"\"\")\n        Do\n            If oProc.Status &gt; 0 Then Exit Do\n            For Each oShellWnd In CreateObject(\"Shell.Application\").Windows\n                Set CreateWindow = oShellWnd.GetProperty(sSignature)\n                If Err.Number = 0 Then Exit Function\n                Err.Clear\n            Next\n        Loop\n    Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4355086, "user_type": "registered", "profile_image": "https://graph.facebook.com/1310880013/picture?type=large", "display_name": "Christopher Beddow", "link": "https://stackoverflow.com/users/4355086/christopher-beddow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1483740090, "creation_date": 1423078264, "last_edit_date": 1531161705, "question_id": 28329807, "link": "https://stackoverflow.com/questions/28329807/extracting-fields-from-a-javascript-section-of-an-html-document-into-tables-geo", "title": "Extracting fields from a javascript section of an HTML document into tables? Geographic coordinates", "body": "<p>I have an HTML document that contains geographic information within a block of Javascript. It is the source code from this web page: <a href=\"https://energy.ehawaii.gov/epd/public/energy-projects-map.html\" rel=\"nofollow\">https://energy.ehawaii.gov/epd/public/energy-projects-map.html</a></p>\n\n<p>This can be viewed as a map and also as a list.</p>\n\n<p>What I want to achieve is to have that list in Excel, but with a field for \"Latitude\" and a field for \"Longitude\". The Google Maps marker specifies the <code>LatLng</code> in the Javascript.</p>\n\n<p>How can I use something like VB to process the source code of the HTML file, and organize into a table that has the following fields/columns:</p>\n\n<ul>\n<li>Description (from the <code>&lt;a ... title=\"such and such\"&gt;</code>)</li>\n<li>Technology (from <code>&lt;p&gt;Technology: Solar&lt;/p&gt;</code> for example)</li>\n<li>Latitude (from <code>google.maps.LatLng(latitude, longitude);</code></li>\n<li>Longtitude (from the same code line as latitude, but using the second variable)?</li>\n</ul>\n\n<p>All help appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423077027, "post_id": 28329333, "comment_id": 45006232, "body": "Can you give example of some of the values you&#39;re trying to parse?  I see some errors in your code but would not expect that error.  For example as you are iterating the 10,000 cells, it was probably not your intention to write the value to ALL of them, every time. The end result of this will be that every one of these cells will contain ONLY the very last evaluation of the <code>getName</code> variable."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423077187, "post_id": 28329333, "comment_id": 45006312, "body": "It&#39;s also not clear where, if anywhere, you have assigned any value to the <code>Path</code> variable.   That variable is not declared, and you do not assign it in the snippet provided. That could contribute to error(s)."}, {"owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423077224, "post_id": 28329333, "comment_id": 45006329, "body": "I have edited my original question. So next to the column of these values I would like the values Hello, Moody and Grass."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423077260, "post_id": 28329333, "comment_id": 45006357, "body": "Please see the other Q: what about the <code>path</code> variable?"}, {"owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423077317, "post_id": 28329333, "comment_id": 45006400, "body": "Ah okay. So I need to assign the path variable to have the string value of the current selected cell in the loop?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423077349, "post_id": 28329333, "comment_id": 45006413, "body": "Yes. without that, you&#39;re psasing a null string to the <code>Instr</code> function and you&#39;ll see if you debug it that values of all <code>part1</code> <code>part2</code> and <code>part3</code> variables are 0, which will cause that error."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1423078577, "last_edit_date": 1423078577, "creation_date": 1423077486, "answer_id": 28329571, "question_id": 28329333, "link": "https://stackoverflow.com/questions/28329333/extracting-text-invalid-procedure-call-or-argument/28329571#28329571", "title": "Extracting text - Invalid procedure call or argument", "body": "<p>First, always use <code>Option Explicit</code>. This will prevent you from using undeclared variables, which was the source of your error here.</p>\n\n<p>Without assigning to that variable, you're passing a null string or zero-value to the <code>Instr</code> function and you'll see if you debug it that values of all <code>part1</code> <code>part2</code> and <code>part3</code> variables are 0, which will cause that error.</p>\n\n<p>You also have some bad logic in assigning to your <code>part</code> variables, which is passing a negative number to the <code>Mid</code> function, which will raise that error.</p>\n\n<p>Try this. I have separated <code>GetPath</code> as its own function call:</p>\n\n<pre><code>Option Explicit\nSub foo()\nDim path As String\nDim rCell As Range\nDim rRng As Range\n\nSet rRng = Sheet2.Range(\"A1:A3\")\n\nFor Each rCell In rRng.Rows\n    path = rCell.Value\n    rCell.Offset(0,1).Value = GetName(path)\nNext rCell\n\nEnd Sub\n\nFunction GetName(path As String)\n\n    Dim part1 As Integer\n    Dim part2 As Integer\n    Dim part3 As Integer\n    Dim returnValue As String\n\n    If Trim(path) = vbNullString Then GoTo EarlyExit 'handles empty strings\n\n    part1 = InStr(path, \")\")\n    part2 = InStr(part1, path, \")\") 'I changed this line\n    part3 = InStr(part2 + 1, path, \"(\")\n\n    returnValue = Trim(Mid(path, part1 + 1, part3 - part1 - 1))\n\nEarlyExit:\n    GetName = returnValue\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 202, "user_id": 4203414, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7fbd998943c689355bc3cfdd03f212bb?s=128&d=identicon&r=PG&f=1", "display_name": "80gm2", "link": "https://stackoverflow.com/users/4203414/80gm2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 28329571, "answer_count": 1, "score": 0, "last_activity_date": 1423078577, "creation_date": 1423076605, "last_edit_date": 1531161705, "question_id": 28329333, "link": "https://stackoverflow.com/questions/28329333/extracting-text-invalid-procedure-call-or-argument", "title": "Extracting text - Invalid procedure call or argument", "body": "<p>I have written this VBA code and I get an error on line 12 (getName = Mid..) - Invalid procedure call or argument.  The aim of this is to find the first instance of a close bracket \")\" then find the second instance of an open \"(\" bracket, and paste the text inbetween these 2 points into the next column. Can someone explain to my why I get this error?</p>\n\n<pre><code>Dim getName As String\n    Dim part1 As Integer\n    Dim part2 As Integer\n    Dim part3 As Integer\n    Dim rCell As Range\n    Dim rRng As Range\n    Set rRng = Sheet2.Range(\"B1:B10000\")\n\n    For Each rCell In rRng.Rows\n    part1 = InStr(Path, \")\")\n    part2 = InStr(Path, \"-\")\n    part3 = InStr(part2 + 1, Path, \"(\")\n    getName = Mid(Path, part1 + 1, part3 - part1 - 1)\n    Range(\"B1:B10000\").Offset(RowOffSet:=0, ColumnOffset:=1).Select.Value = getName\n    Next rCell\n    '\n    End Sub\n</code></pre>\n\n<p>The data I am trying to parse:</p>\n\n<pre><code>TEST2_ (LC) HELLO (brtreq) - dgfdag - 43224 - Dec 08 to Dec 31 2014 - Ros - 2gd - Skin\n\nTEST MOBILE STIE (LC) MOODY (FEREFE) - RDEWF- Jan 15 to Dec 31 2015 - Ros - HRWFEW (New) (2F4F4)\n\nTEST GPTDFV SGE (LC) GRASS (HSK) - GSK - 23F23 - Jan 06 to Jan 31 2015 - Ros - WERWE - PSDF\n</code></pre>\n"}, {"tags": [".net", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1897, "user_id": 783388, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gm7eC.jpg?s=128&g=1", "display_name": "Johanness", "link": "https://stackoverflow.com/users/783388/johanness"}, "edited": false, "score": 1, "creation_date": 1423080106, "post_id": 28329236, "comment_id": 45007856, "body": "have you had a look in the registry for that file (both on the dev machine and on the targets? Perhaps the new version of that dll uses sage services and they are installed and registered on the dev-machine but not (or false/older...) on the dev-machine. BTW: If you get external dlls - aren&#39;t they supported?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1423082377, "post_id": 28329236, "comment_id": 45009116, "body": "Could it be a 32-bit vs. 64-bit issue?"}, {"owner": {"reputation": 3308, "user_id": 1854382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7zNMs.png?s=128&g=1", "display_name": "J King", "link": "https://stackoverflow.com/users/1854382/j-king"}, "reply_to_user": {"reputation": 1897, "user_id": 783388, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gm7eC.jpg?s=128&g=1", "display_name": "Johanness", "link": "https://stackoverflow.com/users/783388/johanness"}, "edited": false, "score": 0, "creation_date": 1423087123, "post_id": 28329236, "comment_id": 45011611, "body": "@Johanness - thanks, the dev machine gets the error if I specify a filepath in the declaration instead of just using the filename alone.  So I don&#39;t think its a services issue."}, {"owner": {"reputation": 3308, "user_id": 1854382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7zNMs.png?s=128&g=1", "display_name": "J King", "link": "https://stackoverflow.com/users/1854382/j-king"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1423087163, "post_id": 28329236, "comment_id": 45011633, "body": "@SO - could be but he problem appears on 32 and 64 bit end user machines.  I am still looking into this though."}, {"owner": {"reputation": 3308, "user_id": 1854382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7zNMs.png?s=128&g=1", "display_name": "J King", "link": "https://stackoverflow.com/users/1854382/j-king"}, "reply_to_user": {"reputation": 1897, "user_id": 783388, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gm7eC.jpg?s=128&g=1", "display_name": "Johanness", "link": "https://stackoverflow.com/users/783388/johanness"}, "edited": false, "score": 0, "creation_date": 1423087607, "post_id": 28329236, "comment_id": 45011860, "body": "@Johanness And yes, I have a support ticket in as well - unfortunately this is time sensitive so I am looking for any help I can get."}, {"owner": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "edited": false, "score": 0, "creation_date": 1423137502, "post_id": 28329236, "comment_id": 45031104, "body": "Trusted locations issue? Sometimes windows updates break stuff in Office. Access Version ?"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1423137840, "post_id": 28329236, "comment_id": 45031313, "body": "have you tried to register the dll? try register using regsvr32 dllname.dll make sure its 32bit otherwise use 64bit command"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 2, "creation_date": 1423182664, "post_id": 28329236, "comment_id": 45056614, "body": "Since this is x32, then that path name looks wrong. Should it not be c:\\Program Files (x86) etc. Also, you CAN place the .dll in the SAME dir as the adp, but just make sure you do a chDir to the current db before you attempt to run that code. I would also consider using loadlib to \u201cload\u201d the library based on the assumption that the .dll is in the same dir as the adp application. As noted, this lib code is NOT a COM object and thus no regsvr32 is required."}, {"owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "edited": false, "score": 0, "creation_date": 1423227558, "post_id": 28329236, "comment_id": 45073668, "body": "Are you using 32 bit or 64 bit Access. The syntax for an API call is a little different in 64 bit. For example, the Declare statement needs to include a PtrSafe."}, {"owner": {"reputation": 3308, "user_id": 1854382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7zNMs.png?s=128&g=1", "display_name": "J King", "link": "https://stackoverflow.com/users/1854382/j-king"}, "reply_to_user": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1423242514, "post_id": 28329236, "comment_id": 45082647, "body": "@AlbertD.Kallal thanks - i confirmed that this is 32 bit and I will try what you suggest and get back to you."}, {"owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "edited": false, "score": 0, "creation_date": 1428654220, "post_id": 28329236, "comment_id": 47263692, "body": "In cases where it&#39;s not a 64/32 problem, it is gonna be a permissions or security zone problem"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1429261526, "post_id": 28329236, "comment_id": 47525948, "body": "Have you considered deploying both the application and the dll to a subfolder in the user&#39;s %localappdata% folder? This is usually a safe place even in a Citrix environment."}], "owner": {"reputation": 3308, "user_id": 1854382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7zNMs.png?s=128&g=1", "display_name": "J King", "link": "https://stackoverflow.com/users/1854382/j-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423076281, "creation_date": 1423076281, "question_id": 28329236, "link": "https://stackoverflow.com/questions/28329236/vba-ms-access-can-not-find-lib-function", "title": "VBA MS Access can not find Lib Function", "body": "<p>This question uses some older tech so please bear with me,  We are trying to patch an old solution until the new one gets deployed in a couple months.  As a result this is really important and I will add a bounty as soon as possible for this problem.</p>\n\n<h2>BACKGROUND</h2>\n\n<p>I have a ms access adp project that uses sql server 2005 on Windows SBS 2003 as its back end.  In this project we use some custom API's to connect to some accounting software.  This project has been working for many years.</p>\n\n<p>I declare the custom api dll in the following way:</p>\n\n<pre><code>Public Declare Function wSDBOpenDatabase Lib \"Sage_SA_dblyr.dll\" (ByRef pDBLinkNo As Integer, ByVal wFlags As Integer, ByVal pszAppID As String, ByVal pszUserID As String, ByVal pSZPWD As String, ByVal szHost As String, ByVal szCompId As String, ByVal szPort As String) As Integer\n</code></pre>\n\n<p>As i understand from <a href=\"https://msdn.microsoft.com/en-us/library/aa716201%28v=vs.60%29.aspx\" rel=\"nofollow\">THIS MSDN ARTICLE</a> the program will look for the dll in the following locations in this order:</p>\n\n<ol>\n<li>Directory containing the .exe file </li>\n<li>Current directory</li>\n<li>Windows system directory (often but not necessarily \\Windows\\System)</li>\n<li>Windows directory (not necessarily \\Windows)</li>\n<li>Path environment variable</li>\n</ol>\n\n<p>So I copied the dll files in to the C:\\Program Files\\Microsoft Office\\Office12 directory and the program finds the dlls and the functions work.</p>\n\n<p>The company that creates the dlls in use here have updated their files (which happens yearly) so I just copy the new dlls into the above mentioned directory.  In previous years this was all that was required and it all worked.  </p>\n\n<h2>PROBLEM</h2>\n\n<p>After copying the new dlls from this years update into the same directory, the program is throwing a VBA error <strong>#53 File not found: Sage_SA_dblyr.dll</strong>\nThis problem does not appear on the development machine, only on machines where the adp project gets packaged and deployed to.</p>\n\n<p>However the development machine will through the same error if I try to explicitly set the file location of the dll, instead of just using the dll name in the function's lib declare statement.</p>\n\n<p>I tried to explicitly set the location of the dll in the following way to solve the deployment machine's issue:</p>\n\n<pre><code>Public Declare Function wSDBOpenDatabase Lib \"C:\\Program Files\\Microsoft Office\\Office12\\Sage_SA_dblyr.dll\" (ByRef pDBLinkNo As Integer, ByVal wFlags As Integer, ByVal pszAppID As String, ByVal pszUserID As String, ByVal pSZPWD As String, ByVal szHost As String, ByVal szCompId As String, ByVal szPort As String) As Integer\n</code></pre>\n\n<p>But I get the same error, and I have tried using different locations as well.  I also copied the dll's into any folder I can imagine it would look,  Including the system root folders of windows\\system32 and windows\\syswow64 depending on 32 vs 64 bit machines.</p>\n\n<p>NOTE: Theses dll do not require registration</p>\n\n<h2>QUESTION</h2>\n\n<p>Can someone help me either explicitly set the file location for the dll declaration or figure out why the adp project cant find the new version of these dlls.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423076246, "post_id": 28329129, "comment_id": 45005837, "body": "You can use the <code>IsRef</code> function to determine whether a cell contains reference to another cell. At first glance I would expect that to work, but I would NOT consider a cell reference like <code>$A$2</code> to be a &quot;constant&quot; the way you have assumed, so it may not work for your purposes."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1423077731, "post_id": 28329129, "comment_id": 45006623, "body": "Do you have a formal definition of what you consider to be a constant and what you do not? That would be the first place to start. From your list, I&#39;m not sure what criteria you&#39;re using to separate constants/non constants..."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423078722, "post_id": 28329129, "comment_id": 45007147, "body": "to have a quick look inside cell you can just press <code>Ctrl + ~</code> to switch between formulas and values."}, {"owner": {"reputation": 1897, "user_id": 783388, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gm7eC.jpg?s=128&g=1", "display_name": "Johanness", "link": "https://stackoverflow.com/users/783388/johanness"}, "edited": false, "score": 0, "creation_date": 1423080354, "post_id": 28329129, "comment_id": 45008014, "body": "You would probably need a full blown parser to check every cell ... take apart whats in the cell, check if its a reference... quite a task to write (VBA)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423082568, "post_id": 28329129, "comment_id": 45009220, "body": "If all your contants are numeric, and you don&#39;t need to account for names which reference fixed values, then a regular expression which checks for numeric values might work.  Of course, you&#39;d also need to account for whether the previous owner also had <i>some</i> contants stored in cells..."}, {"owner": {"reputation": 282, "user_id": 4514233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b357af21cb261689883aff8ffbad7a54?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe.H", "link": "https://stackoverflow.com/users/4514233/philippe-h"}, "edited": false, "score": 0, "creation_date": 1423088613, "post_id": 28329129, "comment_id": 45012336, "body": "I thought I would have a solution but in fact in does not work in all cases. The idea is to use the SPLIT function in VBA to parse a formula into components and test if at least one component is numeric. Probably feasible with a bit of investigation."}, {"owner": {"reputation": 31, "user_id": 4529586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e79771e86c697909b5d2452591b8b2?s=128&d=identicon&r=PG&f=1", "display_name": "PMDDenver", "link": "https://stackoverflow.com/users/4529586/pmddenver"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423168166, "post_id": 28329129, "comment_id": 45050553, "body": "@DavidZemens - In my examples, the bold portion is the constant.  $A$2 would not be a constant."}, {"owner": {"reputation": 31, "user_id": 4529586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e79771e86c697909b5d2452591b8b2?s=128&d=identicon&r=PG&f=1", "display_name": "PMDDenver", "link": "https://stackoverflow.com/users/4529586/pmddenver"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1423168206, "post_id": 28329129, "comment_id": 45050573, "body": "@nwhaught - I would use the excel glossary definition for constant:  A value that is not calculated. For example, the number 210 and the text &quot;Quarterly Earnings&quot; are constants."}, {"owner": {"reputation": 282, "user_id": 4514233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b357af21cb261689883aff8ffbad7a54?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe.H", "link": "https://stackoverflow.com/users/4514233/philippe-h"}, "edited": false, "score": 0, "creation_date": 1423302422, "post_id": 28329129, "comment_id": 45100342, "body": "According to your definition, a constant is a numeric variable or a text string between double quotes. Delimiters inside a formula are mathematical operators (e.g. +, -, *, ...) or the list separator or a parenthesis. So you need to test if the first component of a formula is either a numeric constant or a text string. If yes, your test is positive. If not, you have to test the second component. And so one until all components have been tested. Add a control to test only cells with formulas. See my answer below for an example edited to take account of text strings as constants."}], "answers": [{"tags": [], "owner": {"reputation": 282, "user_id": 4514233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b357af21cb261689883aff8ffbad7a54?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe.H", "link": "https://stackoverflow.com/users/4514233/philippe-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1423308486, "last_edit_date": 1423308486, "creation_date": 1423087879, "answer_id": 28332470, "question_id": 28329129, "link": "https://stackoverflow.com/questions/28329129/highlight-cells-in-selection-that-contain-formulas-with-constants/28332470#28332470", "title": "Highlight cells in selection that contain formulas with constants", "body": "<p>You can parse formulas using the SPLIT function in VBA. E.g. the code below works for the examples you have given. Returns TRUE if formula contains constants, returns N/A if it is not a formula and FALSE otherwise.</p>\n\n<p>Probably you have to adapt a little bit so it works in all cases, but it's a good starting point.</p>\n\n<pre><code>Function HasConstant(r As Range) As Variant\n\nApplication.Volatile\n\nDim formula As String\nDim delimiters() As String\nDim delimiter As Variant\nDim Components() As String\nDim component As Variant\nDim chars As Integer\n\ndelimiters() = Split(\"+ - * / = &amp; ( ) ,\")\n\nIf r.HasFormula Then\n\n    formula = Right(r.formula, Len(r.formula) - 1)\n\n    Do Until formula = \"\"\n\n        chars = Len(formula)\n        component = formula\n\n        For Each delimiter In delimiters\n\n            Components = Split(formula, delimiter)\n\n            If Len(Components(0)) &lt; chars And Len(Components(0)) &gt; 0 Then\n                component = Components(0)\n                chars = Len(component)\n            End If\n\n        Next\n\n        If IsNumeric(Replace(component, \".\", Application.International(xlDecimalSeparator))) Then 'IsNumeric(component)\n            HasConstant = True\n            Exit Function\n        ElseIf Left(CStr(component), 1) = Chr(34) And Right(CStr(component), 1) = Chr(34) Then\n            HasConstant = True\n            Exit Function\n        End If\n\n        If chars &lt; Len(formula) Then\n            formula = Right(formula, Len(formula) - chars - 1)\n        Else\n            formula = \"\"\n        End If\n\n    Loop\n\nElse\n\n    HasConstant = CVErr(xlErrNA)\n    Exit Function\n\nEnd If\n\nHasConstant = False\n\nEnd Function\n</code></pre>\n\n<p>Example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/RoysK.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 31, "user_id": 4529586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e79771e86c697909b5d2452591b8b2?s=128&d=identicon&r=PG&f=1", "display_name": "PMDDenver", "link": "https://stackoverflow.com/users/4529586/pmddenver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1423308486, "creation_date": 1423075925, "question_id": 28329129, "link": "https://stackoverflow.com/questions/28329129/highlight-cells-in-selection-that-contain-formulas-with-constants", "title": "Highlight cells in selection that contain formulas with constants", "body": "<p>I am working on a budget in excel 2007.  It was written by someone else and contains many sheets and many formulas.  I am trying to make the spreadsheet more efficient by creating an Input worksheet where all/most constants would be entered.  To help with this process, I would like to be able to highlight all formulas that contain constants as well as highlight all constants (not in formulas) within my selection.  Or, if easier, the opposite, highlight all formulas that do not contain constants within my selection.  I am mainly dealing with numbers, not text.</p>\n\n<p>Here are examples of formulas(=) with <strong>constants</strong> and just <strong>constants</strong>:</p>\n\n<ol>\n<li>=<strong>82000</strong>-<strong>50000</strong></li>\n<li>=$A$2-<strong>50000</strong></li>\n<li>=A2-<strong>50000</strong></li>\n<li>=F133***.05**</li>\n<li>50000</li>\n</ol>\n\n<p>Here are examples of formulas(=) that do not contain constants:</p>\n\n<ol>\n<li>=SUM(E8:P8)</li>\n<li>=$C$51*'Servicing Detail'!$E$181</li>\n<li>=K152</li>\n</ol>\n\n<p>The closest answer I could find to my question was here: <a href=\"https://stackoverflow.com/questions/19058246/how-to-determine-if-a-cell-formula-contains-constants/19058564#19058564?newreg=9e3269b7567a425db42e3daa97dce817\">How to determine if a cell formula contains Constants?</a>. But I believe this post to be specific to finding quotations within a formula as Siddharth Rout clarified in his last comment.</p>\n\n<p>Any help would be greatly appreciated.  Thank you.  (This is my first post and hope that I have formatted correctly. Apologies in advance)</p>\n"}, {"tags": ["excel", "excel-2010", "selection", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423075875, "post_id": 28329066, "comment_id": 45005630, "body": "I would learn to not rely on <code>Selection</code> or <code>Active_anything</code> objects :)  You may also be interested to use a more reliable way of finding the &quot;last&quot; used cell in a given range: <a href=\"http://www.siddharthrout.com/2012/10/02/find-last-row-in-an-excel-sheetvbavb-net/\" rel=\"nofollow noreferrer\">siddharthrout.com/2012/10/02/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1423076400, "creation_date": 1423076400, "answer_id": 28329276, "question_id": 28329066, "link": "https://stackoverflow.com/questions/28329066/how-would-you-delete-rows-in-excel-such-that-rangeselection-activecell-special/28329276#28329276", "title": "How would you delete rows in excel such that Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select will not select the now empty rows", "body": "<p>Once you have completed deleting unwanted rows, to select the rows that remain run:</p>\n\n<pre><code>Sub SelectTheRest()\n    Dim N As Long\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Range(\"A1:A\" &amp; N).EntireRow.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 967117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f51fd6be00e06ecf66cf0581f01f7454?s=128&d=identicon&r=PG", "display_name": "WickedMongoose", "link": "https://stackoverflow.com/users/967117/wickedmongoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423076400, "creation_date": 1423075679, "last_edit_date": 1531161705, "question_id": 28329066, "link": "https://stackoverflow.com/questions/28329066/how-would-you-delete-rows-in-excel-such-that-rangeselection-activecell-special", "title": "How would you delete rows in excel such that Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select will not select the now empty rows", "body": "<p>The issue is that I have a function that deletes rows containing specific text:</p>\n\n<pre><code>Sub DeleteRowsContaining(text As String)\n    Dim Firstrow As Long\n    Dim Lastrow As Long\n    Dim Lrow As Long\n\n    With ActiveSheet\n        'Set the first and last row to loop through\n        Firstrow = .UsedRange.Cells(2).Row\n        Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n        'We loop from Lastrow to Firstrow (bottom to top)\n        For Lrow = Lastrow To Firstrow Step -1\n            'We check the values in the A column\n            With .Cells(Lrow, \"A\")\n                If Not IsError(.Value) Then\n                    If .Value = text Then .EntireRow.Delete\n                    'This will delete each row with the Value of text\n                    'in Column A, case sensitive.\n                End If\n            End With\n        Next Lrow\n    End With\nEnd Sub\n</code></pre>\n\n<p>After executing this code block I then would like to select the remaining text, however, any rows that were deleted from the end of a column still count when using the</p>\n\n<pre><code>Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select     \n</code></pre>\n\n<p>command. The real issue is the error that happens when using the next command which is </p>\n\n<pre><code>Selection.End(xlDown).Offset(1, 0).Select\n</code></pre>\n\n<p>When using that command, if you have more than two empty rows selected, an error will be thrown. At this point I am at a loss, as all the ways that I can easily and dynamically check for the end of my data range are returning the location of a blank cell.</p>\n\n<p>I am not sure if there is another way to delete a row that does not leave a cell selectable as if it had data, or if there is a way to trim the empty rows from a selection when excel seems to believe that the rows have something there.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423075727, "post_id": 28328799, "comment_id": 45005559, "body": "I have edited my answer to include a sample code."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1423076214, "creation_date": 1423076214, "answer_id": 28329218, "question_id": 28328799, "link": "https://stackoverflow.com/questions/28328799/why-does-an-instance-of-access-quit-when-opened-from-vba-after-the-macro-is-fini/28329218#28329218", "title": "Why does an instance of Access quit when opened from VBA after the macro is finished running?", "body": "<p>The new Access application instance is created and referenced by the <em>axApp</em> object variable.</p>\n\n<p>At the end of your procedure <em>axApp</em> goes out of scope and is destroyed.  As a result of its destruction, the Access application instance it references is closed.</p>\n\n<p>If you want that Access instance to stick around after your VBA procedure is done, set its <code>.UserControl</code> property to True.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n    Dim axApp As Access.Application\n    Set axApp = CreateObject(\"Access.Application\")\n    axApp.Visible = True\n    axApp.UserControl = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 2, "accepted_answer_id": 28329218, "answer_count": 1, "score": 2, "last_activity_date": 1423076214, "creation_date": 1423074819, "last_edit_date": 1423075629, "question_id": 28328799, "link": "https://stackoverflow.com/questions/28328799/why-does-an-instance-of-access-quit-when-opened-from-vba-after-the-macro-is-fini", "title": "Why does an instance of Access quit when opened from VBA after the macro is finished running?", "body": "<p>I am wondering if someone has encountered this before. When I create an instance of Access (2013) through VBA, the Access application quits when the macro is finished running even though I don't have any <code>Application.quit</code> statement anywhere in the subroutine. Any ideas?</p>\n\n<pre><code>Sub Test()\n    Dim axApp As Access.Application\n    Set axApp = CreateObject(\"Access.Application\")\n    axApp.Visible = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["loops", "ms-access", "parameters", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 4529837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-orvWGvoL42s/AAAAAAAAAAI/AAAAAAAAAGk/KwrjwszgQnY/photo.jpg?sz=128", "display_name": "Caryn Knight", "link": "https://stackoverflow.com/users/4529837/caryn-knight"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423083384, "post_id": 28328732, "comment_id": 45009678, "body": "After hours of Google searching, I have come to the same conclusion that you just can&#39;t do it -- see code I updated above. I think I have found a solution. My query is set up so that I can use the Replace function in the loop. So in my illustration, it will replace 3 with 12, and so on and then replace back to 3 at the end. It&#39;s working so far."}], "answers": [{"tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1423454340, "creation_date": 1423454340, "answer_id": 28402616, "question_id": 28328732, "link": "https://stackoverflow.com/questions/28328732/changing-select-clause-of-an-access-query-in-a-vba-loop/28402616#28402616", "title": "Changing Select Clause of an Access Query in a VBA loop", "body": "<p>I have been making PTQ  (Pass Thru Queries) and they do not edit the column names vs any table at creation time but rather at run time.  I can have  </p>\n\n<pre><code>ptq_xxx as  \"Select ID,  @arg1, DTS  From myTable Where DTS &gt;= @arg2.\"\nsSQL = CurrentDb.QueryDefs(\"ptq_xxx\").sql  \nsSQL = Replace(sSQL, \"@arg1\", myNewFieldName)\nsSQL = Replace(sSQL, \"@arg2\", myDateValue)\nDim rst As ADODB.Recordset, nRecAffected As Long\nSet rst = myConn.Execute(sSQL, nRecAffected)\n</code></pre>\n\n<p>Works like a charm.</p>\n"}], "owner": {"reputation": 31, "user_id": 4529837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-orvWGvoL42s/AAAAAAAAAAI/AAAAAAAAAGk/KwrjwszgQnY/photo.jpg?sz=128", "display_name": "Caryn Knight", "link": "https://stackoverflow.com/users/4529837/caryn-knight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594645454, "creation_date": 1423074575, "last_edit_date": 1594645454, "question_id": 28328732, "link": "https://stackoverflow.com/questions/28328732/changing-select-clause-of-an-access-query-in-a-vba-loop", "title": "Changing Select Clause of an Access Query in a VBA loop", "body": "<p>I'm trying to loop through a few queries in Access (2007-2010) and the first query grabs a different field from a table each time. How do I put a \"parameter\" in the select clause of the SQL statement so that each time it runs the query it will grab the correct field? It doesn't recognize the field name if I put [ ] around it to enter a parameter--it will just enter that name in each record.  </p>\n\n<p>Here's a simplified illustration of what I'm trying to describe:</p>\n\n<pre><code>SELECT \n    Base.Trial, \n    Base.Timestep, \n    Base.Rate3, \n    Base.CashIndex  \nFROM \n    Mthly20141231Base AS Base  \nORDER BY \n    Base.Trial, \n    Base.Timestep\n</code></pre>\n\n<p>Each time VBA loops back to this first query, I want it to run the same thing but instead of Base.Rate3 I want Base.Rate12  </p>\n\n<p>I don't want to have to type the SQL code in VBA.</p>\n\n<p>Thanks for any help!</p>\n\n<p>UPDATE-Here is my code for the alternative since Access doesn't support what I want it to do:</p>\n\n<pre><code>Sub LoopTesting()\n\n    Dim db As dao.Database\n    Dim RS_Inputs As Recordset\n    Dim increment As Long\n    Dim increment_prev As Long\n    Dim QueryString As String\n\n    Set db = CurrentDb\n\n    'This table has my increments I want to loop through\n    Set RS_Inputs = db.OpenRecordset(\"Test Periods\")\n\n    RS_Inputs.MoveFirst\n    increment_prev = RS_Inputs(\"Timestep Increments\")\n\n    Do Until RS_Inputs.EOF\n\n        increment = RS_Inputs(\"Timestep Increments\")\n        QueryString = Replace(GetQueryStr(\"RatesbyTimestep\"), increment_prev, increment)\n        db.QueryDefs(\"RatesbyTimestep\").SQL = QueryString\n        increment_prev = increment\n        Call DeleteTable\n        db.Execute \"Step 3 - MakeTable\"\n        Call UpdatePrice(increment)\n\n        RS_Inputs.MoveNext\n\n    Loop\n\n    'reset query back to first increment\n    QueryString = Replace(GetQueryStr(\"RatesbyTimestep\"), 360, 3)\n    db.QueryDefs(\"RatesbyTimestep\").SQL = QueryString\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "range"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1423073420, "post_id": 28328226, "comment_id": 45004315, "body": "Where is the code that defines your <code>WS</code> variable?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1423073450, "post_id": 28328226, "comment_id": 45004335, "body": "How are your <code>WS</code> and <code>myrange</code> variables dimensioned?  As in what type of variable are they?"}, {"owner": {"reputation": 31, "user_id": 4385598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-QNK_K7Mh1yU/AAAAAAAAAAI/AAAAAAAAIgw/XFaI48N9cuY/photo.jpg?sz=128", "display_name": "Bilfrost", "link": "https://stackoverflow.com/users/4385598/bilfrost"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1423073542, "post_id": 28328226, "comment_id": 45004382, "body": "I define them as  <code>dim WS as worksheet </code>dim myrange as range  WS gets its value from an array that I have defined earlier in the code:  `set WS = worksheets(wsarray(i))  WS is recognized correctly when I use the WS.Range(&quot;a1:b2&quot;) syntax, so that doesn&#39;t seem to be the issue."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1423073574, "post_id": 28328226, "comment_id": 45004404, "body": "You need to edit your post with the code.  Don&#39;t put it in the comments"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 1, "last_activity_date": 1423073893, "creation_date": 1423073893, "answer_id": 28328525, "question_id": 28328226, "link": "https://stackoverflow.com/questions/28328226/external-range-throwing-error-400/28328525#28328525", "title": "External range throwing error 400", "body": "<p>Try defining the sheet in each part of the code:</p>\n\n<pre><code>Set myrange = WS.Range(WS.Cells(1, 1), WS.Cells(10, 10))\n'or\nWith WS\nSet myrange = .Range(.Cells(1, 1), .Cells(10, 10))\n</code></pre>\n\n<p>Each Range whether it is called using the Range object or the Cells object needs to have a defined sheet.</p>\n"}], "owner": {"reputation": 31, "user_id": 4385598, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-QNK_K7Mh1yU/AAAAAAAAAAI/AAAAAAAAIgw/XFaI48N9cuY/photo.jpg?sz=128", "display_name": "Bilfrost", "link": "https://stackoverflow.com/users/4385598/bilfrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 28328525, "answer_count": 1, "score": 1, "last_activity_date": 1423074177, "creation_date": 1423072888, "last_edit_date": 1423074177, "question_id": 28328226, "link": "https://stackoverflow.com/questions/28328226/external-range-throwing-error-400", "title": "External range throwing error 400", "body": "<p>I am struggling with something:</p>\n\n<p>The code I need is:</p>\n\n<pre><code>Set myrange = WS.Range(Cells(1, 1), Cells(10, 10))\n</code></pre>\n\n<p>But this is resulting in a 400 error.</p>\n\n<p>Strangely, either of the two lines work fine:</p>\n\n<pre><code>Set myrange = WS.Range(\"a1:b2\")\n\nSet myrange = Range(Cells(1, 1), Cells(10, 10))\n</code></pre>\n\n<p>So it appears that I am only in trouble if I combine an external sheet reference (<code>WS</code>) with referring to the range using cells.</p>\n\n<p>What might be the problem here?</p>\n"}, {"tags": ["vba", "email", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423072609, "post_id": 28328036, "comment_id": 45003891, "body": "have you tried anything on your own? did you find any initial solution in google or anywhere? something like <a href=\"http://stackoverflow.com/questions/10279045/vba-outlook-2010-retrieving-information-from-active-directory\">that</a> as a first step."}], "answers": [{"comments": [{"owner": {"reputation": 1345, "user_id": 5472502, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qZ3mUF0RIy8/AAAAAAAAAAI/AAAAAAAAAeE/LRiEYccRVlc/photo.jpg?sz=128", "display_name": "Nick Peranzi", "link": "https://stackoverflow.com/users/5472502/nick-peranzi"}, "edited": false, "score": 0, "creation_date": 1458756369, "post_id": 28328411, "comment_id": 60006448, "body": "This works perfectly and answer&#39;s OP&#39;s query exactly. S/b accepted answer IMO."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1423120096, "last_edit_date": 1423120096, "creation_date": 1423073490, "answer_id": 28328411, "question_id": 28328036, "link": "https://stackoverflow.com/questions/28328036/get-email-address-from-active-directory/28328411#28328411", "title": "Get email address from Active Directory", "body": "<p>Try this out: it will query back an email based on either a username (name1 - do not pass a second parameter) or first (name1) and last (name2) names.</p>\n\n<pre><code>Function UserNameToEmail(name1 As String, Optional name2 As String = \"\")\n\n    Set rootDSE = GetObject(\"LDAP://RootDSE\")\n    base = \"&lt;LDAP://\" &amp; rootDSE.Get(\"defaultNamingContext\") &amp; \"&gt;\"\n\n    'filter on user objects with the given account name\n    fltr = \"(&amp;(objectClass=user)(objectCategory=Person)\"\n    If Len(name2) = 0 Then\n        fltr = fltr &amp; \"(sAMAccountName=\" &amp; name1 &amp; \"))\"\n    Else\n        fltr = fltr &amp; \"(givenName=\" &amp; name1 &amp; \")(sn=\" &amp; name2 &amp; \"))\"\n    End If\n\n    'add other attributes according to your requirements\n    attr = \"mail,department,givenName,sn\"\n    scope = \"subtree\"\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    conn.Provider = \"ADsDSOObject\"\n    conn.Open \"Active Directory Provider\"\n\n    Set cmd = CreateObject(\"ADODB.Command\")\n    Set cmd.ActiveConnection = conn\n    cmd.CommandText = base &amp; \";\" &amp; fltr &amp; \";\" &amp; attr &amp; \";\" &amp; scope\n\n    Set rs = cmd.Execute\n\n    If Not rs.EOF Then\n      For Each f In rs.Fields\n        Debug.Print f.Name &amp; \": \" &amp; f.Value\n      Next f\n      UserNameToEmail = rs.Fields(\"mail\").Value\n    End If\n\n    rs.Close\n    conn.Close\n\nEnd Function\n</code></pre>\n\n<p>FYI- list of ActiveDirectory fields: <a href=\"http://www.kouti.com/tables/userattributes.htm\" rel=\"nofollow\">http://www.kouti.com/tables/userattributes.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1423079888, "creation_date": 1423079888, "answer_id": 28330308, "question_id": 28328036, "link": "https://stackoverflow.com/questions/28328036/get-email-address-from-active-directory/28330308#28330308", "title": "Get email address from Active Directory", "body": "<p>Are you using the Outlook Object Model? Callin Recipient.Resolve or Recipeints.ResolveAll will resolve the display names of the message recipients. </p>\n\n<p>If you want to resolve a name to an address without creating a message, use Namespace.CreateRecipient / Recipeint.Resolve.</p>\n"}], "owner": {"reputation": 1, "user_id": 4488054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9518186ad80a4615e13c6dd56c3e6c0f?s=128&d=identicon&r=PG&f=1", "display_name": "jagdfuerst", "link": "https://stackoverflow.com/users/4488054/jagdfuerst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7020, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1594068292, "creation_date": 1423072250, "last_edit_date": 1594068292, "question_id": 28328036, "link": "https://stackoverflow.com/questions/28328036/get-email-address-from-active-directory", "title": "Get email address from Active Directory", "body": "<p>I have Word VBA code which sends a document via mail. The recipient email address is manually written into a textbox and then committed automatically to Outlook.</p>\n\n<p>I want that the email address is automatically set into that textbox by using the name of a person (also textboxes for firstname + lastname), comparing that to the Active Directory and retrieving the appropriate email address.</p>\n\n<p>How to do that in Word VBA?</p>\n"}, {"tags": ["vba", "date", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1423072565, "post_id": 28328014, "comment_id": 45003864, "body": "You should be able to pull the current cell via:  selection.address ... can you not?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4437913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc9fb5face31db719e3857bda5ae0dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kahlan", "link": "https://stackoverflow.com/users/4437913/kahlan"}, "edited": false, "score": 1, "creation_date": 1423073275, "post_id": 28328237, "comment_id": 45004246, "body": "Thank you very much, your solution fixed the problem and answered my question."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 0, "last_activity_date": 1423073351, "last_edit_date": 1423073351, "creation_date": 1423072921, "answer_id": 28328237, "question_id": 28328014, "link": "https://stackoverflow.com/questions/28328014/conditional-formatting-using-date-comparison/28328237#28328237", "title": "Conditional Formatting using Date Comparison", "body": "<p>The following will get you what you want:</p>\n\n<pre><code>oSheet.Range(Cells(iStartRow, 1), Cells(iLastRow, 1)).FormatConditions.Add Type:=xlExpression, Formula1:=\"=$A\" &amp; iStartRow &amp; \"=TODAY()\"\n</code></pre>\n\n<p>If you want to reference a specific cell for your date comparison use (for example C1):</p>\n\n<pre><code>oSheet.Range(Cells(iStartRow, 1), Cells(iLastRow, 1)).FormatConditions.Add Type:=xlExpression, Formula1:=\"=$A\" &amp; iStartRow &amp; \"=$C$1\"\n</code></pre>\n\n<p>Notice that in both examples there is a <code>$</code> before the <code>A</code> because it is a fixed column, but there is NO <code>$</code> before the row because the row (<code>iStartRow</code>) needs to be variable.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1423074657, "creation_date": 1423074657, "answer_id": 28328746, "question_id": 28328014, "link": "https://stackoverflow.com/questions/28328014/conditional-formatting-using-date-comparison/28328746#28328746", "title": "Conditional Formatting using Date Comparison", "body": "<p>I don't know how that CF rule's code fits into the surrounding code but you would do better to explicitly define the extents of the <code>.Range</code> as belonging to the same parent worksheet.</p>\n\n<pre><code>with oSheet\n    .Range(.Cells(iStartRow, 1), .Cells(iLastRow, 1)).FormatConditions.Add Type:=xlExpression, Formula1:=\"=$A\" &amp; iStartRow &amp; \"=TODAY()\"\nend with\n</code></pre>\n\n<p>The prefix periods (e.g. <em>full stop</em> or .) tell <code>.Range(...</code> and <code>.Cells(...</code> that they belong to <code>oSheet</code>. Without them, your code may work or it may not. There have been several cases recently where a simple parent mis-definition (by relying on the <em>ActiveSheet</em>) broke otherwise good code.</p>\n"}], "owner": {"reputation": 55, "user_id": 4437913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc9fb5face31db719e3857bda5ae0dbe?s=128&d=identicon&r=PG&f=1", "display_name": "Kahlan", "link": "https://stackoverflow.com/users/4437913/kahlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "accepted_answer_id": 28328237, "answer_count": 2, "score": 1, "last_activity_date": 1423074657, "creation_date": 1423072191, "last_edit_date": 1423073117, "question_id": 28328014, "link": "https://stackoverflow.com/questions/28328014/conditional-formatting-using-date-comparison", "title": "Conditional Formatting using Date Comparison", "body": "<p>I am trying to create a conditional formatting rule in VBA that will change the cell background color only for the current date. I have a column of dates for the year. I am also using Office Excel 2010.</p>\n\n<pre><code>oSheet.Range(Cells(iStartRow, 1), Cells(iLastRow, 1)).FormatConditions.Add xlCellValue, xlEqual, \"=\" &amp; Cells.Address &amp; \"=\" &amp; Date\n</code></pre>\n\n<p>I am trying to identify the current cell's address, so that it can be compared against today's date. Remember that this formula will be checked against a column of different dates.</p>\n\n<p>I can create the conditional formatting in Excel easy enough, but I'm trying to recreate this statement in VBA code.</p>\n\n<p>When I create the Conditional formatting necessary for the Dates Occurring in Excel and then view the formula in VBA; here are the results:\n<code>=FLOOR(A32,1)=TODAY()</code></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423078754, "post_id": 28328002, "comment_id": 45007166, "body": "Works. Just a question -- I called my method addPerson, rather than overloading the add function. But I get a difference between calling the function with parenthesis or not (see my edits above). Care to comment and educate me ;)"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423078839, "post_id": 28328002, "comment_id": 45007216, "body": "Well, no... Not because I&#39;m mean, but because that&#39;s rightfully a completely different question. You should create a new question instead of editing this one."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423079238, "post_id": 28328002, "comment_id": 45007395, "body": "@abalter the parentheses are forcing an evaluation.  Your <code>PersonList</code> class does not have a suitable <code>Get</code> method for the <code>person_list</code> property."}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 5, "last_activity_date": 1423078946, "last_edit_date": 1423078946, "creation_date": 1423072137, "answer_id": 28328002, "question_id": 28327803, "link": "https://stackoverflow.com/questions/28327803/creating-class-with-collection-in-vba/28328002#28328002", "title": "Creating class with collection in VBA", "body": "<p>I recreated your project with the names you gave us.\nThe line that gets the compiler error is right here.</p>\n\n<blockquote>\n  <p>Dim p1 As New clsPerson</p>\n</blockquote>\n\n<p>This is because your class is named <code>Person</code> and not <code>clsPerson</code>. \nDropping the prefix should fix the compiler error.</p>\n\n<p><strong><em>But</em></strong>...</p>\n\n<p>You're going to run into your next problem very soon.</p>\n\n<blockquote>\n  <p>Dim person_list As Collection</p>\n</blockquote>\n\n<p>This declares the person list privately. You'll need to expose it by making it public to work with it. But there's a little more to it than that. You'll also need to add a <code>Class_Initialize</code> routine to your class so that you actually have a collection object to work with.</p>\n\n<pre><code>Private Sub Class_Initialize()\n    Set person_list = New Collection\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I just noticed that you wanted to keep that collection private, so in addition to the class initializer, you'll need to add this method too.</p>\n\n<pre><code>Public Sub Add(value As Person)\n    person_list.Add value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 1, "accepted_answer_id": 28328002, "answer_count": 1, "score": 3, "last_activity_date": 1423078946, "creation_date": 1423071520, "last_edit_date": 1531164843, "question_id": 28327803, "link": "https://stackoverflow.com/questions/28327803/creating-class-with-collection-in-vba", "title": "Creating class with collection in VBA", "body": "<p>I have a class that represents a person</p>\n\n<p><strong>Person.cls</strong></p>\n\n<pre><code>Option Explicit\n'the person class\nPublic FirstName As String\nPublic LastName As String\n</code></pre>\n\n<p>and another class to hold a list of people</p>\n\n<p><strong>PersonList.cls</strong></p>\n\n<pre><code>Dim person_list As Collection\n</code></pre>\n\n<p>I have a module</p>\n\n<p><strong>testPersons.bas</strong></p>\n\n<pre><code>Public Sub testPersons()\n    Dim p1 As New clsPerson\n    p1.FirstName = \"Rita\"\n    p1.LastName = \"Smith\"\n\n    Dim persons2 As New PersonList\n    persons2.person_list.Add p1\nEnd Sub\n</code></pre>\n\n<p>When I run the module I get a compile error: \"Method or data member not found.\"</p>\n\n<p>I tried creating a subroutine <code>addPerson</code> to PersonList, but I can't figure out how to make that work.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Ok, here is what I have now:</p>\n\n<p><strong>Person.cls</strong></p>\n\n<pre><code>Option Explicit\nPublic FirstName As String\nPublic LastName As String\n</code></pre>\n\n<p><strong>PersonList.cls</strong></p>\n\n<pre><code>Public person_list As Collection\n\nPrivate Sub Class_Initialize()\n    Set person_list = New Collection\nEnd Sub\n\nPublic Sub addPerson(this_person As Person)\n    person_list.Add this_person\nEnd Sub\n</code></pre>\n\n<p><strong>testPersons.bas</strong></p>\n\n<pre><code>Public Sub testPersons()\n    Dim p1 As New Person\n    p1.FirstName = \"Rita\"\n    p1.LastName = \"Smith\"\n\n    Dim persons_list As New PersonList\n    persons_list.addPerson p1\nEnd Sub\n</code></pre>\n\n<p>And...<strong>it works!</strong></p>\n\n<p>However, <code>persons_list.addPerson(p1)</code> gives \"<code>Run-time error: 438: Object doesn't support this property or method.</code>\" I guess I don't understand VBA syntax for calling methods.</p>\n"}, {"tags": ["vba", "excel", "ontime"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1423071684, "post_id": 28327790, "comment_id": 45003316, "body": "Getting this to run while the computer is shut down would be quite a feat!  for the other cases though, you should maybe consider using Windows Task Scheduler and a <code>Workbook_Open</code> macro instead of <code>OnTime</code>."}, {"owner": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "edited": false, "score": 1, "creation_date": 1423072054, "post_id": 28327790, "comment_id": 45003541, "body": "Does it work if you change <code>TimeValue(&quot;15:32:00&quot;)</code> to <code>DateValue(Now() - TimeValue(&quot;15:32:00&quot;)) + TimeValue(&quot;15:32:00&quot;)</code>?"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "edited": false, "score": 0, "creation_date": 1423079433, "post_id": 28327790, "comment_id": 45007520, "body": "@Rdhs yes it does. Thanks!"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423079509, "post_id": 28327790, "comment_id": 45007557, "body": "@Tim Williams hahahaha. I realize it was a very dumb question. But you never know. Before I started playing with VBA I had no idea that some of these things we&#39;re possible. So maybe it could work some kinda magic and turn the computer on too! haha"}, {"owner": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "edited": false, "score": 0, "creation_date": 1423081083, "post_id": 28327790, "comment_id": 45008460, "body": "(Anyone coming across this in the future, the actual code you should replace with is <code>Int(Now() - TimeValue(&quot;15:32:00&quot;) + 1) + TimeValue(&quot;15:32:00&quot;)</code>.)"}], "answers": [{"tags": [], "owner": {"reputation": 578, "user_id": 2864943, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1c2806b31e9db236ecaea41e7427abb4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael ", "link": "https://stackoverflow.com/users/2864943/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1616789873, "creation_date": 1616789873, "answer_id": 66823793, "question_id": 28327790, "link": "https://stackoverflow.com/questions/28327790/ontime-is-not-working/66823793#66823793", "title": "OnTime is not Working", "body": "<p>Application.OnTime works in the Windows implementation. As of 3/27/2021, it does not work on an Apple Mac Mini M1.</p>\n<p>I ran the following test code to verify it's a bug in Microsoft's VBA interpreter. The Message box never appears unless testboo is run directly.  I lifted the Ontime call from Microsoft's documentation.</p>\n<pre><code> Sub testtime()\n    Application.OnTime Now + TimeValue(&quot;00:00:15&quot;), &quot;testboo&quot;\n End Sub\n\n Sub testboo()\n   MsgBox (&quot;boo&quot;)\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1616789873, "creation_date": 1423071468, "last_edit_date": 1426010794, "question_id": 28327790, "link": "https://stackoverflow.com/questions/28327790/ontime-is-not-working", "title": "OnTime is not Working", "body": "<p>I currently have on OnTime Function (below) that isn't working.</p>\n\n<pre><code>Sub DeleteAllZeros()\"   'All of these are defined and work perfectly'\nApagarZerosLCA\nApagarZerosLCAFEC\nApagarZerosLCA_ACC\nApagarZerosLCA_ACC_FEC\nApagarZerosLCI\nApagarZerosLCIFEC\nEnd Sub\n\n\nPrivate Sub AutoDeleteZeros()\n\nApplication.OnTime TimeValue(\"15:32:00\"), \"DeleteAllZeros\"\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone explain why this isn't working? Also (likely dumb questions), how would I have it so that this would run if the workbook is closed? Is it possible to have it run if the computer is locked, shut down, or logged off?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "worksheet-function"], "comments": [{"owner": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "edited": false, "score": 1, "creation_date": 1423071150, "post_id": 28327611, "comment_id": 45003017, "body": "What have you tried? You said you won&#39;t attempt to code this since &quot;it will take some time and time is precious&quot; \u2013 is our time <i>not</i> precious?"}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 2, "last_activity_date": 1423071840, "creation_date": 1423071840, "answer_id": 28327911, "question_id": 28327611, "link": "https://stackoverflow.com/questions/28327611/matching-columns-between-sheets-and-transferring-names/28327911#28327911", "title": "Matching columns between sheets and transferring names", "body": "<p>I think what you want, is:</p>\n\n<p>Turn on Record Macro:  </p>\n\n<p>In H1 enter:</p>\n\n<pre><code>=IFERROR(INDEX('Sheet #1'!A:A,MATCH(I1,'Sheet #1'!B:B,0)),\"\")\n</code></pre>\n\n<p>and copy down to suit.</p>\n"}], "owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 28327911, "answer_count": 1, "score": 0, "last_activity_date": 1562648878, "creation_date": 1423070760, "last_edit_date": 1562648878, "question_id": 28327611, "link": "https://stackoverflow.com/questions/28327611/matching-columns-between-sheets-and-transferring-names", "title": "Matching columns between sheets and transferring names", "body": "<p>I'm trying to transfer values with macro in Excel for my upcoming billiards tournament playoff table. For example let's say I have column A with names {A1,A2,A3,A4} and every name is on a different row. Then I have column B in the same sheet with according values {1,4,3,2}. Now I have another sheet which has column I (and previous column H of course) and that column I has values from 1-16. I'd like to match numbers between columns I and B and place names to the previous column (column H). </p>\n\n<p>To visualize this idea (keep in mind that every element is on its own row):</p>\n\n<pre><code>Column A, sheet #1: {A1,A2,A3,A4}   \nColumn B, sheet #1: {1,4,3,2}    \nColumn I, sheet #2: {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16}   \nColumn H, sheet #2: {}   \n</code></pre>\n\n<p>Column H should get values from column A, other rows (which numbers are not in column B) will be left empty.</p>\n\n<p>I've never done VBA before. I know coding in Java and Python but VBA is not really my thing. I'd like to see if anyone could point me in the right direction or maybe should even solve this issue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423069906, "post_id": 28327265, "comment_id": 45002204, "body": "This should work as expected. Can you show some more of your code?  This will have to be assigned <i>before</i> the <code>frmAddLineItem.Show</code> statement."}, {"owner": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423070019, "post_id": 28327265, "comment_id": 45002278, "body": "There isn&#39;t much more to show really that&#39;s the whole Sub. It&#39;s called by a button on a user form (Code Above)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423070104, "post_id": 28327265, "comment_id": 45002338, "body": "Please put your code in the question. It&#39;s impossible to read it when you put it in a comment."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423070216, "post_id": 28327265, "comment_id": 45002418, "body": "Have you put a breakpoint on the assignment to debug it?"}, {"owner": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423070671, "post_id": 28327265, "comment_id": 45002726, "body": "No, it doesnt break the array gets created but it has no values just the space. See above for pics"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423071477, "post_id": 28327265, "comment_id": 45003206, "body": "That&#39;s not what I asked. I asked if you put a breakpoint on that line. If you don&#39;t know what a breakpoint is, you need to look it up and learn basics of debugging.  <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">THIS RESOURCE</a> will save you lots of headaches in the future :)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "edited": false, "score": 0, "creation_date": 1423070711, "post_id": 28327447, "comment_id": 45002753, "body": "The above works but I still need it to pass in the values from an Array"}], "tags": [], "owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1423071038, "last_edit_date": 1423071038, "creation_date": 1423070180, "answer_id": 28327447, "question_id": 28327265, "link": "https://stackoverflow.com/questions/28327265/passing-cell-values-into-a-combo-box-list/28327447#28327447", "title": "Passing Cell Values into a combo box list", "body": "<p>Using ComboBox, you can use <code>.List</code> property of the same to populate worksheet values to combox box.</p>\n\n<p>Check this below example:</p>\n\n<pre><code>ComboBox1.List = Worksheets(\"Sheet1\").Range(\"A1:A5\").Value\n</code></pre>\n\n<p>If you want to use Array, </p>\n\n<pre><code>Dim Arr As Variant\nArr = Worksheets(\"Sheet1\").Range(\"A1:A5\").Value\nComboBox1.List = Arr \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "edited": false, "score": 0, "creation_date": 1423070919, "post_id": 28327580, "comment_id": 45002888, "body": "This works too but again it looks to just create a drop down list with blank lines."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "edited": false, "score": 1, "creation_date": 1423070981, "post_id": 28327580, "comment_id": 45002923, "body": "@Gek Does your workbook have multiple sheets? Check my edit above and input the correct sheet name."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "edited": false, "score": 0, "creation_date": 1423071417, "post_id": 28327580, "comment_id": 45003167, "body": "You should be able to use the <code>.List</code> method @Gek. The problem in your OP was that you did not qualify the correct worksheet object :)"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423071587, "post_id": 28327580, "comment_id": 45003277, "body": "@DavidZemens Both methods work.  Just depends on preference of usage."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1423072039, "post_id": 28327580, "comment_id": 45003532, "body": "Yes, both methods work. I just wanted to point out that it&#39;s not at all necessary in this case to rely on the <code>.AddItem</code> method and that the answer does nto depend on using that method only.  IME, the <code>.AddItem</code> method is most useful when inserting or re-arranging values in the list, and also <i>necessary</i> to use when working with a multi-column list box which is not linked to a RowRange.  Cheers and + 1 to you."}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 2, "last_activity_date": 1423070975, "last_edit_date": 1423070975, "creation_date": 1423070652, "answer_id": 28327580, "question_id": 28327265, "link": "https://stackoverflow.com/questions/28327265/passing-cell-values-into-a-combo-box-list/28327580#28327580", "title": "Passing Cell Values into a combo box list", "body": "<p>There is another (rougher) method <a href=\"http://www.contextures.com/Excel-VBA-ComboBox-Lists.html\" rel=\"nofollow\">found here</a> to do this if you so choose.  Also make sure you define the Sheet name you are sourcing the data from:</p>\n\n<pre><code>Sub AddItemsToBox()\n\n    Dim itemcell As Range\n\n    For Each itemcell in Sheets(\"Source Sheet Name\").Range(\"A1:A5\")\n        frmAddLineItem.ddlProduct.AddItem itemcell.Value\n    Next itemcell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 9661556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc5ebad8c3687af7532ede3ee865f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Dolcekar", "link": "https://stackoverflow.com/users/9661556/dolcekar"}, "is_accepted": false, "score": 0, "last_activity_date": 1588996886, "creation_date": 1588996886, "answer_id": 61691629, "question_id": 28327265, "link": "https://stackoverflow.com/questions/28327265/passing-cell-values-into-a-combo-box-list/61691629#61691629", "title": "Passing Cell Values into a combo box list", "body": "<p>I am just getting into VBA and I am doing exactly this. I think the way I found is pretty easy and straightforward. I'll share it in case it can help someone</p>\n\n<ol>\n<li>Declare variable to store table from Worksheet as \"range\". Make sure \nit's outside of sub routines so it can be called by any function</li>\n</ol>\n\n<p><code>Dim myTable As Range</code></p>\n\n<ol start=\"2\">\n<li>Store table values in declared variable. Then select which column (range) of values you want to store in your combo box.</li>\n</ol>\n\n<pre><code>Private Sub UserForm_Initialize()\nSet myTable = Worksheets(\"dataSheetName\").Range(\"A2:B6\")\n    Me.myComboBox.List = myTable.Columns(1).Value\nEnd Sub ```\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 1788804, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/007a4168cb225282fb50a9470dba789b?s=128&d=identicon&r=PG", "display_name": "Gek", "link": "https://stackoverflow.com/users/1788804/gek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1671, "favorite_count": 0, "accepted_answer_id": 28327580, "answer_count": 3, "score": 1, "last_activity_date": 1588996886, "creation_date": 1423069588, "last_edit_date": 1423070639, "question_id": 28327265, "link": "https://stackoverflow.com/questions/28327265/passing-cell-values-into-a-combo-box-list", "title": "Passing Cell Values into a combo box list", "body": "<p>I am looking to pass cells values into the list for a combo box in Excel.</p>\n\n<p>I have created an array to pass the cell values into but they aren't getting to the combo box list when they are being called. I need the cell values to display as the drop down items and all that displays is the blank space:</p>\n\n<pre><code>Sub Clear_Invoice_Data()\n\n    Dim Arr As Variant\n    Arr = Range(\"A1:A5\").Value\n\n    frmAddLineItem.ddlProduct.List = Arr    \n\nEnd Sub\n</code></pre>\n\n<p>It is called by a button from a User form:</p>\n\n<pre><code>Private Sub cmdClearAll_Click()\n\n    Call Button_Functions.Clear_Invoice_Data\n    i = 18\n\nEnd Sub\n</code></pre>\n\n<p>Pictures of problem: (no values)</p>\n\n<p><img src=\"https://i.stack.imgur.com/qWhvz.png\" alt=\"no elements\">\n<img src=\"https://i.stack.imgur.com/gMZzC.png\" alt=\"5 elements\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4165507, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0b0a5ccdfaf07b4bad099a49c6aaaaaa?s=128&d=identicon&r=PG&f=1", "display_name": "4d554d424c4553", "link": "https://stackoverflow.com/users/4165507/4d554d424c4553"}, "edited": false, "score": 0, "creation_date": 1423070374, "post_id": 28327386, "comment_id": 45002519, "body": "Thanks @David Zemens for that but how can I get it to move the Category at the same time?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 85, "user_id": 4165507, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0b0a5ccdfaf07b4bad099a49c6aaaaaa?s=128&d=identicon&r=PG&f=1", "display_name": "4d554d424c4553", "link": "https://stackoverflow.com/users/4165507/4d554d424c4553"}, "edited": false, "score": 0, "creation_date": 1423070952, "post_id": 28327386, "comment_id": 45002912, "body": "The series also has an <code>.XValues</code> property, which sets the categories.  Use that to assign the category labels. <b>Note:</b> this method is kind of clunky, you&#39;re assigning literal values rather than linking to the cells on the worksheet, so your chart will not &quot;update&quot; if the data changes."}, {"owner": {"reputation": 85, "user_id": 4165507, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0b0a5ccdfaf07b4bad099a49c6aaaaaa?s=128&d=identicon&r=PG&f=1", "display_name": "4d554d424c4553", "link": "https://stackoverflow.com/users/4165507/4d554d424c4553"}, "edited": false, "score": 0, "creation_date": 1423071200, "post_id": 28327386, "comment_id": 45003042, "body": "Can I ask how you would suggest is the best method to do this?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 85, "user_id": 4165507, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0b0a5ccdfaf07b4bad099a49c6aaaaaa?s=128&d=identicon&r=PG&f=1", "display_name": "4d554d424c4553", "link": "https://stackoverflow.com/users/4165507/4d554d424c4553"}, "edited": false, "score": 0, "creation_date": 1423072355, "post_id": 28327386, "comment_id": 45003723, "body": "There are literally thousands of examples of manipulating Excel charts all over the interweb. You might be able to use the <code>.SetSourceData</code> method (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff841196(v=office.14).aspx\" rel=\"nofollow noreferrer\">here</a>)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 85, "user_id": 4165507, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0b0a5ccdfaf07b4bad099a49c6aaaaaa?s=128&d=identicon&r=PG&f=1", "display_name": "4d554d424c4553", "link": "https://stackoverflow.com/users/4165507/4d554d424c4553"}, "edited": false, "score": 0, "creation_date": 1423072409, "post_id": 28327386, "comment_id": 45003763, "body": "Or you can assign a formula reference to the <code>.Values</code> and <code>.XValues</code> property (probably more reliable) like: <code>ActiveChart.SeriesCollection(1).Values = &quot;=&quot; &amp; rg.Parent.Name &amp; &quot;!&quot; &amp; rng.Address</code>"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 1, "creation_date": 1423147370, "post_id": 28327386, "comment_id": 45037764, "body": "@DavidZemens - If you assign a range to .Values or .XValues, you are not assigning literal values, you are in fact assigning the range. You do however need to use a formula to assign a range to the .Name of a series. But use ActiveChart.SeriesCollection(1).Name = ActiveSheet.Range(&quot;C2&quot;).Address(External:=True) and let Excel figure out whether the sheet name requires single quotes etc."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1423155528, "post_id": 28327386, "comment_id": 45043223, "body": "@JonPeltier thanks for clarifying, my mistake (thinking about assigning variant arrays to those properties, which does the literal value)!"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1423248774, "post_id": 28327386, "comment_id": 45085903, "body": "@DavidZemens - Sure. The Excel Charting Object Model is large and complicated and mostly unintuitive."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1423070019, "creation_date": 1423070019, "answer_id": 28327386, "question_id": 28327258, "link": "https://stackoverflow.com/questions/28327258/move-chart-series-data-via-vba/28327386#28327386", "title": "Move Chart series data via VBA", "body": "<p>This will \"move\" the range, rather than resizing it, which is what you're doing.</p>\n\n<pre><code>Set rg = rg.Offset(1,0)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4165507, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0b0a5ccdfaf07b4bad099a49c6aaaaaa?s=128&d=identicon&r=PG&f=1", "display_name": "4d554d424c4553", "link": "https://stackoverflow.com/users/4165507/4d554d424c4553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1208, "favorite_count": 0, "accepted_answer_id": 28327386, "answer_count": 1, "score": 1, "last_activity_date": 1423070019, "creation_date": 1423069573, "question_id": 28327258, "link": "https://stackoverflow.com/questions/28327258/move-chart-series-data-via-vba", "title": "Move Chart series data via VBA", "body": "<p>I have the following code</p>\n\n<pre><code>Dim ss As Series\nDim strs() As String\nSet ss = ActiveChart.SeriesCollection(1)\nstrs = Split(ss.Formula, \",\")\nDim rg As Range\nSet rg = Range(strs(2))\nSet rg = rg.Resize(rg.Rows.Count + 1)\nActiveChart.SeriesCollection(1).Values = rg\n</code></pre>\n\n<p>This allows me to add 1 more item of data to my data series but I want it to also remove the 1st entry every time I run it. For example Day 1- range is A1 to C1 then I run the macro I want it to go to B1 to D1</p>\n\n<p>I hope this makes sense</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "edited": false, "score": 0, "creation_date": 1423069291, "post_id": 28327139, "comment_id": 45001816, "body": "it says Syntax error in JOIN operation."}, {"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 2, "creation_date": 1423069434, "post_id": 28327139, "comment_id": 45001910, "body": "Where is the table alias <code>eb</code> defined?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423069437, "post_id": 28327139, "comment_id": 45001912, "body": "Access SQL does not accept just <code>JOIN</code>.  You have to tell it which type of join you want, so must include <code>INNER</code>, <code>LEFT</code>, or <code>RIGHT</code>."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1423069503, "post_id": 28327139, "comment_id": 45001953, "body": "Did you make this in the designer then copy/paste to VBA? Because the parentheses need to be just right with that many joins."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423070247, "post_id": 28327139, "comment_id": 45002436, "body": "Does your Access database really include tables whose names contain periods: dbo.eCs_QCqueue; dbo.eCs_Queries; and dbo.eCs_Type? If those are really their names, you will probably need to bracket them ... [dbo.eCs_QCqueue] and so forth."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423080615, "post_id": 28327139, "comment_id": 45008173, "body": "I&#39;m going through some other errors here that I might need to clear up before this, but I think the numerous things mentioned here are all contributing to this not working.  I&#39;ll revisit this ASAP.  @HansUp, just so you know, this is eventually going to be a passthrough and the dbo. is part of that, not tables with periods in names."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423080935, "post_id": 28327139, "comment_id": 45008369, "body": "Access and SQL Server&#39;s SQL dialects are different enough that you should make that point clear <b>in the question</b> so you spare other helpers the frustration of offering suggestions only to later discover they don&#39;t apply."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423082734, "post_id": 28327139, "comment_id": 45009329, "body": "@HansUp you&#39;re absolutely right, sorry about that.  Will be more detailed from now on."}], "answers": [{"tags": [], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "is_accepted": true, "score": 1, "last_activity_date": 1424576420, "creation_date": 1424576420, "answer_id": 28654243, "question_id": 28327139, "link": "https://stackoverflow.com/questions/28327139/access-2007-query-def-syntax-error/28654243#28654243", "title": "Access 2007 Query Def Syntax Error", "body": "<p>just wanted to say user HansUp was right in this instance of what my problem was.  VBA doesn't do just <code>JOIN</code>s.</p>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 28654243, "answer_count": 1, "score": 1, "last_activity_date": 1424576420, "creation_date": 1423069247, "question_id": 28327139, "link": "https://stackoverflow.com/questions/28327139/access-2007-query-def-syntax-error", "title": "Access 2007 Query Def Syntax Error", "body": "<p>this is really frustrating and I'm hoping you can help me.  I keep getting a syntax error no matter what I do on this query.  I've read about putting parantheses on multiple joins but I did that and it doesn't work.  What am I doing wrong here?  Thanks for your time.</p>\n\n<pre><code>Set PTI = CurrentDb.CreateQueryDef(\"qry_PTImport\", \"SELECT DISTINCT\" &amp; _\n            \" bl.LoanNumber\" &amp; _\n            \", qcq.Code\" &amp; _\n            \", t.ecType\" &amp; _\n            \", eb.QueryNo\" &amp; _\n            \", q.QueryName\" &amp; _\n            \", q.Description\" &amp; _\n            \", q.suggestedAction\" &amp; _\n            \", bd.datetransfer\" &amp; _\n            \", bd.datebrd \" &amp; _\n            \"FROM ((((dbo.eCs_QCqueue qcq \" &amp; _\n            \"JOIN dbo.eCs_Queries q ON q.QueryNo = eb.QueryNo) \" &amp; _\n            \"JOIN brd_loan bl ON bl.serialID = qcq.serialID) \" &amp; _\n            \"JOIN dbo.eCs_Type t ON t.ectypeid = q.ectypeid) \" &amp; _\n            \"JOIN brd_deal bd ON bd.Code = bl.Code) \" &amp; _\n            \"WHERE qcq.Code = '\" &amp; Deal &amp; \"'\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "edited": false, "score": 0, "creation_date": 1423068872, "post_id": 28326888, "comment_id": 45001526, "body": "Excellent! I knew it was something simple"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 1, "last_activity_date": 1423068558, "creation_date": 1423068558, "answer_id": 28326888, "question_id": 28326852, "link": "https://stackoverflow.com/questions/28326852/vba-save-worksheets-with-array/28326888#28326888", "title": "VBA Save worksheets with array", "body": "<p>Change <code>Worksheets</code> to <code>Sheets</code>.</p>\n\n<pre><code>Sheets(Array(\"Table 1\", \"Table 2\", \"Figure 1\", \"Table 3\")).Copy\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 28326888, "answer_count": 1, "score": 1, "last_activity_date": 1423068558, "creation_date": 1423068437, "last_edit_date": 1531164843, "question_id": 28326852, "link": "https://stackoverflow.com/questions/28326852/vba-save-worksheets-with-array", "title": "VBA Save worksheets with array", "body": "<p>I have a code that will save the specified worksheets into a new workbook. The issue I'm having is it ignores a chart I would like to save. If I put \"Figure 1\" (the name of the chart) to the array list I get an error: \"Subscript out of range\". If I change \"Figure 1\" to the actual name on of the chart I get the same error. </p>\n\n<p>I'm assuming Worksheets(Array(A,B,C)).Copy isn't the code I'm looking for.</p>\n\n<p>Any ideas to copy over the chart?</p>\n\n<pre><code>Sub SavSheets()\n Dim InitFileName As String, fileSaveName As String\n\nfileSaveName = \"C:\\Desktop\\\"\nWorksheets(Array(\"Table 1\", \"Table 2\", \"Figure 1\", \"Table 3\")).Copy\nSet wbNew = ActiveWorkbook\nWith wbNew\n    .SaveAs fileSaveName\n    .Close\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423068131, "post_id": 28326526, "comment_id": 45000996, "body": "This loop hurts my eyes."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1423068286, "post_id": 28326526, "comment_id": 45001112, "body": "Why do you need to <code>Exit For</code> ?  Are you trying to exit the outer loop?"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423068508, "post_id": 28326526, "comment_id": 45001271, "body": "@Jens: Agreed O.o  however, what he&#39;s asking should work - might not be the best way to code it - but it <i>should</i> work (as shown in my tests below). something else is going on he&#39;s not telling us ;)"}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1423068725, "post_id": 28326526, "comment_id": 45001409, "body": "Please see <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>. This likely will make the problem obvious and you will be able to answer on your own."}, {"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423068888, "post_id": 28326526, "comment_id": 45001542, "body": "@Valentin, what are you trying to do with your code?"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1423068919, "post_id": 28326526, "comment_id": 45001561, "body": "Are you trying to exit the second for loop with &quot;j&quot; or do you want to exit all for loops? If you want to exit the inside loop i think you can simply delete &quot;Else&quot; and &quot;Exit For&quot;. No?"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1450879480, "post_id": 28326526, "comment_id": 56615591, "body": "It appears Valentin wants to increment I and/or J before the exit for. If I&#39;m correct, For-Loops in VBA won&#39;t take notice of whatever changes you&#39;ve made. For example, say <code>i</code> is currently at 5 and you add 3 to it, in the next iteration it will be 6, not 9. The alternative would a <code>Do-While</code> loop."}], "answers": [{"comments": [{"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 2, "creation_date": 1423068875, "post_id": 28326715, "comment_id": 45001529, "body": "This is really more of a comment than an answer."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1423072609, "post_id": 28326715, "comment_id": 45003890, "body": "Too large for comment, and without the code snippets, it&#39;s senseless.  Needed the space and formatting to express the point properly."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1423230354, "post_id": 28326715, "comment_id": 45075224, "body": "My response here is a fully workable, complete test case, attempting to show the OP that doing a i=i+1 does in fact work. It is not a sloppy answer, it not incomplete. It is on topic, and is not &quot;dangerously incorrect&quot;."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1423232897, "post_id": 28326715, "comment_id": 45076774, "body": "Your &quot;tests&quot; don&#39;t at all attempt to address the user&#39;s issue, which appears to be an awkward if-statement. Obviously loops and incrementing works, OP&#39;s question is &quot;how can i Next i and Next j before that exit for?&quot; The user needs to restructure their program to achieve this, not be shown that they can increment using <code>i=i+1</code>"}], "tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": false, "score": -1, "last_activity_date": 1423068416, "last_edit_date": 1423068416, "creation_date": 1423068022, "answer_id": 28326715, "question_id": 28326526, "link": "https://stackoverflow.com/questions/28326526/how-can-i-grow-i-and-j-before-exit-for/28326715#28326715", "title": "How can I grow i and j before Exit for?", "body": "<p>Did this quick test: shows \"8\" in the output .. so not sure why you say the i=i+1 doesn't work ?  it \"should\". ;)</p>\n\n<pre><code>  Sub test()\n    For i = 1 To 10\n       If i = 5 Then Exit For\n    Next i\n    i = i + 3\n    MsgBox (i)\n  End Sub\n</code></pre>\n\n<p>[edit] ahh, just noticed, you said \"before\" the exit for ... hmm, that's more interesting ... [/edit]</p>\n\n<p>[/edit2] or not ... just tried it .. works for me </p>\n\n<pre><code>  Sub test()\n    For i = 1 To 10\n       If i = 5 Then\n         i = i + 1\n         Exit For\n       End If\n    Next i\n    MsgBox (i)\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4529379, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eaAwaROVwUE/AAAAAAAAAAI/AAAAAAAAADw/uF75rr8A1Tk/photo.jpg?sz=128", "display_name": "Valentin Dragoi", "link": "https://stackoverflow.com/users/4529379/valentin-dragoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450869469, "creation_date": 1423067548, "last_edit_date": 1531164843, "question_id": 28326526, "link": "https://stackoverflow.com/questions/28326526/how-can-i-grow-i-and-j-before-exit-for", "title": "How can I grow i and j before Exit for?", "body": "<p>Here's my code:</p>\n\n<pre><code> Sub Horizon()\nDim i As Double, j As Double, x As Double, y As Double\nSheets(\"B\").Range(\"C3:G10000\").ClearContents\nx = InputBox(\"Number of rows in A\")\ny = InputBox(\"Number of rows in B\")\nFor i = 3 To x\n    For j = 3 To y\n     If Sheets(\"B\").Cells(j, 1) = Sheets(\"A\").Cells(i, 1) And Sheets(\"B\").Cells(j, 2) &gt;= Sheets(\"A\").Cells(i, 2) And Sheets(\"B\").Cells(j, 2) &lt;= Sheets(\"A\").Cells(i, 3) Then\n     Sheets(\"B\").Cells(j, 3) = Sheets(\"A\").Cells(i, 4)\n     Sheets(\"B\").Cells(j, 4) = Sheets(\"A\").Cells(i, 5)\n     Sheets(\"B\").Cells(j, 5) = Sheets(\"A\").Cells(i, 6)\n     Sheets(\"B\").Cells(j, 6) = Sheets(\"A\").Cells(i, 7)\n     Sheets(\"B\").Cells(j, 7) = Sheets(\"A\").Cells(i, 8)\n     Else\n\n     Exit For\n     End If\n     Next j\n     Next i\nEnd Sub \n</code></pre>\n\n<p>how can I <code>Next i</code> and <code>Next j</code> before that <code>exit for</code>?...is there a way?\nI tried in this way <code>i=i+1</code> but it didn't work.If I'm writing <code>next i</code> and <code>next j</code> before that <code>exit for</code> it gives me an error.</p>\n"}, {"tags": ["arrays", "vba", "function", "pass-by-reference", "subroutine"], "comments": [{"owner": {"reputation": 11225, "user_id": 3718878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392829bf28778fcbb8ae53033c98df8c?s=128&d=identicon&r=PG&f=1", "display_name": "Zenadix", "link": "https://stackoverflow.com/users/3718878/zenadix"}, "edited": false, "score": 2, "creation_date": 1423067931, "post_id": 28326429, "comment_id": 45000845, "body": "It might help to show us the code you&#39;ve been trying."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4524560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ee7ea4e271486f3a3bc3f6a704c6fd?s=128&d=identicon&r=PG&f=1", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/4524560/geoffrey"}, "edited": false, "score": 0, "creation_date": 1423070164, "post_id": 28326978, "comment_id": 45002382, "body": "I know it&#39;s trivial, but this is exactly what I was looking for, and it worked perfectly. I expanded it to pass two arrays and that worked fine too. Thank you very much!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 113, "user_id": 4524560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ee7ea4e271486f3a3bc3f6a704c6fd?s=128&d=identicon&r=PG&f=1", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/4524560/geoffrey"}, "edited": false, "score": 0, "creation_date": 1423070269, "post_id": 28326978, "comment_id": 45002448, "body": "You&#39;re welcome!! Next time, please do show what you&#39;ve tried. Even though it may not work or is causing errors, it is good form to show your efforts when asking for help :)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 18, "last_activity_date": 1537447557, "last_edit_date": 1537447557, "creation_date": 1423068803, "answer_id": 28326978, "question_id": 28326429, "link": "https://stackoverflow.com/questions/28326429/vba-pass-array-by-reference-and-modify-contents/28326978#28326978", "title": "VBA Pass Array By Reference and Modify Contents", "body": "<p>This is fairly trivial, using the <code>ByRef</code> keyword in the function signature will pass your array by reference rather than by value. This means that manipulations <em>to</em> that array will be preserved and bubble up to the calling scope. This is probably an oversimplification, but think of it this way:</p>\n\n<ul>\n<li><code>ByRef</code>: you're passing a reference to the <em>thing</em> (array, Object, etc.) and any transformations to that <em>thing</em> will be apparent anywhere that <em>thing</em> exists.</li>\n<li><code>ByVal</code>: you're passing the <em>value</em> representation of the thing. Essentially, you're passing a \"copy\" of it. You can manipulate this object, but it is <em>not</em> the same object from the calling scope, it's just a copy. So when the enclosing scope ends, you're still left with only the original thing.</li>\n</ul>\n\n<p>Initialize your array as a numeric type and that will give you default <code>0</code> values.</p>\n\n<p>Example as follows:</p>\n\n<pre><code>Option Explicit\nSub foo()\n    Dim myArray(1 To 3) As Double  'The array is initialized with zero-values \n\n    Call bar(myArray)\n\n    MsgBox myArray(3)\n\nEnd Sub\n\nSub bar(ByRef dblArray() As Double)\n\n    dblArray(1) = 123\n    dblArray(2) = 345\n    dblArray(3) = 33456\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 350, "user_id": 3825495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/526158124/picture?type=large", "display_name": "Michael James", "link": "https://stackoverflow.com/users/3825495/michael-james"}, "is_accepted": false, "score": 0, "last_activity_date": 1611198246, "creation_date": 1611198246, "answer_id": 65820602, "question_id": 28326429, "link": "https://stackoverflow.com/questions/28326429/vba-pass-array-by-reference-and-modify-contents/65820602#65820602", "title": "VBA Pass Array By Reference and Modify Contents", "body": "<p>By default, arrays are passed by reference.  I've seen in a few places that passing &quot;ByVal&quot; throws an exception.  However, I have been able to use ByVal without issue in O365.</p>\n"}], "owner": {"reputation": 113, "user_id": 4524560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ee7ea4e271486f3a3bc3f6a704c6fd?s=128&d=identicon&r=PG&f=1", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/4524560/geoffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21836, "favorite_count": 3, "accepted_answer_id": 28326978, "answer_count": 2, "score": 10, "last_activity_date": 1611198246, "creation_date": 1423067313, "question_id": 28326429, "link": "https://stackoverflow.com/questions/28326429/vba-pass-array-by-reference-and-modify-contents", "title": "VBA Pass Array By Reference and Modify Contents", "body": "<p>VBA question. I'm using it to make Solidworks macros, but that's not important.</p>\n\n<p>Can someone explain the syntax to pass an array (1-Dimensional of type Double, with length of three) to a subroutine or function so I can modify the contents. I know that they have to be passed by reference. I'm talking exact syntax, because everything I try I get type mismatch error on the subroutine/function call. </p>\n\n<p>All I'm looking for is the correct Dim statement for the array of Doubles, initialize statement to make all array values zero, then the subroutine call statement and subroutine header that I would need. Please be specific if I need to use variant type or dynamic array, even when I already know the type and size of the array. Use a function or a sub, I don't care which.</p>\n\n<p>My code works fine as of now, but I'm tired of avoiding function and subroutine calls when I'm using arrays. I've looked at countless documentation and similar questions on here, but I just cannot figure it out. Thanks a lot.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423066665, "post_id": 28326115, "comment_id": 44999888, "body": "Change <code>ByRef</code> to <code>ByVal</code>, if that does not help, also change <code>Date</code> to <code>Variant</code>. It will return <code>-1</code> then."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1423067056, "post_id": 28326115, "comment_id": 45000180, "body": "An appropriate place to deal with the one missing value is before this function is called.  If you will post the code that CALLS this function -- presumably found in an event of the text box -- that will let us say more about that approach."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1423067149, "post_id": 28326115, "comment_id": 45000228, "body": "Alternatively, you can take advantage of the error-handling already built into this function.  I have reasons for preferring the other approach."}, {"owner": {"reputation": 13, "user_id": 4529356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58e5146b2ef07e955471156e2e51ba3?s=128&d=identicon&r=PG&f=1", "display_name": "CBraun", "link": "https://stackoverflow.com/users/4529356/cbraun"}, "edited": false, "score": 0, "creation_date": 1423068243, "post_id": 28326115, "comment_id": 45001080, "body": "PaulFrancis solution worked. Thanks! Returns 0 days which is fine by me!"}], "answers": [{"tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 3, "last_activity_date": 1423067560, "creation_date": 1423067560, "answer_id": 28326536, "question_id": 28326115, "link": "https://stackoverflow.com/questions/28326115/type-error-on-vba-function-when-input-left-blank/28326536#28326536", "title": "#type Error on VBA function when input left blank", "body": "<p>Your code will have to accept a Null value, since Date is a Data type that will not tolerate Null, you have two methods, change the declaration of the function from.</p>\n\n<pre><code>Public Function Weekdays(   ByRef startDate As Date, _\n                            ByRef endDate As Date _\n                        ) As Integer\n</code></pre>\n\n<p>To,</p>\n\n<pre><code>Public Function Weekdays(startDate, endDate) As Integer\n</code></pre>\n\n<p>This way the code can have Null values, so a few more additions could be made as,</p>\n\n<pre><code>Public Function Weekdays(startDate, endDate) As Integer\n' Returns the number of weekdays in the period from startDate\n' to endDate inclusive. Returns -1 if an error occurs.\n' If your weekend days do not include Saturday and Sunday and\n' do not total two per week in number, this function will\n' require modification.\n\nOn Error GoTo Weekdays_Error\n    If IsNull(startDate) Or IsNull(endDate) Then\n        Weekdays = 0\n        Exit Function\n    End If\n\n    Const ncNumberOfWeekendDays As Integer = 2\n\n    'so on....\n</code></pre>\n\n<p>Or the other way is to make sure you pass dates by employing <code>Nz()</code> or even prevent the function to be called if you have Null values. </p>\n"}], "owner": {"reputation": 13, "user_id": 4529356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58e5146b2ef07e955471156e2e51ba3?s=128&d=identicon&r=PG&f=1", "display_name": "CBraun", "link": "https://stackoverflow.com/users/4529356/cbraun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 28326536, "answer_count": 1, "score": 1, "last_activity_date": 1594645487, "creation_date": 1423066462, "last_edit_date": 1594645487, "question_id": 28326115, "link": "https://stackoverflow.com/questions/28326115/type-error-on-vba-function-when-input-left-blank", "title": "#type Error on VBA function when input left blank", "body": "<p>I am using the following code in Access 2010. I use it in an unbound text box to return weekdays between two schedule dates (start/Finish) on various scheduled tasks on a form. Code is working properly when dates are entered, however on this particular form not every task will have start / end dates. I would like the code to just return \"\" or 0 if inputs are blank. </p>\n\n<p>I should note I did not write this code myself, I am very very new to VBA and found this code online and manipulated it slightly to work for my application. How can I modify this to fit my needs?</p>\n\n<pre><code>Public Function Weekdays(   ByRef startDate As Date, _\n                            ByRef endDate As Date _\n                        ) As Integer\n' Returns the number of weekdays in the period from startDate\n' to endDate inclusive. Returns -1 if an error occurs.\n' If your weekend days do not include Saturday and Sunday and\n' do not total two per week in number, this function will\n' require modification.\n\nOn Error GoTo Weekdays_Error\n\n    ' The number of weekend days per week.\n    Const ncNumberOfWeekendDays As Integer = 2\n\n    ' The number of days inclusive.\n    Dim varDays As Variant\n\n    ' The number of weekend days.\n    Dim varWeekendDays As Variant\n\n    ' Temporary storage for datetime.\n    Dim dtmX As Date\n\n\n    ' Calculate the number of days inclusive (+ 1 is to add back startDate).\n    varDays = DateDiff(Interval:=\"d\", _\n                        date1:=startDate, _\n                        date2:=endDate) + 1\n\n    ' Calculate the number of weekend days.\n    varWeekendDays = (DateDiff(Interval:=\"ww\", _\n                                date1:=startDate, _\n                                date2:=endDate) _\n                                * ncNumberOfWeekendDays) _\n                                + IIf(DatePart(Interval:=\"w\", _\n                                Date:=startDate) = vbSunday, 1, 0) _\n                                + IIf(DatePart(Interval:=\"w\", _\n                                Date:=endDate) = vbSaturday, 1, 0)\n\n    ' Calculate the number of weekdays.\n    Weekdays = (varDays - varWeekendDays)\n\nWeekdays_Exit:\n    Exit Function\n\nWeekdays_Error:\n    Weekdays = -1\n    Resume Weekdays_Exit\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1423064582, "post_id": 28325149, "comment_id": 44998434, "body": "What have you tried so far?  This should be fairly trivial. Is your question about optimization? (if so, please show your current code)"}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4475468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d04747a9bf180c8fb9fc145ec5133d1?s=128&d=identicon&r=PG", "display_name": "Joffan", "link": "https://stackoverflow.com/users/4475468/joffan"}, "is_accepted": true, "score": 3, "last_activity_date": 1423065314, "creation_date": 1423065314, "answer_id": 28325719, "question_id": 28325149, "link": "https://stackoverflow.com/questions/28325149/remove-filter-cell-contents-in-microsoft-excel-2013/28325719#28325719", "title": "Remove / Filter Cell Contents in Microsoft Excel 2013", "body": "<p>Use Text-to-Columns \"delimited\" to split on the comma, then use it again \"fixed width\" to split the state from the school name (assuming the state is always 2 characters). Clean up spaces with TRIM if required.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1423065579, "creation_date": 1423065579, "answer_id": 28325810, "question_id": 28325149, "link": "https://stackoverflow.com/questions/28325149/remove-filter-cell-contents-in-microsoft-excel-2013/28325810#28325810", "title": "Remove / Filter Cell Contents in Microsoft Excel 2013", "body": "<p>Hi something like this should look through all your cells in row D and return the values you are looking for in the next 3 columns; might need a little adjusting</p>\n\n<p><code>For each cell in Range(\"D2:D &amp; Range(\"D2\".End(xlDown).Row))\ncell.offset(columnOffset:=1) = left(cell,instr(String1:=cell, String2:= \",\"))\ncell.offset(columnOffset:=2) = Mid(cell,instr(String1:=cell, String2:= \",\")+1,2)\ncell.offset(columnOffset:=3) = right(cell,len(cell)-instr(String1:=cell, String2:= \",\")+3) \nNext</code></p>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": false, "score": 0, "last_activity_date": 1423066396, "creation_date": 1423066396, "answer_id": 28326092, "question_id": 28325149, "link": "https://stackoverflow.com/questions/28325149/remove-filter-cell-contents-in-microsoft-excel-2013/28326092#28326092", "title": "Remove / Filter Cell Contents in Microsoft Excel 2013", "body": "<p>I tried Jake Duddy's code it contains quite some errors, I do not know if it works. At the same time you can try below code.</p>\n\n<pre><code>Dim LastRow As Long\nDim State_L As String\nDim City_L As String\nDim HS_L As String\n\nLastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\n\nFor i = 2 To LastRow\n\n    City_L = Left(Range(\"D\" &amp; i), InStr(1, Range(\"D\" &amp; i), \",\") - 1) ' Getting up to comma\n    State_L = Mid(Range(\"D\" &amp; i), InStr(1, Range(\"D\" &amp; i), \",\") + 1, 2) 'Getting after comma for 2 characters\n    HS_L = Mid(Range(\"D\" &amp; i), InStr(1, Range(\"D\" &amp; i), \",\") + 3, Len(Range(\"D\" &amp; i)) - InStr(1, Range(\"D\" &amp; i), \",\")) 'Getting after comma+2 characters upto the end\n\n    Range(\"E\" &amp; i).Value = City_L\n    Range(\"F\" &amp; i).Value = State_L\n    Range(\"G\" &amp; i).Value = HS_L\n\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1423067037, "creation_date": 1423067037, "answer_id": 28326324, "question_id": 28325149, "link": "https://stackoverflow.com/questions/28325149/remove-filter-cell-contents-in-microsoft-excel-2013/28326324#28326324", "title": "Remove / Filter Cell Contents in Microsoft Excel 2013", "body": "<p><strong>Select</strong> the cells you wish to process and run this small macro:</p>\n\n<pre><code>Sub ParseData()\n    Dim r As Range, L As Long, L1 As Long, L2 As Long\n\n    For Each r In Selection\n        t = r.Text\n        L = Len(t)\n        L1 = InStr(1, t, \",\")\n        For i = 1 To L\n            If r.Characters(i, 1).Font.Italic = True Then\n                L2 = i\n                Exit For\n            End If\n        Next i\n\n        r.Offset(0, 1).Value = Mid(t, 1, L1 - 1)\n        r.Offset(0, 2).Value = Mid(t, L1 + 1, L2 - L1 - 1)\n        r.Offset(0, 3) = Mid(t, L2)\n        r.Offset(0, 3).Font.Italic = True\n    Next r\nEnd Sub\n</code></pre>\n\n<p>For example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/R8d6G.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 131, "user_id": 1060275, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/687974b16c6e291ed177335abd59e835?s=128&d=identicon&r=PG", "display_name": "jdgaub", "link": "https://stackoverflow.com/users/1060275/jdgaub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 28325719, "answer_count": 4, "score": 1, "last_activity_date": 1423067037, "creation_date": 1423063831, "question_id": 28325149, "link": "https://stackoverflow.com/questions/28325149/remove-filter-cell-contents-in-microsoft-excel-2013", "title": "Remove / Filter Cell Contents in Microsoft Excel 2013", "body": "<p>I am looking for the best way to clean up the cell contents of one particular cell in my spreadsheet. As it exists now, Column D lists a City, State, and High School in the same cell (Screenshot #1). I need to split these values out into 3 unique columns/cells as shown in Screenshot #2. How would I accomplish this?</p>\n\n<p>** Note - The example below is just a sample size. I have thousands of cells to perform this on.</p>\n\n<p><strong>Existing cell format:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/K4otw.png\" alt=\"enter image description here\"></p>\n\n<p><strong>New Format (Hopefully):</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/lYJ56.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "cryptography", "sha1"], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 2594114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ecb1b955e194695150e9676e6309e130?s=128&d=identicon&r=PG&f=1", "display_name": "Indivara", "link": "https://stackoverflow.com/users/2594114/indivara"}, "edited": false, "score": 0, "creation_date": 1423102308, "post_id": 28325418, "comment_id": 45016449, "body": "Perfect! Thanks so much! How do you know which overload is which? Trial and error? Also, is this going to stay the same always (documented somewhere)?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 633, "user_id": 2594114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ecb1b955e194695150e9676e6309e130?s=128&d=identicon&r=PG&f=1", "display_name": "Indivara", "link": "https://stackoverflow.com/users/2594114/indivara"}, "edited": false, "score": 1, "creation_date": 1423135075, "post_id": 28325418, "comment_id": 45029543, "body": "The convention is <code>Name_X</code> where <code>X</code> is <code>2</code> to <code>N</code> based on the order of declaration of the overloaded method (There is no <code>Name_1</code>, <code>Name</code> itself is used for the first). I used ILSPY to search for <code>ComputeHash</code> in <code>SHA1Managed</code> and saw the second implementation was the one that took <code>byte[]</code>."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1423064529, "creation_date": 1423064529, "answer_id": 28325418, "question_id": 28325067, "link": "https://stackoverflow.com/questions/28325067/calling-net-cryptography-from-vba/28325418#28325418", "title": "Calling .NET Cryptography from VBA", "body": "<p><code>ComputeHash</code> is overloaded, you need to specify which one you want to call, in this case:</p>\n\n<pre><code>hash = oSHA.ComputeHash_2(bytes)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9039793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f22a009a2008c9c2868e1ffbec3122a?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Courtney", "link": "https://stackoverflow.com/users/9039793/evan-courtney"}, "is_accepted": false, "score": 4, "last_activity_date": 1512173971, "last_edit_date": 1512173971, "creation_date": 1512142848, "answer_id": 47596774, "question_id": 28325067, "link": "https://stackoverflow.com/questions/28325067/calling-net-cryptography-from-vba/47596774#47596774", "title": "Calling .NET Cryptography from VBA", "body": "<p>From <code>System.Security.Cryptography.HashAlgorithm</code>:</p>\n\n<ul>\n<li><code>ComputeHash_1(inputStream As stream)</code></li>\n<li><code>ComputeHash_2(buffer As byte())</code></li>\n<li><code>ComputeHash_3(buffer As byte(), offset As int, count As int)</code></li>\n</ul>\n"}], "owner": {"reputation": 633, "user_id": 2594114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ecb1b955e194695150e9676e6309e130?s=128&d=identicon&r=PG&f=1", "display_name": "Indivara", "link": "https://stackoverflow.com/users/2594114/indivara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1225, "favorite_count": 0, "accepted_answer_id": 28325418, "answer_count": 2, "score": 2, "last_activity_date": 1512173971, "creation_date": 1423063651, "question_id": 28325067, "link": "https://stackoverflow.com/questions/28325067/calling-net-cryptography-from-vba", "title": "Calling .NET Cryptography from VBA", "body": "<p>I am trying to generate an SHA-1 hash in VBA (which I am not very familiar with). In .NET it is pretty straightforward, using <code>System.Security.Cryptography</code>. One method is as follows:</p>\n\n<pre><code>using System.Security.Cryptography;\n...\n\nbyte[] data;\n// fill data here\nSHA1Managed sha = new SHA1Managed();\nbytes[] hash = sha.ComputeHash(data);\n</code></pre>\n\n<p>How would you go about calling this from VBA? I got as far as this</p>\n\n<pre><code>Dim oSHA As Object\nSet oSHA = CreateObject(\"System.Security.Cryptography.SHA1Managed\")\n</code></pre>\n\n<p>but I can't figure out how to pass a <code>Byte</code> array to <code>ComputeHash</code></p>\n\n<pre><code>hash = oSHA.ComputeHash(oBytes)\n</code></pre>\n\n<p>This throws an error about the parameter being incorrect. How do you convert it to a format accepted by .NET?</p>\n\n<p>Note that I do NOT want to use VBA calculations for SHA-1 (too slow, and I don't want to reinvent the wheel). It would also be nice if I didn't have to write any wrappers for the .NET portion.</p>\n"}, {"tags": ["vba", "visual-studio-2013", "outlook", "outlook-addin"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 0, "creation_date": 1423067288, "post_id": 28325158, "comment_id": 45000359, "body": "That makes sense.  But how can I access the application property from places other than the &#39;ThisAddIn&#39; Class?  For example  the original code I posted resides under a Ribbon class.  I can get &#39;Outlook.Application&#39;, but then there&#39;s no Outlook.Application.ActiveExplorer.  I tried making a a Public Function under &#39;ThisAddIn&#39; that make the Outlook.Application object available to other classes, but that function wasn&#39;t accessible to other the other classes.  (I hope I&#39;m not mixing terminology - I&#39;m self taught and sometimes things don&#39;t mean what I think they mean).  Thanks!"}, {"owner": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 0, "creation_date": 1423071693, "post_id": 28325158, "comment_id": 45003321, "body": "Yes.  Visual Studio 2013, with Visual Studio Tools for Office 2013 Update 1."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 1, "creation_date": 1423073327, "post_id": 28325158, "comment_id": 45004268, "body": "Use Globals.ThisAddIn.Application"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1423063847, "creation_date": 1423063847, "answer_id": 28325158, "question_id": 28324953, "link": "https://stackoverflow.com/questions/28324953/how-to-access-certain-mailitem-properties-methods-in-a-visual-studio-outlook-add/28325158#28325158", "title": "How to access certain mailitem properties/methods in a Visual Studio Outlook Add-In?", "body": "<p>Do not use  <code>New Outlook.Application</code> in an Outlook addin - you get Outlook.Application object for free when your addin starts up.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 0, "creation_date": 1423067611, "post_id": 28325667, "comment_id": 45000600, "body": "Properties like are mentioned in the article you posted.  E.g. MailItem.To (or .Body).  That article is what led me to believe it was a security issue.  I the Dmitry is on the right track that I don&#39;t need to declare a new Outlook instance, but now I&#39;m just struggling to figure out how to access the &#39;free&#39; Outlook instance from classes other than &quot;ThisAddIn&quot;"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 0, "creation_date": 1423068431, "post_id": 28325667, "comment_id": 45001223, "body": "You need to use the instance provided by the Application property."}, {"owner": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 0, "creation_date": 1423072002, "post_id": 28325667, "comment_id": 45003517, "body": "So I would think to do this I would do:  <code>Dim oApp as Outlook.Application oExplorer = oApp.ActiveExploreer</code>  Then intellisense is showing me the expected properties like .ActiveExplorer, but it&#39;s warning me that oApp hasn&#39;t been defined yet, and throws a nullreference exception at runtime."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "edited": false, "score": 0, "creation_date": 1423073779, "post_id": 28325667, "comment_id": 45004520, "body": "It looks like you didn;t initialize it in the code.     Dim oApp as Outlook.Application  = Globals.ThisAddIn.Application"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1423065153, "creation_date": 1423065153, "answer_id": 28325667, "question_id": 28324953, "link": "https://stackoverflow.com/questions/28324953/how-to-access-certain-mailitem-properties-methods-in-a-visual-studio-outlook-add/28325667#28325667", "title": "How to access certain mailitem properties/methods in a Visual Studio Outlook Add-In?", "body": "<blockquote>\n  <p>certain outlook properties/methods seem to be unavailable</p>\n</blockquote>\n\n<p>What properties are you talking about? Could you be more specific?</p>\n\n<p>As Dmitry suggested, you need to use the Application property provided by VSTO. In that case you will avoid security prompts or exceptions. Typically you get such issue when you try to automate Outlook from a standalone application. The Application object provided by VSTO is trusted and doesn't generate exceptions for secured properties or methods (for example, MailItem.Send). You can read more about that in the <a href=\"http://www.outlookcode.com/article.aspx?id=52\" rel=\"nofollow\">Outlook \"Object Model Guard\" Security Issues for Developers</a> article. </p>\n"}], "owner": {"reputation": 27, "user_id": 1535308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1350f8305a19fa203ae152505b393433?s=128&d=identicon&r=PG", "display_name": "BrINClHOF", "link": "https://stackoverflow.com/users/1535308/brinclhof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 28325667, "answer_count": 2, "score": 0, "last_activity_date": 1608464349, "creation_date": 1423063328, "last_edit_date": 1608464349, "question_id": 28324953, "link": "https://stackoverflow.com/questions/28324953/how-to-access-certain-mailitem-properties-methods-in-a-visual-studio-outlook-add", "title": "How to access certain mailitem properties/methods in a Visual Studio Outlook Add-In?", "body": "<p>I'm developing an Outlook (2010) add-in using Visual Studio 2013 (Targeting .NET 4).</p>\n<p>Certain Outlook properties/methods seem to be unavailable.</p>\n<p>The following code works from Outlook VBA.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub OutlookTest()\n\n    'Dim oApp As New Outlook.Application  (NOT NEEDED FOR OUTLOOK VBA)\n    Dim oExp As Outlook.Explorer\n    Dim oSel As Outlook.Selection   ' You need a selection object for getting the selection.\n    Dim oItem As Object             ' You don't know the type yet.    \n        \n    Set oExp = Application.ActiveExplorer 'Get the ActiveExplorer.\n    Set oSel = oExp.Selection           ' Get the selection.\n\n    For i = 1 To oSel.Count         ' Loop through all the currently .selected items\n        Set oItem = oSel.Item(i)        ' Get a selected item.\n        Call DisplayInfo(oItem)          ' Display information about it.\n    Next i\n\nEnd Sub\n\nPrivate Sub DisplayInfo(oItem As Object)\n\n    Dim strMessageClass As String\n    Dim oMailItem As Outlook.MailItem\n\n    ' You need the message class to determine the type.\n    strMessageClass = oItem.MessageClass\n\n    If (strMessageClass = &quot;IPM.Note&quot;) Then          ' Mail Entry.\n        Set oMailItem = oItem\n        MsgBox oMailItem.Subject\n        MsgBox oMailItem.EntryID\n        MsgBox oMailItem.HTMLBody\n        oMailItem.SaveAs &quot;C:\\Users\\u001tb7\\Desktop\\New folder\\testOL.msg&quot;, olMSG\n    Else\n            MsgBox &quot;Pick something else&quot;\n        End If\n\n    End Sub\n</code></pre>\n<p>When I try near identical code from Visual Studio in an add-in:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub butSettings_Click(sender As Object, e As RibbonControlEventArgs) Handles butSettings.Click\n\n    Dim oApp As New Outlook.Application\n    Dim oExp As Outlook.Explorer\n    Dim oSel As Outlook.Selection   ' You need a selection object for getting the selection.\n    Dim oItem As Object             ' You don't know the type yet.\n\n    oExp = oApp.ActiveExplorer      ' Get the ActiveExplorer.\n    oSel = oExp.Selection           ' Get the selection.\n\n    For i = 1 To oSel.Count         ' Loop through all the currently .selected items\n        oItem = oSel.Item(i)        ' Get a selected item.\n        DisplayInfo(oItem)          ' Display information about it.\n    Next i\n\nEnd Sub\n\nSub DisplayInfo(oItem As Object)\n\n    Dim strMessageClass As String\n    Dim oMailItem As Outlook.MailItem\n\n    ' You need the message class to determine the type.\n    strMessageClass = oItem.MessageClass\n\n    If (strMessageClass = &quot;IPM.Note&quot;) Then          ' Mail Entry.\n        oMailItem = oItem\n        MsgBox(oMailItem.Subject)\n        MsgBox(oMailItem.EntryID)\n        MsgBox(oMailItem.HTMLBody)      '&lt;---FAILS\n        oMailItem.SaveAs(&quot;C:\\Users\\u001tb7\\Desktop\\New folder\\testVS.msg&quot;, Outlook.OlSaveAsType.olMSG)  '&lt;---ALSO FAILS\n    Else\n        MsgBox(&quot;Pick something else&quot;)\n    End If\n\nEnd Sub\n</code></pre>\n<p>I get an error on <code>MailItem.HTMLBody</code> and <code>MailItem.SaveAs</code> but NOT <code>MailItem.Subject</code> or <code>.EntryID</code>.</p>\n<p>This makes me suspect it's something to do with the security, as I think properties like <code>.HTMLBody</code> are 'protected', but <code>.EntryID</code> and <code>.Subject</code> are not.</p>\n<p>The error is the generic COM exception not giving me any detail:</p>\n<blockquote>\n<p>An exception of type 'System.Runtime.InteropServices.COMException' occurred in MsgSave.dll but was not handled in user code</p>\n<p>Additional information: Operation aborted (Exception from HRESULT: 0x80004004 (E_ABORT))</p>\n</blockquote>\n<p>Is there any way to get Outlook to 'trust' my VS code (for eventual distribution)?  Or is there something else amiss?</p>\n<p>EDIT: Thanks to both below!</p>\n<p>Instead of:</p>\n<pre><code>Dim oApp As New Outlook.Application\n</code></pre>\n<p>Use:</p>\n<pre><code>Dim oApp as Outlook.Application = Globals.ThisAddIn.Application\n</code></pre>\n"}, {"tags": ["vba", "excel", "range", "runtime-error"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1423063575, "post_id": 28324921, "comment_id": 44997743, "body": "There&#39;s no obvious reason why publicly scoped variables would resolve this problem, so that is the wrong approach anyways. Which line raises the error -- <code>AccDnn.Cells(Rang&#233;eFinRed - 18, 71).PasteSpecial (xlPasteValues)</code>?  If so, what is the <code>Address</code> of the <code>RangeeFinRed</code> range?"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423063761, "post_id": 28324921, "comment_id": 44997869, "body": "@DavidZemens Edited with offending code line in question pointed out."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1423063922, "post_id": 28324921, "comment_id": 44997984, "body": "<code>AccDnn.Range(Cells(2, 71), Cells(Rang&#233;eFinAcc - 1, 87)).Copy</code> attempts to specify a Range object which potentially spans multiple worksheets. Unqualified <code>Cells</code> always refers to the <code>ActiveWorksheet</code>. If this is <b>not</b> <code>AccDnn</code> then it will fail."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1423063969, "post_id": 28325049, "comment_id": 44998027, "body": "So, the error was thrown because VBA didn&#39;t grasp which cells I was referring to within the range?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1423064203, "post_id": 28325049, "comment_id": 44998170, "body": "No, the error was throwing because you did not qualify your ranges -- VBA knew what cells you were referring to, you were simply referring to them incorrectly :)"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1423064718, "post_id": 28325049, "comment_id": 44998527, "body": "Great! Thanks for the help guys."}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 4, "last_activity_date": 1423063605, "creation_date": 1423063605, "answer_id": 28325049, "question_id": 28324921, "link": "https://stackoverflow.com/questions/28324921/vba-run-time-error-1004-when-trying-to-copy-paste-cells-in-a-separate-sheet/28325049#28325049", "title": "VBA Run-time error 1004 when trying to copy paste cells in a separate sheet", "body": "<p>Update this section:</p>\n\n<pre><code>If SaveRedAns = 6 Then\n        With AccDnn\n            .Range(.Cells(2, 71), .Cells(Rang\u00e9eFinAcc - 1, 87)).Copy\n            .Cells(Rang\u00e9eFinRed - 18, 71).PasteSpecial (xlPasteValues)\n        End With\n        With DrpRed\n            .Range(.Cells(19, 1), .Cells(Rang\u00e9eFinRed, 16)).Copy\n        End With\n        AccDnn.Cells(2, 75).PasteSpecial (xlPasteValues)\n    Else: SaveRedAns = 7\n        Application.ScreenUpdating = True\n        Exit Sub\nEnd If\n</code></pre>\n\n<p>Or without using <code>With</code> statements:</p>\n\n<pre><code>If SaveRedAns = 6 Then\n        AccDnn.Range(AccDnn.Cells(2, 71), AccDnn.Cells(Rang\u00e9eFinAcc - 1, 87)).Copy\n        AccDnn.Cells(Rang\u00e9eFinRed - 18, 71).PasteSpecial (xlPasteValues)\n        DrpRed.Range(DrpRed.Cells(19, 1), DrpRed.Cells(Rang\u00e9eFinRed, 16)).Copy\n        AccDnn.Cells(2, 75).PasteSpecial (xlPasteValues)\n    Else: SaveRedAns = 7\n        Application.ScreenUpdating = True\n        Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11367, "favorite_count": 1, "accepted_answer_id": 28325049, "answer_count": 1, "score": 0, "last_activity_date": 1423064109, "creation_date": 1423063225, "last_edit_date": 1423064109, "question_id": 28324921, "link": "https://stackoverflow.com/questions/28324921/vba-run-time-error-1004-when-trying-to-copy-paste-cells-in-a-separate-sheet", "title": "VBA Run-time error 1004 when trying to copy paste cells in a separate sheet", "body": "<p>I am currently getting the following error in my VBA Excel 2007 code: Run-time error '1004': Method 'Range'of object '_Worksheet' failed. Having peeled through quite a few questions with this error in the title I haven't quite found a similar situation or a solution to my problem. That is, without declaring my variables as public, which, I don't want to do as I use the same variables multiple times in different subroutines.</p>\n\n<p>The error is raised on line:  </p>\n\n<pre><code>AccDnn.Range(Cells(2, 71), Cells(Rang\u00e9eFinAcc - 1, 87)).Copy\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Private Sub SaveRedButton_Click()\n\nDim SaveRedMssg As String, SaveRedTitre As String, SaveRedButtons As Integer, SaveRedAns As Integer\nDim Rang\u00e9eFinRed As Long, DrpRed As Worksheet\nDim Rang\u00e9eFinAcc As Long, AccDnn As Worksheet\n\n    Application.ScreenUpdating = False\n\n    Set DrpRed = ThisWorkbook.Worksheets(\"Drapeaux Rouges\")\n    Set AccDnn = ThisWorkbook.Worksheets(\"Acc. donn\u00e9es\")\n\n    Rang\u00e9eFinRed = DrpRed.Cells(Rows.Count, 1).End(xlUp).Row\n    Rang\u00e9eFinAcc = AccDnn.Cells(Rows.Count, 75).End(xlUp).Row\n    DrpRed.Cells(8, 2) = Rang\u00e9eFinRed\n    DrpRed.Cells(9, 2) = Rang\u00e9eFinAcc\n\n    SaveRedTitre = \"Enregistrement des donn\u00e9es\"\n    SaveRedMssg = \"Voulez-vous enregistrer les donn\u00e9es du formulaire\" &amp; vbNewLine &amp; \"\u00abDrapeaux Rouges - Bobineuse\u00bb?\"\n    SaveRedButtons = vbYesNo + vbQuestion + vbDefaultButton1 + vbApplicationModal\n    SaveRedAns = MsgBox(SaveRedMssg, SaveRedButtons, SaveRedTitre)\n\n    If SaveRedAns = 6 Then\n            AccDnn.Range(Cells(2, 71), Cells(Rang\u00e9eFinAcc - 1, 87)).Copy\n            AccDnn.Cells(Rang\u00e9eFinRed - 18, 71).PasteSpecial (xlPasteValues)\n            DrpRed.Range(Cells(19, 1), Cells(Rang\u00e9eFinRed, 16)).Copy\n            AccDnn.Cells(2, 75).PasteSpecial (xlPasteValues)\n        Else: SaveRedAns = 7\n            Application.ScreenUpdating = True\n            Exit Sub\n    End If\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The aim of this code is to transfer data form an input page on one sheet to a data storage sheet, all in the same workbook. The data is compiled onto the data sheet from the top down. Thus, the code must read how many rows of data shall be added to the data storage sheet and then move the data in the data storage sheet to make room for the input data.</p>\n"}, {"tags": ["sql", "ms-access", "syntax", "sql-update", "vba"], "comments": [{"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "edited": false, "score": 0, "creation_date": 1423062289, "post_id": 28324538, "comment_id": 44996881, "body": "You don&#39;t need that last line. It is already in the join"}, {"owner": {"reputation": 14811, "user_id": 2610022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8edab646dde73b52a734f5867d7b5244?s=128&d=identicon&r=PG", "display_name": "gvee", "link": "https://stackoverflow.com/users/2610022/gvee"}, "edited": false, "score": 1, "creation_date": 1423062404, "post_id": 28324538, "comment_id": 44996959, "body": "What happens if you don&#39;t use aliases?"}], "answers": [{"tags": [], "owner": {"reputation": 4956, "user_id": 1508467, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/462d1a0d5f9b49042e775c46e7ca5344?s=128&d=identicon&r=PG", "display_name": "Rhys Jones", "link": "https://stackoverflow.com/users/1508467/rhys-jones"}, "is_accepted": true, "score": 0, "last_activity_date": 1423062459, "creation_date": 1423062459, "answer_id": 28324640, "question_id": 28324538, "link": "https://stackoverflow.com/questions/28324538/syntax-error-sql/28324640#28324640", "title": "Syntax error SQL", "body": "<p>Normal SQL syntax would be; </p>\n\n<pre><code>UPDATE Imp \nSET FormularyName=F.FormularyName, ClientName=F.ClientName\nFROM ShouldImportMetricsIDsTable as Imp\nINNER JOIN FN_DataDump_ALL_02012015 as F ON Imp.FormularyID=F.FormularyID\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "is_accepted": false, "score": 0, "last_activity_date": 1423062698, "creation_date": 1423062698, "answer_id": 28324730, "question_id": 28324538, "link": "https://stackoverflow.com/questions/28324538/syntax-error-sql/28324730#28324730", "title": "Syntax error SQL", "body": "<p>(1/2 OT)</p>\n\n<p>Your Sql dialect might not support joins in update statements.</p>\n\n<p>In this case you may resort to correlated subqueries:</p>\n\n<pre><code> UPDATE ShouldImportMetricsIDsTable Imp\n    SET Imp.FormularyName = (\n                               SELECT F1.FormularyName\n                                 FROM FN_DataDump_ALL_02012015 F1\n                                WHERE F1.FormularyID = Imp.FormularyID\n                            )\n      , Imp.ClientName    = (\n                               SELECT F2.ClientName\n                                 FROM FN_DataDump_ALL_02012015 F2\n                                WHERE F2.FormularyID = Imp.FormularyID\n                            )\n  WHERE EXISTS (\n            SELECT 1\n              FROM FN_DataDump_ALL_02012015 F\n             WHERE F.FormularyID = Imp.FormularyID\n        )\n</code></pre>\n\n<p>This assumes that the <code>FormularyID</code> columns are constrained to be unique (ie. PK/AK) in their respective tables.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "is_accepted": false, "score": 0, "last_activity_date": 1423062805, "creation_date": 1423062805, "answer_id": 28324771, "question_id": 28324538, "link": "https://stackoverflow.com/questions/28324538/syntax-error-sql/28324771#28324771", "title": "Syntax error SQL", "body": "<p>It worked if I did not use aliases.</p>\n\n<pre><code>UPDATE ShouldImportMetricsIDsTable \nINNER JOIN FN_DataDump_ALL_02012015\nON ShouldImportMetricsIDsTable.FormularyID=FN_DataDump_ALL_02012015.FormularyID\nSET ShouldImportMetricsIDsTable.FormularyName=FN_DataDump_ALL_02012015.FormularyName, ShouldImportMetricsIDsTable.ClientName=FN_DataDump_ALL_02012015.ClientName\nWHERE ShouldImportMetricsIDsTable.FormularyID=FN_DataDump_ALL_02012015.FormularyID\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 28324640, "answer_count": 3, "score": -2, "last_activity_date": 1423062805, "creation_date": 1423062207, "question_id": 28324538, "link": "https://stackoverflow.com/questions/28324538/syntax-error-sql", "title": "Syntax error SQL", "body": "<p>I am trying to run this SQL query but for some reason it keeps failing saying that there is a missing operator on the line <code>Imp.FormularyID=F.FormularyID</code> and I am very confused why.  I have double checked the syntax and everything looks good.  Any help with this issue would be greatly appreciated.</p>\n\n<pre><code>UPDATE ShouldImportMetricsIDsTable as Imp\nINNER JOIN FN_DataDump_ALL_02012015 as F\nON Imp.FormularyID=F.FormularyID\nSET Imp.FormularyName=F.FormularyName, Imp.ClientName=F.ClientName\nWHERE Imp.FormularyID=F.FormularyID\n</code></pre>\n"}, {"tags": ["vba", "excel", "design-patterns"], "answers": [{"comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1423073181, "post_id": 28324860, "comment_id": 45004197, "body": "ok - so when you say cut/paste as opposed to copy/paste you mean if I use the fileStsemObjects moveFile method (I think one exists!) I should have more stability that if I use CopyFile?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1423073241, "post_id": 28324860, "comment_id": 45004227, "body": "..... No. I&#39;m saying <code>MoveFile</code> is considerably faster than <code>CopyFile</code>. I got slightly off topic."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1423073447, "post_id": 28324860, "comment_id": 45004334, "body": "(some extra speed is always good - I will do a full test and post back my findings)"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 1, "last_activity_date": 1423063046, "creation_date": 1423063046, "answer_id": 28324860, "question_id": 28324537, "link": "https://stackoverflow.com/questions/28324537/is-initial-save-to-local-drive-more-resilient-than-using-network-drive/28324860#28324860", "title": "Is initial save to local drive more resilient than using network drive", "body": "<p>Well... that depends. How good is your network? =;)- </p>\n\n<p>When faced with this situation, I tend to write local and them move them after the fact. In my experience, this is more reliable and faster.(Assuming you're using a cut/paste action and not a copy/paste action. Copy/paste is terribly slow.)</p>\n\n<p>Now, that said, I would actually prefer to just write directly to the network drive. It's less code, less bugs, less chance for things to go wrong... <strong><em>IF</em></strong> you have a reliable network.</p>\n"}], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 28324860, "answer_count": 1, "score": 0, "last_activity_date": 1423063046, "creation_date": 1423062204, "last_edit_date": 1531164843, "question_id": 28324537, "link": "https://stackoverflow.com/questions/28324537/is-initial-save-to-local-drive-more-resilient-than-using-network-drive", "title": "Is initial save to local drive more resilient than using network drive", "body": "<p>I would like to create 100 different reports - they all need to initially be saved to one location - then they need to be distributed to various locations on our network drive.</p>\n\n<p>An <code>Excel vba</code> program is creating the files from an <code>xlsm</code> file saved on the network drive.</p>\n\n<p>Which of the following approaches is more resiliant/defensive?</p>\n\n<p>1.Save 100 files to C-Drive of machine running the code - then distribute to 100 different locations on the network drive.\n2.Save 100 files to same network location where controlling <code>xlsm</code> file is located - then distribute to 100 different locations on the network drive.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1423060786, "post_id": 28323975, "comment_id": 44995875, "body": "Have you tried: ALT+F11 ==&gt; F7 ??"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1423060906, "post_id": 28323975, "comment_id": 44995952, "body": "Seems you could also: holding ALT:  L then C. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "is_accepted": false, "score": 1, "last_activity_date": 1423060774, "creation_date": 1423060774, "answer_id": 28324056, "question_id": 28323975, "link": "https://stackoverflow.com/questions/28323975/getting-to-the-thisworkbook-code-area/28324056#28324056", "title": "Getting to the ThisWorkbook Code Area", "body": "<p><kbd>Control</kbd>+<kbd>R</kbd> to jump to the project browser and then the arrow keys to select works for me.</p>\n"}, {"tags": [], "owner": {"reputation": 1069, "user_id": 1143539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/812727270ca069468a11ef94c5c2d6ef?s=128&d=identicon&r=PG", "display_name": "Roobie Nuby", "link": "https://stackoverflow.com/users/1143539/roobie-nuby"}, "is_accepted": false, "score": 1, "last_activity_date": 1423061114, "creation_date": 1423061114, "answer_id": 28324176, "question_id": 28323975, "link": "https://stackoverflow.com/questions/28323975/getting-to-the-thisworkbook-code-area/28324176#28324176", "title": "Getting to the ThisWorkbook Code Area", "body": "<p>If the question is about without using a mouse, you could simply do Alt+F11 followed by Control+R to get to the project explorer, where you could locate ThisWorkbook by using the arrow keys.</p>\n\n<p>If you want a repeatable sequence of characters that will always get you there, that is a more difficult problem.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1423061496, "post_id": 28324200, "comment_id": 44996339, "body": "FYI, playing with <code>SendKeys</code> is known to diminish reasoning power substantially."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1423062123, "last_edit_date": 1423062123, "creation_date": 1423061167, "answer_id": 28324200, "question_id": 28323975, "link": "https://stackoverflow.com/questions/28323975/getting-to-the-thisworkbook-code-area/28324200#28324200", "title": "Getting to the ThisWorkbook Code Area", "body": "<p>If a VBA project does NOT have modules then first <kbd>Alt</kbd>+<kbd>F11</kbd> then,</p>\n\n<p><kbd>Ctrl</kbd>+<kbd>R</kbd>, <kbd>Home</kbd>, <kbd>End</kbd>, <kbd>Enter</kbd>.</p>\n\n<p>The <strong>Object Explorer</strong> seems to get to <em>ThisWorkbook</em> code sheet reliably.</p>\n\n<ol>\n<li><kbd>F2</kbd></li>\n<li>Type <em>t\u00b7h\u00b7i\u00b7s\u00b7w\u00b7o\u00b7r\u00b7k\u00b7b\u00b7o\u00b7o\u00b7k</em></li>\n<li><kbd>Enter</kbd>, <kbd>Enter</kbd>.</li>\n</ol>\n\n<p>That relies on the Object Explorer opening with focus on the search criteria which is not <em>always</em> the case.</p>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 28324200, "answer_count": 3, "score": 1, "last_activity_date": 1423062123, "creation_date": 1423060517, "last_edit_date": 1531161705, "question_id": 28323975, "link": "https://stackoverflow.com/questions/28323975/getting-to-the-thisworkbook-code-area", "title": "Getting to the ThisWorkbook Code Area", "body": "<p>From the normal Excel window, I can open the VBE and insert a new module by touching the key sequence: <kbd>ALT</kbd>+<kbd>F11</kbd>, <kbd>ALT</kbd><kbd>i</kbd><kbd>m</kbd> all without using the mouse.<br><br>Is there a way to open the VBE and navigate to the <strong>ThisWorkbook</strong> code area without using the mouse??</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 2, "creation_date": 1423059966, "post_id": 28323727, "comment_id": 44995300, "body": "<a href=\"http://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">mattgemmell.com/what-have-you-tried</a>"}], "answers": [{"comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1423060617, "post_id": 28323954, "comment_id": 44995746, "body": "Should you really really really want to use VBA, of which I don&#39;t see the point, see the answer on this post <a href=\"http://stackoverflow.com/questions/9911049/access-vba-unable-to-create-table?rq=1\" title=\"access vba unable to create table\">stackoverflow.com/questions/9911049/&hellip;</a>"}], "tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1423060424, "creation_date": 1423060424, "answer_id": 28323954, "question_id": 28323727, "link": "https://stackoverflow.com/questions/28323727/creating-new-access-table-with-vba/28323954#28323954", "title": "Creating new access table with VBA", "body": "<p><strong><em>First result in google...</em></strong></p>\n\n<p>To import a Microsoft Excel file in Microsoft Access 7.0</p>\n\n<ul>\n<li>Save the file in Microsoft Excel using standard database formatting listed above. Close the file.</li>\n<li>Start Microsoft Access 7.0 and open the database you want to import the Microsoft Excel information into.</li>\n<li>On the File menu, click Get External Data and then click Import.</li>\n<li>From the import dialog box, choose Microsoft Excel (*.xls) for the Files Of Type option. </li>\n</ul>\n\n<p>This will display only the Microsoft Excel files.\nFind the desired file and click the Import button.\nThe Import Spreadsheet Wizard appears and allows you to choose options specific to the file.</p>\n\n<p><a href=\"http://support.microsoft.com/kb/141228\" rel=\"nofollow\">http://support.microsoft.com/kb/141228</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4528954, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204929131122331/picture?type=large", "display_name": "Jonathan Taylor", "link": "https://stackoverflow.com/users/4528954/jonathan-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 825, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594640973, "creation_date": 1423059770, "last_edit_date": 1594640973, "question_id": 28323727, "link": "https://stackoverflow.com/questions/28323727/creating-new-access-table-with-vba", "title": "Creating new access table with VBA", "body": "<p>This is a simple question but I can't find a straightforward answer anywhere for some reason. I am very new to VBA and Access but am learning quickly. I have used VBA to export data from access to Excel, then manipulate in excel, and now my results are in Excel. (just one row of numbers, and then a few other numbers placed here and there.) Because I can't import a chart from Excel to access, I need to move the results back over to access so I can do my work there. </p>\n\n<p>I need help with how to, using VBA, create a new table, with say one field for the row of data, and then 3 fields for the other results. Then I can use that table to create my graph. </p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1423058827, "post_id": 28323273, "comment_id": 44994576, "body": "The problem with your code is that it will stop at the first blank cell downwards. The op Data could be separated by blank cells. If you would start counting up from below, you&#39;d be sure you didn&#39;t miss."}, {"owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1423059193, "post_id": 28323273, "comment_id": 44994809, "body": "That&#39;s what he asked for - &quot;I want to be able to loop until the cell becomes empty&quot;"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1423059420, "post_id": 28323273, "comment_id": 44994939, "body": "I&#39;m not saying it is wrong. I&#39;m only saying there&#39;s a better way to put it."}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1423058397, "creation_date": 1423058397, "answer_id": 28323273, "question_id": 28323177, "link": "https://stackoverflow.com/questions/28323177/using-a-vba-for-loop-to-concatenate-column-in-excel/28323273#28323273", "title": "Using a VBA For Loop to concatenate column in excel", "body": "<p>Get the first empty cell from the top using</p>\n\n<pre><code>lLastRow = sheet.Cells(1, 2).End(xlDown).Row\n</code></pre>\n\n<p>The use this in your for loop</p>\n\n<pre><code>For i = 1 To lLastRow\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4200137, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100002929348757/picture?type=large", "display_name": "Cristopher Ontiveros", "link": "https://stackoverflow.com/users/4200137/cristopher-ontiveros"}, "edited": false, "score": 0, "creation_date": 1423068940, "post_id": 28323370, "comment_id": 45001578, "body": "Worked like a charm! Thanks, mate!"}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 0, "last_activity_date": 1423058693, "creation_date": 1423058693, "answer_id": 28323370, "question_id": 28323177, "link": "https://stackoverflow.com/questions/28323177/using-a-vba-for-loop-to-concatenate-column-in-excel/28323370#28323370", "title": "Using a VBA For Loop to concatenate column in excel", "body": "<pre><code>With Worksheets(\"YourSheetName\")\nlastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>Loop it to LastRow.</p>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1542610772, "creation_date": 1542610772, "answer_id": 53369720, "question_id": 28323177, "link": "https://stackoverflow.com/questions/28323177/using-a-vba-for-loop-to-concatenate-column-in-excel/53369720#53369720", "title": "Using a VBA For Loop to concatenate column in excel", "body": "<p>You could use the following skeleton:</p>\n\n<pre><code>Sub ALoop()\n    Dim r As Long\n    r = 2 '//Start row\n    While Len(Cells(r, \"A\")) &gt; 0 '//Or While Not IsEmpty(...)\n        '// Your code\n        r = r + 1 '//Don't forget to increment row\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4200137, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100002929348757/picture?type=large", "display_name": "Cristopher Ontiveros", "link": "https://stackoverflow.com/users/4200137/cristopher-ontiveros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 28323370, "answer_count": 3, "score": 0, "last_activity_date": 1542610772, "creation_date": 1423058128, "last_edit_date": 1542609138, "question_id": 28323177, "link": "https://stackoverflow.com/questions/28323177/using-a-vba-for-loop-to-concatenate-column-in-excel", "title": "Using a VBA For Loop to concatenate column in excel", "body": "<p>I have a column of data in excel. I want to loop through the data and combine the contents into a single string. I can specify the cell range, but what if the range is unknown. I want to be able to loop until the cell becomes empty. here is what I have so far. </p>\n\n<pre><code>Sub ConcatenationLoop()\n\nDim rng As Range, i As Integer\n\nSet rng = Range(\"A1\", \"A5\")\n\nFor i = 1 To rng.Rows.Count\nWith Range(\"B1\")\n    If .Value = \"\" Then\n        .Value = rng.Range(\"A\" &amp; i)\n    Else\n        .Value = .Value &amp; \", \" &amp; rng.Range(\"A\" &amp; i)\n    End If\nEnd With\nNext\n</code></pre>\n\n<p>is it possible to combine with something like:</p>\n\n<pre><code>Do Until IsEmpty(ActiveCell)\n</code></pre>\n\n<p>Much help is appreciated!</p>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423059047, "post_id": 28323314, "comment_id": 44994693, "body": "This works as well! Thanks! Didn&#39;t know I have to add to add ws. to cells as well :)  Appreciate you taking your time!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1423058542, "creation_date": 1423058542, "answer_id": 28323314, "question_id": 28323053, "link": "https://stackoverflow.com/questions/28323053/excel-vba-range-object-error-in-looping-through-worksheet/28323314#28323314", "title": "Excel VBA Range object Error in Looping Through Worksheet", "body": "<p>You have to qualify the <code>Cells</code> calls as well as the <code>Range</code> call:</p>\n\n<pre><code>With ws.Range(ws.cells(lastRow, 1), ws.cells(1, lastColumn))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423058723, "post_id": 28323318, "comment_id": 44994528, "body": "Thank you so much! The code works!  I have some questions: 1) Why do you put the variable assignment inside the loop? 2) What&#39;s the difference with ws.Range(cells ...) &amp; Range(ws.cells...)  Thank you so much! Just want to make sure I understand the code fully :)"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423058766, "post_id": 28323318, "comment_id": 44994542, "body": "No problem. What are the questions?"}, {"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423059117, "post_id": 28323318, "comment_id": 44994741, "body": "Can you read the questions above? I accidentally posted without finishing the question"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1423059226, "post_id": 28323318, "comment_id": 44994840, "body": "Note it is better to use <code>ws.Range</code> not just <code>Range</code>. If the code is in a worksheet code module, it would raise an error otherwise."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423059230, "post_id": 28323318, "comment_id": 44994844, "body": "1. Variable assignment determines the last row and the last column of the worksheet. Unless each of the worksheets has exactly the same number of rows and same number of columns, you have to reassign it each time. Think about what is happening. The loop starts at sheet 1, checks the last row and last column, then performs the action. It loops to the next sheet. Should the same last row and column be used again, or should it be reassigned? 2. It&#39;s about properly qualifying objects. This will be more difficult to explain (and I&#39;m running out of characters) so I will add another comment below."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423059428, "post_id": 28323318, "comment_id": 44994950, "body": "2 (cont). When the loop starts, it&#39;s on sheet 1 (for example). ws refers to sheet 1. Everything is fine. However, when it loops to the second sheet, Excel doesn&#39;t actually switch over to the second sheet. So, the active sheet is still sheet 1. Looking at the code, <code>ws</code> refers to sheet 2, so <code>ws.Range</code> expects a range object for sheet 2. However, since <code>Cells</code> is not qualified, Excel defaults to the active sheet (sheet 1). So the code basically says: <code>Sheet2.Range(Sheet1.Cells)...</code> Does that help to explain what&#39;s going on?"}, {"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423059798, "post_id": 28323318, "comment_id": 44995191, "body": "I got the process flow for Question 1. There are different rows and columns in each worksheet. For the code to properly determine the last row and column it will do a check at each loop. Am I right?"}, {"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423059876, "post_id": 28323318, "comment_id": 44995246, "body": "For question 2, what do you mean by &quot;since &#39;cells&#39; is not qualified?"}, {"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1423060009, "post_id": 28323318, "comment_id": 44995335, "body": "@Rory thanks for the clarification! I will take note of it in worksheet code module."}, {"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423060185, "post_id": 28323318, "comment_id": 44995441, "body": "One more question: Isn&#39;t <code>ws.cells(lastRow, lastColumn)</code> selecting the entire selection. Why do you need to reference it from the first cell?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423061673, "post_id": 28323318, "comment_id": 44996472, "body": "1. Correct, it will check last row/column in each worksheet. 2. By qualified, I mean its parent object is not selected. The parent being the worksheet within which the cells reside. Think of it like houses; each house has its own individual rooms, but they all belong to a different house (parent object). 3. It is not selecting the entire select. <code>Cells</code> refers to a SINGLE cell, at the <code>(ROW,COLUMN)</code>. When we write <code>RANGE(CELLS(1,1), CELLS(LR, LC))</code>, we select all of the cells in Range A1 : LASTROW/LASTCOLUMN"}, {"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423091204, "post_id": 28323318, "comment_id": 45013484, "body": "For 3) is LC referring to the last column cell on the first row or the last column cell at the last row? It maybe because I am misunderstanding this point. Thank you so much for helping me clarifying my doubts."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423144145, "post_id": 28323318, "comment_id": 45035422, "body": "It&#39;s actually based on your definition. If you break down the code assigning a variable to LC into smaller parts, you can more easily understand it. First, <code>Cells(1, Columns.Count)</code> finds the very last Column on row 1. (In Excel 2010, that is Cell XFD1). Then, <code>End(xlToLeft)</code> finds the first column to the left of the last cell with data. If you have an irregular number of columns on different rows, LC would be different based on which row you select in the <code>CELLS</code> function. Of course, if you have contiguous data, you can use the <code>.CurrentRegion</code> property"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1423144199, "post_id": 28323318, "comment_id": 45035461, "body": "Also, if you find that the solution has worked as needed, please mark the question as Answered to aid users who are performing searches in the future"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1423058564, "creation_date": 1423058564, "answer_id": 28323318, "question_id": 28323053, "link": "https://stackoverflow.com/questions/28323053/excel-vba-range-object-error-in-looping-through-worksheet/28323318#28323318", "title": "Excel VBA Range object Error in Looping Through Worksheet", "body": "<p>Few changes to be made:\n1. You have to redefine the last row and last column for each sheet. With that said, place the variable assignment inside the loop.</p>\n\n<ol start=\"2\">\n<li>Instead of <code>ws.Range(cells...)</code>, the proper syntax is <code>Range(ws.cells...)</code></li>\n</ol>\n\n<p>See below:</p>\n\n<pre><code>Sub formatting()\n    Dim ws As Worksheet\n    Dim lastrow As Long, lastcolumn As Long\n\n\n    For Each ws In ActiveWorkbook.Worksheets\n        lastrow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        lastcolumn = (Cells(1, Columns.Count).End(xlToLeft).Column)\n        With Range(ws.Cells(1, 1), ws.Cells(lastrow, lastcolumn))\n            'rest of the actions I want to perform'\n            .Font.Bold = True\n        End With\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423115423, "post_id": 28324389, "comment_id": 45019931, "body": "Hello! I understood the currentRegion property. It&#39;s quite useful since most of my fields are connected.   But why do you set <code>rSheet = nothing</code>? Is it to cancel out all the selection?"}, {"owner": {"reputation": 486, "user_id": 3461846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9b9be4272a419813fa24ea47b6a573?s=128&d=identicon&r=PG&f=1", "display_name": "durbo", "link": "https://stackoverflow.com/users/3461846/durbo"}, "reply_to_user": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "edited": false, "score": 0, "creation_date": 1423185108, "post_id": 28324389, "comment_id": 45057300, "body": "Yes, It clears the rSheet from memory thus from future (accidental) use when you no longer require it. In your example, I&#39;m clearing the rSheet from Sheet1 before i move to Sheet2.  Its good practice to clear memory when you no longer need that object."}], "tags": [], "owner": {"reputation": 486, "user_id": 3461846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9b9be4272a419813fa24ea47b6a573?s=128&d=identicon&r=PG&f=1", "display_name": "durbo", "link": "https://stackoverflow.com/users/3461846/durbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1423111580, "last_edit_date": 1423111580, "creation_date": 1423061789, "answer_id": 28324389, "question_id": 28323053, "link": "https://stackoverflow.com/questions/28323053/excel-vba-range-object-error-in-looping-through-worksheet/28324389#28324389", "title": "Excel VBA Range object Error in Looping Through Worksheet", "body": "<p>If you just got started in VBA I'd learn about setting ranges using .currentregion this will greatly help you in the future.</p>\n\n<p>The code snippet makes all fields bold. If you are applying to all then currentregion can save code and possible errors on <strong>one condition \"that all the fields are connected.\"</strong></p>\n\n<pre><code>Sub formattingWithCurrentRegion()\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        ws.Range(\"A1\").CurrentRegion.Font.Bold = True\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>By setting the area as a range you can get greater control over ranges to set different formatting without having to deal with loops in loops.\nSee below</p>\n\n<pre><code>Sub formattingWithCurrentRegion()\n    Dim ws As Worksheet\n    Dim rSheet As Range\n\n    For Each ws In ActiveWorkbook.Worksheets\n        '' sets the CurrentRegion as a range. Use the immediate window rSheet.Select to see what CurrentRegion does.\n        Set rSheet = ws.Range(\"A1\").CurrentRegion\n\n        '' now you can work with it\n        rSheet.Font.Bold = True\n\n        '' make the 2 column font.color to Red\n        rSheet.Resize(rSheet.Rows.Count, 1).Offset(0, 1).Font.Color = vbRed\n\n        ''now clean up. Always set ranges to nothing when done with them.\n        Set rSheet = Nothing\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3625711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04c5720bddb5d61b4271f3edfc3d5374?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvinlimjk", "link": "https://stackoverflow.com/users/3625711/kelvinlimjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 1, "accepted_answer_id": 28323318, "answer_count": 3, "score": 0, "last_activity_date": 1423111580, "creation_date": 1423057773, "question_id": 28323053, "link": "https://stackoverflow.com/questions/28323053/excel-vba-range-object-error-in-looping-through-worksheet", "title": "Excel VBA Range object Error in Looping Through Worksheet", "body": "<p>I am trying to loop through different sheets in my workbook. I have tried searching through stackoverflow but still stuck with the error. The error showed \"Method 'Range' of object'_Worksheet' failed.</p>\n\n<p>The purpose of this code is to standardise all formats in the worksheets.</p>\n\n<pre><code>Sub formatting()\nDim ws as Worksheet\nDim lastRow as long, lastColumn as long\n\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastColumn = (Cells(1, Columns.Count).End(xlToLeft).Column)\n\nFor each ws in Activeworkbook.Worksheets\nWith ws.Range(cells(lastRow, 1), cells(1, lastColumn))\n    'rest of the actions I want to perform'\n    .font.bold = true\nEnd With\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>I just got started on Excel vba, please enlighten me! Thank you!</p>\n"}, {"tags": ["sql", "vba", "excel", "dao", "adodb"], "answers": [{"tags": [], "owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "is_accepted": false, "score": 1, "last_activity_date": 1423056327, "creation_date": 1423056327, "answer_id": 28322593, "question_id": 28322485, "link": "https://stackoverflow.com/questions/28322485/is-there-a-workaround-in-vba-for-sql-queries-with-no-results/28322593#28322593", "title": "Is there a workaround in VBA for sql queries with no results?", "body": "<p>Before accessing any field value in resulting recordset, you have to check, is recordset at .EOF or ask records count of it. Just opening empty recordset will not give you error, accessing its records gives.</p>\n\n<p>Without seeing your code (starting from recordset opening) it is hard to write any more specific suggestions.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 3881965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29fa7c7ea5e8c913586f5f61c1967b1f?s=128&d=identicon&r=PG&f=1", "display_name": "smpat04", "link": "https://stackoverflow.com/users/3881965/smpat04"}, "edited": false, "score": 0, "creation_date": 1423056869, "post_id": 28322684, "comment_id": 44993304, "body": "Brilliant, totally forgot about the .recordcount property"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1423057749, "post_id": 28322684, "comment_id": 44993891, "body": "I would just note that the <code>recordcount</code> property isn&#39;t always accurate depending on which rdbms you&#39;re using. I personally prefer to use <code>If Not rsObj.EOF</code> because you don&#39;t really care if you&#39;re at the beginning of the file, you just don&#39;t want to work past the end of it."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1423057975, "post_id": 28322684, "comment_id": 44994044, "body": "@RubberDuck As far as I know, if there are records in the recordset .RecordCount always returns &gt;0, so the test is correct. But you are right, to get the actual record count the recordset has to be &quot;populated&quot; first."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1423058024, "post_id": 28322684, "comment_id": 44994076, "body": "A very valid Statement by @RubberDuck, yes RecordCount would return a -1 for ADO setup, DAO returns 0 for <b>no records</b>. However the count will always be &gt; 1 if the recordset returns something. So my checking condition &lt;0 should simply work without a problem !"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1423058095, "post_id": 28322684, "comment_id": 44994125, "body": "That&#39;s not true @PaulFrancis. It&#39;s a known issue with ADODB that recordcount may not return a recordcount until the cursor has been moved. It does not seem to be an issue for DAO, but we don&#39;t know which OP is using."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 2, "creation_date": 1423058134, "post_id": 28322684, "comment_id": 44994157, "body": "Unless as mentioned by @MarekStejskal, if you are actually wanting the count of the records returned, a <code>MoveLast</code> and <code>MoveFirst</code> would be in order after checking the <code>BOF And EOF</code> is <b>False</b>."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1423058424, "post_id": 28322684, "comment_id": 44994342, "body": "@RubberDuck, absolutely true."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 4, "last_activity_date": 1423056632, "creation_date": 1423056632, "answer_id": 28322684, "question_id": 28322485, "link": "https://stackoverflow.com/questions/28322485/is-there-a-workaround-in-vba-for-sql-queries-with-no-results/28322684#28322684", "title": "Is there a workaround in VBA for sql queries with no results?", "body": "<p>This is the need for testing the RecordCount/EOF to make sure you have records in the recordset before navigating into the opened recordset. </p>\n\n<pre><code>Public Sub TestRS()\n    Dim rsObj As DAO.Recordset\n\n    Set rsObj = CurrentDB.OpenRecordset(\"SELECT FieldName1, FieldName2 FROM tableName WHERE someID = 10\")\n\n    If rsObj.RecordCount &lt; 1 Then\n        MsgBox \"No Records.\"\n        'You can also test using one of the following.\n        'If Not (rsObj.BOF And rsObj.EOF) Then\n    Else\n        MsgBox \"There are more than one Record.\"\n    End If\n    Set rsObj = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3881965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29fa7c7ea5e8c913586f5f61c1967b1f?s=128&d=identicon&r=PG&f=1", "display_name": "smpat04", "link": "https://stackoverflow.com/users/3881965/smpat04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5296, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1423057977, "creation_date": 1423056041, "last_edit_date": 1423057977, "question_id": 28322485, "link": "https://stackoverflow.com/questions/28322485/is-there-a-workaround-in-vba-for-sql-queries-with-no-results", "title": "Is there a workaround in VBA for sql queries with no results?", "body": "<p>I have a VBA program in which part of it queries our SQL servers and returns specific data.  The problem is that the data isn't necessarily always there, which is expected.  I need to query the database asking for specific data, and if it isn't there then I want the program to ignore it and move on.  Unfortunately, when I hit a record without data I get the following error:</p>\n\n<blockquote>\n  <p>Run-time error '3021': <br>\n  Either BOF or EOF is True, or the current record has been deleted.</p>\n</blockquote>\n\n<p>a.k.a. there's no record.  Is there a way, without using on error, to either </p>\n\n<ol>\n<li>Determine which the data is present, OR </li>\n<li>just have it return a null string/recordset/<em>anything</em> other than an error?</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 8, "creation_date": 1423056422, "post_id": 28322451, "comment_id": 44992957, "body": "VBA is talking english. You have already used IFERROR and AVERAGE in correct language. So use NA() instead of the german NV()."}, {"owner": {"reputation": 31, "user_id": 1380360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537c792e4eee30551adadb75e995e60c?s=128&d=identicon&r=PG", "display_name": "Jan Hangebrauck", "link": "https://stackoverflow.com/users/1380360/jan-hangebrauck"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1423136757, "post_id": 28322451, "comment_id": 45030636, "body": "Thanks a lot, it works. I was sure NV would be No Value, whereas NA would be Not Available, but you&#39;re right. Thank you!"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1423138102, "post_id": 28322451, "comment_id": 45031489, "body": "NA() = #N/A = Not Available = NV() = #NV = Nicht Verf&#252;gbar ;-)"}], "owner": {"reputation": 31, "user_id": 1380360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537c792e4eee30551adadb75e995e60c?s=128&d=identicon&r=PG", "display_name": "Jan Hangebrauck", "link": "https://stackoverflow.com/users/1380360/jan-hangebrauck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 517, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423058236, "creation_date": 1423055958, "last_edit_date": 1423058236, "question_id": 28322451, "link": "https://stackoverflow.com/questions/28322451/excel-array-formula-evaluation-nv-in-iferror-evaluates-to-name", "title": "Excel Array Formula Evaluation: NV() in IFERROR evaluates to #NAME?", "body": "<p>I am using an array formula with the structure</p>\n\n<p><code>=IFERROR(AVERAGE(IF(...)),NV())</code></p>\n\n<p>which I am inserting into cells using <code>VBA's Range(...).FormulaArray</code> method. The problem is really weird: The <code>AVERAGE</code> evaluates to a <code>#DIV/0!</code> error (which is correct in this case), but in <code>IFERROR(#DIV/0!,NV())</code>, the <code>NV()</code> evaluates to the <code>#NAME?</code> error.</p>\n\n<p>The weirdest thing is that when I re-enter the cell with the array formula manually and press Ctrl-Shift-Return, Excel returns <code>#NV</code> correctly. The formula is definitely recognized as an array formula in the first place.</p>\n\n<p>I've been looking for the reason for this behavior for more than one day now, and I just do not find a thing. Any help would really be appreciated :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1423056137, "post_id": 28322377, "comment_id": 44992770, "body": "It looks like you have a pretty good plan and shouldn&#39;t be too hard to implement with some research and gumption.  Probably should start with google.  Do a bit of research on the randbetween function.  Once you have that down, do a bit more googling on functions or subs that will return only unused numbers (or something to that effect).  After that, give it a go and post back if you get stuck.  Be sure to post what you tried, what didn&#39;t work, and what you&#39;re expecting."}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423056789, "post_id": 28322552, "comment_id": 44993234, "body": "This could work, but it starts to re-use numbers which are already used. For example player F and player B could both be assigned with number 6."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1423056212, "creation_date": 1423056212, "answer_id": 28322552, "question_id": 28322377, "link": "https://stackoverflow.com/questions/28322377/assigning-random-numbers-to-column-of-names-in-excel/28322552#28322552", "title": "Assigning random numbers to column of names in Excel", "body": "<p>Turn on Record Macro if you wish first. Say names are in ColumnB, 1>15 in ColumnC (both starting in Row1). In A1 and copied down to A15 enter:</p>\n\n<pre><code>=RANDBETWEEN(1,1000)  \n</code></pre>\n\n<p>the sort ColumnA:B on A.</p>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423057048, "post_id": 28322755, "comment_id": 44993401, "body": "Are they still minimal if i use for example 64 players?"}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1423057459, "post_id": 28322755, "comment_id": 44993669, "body": "I would say so, the number generated by Rand looks like this &#39;0.537072112173298&#39;, so I think it&#39;s pretty safe. But @pnuts has a point, this is not practical as the Rand changes on every change on the worksheet, I meant that only as a proof of concept. If you get VBA to handle your Rand() generation, it would be better of course."}], "tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": false, "score": 0, "last_activity_date": 1423057251, "last_edit_date": 1423057251, "creation_date": 1423056836, "answer_id": 28322755, "question_id": 28322377, "link": "https://stackoverflow.com/questions/28322377/assigning-random-numbers-to-column-of-names-in-excel/28322755#28322755", "title": "Assigning random numbers to column of names in Excel", "body": "<p>If you do not wish to use sorting, you can also do it like this:</p>\n\n<pre><code>        A           B                  C\n1  Player Name |  Rand   |       Player Number\n  ============+======+==============================\n2  John        | =Rand() | =COUNTIF($B$2:$B$6,\"&gt;\"&amp;B2)\n3  James       | =Rand() | =COUNTIF($B$2:$B$6,\"&gt;\"&amp;B3)\n4  Jim         | =Rand() | =COUNTIF($B$2:$B$6,\"&gt;\"&amp;B4)\n5  George      | =Rand() | =COUNTIF($B$2:$B$6,\"&gt;\"&amp;B5)\n6  Pete        | =Rand() | =COUNTIF($B$2:$B$6,\"&gt;\"&amp;B6)\n</code></pre>\n\n<p>How does it work? Everytime the sheet is changed/refreshed a new random number is generated in column B. Column C merely counts how many numbers in that row are greater than the remaining values in column B.</p>\n\n<p>The chance for the <code>Rand()</code> values to be exactly the same is minimal, so you shouldn't worry about players having the same nubmer.</p>\n"}, {"comments": [{"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423064810, "post_id": 28323130, "comment_id": 44998582, "body": "Thank you, this did the thing i wanted"}, {"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423065701, "post_id": 28323130, "comment_id": 44999203, "body": "Just a few follow up questions - is it normal for it to crash if i&#39;ve already ran it once and haven&#39;t deleted the empty space in result column (B)? Second question, how could i modify that the count begins from the second row instead of first one?"}, {"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 1, "creation_date": 1423065813, "post_id": 28323130, "comment_id": 44999282, "body": "As for first question, i think this could be avoided if the program checks at first whether the area where the randomed numbers will appear (column B) is empty or not and then clear it at first."}, {"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "reply_to_user": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423065916, "post_id": 28323130, "comment_id": 44999350, "body": "It should not crash. It just calculates everything again, but always finds a value. This could take a long time, but should not crash. You could counter this by adding <code>If IsNull(Range(&quot;B&quot; &amp; i) ) Then</code> at the beginning of the loop. For your second question, change the value of <code>i</code> and <code>t</code> to the desired row. (2)"}, {"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "reply_to_user": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423067153, "post_id": 28323130, "comment_id": 45000233, "body": "It does get stuck in an infinite loop, when all numbers have been used and it&#39;s still not at the end. But this will definitely put you in the right direction."}, {"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 1, "creation_date": 1423068225, "post_id": 28323130, "comment_id": 45001066, "body": "I fixed it using .Columns(2).ClearContents in With ActiveSheet."}, {"owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "edited": false, "score": 0, "creation_date": 1423074274, "post_id": 28323130, "comment_id": 45004796, "body": "changing i and t to two didn&#39;t work. I have 13 elements and in the top description &quot;NAME&quot;. It still counts the whole column"}], "tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": true, "score": 1, "last_activity_date": 1423058339, "last_edit_date": 1423058339, "creation_date": 1423057999, "answer_id": 28323130, "question_id": 28322377, "link": "https://stackoverflow.com/questions/28322377/assigning-random-numbers-to-column-of-names-in-excel/28323130#28323130", "title": "Assigning random numbers to column of names in Excel", "body": "<p>The following code works for an infinite number of people. Note that the more people you add, the longer the code will run, because it has to check everything over and over again.</p>\n\n<pre><code>Private Sub numb_ass()\nDim i As Integer: i = 1\nDim v As Integer\nDim lr As Integer\nDim t As Integer: t = 1\n\nWith ActiveSheet\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nDo Until i &gt; lr\nNewNumber:\n    v = Int(lr * Rnd() + 1)\n    Do Until t &gt; lr\n        If v = Range(\"B\" &amp; t) Then\n            If t &gt; lr Then: Exit Sub\n            t = 1\n            GoTo NewNumber\n        End If\n        t = t + 1\n        If t &gt; lr Then: Range(\"B\" &amp; i) = v\n    Loop\nt = 1\ni = i + 1\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 271, "user_id": 3450067, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cabdc3578a06921328813bd84bfb53d9?s=128&d=identicon&r=PG&f=1", "display_name": "charen", "link": "https://stackoverflow.com/users/3450067/charen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 28323130, "answer_count": 3, "score": -1, "last_activity_date": 1423058339, "creation_date": 1423055703, "question_id": 28322377, "link": "https://stackoverflow.com/questions/28322377/assigning-random-numbers-to-column-of-names-in-excel", "title": "Assigning random numbers to column of names in Excel", "body": "<p>I'd like to do a tournament shuffling. For example i have 15 players and i'd like to create a play-off table. </p>\n\n<p>So my idea would work in a way that i'd write all the players in the column, let's say it's column B. Then the so called macro will draft a number for every player in range 1-playerCount (one number for one player). After that the players are assigned in the playoff table (which is really easy to do in Excel with borderlines). </p>\n\n<p>In coding manner it could work in a way that every person in a column gets drafted a number. The numbers are in a list. So let's say we have 15 players, at first there are numbers 1-15 in a list. Then a list gets shuffled (basically same as drafting a random number but we don't have to start searching for unassigned numbers). First element (or last, doesen't matter) will be assigned for the player. So now players all get random numbers which will draft them into the table. These numbers 1-15 could represent the column X maybe, where the names should go into and then the values in this column change.</p>\n\n<p>My question is - how hard would it be to implement this kind of thing? As a Java Programmer i watch this idea and i'd think that doing something in JAVA it shouldn't take long and would be pretty easy. The problem with JAVA is that then the UI needs to be coded and creating UI which makes playoff tables isn't the easiest solution. </p>\n"}, {"tags": ["c#", ".net", "winforms", "vba", "dll"], "comments": [{"owner": {"reputation": 3132, "user_id": 733623, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EuFxV.jpg?s=128&g=1", "display_name": "Thomas Andre&#232; Wang", "link": "https://stackoverflow.com/users/733623/thomas-andre%c3%a8-wang"}, "edited": false, "score": 0, "creation_date": 1423054677, "post_id": 28321942, "comment_id": 44991814, "body": "This might be alittle off. but have you tried looking at the OnFormClosed function of the form?  <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.onformclosed(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>  You should be able to handle killing stuff onclose there"}, {"owner": {"reputation": 38630, "user_id": 1324033, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/PaonW.png?s=128&g=1", "display_name": "Sayse", "link": "https://stackoverflow.com/users/1324033/sayse"}, "edited": false, "score": 0, "creation_date": 1423054747, "post_id": 28321942, "comment_id": 44991852, "body": "Unreference the dll&#39;s or objects within the dlls?"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1423055872, "post_id": 28321942, "comment_id": 44992588, "body": "In your MSAccess code, are you <code>Set myNetCOMForm = Nothing</code> when you are done with it?"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1423057907, "post_id": 28321942, "comment_id": 44994002, "body": "Pretty sure <code>GC.Collect</code> won&#39;t have any effect if your .NET COM-visible code still has a dangling COM reference to it"}, {"owner": {"reputation": 9, "user_id": 4528630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6372511b1182008779740dbc9025b008?s=128&d=identicon&r=PG&f=1", "display_name": "bhash", "link": "https://stackoverflow.com/users/4528630/bhash"}, "edited": false, "score": 0, "creation_date": 1423067217, "post_id": 28321942, "comment_id": 45000295, "body": "Yes, I did the form = nothing on exiting of the function. I also override the Dispose method on all of the controls being used"}], "answers": [{"comments": [{"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1423055425, "post_id": 28322002, "comment_id": 44992295, "body": "<i>&quot;You can not unload an assembly which is loaded into a .NET AppDomain.&quot;</i> - I may be trolling but that is incorrect.  <a href=\"https://msdn.microsoft.com/en-us/library/ms173101.aspx\" rel=\"nofollow noreferrer\">If you want to unload some assemblies but not others, consider creating a new application domain, executing the code inside that domain, and then unloading that application domain.</a>"}, {"owner": {"reputation": 21059, "user_id": 472434, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8e4969da6f6390324dce670ffc7597?s=128&d=identicon&r=PG", "display_name": "Christoph Fink", "link": "https://stackoverflow.com/users/472434/christoph-fink"}, "reply_to_user": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 1, "creation_date": 1423055731, "post_id": 28322002, "comment_id": 44992498, "body": "@MickyDuncan: My statement is correct: You can unload an <code>AppDomain</code>, but NOT only one assembly inside that domain without unloading the complete domain -&gt; you can not unload an assembly only an <code>AppDomain</code>. But of course you are right with &quot;create a seperate <code>AppDomain</code> for assemblies if you need to unload them&quot;..."}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 1, "creation_date": 1423056196, "post_id": 28322002, "comment_id": 44992802, "body": "I guess it can be read two ways. We appear to agree anyway my friend."}], "tags": [], "owner": {"reputation": 21059, "user_id": 472434, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc8e4969da6f6390324dce670ffc7597?s=128&d=identicon&r=PG", "display_name": "Christoph Fink", "link": "https://stackoverflow.com/users/472434/christoph-fink"}, "is_accepted": false, "score": 0, "last_activity_date": 1423054653, "creation_date": 1423054653, "answer_id": 28322002, "question_id": 28321942, "link": "https://stackoverflow.com/questions/28321942/unreferences-the-dlls-on-closing-winform/28322002#28322002", "title": "UnReferences the dlls on closing Winform", "body": "<blockquote>\n  <p>How can I unreference those dlls during closing of the form?</p>\n</blockquote>\n\n<p>You can not unload an assembly which is loaded into a .NET <code>AppDomain</code>, but it is also only loaded once -> no increase in memory here when \"reloading a form\".</p>\n\n<p>I guess you have some memory-leak inside your code: Have you tried pinning it down using a memory profiler?</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 4528630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6372511b1182008779740dbc9025b008?s=128&d=identicon&r=PG&f=1", "display_name": "bhash", "link": "https://stackoverflow.com/users/4528630/bhash"}, "edited": false, "score": 0, "creation_date": 1423067259, "post_id": 28322346, "comment_id": 45000333, "body": "How can I unrelease the unmanaged object on the form closing."}, {"owner": {"reputation": 340, "user_id": 4520832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A7KoG.png?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/4520832/jessica"}, "reply_to_user": {"reputation": 9, "user_id": 4528630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6372511b1182008779740dbc9025b008?s=128&d=identicon&r=PG&f=1", "display_name": "bhash", "link": "https://stackoverflow.com/users/4528630/bhash"}, "edited": false, "score": 0, "creation_date": 1423070708, "post_id": 28322346, "comment_id": 45002749, "body": "That depends on how you&#39;re creating them. I&#39;d need to see code to determine that."}], "tags": [], "owner": {"reputation": 340, "user_id": 4520832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A7KoG.png?s=128&g=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/4520832/jessica"}, "is_accepted": false, "score": 1, "last_activity_date": 1423055592, "creation_date": 1423055592, "answer_id": 28322346, "question_id": 28321942, "link": "https://stackoverflow.com/questions/28321942/unreferences-the-dlls-on-closing-winform/28322346#28322346", "title": "UnReferences the dlls on closing Winform", "body": "<p>It sounds more like you're creating unmanaged objects and not releasing them when the form closes.</p>\n\n<p>If this is the case then you need to keep track of the unmanaged objects and release them within OnFormClosed.</p>\n"}], "owner": {"reputation": 9, "user_id": 4528630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6372511b1182008779740dbc9025b008?s=128&d=identicon&r=PG&f=1", "display_name": "bhash", "link": "https://stackoverflow.com/users/4528630/bhash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1423055592, "creation_date": 1423054465, "last_edit_date": 1423054687, "question_id": 28321942, "link": "https://stackoverflow.com/questions/28321942/unreferences-the-dlls-on-closing-winform", "title": "UnReferences the dlls on closing Winform", "body": "<p>I have .NET Form in which multiple of user controls being used and inside the user controls multiple of dlls are referenced. The application is a combination of vba and .NET forms and we open up the .NET form from VBA through COM interfacing. </p>\n\n<p>The issue is that when I close the form, it does not unrelease / unreferenced the dlls used inside the form because of that it it keeps on increasing the size of the <code>MSACCESS.exe</code> process whenever I open up the form again. I tried to call <code>GC.Collect</code> and <code>GC.WaitForPendingFinalizers()</code> but it did not resolve the issue. </p>\n\n<p>How can I unreference those dlls during closing of the form?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1423053729, "creation_date": 1423053729, "answer_id": 28321700, "question_id": 28321370, "link": "https://stackoverflow.com/questions/28321370/vba-accounting-for-inserted-rows/28321700#28321700", "title": "VBA accounting for inserted rows", "body": "<p>You can name the range in the GUI or in code:</p>\n\n<pre><code>Range(\"A1:N40\").Name = \"printRange\"\n</code></pre>\n\n<p>User inserted (not pasted) rows within that range will extend the range so after adding a row <code>Range(\"printRange\")</code> is now <code>A1:N41</code></p>\n"}], "owner": {"reputation": 33, "user_id": 4520706, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7e9da3149db8826e0095b2cacb47a612?s=128&d=identicon&r=PG&f=1", "display_name": "Lupi", "link": "https://stackoverflow.com/users/4520706/lupi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423053729, "creation_date": 1423052790, "last_edit_date": 1423052973, "question_id": 28321370, "link": "https://stackoverflow.com/questions/28321370/vba-accounting-for-inserted-rows", "title": "VBA accounting for inserted rows", "body": "<p>I am making a scheduling worksheet with various macros which apply to certain ranges. The sheet is currently setup to where it should have enough rows for most days, but occasionally might need more. </p>\n\n<p>Currently when a row is added(or deleted), the macro isn't accounting for this and the range stays the same, if it is possible I would like for it to account for the added rows. Here's an example of one of my macros-</p>\n\n<pre><code>Sub Print1st()\n\n'\n\n' Print1st Macro\n\nX = Application.Dialogs(xlDialogPrinterSetup).Show\n\nIf X = False Then Exit Sub \n\nRange(\"A1:N40\").PrintOut\nRange(\"A4\").Select\n\nEnd Sub\n</code></pre>\n\n<p>So for instance, if two rows are inserted it I would like it to reference A1:N42 so that when it prints it is still printing everything and not cutting off two rows. If not, I can just lock users out from inserting rows and adjust later if it isn't sufficient. </p>\n\n<p>Thanks for any help! </p>\n"}, {"tags": ["macos", "vba"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1423052780, "post_id": 28321252, "comment_id": 44990705, "body": "What&#39;s the name of the first and second workbook?"}, {"owner": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1423052906, "post_id": 28321252, "comment_id": 44990771, "body": "the first one is &quot;Payment Request Builder&quot; and the 2nd is &quot;United&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "edited": false, "score": 0, "creation_date": 1423056853, "post_id": 28321624, "comment_id": 44993292, "body": "Sub Copy2Workbook() &#39;You need to place this in your source workbook!     Dim wbT As Workbook &#39; target workbook     Set wbT = Workbooks(&quot;United&quot;) &#39;I get an error here...Apologies, my understanding is very limited."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "edited": false, "score": 0, "creation_date": 1423057978, "post_id": 28321624, "comment_id": 44994047, "body": "Is your target book &quot;United&quot; open?"}, {"owner": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "edited": false, "score": 0, "creation_date": 1423058828, "post_id": 28321624, "comment_id": 44994577, "body": "Yes the target book is open."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "edited": false, "score": 0, "creation_date": 1423059498, "post_id": 28321624, "comment_id": 44994997, "body": "What is the EXACT name of the target workbook (make sure there are no spaces in the name&quot;, including the extensions (.xls, .xslx)."}, {"owner": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "edited": false, "score": 0, "creation_date": 1423059649, "post_id": 28321624, "comment_id": 44995085, "body": "United.xlsx...I&#39;ll be back on in a few hours. Thank you so far for your help."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "edited": false, "score": 0, "creation_date": 1423070987, "post_id": 28321624, "comment_id": 45002927, "body": "Try <code>Set wbT = Workbooks(&quot;United.xlsx&quot;)</code>"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1537165276, "last_edit_date": 1537165276, "creation_date": 1423053479, "answer_id": 28321624, "question_id": 28321252, "link": "https://stackoverflow.com/questions/28321252/select-end-row-of-table-copy-and-paste-in-another-workbook/28321624#28321624", "title": "Select end row of table, copy and paste in another workbook", "body": "<p>The following code will do what you need. Just make the changes mentioned in the comments.</p>\n\n<pre><code>Sub Copy2Workbook() 'You need to place this in your source workbook!\n    Dim wbT As Workbook ' target workbook\n    Set wbT = Workbooks(\"United\")\n    Dim shtT As Worksheet 'target worksheet\n    Set shtT = wbT.Worksheets(\"Name of target sheet\") ' change name to fit your case\n    Dim shtS As Worksheet 'source worksheet\n    Set shtS = ThisWorkbook.Worksheets(\"Name of source sheet\") ' change name to fit your case\n    Dim lastRow As Long\n    '*****************************************\n    lastRow = shtS.Cells(Rows.Count, \"B\").End(xlUp).Row\n    shtT.Range(\"G14\").Value = shtS.Range(\"B\" &amp; lastRow).Value\n    'repeat the two lines of above while changing the references to your needs\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4528484, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152957098976236/picture?type=large", "display_name": "Matthew", "link": "https://stackoverflow.com/users/4528484/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537165276, "creation_date": 1423052471, "last_edit_date": 1438376655, "question_id": 28321252, "link": "https://stackoverflow.com/questions/28321252/select-end-row-of-table-copy-and-paste-in-another-workbook", "title": "Select end row of table, copy and paste in another workbook", "body": "<p>I have 2 workbooks.</p>\n\n<p>Source Workbook\n - Select a cell in <strong>column B,</strong> last row of a table. e.g. B29 (But this would change as the table grows)</p>\n\n<p>2nd Workbook \n- Paste that cell into <strong>G14</strong> of the 2nd workbook (This doesn't change)</p>\n\n<p>Source Workbook\n - Select a cell in <strong>column D</strong>, same row - last row of table. e.g.. D29</p>\n\n<p>2nd Workbook \n- Paste that cell into <strong>D8</strong> (This doesn't change)</p>\n\n<p>This same process repeats 4 more times (<strong>Columns E-H</strong>) and all the pasting is done into <strong>C3, F14, I14 and E14</strong> respectively.</p>\n"}, {"tags": ["javascript", "html", "vba", "scripting"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1423071187, "post_id": 28320883, "comment_id": 45003037, "body": "Loop over the options within the select, and set the value when you hit the one with the desired text.  You can wrap that up in a reusable function.  See Lansman&#39;s answer here: <a href=\"http://stackoverflow.com/questions/15003015/using-excel-vba-to-change-the-value-of-a-dropdown-menu-on-a-website\" title=\"using excel vba to change the value of a dropdown menu on a website\">stackoverflow.com/questions/15003015/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4528406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094840184b6ba9e1d93c03bc5318bd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/4528406/nelson"}, "edited": false, "score": 0, "creation_date": 1423149936, "post_id": 28321317, "comment_id": 45039589, "body": "&quot;You mean you want to change the value? That&#39;s just $(&#39;select&#39;).val(&#39;value you want&#39;);, using Jquery.&quot;"}, {"owner": {"reputation": 11, "user_id": 4528406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094840184b6ba9e1d93c03bc5318bd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/4528406/nelson"}, "edited": false, "score": 0, "creation_date": 1423150232, "post_id": 28321317, "comment_id": 45039786, "body": "&quot;You mean you want to change the value? That&#39;s just $(&#39;select&#39;).val(&#39;value you want&#39;);, using Jquery.&quot;  No, that will input the value for the option.   I want to input what the user would input, not the value. In the case of the example I provided, I want  to programmatically input &quot;Aetna Healthcare&quot; into the select field not &quot;383&quot; which is the value."}, {"owner": {"reputation": 416, "user_id": 4305926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa0670967ea111b991225f31de3e5d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Mark", "link": "https://stackoverflow.com/users/4305926/peter-mark"}, "reply_to_user": {"reputation": 11, "user_id": 4528406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094840184b6ba9e1d93c03bc5318bd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/4528406/nelson"}, "edited": false, "score": 0, "creation_date": 1423508186, "post_id": 28321317, "comment_id": 45167456, "body": "Nelson, but when you change the value, it changes the corresponding text automatically. So, if you use the .val(&#39;383&#39;), the field will say &#39;Aetna Healthcare&#39;. That&#39;s what you want, unless I&#39;m mistaken. Now, if you want to programmatically update it with input being text (ie., you want to be able to program .val(&#39;Aetna Healthcare&#39;), then you can use the function above to obtain the corresponding value to set. Here&#39;s a fiddle: <a href=\"http://jsfiddle.net/Lcf2so9f/\" rel=\"nofollow noreferrer\">jsfiddle.net/Lcf2so9f</a>"}, {"owner": {"reputation": 11, "user_id": 4528406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094840184b6ba9e1d93c03bc5318bd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/4528406/nelson"}, "edited": false, "score": 0, "creation_date": 1423598998, "post_id": 28321317, "comment_id": 45211371, "body": "I do not want to enter the VALUE. I do not want to enter &quot;383&quot; in this example. I want to enter the text into the select field programmatically as if I was typing it in the box. For example, if I was typing in the box, I would type: &quot;Aetna Healthcare&quot; not &quot;383&quot;. In fact when I started to type &quot;aet&quot;, Aetna Healthcare would show up and I would select that. So I want to programmably enter &quot;Aetna Healthcare&quot; and get the correct selection. Pretend we don&#39;t know that value of &quot;Aetna Healthcare&quot;.is &quot;383&quot;. Let&#39;s pretend we don&#39;t know the value of any of the options."}, {"owner": {"reputation": 416, "user_id": 4305926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa0670967ea111b991225f31de3e5d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Mark", "link": "https://stackoverflow.com/users/4305926/peter-mark"}, "reply_to_user": {"reputation": 11, "user_id": 4528406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094840184b6ba9e1d93c03bc5318bd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/4528406/nelson"}, "edited": false, "score": 0, "creation_date": 1423646922, "post_id": 28321317, "comment_id": 45229227, "body": "Nelson, the Fiddle I posted does that. It lets you programmatically enter your text (eg., &quot;volvo&quot;) and that option is automatically selected without needing to know the value."}], "tags": [], "owner": {"reputation": 416, "user_id": 4305926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa0670967ea111b991225f31de3e5d9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Mark", "link": "https://stackoverflow.com/users/4305926/peter-mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1423052670, "last_edit_date": 1495535124, "creation_date": 1423052670, "answer_id": 28321317, "question_id": 28320883, "link": "https://stackoverflow.com/questions/28320883/enter-text-into-select-object/28321317#28321317", "title": "enter text into select object", "body": "<p>You mean you want to change the value? That's just <code>$('select').val('value you want');</code>, using Jquery.</p>\n\n<p>If you're wanting to obtain the value based on what is in the text field, that is as below, derived in part from <a href=\"https://stackoverflow.com/questions/3744289/jquery-how-to-select-an-option-by-its-text\">this post</a>.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var pick = \"hey\";\r\n\r\nvar value_pick = $('option').filter(function () { return $(this).html() == pick; }).val();\r\nconsole.log(value_pick);\r\n\r\n$(\"select\").val(value_pick);</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n&lt;select&gt;\r\n  &lt;option value=\"1\" &gt;hey&lt;/option&gt;\r\n  &lt;option value=\"1\" &gt;baha&lt;/option&gt;\r\n  &lt;option value=\"1\" &gt;yo&lt;/option&gt;\r\n&lt;/select&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 11, "user_id": 4528406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094840184b6ba9e1d93c03bc5318bd0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/4528406/nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423052670, "creation_date": 1423051316, "question_id": 28320883, "link": "https://stackoverflow.com/questions/28320883/enter-text-into-select-object", "title": "enter text into select object", "body": "<p>I want to enter the text selection for the following select field:</p>\n\n<pre><code>&lt;select name=\"Payerid\" id=\"Payerid\" class=\"text\" name=\"Payerid\"&gt;\n    &lt;option value=\"383\"&gt;Aetna Healthcare&lt;/option&gt;\n    ...\n</code></pre>\n\n<p>Using VBA, I know I can use: (If you give me the syntax in another language, I'll convert) </p>\n\n<pre><code>  IE.getElementById(\"Payerid\").Value = \"383\"\n</code></pre>\n\n<p>but there about 100 options so I don't want to keep track of the values (which are meaningless to me) or changes the website developers make. </p>\n\n<p>So is there a  way to enter the text into the select field?\nI tried:</p>\n\n<pre><code> IE.getElementById(\"Payerid\").Text = \"Aetna Healthcare\"\n</code></pre>\n\n<p>but that didn't work.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2003"], "answers": [{"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1423134490, "creation_date": 1423134490, "answer_id": 28342382, "question_id": 28320712, "link": "https://stackoverflow.com/questions/28320712/calling-oracle-stored-procedure-in-ms-access-without-saving-password-in-pass-thr/28342382#28342382", "title": "calling oracle stored procedure in ms access without saving password in pass through query", "body": "<p>Yes this is possible however you need to know or in other words be able to retrieve the password somehow within your application. In a production line application you would use the user(login) password to create a connection string to access the back-end tables.</p>\n\n<p>The structure would look similar to this:</p>\n\n<ol>\n<li>Create a module to host connection related public functions.</li>\n<li>Create new function GET_CONNECTION_STRING() as String: Which will return your connection-string including logged in user's password.</li>\n<li>loop through the table definitions/ query definitions in your database and update the <strong>.connect</strong> property.</li>\n<li>In most cases you would change the .connect property and use the .RefreshLink to refresh/connect manually.</li>\n<li>You need to add a new reference to use DAO object. (Microsoft dao objets, or activex data obects or ado objects whichever type you want to use)</li>\n</ol>\n\n<p>some startup code:</p>\n\n<pre><code>dim db  as dao.database\nset db = currentdb\ndim tdf as dao.tabledef\n\nFor Each tdf In db.TableDefs\n    If tdf.connect &lt;&gt; vbNullString Then\n        tdf.connect = GET_CONNECTION_STRING &amp; \";TABLE=\" &amp; tdf.name\n        'if you want to manually refresh uncomment below line\n        'tdf.refreshlink\n        End If\n    End If\nNext tdf\n</code></pre>\n\n<p>adding above function to a startup macro will ensure all the linked tables (queries you need to perform extra) are updated with the newest connectionstring.</p>\n\n<p>try and post your code when you are stuck. </p>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1423180667, "creation_date": 1423180667, "answer_id": 28356290, "question_id": 28320712, "link": "https://stackoverflow.com/questions/28320712/calling-oracle-stored-procedure-in-ms-access-without-saving-password-in-pass-thr/28356290#28356290", "title": "calling oracle stored procedure in ms access without saving password in pass through query", "body": "<p>Any linked table(s) and that of including \u201csaved\u201d pass-though quires in Access does NOT require the password to be included in that string. If you leave out the password, then a SINGLE logon to the Oracle database will THEN allow ALL linked tables and pass though quires to run and do so without a password.</p>\n\n<p>The first step is to setup your tables as DSN less, and DON\u2019T include the password (you likely best to delete existing linked tables).</p>\n\n<p>To link using above but NOT include pass-word means you FIRST will have to execute a logon into the database. Once done, then you can link your tables and pass-though quires. So a one time link of tables as DSN less and you are off to the races.</p>\n\n<p>Once above is done, then any and all connections (including pass-though query) will all work and work without having to include the user name.</p>\n\n<p>The above thus means you don\u2019t have to re-link for different users logging into the database.</p>\n\n<p>To run a pass-through query, you can then use this one line of VBA code:</p>\n\n<p>CurrentDb.Execute.QueryDefs(\"MyPassQuery\").execute</p>\n\n<p>How to link with DNS-less is outlined here:\n<a href=\"http://www.accessmvp.com/djsteele/DSNLessLinks.html\" rel=\"nofollow\">http://www.accessmvp.com/djsteele/DSNLessLinks.html</a></p>\n\n<p>How to \u201ccache\u201d the user logon, and NOT require user + logon in the linked connections or ones used for pass-though is outlined here:</p>\n\n<p>Power Tip: Improve the security of database connections</p>\n\n<p><a href=\"http://blogs.office.com/b/microsoft-access/archive/2011/04/08/power-tip-improve-the-security-of-database-connections.aspx\" rel=\"nofollow\">http://blogs.office.com/b/microsoft-access/archive/2011/04/08/power-tip-improve-the-security-of-database-connections.aspx</a></p>\n\n<p>So you can on startup execute the logon one time, or prompt the user for a logon, and from that point on your application and pass-=though queries will run without required a password. And this ALSO means you can have different users logon and NOT have to re-linked the existing tables (and pass-though quires).</p>\n"}], "owner": {"reputation": 93, "user_id": 4105419, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1adfcaabc2188891d23571a2e2578110?s=128&d=identicon&r=PG&f=1", "display_name": "ravi chaudhary", "link": "https://stackoverflow.com/users/4105419/ravi-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1423180667, "creation_date": 1423050728, "last_edit_date": 1423057496, "question_id": 28320712, "link": "https://stackoverflow.com/questions/28320712/calling-oracle-stored-procedure-in-ms-access-without-saving-password-in-pass-thr", "title": "calling oracle stored procedure in ms access without saving password in pass through query", "body": "<p>I am working on MS ACCESS 2003, i need to call oracle stored procedure through ms access. I am using <em>pass through</em> query to call the procedure. I have created user DSN with Microsoft driver for ODBC and successfully able to call the procedure. \n<strong>ODBC;DSN=DSN_NAME;UID=USER_NAME;PWD=*******;DBQ=MY_SERVER</strong></p>\n\n<p>But my worry is to save the password in pass through query, some times password changes then i have to change the connection string for that <em>pass through</em> query every time.</p>\n\n<p>Is there any other way to calling the procedure via <em>pass through</em> query without changing the connection string when password gets change or is there any code in vba to doing the same. I am looking for dynamic way where calling procedure would be easy without changing password to each and every <em>pass through</em> query by going to its properties.\nThanks !! </p>\n"}, {"tags": ["forms", "vba", "listbox", "multi-select"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423051265, "post_id": 28320339, "comment_id": 44989899, "body": "Did you try <b>Debug.Print</b> and see what you get from looping through the listbox? Also your DELETE is missing an <code>*</code> specifying what to delete from the table."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423051809, "post_id": 28320339, "comment_id": 44990207, "body": "@PaulFrancis The &#39;*&#39; is actually not necessary"}, {"owner": {"reputation": 3, "user_id": 4524906, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152703242496491/picture?type=large", "display_name": "Anna Thalakada", "link": "https://stackoverflow.com/users/4524906/anna-thalakada"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423058849, "post_id": 28320339, "comment_id": 44994587, "body": "@PaulFrancis where does the Debug.Print go?"}, {"owner": {"reputation": 3, "user_id": 4524906, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152703242496491/picture?type=large", "display_name": "Anna Thalakada", "link": "https://stackoverflow.com/users/4524906/anna-thalakada"}, "edited": false, "score": 0, "creation_date": 1423058942, "post_id": 28320339, "comment_id": 44994636, "body": "I get this VBA error message when I press the Command button: Run Time Error 3075: Syntax error (missing operator) in query expression &#39;Period IN (,&#39;01/04/2014&#39;,&#39;01/05/2014)&#39;. Not sure what this means..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4524906, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152703242496491/picture?type=large", "display_name": "Anna Thalakada", "link": "https://stackoverflow.com/users/4524906/anna-thalakada"}, "edited": false, "score": 0, "creation_date": 1423060832, "post_id": 28323561, "comment_id": 44995908, "body": "Thats great it worked with the dates format, thanks @PaulFrancis! Is there also a way to bring up a pop-up box to confirm the deletion of records?"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 3, "user_id": 4524906, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152703242496491/picture?type=large", "display_name": "Anna Thalakada", "link": "https://stackoverflow.com/users/4524906/anna-thalakada"}, "edited": false, "score": 0, "creation_date": 1423061240, "post_id": 28323561, "comment_id": 44996168, "body": "You can add a message box to get confirmation. I have modified the code. Please check the updated answer. Please mark the <code>Answer</code> with a Green tick so others could find it useful too. Thanks."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 1, "last_activity_date": 1423061174, "last_edit_date": 1423061174, "creation_date": 1423059294, "answer_id": 28323561, "question_id": 28320339, "link": "https://stackoverflow.com/questions/28320339/ms-access-deleting-records-using-multi-select-listbox/28323561#28323561", "title": "MS Access - deleting records using multi-select Listbox", "body": "<p>Since you are dealing with Dates, you need to make sure that the Dates are enclosed between <code>#</code> tags, and to be sure that the dates are in the <strong>MM/DD/YYYY</strong> format. So the following code should work,</p>\n\n<pre><code>Private Sub cmdOK1_Click()\n    Dim vItem       As Variant\n    Dim strSet      As String\n    Dim i           As Long\n\n    strSet = \"\"\n\n    With Me.lstPeriod\n        For Each vItem In .ItemsSelected\n            If Not IsNull(vItem) Then\n                strSet = strSet &amp; \",\" &amp; Format(.ItemData(vItem), \"\\#mm\\/dd\\/yyyy\\#\")\n            End If\n        Next\n    End With\n\n    'Remove the first comma\n    strSet = Trim(Right(strSet, Len(strSet) - 1))\n\n    If MsgBox(\"You are about to DELETE records from the table. This process is not reversible.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n                \"Are you sure you want to proceed?\", vbYesNo + vbQuestion) = vbNo Then Exit Sub\n\n    strSQL = \"DELETE FROM tblDataConsolidation WHERE Period IN (\" &amp; strSet &amp; \")\"\n\n    CurrentDb.Execute strSQL\n\n    For i = 0 To lstPeriod.ListCount - 1\n        lstPeriod.Selected(i) = False\n    Next\n\n    For i = 0 To lstPeriod.ListCount - 1\n        lstPeriod.Selected(i) = False\n    Next\n\n    lstPeriod.Requery\n    lstPeriod.Requery\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4524906, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152703242496491/picture?type=large", "display_name": "Anna Thalakada", "link": "https://stackoverflow.com/users/4524906/anna-thalakada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 28323561, "answer_count": 1, "score": 0, "last_activity_date": 1423061174, "creation_date": 1423049587, "last_edit_date": 1423051464, "question_id": 28320339, "link": "https://stackoverflow.com/questions/28320339/ms-access-deleting-records-using-multi-select-listbox", "title": "MS Access - deleting records using multi-select Listbox", "body": "<p>I would like to use a multi-select Listbox form control in Access (2007) to delete multiple records in an unbound Table. The Listbox is made up of Dates (dd/mmm/yy) so I need to write code that can understand date types but I've struggled to find the right code out there that matches my requirements. Any suggestions or advice would be much appreciated!</p>\n\n<p>Here is the code that I have attached to the OK Command button on the Form which I can't get it to work:</p>\n\n<pre><code>Private Sub cmdOK1_Click()\n    Dim vItem       As Variant\n    Dim strSet      As String\n    Dim i           As Long\n\n    strSet = \"\"\n\n    With Me.lstPeriod\n        For Each vItem In .ItemsSelected\n            If Not IsNull(vItem) Then\n                strSet = strSet &amp; \"','\" &amp; .ItemData(vItem)\n            End If\n        Next\n    End With\n\n    'Remove the first comma\n    strSet = Mid(Trim(strSet), 2, Len(strSet) - 1)\n\n    strSQL = \"DELETE FROM tblDataConsolidation WHERE Period IN (\" &amp; strSet &amp; \")\"\n\n    CurrentDb.Execute strSQL\n\n    For i = 0 To lstPeriod.ListCount - 1\n        lstPeriod.Selected(i) = False\n    Next\n\n    For i = 0 To lstPeriod.ListCount - 1\n        lstPeriod.Selected(i) = False\n    Next\n\n    lstPeriod.Requery\n    lstPeriod.Requery\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "add", "conditional-statements", "vba"], "comments": [{"owner": {"reputation": 791, "user_id": 4245519, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wxicC.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4245519/mark-smith"}, "edited": false, "score": 0, "creation_date": 1423049029, "post_id": 28320040, "comment_id": 44988699, "body": "Are you sure this needs to be a macro?  I think I would use a lookup (keyword is VLOOKUP).  Google some examples of that and see if it&#39;s what you want."}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "reply_to_user": {"reputation": 791, "user_id": 4245519, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wxicC.png?s=128&g=1", "display_name": "Mark Smith", "link": "https://stackoverflow.com/users/4245519/mark-smith"}, "edited": false, "score": 0, "creation_date": 1423050103, "post_id": 28320040, "comment_id": 44989251, "body": "It does need to be a macro because it&#39;s going to search through <i>and add the right number</i> to all entries in the sales sheet, which can contain thousands of entries. I tried looking at VLOOKUP but it seems to only look for strings or values, i want it too look for them and add an entry to the cell on the right which corresponds to the number on the items sheet."}, {"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1423051073, "post_id": 28320040, "comment_id": 44989791, "body": "please add some screenshot"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423051440, "post_id": 28320884, "comment_id": 44989993, "body": "Would this also add the correct number to the cell to the right of each item in the sales sheet? That&#39;s my main concern."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423051749, "post_id": 28320884, "comment_id": 44990162, "body": "sorry i mixed up your sheet names, please read my answer again , the formula is to be entered in cell I1 on the sales sheet(drag formula down )  which is where you want the number to be"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423052476, "post_id": 28320884, "comment_id": 44990544, "body": "I added this particular formula into cell I1 and it just returns &quot;#N/A&quot; - i&#39;ve checked that all the sheet names and such are correct, the data is in the sheet i want to look at and add to."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423052567, "post_id": 28320884, "comment_id": 44990592, "body": "is it an exact match?  the data in both cells need to be identical,  no extra whitespace or  case sizes in the description etc,  Can you paste both data?"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423052723, "post_id": 28320884, "comment_id": 44990674, "body": "The data is exactly the same in both sheets. No variation in spacing or case sizes. The items sheet has 2 columns. Column A is the item name i&#39;m searching for and column B is the number i want to return into the empty cell."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423052877, "post_id": 28320884, "comment_id": 44990755, "body": "N/A means no match is found,    are you sure row 1 of the sales sheet has a product in it?  please drag formula down along the product rows"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423053484, "post_id": 28320884, "comment_id": 44991077, "body": "My apologies, it does work fine now. The only problem i have is that i do have some fields which are not exactly the same in both sheets, for example, i have a quantity of a particular item which shows as 2x or 3x etc and i&#39;d like to have 1 entry for them so that if the string contains &quot;Ice Scraper&quot; - for example - it adds the number as it is now. Would this be possible? More or less looking for a wildcard."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423053621, "post_id": 28320884, "comment_id": 44991155, "body": "ive added these to the answer above"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423054404, "post_id": 28320884, "comment_id": 44991640, "body": "Steve, the wildcard VLOOKUP is only returning &quot;1&quot; rather than the number associated with the item we have on the items sheet."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423055038, "post_id": 28320884, "comment_id": 44992031, "body": "Please see my note ,  Vlookup finds te first match, so there must be another product with the same string somewhere in it, with a 1 ,  id advise you to use product codes instead of description to make this work reliablly,  can you pvt mail me at stevenmartin99@gmail.com and maybe we could see what you have to work with?"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423057538, "post_id": 28320884, "comment_id": 44993734, "body": "We do use product codes more often than not, however sometimes people purchase 2 or 3 (or more) of a particular item so therefore it will show as &quot;2x Ice&quot;, which is where this particular formula trips up. Is there a way for it to ignore the 2x and just look for the string of text?"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423057621, "post_id": 28320884, "comment_id": 44993790, "body": "i mean do you have a column on the sales page with a product code that code be used as a lookup against the items sheet? it would involve adding the product codes to the items sheet but it would make it work reliably.   in regards your other question  does it have 1x if there is only 1? or is there another column also with the qty ordered that could be used to know there will be a Xx at the start?"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423057754, "post_id": 28320884, "comment_id": 44993892, "body": "Generally it will just state the item code if it&#39;s just 1. I could manually put 2x 3x 4x the item in the items sheet, but this would be unreliable."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423057853, "post_id": 28320884, "comment_id": 44993965, "body": "can you make the system always put 1x  when one is ordered just as it does when 2 is ordered,  not on the items sheet , but on the sales sheet  so that we can reliably chop off everything until the first &quot;x &quot;"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423058045, "post_id": 28320884, "comment_id": 44994089, "body": "did you mean there is a product code with no spaces in it so you might have   &quot;3X 889809&quot; and &quot;889809&quot; if 1 is ordered becuase we could use this to do the lookup then , the issue is that descriptions have spaces in them and product codes generally dont"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423058494, "post_id": 28320884, "comment_id": 44994382, "body": "When we get our orders through, we get them in an excel spreadsheet which has all the order details etc and it would then have a &quot;Quantity&quot; field. I suppose i could run the VLOOKUP before amending the quantity into the title. I was just hoping there may be a simple way to have it do this with a script or macro. I do, however, have a macro which finds and replaces item titles to shorten them so we can print the labels, however this uses the Find &amp; Replace script. Would there be a way to use this to find the title and &quot;replace&quot; the blank cell with the number?"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "reply_to_user": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423058699, "post_id": 28320884, "comment_id": 44994514, "body": "yes if you already have a macro , the first thing would be to use the product code or description (if it doesn&#39;t yet contain the &quot;2x&quot;) to get the number before you start modifying the sales sheet.  Is there a way you can send me the macro code? and i will add the line, comments on StackOverflow are very limited to what you can write in"}, {"owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "edited": false, "score": 0, "creation_date": 1423058964, "post_id": 28320884, "comment_id": 44994649, "body": "The macro i use at the moment is this:  <code>Sub FindNReplace() Dim InputRng As Range, ReplaceRng As Range  &#39;Set Range Values Set InputRng = Range(&quot;H1:H5000&quot;) Set ReplaceRng = Sheets(&quot;royal&quot;).Range(&quot;A1:B100&quot;)  &#39;Spin through replacement range and perform replace For Each Rng In ReplaceRng.Columns(1).Cells     InputRng.Replace what:=Rng.Value, replacement:=Rng.Offset(0, 1).Value Next End Sub</code>  This finds item titles and replaces them with shorter titles depicted in another sheet."}], "tags": [], "owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1423053705, "last_edit_date": 1423053705, "creation_date": 1423051319, "answer_id": 28320884, "question_id": 28320040, "link": "https://stackoverflow.com/questions/28320040/excel-adding-data-based-on-current-data/28320884#28320884", "title": "Excel adding data based on current data", "body": "<p>This is exactly what vlookup is used for</p>\n\n<pre><code> =VLOOKUP(H1, items!A:B,2,FALSE)\n</code></pre>\n\n<p>Put this formula into I1 on the sales sheet and drag it down,  if the items sheet is not in the same workbook , you will need to modify the reference to point to it, </p>\n\n<p>you could obviously write a macro that will insert this formula and drop it down, but it will still be using  vlookup or application.vlookup to get the result</p>\n\n<p>Wildcard searches at the front would be</p>\n\n<pre><code>=VLOOKUP(\"*\"&amp;H1, items!A:B,2,FALSE)   \n</code></pre>\n\n<p>or both ends would be </p>\n\n<pre><code>=VLOOKUP(\"*\"&amp;H1&amp;\"*\", items!A:B,2,FALSE)\n</code></pre>\n\n<p>NB* BE CAREFUL WITH THIS AS YOU MAY HAVE ITEMS WITH SIMILAR DESCRIPTIONS\n like \"apple\" and \"red apple\"  </p>\n\n<p>you should always use a product code to do lookups when available</p>\n"}], "owner": {"reputation": 31, "user_id": 4356776, "user_type": "registered", "profile_image": "https://graph.facebook.com/1079353784/picture?type=large", "display_name": "EzyCare", "link": "https://stackoverflow.com/users/4356776/ezycare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 28320884, "answer_count": 1, "score": -1, "last_activity_date": 1442282427, "creation_date": 1423048685, "last_edit_date": 1531161705, "question_id": 28320040, "link": "https://stackoverflow.com/questions/28320040/excel-adding-data-based-on-current-data", "title": "Excel adding data based on current data", "body": "<p>I'm trying to write a macro that i can run which will allow me to simply sort a range of orders into what i like to call categories. </p>\n\n<p>The basic idea is that we get orders through, and we generally have to print a different type of shipping label for the different items, based on weight, size and value. Unfortunately, there is no easy way of doing this other than going through all orders (sometimes thousands) and copying them into different worksheets to group them into the type of shipping method we need to use.</p>\n\n<p>What i'd like to do (i already have a couple of macros already) - is to look in another sheet whereby we store the item titles, and have a second column within that sheet with a number (1, 2 or 3). For each item, based on it's weight, size or value, which we have already specified - they would be assigned a number. The Macro will look at the item name, if the sales sheet finds a match from column A in the item's sheet, it will then add the correct number specified in the item's sheet to the cell next to the item title in the sales sheet.</p>\n\n<p>Column A-G has all customer details, Column H has the item title. The number i'm wanting to add to the row will be inserted into Column I. </p>\n\n<p>The item's sheet has Column A which is the item title, and Column B is the number assigned to this item.</p>\n\n<p>I have tried to muster a macro up myself, however it's confusing me no end. </p>\n"}, {"tags": ["xml", "vba"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423048992, "post_id": 28319938, "comment_id": 44988673, "body": "Needs more verbiage to your question. Your description says you need to replace this, but then again you say it is different. Could you please show couple of samples?"}, {"owner": {"reputation": 21, "user_id": 4528243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da13429fcc334fea51c1f153757075b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike the new guy", "link": "https://stackoverflow.com/users/4528243/mike-the-new-guy"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1423052422, "post_id": 28319938, "comment_id": 44990521, "body": "The line of code specifically that I need to work on is      &lt;CellConfiguration CellName=&quot;XXXXXX&quot; PartName=&quot;YYYYY&quot;&gt;   The &quot;XXXXX&quot; and the &quot;YYYYY&quot; will always be something different in the file. I will always need them to be changed to &quot;Test&quot; and &quot;AuxCell&quot;. @PaulFrancis"}], "answers": [{"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 2, "last_activity_date": 1423057332, "creation_date": 1423057332, "answer_id": 28322899, "question_id": 28319938, "link": "https://stackoverflow.com/questions/28319938/how-do-i-replace-two-attribute-values-in-a-selected-xml-file/28322899#28322899", "title": "How do I replace two attribute values in a selected xml file?", "body": "<p>You need to add a reference to the <strong>Microsoft XML</strong> library to work with the XML DomDocument.</p>\n\n<p><img src=\"https://i.stack.imgur.com/IADwi.png\" alt=\"VBA Project References\"></p>\n\n<p>Using this library, you will need to take the following steps.</p>\n\n<ol>\n<li>Load the document. (I've loaded it from a file, you can also load it from a string with the <code>LoadXML</code> method.)</li>\n<li>Get the list of elements named \"CellConfiguration\".</li>\n<li>For each CellConfiguration loop through the attributes of the node.</li>\n<li>Check the attribute name to see if/what it's value should be updated to and then update it appropriately.</li>\n<li>Save the document.</li>\n</ol>\n\n<p>Here's what I came up with.</p>\n\n<pre><code>Public Sub test()\n\n    Dim doc As New DOMDocument\n    Const filePath As String = \"C:\\Users\\x1ucjk2\\Documents\\test.xml\"\n    Dim isLoaded As Boolean\n\n    isLoaded = doc.Load(filePath)\n\n    If isLoaded Then\n        Dim CellConfigurationList As MSXML2.IXMLDOMNodeList\n        Set CellConfigurationList = doc.getElementsByTagName(\"CellConfiguration\")\n\n        Dim attr As MSXML2.IXMLDOMAttribute\n        Dim node As MSXML2.IXMLDOMElement\n        For Each node In CellConfigurationList\n            For Each attr In node.Attributes\n                If attr.Name = \"CellName\" Then\n                    attr.Value = \"Test\"\n                ElseIf attr.Name = \"PartName\" Then\n                    attr.Value = \"AuxCell\"\n                End If\n            Next attr\n        Next node\n\n        doc.Save filePath\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4528243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0da13429fcc334fea51c1f153757075b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike the new guy", "link": "https://stackoverflow.com/users/4528243/mike-the-new-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423057372, "creation_date": 1423048379, "last_edit_date": 1423057372, "question_id": 28319938, "link": "https://stackoverflow.com/questions/28319938/how-do-i-replace-two-attribute-values-in-a-selected-xml-file", "title": "How do I replace two attribute values in a selected xml file?", "body": "<p>I need to replace the values of \"XXXXXX\" and \"YYYY\". The replacements in quotes will always be the same. But the original values in the quotes will always be different. I'm very new to coding so any help would be appreciated.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;CellProgram&gt;\n  &lt;CellConfiguration CellName=\"XXXXXX\" PartName=\"YYYYY\"&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4528195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7fc66b825c2dae3796cd21e485fe627?s=128&d=identicon&r=PG&f=1", "display_name": "vighurt", "link": "https://stackoverflow.com/users/4528195/vighurt"}, "edited": false, "score": 0, "creation_date": 1423205779, "post_id": 28319488, "comment_id": 45062972, "body": "Thanks for your answer. I&#39;ve tested your suggestions, unfortunately I get the same error. This original line works: Selection.AutoFill Destination:=Range(&quot;BT119:BT&quot; &amp; lastRow), Type:=xlFillDefault,    I&#39;m trying to make the program more dynamic by replacing &quot;119&quot; with &quot;HighPeriod&quot;. &quot;119&quot; is used at a lot of places in the program. Any more ideas? Best regards, Daniel"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 91, "user_id": 4528195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7fc66b825c2dae3796cd21e485fe627?s=128&d=identicon&r=PG&f=1", "display_name": "vighurt", "link": "https://stackoverflow.com/users/4528195/vighurt"}, "edited": false, "score": 0, "creation_date": 1423207827, "post_id": 28319488, "comment_id": 45063796, "body": "@vighurt if the code works with 119, then you have just fixed the problem of syntax I told you and highlighted a new one. We cannot help you if you dont show us <i>how</i> you define the variable HighPeriod"}, {"owner": {"reputation": 91, "user_id": 4528195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7fc66b825c2dae3796cd21e485fe627?s=128&d=identicon&r=PG&f=1", "display_name": "vighurt", "link": "https://stackoverflow.com/users/4528195/vighurt"}, "edited": false, "score": 0, "creation_date": 1423207999, "post_id": 28319488, "comment_id": 45063850, "body": "It&#39;s solved! Had to add HighPeriod+1. Thanks again and have a great weekend! /Daniel"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 2, "last_activity_date": 1423047092, "creation_date": 1423047092, "answer_id": 28319488, "question_id": 28319394, "link": "https://stackoverflow.com/questions/28319394/vba-method-range-of-object-global-failed/28319488#28319488", "title": "VBA - Method &#39;Range&#39; of object &#39;_Global&#39; failed", "body": "<p>It seems there's a typo in your code, you might want to test with: </p>\n\n<pre><code>Selection.AutoFill Destination:=Range(\"BT\" &amp; HighPeriod &amp; \":BT\" &amp; lastRow), Type:=xlFillDefault\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Selection.AutoFill Destination:=Range(\"BT\" &amp; HighPeriod, \"BT\" &amp; lastRow), Type:=xlFillDefault\n</code></pre>\n\n<p>if you're sure about the rest.</p>\n"}], "owner": {"reputation": 91, "user_id": 4528195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7fc66b825c2dae3796cd21e485fe627?s=128&d=identicon&r=PG&f=1", "display_name": "vighurt", "link": "https://stackoverflow.com/users/4528195/vighurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 28319488, "answer_count": 1, "score": 0, "last_activity_date": 1423050470, "creation_date": 1423046787, "last_edit_date": 1423050470, "question_id": 28319394, "link": "https://stackoverflow.com/questions/28319394/vba-method-range-of-object-global-failed", "title": "VBA - Method &#39;Range&#39; of object &#39;_Global&#39; failed", "body": "<p>I get that error on this line</p>\n\n<pre><code>Selection.AutoFill Destination:=Range(\"BT &amp; HighPeriod, :BT\" &amp; lastRow), _\n    Type:=xlFillDefault\n</code></pre>\n\n<p><code>HighPeriod</code> is an integer. Is it possible to use integers in both values of the Range. </p>\n"}, {"tags": ["vba", "excel", "interface", "com", "late-binding"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1423049532, "post_id": 28318263, "comment_id": 44988971, "body": "Why can&#39;t you just declare it as <code>Object</code>?"}, {"owner": {"reputation": 515, "user_id": 3186058, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0a050acdc4b75010ee6578c8b885c1f1?s=128&d=identicon&r=PG&f=1", "display_name": "hend", "link": "https://stackoverflow.com/users/3186058/hend"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1423061398, "post_id": 28318263, "comment_id": 44996276, "body": "It doesn&#39;t work if I declare as object. When I do this: Set IPICalc = srv, it get the &quot;IPICalculation&quot; from the srv object. If I declare IPICalc as object, it doesn&#39;t do that."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423063734, "post_id": 28318263, "comment_id": 44997847, "body": "@hend What does it do instead?"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1423063819, "post_id": 28318263, "comment_id": 44997913, "body": "does dimming it as a Variant work?  Or leaving off the &quot;As ....&quot; all together?"}, {"owner": {"reputation": 515, "user_id": 3186058, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0a050acdc4b75010ee6578c8b885c1f1?s=128&d=identicon&r=PG&f=1", "display_name": "hend", "link": "https://stackoverflow.com/users/3186058/hend"}, "edited": false, "score": 0, "creation_date": 1423066003, "post_id": 28318263, "comment_id": 44999421, "body": "sous2817 it doesn&#39;t work either. GSerg: it doesn&#39;t work. It gives an error saying &quot;The object can perform that action&quot; or something like this. It&#39;s because without declaring IPICalc as IPICalculation type, it doesn&#39;t get the IPICalculation interface from the Server object as it should do to make the method ExpressionSummaries to work."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423066526, "post_id": 28318263, "comment_id": 44999787, "body": "So you have a peculiar COM object that does not expose a correct interface by default and will throw upon trying to call a method from that interface, but will satisfy an explicit <code>QueryInterface</code> call and return the correct interface? What is the exact error message?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1423067277, "post_id": 28318263, "comment_id": 45000349, "body": "If that is actually the case: do add a reference in the project. If for some reason you don&#39;t want to reference the actual type library, <a href=\"http://stackoverflow.com/a/5196051/11683\">compile</a> a tiny tlb file yourself, with just <code>IPICalculation</code> interface (you have to look up its IID for that), simply deriving it from <code>IDispatch</code> without providing any methods, then reference that tlb from Excel."}, {"owner": {"reputation": 515, "user_id": 3186058, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0a050acdc4b75010ee6578c8b885c1f1?s=128&d=identicon&r=PG&f=1", "display_name": "hend", "link": "https://stackoverflow.com/users/3186058/hend"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423068917, "post_id": 28318263, "comment_id": 45001556, "body": "@GSerg, if I declare IPIcalc as object, the error is &quot;Error 438 - Object doesn&#39;t accept this property or method&quot; (sorry, it&#39;s something like this. my office is in portuguese)  And you were right at your previous comment. That&#39;s exactly what happens. And your suggestion sounds good, but I have no idea how to do this."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1423069751, "post_id": 28318263, "comment_id": 45002100, "body": "<a href=\"http://stackoverflow.com/a/28237063/11683\">Use <code>TypeLib</code></a> to look up the Interface ID of <code>IPICalculation</code>, then refer to a MIDL manual or to <a href=\"http://stackoverflow.com/q/5195605/11683\">examples</a> to create the library, then compile it with a MIDL compiler. Alternatively download <a href=\"http://www.mvps.org/emorcillo/en/code/vb6/index.shtml\" rel=\"nofollow noreferrer\">Edanmo&#39;s olelib.tlb</a>, reference that, declare the variable as <code>IUnknown</code> and explicitly call <code>QueryInterface</code> with the correct Interface ID. Why don&#39;t you want to refer to the correct tlb in the first place?"}, {"owner": {"reputation": 515, "user_id": 3186058, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0a050acdc4b75010ee6578c8b885c1f1?s=128&d=identicon&r=PG&f=1", "display_name": "hend", "link": "https://stackoverflow.com/users/3186058/hend"}, "edited": false, "score": 0, "creation_date": 1423070195, "post_id": 28318263, "comment_id": 45002404, "body": "First, I don&#39;t want to add a reference to the project. Because I have crazy users and they do the craziest things with my file, including remove my references.  Also, there are users with many, many differente versios of this reference. If I add one reference and the users has other, it won&#39;t work. If I use latebinding, since the SDK works the same way even in different versions, it will work."}, {"owner": {"reputation": 515, "user_id": 3186058, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0a050acdc4b75010ee6578c8b885c1f1?s=128&d=identicon&r=PG&f=1", "display_name": "hend", "link": "https://stackoverflow.com/users/3186058/hend"}, "edited": false, "score": 0, "creation_date": 1423070238, "post_id": 28318263, "comment_id": 45002432, "body": "Also, I need to paste this function in a VBS file and run it alone. And I noticed that if I write the code using late binding in Excel VBA, I just need to copy and paste it to a .vbs file and it will work. I don&#39;t know if there is a different way I could make it work in .vbs files."}, {"owner": {"reputation": 360, "user_id": 3659875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98f099cfc2bd6caa05978347c4f9c0d?s=128&d=identicon&r=PG", "display_name": "Madgui", "link": "https://stackoverflow.com/users/3659875/madgui"}, "edited": false, "score": 0, "creation_date": 1552993292, "post_id": 28318263, "comment_id": 97211531, "body": "Could it be possible for you to call powershell scripts instead ? Osisoft has a lot of cmdlet in ps, and you coul call .net objects also !"}], "owner": {"reputation": 515, "user_id": 3186058, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0a050acdc4b75010ee6578c8b885c1f1?s=128&d=identicon&r=PG&f=1", "display_name": "hend", "link": "https://stackoverflow.com/users/3186058/hend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1423063404, "creation_date": 1423043420, "last_edit_date": 1423063404, "question_id": 28318263, "link": "https://stackoverflow.com/questions/28318263/vba-interface-casting", "title": "VBA Interface Casting", "body": "<p>I have the following code (using Osisoft PI SDK), which works.</p>\n\n<pre><code>Dim myPISDK As Object\nDim srv As Object\nDim pn As Object\nDim IPICalc As IPICalculation\n\nSet myPISDK = CreateObject(\"PISDK.PISDK\")\nSet pn = CreateObject(\"PISDKCommon.NamedValues\")\n\nSet srv = myPISDK.Servers.Item(\"myPIServer\")\nSet IPICalc = srv\n\nSet pn = IPICalc.ExpressionSummaries(dtI, dtF, \"\", TAG, 0, 0, 0, sample)\n</code></pre>\n\n<p>Did you noticed I am using late binding for everything (declare as object and use createObject to instanciate it) except for \"IPICalc\"?</p>\n\n<p>That's what I need to do and I don't know how. I need to use late binding for <code>IPICalc</code> to.<br>\n<code>IPICalculation</code> is an interface from the Server object, which I get in the <code>srv</code> variable.  </p>\n\n<p>It doesn't work if I declare as <code>object</code>. When I do this: <code>Set IPICalc = srv</code>, it get the <code>IPICalculation</code> from the <code>srv</code> object. If I declare <code>IPICalc as object</code>, it doesn't do that.</p>\n\n<p>Does anyone know if there is a way I can do this in VBA?<br>\nAmong other things, I need to make it work without adding references to the VBA Project, so I need to do late binding, otherwise there will be errors since Excel won't know what is <code>IPICalculation</code> to declare it.</p>\n"}, {"tags": ["vba", "registry"], "owner": {"reputation": 912, "user_id": 3567877, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6be82f196ca86106eef2080a26f07f12?s=128&d=identicon&r=PG&f=1", "display_name": "Zer0", "link": "https://stackoverflow.com/users/3567877/zer0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423041982, "creation_date": 1423040827, "question_id": 28317390, "link": "https://stackoverflow.com/questions/28317390/changing-registry-value", "title": "Changing Registry Value", "body": "<p>I'm trying to use VBA to create a .vbs script which changes a registry value in the Windows Registry Editor. I'm trying to change the <strong>(Default)</strong> value which is a <strong>REG_EXPAND_SZ</strong> in the Key:</p>\n\n<p><code>HKEY_CLASSES_ROOT\\txtfile\\shell\\open\\command</code></p>\n\n<p>The code to change is currently:</p>\n\n<pre><code>Const HKEY_CLASSES_ROOT = &amp;H80000000\n\nstrComputer = \".\"\n\nSet objRegistry = GetObject(\"winmgmts:\\\\\" &amp; strComputer &amp; \"\\root\\default:StdRegProv\")\n\nstrKeyPath = \"txtfile\\shell\\open\\command\"\nstrValueName = \"\"\nstrValue = \"Test Value\"\n\nobjRegistry.SetStringValue HKEY_CLASSES_ROOT, strKeyPath, strValueName, strValue\n</code></pre>\n\n<p>The problem is that it doesn't work when I use the <code>HKEY_CLASSES_ROOT</code> key. I've tested this exact code when changing a value in the <code>HKEY_LOCAL_MACHINE</code>. What I think is that there needs to be security or permissions added to the script in order to change a value it the <code>HKEY_CLASSES_ROOT</code> key. </p>\n\n<p>What do I have to do to make this work?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": false, "score": 1, "last_activity_date": 1423041194, "creation_date": 1423041194, "answer_id": 28317499, "question_id": 28317110, "link": "https://stackoverflow.com/questions/28317110/cells-is-not-null-but-it-shows-null/28317499#28317499", "title": "Cells is not null but it shows null", "body": "<p>That is because you cannot call <code>.Text</code> on a range containing multiple cells. You will need to iterate through the range cells first to continune processing them one at a time.</p>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 1, "last_activity_date": 1423041198, "creation_date": 1423041198, "answer_id": 28317502, "question_id": 28317110, "link": "https://stackoverflow.com/questions/28317110/cells-is-not-null-but-it-shows-null/28317502#28317502", "title": "Cells is not null but it shows null", "body": "<p>You need a loop for all cells in the range, so the code should look like that:</p>\n\n<pre><code>Sub Test1()\nDim rng As Range\nDim strString$, x&amp;\nstrString = Range(\"B1\").Value\nFor Each rng In Range(\"A2:A3\")\n    rng.Font.ColorIndex = 1\n    For x = 1 To Len(rng.Text) - Len(strString) Step 1\n       If Mid(rng.Text, x, Len(strString)) = strString Then rng.Characters(x, Len(strString)).Font.ColorIndex = 5\n    Next x\nNext rng\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3627, "user_id": 1939166, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6dc994091bdd8ca14a711ce2a5b9c5a3?s=128&d=identicon&r=PG", "display_name": "aceminer", "link": "https://stackoverflow.com/users/1939166/aceminer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 28317502, "answer_count": 2, "score": 0, "last_activity_date": 1423042144, "creation_date": 1423039907, "last_edit_date": 1423042144, "question_id": 28317110, "link": "https://stackoverflow.com/questions/28317110/cells-is-not-null-but-it-shows-null", "title": "Cells is not null but it shows null", "body": "<p>I have some code which i took from online and it works. However, there is some issue when i tried to increase the range</p>\n\n<p>This code works</p>\n\n<pre><code>Sub Test1()\n    Dim strString$, x&amp;\n    strString = Range(\"B1\").Value\n\n    With Range(\"A1\")\n        .Font.ColorIndex = 1\n        For x = 1 To Len(.Text) - Len(strString) Step 1\n            If Mid(.Text, x, Len(strString)) = strString Then .Characters(x, Len(strString)).Font.ColorIndex = 5\n        Next x\n    End With\nEnd Sub\n</code></pre>\n\n<p>This doesnt</p>\n\n<pre><code>Sub Test1()\n    Dim strString$, x&amp;\n    strString = Range(\"B1\").Value\n\n    **With Range(\"A1:A2\")**\n        .Font.ColorIndex = 1\n        **For x = 1 To Len(.Text) - Len(strString) Step 1**\n            If Mid(.Text, x, Len(strString)) = strString Then .Characters(x, Len(strString)).Font.ColorIndex = 5\n        Next x\n    End With\nEnd Sub\n</code></pre>\n\n<p>I am sure that my cell A1 and A2 is not null. However, when i did it ran it in debug mode, it shows that Len(.Text) is null. However, when i tried to do it in this way it works</p>\n\n<p>This works too </p>\n\n<pre><code>Sub Test1()\n    Dim strString$, x&amp;\n    strString = Range(\"B1\").Value\n\n    With Range(\"A2\")\n        .Font.ColorIndex = 1\n        For x = 1 To Len(.Text) - Len(strString) Step 1\n            If Mid(.Text, x, Len(strString)) = strString Then .Characters(x, Len(strString)).Font.ColorIndex = 5\n        Next x\n    End With\nEnd Sub\n</code></pre>\n\n<p>Based on the debugger the error lies in this code</p>\n\n<pre><code>Len(.Text) which is null\n</code></pre>\n"}, {"tags": ["vba", "excel", "compare"], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "edited": false, "score": 0, "creation_date": 1423038891, "post_id": 28316202, "comment_id": 44982626, "body": "Thanks Dane. It still shows an error &quot;Invalid Procedure call or argument&quot; Manual Step through Stops at &quot;Set r2 = i.Cells(&quot;I&quot; &amp; j).Value&quot; Step and gave this error."}], "tags": [], "owner": {"reputation": 734, "user_id": 4072870, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0ac60c8dfccd524dec0324413af2b6f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dane I", "link": "https://stackoverflow.com/users/4072870/dane-i"}, "is_accepted": false, "score": 0, "last_activity_date": 1423036479, "creation_date": 1423036479, "answer_id": 28316202, "question_id": 28316086, "link": "https://stackoverflow.com/questions/28316086/macro-to-copy-range-and-paste-based-on-cell-value/28316202#28316202", "title": "Macro to Copy Range and Paste Based on Cell Value", "body": "<p>You didn't dimension all your variables. Let me know if it doesn't fix your error:</p>\n\n<pre><code>Sub Reconcile()\n\nDim i as Worksheet\nDim e As Worksheet\nDim r1 As Range\nDim r2 As Variant\nDim j As Integer\n\nSet i = Sheets(\"Data\")\nSet e = Sheets(\"Final\")\n\nj = 2\nSet r1 = i.Range(Cells(j, 1), Cells(j, 5))\nSet r2 = i.Cells(\"I\" &amp; j).Value\n\nDo Until IsEmpty(i.Range(\"A\" &amp; j))\n    r1.Select\n    Selection.Copy\n    e.Range(r2).Select\n    Selection.Paste\n    j = j + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "edited": false, "score": 0, "creation_date": 1423045385, "post_id": 28317178, "comment_id": 44986572, "body": "Is there a way to avoid Loop function and make it faster as I had 18000 rows and it took around 1hr to process all the records."}, {"owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "edited": false, "score": 0, "creation_date": 1423116558, "post_id": 28317178, "comment_id": 45020312, "body": "That helped a lot. Thanks."}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": true, "score": 0, "last_activity_date": 1423051982, "last_edit_date": 1423051982, "creation_date": 1423040126, "answer_id": 28317178, "question_id": 28316086, "link": "https://stackoverflow.com/questions/28316086/macro-to-copy-range-and-paste-based-on-cell-value/28317178#28317178", "title": "Macro to Copy Range and Paste Based on Cell Value", "body": "<p>Try the following code (in the sample sheet and in the description the target is in <code>H</code> column, not <code>I</code> as in sample VBA)   </p>\n\n<pre><code>Sub Reconcile()\n\nSet i = Sheets(\"Data\")\nSet e = Sheets(\"Final\")\n\nDim r1 As Range\nDim r2 As Range\nDim j As Integer\nj = 2\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nDo Until IsEmpty(i.Range(\"A\" &amp; j))\n    Set r1 = i.Range(Cells(j, 1), Cells(j, 5))\n    Set r2 = e.Range(i.Range(\"H\" &amp; j).Value)\n    r2.Resize(1, 5).Value = r1.Value\n    j = j + 1\nLoop\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I don't think you can achieve that without a loop, but I have edited the code to:</p>\n\n<ul>\n<li>disable screen updates</li>\n<li>disable events</li>\n<li>disable formula calculation</li>\n<li>assign range values instead of copy/paste</li>\n</ul>\n\n<p>On my computer test with 18000 rows finished in less than 3 seconds.</p>\n"}], "owner": {"reputation": 299, "user_id": 4527488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wn23p.png?s=128&g=1", "display_name": "Vipul Karkar", "link": "https://stackoverflow.com/users/4527488/vipul-karkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9190, "favorite_count": 0, "accepted_answer_id": 28317178, "answer_count": 2, "score": 0, "last_activity_date": 1423103747, "creation_date": 1423036035, "last_edit_date": 1423103747, "question_id": 28316086, "link": "https://stackoverflow.com/questions/28316086/macro-to-copy-range-and-paste-based-on-cell-value", "title": "Macro to Copy Range and Paste Based on Cell Value", "body": "<p>I had created a macro to copy the data and paste into another sheet.</p>\n\n<p>The cell reference where the data needs to be pasted is in the last column of table.</p>\n\n<p>Range A2:E2 needs to be copied and paste at \"A2\" (mentioned in \"H2\")</p>\n\n<p>The below code constantly gives and error \"Object Required\"</p>\n\n<p><a href=\"https://docs.google.com/spreadsheets/d/1d3UcnRCkHjpRXiyxYQ4mENFnrdX1F-nYESd64oqaWuk/edit?usp=sharing\" rel=\"nofollow\">Google Doc Version of the Worksheet</a></p>\n\n<hr>\n\n<pre><code>Sub Reconcile()\n\nSet i = Sheets(\"Data\")\nSet e = Sheets(\"Final\")\n\nDim r1 As Range\nDim r2 As Variant\nDim j\nj = 2\nSet r1 = i.Range(Cells(j, 1), Cells(j, 5))\nSet r2 = i.Cells(\"I\" &amp; j).Value\n\nDo Until IsEmpty(i.Range(\"A\" &amp; j))\n    r1.Select\n    Selection.Copy\n    e.Range(r2).Select\n    Selection.Paste\n    j = j + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1423043953, "last_edit_date": 1423043953, "creation_date": 1423035823, "answer_id": 28316019, "question_id": 28315800, "link": "https://stackoverflow.com/questions/28315800/passing-textbox-value-between-two-userforms/28316019#28316019", "title": "Passing TextBox value between two UserForms", "body": "<p>You can declare a public variable:</p>\n\n<p>i.e <code>X</code>. In user form 1 <code>x=textbox1.value</code> and in user form2 <code>textbox2.value=X</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 1, "last_activity_date": 1423035845, "creation_date": 1423035845, "answer_id": 28316033, "question_id": 28315800, "link": "https://stackoverflow.com/questions/28315800/passing-textbox-value-between-two-userforms/28316033#28316033", "title": "Passing TextBox value between two UserForms", "body": "<p>Assuming that your forms are named:</p>\n\n<ul>\n<li><code>Userform1</code> for this first form</li>\n<li><code>Userform2</code> for the second form</li>\n</ul>\n\n<p>And assuming that you have two textboxes one in each form as follow:</p>\n\n<ul>\n<li><code>TextBox1</code> for the first textbox located in your first form</li>\n<li><code>TextBox2</code> for the second textbox located in the second form</li>\n</ul>\n\n<p>You assign the value of the first <code>TextBox1</code> to <code>TextBox2</code> using <code>Userform2.TextBox2.Text=Userform1.TextBox1.Text</code></p>\n"}], "owner": {"reputation": 17, "user_id": 4493486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/96cadf3fa1e5e1126ef5c7b91a2ecbd9?s=128&d=identicon&r=PG&f=1", "display_name": "Reeve", "link": "https://stackoverflow.com/users/4493486/reeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7089, "favorite_count": 0, "accepted_answer_id": 28316033, "answer_count": 2, "score": 0, "last_activity_date": 1423043953, "creation_date": 1423034976, "last_edit_date": 1423043843, "question_id": 28315800, "link": "https://stackoverflow.com/questions/28315800/passing-textbox-value-between-two-userforms", "title": "Passing TextBox value between two UserForms", "body": "<p>I have two user forms in Excel VBA. I enter a value in the <code>TextBox</code> at the first <code>UserForm</code>. How do I pass the value to the second <code>UserForm</code> to display same value in a <code>TextBox</code> too?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423038190, "post_id": 28316255, "comment_id": 44982233, "body": "Unfortunately this gives me a runtime error &#39;1004&#39; on this line:  <code>.AddComment Cell.Offset(20, 0).Value</code>  I&#39;m not sure if it&#39;s possible to put the values directly into the comments like this... thanks for helping me out here!"}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423041778, "post_id": 28316255, "comment_id": 44984308, "body": "sorry obviously I&#39;m just too dumb for this^^ it doesn&#39;t work though I do have the code in the right sheet, could you post your entire code? thanks man..."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423042358, "post_id": 28316255, "comment_id": 44984651, "body": "Do you have any empty cells in <code>range(&quot;A21:F40&quot;)</code>?"}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423044508, "post_id": 28316255, "comment_id": 44986038, "body": "I don&#39;t have any empty cells in <code>range(&quot;A21:F40&quot;)</code>... It still doesn&#39;t work, even if I copy your exact code Plus I need it as a private sub since the comments should automatically change when the values in A21:F40 change!  Sorry if my questions are totally dumb^^"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423044569, "post_id": 28316255, "comment_id": 44986082, "body": "Do you have any merged cells?"}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423044872, "post_id": 28316255, "comment_id": 44986264, "body": "No, no merged cells anywhere on the sheet, also tried it with a new empty sheet, doesn&#39;t work either!"}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423045586, "post_id": 28316255, "comment_id": 44986708, "body": "Okay I got it now! The cells were filled with numbers instead of formulas!  thanks a lot for all your help!"}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423046956, "post_id": 28316255, "comment_id": 44987525, "body": "One more question: Is it possible to refer to a range of cells on another worksheet? F.e. show values of  &quot;Table 1&quot;A1:F20 in the comments of &quot;Table2&quot;A21:F40? I guess in this case the <code>cell.offset</code> function wouldn&#39;t be an option anymore, right?"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423047165, "post_id": 28316255, "comment_id": 44987656, "body": "Yes. It is possible to refer to a range of cells on another worksheet. Use <code>Worksheets(&quot;Name_of_the_worksheet&quot;).Range(&quot;Your_Range_Here&quot;)</code>&zwnj;&#8203;."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423048199, "post_id": 28316255, "comment_id": 44988246, "body": "<code>Offset</code> is a property of the <code>Range</code> class. It means that whenever you have a valid range, the offset property will be available for use. In your case, I figured that was an offset between the range of cells that contain the comments and the range to be commented. If you&#39;re going to tell VBA to grab comments from another sheet, the logic will change because the offset property was directly linked to the <code>For Each</code> counter as it hoops from cell to cell and copies comments. You have to make an loop that advances your another sheet range values with the <code>For Each</code> accordingly."}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423048387, "post_id": 28316255, "comment_id": 44988356, "body": "Okay thanks a lot! This is what I meant, I will try to set up the loop!"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423051637, "post_id": 28316255, "comment_id": 44990096, "body": "I would advise you to store the comments range in a variant type and then loop from its content from 0 to its upper bound. Let me know if I can help you with that."}, {"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423055324, "post_id": 28316255, "comment_id": 44992229, "body": "Thanks I already solved the problem by adapting the code @PommesKlaus posted before! I posted my final code as an answer to my question if you&#39;re interested!  Thanks for all your help!"}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 1, "last_activity_date": 1423042769, "last_edit_date": 1423042769, "creation_date": 1423036728, "answer_id": 28316255, "question_id": 28315709, "link": "https://stackoverflow.com/questions/28315709/create-comments-to-a-range-of-cells-ftom-the-values-of-another-range-of-cells/28316255#28316255", "title": "Create comments to a range of cells ftom the values of another range of cells", "body": "<p>It should do you the job if you replace</p>\n\n<pre><code>With Range(\"I6\")\n        .ClearComments\n        .AddComment\n        .Comment.Text Text:=sResult\n    End With\n</code></pre>\n\n<p>with</p>\n\n<pre><code>    For Each cell In Range(\"A1\", \"F20\").Cells\n    Dim V As Range\n    Set V = cell.Offset(20, 0)\n    With cell\n    .ClearComments\n    If Not IsEmpty(V) Then\n    .AddComment V.Value\n    End If\n    End With\n   Next\n</code></pre>\n\n<p>This will basically ignore all empty cells.</p>\n\n<p>Output:</p>\n\n<p><img src=\"https://i.stack.imgur.com/WWPYa.png\" alt=\"enter image description here\"></p>\n\n<p>My code:</p>\n\n<pre><code>Sub TEST()\n For Each cell In Range(\"A1\", \"F20\").Cells\n    Dim V As Range\n    Set V = cell.Offset(20, 0)\n    With cell\n    .ClearComments\n    If Not IsEmpty(V) Then\n    .AddComment V.Value\n    End If\n    End With\n   Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "edited": false, "score": 0, "creation_date": 1423040353, "post_id": 28316806, "comment_id": 44983431, "body": "That&#39;s almost what I want, but I don&#39;t want to need to select the ranges of cells, I want it to happen automatically with specific ranges of cells. F.e. always show the values of cells A1:A5 in comments of B1:B5!"}], "tags": [], "owner": {"reputation": 1, "user_id": 4527695, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f8cff50864ef4f54bd51c8aa1b4afc74?s=128&d=identicon&r=PG", "display_name": "PommesKlaus", "link": "https://stackoverflow.com/users/4527695/pommesklaus"}, "is_accepted": false, "score": 0, "last_activity_date": 1423038785, "creation_date": 1423038785, "answer_id": 28316806, "question_id": 28315709, "link": "https://stackoverflow.com/questions/28315709/create-comments-to-a-range-of-cells-ftom-the-values-of-another-range-of-cells/28316806#28316806", "title": "Create comments to a range of cells ftom the values of another range of cells", "body": "<p>From your question I understand that you want to select a range of cells (e.g. \"A1:A5\"), then select another range of cells (e.g. \"B6:B10\") and the respective values of the first selected Range should be placed as comments in the secon selected Range. Is this correct?</p>\n\n<p>The following code checks if 2 ranges with an equal length are selected and copies the values of the first selected range as comments to the second selected range:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal target As Range)\n\nIf InStr(target.Address, \",\") Then\n    Dim selected_range() As String\n    selected_range = Split(target.Address, \",\")\n\n    If Range(selected_range(0)).Rows.Count = Range(selected_range(1)).Rows.Count Then\n        Dim src As Range: Set src = Range(selected_range(0))\n        Dim tar As Range: Set tar = Range(selected_range(1))\n\n        For i = 0 To src.Rows.Count - 1\n            Dim sResult As String\n            sResult = \"Maximal \" &amp; Cells(src.Row + i, src.Column)\n            With Cells(tar.Row + i, tar.Column)\n                .ClearComments\n                .AddComment\n                .Comment.Text Text:=sResult\n            End With\n        Next i\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "is_accepted": false, "score": 1, "last_activity_date": 1423055446, "creation_date": 1423055446, "answer_id": 28322294, "question_id": 28315709, "link": "https://stackoverflow.com/questions/28315709/create-comments-to-a-range-of-cells-ftom-the-values-of-another-range-of-cells/28322294#28322294", "title": "Create comments to a range of cells ftom the values of another range of cells", "body": "<p>I made some adaptions to your advices, thanks a lot, this solved my problem:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n\n\nDim src As Range: Set src = Worksheets(\"maxleft\").Range(\"C2:K11\")\nDim tar As Range: Set tar = Range(\"I6:Q15\")\n\n    For i = 0 To tar.Rows.Count - 1\n        For j = 0 To tar.Columns.Count - 1\n        Dim sResult As String\n        sResult = \"Maximal \" &amp; Worksheets(\"maxleft\").Cells(src.Row + i, src.Column + j)\n        With Cells(tar.Row + i, tar.Column + j)\n            .ClearComments\n            .AddComment\n            .Comment.Text Text:=sResult\n        End With\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4527429, "user_type": "registered", "profile_image": "https://graph.facebook.com/868815409807640/picture?type=large", "display_name": "Philip Gruber", "link": "https://stackoverflow.com/users/4527429/philip-gruber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17236, "favorite_count": 2, "accepted_answer_id": 28316255, "answer_count": 3, "score": 2, "last_activity_date": 1576449271, "creation_date": 1423034636, "last_edit_date": 1576449271, "question_id": 28315709, "link": "https://stackoverflow.com/questions/28315709/create-comments-to-a-range-of-cells-ftom-the-values-of-another-range-of-cells", "title": "Create comments to a range of cells ftom the values of another range of cells", "body": "<p>I want to create comments to a range of cells. The comments should contain the values of another range of cells.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim sResult As String\n\nIf Union(Target, Range(\"A18\")).Address = Target.Address Then\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    sResult = \"Maximal \" &amp; Target.Value\n\n    With Range(\"I6\")\n        .ClearComments\n        .AddComment\n        .Comment.Text Text:=sResult\n    End With\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This works for one cell. I need this for a range of cells. For example, let's say I need the values of cells A1:F20 in comments of cells A21:F40. I do not want to copy the same Sub as many times.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423043245, "post_id": 28315643, "comment_id": 44985207, "body": "inspect first your range names in <i>menu &gt;&gt; formulas &gt;&gt; Name manager</i>"}, {"owner": {"reputation": 15, "user_id": 2775606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3e7f972da1f935a809bc2067c256bb3?s=128&d=identicon&r=PG&f=1", "display_name": "user2775606", "link": "https://stackoverflow.com/users/2775606/user2775606"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423049949, "post_id": 28315643, "comment_id": 44989183, "body": "it is not listed out there. Infact the Name manager is empty"}, {"owner": {"reputation": 1936, "user_id": 2474149, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6ec6e9e714905b4aa40e2a762a3efa0c?s=128&d=identicon&r=PG", "display_name": "barryleajo", "link": "https://stackoverflow.com/users/2474149/barryleajo"}, "edited": false, "score": 0, "creation_date": 1423049973, "post_id": 28315643, "comment_id": 44989193, "body": "Are you generating the Names programmatically and if so please post this code (by editing your answer?)"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1423050356, "post_id": 28315643, "comment_id": 44989377, "body": "search in Google for <code>_xlfn</code> as this is a special restricted type of prefix added by Excel in some situation."}, {"owner": {"reputation": 15, "user_id": 2775606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3e7f972da1f935a809bc2067c256bb3?s=128&d=identicon&r=PG&f=1", "display_name": "user2775606", "link": "https://stackoverflow.com/users/2775606/user2775606"}, "edited": false, "score": 0, "creation_date": 1423222382, "post_id": 28315643, "comment_id": 45070971, "body": "I read in some forums that _xlfn is added as a marker when a 2010 workbook is saved in a 97-03 format for any formulas containing functions which where supported only in 2010. But I was not able to figure out why a range name(_xlfn.STDEV.P) is created even though I am saving the sheet in 2010 format"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 2775606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3e7f972da1f935a809bc2067c256bb3?s=128&d=identicon&r=PG&f=1", "display_name": "user2775606", "link": "https://stackoverflow.com/users/2775606/user2775606"}, "is_accepted": false, "score": 0, "last_activity_date": 1445409385, "last_edit_date": 1445409385, "creation_date": 1445406799, "answer_id": 33251905, "question_id": 28315643, "link": "https://stackoverflow.com/questions/28315643/error-while-importing-a-text-file-and-deleting-the-range-name-that-start-with/33251905#33251905", "title": "Error while importing a text file and deleting the Range name that start with _", "body": "<p>Range names that start with _xlfn is created by excel, so any attempt to delete these range names will throw error. So I have avoided the deletion of range names that start with _xlfn.</p>\n\n<pre><code>For Each n In ActiveWorkbook.Names\n    If Mid$(n.Name, 1, 5) = \"_xlfn\" Then\n        continue\n    Else  \n        n.Delete\n    End If\nNext n\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 2775606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3e7f972da1f935a809bc2067c256bb3?s=128&d=identicon&r=PG&f=1", "display_name": "user2775606", "link": "https://stackoverflow.com/users/2775606/user2775606"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445409385, "creation_date": 1423034399, "last_edit_date": 1423042478, "question_id": 28315643, "link": "https://stackoverflow.com/questions/28315643/error-while-importing-a-text-file-and-deleting-the-range-name-that-start-with", "title": "Error while importing a text file and deleting the Range name that start with _", "body": "<p>I was trying to import the text file(whose content is pasted here) in excel 2010.</p>\n\n<p>Sample<br>\n<code>0.000336179308182416   0.0003623072328649  0.000330580466347818       0.000328403140930966 0.000326536860231208    0.000316583362896417    0.000331824654826285    0.000376926431150615    0.000359196764802228    0.00035110955014428 0.000340222914920751    0.00038594678488213 0.000374438054920212    0.00038719097133022 0.000356708390252258    0.000355464204180755    0.000362307232454562    0.000408031102693052    0.00042793809249897 0.000361685139135481    =AVERAGE(B2:U2) =MEDIAN(B2:U2)  =STDEV.P(B2:U2) 0.000317516503116533    0.000324670578360742    0.000343644429001611    0.00031720545739935 0.000316272316168398    0.000322182204319699    0.000319071737757159    =AVERAGE(B2:AE2)    =MEDIAN(B2:AE2) =STDEV.P(B2:AE2)</code>   </p>\n\n<p>The import worked properly. After the text file is opened in excel, I wrote the following VBA code to delete the range names that start with _.</p>\n\n<pre><code>Private Sub Workbook_Open()\n For Each n In ActiveWorkbook.Names\n  If Mid$(n.Name, 1, 1) = \"_\" Then\n    MsgBox (\"The file being deleted is \" + n.Name)\n     n.Delete\n  End If\n Next n\nEnd Sub\n</code></pre>\n\n<p>and saved the file. Now again I opened this saved xlsm file and I have the msg displayed \"The file being deleted is _xlfn.STDEV.P\". </p>\n\n<p>Even though I have an STDEV.P function specified in my text file,I dont know from where this range name has been added to the <code>ActiveWorkBook.Names</code> collection. And the subsequent delete operation is also throwing an error,as the range name is a excel funtion name. Please help me to rectify this issue. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1423067805, "post_id": 28319993, "comment_id": 45000734, "body": "(<a href=\"http://stackoverflow.com/questions/28314516/access-2007-dlookup-for-autofill-not-returning-values\" title=\"access 2007 dlookup for autofill not returning values\">stackoverflow.com/questions/28314516/&hellip;</a>)  PaulFrancis....thank you so much.  I used the code, but got an Compile Error: Expected Function or variable at &quot;Set rsObj = CurrentDb.Execute&quot; ...&quot;Execute&quot; was highlighted..."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1423067889, "post_id": 28319993, "comment_id": 45000810, "body": "Sorry @Michael, I used <code>Execute</code> where I should have use <b>OpenRecordset</b> I have edited my answer."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1423068406, "post_id": 28319993, "comment_id": 45001200, "body": "Seems his table includes a field whose name includes a space, <i>Street Address</i>.  Enclose that name in square brackets so the db engine will recognize it correctly: <code>WHERE [Street Address] = </code> Note that issue also applies to the <code>DLookup</code> approach."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423068500, "post_id": 28319993, "comment_id": 45001266, "body": "Are you saying a domain function does not &quot;clean up after itself&quot;?  What does that mean?"}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1423086484, "post_id": 28319993, "comment_id": 45011279, "body": "(<a href=\"http://stackoverflow.com/questions/28314516/access-2007-dlookup-for-autofill-not-returning-values\" title=\"access 2007 dlookup for autofill not returning values\">stackoverflow.com/questions/28314516/&hellip;</a>)  PaulFrancis...thank you for the update.    I created the Street Address as a combo box with only the street address in the lookup table.  When the volunteer enters a new record (Ctr+Shf++) the street address field &quot;highlights&quot; and reads aloud &quot;street address.&quot;  The worker can then put in the address.  (cont.)"}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1423086532, "post_id": 28319993, "comment_id": 45011306, "body": "(<a href=\"http://stackoverflow.com/questions/28314516/access-2007-dlookup-for-autofill-not-returning-values\" title=\"access 2007 dlookup for autofill not returning values\">stackoverflow.com/questions/28314516/&hellip;</a>) ...(cont)  If it matches one in the table, it will continue to read out the whole address.  When the match is audibly identified the worker hits &quot;Tab key&quot; where I want the remaining fields to auto populate.  I input the code and executed.  Got the message: &quot;no information matched.&quot;   However, the &quot;Truck_Routes&quot; table does have an exact match (record ID # 8) and all other fields (suite, city, zip, contact, phone) are filled, yet it will not populate the form..."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 0, "last_activity_date": 1423068522, "last_edit_date": 1423068522, "creation_date": 1423048512, "answer_id": 28319993, "question_id": 28314516, "link": "https://stackoverflow.com/questions/28314516/access-2007-dlookup-for-autofill-not-returning-values/28319993#28319993", "title": "Access 2007: DLookup for Autofill not returning values", "body": "<p>You have your DLookup a bit off, the square brackets are outside the quotes. Also they are supposed to be enclosed inside single quotes, as they are Text types. I have fixed them for you. </p>\n\n<pre><code>Private Sub cboAddress_AfterUpdate()\n    PopulateFields\nEnd Sub\n\nPrivate Sub PopulateFields()\n    Me.Suite = DLookup(\"Suite\", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n    Me.Company = DLookup(\"Company\", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n    Me.City = DLookup(\"City \", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n    Me.State = DLookup(\"State \", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n    Me.zip = DLookup(\"zip \", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n    Me.ContactName = DLookup(\"ContactName \", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n    Me.ContactPHone = DLookup(\"ContactPhone \", \"Truck_Routes\", \"[Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\nEnd Sub\n</code></pre>\n\n<p>On a side note, the Domain function is rather expensive piece of operation. It is a simplified SQL. So every time you use a DLookup, you are performing a READ to the table in the above example you are querying the table 7 times, in one single AfterUpdate. This could be massively reduced if you were to use a RecordSet object. </p>\n\n<p>Something like,</p>\n\n<pre><code>Private Sub cboAddress_AfterUpdate()\n    PopulateFields\nEnd Sub\n\nPrivate Sub PopulateFields()\n    Dim rsObj As DAO.Recordset\n\n    Set rsObj = CurrentDB.OpenRecordset(\"SELECT Suite, Company, City, State, zip, ContactName, ContactPhone \" &amp; _\n                                    \"FROM Truck_Routes WHERE [Street Address] = '\" &amp; Me.cboAddress &amp; \"'\")\n\n    If Not rsObj.EOF Then\n        Me.Suite = rsObj.Fields(\"Suite\")\n        Me.Company = rsObj.Fields(\"Company\")\n        Me.City = rsObj.Fields(\"City\")\n        Me.State = rsObj.Fields(\"State\")\n        Me.zip = rsObj.Fields(\"zip\")\n        Me.ContactName = rsObj.Fields(\"ContactName\")\n        Me.ContactPHone = rsObj.Fields(\"ContactPhone\")\n    Else\n        MsgBox \"No Information matched.\"\n    End If\n\n    Set rsObj = Nothing\nEnd Sub\n</code></pre>\n\n<p>There are also other advantages like,</p>\n\n<ol>\n<li>Checking if the Recordset returns more than one row using the <strong>RecordCount</strong> property of the RecordSet object.</li>\n<li>This not only reduces the hit on the Database, this code also cleans up after itself unlike a Domain function. </li>\n</ol>\n\n<p>Hope this helps !</p>\n"}], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 28319993, "answer_count": 1, "score": 1, "last_activity_date": 1594652489, "creation_date": 1423029835, "last_edit_date": 1594652489, "question_id": 28314516, "link": "https://stackoverflow.com/questions/28314516/access-2007-dlookup-for-autofill-not-returning-values", "title": "Access 2007: DLookup for Autofill not returning values", "body": "<p>Developing a database for visually impaired persons scheduling donation pickups (uses an audio reader for fields).  Have a simple table \" Truck_Routes\" with customer ID, street address, suite, company, city, state, zip, contact name, contact phone number, and several donation information fields.</p>\n\n<p>Trying to develop a form that auto fills: suite, company, city, state, zip, contact name, and contact phone number based on an existing combo box: cboAddress ....(street address).   Spent hours on the web emulating other examples, but can't get vba to work.</p>\n\n<p>Street Address - combo box with \"After_Update event procedure\"</p>\n\n<pre><code>Private Sub cboAddress_AfterUpdate()\n  PopulateFields\nEnd Sub\n\nPrivate Sub PopulateFields()\n  Me.Suite = DLookup(\"Suite\", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\n  Me.Company = DLookup(\"Company\", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\n  Me.City = DLookup(\"City \", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\n  Me.State = DLookup(\"State \", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\n  Me.zip = DLookup(\"zip \", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\n  Me.ContactName = DLookup(\"ContactName \", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\n  Me.ContactPHone = DLookup(\"ContactPhone \", \"Truck_Routes\", \"Street Address=\" &amp; Me.[cboAddress &amp; \"'\"])\nEnd Sub\n</code></pre>\n\n<p>Fields in form are navigated using \"tab\" key, audio reader reads the field.  Default value for each field is the name of the field so it could be read to the operator.  Any thoughts/recommendations?</p>\n"}, {"tags": ["excel", "vbscript", "scheduled-tasks", "mailmerge", "vba"], "owner": {"reputation": 21, "user_id": 4230995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e455d62ab4f25f7e9d91c724950e467a?s=128&d=identicon&r=PG&f=1", "display_name": "User098765", "link": "https://stackoverflow.com/users/4230995/user098765"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1423027858, "creation_date": 1423027858, "last_edit_date": 1531161705, "question_id": 28314135, "link": "https://stackoverflow.com/questions/28314135/error-running-vbs-to-mail-merge-with-task-scheduler", "title": "Error Running VBS to Mail Merge with Task Scheduler", "body": "<p>I have setup a simple VBS to open .xlsm file that has a macro to open a word doc and execute mail merge. VBS works great until I try to automate it with Task Scheduler.</p>\n\n<p>Excel macro was running with both Excel and Word instances open but it took way longer than it supposed to be with couple Excel error message :</p>\n\n<pre><code>Microsoft Excel is waiting for another application to complete an OLE action\n</code></pre>\n\n<p>And after couple of error message and long wait for word doc to go through all records, mail merge was not executed at all.</p>\n\n<p>Does anyone have similar experience with me? Any resolution/suggestion is highly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1423023224, "post_id": 28313291, "comment_id": 44976829, "body": "CHeck whether file exists at the given location."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1423023267, "post_id": 28313291, "comment_id": 44976834, "body": "It is there. I ensured that."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423024979, "post_id": 28313291, "comment_id": 44977237, "body": "I realize this is a bit editorial, but I would advise against using variable names that don&#39;t accurately represent the data being stored therein: specificially, a variable called <code>folderPath</code> should probably not be used to store the <i>file name</i>."}, {"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 1, "creation_date": 1423025287, "post_id": 28313291, "comment_id": 44977296, "body": "Use FSO object instead to identify and exclude files from delete operation."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "reply_to_user": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1423028450, "post_id": 28313291, "comment_id": 44978259, "body": "@PareshJ can show me an example."}], "answers": [{"comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1423048279, "post_id": 28313770, "comment_id": 44988300, "body": "Should also probably <code>lcase$(strFileName) like ...</code>"}], "tags": [], "owner": {"reputation": 2040, "user_id": 2264536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3e20b1d6633c60c281d0a6718f4c94?s=128&d=identicon&r=PG", "display_name": "Simon1979", "link": "https://stackoverflow.com/users/2264536/simon1979"}, "is_accepted": true, "score": 4, "last_activity_date": 1423090859, "last_edit_date": 1423090859, "creation_date": 1423025740, "answer_id": 28313770, "question_id": 28313291, "link": "https://stackoverflow.com/questions/28313291/delete-non-excel-files-in-a-folder-vba/28313770#28313770", "title": "Delete non-Excel Files in a folder VBA", "body": "<p>Using the below should do as required. Note it is better to use the <code>Like</code> operator to compare partial strings, in this case the <code>Not</code> operator seeks only those which do not match.</p>\n\n<pre><code>strFileName = Dir(\"C:\\test\\*\")\nDo While strFileName &lt;&gt; \"\"\n  If Not lcase$(strFileName) Like \"*.xls\" Then 'or .txt or .csv or whatever\n     Kill \"C:\\test\\\" &amp; strFileName\n  End If\n  strFileName = Dir\nLoop\n</code></pre>\n\n<p>Note, if you want it to ignore all Excel files then consider the alternate extensions and explicitly account for them with <code>And</code> as follows:</p>\n\n<p><code>If Not lcase$(strFileName) Like \"*.xls\" And Not lcase$(strFileName) Like \"*.xlsx\" Then</code></p>\n\n<p>Remembering .txt, .csv, .xlsm etc.</p>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 28313770, "answer_count": 1, "score": 1, "last_activity_date": 1423090859, "creation_date": 1423022577, "last_edit_date": 1423023951, "question_id": 28313291, "link": "https://stackoverflow.com/questions/28313291/delete-non-excel-files-in-a-folder-vba", "title": "Delete non-Excel Files in a folder VBA", "body": "<p>I want to delete non-Excel files in a folder using VBA.</p>\n\n<p>This is code I found from here:<a href=\"http://www.mrexcel.com/forum/excel-questions/437533-excel-delete-files-folder-visual-basic-applications.html\" rel=\"nofollow\">Excel Delete Files</a>.</p>\n\n<pre><code>Dim fName As String\nfName = Dir(\"C:\\test\\*.*\")\nDo While fName &lt;&gt; \"\"\n    If fName &lt;&gt; \"fileA.xls\" Then'or .txt or .csv or whatever\n       Kill \"C:\\test\\\" &amp; fName\n    End If\n    fName = Dir\nLoop\n</code></pre>\n\n<p>I changed the code this way:</p>\n\n<pre><code>folderPath = Dir(\"C:\\test\\\")\nDo While folderPath &lt;&gt; \"\"\n  If folderPath &lt;&gt; \"*.xls\" Then'or .txt or .csv or whatever\n     Kill \"C:\\test\\\" &amp; folderPath \n  End If\n  folderPath = Dir\nLoop\n</code></pre>\n\n<p>It is giving me an error saying the file not found. But I have a file in the folder that needs to be deleted.</p>\n\n<p>Need some guidance on this.</p>\n"}, {"tags": ["vba", "excel", "range"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4526624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dbf7d08296886eb7008b0a6a5e7d5a?s=128&d=identicon&r=PG&f=1", "display_name": "Hypocee ee", "link": "https://stackoverflow.com/users/4526624/hypocee-ee"}, "edited": false, "score": 0, "creation_date": 1423032050, "post_id": 28313456, "comment_id": 44979546, "body": "Thanks for the guidance, I trimmed it. Most questions I see on SO meet with &quot;Why didn&#39;t you try X&quot; or &quot;What happens when Y&quot;, so I tried to forestall that but I guess I went overboard.  And indeed, thanks for the answer. Dropping &quot;Set&quot; was the super-simple syntax I&#39;d overlooked on my otherwise correct methods, then subconsciously restored on my final incorrect one. The macro is now working as expected and I feel dumb but sane."}], "tags": [], "owner": {"reputation": 2040, "user_id": 2264536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3e20b1d6633c60c281d0a6718f4c94?s=128&d=identicon&r=PG", "display_name": "Simon1979", "link": "https://stackoverflow.com/users/2264536/simon1979"}, "is_accepted": true, "score": 1, "last_activity_date": 1423023767, "creation_date": 1423023767, "answer_id": 28313456, "question_id": 28313178, "link": "https://stackoverflow.com/questions/28313178/why-does-this-excel-2007-vba-program-fail-to-iterate-reassign-a-range-variable/28313456#28313456", "title": "Why does this Excel 2007 VBA program fail to iterate/reassign a Range variable?", "body": "<p>That is a lot of writing for a relatively small question, I would recommend cutting out any non-essential text in future questions; a lot of people will just see the sheer volume of text and move on.</p>\n\n<p>With respect to your issue I think a minor change would do the job:</p>\n\n<p>The examples you have commented out should work if you just add <code>Set</code> in front of them:</p>\n\n<p><code>Set CurrentClientAnchor = CurrentClientAnchor.Offset(DataHeight + 1, 0)</code></p>\n\n<p>As you have it with the line </p>\n\n<p><code>Set CurrentClientAnchor = ActiveSheet.Cells(WhatsMyAnchor + DataHeight + 1, 0)</code></p>\n\n<p>Changed to </p>\n\n<p><code>Set CurrentClientAnchor = ActiveSheet.Range(\"A\" &amp; WhatsMyAnchor + DataHeight + 1)</code></p>\n\n<p>Should also work.</p>\n"}], "owner": {"reputation": 3, "user_id": 4526624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dbf7d08296886eb7008b0a6a5e7d5a?s=128&d=identicon&r=PG&f=1", "display_name": "Hypocee ee", "link": "https://stackoverflow.com/users/4526624/hypocee-ee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 28313456, "answer_count": 1, "score": -1, "last_activity_date": 1423112984, "creation_date": 1423021727, "last_edit_date": 1423112984, "question_id": 28313178, "link": "https://stackoverflow.com/questions/28313178/why-does-this-excel-2007-vba-program-fail-to-iterate-reassign-a-range-variable", "title": "Why does this Excel 2007 VBA program fail to iterate/reassign a Range variable?", "body": "<p>Chopped down from uber-detail history mode per suggestion.</p>\n\n<p>My level of expertise: Hacked some fairly complex dialog-boxing multi-workbook macro systems ten years ago, experienced but not formally trained and rusty.</p>\n\n<p>The complicated stuff in this macro works; its central bug is that it won't change that CurrentClientAnchor Range variable, the most basic operation in Excel VBA, no matter what I do. It loops as many times as you like anchored on cell A2, correctly finding the cell that should next become CurrentClientAnchor (on the real data, A4, two cells down), and creating the invoice sheet perfectly from the selected data as long as you give it permission to overwrite the copy it just created a second ago. I won't be surprised if my special last record routine breaks something, but manually stepping through, none of that If clause ever runs. The program correctly steps over it. WhatsMyAnchor should be 4 just before the last Loop command, but never changes from 2.</p>\n\n<p>The only method I know for accomplishing what I want that doesn't have a commented fossil  left in the code is the first one I wrote, assigning a ClientsRange as Range over Range(\"A2\", Cells(LastRow,1)) and then putting everything in a For...Next loop. That version also just ran over and over on the first record. </p>\n\n<p>In what way am I being incredibly stupid, please?</p>\n\n<pre><code>Option Explicit\nSub FillOutInvoices()\n\nDim BilledDate As String\nDim ServiceYear As String\nDim ServiceMonth As String\nDim CompBasePath As String\n\nDim InvoiceTemplatePath As String\nInvoiceTemplatePath = \"H:\\Comp\\Comp Invoice BLANK PRINT COPY.xls\"\n\n\n\n\n\n'The info to change for each invoicing\n'========================\n'========================\nCompBasePath = \"H:\\Comp\\2014 Invoices\\\"\nServiceYear = \"2014\"\nServiceMonth = \"September\"\nBilledDate = \"02/01/2015\"\n'========================\n'========================\n\n\n\n\n\nDim InvoiceFolder As String\nInvoiceFolder = CompBasePath &amp; ServiceYear &amp; \" \" &amp; ServiceMonth &amp; \" generated invoices\" &amp; \"\\\"\nIf Dir(InvoiceFolder, vbDirectory) = vbNullString Then\n  MkDir InvoiceFolder\nEnd If\n'Find the last used row on the sheet with a web recipe to speed things up\n'and avoid arbitrary search windows.\nDim LastRow As Long\nLastRow = ActiveSheet.UsedRange.Rows.Count\n\n'We assume our first client is in A2\nDim CurrentClientAnchor As Range\nSet CurrentClientAnchor = Range(\"A2\")\nDim DataHeight As Single\nDim NoMoreRecords As Boolean\nNoMoreRecords = False\n\n'Debugging variable so I don't have to paw through \n'a zillion properties of CCA in the Watch pane all the time\nDim WhatsMyAnchor As Single\nWhatsMyAnchor = CurrentClientAnchor.Row\n\nDo Until NoMoreRecords = True 'Loop captures falling through the last record, internal exit catches\n  'the next result each time\n\n  'Surprisingly the main loop. For each client, find the next one or end of job,\n  'use that as an upper and lower bound to create and write the invoice\n\n  'Transplanted inline from what should be a sub, because I need it to Just Work Now.\n  'As a sub, causes Object Required error on passing the range which is a range into the range slot that's designated as a range.\n  'This should become some clever run-once array of nonempty ranges someday\n\n  'Find next nonempty A. If none before lastrow, last record; find last nonempty F, set rows, copy data, terminate macro.\n  'If found, set rows and copy data\n  DataHeight = 1\n  Do Until CurrentClientAnchor.Offset(DataHeight, 0).Value &lt;&gt; \"\"\n    'Find the next nonempty cell below CurrentClientAnchor and record the offset\n    'We're falling off the bottom of the last one, have to do our special last search up front here.\n    If CurrentClientAnchor.Offset(DataHeight, 0).Row = LastRow Then 'special finder for last record down F to first empty cell\n      NoMoreRecords = True\n      DataHeight = 1\n      Do Until CurrentClientAnchor.Offset(DataHeight, 5).Value = \"\"\n          DataHeight = DataHeight + 1\n      Loop\n      Exit Do\n    End If\n    DataHeight = DataHeight + 1\n  Loop\n\n  'We now have our DataHeight value for the grunt work.\n  'Subtract one from it, to convert to the cell offsets we'll use\n  DataHeight = DataHeight - 1\n\n  'Inlined from sub again because I apparently don't know how to pass a variable.\n  'MakeInvoiceFile\n  Dim SourceBook As Workbook\n  Set SourceBook = ThisWorkbook\n  Dim InvoiceFileName As String\n  InvoiceFileName = InvoiceFolder &amp; _\n    CurrentClientAnchor.Value &amp; \" \" &amp; ServiceYear &amp; \" \" &amp; ServiceMonth &amp; \" Invoice\" &amp; \".xls\"\n  Dim DestBook As Workbook\n  Dim Template As Workbook\n  Application.Workbooks.Open InvoiceTemplatePath\n  Set Template = ActiveWorkbook\n  Set DestBook = ActiveWorkbook\n\n  DestBook.SaveAs (InvoiceFileName)\n\n  SourceBook.Activate\n  'Close for debugging cleanliness, more elegant keep open behavior later\n  'Doesn't work. Maybe not even ugly, anyway cut for dev time.\n  'Template.Close\n\n  'More debugging watchable variables\n  Dim WhereCopyingRow As Single\n  Dim WhereCopyingColumn As Single\n\n  Dim CopyRange As Range\n  'Client name into job name\n  Set CopyRange = CurrentClientAnchor\n  WhereCopyingRow = CopyRange.Row\n  WhereCopyingColumn = CopyRange.Column\n  CopyRange.Copy\n  DestBook.Sheets(1).Cells(3, 4).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  'Service address into job location\n  Set CopyRange = CurrentClientAnchor.Offset(0, 3)\n  WhereCopyingRow = CopyRange.Row\n  WhereCopyingColumn = CopyRange.Column\n  CopyRange.Copy\n  DestBook.Sheets(1).Cells(4, 4).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  'Billing address into billing address\n  Set CopyRange = CurrentClientAnchor.Offset(0, 4)\n  WhereCopyingRow = CopyRange.Row\n  WhereCopyingColumn = CopyRange.Column\n  CopyRange.Copy\n  DestBook.Sheets(1).Cells(9, 2).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  'Billing Date into Date Billed\n  'Currently discarded for progress\n  'DestBook.Sheets(1).Cells(24, 3).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  'Descriptions\n  Set CopyRange = Range(CurrentClientAnchor.Offset(0, 5), CurrentClientAnchor.Offset(DataHeight, 5))\n  WhereCopyingRow = CopyRange.Row\n  WhereCopyingColumn = CopyRange.Column\n  CopyRange.Copy\n  DestBook.Sheets(1).Cells(13, 2).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  'Totals\n  Set CopyRange = Range(CurrentClientAnchor.Offset(0, 14), CurrentClientAnchor.Offset(DataHeight, 15))\n  WhereCopyingRow = CopyRange.Row\n  WhereCopyingColumn = CopyRange.Column\n  CopyRange.Copy\n  DestBook.Sheets(1).Cells(13, 6).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  'Overall total\n  Set CopyRange = CurrentClientAnchor.Offset(DataHeight, 16)\n  WhereCopyingRow = CopyRange.Row\n  WhereCopyingColumn = CopyRange.Column\n  CopyRange.Copy\n  DestBook.Sheets(1).Cells(24, 6).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone\n  DestBook.Save\n  DestBook.Close\n\n  'SourceBook appears to be activated when we close DestBook, but it's failing to iterate so let's make sure.\n  SourceBook.Activate\n\n  'CurrentClientAnchor = CurrentClientAnchor.Offset(DataHeight + 1, 0)\n  'WhatsMyAnchor = CurrentClientAnchor.Row\n\n  'Apparently we can't assign a range to its offset, fails to iterate, so\n  'we pop out to selection and back to the variable.\n\n  'CurrentClientAnchor.Offset(DataHeight + 1, 0).Select\n  'CurrentClientAnchor = Selection\n  'WhatsMyAnchor = CurrentClientAnchor.Row\n\n  'Nope. Escalate to activating and assigning.\n\n  'CurrentClientAnchor.Offset(DataHeight + 1, 0).Activate\n  'CurrentClientAnchor = ActiveCell\n  'WhatsMyAnchor = CurrentClientAnchor.Row\n\n  'That doesn't iterate either, it's really hard for a programming language in\n  'Excel to iterate on the most common object in Excel,\n  'so let's turn the blasted stupid debugging variable into an absolute cell selector\n\n  Set CurrentClientAnchor = ActiveSheet.Cells(WhatsMyAnchor + DataHeight + 1, 0)\n  WhatsMyAnchor = CurrentClientAnchor.Row\n\n  'That throws a 1004 error with or without the Set, \"application or object-defined error\", thanks.\n  'It's just impossible to move a Range down a few cells. Excel VBA can't do that. You can't vary a Range variable.\n\nLoop\nMsgBox \"All successfully written\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562085255, "post_id": 28313173, "comment_id": 100263638, "body": "This question is basically the opposite use-case of <a href=\"https://stackoverflow.com/questions/56670498/how-to-insert-a-table-after-body-of-e-mail-and-before-signature/56673269#56673269\">this one</a>. You will not (obviously) need to create the OFT template file, but may use that framework to handle the <code>WordEditor</code> instance of the <code>MailItem</code> object, then you can handle the table(s) and copy/paste into Excel."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562085276, "post_id": 28313173, "comment_id": 100263648, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562085422, "post_id": 28313173, "comment_id": 100263711, "body": "The question is also too broad (you seem to be asking for a fully implemented solution, while contributing apparently zero effort of your own)."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1562084920, "last_edit_date": 1562084920, "creation_date": 1423047708, "answer_id": 28319691, "question_id": 28313173, "link": "https://stackoverflow.com/questions/28313173/copy-the-contents-of-a-table-in-the-body-of-an-email-from-outlook-inbox-to-excel/28319691#28319691", "title": "Copy the contents of a table in the body of an email from Outlook Inbox to Excel", "body": "<p>You can handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686(v=office.15).aspx\" rel=\"nofollow noreferrer\">NewMailEx</a> event to get notified when a new mail arrives. Then you can get an instance of the just arrived item using the EntryID value passed to the NewMailEx event handler. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869893.aspx\" rel=\"nofollow noreferrer\">GetItemFromID</a> method of the Namespace class returns a Microsoft Outlook item identified by the specified entry ID (if valid).</p>\n\n<p>Also you may consider handling the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609(v=office.15).aspx\" rel=\"nofollow noreferrer\">ItemAdd</a> event of the Items class. It is fired when one or more items are added to the specified collection. Be aware, this event does not run when a large number of items are added to the folder at once.</p>\n\n<p>You can read more about that in the series of articles:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/10/03/outlook-newmail-event/\" rel=\"nofollow noreferrer\">Outlook NewMail event unleashed: the challenge (NewMail, NewMailEx, ItemAdd)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/10/24/outlook-newmail-solution-options/\" rel=\"nofollow noreferrer\">Outlook NewMail event: solution options</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/01/outlook-newmail-extended-mapi/\" rel=\"nofollow noreferrer\">Outlook NewMail event and Extended MAPI: C# example</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/11/10/outlook-newmail-custom-solution/\" rel=\"nofollow noreferrer\">Outlook NewMail unleashed: writing a working solution (C# example)</a></li>\n</ul>\n\n<p>After getting an instance of the MailItem class which represents the incoming email you can get the required information parsing the message body. There are three main ways for working with bodies in Outlook:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow noreferrer\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow noreferrer\">HTMLBody</a>. </li>\n<li>Word editor. The Inspector class provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow noreferrer\">WordEditor</a> property which returns an instance of the Document class from the Word object model which represents the message body. Outlook uses Word as an email editor. </li>\n</ol>\n\n<p>You can read more about that in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">Chapter 17: Working with Item Bodies</a> .</p>\n"}], "owner": {"reputation": 1, "user_id": 4526895, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-40Ni4_iVP8M/AAAAAAAAAAI/AAAAAAAAAEA/ngZOe4LBRNI/photo.jpg?sz=128", "display_name": "Uday Paladugula", "link": "https://stackoverflow.com/users/4526895/uday-paladugula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "closed_date": 1562145271, "answer_count": 1, "score": 0, "last_activity_date": 1592984237, "creation_date": 1423021687, "last_edit_date": 1592984237, "question_id": 28313173, "link": "https://stackoverflow.com/questions/28313173/copy-the-contents-of-a-table-in-the-body-of-an-email-from-outlook-inbox-to-excel", "closed_reason": "Needs more focus", "title": "Copy the contents of a table in the body of an email from Outlook Inbox to Excel", "body": "<p>I'm using <strong>Outlook 2010</strong> and <strong>Excel 2010</strong>. Daily I'm getting 200 emails with <strong><em>same subject</em></strong> and <strong>tabular data</strong> in the body (The table will be same all over the mails). I need to copy the <strong>data in the table</strong> to Excel in the same format as they are recieved. Kindly help me out in this..</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1423067478, "post_id": 28312989, "comment_id": 45000510, "body": "<i>help me with a script</i> generally implies that you&#39;ve done some work so far. Please show what you&#39;ve tried so far. There is ample documentation on basic I/O functions for reading text files/etc. on the web :)"}, {"owner": {"reputation": 23, "user_id": 4526835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf5b308408461682891ae00c02d1311?s=128&d=identicon&r=PG&f=1", "display_name": "Kotune", "link": "https://stackoverflow.com/users/4526835/kotune"}, "edited": false, "score": 0, "creation_date": 1423082605, "post_id": 28312989, "comment_id": 45009242, "body": "Edited the post with attempted scripts"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4526835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf5b308408461682891ae00c02d1311?s=128&d=identicon&r=PG&f=1", "display_name": "Kotune", "link": "https://stackoverflow.com/users/4526835/kotune"}, "edited": false, "score": 1, "creation_date": 1423174229, "post_id": 28332210, "comment_id": 45053618, "body": "Worked like a charm! Thank you!"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 1, "last_activity_date": 1423088042, "last_edit_date": 1423088042, "creation_date": 1423086825, "answer_id": 28332210, "question_id": 28312989, "link": "https://stackoverflow.com/questions/28312989/vba-excel-delete-2-rows-above-the-row-with-a-specific-keyword/28332210#28332210", "title": "VBA Excel - Delete 2 rows above the row with a specific keyword", "body": "<p>Not sure if this is what you're looking for, but maybe it will help</p>\n\n<p>Just select the cell at the top of the list and run the macro</p>\n\n<pre><code>Sub DeleteSuccessfulRows()\n\nApplication.ScreenUpdating = False\nDim x\nFor x = Cells(Rows.Count, ActiveCell.Column).End(xlUp).Row To ActiveCell.Row Step -1\n    If Cells(x, 1) = \"Status: Successfully decrypted!\" Then 'If we find this text\n        Cells(x, 1).EntireRow.Delete      'Delete the entire row\n        Cells(x - 1, 1).EntireRow.Delete  'Delete the row above it\n        Cells(x - 2, 1).EntireRow.Delete  'Delete the row 2 rows above it\n        x = x - 2\n    'Delete blank rows\n    ElseIf Cells(x, 1) = vbNullString Then Cells(x, 1).EntireRow.Delete\n    'Optional delete rows that contain \"File looks like ...\"\n    'ElseIf Cells(x, 1) = \"File looks like it is not encrypted. Skipping ...\" Then Cells(x, 1).EntireRow.Delete\n    'ElseIf Cells(x, 1) = \"File could not be decrypted properly. Skipping ...\" Then Cells(x, 1).EntireRow.Delete\n    End If\nNext x\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><img src=\"https://i.stack.imgur.com/UhPID.png\" alt=\"After\"></p>\n"}], "owner": {"reputation": 23, "user_id": 4526835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf5b308408461682891ae00c02d1311?s=128&d=identicon&r=PG&f=1", "display_name": "Kotune", "link": "https://stackoverflow.com/users/4526835/kotune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2765, "favorite_count": 0, "accepted_answer_id": 28332210, "answer_count": 1, "score": 2, "last_activity_date": 1423088042, "creation_date": 1423020293, "last_edit_date": 1531164843, "question_id": 28312989, "link": "https://stackoverflow.com/questions/28312989/vba-excel-delete-2-rows-above-the-row-with-a-specific-keyword", "title": "VBA Excel - Delete 2 rows above the row with a specific keyword", "body": "<p>I have little insight in VBA, hence I need someone to help me with a script to achieve the outcome as stated in title.</p>\n\n<p>I need to extract specific rows from a log file that I have.</p>\n\n<p>Excerpt from actual log file in excel:</p>\n\n<pre><code>=====================================\n\nEncrypted file: C:\\[specific path]      \nAlgorithm picked for decryption: RC4        \nStatus: Successfully decrypted!     \n\nEncrypted file: C:\\[specific path]          \nFile looks like it is not encrypted. Skipping ...       \n\nEncrypted file: C:\\[specific path]      \nFile could not be decrypted properly. Skipping ...      \n\n=====================================\n</code></pre>\n\n<p>It goes like this for about 90k rows. I need to get rid of all \"Status: Successfully decrypted!\" rows with 2 rows above it. \nThe final data that I need are only rows with skipped paths, that failed decryption.</p>\n\n<p>Each block of text in this log is followed by blank row.</p>\n\n<p>Tried the following one:</p>\n\n<p>Sub DeleteRowsBelow()</p>\n\n<pre><code>Dim x As Long\nDim y As Long\n\nx = ActiveSheet.UsedRange.Rows.Count\n\nCells.Find(What:=\"Macro\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Select\ny = Selection.Row + 1\nRows(x &amp; \":\" &amp; y).EntireRow.Delete\n</code></pre>\n\n<p>End Sub</p>\n\n<p>But it deletes all of the rows below a certain keyword, so that does not work for me.</p>\n\n<p>Then tried to incorporate the following into the above script:</p>\n\n<p>Rows(\"1:\" &amp; Cells.Find(\"KEY WORD\").Row - 1).Delete</p>\n\n<p>But also with little luck, and again it deletes all of the rows above a certain keyword.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423020321, "post_id": 28312526, "comment_id": 44976191, "body": "This is part of my current codes only. The project I am working on requires me to create a new column and assign values to it base on another column. I will edit my original post to show my work so far. Thanks"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423053686, "post_id": 28312526, "comment_id": 44991200, "body": "Hafiz, again the problem in your code is that the assignment statement is too long. So instead of having that data hard coded, add it to separate worksheet (call it SourceData for example), and use the code I have in my answer"}, {"owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423098281, "post_id": 28312526, "comment_id": 45015548, "body": "Hi jeanno, really appreaciate you taking your time to assist me. I&#39;m still not quite sure understand. Can you explain it to me? I am still quite new to the VBA environment. Cheers."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "edited": false, "score": 0, "creation_date": 1423101625, "post_id": 28312526, "comment_id": 45016298, "body": "what I am saying this line in your <code>a = [{&quot;991&quot;,1042;&quot;916&quot;, 1042;&quot;954&quot;,261;&quot;975&quot;,3004;&quot;938&quot;,726;&quot;901&quot;,762;&quot;482&quot;,728; _             &quot;482&quot;,728;&quot;934&quot;,723;&quot;200&quot;,724;&quot;201&quot;,724;&quot;952&quot;,724;&quot;992&quot;,3030&zwnj;&#8203;;&quot;980&quot;,3207;&quot;116&quot;,62&zwnj;&#8203;6;&quot;939&quot;,722;&quot;390&quot;,51&zwnj;&#8203;7;&quot;484&quot;,548;&quot;339&quot;,59&zwnj;&#8203;;&quot;141&quot;,717;&quot;935&quot;,59;&zwnj;&#8203;&quot;994&quot;,3370;&quot;140&quot;,840&zwnj;&#8203;8;&quot;950&quot;,775;&quot;370&quot;, 734 }] </code> code is no good. Create a new worksheet in your workbook called <code>SourceData</code>, and the code I have provided to create the 2D vector. Make sure you change <code>Sheet1</code> to <code>SourceData</code> and set the correct range"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 1, "last_activity_date": 1423016951, "creation_date": 1423016951, "answer_id": 28312526, "question_id": 28312342, "link": "https://stackoverflow.com/questions/28312342/identifier-too-long/28312526#28312526", "title": "Identifier too long", "body": "<p>There is a limit on the number of characters per line. You can accomplish this using a much simpler way. Add your data to a spreadsheet (\"Sheet1\" for example) and in column A and column B.</p>\n\n<pre><code>Sub Assign2DVector()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Dim a As Variant\n    a = ws.Range(\"A1:B20\").Value ' set to whatever your actual range is\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4233993, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100001086022887/picture?type=large", "display_name": "Hafiz Haziq", "link": "https://stackoverflow.com/users/4233993/hafiz-haziq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1688, "favorite_count": 0, "accepted_answer_id": 28312526, "answer_count": 1, "score": -1, "last_activity_date": 1423020354, "creation_date": 1423015764, "last_edit_date": 1423020354, "question_id": 28312342, "link": "https://stackoverflow.com/questions/28312342/identifier-too-long", "title": "Identifier too long", "body": "<p>I am faced with this problem: \"Identifier too long\". What can I do to fix this? I tried using a break \"_\" . But there will another error: Missing end bracket. Thanks guys.</p>\n\n<pre><code> Sub Netting()\n\n     Dim Found As Range\n     Dim LR As Long\n     Dim ws As Worksheet\n     Dim cell As Range\n     Dim a As Variant, v As Variant, num\n\n     Set ws = Sheets(\"PAYABLES - OUTFLOWS\")\n\n     Set Found = ws.Rows(1).Find(What:=\"Invoice Amount\", _\n                                LookIn:=xlValues, lookat:=xlWhole)\n     If Found Is Nothing Then Exit Sub\n\n     a = [{\"991\",1042;\"916\", 1042;\"954\",261;\"975\",3004;\"938\",726;\"901\",762;\"482\",728; _\n            \"482\",728;\"934\",723;\"200\",724;\"201\",724;\"952\",724;\"992\",3030;\"980\",3207;\"116\",626;\"939\",722;\"390\",517;\"484\",548;\"339\",59;\"141\",717;\"935\",59;\"994\",3370;\"140\",8408;\"950\",775;\"370\", 734 }] 'create 2-d lookup array\n\n     LR = ws.Cells(ws.Rows.Count, Found.Column).End(xlUp).Row\n     Found.Offset(0, 1).EntireColumn.Insert\n     ws.Cells(1, Found.Column + 1).Value = \"Netting\"\n\n     For Each cell In ws.Range(ws.Range(\"C2\"), ws.Cells(LR, 3))\n        num = CStr(Mid(cell.Value, 3, 3))\n        v = Application.VLookup(num, a, 2, False)\n        cell.EntireRow.Cells(Found.Column + 1).Value = IIf(IsError(v), \"\", v)\n     Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1423027172, "last_edit_date": 1423027172, "creation_date": 1423026583, "answer_id": 28313921, "question_id": 28312114, "link": "https://stackoverflow.com/questions/28312114/comparing-array-versus-table/28313921#28313921", "title": "Comparing Array versus Table", "body": "<p>Your code have a lot of hanging statements (<code>For Loop</code> and <code>If Statements</code>).<br>\nI don't know what you mean by load but if what you want is to copy Worksheets from WorkbookA that is not in the list (table in sheet in WorkbookB), you can try below:</p>\n\n<p>Code in WorksheetB:</p>\n\n<pre><code>Dim sourcewb As Workbook, destwb As Workbook\nDim ws As Worksheet\nSet sourcewb = Workbooks(\"workbookname\") 'or using Open method\nSet destwb = ThisWorkbook 'contains your table\n\nFor Each ws In sourcewb.Sheets\n    If IsError(Application.Match(ws.Name, Sheet1.Range(\"tblList\"), 0)) Then\n        ws.Copy , destwb.Sheets(destwb.Sheets.Count) 'copy after last sheet\n    End If\nNext\n</code></pre>\n\n<p>This is assuming you have a table with only 1 column like below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/1La11.png\" alt=\"enter image description here\"></p>\n\n<p>If not, you should include the header like below:</p>\n\n<pre><code>If IsError(Application.Match(ws.Name, Sheet1.Range(\"tblList[List]\"), 0)) Then\n</code></pre>\n\n<p>Note that <code>Sheet1</code> is the worksheet codename that contains your table.<br>\nIt can be replaced with <code>destwb.Sheets(\"Sheet1\")</code> or whatever name your sheet have. <br>Is this what you're trying? HTH.</p>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "is_accepted": false, "score": 1, "last_activity_date": 1423104592, "last_edit_date": 1423104592, "creation_date": 1423103791, "answer_id": 28335247, "question_id": 28312114, "link": "https://stackoverflow.com/questions/28312114/comparing-array-versus-table/28335247#28335247", "title": "Comparing Array versus Table", "body": "<p>Alternate Solution to L42. The abpve question can be implemented by using Dictionary.</p>\n\n<blockquote>\n<pre><code>Public Function ExclutionDict(Table As String) As Dictionary\n\nDim rngTable As Range\nDim arr As Variant\nDim Dict As Dictionary\nDim Count As Long\nDim tblIgnoreLoad As String\nDim lo As Excel.ListObject\nDim test As String\n\nIf Table = \"tblIgnoreLoad\" Then\nSet lo = ShControl.ListObjects(\"tblIgnoreLoad\")\nSet rngTable = lo.DataBodyRange\n\n    arr = rngTable.Value\n    Set Dict = New Dictionary\n\n    For Count = LBound(arr, 1) To UBound(arr, 1)\n     If Len(arr(Count, 1)) &lt;&gt; 0 Then\n         Dict.Add arr(Count, 1), Count\n     End If\n    Next Count\nEnd If\nSet ExclutionDict = Dict\nEnd Function\n</code></pre>\n</blockquote>\n\n<p>The above function can be executed to match the requirement</p>\n\n<blockquote>\n<pre><code>Dim temp As Dictionary\n    Set temp = ShControl.ExclutionDict(\"tblIgnoreLoad\")\n\n     If temp.Exists(SourceDataWorkbook.Sheets(i).name) Then\n      'Do Nothing\n\n     Else \n  ' Do you usual copy/load\nend if\n</code></pre>\n</blockquote>\n\n<p>The table is converted into an dictionary and the list is taken as array. A condition is validated to check if the worksheet is present in the dictionary, do nothing; else copy.</p>\n\n<p>Note: Please do not forget to add the reference of Microsoft Scripting Runtime to enable dictionary property.</p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 351, "user_id": 3597166, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5046ab7628deca9e3bf1b9f780a7b192?s=128&d=identicon&r=PG&f=1", "display_name": "Manivannan KG", "link": "https://stackoverflow.com/users/3597166/manivannan-kg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 28313921, "answer_count": 2, "score": 0, "last_activity_date": 1423104592, "creation_date": 1423014354, "last_edit_date": 1531164843, "question_id": 28312114, "link": "https://stackoverflow.com/questions/28312114/comparing-array-versus-table", "title": "Comparing Array versus Table", "body": "<p>My aim is to load the Worksheets(ws1...wsn) in the WorkbookA to WorkbookB with specific condition.\nI have formed an array of worksheets present in WorkbookA.</p>\n\n<p><strong>Condition:</strong> <br>I have a table(tblList) in WorkbookB which lists down the worksheet names that has to be ignored loading (Say I do not want to load ws2,ws4).</p>\n\n<pre><code>Set SourceDataWorkbook = Workbooks.Open(vSrcFileName)\nvalidationProd = SourceDataWorkbook.Sheets.Count\n\nReDim arrsNames(validationProd)\nFor i = 1 To validationProd\nsName = \"\"\n\nIf fCheckSheet(SourceDataWorkbook, SourceDataWorkbook.Sheets(i).Name) Then\n    sName = SourceDataWorkbook.Sheets(i).Name\n    If Len(Trim(sName)) &gt; 30 Then\n    sName = Mid(sName, 1, 29)\nEnd If\n    arrsNames(i - 1) = sName\n    outputWorkbook.Sheets.Add(After:=outputWorkbook.Worksheets(i + 3)).Name = _\n        sName + \"_P\"\n    SourceDataWorkbook.Sheets(i).Activate\nElse\n    ErrorStatus = \"Source Sheet not found \"\n    msgBoxReturn = MsgBox(ErrorStatus &amp; SourceDataWorkbook.FullName, _\n        vbExclamation + vbOKCancel)\n    GoTo TheExit:\nEnd If\n</code></pre>\n\n<p>Please help me in achieving the requirement.</p>\n"}, {"tags": ["excel", "if-statement", "vlookup", "vba"], "comments": [{"owner": {"reputation": 30989, "user_id": 3379653, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/f97JZ.png?s=128&g=1", "display_name": "qwerty_so", "link": "https://stackoverflow.com/users/3379653/qwerty-so"}, "edited": false, "score": 0, "creation_date": 1423007136, "post_id": 28310764, "comment_id": 44972729, "body": "Just use a text editor and indent that stuff."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1423008820, "creation_date": 1423008820, "answer_id": 28311255, "question_id": 28310764, "link": "https://stackoverflow.com/questions/28310764/to-interpret-nested-if-statement-in-excel/28311255#28311255", "title": "To Interpret nested if statement in Excel", "body": "<p>A lookup is performed of C9 concatenated with C10, both from sheet <code>The Imputer</code> in one or other of two ranges, which depending upon whether C16 contains <code>A</code> or <code>P</code>, for the exact match in the adjacent column.</p>\n\n<p>The range for <code>A</code> is sheet <code>detasian</code> O23:P40 and for <code>P</code> sheet <code>detnhpi</code> L23:M40. </p>\n"}], "owner": {"reputation": 189, "user_id": 1580711, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3a991b5f856a813df15142beae38ecd3?s=128&d=identicon&r=PG", "display_name": "Hank", "link": "https://stackoverflow.com/users/1580711/hank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 28311255, "answer_count": 1, "score": 0, "last_activity_date": 1423008820, "creation_date": 1423006096, "last_edit_date": 1531161705, "question_id": 28310764, "link": "https://stackoverflow.com/questions/28310764/to-interpret-nested-if-statement-in-excel", "title": "To Interpret nested if statement in Excel", "body": "<p>Can anyone help me to interpret the following nested if statement in Excel? Thanks.</p>\n\n<p>\"The Imputer\", \"detasian\", and \"detnphi\" are worksheet names of an Excel workbook. cell C9 and cell C10 are user inputs, and cell c16 is a result from an intermediate calculation step.</p>\n\n<blockquote>\n  <p>\"value of cell c17\"=IF(C16=\"A\",VLOOKUP('The Imputer'!C9&amp;'The Imputer'!C10,detasian!O23:P40,2,FALSE),IF(C16=\"P\",VLOOKUP('The\n  Imputer'!C9&amp;'The Imputer'!C10,detnhpi!L23:M40,2,FALSE),\"\"))</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-office", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1423063982, "post_id": 28320436, "comment_id": 44998036, "body": "Eugene&#39;s correct. Either a document property or a presentation level tag would allow you to add your own unique ID.  Note that FullName isn&#39;t foolproof.  C:\\Temp\\ThisFile.PPTX on my computer and on your computer could be entirely different presentations, but same FullName.  Or Anthony might need to be able to determine that a given file, no matter where it&#39;s stored or what it&#39;s named, is actually the file he&#39;s looking for.  FullName would fail again, but tags or doc props would work.  I prefer tags because the user won&#39;t be able to see/edit them."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 3, "last_activity_date": 1423049931, "creation_date": 1423049931, "answer_id": 28320436, "question_id": 28310697, "link": "https://stackoverflow.com/questions/28310697/is-there-any-unique-id-associated-with-each-powerpoint-presentation-file-ppt-o/28320436#28320436", "title": "Is there any unique ID associated with each Powerpoint presentation file (.ppt or .pptx)?", "body": "<p>The PowerPoint object model doesn't provide any special ID. You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff746313(v=office.15).aspx\" rel=\"nofollow\">FullName</a> property of the Presentation class to identify presentations uniquely. </p>\n\n<p>If you are not satisfied with that solution you may consider adding your own ID as a custom document property. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff744661(v=office.15).aspx\" rel=\"nofollow\">CustomDocumentProperties</a> property of the Presentation class returns a DocumentProperties collection that represents all the custom document properties for the specified presentation.</p>\n"}], "owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "accepted_answer_id": 28320436, "answer_count": 1, "score": 1, "last_activity_date": 1593807689, "creation_date": 1423005786, "last_edit_date": 1593807689, "question_id": 28310697, "link": "https://stackoverflow.com/questions/28310697/is-there-any-unique-id-associated-with-each-powerpoint-presentation-file-ppt-o", "title": "Is there any unique ID associated with each Powerpoint presentation file (.ppt or .pptx)?", "body": "<p>I have checked MSDN and there seems to be no unique ID (UUID or whatnot) property in the <code>Presentation</code> object model ( <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff746640(v=office.15).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/ff746640(v=office.15).aspx</a> )</p>\n\n<p>According to the code example, a Presentation can only be identified by a name only. e.g.</p>\n\n<pre><code>Presentations(\"Sample Presentation\").Slides.Add 1, 1\n</code></pre>\n\n<p>Is there anyway I can identify a presentation by way of an ID? Hopefully it will looks something like this</p>\n\n<pre><code>Presentations(\"067e6162-3b6f-4abc-a171-2470b63dff00\").Slides.Add 1, 1\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "cross-reference"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1423014092, "post_id": 28310448, "comment_id": 44974600, "body": "Can you boil your question down to a specific line of code that you&#39;re having trouble with?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423031756, "post_id": 28310448, "comment_id": 44979444, "body": "Try to use this logic: <code>ActiveDocument.Fields(1).select</code> &gt;&gt; <code>selection.MoveLeft</code> &gt;&gt; <code>selection.TypeText &quot;001 &quot;</code>"}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1423174751, "post_id": 28310448, "comment_id": 45053856, "body": "Thanks KazJaw. The code you provided solved half the problem. That inserts the text &#39;001&#39; before the field and not the target the field CTRL+Clicks to. I modified it slightly to do what I need it to. I will Update the original Post with the new code, and a new issue I am having."}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1423176150, "post_id": 28310448, "comment_id": 45054416, "body": "RubberDuck, thanks for the reply. I updated the OP with a more specific problem. Regards"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1450204939, "post_id": 34254910, "comment_id": 56335515, "body": "Hello Cindy, thanks for the alternative approach. I dropped this project a while ago, but will pick it back up again soon. I&#39;ll be sure to try out the code you&#39;ve kindly provided! Many Thanks"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1450032450, "creation_date": 1450032450, "answer_id": 34254910, "question_id": 28310448, "link": "https://stackoverflow.com/questions/28310448/using-cross-reference-field-code-to-move-selection-to-target-of-field-code/34254910#34254910", "title": "Using Cross Reference Field Code to move selection to Target of Field Code", "body": "<p>All REF fields \"reference\" bookmarks. Word sets bookmarks on all objects that get a reference for a REF field: figures, headings, etc. There's no way to distinguish from the content of the field what's at the other end. You need to \"inspect\" that target, which you can do without actually selecting it. For example, you could check whether the first six letters are \"Figure\".</p>\n\n<p>The code you have is inefficient - there's no need to use the Selection object to get the field code. The following is more efficient:</p>\n\n<pre><code>Sub Method3()\n  Dim fld As Word.Field\n  Dim rng as Word.Range\n  Dim vSt1 As String\n\n  ForEach fld in ActiveDocument.Fields\n    vSt1 = fld.Code\n    'MsgBox vSt1\n    vSt1 = Split(vSt1, \" \")(2) 'Find out what the (2) does\n    MsgBox vSt1\n    Set rng = ActiveDocument.Bookmarks(vSt1).Range\n    If Left(rng.Text, 6) &lt;&gt; \"Figure\" Then\n        rng.Select\n    End If\n  Next \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450032450, "creation_date": 1423004482, "last_edit_date": 1423178559, "question_id": 28310448, "link": "https://stackoverflow.com/questions/28310448/using-cross-reference-field-code-to-move-selection-to-target-of-field-code", "title": "Using Cross Reference Field Code to move selection to Target of Field Code", "body": "<p>OP Update:</p>\n\n<p>Thanks for the code KazJaw, it prompted me to change the approach I am trying to tackle the problem with. This is my current code:</p>\n\n<pre><code>Sub Method3()\nDim intFieldCount As Integer\nDim i As Integer\nDim vSt1 As String\n\nintFieldCount = ActiveDocument.Fields.Count\n\nFor i = 1 To intFieldCount\n    ActiveDocument.Fields(i).Select 'selects the first field in the doc\n    Selection.Expand\n    vSt1 = Selection.Fields(1).Code\n    'MsgBox vSt1\n    vSt1 = Split(vSt1, \" \")(2) 'Find out what the (2) does\n    MsgBox vSt1\n    ActiveDocument.Bookmarks(vSt1).Select  'Selects the current crossreference in the ref list\nNext i\nEnd Sub\n</code></pre>\n\n<p>Ok the so the Code currently finds the first field in the document, reads its field code and then jumps to the location in the document to mimic a CTRL+Click.</p>\n\n<p>However, It does this for all types of fields Bookmarks, endnotes, figures, tables etc. I only want to find Reference fields. I thought I could deduce this from the field code but it turns out figures and bookmarks use the same field code layout ie.</p>\n\n<ol>\n<li>A Reference/Boookmark has a field code {REF_REF4123123214\\h}</li>\n<li>A Figure cross ref has the field code {REF_REF407133655\\h}</li>\n</ol>\n\n<p>Is there an effective way to get VBA to distinguish between the two? I was thinking as reference fields in the document are written as (Reference 1) I could find the field and then string compare the word on the left to see if it says \"Reference\".</p>\n\n<p>I was thinking of using the MoveLeft Method to do this</p>\n\n<pre><code>Selection.MoveLeft\n</code></pre>\n\n<p>But I can't work out how to move left 1 word from the current selection and select that word instead to do the strcomp</p>\n\n<p>Or perhaps I can check the field type? with...</p>\n\n<pre><code>If Selection.Type = wdFieldRef Then\n   Do Something\nEnd If\n</code></pre>\n\n<p>But I am not sure which \"Type\" i should be looking for.</p>\n\n<p>Any advice is appreciated</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 1806594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039f6da0dcde881740ca6538a4755003?s=128&d=identicon&r=PG", "display_name": "GothamHunter", "link": "https://stackoverflow.com/users/1806594/gothamhunter"}, "edited": false, "score": 0, "creation_date": 1423003922, "post_id": 28310245, "comment_id": 44971510, "body": "I actually just figured this out myself as well; the problem was that I was trying to use the email address or AD name and not the literal name of the mailbox (two words with a space and all that).  Will mark as answer though; thank you for your reply."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1423005344, "post_id": 28310245, "comment_id": 44972052, "body": "This code assumes the mailbox is already opened in the current profile and the Inbox is actually called &quot;Inbox&quot; (which is not true in other languages)."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1423003810, "last_edit_date": 1423003810, "creation_date": 1423003681, "answer_id": 28310245, "question_id": 28310088, "link": "https://stackoverflow.com/questions/28310088/using-microsoft-access-need-to-pull-attachments-from-outlook-emails-of-a-differ/28310245#28310245", "title": "Using Microsoft Access, need to pull attachments from Outlook emails of a different account", "body": "<p>Try this:</p>\n\n<pre><code>Set Inbox = ns.Folders(\"MailboxName\").Folders(\"Inbox\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1423005348, "creation_date": 1423005348, "answer_id": 28310606, "question_id": 28310088, "link": "https://stackoverflow.com/questions/28310088/using-microsoft-access-need-to-pull-attachments-from-outlook-emails-of-a-differ/28310606#28310606", "title": "Using Microsoft Access, need to pull attachments from Outlook emails of a different account", "body": "<p>Use Namespace.GetSharedDefaultFolder</p>\n\n<pre><code>Set recip = ns.CreateRecipient(\"other mailbox owner\")\nrecip.Resolve\nSet Inbox = ns.GetSharedDefaultFolder(recip, olFolderInbox)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 1806594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039f6da0dcde881740ca6538a4755003?s=128&d=identicon&r=PG", "display_name": "GothamHunter", "link": "https://stackoverflow.com/users/1806594/gothamhunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "accepted_answer_id": 28310245, "answer_count": 2, "score": 0, "last_activity_date": 1593475501, "creation_date": 1423003000, "last_edit_date": 1593475501, "question_id": 28310088, "link": "https://stackoverflow.com/questions/28310088/using-microsoft-access-need-to-pull-attachments-from-outlook-emails-of-a-differ", "title": "Using Microsoft Access, need to pull attachments from Outlook emails of a different account", "body": "<p>I have working code below to extract attachments from my own Outlook email account, however I need to do it for a different account that is setup as a default reply email box for an automated process.  </p>\n\n<p>I'm not entirely sure how to tell the code below to check for that mailbox instead of my own.  I've tried different variations of setting the Inbox variable, but none of them have worked thus far.  This is done within Access 2013.</p>\n\n<pre><code>Private Sub GetAttachments()\n\n    Dim ns As Namespace\n    Dim Inbox As Outlook.MAPIFolder\n    Dim Item As Object\n    Dim Atmt As Outlook.Attachment\n    Dim FileName As String\n\n    Set ns = GetNamespace(\"MAPI\")\n\n    Set Inbox = ns.GetDefaultFolder(olFolderInbox)\n\n    If Inbox.Items.Count = 0 Then\n        MsgBox \"There are no messages in the Inbox.\", vbInformation, _\n                \"Nothing Found\"\n        Exit Sub\n    End If\n\n    For Each Item In Inbox.Items\n        For Each Atmt In Item.Attachments\n            If Atmt.Type = 1 And InStr(Atmt, \"xlsx\") &gt; 0 Then\n                FileName = \"C:\\attachments\\\" &amp; Atmt.FileName\n                Atmt.SaveAsFile FileName\n            End If\n        Next Atmt\n    Next Item\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 424, "user_id": 3913120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727ab82954f240049d290b6279f34589?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/3913120/frank"}, "edited": false, "score": 1, "creation_date": 1423001511, "post_id": 28309552, "comment_id": 44970473, "body": "Is there a particular reason for using VBA for this? Formulas should do and are probably easier to maintain going forward."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1423003166, "post_id": 28309552, "comment_id": 44971187, "body": "So which exact part of this are you having a problem with?  What have you tried, and what problems did you run into?"}, {"owner": {"reputation": 1, "user_id": 3818507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f630c30a9e78a3263012da9dbd3d566?s=128&d=identicon&r=PG&f=1", "display_name": "user3818507", "link": "https://stackoverflow.com/users/3818507/user3818507"}, "edited": false, "score": 0, "creation_date": 1423149774, "post_id": 28309552, "comment_id": 45039468, "body": "I really need vba because the example above is very simplified.  There is actually 10,000 rows of data and 9 columns to add."}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "edited": false, "score": 0, "creation_date": 1423003886, "post_id": 28310260, "comment_id": 44971501, "body": "if using vba you would have to use a loop to look through the cells in sheet 1 and 2 and then a if function to return the value in column b if the id is matched. The formula is a much easier solution"}], "tags": [], "owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1423003747, "creation_date": 1423003747, "answer_id": 28310260, "question_id": 28309552, "link": "https://stackoverflow.com/questions/28309552/macro-to-add-two-amounts-based-on-a-common-id/28310260#28310260", "title": "Macro to add two amounts based on a common id", "body": "<p>On sheet 3 in A1</p>\n\n<pre><code>`=index(Sheet1!B1:B10,Match(A1,Sheet1!A1:A10))+index(Sheet2!B1:B10,Match(A1,Sheet2!A1:A10))'\n</code></pre>\n\n<p>This will search for the id in column a of sheet 3 on sheet 1 and 2 and bring back the values from column b on those sheets</p>\n"}], "owner": {"reputation": 1, "user_id": 3818507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f630c30a9e78a3263012da9dbd3d566?s=128&d=identicon&r=PG&f=1", "display_name": "user3818507", "link": "https://stackoverflow.com/users/3818507/user3818507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1423003747, "creation_date": 1423000764, "last_edit_date": 1423000910, "question_id": 28309552, "link": "https://stackoverflow.com/questions/28309552/macro-to-add-two-amounts-based-on-a-common-id", "title": "Macro to add two amounts based on a common id", "body": "<p>I have a workbook with three sheets.  I'm trying to create a macro that matches an id on two sheets, sums an amount from another column on that sheet, and populate the result on the third sheet.</p>\n\n<p>Example:<br>\nSheet 1</p>\n\n<blockquote>\n  <p>id,   amount<br>\n  1, 10<br>\n  2, 13<br>\n  3, 7<br>\n  4, 33<br>\n  5,16</p>\n</blockquote>\n\n<p>Sheet 2  </p>\n\n<blockquote>\n  <p>id, amount<br>\n  1, 3<br>\n  3, 40<br>\n  4, 12</p>\n</blockquote>\n\n<p>Expected Return on sheet 3</p>\n\n<blockquote>\n  <p>id, amount<br>\n  1, 13<br>\n  2, 13<br>\n  3, 47<br>\n  4, 45<br>\n  5,16</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1422999627, "post_id": 28309235, "comment_id": 44969586, "body": "change Book_List to a collection"}], "answers": [{"comments": [{"owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423001333, "post_id": 28309332, "comment_id": 44970388, "body": "That looks simple enough. Would you mind fleshing out your answer just a bit? Do I first create a book object, and then add it to the list? Is <code>bk = book_list.Item(indexNumber)</code> how I retrieve the book object at <code>indexNumber</code>? When did I set the values for that item in the first place?  Thanks --AB"}, {"owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423001481, "post_id": 28309332, "comment_id": 44970460, "body": "Oh, and where do I put <code>Public book_list As Collection</code>? In the <code>EmailData</code> class?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423001774, "post_id": 28309332, "comment_id": 44970598, "body": "yes you declare the member in your EmailData class, bk = book_list.Item(indexNumber) is how you would obtain the object.  Yes you want to create the book object and then add it to the list.  You could also create methods to search the books collection for a specific book but to provide an example I would need to know your book class and emaildata class."}, {"owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423002826, "post_id": 28309332, "comment_id": 44971046, "body": "Thanks. I think I understand enough now."}, {"owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423008145, "post_id": 28309332, "comment_id": 44973048, "body": "On the line <code>book_list = New Collection</code> I&#39;m getting <code>compile error argument not optional</code>"}, {"owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "edited": false, "score": 0, "creation_date": 1423008789, "post_id": 28309332, "comment_id": 44973243, "body": "And, even if I comment out that line, macro crashes (no error, just stops) at <code>email = New EmailData</code> in the main method. The prior line <code>Dim email as EmailData</code> does not crash (execution continues if I comment out the next line specified)."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 8, "last_activity_date": 1423017642, "last_edit_date": 1423017642, "creation_date": 1422999807, "answer_id": 28309332, "question_id": 28309235, "link": "https://stackoverflow.com/questions/28309235/array-of-class-objects-as-class-member-in-vba/28309332#28309332", "title": "Array of class objects as class member in VBA", "body": "<p>Per my comment I would use a collection.  Here is how you define it and initialize it  </p>\n\n<pre><code>Public book_list As Collection\n\n'intitalize the collection in the constructor of the class\nPrivate Sub Class_Initialize()\n    Set book_list = New Collection\nEnd Sub\n</code></pre>\n\n<p>and to use it</p>\n\n<pre><code>book_list.Add &lt;book&gt;\ndim bk as Book\nset bk  = book_list.Item(indexNumber)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "is_accepted": false, "score": 5, "last_activity_date": 1422999899, "creation_date": 1422999899, "answer_id": 28309349, "question_id": 28309235, "link": "https://stackoverflow.com/questions/28309235/array-of-class-objects-as-class-member-in-vba/28309349#28309349", "title": "Array of class objects as class member in VBA", "body": "<p>There's a couple of options.</p>\n\n<p>The easiest is just to make book_list a Variant type. You can treat it as an array using ReDim. You can use variables of Variant type to store object references just like you would with an object variable.</p>\n\n<p>The other option is to make book_list a private variable and create accessor methods. This is the preferred way to use classes anyway, and if you're using classes in the first place, you might as well observe good object oriented design. Your class would look something like this.</p>\n\n<pre><code>Private email_text As String\n...\nPrivate book_list() As Book\n\nPrivate Sub Class_Initialize()\n    email_text = \"default email text\"\n    ...\n    ReDim book_list(10)\nEnd Sub\n\nPublic Function GetBook(index As Long) As Book\n    Set GetBook = book_list(index)\nEnd Function\n\nPublic Sub SetBook(index As Long, b As Book)\n    Set book_list(index) = b\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7483, "user_id": 188963, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/c76255b9a96d7e087522477fc278631a?s=128&d=identicon&r=PG", "display_name": "abalter", "link": "https://stackoverflow.com/users/188963/abalter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31549, "favorite_count": 1, "accepted_answer_id": 28309332, "answer_count": 2, "score": 5, "last_activity_date": 1423017642, "creation_date": 1422999390, "last_edit_date": 1531164843, "question_id": 28309235, "link": "https://stackoverflow.com/questions/28309235/array-of-class-objects-as-class-member-in-vba", "title": "Array of class objects as class member in VBA", "body": "<p>I'm writing an Excel macro in VBA to send emails to library patrons alerting them of overdue materials. The data comes from a spreadsheet with data like</p>\n\n<pre><code>UserID   Name        Email      Title    Author     Barcode Call Number Borrowed Date   Due Date\nuser2   Jones, Bob   bob@jones  Title1  A. Baker    a0001   H00027C     11/23/2014      1/1/2015\nuser2   Jones, Bob   bob@jones  Title2  C. Dalton   b0002   S00406R     11/23/2014      1/1/2015\nuser3   Smith, Mary  bob@jones  Title3  E. Franklin c0003   M00174R     11/23/2014      1/1/2015\nuser3   Smith, Mary  mary@smith Title4  F. Gelt     d0004   M00157G     11/23/2014      1/1/2015\nuser3   Smith, Mary  mary@smith Title5  H. Ivers    e0005   M00081G     11/23/2014      1/1/2015\n</code></pre>\n\n<p>I started out with a user defined type for book and patron, and gave each patron an array of books. I tried passing the patron to a function to generate the email text, but apparently I can't pass a user defined type as a parameter. So, now I'm trying classes. </p>\n\n<p>I want to have a <code>Book</code> class with members</p>\n\n<pre><code>Public book_title As String\nPublic date_borrowed As Date\nPublic date_due As Date\nPublic barcode As String\nPublic call_number As String\n</code></pre>\n\n<p>and a <code>EmailData</code> class with members</p>\n\n<pre><code>Public email_text As String\nPublic patron_name As String\nPublic patron_email As String\nPublic sender_email As String\nPublic book_list() As Book\n</code></pre>\n\n<p>where <code>book_list</code> is an array of <code>Book</code> objects, and a method <code>sendEmail()</code>.</p>\n\n<p>But, this isn't working because apparently I can't define an array of <code>Book</code> objects as a member of the an <code>EmailData</code> object. </p>\n\n<p>So, what is my approach here? I've heard of collections. Would that be a solution?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 1, "creation_date": 1423000540, "post_id": 28309383, "comment_id": 44970015, "body": "@pnuts You are right, what you are suggesting is much better. I didn&#39;t know that you can use wildcards in &#39;Replace&#39;. I&#39;m glad I know that now, thank you for that."}], "tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": false, "score": 2, "last_activity_date": 1423000051, "creation_date": 1423000051, "answer_id": 28309383, "question_id": 28309186, "link": "https://stackoverflow.com/questions/28309186/select-everything-to-the-right-of-a-specific-character-and-delete-it-from-column/28309383#28309383", "title": "Select everything to the right of a specific character and delete it from column", "body": "<p>What you are looking for is a <code>Split</code> function.</p>\n\n<p>It works like this:</p>\n\n<pre><code>Dim str As String: str = \"x, y, z\"\n\nDebug.Print Split(str, \",\")(0)\n</code></pre>\n\n<p>Result is <code>x</code></p>\n\n<p>The important parameters for <code>Split</code> are <code>string</code> and <code>delimiter</code>, the number after the function specifies the occurence. So if you wanted to select <code>y</code>, you would put 1 there etc. In that case, you would probably include the space in the delimiter so you would not need to trim the result further.</p>\n"}, {"comments": [{"owner": {"reputation": 1276, "user_id": 2752265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BdK4g.jpg?s=128&g=1", "display_name": "Jaken Herman", "link": "https://stackoverflow.com/users/2752265/jaken-herman"}, "edited": false, "score": 0, "creation_date": 1423001138, "post_id": 28309590, "comment_id": 44970295, "body": "Run-Time error &#39;5&#39;: Invalid procedure call or argument. Any idea why?"}, {"owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "reply_to_user": {"reputation": 1276, "user_id": 2752265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BdK4g.jpg?s=128&g=1", "display_name": "Jaken Herman", "link": "https://stackoverflow.com/users/2752265/jaken-herman"}, "edited": false, "score": 0, "creation_date": 1423040112, "post_id": 28309590, "comment_id": 44983300, "body": "If you use it on a cell with no comma. You can use an if to qualify."}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": false, "score": 1, "last_activity_date": 1423000918, "creation_date": 1423000918, "answer_id": 28309590, "question_id": 28309186, "link": "https://stackoverflow.com/questions/28309186/select-everything-to-the-right-of-a-specific-character-and-delete-it-from-column/28309590#28309590", "title": "Select everything to the right of a specific character and delete it from column", "body": "<p>You can use left with Instr to give you all the characters before the first comma.</p>\n\n<pre><code>ActiveCell = Left(ActiveCell,Instr(ActiveCell,\",\")-1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1276, "user_id": 2752265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BdK4g.jpg?s=128&g=1", "display_name": "Jaken Herman", "link": "https://stackoverflow.com/users/2752265/jaken-herman"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1423002540, "post_id": 28309917, "comment_id": 44970925, "body": "@pnuts that&#39;s much better! I guess after just staring at it for so long, my brain was telling me the loop was needed :p. Editing the answer now."}], "tags": [], "owner": {"reputation": 1276, "user_id": 2752265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BdK4g.jpg?s=128&g=1", "display_name": "Jaken Herman", "link": "https://stackoverflow.com/users/2752265/jaken-herman"}, "is_accepted": true, "score": 1, "last_activity_date": 1423002578, "last_edit_date": 1423002578, "creation_date": 1423002209, "answer_id": 28309917, "question_id": 28309186, "link": "https://stackoverflow.com/questions/28309186/select-everything-to-the-right-of-a-specific-character-and-delete-it-from-column/28309917#28309917", "title": "Select everything to the right of a specific character and delete it from column", "body": "<p>Thanks to @pnuts I was able to complete this task. I was unaware that wildcards could be used in Replace. This is my (working) macro:</p>\n\n<pre><code>Columns(\"S:S\").Replace What:=\",*\", Replacement:=\"\"\n</code></pre>\n"}], "owner": {"reputation": 1276, "user_id": 2752265, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BdK4g.jpg?s=128&g=1", "display_name": "Jaken Herman", "link": "https://stackoverflow.com/users/2752265/jaken-herman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 28309917, "answer_count": 3, "score": 0, "last_activity_date": 1431373368, "creation_date": 1422999202, "last_edit_date": 1431373368, "question_id": 28309186, "link": "https://stackoverflow.com/questions/28309186/select-everything-to-the-right-of-a-specific-character-and-delete-it-from-column", "title": "Select everything to the right of a specific character and delete it from column", "body": "<p>My column S needs to only contain one word, however, on import it usually has about three words separated by commas. I would like to only keep the first word in the cell.</p>\n\n<p>For example, my S1 column has something like \"x, y, z\" and I would like to make S1 only say x. So basically, I am trying to remove everything to the right of the first comma in the cell. I have tried to use Replace, but that isn't working. Is there a simpler way to do this?</p>\n\n<p>My (failing) macro right now:</p>\n\n<pre><code>For i = ActiveSheet.UsedRange.Rows.Count To 1 Step -1\n        If Cells(i, 19) = \",\" Then Columns(\"S:i\").Select\n        Selection.Replace What:=Trim(Right(ActiveCell.Value, 25), InStr(ActiveCell.Value, \",\") - 1), Replacement:=\"\"\nNext\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1422999306, "post_id": 28309022, "comment_id": 44969427, "body": "You have type-setting style quote <code>\u201d</code> instead of plain quote <code>&quot;</code> here: <code>DateValue([tsUpdated])=Date\u201d)</code>  Change it to: <code>DateValue([tsUpdated])=Date&quot;)</code>  What happens with that change?  Does it work?  If not, is there an error message?"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423003882, "post_id": 28309022, "comment_id": 44971500, "body": "I have made sure the right quotes are used, still a problem.  the error that results is Runtime error &#39;2471&#39;:  The expression you entered as a query parameter produced this error: &#39;Date&#39;.  For what it&#39;s worth, when I debug, this line later down in the code is highlighted: <code>tCompleted = DCount(&quot;qry_SessionReport.[EC#]&quot;, &quot;qry_SessionReport&quot;, &quot;&quot;)</code>.  I think the problem lies within the query but that&#39;s what highlights, which is an operation I want to do based on the query."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1423006018, "post_id": 28309022, "comment_id": 44972299, "body": "ah sorry, i simplified my SQL statement in the original question to focus on the problem.  there is, in reality, an [EC#] field in the SQL statement, and it still gives that error"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 4731795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b488619b97cb441867ddb72338b6297?s=128&d=identicon&r=PG&f=1", "display_name": "Lenny Sockman", "link": "https://stackoverflow.com/users/4731795/lenny-sockman"}, "is_accepted": false, "score": 0, "last_activity_date": 1427857431, "creation_date": 1427857431, "answer_id": 29382175, "question_id": 28309022, "link": "https://stackoverflow.com/questions/28309022/access-vba-filtering-sql-by-short-date-on-a-long-date-time-field/29382175#29382175", "title": "Access VBA filtering SQL by short date on a long date/time field", "body": "<p>For the querydef, I noticed you don't have the closing parenthesis for the Date() function in the SQL text. In the VBA editor, the function is listed as Date with no parenthesis but if you tried to use the Date() function in a query without the parenthesis Access would throw an error. Hope that helps!</p>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427857431, "creation_date": 1422998569, "last_edit_date": 1495539805, "question_id": 28309022, "link": "https://stackoverflow.com/questions/28309022/access-vba-filtering-sql-by-short-date-on-a-long-date-time-field", "title": "Access VBA filtering SQL by short date on a long date/time field", "body": "<p>I am having an issue getting criteria to work.  There is a related question on StackO here, but I have tried what's in it and it's still not working, so I'm asking my specific question.  Apologies if that's not technically kosher at StackO.\n<a href=\"https://stackoverflow.com/questions/20863041/cant-filter-ms-access-datetime-field-using-short-date\">Can&#39;t filter MS access datetime field using short date</a></p>\n\n<p>I have a query that I need to have WHERE criteria based on an associate ID and the current day\u2019s date.  But the field that has the current day\u2019s date needs to be a long date and time field, so criteria for short date doesn\u2019t work.  I have made this query in query design mode and it does exactly what I want:</p>\n\n<pre><code>SELECT tbl_Data.[#], AssocID, tsUpdated FROM tbl_Data WHERE AssocID = 4441 AND DateValue([tsUpdated])=Date()));\n</code></pre>\n\n<p>But when I do the equivalent in VBA, which I need to have this happen in, it does not work.  <strong>Please note</strong>, I have used <code>Date</code> in this vba version because according to <a href=\"http://www.classanytime.com/mis333k/sjdatetime.html\" rel=\"nofollow noreferrer\">this</a> website, <code>Date</code> will return current date:</p>\n\n<pre><code>Set FinishReport = CurrentDb.CreateQueryDef(\"qry_SessionReport\", \"SELECT tbl_Data.[#], AssocID, tsUpdated FROM tbl_Data WHERE AssocID = 4441 AND DateValue([tsUpdated])=Date\u201d)\n</code></pre>\n\n<p>I have tried all kinds of syntax, and I have tried the answers from that StackO URL above, but nothing has worked.  Any thoughts?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6123, "user_id": 2670182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MzRYh.jpg?s=128&g=1", "display_name": "Cool Blue", "link": "https://stackoverflow.com/users/2670182/cool-blue"}, "edited": false, "score": 1, "creation_date": 1423006112, "post_id": 28308971, "comment_id": 44972326, "body": "It&#39;s a Unicode/ascii thing read <a href=\"http://blog.nkadesign.com/2013/vba-unicode-strings-and-the-windows-api/\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 3193969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05cee30cb928d0b4c77b1f9a3eb4a31d?s=128&d=identicon&r=PG&f=1", "display_name": "sysmod", "link": "https://stackoverflow.com/users/3193969/sysmod"}, "is_accepted": false, "score": 0, "last_activity_date": 1431944717, "creation_date": 1431944717, "answer_id": 30300733, "question_id": 28308971, "link": "https://stackoverflow.com/questions/28308971/chinese-translation-resulting-is-question-marks/30300733#30300733", "title": "Chinese translation resulting is question marks (????...)", "body": "<p>Bit late but I just found this now. I'm that guy ;-)\nI've updated the code now to handle UTF-8, see the post at</p>\n\n<p><a href=\"https://sysmod.wordpress.com/2012/01/09/microsoft-translator-vba-code-sample/\" rel=\"nofollow\">https://sysmod.wordpress.com/2012/01/09/microsoft-translator-vba-code-sample/</a></p>\n\n<p>Please link to the post rather than the .bas file because file names can change.</p>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1496988308, "creation_date": 1496988308, "answer_id": 44450382, "question_id": 28308971, "link": "https://stackoverflow.com/questions/28308971/chinese-translation-resulting-is-question-marks/44450382#44450382", "title": "Chinese translation resulting is question marks (????...)", "body": "<p>Very late to post answer, but this may be it.</p>\n\n<p>You need to change the Language settings in Windows so that VBA can access the language you are working on.</p>\n\n<p>Follow below (except the Registry part) and you should be ok.</p>\n\n<p><a href=\"http://www.spreadsheet1.com/how-to-display-foreign-characters-in-vbe.html\" rel=\"nofollow noreferrer\">How To Display Foreign Characters In Excel VBE</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4526007, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203221699614990/picture?type=large", "display_name": "Steph Wilkins", "link": "https://stackoverflow.com/users/4526007/steph-wilkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496988308, "creation_date": 1422998414, "question_id": 28308971, "link": "https://stackoverflow.com/questions/28308971/chinese-translation-resulting-is-question-marks", "title": "Chinese translation resulting is question marks (????...)", "body": "<p>Long story short, as a test, I am reading data from one cell into a routine that sends non-English words/symbols to Microsoft translator. Upon return, it writes the results in a seperate cell. Unfortunately, because I lack experience when dealing with XMLHTTP, I am banging my head on this one.</p>\n\n<p>That's the plain vanilla short of it. Now here is the long version. I hope I make this clear enough. Forgive me, but remember I am new to this side of VBA...</p>\n\n<p>I'm attempting to leverage a routine that developed by Microsoft and edited by a guy named Patrick O'Beirne, because the way that Microsoft handles tokens has changed supposedly.. Patricks code is here: <a href=\"http://www.sysmod.com/MSTranslator.bas\" rel=\"nofollow\">http://www.sysmod.com/MSTranslator.bas</a>.</p>\n\n<p>Long version...\nI am looking to load Chinese data into the routine that uses MSXML2.XMLHTTP to perform a GET on it's way to Microsoft for translation.</p>\n\n<p>This routine works fine on Spanish or French words, but spits out question marks for Chinese Symbols. This may have to do with Chinese symbols being double-byte (?)...</p>\n\n<p>Here is the code. I traced it all the way into the MSHttpRequest function. It looks like it loads the data into oH, but when it comes back  to oH.ResponseText, the symbol change. This is purely a guess on my part.</p>\n\n<p>Anyway, my goal is to send Chinese symbols to Microsoft's translation server and return it in English.</p>\n\n<pre><code>Function MSHttpRequest(sRequest As String) As String\nDim sURL As String, oH As MSXML2.XMLHTTP, sToken As String\n\nsURL = \"http://api.microsofttranslator.com/V2/Http.svc/\" &amp; sRequest\nsToken = GetAccessToken()\nSet oH = CreateObject(\"MSXML2.XMLHTTP\")\n\noH.Open \"GET\", sURL, False\noH.setRequestHeader \"Authorization\", \"Bearer \" &amp; sToken\noH.send\nMSHttpRequest = oH.responseText\nSet oH = Nothing\nEnd Function\n</code></pre>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks,\nSteve</p>\n"}, {"tags": ["vba", "charts", "powerpoint", "paste"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1422998166, "creation_date": 1422998166, "answer_id": 28308900, "question_id": 28308737, "link": "https://stackoverflow.com/questions/28308737/selecting-a-linked-excel-chart-in-powerpoint/28308900#28308900", "title": "Selecting a linked excel chart in powerpoint", "body": "<p>This should be cleaner but you can save the copy/paste step if you simply ungroup the chart shape.  That'll give you a metafile directly.</p>\n\n<pre><code>Sub Select_All() \nDim oPresentation As Presentation \nSet oPresentation = ActivePresentation\n\nDim oSlide As Slide\nDim oSlides As SlideRange\nDim oShape As Shape\n' These should be Longs\nDim slideNumber As Long\nDim shapeNumber As Long\nDim lastslideNumber As Long\nDim lastshapeNumber As Long \nDim i As Long\n\nDim w As Double\nDim h As Double\nDim l As Double\nDim t As Double\n\nFor slideNumber = 14 To 100\n\n    'oPresentation.Slides(slideNumber).Select\n    ' never select anything unless you absolutely must\n    Set oSlide = oPresentation.Slides(slidenumber)\n\n    For i = oSlide.Shapes.Count to 1 step -1\n    ' Step through shapes backward, else you'll run into weird \n    ' side effects when deleting shapes\n        If oSlide.Shapes(i).HasChart Then\n            'oPresentation.Slides(slideNumber).Shapes(i).Select\n            ' don't select anything etc etc\n            oSlide.Shapes(i).Copy\n            With oSlide.Shapes(i)\n                w = .Width\n                h = .Height\n                l = .Left\n                t = .Top\n          End With\n          oSlide.Shapes(i).Delete\n          set oShape = oSlide.Shapes.PasteSpecial (ppPasteEnhancedMetafile)(1)\n\n            With oShape\n                '.Width = w\n                '.Height = h\n                .Left = l\n                .Top = t\n                .ZOrder msoSendToBack\n            End With\n        End If\n\n    Next i\n\nNext slideNumber\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4321958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6252746ae41cf61a0b7b25fb16958946?s=128&d=identicon&r=PG&f=1", "display_name": "phl194", "link": "https://stackoverflow.com/users/4321958/phl194"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 28308900, "answer_count": 1, "score": 0, "last_activity_date": 1422999191, "creation_date": 1422997587, "last_edit_date": 1422999191, "question_id": 28308737, "link": "https://stackoverflow.com/questions/28308737/selecting-a-linked-excel-chart-in-powerpoint", "title": "Selecting a linked excel chart in powerpoint", "body": "<p>I have a powerpoint presentation with 100 slides and most of them have linked excel charts.  I am trying to run a macro that will cycle through the slides and then the shapes on the slides and find the linked chart/graph, copy it, and paste it into the same position as a metafile so that I can make an emailable pdf file.  However, the macro is skipping over the chart or not recognizing it as a chart.  I searched and searched, any help would be much appreciated.</p>\n\n<pre><code>Sub Select_All()\n    Dim oPresentation As Presentation\n    Set oPresentation = ActivePresentation\n\n    Dim oSlide As Slide\n    Dim oSlides As SlideRange\n    Dim oShape As Shape\n    Dim slideNumber As Integer\n    Dim shapeNumber As Integer\n    Dim lastslideNumber As Integer\n    Dim lastshapeNumber As Integer, i As Integer\n    Dim w As Double\n    Dim h As Double\n    Dim l As Double\n    Dim t As Double\n\n    For slideNumber = 14 To 100\n\n        oPresentation.Slides(slideNumber).Select\n\n        For i = 1 To oPresentation.Slides(slideNumber).Shapes.Count\n            If oPresentation.Slides(slideNumber).Shapes(i).HasChart Then\n                oPresentation.Slides(slideNumber).Shapes(i).Select\n                oPresentation.Slides(slideNumber).Shapes(i).Copy\n                With ActiveWindow.Selection.ShapeRange(1)\n                    w = .Width\n                    h = .Height\n                    l = .Left\n                    t = .Top\n                End With\n                oPresentation.Slides(slideNumber).Shapes(i).Delete\n                oPresentation.Slides(slideNumber).Shapes.PasteSpecial (ppPasteEnhancedMetafile)\n\n                With ActiveWindow.Selection.ShapeRange\n                    '.Width = w\n                    '.Height = h\n                    .Left = l\n                    .Top = t\n                    .ZOrder msoSendToBack\n                End With\n            End If\n\n        Next i\n\n    Next slideNumber\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4408894, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5503c98efb4f9c2a0503f4d5dbc1c61d?s=128&d=identicon&r=PG&f=1", "display_name": "waysmoove", "link": "https://stackoverflow.com/users/4408894/waysmoove"}, "edited": false, "score": 0, "creation_date": 1423155809, "post_id": 28349287, "comment_id": 45043436, "body": "Thanks. Trying your suggestion now."}, {"owner": {"reputation": 25, "user_id": 4408894, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5503c98efb4f9c2a0503f4d5dbc1c61d?s=128&d=identicon&r=PG&f=1", "display_name": "waysmoove", "link": "https://stackoverflow.com/users/4408894/waysmoove"}, "edited": false, "score": 0, "creation_date": 1423156462, "post_id": 28349287, "comment_id": 45043904, "body": "You are awesome!!!!! It worked perfectly. Thank you very much. You are really awesome."}], "tags": [], "owner": {"reputation": 1967, "user_id": 2548338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5334e079c2f6bf8785e552f4cbb27796?s=128&d=identicon&r=PG", "display_name": "pteranodon", "link": "https://stackoverflow.com/users/2548338/pteranodon"}, "is_accepted": true, "score": 0, "last_activity_date": 1423154263, "creation_date": 1423154263, "answer_id": 28349287, "question_id": 28307897, "link": "https://stackoverflow.com/questions/28307897/criteria-to-return-all-records-if-selection-from-form-is-both/28349287#28349287", "title": "Criteria to return all records if selection from form is both", "body": "<p><a href=\"http://access.mvps.org/access/queries/qry0001.htm\" rel=\"nofollow\">Use a parameter to return all records if Null</a> shows how you can use a Null field value to lift that field's filter.\nTo adapt this, you could use: \n<code>[Forms]![ReportsForm]![cmbLvl]=\"All\" OR [Forms]![ReportsForm]![cmbLvl]</code></p>\n\n<p>If you need to show \"ALL\" as a combobox choice rather than just leaving it blank, consult <a href=\"http://http://access.mvps.org/access/forms/frm0043.htm\" rel=\"nofollow\">Adding \"All\" to a listbox or combobox</a>'s part about creating a union query including a null value listed as \"All\".</p>\n"}], "owner": {"reputation": 25, "user_id": 4408894, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5503c98efb4f9c2a0503f4d5dbc1c61d?s=128&d=identicon&r=PG&f=1", "display_name": "waysmoove", "link": "https://stackoverflow.com/users/4408894/waysmoove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "accepted_answer_id": 28349287, "answer_count": 1, "score": 0, "last_activity_date": 1423154263, "creation_date": 1422994449, "last_edit_date": 1423145305, "question_id": 28307897, "link": "https://stackoverflow.com/questions/28307897/criteria-to-return-all-records-if-selection-from-form-is-both", "title": "Criteria to return all records if selection from form is both", "body": "<p>I'm trying to pass multiple query criteria from form controls. I'm using\nthe following type of syntax for the criteria.</p>\n\n<pre><code>IIf([Forms]![ReportsForm]![cmbLvl]=\"ALL\", \"*\", [Forms]![ReportsForm]![cmbLvl])\n</code></pre>\n\n<p>It works for the else clause. But it does not work for the <code>ALL</code> Scenario. Is there an easy way to make this work. </p>\n\n<p>What I am trying to do is to return all records and not just one type. For example. On a table I want to be able to search for both Male and Female. Not just Male or vice versa. Not just female only too. But both.</p>\n\n<p>I also tried <code>Like Nz([Forms]![ReportsForm]![cmbLvl],\"*\")</code> . That did not work also.</p>\n"}, {"tags": ["excel", "formatting", "conditional", "vba"], "comments": [{"owner": {"reputation": 602, "user_id": 2608071, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/2abaf849fb1d66c9864af9384183b3c2?s=128&d=identicon&r=PG", "display_name": "TriHard8", "link": "https://stackoverflow.com/users/2608071/trihard8"}, "edited": false, "score": 0, "creation_date": 1422993391, "post_id": 28307302, "comment_id": 44966005, "body": "Use the format painter ( on home tab ) to copy and paste the conditional formatting on the entire row(s)."}, {"owner": {"reputation": 602, "user_id": 2608071, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/2abaf849fb1d66c9864af9384183b3c2?s=128&d=identicon&r=PG", "display_name": "TriHard8", "link": "https://stackoverflow.com/users/2608071/trihard8"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422996698, "post_id": 28307302, "comment_id": 44967842, "body": "@pnuts you&#39;re right.  Let&#39;s say cell C5 holds the data which determines formatting...He just needs to make the conditioning in row 5 as $C5 and the conditioning in row 6 as $C5.  Then he can do the format painter for the remainder of the rows.  I assumed that since he knew conditional formatting, he knew about the $...The format painter will copy and paste the conditional formatting."}, {"owner": {"reputation": 602, "user_id": 2608071, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/2abaf849fb1d66c9864af9384183b3c2?s=128&d=identicon&r=PG", "display_name": "TriHard8", "link": "https://stackoverflow.com/users/2608071/trihard8"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422997312, "post_id": 28307302, "comment_id": 44968231, "body": "@pnuts I don&#39;t believe the question was asked well and if I could downvote, I would on this one.  Many of us are interpreting this differently.  I&#39;m reading it that OP has data in cell(1,1) with rows 1 and 2, based on this data, then cell(3,3) has additional data which rows 3 and 4 depend, etc.  Once you get the formatting set on rows 1 and 2, then you can highlight both rows, click format painter, then shift+end+down, beginning on row 3, and you&#39;re done..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4525744, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JIjFfhYR7l0/AAAAAAAAAAI/AAAAAAAAFiA/_UrF9rJ1xwM/photo.jpg?sz=128", "display_name": "Seth M", "link": "https://stackoverflow.com/users/4525744/seth-m"}, "edited": false, "score": 0, "creation_date": 1422993296, "post_id": 28307378, "comment_id": 44965958, "body": "Alright, I had tried that before but I didn&#39;t know that I could change the &quot;Applies to&quot; selection after creating the rule. Creating it with the row I want (below the cell) and then editing the rule to apply to the entire selection of rows I want to repeat it seems to work. Thank you!"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 1, "user_id": 4525744, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JIjFfhYR7l0/AAAAAAAAAAI/AAAAAAAAFiA/_UrF9rJ1xwM/photo.jpg?sz=128", "display_name": "Seth M", "link": "https://stackoverflow.com/users/4525744/seth-m"}, "edited": false, "score": 0, "creation_date": 1422993474, "post_id": 28307378, "comment_id": 44966049, "body": "yeah, &quot;changing&quot; conditional formatting can be touchy. I usually find it best to highlight all cells you want affected, note which cell is &quot;active&quot; (it&#39;ll show as the one that doesn&#39;t quite look highlighted :) ) and then put in the formula based on that cell as a reference point."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422994227, "post_id": 28307378, "comment_id": 44966484, "body": "@pnuts - not quite. the formula is on row 5, so it can only change the format of row 5. it can, however, REFERENCE other rows, such as row 6 (ie $g6)."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422995076, "post_id": 28307378, "comment_id": 44966916, "body": "@pnuts Oh I see, yeah, the way the OP worded the question, I misread it. So yeah, should set the conditional formatting on &quot;row 6&quot; to =$g5=value.  Either way, the method is clear - conditional formatting can look to other cells/rows to figure out if it should format or not."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1422995587, "post_id": 28307378, "comment_id": 44967214, "body": "depends on how complex they are, but yeah, sure. You could either setup a really complex formula that looked at current row, and row above to see what to change to. Or you set up 2 rules, 1 to look at current row, 1 to look at previous row."}], "tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": false, "score": 1, "last_activity_date": 1422995679, "last_edit_date": 1422995679, "creation_date": 1422992557, "answer_id": 28307378, "question_id": 28307302, "link": "https://stackoverflow.com/questions/28307302/changing-row-color-based-on-a-cell-in-a-different-row/28307378#28307378", "title": "Changing row color based on a cell in a different row", "body": "<p>so just reference the cell.</p>\n\n<p>For example, say you have the current row want to look at the next row, column G.</p>\n\n<p>In your conditional formulas:</p>\n\n<p>in row \"5\" (for example):</p>\n\n<pre><code>=$g6=value\n</code></pre>\n\n<p>[edit] misred the question got things backwards, the above will change format for a cell based on the row <em>below</em>. If you want to change the format for a cell based on the row <em>above</em>, of course, just flip the logic, in short, you can reference any cell/row to change the format for a given cell within the conditional formatting[edit]</p>\n\n<p>and set the background.\nThe $ in front of the G makes sure that no matter what column you're looking at, it'll always look at column g value. leave the 6 \"floating\", and it'll stay \"relative\" to your current row. So you're on row 5, with the formula pointing to 6, so copy that down 10 rows, and row 7 will look to row 8, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1422993447, "creation_date": 1422993447, "answer_id": 28307619, "question_id": 28307302, "link": "https://stackoverflow.com/questions/28307302/changing-row-color-based-on-a-cell-in-a-different-row/28307619#28307619", "title": "Changing row color based on a cell in a different row", "body": "<p>Sat your status column is C and for that you have chosen that ColumnsA:N are highlighted yellow with a CF formula rule of:  </p>\n\n<pre><code>=$C1=\"s\"  \n</code></pre>\n\n<p>and Applies to </p>\n\n<pre><code>=$A:$N \n</code></pre>\n\n<p>To extend that to colour highlight also the row immediately below each \"s\" in ColumnC, select C2 and adjust the rule to:</p>\n\n<pre><code> =OR($C1=\"s\",$C2=\"s\")  \n</code></pre>\n\n<p>and the Applies to range to:  </p>\n\n<pre><code>  =$A$2:$N$1048573\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4525744, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JIjFfhYR7l0/AAAAAAAAAAI/AAAAAAAAFiA/_UrF9rJ1xwM/photo.jpg?sz=128", "display_name": "Seth M", "link": "https://stackoverflow.com/users/4525744/seth-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1134, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1423113038, "creation_date": 1422992295, "last_edit_date": 1531161705, "question_id": 28307302, "link": "https://stackoverflow.com/questions/28307302/changing-row-color-based-on-a-cell-in-a-different-row", "title": "Changing row color based on a cell in a different row", "body": "<p>I have an Excel doc of projects with a status column, and each project consists of two rows. I have already used conditional formatting to change the background color of a row depending on the status, but I need to also change the color of the row below based on the same status cell. The cell in the blank row also has a blank status.</p>\n\n<p>Is there a conditional formatting or macro I can use to do this? Thanks.</p>\n"}, {"tags": ["excel", "merge", "duplicates", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2363016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccb4df7876bf6bee918a8b608ccf1bc?s=128&d=identicon&r=PG", "display_name": "Fiernaq", "link": "https://stackoverflow.com/users/2363016/fiernaq"}, "edited": false, "score": 0, "creation_date": 1440512586, "post_id": 28307300, "comment_id": 52297178, "body": "I wanted to post on here that this is good information although I was unable to use it to solve my problem.  Hopefully it&#39;ll help someone else though."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 13, "user_id": 2363016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccb4df7876bf6bee918a8b608ccf1bc?s=128&d=identicon&r=PG", "display_name": "Fiernaq", "link": "https://stackoverflow.com/users/2363016/fiernaq"}, "edited": false, "score": 0, "creation_date": 1440512632, "post_id": 28307300, "comment_id": 52297224, "body": "Oh? why not? did it throw an error? or just additional requirements you have that screw it up? ;)"}, {"owner": {"reputation": 13, "user_id": 2363016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccb4df7876bf6bee918a8b608ccf1bc?s=128&d=identicon&r=PG", "display_name": "Fiernaq", "link": "https://stackoverflow.com/users/2363016/fiernaq"}, "edited": false, "score": 0, "creation_date": 1440514191, "post_id": 28307300, "comment_id": 52298517, "body": "Additional requirements.  Lack of a single unique column that I could rely on to always be present added to the complexity.  Basically, the data coming in wasn&#39;t enough to perform the automation I desired.  I&#39;m not familiar with this site&#39;s etiquette, should I upvote your solution since the information is valid for the small sample I posted?"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 13, "user_id": 2363016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccb4df7876bf6bee918a8b608ccf1bc?s=128&d=identicon&r=PG", "display_name": "Fiernaq", "link": "https://stackoverflow.com/users/2363016/fiernaq"}, "edited": false, "score": 0, "creation_date": 1440514675, "post_id": 28307300, "comment_id": 52298871, "body": "Hmm .. not really sure myself :) lol   I suppose you could do that, and post another question with more info, or just update your original post with the additional info ... either&#39;s fine I suspect. :)"}], "tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": false, "score": 0, "last_activity_date": 1422992291, "creation_date": 1422992291, "answer_id": 28307300, "question_id": 28306962, "link": "https://stackoverflow.com/questions/28306962/macro-vba-to-merge-rows-for-non-unique/28307300#28307300", "title": "Macro/VBA to merge rows for non-unique", "body": "<p>You could try this:\nI find formulas work so much easier/faster than vba .. so I try to use vba as little as possible.</p>\n\n<p>First, create a new column, with the following formula:</p>\n\n<pre><code>=IF(ISNA(MATCH(F2,OFFSET(F2,-1*(ROW(G2)-1),0,ROW(G2)-1,1),0)), FALSE, TRUE)\n</code></pre>\n\n<p>The intent of that formula is to return TRUE if the current record is a duplicate of anything above it. For now, it just checks the Serial Number, however, in the FALSE section, you could dup the logic a little and change the columns to check the MAC Address in a similar fashion if you wanted.</p>\n\n<p>I added that formula in column G.  In cell H1, I added this formula: </p>\n\n<pre><code>=COUNTA(G:G)\n</code></pre>\n\n<p>(I also named this cell \"numrows\" )</p>\n\n<p>Then in vba, I did the following:</p>\n\n<pre><code>  Sub Macro1()\n    Dim r As Integer\n\n    r = Range(\"numrows\").Value\n\n    For i = r To 2 Step -1\n      If Cells(i, 7).Value Then\n          Rows(i).Select\n          Selection.Delete Shift:=xlUp\n          Cells(i, 1).Select\n      End If\n    Next i\n  End Sub\n</code></pre>\n\n<p>and that seems to do the trick.\nby keeping the formula outside of vba, it should make it a bit easier to tweak it to help id the records. Then the vba script simply looks for that \"trigger\" column, and deletes based on this.\nThis actually allows you to \"override\" manually if you wanted, to delete a record or two that you know you want gone.</p>\n"}], "owner": {"reputation": 13, "user_id": 2363016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccb4df7876bf6bee918a8b608ccf1bc?s=128&d=identicon&r=PG", "display_name": "Fiernaq", "link": "https://stackoverflow.com/users/2363016/fiernaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422992291, "creation_date": 1422991032, "last_edit_date": 1531164843, "question_id": 28306962, "link": "https://stackoverflow.com/questions/28306962/macro-vba-to-merge-rows-for-non-unique", "title": "Macro/VBA to merge rows for non-unique", "body": "<p>I have a spreadsheet with a data connection to a tab delineated text file.  The text file is generated by using the export feature from a program called NetScan by SoftPerfect.  Each report is real-time and does not include data from computers that are not currently turned on or connected to the network.  This means that a newer report might be missing a computer that an older report had but it might also contain updated information for a computer that had more memory added or something else like that.</p>\n\n<p>So, on the spreadsheet I can refresh the data connection to update from the text file but since the text file is being appended to rather than replaced each time I wind up with a LOT of duplicate computer entries (the entire row may or may not be completely duplicate).  I'd like to merge the rows so that I have one row for each computer.</p>\n\n<p>Small piece of sample data (all fake) - note that there are many more columns in the full spreadsheet but this sample data contains all the info that I plan to filter/merge by:</p>\n\n<pre><code>A               B           C                   D               E       F\nIP Address      Host Name   MAC Address         Response Time   Dups    Serial Number\n192.168.1.110   CLT-001     XX:XX:XX:XX:XX:C5   0 ms            2       ABC123\n192.168.1.174   CLT-001     XX:XX:XX:XX:XX:FE   5 ms            1       ABC123\n192.168.1.110   CLT-001     XX:XX:XX:XX:XX:C5   1 ms            2       ABC123\n192.168.1.138   CLT-004     XX:XX:XX:XX:XX:04   1 ms            2       DEF456\n192.168.1.146   CLT-009     XX:XX:XX:XX:XX:8E   1 ms            2       GHI789\n192.168.1.121   CLT-004     XX:XX:XX:XX:XX:04   1 ms            2       DEF456\n192.168.1.146   NA          XX:XX:XX:XX:XX:8E   1 ms            2       NA\n192.168.1.152   CLT-005     XX:XX:XX:XX:XX:6B   1 ms            1       JKL012\n</code></pre>\n\n<p>The Serial Number is how to identify a unique computer but sometimes the scan cannot obtain the S/N (WMI error) in which case the next best bet is MAC Address.  The problem with MAC Address is that most of these laptops will eventually wind up registering 2 per computer - one for wired and one for wireless.</p>\n\n<p>I tried using <code>=COUNTIF(Row,ItemToCount)</code> (that's what column E is in the example data) but I'm not sure how to use the information I get from it.  Also, this whole thing needs to be done in VBA so I can include it in my data cleanup button on the main sheet of the workbook.  My goal is to end up with data that looks like this:</p>\n\n<pre><code>A               B           C                   D               E       F\nIP Address      Host Name   MAC Address         Response Time   Dups    Serial Number\n192.168.1.110   CLT-001     XX:XX:XX:XX:XX:C5   0 ms            1       ABC123\n192.168.1.146   CLT-009     XX:XX:XX:XX:XX:8E   1 ms            1       GHI789\n192.168.1.121   CLT-004     XX:XX:XX:XX:XX:04   1 ms            1       DEF456\n192.168.1.152   CLT-005     XX:XX:XX:XX:XX:6B   1 ms            1       JKL012\n</code></pre>\n\n<p>One concept I considered was using the Response Time to indicate whether the connection was wired or wireless which should be accurate enough for my purposes.  0 or 1ms indicates wired while 2ms or more indicates wireless.  The other option is to add more WMI calls to identify the type of network card that way and filter them out before the report even gets to the exported text file.</p>\n\n<p>At this point, any help would be appreciated.  The closest thing I could find on these forums was the <a href=\"https://superuser.com/questions/635489/conditional-removal-of-duplicates-from-excel\">Conditional Removal of Duplicates from Excel</a> question.  Other forums such as mrexcel, excelforum, and ozgrid didn't have any obvious answers either although there are so many posts with nearly similar questions that finding what I'm looking for is rather difficult.  Thanks!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1423032871, "post_id": 28306680, "comment_id": 44979904, "body": "I believe your line of code is a part of SQL query. If so, why don&#39;t you show us complete query?"}], "answers": [{"tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 0, "last_activity_date": 1423048876, "creation_date": 1423048876, "answer_id": 28320099, "question_id": 28306680, "link": "https://stackoverflow.com/questions/28306680/access-dmax-as-query-criteria-but-dmaxing-groups-of-records-not-entire-query/28320099#28320099", "title": "Access DMax as query criteria, but Dmaxing groups of records, not entire query", "body": "<p>You need a GROUP BY Query on the [Number] too. Something like,</p>\n\n<pre><code>SELECT \n    [Number],\n    Max(Sequence) As MaxOfSeq\nFROM\n    tableName\nGROUP BY \n    [Number];\n</code></pre>\n\n<p>This would give you a result like</p>\n\n<pre><code>Number  |   MaxOfSeq\n--------+-----------\n100     |   3\n101     |   2\n102     |   3\n104     |   4\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "accepted_answer_id": 28320099, "answer_count": 1, "score": 1, "last_activity_date": 1423048876, "creation_date": 1422989995, "question_id": 28306680, "link": "https://stackoverflow.com/questions/28306680/access-dmax-as-query-criteria-but-dmaxing-groups-of-records-not-entire-query", "title": "Access DMax as query criteria, but Dmaxing groups of records, not entire query", "body": "<p>I'm using Access 2007.</p>\n\n<p>I have a query that has entries for the same record by they differ by order, like this:</p>\n\n<pre><code>Number       Sequence\n100          1\n100          2\n100          3\n101          1\n101          2\n102          1\n102          2\n102          3\n102          4\n</code></pre>\n\n<p>And then I have another field that I want to only show a number on the last of the sequence for each number.  I tried this criteria:</p>\n\n<pre><code>IIf([Sequence]=DMax(\"Sequence\",\"tbl_TimeReporting\",\"\"),[do my operation],\"\")\n</code></pre>\n\n<p>But this only shows a value on 102, sequence 4, because that's the max value for the whole query.  I want it to show a value on that, but also 100, sequence 3 and 101, sequence 2, because those are the max values for each #.  I hope that makes sense.</p>\n\n<p>How might I go about doing this?</p>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1422990306, "post_id": 28306574, "comment_id": 44964394, "body": "What is the specific error message?"}, {"owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1422994095, "post_id": 28306574, "comment_id": 44966410, "body": "Run-time error &#39;-2147024809 (80070057)&#39;: This object has no title."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1422994387, "post_id": 28307274, "comment_id": 44966573, "body": "<code>S</code> is a reference to the worksheet object. My thoughts along the same line, though -- I&#39;ve revised your answer with that idea: OP should declare a variable to represent the chart object, and refer to that, rather than <code>ActiveChart</code>."}, {"owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "edited": false, "score": 0, "creation_date": 1422994399, "post_id": 28307274, "comment_id": 44966580, "body": "The suggestion you had above, unfortunately, did not prevent the error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "edited": false, "score": 0, "creation_date": 1422994436, "post_id": 28307274, "comment_id": 44966604, "body": "@JMichael please try the revised answer."}, {"owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "edited": false, "score": 0, "creation_date": 1422995714, "post_id": 28307274, "comment_id": 44967293, "body": "Using a ChartObject did though. Code is in separate answer (too long for comment)"}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1422994388, "last_edit_date": 1422994388, "creation_date": 1422992192, "answer_id": 28307274, "question_id": 28306574, "link": "https://stackoverflow.com/questions/28306574/chart-title-inexplicably-disappearing/28307274#28307274", "title": "Chart Title inexplicably disappearing", "body": "<p>I'd need the specific error, but I've had weird quirks with selected/Active objects.  If that's a reference to the chart then you should be able to replace those ActiveChart references with \"S\". Depending on your version of Excel it may be S.Chart.SeriesCollection... </p>\n\n<p>Something to test, see 'this line</p>\n\n<pre><code>Dim cht as Chart\n\nSet cht = S.Shapes.AddChart2(227, xlLine).Chart\ncht.SetElement (msoElementChartTitleAboveChart) 'this line\ncht.SeriesCollection.NewSeries\ncht.FullSeriesCollection(1).Name = \"=\" &amp; S.Name &amp; \"!$H$1\"\ncht.FullSeriesCollection(1).Values = \"=\" &amp; S.Name &amp; \"!$H$2:$H$\" &amp; i\ncht.FullSeriesCollection(1).XValues = \"=\" &amp; S.Name &amp; \"!$G$2:$G$\" &amp; i\ntemp = 0\nDo While cht.HasTitle = False\n    If temp &lt;= 5 Then\n        cht.HasTitle = True\n        temp = temp + 1\n    Else\n        MsgBox \"The script failed to add a title to the chart on \" &amp; S.Name\n    End If\nLoop\nIf cht.HasTitle Then\n    cht.ChartTitle.Text = S.Name\nEnd If\n</code></pre>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/563058-interesting-visual-basic-applications-problem.html\" rel=\"nofollow\">taken from here</a></p>\n"}, {"tags": [], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "is_accepted": true, "score": 1, "last_activity_date": 1422995889, "creation_date": 1422995889, "answer_id": 28308271, "question_id": 28306574, "link": "https://stackoverflow.com/questions/28306574/chart-title-inexplicably-disappearing/28308271#28308271", "title": "Chart Title inexplicably disappearing", "body": "<p>The code I ultimately went with follows. All the credit to Jimmy Smith and David Zemens though, they got me here, just wanted to capture end state for anyone who finds this page in the future</p>\n\n<pre><code>Dim ch as ChartObject\n\nSet ch = S.ChartObjects.Add(Left:=Range(\"J2\").Left, Top:=Range(\"J2\").Top, Width:=500, Height:=325)\nch.Chart.SeriesCollection.NewSeries\nch.Chart.FullSeriesCollection(1).Name = \"=\" &amp; S.Name &amp; \"!$H$1\"\nch.Chart.FullSeriesCollection(1).Values = \"=\" &amp; S.Name &amp; \"!$H$2:$H$\" &amp; i\nch.Chart.FullSeriesCollection(1).XValues = \"=\" &amp; S.Name &amp; \"!$G$2:$G$\" &amp; i\nch.Chart.ChartType = xlLine\ntemp = 0\nDo While ch.Chart.HasTitle = False\n    If temp &lt;= 5 Then\n        ch.Chart.HasTitle = True\n        temp = temp + 1\n    Else\n        MsgBox \"The script failed to add a title to the chart on \" &amp; S.Name\n    End If\nLoop\nIf ch.Chart.HasTitle Then\n    ch.Chart.ChartTitle.Text = S.Name\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 28308271, "answer_count": 2, "score": 0, "last_activity_date": 1423113056, "creation_date": 1422989604, "last_edit_date": 1423113056, "question_id": 28306574, "link": "https://stackoverflow.com/questions/28306574/chart-title-inexplicably-disappearing", "title": "Chart Title inexplicably disappearing", "body": "<p>I have a macro that is creating a chart on each tab in a given workbook (after doing some other things). As a part of that, the chart is supposed to have a title added, with the title set to the sheet name. Below is how I tried to do that:</p>\n\n<pre><code>S.Shapes.AddChart2(227, xlLine).Select\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(1).Name = \"=\" &amp; S.Name &amp; \"!$H$1\"\nActiveChart.FullSeriesCollection(1).Values = \"=\" &amp; S.Name &amp; \"!$H$2:$H$\" &amp; i\nActiveChart.FullSeriesCollection(1).XValues = \"=\" &amp; S.Name &amp; \"!$G$2:$G$\" &amp; i\ntemp = 0\nDo While ActiveChart.HasTitle = False\n    If temp &lt;= 5 Then\n        ActiveChart.HasTitle = True\n        temp = temp + 1\n    Else\n        MsgBox \"The script failed to add a title to the chart on \" &amp; S.Name\n    End If\nLoop\nIf ActiveChart.HasTitle Then\n    ActiveChart.ChartTitle.Text = S.Name\nEnd If\n</code></pre>\n\n<p>For context, i is the last row of data for that sheet (dynamically set based on the number of data points on that sheet), and S is a Worksheet variable holding the current sheet, temp is just an all purpose counter I added to prevent an infinite loop.</p>\n\n<p>The thing that really gets me is that the error occurs on the second to last line in the snippet above. For the macro to have even gotten there, there had to have been a chart title. But then the error thrown says there isn't one.</p>\n\n<p>The error doesn't occur if I step through the code above each time, but turning screenupdates back on and activating S does not prevent the error. </p>\n\n<p>So it seems like there's some context that's not handled by the code correctly, but I can't figure out what I'm missing.</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1422989859, "post_id": 28306364, "comment_id": 44964183, "body": "how many rows is there?"}, {"owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1422990075, "post_id": 28306364, "comment_id": 44964307, "body": "HeadsTable currently contains 175, producing a little over 4000 in the AllocatedHeads table."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1422991302, "post_id": 28306364, "comment_id": 44964883, "body": "I think a sample of data might help clarify exactly what it is you&#39;re doing here."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1422991738, "post_id": 28306364, "comment_id": 44965095, "body": "It will be <b>MUCH</b> faster if you write your table into an array that you have pre-dimensioned, and then write it to a worksheet range in a single step.  e.g: <code>ReDim V(1 to numrows, 1 to numcolumns)</code>; then fill in all the cells; then <code>Range(cell_ref).Resize(ubound(v,1),ubound(v,2)).Value = V</code>"}, {"owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "edited": false, "score": 0, "creation_date": 1422992076, "post_id": 28306364, "comment_id": 44965303, "body": "This is a possibility.  I was hoping to make it so that the AllocatedHeads table columns do not have to be arranged the same way as the HeadsTable.  I don&#39;t think your solution allows for that, but it may be worth setting them up that way."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1423015118, "post_id": 28306364, "comment_id": 44974839, "body": "@DougClarke If you are responding to me, then read your original data into one VBA array; then create a different array to hold the results -- can be in whatever order you want; you may want to create a Class object and a collection to collect and massage the data; put the collection into the new array and write the results back to the worksheet."}, {"owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1423077970, "post_id": 28306364, "comment_id": 45006753, "body": "Thanks @Ron Rosenfeld.  That is probably faster, however I thought the code I posted in my answer was easier to implement based on what I had already done."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "is_accepted": false, "score": 0, "last_activity_date": 1423077862, "creation_date": 1423077862, "answer_id": 28329672, "question_id": 28306364, "link": "https://stackoverflow.com/questions/28306364/fastest-way-to-fill-an-excel-table/28329672#28329672", "title": "Fastest way to fill an excel table", "body": "<p>My solution was to convert to a range, fill in the cells, and convert back to a table.  Filling in cells in a range is MUCH quicker than in a table.  I also took advantage of the fact that filling in the first cell in a table column turns it into a calculated field.  By using formulas in those fields I reduced the number of fields I was storing in my Entry object and the number of cells I needed to fill in.  I am sure that there are much faster ways, but this solution brings it down from hours to under a minute, which is good enough for my needs.  The code beow doesn't show the entire sub, only the relevant portion.</p>\n\n<pre><code>    'determine needed size for Allocated heads table\n        AllocatedHeadsRowCount = 0\n        For Each Entry In HeadsCollection.Entries\n        AllocatedHeadsRowCount = AllocatedHeadsRowCount + (UBound  (Entry.PALSOS) * UBound(Entry.Service))\n        Next Entry\n\n    'determine Absolute row (sheet row, instead of listobject row) of first row in table\n    Dim AbsRow As Long\n    AbsRow = [AllocatedHeads].ListObject.HeaderRowRange.Row + 1\n\n    'delete all table rows\n    If [AllocatedHeads].ListObject.ListRows.Count &gt; 0 Then\n        'clear table, add one row, get row value\n        [AllocatedHeads].ListObject.DataBodyRange.Rows.Delete\n    End If\n\n    'assign number values of header row, first table column, number of column\n    AllocatedHeadsStartRow = [AllocatedHeads].ListObject.HeaderRowRange.Row\n    AllocatedHeadsStartColumn = [AllocatedHeads].ListObject.HeaderRowRange.Column\n    AllocatedNumberofColumns = [AllocatedHeads].ListObject.HeaderRowRange.Columns.Count\n\n    'dimension field column variables\n    Dim Heads_IDCol As Integer\n    Dim PALS_OSCol As Integer\n    Dim ServiceCol As Integer\n\n    'assign column values to variables\n    Heads_IDCol = [AllocatedHeads[Heads_ID]].Column\n    PALS_OSCol = [AllocatedHeads[PALS/O&amp;S]].Column\n    ServiceCol = [AllocatedHeads[Service]].Column\n\n    'convert table to range because filling cells in a range is MUCH faster than in a table\n    [AllocatedHeads].ListObject.Unlist\n\n    'fill ID, PALS/O&amp;S, and Service columns\n    For Each Entry In HeadsCollection.Entries\n        For i = 1 To UBound(Entry.PALSOS)\n            For j = 1 To UBound(Entry.Service)\n            Cells(AbsRow, Heads_IDCol) = Entry.ID\n            Cells(AbsRow, PALS_OSCol) = Entry.PALSOS(i - 1)\n            Cells(AbsRow, ServiceCol) = Entry.Service(j - 1)\n            AbsRow = AbsRow + 1\n            Next j\n        Next i\n    Next Entry\n\n    'convert back to table\n    With Sheets(\"Allocated Heads\").ListObjects.Add(xlSrcRange, Range(Cells(AllocatedHeadsStartRow, AllocatedHeadsStartColumn), Cells(AllocatedHeadsStartRow + AllocatedHeadsRowCount, AllocatedHeadsStartColumn + AllocatedNumberofColumns - 1)), , xlYes)\n    .Name = \"AllocatedHeads\"\n    .TableStyle = \"TableStyleMedium7\"\n    End With\n\n    'add formulas to the first cell in columns for which the data is the same as in the heads table.\n    'This creates a calculated column and will fill down\n    [AllocatedHeads].ListObject.ListColumns(\"Service Share Rule\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[Service Share Rule]:[Service Share Rule]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"PALS/O&amp;S Split\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[PALS/O&amp;S Split]:[PALS/O&amp;S Split]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"Org Tier 1\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[Org Tier 1]:[Org Tier 1]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"Org Tier 2\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[Org Tier 2]:[Org Tier 2]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"Org Tier 3\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[Org Tier 3]:[Org Tier 3]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"LM WBS\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[LM WBS]:[LM WBS]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"Description\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[[Description]:[Description]])\"\n    [AllocatedHeads].ListObject.ListColumns(\"2009\").DataBodyRange = \"=LOOKUP(AllocatedHeads[@[Heads_ID]:[Heads_ID]],HeadsTable[[ID]:[ID]],HeadsTable[2009])*SUMPRODUCT((AllocatedHeads[@[PALS/O&amp;S Split]:[PALS/O&amp;S Split]] = SplitTable[[Split Name]:[Split Name]])*(AllocatedHeads[@[PALS/O&amp;S]:[PALS/O&amp;S]] = SplitTable[[PALS/O&amp;S]:[PALS/O&amp;S]])*SplitTable[2009])*SUMPRODUCT((AllocatedHeads[@[Service Share Rule]:[Service Share Rule]]=SplitTable[[Split Name]:[Split Name]])*(AllocatedHeads[@[Service]:[Service]]=SplitTable[[Service]:[Service]])*SplitTable[2009])\"\n\n    'Fill years columns by first drragging across(to have appropriate column references),\n    'then copy pasting in place in order to create calculated columns\n    Dim FirstCell As Range\n    Dim FillRange As Range\n    Set FirstCell = Intersect([AllocatedHeads].ListObject.DataBodyRange.Rows(1), [AllocatedHeads[2009]])\n    Set FillRange = Range(FirstCell.Address, Cells(FirstCell.Row, [AllocatedHeads].ListObject.Range.SpecialCells(xlLastCell).Column))\n    FirstCell.AutoFill FillRange, xlFillDefault\n    FillRange.Copy\n    FirstCell.PasteSpecial xlPasteFormulas\n\n    'create calculated column in Total column\n    [AllocatedHeads].ListObject.ListColumns(\"Total\").DataBodyRange = \"=SUM(\" &amp; FirstCell.Address(False, False) &amp; \":\" &amp; Cells(FirstCell.Row, [AllocatedHeads].ListObject.Range.SpecialCells(xlLastCell).Column).Address(False, False) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4525451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8379e60803cac187e1b31bf80610647?s=128&d=identicon&r=PG", "display_name": "Doug Clarke", "link": "https://stackoverflow.com/users/4525451/doug-clarke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1587, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423077862, "creation_date": 1422988868, "question_id": 28306364, "link": "https://stackoverflow.com/questions/28306364/fastest-way-to-fill-an-excel-table", "title": "Fastest way to fill an excel table", "body": "<p>I am working on a sub which will take data from one table (HeadsTable) and fill it into the appropriate place in another table (AllocatedHeads).  The HeadsTable contains headcount data by year.  These headcounts need to be split by a number of stakeholders and funding types.  The AllocatedHeads table will have a row for each stakeholder and funding type so one entry in the HeadsTable corresponds to multiple in the AllocatedHeads table(up to 30).  The headcounts themselves I am filling in with excel formulas, but I want the macro to fill in all of the decriptive data from the heads table.</p>\n\n<p>I have created a HeadsEntry Class which holds all of the field data for an entry from HeadsTable and a HeadsCollection Class which is just a collection of all of the HeadsEntry Objects.</p>\n\n<p>I am happy to show my entire sub, but what is shown here relates to my efforts to fill the table by iterating over the HeadsCollection.  The code below is functional, but takes a REALLY long time.  Hours.  My first attempt also worked and is shown in the comments.  It also took hours to run.  </p>\n\n<p>Is there a way I can accomplish this task in a more reasonable run time?</p>\n\n<pre><code>    Dim AbsRow As Long\n\n    If [AllocatedHeads].ListObject.ListRows.Count &gt; 0 Then\n        'clear table, add one row, get row value\n        [AllocatedHeads].ListObject.DataBodyRange.Rows.Delete\n        [AllocatedHeads].ListObject.ListRows.Add\n        AbsRow = [AllocatedHeads].ListObject.ListRows(1).Range.Row\n    End If\n    'dimension field column variables\n    Dim DescriptionCol As Integer\n    Dim LMWBSCol As Integer\n    Dim Org1Col As Integer\n    Dim Org2Col As Integer\n    Dim Org3Col As Integer\n    Dim PALS_OSsplitCol As Integer\n    Dim ServiceShareRuleCol As Integer\n    Dim Heads_IDCol As Integer\n    Dim PALS_OSCol As Integer\n    Dim ServiceCol As Integer\n\n    'assign column values to variables\n    DescriptionCol = [AllocatedHeads[Description]].Column\n    LMWBSCol = [AllocatedHeads[LM WBS]].Column\n    Org1Col = [AllocatedHeads[Org Tier 1]].Column\n    Org2Col = [AllocatedHeads[Org Tier 2]].Column\n    Org3Col = [AllocatedHeads[Org Tier 3]].Column\n    PALS_OSsplitCol = [AllocatedHeads[PALS/O&amp;S Split]].Column\n    ServiceShareRuleCol = [AllocatedHeads[Service Share Rule]].Column\n    Heads_IDCol = [AllocatedHeads[Heads_ID]].Column\n    PALS_OSCol = [AllocatedHeads[PALS/O&amp;S]].Column\n    ServiceCol = [AllocatedHeads[Service]].Column\n\n'    RowNum = 1\n    For Each Entry In HeadsCollection.Entries\n        For i = 1 To UBound(Entry.PALSOS)\n            For j = 1 To UBound(Entry.Service)\n'            [AllocatedHeads].ListObject.ListRows.Add\n'            AbsRow = [AllocatedHeads].ListObject.ListRows(RowNum).Range.Row\n            Cells(AbsRow, DescriptionCol) = Entry.Description\n            Cells(AbsRow, LMWBSCol) = Entry.LMWBS\n            Cells(AbsRow, Org1Col) = Entry.Org1\n            Cells(AbsRow, Org2Col) = Entry.Org2\n            Cells(AbsRow, Org3Col) = Entry.Org3\n            Cells(AbsRow, PALS_OSsplitCol) = Entry.PALSOSsplit\n            Cells(AbsRow, ServiceShareRuleCol) = Entry.ServiceRule\n            Cells(AbsRow, Heads_IDCol) = Entry.ID\n            Cells(AbsRow, PALS_OSCol) = Entry.PALSOS(i - 1)\n            Cells(AbsRow, ServiceCol) = Entry.Service(j - 1)\n            AbsRow = AbsRow + 1\n'            Set RowRange = [AllocatedHeads].ListObject.ListRows(RowNum).Range\n'            Intersect(RowRange, [AllocatedHeads[Description]]) = Entry.Description\n'            With Intersect(RowRange, [AllocatedHeads[LM WBS]])\n'            .value = Entry.LMWBS\n'            .NumberFormat = \"@\"\n'            End With\n'            Intersect(RowRange, [AllocatedHeads[Org Tier 1]]) = Entry.Org1\n'            Intersect(RowRange, [AllocatedHeads[Org Tier 2]]) = Entry.Org2\n'            Intersect(RowRange, [AllocatedHeads[Org Tier 3]]) = Entry.Org3\n'            Intersect(RowRange, [AllocatedHeads[PALS/O&amp;S Split]]) = Entry.PALSOSsplit\n'            Intersect(RowRange, [AllocatedHeads[Service Share Rule]]) = Entry.ServiceRule\n'            Intersect(RowRange, [AllocatedHeads[Heads_ID]]) = Entry.ID\n'            Intersect(RowRange, [AllocatedHeads[PALS/O&amp;S]]) = Entry.PALSOS(i - 1)\n'            Intersect(RowRange, [AllocatedHeads[Service]]) = Entry.Service(j - 1)\n'            RowNum = RowNum + 1\n            Next j\n        Next i\nNext Entry\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 4, "creation_date": 1486639969, "post_id": 28306279, "comment_id": 71437345, "body": "actually you just need one line of coding <code>Range(&quot;A1:I&quot; &amp; Range(&quot;A1&quot;).End(xlDown).Row).Select</code>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 6, "last_activity_date": 1422988576, "creation_date": 1422988576, "answer_id": 28306279, "question_id": 28306140, "link": "https://stackoverflow.com/questions/28306140/select-cells-in-range-until-row-is-blank/28306279#28306279", "title": "Select Cells in Range until row is blank", "body": "<p>Try this:</p>\n\n<pre><code>Sub hfjksaf()\n    Dim N As Long\n    N = Cells(1, 1).End(xlDown).Row\n    Range(\"A1:I\" &amp; N).Select\nEnd Sub\n</code></pre>\n\n<p>For example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/qz3cq.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 41, "user_id": 4525477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56cc24eb154e24cbf1bda57637472d7b?s=128&d=identicon&r=PG&f=1", "display_name": "mmariano", "link": "https://stackoverflow.com/users/4525477/mmariano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47684, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1507771936, "creation_date": 1422988075, "question_id": 28306140, "link": "https://stackoverflow.com/questions/28306140/select-cells-in-range-until-row-is-blank", "title": "Select Cells in Range until row is blank", "body": "<p>I have a spread sheet that will always be from Columns A to I but the range of the amount of rows can vary. I want to Select all cells in range (A1:I20000) until the first blank cell in column A, so if the data ends at 202 it will stop selecting the rows at line 202.</p>\n\n<p>I tried writing my own formula but unfortunately columns B, C, E, and H continued to select down to row 20000</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1422987636, "post_id": 28305717, "comment_id": 44962997, "body": "Are you getting a specific error?  Have you stepped through your code to see what the form thinks the value is?  It may just be a refresh issue."}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1422990252, "post_id": 28305717, "comment_id": 44964372, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/14197687/accessing-the-value-of-a-control-on-other-form-in-access-2010\">Accessing the value of a control on other form in access 2010</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4241173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KXGWfBtpiWA/AAAAAAAAAAI/AAAAAAAAAuM/LyylWX6ufPI/photo.jpg?sz=128", "display_name": "Scott Willis", "link": "https://stackoverflow.com/users/4241173/scott-willis"}, "is_accepted": false, "score": 0, "last_activity_date": 1422989616, "creation_date": 1422989616, "answer_id": 28306577, "question_id": 28305717, "link": "https://stackoverflow.com/questions/28305717/pass-values-between-forms-in-access-2010-vba/28306577#28306577", "title": "Pass values between forms in access 2010 vba", "body": "<p>This is the standard way we do it.</p>\n\n<pre><code>stFrmName = \"Com_pedordmon\"\nstLinkCriteria = me.cd.value\n\nDoCmd.OpenForm stFrmName, , , stLinkCriteria\n</code></pre>\n\n<p>Then in the Com_pedordmon OnLoad/OnOpen event grab the criteria and set your control property.</p>\n"}], "owner": {"reputation": 1650, "user_id": 1483520, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b858e747a79c31d8270fb558d98e96b2?s=128&d=identicon&r=PG", "display_name": "alejandro carnero", "link": "https://stackoverflow.com/users/1483520/alejandro-carnero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422989616, "creation_date": 1422986684, "last_edit_date": 1422988534, "question_id": 28305717, "link": "https://stackoverflow.com/questions/28305717/pass-values-between-forms-in-access-2010-vba", "title": "Pass values between forms in access 2010 vba", "body": "<p>I have a combobox in an  access 2010 form , named cd_numero I need to pass the value to another form I have try this way:</p>\n\n<pre><code>     DoCmd.OpenForm \"com_PedsOrdMon\", acNormal, , , acFormAdd, acDialog\n     Forms!com_pedsordmon!cd.value = me.cd.value\n\n    Me.Requery\n</code></pre>\n\n<p>the destination form is com_PedsOrdMon and the control is label3, what is wrong in the line form.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1422986316, "post_id": 28305234, "comment_id": 44962308, "body": "Comments, like most Shapes, do not generate a hit on the SelectionChange event.  Unlike many Shapes, you can&#39;t even assign a macro to Comments."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4525041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f619bf9fb0b231a3e9af46601ee1d219?s=128&d=identicon&r=PG&f=1", "display_name": "user4525041", "link": "https://stackoverflow.com/users/4525041/user4525041"}, "edited": false, "score": 0, "creation_date": 1423073419, "post_id": 28308097, "comment_id": 45004314, "body": "Thanks for the suggestion.  Yes, this works if the user clicks on a cell containing the comment when the comments are hidden.  I had that part working.  But when the user has comments shown and clicks within the comment box itself, it doesn&#39;t seem to trigger a SelectionChange event because they aren&#39;t really selecting a cell on a sheet.  I put a MsgBox statement inside the SelectionChange and it doesn&#39;t show when I click inside a comment box.  But Excel must somehow know when you click within a comment, which cell the comment belongs to because it shows the cell in the status bar."}, {"owner": {"reputation": 11, "user_id": 4525902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b25ed87fdcdff32de363182701a21c?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleDownAgain", "link": "https://stackoverflow.com/users/4525902/doubledownagain"}, "reply_to_user": {"reputation": 11, "user_id": 4525041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f619bf9fb0b231a3e9af46601ee1d219?s=128&d=identicon&r=PG&f=1", "display_name": "user4525041", "link": "https://stackoverflow.com/users/4525041/user4525041"}, "edited": false, "score": 0, "creation_date": 1423162678, "post_id": 28308097, "comment_id": 45047495, "body": "But there isn&#39;t an event associated with it...  You&#39;d have to trigger an event another way."}], "tags": [], "owner": {"reputation": 11, "user_id": 4525902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3b25ed87fdcdff32de363182701a21c?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleDownAgain", "link": "https://stackoverflow.com/users/4525902/doubledownagain"}, "is_accepted": false, "score": 1, "last_activity_date": 1422995137, "creation_date": 1422995137, "answer_id": 28308097, "question_id": 28305234, "link": "https://stackoverflow.com/questions/28305234/is-there-an-excel-comment-activate-or-selection-event/28308097#28308097", "title": "Is there an Excel Comment Activate or Selection Event?", "body": "<p>I do not believe there are any events for comments.</p>\n\n<p>However you could use the SelectionChange Event on the sheet:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not (Target.Comment Is Nothing) Then MsgBox Target.Comment.Text\nEnd Sub\n</code></pre>\n\n<p>To use within your Form:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)        \n    If Not (Target.Comment Is Nothing) Then\n         frmYourForm.Show\n         frmYourForm.txtComments = Target.Comment.Text\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4525041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f619bf9fb0b231a3e9af46601ee1d219?s=128&d=identicon&r=PG&f=1", "display_name": "user4525041", "link": "https://stackoverflow.com/users/4525041/user4525041"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1422995137, "creation_date": 1422985030, "last_edit_date": 1531161705, "question_id": 28305234, "link": "https://stackoverflow.com/questions/28305234/is-there-an-excel-comment-activate-or-selection-event", "title": "Is there an Excel Comment Activate or Selection Event?", "body": "<p>I am using Excel Comments to store some information that I want to allow the user to edit using a form.  I want to pre-populate the form with the text contained in the Comment when the user selects the Comment.  I can do this  when the user selects the cell with the red tab (when the Comments are hidden) using the SheetSelectionChange event.  But is there a way to do this when the Comments are shown and the user clicks inside the Comment box?  </p>\n\n<p>I can't find any events associated with Comments in the help.  Are there any Comment Events exposed to VBA?  Or can I do this with some Cell or Sheet event?  I tried putting a MsgBox inside the SheetSelectionChange Event to show the Target.ActiveCell, but when I select a Comment, I'm not getting a response, so it seems like when selecting a Comment, it is not associated with a sheet.  </p>\n\n<p>Thanks in advance for any tips.</p>\n"}, {"tags": ["sql", "ms-access", "insert", "vba", "exists"], "answers": [{"tags": [], "owner": {"reputation": 5832, "user_id": 4155665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7IH7Y.png?s=128&g=1", "display_name": "jleach", "link": "https://stackoverflow.com/users/4155665/jleach"}, "is_accepted": false, "score": 0, "last_activity_date": 1422985138, "creation_date": 1422985138, "answer_id": 28305267, "question_id": 28305210, "link": "https://stackoverflow.com/questions/28305210/insert-sql-statement/28305267#28305267", "title": "Insert SQL Statement", "body": "<p>Just put another SELECT statement in there to return the records you want to check:</p>\n\n<pre><code>WHERE EXISTS (\n  SELECT FormularyID FROM MyTable WHERE SomeCondition\n);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "edited": false, "score": 0, "creation_date": 1422985714, "post_id": 28305362, "comment_id": 44961938, "body": "It asks me to define the parameter &quot;<code>F.formularyId</code>&quot; Shouldn&#39;t there be an &quot;as&quot; in <code>FN_DataDump_ALL_02012015 F</code>?"}, {"owner": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "edited": false, "score": 0, "creation_date": 1422986052, "post_id": 28305362, "comment_id": 44962146, "body": "This works but it inserts them as new records.  I would like to add the field values to the records that already exists.  How would I do that?"}, {"owner": {"reputation": 85387, "user_id": 3349551, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/xodSn.jpg?s=128&g=1", "display_name": "P\u0bb0\u0ba4\u0bc0\u0baa\u0bcd", "link": "https://stackoverflow.com/users/3349551/p%e0%ae%b0%e0%ae%a4%e0%af%80%e0%ae%aa%e0%af%8d"}, "reply_to_user": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "edited": false, "score": 0, "creation_date": 1422986201, "post_id": 28305362, "comment_id": 44962229, "body": "@peter burke sorry didn&#39;t get you can you add sample data and expected output"}, {"owner": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "edited": false, "score": 0, "creation_date": 1422986918, "post_id": 28305362, "comment_id": 44962643, "body": "I have Added a picture of my table to the question.  This is what that SQL Query does.  It adds the information as new records.  I want to add them to the records that already exist.  Would that be possible? Maybe with an <code>UPDATE</code> Statement?"}], "tags": [], "owner": {"reputation": 85387, "user_id": 3349551, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/xodSn.jpg?s=128&g=1", "display_name": "P\u0bb0\u0ba4\u0bc0\u0baa\u0bcd", "link": "https://stackoverflow.com/users/3349551/p%e0%ae%b0%e0%ae%a4%e0%af%80%e0%ae%aa%e0%af%8d"}, "is_accepted": false, "score": 0, "last_activity_date": 1422985471, "creation_date": 1422985471, "answer_id": 28305362, "question_id": 28305210, "link": "https://stackoverflow.com/questions/28305210/insert-sql-statement/28305362#28305362", "title": "Insert SQL Statement", "body": "<p>Inside the exists operator write the select from the table you want to check in where clause join the common columns in both the tables Try this.</p>\n\n<pre><code>INSERT INTO ShouldImportMetricsIDsTable\n            (FormularyName,ClientName)\nSELECT [Formulary Name],\n       [Client Name]\nFROM   FN_DataDump_ALL_02012015 as F\nWHERE  EXISTS (SELECT 1\n               FROM   mytable as M\n               WHERE  F.formularyId = M.formularyId) \n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4525099, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7d139fc8f564daa73ce88a323a546e8c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Burke", "link": "https://stackoverflow.com/users/4525099/peter-burke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1422986829, "creation_date": 1422984953, "last_edit_date": 1422986829, "question_id": 28305210, "link": "https://stackoverflow.com/questions/28305210/insert-sql-statement", "title": "Insert SQL Statement", "body": "<p>I am trying to insert two fields into one access table from another but I only want to insert the fields for the records that exist in both tables.  I have started developing a SQL statement which I have pasted below but I am unsure of the syntax for the exists statement.  I basically want to say where FormularyID Exists in \"MyTable\". Any help with this issue would be greatly appreciated.</p>\n\n<pre><code>INSERT INTO ShouldImportMetricsIDsTable (FormularyName, ClientName)\nSELECT [Formulary Name], [Client Name]\nFROM FN_DataDump_ALL_02012015\nWHERE EXISTS (\n</code></pre>\n\n<p>TEST DATA:</p>\n\n<p><a href=\"http://imgur.com/9puR61l\" rel=\"nofollow\">http://imgur.com/9puR61l</a></p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 11, "user_id": 4524954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1978e491f713d88d4f4ef34112dd4327?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Oneal", "link": "https://stackoverflow.com/users/4524954/ryan-oneal"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422985816, "post_id": 28305093, "comment_id": 44962007, "body": "What I want to do is automate the copying of the PivotTable data, then paste as values in the next available blank row below the PivotTable. Then paste the same PivotTable again to retain the formatting, for ALL worksheets in the book. My VBA code is ngiving me multiple areas, not sure where I&#39;m going wrong."}, {"owner": {"reputation": 11, "user_id": 4524954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1978e491f713d88d4f4ef34112dd4327?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Oneal", "link": "https://stackoverflow.com/users/4524954/ryan-oneal"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1422986656, "post_id": 28305093, "comment_id": 44962501, "body": "When I run. I get &quot; Run time error 1004&quot; &quot;We can&#39;t paste because the copy area and the paste area aren&#39;t the same size&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "reply_to_user": {"reputation": 11, "user_id": 4524954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1978e491f713d88d4f4ef34112dd4327?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Oneal", "link": "https://stackoverflow.com/users/4524954/ryan-oneal"}, "edited": false, "score": 0, "creation_date": 1423746037, "post_id": 28308243, "comment_id": 45278822, "body": "Glad to have helped! Please close this question by accepting this answer (click the green tick icon next to my solution)."}], "tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": false, "score": 2, "last_activity_date": 1422996340, "last_edit_date": 1422996340, "creation_date": 1422995734, "answer_id": 28308243, "question_id": 28305093, "link": "https://stackoverflow.com/questions/28305093/excel-copying-pivot-tables-on-multiple-sheets-and-pasting-as-values-retaining/28308243#28308243", "title": "Excel - Copying pivot tables on multiple sheets and pasting as values (retaining formatting)", "body": "<p>This piece of code</p>\n\n<pre><code>Set NextRow = ws.Cells(Cells.Rows.Count).End(xlUp).Offset(1)\n</code></pre>\n\n<p>selects the very last column of your worksheet, that's why you cannot paste anything that's more than one column wide. You need to modify the logic behind finding the <code>NextRow</code>.</p>\n\n<p>EDIT: </p>\n\n<p>This minor change will do it:</p>\n\n<pre><code>Set NextRow = ws.Cells(Cells.Rows.Count, 1).End(xlUp).Offset(1)\n</code></pre>\n\n<p>Apparently, the default <code>ColumnIndex</code> parameter for Cells() is not 1, you need to explicitly set it.</p>\n"}], "owner": {"reputation": 11, "user_id": 4524954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1978e491f713d88d4f4ef34112dd4327?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Oneal", "link": "https://stackoverflow.com/users/4524954/ryan-oneal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3816, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1422996340, "creation_date": 1422984586, "question_id": 28305093, "link": "https://stackoverflow.com/questions/28305093/excel-copying-pivot-tables-on-multiple-sheets-and-pasting-as-values-retaining", "title": "Excel - Copying pivot tables on multiple sheets and pasting as values (retaining formatting)", "body": "<p>here was my project:</p>\n\n<p>I created a pivot table from a central Excel file on item pricing and data. I did \"show filter pages\" to create different worksheets for each unique entry in a particular field (created in excess of 100 worksheets). I moved all the resulting PivotTable sheets to their own workbook (titled PivotTableResults).</p>\n\n<p>What I want to do is automate the copying of the PivotTable data, then paste as values in the next available blank row below the PivotTable. Then paste the same PivotTable again to retain the formatting, for ALL worksheets in the book.</p>\n\n<p>I followed this  advice on accomplishing the PivotTable pasting values/formatting: <a href=\"http://spreadsheetpage.com/index.php/tip/unlinking_a_pivot_table_from_its_source_data/\" rel=\"nofollow\">http://spreadsheetpage.com/index.php/tip/unlinking_a_pivot_table_from_its_source_data/</a></p>\n\n<p>Here's my current code:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim ws As Worksheet\n    Dim pt As PivotTable\n    Set pt = ActiveSheet.PivotTables(1)\n\nFor Each ws In ActiveWorkbook.Worksheets\n    Dim NextRow As Range\n    Set NextRow = ws.Cells(Cells.Rows.Count).End(xlUp).Offset(1)\n    For Each pt In ws.PivotTables\n        'ws.PivotTables(\"pt\").PivotSelect \"\", xlDataAndLabel, True\n        pt.TableRange2.Copy\n        Set CurrentRow = NextRow\n        CurrentRow.Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n        Application.CutCopyMode = False\n        CurrentRow.Select\n        Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    Next pt\n\nNext ws\nEnd Sub\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["oracle", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 211530, "user_id": 10397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a116491222bf3f94c85381528593fd7?s=128&d=identicon&r=PG", "display_name": "Justin Cave", "link": "https://stackoverflow.com/users/10397/justin-cave"}, "is_accepted": false, "score": 2, "last_activity_date": 1422983881, "creation_date": 1422983881, "answer_id": 28304903, "question_id": 28304665, "link": "https://stackoverflow.com/questions/28304665/vba-query-with-multiple-and-statement-not-working/28304903#28304903", "title": "VBA - Query with multiple AND statement not working", "body": "<p>If you are going to hard-code the date range, assuming <code>announcement_date</code> is a <code>date</code>, you'd want to compare against dates, not strings.  You can use <code>to_date</code> with an explicit format mask to convert a string to a date, </p>\n\n<pre><code>sta.announcement_date &gt;= to_date( '01-January-2015', 'DD-Month-YYYY')\n</code></pre>\n\n<p>or you can use a date literal which always has the format YYYY-MM-DD</p>\n\n<pre><code>sta.announcement_date &gt;= date '2015-01-01'\n</code></pre>\n\n<p>My guess is that your code seems to work in SQL Developer because you happen to have configured your <code>NLS_DATE_FORMAT</code> to be 'DD-Month-YYYY' in SQL Developer.  </p>\n\n<p>In reality, you should really be using bind variables rather than hard-coding things like the date range.  Assuming you bind a date value, the conversion (if any) from a string to a date would happen in VB and wouldn't depend on your session's NLS settings.  There are also performance and security reasons to prefer bind variables.</p>\n"}], "owner": {"reputation": 1, "user_id": 4525119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eabd54cfde3469d650c319d244fea2f7?s=128&d=identicon&r=PG&f=1", "display_name": "Amrahir", "link": "https://stackoverflow.com/users/4525119/amrahir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423002442, "creation_date": 1422983106, "last_edit_date": 1423002442, "question_id": 28304665, "link": "https://stackoverflow.com/questions/28304665/vba-query-with-multiple-and-statement-not-working", "title": "VBA - Query with multiple AND statement not working", "body": "<p>I'm having a hard time trying to gather data from an Oracle DB. I've managed to get the connection going, so the problem lies within the query. At the moment the query dont return anything, and neither VBA complains about it.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub Connect_XXXX()\n\nDim conn As ADODB.Connection\nSet conn = New ADODB.Connection\nDim rs As New ADODB.Recordset\nSet rs = New ADODB.Recordset\nDim myQuery As ADODB.Command\nSet myQuery = New ADODB.Command\n\n\nconn.Open \"Provider=OraOLEDB.Oracle;\" &amp; _\n          \"Data Source=XXXX;\" &amp; _\n          \"User Id=YYYY;\" &amp; _\n          \"Password=ZZZZ\"\n\nmyQuery.ActiveConnection = conn\n\nmyQuery.CommandText = \"SELECT sta.index_id, sta.index_action as Action, sta.ticker, sta.company, sta.announcement_date as A_Date, sta.announcement_time as A_Time, \" &amp; _\n                        \"sta.effective_date as E_Date, dyn.index_supply_demand as BS_Shares, dyn.net_index_supply_demand as Net_BS_Shares, dyn.est_funding_trade as BS_Value, \" &amp; _\n                        \"dyn.trade_adv_perc/100 as Days_to_Trade, dyn.pre_index_weight/100 as Wgt_Old, dyn.post_index_weight/100 as Wgt_New, dyn.net_index_weight/100 as Wgt_Chg, \" &amp; _\n                        \"dyn.pre_est_index_holdings as Index_Hldgs_Old, dyn.post_est_index_holdings as Index_Hldgs_New, dyn.net_est_index_holdings as Index_Hldgs_Chg, sta.index_action_details as Details \" &amp; _\n                        \"FROM index_analysis.eq_index_actions_dyn dyn, index_analysis.eq_index_actions_static sta \" &amp; _\n                        \"WHERE (sta.action_id = dyn.action_id) AND (sta.announcement_date=dyn.price_date) AND (sta.announcement_date &gt;= '01-January-2015') AND (sta.announcement_date &lt;= '30-January-2015') \" &amp; _\n                        \"ORDER by sta.index_id,sta.announcement_date\"\n\n\n\nSet rs = myQuery.Execute\n\nSheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset rs\n\nrs.Close\nconn.Close\n\nEnd Sub   \n</code></pre>\n\n<p>I've played around with the query a lot, and I've been able to get some results by removing some of the AND statements after the WHERE and trying with fewer fields on the SELECT statement, but I need them all in order for this results to work for me. The weird thing is that if I run the same query in a problem like Oracle Sql Developer (after connecting to the DB) it shows the results that I want. I could really use some help, Thanks!</p>\n"}, {"tags": ["xml", "vba"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1422987071, "post_id": 28304042, "comment_id": 44962714, "body": "You can basically parse your XML file using a regex to get your nodes content."}, {"owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1422988655, "post_id": 28304042, "comment_id": 44963506, "body": "Do you mean using something like INSTR to look for the nodes and attributes? I could do that, but I would rather learn to use the DOM to do it the way it was designed to be done."}], "answers": [{"tags": [], "owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "is_accepted": true, "score": 4, "last_activity_date": 1422993391, "last_edit_date": 1495540123, "creation_date": 1422993391, "answer_id": 28307597, "question_id": 28304042, "link": "https://stackoverflow.com/questions/28304042/vba-and-xml-only-need-to-extract-attribute-values-from-certain-nodes/28307597#28307597", "title": "vba and XML only need to extract attribute values from certain nodes", "body": "<p>I found the answer in another forum post on Stack Overflow. Sorry I didn't see this earlier today. Here is the answer <a href=\"https://stackoverflow.com/questions/16538329/how-i-can-read-all-attributes-from-a-xml-with-vba#new-answer\">How I can read all Attributes from a XML with VBA?</a> and here is my final code.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Private Sub Workbook_Open()\r\n  Dim spin As String\r\n  Dim xmlUrl As String\r\n  Dim xmlDoc As New DOMDocument\r\n  Dim n As IXMLDOMNode\r\n  Dim nText As String\r\n\r\n\r\n  xmlUrl = Environ(\"USERPROFILE\") &amp; \"\\Documents\\Viewer\\XML\\00\\001C.xml\"\r\n  xmlDoc.async = False\r\n\r\n  If Not xmlDoc.Load(xmlUrl) Then\r\n    MsgBox \"XML LOAD ERROR\"\r\n  Else\r\n\r\n    For Each n In xmlDoc.selectNodes(\"//misc/seqlist/item\")\r\n      spin = n.Attributes.getNamedItem(\"spinno\").Text\r\n        nText = n.Text\r\n    Next\r\n\r\n  End If\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This searches for and grabs all of the attribute values that I need.</p>\n\n<p>Thanks,</p>\n\n<p>David</p>\n"}, {"comments": [{"owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "edited": false, "score": 0, "creation_date": 1423083593, "post_id": 28307599, "comment_id": 45009785, "body": "Thanks for the response Tim. I am just getting started with Xpath. I took the tutorial on W3 schools. It seems like you can do quite a bit with Xpath. I am actually learning it at school and at the same time, a requirement for me to use it at work came up. Wow!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1422996920, "last_edit_date": 1422996920, "creation_date": 1422993399, "answer_id": 28307599, "question_id": 28304042, "link": "https://stackoverflow.com/questions/28304042/vba-and-xml-only-need-to-extract-attribute-values-from-certain-nodes/28307599#28307599", "title": "vba and XML only need to extract attribute values from certain nodes", "body": "<p>You can use XPath to select only nodes which have that attribute:</p>\n\n<pre><code>Dim iNodes, n\nSet xDoc = New MSXML2.DOMDocument60\n\nxDoc.validateOnParse = True\nxDoc.LoadXML Sheet1.Range(\"a1\").Value 'my testing\n\nxDoc.setProperty \"SelectionLanguage\", \"XPath\" '&lt;&lt;&lt;######\n\n'I simplified your XML a bit, so adjust here....\nSet iNodes = xDoc.SelectNodes(\"/docpms/seqlist/item[@spinno]\")\n\nDebug.Print iNodes.Length\nFor Each n In iNodes\n    Debug.Print n.Text 'all itens with the spinno attribute\nNext n\n</code></pre>\n"}], "owner": {"reputation": 388, "user_id": 1561777, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/XhulK.jpg?s=128&g=1", "display_name": "David.Warwick", "link": "https://stackoverflow.com/users/1561777/david-warwick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5855, "favorite_count": 0, "accepted_answer_id": 28307597, "answer_count": 2, "score": 1, "last_activity_date": 1423610963, "creation_date": 1422981387, "last_edit_date": 1423610963, "question_id": 28304042, "link": "https://stackoverflow.com/questions/28304042/vba-and-xml-only-need-to-extract-attribute-values-from-certain-nodes", "title": "vba and XML only need to extract attribute values from certain nodes", "body": "<p>I am new to XML. I have a requirement now where I must extract data from a bunch of XML files. I cannot show the entire XML file, but hopefully someone can show me how to do this. I have read through a lot of forums and blogs and I am just so confused. Here is the XML. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;?xml version=\"1.0\"?&gt;\r\n&lt;docpms&gt;\r\n  &lt;distrib&gt;\r\n  &lt;mrc&gt;    \r\n    &lt;toolsetc&gt;              \r\n      &lt;misc&gt;\r\n        &lt;seqlist&gt;\r\n          &lt;item spinno=\"02\"&gt;\r\n            &lt;paratext&gt;Gloves&lt;/paratext&gt;\r\n          &lt;/item&gt;\r\n          &lt;item spinno=\"022\"&gt;\r\n            &lt;paratext&gt;Pail&lt;/paratext&gt;\r\n          &lt;/item&gt;\r\n          &lt;item spinno=\"03\"&gt;\r\n            &lt;paratext&gt;Lanyard&lt;/paratext&gt;\r\n          &lt;/item&gt;\r\n          &lt;item spinno=\"07\"&gt;\r\n            &lt;paratext&gt;Goggles&lt;/paratext&gt;\r\n          &lt;/item&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>So, I want to loop through the item nodes that have a spinno attribute and get the text value of the attribute. There are many other item nodes that do not have this attribute, so I think I need to use something like the following VBA. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Option Compare Database\r\nOption Explicit\r\n\r\nDim xDoc As MSXML2.DOMDocument60\r\nDim strpath As String\r\nDim spinAttribute As MSXML2.IXMLDOMAttribute\r\n\r\nPublic Sub LoadDocument()\r\nstrpath = Environ(\"USERPROFILE\") &amp; \"\\Documents\\XML\\00\\\"\r\nSet xDoc = New MSXML2.DOMDocument60\r\nxDoc.validateOnParse = False\r\nIf (xDoc.Load(strpath &amp; \"1C.xml\")) Then\r\n   ' The document loaded successfully.\r\n   ' Now do something intersting.\r\n   DisplayNode xDoc.childNodes, 0\r\nElse\r\n   ' The document failed to load.\r\n   ' See the previous listing for error information.\r\nEnd If\r\nEnd Sub\r\n\r\nPublic Sub DisplayNode(ByRef Nodes As MSXML2.IXMLDOMNodeList, _\r\n   ByVal Indent As Integer)\r\n    Dim strSpin As String\r\n    \r\n   Dim xNode As MSXML2.IXMLDOMNode\r\n   Set xNode = xDoc.selectNodes(\"/docpms/mrc/toolsetc/misc/seqlist/item\")\r\n   \r\n\r\n   For Each xNode In Nodes\r\n   Set spinAttribute = xNode.Attributes.getNamedItem(\"spinno\")\r\n    strSpin = spinAttribute.Text\r\n      \r\n   Next xNode\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>But when I am stepping through the code, I get a type mismatch on Set xNode = xDoc.selectNodes(\"/docpms/mrc/toolsetc/misc/seqlist/item\") for starters and I am not sure if my for each loop will do what I want. Any help will be appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>David</p>\n"}, {"tags": ["vba", "screen-scraping", "scraper"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1422980832, "post_id": 28303780, "comment_id": 44958975, "body": "You probably need to clear the error handler with <code>On Error GoTo 0</code> after the <code>Skip:</code> line.  Aside from that, it&#39;s not very clear what you&#39;re asking. Consider revising your question and providing more detail about how the observed results of this macro differ from your expected/desired results."}], "answers": [{"tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": false, "score": 0, "last_activity_date": 1424342042, "creation_date": 1424342042, "answer_id": 28604075, "question_id": 28303780, "link": "https://stackoverflow.com/questions/28303780/scraping-from-vba-very-close-to-working/28604075#28604075", "title": "Scraping from VBA (very close to working!!)", "body": "<p>Instead of looping through the collection of \"desc\" anchors (which only contain the product description), I suggest you loop through their parent \"items\" collection. That way you can reference your anchors' siblings, which contain price etc.:</p>\n\n<pre><code>Sub asosdesc2()\n\n    Const READYSTATE_COMPLETE = 4\n\n    Dim j As Integer\n\n    Dim ie As InternetExplorer\n    Dim Doc As IHTMLDocument\n    Dim itemsColl As IHTMLElementCollection\n    Dim itemsEle As IHTMLElement\n\n    Dim itemsAttributesColl As IHTMLElementCollection\n    Dim itemsAttributesEle As IHTMLElement\n\n    Dim pn As Integer\n\n    On Error GoTo 0\n    j = 1\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    For pn = 1 To 1\n\n        ie.Visible = True\n        ie.Navigate \"http://www.asos.com/Men/Sale/Accessories/Cat/pgecategory.aspx?cid=2097&amp;CTARef=shop|sale|cat|accessories#parentID=-1&amp;pge=0&amp;pgeSize=36&amp;sort=-1\"\n\n        Do\n          DoEvents\n        Loop Until Not ie.Busy And ie.readyState = READYSTATE_COMPLETE\n\n        Set Doc = ie.Document\n\n        Set itemsColl = Doc.getElementById(\"items\").Children\n\n        For Each itemsEle In itemsColl\n            On Error GoTo Skip\n            Set itemsAttributesColl = itemsEle.Children\n\n            For Each itemsAttributesEle In itemsAttributesColl\n\n\n                If itemsAttributesEle.className = \"desc\" Then\n                  Range(\"B\" &amp; j).Value = itemsAttributesEle.innerText 'Description\n                  Range(\"E\" &amp; j).Value = itemsAttributesEle.getAttribute(\"href\") 'Link\n                End If\n\n                If itemsAttributesEle.className = \"productprice\" Then\n                  Range(\"C\" &amp; j).Value = itemsAttributesEle.Children(0).innerText 'recRP\n                  Range(\"D\" &amp; j).Value = itemsAttributesEle.Children(1).innerText 'Outlet current price\n                End If\n            Next itemsAttributesEle\n\n          j = j + 1\nSkip:\n        Next itemsEle\n        On Error GoTo 0\n\n    Next pn\n\n    ie.Quit\n    Set itemsColl = Nothing\n    Set itemsEle = Nothing\n    Set itemsAttributesColl = Nothing\n    Set itemsAttributesEle = Nothing\n    Set Doc = Nothing\n    Set ie = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3509663, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1bcd0529617143bed8f369dbcb9f9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan_ark", "link": "https://stackoverflow.com/users/3509663/jordan-ark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424342042, "creation_date": 1422980494, "last_edit_date": 1422980641, "question_id": 28303780, "link": "https://stackoverflow.com/questions/28303780/scraping-from-vba-very-close-to-working", "title": "Scraping from VBA (very close to working!!)", "body": "<p>I have been playing around with a scraper for consumer stocks and I can scrape data from the main page of items but once i start using the second, thid parges, </p>\n\n<pre><code>Sub asosdesc2()\n\n Const READYSTATE_COMPLETE = 4\n\nDim j As Integer\n\nDim ie As InternetExplorer\nDim Doc As IHTMLDocument\nDim xcolElements As IHTMLElementCollection\nDim ell As IHTMLElement\n\nDim pn As Integer\n\nj = 1\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nFor pn = 1 To 1\n\n    ie.Visible = False\n    ie.Navigate \"http://www.asos.com/Men/Sale/Accessories/Cat/pgecategory.aspx?cid=2097&amp;CTARef=shop|sale|cat|accessories#parentID=-1&amp;pge=0&amp;pgeSize=36&amp;sort=-1\"\n\n    Do\n      DoEvents\n    Loop Until Not ie.Busy And ie.readyState = READYSTATE_COMPLETE\n\n    Set Doc = ie.Document\n\n    'Set xcolElements = Doc.getElementsByClassName(\"description\")\n    'Here lies the problem. Description works perflectly, price doesn't\n    Set xcolElements = Doc.getElementsByClassName(\"desc\")\n\n\n\n    For Each ell In xcolElements\n      On Error GoTo Skip\n      Range(\"B\" &amp; j).Value = ell.innerText\n      j = j + 1\nSkip:\n    Next ell\n\nOn Error GoTo 0\n\nNext pn\n\nie.Quit\nSet el = Nothing\nSet xcolElements = Nothing\nSet Doc = Nothing\nSet ie = Nothing\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to return the description, the price and the HREF code to identify the item</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 1, "creation_date": 1422977717, "post_id": 28302696, "comment_id": 44956716, "body": "Could you please include your code for querying the database and for copying from the base data to the formatted report? The issue is more likely in one of those or the interaction between them."}, {"owner": {"reputation": 23, "user_id": 4450341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0b3ac396808bcac5c7a2acc7f978331?s=128&d=identicon&r=PG&f=1", "display_name": "David Tinsley", "link": "https://stackoverflow.com/users/4450341/david-tinsley"}, "reply_to_user": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 0, "creation_date": 1422979161, "post_id": 28302696, "comment_id": 44957820, "body": "This is the code to transfer the data to the second page Sub CopyToTemplate() &#39; &#39; CopyToTemplate Macro &#39;  &#39;     Rows(&quot;3:100&quot;).Select     Selection.Copy     Sheets(&quot;SAVE TEMPLATE&quot;).Select     Range(&quot;A7&quot;).Select     ActiveSheet.Paste      End Sub"}, {"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 0, "creation_date": 1422979248, "post_id": 28302696, "comment_id": 44957912, "body": "Please <a href=\"https://stackoverflow.com/posts/28302696/edit\">edit</a> the additional information into the question post. You&#39;re more likely to get useful answers, the easier you make it for people to understand your problem and its context."}, {"owner": {"reputation": 23, "user_id": 4450341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0b3ac396808bcac5c7a2acc7f978331?s=128&d=identicon&r=PG&f=1", "display_name": "David Tinsley", "link": "https://stackoverflow.com/users/4450341/david-tinsley"}, "reply_to_user": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "edited": false, "score": 0, "creation_date": 1422979961, "post_id": 28302696, "comment_id": 44958435, "body": "I think I know what it is. You mentioned my original query, and that&#39;s probably the issue. When I run the original query, it populates my data, then I manipulate it and save it on another sheet. Then I run another query, and it ruins the manipulated data on all sheets. I think that query is staying connected to the data on all sheets and repopulating with new data. Is this a possibility?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4450341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0b3ac396808bcac5c7a2acc7f978331?s=128&d=identicon&r=PG&f=1", "display_name": "David Tinsley", "link": "https://stackoverflow.com/users/4450341/david-tinsley"}, "edited": false, "score": 0, "creation_date": 1422981393, "post_id": 28303694, "comment_id": 44959284, "body": "Isaac, thanks for the documentation, I am totally new to VBA and appreciate a reference. This is giving an error though. It doesn&#39;t like the first line, and I&#39;m not sure how to rearrange it to fix."}, {"owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "reply_to_user": {"reputation": 23, "user_id": 4450341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0b3ac396808bcac5c7a2acc7f978331?s=128&d=identicon&r=PG&f=1", "display_name": "David Tinsley", "link": "https://stackoverflow.com/users/4450341/david-tinsley"}, "edited": false, "score": 0, "creation_date": 1422981589, "post_id": 28303694, "comment_id": 44959398, "body": "@DavidTinsley Sorry about that. What error did you get? I changed the paste command to paste to the range instead of to the sheet, which ought to work. I didn&#39;t account for the fact that PasteSpecial is a method of a range, not a sheet."}, {"owner": {"reputation": 23, "user_id": 4450341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0b3ac396808bcac5c7a2acc7f978331?s=128&d=identicon&r=PG&f=1", "display_name": "David Tinsley", "link": "https://stackoverflow.com/users/4450341/david-tinsley"}, "edited": false, "score": 1, "creation_date": 1422981905, "post_id": 28303694, "comment_id": 44959619, "body": "That was it! Thank you. It is no longer responding to query updates, and works beautifully. You&#39;re Awesome!"}], "tags": [], "owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "is_accepted": true, "score": 0, "last_activity_date": 1422981511, "last_edit_date": 1422981511, "creation_date": 1422980214, "answer_id": 28303694, "question_id": 28302696, "link": "https://stackoverflow.com/questions/28302696/when-i-update-my-data-it-reverses-the-results-of-my-sub/28303694#28303694", "title": "When I update my data, it reverses the results of my Sub", "body": "<p>Most likely, you are copying cells that are automatically linked to your data query. Because you are copying the entire cell, the link is coming with it.</p>\n\n<p>To copy only the value and formatting, replace</p>\n\n<pre><code>Range(\"A7\").Select\nActivesheet.Paste\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Range(\"A7\").PasteSpecial Paste:=xlPasteValues\nRange(\"A7\").PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476%28v=office.15%29.aspx\" rel=\"nofollow\">Here</a> is documentation on PasteSpecial.</p>\n"}], "owner": {"reputation": 23, "user_id": 4450341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b0b3ac396808bcac5c7a2acc7f978331?s=128&d=identicon&r=PG&f=1", "display_name": "David Tinsley", "link": "https://stackoverflow.com/users/4450341/david-tinsley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 28303694, "answer_count": 1, "score": 1, "last_activity_date": 1423115067, "creation_date": 1422977483, "last_edit_date": 1531161705, "question_id": 28302696, "link": "https://stackoverflow.com/questions/28302696/when-i-update-my-data-it-reverses-the-results-of-my-sub", "title": "When I update my data, it reverses the results of my Sub", "body": "<p>I have a report that I pull directly from our database (Query), but it includes more information than necessary (items with no values), so I added a Subroutine to delete the rows that were extra. The Subroutine seems to work fine to correct the empty rows. I then have another Subroutine that copies the values returned and puts them below onto another sheet where the header is already laid out, and then another to add the signature block on the bottom. When this is all complete, the user makes a copy of this sheet and renames it for the month and year that it applies to. This would be a finished and easy process, but......</p>\n\n<p>The problem is that when the workbook data is refreshed to create a new report, all prior copies of formatted and finished reports suddenly include the rows that were deleted. I don't understand how deleted rows return to reports on different sheets, but here is the VBA i'm using to accomplish this. (I have since set this up to run automatically upon updating the data, but I get the same result) </p>\n\n<p>Hopefully, someone can help, thanks for any help in advance.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim wb1 As Workbook\n    Dim lr As Long, i As Long\n    Set wb1 = ActiveWorkbook\n    With wb1.Sheets(\"DATA SHEET\")\n        lr = Application.Max(.Cells(Rows.Count, 4).End(xlUp).Row, _\n          .Cells(Rows.Count, 6).End(xlUp).Row)\n        For i = lr To 1 Step -1\n            If .Cells(i, 4).Value = 0 And _\n              .Cells(i, 5).Value = 0 And _\n              .Cells(i, 7).Value = 0 And _\n              .Cells(i, 8).Value = 0 And _\n              .Cells(i, 9).Value = 0 And _\n              .Cells(i, 10).Value = 0 Then\n                .Rows(i).EntireRow.Delete\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here is the VBA to copy the data over, which was just a recorded Macro. I need to keep my formatting, but didn't see how to only transfer values and formatting.</p>\n\n<pre><code>Sub CopyToTemplate()\n'\n' CopyToTemplate Macro\n'\n\n'\n    Rows(\"3:100\").Select\n    Selection.Copy\n    Sheets(\"SAVE TEMPLATE\").Select\n    Range(\"A7\").Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "string-comparison"], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 81, "user_id": 4515945, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/234ea7896e16d9bbaf8204b54c171bf0?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4515945/helloworld"}, "edited": false, "score": 0, "creation_date": 1422979035, "post_id": 28302877, "comment_id": 44957708, "body": "I added another possibility in the end of the answer"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1422979210, "post_id": 28302877, "comment_id": 44957868, "body": "It&#39;s a bit dangerous and confusing to use <code>Option Compare Text</code> because it affects the entire module. That may not be desirable. Still, both of your solutions should work. +1"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1422979569, "post_id": 28302877, "comment_id": 44958136, "body": "@RubberDuck correct. I was assuming that there are no other Subs or Functions in that module. Good point in highlighting it though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user496736"}, "edited": false, "score": 1, "creation_date": 1422979756, "post_id": 28302877, "comment_id": 44958280, "body": "I&#39;d also add a suggestion to use the $ version of the functions whenever possible.  They run a little faster than the non$ version of the same function.  e.g.  If InStr(LCase$(Cells(J, &quot;C&quot;).value, v) &gt; 0 Then"}, {"owner": {"reputation": 81, "user_id": 4515945, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/234ea7896e16d9bbaf8204b54c171bf0?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4515945/helloworld"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1422980526, "post_id": 28302877, "comment_id": 44958789, "body": "I had to accept this answer because it came first, sorry @RubberDuck!"}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "reply_to_user": {"reputation": 81, "user_id": 4515945, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/234ea7896e16d9bbaf8204b54c171bf0?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4515945/helloworld"}, "edited": false, "score": 0, "creation_date": 1422980615, "post_id": 28302877, "comment_id": 44958848, "body": "@Bitter I gave RubberDuck an upvote, too. So his effort won&#39;t be in vain :)"}], "tags": [], "owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "is_accepted": true, "score": 1, "last_activity_date": 1422979268, "last_edit_date": 1422979268, "creation_date": 1422978013, "answer_id": 28302877, "question_id": 28302691, "link": "https://stackoverflow.com/questions/28302691/how-to-modify-this-script-to-account-for-different-case/28302877#28302877", "title": "How to modify this script to account for different case?", "body": "<p>Pretty simple, just cast it to lower case:</p>\n\n<pre><code>Sub Test()\n    Dim NA As Long, NC As Long, v As String, I As Long, J As Long\n    Dim v2 As String\n    NA = Cells(Rows.Count, \"A\").End(xlUp).Row\n    NC = Cells(Rows.Count, \"C\").End(xlUp).Row\n    For I = 2 To NA\n        v = LCase(Cells(I, \"A\").Value)\n        v2 = \"\"\n        For J = 2 To NC\n            If InStr(LCase(Cells(J, \"C\").Value), v) &gt; 0 Then\n                v2 = v2 &amp; \";\" &amp; Cells(J, \"C\").Value\n            End If\n        Next J\n        Cells(I, \"A\").Offset(0, 1).Value = Mid(v2,2)\n    Next I\nEnd Sub\n</code></pre>\n\n<p>I just took your code sample and put casts to lower case on <code>v</code> and <code>Cells(J, \"C\").Value</code>.</p>\n\n<p>I didn't test this, so I can't guarantee flawless functionality.</p>\n\n<hr>\n\n<p>You can also alter your module (on top) with</p>\n\n<p><code>Option Compare Text</code></p>\n\n<p>That will shut down case sensitivity completely (so you wouldn't need <code>LCase(..)</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 81, "user_id": 4515945, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/234ea7896e16d9bbaf8204b54c171bf0?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4515945/helloworld"}, "edited": false, "score": 0, "creation_date": 1422979525, "post_id": 28303283, "comment_id": 44958110, "body": "You&#39;re welcome! I know you don&#39;t have the rep to upvote yet, but please be sure to upvote useful answers. It&#39;s how we show our appreciation around here."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1422979655, "post_id": 28303283, "comment_id": 44958204, "body": "I forgot about optional arguments in InStr, so this should conclude the list of possible solutions :)"}, {"owner": {"reputation": 81, "user_id": 4515945, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/234ea7896e16d9bbaf8204b54c171bf0?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4515945/helloworld"}, "edited": false, "score": 0, "creation_date": 1422979947, "post_id": 28303283, "comment_id": 44958427, "body": "@RubberDuck: Hmm .. I&#39;m getting a type mismatch error on the if condition. Any thoughts?"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 1, "last_activity_date": 1422980217, "last_edit_date": 1422980217, "creation_date": 1422979099, "answer_id": 28303283, "question_id": 28302691, "link": "https://stackoverflow.com/questions/28302691/how-to-modify-this-script-to-account-for-different-case/28303283#28303283", "title": "How to modify this script to account for different case?", "body": "<p>Just use the <code>vbTextCompare</code> option of the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264811.aspx\" rel=\"nofollow\"><code>Instr</code> function</a>.</p>\n\n<pre><code>If InStr(1, Cells(J, \"C\").Value, v, vbTextCompare) &gt; 0 Then\n    v2 = v2 &amp; \";\" &amp; Cells(J, \"C\").Value\nEnd If\n</code></pre>\n\n<blockquote>\n  <p>[vbTextCompare] Performs a text comparison, based on a case-insensitive text sort order determined by your application's current culture information.</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 4515945, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/234ea7896e16d9bbaf8204b54c171bf0?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4515945/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 28302877, "answer_count": 2, "score": 1, "last_activity_date": 1422980217, "creation_date": 1422977475, "last_edit_date": 1531164843, "question_id": 28302691, "link": "https://stackoverflow.com/questions/28302691/how-to-modify-this-script-to-account-for-different-case", "title": "How to modify this script to account for different case?", "body": "<p>I wrote a VBA script which searches for a string in one column and returns the match in another column. The point is match an item number to it's product image by SKU. The problem is that it fails if the case of the item number and the image have different case. The script is below:</p>\n\n<pre><code>Sub Test()\n    Dim NA As Long, NC As Long, v As String, I As Long, J As Long\n    Dim v2 As String\n    NA = Cells(Rows.Count, \"A\").End(xlUp).Row\n    NC = Cells(Rows.Count, \"C\").End(xlUp).Row\n    For I = 2 To NA\n        v = Cells(I, \"A\").Value\n        v2 = \"\"\n        For J = 2 To NC\n            If InStr(Cells(J, \"C\").Value, v) &gt; 0 Then\n                v2 = v2 &amp; \";\" &amp; Cells(J, \"C\").Value\n            End If\n        Next J\n        Cells(I, \"A\").Offset(0, 1).Value = Mid(v2,2)\n    Next I\nEnd Sub\n</code></pre>\n\n<p>How can I account for different case? Is there a method for this?</p>\n"}, {"tags": ["sql", "excel", "stored-procedures", "vba"], "comments": [{"owner": {"reputation": 1661, "user_id": 1402658, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/BJJdL.jpg?s=128&g=1", "display_name": "Taras Velykyy", "link": "https://stackoverflow.com/users/1402658/taras-velykyy"}, "edited": false, "score": 0, "creation_date": 1422977239, "post_id": 28302514, "comment_id": 44956375, "body": "@ChaseErsnt, do you have primary key on that table?"}, {"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 0, "creation_date": 1422977387, "post_id": 28302514, "comment_id": 44956478, "body": "How do you know which volume goes with which ticket?"}, {"owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "reply_to_user": {"reputation": 1661, "user_id": 1402658, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/BJJdL.jpg?s=128&g=1", "display_name": "Taras Velykyy", "link": "https://stackoverflow.com/users/1402658/taras-velykyy"}, "edited": false, "score": 0, "creation_date": 1422977472, "post_id": 28302514, "comment_id": 44956531, "body": "Certain products can be labeled Fluid inside the Products table. @tvelykyy updated question"}, {"owner": {"reputation": 1661, "user_id": 1402658, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/BJJdL.jpg?s=128&g=1", "display_name": "Taras Velykyy", "link": "https://stackoverflow.com/users/1402658/taras-velykyy"}, "edited": false, "score": 0, "creation_date": 1422977758, "post_id": 28302514, "comment_id": 44956742, "body": "@ChaseErnst it would be easier to help you if you provide complete schema."}], "answers": [{"comments": [{"owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "edited": false, "score": 0, "creation_date": 1422977879, "post_id": 28302780, "comment_id": 44956821, "body": "I will try to convert this to sql and give this a try."}, {"owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "edited": false, "score": 0, "creation_date": 1422978981, "post_id": 28302780, "comment_id": 44957657, "body": "Worked out great. Thank you."}], "tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": true, "score": 1, "last_activity_date": 1422977711, "creation_date": 1422977711, "answer_id": 28302780, "question_id": 28302514, "link": "https://stackoverflow.com/questions/28302514/sql-select-statement-with-column-being-null-sometimes/28302780#28302780", "title": "SQL select statement with column being null sometimes", "body": "<p>You could do something like this (This is in Oracle, though .. )\nNot sure why you have this question flagged vba ..</p>\n\n<pre><code>  with w_data as ( \n           select 33 volume, 1234 ticket, 10.5 hours, 190 rate, 1995 amount from dual union all\n           select 90 volume, 1234 ticket, 90   hours, 100 rate, 9000 amount from dual union all\n           select 33 volume, 1235 ticket, 11   hours, 190 rate, 2090 amount from dual union all\n           select 90 volume, 1235 ticket, 90   hours, 110 rate, 9900 amount from dual \n        )\n  Select case when ticket = lag(ticket) over (partition by ticket order by ticket, volume) then volume else null end new_volume, \n        case when ticket = lag(ticket) over (partition by ticket order by ticket, volume) then null else ticket end new_ticket, \n           hours, rate, amount\n    from w_data\n  order by ticket, volume\n  /\n\n  NEW_VOLUME NEW_TICKET      HOURS       RATE     AMOUNT\n  ---------- ---------- ---------- ---------- ----------\n                   1234       10.5        190       1995\n          90                    90        100       9000\n                   1235         11        190       2090\n          90                    90        110       9900\n\n  4 rows selected.\n</code></pre>\n"}], "owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 28302780, "answer_count": 1, "score": 0, "last_activity_date": 1422977711, "creation_date": 1422977043, "last_edit_date": 1531164843, "question_id": 28302514, "link": "https://stackoverflow.com/questions/28302514/sql-select-statement-with-column-being-null-sometimes", "title": "SQL select statement with column being null sometimes", "body": "<p>I am wondering how I would go about creating an SQL select statement that may have a possible null in a couple of the columns. Here is what one possible result set could look like:</p>\n\n<pre><code>Volume    |  Ticket   |  Hours   |  Rate   |   Amount\n              1234        10.5       190        1995\n  90                      90         100        9000\n              1235        11         190        2090\n  90                      90         110        9900\n</code></pre>\n\n<p>the volume is related the their above ticket. So the first time a ticket is display we don't want to show the volume, but we want to show the Ticket #. If there is Volume we want the next line to display it's values, but not the ticket.</p>\n\n<p>The table table that I am pulling from is <code>Charges</code>. These are the columns:</p>\n\n<p><code>ChargeID, TicketNum, ProductID, Hours, Rate, Amount</code></p>\n\n<p>Where ChargeID is a primary key.</p>\n\n<p>If anyone has as any ideas they would be greatly appreciated.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "insert", "ms-access-2007"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 2, "creation_date": 1422974444, "post_id": 28301527, "comment_id": 44954396, "body": "Why would you want to do this? the current setup is correct. You have a RELATIONSHIP defined between the two tables. The ID is what is stored, when you need to see the Text description you simply JOIN the two tables and get the right data. Leave it as it is."}, {"owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1422974659, "post_id": 28301527, "comment_id": 44954543, "body": "I would do that but I need to export the table to an excel spreadsheet and the description needs to be there."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 3, "creation_date": 1422974762, "post_id": 28301527, "comment_id": 44954621, "body": "Yes still, you can create a Query with the correct JOIN and export the Query. Still no reason to edit. Editing will cause instability to data, changes to Forms and code - a very painful task for something that has a better solution."}, {"owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1422976395, "post_id": 28301527, "comment_id": 44955821, "body": "I wrote this JOIN statement but for some reason it won&#39;t run due to a syntax error. I am very confused why. Any help would be greatly appreciated"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1422977340, "post_id": 28301527, "comment_id": 44956448, "body": "What is your question?"}, {"owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1422977632, "post_id": 28301527, "comment_id": 44956648, "body": "@HansUp I am unsure of the syntax error in the Join statement above."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1422977673, "post_id": 28301527, "comment_id": 44956672, "body": "Doesn&#39;t it point you to the line of the syntax error?"}, {"owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "edited": false, "score": 0, "creation_date": 1422977801, "post_id": 28301527, "comment_id": 44956775, "body": "Yes it points to <code>ShouldImportMetricsIDsTable.FORMULARYID</code> but I don&#39;t see the error."}, {"owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "edited": false, "score": 0, "creation_date": 1422977822, "post_id": 28301527, "comment_id": 44956794, "body": "That table and field exist."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1423156567, "last_edit_date": 1423156567, "creation_date": 1422977784, "answer_id": 28302801, "question_id": 28301527, "link": "https://stackoverflow.com/questions/28301527/change-value-in-access-vba/28302801#28302801", "title": "Change Value in Access VBA", "body": "<p>Mention <em>ReasonCodes</em> only once in your query's <code>FROM</code> clause.</p>\n\n<p>Change this ...</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>FROM ShouldImportMetricsIDsTable,ReasonCodes\nINNER JOIN ReasonCodes\n</code></pre>\n\n<p>To this ...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>FROM ShouldImportMetricsIDsTable\nINNER JOIN ReasonCodes\n</code></pre>\n\n<p>As general advice, I suggest you begin your queries in the Access query designer.  At least choose the data sources (tables or saved queries) and set up joins there.</p>\n\n<p>With your original example, the designer would have applied an alias, <em>ReasonCodes_1</em>, for one of those duplicate <em>ReasonCodes</em> names.  And that could be an early warning that the data sources aren't correct.</p>\n"}], "owner": {"reputation": 31, "user_id": 4479701, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/258023f6157b79295df91177bf7141b0?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Caffrey", "link": "https://stackoverflow.com/users/4479701/neil-caffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 28302801, "answer_count": 1, "score": 0, "last_activity_date": 1594645483, "creation_date": 1422974305, "last_edit_date": 1594645483, "question_id": 28301527, "link": "https://stackoverflow.com/questions/28301527/change-value-in-access-vba", "title": "Change Value in Access VBA", "body": "<p>I have a table full of code IDs and their descriptions in access. And in another table is a field that has code IDs that correlate to the IDs in the Codes table.  I am trying to design a macro that when executed will replace the code ID in the second table with the correct description but I am unsure a way to do this. I was thinking of using a SQL <code>Insert</code> query to do so but am unsure of what the statement would look like.</p>\n\n<p><code>JOIN</code> statement:</p>\n\n<pre><code>SELECT ShouldImportMetricsIDsTable.FORMULARYID, ReasonCodes.Description\nFROM ShouldImportMetricsIDsTable,ReasonCodes\nINNER JOIN ReasonCodes\nON ShouldImportMetricsIDsTable.ReasonCode=ReasonCodes.CodeID\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3926, "user_id": 2500842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/F22Yd.jpg?s=128&g=1", "display_name": "Master Yoda", "link": "https://stackoverflow.com/users/2500842/master-yoda"}, "edited": false, "score": 0, "creation_date": 1422974061, "post_id": 28301375, "comment_id": 44954137, "body": "You may be better off taking a screendump of your excel sheets with visual descriptions of what you need. Currently it is very difficult to understand what you are asking."}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 4329374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-M_LQ74LC2Dc/AAAAAAAAAAI/AAAAAAAAAEU/VMlIKN97Dhs/photo.jpg?sz=128", "display_name": "Martin", "link": "https://stackoverflow.com/users/4329374/martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1422974037, "creation_date": 1422974037, "answer_id": 28301441, "question_id": 28301375, "link": "https://stackoverflow.com/questions/28301375/copying-data-to-next-sheet-in-excel-2010/28301441#28301441", "title": "Copying data to next sheet in excel 2010", "body": "<p><a href=\"http://analysistabs.com/excel-vba/copy-data-from-one-worksheet-to-another/\" rel=\"nofollow\">http://analysistabs.com/excel-vba/copy-data-from-one-worksheet-to-another/</a></p>\n\n<p>first hit on google when you search for \"excel copy data from one sheet to another VB\" \nand i only typed excel copy and VB the rest was autocompleted</p>\n\n<p>edit: i would vote down, but i can't :P</p>\n"}], "owner": {"reputation": 13, "user_id": 2637068, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zJgsJ.jpg?s=128&g=1", "display_name": "Vigneshwaran Kandaswamy", "link": "https://stackoverflow.com/users/2637068/vigneshwaran-kandaswamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1422974037, "creation_date": 1422973850, "last_edit_date": 1531161705, "question_id": 28301375, "link": "https://stackoverflow.com/questions/28301375/copying-data-to-next-sheet-in-excel-2010", "title": "Copying data to next sheet in excel 2010", "body": "<p>I have data from column a, b &amp; c in worksheet Sheet1. I need to copy those data to sheet3 a, b &amp; C column. Then i need to go  to sheet2 and column a, b &amp; c contains similar data like sheet1, i need to copy that data and paste in sheet3 below where i already pasted data from sheet1.\nCould anyone help me on this?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1422973730, "post_id": 28301245, "comment_id": 44953908, "body": "Try specifying which type of recordset - ADODB or DAO."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1422973769, "post_id": 28301245, "comment_id": 44953942, "body": "It would make more sense if you could show a bit more code, the above could not always be the reason for the freeze. Also make sure you reference the Recordset, use DAO or ADO"}, {"owner": {"reputation": 273, "user_id": 2712113, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/32880a70581e11f4869b924859003ad8?s=128&d=identicon&r=PG&f=1", "display_name": "John Janssen", "link": "https://stackoverflow.com/users/2712113/john-janssen"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1422973959, "post_id": 28301245, "comment_id": 44954070, "body": "@PaulFrancis I don&#39;t know what other code I can show you.  The other code I have is irrelevant for I can&#39;t even create this subroutine to begin passing data in."}, {"owner": {"reputation": 273, "user_id": 2712113, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/32880a70581e11f4869b924859003ad8?s=128&d=identicon&r=PG&f=1", "display_name": "John Janssen", "link": "https://stackoverflow.com/users/2712113/john-janssen"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1422974019, "post_id": 28301245, "comment_id": 44954108, "body": "@Rory It is a DAO recordset, I have updated the question and the details."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1422974047, "post_id": 28301245, "comment_id": 44954128, "body": "I pass Recordsets to subroutines and it always works. I cannot see why else it should fail, have you tried adding DAO? Like <code>Sub WriteToForms(rs as DAO.RecordSet)</code>"}, {"owner": {"reputation": 273, "user_id": 2712113, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/32880a70581e11f4869b924859003ad8?s=128&d=identicon&r=PG&f=1", "display_name": "John Janssen", "link": "https://stackoverflow.com/users/2712113/john-janssen"}, "edited": false, "score": 1, "creation_date": 1422974119, "post_id": 28301245, "comment_id": 44954178, "body": "I feel like a dolt.  that worked. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 273, "user_id": 2712113, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/32880a70581e11f4869b924859003ad8?s=128&d=identicon&r=PG&f=1", "display_name": "John Janssen", "link": "https://stackoverflow.com/users/2712113/john-janssen"}, "is_accepted": true, "score": 0, "last_activity_date": 1422974443, "creation_date": 1422974443, "answer_id": 28301580, "question_id": 28301245, "link": "https://stackoverflow.com/questions/28301245/adding-a-dao-recordset-to-subroutine-vba/28301580#28301580", "title": "Adding a DAO Recordset to Subroutine - vba", "body": "<p>When passing a recordset to a subroutine in Access you must specify what type of recordset it is.  For example:</p>\n\n<pre><code>Sub WriteToForms(rs as recordset) \n</code></pre>\n\n<p>Should actually be:</p>\n\n<pre><code>Sub WriteToForms(rs as Dao.RecordSet) 'If you are dealing with a DAO recordset.\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Sub WriteToForms(rs as ADODB.RecordSet) 'If you are dealing with a ADO recordset.\n</code></pre>\n\n<p>Failure to specify the type of recordset will cause the program to freeze and you will need to restart Access/Excel.</p>\n"}], "owner": {"reputation": 273, "user_id": 2712113, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/32880a70581e11f4869b924859003ad8?s=128&d=identicon&r=PG&f=1", "display_name": "John Janssen", "link": "https://stackoverflow.com/users/2712113/john-janssen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 28301580, "answer_count": 1, "score": 0, "last_activity_date": 1594645495, "creation_date": 1422973486, "last_edit_date": 1594645495, "question_id": 28301245, "link": "https://stackoverflow.com/questions/28301245/adding-a-dao-recordset-to-subroutine-vba", "title": "Adding a DAO Recordset to Subroutine - vba", "body": "<p>I am using vba in Access 2010, and I am just trying to pass in a DAO recordset into a subroutine.  I am doing this so I don't have to duplicate code (potentially hundreds of lines).  I believe this is very simple, but every time I try something it freezes the program and I am forced to restart Access and re-add my code. Below is all of the code I have tried:</p>\n\n<pre><code>Sub WriteToForms(rs as RecordSet) ' When I press enter, that is when it freezes\n\nSub WriteToForms(ByVal rs as RecordSet) ' When I press enter, that is when it freezes\n\nSub WriteToForms(ByRef rs as RecordSet) 'When I press enter, that is when it freezes\n</code></pre>\n\n<p>However, when I do this:</p>\n\n<pre><code>Sub WriteToForms (types as string)\n</code></pre>\n\n<p>It works. I have looked at multiple articles and the above code is what they suggested. </p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 35, "user_id": 4524417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5bb272f1071501bc6fafe2606b988a?s=128&d=identicon&r=PG&f=1", "display_name": "Raffi95", "link": "https://stackoverflow.com/users/4524417/raffi95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561559479, "creation_date": 1422970892, "last_edit_date": 1531164843, "question_id": 28300369, "link": "https://stackoverflow.com/questions/28300369/how-to-arrange-windows-in-a-specific-order-using-windows-arrange", "title": "How to arrange Windows in a specific order using Windows.Arrange?", "body": "<p>I have opened more Excel Windows and I will arrange them with macros.\nHow could I decide the arrange of the windows?</p>\n\n<p>At the moment the arrange of the windows is random.</p>\n\n<p>If I make the arrange a second time, the windows will be arrange in an other order.</p>\n\n<p>I used this script:</p>\n\n<pre><code>Windows.Arrange ArrangeStyle:=xlVertical\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 1, "creation_date": 1422969764, "post_id": 28299912, "comment_id": 44951479, "body": "What doesn&#39;t work? Do you get any errors? What do the other macros do? Did you try disabling some of the macros to identify which macro combination could be causing hte problem? Please clarify."}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 0, "creation_date": 1422970901, "post_id": 28299912, "comment_id": 44952143, "body": "No errors. The other macros do a bunch of math to a lot of different cells. Range(&quot;B7&quot;) is a cell that has the summation of various cells. It only works when you isolate the individual macro itself."}, {"owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 3, "creation_date": 1422971277, "post_id": 28299912, "comment_id": 44952383, "body": "Does the code reach the macro? Have you tried putting a breakpoint in there to see what happens?"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "edited": false, "score": 2, "creation_date": 1422975160, "post_id": 28299912, "comment_id": 44954906, "body": "As @MarekStejskal suggested, you should try stepping through your code to see where it is going wrong. Is it possible that <code>SalvarLCA_aber</code> or <code>Fechar</code> are replacing the contents of <code>Sheet.Range(&quot;F2&quot;)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 4533150, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ea4225597ae3fa9017c0d28ea24f1474?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/4533150/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1423143444, "creation_date": 1423143444, "answer_id": 28345369, "question_id": 28299912, "link": "https://stackoverflow.com/questions/28299912/inconsistency-with-running-macros-copy-paste/28345369#28345369", "title": "Inconsistency with Running Macros Copy/Paste", "body": "<p>Is it possible that two (or more) macros are using Copy/Paste to perform their duties? Perhaps a second \"Copy\" is being performed before the corresponding \"Paste\" is executed. So, in other words, you did a second copy before you got to perform your first paste.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 28345369, "answer_count": 1, "score": 1, "last_activity_date": 1426010898, "creation_date": 1422969471, "last_edit_date": 1426010898, "question_id": 28299912, "link": "https://stackoverflow.com/questions/28299912/inconsistency-with-running-macros-copy-paste", "title": "Inconsistency with Running Macros Copy/Paste", "body": "<p>When I exclusively run the Sub \"EmailAbertura\" (below) I get the desired result. However, when I run it within a list of other subs it copy and pastes a number that isn't even on the sheet. Why would that be occuring?  Thanks!</p>\n\n<pre><code>Sub EmailAbertura()\nDim Email As Workbook\nDim Sheet As Worksheet\nDim LCA As Workbook\nDim Lastro As Worksheet\n\nSet Email = Workbooks(\"Email\")\nSet Sheet = Email.Sheets(\"Sheet1\")\nSet LCA = Workbooks(\"Controle de Lastro LCA_FEC - Test\")\nSet Lastro = LCA.Sheets(\"Controle Lastro\")\n\nLastro.Range(\"B7\").Copy\nSheet.Range(\"F2\").PasteSpecial\nEnd Sub\n</code></pre>\n\n<p>But When I include it in this macro, it doesn't work.</p>\n\n<pre><code>Sub DoLCA() 'fazer todos de LCA para fechamento e abertura'\nAddEmLCA\nMenosResLCA\nLCAHist\nSalvarLCA\nEmailDadosLCA\nMudaDataLCA\nDeleteDateLCA\nEmailAbertura\nSalvarLCA_aber\nFechar\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "csv", "import"], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 3975312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6e513bf214eaa219b59809a8a1709ca8?s=128&d=identicon&r=PG&f=1", "display_name": "frrrt", "link": "https://stackoverflow.com/users/3975312/frrrt"}, "is_accepted": false, "score": 0, "last_activity_date": 1422969977, "creation_date": 1422969977, "answer_id": 28300074, "question_id": 28299241, "link": "https://stackoverflow.com/questions/28299241/access-vba-importing-csv-file-via-transfertext-with-commata-as-decimal-separato/28300074#28300074", "title": "Access VBA, importing csv file via TransferText with commata as decimal separator and semicolon as delimiter", "body": "<p>Ok, I think I got it!</p>\n\n<p>The problem where the regional settings and that my Access uses comma as decimal separator. I was also not able to create a Import Spec via manual import, since it needs to have defined which fields will have to be imported.</p>\n\n<p>What I did now was this:</p>\n\n<p>Open the table <code>MSysIMEXSpecs</code>that contains the import specs via query:\n    select * from MSysIMEXSpecs</p>\n\n<p>Then add a new row and set <code>SpecName</code> = \"Whatever\", <code>DecimalPoint</code>= \",\" and 'FieldSeparator` = \";\" and whatever other settings have to be made.</p>\n\n<p>Since there is this workaround, isn't there a way to do this easier?</p>\n"}], "owner": {"reputation": 89, "user_id": 3975312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6e513bf214eaa219b59809a8a1709ca8?s=128&d=identicon&r=PG&f=1", "display_name": "frrrt", "link": "https://stackoverflow.com/users/3975312/frrrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1748, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1422969977, "creation_date": 1422967311, "last_edit_date": 1422967711, "question_id": 28299241, "link": "https://stackoverflow.com/questions/28299241/access-vba-importing-csv-file-via-transfertext-with-commata-as-decimal-separato", "title": "Access VBA, importing csv file via TransferText with commata as decimal separator and semicolon as delimiter", "body": "<p>I'm having some problems importing double numbers from csv files. The files have a semicolon delimiter and comma as decimal separator.</p>\n\n<p>I can't set up import specs since the order of the fields in the csv often changes and it would be a desaster if the data goes into the wrong field.</p>\n\n<p>Also the csv files will have to written to a temporary table first. Don't hate me for it, but since I have to process data and set some information fields for later data processing this is by far the easiest, fastest and safest way to achieve it.</p>\n\n<p>Here is the problem itself:</p>\n\n<p>When using <code>TransferText</code> it will import, but of course interpret the comma as delimiter. Not good ...</p>\n\n<p>When replacing comma by full stop and semicolon by comma it works. But it will ignore full stops, so 1.2 becomes 12, 1.333 becomes 1333. The field will be of type double.</p>\n\n<p>I've tests numerous things. Besides <code>TransferText</code> I've tried:</p>\n\n<pre><code>DoCmd.RunSQL (\"INSERT INTO Tabelle1 SELECT cdbl(a1) as aa FROM[TEXT;FMT=Delimited;HDR=YES;CharacterSet=437;DATABASE=C:\\SPOT].[test.csv]\")\n</code></pre>\n\n<p>But nothing seems to work, even when I create a new table with field type DOUBLE before using <code>TransferText</code> ... decimals are still ignored.</p>\n\n<p>So, I would be happy if you could tell me either how to use <code>TransferText</code> with or without replacing semicolon and comma in a first step or how to use the <code>INSERT INTO</code> stuff.</p>\n\n<p>Thank you very much!</p>\n"}]