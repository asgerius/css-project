[{"tags": ["arrays", "excel", "vba", "function"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1567035518, "creation_date": 1567035518, "answer_id": 57701244, "question_id": 57701021, "link": "https://stackoverflow.com/questions/57701021/excel-vba-array-function-that-will-shift-a-vector-up/57701244#57701244", "title": "Excel VBA Array Function that will shift a Vector up", "body": "<p>When dealing with Ranges its easiest to work 2D Arrays.  Also, your logic can be simplified quite a bit.</p>\n\n<pre><code>Function ShiftVector(rng As Range, n As Long)\n    Dim i As Long\n    Dim shift() As Variant\n    Dim dat As Variant\n\n    ReDim shift(1 To rng.Rows.Count, 1 To 1)\n    dat = rng.Value 'this will speed up the UDF on larger ranges\n\n    For i = 1 To n\n        shift(i, 1) = dat(i + n, 1)\n    Next i\n    For i = n + 1 To rng.Rows.Count\n        shift(i, 1) = dat(i - n, 1)\n    Next i\n\n    ShiftVector = shift()\nEnd Function\n\n</code></pre>\n\n<p>I'd also suggest adding some range checks on <code>n</code> and size/shape checks on <code>rng</code></p>\n\n<p><Sub>FWIW your code could be fixed by changing the last line to <code>ShiftVector = Application.Transpose(shift())</code></Sub></p>\n"}], "owner": {"reputation": 99, "user_id": 9195742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4lr0.jpg?s=128&g=1", "display_name": "Toasted", "link": "https://stackoverflow.com/users/9195742/toasted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 57701244, "answer_count": 1, "score": 0, "last_activity_date": 1594670805, "creation_date": 1567033467, "question_id": 57701021, "link": "https://stackoverflow.com/questions/57701021/excel-vba-array-function-that-will-shift-a-vector-up", "title": "Excel VBA Array Function that will shift a Vector up", "body": "<p>I need an array function that will shift up a vector at rng range by n cells.\nHere is my code so far:</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nFunction ShiftVector(rng As Range, n As Integer)\nDim nr As Integer\nDim i As Integer\nDim head() As Variant\nDim tail() As Variant\nDim shift() As Variant\n\nnr = rng.Rows.Count\nReDim head(n)\n\nFor i = 1 To n\n        head(i) = rng(i).Value\n    Next i\n\nReDim tail(nr - n)\n\nFor i = 1 To nr - n\n        tail(i) = rng(n + i).Value\n    Next i\n\nReDim shift(nr)\n\nFor i = 1 To nr - n\n        shift(i) = tail(i)\n    Next i\n\nFor i = (nr - n + 1) To nr\n        shift(i) = head(i - (nr - n))\n    Next i\n\nShiftVector = shift()\n\nEnd Function\n</code></pre>\n\n<p>I have tested running this as a subroutine and saw that in the locals window the new array \"shift()\" had the values I needed, however I am having trouble outputting the new array as a function in a new location show below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uMiM7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uMiM7.png\" alt=\"How I want to output the new shifted array\"></a></p>\n"}, {"tags": ["vba", "password-protection", "common-dialog"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "edited": false, "score": 0, "creation_date": 1567035403, "post_id": 57701180, "comment_id": 101846181, "body": "This code works partially for me.  Now I have to add password to both hide and unhide the worksheet. However, I don&#39;t want the user to enter the password to hide it i.e. when the click the button sheet 2 should just hide if its visible."}, {"owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "edited": false, "score": 0, "creation_date": 1567091042, "post_id": 57701180, "comment_id": 101868231, "body": "Oh I just figured that even if you add a different password/string instead of &quot;pword&quot; then it will accept and unhide the worksheet."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1567034918, "creation_date": 1567034918, "answer_id": 57701180, "question_id": 57700888, "link": "https://stackoverflow.com/questions/57700888/how-to-code-in-vba-for-requesting-password-when-clicked-on-a-button/57701180#57701180", "title": "How to code in VBA for requesting password when clicked on a button?", "body": "<p>You can use an inputbox to collect input from a user. Not exactly sure what you are trying to do, but maybe something like this works.</p>\n\n<pre><code>Option Explicit\nSub myButton()\n\n    Dim pword As String\n\n    pword = InputBox(\"Please enter a password\", \"Password Entry\")\n\n    If (Len(Trim$(pword)) = 0) Then Exit Sub\n\n    ActiveWorkbook.Unprotect pword\n\n    If (Sheets(\"Sheet2\").Visible) Then\n        Sheets(\"Sheet2\").Visible = False\n        Sheets(\"Sheet1\").Select\n    Else\n        Sheets(\"Sheet2\").Visible = True\n        Sheets(\"Sheet2\").Select\n    End If\n\n    ActiveWorkbook.Protect Password:=pword, structure:=True, Windows:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "is_accepted": false, "score": 0, "last_activity_date": 1567093264, "creation_date": 1567093264, "answer_id": 57713616, "question_id": 57700888, "link": "https://stackoverflow.com/questions/57700888/how-to-code-in-vba-for-requesting-password-when-clicked-on-a-button/57713616#57713616", "title": "How to code in VBA for requesting password when clicked on a button?", "body": "<p>I was able to resolve this with few tweaks. Thanks Ryan for your help!</p>\n\n<pre><code>Sub myButton()\n\nDim pword As String\n\nIf (Sheets(\"Sheet2\").Visible) Then\n    Sheets(\"Sheet2\").Visible = False\n    Sheets(\"Sheet1\").Select\nElse\n\npword = InputBox(\"Please enter a password\", \"Password Entry\")\n\nIf pword = \"password\" Then\n\nActiveWorkbook.Unprotect \"password\"\n\n    Sheets(\"Sheet2\").Visible = True\n    Sheets(\"Sheet2\").Select\n\nActiveWorkbook.Protect Password:=\"password\", structure:=True, Windows:=False\n\nElse\n    MsgBox (\"Wrong Password\")\nEnd If\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 13, "user_id": 11161564, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d_mg-M87tAk/AAAAAAAAAAI/AAAAAAAACuo/IopghCdwMnA/photo.jpg?sz=128", "display_name": "rikin bhavsar", "link": "https://stackoverflow.com/users/11161564/rikin-bhavsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567093264, "creation_date": 1567032267, "question_id": 57700888, "link": "https://stackoverflow.com/questions/57700888/how-to-code-in-vba-for-requesting-password-when-clicked-on-a-button", "title": "How to code in VBA for requesting password when clicked on a button?", "body": "<p>I have got a command button on one of the excel sheet to hide/unhide one of the worksheet. See below code. </p>\n\n<p>However, now I want to add a capability for the admin to enter the password in order to unhide the sheet, else anyone can click the button and unhide the data sheet. </p>\n\n<p>Is there a way to force excel to show the normal enter password prompt to unhide?</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub myButton()\n\nActiveWorkbook.Unprotect\n\nIf (Sheets(\"Sheet2\").Visible) Then \n    Sheets(\"Sheet2\").Visible = False \n    Sheets(\"Sheet1\").Select          \nElse\n    Sheets(\"Sheet2\").Visible = True  \n    Sheets(\"Sheet2\").Select          \nEnd If\n\nActiveWorkbook.Protect Password:=\"password\", structure:=True, Windows:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 374, "user_id": 6509779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Oejm.jpg?s=128&g=1", "display_name": "Wilco", "link": "https://stackoverflow.com/users/6509779/wilco"}, "edited": false, "score": 0, "creation_date": 1567032576, "post_id": 57700865, "comment_id": 101845651, "body": "I don&#39;t see an opening &#39;IF&#39; statement which may cause problems, but I think the main issue is you need to iterate over each file. I think a Do While loop might be what you are after.  <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/doloop-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1567034481, "post_id": 57701081, "comment_id": 101846025, "body": "Don&#39;t you need <code>appExcel</code> before <code>myWorkbook.Worksheets(&quot;Sheet1&quot;)</code> when setting <code>mysheet</code>?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1567034550, "post_id": 57701081, "comment_id": 101846040, "body": "@Dan No, because of the <code>Set myWorkbook = appExcel.Workbooks.Open(...</code> <code>myWorkbook</code> is already correctly assigned."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1567034583, "post_id": 57701081, "comment_id": 101846047, "body": "Ahhh yes my bad, didn&#39;t look at the upper part of the code :)"}, {"owner": {"reputation": 1, "user_id": 9699377, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156244861518618/picture?type=large", "display_name": "Dawn Bigelbach", "link": "https://stackoverflow.com/users/9699377/dawn-bigelbach"}, "edited": false, "score": 0, "creation_date": 1567085769, "post_id": 57701081, "comment_id": 101865004, "body": "seems to work now - I guess I just go myself so lost in trying to fix it that I tried everything and ended up with a bunch of garbage.  Thanks for the help."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 4, "last_activity_date": 1567047782, "last_edit_date": 1567047782, "creation_date": 1567034069, "answer_id": 57701081, "question_id": 57700865, "link": "https://stackoverflow.com/questions/57700865/selecting-excel-range-throwing-1004-error-in-ms-access-vba/57701081#57701081", "title": "Selecting Excel range throwing 1004 error in MS Access VBA", "body": "<p>Many issues here:</p>\n\n<ol>\n<li>Unnecessary <code>Select</code>'s and <code>Activate</code>'s </li>\n<li>Unqualified <code>Worksheets</code> reference. Access doesn't know about <code>Worksheets</code>, that will error</li>\n<li>Unqualified <code>Range</code>  reference.  Access doesn't know about <code>Range</code>, that will error</li>\n<li>While you have coded <code>With</code> blocks, you are not actually using them</li>\n<li>Excel.Application object doesn't have a Worksheets collection</li>\n<li>Clean up of objects in wrong order</li>\n</ol>\n\n<p>If this code were written in Excel VBA, unqualified <code>Worksheets(...</code> would imply <code>ActiveWorkbook.Worksheets(...</code>, and unqualified <code>Range(...</code> would imply <code>ActiveSheet.Range(...</code> </p>\n\n<p>Since this code is written in Access VBA, VBA can't resolve those implicit references.</p>\n\n<p>So, all Excel objects and methods must be fully qualified back to the Excel Application object <code>appExcel</code></p>\n\n<p>Refactored:</p>\n\n<pre><code>Set appExcel = CreateObject(\"Excel.Application\")\nSet myWorkbook = appExcel.Workbooks.Open(vfilepath &amp; \"\\\" &amp; vfilename)\n\n'...\n\nSet mysheet = myWorkbook.Worksheets(\"Sheet1\")\nWith mysheet \n    .Range(\"B2\", .Range(\"N2\").End(xlDown)).Copy\nEnd With\n\n'....\n\nSet mysheet = Nothing\nmyWorkbook.Close\nSet myWorkbook = Nothing\nappExcel.Quit\nSet appExcel = Nothing\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9699377, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156244861518618/picture?type=large", "display_name": "Dawn Bigelbach", "link": "https://stackoverflow.com/users/9699377/dawn-bigelbach"}, "edited": false, "score": 0, "creation_date": 1567041272, "post_id": 57701097, "comment_id": 101847184, "body": "the second with was really a shot in the dark attempt at anything :(  Didn&#39;t originally have it there.  Will try this and let you know.  TX"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 1, "user_id": 9699377, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156244861518618/picture?type=large", "display_name": "Dawn Bigelbach", "link": "https://stackoverflow.com/users/9699377/dawn-bigelbach"}, "edited": false, "score": 0, "creation_date": 1567043024, "post_id": 57701097, "comment_id": 101847473, "body": "To be honest I think Chris\u2019s answer may be better for you but see if this works"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1567034180, "creation_date": 1567034180, "answer_id": 57701097, "question_id": 57700865, "link": "https://stackoverflow.com/questions/57700865/selecting-excel-range-throwing-1004-error-in-ms-access-vba/57701097#57701097", "title": "Selecting Excel range throwing 1004 error in MS Access VBA", "body": "<p>When using <code>With</code> you need to precede with a period / Full Stop <code>.</code></p>\n\n<p>Something like this (I cleaned up the select too)</p>\n\n<pre><code>With appExcel\n    .Sheets(\"Sheet1\").Range(\"B2\", .Sheets(\"Sheet1\").Range(\"N2\").End(xlDown)).Copy\nEnd With\n</code></pre>\n\n<p>Not really sure why you had the second <code>With</code> in there.</p>\n"}], "owner": {"reputation": 1, "user_id": 9699377, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156244861518618/picture?type=large", "display_name": "Dawn Bigelbach", "link": "https://stackoverflow.com/users/9699377/dawn-bigelbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1598772826, "creation_date": 1567032022, "last_edit_date": 1598772826, "question_id": 57700865, "link": "https://stackoverflow.com/questions/57700865/selecting-excel-range-throwing-1004-error-in-ms-access-vba", "title": "Selecting Excel range throwing 1004 error in MS Access VBA", "body": "<p>I have a procedure that receives a file name and opens the file to copy a range of data into an Access database.</p>\n<p>It works if I run it one file at a time.</p>\n<p>When I pass it a second file it throws</p>\n<blockquote>\n<p>Method 'Range' of object'_Global' failed.</p>\n</blockquote>\n<p>If I close and start again it is fine.</p>\n<p>I have read a other questions about this error and tried different things.</p>\n<p>I validated there isn't anything different in any of the files. I ran it on at least 15 files one at a time and one-by-one they run fine. I tried calling the range in different ways, using Select instead of range, etc.</p>\n<p>I tried it in both Access 2010 and Access 2016.</p>\n<p>The error happens right after the &gt;&gt;&gt; PROBLEM HERE line below.</p>\n<pre><code>Dim appExcel As Excel.Application\nDim myWorkbook As Excel.Workbook\nDim mysheet As Excel.Worksheet\n\nSet appExcel = CreateObject(&quot;Excel.Application&quot;)\nSet myWorkbook = appExcel.Workbooks.Open(vfilepath &amp; &quot;\\&quot; &amp; vfilename)\nappExcel.Visible = True\n    \nWith appExcel\n\n    With appExcel.Worksheets(&quot;Sheet1&quot;).Activate\n\n        ' &gt;&gt;&gt; PROBLEM HERE\n        Worksheets(&quot;Sheet1&quot;).Range(&quot;B2&quot;, Range(&quot;N2&quot;).End(xlDown)).Select\n\n        Selection.Copy\n    End With\n\n    DoCmd.OpenTable &quot;tblExcelImport_Main&quot;, acViewNormal\n    DoCmd.RunCommand acCmdPasteAppend\n    DoCmd.Close acTable, &quot;tblExcelImport_Main&quot;, acSaveYes\n\n    myWorkbook.Close\n    appExcel.Quit\n    Set appExcel = Nothing\n    Set myWorkbook = Nothing\n    rst.Close\n    cnn.Close\n    \nEnd With\nEnd If\n</code></pre>\n<p>I need to loop through each file until finished (about 25 files - none are huge).</p>\n"}, {"tags": ["excel", "vba", "range", "criteria", "countif"], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1567055279, "last_edit_date": 1567055279, "creation_date": 1567054607, "answer_id": 57703207, "question_id": 57700666, "link": "https://stackoverflow.com/questions/57700666/debug-countif-and-autofill-in-excel-vba-criteria-doesnt-work/57703207#57703207", "title": "Debug countif and autofill in excel VBA, criteria doesn&#39;t work", "body": "<p>You can try this code</p>\n\n<pre><code>Dim paste_conPTD As Range\nSet paste_conYTD = Range(\"J2:J\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\nRange(\"K1\") = \"Count_PTD\"\n\nDim iRng as Range   \n\nFor each iRng in paste_conPTD\n\n    iRng.Offset(0,1) = Worksheetfunction.Countif(paste_conPTD, iRng)\n\nNext iRng\n</code></pre>\n\n<p>To give you some notes, we need to <em>iterate</em> over each cells in the <code>paste_conYTD</code> range, that is where <code>iRng</code> comes in. We can't tell Excel like <code>paste_conYTD = &lt;some formula&gt;</code> and assume Excel knows we want it to compute for each cells using the formula. Excel iteration comes in a few ways, we can choose one that is easiest to apply based on scenario.</p>\n\n<ul>\n<li><code>For each ... in ... Next</code></li>\n</ul>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/for-eachnext-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/for-eachnext-statement</a></p>\n\n<ul>\n<li><code>For ... Next</code></li>\n</ul>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/fornext-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/fornext-statement</a></p>\n\n<ul>\n<li><code>Do... Loop</code></li>\n</ul>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/doloop-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/doloop-statement</a></p>\n\n<ul>\n<li><code>While... Wend</code></li>\n</ul>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/whilewend-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/whilewend-statement</a></p>\n"}, {"tags": [], "owner": {"reputation": 3397, "user_id": 2850026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p9fbq.jpg?s=128&g=1", "display_name": "norie", "link": "https://stackoverflow.com/users/2850026/norie"}, "is_accepted": false, "score": 0, "last_activity_date": 1567069741, "creation_date": 1567069741, "answer_id": 57706785, "question_id": 57700666, "link": "https://stackoverflow.com/questions/57700666/debug-countif-and-autofill-in-excel-vba-criteria-doesnt-work/57706785#57706785", "title": "Debug countif and autofill in excel VBA, criteria doesn&#39;t work", "body": "<p>If you want the actual formula in the cells try this.\n    Dim paste_conPTD As Range</p>\n\n<pre><code>    Set paste_conYTD = Range(\"J2:J\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\n    Range(\"K1\").Value = \"Count_PTD\"\n    paste_conYTD.Offset(, 1).FormulaR1C1 = \"=COUNTIF(\" &amp; paste_conYTD.Address(ReferenceStyle:=xlR1C1) &amp; \",RC[-2])\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11257522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1003021183228140/picture?type=large", "display_name": "Lixin Tan", "link": "https://stackoverflow.com/users/11257522/lixin-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567433354, "creation_date": 1567030418, "last_edit_date": 1567433354, "question_id": 57700666, "link": "https://stackoverflow.com/questions/57700666/debug-countif-and-autofill-in-excel-vba-criteria-doesnt-work", "title": "Debug countif and autofill in excel VBA, criteria doesn&#39;t work", "body": "<p>I will need a function to count the number of each item in column J and show the result on column K. But this code I show below keep saying that the criteria part RC[-2] is wrong. After the countif function, I will need it to be able to autofill in whatever lines are given so that I can apply this code to other files as well.</p>\n\n<p>I used Macro to generate some code to start. And also try this earlier:\npaste_countPTD = Worksheetfunction.CountIf(paste_conPTD,RC[-2]).</p>\n\n<p>The criteria part seemed wrong.</p>\n\n<pre><code>Dim paste_conPTD As Range\nSet paste_conYTD = Range(\"J2:J\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\nRange(\"K1\").Select\nActiveCell.FormulaR1C1 = \"Count_PTD\"\nRange(\"K2\").Worksheetfunction.countif(paste_conPTD,RC[-2])\n</code></pre>\n\n<p>I appreciate any suggestion to make this code works. To do the countif for a column and autofill the formula.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1567046896, "creation_date": 1567046896, "answer_id": 57702334, "question_id": 57700043, "link": "https://stackoverflow.com/questions/57700043/error-91-when-creating-vba-charts-with-for-loop-in-a-separate-worksheet/57702334#57702334", "title": "Error 91 when creating VBA charts with For loop in a separate worksheet", "body": "<p>Your code will only work if worksheet <code>ws491g</code> is active.  </p>\n\n<p>Change it to use a Variable to reference the created chart, like this</p>\n\n<pre><code>Dim chrt As Chart\n'...\n\nSet chrt = ws491g.Shapes.AddChart2(240, xlXYScatter, (i * 360) - 720, 0, 360, 200).Chart\n\nWith chrt\n    '...\n\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11991270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBtRwiMbYIBoVyfyrche6ltABo7FgEY6Ee85sVqLg=k-s128", "display_name": "klacca", "link": "https://stackoverflow.com/users/11991270/klacca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57702334, "answer_count": 1, "score": 0, "last_activity_date": 1567046896, "creation_date": 1567026449, "last_edit_date": 1567028041, "question_id": 57700043, "link": "https://stackoverflow.com/questions/57700043/error-91-when-creating-vba-charts-with-for-loop-in-a-separate-worksheet", "title": "Error 91 when creating VBA charts with For loop in a separate worksheet", "body": "<p>My code works as intended when I output iterated charts into the same sheet as the source data (ws491), but I'm getting an error when I try to put them in another sheet (ws491g).</p>\n\n<p>Debug doesn't like this line</p>\n\n<p><code>.SetSourceData Source:=Union(ws491.Columns((5 * i) - 8), ws491.Columns((5 * i) - 5), ws491.Columns((5 * i) - 4))</code></p>\n\n<p>only when I output to a sheet other than ws491. I know Union can't combine ranges in multiple sheets, but I think I should be able to reference combined ranges from another sheet, right? Any advice is appreciated.</p>\n\n<p>Full code:</p>\n\n<pre><code>Set ws491 = Worksheets(\"49\")\nSet ws491g = Worksheets(\"49 Graphs\")\nSet copyrange = Worksheets(\"Log Data\").Range(\"A1:A10000,D1:D10000,F1:F10000,I1:I10000,J1:J10000\")\nSet pasterange = Worksheets(\"49\").Range(\"B1:AZ1000\")\nDim CtNum As Integer\n\nCtNum = Application.WorksheetFunction.CountA(ws491.Range(\"A2:A100\"))\n\npasterange.ClearContents\n\nFor i = 2 To CtNum\n\nwslog.Range(\"A1:K1\" &amp; Lastrow).AutoFilter Field:=2, Criteria1:=ws491.Range(\"A1\")\nwslog.Range(\"A1:K1\" &amp; Lastrow).AutoFilter Field:=4, Criteria1:=ws491.Range(\"A\" &amp; i)\ncopyrange.Copy\npasterange.Cells(1, (5 * i) - 9).PasteSpecial Paste:=xlPasteValues\n\nws491g.Shapes.AddChart2(240, xlXYScatter, (i * 360) - 720, 0, 360, 200).Select\n\nWith ActiveChart\n    .SetSourceData Source:=Union(ws491.Columns((5 * i) - 8), ws491.Columns((5 * i) - 5), ws491.Columns((5 * i) - 4))\n    .HasTitle = True\n    .ChartTitle.Characters.Text = Cells(2, (5 * i) - 7)\n    .ApplyChartTemplate ( _\n        \"C:\\Users\\-------\")\n    .Axes(xlCategory).MinimumScale = WorksheetFunction.Min(Columns((5 * i) - 8))\n    .Axes(xlCategory).MaximumScale = WorksheetFunction.Max(Columns((5 * i) - 8))\nEnd With\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "is_accepted": true, "score": 1, "last_activity_date": 1567059263, "creation_date": 1567059263, "answer_id": 57704028, "question_id": 57699965, "link": "https://stackoverflow.com/questions/57699965/loop-through-every-table-row-and-insert-different-formula/57704028#57704028", "title": "Loop through every table row and insert different formula", "body": "<p>The Excel Table is autofilling the whole column with the last Formula you entered on any Row.</p>\n\n<p>To Prevent this, put <code>Application.AutoCorrect.AutoFillFormulasInLists = False</code> in the beginning of your Sub.</p>\n"}], "owner": {"reputation": 73, "user_id": 5687881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e799b56beb52317202fe1555d9ff1ea3?s=128&d=identicon&r=PG&f=1", "display_name": "H_Braun", "link": "https://stackoverflow.com/users/5687881/h-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57704028, "answer_count": 1, "score": 0, "last_activity_date": 1567059263, "creation_date": 1567025920, "last_edit_date": 1567026815, "question_id": 57699965, "link": "https://stackoverflow.com/questions/57699965/loop-through-every-table-row-and-insert-different-formula", "title": "Loop through every table row and insert different formula", "body": "<p>i have a table with predefined rows and columns. I want to loop through every row and put a different formula into each cell. The cell should show data from a different worksheet. This step is to be repeated for every column.</p>\n\n<pre><code>                                      Repeat:\n+--------+--------+-----+---------+  1 || 2 -&gt;\n|Column 1|Column 2| ... | Column n|  |\n+--------+--------+-----+---------+  |\n|row 1   | row 1  | ... | row 1   |  |\n+--------+--------+-----+---------+  v\n|                ...              |\n+--------+--------+-----+---------+\n|row n   | row n  | ... | row n   |\n+--------+--------+-----+---------+\n\n</code></pre>\n\n<p>I tried using a for loop, which runs until the last row and places the formula with the .FormulaLocal method into the current cell.</p>\n\n<pre><code>For i = 1 To UBound(bmPos)\n        curTable.DataBodyRange.Cells(i, curTable.ListColumns(\"Column1\").Index).FormulaLocal = _\n                \"=Table1!\" &amp; wksBM.Cells(bmPos(i), rngDate.Column).Address\n        [...]\n        curTable.DataBodyRange.Cells(i, curTable.ListColumns(\"ColumnN\").Index).FormulaLocal = _\n                \"=Table1!\" &amp; wksBM.Cells(bmPos(i), rngCustomer.Column).Address\nNext i\n\n</code></pre>\n\n<p>The expected result is that each cell <em>i</em> contains a formula like this:\n=Table1!$A$1 ... =Table1!$A$ <em>i</em></p>\n\n<p>What i see when i step through my code with the debugger is, that in the very first iteration, <strong>all</strong> rows get the same value. So after the last iteration, all rows contain the formula  =Table1!$A$ <em>i</em></p>\n\n<p>Infact, when I replace the whole formula with just <em>i</em>, I get the right iteration step in the cell.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1567027303, "post_id": 57699780, "comment_id": 101844364, "body": "If you want to remember all the cells changed in various phases I think you might have to store the number of changes in a cell. Does that sound workable? Otherwise they will be &quot;forgotten&quot; every time you make another change."}], "answers": [{"tags": [], "owner": {"reputation": 3397, "user_id": 2850026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p9fbq.jpg?s=128&g=1", "display_name": "norie", "link": "https://stackoverflow.com/users/2850026/norie"}, "is_accepted": false, "score": 0, "last_activity_date": 1567071121, "creation_date": 1567071121, "answer_id": 57707181, "question_id": 57699780, "link": "https://stackoverflow.com/questions/57699780/i-am-working-on-a-vba-code-to-store-all-the-worksheet-changes-into-an-array-and/57707181#57707181", "title": "I am working on a VBA code to store all the worksheet changes into an array and before closing use all the &quot;targets&quot; to send out email notifications", "body": "<p>You could try declaring the array(s) as Public in a standard (Insert>Module) module.</p>\n\n<p>If you do that though you would probably lose all the values in the arrays if there are errors encountered in the code.</p>\n"}], "owner": {"reputation": 1, "user_id": 11991250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41aa55cccb8431fb5f0f3a45f0baa0e2?s=128&d=identicon&r=PG&f=1", "display_name": "ssdeshp4", "link": "https://stackoverflow.com/users/11991250/ssdeshp4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567433361, "creation_date": 1567024934, "last_edit_date": 1567433361, "question_id": 57699780, "link": "https://stackoverflow.com/questions/57699780/i-am-working-on-a-vba-code-to-store-all-the-worksheet-changes-into-an-array-and", "title": "I am working on a VBA code to store all the worksheet changes into an array and before closing use all the &quot;targets&quot; to send out email notifications", "body": "<p>I already have a working code to send out emails when a cell is changed. However I want to wait till all the changes are made in the worksheet and either before closing or after saving I want the email notifications to be sent out. \nThe problem I am facing is In Worksheet_change I am not able to store all the target values in an array  and use them in <code>Before_close</code> or <code>After_save</code> events. Can you please assist me in how to pass those values?</p>\n\n<ol>\n<li>For storing values in an array I tried the following :</li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim DiffAddys() As String, NewValues() As Variant\n\nApplication.EnableEvents = False\n\nReDim DiffAddys(Target.Cells.Count)\nReDim NewValues(Target.Cells.Count)\n\ni = 1 \n\nFor Each aCell In Target.Cells\n\n   DiffAddys(i) = aCell.Address\n    NewValues(i) = aCell.Value\n    i = i + 1\nMsgBox (aCell.Value)\nMsgBox (DiffAddys(2))\nNext aCell\n</code></pre>\n\n<ol start=\"2\">\n<li>To get the variable into Before_close, I made both the subs public and tried to use the array as it is.</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567023567, "post_id": 57699506, "comment_id": 101842951, "body": "Do you want the entire path or just the filename? <code>MyPath &amp; LatestFile</code> is the entire path; <code>LatestFile</code> is the filename. Just write whichever one you need to the cell in question."}, {"owner": {"reputation": 17, "user_id": 10881462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c62748118b897b8034b2460ed40df4?s=128&d=identicon&r=PG&f=1", "display_name": "RonanC", "link": "https://stackoverflow.com/users/10881462/ronanc"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567028317, "post_id": 57699506, "comment_id": 101844675, "body": "Thank you for replying I&#39;m still learning! But every response is great cause I can glean something new each time :)"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1567025845, "creation_date": 1567025845, "answer_id": 57699948, "question_id": 57699506, "link": "https://stackoverflow.com/questions/57699506/pull-filename-from-latest-file/57699948#57699948", "title": "Pull Filename From Latest File", "body": "<p>You can do something like this:</p>\n\n<pre><code>Sub Macro3()\n\n    Dim MyPath As String\n    Dim MyFile As String\n    Dim LatestFile As String\n    Dim LatestDate As Date\n    Dim LMD As Date\n    Dim wb As WorkBook, wsDest As Worksheet '&lt;&lt;&lt;\n\n    Application.DisplayAlerts = False\n\n    MyPath = \"C:\\Users\\XXXX\\Desktop\\folderXXX\"\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n    MyFile = Dir(MyPath &amp; \"XYZ-********-123.csv\", vbNormal)\n    If Len(MyFile) = 0 Then\n        'MsgBox \"No files were found\u2026\", vbExclamation\n            Exit Sub\n    End If\n    Do While Len(MyFile) &gt; 0\n        LMD = FileDateTime(MyPath &amp; MyFile)\n        If LMD &gt; LatestDate Then\n            LatestFile = MyFile\n            LatestDate = LMD\n        End If\n        MyFile = Dir\n    Loop\n\n    Set wsDest = ThisWorkbook.WorkSheets(\"Data\") '&lt;&lt; for example\n\n    Set wb = Workbooks.Open(MyPath &amp; LatestFile)\n\n    wb.Sheets(1).Range(\"B2:D97\").Copy wsDest.Range(\"A2\")\n    wb.Close False '&lt;&lt; don't save\n\n    wsDest.Range(\"A1\").Value = LatestFile '&lt;&lt; record the file name\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10881462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63c62748118b897b8034b2460ed40df4?s=128&d=identicon&r=PG&f=1", "display_name": "RonanC", "link": "https://stackoverflow.com/users/10881462/ronanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57699948, "answer_count": 1, "score": 0, "last_activity_date": 1567025845, "creation_date": 1567023424, "last_edit_date": 1567024191, "question_id": 57699506, "link": "https://stackoverflow.com/questions/57699506/pull-filename-from-latest-file", "title": "Pull Filename From Latest File", "body": "<p>I am using the following code (co-opted from someone here) to access the latest generated files from a folder. I use it to open the file and do various bits (example below). But I was wondering if there is a way to pull the filename from the latest file and paste it into a cell in another workbook?</p>\n\n<pre><code>Sub Macro3()\n\n    Dim MyPath As String\n    Dim MyFile As String\n    Dim LatestFile As String\n    Dim LatestDate As Date\n    Dim LMD As Date\n\n\n    Application.DisplayAlerts = False\n\n    MyPath = \"C:\\Users\\XXXX\\Desktop\\folderXXX\"\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n    MyFile = Dir(MyPath &amp; \"XYZ-********-123.csv\", vbNormal)\n    If Len(MyFile) = 0 Then\n        'MsgBox \"No files were found\u2026\", vbExclamation\n            Exit Sub\n    End If\n    Do While Len(MyFile) &gt; 0\n        LMD = FileDateTime(MyPath &amp; MyFile)\n        If LMD &gt; LatestDate Then\n            LatestFile = MyFile\n            LatestDate = LMD\n        End If\n        MyFile = Dir\n    Loop\n    Workbooks.Open MyPath &amp; LatestFile\n\n    Range(\"B2:D97\").Copy\n    ActiveWindow.Close\n    Windows(\"New.xlsm\").Activate\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>Can it been done with the existing code, is it as simple as adding something to this line <code>Workbooks.Open MyPath &amp; LatestFile</code> instead of <code>.Open</code>?</p>\n\n<p>Appreciate any help or tips even tips to tidy it up in any way. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1567023763, "post_id": 57699443, "comment_id": 101843016, "body": "Are you running this code from outside of Excel? You don&#39;t need to declare your objects like that from within the application."}], "answers": [{"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1567023958, "creation_date": 1567023958, "answer_id": 57699597, "question_id": 57699443, "link": "https://stackoverflow.com/questions/57699443/batch-opening-hyperlinks-opens-each-link-twice/57699597#57699597", "title": "Batch Opening Hyperlinks Opens Each Link Twice", "body": "<p>Check your selection. I tested this and only one tab opened:</p>\n\n<pre><code>Sub BatchOpenHyperLinks_SelectedRanges()\n    Dim thisHyperlink As Hyperlink\n    For Each thisHyperlink In Selection.Hyperlinks\n        thisHyperlink.Follow\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11991164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147e1fc17f67521e10607567c8d1fe42?s=128&d=identicon&r=PG&f=1", "display_name": "akaorenji", "link": "https://stackoverflow.com/users/11991164/akaorenji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567433367, "creation_date": 1567023070, "last_edit_date": 1567433367, "question_id": 57699443, "link": "https://stackoverflow.com/questions/57699443/batch-opening-hyperlinks-opens-each-link-twice", "title": "Batch Opening Hyperlinks Opens Each Link Twice", "body": "<p>When I run this macro on a selected column of hyperlinks, two tabs open for each link.</p>\n\n<pre><code>Sub BatchOpenHyperLinks_SelectedRanges()\n    Dim objSelectedRange As Excel.Range\n    Dim objHyperlink As Excel.Hyperlink\n\n    'Get selected ranges\n    Set objSelectedRange = Excel.Application.Selection\n    For Each objHyperlink In objSelectedRange.Hyperlinks\n        objHyperlink.Follow\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-addins"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567023566, "post_id": 57699270, "comment_id": 101842950, "body": "FWIW you&#39;re discarding the opened workbook; capture the reference instead of assuming the opened book is the active workbook - <code>Set wb1 = Workbooks.Open(...)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1567024044, "creation_date": 1567024044, "answer_id": 57699616, "question_id": 57699270, "link": "https://stackoverflow.com/questions/57699270/how-to-initiate-addin-code-on-beforeclose-event/57699616#57699616", "title": "How to initiate addin code on .BeforeClose() event", "body": "<p>You shouldn't ever be typing event handler procedure signatures by hand.</p>\n\n<blockquote>\n<pre><code>Private WithEvents App As Application\n</code></pre>\n</blockquote>\n\n<p>This <code>WithEvents</code> variable adds an <code>App</code> entry in the code pane's left-hand dropdown:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pOxdP.png\" alt=\"App variable in the LHS dropdown\"></p>\n\n<p>Select it. Now expand the right-hand dropdown...</p>\n\n<p><img src=\"https://i.stack.imgur.com/SsebA.png\" alt=\"available events for the App event source\"></p>\n\n<p>When you select a member in the RHS dropdown, the VBE automatically creates the handler procedure for you, <em>and it is guaranteed to be valid and well-formed</em>. Whereas if you type them from memory, a mistake in parameter ordering can cause a lot of grief.</p>\n\n<p>In any case, the <code>Excel.Application</code> object does not expose a <code>BeforeClose</code> event, so while your procedure <em>looks</em> like an event handler, the LHS dropdown says <strong>(General)</strong> (instead of an event source object), and the \"handler\" is never actually invoked.</p>\n\n<p>But, since <code>ThisWorkbook</code> is an add-in, it will be loaded along with Excel, and unless unloaded manually, will be unloaded <em>also</em> along with Excel - so if you handle <code>Workbook.BeforeClose</code> in <code>ThisWorkbook</code>, then you'll get to run custom code when Excel closes your add-in - <em>whether because the add-in is being unloaded, or because Excel is shutting down</em>.</p>\n"}], "owner": {"reputation": 31, "user_id": 6693033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b87f1b9bb7a12911fcd42f933a0e17e?s=128&d=identicon&r=PG&f=1", "display_name": "Totos", "link": "https://stackoverflow.com/users/6693033/totos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57699616, "answer_count": 1, "score": 1, "last_activity_date": 1567024044, "creation_date": 1567022181, "question_id": 57699270, "link": "https://stackoverflow.com/questions/57699270/how-to-initiate-addin-code-on-beforeclose-event", "title": "How to initiate addin code on .BeforeClose() event", "body": "<p>I am trying to build my first excel addin that would initiate a code on close of the workbook once certain condition is met. The condition is checked by the on error go to end.</p>\n\n<p>When I run my addin, it looks like this entire part of code does not get initiated.</p>\n\n<p>This code is currently stored in the ThisWorkbook of the add-in.</p>\n\n<pre><code>Private WithEvents App As Application\n\nPrivate Sub Workbook_Open()\n    Set App = Application\nEnd Sub\n\nPrivate Sub App_BeforeClose(Cancel As Boolean)\n    Dim wb1 As Workbook\n    Dim lastrow As Integer\n\n    On Error GoTo ENDING\n    Application.ScreenUpdating = False\n    Workbooks.Open (ActiveWorkbook.Sheets(\"ADDIN-\n\nDONOTTOUCH\").Cells(1.1).Value)\n    Set wb1 = ActiveWorkbook\n    Set ws = wb1.ActiveSheet\n    lastrow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n.....'Other code....\n\nwb1.Save\nwb1.Close\n\nApplication.DisplayAlerts = False\nActiveWorkbook.Sheets(\"ADDIN-DONOTTOUCH\").Delete\nApplication.DisplayAlerts = True\n\nApplication.ScreenUpdating = True\nENDING:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "arguments", "user-defined-functions"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1567022309, "post_id": 57699267, "comment_id": 101842437, "body": "To debug, call <code>SLV</code> from a sub instead of as a UDF from the worksheet. What line throws the error? Note that you have to repeat the type in VBA, otherwise variables are actually <code>Variant</code>s: <code>Dim det as Single, root1 as Single, root2 as Single...</code>."}, {"owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567022593, "post_id": 57699267, "comment_id": 101842576, "body": "Many thanks for the useful tip!!! I&#39;ve already change the code in variable declaration as you pointed out. My current formula is <code>=slv(B14&#47;2,(Q19*S34)*10^(-4),(-Q19*S34*D14+O19*S34*L19)*10^(&zwnj;&#8203;-4))</code>. However, I&#39;ve come to find that only argument C gives error, not A or B. Does this help?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567022680, "post_id": 57699267, "comment_id": 101842612, "body": "Well <code>c</code> shouldn&#39;t be <code>As Range</code> right?"}, {"owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1567022760, "post_id": 57699267, "comment_id": 101842647, "body": "I&#39;m sorry for being a beginner, but I cannot pass an arguments operation as a range? Should it be declared as long?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1567022816, "post_id": 57699267, "comment_id": 101842670, "body": "<code>Function SLV(ByVal a As Double, ByVal b as Double, ByVal c As Double) As Double</code>"}, {"owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1567022909, "post_id": 57699267, "comment_id": 101842707, "body": "It is working now!!!!! Many thanks @ScottCraner"}, {"owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1567022961, "post_id": 57699267, "comment_id": 101842723, "body": "Many thanks @BigBen!!!!!!"}, {"owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "edited": false, "score": 0, "creation_date": 1567022975, "post_id": 57699267, "comment_id": 101842728, "body": "You may post it as solution!!!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1567023260, "creation_date": 1567023260, "answer_id": 57699476, "question_id": 57699267, "link": "https://stackoverflow.com/questions/57699267/how-to-pass-as-argument-cells-operation-instead-of-single-cell-in-excel-vba-udf/57699476#57699476", "title": "How to pass as argument cells operation instead of single cell in Excel VBA UDF?", "body": "<p>1: You need to specify the type in variable declaration, otherwise the variables are actually <code>Variant</code>s: <code>Dim det as Single, root1 as Single, root2 as Single...</code>. Though <code>As Double</code> would be preferred here for more precision.</p>\n\n<p>2: Since the arguments are no longer <code>Range</code>s, change the types:</p>\n\n<pre><code>Function SLV(ByVal a As Double, ByVal b As Double, ByVal c As Double) As Double\n\n    Dim det As Double, root1 As Double, root2 As Double, rootf As Double, result As Double\n\n    &lt;several operations&gt;\n\n    SLV = result\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 57699476, "answer_count": 1, "score": 0, "last_activity_date": 1567433376, "creation_date": 1567022173, "last_edit_date": 1567433376, "question_id": 57699267, "link": "https://stackoverflow.com/questions/57699267/how-to-pass-as-argument-cells-operation-instead-of-single-cell-in-excel-vba-udf", "title": "How to pass as argument cells operation instead of single cell in Excel VBA UDF?", "body": "<p>I've created a UDF to calculate a nonlinear equation which considers 3 arguments (A1, B1 and C1). The results comes in D1 (=SLV(A1; B1; C1)).</p>\n\n<p>What I am trying to do is to give a operation between cells instead of A1, B1 or C1.\nAs example: instead of A1, I would like to write G1/H1^(K1*10^-4).</p>\n\n<p>My UDF function is given below:</p>\n\n<pre><code>Function SLV(ByVal a, b, c As Range) As Single\n\n    Dim det, root1, root2, rootf As Single\n\n    &lt;several operations&gt;\n\n    SLV = result\n\nEnd Function\n</code></pre>\n\n<p>This results in error <code>#VALUE</code>.</p>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567023060, "post_id": 57699199, "comment_id": 101842756, "body": "<code>xlCalculationAutomatic</code> though I think it&#39;s the same value as <code>xlAutomatic</code>"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567026170, "post_id": 57699199, "comment_id": 101843937, "body": "Where did you insert <code>Sub_Pause (45)</code> inside <code>Global</code> ?"}, {"owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567086688, "post_id": 57699199, "comment_id": 101865600, "body": "@Tim: xlCalculationAutomatic has the same outcome as xlAutomatic. Thanks though."}, {"owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567099537, "post_id": 57699199, "comment_id": 101872187, "body": "@DecimalTurn: The Sub_Pause is placed immediately below Sub_Update"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567107752, "post_id": 57699199, "comment_id": 101875387, "body": "Is it necessary to include <code>ActiveWorkbook.RefreshAll</code> inside <code>Sub_Pause</code>? According to the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.refreshall\" rel=\"nofollow noreferrer\">MDSN Article</a>, it &quot;refreshes all external data ranges&quot; which seems like it would restart the whole updating process."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567112230, "post_id": 57699199, "comment_id": 101876994, "body": "Actually, I just made a test and apparently <code>ActiveWorkbook.RefreshAll</code> does not refresh external data links, so you can ignore my comment."}, {"owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567116279, "post_id": 57699199, "comment_id": 101878052, "body": "@DecimalTurn: Thanks for your efforts. I had previously removed all RefreshAll commands as well, but still didn&#39;t work.  At this point I&#39;d be happy to know if anyone can duplicate my problem (so I know I&#39;m not completely crazy), or if there is an alternate solution that does work."}, {"owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 1, "creation_date": 1574185998, "post_id": 57699199, "comment_id": 104138665, "body": "@DecimalTurn: It has been a few months, but I wanted to tell you the proper command for refreshing external data links: <code>Application.CalculateFullRebuild</code>. This commnd forces Excel to rebuild each formula and reconnect to external links, refreshing the external data. This, coupled with your timing solution provides the flexibility I needed. Thank you."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1574188444, "post_id": 57699199, "comment_id": 104139906, "body": "Good to know, thanks. There is weirdly no mention of it on this <a href=\"https://docs.microsoft.com/en-us/office/client-developer/excel/excel-recalculation?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">MSDN page</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "edited": false, "score": 0, "creation_date": 1567180173, "post_id": 57719090, "comment_id": 101899939, "body": "This approach solved the update problem.  THANK YOU."}, {"owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "edited": false, "score": 0, "creation_date": 1567180280, "post_id": 57719090, "comment_id": 101899987, "body": "Sorry that my reputation points don&#39;t meet the minimum for my vote to count. I did vote this as the most useful."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "edited": false, "score": 0, "creation_date": 1567180457, "post_id": 57719090, "comment_id": 101900067, "body": "@Steve I&#39;m glad I could help. If this solves your question, you can still accept it by <a href=\"https://meta.stackexchange.com/a/5235/372533\">clicking the check mark beside it</a>. This does not require reputation."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 0, "last_activity_date": 1574188477, "last_edit_date": 1574188477, "creation_date": 1567124742, "answer_id": 57719090, "question_id": 57699199, "link": "https://stackoverflow.com/questions/57699199/vba-not-refreshing-calculated-cells-links/57719090#57719090", "title": "VBA not refreshing calculated cells &amp; links", "body": "<p>It's hard to replicate those kinds of problems with cells and calculations refreshing since there is a lot going on when those happen and some other factors can interfere which makes things more uncertain.</p>\n\n<p>In order to have a more reliable method to create a pause in your code, I would suggest using the <code>Application.OnTime</code> method. It will schedule a macro at a later time, so you can return the full control to Excel in the meantime in order to let Excel update calculations and cells.</p>\n\n<p>For example, you could do the following:</p>\n\n<pre><code>Public RepeatCounter As Long\n\nSub Main()\n\n    Dim ActiveWKB As Workbook\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = True\n    Application.Calculation = xlManual\n    Set ActiveWKB = Workbooks.Open(\"Master.xlsx\")\n    Set ActiveWKB = Workbooks.Open(\"Sub01.xlsx\")\n    Sub_Update\n\n\n    RepeatCounter = 0 'Reset Counter\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"PauseInOrOut\" 'Start Pause\nEnd Sub\n\n\nSub PauseInOrOut()\n\n    'Customizable parameter\n    Const RepeatLimit As Long = 3\n\n    If RepeatCounter &lt; RepeatLimit Then\n        If Application.WorksheetFunction.CountIf(Range(\"C2:Q1100\"), \"#N/A\") = 0 Then\n            MsgBox \"Pause completed\"\n            'You can call the code that needs to run after the pause here\n        Else\n            RepeatCounter = RepeatCounter + 1\n            Application.OnTime Now + TimeValue(\"00:00:10\"), \"PauseInOrOut\" 'Run this macro again\n        End If\n    Else\n        MsgBox \"Values couldn't be updated within time limit.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Here, I've put a waiting time of 10 seconds before running your \"pause\" macro the next time. I've also added a limit, so it wouldn't run forever. Feel free to modify the condition for the pause to be completed in a way that suits your needs, I've added an example here that would match what I got from your question regarding the NAs.</p>\n"}], "owner": {"reputation": 13, "user_id": 10792147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14674933da8aa08fa4ffed1f76a96c61?s=128&d=identicon&r=PG&f=1", "display_name": "Steve ", "link": "https://stackoverflow.com/users/10792147/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 57719090, "answer_count": 1, "score": 0, "last_activity_date": 1574188477, "creation_date": 1567021842, "last_edit_date": 1567098883, "question_id": 57699199, "link": "https://stackoverflow.com/questions/57699199/vba-not-refreshing-calculated-cells-links", "title": "VBA not refreshing calculated cells &amp; links", "body": "<p>In Short: My update macro runs, but cells are not updated if additional SUBs are included. Cells are updated if no additional SUBs are included.</p>\n\n<p>I have a series of spreadsheets with anywhere between 5000 and 25000 calculated cells. My end goal is to link these spreadsheets together to iteratively update all cells and links.\nThe update code by itself works fine. But cell values no longer update if I include a timing loop or a check to see of all values are updated.</p>\n\n<p>The basic code that works:</p>\n\n<pre><code>     Sub Global()\n      Dim ActiveWKB As Workbook\n      Application.DisplayAlerts = False\n      Application.ScreenUpdating = True\n      Application.Calculation = xlManual\n      Set ActiveWKB = Workbooks.Open(\"Master.xlsx\")\n      Set ActiveWKB = Workbooks.Open(\"Sub01.xlsx\")\n      Sub_Update\n    End Sub\n    Sub Sub_Update()\n      Application.ScreenUpdating = True\n      Application.Calculation = xlAutomatic\n      Application.CalculateFull\n      ActiveWorkbook.UpdateLink Name:=ActiveWorkbook.LinkSources\n    End Sub\n</code></pre>\n\n<p>I am adding the following code (the code itself runs fine), but does NOT update the calculated links &amp; cells:</p>\n\n<p>I've added the following to Sub Global, below Sub_Update:</p>\n\n<pre><code>     Sub_Pause (45)\n</code></pre>\n\n<p>Sub_Pause contains the following code:</p>\n\n<pre><code>      Dim StartTime\n      Dim Delay\n      StartTime = Timer\n      Application.ScreenUpdating = True\n          Do\n          Delay = Timer - StartTime\n          Application.ScreenUpdating = True\n          DoEvents\n      Loop Until Delay &gt;= EndPoint\n      ActiveWorkbook.RefreshAll   \n      Application.Calculation = xlManual\n      MsgBox(\u201cSub_Pause Done\u201d)\n     End Sub\n</code></pre>\n\n<p>This SUB pauses for 45 seconds, displays the message \"Sub_Pause Done\", then the macro ends.</p>\n\n<p>After running WITHOUT Sub_Pause, my dashboard shows how many cells remain to be updated, (initially at 10134) and counts down to zero. The cells themselves slowly change from #N/A to the updated value.</p>\n\n<p>After running WITH Sub_Pause, my dashboard shows the initial number of cells to be updated (10134) and the cell values are never refreshed (Display #N/A instead)</p>\n\n<p>I've tried replacing the timer in Sub_Pause with the following partial code to simply count the number of #NA's remaining:</p>\n\n<pre><code>      NAs = Application.WorksheetFunction.Countif(Range(\u201cC2:Q1500),\u201c#N/A\u201d)\n</code></pre>\n\n<p>I embedded a message box within the Do Until loop to display the variable NAs.</p>\n\n<p>Stepping through shows the variable NAs never changes from the initial count of 10134.</p>\n\n<p>Any suggestions on how I can get the values to update while running Sub_Pause?</p>\n\n<p>The purpose of this sub is to pause the macro long enough for all cells to update before I save and close the file, then open up the next spreadsheet file.</p>\n\n<p>Any suggestions?\nThanks</p>\n\n<p><strong>Update:</strong>\nAfter the macro ended I accidentally hit a hotkey to turn on automatic calculation (Automatic calculation was already on).</p>\n\n<p>All cells immediately updated to their calculated values and my dashboard updated the number of #NA values from 10134 to 0.</p>\n\n<p>Thinking this may have been a screen refresh problem I inserted the following code into my Sub_Pause:</p>\n\n<pre><code>    Dim NACount As Long\n.\n .\n  .\n        NACount = Application.WorksheetFunction.CountIf(Range(\"C2:Q1100\"), \"#N/A\")\n        MsgBox (NACount)\n</code></pre>\n\n<p>The full Sub_Pause reads:</p>\n\n<pre><code>    Sub Sub_Pause(EndPoint As Long)\n\n    Dim StartTime\n    Dim Delay\n    StartTime = Timer\n    Dim NACount As Long\n\n    Application.ScreenUpdating = True\n\n    Do\n        Delay = Timer - StartTime\n        DoEvents\n        ActiveWorkbook.RefreshAll\n        NACount = Application.WorksheetFunction.CountIf(Range(\"C2:Q1100\"), \"#N/A\")\n        MsgBox (NACount)\n\n    Loop Until Delay &gt;= EndPoint\n\n    ActiveWorkbook.RefreshAll\n\n    NACount = Application.WorksheetFunction.CountIf(Range(\"C2:Q1100\"), \"#N/A\")\n    MsgBox (NACount)\n\n    End Sub\n</code></pre>\n\n<p>Both within the Do Until loop and at the end of Sub_Pause the NACount came back as 10134, showing this is not a screen refresh problem, but the macro code is not recognizing that the cells have been updated.\nAs soon as the macro finished I immediately hit the hotkey to turn automatic calculations \"On\" (they were already on).</p>\n\n<p>The count of #NAs immediately set to zero.</p>\n\n<p>If there were simply a screen refresh issue, the NACount would reflect the internal value of zero. Because it reflects the internal count of 10134, I have to believe that the VBA code is not recognizing that the cell values have been updated.</p>\n\n<p>I ran these on my laptop as well (from OneDrive) with the same results.</p>\n\n<p>Any insights? Suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1567021414, "post_id": 57699048, "comment_id": 101842080, "body": "try <code>cells(i.&quot;A&quot;).value = replace(textbox1.value,vbCrLf,&quot;&quot;)</code> - where you&#39;re replacing vbCrLf (x000d or carriagereturn + linefeed) with empty string"}, {"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1567021551, "post_id": 57699048, "comment_id": 101842141, "body": "thanks for the answer .will try it"}], "owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1567022903, "creation_date": 1567021090, "last_edit_date": 1567022903, "question_id": 57699048, "link": "https://stackoverflow.com/questions/57699048/avoid-x000d-due-to-line-breaks", "title": "avoid &quot;_X000D&quot; due to line breaks", "body": "<p>when copied multiline text from texttbox of an userform to an excel cell something like <em>x000d</em> is getting added at the end of each line.when i googled it i understood it is due to line break .but line break is really necessary for me.this </p>\n\n<pre><code>cells(i,\"A\").value = textbox1.value\n</code></pre>\n\n<p>i would like to get multi-line data in cell without \"<em>x000d</em> \"</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567080698, "post_id": 57699146, "comment_id": 101861905, "body": "This is removing values that are not dups"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567081406, "post_id": 57699146, "comment_id": 101862294, "body": "Shouldn&#39;t be, I am unable to recreate an instance where it does. Could you give me an example that I can test?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567081648, "post_id": 57699146, "comment_id": 101862417, "body": "That is strange."}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567081850, "post_id": 57699146, "comment_id": 101862536, "body": "Sorry - removed my last comment.  Yes I&#39;ll give examples where it is not working."}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567082230, "post_id": 57699146, "comment_id": 101862765, "body": "Under the end sub above.  It removed the value C-3.  Column D is a copy column of C for reference.  C3 should have remained -25"}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567082425, "post_id": 57699146, "comment_id": 101862886, "body": "in the picture example, it removed values that were not dups at all."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567082467, "post_id": 57699146, "comment_id": 101862914, "body": "It does not do that on my end. Are you sure you changed all the cell references to be Column C instead of Column B like in my answer? Using your 6 rows that you edited in, the only thing it removes for me is the second -17.44 everything else is still there."}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567082799, "post_id": 57699146, "comment_id": 101863108, "body": "Yes - i changed the argument to point to the correct cell in the .Cells() method"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567083006, "post_id": 57699146, "comment_id": 101863247, "body": "Just edited in the proper ones anyway. I&#39;m not sure what it could be then, I can&#39;t reproduce it."}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567083436, "post_id": 57699146, "comment_id": 101863515, "body": "I debugged and added a few dummy columns.  Its behaving as if the first 2 characters - after finding a dup - are &quot;stored&quot; in a memory of sorts.  It recognized -100 as a dup of -10."}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567083842, "post_id": 57699146, "comment_id": 101863821, "body": "Note i added this: dupedict.RemoveAll  after the Else and value=&quot;&quot; and it seems to be working"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567083937, "post_id": 57699146, "comment_id": 101863879, "body": "If you remove all from the dupedict it shouldn&#39;t delete anything at all because you are clearing it&#39;s contents. There will never be more than a single entry in the dictionary."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567084023, "post_id": 57699146, "comment_id": 101863936, "body": "You don&#39;t have the two loops from the code in your question, applied to the code in my answer do you?"}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567085576, "post_id": 57699146, "comment_id": 101864864, "body": "No, i do not have two loops.  I had your code copy+paste and only changed the column reference"}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567085682, "post_id": 57699146, "comment_id": 101864930, "body": "for the delete of records - i&#39;m not sure then.. its def removing items that are not dups to the item above.  For example, in the data set there will be more instances of &quot;-17.44&quot;.. but i dont need all of them removed, just the instances where they duplicate the row above it."}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567086134, "post_id": 57699146, "comment_id": 101865247, "body": "I added a larger data set to test as requested.. column &quot;B&quot; is the use case."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567086549, "post_id": 57699146, "comment_id": 101865513, "body": "Ohh, you only want to delete duplicates that are immediately following?"}, {"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567086668, "post_id": 57699146, "comment_id": 101865588, "body": "yes - that is correct; all of the dups that immediately follow. it could be 1, or more rows.. but if they &quot;follow&quot; i dont need them."}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1567086870, "last_edit_date": 1567086870, "creation_date": 1567021566, "answer_id": 57699146, "question_id": 57698993, "link": "https://stackoverflow.com/questions/57698993/how-to-continue-a-loop-if-a-duplicate-value-is-found-vba/57699146#57699146", "title": "How to continue a loop if a duplicate value is found VBA", "body": "<p>This should remove every duplicate after the first instance, using a dictionary.</p>\n\n<pre><code>Sub dupes()\n    Dim lastrow As Long\n    Dim i As Long\n    Dim dupedict As Object\n\n    Set dupedict = CreateObject(\"Scripting.Dictionary\") 'Can early bind if you add in the scripting runtime reference\n    With ActiveSheet 'Make this an explicit reference\n        lastrow = .Cells(Rows.Count, 2).End(xlUp).Row\n\n        For i = 2 To lastrow\n            If Not dupedict.exists(.Cells(i, 3).Value) Then\n                dupedict.Add .Cells(i, 3).Value, \"\"\n            Else\n                .Cells(i, 3).Value = \"\"\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>This will remove only duplicates that immediately follow the original.</p>\n\n<pre><code>Option Explicit\n\nSub dupes()\n    Dim lastrow As Long\n    Dim i As Long\n    Dim dupecheck As String\n    With ActiveSheet 'Make this an explicit reference\n        lastrow = .Cells(Rows.Count, 2).End(xlUp).Row\n        dupecheck = \"\"\n        For i = 2 To lastrow\n            If dupecheck = \"\" Or dupecheck &lt;&gt; .Cells(i, 3).Value Then\n                dupecheck = .Cells(i, 3).Value\n            Else\n                .Cells(i, 3).Value = \"\"\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "edited": false, "score": 0, "creation_date": 1567080731, "post_id": 57699170, "comment_id": 101861926, "body": "This is giving this error: &quot;User-defined type not defined&quot;"}], "tags": [], "owner": {"reputation": 31, "user_id": 11969514, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gwIV7wpKov0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reBL9n5H61RZ7qF-GCtJ4_ns7h2pg/photo.jpg?sz=128", "display_name": "weixing zhang", "link": "https://stackoverflow.com/users/11969514/weixing-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1567021688, "creation_date": 1567021688, "answer_id": 57699170, "question_id": 57698993, "link": "https://stackoverflow.com/questions/57698993/how-to-continue-a-loop-if-a-duplicate-value-is-found-vba/57699170#57699170", "title": "How to continue a loop if a duplicate value is found VBA", "body": "<p>What you need is the dictionary function which will record all the existing value. Proposed codes like following:</p>\n\n<pre><code>Sub RemoveDups()\nDim LastRow As Long\nDim i As Long\nLastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nSet eleDict = New Scripting.Dictionary\nFor i = 2 To LastRow\n    If eleDict.Exists(Range(\"B\" &amp; i).Value) Then\n        'remove the cell value\n        Cell(i, 2).Value = \"\"\n    Else\n        eleDict(Range(\"B\" &amp; i).Value) = 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7226307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-imEf4OqCssk/AAAAAAAAAAI/AAAAAAAAACE/2Y9XkiNwHlU/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/7226307/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1179, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1581926861, "creation_date": 1567020853, "last_edit_date": 1581926861, "question_id": 57698993, "link": "https://stackoverflow.com/questions/57698993/how-to-continue-a-loop-if-a-duplicate-value-is-found-vba", "title": "How to continue a loop if a duplicate value is found VBA", "body": "<p>I have a large data set (we're using excel macros).  Some of the values are duplicated in the row or rows after:</p>\n\n<pre><code> A     B       C       D\n1234  300    2001    389\n6546  300    2005    485\n8631  124    9583    562\n1234  500    2001    389\n6546  500    2005    485\n8631  500    9583    562\n</code></pre>\n\n<p>In this example B2 is a duplicate of B1.  I need away to determine if the next row/observation is a dup (I'm only worried about 1 column).  The trouble is, it may be duplicated over multiple rows; it may not just be 2 rows of dups.  </p>\n\n<p>The goal would be to remove the dup when they exist.  The above \"should\" look like this:</p>\n\n<pre><code>1234  300    2001    389\n6546         2005    485\n8631  124    9583    562\n1234  500    2001    389\n6546         2005    485\n8631         9583    562\n</code></pre>\n\n<p>I can sort through the column to the end, but i'm not sure how to loop an check after i find a match</p>\n\n<pre><code>Sub Dups()\nDim LastRow As Long\nDim i As Long\nLastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\n    If Range(\"B\" &amp; i).Value = Range(\"B\" &amp; i + 1).Value Then\n       For ii = 1 To LastRow \n\n       //check next rows (same column until i dont have a dup.. then \n          remove \n        them\n\n       Next ii\n\n\n    End If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n\n<pre><code>   A          B       C          D               E\n11/5/2018   3944    -17.44    -17.44           2000\n11/5/2018   3945    0.00      -17.44           2000\n11/5/2018   3946    0.00      -25.00           2001\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/aWvx5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aWvx5.png\" alt=\"bszIZ.png\"></a></p>\n"}, {"tags": ["vba", "directory"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5226743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCrgx.jpg?s=128&g=1", "display_name": "JohnnyKunst", "link": "https://stackoverflow.com/users/5226743/johnnykunst"}, "edited": false, "score": 0, "creation_date": 1567026554, "post_id": 57699139, "comment_id": 101844088, "body": "I&#39;ve tried replacing wdApp.ActiveDocument.ActiveWindow.Application.Quit with wdApp.ActiveDocument.Close I see your point, however, it still remains that my code runs fine if I&#39;ve navigated away from the containing folder of the Word document."}, {"owner": {"reputation": 75, "user_id": 11837578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYOeu.png?s=128&g=1", "display_name": "wakgtech", "link": "https://stackoverflow.com/users/11837578/wakgtech"}, "reply_to_user": {"reputation": 1, "user_id": 5226743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCrgx.jpg?s=128&g=1", "display_name": "JohnnyKunst", "link": "https://stackoverflow.com/users/5226743/johnnykunst"}, "edited": false, "score": 0, "creation_date": 1567106842, "post_id": 57699139, "comment_id": 101875060, "body": "OK, It may be a focus thing. Try leaving the folder open but move the focus to something else, say another icon. Then run your code."}, {"owner": {"reputation": 75, "user_id": 11837578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYOeu.png?s=128&g=1", "display_name": "wakgtech", "link": "https://stackoverflow.com/users/11837578/wakgtech"}, "reply_to_user": {"reputation": 1, "user_id": 5226743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCrgx.jpg?s=128&g=1", "display_name": "JohnnyKunst", "link": "https://stackoverflow.com/users/5226743/johnnykunst"}, "edited": false, "score": 0, "creation_date": 1567520880, "post_id": 57699139, "comment_id": 101982626, "body": "Any success with this?"}], "tags": [], "owner": {"reputation": 75, "user_id": 11837578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYOeu.png?s=128&g=1", "display_name": "wakgtech", "link": "https://stackoverflow.com/users/11837578/wakgtech"}, "is_accepted": false, "score": 0, "last_activity_date": 1567021545, "creation_date": 1567021545, "answer_id": 57699139, "question_id": 57698736, "link": "https://stackoverflow.com/questions/57698736/using-vba-to-move-a-folder-already-open-in-windows-explorer-path-file-access-er/57699139#57699139", "title": "Using VBA to move a folder already open in Windows Explorer: Path/File Access Error", "body": "<p>This has nothing to do with folders. The problem is the open word doc. When you open a file that exists in a folder a connection is made between the open file and the folder that it was opened in. There are certain events (renaming said folder) that are locked down until that file is closed.\nFirst run your code to quit the word file and you should not have any issues.</p>\n"}], "owner": {"reputation": 1, "user_id": 5226743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCrgx.jpg?s=128&g=1", "display_name": "JohnnyKunst", "link": "https://stackoverflow.com/users/5226743/johnnykunst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567032578, "creation_date": 1567019479, "last_edit_date": 1567032578, "question_id": 57698736, "link": "https://stackoverflow.com/questions/57698736/using-vba-to-move-a-folder-already-open-in-windows-explorer-path-file-access-er", "title": "Using VBA to move a folder already open in Windows Explorer: Path/File Access Error", "body": "<p>I have written Excel VBA code to identify the containing folder of an open Word document, move the containing folder and its contents.\nIf I have the folder open in Windows Explorer, the code throws an error (Path/File access error)\nIf I have navigated out of the containing folder it works fine.\nI need for the code to run whether or not the containing folder is open in Windows Explorer</p>\n\n<pre><code>Sub Mover()\n\nDim OldFolder As String\nDim NewFolder As String\nDim wdApp As Object\n\nSet wdApp = GetObject(, \"Word.Application\")\n\nOldFolder = \"\\\\X-ns1\\Test\\Open\\\" &amp; Replace(wdApp.ActiveDocument.Name, \".docx\", \"\")\n\nNewFolder = \"\\\\X-ns1\\Test\\Closed and imported\\\" &amp; Replace(wdApp.ActiveDocument.Name, \".docx\", \"\")\n\nwdApp.ActiveDocument.ActiveWindow.Application.Quit\n\nName OldFolder As NewFolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1567019591, "post_id": 57698474, "comment_id": 101841423, "body": "Word&#39;s <code>find</code> doesn&#39;t work with <code>If</code> in this manner. I suggest you try in the Word UI (Ctrl+H) to find the highlight color and record a macro to get the basics. Also, you can <i>try</i> using <code>Replace</code> and replace with nothing (empty string - no entry in the Replace box). Not sure whether that will work with highlighting, though... If it doesn&#39;t work, get as far as you can based on the recorded macro, then update your post with that and describe how it&#39;s not doing the job."}], "answers": [{"tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1567030005, "creation_date": 1567030005, "answer_id": 57700607, "question_id": 57698474, "link": "https://stackoverflow.com/questions/57698474/delete-all-highlighted-text-in-word-document-via-excel-macro/57700607#57700607", "title": "Delete all highlighted text in Word document via Excel macro", "body": "<p>Try this one:</p>\n\n<pre><code>Dim wrdApp As Object\n\nSet wrdApp = CreateObject(\"Word.Application\")\nstrFilePath = ThisWorkbook.Path\nwrdApp.Visible = True\nwrdApp.Documents.Open (strFilePath &amp; \"\\test.docx\")\nwrdApp.Selection.Find.Highlight = True\nwrdApp.Selection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>With this code you will get all the highlighted text in your file. .Highlight is a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.find.highlight\" rel=\"nofollow noreferrer\">boolean value</a>, so it can not be wdYellow. If you need to check color, use <code>Range.HighlightColorIndex</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.range.highlightcolorindex\" rel=\"nofollow noreferrer\">property</a>.</p>\n\n<p>I can not make comments, sorry.</p>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1567078666, "creation_date": 1567078666, "answer_id": 57709355, "question_id": 57698474, "link": "https://stackoverflow.com/questions/57698474/delete-all-highlighted-text-in-word-document-via-excel-macro/57709355#57709355", "title": "Delete all highlighted text in Word document via Excel macro", "body": "<p>The macro recorder gives the following, which successfully replaces all text highlighted yellow. You can integrate it into your code framework.</p>\n\n<pre><code>Sub DeleteHighlightedText()\n'\n' DeleteHighlightedText Macro\n'\n'\n    ActiveDocument.content.HighlightColorIndex = wdYellow\n    With Selection.Find\n        .ClearFormatting\n        .Highlight = True\n        .Replacement.ClearFormatting\n        .Text = \"\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchByte = False\n        .CorrectHangulEndings = False\n        .HanjaPhoneticHangul = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1567078666, "creation_date": 1567018243, "last_edit_date": 1567018686, "question_id": 57698474, "link": "https://stackoverflow.com/questions/57698474/delete-all-highlighted-text-in-word-document-via-excel-macro", "title": "Delete all highlighted text in Word document via Excel macro", "body": "<p>I am trying to delete everything in a specific word document that is highlighted in a certain color, in this example; <code>wdYellow</code>. I have some code below that opens the Word document, tries to find where highlighting occurs and deletes it accordingly.</p>\n\n<pre><code>Set wrdApp = New Word.Application\nstrFilePath = ThisWorkbook.Path\nSet wrdDoc = wrdApp.Documents.Add(strFilePath &amp; \"\\test.docx\")\n\nWith wrdDoc.Content.Find\n    If .Highlight = wdYellow Then\n        .text = \"\"\n    End If\nEnd With\n\nwrdDoc.SaveAs (strFilePath &amp; \"\\test.docx\")\nwrdApp.Quit\n\nSet wrdDoc = Nothing\nSet wrdApp = Nothing\n</code></pre>\n\n<p>So this code works to an extent... <strong>It doesn't actually find any highlights with wdYellow, so it will never reach</strong> <code>.text = \"\"</code>. But other than that, it runs through it just fine. I believe the error to be with the <code>With wrdDoc.Content.Find</code> section. Can anyone help me out?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567051677, "post_id": 57698366, "comment_id": 101849012, "body": "Can you be more specific about the UI Automation framework you are using?"}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1567055274, "post_id": 57698366, "comment_id": 101849731, "body": "@DecimalTurn, thanks for your reply! Please see the edited post."}], "answers": [{"comments": [{"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1567097104, "post_id": 57709113, "comment_id": 101871145, "body": "thanks for your reply, I tried the second option you suggested, but unfortunately it seems to grey out the ribbon where he automation framework operates. I guess this function affects the UI tree and the automation framework cannot carry out its actions."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1567104116, "post_id": 57709113, "comment_id": 101873998, "body": "@ribarcheto94 I added a 3rd option that shouldn&#39;t affect the UI tree. Let me know if that works for you."}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1567107644, "post_id": 57709113, "comment_id": 101875352, "body": "thanks for taking the time to add this 3rd option. Unfortunately, this macro will be used in a productive application and it will look unprofessional to minimize the window for the user when they click a button. I guess there might be no good way do it but I will give you credit anyways because you have put in a lot of effort into this. Perhaps, someone else might find your suggestions useful."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1567108281, "post_id": 57709113, "comment_id": 101875554, "body": "@ribarcheto94 Thanks! And if you want to keep it professional, you could always display a VBA modeless userform that would remain visible to the user while the Excel window is minimized. You could even include a progress bar!"}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1567187725, "post_id": 57709113, "comment_id": 101902782, "body": "is it possible to display some sort of a filled rectangle over the ribbon while the macro is running? That way the UI tree will be available but the user will not see any of the actions."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1567188194, "post_id": 57709113, "comment_id": 101902928, "body": "@ribarcheto94 That&#39;s something a modeless useform could do, but this would be a different question. If you want, you can create a new question and I can provide a potential answer."}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 1, "creation_date": 1567233875, "post_id": 57709113, "comment_id": 101910842, "body": "thank you. Here&#39;s the new question: <a href=\"https://stackoverflow.com/questions/57735800/excel-2016-use-a-control-form-to-cover-up-the-excel-ribbon-while-a-macro-is-run\" title=\"excel 2016 use a control form to cover up the excel ribbon while a macro is run\">stackoverflow.com/questions/57735800/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1567103965, "last_edit_date": 1567103965, "creation_date": 1567077863, "answer_id": 57709113, "question_id": 57698366, "link": "https://stackoverflow.com/questions/57698366/vba-application-screenupdating-equivalent-for-actions-on-the-excel-ribbon/57709113#57709113", "title": "VBA: Application.ScreenUpdating equivalent for actions on the Excel ribbon", "body": "<h3>Summary</h3>\n\n<ol>\n<li>LockWindowUpdate: An Unreliable Solution</li>\n<li>WM_SETREDRAW: A (too?) Powerful Solution</li>\n<li>SW_SHOWMINIMIZED: A Subtle Solution </li>\n</ol>\n\n<h1>1) LockWindowUpdate: An Unreliable Solution</h1>\n\n<p>It seems like there is a Windows API function that some people suggest: <code>LockWindowUpdate</code>. The main problem is that it seems unreliable based on the tests that I've done and the 2 posts that I've found:</p>\n\n<ul>\n<li><a href=\"https://answers.microsoft.com/en-us/office/forum/office_365hp-customize/windows-api-sendmessage-to-freeze-screen-in-excel/4441814a-f8c6-47ab-ba44-5e9fd373217c\" rel=\"nofollow noreferrer\">Windows API SendMessage to freeze screen in Excel VBA</a> (Doesn't work on all machines)</li>\n<li><a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/507ed95b-b702-47f0-8f8d-88a7ddfe884d/api-lockwindowupdate-dont-work-as-expected?forum=windowsgeneraldevelopmentissues\" rel=\"nofollow noreferrer\">API LockWindowUpdate don't work as expected</a> - You can read in that second post the following:\n\n<blockquote>\n  <p>LockWindowUpdate is not intended for general-purpose suppression of window redraw. The purpose of the LockWindowUpdate function is to permit drag/drop feedback to be drawn over a window without interference from the window itself. The intent is that the window is locked when feedback is drawn and unlocked when feedback is complete.</p>\n</blockquote></li>\n</ul>\n\n<p>But if you want to test it for yourself, it can be declared at the top of your module with the following <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ptrsafe-keyword\" rel=\"nofollow noreferrer\">backward compatible declaration construct</a>:</p>\n\n<pre><code>'LockWindowUpdate declaration\n#If VBA7 Then\n    Private Declare PtrSafe Function LockWindowUpdate Lib \"user32\" (ByVal hWndLock As LongPtr) As Long\n#Else\n    Private Declare Function LockWindowUpdate Lib \"user32\" (ByVal hWndLock As Long) As Long\n#End If\n</code></pre>\n\n<p>So, by supplying the window handle of the workbook you are interacting with (must be the top window), you may be able to temporarily freeze that Window. For example you could add:</p>\n\n<pre><code>'WindowHandle declaration\n#If VBA7 Then\n    Private WindowHandle As LongPtr\n#Else\n    Private WindowHandle As Long\n#End If\n\n'GetForegroundWindow declaration\n#If VBA7 Then\n    Private Declare PtrSafe Function GetForegroundWindow Lib \"USER32\" () As LongPtr\n#Else\n    Private Declare Function GetForegroundWindow Lib \"user32\" () As Long\n#End If\n\nSub LockWindow()\n    On Error GoTo ErrHandler\n    WindowHandle = GetForegroundWindow\n    LockWindowUpdate WindowHandle\n\n    'Your code here\n\nErrHandler:\n    LockWindowUpdate WindowHandle\n\nEnd Sub\n</code></pre>\n\n<h1>2) WM_SETREDRAW: A Powerful Solution </h1>\n\n<p>There is also a message that you can send via the SendMessage Window API function that is exaclty made for preventing a window to be redrawn or refreshed.</p>\n\n<p>To implement this for an Excel workbook, you could use the following declaration of the <code>SendMessage</code> function, the <code>GetForegroundWindow</code> (see code from above) and the appropriate constant:</p>\n\n<pre><code>'SendMessage declaration\n#If VBA7 Then\n    Declare PtrSafe Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n#Else\n    Private Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Long) As Long\n#End If\n\n'SendMessage Message(s)\nPrivate Const WM_SETREDRAW = &amp;HB\n</code></pre>\n\n<p>You would then surround your code like in the following example:</p>\n\n<pre><code>Sub FreezeWorkbook()\n\n    On Error GoTo ErrHandler\n    WindowHandle = GetForegroundWindow\n    Call SendMessage(WindowHandle, WM_SETREDRAW, False, 0&amp;)\n\n    'Your code here\n\nErrHandler:\n    Call SendMessage(WindowHandle, WM_SETREDRAW, True, 0&amp;)\n\nEnd Sub\n</code></pre>\n\n<p>I haven't been able to test it with UI Automation commands, but it seems like it should work. </p>\n\n<h2> A more drastic alternative </h2>\n\n<p>If that doesn't work, you might want to consider doing it for the screen as a whole. For that you'll need a special function that returns the handle for the desktop:</p>\n\n<pre><code>'GetDesktopWindow declaration\n#If VBA7 Then\n    Private Declare PtrSafe Function GetDesktopWindow Lib \"user32\" () As LongPtr\n#Else\n    Private Declare Function GetDesktopWindow Lib \"user32\" () As Long\n#End If\n</code></pre>\n\n<p>And the rest is basically the same:</p>\n\n<pre><code>Sub FreezeDesktop()\n\n    On Error GoTo ErrHandler\n    Call SendMessage(GetDesktopWindow, WM_SETREDRAW, False, 0&amp;)\n\n    'Your code here\n\nErrHandler:\n    Call SendMessage(GetDesktopWindow, WM_SETREDRAW, True, 0&amp;)\n\nEnd Sub\n</code></pre>\n\n<p>Note that the use of error handling is even more crucial here because you don't want your whole screen to remain frozen in case of an unhandled error. </p>\n\n<blockquote>\n  <p>[However, if it were to happen, you could still] press the keyboard sleep key and then after entering the sleep state,\n  press the WakeUp key .. that shoud unfreeze the computer and avoid any\n  accidental loss of data. (<a href=\"https://www.mrexcel.com/forum/excel-questions/831844-lockwindowupdate-not-working-prevent-vbe-flicker-when-code-writing-code.html\" rel=\"nofollow noreferrer\">source</a>)</p>\n</blockquote>\n\n<h1>3) SW_SHOWMINIMIZED: A Subtle Solution </h1>\n\n<p>If the previous solution is interfering with your UI Automation process, you might want to consider a more subtle solution that solves your problem indirectly. I'm talking about minimizing the window at the beginning of your code and maximizing it at the end. </p>\n\n<p>This is not exactly what you wanted, but at least the user won't see the window while the interaction occurs. Based on the tests that I've done, the fact that a window is minimized shouldn't affect UI Automation commands.</p>\n\n<pre><code>'WindowHandle declaration\n#If VBA7 Then\n    Private WindowHandle As LongPtr\n#Else\n    Private WindowHandle As Long\n#End If\n\n'GetForegroundWindow declaration\n#If VBA7 Then\n    Private Declare PtrSafe Function GetForegroundWindow Lib \"user32\" () As LongPtr\n#Else\n    Private Declare Function GetForegroundWindow Lib \"user32\" () As Long\n#End If\n\n'ShowWindow declaration\n#If VBA7 Then\n    Private Declare PtrSafe Function ShowWindow Lib \"user32\" (ByVal hwnd As LongPtr, ByVal nCmdShow As Long) As Long\n#Else\n    Private Declare Function ShowWindow Lib \"user32\" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long\n#End If\n\n'ShowWindow Commands\nPublic Const SW_HIDE = 0\nPublic Const SW_SHOWNORMAL = 1\nPublic Const SW_NORMAL = 1\nPublic Const SW_SHOWMINIMIZED = 2\nPublic Const SW_SHOWMAXIMIZED = 3\nPublic Const SW_MAXIMIZE = 3\nPublic Const SW_SHOWNOACTIVATE = 4\nPublic Const SW_SHOW = 5\nPublic Const SW_MINIMIZE = 6\nPublic Const SW_SHOWMINNOACTIVE = 7\nPublic Const SW_SHOWNA = 8\nPublic Const SW_RESTORE = 9\nPublic Const SW_SHOWDEFAULT = 10\nPublic Const SW_MAX = 10\n\nSub MinimizeAndMaximize()\n    On Error GoTo ErrHandler\n    WindowHandle = GetForegroundWindow\n    ShowWindow WindowHandle, SW_SHOWMINIMIZED\n\n    'Your code here\n\nErrHandler:\n    ShowWindow WindowHandle, SW_MAXIMIZE\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 57709113, "answer_count": 1, "score": 1, "last_activity_date": 1567103965, "creation_date": 1567017711, "last_edit_date": 1567055241, "question_id": 57698366, "link": "https://stackoverflow.com/questions/57698366/vba-application-screenupdating-equivalent-for-actions-on-the-excel-ribbon", "title": "VBA: Application.ScreenUpdating equivalent for actions on the Excel ribbon", "body": "<p>I have a macro that does some actions using the <code>UI Automation</code> framework. I would like to suppress the rapid movements on the ribbon during the macro execution and would like to simply show the outcome at end. I tried using <code>Application.ScreenUpdating</code>, but it looks like it is a setting that does not apply to the ribbon. \nIs there any setting out there that can be used to manipulate the screen updates for the Excel ribbon?</p>\n\n<p>EDIT: the Automation framework can be referenced as <code>UIAutomationClient</code> in the VBA project. The dll file is <code>UIAutomationCore.dll</code></p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1567029594, "post_id": 57698188, "comment_id": 101845044, "body": "AFAIK Excel will only update workbooks that are open, unless you treat those workbooks as a Database.  You would need to have the code open each workbook individually, update the Workbook, then close/save that workbook."}, {"owner": {"reputation": 1, "user_id": 11990788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c5ebbacb97023900e26576a9536076?s=128&d=identicon&r=PG&f=1", "display_name": "CKD", "link": "https://stackoverflow.com/users/11990788/ckd"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1567095394, "post_id": 57698188, "comment_id": 101870390, "body": "Thanks for your swift reply - any chance you could elaborate on the &quot;Database&quot; explanation! Thank you!"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1567096047, "post_id": 57698188, "comment_id": 101870689, "body": "From the Data Tab in Excel you can choose &quot;From Other Sources&quot; and then choose Excel.  If there is a table in the workbook you want data to update/push to other workbooks then from the workbook you want the data to update to you connect directly to the workbook and table or named range that has updated data.  You can then set the refresh to update automatically when the workbook receiving the data is open.  It sounds complicated but it really isnt."}], "owner": {"reputation": 1, "user_id": 11990788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c5ebbacb97023900e26576a9536076?s=128&d=identicon&r=PG&f=1", "display_name": "CKD", "link": "https://stackoverflow.com/users/11990788/ckd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567023399, "creation_date": 1567016835, "last_edit_date": 1567023399, "question_id": 57698188, "link": "https://stackoverflow.com/questions/57698188/how-to-use-vba-code-for-refreshing-data-in-an-external-workbook", "title": "How to use vba code for refreshing data in an external workbook?", "body": "<p>I want to create a macro in my 'main' workbook to refresh the pivot table data in external workbooks (country A workbook, Country B, Country C etc.)</p>\n\n<p>I used this simple code:</p>\n\n<p><code>Workbooks.Refresh \"LOCATION of file\"</code> however the method refresh is not recognized.</p>\n\n<p>ex: <code>Workbooks.Open \"LOCATION of file\"</code> <code>-&gt;</code> opens the file...</p>\n\n<p>Is there a simple VBA Code (1 line) to update external workbooks with file path location?</p>\n"}, {"tags": ["html", "excel", "vba", "superscript", "italic"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567015958, "post_id": 57697430, "comment_id": 101839998, "body": "The <code>For n = 1 To Len(rngCell.Value) + 1</code> loop expression is also invalid after the first insert: <code>Len(rngCell.Value)</code> can change at every iteration - you need something other than a <code>For</code> loop here, since you <i>don&#39;t</i> know how many iterations you&#39;ll need to complete the logic."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567016073, "post_id": 57697430, "comment_id": 101840042, "body": "<code>Do While n &lt;= Len(rngCell.Value) ... Loop</code> should re-evaluate the exit condition at each iteration; the upper bound of a <code>For</code> loop is only evaluated once."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567018290, "post_id": 57698454, "comment_id": 101840883, "body": "Nice, much better idea than trying to fix the loop condition :)"}, {"owner": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "edited": false, "score": 0, "creation_date": 1567018509, "post_id": 57698454, "comment_id": 101840964, "body": "Dude... I can&#39;t thank you enough!! It worked perfectly. I just need to place the output in the same cell as before now and it was done."}, {"owner": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "edited": false, "score": 0, "creation_date": 1567018616, "post_id": 57698454, "comment_id": 101841003, "body": "I accomplished that by setting the rng.Offset(, 1).Value to rng.Offset(, 0).Value"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "edited": false, "score": 1, "creation_date": 1567019845, "post_id": 57698454, "comment_id": 101841510, "body": "@MatheusSant&#39;ana you could just say <code>rng.value = z</code> and that is fine, since there isn&#39;t an offset"}, {"owner": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "edited": false, "score": 0, "creation_date": 1567020403, "post_id": 57698454, "comment_id": 101841715, "body": "Even better! Thank you again."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 3, "last_activity_date": 1567018163, "creation_date": 1567018163, "answer_id": 57698454, "question_id": 57697430, "link": "https://stackoverflow.com/questions/57697430/replace-superscript-and-italic-with-html-tags-in-excel-sheet/57698454#57698454", "title": "Replace superscript and italic with HTML tags in Excel sheet", "body": "<p>Rather than inserting into your string, you should start building an appropriate string (<code>z</code>), similar to: </p>\n\n<pre><code>Option Explicit\n\nSub remove_italics_and_superscripts()\n    Dim i As Long, j As Long, rng As Range, z As String\n    For Each rng In ActiveSheet.UsedRange\n        For i = 1 To Len(rng)\n            If rng.Characters(i, 1).Font.Superscript = True Then\n                For j = 0 To Len(rng) - i\n                    If rng.Characters(j + i, 1).Font.Superscript = False Then Exit For\n                Next j\n                z = z &amp; \"&lt;sup&gt;\" &amp; Mid(rng.Value, i, j) &amp; \"&lt;/sup&gt;\"\n            ElseIf rng.Characters(i, 1).Font.Italic = True Then\n                For j = 0 To Len(rng) - i\n                    If rng.Characters(j + i, 1).Font.Italic = False Then Exit For\n                Next j\n                z = z &amp; \"&lt;i&gt;\" &amp; Mid(rng.Value, i, j) &amp; \"&lt;/i&gt;\"\n            Else\n                z = z &amp; Mid(rng.Value, i, 1)\n                j = 1\n            End If\n            i = i + j - 1\n        Next i\n        rng.Offset(, 1).Value = z 'didn't immediately see where you output, so just out to the next column to the right\n        z = \"\"\n    Next rng\nEnd Sub\n</code></pre>\n\n<p>I cleaned up a little of the looping/conditions that you were using.  Additionally, this removes the need for an array (note your <code>redim preserve</code>).</p>\n"}], "owner": {"reputation": 443, "user_id": 8837616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690d94f0c162dcda1b2eceae25eb8158?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Sant&#39;ana", "link": "https://stackoverflow.com/users/8837616/matheus-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 57698454, "answer_count": 1, "score": 2, "last_activity_date": 1567018163, "creation_date": 1567013466, "last_edit_date": 1567014938, "question_id": 57697430, "link": "https://stackoverflow.com/questions/57697430/replace-superscript-and-italic-with-html-tags-in-excel-sheet", "title": "Replace superscript and italic with HTML tags in Excel sheet", "body": "<p>I need to get rid of the superscript and the italic, adding an HTML tag to surround the word/letter.</p>\n\n<p>For example:</p>\n\n<p>My phrase has a superscript<sup>1</sup> and also has an <i>italic</i> word.</p>\n\n<p>Should be converted to:</p>\n\n<pre><code>My phrase has a superscript&lt;sup&gt;1&lt;/sup&gt; and also has an &lt;i&gt;italic&lt;/i&gt; word.\n</code></pre>\n\n<p>I have found a \"solution\" for that (it locates where the superscript and italic are and store its position), but it had lots of problems. I got to make that work for a while:</p>\n\n<pre><code>Sub TagSubstitution()\n    Dim lngStart_i As Long\n    Dim lngFinish_i As Long\n    Dim lngStart_sup As Long\n    Dim lngFinish_sup As Long\n    Dim n As Long\n    Dim k_i As Long\n    Dim k_sup As Long\n    Dim rngCell As Range\n    Dim rngConstants As Range\n    Dim cellAddress As String\n\n    On Error Resume Next\n    Set rngConstants = ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants)\n    On Error GoTo 0\n\n    If Not rngConstants Is Nothing Then\n        Application.ScreenUpdating = False\n        For Each rngCell In rngConstants.Cells\n            Dim listStart_i() As Long, X_i As Long\n            Dim listFinish_i() As Long, Y_i As Long\n            Dim listStart_sup() As Long, X_sup As Long\n            Dim listFinish_sup() As Long, Y_sup As Long\n            X_i = 0\n            Y_i = 0\n            X_sup = 0\n            Y_sup = 0\n            ReDim Preserve listStart_i(X)\n            ReDim Preserve listFinish_i(Y)\n            ReDim Preserve listStart_sup(X)\n            ReDim Preserve listFinish_sup(Y)\n            lngStart_i = 0\n            lngStart_sup = 0\n            For n = 1 To Len(rngCell.Value) + 1\n                If rngCell.Characters(n, 1).Font.Italic Then\n                    If lngStart_i = 0 Then\n                        lngStart_i = n\n                        ReDim Preserve listStart_i(0 To X_i)\n                        listStart_i(X_i) = lngStart_i\n                        X_i = X_i + 1\n                    End If\n                ElseIf lngStart_i &lt;&gt; 0 Then\n                    If Not rngCell.Characters(n, 1).Font.Italic Then\n                        lngFinish_i = n\n                        ReDim Preserve listFinish_i(0 To Y_i)\n                        listFinish_i(Y_i) = lngFinish_i\n                        Y_i = Y_i + 1\n                        lngStart_i = 0\n                    End If\n                End If\n                If rngCell.Characters(n, 1).Font.Superscript Then\n                    If lngStart_sup = 0 Then\n                        lngStart_sup = n\n                        ReDim Preserve listStart_sup(0 To X_sup)\n                        listStart_sup(X_sup) = lngStart_sup\n                        X_sup = X_sup + 1\n                    End If\n                ElseIf lngStart_sup &lt;&gt; 0 Then\n                    If Not rngCell.Characters(n, 1).Font.Superscript Then\n                        lngFinish_sup = n\n                        ReDim Preserve listFinish_sup(0 To Y_sup)\n                        listFinish_sup(Y_sup) = lngFinish_sup\n                        Y_sup = Y_sup + 1\n                        lngStart_sup = 0\n                    End If\n                End If\n            Next n\n            If listStart_i(0) &lt;&gt; 0 Then\n                Dim sup_addition_i As Integer\n                sup_addition_i = 0\n                For k_i = LBound(listStart_i) To UBound(listStart_i)\n                    start_value = listStart_i(k_i) + sup_addition_i\n                    finish_value = listFinish_i(k_i) + sup_addition_i\n                    If Len(rngCell.Value) &gt; 255 Then\n                        content_len = finish_value + 1 - start_value\n                        before_content = Left(rngCell, start_value - 1)\n                        after_content = Right(rngCell, Len(rngCell.Value) + content_len - finish_value)\n                        after_content = Left(after_content, content_len - 1)\n                        end_content = Right(rngCell, Len(rngCell.Value) + 1 - finish_value)\n                        rngCell = before_content &amp; \"&lt;i&gt;\" &amp; after_content &amp; \"&lt;/i&gt;\" &amp; end_content\n                    Else\n                        rngCell.Characters(start_value, 0).Insert \"&lt;i&gt;\"\n                        rngCell.Characters(finish_value + 3, 0).Insert \"&lt;/i&gt;\"\n                    End If\n                    sup_addition_i = 7 * (k_i + 1)\n                Next k_i\n                rngCell.Font.Italic = False\n            If listStart_sup(0) &lt;&gt; 0 Then\n                Dim sup_addition_sup As Integer\n                sup_addition_p = 0 - sup_addition_i\n                For k_sup = LBound(listStart_sup) To UBound(listStart_sup)\n                    start_value = listStart_sup(k_sup) + sup_addition_sup\n                    finish_value = listFinish_sup(k_sup) + sup_addition_sup\n                    If Len(rngCell.Value) &gt; 255 Then\n                        content_len = finish_value + 1 - start_value\n                        before_content = Left(rngCell, start_value - 1)\n                        after_content = Right(rngCell, Len(rngCell.Value) + content_len - finish_value)\n                        after_content = Left(after_content, content_len - 1)\n                        end_content = Right(rngCell, Len(rngCell.Value) + 1 - finish_value)\n                        rngCell = before_content &amp; \"&lt;sup&gt;\" &amp; after_content &amp; \"&lt;/sup&gt;\" &amp; end_content\n                    Else\n                        rngCell.Characters(start_value, 0).Insert \"&lt;sup&gt;\"\n                        rngCell.Characters(finish_value + 5, 0).Insert \"&lt;/sup&gt;\"\n                    End If\n                    sup_addition_sup = 11 * (k_sup + 1) - sup_addition_i\n                Next k_sup\n                rngCell.Font.Superscript = False\n            End If\n            End If\n        Next rngCell\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>The problem with this code is that when I have both superscript and italic on the same cell I get the problem that, after inserting italic, the position of the superscript is not the same as before. So I misplace every <code>&lt;sup&gt;</code> tag after that...</p>\n\n<p>I am a newbie in VBA and I don't know the proper way that I could accomplish this solution.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Another approach that I've tried:</p>\n\n<pre><code>Sub AdicionarTags()\n    Dim xSh As Worksheet\n    Application.ScreenUpdating = False\n    For Each xSh In Worksheets\n        xSh.Select\n        Call TagItalic\n        Call TagSuperscript\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\nSub TagItalic()\n    Dim lngStart As Long\n    Dim lngFinish As Long\n    Dim n As Long\n    Dim k As Long\n    Dim rngCell As Range\n    Dim rngConstants As Range\n    Dim cellAddress As String\n\n    On Error Resume Next\n    Set rngConstants = ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants)\n    On Error GoTo 0\n\n    If Not rngConstants Is Nothing Then\n        Application.ScreenUpdating = False\n        For Each rngCell In rngConstants.Cells\n            Dim listStart() As Long, X As Long\n            Dim listFinish() As Long, Y As Long\n            X = 0\n            Y = 0\n            ReDim Preserve listStart(X)\n            ReDim Preserve listFinish(Y)\n            lngStart = 0\n            For n = 1 To Len(rngCell.Value) + 1\n                If rngCell.Characters(n, 1).Font.Italic Then\n                    If lngStart = 0 Then\n                        lngStart = n\n                        ReDim Preserve listStart(0 To X)\n                        listStart(X) = lngStart\n                        X = X + 1\n                    End If\n                ElseIf lngStart &lt;&gt; 0 Then\n                    If Not rngCell.Characters(n, 1).Font.Italic Then\n                        lngFinish = n\n                        ReDim Preserve listFinish(0 To Y)\n                        listFinish(Y) = lngFinish\n                        Y = Y + 1\n                        lngStart = 0\n                    End If\n                End If\n            Next n\n            If listStart(0) &lt;&gt; 0 Then\n                Dim sup_addition As Integer\n                sup_addition = 0\n                For k = LBound(listStart) To UBound(listStart)\n                    start_value = listStart(k) + sup_addition\n                    finish_value = listFinish(k) + sup_addition\n                    content_len = finish_value + 1 - start_value\n                    before_content = Left(rngCell, start_value - 1)\n                    after_content = Right(rngCell, Len(rngCell.Value) + content_len - finish_value)\n                    after_content = Left(after_content, content_len - 1)\n                    end_content = Right(rngCell, Len(rngCell.Value) + 1 - finish_value)\n                    rngCell = before_content &amp; \"&lt;i&gt;\" &amp; after_content &amp; \"&lt;/i&gt;\" &amp; end_content\n                    sup_addition = 7 * (k + 1)\n                Next k\n                rngCell.Font.Italic = False\n            End If\n        Next rngCell\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\nSub TagSuperscript()\n    Dim lngStart As Long\n    Dim lngFinish As Long\n    Dim n As Long\n    Dim k As Long\n    Dim rngCell As Range\n    Dim rngConstants As Range\n    Dim cellAddress As String\n\n    On Error Resume Next\n    Set rngConstants = ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants)\n    On Error GoTo 0\n\n    If Not rngConstants Is Nothing Then\n        Application.ScreenUpdating = False\n        For Each rngCell In rngConstants.Cells\n            Dim listStart() As Long, X As Long\n            Dim listFinish() As Long, Y As Long\n            X = 0\n            Y = 0\n            ReDim Preserve listStart(X)\n            ReDim Preserve listFinish(Y)\n            lngStart = 0\n            For n = 1 To Len(rngCell.Value) + 1\n                If rngCell.Characters(n, 1).Font.Superscript Then\n                    If lngStart = 0 Then\n                        lngStart = n\n                        ReDim Preserve listStart(0 To X)\n                        listStart(X) = lngStart\n                        X = X + 1\n                    End If\n                ElseIf lngStart &lt;&gt; 0 Then\n                    If Not rngCell.Characters(n, 1).Font.Superscript Then\n                        lngFinish = n\n                        ReDim Preserve listFinish(0 To Y)\n                        listFinish(Y) = lngFinish\n                        Y = Y + 1\n                        lngStart = 0\n                    End If\n                End If\n            Next n\n            If listStart(0) &lt;&gt; 0 Then\n                Dim sup_addition As Integer\n                sup_addition = 0\n                For k = LBound(listStart) To UBound(listStart)\n                    start_value = listStart(k) + sup_addition\n                    finish_value = listFinish(k) + sup_addition\n                    content_len = finish_value + 1 - start_value\n                    before_content = Left(rngCell, start_value - 1)\n                    after_content = Right(rngCell, Len(rngCell.Value) + content_len - finish_value)\n                    after_content = Left(after_content, content_len - 1)\n                    end_content = Right(rngCell, Len(rngCell.Value) + 1 - finish_value)\n                    rngCell = before_content &amp; \"&lt;sup&gt;\" &amp; after_content &amp; \"&lt;/sup&gt;\" &amp; end_content\n                    sup_addition = 11 * (k + 1)\n                Next k\n                rngCell.Font.Superscript = False\n            End If\n        Next rngCell\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>But this time the problem is that after running the first <code>Sub</code>, when I replace the cell, the style is lost and when the second function runs it has none of the previous formatting.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11852726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HczHR2e-bGs/AAAAAAAAAAI/AAAAAAAADNw/agSKTqlLgoI/photo.jpg?sz=128", "display_name": "Mohammad Anas", "link": "https://stackoverflow.com/users/11852726/mohammad-anas"}, "edited": false, "score": 0, "creation_date": 1567013148, "post_id": 57697237, "comment_id": 101838921, "body": "Yes!!! This works. But I just realized that some names might have 3 initials. The first 2 letters will always be location but any letters after that will be initials and numbers after that for employee number."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 11852726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HczHR2e-bGs/AAAAAAAAAAI/AAAAAAAADNw/agSKTqlLgoI/photo.jpg?sz=128", "display_name": "Mohammad Anas", "link": "https://stackoverflow.com/users/11852726/mohammad-anas"}, "edited": false, "score": 0, "creation_date": 1567013983, "post_id": 57697237, "comment_id": 101839249, "body": "Is it only ever 2 or 3 initials?"}, {"owner": {"reputation": 1, "user_id": 11852726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HczHR2e-bGs/AAAAAAAAAAI/AAAAAAAADNw/agSKTqlLgoI/photo.jpg?sz=128", "display_name": "Mohammad Anas", "link": "https://stackoverflow.com/users/11852726/mohammad-anas"}, "edited": false, "score": 0, "creation_date": 1567018541, "post_id": 57697237, "comment_id": 101840977, "body": "Yes, only 2 or 3"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1567020578, "last_edit_date": 1567020578, "creation_date": 1567012559, "answer_id": 57697237, "question_id": 57697176, "link": "https://stackoverflow.com/questions/57697176/how-to-have-a-cell-auto-update-with-name-initials-with-any-change-in-row/57697237#57697237", "title": "How to have a cell auto-update with name initials with any change in row", "body": "<p>This?</p>\n\n<p><code>Cells(Target.Row, \"AF\").Value = mid(Environ(\"UserName\"),3,2)</code></p>\n\n<p>If there are only ever 2 or 3 initials followed by numbers, try this:</p>\n\n<pre><code>If Environ(\"UserName\") Like \"[A-Z][A-Z][A-Z][A-Z]#*\" Then\n    Cells(Target.Row, \"AF\").Value = Mid(Environ(\"UserName\"), 3, 2)\nElse\n    Cells(Target.Row, \"AF\").Value = Mid(Environ(\"UserName\"), 3, 3)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11852726, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HczHR2e-bGs/AAAAAAAAAAI/AAAAAAAADNw/agSKTqlLgoI/photo.jpg?sz=128", "display_name": "Mohammad Anas", "link": "https://stackoverflow.com/users/11852726/mohammad-anas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567020578, "creation_date": 1567012334, "question_id": 57697176, "link": "https://stackoverflow.com/questions/57697176/how-to-have-a-cell-auto-update-with-name-initials-with-any-change-in-row", "title": "How to have a cell auto-update with name initials with any change in row", "body": "<p>I have an excel sheet with Companies in a list and the cities they operate in. The excel file will be used bu multiple people to add and update with time. I would like to have a column in the sheet where cells update with the initials of the user updating the respective row.</p>\n\n<p>I have a code which pulls the windows username and inserts it into the cell if cell in that row is changed. The issue is that usernames are not names but a combination of the location of the office, initials and employee number.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Row &lt; 5 Then Exit Sub\nApplication.EnableEvents = False\n    Cells(Target.Row, \"AE\").Value = Date\n    Cells(Target.Row, \"AF\").Value = Environ(\"UserName\")\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>The employee number looks something like: \"CAMA000000\" where CA is the location, MA is the initials and the last 6 digits are the employee number. I just need the initials.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1567012266, "post_id": 57696958, "comment_id": 101838520, "body": "Show us how your data is arranged. If its confidential, post a sample."}, {"owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1567019028, "post_id": 57696958, "comment_id": 101841175, "body": "@RicardoDiaz I included a sample of how my Data is arranged. Should be easier to examine now."}], "answers": [{"tags": [], "owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "is_accepted": true, "score": 0, "last_activity_date": 1567099319, "creation_date": 1567099319, "answer_id": 57715138, "question_id": 57696958, "link": "https://stackoverflow.com/questions/57696958/vlookup-to-replace-table-content-from-data-source/57715138#57715138", "title": "VLookup to Replace Table Content from Data Source", "body": "<p>So, My Issue seems to have been caused by my Misunderstanding of the VLOOKUP function. I had the Unique IDs in the Raw Data sheet in the Last Column. This meant that the VLOOKUP could not find the ID properly. Upon switching it to the First Column the VLOOKUP returned the correct data in the Comment Column of my Table.</p>\n\n<p>As Shown Below:\n<a href=\"https://i.stack.imgur.com/TxBpC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TxBpC.png\" alt=\"New Layout\"></a>\nWhen I did this the VLOOKUP performed as expected.\nThis is the only part of the Macro I changed. </p>\n\n<pre><code>    'This Block Copies and Pastes A:F Data to RawData\n    Dim AF As Range\n    Set AF = ReadyB.Columns(\"M\")\n    Application.CutCopyMode = False\n    AF.Copy\n    RawD.Paste\n    Set AF = ReadyB.Columns(\"A:F\")\n    AF.Copy\n    RawD.Paste Destination:=RawD.Range(\"B1\")\n    RawD.Cells.NumberFormat = \"General\"\n</code></pre>\n"}], "owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 57715138, "answer_count": 1, "score": 0, "last_activity_date": 1567099319, "creation_date": 1567011218, "last_edit_date": 1567019096, "question_id": 57696958, "link": "https://stackoverflow.com/questions/57696958/vlookup-to-replace-table-content-from-data-source", "title": "VLookup to Replace Table Content from Data Source", "body": "<p>I'm programming a Macro to Refresh Data from a DataSource and the copy a copy of the comments added to the file into the table the Data is located in.</p>\n\n<p>I've tried changing the columns I'm copying from and replicating this without disabling background refresh( w/o Refresh this worked but the Refresh will finish after the Macro Complete wiping my Vlookup)</p>\n\n<pre><code>\nSub RefreshAndDelete3()\n' This Macro Will Copy over the First Five Columns\n' Then Delete the Original Data\n' Refresh the Data &amp; Vlookup the Comments back\n'\n\n    'This Block Sets Variables for Sheets and Makes RawData Sheet\n    Application.ScreenUpdating = False\n\n    Dim wb As Workbook: Set wb = ThisWorkbook\n    Dim ReadyB As Worksheet: Set ReadyB = wb.Sheets(\"Ready Board\")\n    ReadyB.Visible = True\n    Dim RawD As Worksheet\n    Sheets.Add , Worksheets(Worksheets.Count)\n    ActiveSheet.Name = \"Raw Data\"\n    Set RawD = wb.Sheets(\"Raw Data\")\n\n    'This Block Copies and Pastes A:F Data to RawData\n    Dim AF As Range\n    Set AF = ReadyB.Columns(\"A:F\")\n    Application.CutCopyMode = False\n    AF.Copy\n    RawD.Paste\n    Set AF = ReadyB.Columns(\"M\")\n    AF.Copy\n    RawD.Paste Destination:=RawD.Range(\"G1\")\n    RawD.Cells.NumberFormat = \"General\"\n\n    'This Refreshes the Data\n    Dim Connection As Variant\n    For Each Connection In ActiveWorkbook.Connections\n        Connection.OLEDBConnection.BackgroundQuery = False\n    Next Connection\n    wb.RefreshAll\n\n    'ThisExecutes a VLookup\n    Dim ReadyLastRow As Long, DataLastRow As Long, x As Long\n    Dim DataRange As Range\n    DataLastRow = RawD.Range(\"A\" &amp; rows.Count).End(xlUp).Row\n    ReadyLastRow = ReadyB.Range(\"A\" &amp; rows.Count).End(xlUp).Row\n    Set DataRange = RawD.Range(\"A2:G\" &amp; DataLastRow)\n    For x = 2 To ReadyLastRow\n        On Error Resume Next\n        ReadyB.Range(\"F\" &amp; x).Value = Application.WorksheetFunction.VLookup( _\n            ReadyB.Range(\"M\" &amp; x).Value, DataRange, 6, False)\n    Next x\n\n    'This Deletes the Raw Data Sheet &amp; Hides the Board Then Sets Home\n    ReadyB.Visible = False\n    Application.DisplayAlerts = False\n    RawD.Delete\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n    Sheets(\"Home\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I expect that as soon as the Connection is Refreshed the VLookUp will copy the Comment Column in the \"Raw Data\" sheet(Column F on both Sheets) back into the comment Column in the \"Ready board\" Sheet and then delete the Raw Data sheet.</p>\n\n<p>The VLookUp should be comparing the Unique IDs that get copied over from the \nReady Board and then adding the Comments (if any) back into the Ready Board Table AFTER the Data Connection is Refreshed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fm36p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fm36p.png\" alt=\"SampleData\"></a>\nRaw Data\n<a href=\"https://i.stack.imgur.com/DDihR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DDihR.png\" alt=\"RawData\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1567012912, "post_id": 57696939, "comment_id": 101838821, "body": "what have you tried so far?"}, {"owner": {"reputation": 1, "user_id": 11904164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/548865c47bb060f5dccee649ecbf7187?s=128&d=identicon&r=PG&f=1", "display_name": "nisshaheen", "link": "https://stackoverflow.com/users/11904164/nisshaheen"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1567014027, "post_id": 57696939, "comment_id": 101839267, "body": "Miles Fett, thanks For your reply try with different code not work with i want, now i try with this function but failure try (Function MyCOUNTIF(ByVal userRange As Variant, ByVal userCriteria As Variant)     MyCOUNTIF = Application.WorksheetFunction.CountIf(ws.range (&quot;X4:X16&quot;, Sheets(&quot;Main of Month&quot;.range(&quot;AB3:AB&quot;))) End Function )"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1567110182, "post_id": 57696939, "comment_id": 101876251, "body": "Out of curiosity why are you creating a COUNTIF function when one already exists in Excel?"}, {"owner": {"reputation": 1, "user_id": 11904164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/548865c47bb060f5dccee649ecbf7187?s=128&d=identicon&r=PG&f=1", "display_name": "nisshaheen", "link": "https://stackoverflow.com/users/11904164/nisshaheen"}, "edited": false, "score": 0, "creation_date": 1567147460, "post_id": 57696939, "comment_id": 101884204, "body": "zack thanks for reply, I don&#39;t no how used counting formula inside macro that why creating function, function not work with me, I try to creating macro"}], "owner": {"reputation": 1, "user_id": 11904164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/548865c47bb060f5dccee649ecbf7187?s=128&d=identicon&r=PG&f=1", "display_name": "nisshaheen", "link": "https://stackoverflow.com/users/11904164/nisshaheen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567059154, "creation_date": 1567011116, "last_edit_date": 1567059154, "question_id": 57696939, "link": "https://stackoverflow.com/questions/57696939/countif-range-based-on-cell-value-in-another-sheet-vba", "title": "countif range based on cell value in another sheet vba", "body": "<p>i have multisheets with on workbook the name of sheets as today date, my question (how i can countif range based on specific range in another sheets)</p>\n\n<p>the range will search in multisheets (X4:X16) i want to count the value in this range if repeat more than 1 and paste the result in master sheet(Main of Month) range (AB3:AB16)</p>\n\n<p>any help for, thanks</p>\n\n<pre><code>Function MyCOUNTIF(ByVal userRange As Variant, ByVal userCriteria As Variant)\n     MyCOUNTIF = Application.WorksheetFunction.CountIf(ws.range(\"X4:X16\",Sheets(\"MainofMonth\".range(\"AB3:AB\")))\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567012863, "post_id": 57696904, "comment_id": 101838795, "body": "What does <code>=VLOOKUP(&quot;https:&#47;&#47;www.facebook.com&#47;groups&#47;xxx&#47;permalink&#47;1338&zwnj;&#8203;777099605419&#47;&quot;, $B$2:$F$4, 6, FALSE)</code> output? Hint: your lookup table is 5 columns wide, and you&#39;re asking for a value in the 6th one."}, {"owner": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567013170, "post_id": 57696904, "comment_id": 101838931, "body": "I have checked by changing myColumnIndex to 5. But no luck"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567013631, "post_id": 57696904, "comment_id": 101839126, "body": "Is the formula valid? Did the error number change? <code>WorksheetFunction.Xxxxxx</code> functions will <i>raise</i> an error rather than <i>return</i> one - if the lookup yields <code>#N&#47;A</code> then you need to handle the runtime error, or yield it to a <code>Variant</code> with <code>Application.VLookup</code> instead (and then use <code>If Not IsError(myLookupResult) Then</code> to avoid a type mismatch error when you later try to show the result in a msgbox)."}, {"owner": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567014132, "post_id": 57696904, "comment_id": 101839315, "body": "Did the error number change? No. Same error. I can able to search for other column result successfully. But not the last column."}, {"owner": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567015268, "post_id": 57696904, "comment_id": 101839780, "body": "I tried with =VLOOKUP(&quot;<a href=\"https://www.facebook.com/groups/xxx/permalink/1338777099605419/&quot;,A2:F4,5,FALSE\" rel=\"nofollow noreferrer\">facebook.com/groups/xxx/permalink/1338777099605419&zwnj;&#8203;/&hellip;</a>). But getting N/A as the output."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567015361, "post_id": 57696904, "comment_id": 101839804, "body": "So, the lookup fails, and <code>WorksheetFunction.VLookup</code> is raising an error. Refer to <a href=\"https://stackoverflow.com/questions/57696904/runtime-error-1004-not-able-to-lookup-the-column-with-the-url-link-name?noredirect=1#comment101839126_57696904\">previous comment</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567019139, "post_id": 57696904, "comment_id": 101841218, "body": "Figured it out when I finally noticed the table at the top of your post - the lookup value needs to be in the leftmost column of the lookup range, and the lookup column needs to be the column that contains the result you&#39;re trying to get... you can&#39;t have both the lookup value and the lookup column be the URL column."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1567019744, "post_id": 57696904, "comment_id": 101841478, "body": "There are 2 issues here - firstly, your data isn&#39;t in the right order for a vlookup, so you need to use <code>index&#47;match</code> instead (or just <code>.Find()</code> seeing as you&#39;re using VBA anyway...). Secondly, you use your variables to set your lookup range, but then you use the same variables to query that range. When you set the first column to <code>2 (B)</code> and then lookup using that variable you&#39;re now looking up the second column of your new range, which is actually column <code>C</code> in the original range, so you need to correct your indeces."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "edited": false, "score": 0, "creation_date": 1567015581, "post_id": 57697335, "comment_id": 101839872, "body": "@Unknown see edit - this <i>did</i> work. But you need to handle a failing lookup."}, {"owner": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "edited": false, "score": 0, "creation_date": 1567016169, "post_id": 57697335, "comment_id": 101840086, "body": "But in my xls, I do have the url string. It should be able to find the cell in the code. I lost in why it is not able to find the url."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "edited": false, "score": 0, "creation_date": 1567016298, "post_id": 57697335, "comment_id": 101840145, "body": "Watch for leading/trailing spaces in particular. Hard to tell what&#39;s wrong without seeing the data."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1567019050, "last_edit_date": 1567019050, "creation_date": 1567013034, "answer_id": 57697335, "question_id": 57696904, "link": "https://stackoverflow.com/questions/57696904/runtime-error-1004-not-able-to-lookup-the-column-with-the-url-link-name/57697335#57697335", "title": "Runtime error 1004 Not able to lookup the column with the url link name", "body": "<p>EDIT: Your lookup table has the lookup value in the wrong column. <code>VLOOKUP</code> requires the lookup value to exist in the <strong>first</strong> column of the lookup table, but you're looking for a url, which is the <em>last</em> column in your data.</p>\n\n<p>How <code>VLOOKUP</code> works, is that you give it a lookup value (say, \"dataxxxx\"), tell it where it's going to find that value (say, that range of cells right there - the lookup value is in the left-most column, always), and then which column from the left you're pulling the lookup result from: if you want to <em>get</em> a URL, then the URL can't be your <em>lookup value</em>.</p>\n\n<p>Original answer follows.</p>\n\n<hr>\n\n<p><code>myColumnIndex</code> can't match <code>myLastColumn</code>; you're v-looking-up one column beyond the lookup table, which starts in column <code>B</code> (<code>myFirstColumn = 2</code>).</p>\n\n<pre><code>myColumnIndex = myLastColumn - myFirstColumn + 1\n</code></pre>\n\n<p>Should fix it.</p>\n\n<p>Note that if the lookup fails (i.e. returns <code>#N/A</code> on a worksheet) then <code>WorksheetFunction.VLookup</code> will <em>raise</em> a run-time error that you need to handle.</p>\n\n<p>If a failing lookup isn't an exceptional situation, consider using the late-bound <code>Application.VLookup</code> equivalent, which will <em>return</em> the error instead:</p>\n\n<pre><code>Dim myVLookupResult As Variant ' &lt;~ note the return type\nmyVLookupResult = Application.VLookup(myLookupValue, myTableArray, myColumnIndex, False)\n\nIf IsError(myVLookupResult) Then\n     'vlookup returned #N/A 'string coercion would throw a type mismatch here\nElse\n     MsgBox myVLookupResult 'string coercion is safe/valid here\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1858, "user_id": 1945220, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/nbZTM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/1945220/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 57697335, "answer_count": 1, "score": 2, "last_activity_date": 1567047994, "creation_date": 1567010984, "last_edit_date": 1567047994, "question_id": 57696904, "link": "https://stackoverflow.com/questions/57696904/runtime-error-1004-not-able-to-lookup-the-column-with-the-url-link-name", "title": "Runtime error 1004 Not able to lookup the column with the url link name", "body": "<p>I am trying to search for the column with the help of VBA in Microsoft XLS.</p>\n\n<p>Here is my xlsx data</p>\n\n<pre><code>---------------------------------------------------------------------\n|Column1 |Column2 |Column3 |Column4 |Column5 |Column6                |\n---------------------------------------------------------------------\n|Dataxxx |Olivier |  40    | 100    |  1163  | https://www.facebook.com/groups/xxx/permalink/1338777099605419/      |\n----------------------------------------------------------------------\n|Dataxxx |Geovanny| 35     | 101    |  1147  |  https://www.facebook.com/groups/xxx/permalink/1338288259654303/      |\n----------------------------------------------------------------------\n|Dataxxx |Julien  | 33     |  66    |  1200  | https://www.facebook.com/groups/xxx/permalink/1339487882867674/      |\n----------------------------------------------------------------------\n</code></pre>\n\n<p>Here is the code which I have tried:</p>\n\n<pre><code>Sub myMacro()\n\n    Dim myLookupValue As String\n    Dim myFirstColumn As Long\n    Dim myLastColumn As Long\n    Dim myColumnIndex As Long\n    Dim myFirstRow As Long\n    Dim myLastRow As Long\n    Dim myVLookupResult As String\n\n    Dim myTableArray As Range\n\n    myLookupValue = \"https://www.facebook.com/groups/xxx/permalink/1338777099605419/\"\n    myFirstColumn = 2\n    myLastColumn = 6\n    myColumnIndex = 5\n    myFirstRow = 2\n    myLastRow = 4\n\n    With Worksheets(\"Sheet1\")\n        Set myTableArray = .Range(.Cells(myFirstRow, myFirstColumn), .Cells(myLastRow, myLastColumn))\n    End With\n\n    myVLookupResult = WorksheetFunction.VLookup(myLookupValue, myTableArray, myColumnIndex, False)\n\n    MsgBox \"My lookup value \" &amp; myLookupValue &amp; \" are \"\n\nEnd Sub\n</code></pre>\n\n<p>How do I resolve this issue?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11985153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed3489b711500e5e2d0ae89f968c31e?s=128&d=identicon&r=PG&f=1", "display_name": "Sofar", "link": "https://stackoverflow.com/users/11985153/sofar"}, "edited": false, "score": 0, "creation_date": 1567065571, "post_id": 57699784, "comment_id": 101853735, "body": "That&#39;s some cool vba code, thank you. However, it seems that I cannot pre-format this to be drawn shape (e.g. a different color and font size than the default shapestyle) as .executemso does not allow for additional arguments (like .fill). Of course it can be formatted afterwards, but that is not ideal. Hence would you have a suggestion on how to pre-format the shape?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 1, "user_id": 11985153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed3489b711500e5e2d0ae89f968c31e?s=128&d=identicon&r=PG&f=1", "display_name": "Sofar", "link": "https://stackoverflow.com/users/11985153/sofar"}, "edited": false, "score": 0, "creation_date": 1567092769, "post_id": 57699784, "comment_id": 101869141, "body": "Sorry, it&#39;s all or nothing for presetting formatting. You can preformat the object including position and size, or you can draw the object using this workaround and apply formatting later. A workaround to the workaround would be to set your desired formatting as the shape default before running the command. Here is Microsoft&#39;s help page on the SetShapesDefaultProperties command: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.shape.setshapesdefaultproperties\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1567024961, "creation_date": 1567024961, "answer_id": 57699784, "question_id": 57696515, "link": "https://stackoverflow.com/questions/57696515/creating-shapes-in-similar-fashion-as-with-autoshape-dropdown/57699784#57699784", "title": "Creating shapes in similar fashion as with autoshape dropdown", "body": "<p>This will put your cursor in drawing mode to draw an oval. After running, you may have to click on the slide once, then the cursor will change shape and you can draw an oval:</p>\n\n<pre><code>Sub DrawOval()\n  Application.CommandBars.ExecuteMso (\"ShapeOval\")\nEnd Sub\n</code></pre>\n\n<p>Other commands to substitute for ShapeOval:\nShapeRectangle\nShapeElbowConnectorArrow\nShapeStraightConnectorArrow\nGet the full list in Excel spreadsheets from Microsoft <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=50745\" rel=\"nofollow noreferrer\">Office 2016 Help Files: Office Fluent User Interface Control Identifiers</a>\nLook for the powerpointcontrols.xlsx file and search the first column with \"shape\"</p>\n\n<p>There are 173 shapes in the menu, so you have a lot of macros to write.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11985153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed3489b711500e5e2d0ae89f968c31e?s=128&d=identicon&r=PG&f=1", "display_name": "Sofar", "link": "https://stackoverflow.com/users/11985153/sofar"}, "edited": false, "score": 0, "creation_date": 1567186772, "post_id": 57716744, "comment_id": 101902482, "body": "Hmm it seems to result in an compile error &#39;variable not defined&#39; (w.r.t. &#39;selection&#39;). Hence, the code does not run."}, {"owner": {"reputation": 33, "user_id": 11861360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VrnBRH1G7m8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftBaJAMwRgIEfm10WvlpyzZEKo9w/photo.jpg?sz=128", "display_name": "dmorchard", "link": "https://stackoverflow.com/users/11861360/dmorchard"}, "reply_to_user": {"reputation": 1, "user_id": 11985153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed3489b711500e5e2d0ae89f968c31e?s=128&d=identicon&r=PG&f=1", "display_name": "Sofar", "link": "https://stackoverflow.com/users/11985153/sofar"}, "edited": false, "score": 0, "creation_date": 1567187289, "post_id": 57716744, "comment_id": 101902654, "body": "I encountered the same thing when I first tried it in Excel, and the issue was me mouse-clicking off the just-drawn shape causing it to become unselected prior to resuming the stopped subroutine."}], "tags": [], "owner": {"reputation": 33, "user_id": 11861360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VrnBRH1G7m8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftBaJAMwRgIEfm10WvlpyzZEKo9w/photo.jpg?sz=128", "display_name": "dmorchard", "link": "https://stackoverflow.com/users/11861360/dmorchard"}, "is_accepted": false, "score": 1, "last_activity_date": 1567107075, "creation_date": 1567107075, "answer_id": 57716744, "question_id": 57696515, "link": "https://stackoverflow.com/questions/57696515/creating-shapes-in-similar-fashion-as-with-autoshape-dropdown/57716744#57716744", "title": "Creating shapes in similar fashion as with autoshape dropdown", "body": "<p>Building on what John Korchok suggested, here's code that retrieves the just-drawn shape so that your code can resume and manipulate it...</p>\n\n<pre><code>Sub testAppComBars()\n    Dim SHP As Shape\n\n    Application.CommandBars.ExecuteMso (\"ShapeFreeform\")\n\n    Stop\n\n    Set SHP = Selection.ShapeRange(1)\n    With SHP.Fill\n        .ForeColor.RGB = RGB(192, 0, 0)\n        .Transparency = 0.75\n    End With\nEnd Sub\n</code></pre>\n\n<p>I would hope there's a more elegant solution than using <code>Stop</code> to pause code execution while the user picks the shape's location (or in this case, draws a freeform polyline/polygon), but that's all I could come up with off the top of my head.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 11839085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34b2bc472a9a6b17616b5d44d92be675?s=128&d=identicon&r=PG&f=1", "display_name": "egerz", "link": "https://stackoverflow.com/users/11839085/egerz"}, "is_accepted": false, "score": 1, "last_activity_date": 1567350388, "creation_date": 1567350388, "answer_id": 57747106, "question_id": 57696515, "link": "https://stackoverflow.com/questions/57696515/creating-shapes-in-similar-fashion-as-with-autoshape-dropdown/57747106#57747106", "title": "Creating shapes in similar fashion as with autoshape dropdown", "body": "<p>I was fascinated by this problem and think this might help you.</p>\n\n<p>Consider that when you draw a new autoshape, you have changed the window selection, and created a new selection ShapeRange with exactly 1 item (the new shape).</p>\n\n<p>So by setting a WindowSelectionChange event, you're able to apply any formatting you wish at the time of creation.</p>\n\n<p>First create a class module called cPptEvents with the following:</p>\n\n<pre><code>Public WithEvents PPTEvent As Application\n\nPrivate Sub PPTEvent_WindowSelectionChange(ByVal sel As Selection)\n    On Error GoTo Errhandler\n    Debug.Print \"IN_PPTEvent_WindowSelectionChange\"\n\n    Dim oShp As Shape\n\n    If (ActiveWindow.ViewType = ppViewNormal) Then\n        With sel\n            If .Type = ppSelectionShapes Then\n                If .ShapeRange.Count = 1 Then\n                    Set oShp = .ShapeRange(1)\n                    If oShp.Type = msoAutoShape Then\n                        If oShp.AutoShapeType = msoShapeOval Then\n                           If oShp.Tags(\"new_oval\") = \"\" Then\n                                oShp.Fill.ForeColor.RGB = RGB(255, 0, 0)\n                                oShp.Tags.Add \"new_oval\", \"true\"\n                            End If\n                        End If\n                    End If\n                End If\n            End If\n        End With\n\n    End If\n\n\n\n    Exit Sub\n\nErrhandler:\n    Debug.Print \"Error: \" &amp; Err.Description\n\nEnd Sub\n</code></pre>\n\n<p>This checks the selection every time it changes.  If there's an oval selected, it looks for the \"new_oval\" tag, which will not exist for a newly created shape.  In that case, it applies a red fill, although of course once you get to this point you can call an entirely different sub, pass along the shape, and do whatever you want formatting-wise to it.</p>\n\n<p>By adding that \"new_oval\" tag, you ensure that the formatting will not be applied to an oval that hasn't been newly created. This allows the user to make manual changes to the formatting as needed -- otherwise you're just resetting the formatting every time the user selects an oval.</p>\n\n<p>Note that for the _WindowSelectionChange event to be running in the background, you have to call this at some point:</p>\n\n<pre><code>Public MyEventClassModule As New cPptEvents\n\n'\nPublic Sub StartMeUp()\n   Set MyEventClassModule.PPTEvent = Application\nEnd Sub\n</code></pre>\n\n<p>You can include that one line from StartMeUp above in whatever Ribbon_Onload sub is triggered by your addin, if you're making a new addin ribbon.</p>\n\n<p>With this solution, you don't even have to give the end user a special button or set of tools to create the shapes that are being formatted. It happens invisibly whenever the user draws a new shape from the native PPT tools.</p>\n"}], "owner": {"reputation": 1, "user_id": 11985153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed3489b711500e5e2d0ae89f968c31e?s=128&d=identicon&r=PG&f=1", "display_name": "Sofar", "link": "https://stackoverflow.com/users/11985153/sofar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1593678121, "creation_date": 1567009124, "last_edit_date": 1593678121, "question_id": 57696515, "link": "https://stackoverflow.com/questions/57696515/creating-shapes-in-similar-fashion-as-with-autoshape-dropdown", "title": "Creating shapes in similar fashion as with autoshape dropdown", "body": "<p>I would like to make a macro in Powerpoint that enables me to create shapes in a similar fashion as when you select the autoshapes in the autoshape overview (i.e. once you call the macro you have a possibility to click to set the coordinates and subsequently you drag and click to set the width&amp;height). Also, I would like to give it pre-set cosmetic characteristics (e.g. certain inner margins, fill color, border style and transparancy), which will be defined in the vba code.</p>\n\n<p>I am aware of .addshapes(), however, this requires coordinates and height/width as input. Moreover, I have not find any posts / documents on vba to create shapes without defined coordinates and height/width.\nAnyone some ideas on how to tackle this challenge?</p>\n\n<p>Many thanks in advance!</p>\n\n<p>Sofar</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567010602, "post_id": 57696484, "comment_id": 101837865, "body": "You can&#39;t select or activate a cell on a non-active sheet, not that you generally need to anyway."}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567013728, "post_id": 57696484, "comment_id": 101839163, "body": "I know.  That&#39;s my problem.  How to do it without using activecell"}], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "is_accepted": false, "score": 0, "last_activity_date": 1567016054, "creation_date": 1567016054, "answer_id": 57698012, "question_id": 57696484, "link": "https://stackoverflow.com/questions/57696484/returning-value-of-next-visible-cell-from-structured-table-in-a-different-sheet/57698012#57698012", "title": "Returning value of next visible cell from structured table in a different sheet", "body": "<p>I gave up trying to work around the sheet not being active and Activecell.  This seems to work, although it seems like there would be a more elegant way, No?</p>\n\n<pre><code>Sub movePointerDown()\n\n  Application.ScreenUpdating = False\n  Set wksToCheck = Sheets(\"Data\")\n  Sheets(\"data\").Select\n  Sheets(\"Data\").Range(\"A1\").EntireColumn.SpecialCells(xlCellTypeVisible).Find(What:=\"*\", After:=ActiveCell).Activate\n\n  Sheets(\"Main\").Range(\"O2\").Value = ActiveCell.Value\n\n  Sheets(\"Main\").Select\n  Application.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n\n<p>And its companion:</p>\n\n<pre><code>Sub movePointerUp()\n\n  Application.ScreenUpdating = False\n  Set wksToCheck = Sheets(\"Data\")\n  Sheets(\"data\").Select\n  Sheets(\"Data\").Range(\"A1\").EntireColumn.SpecialCells(xlCellTypeVisible).Find(What:=\"*\", After:=ActiveCell, Searchdirection:=xlPrevious).Activate\n\n  Sheets(\"Main\").Range(\"O2\").Value = ActiveCell.Value\n\n  Sheets(\"Main\").Select\n  Application.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1567116540, "last_edit_date": 1567116540, "creation_date": 1567102396, "answer_id": 57715765, "question_id": 57696484, "link": "https://stackoverflow.com/questions/57696484/returning-value-of-next-visible-cell-from-structured-table-in-a-different-sheet/57715765#57715765", "title": "Returning value of next visible cell from structured table in a different sheet", "body": "<p>Don't need to work with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.activecell\" rel=\"nofollow noreferrer\">ActiveCell</a> if you use <a href=\"https://www.google.com/search?q=excel+vba+working+with+objects&amp;rlz=1C1CHBF_enVE851VE851&amp;oq=excel+vba+working+with+objects&amp;aqs=chrome..69i57j33l5.14386j1j7&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">Excel objects</a>, there is plenty of information about the subject on the internet.</p>\n\n<p>This proposed solution returns the next <code>Cell</code> record, and it's wrapped in a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/function-statement\" rel=\"nofollow noreferrer\">Function</a><br>\n to allow for flexibility. It uses a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/static-statement\" rel=\"nofollow noreferrer\">Static</a> variable to keep track of actual record <em>(see link provided for details)</em> and validates the <code>ListObject</code> (excel Table) field, its <code>AutoFilter</code> and whether the actual record is the last visible record.</p>\n\n<pre><code>Function ListObject_\u0192NextVisibleCell(rOutput As Range, sMsgOut As String, sFld As String) As Boolean\nStatic rCll As Range\nConst kMsg1 As String = \"Field [ #FLD ] not found.\"\nConst kMsg2 As String = \"ListObject filter returned zero records\"\nConst kMsg3 As String = \"Actual record is the last visible record\"\nDim wsDATA As Worksheet\nDim lo As ListObject\nDim rTrg As Range\nDim rCllLast As Range\n\n    Set wsDATA = ThisWorkbook.Worksheets(\"DATA\")\n    Set lo = wsDATA.ListObjects(\"lo.DATA\")  'update as required\n\n    With lo\n        On Error Resume Next\n\n        Rem Validate Field\n        Set rTrg = .ListColumns(sFld).DataBodyRange\n        If rTrg Is Nothing Then\n            sMsgOut = Replace(kMsg1, \"#FLD\", sFld)\n            Exit Function\n        End If\n\n        Rem Validate ListObject AutoFilter\n        Set rTrg = Nothing\n        Set rTrg = .ListColumns(sFld).DataBodyRange.SpecialCells(xlCellTypeVisible)\n        If rTrg Is Nothing Then sMsgOut = kMsg2: Exit Function\n\n        On Error GoTo 0\n    End With\n\n    Select Case (rCll Is Nothing)\n\n    Case True\n        Rem No Previous Record\n        Set rCll = rTrg.Cells(1)\n\n    Case False\n        With lo.ListColumns(sFld).DataBodyRange\n\n            Rem Validate Last Record\n            Set rCllLast = rTrg.Areas(rTrg.Areas.Count).Cells(rTrg.Areas(rTrg.Areas.Count).Cells.Count)\n            If rCll.Address = rCllLast.Address Then\n                sMsgOut = kMsg3\n                Exit Function\n\n            Else\n                Rem Reset Visible Cells Range\n                Set rTrg = Range(rCll.Offset(1), .Cells(.Cells.Count))\n                Set rTrg = rTrg.SpecialCells(xlCellTypeVisible)\n\n                Rem Set Next Record\n                Set rCll = rTrg.Cells(1)\n\n    End If: End With: End Select\n\n    Rem Set Results\n    Set rOutput = rCll\n    ListObject_\u0192NextVisibleCell = True\n\n    End Function\n</code></pre>\n\n<p>It should be called in this manner</p>\n\n<pre><code>Sub ListObject_\u0192NextVisibleCell_TEST()\nConst kTitle As String = \"ListObject Next Visible Cell\"\nDim wsMain As Worksheet, rCll As Range\nDim sFld As String, sMsg As String\n\n    sFld = \"JobNo\"\n    Set wsMain = ThisWorkbook.Worksheets(\"Main\")\n\n    If ListObject_\u0192NextVisibleCell(rCll, sMsg, sFld) Then\n        wsMain.Range(\"O2\").Value2 = rCll.Value2\n\n    Else\n        MsgBox sMsg, vbCritical, kTitle\n\n    End If: End With\n\n    End Sub\n</code></pre>\n\n<p>Suggest to check the following pages for details about the resources used:  </p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet\" rel=\"nofollow noreferrer\">Worksheet object (Excel)</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobject\" rel=\"nofollow noreferrer\">ListObject object (Excel)</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.range\" rel=\"nofollow noreferrer\">Application.Range property (Excel)</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/with-statement\" rel=\"nofollow noreferrer\">With statement</a><br>\n<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/msgbox-function\" rel=\"nofollow noreferrer\">MsgBox function</a>  </p>\n"}], "owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567116540, "creation_date": 1567009026, "last_edit_date": 1567075839, "question_id": 57696484, "link": "https://stackoverflow.com/questions/57696484/returning-value-of-next-visible-cell-from-structured-table-in-a-different-sheet", "title": "Returning value of next visible cell from structured table in a different sheet", "body": "<p>On the sheet named \"Data\" I have an Excel Table.  This table has a variable number of rows, typically 20k to 30k.  Column A is \"JobNo\"</p>\n\n<p>On the sheet named \"Main\" I have cell where I show the \"JobNo\".  That value starts as the first visible JobNo from the filtered table.  </p>\n\n<p>I have buttons for \"Next Record\".  When I click this button and run it's associated VBA code, I need that code to move the \"Data\" sheet's cell pointer to the next visible (filtered) value in column A.</p>\n\n<p>I've tried several samples of code found here to find the first visible cell, and to move to the next visible cell, but most of them relied on \"Activecell\".  I need to move a \"virtual\" pointer to the next visible cell because that sheet, where the table is located is not visible and so the ActiveCell is not there.</p>\n\n<p>This for example works to move the cell pointer to the next visible cell, but it only works if \"Dat\" sheet is selected:</p>\n\n<pre><code>Sub movetest()\n\n  Sheets(\"Data\").Range(\"A1\").EntireColumn.SpecialCells(xlCellTypeVisible).Find(What:=\"*\", After:=ActiveCell).Activate\n\nEnd Sub\n</code></pre>\n\n<p>What I need is something that can do what the above line does, but do it to a sheet that is not selected.  Bonus to me if it was in structured table syntax.</p>\n\n<p>I also tried to use some variant of this, which moves to the first visible cell, but only when the \"Data\" sheet is selected:</p>\n\n<pre><code>Range(\"Data[[#All],[PACEJob]]\").SpecialCells(xlCellTypeVisible).Find _\n(What:=\"*\", After:=ActiveSheet.Range(\"Data[[#Headers],[PACEJob]]\"), _\nLookIn:=xlFormulas, lookat:=xlPart, searchorder:=xlByColumns, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False).Activate\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>This does what I need for non filtered table.  Just need to replicate this to do the same thing with a filtered table and only show visible.</p>\n\n<pre><code>  (GLobal selectedRow)\n\n  selectedJobRow = selectedJobRow + 1\n  Sheets(\"Main\").Range(\"O2\").Value = Sheets(\"Data\").Range(\"A\" &amp; selectedJobRow).Value\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1567335413, "creation_date": 1567335413, "answer_id": 57745379, "question_id": 57696303, "link": "https://stackoverflow.com/questions/57696303/how-to-compare-a-string-with-date/57745379#57745379", "title": "How to compare a String with Date", "body": "<p>Try to compare the dates like this:</p>\n\n<pre><code>If Format(ValFile ,\"yyyy-mm-dd\") &lt;= Format(Date(),\"yyyy-mm-dd\") Then......etc.\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10163746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5442a2209239f61c6dce162cf8083?s=128&d=identicon&r=PG&f=1", "display_name": "Senate", "link": "https://stackoverflow.com/users/10163746/senate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586980560, "creation_date": 1567008192, "last_edit_date": 1586980560, "question_id": 57696303, "link": "https://stackoverflow.com/questions/57696303/how-to-compare-a-string-with-date", "title": "How to compare a String with Date", "body": "<p>I'm trying to write some vba code that takes a filename in specified folder, picks out the date-part of this filename and compares this with the current date. If the date in the filename is smaller, the file shall be deleted.</p>\n\n<p>The date is given in the filename like dd.mm.yy</p>\n\n<p>So far I'm up to</p>\n\n<pre><code>Public Sub DeleteOldFiles()\n\n    Dim FolderOld, CheckDate, ValFile As String\n\n    FolderOld = \"O:\\temp\\\"\n\n    Set FS = CreateObject(\"Scripting.FileSystemObject\")\n    Set Folder = FS.GetFolder(FolderOld)\n    For Each File In Folder.Files\n        CheckDate = File.Name\n        ValFile = Mid(DateiName, InStr(CheckDate, \"valid until \") + 12) 'cut of everything before the date\n        ValFile = Left(ValFile, 8) 'cut everything behind the date\n\n        If ValFile &lt; Format(Date(), \"dd.mm.yy\") Then\n            Kill FolderOld &amp; CheckDate\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>My code works just as it should as long as it only concerns the day-part of the date.For instance, today is August 28th. </p>\n\n<p>If the filename contains 28.08.19, it is still valid and is not deleted as expected.</p>\n\n<p>If the filename contains 26.08.19, it isn't valid and is deleted as expected.\nBut if the filename contains 26.09.19, it is deleted although still valid.</p>\n\n<p>Maybe someone has a possible solution?</p>\n"}, {"tags": ["vba", "grouping", "autocad", "autolisp"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11957478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRCk53C5WlU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfghcKbFNsQgsmuc0cWOdJ2MGThFA/photo.jpg?sz=128", "display_name": "Pedro", "link": "https://stackoverflow.com/users/11957478/pedro"}, "edited": false, "score": 0, "creation_date": 1567095981, "post_id": 57697152, "comment_id": 101870657, "body": "thank you very much, worked like a charm. I slightly changed it so it filters the blocks that I wanted to see if were grouped or not: <code>(if (setq sel (ssget &quot;_X&quot; &#39;((0 . &quot;INSERT&quot;) (2 . &quot;BLOCK1,BLOCK2,BLOCK3&quot;))))</code> I am giving you the answer, although I have a tangent that I would love if you could explain me why is it not working. I want to delete the blocks that are ungrouped, and as such i used <code>(command &quot;erase&quot; blk &quot;&quot;)</code> What am I not getting right?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 47, "user_id": 11957478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRCk53C5WlU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfghcKbFNsQgsmuc0cWOdJ2MGThFA/photo.jpg?sz=128", "display_name": "Pedro", "link": "https://stackoverflow.com/users/11957478/pedro"}, "edited": false, "score": 0, "creation_date": 1567098815, "post_id": 57697152, "comment_id": 101871894, "body": "You&#39;re most welcome Pedro. The supplied functions will return a list of block names; if you wish to erase the blocks that are ungrouped, you will need to use the second function and instead of obtaining the block name, you should use <code>entdel</code> with the block reference entity (DXF group -1 or the entity returned by the <code>ssname</code> function)."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1567012197, "last_edit_date": 1592644375, "creation_date": 1567012197, "answer_id": 57697152, "question_id": 57695849, "link": "https://stackoverflow.com/questions/57695849/vba-autolisp-how-to-check-if-a-block-is-grouped-through-code-in-autocad/57697152#57697152", "title": "VBA/AutoLisp - How to check if a block is grouped through code in AutoCAD", "body": "<h3>Background</h3>\n<p>A block <strong>definition</strong> may have many block <strong>references</strong>: the block definition is analogous to the blueprints for a building, with each block reference analogous to the construction of the building itself.</p>\n<p>As such, given only a list of block <strong>names</strong>, each block name may correspond to multiple block <strong>references</strong>, with some contained within groups, and others not.</p>\n<hr>\n<h3>Methods</h3>\n<p>You can therefore approach this task from two angles:</p>\n<ul>\n<li>Iterate over all <strong>Groups</strong> defined within the drawing (either using the ActiveX Groups Collection, or the <code>ACAD_GROUP</code> dictionary contained within the Named Object Dictionary), and obtain the set of distinct block names corresponding to blocks contained within at least one Group.</li>\n</ul>\n<p><sup>OR</sup></p>\n<ul>\n<li>Iterate over all <strong>Block References</strong> within the drawing and test whether the block reference has a link to a <code>GROUP</code> entity via an <code>{ACAD_REACTORS}</code> entry in the DXF data. Compile a list of block names corresponding to blocks which are either contained within at least one group, or not contained within any group.</li>\n</ul>\n<p>Given such a list, you can then easily test whether any of your block names are not present in the list.</p>\n<hr>\n<h3>Sample Code</h3>\n<p>Below is a function that will iterate over all Groups defined within the <code>ACAD_GROUP</code> dictionary of the Named Object Dictionary, and will return a list of the names of block references contained within one or more groups:</p>\n<pre class=\"lang-lisp prettyprint-override\"><code>(defun blocknamesfromgroups ( / blk dic enx grp rtn )\n    (if (setq dic (cdr (assoc -1 (dictsearch (namedobjdict) &quot;acad_group&quot;))))\n        (while (setq grp (dictnext dic (not grp)))\n            (foreach itm grp\n                (if (and (= 340 (car itm)) (= &quot;INSERT&quot; (cdr (assoc 0 (setq enx (entget (cdr itm)))))))\n                    (if (not (member (setq blk (cdr (assoc 2 enx))) rtn))\n                        (setq rtn (cons blk rtn))\n                    )\n                )\n            )\n        )\n    )\n    (reverse rtn)\n)\n</code></pre>\n<p>Alternatively, the below function will iterate over all primary block references in the active drawing and will report the names of block references not contained within a group:</p>\n<pre class=\"lang-lisp prettyprint-override\"><code>(defun blocknamesnotgrouped ( / blk enx grp idx sel rtn )\n    (if (setq sel (ssget &quot;_X&quot; '((0 . &quot;INSERT&quot;))))\n        (repeat (setq idx (sslength sel))\n            (setq idx (1- idx)\n                  enx (entget (ssname sel idx))\n                  blk (cdr (assoc 2 enx))\n            )\n            (if\n                (not\n                    (or\n                        (and\n                            (setq enx  (member '(102 . &quot;{ACAD_REACTORS&quot;) enx))\n                            (setq grp  (cdr (assoc 330 enx)))\n                            (= &quot;GROUP&quot; (cdr (assoc 0 (entget grp))))\n                        )\n                        (member blk rtn)\n                    )\n                )\n                (setq rtn (cons blk rtn))\n            )\n        )\n    )\n    (reverse rtn)\n)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11957478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRCk53C5WlU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfghcKbFNsQgsmuc0cWOdJ2MGThFA/photo.jpg?sz=128", "display_name": "Pedro", "link": "https://stackoverflow.com/users/11957478/pedro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 57697152, "answer_count": 1, "score": 0, "last_activity_date": 1567153819, "creation_date": 1567006432, "last_edit_date": 1567153819, "question_id": 57695849, "link": "https://stackoverflow.com/questions/57695849/vba-autolisp-how-to-check-if-a-block-is-grouped-through-code-in-autocad", "title": "VBA/AutoLisp - How to check if a block is grouped through code in AutoCAD", "body": "<p>I am working with groups in AutoCAD and, due to copy pasting them from different drawings, they ungroup. \nIn the possibility of me forgetting to regroup them, I want to create a code that, when I think I am finished with the drawing, can check if a list of blocks (every group has a block) is not inside a group.</p>\n\n<p>As such, the idea is that it would run from a selection of blocks (ex: block1, block3, block7) and check if those particular blocks are grouped. If not, it would tell me which block is ungrouped.</p>\n\n<p>As the tags suggest, either vba or autolisp is fine. I am fairly novice at this, any help would be fairly appreciated.</p>\n\n<p>edit: knowing how I could get a block group name in vba would be great</p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1567006765, "post_id": 57695804, "comment_id": 101836059, "body": "did you set a reference to MS Active Data Objects Library ?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1567006787, "post_id": 57695804, "comment_id": 101836072, "body": "does the code compile ?"}, {"owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1567007048, "post_id": 57695804, "comment_id": 101836218, "body": "@Patrick Honorez - For my References, I have: VBA, Microsoft Excel 16.0 Library, OLE Automation, Microsoft ActiveX Data Objects Recordset 6.0 Library, and Microsoft ActiveX Data Objects 6.1 Library. My code does compile"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1567007705, "post_id": 57695804, "comment_id": 101836565, "body": "ADO SQL is not the same as SQL Server&#39;s SQL - it&#39;s closer to MS Access&#39;s version. In this case you can&#39;t set a shortname for a record set just by adding a letter, you need to use the keyword AS -so &quot;select name from mydata as a&quot; rather than &quot;select name from mydata a&quot;. This may not be the only problem of course."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1567008531, "post_id": 57695804, "comment_id": 101836995, "body": "@HarassedDad it&#39;s not ADO, it&#39;s <code>Microsoft.ACE.OLEDB.12.0</code>. If it&#39;s SQL Server running the query, the syntax is T-SQL syntax, even though the connection is through ADODB. It&#39;s the provider that matters. But yeah, ACE.OLEDB isn&#39;t T-SQL ;-)"}, {"owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1567009306, "post_id": 57695804, "comment_id": 101837348, "body": "@HarassedDad I changed it and no luck, but thanks for the idea. I kind of just assumed the SQL Server would be the same because they&#39;re both Microsoft"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1567009907, "post_id": 57695804, "comment_id": 101837591, "body": "Try manually setting up the connection and query through the UI first, you&#39;ll probably get more meaningful error messages"}, {"owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567011716, "post_id": 57695804, "comment_id": 101838287, "body": "@MathieuGuindon I&#39;m sorry, I&#39;m not familiar with UI. Could you send me some resources pertaining to it? Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1567011753, "post_id": 57695804, "comment_id": 101838305, "body": "I mean the Excel UI - from the &quot;Data&quot; tab..."}, {"owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "edited": false, "score": 0, "creation_date": 1567013367, "post_id": 57695804, "comment_id": 101839005, "body": "I&#39;m still lost. I&#39;ve never heard of Excel UI before"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 2, "creation_date": 1567075596, "post_id": 57695804, "comment_id": 101859023, "body": "UI = User Interface. He means use the menus rather than VB to make the connection - that should give you better error messages for debugging"}, {"owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567168093, "post_id": 57695804, "comment_id": 101893548, "body": "@MathieuGuindon It gave me the same error : \\"}], "owner": {"reputation": 79, "user_id": 11664860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-unDCpbjn5To/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rck1GbI9tcjeDlqco7OaVzuyqqZIg/mo/photo.jpg?sz=128", "display_name": "Jimmy Sgrazzutti", "link": "https://stackoverflow.com/users/11664860/jimmy-sgrazzutti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567007608, "creation_date": 1567006248, "last_edit_date": 1567007608, "question_id": 57695804, "link": "https://stackoverflow.com/questions/57695804/automation-error-unspecified-error-when-using-excel-vba-and-adodb-objects", "title": "&quot;Automation Error&quot; &quot;Unspecified Error&quot; When Using Excel-VBA and ADODB Objects", "body": "<p>I am creating a macro that looks through a folder, performs a SQL operation on each of the documents, and copies the results into another workbook; however, every time I debug and hit the <code>Set rs = cn.Execute(sql)</code> line I get an </p>\n\n<blockquote>\n  <p>\"Automation Error\" \"Unspecified Error\" .</p>\n</blockquote>\n\n<p>The even weirder thing is that when I just run the code, I get an </p>\n\n<blockquote>\n  <p>\"Execute of object _Connection failed\" error.</p>\n</blockquote>\n\n<p>I have tested the SQL code in microsoft SQL server already and each of these statements are almost verbatim  with code I have previously got to work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\n\nSub hardnessTests()\n\n    On Error GoTo ErrorHandling\n\n    Dim filename As Variant, n As Long\n    n = 0\n\n    Call turnOff\n\n    filename = Dir(\"T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\County Summary Results\\*\")\n\n    While filename &lt;&gt; \"\"\n\n        Dim file As String, cn As Object, rs As Object, sql As String, hardField As ADODB.Field\n        file = \"T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\County Summary Results\\\" &amp; filename\n\n        Set cn = CreateObject(\"ADODB.Connection\")\n\n        With cn\n            .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n            .connectionstring = \"Data Source=\" &amp; file &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;Readonly=false;IMEX=0\"\";\"\n            .Open\n        End With\n\n        sql = \"SELECT c.STATEFP, c.COUNTYFP, AVG(CAST(a.ResultMeasureValue AS NUMERIC)) AS Average_Surface_Water_Hardness, COUNT(a.ResultMeasureValue) AS Number_Of_Surface_Water_Tests, \" &amp; _\n              \"AVG(CAST(b.ResultMeasureValue AS NUMERIC)) AS Average_Groundwater_Hardness, COUNT(b.ResultMeasureValue) AS Number_Of_Groundwater_Tests \" &amp; _\n              \"FROM (SELECT * FROM [Sheet1$] WHERE CAST(LEFT(ActivityStartDate, 4) AS NUMERIC) &gt;= 2010 and ActivityMediaSubdivisionName = 'Surface Water') a, \" &amp; _\n              \"(SELECT * FROM [Sheet1$] WHERE CAST(LEFT(ActivityStartDate, 4) AS NUMERIC) &gt;= 2010 AND ActivityMediaSubdivisionName = 'Groundwater') b, \" &amp; _\n              \"(SELECT * FROM [Sheet1$] WHERE CAST(LEFT(ActivityStartDate, 4) AS NUMERIC) &gt;= 2010 ) c GROUP BY c.STATEFP, c.COUNTYFP ORDER BY c.STATEFP, c.COUNTYFP\"\n\n        Set rs = cn.Execute(sql)\n\n        Dim wb As Workbook, fieldCount As Long\n        fieldCount = 0\n        Set wb = Workbooks.Add\n        wb.SaveAs \"T:\\Marketing\\Data Analytics\\GIS Data\\Water Quality Portal Data\\County Summary Results\\ALL_HARDNESS.xlsx\"\n\n        If n = 0 Then\n            wb.Worksheets(\"Sheet1\").Range(\"A2\").CopyFromRecordset rs\n        Else:\n            wb.Worksheets(\"Sheet1\").Range(\"A2\").End(xlDown).CopyFromRecordset rs\n        End If\n\n        filename = Dir\n        n = n + 1\n\n    Wend\n\n    For Each hardField In rs.Fields\n        wb.Worksheets(\"Sheet1\").Range(\"A1\").Offset(0, fieldCount) = hardField.Name\n        fieldCount = fieldCount + 1\n    Next hardField\n\n    Call turnOn\n\nExit Sub\n\nErrorHandling:\n    MsgBox (\"Source: \" &amp; Err.Source &amp; vbNewLine &amp; \"Number: \" &amp; Err.Number &amp; vbNewLine &amp; \"Description: \" &amp; Err.Description &amp; vbNewLine &amp; \"Help Context: \" &amp; Err.HelpContext)\nDone:\n    End Sub\n\nPrivate Sub turnOff()\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\nEnd Sub\n\nPrivate Sub turnOn()\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n\n\n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567006377, "post_id": 57695798, "comment_id": 101835832, "body": "<code>Set j = Range(&quot;J15:AL&quot; &amp; k.row)</code> - you are not varying <code>j</code>, it is fixed. Also copy on its own doesn&#39;t do anything."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1567007187, "post_id": 57695798, "comment_id": 101836295, "body": "<code>Range(&quot;J&quot; &amp; k.row &amp;&quot;:AL&quot; &amp; k.row).copy</code>- you don&#39;t have a destination"}, {"owner": {"reputation": 11, "user_id": 11990019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b734fbfbc9ac8f6278cabe173429e117?s=128&d=identicon&r=PG&f=1", "display_name": "metalscuba", "link": "https://stackoverflow.com/users/11990019/metalscuba"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567008497, "post_id": 57695798, "comment_id": 101836978, "body": "@SJR its genius, thank you. It works amazing. Currently it copies all rows. Do you think is there a way not to copy if a cell in between is empty? For example E15 and E17 has a value, in this case program copies J15:AL17 although E16 is empty."}, {"owner": {"reputation": 11, "user_id": 11990019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b734fbfbc9ac8f6278cabe173429e117?s=128&d=identicon&r=PG&f=1", "display_name": "metalscuba", "link": "https://stackoverflow.com/users/11990019/metalscuba"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1567008632, "post_id": 57695798, "comment_id": 101837037, "body": "@Davesexcel thanks for your help. In this case this one does not need a destination as destination is rapidly changing."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567008915, "post_id": 57695798, "comment_id": 101837184, "body": "Might help if you explain what you are trying to achieve as might be a simpler way. You are copying the same range over again, and I don&#39;t understand what you mean by &quot;one does not need a destination&quot;."}, {"owner": {"reputation": 11, "user_id": 11990019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b734fbfbc9ac8f6278cabe173429e117?s=128&d=identicon&r=PG&f=1", "display_name": "metalscuba", "link": "https://stackoverflow.com/users/11990019/metalscuba"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1567032497, "post_id": 57695798, "comment_id": 101845639, "body": "@SJR What I meant by &quot;no destination&quot; is, this data will be copied to clipboard only. What you have advised works like a charm. This was my goal and your explanation is much appreciated. But currently, lets say i have following values on following cells; 1 on E15, 0 on E16, 2 on E17. Current program copies J15:AL17. Is there a way to make it copy only J15:AL15 and J17:AL17. As I do not need row across of 0 value."}], "owner": {"reputation": 11, "user_id": 11990019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b734fbfbc9ac8f6278cabe173429e117?s=128&d=identicon&r=PG&f=1", "display_name": "metalscuba", "link": "https://stackoverflow.com/users/11990019/metalscuba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567433389, "creation_date": 1567006198, "last_edit_date": 1567433389, "question_id": 57695798, "link": "https://stackoverflow.com/questions/57695798/copy-a-range-if-a-specific-cell-has-value", "title": "Copy a Range if a Specific Cell Has Value", "body": "<p>I am new to VBA but really having fun. What I wanna do is,if cell E15 has a value bigger than 0 program should copy range J15:AL15. Basically it needs to repeat same action for each cell in range E15:E46. If E16 has a value J15:AL16 should be copied and so on.</p>\n\n<p>Below code is what i have so far. It copies only range J15:AL15 even if E16 or E40 has a value. I am seriouslly missing some important point.</p>\n\n<pre><code>Sub Copy_Click()\n\nDim k As Range\nDim j As Range\n\nFor Each k In Range(\"E15:E46\")\n    Set j = Range(\"J15:AL15\")\n    If k &gt; 0 Then\n      j.Copy\n    End If\nNext k\n\nEnd Sub\n</code></pre>\n\n<p>I feel like something is wrong with variable j but could not find a way to define it.</p>\n"}, {"tags": ["vba", "find", "instr"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1567005903, "post_id": 57695649, "comment_id": 101835529, "body": "Have you tried vbLf ?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006484, "post_id": 57695845, "comment_id": 101835896, "body": "<code>vbCrLf</code> is <code>Chr$(10)</code> &amp; <code>Chr$(13)</code> though. OP was just not looking for the right thing"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006562, "post_id": 57695845, "comment_id": 101835952, "body": "@MathieuGuindon oooh while your here.... isn&#39;t Chr$(10) newline? So are you saying Chr$(10) &amp; Chr$(13) is equivalent to \\n ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006669, "post_id": 57695845, "comment_id": 101836004, "body": "<code>vbNewLine</code> is <code>vbCrLf</code> (on Windows); <code>Chr(10)</code> is <code>vbLf</code>, and <code>Chr(13)</code> is <code>vbCr</code> ;-)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006715, "post_id": 57695845, "comment_id": 101836027, "body": "@MathieuGuindon so \\n is chr$(10) ? - that was what I was focusing on. I completely missed the other part. :-("}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1567006892, "post_id": 57695845, "comment_id": 101836133, "body": "<a href=\"https://stackoverflow.com/a/1761086/1188513\">this</a> explains it better than I could in a comment - <code>\\r</code> would be the &quot;carriage return&quot;, i.e. <code>vbCr</code> so <code>Chr(13)</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1567006997, "post_id": 57695845, "comment_id": 101836193, "body": "for future ref you can check an <a href=\"https://www.asciitable.xyz/images/ascii-table.png\" rel=\"nofollow noreferrer\">ascii table</a> to see what each <code>Chr(dec)</code> represents"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1567007016, "last_edit_date": 1567007016, "creation_date": 1567006406, "answer_id": 57695845, "question_id": 57695649, "link": "https://stackoverflow.com/questions/57695649/instr-vba-function-cant-find-vbcrlf/57695845#57695845", "title": "InStr (VBA function) can&#39;t find vbCrLf", "body": "<p>Thanks to @Mathieu Guindon for noticing OP was looking for wrong character.</p>\n\n<p>I was looking at your '\\n' and jumped to an alternative I like to use which is the Chr code</p>\n\n<pre><code>InStr(text, chr$(10))\n</code></pre>\n\n<p><a href=\"https://www.petefreitag.com/item/863.cfm\" rel=\"nofollow noreferrer\">Quote:</a></p>\n\n<blockquote>\n  <p>The ASCII character code 10 is sometimes written as \\n and it is\n  sometimes called a New Line or NL. ASCII character 10 is also called a\n  Line Feed or LF</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 11989629, "user_type": "registered", "profile_image": "https://graph.facebook.com/2798038683600258/picture?type=large", "display_name": "Manoel Gumes", "link": "https://stackoverflow.com/users/11989629/manoel-gumes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567007016, "creation_date": 1567005686, "last_edit_date": 1567005819, "question_id": 57695649, "link": "https://stackoverflow.com/questions/57695649/instr-vba-function-cant-find-vbcrlf", "title": "InStr (VBA function) can&#39;t find vbCrLf", "body": "<p>I would like to get a string up to the newline. For this I am trying to use InStr(text, vbCrLf), but the function returns 0. MsgBox displays the text considering the line jump. Why it returns 0?</p>\n\n<p>' VBA</p>\n\n<pre><code>InStr(text, \"/r\") ' returns 0\nInStr(text, \"/n\") ' returns 0\nInStr(text, vbCrLf) ' returns 0\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1567007895, "post_id": 57695508, "comment_id": 101836669, "body": "But aren&#39;t you trying to get all references from tblA in order to set the reference? Surely you need &quot;SELECT DISTINCT TblA.Reference, TblA.OriginalAmount FROM TblA&quot;"}, {"owner": {"reputation": 347, "user_id": 2583190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c11255d60c36bb219cd269251a0c3cac?s=128&d=identicon&r=PG", "display_name": "New2Programming", "link": "https://stackoverflow.com/users/2583190/new2programming"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1567008890, "post_id": 57695508, "comment_id": 101837176, "body": "only the references that match table b because there can be many of the same reference in tblA and this is why i am using the amount."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 2583190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c11255d60c36bb219cd269251a0c3cac?s=128&d=identicon&r=PG", "display_name": "New2Programming", "link": "https://stackoverflow.com/users/2583190/new2programming"}, "edited": false, "score": 0, "creation_date": 1567064150, "post_id": 57696557, "comment_id": 101853014, "body": "Thanks but the user will need to specify the amount as there is no distinct/unique reference (many to many relationship). Currently the subform will show all the records from TblB and has a combobox in the last row of Tbla data (datasheet view) I have the column count to 2 so the user can see the reference and amount but I don&#39;t want the selection to every reference only the one that relates to the currentrow)."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 347, "user_id": 2583190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c11255d60c36bb219cd269251a0c3cac?s=128&d=identicon&r=PG", "display_name": "New2Programming", "link": "https://stackoverflow.com/users/2583190/new2programming"}, "edited": false, "score": 0, "creation_date": 1567092993, "post_id": 57696557, "comment_id": 101869238, "body": "Ok, I think I see. Your problem is &quot;Data Sheet View&quot;. This view needs to be hidden from the user facing version. You must construct proper forms for your users. You can make a form that prominently displays a data grid, which is the view that people may want. I tried your example with my data and it works. The query returns the expected list. Have you put it in to a query and just viewed it? Then you can simply cite the query name in any element where you want that list to appear."}, {"owner": {"reputation": 347, "user_id": 2583190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c11255d60c36bb219cd269251a0c3cac?s=128&d=identicon&r=PG", "display_name": "New2Programming", "link": "https://stackoverflow.com/users/2583190/new2programming"}, "edited": false, "score": 0, "creation_date": 1567153052, "post_id": 57696557, "comment_id": 101886661, "body": "Sorry not sure how to create a data grid, I have since made TblB as a subform and added an unbound to a Mainform with a hidden unbound textbox using     =[TblB_SF].[Form]![Reference] but I don&#39;t know how to get the unbound combobox on my subform to call the textbox. I will look into trying to make a datagrid so I can try your way, please bear with me. thanks. I can add a simple dropbox file of what I&#39;m trying to achieve."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 1, "last_activity_date": 1567009304, "creation_date": 1567009304, "answer_id": 57696557, "question_id": 57695508, "link": "https://stackoverflow.com/questions/57695508/ms-access-forms-datasheet-to-populate-all-matching-records-in-a-dropdown-from-an/57696557#57696557", "title": "MS Access Forms datasheet to populate all matching records in a dropdown from another table", "body": "<p>I think I know what you are asking. First, you need to get the selected Reference number to work with. The easiest way to do that is to add a textbox to your form that contains the Reference (<code>Control Source = Reference</code>) and let's name that textbox \"CurrentReference\".\nYou can hide this textbox if you don't want the user to see it.</p>\n\n<p>Now simply add a where clause to your SQL:</p>\n\n<pre><code>SELECT DISTINCT TblA.Reference, TblA.OriginalAmount\nFROM TblA WHERE TblA.Reference = CurrentReference\n</code></pre>\n\n<p>Now change your combobox <code>Enabled = False</code> so the user can't manually manipulate it.  The combobox now only shows the original amount that corresponds to the selected record in TblB.</p>\n\n<p>NOTE: Now that you are displaying only one value, you can use a TextBox and not a ComboBox.</p>\n"}, {"tags": [], "owner": {"reputation": 347, "user_id": 2583190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c11255d60c36bb219cd269251a0c3cac?s=128&d=identicon&r=PG", "display_name": "New2Programming", "link": "https://stackoverflow.com/users/2583190/new2programming"}, "is_accepted": true, "score": 1, "last_activity_date": 1567409273, "creation_date": 1567409273, "answer_id": 57752919, "question_id": 57695508, "link": "https://stackoverflow.com/questions/57695508/ms-access-forms-datasheet-to-populate-all-matching-records-in-a-dropdown-from-an/57752919#57752919", "title": "MS Access Forms datasheet to populate all matching records in a dropdown from another table", "body": "<p>I managed to get this working but it is a bit ugly, I have used 2 subforms within a mainform added a textbox on my mainform to capture what is selected from the subform (TblB) also doing the same for TblA. On the second subform (TblA data) I manually typed the reference into the Link Master/Child fields. Finally I then added an update query to update TblA with TblB data. Hope this can help someone else.</p>\n"}], "owner": {"reputation": 347, "user_id": 2583190, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c11255d60c36bb219cd269251a0c3cac?s=128&d=identicon&r=PG", "display_name": "New2Programming", "link": "https://stackoverflow.com/users/2583190/new2programming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 57752919, "answer_count": 2, "score": 0, "last_activity_date": 1567409273, "creation_date": 1567005186, "last_edit_date": 1567015042, "question_id": 57695508, "link": "https://stackoverflow.com/questions/57695508/ms-access-forms-datasheet-to-populate-all-matching-records-in-a-dropdown-from-an", "title": "MS Access Forms datasheet to populate all matching records in a dropdown from another table", "body": "<p>I am using MS Access 2013 forms.</p>\n\n<p>I have 2 tables: <code>TblA</code> and <code>TblB</code>.</p>\n\n<p>Both have multiple references and values and what I am trying to do is have a datasheet of <code>TblB</code> and have a combobox on the same datasheet which will show the field <code>OrigAmt</code> from <code>TblA</code> that matches <code>TblB</code>.</p>\n\n<p>The purpose of this is because there is no link between the tables other than the reference the user will need to see all values so they can select the value that is in <code>TblA</code> that relates to that record and then <code>TblA</code> will update with values from <code>TblB</code>.</p>\n\n<p>I tried using the lookup field on rowsource from the design where the reference from <code>TblA</code> equals <code>TblB</code> but the datasheet doesn't seem to filter on a row level.</p>\n\n<pre><code>SELECT DISTINCT TblA.Reference, TblA.OriginalAmount\nFROM TblA INNER JOIN TblB ON TblA.Reference = TblB.Reference\n</code></pre>\n\n<p>I'm sure this has probably been answered before but I cant seem to work this out after spending hours on this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567004708, "post_id": 57695285, "comment_id": 101834812, "body": "<code>Destination:=ws.Range(&quot;A:A&quot;)</code> you need to be explicit abut <i>every</i> range you use, or it defaults to the activesheet.  That can cause problems once you start to chain different procedures together.  If that&#39;s not the issue then it would help to explain exactly how it &quot;doesn&#39;t work&quot; - do you see an error or ???"}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567005181, "post_id": 57695285, "comment_id": 101835091, "body": "@TimWilliams thanks for the suggestion! Now, when I run the sub (by itself) on another sheet it works however when I run it through the button it still doesn&#39;t work."}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567006299, "post_id": 57695285, "comment_id": 101835782, "body": "@TimWilliams sorry, I should have been clearer! When I meant not work, I meant that it does not split the text into separate columns. It also does not give any errors."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567005436, "post_id": 57695451, "comment_id": 101835249, "body": "thanks for the suggestion! I tried this and while this lets me run the sub (by itself) on another sheet, it doesn&#39;t work through the button."}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567005630, "post_id": 57695451, "comment_id": 101835367, "body": "When you debugged the function step by step, did you discovered in which function the code fail to run?"}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567005692, "post_id": 57695451, "comment_id": 101835410, "body": "the code failed to run in the sub where the code is split, formatUSDAWeekly"}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567005927, "post_id": 57695451, "comment_id": 101835543, "body": "when I ran the start sub step by step, it worked! Yet, when I click the button formatUSDAWeekly did not work, i.e. did not split the columns"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567006314, "post_id": 57695451, "comment_id": 101835795, "body": "@court_k look for <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit ActiveSheet references</a>, and possibly <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveWorkbookReference\" rel=\"nofollow noreferrer\">implicit ActiveWorkbook references</a> too - &quot;code works when I step through, but not when I don&#39;t&quot; is 99.999% caused by this (i.e. you have a different sheet active when you&#39;re debugging than when you&#39;re not, and code that&#39;s implicitly referring to the ActiveSheet <i>somewhere</i>)."}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006766, "post_id": 57695451, "comment_id": 101836060, "body": "@MathieuGuindon thanks for the links! I have changed my code to include a with statement (I added it the question above), however it still does not work... I&#39;ll keep trying to find the implicit reference though!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567007152, "post_id": 57695451, "comment_id": 101836282, "body": "@court_k I should have mentioned, these links point to a website I own - &quot;Rubberduck&quot; is actually a VBE add-in (free &amp; open-source), and these inspections are features: the add-in can hunt down the implicit references for you!"}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567007285, "post_id": 57695451, "comment_id": 101836352, "body": "@MathieuGuindon it worked!!! :) Thanks for all the help! I&#39;ll definitely take a look at those add-ins!"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 1, "last_activity_date": 1567007165, "last_edit_date": 1567007165, "creation_date": 1567005017, "answer_id": 57695451, "question_id": 57695285, "link": "https://stackoverflow.com/questions/57695285/splitting-columns-doesnt-work-with-button/57695451#57695451", "title": "Splitting columns doesn&#39;t work with button", "body": "<p>The reason is probably due to the change of <code>activeSheet</code> made by the call to <code>pullFrom610()</code> when you click the button.</p>\n\n<p>To solve this, make an explicit call to your <code>Destination</code> Range in <code>Sub formatUSDAWeekly</code>.</p>\n\n<h2> Edit: </h2>\n\n<p>As suggested by @RonRosenfeld, there was a second problem with the query not finishing it's job in time. The solution to this is to put <code>.BackgroundQuery = False</code>. The final code will look like this:</p>\n\n<pre><code>Sub pullFrom610()\n'this code was taken from Seamus Abshere\n'on SO:https://stackoverflow.com/questions/158633/how-can-i-send-an-http-post-request-to-a-server-from-excel-using-vba\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"USDA Weekly\")\n\nws.Columns(\"A:F\").ClearContents 'clears the previous information\n\nWith ws.QueryTables.Add(Connection:=\"URL;https://www.ams.usda.gov/mnreports/lm_pk610.txt\", Destination:=ws.Range(\"A1\"))\n\n    .BackgroundQuery = False\n    .RefreshStyle = xlOverwriteCells\n    .Refresh\n    .SaveData = True\n\nEnd With\n\nEnd Sub\n\nSub formatUSDAWeekly()\n'this sub pulls information from strictly within the workbook\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook 'sets wb to the workbook that contains the code (i.e. this workbook)\n\nSet ws = wb.Sheets(\"USDA Weekly\")\n\nws.Range(\"A:A\").TextToColumns Destination:=ws.Range(\"A:A\"), DataType:=xlFixedWidth, _\n        FieldInfo:=Array(Array(0, 1), Array(39, 1), Array(50, 1), Array(52, 1), Array(61, 1), _\n        Array(73, 1)), TrailingMinusNumbers:=True\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006820, "post_id": 57695931, "comment_id": 101836096, "body": "Ha, totally missed that!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1567006993, "post_id": 57695931, "comment_id": 101836190, "body": "@MathieuGuindon I had a similar problem a few weeks ago, and spent some time troubleshooting."}, {"owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567007131, "post_id": 57695931, "comment_id": 101836271, "body": "@RonRosenfeld ooh! That might be it. I&#39;m not going to lie, this is little beyond the scope of my knowledge. When would I disable the background refresh?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "edited": false, "score": 0, "creation_date": 1567007219, "post_id": 57695931, "comment_id": 101836312, "body": "@court_k anywhere before the <code>.Refresh</code> member call in the <code>With ws.QueryTables.Add(...)</code> block"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1567007884, "post_id": 57695931, "comment_id": 101836664, "body": "++ Good Catch :)"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 3, "last_activity_date": 1567006858, "last_edit_date": 1567006858, "creation_date": 1567006767, "answer_id": 57695931, "question_id": 57695285, "link": "https://stackoverflow.com/questions/57695285/splitting-columns-doesnt-work-with-button/57695931#57695931", "title": "Splitting columns doesn&#39;t work with button", "body": "<p>Although there may be a problem with Active Sheet implicit references (and those should be corrected), most likely the problem is that the Query is not finishing before <code>formatUSDAWeekly</code> is being called.</p>\n\n<p>There are a variety of possible solutions to this problem including:</p>\n\n<ul>\n<li>disable <code>Background Refresh</code>  <code>.BackgroundQuery = False</code></li>\n<li>use <code>DoEvents</code> after the query, but this doesn't always work</li>\n<li>use <code>.RefreshAll</code> with a blank query after <code>pullFrom610</code> that is named something like <code>zzzzzz</code> so it runs last (the queries refresh in alphabetical order)</li>\n</ul>\n"}], "owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 57695451, "answer_count": 2, "score": 1, "last_activity_date": 1567007165, "creation_date": 1567004422, "last_edit_date": 1567006929, "question_id": 57695285, "link": "https://stackoverflow.com/questions/57695285/splitting-columns-doesnt-work-with-button", "title": "Splitting columns doesn&#39;t work with button", "body": "<p>For work, I have to pull various information from a USDA report. I have created a sub that will pull the information I need from a text file, into a worksheet \"USDA Weekly.\" I created another sub, using the recorder, that uses text to column to split the information (via fixed width). The sub that does the splitting is the only sub that changes the information on the \"USDA Weekly\" sheet in any way. All other subs pull information from this sheet. </p>\n\n<p>I have a button on another worksheet (in the same workbook) that runs all the subs I have created for the report I have to do, including the two subs mentioned. Now, when I run sub to split the information it works perfectly however when I click the button to run all the subs including the splitter it doesn't work. </p>\n\n<p>I have run this in the debugger step by step numerous times, in an attempt to figure out why this is happening with no luck. I'm mostly confused as to why it the sub doesn't work when the button is clicked, yet works when run by itself. Any tips as to why this isn't working is appreciated. </p>\n\n<p>Edit: clarification on how this doesn't work. When the splitting sub is run through the button, it does not split the column at all, as shown below. No errors, or anything pop-up. </p>\n\n<p><a href=\"https://i.stack.imgur.com/OkJNk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OkJNk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit Edit: as per Mathieu Guindon (implict) suggestion I have modified formatUSDAWeekly to use a with statement to avoid implicit references.</p>\n\n<pre><code>Sub formatUSDAWeekly()\n'this sub pulls information from strictly within the workbook\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook 'sets wb to the workbook that contains the code (i.e. this workbook)\n\nSet ws = wb.Sheets(\"USDA Weekly\")\n\nWith ws\n\n    .Range(\"A:A\").TextToColumns Destination:=.Range(\"A:A\"), DataType:=xlFixedWidth, _\n        FieldInfo:=Array(Array(0, 1), Array(39, 1), Array(50, 1), Array(52, 1), Array(61, 1), _\n        Array(73, 1)), TrailingMinusNumbers:=True\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This is the sub for the button</p>\n\n<pre><code>Sub start()\n\nCall pullFrom610\nCall formatUSDAWeekly\nCall formatWIWorkbook\nCall formatOSWorkbook\n\nEnd Sub\n</code></pre>\n\n<p>This is the sub that pulls the information</p>\n\n<pre><code>Sub pullFrom610()\n'this code was taken from Seamus Abshere\n'on SO:https://stackoverflow.com/questions/158633/how-can-i-send-an-http-post-request-to-a-server-from-excel-using-vba\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"USDA Weekly\")\n\nws.Columns(\"A:F\").ClearContents 'clears the previous information\n\nWith ws.QueryTables.Add(Connection:=\"URL;https://www.ams.usda.gov/mnreports/lm_pk610.txt\", Destination:=ws.Range(\"A1\"))\n\n    .RefreshStyle = xlOverwriteCells\n    .SaveData = True\n    .Refresh\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This is the sub that splits the information using text to column</p>\n\n<pre><code>Sub formatUSDAWeekly()\n'this sub pulls information from strictly within the workbook\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook 'sets wb to the workbook that contains the code (i.e. this workbook)\n\nSet ws = wb.Sheets(\"USDA Weekly\")\n\nws.Range(\"A:A\").TextToColumns Destination:=Range(\"A:A\"), DataType:=xlFixedWidth, _\n        FieldInfo:=Array(Array(0, 1), Array(39, 1), Array(50, 1), Array(52, 1), Array(61, 1), _\n        Array(73, 1)), TrailingMinusNumbers:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1567025333, "post_id": 57695103, "comment_id": 101843619, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21385438/importing-xls-to-access-mdb-external-table-is-not-in-the-expected-format\">Importing .xls to Access .mdb: External Table is not in the expected format</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1567007441, "creation_date": 1567007441, "answer_id": 57696109, "question_id": 57695103, "link": "https://stackoverflow.com/questions/57695103/docmd-transferspreadsheet-issues/57696109#57696109", "title": "DoCmd.TransferSpreadsheet Issues", "body": "<p>You can try to read an Excel directly from a query:  </p>\n\n<pre><code>SELECT  s.*\nFROM [Sheet1$] s IN '' [Excel 12.0 Xml;HDR=YES;IMEX=2;ACCDB=YES;DATABASE=@sourceFile]\n</code></pre>\n\n<p>Just replace Sheet1$ by the sheet name with a trailing $,<br>\nand replace @sourcefile by the full file name.  </p>\n\n<p>You can even specify the starting row and col and conditions:  </p>\n\n<pre><code>SELECT  s.*\nFROM [Fees$a10:h10] s IN...\nWHERE [someField] IS NOT NULL\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11989862, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OOiGU_4IM74/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rchoO_yEniL-IxsufY1nWKRInXy7w/photo.jpg?sz=128", "display_name": "Maggie", "link": "https://stackoverflow.com/users/11989862/maggie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594549284, "creation_date": 1567003838, "last_edit_date": 1594549284, "question_id": 57695103, "link": "https://stackoverflow.com/questions/57695103/docmd-transferspreadsheet-issues", "title": "DoCmd.TransferSpreadsheet Issues", "body": "<p>I'm having issues importing a specific set of Excel workbooks to a table in Access through VBA using <code>DoCmd.TransferSpreadsheet acImport, 8, TableInput, FilePathName, True</code></p>\n\n<p>One thing that works is when I open each workbook and re-save them, then the code works, not sure what could be the issue. The file type shows that the workbook is 97-2003, so I use value 8 but that still gives the run time error 3274 unless I do the above. And the code doesn't have issues with other excel file sets. I also don't see any differences between files when using the Document Inspector.</p>\n\n<p>Note, the excel files I'm using are provided by third party companies. Thanks for your help!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1567004648, "last_edit_date": 1567004648, "creation_date": 1567004252, "answer_id": 57695226, "question_id": 57694982, "link": "https://stackoverflow.com/questions/57694982/365-office-runtime-1004-debuging/57695226#57695226", "title": "365 office runtime 1004 debuging", "body": "<blockquote>\n<pre><code>Set tableData = tables.Range(Cells(2, tabelaDataColumn), Cells(tabelaDataLastRow, tabelaDataColumn + 4))\n</code></pre>\n</blockquote>\n\n<p>That code will work perfectly fine... as long as <code>ThisWorkbook.Sheets(\"tranlsate_Table\")</code> (with that typo) is the <code>ActiveSheet</code>.</p>\n\n<p>If the <code>tables</code> worksheet isn't active, then the unqualified <code>Cells</code> member calls are going against <code>Global</code>, and forwarded to whatever the <code>ActiveSheet</code> is.</p>\n\n<p>And since a <code>Range</code> knows what sheet it's in (through its <code>Parent</code> property), then...</p>\n\n<pre><code>Sheet1.Range(Sheet2.Cells(1, 1), Sheet2.Cells(10, 10))\n</code></pre>\n\n<p>...isn't something Excel can resolve :)</p>\n\n<p>Just qualify the <code>Cells</code> member calls with the <code>Worksheet</code> object you mean to work with.</p>\n\n<pre><code>Set tableData = tables.Range(tables.Cells(2, tabelaDataColumn), tables.Cells(tabelaDataLastRow, tabelaDataColumn + 4))\n</code></pre>\n\n<p>Note that Rubberduck (an open-source VBE add-in project I manage) can help you locate all such <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit ActiveSheet references</a> in your code.</p>\n"}], "owner": {"reputation": 7, "user_id": 11369292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ihJgp.jpg?s=128&g=1", "display_name": "Pedro de Carvalho", "link": "https://stackoverflow.com/users/11369292/pedro-de-carvalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 57695226, "answer_count": 1, "score": 0, "last_activity_date": 1586980570, "creation_date": 1567003373, "last_edit_date": 1586980570, "question_id": 57694982, "link": "https://stackoverflow.com/questions/57694982/365-office-runtime-1004-debuging", "title": "365 office runtime 1004 debuging", "body": "<p>When is creating the tableData\n\"run time error 1004 vba \"</p>\n\n<p>Im using 365 office and the code was working perfecty in excel 2013, now it gives me an error in the row of tableData as it is setting the range</p>\n\n<pre><code>Sub SendEmails(ByVal eMailType As String, ByVal SendEmailTo As String, ByVal SendEmailToCC As String)\n    Dim ws_email_templates As Worksheet\n    Dim Email_Send_From, Email_Subject, Email_Body1, Email_Body2 As String\n    Dim emailTypeRow As Long\n    Dim tableData As Range\n\n    ThisWorkbook.Activate\n\n    Set ws_email_templates = ThisWorkbook.Sheets(\"email_templates\")\n    Set tables = ThisWorkbook.Sheets(\"tranlsate_Table\")\n    emailTypeRow = ws_email_templates.Range(\"A1:I1\").Find(eMailType).Column\n\n\n\n    GetEmailBody1 = ws_email_templates.Cells(4, emailTypeRow)\n    GetEmailBody2 = ws_email_templates.Cells(5, emailTypeRow)\n    GetEmailPriority = ws_email_templates.Cells(6, emailTypeRow)\n\n    Email_Send_From = ws_email_templates.Cells(2, emailTypeRow)\n    Email_Subject = ws_email_templates.Cells(3, emailTypeRow)\n\n    If Right(eMailType, 18) = \"contractEnd_noData\" Or Right(eMailType, 17) = \"creditTime_noData\" Then\n        Email_Body = GetEmailBody1\n    Else\n        tabelaDataColumn = tables.Range(\"A1:Z1\").Find(eMailType).Column\n        tabelaDataLastRow = tables.Cells(1000, tabelaDataColumn).End(xlUp).Row\n        'Set tableData = tables.Range(\"V2:Z3\")\n\n        **'error\n        Set tableData = tables.Range(Cells(2, tabelaDataColumn), Cells(tabelaDataLastRow, tabelaDataColumn + 4))**\n\n        Email_Body = GetEmailBody1 &amp; RangetoHTML(tableData) &amp; GetEmailBody2\n    End If\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1567003392, "post_id": 57694917, "comment_id": 101834054, "body": "DoCmd.Close acform, &quot;FORMNAME&quot;"}, {"owner": {"reputation": 45, "user_id": 11963138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d9c0ac0137a506759e44f897096d854?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/11963138/newbie"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1567006126, "post_id": 57694917, "comment_id": 101835671, "body": "Thank you, I added this and it worked perfectly."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1567004556, "creation_date": 1567004556, "answer_id": 57695320, "question_id": 57694917, "link": "https://stackoverflow.com/questions/57694917/require-password-to-open-access-form/57695320#57695320", "title": "Require Password to Open Access Form", "body": "<p>Instead of <code>Load</code>, use the <code>Open</code> event:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n</code></pre>\n\n<p>There you can set <code>Cancel = True</code>, then the form won't be opened.</p>\n\n<p>But note that if you open the form from somewhere else with <code>DoCmd.OpenForm</code>, it will raise an error that you need to trap or ignore.</p>\n\n<hr>\n\n<p>Note that <code>DoCmd.OpenForm \"AddNewRule\"</code> in the success case is wrong, you are already opening the form.</p>\n"}], "owner": {"reputation": 45, "user_id": 11963138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d9c0ac0137a506759e44f897096d854?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/11963138/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 57695320, "answer_count": 1, "score": 0, "last_activity_date": 1567004556, "creation_date": 1567003148, "last_edit_date": 1567004415, "question_id": 57694917, "link": "https://stackoverflow.com/questions/57694917/require-password-to-open-access-form", "title": "Require Password to Open Access Form", "body": "<p>I have a few forms in my Access database that only a few team members should be using I wrote the following to password-protect those forms, but if you enter the wrong password or hit cancel on the pop-up, it will open the form anyway. </p>\n\n<p>How can I prevent Access from loading the form unless you enter the correct password?</p>\n\n<pre><code>Private Sub Form_Load()\n    Dim strInput As String\n    Dim strMsg As String\n\n    Beep\n    strMsg = \"This function requires a password.\" &amp; vbCrLf &amp; vbLf &amp; \"Please see your manager for assistance.\"\n    strInput = InputBox(Prompt:=strMsg, title:=\"Password:\")\n    If strInput = \"administrator\" Then 'password is correct\n        DoCmd.OpenForm \"AddNewRule\"\n    Else 'password is incorrect\n        MsgBox \"Incorrect Password!\" &amp; vbCrLf &amp; vbLf &amp; \"Please see your manager for assistance\", vbCritical, \"Invalid Password\"\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "object", "gmail"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1567003673, "post_id": 57694877, "comment_id": 101834216, "body": "I don&#39;t add attachments that way, (I use <code>Attachments.Add</code>) but I imagine you should be doing the following instead of <i>that</i> line: <code>.AddAttachment = TempFilePath &amp; TempFileName &amp; FileExtStr</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1567004526, "post_id": 57694877, "comment_id": 101834695, "body": "<a href=\"https://devblogs.microsoft.com/scripting/how-can-i-attach-a-file-to-an-email-sent-using-cdo/\" rel=\"nofollow noreferrer\">devblogs.microsoft.com/scripting/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 9723901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33df4591b2be05bb1fd2e54dcc2a1a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Peters", "link": "https://stackoverflow.com/users/9723901/ian-peters"}, "is_accepted": false, "score": 0, "last_activity_date": 1567009639, "creation_date": 1567009639, "answer_id": 57696625, "question_id": 57694877, "link": "https://stackoverflow.com/questions/57694877/how-to-send-email-with-attachment-to-gmail-in-excel/57696625#57696625", "title": "How to send email with attachment to gmail in excel", "body": "<p>You haven't defined msConfigURL anywhere in your code.  Add</p>\n\n<pre><code>msConfigURL = \"http://schemas.microsoft.com/cdo/configuration\"\n</code></pre>\n\n<p>and see what happens.</p>\n"}], "owner": {"reputation": 3, "user_id": 11904356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06057dd2815c3c1b1c751750b661df1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/11904356/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567091906, "creation_date": 1567002996, "last_edit_date": 1567089221, "question_id": 57694877, "link": "https://stackoverflow.com/questions/57694877/how-to-send-email-with-attachment-to-gmail-in-excel", "title": "How to send email with attachment to gmail in excel", "body": "<p>I actually have 2 problems. My first error is \"Object does not support property or method\". Is is the .add attachment line in the code. When I make that a remark it will process fine until the \"NewMail.Configuration = mailConfig\" line where I get a \"runtime error (20)\". I'm just not seeing the problem in the code. </p>\n\n<p>I am not a coder but the closest we have for excel development. This code was originally written for outlook but the email addresses were changed to gmail so I was asked to modify it for gmail. The file creation portion of the code is unchanged. I tried two different borrowed codes for sending emails for gmail. I've tried a few different ways of describing the file name for the add attachment line.  I'm at a loss for the runtime error. I've changed email addresses for obvious reasons.</p>\n\n<pre><code>Sub Mail_workbook_Outlook_2()\n\n    Dim wb1 As Workbook\n    Dim wb2 As Workbook\n    Dim TempFilePath As String\n    Dim TempFileName As String\n    Dim FileExtStr As String\n\n    Set wb1 = ActiveWorkbook\n    If Val(Application.Version) &gt;= 12 Then\n    If wb1.FileFormat = 51 And wb1.HasVBProject = True Then\n        MsgBox \"There is VBA code in this xlsx file. There will\" &amp; vbNewLine &amp; _\n               \"be no VBA code in the file you send. Save the\" &amp; vbNewLine &amp; _\n               \"file as a macro-enabled (. Xlsm) and then retry the macro.\", vbInformation\n        Exit Sub\n    End If\nEnd If\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n' Make a copy of the file.\n' If you want to change the file name then change only TempFileName variable.\nTempFilePath = Environ$(\"temp\") &amp; \"\\\"\nTempFileName = \"Copy of \" &amp; wb1.Name &amp; \" \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\nFileExtStr = \".\" &amp; LCase(Right(wb1.Name, _\n                               Len(wb1.Name) - InStrRev(wb1.Name, \".\", , 1)))\n\nwb1.SaveCopyAs TempFilePath &amp; TempFileName &amp; FileExtStr\nSet wb2 = Workbooks.Open(TempFilePath &amp; TempFileName &amp; FileExtStr)\n\n'On Error GoTo Err\n\nDim NewMail As Object\nDim mailConfig As Object\nDim fields As Variant\nDim msConfigURL As String\n\nSet NewMail = Nothing\nSet mailConfig = Nothing\n\nSet NewMail = CreateObject(\"CDO.Message\")\nSet mailConfig = CreateObject(\"CDO.Configuration\")\n\n' load all default configurations\nmailConfig.Load -1\n\nSet fields = mailConfig.fields\n\n'Set All Email Properties\n\nWith NewMail\n    .Subject = \"QUOTE FORM\"\n    .From = \"123456@gmail.com\"\n    .To = \"123456@gmail.com; 234567@gmail.com; 345678@gmail.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .TextBody = \"\"\n    '.AddAttachment = wb1(\"TempFilePath &amp; TempFileName &amp; FileExtStr\")\nEnd With\n\n\nWith fields\n    'Enable SSL Authentication\n    .Item(msConfigURL &amp; \"/smtpusessl\") = True\n\n    'Make SMTP authentication Enabled=true (1)\n    .Item(msConfigURL &amp; \"/smtpauthenticate\") = 1\n\n    'Set the SMTP server and port Details\n    'To get these details you can get on Settings Page of your Gmail Account\n    .Item(msConfigURL &amp; \"/smtpserver\") = \"smtp.gmail.com\"\n    .Item(msConfigURL &amp; \"/smtpserverport\") = 465\n    .Item(msConfigURL &amp; \"/sendusing\") = 2\n\n    'Set your credentials of your Gmail Account\n    .Item(msConfigURL &amp; \"/sendusername\") = \"12345@gmail.com\"\n    .Item(msConfigURL &amp; \"/sendpassword\") = \"34567\"\n\n    'Update the configuration fields\n    .Update\n\nEnd With\n\n\nNewMail.Configuration = mailConfig\nOn Err GoTo Err2\nErr2:\nResume Next\nNewMail.Send\nMsgBox (\"Mail has been Sent\")\n\nExit_Err:\n\nSet NewMail = Nothing\nSet mailConfig = Nothing\nEnd\n\nErr:\nSelect Case Err.Number\n\nCase -2147220973  'Could be because of Internet Connection\n    MsgBox \" Could be no Internet Connection !!  -- \" &amp; Err.Description\n\nCase -2147220975  'Incorrect credentials User ID or password\n    MsgBox \"Incorrect Credentials !!  -- \" &amp; Err.Description\n\nCase Else   'Rest other errors\n    MsgBox \"Error occured while sending the email !!  -- \" &amp; \nErr.Description\nEnd Select\n\nResume Exit_Err\n\n\nwb2.Close SaveChanges:=False\n\n' Delete the file.\nKill TempFilePath &amp; TempFileName &amp; FileExtStr\n\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 2, "creation_date": 1567002438, "post_id": 57694635, "comment_id": 101833488, "body": "You&#39;re looking <code>for</code> a loop. Search <code>for loop vba</code>."}, {"owner": {"reputation": 3, "user_id": 11989763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDYzF0UG7Y14wa4hK5Ih_9sNEfytgTZxi_QRGDP8Q=k-s128", "display_name": "Lataya Elston", "link": "https://stackoverflow.com/users/11989763/lataya-elston"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1567002510, "post_id": 57694635, "comment_id": 101833532, "body": "Yes, I have been researching that and am having issues implementing it.  :("}, {"owner": {"reputation": 3, "user_id": 11989763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDYzF0UG7Y14wa4hK5Ih_9sNEfytgTZxi_QRGDP8Q=k-s128", "display_name": "Lataya Elston", "link": "https://stackoverflow.com/users/11989763/lataya-elston"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1567003493, "post_id": 57694635, "comment_id": 101834111, "body": "@urdearboy I have a spreadsheet that has 3 dependent drop downs and the current VBA code is only working for row 5 and I need to to repeat for rows 6-200 as well."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1567004099, "post_id": 57694635, "comment_id": 101834459, "body": "You don&#39;t need a loop, you can use <code>target.row</code> and <code>target.column</code> to determine if they are in the range you are looking for."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11989763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDYzF0UG7Y14wa4hK5Ih_9sNEfytgTZxi_QRGDP8Q=k-s128", "display_name": "Lataya Elston", "link": "https://stackoverflow.com/users/11989763/lataya-elston"}, "edited": false, "score": 0, "creation_date": 1567007326, "post_id": 57695303, "comment_id": 101836365, "body": "This worked!  Thank you sooooooooo much!! :)  I have accepted your answer, but I am new, so I have less than 15 reputation, so my vote is recorded, but not publicly posted. :)"}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1567004495, "creation_date": 1567004495, "answer_id": 57695303, "question_id": 57694635, "link": "https://stackoverflow.com/questions/57694635/i-need-to-repeat-a-vba-code-for-rows-5-200-and-have-no-idea-how-what-to-do/57695303#57695303", "title": "I need to repeat a VBA code for rows 5-200 and have no idea how what to do", "body": "<p>This will work for columns L and M on rows between 5 and 200. If you need other columns or rows just adjust the <code>If Statements</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Row &gt;= 5 And Target.Row &lt;= 200 Then\n        If Target.Column = 12 Then\n            Range(\"M\" &amp; Target.Row &amp; \":N\" &amp; Target.Row).Value = \"Please Select...\"\n        ElseIf Target.Column = 13 Then\n            Range(\"N\" &amp; Target.Row).Value = \"Please Select...\"\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11989763, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDYzF0UG7Y14wa4hK5Ih_9sNEfytgTZxi_QRGDP8Q=k-s128", "display_name": "Lataya Elston", "link": "https://stackoverflow.com/users/11989763/lataya-elston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57695303, "answer_count": 1, "score": -2, "last_activity_date": 1567004495, "creation_date": 1567002208, "last_edit_date": 1567003321, "question_id": 57694635, "link": "https://stackoverflow.com/questions/57694635/i-need-to-repeat-a-vba-code-for-rows-5-200-and-have-no-idea-how-what-to-do", "title": "I need to repeat a VBA code for rows 5-200 and have no idea how what to do", "body": "<p>I need to repeat a VBA code for rows 5-200 and have no idea how to do it.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$L$5\" Then\n       Range(\"M5:N5\").Value = \"Please Select...\"\n\n    ElseIf Target.Address = \"$M$5\" Then\n       Range(\"N5\").Value = \"Please Select...\"\n\n   End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) \n    If Target.Address = \"$L$5\" Then \n        Range(\"M5:N5\").Value = \"Please Select...\" \n    ElseIf Target.Address = \"$M$5\" Then \n        Range(\"N5\").Value = \"Please Select...\" \n    For i = 1 To 10 \n        Total = Total + iArray(i) \n    Next i \nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567002294, "post_id": 57694474, "comment_id": 101833394, "body": "Why not simply add another box to the form you show where the user can enter the sheet name?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1567002334, "post_id": 57694474, "comment_id": 101833420, "body": "@urdearboy I think the interface (form and code) is in Access, so they won&#39;t be able to use <code>Application.Input</code>..."}, {"owner": {"reputation": 3, "user_id": 11984286, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Q9WWdy11YVk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFfipAFwCVYWIRw-ePmWc_98G9yg/photo.jpg?sz=128", "display_name": "Bryan Stalyn Almachi Analuisa", "link": "https://stackoverflow.com/users/11984286/bryan-stalyn-almachi-analuisa"}, "edited": false, "score": 0, "creation_date": 1567002552, "post_id": 57694474, "comment_id": 101833571, "body": "@undearboy Cindy is correct, all the code is in Access"}, {"owner": {"reputation": 3, "user_id": 11984286, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Q9WWdy11YVk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFfipAFwCVYWIRw-ePmWc_98G9yg/photo.jpg?sz=128", "display_name": "Bryan Stalyn Almachi Analuisa", "link": "https://stackoverflow.com/users/11984286/bryan-stalyn-almachi-analuisa"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567002640, "post_id": 57694474, "comment_id": 101833629, "body": "@Cindy I&#39;m beginner in Access VBA, can u help me with the another box? I would greatly appreciate it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567002700, "post_id": 57694474, "comment_id": 101833662, "body": "Did you not create the form in the screen shot at the top yourself?"}, {"owner": {"reputation": 3, "user_id": 11984286, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Q9WWdy11YVk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFfipAFwCVYWIRw-ePmWc_98G9yg/photo.jpg?sz=128", "display_name": "Bryan Stalyn Almachi Analuisa", "link": "https://stackoverflow.com/users/11984286/bryan-stalyn-almachi-analuisa"}, "edited": false, "score": 0, "creation_date": 1567002994, "post_id": 57694474, "comment_id": 101833847, "body": "I refer to the encoding to capture the selected file sheet in the first form"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1567012804, "post_id": 57694474, "comment_id": 101838774, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17350789/docmd-transferspreadsheet-is-not-recognizing-worksheet-name\">DoCmd.TransferSpreadsheet is not recognizing worksheet name</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1567014332, "creation_date": 1567014332, "answer_id": 57697623, "question_id": 57694474, "link": "https://stackoverflow.com/questions/57694474/how-can-i-select-a-specific-sheet-from-an-excel-file-to-import-into-access/57697623#57697623", "title": "How can I select a specific sheet from an Excel file to import into Access?", "body": "<p>Concatenate user textbox input with $ character in Range argument.</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"MYSTERY_SHOPPER\", fileName, True, Me.tbxSheet &amp; \"$\"\n</code></pre>\n\n<p>If you want to specify range as well as sheet, syntax is:</p>\n\n<p><code>\"SheetName!A1:E10\"</code></p>\n\n<p>Or with range name</p>\n\n<p><code>\"SheetName!MyRange\"</code></p>\n"}], "owner": {"reputation": 3, "user_id": 11984286, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Q9WWdy11YVk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFfipAFwCVYWIRw-ePmWc_98G9yg/photo.jpg?sz=128", "display_name": "Bryan Stalyn Almachi Analuisa", "link": "https://stackoverflow.com/users/11984286/bryan-stalyn-almachi-analuisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57697623, "answer_count": 1, "score": 0, "last_activity_date": 1567022661, "creation_date": 1567001710, "last_edit_date": 1567022661, "question_id": 57694474, "link": "https://stackoverflow.com/questions/57694474/how-can-i-select-a-specific-sheet-from-an-excel-file-to-import-into-access", "title": "How can I select a specific sheet from an Excel file to import into Access?", "body": "<p><a href=\"https://i.stack.imgur.com/NJ4bT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NJ4bT.png\" alt=\"\"></a></p>\n\n<p>In the image I show the interface through which I select the Excel file to import.</p>\n\n<p>It works perfect as long as you enter the name of the sheet in the code:</p>\n\n<p><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"MYSTERY_SHOPPER\", fileName, True, \"Junio-2019!\"</code></p>\n\n<p>However, I would like the user to select the sheet they want to import (perhaps with an inputbox to capture the name of the sheet?) since he should not enter each time and edit that line.</p>\n\n<p>SOLVED - Thaks to @June7</p>\n\n<pre><code>'----------------- BUTTON BROWSE\n\nPrivate Sub btnbuscar_Click()\n\nDim diag2 As Office.FileDialog\nDim Item2 As Variant\n\nSet diag2 = Application.FileDialog(msoFileDialogFilePicker)\ndiag2.AllowMultiSelect = False\ndiag2.Title = \"Choose a Excel file\"\ndiag2.Filters.Clear\ndiag2.Filters.Add \"Excel files\", \"*.xls, *.xlsx\"\nDoCmd.SetWarnings False\n\nIf diag2.Show Then\n    For Each Item2 In diag2.SelectedItems\n        Me.etiquetaarchivo = Item2\n    Next\nEnd If\n\nEnd Sub\n\n\n'---------------- BUTTON IMPORT\n\nPrivate Sub btnimportar_Click()\n\nDim FSO2 As New FileSystemObject\n\nIf Nz(Me.etiquetaarchivo, \"\") = \"\" Then\n    MsgBox \"You don't select a file!\"\n    Exit Sub\nEnd If\n\nIf FSO2.FileExists(Nz(Me.etiquetaarchivo, \"\")) Then\n\n    ExcelImport2.ImportExcelSpreadsheet Me.etiquetaarchivo, FSO2.GetFileName(Me.etiquetaarchivo)\n    DoCmd.SetWarnings False\n\nElse\n    MsgBox \"Not file found!\"\nEnd If\n\n\n'---------------- MODULE\n\nPublic Sub ImportExcelSpreadsheet(fileName As String, tableName As String)\nOn Error GoTo BadFormat\n\nDim Hoja As String\nHoja = inputbox(\"Input the sheet name\")\n    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"MYSTERY_SHOPPER\", fileName, True, Hoja &amp; \"$\"\n    DoCmd.SetWarnings False\n    Exit Sub\n\nBadFormat:\n    MsgBox \"The format isn't correct\"\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1567333849, "creation_date": 1567333849, "answer_id": 57745204, "question_id": 57694142, "link": "https://stackoverflow.com/questions/57694142/outlook-vba-email-from-template-html-format-lost/57745204#57745204", "title": "Outlook VBA email from template - HTML format lost", "body": "<p>I'd suggest checking the list of running add-ins in Outlook. Add-ins may change the body format in the background (in any Outlook's event handler).</p>\n\n<pre><code>Set Mail_Single = Mail_Object.CreateItemFromTemplate(\"K:\\Path\\Product Update.oft\")\nApplication.Wait (Now + #12:00:04 AM#) 'didn't help\n</code></pre>\n\n<p>Also, there is no need to add a delay right after the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.createitemfromtemplate\" rel=\"nofollow noreferrer\">CreateItemFromTemplate</a> call.   </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14373701, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/580f829c2e1ac4e4ebd4f36b5c5b06f8?s=128&d=identicon&r=PG", "display_name": "Volare", "link": "https://stackoverflow.com/users/14373701/volare"}, "is_accepted": false, "score": 0, "last_activity_date": 1601554385, "last_edit_date": 1601554385, "creation_date": 1601553423, "answer_id": 64154910, "question_id": 57694142, "link": "https://stackoverflow.com/questions/57694142/outlook-vba-email-from-template-html-format-lost/64154910#64154910", "title": "Outlook VBA email from template - HTML format lost", "body": "<p>Try this just before .Send:</p>\n<pre><code>.BodyFormat = olFormatHTML 'Probably it will work anyway, but just to be sure.\n.HTMLBody = .HTMLBody 'A stupid assignment, but it works for me.\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5556320, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c38340c5618bc34e2cfed7557ebdb9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/5556320/dr-phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1601554385, "creation_date": 1567000552, "last_edit_date": 1586980603, "question_id": 57694142, "link": "https://stackoverflow.com/questions/57694142/outlook-vba-email-from-template-html-format-lost", "title": "Outlook VBA email from template - HTML format lost", "body": "<p>I am sending emails using VBA with Outlook (Office 365).<br>\nIt's an HTML formatted email, that I have saved as a template (.oft). It's somewhat heavy due to some images (<em>2Mb total</em>)<br>\nMany times it works fine.\nSometimes it just loses the HTML formatting, and sends out a plain text email (<em>same recipient, same template, same sender, same hardware / software</em>).</p>\n\n<p>2 things I have tried, that didn't help.<br>\n1) Slow down the loading of template (<em>application.wait</em>)<br>\n2) Setting the format explicitly as HTML</p>\n\n<pre><code>row = 2\nDo While Sheets(\"invitees\").Cells(row, 1) &lt;&gt; \"\"\n    Email_Send_To = Sheets(\"invitees\").Cells(row, 1)\n    Set Mail_Single = Mail_Object.CreateItemFromTemplate(\"K:\\Path\\Product Update.oft\")\n    Application.Wait (Now + #12:00:04 AM#) 'didn't help\n\nWith Mail_Single\n        .To = Email_Send_To\n        .SentOnBehalfOfName = Email_Send_From\n        .Subject = \"Product Update\"\n        .BodyFormat = olFormatHTML 'didn't help\n        .Send\n    End With\nrow = row + 1\nLoop\n</code></pre>\n\n<p>Update 2 days later:\nI stripped the code down to</p>\n\n<pre><code>Set Mail_Single = Mail_Object.CreateItemFromTemplate(\"K:\\Path\\Product Update.oft\")\nMsgBox (Mail_Single.BodyFormat) 'the output is olFormatHTML as expected\nMail_Single.Close (olSave)\n</code></pre>\n\n<p>In the drafts, my email is consistently text only.</p>\n\n<p>If I take the same outlook template and send it manually, it goes through as HTML (<em>both outlook and gmail render it accurately</em>).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 2, "creation_date": 1566999789, "post_id": 57693776, "comment_id": 101831780, "body": "you&#39;re missing a <code>;</code> after <code>&quot;TEXT&quot;</code> aren&#39;t you? i.e. <code>&quot;TEXT;&quot;</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.QueryTables.Add\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/Excel.QueryTables.Ad&zwnj;&#8203;d</a>"}, {"owner": {"reputation": 244, "user_id": 8374968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8a247d6cd470a099ed330db311e1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "EXIT_FAILURE", "link": "https://stackoverflow.com/users/8374968/exit-failure"}, "reply_to_user": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1567001675, "post_id": 57693776, "comment_id": 101832992, "body": "Ah, you&#39;re right. However that didn&#39;t fix my problem. I after another half hour of searching I found the mistake (see my posting)."}], "answers": [{"comments": [{"owner": {"reputation": 244, "user_id": 8374968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8a247d6cd470a099ed330db311e1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "EXIT_FAILURE", "link": "https://stackoverflow.com/users/8374968/exit-failure"}, "edited": false, "score": 0, "creation_date": 1567002688, "post_id": 57694445, "comment_id": 101833653, "body": "Thanks you for you explanation. Error handling seems to be a good idea here."}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": true, "score": 1, "last_activity_date": 1567002324, "last_edit_date": 1567002324, "creation_date": 1567001616, "answer_id": 57694445, "question_id": 57693776, "link": "https://stackoverflow.com/questions/57693776/vba-excel-wont-copy-data-to-sheets/57694445#57694445", "title": "VBA Excel won&#39;t copy data to sheets", "body": "<p>I changed your setup and used the <code>Refresh</code> function. See below. I also added the semicolon to the <code>Connection</code> string.</p>\n\n<blockquote>\n  <p>The Refresh method causes Microsoft Excel to connect to the data source of the QueryTable object, execute the SQL query, and return data to the range that is based on the QueryTable object. <strong>Unless this method is called, the QueryTable object doesn't communicate with the data source.</strong></p>\n</blockquote>\n\n<p>Therefore, the connection exists but it has not yet attempted to open connection.</p>\n\n<p>Also, this method can fail. If you had left the code without the <code>\"TEXT;\"</code>, you may have received an error. Just something to think about. You may want to do some error handling around it.</p>\n\n<blockquote>\n  <p>After the database connection is made, the SQL query is validated. If the query isn't valid, the Refresh method fails with the SQL Syntax Error exception.</p>\n</blockquote>\n\n<pre><code>With Sheets(outputSheet).QueryTables.Add(Connection:=\"TEXT;\" &amp; fileName, Destination:=Sheets(outputSheet).Range(\"$A$1\"))\n    .CommandType = 0\n    .RefreshPeriod = 0\n    .Name = outputSheet\n    .FieldName = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .Refresh BackgroundQuery:=True      ' This is the step I changed.\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePlatform = 65001\n    .TextFilePromptOnRefresh = False\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileConsecutiveDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileTrailingMinusNumbers = True\n    .PreserveColumnInfo = True\n    .PreserveColumnInfo = True\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 244, "user_id": 8374968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8a247d6cd470a099ed330db311e1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "EXIT_FAILURE", "link": "https://stackoverflow.com/users/8374968/exit-failure"}, "is_accepted": false, "score": 0, "last_activity_date": 1567002004, "creation_date": 1567002004, "answer_id": 57694568, "question_id": 57693776, "link": "https://stackoverflow.com/questions/57693776/vba-excel-wont-copy-data-to-sheets/57694568#57694568", "title": "VBA Excel won&#39;t copy data to sheets", "body": "<p>After Semicolon to <code>\"TEXT\"</code> (thanks GibralterTop)</p>\n\n<pre><code>With Sheets(outputSheet).QueryTables.Add(Connection:=\"TEXT;\" + fileName, Destination:=Sheets(outputSheet).Range(\"$A$1\"))\n</code></pre>\n\n<p>and adding </p>\n\n<pre><code>.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>right before the end of the <code>with</code>-section my problem seems to be fixed. Since I'm brand new to VBA maybe someone can enlighten me the the exact error was.</p>\n"}], "owner": {"reputation": 244, "user_id": 8374968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8a247d6cd470a099ed330db311e1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "EXIT_FAILURE", "link": "https://stackoverflow.com/users/8374968/exit-failure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 57694445, "answer_count": 2, "score": 2, "last_activity_date": 1567002324, "creation_date": 1566999419, "question_id": 57693776, "link": "https://stackoverflow.com/questions/57693776/vba-excel-wont-copy-data-to-sheets", "title": "VBA Excel won&#39;t copy data to sheets", "body": "<p>I'm trying to copy the data from a hand full of CSV files into separate sheets of an excel file. I want to create one sheet per CSV file and I would like to delete the sheets if they are already present before copying over the new data (this Part seems to work fine).</p>\n\n<p>Unfortunately my script doesn't seem to copy the data. The script runs without giving me an error but there still is no data in the respective tables.\nLeaving out the last bit that deletes the established connection doesn't change anything.</p>\n\n<p>Thank you so much in advance.</p>\n\n<p>The sheet \"import\" looks like this:</p>\n\n<pre><code>ColumnA           ColumnB\nfile_name         sheet_name\n\n&lt;pathTo&gt;\\1.csv    file_1\n&lt;pathTo&gt;\\2.csv    file_2\n&lt;pathTo&gt;\\3.csv    file_3\n&lt;pathTo&gt;\\4.csv    file_4\n</code></pre>\n\n<p>My Macro looks like this:</p>\n\n<pre><code>Sub AddAllFiles()\n    Dim inputRow As Integer\n    For inputRow = 3 To 20\n        Dim fileName As String\n        Dim outputSheet As String\n\n        fileName = Sheets(\"import\").Range(\"A\" &amp; inputRow).Value\n        outputSheet = Sheets(\"import\").Range(\"B\" &amp; inputRow).Value\n\n        Dim checkSheetName As String\n        On Error Resume Next\n        checkSheetName = Worksheets(outputSheet).Name\n        If checkSheetName &lt;&gt; \"\" Then\n            Sheets(outputSheet).Delete\n        End If\n        Worksheets.Add.Name = outputSheet\n\n        With Sheets(outputSheet).QueryTables.Add(Connection:=\"TEXT\" &amp; fileName, Destination:=Sheets(outputSheet).Range(\"$A$1\"))\n            .FieldName = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = True\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePlatform = 65001\n            .TextFilePromptOnRefresh = False\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileStartRow = 1\n            .TextFileParseType = xlDelimited\n            .TextFileConsecutiveDelimiter = True\n            .TextFileSemicolonDelimiter = True\n            .TextFileTabDelimiter = False\n            .TextFileCommaDelimiter = False\n            .TextFileSpaceDelimiter = False\n            .TextFileTrailingMinusNumbers = True\n            .PreserveColumnInfo = True\n        End With\n\n        Dim wb_connection As WorkbookConnection\n        For Each wb_connection In ActiveWorkbook.Connections\n            If InStr(fileName, wb_connection) &gt; 0 Then\n                wb_connection.Delete\n            End If\n        Next wb_connection\n\n    Next inputRow\n\n    MsgBox \"Imported CSV Files\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1566999171, "post_id": 57693644, "comment_id": 101831414, "body": "Why not open the other workbook, create the formula manually by point and click and look at the formula syntax? NB: I don&#39;t recommend doing a lookup over a table in an external workbook, it is slow."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1566999198, "post_id": 57693644, "comment_id": 101831422, "body": "You can&#39;t use a named table reference when looking up from another spreadsheet. You can query that table into your spreadsheet or you can use the cell references as an alternative."}, {"owner": {"reputation": 71, "user_id": 10450858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f156a55390caa505e5d2565905d830e?s=128&d=identicon&r=PG&f=1", "display_name": "Repairer", "link": "https://stackoverflow.com/users/10450858/repairer"}, "edited": false, "score": 0, "creation_date": 1566999413, "post_id": 57693644, "comment_id": 101831567, "body": "If I write the formula manually, the formula generated refers the worksheet and not the table, I need to reference the table because while writing VBA, I only have Table and the Column name and not the worksheet name.."}, {"owner": {"reputation": 71, "user_id": 10450858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f156a55390caa505e5d2565905d830e?s=128&d=identicon&r=PG&f=1", "display_name": "Repairer", "link": "https://stackoverflow.com/users/10450858/repairer"}, "edited": false, "score": 0, "creation_date": 1567001453, "post_id": 57693644, "comment_id": 101832851, "body": "Is it possible to write the above vlookup in VBA and try to reference the worksheet name from the table.parent expression? It will still be a vlookup trying to operate on a table of a different workbook. I tried it and I was getting error, not sure about the exact cause of error, still..has anyone tried it?"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1575061433, "creation_date": 1575061433, "answer_id": 59110950, "question_id": 57693644, "link": "https://stackoverflow.com/questions/57693644/vlookup-from-a-table-column-located-on-a-different-workbook/59110950#59110950", "title": "Vlookup from a table, column located on a different workbook", "body": "<ol>\n<li>Use this syntax (with the target workbook open):</li>\n</ol>\n\n<p><code>= VLOOKUP( Lookup_value, 'Target_Workbook_Name'!Table_Name[#Data], Col_index_num, FALSE )</code></p>\n\n<ol start=\"2\">\n<li>It has been tried before, but it would be very slow. However, since you are using VBA suggest working with the <code>ListObject</code> object, instead of trying to replicate the manner in which it is done manually.</li>\n</ol>\n"}], "owner": {"reputation": 71, "user_id": 10450858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f156a55390caa505e5d2565905d830e?s=128&d=identicon&r=PG&f=1", "display_name": "Repairer", "link": "https://stackoverflow.com/users/10450858/repairer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59110950, "answer_count": 1, "score": 0, "last_activity_date": 1578353796, "creation_date": 1566999004, "last_edit_date": 1578353796, "question_id": 57693644, "link": "https://stackoverflow.com/questions/57693644/vlookup-from-a-table-column-located-on-a-different-workbook", "title": "Vlookup from a table, column located on a different workbook", "body": "<ol>\n<li><p>I am trying to do a Vlookup from a table that is located on a different workbook.</p>\n\n<ul>\n<li>From a similar post in this forum I got a working formula\n<code>=VLOOKUP(E37,tblCosts[#All],COLUMN(tblCosts[Jun-17]),FALSE)</code> </li>\n<li>I need to reference the table. How do I append the workbook name in the formula?</li>\n</ul></li>\n<li><p>Once I have this formula working, how would I write it in VBA, reading the table name and the column name from cell values?</p></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 2, "creation_date": 1566998973, "post_id": 57693553, "comment_id": 101831261, "body": "Welcome to SO. There is no such thing as <code>ie.document.getElementsid</code>. The method you&#39;re looking for is probably <code>ie.document.getElementByID()</code>. This method returns one single item and not a collection of items, so no need to refer to <code>.item(0)</code>."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1566999349, "post_id": 57693553, "comment_id": 101831536, "body": "Also from what I can see in the HTML snippet you provided, &quot;mesaj_baslik&quot; is a name of a Class and not the Name attribute of some element. So maybe you should be using  <code>ie.document.getElementsByClassName(&quot;formlar_mesajyaz&quot;)</code> instead."}, {"owner": {"reputation": 11, "user_id": 9572560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b41550c67307e4b9e0a26409dd8137?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9572560/ahmet"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567003451, "post_id": 57693553, "comment_id": 101834090, "body": "Thanks for the answers. But it doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9572560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b41550c67307e4b9e0a26409dd8137?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9572560/ahmet"}, "edited": false, "score": 0, "creation_date": 1567077344, "post_id": 57706970, "comment_id": 101859947, "body": "When I use these codes, it doesn&#39;t write anything in that field. excel did not give error warning."}, {"owner": {"reputation": 11, "user_id": 9572560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b41550c67307e4b9e0a26409dd8137?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9572560/ahmet"}, "edited": false, "score": 0, "creation_date": 1567077864, "post_id": 57706970, "comment_id": 101860279, "body": "Passed to the following code without writing anything.    ieDocument.getElementById(&quot;mesaj_icerik&quot;).Value = &quot;TEST&quot; &lt;--- Dont  write and excel did not give error warning      ie.document.getElementsByName(&quot;mesaj_baslik&quot;).Item(0).Value = Cells(i, 1)"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 11, "user_id": 9572560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b41550c67307e4b9e0a26409dd8137?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9572560/ahmet"}, "edited": false, "score": 0, "creation_date": 1567080612, "post_id": 57706970, "comment_id": 101861864, "body": "@Ahmet there was a typo in my answer it&#39;s <code>ie.document</code> not <code>ieDocument</code>."}, {"owner": {"reputation": 11, "user_id": 9572560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b41550c67307e4b9e0a26409dd8137?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9572560/ahmet"}, "edited": false, "score": 0, "creation_date": 1567081613, "post_id": 57706970, "comment_id": 101862400, "body": "Stavros Jon thanks . I tried again.  But nothing changed: No error message ve data not transferred"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1567080438, "last_edit_date": 1567080438, "creation_date": 1567070373, "answer_id": 57706970, "question_id": 57693553, "link": "https://stackoverflow.com/questions/57693553/error-entering-data-into-web-page-with-excel/57706970#57706970", "title": "Error entering data into web page with Excel", "body": "<p>As I said in my comments, there are several issues with your code, although the overall effort is good.</p>\n\n<p>Firstly, this <code>ie.document.getElementsid(\"mesaj_baslik\")</code> is not a valid method. If what you want is to access a single HTML element with a unique ID, then the method you need to use is <code>ie.Document.getElementById(\"the element's ID\")</code>.</p>\n\n<p>Assuming that what I wrote above is what you were trying to achieve, you have to keep in mind that the <code>.getElementById()</code> method, returns only one single element. </p>\n\n<p>So this <code>ie.Document.getElementById(\"the element's ID\").item(0)</code> would give you an error saying:</p>\n\n<blockquote>\n  <p>Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>Even if all the aforementioned mistakes were corrected, I still don't see any elements with an ID equal to <code>\"mesaj_baslik\"</code>, in the HTML snippet that you have provided. In fact this particular string is nowhere to be found in the HTML.</p>\n\n<p>So even if the method was correct, this <code>ie.Document.getElementById(\"mesaj_baslik\")</code>, would return <code>Nothing</code>.</p>\n\n<p>Secondly, although your usage of the method  <code>ie.document.getElementsByName()</code> is correct, there is no element with a Name attribute being equal to <code>\"formlar_mesajyaz\"</code>, in the HTML snippet you have provided.</p>\n\n<p>In fact this string seems to be a Class name rather than anything else. In this case you would have to use this method: <code>ie.document.getElementsByClassName()</code>.</p>\n\n<p>Now, from the info you have provided, the best I can do is assume that, what you want to do is enter some text in the <code>textArea</code> element. To do that, you can use the element's ID like so:</p>\n\n<pre><code>ie.Document.getElementById(\"mesaj_icerik\").Value = \"TEST\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9572560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b41550c67307e4b9e0a26409dd8137?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9572560/ahmet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567612162, "creation_date": 1566998729, "last_edit_date": 1567081357, "question_id": 57693553, "link": "https://stackoverflow.com/questions/57693553/error-entering-data-into-web-page-with-excel", "title": "Error entering data into web page with Excel", "body": "<p>I want to enter data into a web page field.\nThere are 2 data entry fields on the web page.\nI entered data in the first section.\nHowever, I cannot enter data in the other field.</p>\n\n<p>Information you need to review the site : </p>\n\n<p>Site : <a href=\"http://splan.byethost7.com/mesaj_yaz.php?fno=1&amp;kip=yeni\" rel=\"nofollow noreferrer\">http://splan.byethost7.com/mesaj_yaz.php?fno=1&amp;kip=yeni</a>  </p>\n\n<p>user :kurucu password :a11111</p>\n\n<p>I entered the data in the \"BA\u015eLIK\" field.\nHowever I am unable to write data to the field named \"\u0130\u00c7ER\u0130K\"</p>\n\n<p>I want to enter data in this field using an Excel macro. But I can't enter data using the code:</p>\n\n<pre><code>  Sub deneme()\n    Dim URL As String\n    On Error Resume Next\n    URL = \"http://splan.byethost7.com/mesaj_yaz.php?fno=1&amp;kip=yeni\"\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = 1\n\n    For i = 1 To Range(\"A\" &amp; Rows.Count).End(3).row\n        If Cells(i, 1) &lt;&gt; Empty Then\n            ie.navigate URL\n\n            Call bekle\n\n\n\n  ie.Document.getElementById(\"mesaj_icerik\").Value = \"TEST\"\n\n  ie.document.getElementsByName(\"mesaj_baslik\").Item(0).Value = Cells(i, 1)\n\n 'IE.Document.getElementsByClassName(\"submitButton\")(0).Click\n\n              Call bekle\n\n        End If\n    Next i\n   ' IE.Quit\n    Set ie = Nothing\nEnd Sub\n\nSub bekle()\n    With ie\n        Do Until .readyState = 4: DoEvents: Loop\n        Do While .Busy: DoEvents: Loop\n    End With\n    Application.Wait (Now + TimeValue(\"00:00:02\"))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1566998244, "post_id": 57693294, "comment_id": 101830811, "body": "Look at the <code>Mid$</code> function."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1566998608, "post_id": 57693294, "comment_id": 101831035, "body": "Man I can&#39;t believe how many people are on the <code>VBA</code> tag just ready to help! Which is awesome :)"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1567023515, "post_id": 57693294, "comment_id": 101842934, "body": "We all use VBA at work."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1567777176, "post_id": 57693294, "comment_id": 102076371, "body": "@Felix Can I have any feedbacks on my <a href=\"https://stackoverflow.com/a/57693429/11167163\">Answer</a> . At Least if your issue is solved, May I ask you to Accept the Answer ? <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">Click here to see How to Accept</a>  Kindest Regards"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568026966, "post_id": 57693294, "comment_id": 102131706, "body": "@Felix If this issue is solved May I ask you to accept one answer? Click <a href=\"https://meta.stackexchange.com/a/5235\">here to see how to accept</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1566998394, "post_id": 57693378, "comment_id": 101830901, "body": "Why don&#39;t you wrap this in a <code>For</code> loop from start of string to <code>Len(str)</code>, and you get a +1 from me"}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 1, "creation_date": 1567001642, "post_id": 57693378, "comment_id": 101832968, "body": "If you have a lot of positions to test, your performance could benefit from taking the string to test, put that in an &#39;character&#39; array (VBA doesn&#39;t gave that type, technically it would be an array of 1-character strings), then test the array element for IsNumeric.This way, you would avoid looping over the string for every position you want to test."}], "tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": false, "score": 1, "last_activity_date": 1566999668, "last_edit_date": 1566999668, "creation_date": 1566998234, "answer_id": 57693378, "question_id": 57693294, "link": "https://stackoverflow.com/questions/57693294/are-numbers-at-specific-position-in-string/57693378#57693378", "title": "Are numbers at specific position in String?", "body": "<p>Use following:</p>\n\n<pre><code>Function IsNumberAtPosition(s As String, pos As Integer) As Boolean\n  IsNumberAtPosition = IsNumeric(Mid(s, pos, 1))\nEnd Function\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>IsNumberAtPosition(\"TestTestTest12\", 13)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 2, "creation_date": 1566998530, "post_id": 57693443, "comment_id": 101830989, "body": "This strikes me as more of a comment then an answer."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1566999133, "post_id": 57693443, "comment_id": 101831388, "body": "It also uses the javascript <code>&#47;&#47;</code> syntax which VB does not have."}, {"owner": {"reputation": 29, "user_id": 11087621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xB049.jpg?s=128&g=1", "display_name": "Christian Tsivkov", "link": "https://stackoverflow.com/users/11087621/christian-tsivkov"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1567434788, "post_id": 57693443, "comment_id": 101953594, "body": "@GSerg lol as if you cannot see how this the \\d+ expression is represented in VB. Sometimes you need to use some search skills, not just copy&amp;paste."}], "tags": [], "owner": {"reputation": 29, "user_id": 11087621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xB049.jpg?s=128&g=1", "display_name": "Christian Tsivkov", "link": "https://stackoverflow.com/users/11087621/christian-tsivkov"}, "is_accepted": false, "score": -1, "last_activity_date": 1566998379, "creation_date": 1566998379, "answer_id": 57693443, "question_id": 57693294, "link": "https://stackoverflow.com/questions/57693294/are-numbers-at-specific-position-in-string/57693443#57693443", "title": "Are numbers at specific position in String?", "body": "<p>Use regex:\n/(\\d+)/g\nmatch and get the positions.</p>\n"}, {"comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "reply_to_user": {"reputation": 11, "user_id": 11808440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-14MjxF48n90/AAAAAAAAAAI/AAAAAAAAA2g/xgVGYDX-OGI/photo.jpg?sz=128", "display_name": "Felix", "link": "https://stackoverflow.com/users/11808440/felix"}, "edited": false, "score": 0, "creation_date": 1566999262, "post_id": 57693463, "comment_id": 101831479, "body": "If it helped, feel free to up-vote. I cast votes more then most, but why not? I up-vote and down-vote at will. I wasn&#39;t sure your use case, maybe this will help, maybe other answers will be better."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1566999292, "post_id": 57693463, "comment_id": 101831496, "body": "I do wonder why you allocate this string array, one element per original character. It does not seem to serve any purpose."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1566999525, "post_id": 57693463, "comment_id": 101831633, "body": "This answer work but this is not the best way .. You will use so much CPU"}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1567003702, "post_id": 57693463, "comment_id": 101834233, "body": "As @GSerg pointed out, there&#39;s much unnecessary code in there. The whole <code>buff</code> and <code>char</code> allocation/assignment can be reduced to <code>If IsNumeric(Mid$(my_string, i, 1)) = True</code>"}], "tags": [], "owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "is_accepted": false, "score": 0, "last_activity_date": 1566998423, "creation_date": 1566998423, "answer_id": 57693463, "question_id": 57693294, "link": "https://stackoverflow.com/questions/57693294/are-numbers-at-specific-position-in-string/57693463#57693463", "title": "Are numbers at specific position in String?", "body": "<p>This is some code I had lying around to check the entire string, just thought I'd share, but you already have a better answer if you truly only want to check a specific portion.</p>\n\n<pre><code>Sub test()\n\nmy_string = \"TestTestTest12\"\n\nDim buff() As String\nReDim buff(Len(my_string) - 1)\nFor i = 1 To Len(my_string)\n    buff(i - 1) = Mid$(my_string, i, 1)\n    char = buff(i - 1)\n    MsgBox char\n    If IsNumeric(char) = True Then\n        MsgBox char &amp; \" = Number\"\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "is_accepted": false, "score": 0, "last_activity_date": 1567033431, "last_edit_date": 1567033431, "creation_date": 1567018684, "answer_id": 57698571, "question_id": 57693294, "link": "https://stackoverflow.com/questions/57693294/are-numbers-at-specific-position-in-string/57698571#57698571", "title": "Are numbers at specific position in String?", "body": "<p>I think for almost any scenario the @EyIM answer suffices. I do however also like the @FreeSoftwareServers train of thought. Let me elaborate: as soon as you're talking about a position, an array feels like the natural thing. You want to treat the string as if it were an array. I do, anyway. So just as an alternative, and combining the answers already given, that could look like this:</p>\n\n<pre><code>Option Explicit\n\nDim MyStringArray() As String\nDim str As String\n\n'run example\nSub Test()\n    str = \"TestTestTest12\"\n    MyStringArray = StringToArray(str)\n    Debug.Print IsPositionNumeric(MyStringArray, 12)\n    Debug.Print IsPositionNumeric(MyStringArray, 13)\n    Debug.Print IsPositionNumeric(MyStringArray, 14)\nEnd Sub\n\n'return if character at position p in array arr is numeric\nFunction IsPositionNumeric(ByRef arr() As String, p As Integer) As Boolean\n    IsPositionNumeric = IsNumeric(arr(p - 1)) '- 1 because string position is 1-based\nEnd Function\n\n'take string s and make it into array\nFunction StringToArray(ByRef s As String) As String()\n\n    'define temp array\n    Dim tmpArray() As String\n\n    'set dimension of array to match string length\n    ReDim tmpArray(Len(s))\n\n    'assign each character in string s to array\n    Dim i As Integer\n    For i = 1 To Len(s)\n        tmpArray(i - 1) = Mid$(s, i, 1) 'remember that (by default), arrays are 0-bound, so - 1\n    Next i\n\n    StringToArray = tmpArray\n\nEnd Function\n</code></pre>\n\n<p>This allows you to access your string as if it were an array, like a poor man's version of <code>ToCharArray()</code> in .Net. Granted, it may be total overkill. For one, it does an 'expensive' <code>Mid(string, position, length)</code> for every character, albeit just once. After that you just retrieve an element from an array, which is faster. So there is a balance between the number of positions you want to test and the length of the strings to test.</p>\n"}], "owner": {"reputation": 11, "user_id": 11808440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-14MjxF48n90/AAAAAAAAAAI/AAAAAAAAA2g/xgVGYDX-OGI/photo.jpg?sz=128", "display_name": "Felix", "link": "https://stackoverflow.com/users/11808440/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1567033431, "creation_date": 1566997976, "question_id": 57693294, "link": "https://stackoverflow.com/questions/57693294/are-numbers-at-specific-position-in-string", "title": "Are numbers at specific position in String?", "body": "<p>I just want to know if it is possible to check if there are numbers at a specific Position in a String</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n\nDim a As String\na = \"TestTestTest12\"\n\n'If (the 13th and the 14th positon are numbers) Then ...\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567001366, "post_id": 57693530, "comment_id": 101832798, "body": "Kostas - this works perfectly. Thank you very much!"}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567001607, "post_id": 57693530, "comment_id": 101832944, "body": "Kostas - one quick question. I get a &quot;Subscript out of range&quot; error each time I run the query. I simply hit OK and everything works as expected but I was wondering if you had any idea what could be causing that?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567003581, "post_id": 57693530, "comment_id": 101834165, "body": "Sounds like one of the supplied values is causing it. It must be only one value so if you can identify which one, we\u2019ll be able to sort it out."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567004927, "post_id": 57693530, "comment_id": 101834946, "body": "You are right. In the view I am querying I have 96 records yet the query with your function returns 95. See the image I just added. That last record it weird."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567005464, "post_id": 57693530, "comment_id": 101835266, "body": "To clarify that image I added is of the view I am querying. That last record is causing the error. The query that makes use of your function works perfectly except when you scroll down to the last record you get spammed with the &quot;Subscript out of range&quot; error message."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567006536, "post_id": 57693530, "comment_id": 101835934, "body": "It shouldn&#39;t throw an error if null or even white-space. Set a beakpoint just before you reach the last record and see the value supplied to the function."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567019021, "post_id": 57693530, "comment_id": 101841173, "body": "NVM I just wrapped the expression in an IF &quot;&quot; THEN &quot;&quot; ELSE [your function] and that fixed it. Kostas thank you again this was really awesome."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1567001013, "last_edit_date": 1567001013, "creation_date": 1566998667, "answer_id": 57693530, "question_id": 57693209, "link": "https://stackoverflow.com/questions/57693209/ms-access-vba-loop-split-function-and-output-either-first-value-if-not-null/57693530#57693530", "title": "MS Access VBA - Loop Split Function and Output Either First Value (If Not Null) or Last Value", "body": "<p>Try this.</p>\n\n<p>Just Split the value and return the last element in the array. If the value is null, return an empty string.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function SplitToLast(Value As Variant) As String\n    On Error GoTo Trap\n\n    If IsNull(Value) Then GoTo Leave\n\n    Dim arr As Variant\n        arr = Split(Value, \",\")\n\n    SplitToLast = arr(UBound(arr))\n\nLeave:\n    On Error GoTo 0\n    Exit Function\n\nTrap:\n    MsgBox Err.Description, vbCritical\n    Resume Leave\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567001421, "post_id": 57693792, "comment_id": 101832830, "body": "Unhanded Exception - thank you for the assistance your code looks right but I kept getting a &quot;Undefined function in expression&quot; error. I ended up using Kostas&#39; answer."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567001540, "post_id": 57693792, "comment_id": 101832904, "body": "No problem. This seems to be because of possible Null-values in your data. I will correct that."}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567001977, "post_id": 57693792, "comment_id": 101833186, "body": "Yes I did. Any other ideas?"}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "reply_to_user": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567002171, "post_id": 57693792, "comment_id": 101833314, "body": "I don&#39;t understand correctly. Ideas for what? Did you try the current code? Does it still not work?"}, {"owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "edited": false, "score": 0, "creation_date": 1567002608, "post_id": 57693792, "comment_id": 101833608, "body": "Sorry yes I did try the updated code and I still get the &quot;Undefined function in expression&quot; error."}], "tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": false, "score": 1, "last_activity_date": 1567002459, "last_edit_date": 1567002459, "creation_date": 1566999470, "answer_id": 57693792, "question_id": 57693209, "link": "https://stackoverflow.com/questions/57693209/ms-access-vba-loop-split-function-and-output-either-first-value-if-not-null/57693792#57693792", "title": "MS Access VBA - Loop Split Function and Output Either First Value (If Not Null) or Last Value", "body": "<p>Try this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetLastValue(ByVal value As Variant, ByVal delimiter As String) As String\n    If IsNull(value) Then Exit Function\n\n    If Len(delimiter) = 0 Then\n        GetLastValue = value\n        Exit Function\n    End If\n\n    Dim tmpValue As String\n    tmpValue = Trim(CStr(value))\n\n    Do While tmpValue Like \"*\" &amp; delimiter\n        tmpValue = Trim(Left(tmpValue, Len(tmpValue) - Len(delimiter)))\n    Loop\n\n    If Len(tmpValue) = 0 Then Exit Function\n\n    Dim tmpArr() As String\n    tmpArr = Split(tmpValue, delimiter)\n\n    GetLastValue = tmpArr(UBound(tmpArr))\nEnd Function\n</code></pre>\n\n<ul>\n<li>It also takes care of multiple delimiters at the end of the value like <code>1,2,3,, ,</code>.</li>\n<li>It also works if the length of the delimiter is > 1.</li>\n<li>In case <code>value</code> is an empty string, the result will be an empty string too.</li>\n<li>In case <code>delimiter</code> is an empty string, the result will be <code>value</code>.</li>\n</ul>\n\n<p>This example calling works fine:</p>\n\n<p><code>SELECT GetLastValue([Field1],\",\") AS LastValue FROM Table1</code></p>\n\n<p>If you edit the query in the query design view and not in SQL view, take care of the <code>,</code> which separates the parameters. There it must be a <code>;</code> instead.</p>\n"}], "owner": {"reputation": 97, "user_id": 7374950, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eb8614c5bd0ca53a41504c73e333eadc?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/7374950/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 57693530, "answer_count": 2, "score": 1, "last_activity_date": 1594549321, "creation_date": 1566997725, "last_edit_date": 1594549321, "question_id": 57693209, "link": "https://stackoverflow.com/questions/57693209/ms-access-vba-loop-split-function-and-output-either-first-value-if-not-null", "title": "MS Access VBA - Loop Split Function and Output Either First Value (If Not Null) or Last Value", "body": "<p>I have a field in my Access database that contains values such as <code>24,25,152</code>, <code>128,152</code>, <code>,113</code>, <code>113</code> and NULLS.</p>\n\n<p>When there is only one value present in the field I would like the first value to be my output (<code>113</code> for <code>,113</code> and <code>113</code>) and when there is more than one value present I would like the last value to be my output (<code>152</code> for <code>24,25,152</code> and <code>128,152</code>).</p>\n\n<p>Right now I have a user-defined function that is invoked by a query that has been hard-coded to account for the correct number of commas/values present in the field. In the future there will be more commas so I would like to account for those and I'd like my output to be in a single column (as opposed to having one column per value after each comma).</p>\n\n<p>Here is VBA code for that user-defined function which came from <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/separate-comma-delimited-field-into-separate/78e97b88-562d-4b39-9706-d633039332f8\" rel=\"nofollow noreferrer\">this post</a>.</p>\n\n<pre><code>Function mySplit(sMyText As String, sDelim As String, lIndx As Long) As String\n    On Error GoTo Error_Handler\n\n    mySplit = Split(sMyText, sDelim)(lIndx)\n\nError_Handler_Exit:\n    On Error Resume Next\n    Exit Function\n\nError_Handler:\n    If Err.Number = 9 Then\n        mySplit = \"\"\n    Else\n        MsgBox \"The following error has occured\" &amp; vbCrLf &amp; vbCrLf &amp; _\n               \"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; _\n               \"Error Source: mySplit\" &amp; vbCrLf &amp; _\n               \"Error Description: \" &amp; Err.Description &amp; _\n               Switch(Erl = 0, \"\", Erl &lt;&gt; 0, vbCrLf &amp; \"Line No: \" &amp; Erl) _\n               , vbOKOnly + vbCritical, \"An Error has Occured!\"\n    End If\n    Resume Error_Handler_Exit\n\n\n\nEnd Function\n</code></pre>\n\n<p>Here is the query:</p>\n\n<pre><code>SELECT Field, mySplit([field].[table],\",\",0) AS 1, mySplit([field].[table],\",\",1) AS 2, mySplit([field].[table],\",\",2) AS 3, Val(IIf([3]&lt;&gt;\"\",[3],IIf([2]&lt;&gt;\"\",[2],IIf([1]&lt;&gt;\"\",[1])))) AS [Value]\n\nFROM Table;\n</code></pre>\n\n<p>Ideally I'd to have a single field that looks like the \"Value\" field (outlined in green) in the image below.</p>\n\n<p>Right now that value field is a bunch of nested <code>if</code> statements looking at the <code>1</code>, <code>2</code>, and <code>3</code> columns. I know I need to modify this code to count the delimiters and then loop through each delimiter and take either the first value (if there is only one) and the last value (if there is more than one) but I am not sure how to go about achieving that.</p>\n\n<p>Any help will be greatly appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ham00.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ham00.png\" alt=\"\"></a></p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/KRPeC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KRPeC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1566999049, "post_id": 57693201, "comment_id": 101831322, "body": "Why not let Excel do the heavy lifting and convert the INT list to range names. The all you need to do is add an equal sign before each text formula."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1567002392, "post_id": 57693201, "comment_id": 101833456, "body": "It looks like the codes and their associated Int values are stored in worksheet <code>Vari&#225;veis</code>.  Are the codes in Column A of that sheet?  What column are the associated Int values in that sheet?  For some reason you&#39;re doing a <code>Match(F1...</code> on it, but we have no idea what is in <code>F1</code>, and since you <i>always</i> specify <code>F1</code>, the column match results in will never change, so we can just point to the column directly if we know where the Int values are stored.  Then just do a Find/Replace for all codes to their int values and convert the text values to formulas by prepending an <code>=</code> symbol."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1567002480, "post_id": 57693201, "comment_id": 101833518, "body": "This also looks like you&#39;re only ever evaluating a single cell and then outputting the result in a single other cell (<code>C567</code>).  However, you mention that you have a column of about 1000 rows where you need to perform this conversion, so I&#39;m guessing you will also need to implement a loop to cover all the cells."}, {"owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 0, "creation_date": 1567004663, "post_id": 57693201, "comment_id": 101834780, "body": "F1 is the head column, <code>month&#47;year</code> (e.g. Dec/17), of the cell where I want to print the formula. I need to match F1 with the same date in worksheet <code>Vari&#225;veis</code>. And yes, for now I&#39;m just testing this in a single cell for different formulas with the same date, I&#39;ll implement a loop to cover all the cells and dates afterwards."}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 0, "creation_date": 1567008649, "post_id": 57695085, "comment_id": 101837051, "body": "First of all I&#39;d like to show all my appreciation for the time you&#39;re spending trying to help me in this matter. I ran your code and it worked almost perfectly and I say almost because what isn&#39;t working properly is most probably my fault. The code runs smoothly until but in certain rows the formulas are there with the according values and operators but seems like the equal sign wasn&#39;t inserted and because of that they are not recognized as a formula."}, {"owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 0, "creation_date": 1567008886, "post_id": 57695085, "comment_id": 101837174, "body": "The codes are in column A (A2:A2309) and the <code>int</code> values are in column B (B2:B2309), which represent the month/date header that matches F1 in the sheet2. So in your code i replaced <code>aLookup = wsLookup.Range(&quot;A2:B2&quot; &amp; wsLookup.Cells(wsLookup.Rows.Count, &quot;A&quot;).End(xlUp).Row)</code>  and <code>With wsData.Range(&quot;C2:C1503&quot;, wsData.Cells(wsData.Rows.Count, &quot;C&quot;).End(xlUp))</code> and left the rest untouched."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 1, "creation_date": 1567009186, "post_id": 57695085, "comment_id": 101837289, "body": "@JohnnyAbreu Because you&#39;re hard-coding the last row, you can cut out everything after the range: <code>aLookup = wsLookup.Range(&quot;A2:B2309&quot;).Value</code> and <code>With wsData.Range(&quot;C2:C564&quot;)</code>"}, {"owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 1, "creation_date": 1567089661, "post_id": 57695085, "comment_id": 101867435, "body": "I&#39;ve managed to discover what&#39;s causing the errors. The formulas are all properly converted but in some of them the excel doesn&#39;t recognize them certain values... e.g. this formula: <code>((dAA65ab*0,18)+(dAA67ab*0,60))&#47;((dAA66ab*0,18)+(dAA68ab*0,6&zwnj;&#8203;0))*100</code> was converted as intended into <code>((180*0,18)+(549*0,60))&#47;((165*0,18)+(619*0,60))*100</code> but the code stoped running here because the excel did not recognized the decimal numbers (decimal separator in the current settings is a dot)."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 0, "creation_date": 1567090528, "post_id": 57695085, "comment_id": 101867929, "body": "@JohnnyAbreu Glad to hear you got it sorted :)"}, {"owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 0, "creation_date": 1567092156, "post_id": 57695085, "comment_id": 101868817, "body": "One more question if you don&#39;t mind. Atm the code just gets the the int&#39;s from one column (that represents one date). If I want to calculate the formulas for different columns (dates), how could I match the header in <code>sheet2</code> with the header in <code>Vari&#225;veis</code> so it could get the respective int&#39;s for each date and formula? (e.g. columns d, e, f, .. in <code>sheet2</code> match the columns c, d, e, f,... in <code>Vari&#225;veis</code>)"}, {"owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 0, "creation_date": 1567092321, "post_id": 57695085, "comment_id": 101868905, "body": "<code>Vari&#225;veis</code> holds A and B (code and description), C, D, E, F, ... (int&#39;s for each date and respective code) while <code>sheet2</code> holds A, B and C (ID, description, formula), D, E, F,... (date columns where I want to store the formula result)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "edited": false, "score": 1, "creation_date": 1567095726, "post_id": 57695085, "comment_id": 101870542, "body": "@JohnnyAbreu You&#39;d need to implement a loop in the code starting after the <code>Set wsLookup = wb.Worksheets(&quot;Vari&#225;veis&quot;)</code> line.  Then when you define the range for <code>aLookup</code>, it can be dependent on either the loop variable, or on a match so that the <code>UBound</code> is pointed to the correct column.  Give it a try and if you get stuck, please open a new question so we can take a look at it."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1567003786, "creation_date": 1567003786, "answer_id": 57695085, "question_id": 57693201, "link": "https://stackoverflow.com/questions/57693201/how-to-find-lowest-value-while-ignoring-0s-and-print-a-string-as-an-excel-formu/57695085#57695085", "title": "How to find lowest value while ignoring 0&#39;s and print a string as an excel formula", "body": "<p>Make a copy of your workbook to test this code on.  It makes some assumptions because a few details were missing from your question, but I commented the code to try to make it as clear as possible and point out where you can make adjustments to suit your needs.  It ran successfully and provided expected results on a sample workbook I created, so you should be able to make this work for you.  It doesn't use cell <code>C567</code> at all because it just converts the Formulas As Text in place.  It would be a simple matter to change where the results are output to if necessary though.</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsLookup As Worksheet\n    Dim wsData As Worksheet\n    Dim aLookup() As Variant\n    Dim aData() As Variant\n    Dim lCodesLookupCol As Long\n    Dim lCodesConvertCol As Long\n    Dim i As Long\n\n    Set wb = ActiveWorkbook\n\n    'Change this to the actual worksheet that contains the data that needs to be converted\n    Set wsData = wb.Worksheets(2)\n\n    'Change this to the actual worksheet that contains the Codes to Int Values conversion table\n    Set wsLookup = wb.Worksheets(\"Vari\u00e1veis\")\n\n    'This line loads the Codes we need to lookup and their associated Int Values into an array\n    'In this sample code, Column A contains the Codes and Column B contains their assocated Int Values\n    'Change the column letters to suit your actual data\n    'Don't include the header row (which is why it starts at A2)\n    aLookup = wsLookup.Range(\"A2:B\" &amp; wsLookup.Cells(wsLookup.Rows.Count, \"A\").End(xlUp).Row)\n\n    'This sample code assumes that the Codes Column is *BEFORE* the associated Int Values Column (for example, codes in col A is before the int values in col B)\n    'If that is not the case, swap the LBound and Ubound (for example, if the codes are in col B and the int values in col A, then the codes are After the int values and the ubound and lbound would need to be swapped)\n    lCodesLookupCol = LBound(aLookup, 2)\n    lCodesConvertCol = UBound(aLookup, 2)\n\n    'This is the range containing the Formulas Stored As Text on your data worksheet\n    'This sample code assumes those formulas are in column C (inferred from your provided code)\n    'Be sure to exclude the header row (which is why it starts at C2)\n    With wsData.Range(\"C2\", wsData.Cells(wsData.Rows.Count, \"C\").End(xlUp))\n\n        'Loop through the lookup array and convert all codes into their assocated int values using the Range.Replace method\n        For i = 1 To UBound(aLookup, 1)\n            .Replace aLookup(i, lCodesLookupCol), aLookup(i, lCodesConvertCol), xlPart, , False\n        Next i\n\n        'Now all of the codes should have been replaced with their associated Int values, but the formulas are still just text\n        'This block will Load the Formulas As Text into an array\n        If .Cells.Count = 1 Then\n            ReDim aData(1 To 1, 1 To 1)\n            aData(1, 1) = .Formula\n        Else\n            aData = .Formula\n        End If\n\n        'Loop through the aData array to prepend an = sign to convert them into formulas\n        For i = 1 To UBound(aData, 1)\n            'Verify the cell isn't blank and that it's not already a formula\n            If Len(aData(i, 1)) &gt; 0 And Left(aData(i, 1), 1) &lt;&gt; \"=\" Then aData(i, 1) = \"=\" &amp; aData(i, 1)\n        Next i\n\n        'Text formulas now converted to actual formulas, update the worksheet so that Excel will calculate them\n        .Formula = aData\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 11515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a12a06f75df2e6ad12c29e215427e11e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Abreu", "link": "https://stackoverflow.com/users/11515463/johnny-abreu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 57695085, "answer_count": 1, "score": 1, "last_activity_date": 1567003786, "creation_date": 1566997687, "question_id": 57693201, "link": "https://stackoverflow.com/questions/57693201/how-to-find-lowest-value-while-ignoring-0s-and-print-a-string-as-an-excel-formu", "title": "How to find lowest value while ignoring 0&#39;s and print a string as an excel formula", "body": "<p>I have an excel column with more than 1K text formulas. These formulas (e.g. <code>(dAA11b+dAA12b)/dAA13b*100</code>, <code>(dAA07b_2G+dAA08b_2G)/dAA09ab_2G*100</code>, ...) are composed by some codes (e.g. <code>dAA11b</code> or <code>dAA07b_2G</code>) that store an <code>int</code> value in a different sheet.</p>\n\n<p>I'm trying to convert these text formulas into proper excel formulas. For that I developed some code that loops through every text formula character. </p>\n\n<p><strong>Assuming we are working with <code>(dAA11b+dAA12b)/dAA13b*100</code></strong></p>\n\n<p>I defined two strings, <code>str_var = \"VLOOKUP(\"\"\"</code> and <code>str_var1 = \"\"\";Vari\u00e1veis;MATCH(F1;Vari\u00e1veis!$A$1:$AD$1;0);FALSE)\"</code>, that will be added to the main string <code>str_f = \"\"</code> (that is initially empty) everytime a certain character is detected (e.g. <code>str_f = str_f &amp; str_var</code> and <code>str_f = str_f &amp; a &amp; str_var1</code>). </p>\n\n<p>Moving on, everytime the loop finds a character = \"d\" the code will add <code>str_var</code> to the main string and after that it will look for the next operator in the formula (+, -, * or /) and detect his corresponding character number (e.g. \"+\" is e = 8, which represents his position in the length of the whole formula). \nAfter finding the next operator the code will look for all the characters behind it until the current character (represented by i) we are in (\"d\" in this case) and store it initially in a variable (a = dAA11b) and then add it to the main string (str_f) along with the second (str_var1), resulting in <code>str_f = str_f &amp; a &amp; str_var1</code>.</p>\n\n<pre><code>\nstr_var = \"VLOOKUP(\"\"\"\nstr_var1 = \"\"\";Vari\u00e1veis;MATCH(F1;Vari\u00e1veis!$A$1:$AD$1;0);FALSE)\"\n\ncel = Worksheets(2).Cells(2, 3)\nstr_f = \"\"\nstrLen = Len(cel)\n\n\nWith Sheets(\"Indicadores\")\n\ni = 1\nterminou = False\ncarater = 1\n\nDo\ncarater = Mid(cel, i, 1)\n    If carater = \"(\" And i = 1 Then\n    str_f = \"(\" &amp; str_f\n    .Cells(567, 3).Value = str_f\n    End If\n\n    If carater = \"(\" And i &gt; 1 Then\n    str_f = str_f &amp; \"(\"\n    .Cells(567, 3).Value = str_f\n    End If\n\n    If carater = \")\" Then\n    str_f = str_f &amp; \")\"\n    .Cells(567, 3).Value = str_f\n    End If\n\n    If carater = \"d\" Then\n    str_f = str_f &amp; str_var\n        b = InStr(1, Mid(cel, 1, 999), \"/\", vbTextCompare)\n        c = InStr(1, Mid(cel, 1, 999), \"*\", vbTextCompare)\n        d = InStr(1, Mid(cel, 1, 999), \"-\", vbTextCompare)\n        e = InStr(1, Mid(cel, 1, 999), \"+\", vbTextCompare)\n        f = InStr(1, Mid(cel, 1, 999), \")\", vbTextCompare)\n\n        minimo = 0\n        If b &lt;&gt; 0 Then\n        minimo = b\n        End If\n\n        'test = Application.WorksheetFunction.MinIfs(i, f)\n\n        If c &lt;&gt; 0 And c &lt; minimo Then\n        minimo = c\n        End If\n\n        If d &lt;&gt; 0 And d &lt; minimo Then\n        minimo = d\n        End If\n\n        If e &lt;&gt; 0 And e &lt; minimo Then\n        minimo = e\n        End If\n\n        If f &lt;&gt; 0 And f &lt; minimo Then\n        minimo = f\n        End If\n\n        a = Mid(cel, i, minimo - 2)\n        str_f = str_f &amp; a &amp; str_var1\n        .Cells(567, 3).Value = str_f\n\n    End If\n\ncarater = Mid(cel, i, 1)\n    If carater = \"+\" Then\n        str_f = str_f &amp; \"+\"\n        .Cells(567, 3).Value = str_f\n    End If\n\ncarater = Mid(cel, i, 1)\n    If carater = \"/\" Then\n        str_f = str_f &amp; \"/\"\n        .Cells(567, 3).Value = str_f\n    End If\n\ncarater = Mid(cel, i, 1)\n    If carater = \"*\" Then\n        str_f = str_f &amp; \"*\"\n        .Cells(567, 3).Value = str_f\n    End If\n\ncarater = Mid(cel, i, 1)\n    If carater = \"+\" Or carater = \"-\" Or carater = \"*\" Or carater = \"/\" Then\n        b1 = InStr(1, Mid(cel, i, 999), \")\", vbTextCompare)\n        c1 = InStr(1, Mid(cel, i, 999), \"*\", vbTextCompare)\n        d1 = InStr(1, Mid(cel, i, 999), \"-\", vbTextCompare)\n        e1 = InStr(1, Mid(cel, i, 999), \"+\", vbTextCompare)\n        f1 = InStr(1, Mid(cel, i, 999), \"/\", vbTextCompare)\n        If b1 &lt;= 5 And c1 &lt;= 1 And d1 &lt;= 1 And e1 &lt;= 1 And f1 &lt;= 1 Then\n            a1 = Mid(cel, i + 1, (strLen - (strLen - 3)))\n        End If\n        str_f = str_f &amp; a1\n        .Cells(567, 3).Value = str_f\n    End If\n\n    If carater = \"-\" Then\n        d2 = InStr(1, Mid(cel, i, 999), \"-\", vbTextCompare)\n        If d2 &lt;= 1 Then\n            a2 = Mid(cel, i - 1, i - 2)\n        End If\n        str_f = str_f &amp; a2\n        .Cells(567, 3).Value = str_f\n    End If\n\n    carater = Mid(cel, i, 1)\n    If carater = \"-\" Then\n        str_f = str_f &amp; \"-\"\n        .Cells(567, 3).Value = str_f\n    End If\n\ni = i + 1\n\nLoop Until carater = \"\"\n\n    '.Cells(567, 3).Formula = str_f\n    '.Cells(568, 3).Formula = \n    'end result: str_f = \"=(VLOOKUP(\"dAA11b\";Vari\u00e1veis;MATCH(F1;Vari\u00e1veis!$A$1:$AD$1;0);FALSE)+VLOOKUP(\"dAA12b\";Vari\u00e1veis;MATCH(F1;Vari\u00e1veis!$A$1:$AD$1;0);FALSE))/VLOOKUP(\"dAA13ab\";Vari\u00e1veis;MATCH(F1;Vari\u00e1veis!$A$1:$AD$1;0);FALSE)*100\nEnd With\"\n\nEnd Sub\n</code></pre>\n\n<p>This works fine for some formulas but not for others. The problem is when the code tries to get the characters behind the operator, and because de codes varie in length, the variable <code>a = Mid(cel, i, minimo - 2)</code> assumes the minimo value (which is e = 8 in the example mentioned before) as starting in the current character (\"d\", i = 2). So even tho \"+\" is in the 8th position in the formula length the <code>Mid</code> function assumes it as if it the 10th (8+i). This wouldn't be a problem because I subtract -2 but, since the codes varie in length this will not work properly everytime. <strong>Is there any other way i can get the full codes before the operators?</strong></p>\n\n<p>The 2nd problem is when I'm about to print the final formula,stored in str_f, <code>.Cells(567, 3).Formula = str_f</code> to the excel sheet it does not recognize it as a formula. I tried in many different ways but nothing... the main problem seems to be because of the equal sign and the quote signs in the codes (<code>\"dAA11b\"</code>). <strong>Any way i can print the string as seen in the last comment of the code into the excel sheet?</strong></p>\n\n<p>I apologize if this sounds very confusing but I can't explain it in any other way, I tried to do it in a previous question with fewer details and people suggested me to ask the same question again but with all the details possible.</p>\n"}, {"tags": ["excel", "vba", "adp"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 2, "creation_date": 1566997510, "post_id": 57693064, "comment_id": 101830355, "body": "Well, what&#39;s not working? Start by getting rid of the <code>On Error Resume Next</code>, so you can actually see any errors it raises."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567000853, "post_id": 57693064, "comment_id": 101832465, "body": "While you&#39;re at it, use the <a href=\"https://stackoverflow.com/posts/57693064/edit\">edit</a> link to format the code into a more readable format. Get rid of empty lines and make sure everything is indented by <i>at least</i> four spaces so that it&#39;s in a code block."}, {"owner": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "edited": false, "score": 0, "creation_date": 1567004224, "post_id": 57693064, "comment_id": 101834522, "body": "it breaks when pasting (tmp.pastespecial...&quot;)....for whtever reason, if i run it twice, it works...so messed up...the on error resume next was to bypass that error....it doesn&#39;t make sense that when i run it again, it works, right?"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1567005508, "post_id": 57693064, "comment_id": 101835296, "body": "If <code>On Error Resume Next</code> is used to hide syntax errors, then the problem doesn&#39;t go away.  If you refer to the <code>Range.PasteSpecial</code> method, you are not following the format as shown here <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.pastespecial\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "edited": false, "score": 0, "creation_date": 1567010143, "post_id": 57695502, "comment_id": 101837694, "body": "i tried that, but it doesn&#39;t work (just use range(&quot;a1&quot;).paste...)  ...i get &quot;complie error: named argument not found&quot;  I tried doing range(&quot;a1&quot;).select selection.pastespecial format....  but if i do that, it doesn&#39;t paste at all even if i run it twice....i think the code is such that because the information is being copy and pasted from ADP/Broadridge which literally looks like a DOS screen (or if youve ever seen Costco&#39;s system, it looks like that)"}, {"owner": {"reputation": 24, "user_id": 11989975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PJ1XwbehTZQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuRBm1sq5-Yk6YBiPZz0PeAQmOFw/photo.jpg?sz=128", "display_name": "Patrick O&#39;Brien", "link": "https://stackoverflow.com/users/11989975/patrick-obrien"}, "reply_to_user": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "edited": false, "score": 0, "creation_date": 1567012241, "post_id": 57695502, "comment_id": 101838509, "body": "@dwightchang Have you tried doing this without VBA first to see what kind of paste methods work and then you can alter the pastespecial from there?  You could try specifically stating -   Activeworkbook.sheets(tmp.name).range(&quot;A1&quot;).pastespecial ...   and see if that works?"}, {"owner": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "edited": false, "score": 0, "creation_date": 1567014489, "post_id": 57695502, "comment_id": 101839461, "body": "sorry for not trying earlier guys, but....             Range(&quot;a1&quot;).Select      ActiveSheet.Paste        seemed to do the trick"}], "tags": [], "owner": {"reputation": 24, "user_id": 11989975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PJ1XwbehTZQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuRBm1sq5-Yk6YBiPZz0PeAQmOFw/photo.jpg?sz=128", "display_name": "Patrick O&#39;Brien", "link": "https://stackoverflow.com/users/11989975/patrick-obrien"}, "is_accepted": false, "score": 0, "last_activity_date": 1567005772, "last_edit_date": 1567005772, "creation_date": 1567005179, "answer_id": 57695502, "question_id": 57693064, "link": "https://stackoverflow.com/questions/57693064/have-to-run-a-macro-twice/57695502#57695502", "title": "have to run a macro twice", "body": "<p>If you need the macro to loop twice, set up a separate subroutine in the same module and just call the main subroutine twice. Kind of a brute force way to do it though, so I'd recommend not doing this often.</p>\n\n<pre><code>call main_subroutine_name() \ncall main_subroutine_name()\n</code></pre>\n\n<p>Your issue however appears to be with the data that you're pasting. Are you trying to paste values, and where are you trying to paste the data? If you're trying to paste the data in range \"A1,\" try:</p>\n\n<pre><code>range(\"A1\").pastespecial ...\n</code></pre>\n\n<p>Since you already activated the specific sheet, you shouldn't need to specify the sheet as the region in which you're trying to paste, and can rather just reference cell \"A1\" as shown above.</p>\n"}], "owner": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1567005772, "creation_date": 1566997262, "last_edit_date": 1567003923, "question_id": 57693064, "link": "https://stackoverflow.com/questions/57693064/have-to-run-a-macro-twice", "title": "have to run a macro twice", "body": "<p>i need to run the macro twice for it to work</p>\n\n<p>have no clue how to fix it</p>\n\n<pre><code>Dim ws As Worksheet\nDim tmp As Worksheet\nDim acct As String\n\nSet ws = Sheets(\"Booking\")\nSet tmp = ThisWorkbook.Worksheets.Add\ntmp.Activate\n\nOn Error Resume Next\nAppActivate \"BTS\", True\nOn Error GoTo 0\nSleep 1000\n\nOn Error Resume Next\n\nSendKeys \"MRGN\", True 'enter margin\nSleep 500\nSendKeys \"^\", True 'reset\nSleep 500\nSendKeys \"40911025\", True ' enter account number\nSendKeys \"{F3}\", True 'get balance secreen\nSleep 750 'waits X seconds\nSendKeys \"^{INSERT}\", True 'copy\nSleep 100\ntmp.Activate\n\ntmp.Range(\"A1\").Select\ntmp.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n\n        ws.Range(\"I7\") = Trim(Left(tmp.Range(\"A7\"), 13)) 'GetEquity\n        ws.Range(\"I9\") = Trim(Left(tmp.Range(\"A9\"), 13)) 'GetMM\n        ws.Range(\"I11\") = Trim(Left(tmp.Range(\"A11\"), 13)) 'GetDebt\n        ws.Range(\"I13\") = Trim(Left(tmp.Range(\"A13\"), 13)) 'GetL250\n\nApplication.DisplayAlerts = False\n\ntmp.Delete\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\nSheets(\"Booking\").Activate\n</code></pre>\n\n<p>it works, but I need to run it twice.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1566997724, "last_edit_date": 1566997724, "creation_date": 1566996911, "answer_id": 57692951, "question_id": 57692853, "link": "https://stackoverflow.com/questions/57692853/vba-hide-unhide-rows-based-on-user-number-entry/57692951#57692951", "title": "VBA hide unhide rows based on user number entry", "body": "<p>Maybe you can try by doing like that (<strong>The last Code should be yours try it</strong>) : </p>\n\n<pre><code>Sub tryme()\n\nDim MyRng As Range\n\nSet MyRng = Columns(\"C:D\")\n\nMyRng.Hidden = True\n\n\nEnd Sub\n</code></pre>\n\n<p>In your case if you want to Hide column with the number of the column and not the letter you should do stuff like this : </p>\n\n<pre><code>Sub Worksheet_SelectionChange()\n\nDim MyRng As Range\nDim ColumnsToHide1 As Integer\nDim ColumnsToHide2 As Integer\n\nColumnsToHide1 = 1\nColumnsToHide2 = 5\n\nSet MyRng = Range(Columns(ColumnsToHide1), Columns(ColumnsToHide2))\n\nMyRng.Hidden = True\n\nEnd Sub\n</code></pre>\n\n<p>So maybe your code would be like this : <strong>give this a try</strong> : </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n        If Target.Address = \"$C$2\" Then\n            Range(\"G:L\").EntireColumns.Hidden = True\n            Dim i As Integer\n            Dim imax As Integer\n            Dim str1 As Integer\n            Dim str11 As Integer\n\n            Dim str2 As Integer\n            Dim str22 As Integer\n\n            Dim MyRng1 As Range\n            Dim MyRng2 As Range\n\n            imax = 5\n\n            If Range(\"C2\").Value &gt; 0 And Range(\"C2\") &lt;= imax Then\n                i = Range(\"C2\").Value\n                str1 = 7\n                str11 = 7 + i\n                str2 = 7 + i\n                str22 = 12\n\n                Range(Columns(str1), Columns(str11)).Hidden = True\n                Range(Columns(str2), Columns(str22)).Hidden = True\n\n            End If\n        End If\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1566997262, "creation_date": 1566997262, "answer_id": 57693063, "question_id": 57692853, "link": "https://stackoverflow.com/questions/57692853/vba-hide-unhide-rows-based-on-user-number-entry/57693063#57693063", "title": "VBA hide unhide rows based on user number entry", "body": "<p>This would hide A:C if you entered 3.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address = \"$C$2\" Then\n        If IsNumeric(Target.Value) Then\n            Range(\"A1\").Resize(, Target.Value).EntireColumn.Hidden = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568215940, "post_id": 57783610, "comment_id": 102206335, "body": "May I ask you to accept my answer :  <a href=\"https://meta.stackexchange.com/a/5235\">look here to see how to accept</a>. Kindest regards"}], "tags": [], "owner": {"reputation": 1, "user_id": 11988261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G08YV.jpg?s=128&g=1", "display_name": "ChristineAnita", "link": "https://stackoverflow.com/users/11988261/christineanita"}, "is_accepted": true, "score": 0, "last_activity_date": 1567582694, "creation_date": 1567582694, "answer_id": 57783610, "question_id": 57692853, "link": "https://stackoverflow.com/questions/57692853/vba-hide-unhide-rows-based-on-user-number-entry/57783610#57783610", "title": "VBA hide unhide rows based on user number entry", "body": "<p>Thank you SJR, Thank you Dorian, both codes work really good! However because columns to hide/unhide are years (2018, 2019, 2020 and so on) I want to unhide starting from the first year. So I had to modify the code a little. Here is the result: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)                                 \n\n    Dim MyRng As Range\n    Dim Hide1 As Integer\n    Dim Hide2 As Integer\n\nIf Target.Address = \"$C$2\" Then \n\n    Hide1 = 7                                                                     \n    Hide2 = 14                                                                   \n    Set MyRng = Range(Columns(Hide1), Columns(Hide2))   \n\n    MyRng.Hidden = True                                                    \n\n    Dim i As Integer\n    Dim imax As Integer\n\n    Dim str1 As Integer\n    Dim str11 As Integer\n\n    Dim str2 As Integer\n    Dim str22 As Integer\n\n    imax = 9\n\n\n    If Range(\"C2\").Value &gt; 0 And Range(\"C2\") &lt;= imax Then         \n\n         i = Range(\"C2\").Value                                                      \n         str1 = 7\n         str11 = 7 + i                                                                    \n\n         str2 = 7 + i\n         str22 = 15\n\n         Range(Columns(str1), Columns(str11)).Hidden = False       \n         Range(Columns(str2), Columns(str22)).Hidden = True         \n\nEnd If\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11988261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G08YV.jpg?s=128&g=1", "display_name": "ChristineAnita", "link": "https://stackoverflow.com/users/11988261/christineanita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57783610, "answer_count": 3, "score": 0, "last_activity_date": 1567582694, "creation_date": 1566996578, "last_edit_date": 1567000701, "question_id": 57692853, "link": "https://stackoverflow.com/questions/57692853/vba-hide-unhide-rows-based-on-user-number-entry", "title": "VBA hide unhide rows based on user number entry", "body": "<p>I would like to write a macro that unhides and hides columns based on user entry. \nIt should unhide e.g. 3 columns if user enters \"3\" in a defined field and so on... </p>\n\n<p>Here is the code that works fine if I do it for Rows. However for columns it does not work. </p>\n\n<pre><code>    Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n        If Target.Address = \"$C$2\" Then\n            Range(\"G:L\").EntireColumns.Hidden = True\n            Dim i As Integer\n            Dim imax As Integer\n            Dim str1 As String\n            Dim str2 As String\n            imax = 5\n\n            If Range(\"C2\").Value &gt; 0 And Range(\"C2\") &lt;= imax Then\n                i = Range(\"C2\").Value\n                str1 = \"7:\" &amp; 7 + i\n                str2 = 7 + i &amp; \":12\"\n                Range(str1).EntireColumn.Hidden = True\n                Range(str2).EntireColumn.Hidden = True\n            End If\n        End If\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567001909, "post_id": 57692759, "comment_id": 101833135, "body": "Welcome to SO. I suggest you update your post to be more specific as to what your problem is and which info you want to pull from the webpage. Also, there is a typo here <code>.getElementsByclssName</code>. It should be <code>getElementsByClassName</code>. Furthermore, &quot;div&quot; is highly unlikely to be a class name. Maybe the method you should be using is <code>.getElementsByTagName(&quot;div&quot;)</code>."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567002600, "post_id": 57692759, "comment_id": 101833604, "body": "Also, this <code>For Each htmlEle In ieObj.document.getElementsByclssName(&quot;div&quot;)(0).getElementsBy&zwnj;&#8203;clssName(&quot;sp-summary&zwnj;&#8203;__text_pre&quot;).Innerte&zwnj;&#8203;xt</code> is bound to fail, because you are basically trying to loop through a string, which doesn&#39;t make sense. What you need to do is loop through a collection of HTML elements. So you have to delete the <code>.innerText</code> part like so <code>For Each htmlEle In ieObj.document.getElementsByclssName(&quot;div&quot;)(0).getElementsBy&zwnj;&#8203;clssName(&quot;sp-summary&zwnj;&#8203;__text_pre&quot;)</code>"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1567408602, "post_id": 57692759, "comment_id": 101942319, "body": "Glad I could help! Did this solve your problem?"}], "owner": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567000686, "creation_date": 1566996307, "last_edit_date": 1567000686, "question_id": 57692759, "link": "https://stackoverflow.com/questions/57692759/how-to-pull-our-all-inner-text-from-website", "title": "How to pull our all inner text from website?", "body": "<p>How can I pull out all inner text from page?</p>\n\n<p>Please help</p>\n\n<pre><code>Sub CountryList()\n    ' declare the variables\n    Dim ieObj As InternetExplorer\n    Dim htmlEle As IHTMLElement\n    Dim i As Integer\n\n    ' initialize i to one\n    i = 1\n\n    ' create and get access to an instance of IE\n    Set ieObj = New InternetExplorer\n    ieObj.Visible = True\n    ieObj.navigate \"http://www.spark-interfax.ru/system/home/card#/company/3411D127F25A45F7ABAB32964A32848D/250/latest\"\n\n    ' give the webpage some time to load all content\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    ' loop through all the rows in the table\n    For Each htmlEle In ieObj.document.getElementsByclssName(\"div\")(0).getElementsByclssName(\"sp-summary__text_pre\").Innertext\n        With ActiveSheet\n            .Range(\"A\" &amp; i).Value = htmlEle.Children(0).textContent\n            .Range(\"B\" &amp; i).Value = htmlEle.Children(1).textContent\n            .Range(\"C\" &amp; i).Value = htmlEle.Children(2).textContent\n            .Range(\"D\" &amp; i).Value = htmlEle.Children(3).textContent\n            .Range(\"E\" &amp; i).Value = htmlEle.Children(4).textContent\n        End With\n\n        i = i + 1\n    Next htmlEle\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MK7Hz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MK7Hz.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "range", "paste", "transpose", "consolidation"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1566996292, "post_id": 57692651, "comment_id": 101829625, "body": "You want to paste the rows as columns to the right of each other each time?"}, {"owner": {"reputation": 15, "user_id": 11823803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f216cedff047d218271bf2cfea427726?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11823803/jules"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1566996476, "post_id": 57692651, "comment_id": 101829730, "body": "yes that&#39;s excatly what I am looking for."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1566996562, "post_id": 57692651, "comment_id": 101829786, "body": "Is the initial destination a particular row or column? You are offsetting from usedrange which could be a variable cell."}, {"owner": {"reputation": 15, "user_id": 11823803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f216cedff047d218271bf2cfea427726?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11823803/jules"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1566996731, "post_id": 57692651, "comment_id": 101829886, "body": "initial destination could be A1, but to avoid additional coding, i would prefer to start from B2. That&#39;s why I inserted Offset..."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11823803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f216cedff047d218271bf2cfea427726?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11823803/jules"}, "edited": false, "score": 0, "creation_date": 1566997619, "post_id": 57692943, "comment_id": 101830423, "body": "Additional question if I may, why use End(xlToLeft) when range are pasted successively to the right ?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 15, "user_id": 11823803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f216cedff047d218271bf2cfea427726?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11823803/jules"}, "edited": false, "score": 0, "creation_date": 1566997702, "post_id": 57692943, "comment_id": 101830478, "body": "<code>Cells(2, Columns.Count)</code> means we go to the very last column in row 2 and then <code>xltoleft</code> takes us back to the left and stops at the first filled cell, then we offset 1 to the right. You can see this on a sheet by using ctrl+End and ctrl + left arrow."}, {"owner": {"reputation": 15, "user_id": 11823803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f216cedff047d218271bf2cfea427726?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11823803/jules"}, "edited": false, "score": 1, "creation_date": 1566997861, "post_id": 57692943, "comment_id": 101830566, "body": "Right, I see. You&#39;ve made my day  ;-)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1566996881, "creation_date": 1566996881, "answer_id": 57692943, "question_id": 57692651, "link": "https://stackoverflow.com/questions/57692651/copy-varying-range-from-multiple-sheets-and-paste-from-same-row/57692943#57692943", "title": "Copy varying range from multiple sheets and paste from same row", "body": "<p>Can you try this? <code>UsedRange</code> can be unpredictable. You can also have problems if you don't have anything in the first cell of <code>Rng</code>, in which case this code will need adjusting.</p>\n\n<p>I would also prefer to use the sheeet name rather than index.</p>\n\n<pre><code>Sub x()\n\nDim sh As Worksheet, wb As Workbook, Rng As Range\n\nSet sh = wb.Sheets.Add(after:=wb.Sheets(wb.Sheets.Count))\nsh.Name = \"Prep\"\n\n'Loop\nFor Each sh In wb.Worksheets\n    Select Case sh.Index\n        Case 1\n            Set Rng = sh.Range(\"D16:D18\")\n        Case 2\n            lastrow = sh.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            lastcol = sh.Cells(9, Columns.Count).End(xlToLeft).Column\n            Set Rng = sh.Range(\"M9\", sh.Cells(lastrow, lastcol))\n        Case 3\n            'Check if Range (first col for answers) is not empty\n            If WorksheetFunction.CountA(sh.Range(\"L9:L24\")) = 0 Then\n                Exit For\n            Else\n                lastrow = sh.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                lastcol = sh.Cells(9, Columns.Count).End(xlToLeft).Column\n                Set Rng = sh.Range(\"L9\", sh.Cells(lastrow, lastcol))\n            End If\n    End Select\n    Rng.Copy\n    wb.Sheets(\"Prep\").Cells(2, Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial Paste:=xlPasteAll, Transpose:=True\nNext\n\nSet sh = Nothing\nSet Rng = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11823803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f216cedff047d218271bf2cfea427726?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/11823803/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 57692943, "answer_count": 1, "score": 0, "last_activity_date": 1566996881, "creation_date": 1566995992, "question_id": 57692651, "link": "https://stackoverflow.com/questions/57692651/copy-varying-range-from-multiple-sheets-and-paste-from-same-row", "title": "Copy varying range from multiple sheets and paste from same row", "body": "<p>I am working currently with one workbook and want to implement a preparatory work, copy/pasting all the relevant range from my workbook contained in separate worksheets (3 worksheets at most). </p>\n\n<p>I have the below code to loop through the worksheets, unfortunately I am unable to write the paste-command so as to paste these ranges from the same row successively. I want Transpose:= True. I.E Rgn from sheet1 starting from B2, after last filled cell on the right starts Rgn from Sheet2, after last filled cell starts Rgn from Sheet3 (provided Rgn exists for Sheet3). </p>\n\n<p>Currently, my code overwrites what was copied from previous sheet. </p>\n\n<p>I found a potential reference here (<a href=\"https://stackoverflow.com/questions/21869053/vba-copy-paste-values-from-separate-ranges-and-paste-on-same-sheet-same-row-off\">VBA Copy Paste Values From Separate Ranges And Paste On Same Sheet, Same Row Offset Columns (Repeat For Multiple Sheets)</a>) but I am not sure how to use Address nor how the Offset is set in the solution. </p>\n\n<pre><code>' Insert temporary tab\nSet sh = wb.Sheets.Add(after:=wb.Sheets(wb.Sheets.Count))\nsh.Name = \"Prep\"\n\n\n'Loop\nFor Each sh In wb.Worksheets\n    Select Case sh.Index\n        Case 1\n           Sheets(1).Range(\"D16:D18\").Copy\n\n        Case 2\n           lastrow = Sheets(2).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n           lastcol = Sheets(2).Cells(9, Columns.Count).End(xlToLeft).Column\n           Set Rng = Sheets(2).Range(\"M9\", Sheets(2).Cells(lastrow, lastcol))\n           Rng.Copy\n\n        Case 3\n             'Check if Range (first col for answers) is not empty   \n             If Worksheetunction.CountA(Range(\"L9:L24\")) = 0 Then\n                   Exit For\n             Else\n                   lastrow = Sheets(3).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                   lastcol = Sheets(3).Cells(9, Columns.Count).End(xlToLeft).Column\n                   Set Rng = Sheets(3).Range(\"L9\", Sheets(3).Cells(lastrow, lastcol))\n                   Rng.Copy\n\n\n              End If\n\n     End Select\n\n     wb.Sheets(\"Prep\").UsedRange.Offset(1,1).PasteSpecial Paste:=xlPasteAll, Transpose:=True\n\n Next\n Set sh = Nothing\n Set Rng = Nothing\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "html", "vba", "autocomplete"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567006183, "post_id": 57692639, "comment_id": 101835709, "body": "Can you include the url? An example input value as well."}, {"owner": {"reputation": 11, "user_id": 10314732, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJsq9aU_SEU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPO_9UQVehAS7T_AzAHkZBe__5QLA/mo/photo.jpg?sz=128", "display_name": "Jan Nguyen", "link": "https://stackoverflow.com/users/10314732/jan-nguyen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1567058686, "post_id": 57692639, "comment_id": 101850663, "body": "Hi Qharr,  Im sorry but the url only works on local connection. I will try to describe the situation better to my best effort. I will include an example input as requested. Thanks for taking your time, Qharr."}], "owner": {"reputation": 11, "user_id": 10314732, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJsq9aU_SEU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPO_9UQVehAS7T_AzAHkZBe__5QLA/mo/photo.jpg?sz=128", "display_name": "Jan Nguyen", "link": "https://stackoverflow.com/users/10314732/jan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567060907, "creation_date": 1566995964, "last_edit_date": 1567060907, "question_id": 57692639, "link": "https://stackoverflow.com/questions/57692639/how-do-i-click-on-a-jquery-autocomplete-generated-list-via-vba", "title": "How do i click on a jQuery-autocomplete generated list via VBA?", "body": "<p>I'm trying to click on a list in a browser generated by jQuery/autocomplete through VBA. </p>\n\n<p>I have tried using \".click\" function, but it still wont click on the list. I also tried using \"selectedindex\" but it only returned error. I also tried \"fireevent\" with onchange. I got no error but it still didn't click on the list. </p>\n\n<p>There are similar threads here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/26649727/vba-html-jquery-chosen-autocomplete-select-in-a-list\">VBA / HTML / jQuery Chosen AutoComplete - Select in a list</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/54107030/how-to-fill-in-html-autocomplete-fields-using-vba\">How to fill in html autocomplete fields using vba?</a></p>\n\n<p>But the solution provided did nothing. I'm still new to javascript, so maybe I did something wrong.</p>\n\n<p>This is what i currently have:<br>\n<a href=\"https://i.stack.imgur.com/zrVwx.png\" rel=\"nofollow noreferrer\">This is the textbox im trying to work on(\"Konto\")</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RhabL.png\" rel=\"nofollow noreferrer\">The dropdownlist that appears when typing in the textbox</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZnVm6.png\" rel=\"nofollow noreferrer\">A new dynamic element generates at the bottom of the code when the dropdownlist occurs</a></p>\n\n<p>This is the code im currently working on:</p>\n\n<pre><code>Main.ie.document.getElementsByTagName(\"input\")(12).Value = Sheets(\"Visma\").Cells(2, 5).Value Main.ie.document.getElementsByTagName(\"input\")(12).Focus\nSet liste = Main.ie.document.getElementsByClassName(\"wicket-aa\")(0).getElementsByTagName(\"li\")\nDo While liste.Length = 0: DoEvents: Loop\nDebug.Print liste(0).innerHTML\nliste(0).Click\n</code></pre>\n\n<p>I can't target the ID since they generate new IDs every new session.</p>\n\n<p>When i run the code, <a href=\"https://i.stack.imgur.com/D11bh.png\" rel=\"nofollow noreferrer\">the input gets filled and the dropdownlist appears</a>, but it wont click on that list. When i <a href=\"https://i.stack.imgur.com/57EBc.png\" rel=\"nofollow noreferrer\">print the variable</a>, it does indeed display the item i want to click on.But \"liste(0).click\" doesn't seem to be doing anything.</p>\n\n<p>Here is the HTML-code for the textbox:</p>\n\n<pre><code>&lt;div class=\"form-group costCentreElement\"&gt;\n    &lt;label&gt;&lt;a href=\"javascript:;\" tabindex=\"0\" id=\"id20\"&gt;Konto&lt;/a&gt;&lt;/label&gt;\n            &lt;input type=\"text\" class=\"form-control ccDimensionField\" maxlength=\"12\" onkeypress=\"return disableEnterKey(event)\" value=\"\" name=\"kontLinjer:1:konteringLinjePanel:konteringForm:kPanel:form:wmc:kbInputView:0:kbInput\" id=\"id21\" autocomplete=\"off\" placeholder=\"Konto\" onfocus=\"select();\" tabindex=\"1\"&gt;\n</code></pre>\n\n<p>I believe this is the code for autocomplete that genereates the dropdownlist when typing in the textbox:</p>\n\n<pre><code>&lt;div class=\"wicket-aa-container\" id=\"id21-autocomplete-container\"     style=\"overflow: auto; position: absolute; margin: 0px; padding: 0px; width:  auto; left: 217px; top: 688px; display: none;\"&gt;\n    &lt;div id=\"id21-autocomplete\" class=\"wicket-aa\"&gt;\n        &lt;ul&gt;\n            &lt;li textvalue=\"4330\"&gt;4330 - KARTONGER/ESKER&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1566996015, "post_id": 57692606, "comment_id": 101829454, "body": "Why are you setting <code>.HTMLBody</code> to <code>....strTest.... .HTMLBody</code>? Isn&#39;t the second <code>.HTMLBody</code> just an empty string is it set elsewhere?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1566996040, "post_id": 57692606, "comment_id": 101829471, "body": "Also change <code>StrTEST _</code> to <code>StrTEST</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1567000636, "post_id": 57692606, "comment_id": 101832334, "body": "The problem is that you&#39;re missing the <code>&amp; </code> that connects <code>StrTEST</code> with <code>.HTMLBody</code>. Compare the first code that works with the second, that&#39;s not working. <code>StrTEST &amp;  .HTMLBody</code>  &lt;-- Just move them together like that"}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1567001192, "post_id": 57692606, "comment_id": 101832690, "body": "@Tom if you don&#39;t include the last .HTMLBody the signature is not included in the mail."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1567001252, "post_id": 57692606, "comment_id": 101832728, "body": "@DennisChristiansen Ah makes sense"}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1567001264, "post_id": 57692606, "comment_id": 101832737, "body": "@SiddharthRout the _ is used to indicate the line shift? The actual string from the cell includes the &amp;. But changing it to    StrTEST &amp; _ makes no difference."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1567001324, "post_id": 57692606, "comment_id": 101832769, "body": "@DennisChristiansen the <code>&amp; _</code> is to concatenate the string in <code>VBA</code> syntax. If it is in the cell it will be just read as part of the string"}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567001411, "post_id": 57692606, "comment_id": 101832825, "body": "@CindyMeister I tried added all of it in one line to the following: &quot;.HTMLBody = &quot;&lt;p style=&#39;font-family:arial;font-size:13&#39;&gt;&quot; &amp; StrTEST &amp; .HTMLBody&quot; but I still get an error 91."}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1567001619, "post_id": 57692606, "comment_id": 101832953, "body": "@Tom I tried changing it (see the EDIT), but it dosen&#39;t work."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1567001692, "post_id": 57692606, "comment_id": 101833004, "body": "@DennisChristiansen your edit is still missing the <code>&amp;</code> should be: <code>.HTMLBody = &quot;&lt;p style=&#39;font-family:arial;font-size:13&#39;&gt;&quot; &amp; StrTEST &amp; .HTMLBody</code>"}, {"owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1567066905, "post_id": 57692606, "comment_id": 101854496, "body": "@tom Thank you! I moved some things around and added the &amp; and it works."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "is_accepted": true, "score": 0, "last_activity_date": 1567071967, "creation_date": 1567071967, "answer_id": 57707469, "question_id": 57692606, "link": "https://stackoverflow.com/questions/57692606/vba-dynamic-html-body-in-mail/57707469#57707469", "title": "VBA Dynamic HTML body in mail", "body": "<p>I got it to work, by moving the &amp; from the string, in the cell, to the actual code and moving some of it around. For the string, remove the \" and simply include &lt; br > (without space) for a lineshift.</p>\n\n<pre><code>Cell(2,1) = Hi &lt;br&gt; &lt;br&gt; TEST TEST TEST TEST\n\nSub Stackoverflow3()\nStrTEST = Worksheets(\"Sheet1\").Cells(2, 1)\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objOutlookMsg = objOutlook.CreateItem(olMailItem)\nWith objOutlookMsg\n    .To = \"Dennis@Stackoverflow.com\"\n    .Subject = \"MAIL TEST\"\n    .Display\n    .HTMLBody = \"&lt;p style='font-family:arial;font-size:13'&gt;\" &amp; StrTEST &amp; .HTMLBody\n    .Display\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8004088, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a21a6a7b96564033c490741534f84c98?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Christiansen", "link": "https://stackoverflow.com/users/8004088/dennis-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 1, "accepted_answer_id": 57707469, "answer_count": 1, "score": -1, "last_activity_date": 1567071983, "creation_date": 1566995872, "last_edit_date": 1567071983, "question_id": 57692606, "link": "https://stackoverflow.com/questions/57692606/vba-dynamic-html-body-in-mail", "title": "VBA Dynamic HTML body in mail", "body": "<p>I'm creating some mail templates using VBA. The idea is to have all the templates in an Excel document, where everyone can easily change it and add more templates. These people wont have access to the VBA code, so everything is read from here.</p>\n\n<p>I want to do it as an HTML body, to include the signature and format the text, and this is where the problem arise. </p>\n\n<p>This code works just fine, and this is the layout I want to recreate:</p>\n\n<pre><code>Sub Stackoverflow1()\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objOutlookMsg = objOutlook.CreateItem(olMailItem)\nWith objOutlookMsg\n    .To = \"Dennis@Stackoverflow.com\"\n    .Subject = \"MAIL TEST\"\n    .Display\n    .HTMLBody = \"&lt;p style='font-family:arial;font-size:13'&gt;\" &amp; _\n    \"Hi\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n    \"TEST TEST TEST TEST\" &amp; _\n    .HTMLBody\n    .Display\nEnd With\nEnd Sub\n</code></pre>\n\n<p>cell(2,1) is the following string:</p>\n\n<pre><code>\"Hi\" &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; \"TEST TEST TEST TEST\" &amp; \n</code></pre>\n\n<p>Where I'm trying to input it into the outlook mail as the following:</p>\n\n<pre><code>Sub Stackoverflow2()\nStrTEST = Worksheets(\"Sheet1\").Cells(2, 1)                              '&lt;----------------\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objOutlookMsg = objOutlook.CreateItem(olMailItem)\nWith objOutlookMsg\n    .To = \"Dennis@Stackoverflow.com\"\n    .Subject = \"MAIL TEST\"\n    .Display\n    .HTMLBody = \"&lt;p style='font-family:arial;font-size:13'&gt;\" &amp; _\n     StrTEST _                                                         '&lt;----------------\n    .HTMLBody \n    .Display\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Even though the \"text\" is technically the same it obviously dont work, and I get an object required error. Does anyone know how to make the above work and not read it as string?</p>\n"}, {"tags": ["excel", "vba", "protected", "taskmanager", "security-warning"], "owner": {"reputation": 73, "user_id": 4329386, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1dc4db498ab818072ab15ee8d28eddd2?s=128&d=identicon&r=PG&f=1", "display_name": "phptraining", "link": "https://stackoverflow.com/users/4329386/phptraining"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567433408, "creation_date": 1566995434, "last_edit_date": 1567433408, "question_id": 57692490, "link": "https://stackoverflow.com/questions/57692490/vba-excel-2007-security-warning-when-closing-with-task-manager", "title": "VBA Excel 2007 Security warning when Closing with Task manager", "body": "<p>In Excel 2007 I Create file and macro (vba), I protected workbook using password \nand to avoid Security warning when closing file through icon red (X) and reopen file and after save my data and indeed, the problem is solved</p>\n\n<p><strong>Steps</strong></p>\n\n<ol>\n<li>to avoid Security warning (code problem solved is down )</li>\n<li>Closing file with red icon (X)</li>\n<li>Reopen file</li>\n<li>Save my work</li>\n<li>close and reopen</li>\n<li>work fine</li>\n</ol>\n\n<p><strong>But window Security warning arise when Closing file with Task manager and next reopen file, code down not working</strong>  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    ThisWorkbook.Unprotect Password:=\"blabla\"\n    ThisWorkbook.Save\n    ThisWorkbook.Saved = True\nEnd Sub\n\n\nPrivate Sub Workbook_Open()\n    ThisWorkbook.Protect Password:=\"blabla\"\n    ThisWorkbook.Save\n    ThisWorkbook.Saved = True\nEnd Sub  \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1566995528, "post_id": 57692161, "comment_id": 101829166, "body": "You autofilter on column 46, but you only try to autofilter columns A:C. By definition an autofilter cannot be applied while excluding the column the autofilter is applied on. Either include (up to) column AS in your range, or set the field you want to filter as one within your range."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566998675, "post_id": 57692518, "comment_id": 101831078, "body": "Have you tried this? Depending on your settings, this might give you unexpected results (as it did on my end)."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1566995548, "creation_date": 1566995548, "answer_id": 57692518, "question_id": 57692161, "link": "https://stackoverflow.com/questions/57692161/how-to-filter-out-all-the-dates-that-are-older-than-3-months-referencing-the-c/57692518#57692518", "title": "How to filter out all the dates that are older than 3 months , referencing the current date", "body": "<p><strong>You can try this:</strong></p>\n\n<pre><code>Dim Date3M_ago As Date\n\nDate3M_ago = Worksheets(\"Engine\").Range(\"C1\")\n\nActiveSheet.UsedRange.AutoFilter Field:=46, Criteria1:=\"&lt;\" &amp; Date3M_ago, Operator:=xlAnd\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11819094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c27b696f0184743450b61ecb1e73561?s=128&d=identicon&r=PG&f=1", "display_name": "hunter", "link": "https://stackoverflow.com/users/11819094/hunter"}, "edited": false, "score": 0, "creation_date": 1567060737, "post_id": 57692545, "comment_id": 101851453, "body": "One more question kind sir , before i close this.How do i make the field area variable ?Like to search for a name every time"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 11819094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c27b696f0184743450b61ecb1e73561?s=128&d=identicon&r=PG&f=1", "display_name": "hunter", "link": "https://stackoverflow.com/users/11819094/hunter"}, "edited": false, "score": 0, "creation_date": 1567061010, "post_id": 57692545, "comment_id": 101851558, "body": "@hunter, you could apply a variable instead of the <code>Field:=3</code>. It would for example become something like <code>Field:= X</code>. Now you can assign any number of column withing the <code>.Range(&quot;A:C&quot;)</code>, so meaning 1, 2 or 3 to the X variable. If you need to increase the range, you can do so and assign other columns."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1566998611, "last_edit_date": 1566998611, "creation_date": 1566995620, "answer_id": 57692545, "question_id": 57692161, "link": "https://stackoverflow.com/questions/57692161/how-to-filter-out-all-the-dates-that-are-older-than-3-months-referencing-the-c/57692545#57692545", "title": "How to filter out all the dates that are older than 3 months , referencing the current date", "body": "<p>Hopefully something in here is usefull for you:</p>\n\n<p>You say you need to filter out dates older than today minus three months (as that is what your formula in <code>Worksheets(\"Engine\").Range(\"C1\")</code> does. The same can be done through VBA with <code>Application.WorksheetFunction.EDate(Date, -3)</code>,or even <code>DateAdd</code> as per @Plutian his answer. If this is not what your intention was, you can instead reference your own variable again in it's place but make sure to turn it into a double value to use within the filter > <code>CDbl(Date3M_ago)</code>.</p>\n\n<ul>\n<li>Why do we turn this into a double? Depending on your Windows Regional Settings, the use of dates as criteria can give you unexpected results. <a href=\"https://www.ozgrid.com/VBA/autofilter-vba-dates.htm\" rel=\"nofollow noreferrer\">This is because Excel sees the dates as a US date</a>. One way around this, as per the link, is to use Long variables, however using Double variables will work with decimals and therefor it's saver to use <code>CDbl</code> in my option to account for date-time values.</li>\n</ul>\n\n<p>If we put the above into practice with some sample data like below (dates are formatted \"d-m-yyyy\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/RA1Bb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RA1Bb.png\" alt=\"enter image description here\"></a></p>\n\n<p>A piece of code to filter on column C would look like:</p>\n\n<pre><code>Sub Test()\n\nDim Date3M_ago As Date\nDate3M_ago = Worksheets(\"Engine\").Range(\"F1\")\nWith ThisWorkbook.Sheets(\"Sheet1\") 'Change accordingly\n    'All options below will work, remove the lines you don't want to use:\n    .Range(\"A:C\").AutoFilter Field:=3, Criteria1:=\"&gt;\" &amp; Application.WorksheetFunction.EDate(Date, -3)\n    .Range(\"A:C\").AutoFilter Field:=3, Criteria1:=\"&gt;\" &amp; CDbl(DateAdd(\"m\", -3, Date))\n    .Range(\"A:C\").AutoFilter Field:=3, Criteria1:=\"&gt;\" &amp; CDbl(Worksheets(\"Engine\").Range(\"F1\"))\n    .Range(\"A:C\").AutoFilter Field:=3, Criteria1:=\"&gt;\" &amp; CDbl(Date3M_ago)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Notice how the field to be filtered is in the range to be filtered, e.g.: the third column? The output would look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IHmVN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IHmVN.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1566998186, "post_id": 57692773, "comment_id": 101830766, "body": "Interestingly, while <code>DateAdd</code> returns a date value, it will not always work as a variable in the criteria (depemding on Windows Regional Settings I guess). To make it work, you can wrap it into a <code>CDbl</code> &gt; <code>Criteria1:=&quot;&gt;&quot; &amp; CDbl(DateAdd(&quot;M&quot;, -3, Date))</code>. Futhermore +1 for the nice idea of using <code>DateAdd</code> :)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566998712, "post_id": 57692773, "comment_id": 101831099, "body": "Thanks JvdV, that is indeed interesting to know. I might have use of this for a project that is coming up though as I&#39;ll be using autofilter quite a bit."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566998797, "post_id": 57692773, "comment_id": 101831148, "body": "Also would CDate work as a substitute of CDbl in this case?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1566998897, "post_id": 57692773, "comment_id": 101831215, "body": "No, it wouldn&#39;t. It would even mean overkill as <code>DateAdd</code> returns a date on it&#39;s own. Check the link I provided in my answer, for better understanding of why the filtering wouldn&#39;t work with date variables."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566999084, "post_id": 57692773, "comment_id": 101831351, "body": "Fair enough. As I said, just trying to learn as I might have use for it later. Thanks!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566999145, "post_id": 57692773, "comment_id": 101831397, "body": "It&#39;s something I also find difficult to understand as to why MS have made this so difficult :S"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1567000092, "post_id": 57692773, "comment_id": 101831998, "body": "I suppose it&#39;s to do with compatibility with different date format customs. It is near impossible to predict and account for every different custom. I helped someone not too long ago as he used the German custom of writing dates without years as <code>dd.mm.</code> which (of course) completely threw his code."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 1, "last_activity_date": 1566998945, "last_edit_date": 1566998945, "creation_date": 1566996340, "answer_id": 57692773, "question_id": 57692161, "link": "https://stackoverflow.com/questions/57692161/how-to-filter-out-all-the-dates-that-are-older-than-3-months-referencing-the-c/57692773#57692773", "title": "How to filter out all the dates that are older than 3 months , referencing the current date", "body": "<p>Autofilter cannot be applied to a column outside of the range you are trying to autofilter. In your example you are trying to filter column AT (<code>Field:=46</code>) but only apply the range from column A to C. Either apply column AT to your autofilter like so:</p>\n\n<pre><code>ActiveSheet.Range(\"A:AT\").AutoFilter Field:=46, Operator:= _\n</code></pre>\n\n<p>Or change your field to be one included in the range:</p>\n\n<pre><code>ActiveSheet.Range(\"A:C\").AutoFilter Field:=3, Operator:= _\n</code></pre>\n\n<p>Also a suggestion, replace the reference to cell filled with your date 30 days ago with a vba calculation instead to prevent breaking:</p>\n\n<pre><code>Date3M_ago = DateAdd(\"m\", -3, Now)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11819094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c27b696f0184743450b61ecb1e73561?s=128&d=identicon&r=PG&f=1", "display_name": "hunter", "link": "https://stackoverflow.com/users/11819094/hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 57692545, "answer_count": 3, "score": 0, "last_activity_date": 1566998945, "creation_date": 1566994385, "last_edit_date": 1566994928, "question_id": 57692161, "link": "https://stackoverflow.com/questions/57692161/how-to-filter-out-all-the-dates-that-are-older-than-3-months-referencing-the-c", "title": "How to filter out all the dates that are older than 3 months , referencing the current date", "body": "<p>i want to filter the dates that are older than 3 months and i want to have the system variable </p>\n\n<pre><code>Dim Date3M_ago As Date\nDate3M_ago = Worksheets(\"Engine\").Range(\"C1\")\nSelection.AutoFilter\nActiveSheet.Range(\"A:C\").AutoFilter Field:=46, Operator:= _\nxlFilterValues, Criteria1:= Date3M_ago\n</code></pre>\n\n<p>'<code>Worksheets(\"Engine\").Range(\"C1\")</code> is the cell where i have the formula that shows me the date 3 months ago , referencing the current date</p>\n\n<p>The problem is i can't write <code>criteria1:= &lt; Date3M_ago</code> , because it gives me error. the correct syntax would be <code>criteria1:= \"&lt; 8/28/2019\"</code> but that's a fixed date and i don't need that.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1566994800, "post_id": 57691936, "comment_id": 101828722, "body": "Missing declaration of<code>olFolder</code>indicates missing<code>Option Explicit</code> (even your code includes it). Remove the outlook reference as your code looks late-bound to outlook. Maybe that causes the error as you define<code>olFolderInbox</code> as constant, what is an outlook enum (not accessible if late-bound)."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566996480, "post_id": 57691936, "comment_id": 101829734, "body": "This code looks familiar ;) What happens if you type these 2 lines <code>olShareName.Resolve</code> and  <code>If Not olShareName.Resolved Then Msgbox &quot;Unable To resolve&quot;</code> before  <code>Set olFolder = oOlns.GetSharedDefaultFolder(olShareName, olFolderInbox)</code>"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1566999869, "post_id": 57691936, "comment_id": 101831823, "body": "Yes, it&#39;s orignally yours with some minor modification. Thanks it works really good and helps me alot!! Unfortunately your suggestion still get me the same error at the same line."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1567000002, "post_id": 57691936, "comment_id": 101831927, "body": "The solution was to dim the object that cause the error. So I added: <code>Dim olFolder As Outlook.Folder</code> before the error line <code>Set olFolder ...</code>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567009701, "post_id": 57691936, "comment_id": 101837508, "body": "Why early-binding(<code>Dim olFolder As Outlook.Folder</code>) , when all is prepared for late-binding(<code>Dim olFolder As Object</code>) (compatible to different outlook versions, if early-boun, only same or newer versions supported)"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1567409733, "post_id": 57691936, "comment_id": 101942718, "body": "Thank you @ComputerVersteher. Didn&#39;t thought about that. <code>Dim olFolder As Object</code> is a better choice."}], "answers": [{"comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 1, "creation_date": 1567000125, "post_id": 57692332, "comment_id": 101832017, "body": "Thank you, it actually helped me alot. I tried to change my setup to no success. However you pointed me in the right direction as you have Dim your <code>Folder</code> and I haven&#39;t. So it solved my isssue. Thanks!! (Always Dim your variables..., I should know ;) )"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1567009788, "post_id": 57692332, "comment_id": 101837545, "body": "@Wizhi Always use<code>Option Explicit</code>(and not only show in question;))!"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1567409810, "post_id": 57692332, "comment_id": 101942739, "body": "I always use <code>Option Explicit</code> as it cause less headache... However this was strange case since it worked good before I went away. 2 weeks later when I came back the macro didn&#39;t work and I got this error message..."}], "tags": [], "owner": {"reputation": 51, "user_id": 9697042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGWgnsyRTCA/AAAAAAAAAAI/AAAAAAAAA34/GHXncS51m4o/photo.jpg?sz=128", "display_name": "p77u77n77k", "link": "https://stackoverflow.com/users/9697042/p77u77n77k"}, "is_accepted": true, "score": 1, "last_activity_date": 1572900407, "last_edit_date": 1572900407, "creation_date": 1566994948, "answer_id": 57692332, "question_id": 57691936, "link": "https://stackoverflow.com/questions/57691936/referencing-a-shared-inbox-error-assignment-to-constant-not-permitted/57692332#57692332", "title": "Referencing a shared inbox, ERROR: assignment to constant not permitted", "body": "<p>Sorry but can't comment yet.</p>\n\n<p>Error might be caused by:</p>\n\n<pre><code>Const olFolderInbox As Integer = 6\n</code></pre>\n\n<p>If you change it to normal <code>olFolderInbox = 6</code> it might fix your issue.</p>\n\n<p>I've got similar vba, that opens inbox and then check's e-mail details and iterate through them.</p>\n\n<p>On mine I've set different <code>Dim's</code> </p>\n\n<pre><code>Dim myOlApp As New Outlook.Application\nDim filteredItems As Outlook.Items\nDim Ns As Outlook.Namespace\nDim Folder As Outlook.Folder\nDim olSharedName As Outlook.Recipient\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>Set Ns = myOlApp.GetNamespace(\"MAPI\")\nSet olSharedName = Ns.CreateRecipient(\"e'mail@domain.com\") \nSet Folder = Ns.GetSharedDefaultFolder(olSharedName, olFolderInbox)\n</code></pre>\n\n<p>My references are:</p>\n\n<p><a href=\"https://i.stack.imgur.com/00esu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/00esu.png\" alt=\"References\"></a></p>\n\n<p>Hope I've helped.</p>\n"}], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 57692332, "answer_count": 1, "score": 0, "last_activity_date": 1576123753, "creation_date": 1566993607, "last_edit_date": 1576123753, "question_id": 57691936, "link": "https://stackoverflow.com/questions/57691936/referencing-a-shared-inbox-error-assignment-to-constant-not-permitted", "title": "Referencing a shared inbox, ERROR: assignment to constant not permitted", "body": "<p>I have a code that will:</p>\n\n<ol>\n<li>Go to a specific folder (\"Company A status report\") which is below the shared mailbox (Inquiry@company.com). </li>\n<li>Search for unread emails + a subject phrase: \"Company A status report\"</li>\n<li>Take emails that match the criteria, find the last email then check if an attachment exists.</li>\n<li>If attachments exist then download the file.</li>\n</ol>\n\n<p>The code has previously worked, but now I get an error at this line:</p>\n\n<pre><code>Set olFolder = oOlns.GetSharedDefaultFolder(olShareName, olFolderInbox) '// Inbox\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>\"assignment to constant not permitted\"</p>\n</blockquote>\n\n<p>Library references<br>\n<a href=\"https://i.stack.imgur.com/K1QBP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K1QBP.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nConst olFolderInbox As Integer = 6\n'~~&gt; Path for the attachment\nConst AttachmentPath As String = \"C:\\Projects\\Attachments\"\n\nSub DownloadAttachmentFirstUnreadEmail()\n    Dim oOlInbFiltered As Variant\n    Dim oOlAp As Object, oOlns As Object, oOlInb As Object\n    Dim oOlItm As Object, oOlItmF As Object, oOlAtch As Object\n    '~~&gt; New File Name for the attachment\n    Dim NewFileName As String\n    NewFileName = AttachmentPath &amp; Format(Date, \"DD-MM-YYYY\") &amp; \" - \"\n    '~~&gt; Get Outlook instance\n    Set oOlAp = GetObject(, \"Outlook.application\")\n    Set oOlns = oOlAp.GetNamespace(\"MAPI\")\n    'Set oOlInb = oOlns.GetDefaultFolder(olFolderInbox).Folders(\"Company A status report\") 'If outlook only contain the following:\n    'Looks in Inbox\n    '-Personal Inbox\n        '-Company A status report\n\n    Dim olShareName As Object\n    'https://superuser.com/questions/1035062/how-to-run-a-macro-on-a-shared-mailbox-in-outlook-2013\n    Set olShareName = oOlns.CreateRecipient(\"Inquiry@company.com\") '// Owner's email address\n    Set olFolder = oOlns.GetSharedDefaultFolder(olShareName, olFolderInbox) '// Inbox\n    Set oOlInb = olFolder.Folders(\"Company A status report\")\n    'Looks in Shared Inbox\n    '-Personal Inbox\n    '-Inquiry Inbox (Shared)\n        '-Company A status report\n\n    '~~&gt; Check if there are any actual unread emails\n    If oOlInb.Items.Restrict(\"[UnRead] = True\").Count = 0 Then\n        MsgBox \"NO Unread Email In Inbox\"\n        Exit Sub\n    End If\n\n    'https://stackoverflow.com/questions/30464271/find-an-email-starting-with-specific-subject-using-vba\n    '~~&gt; Filter all unread mails with the subject: Company A status report\n    Dim Findvariable As String\n    Findvariable = \"Company A status report\"\n    Dim filterStr As String\n    filterStr = \"@SQL=\" &amp; \"urn:schemas:httpmail:subject like '%\" &amp; Findvariable &amp; \"%'\"\n    Set oOlInbFiltered = oOlInb.Items.Restrict(filterStr)\n    Set oOlInbFiltered = oOlInb.Items.Restrict(\"[UnRead] = True\")\n    'Set oOlInbFiltered = oOlInb.Items.Restrict(\"[UnRead] = True AND [Subject] = 'Company A status report'\") - works\n\n    'Test how many mails that are found and populated in the variable: oOlInbFiltered\n    MsgBox (\"Hello Test\")\n    Dim testp As Object\n    For Each testp In oOlInbFiltered\n        Debug.Print testp.Subject\n    Next testp\n\n    'Sort all the mails by ReceivedTime so the loop will start with the latest mail\n    oOlInbFiltered.Sort \"ReceivedTime\", True 'True for Ascending. Take the last mail to the oldest. We only want the last and therefore exit the loop after we find it.\n    For Each oOlItm In oOlInbFiltered\n    'Debug.Print oOlItm\n    '~~&gt; Check if the email actually has an attachment\n        If oOlItm.Attachments.Count &lt;&gt; 0 Then\n            For Each oOlAtch In oOlItm.Attachments\n                Debug.Print oOlAtch\n                '~~&gt; Download the attachment\n                oOlAtch.SaveAsFile NewFileName &amp; oOlAtch.FileName\n                'Mark the found mail as read\n                oOlItm.UnRead = False\n                DoEvents\n                oOlItm.Save\n                Exit For\n            Next\n        Else\n            MsgBox \"The Email doesn't have an attachment\"\n        End If\n        Exit For\n\n    Next oOlItm\n\n    'Open the downloaded file\n    Dim wb As Workbook\n    Dim FilePath As String\n    FilePath = NewFileName &amp; oOlAtch.FileName\n    Set wb = Workbooks.Open(FilePath)\n    'Set DataPage = wb1.Sheets(\"DATA\")\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 7856982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd36c79122d5857bd8ee070138210202?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/7856982/harry"}, "is_accepted": true, "score": 0, "last_activity_date": 1566993699, "creation_date": 1566993699, "answer_id": 57691963, "question_id": 57691456, "link": "https://stackoverflow.com/questions/57691456/powerpoint-vba-put-selected-text-into-square-bracket/57691963#57691963", "title": "Powerpoint - VBA - Put selected text into square bracket", "body": "<p>The main issue (there are more than one) is that the excel code is working on the active cell. On powerpoint, you can just use ActiveWindow.Selection</p>\n\n<p>This should work:</p>\n\n<pre><code>Sub other_Brackets() ' Keyboard shortcut: Ctrl + Shift + T\nDim selectedText As String\nDim replacedText As String\nselectedText = ActiveWindow.Selection.TextRange\nIf Left(selectedText, 1) = \"[\" Or Right(selectedText, 1) = \"]\" Then\n    replacedText = Right(selectedText, Len(selectedText) - 1)\n    replacedText = Left(replacedText, Len(replacedText) - 1)\n    ActiveWindow.Selection.TextRange = replacedText\nElse\n    ActiveWindow.Selection.TextRange = \"[\" &amp; selectedText &amp; \"]\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 57691963, "answer_count": 1, "score": 0, "last_activity_date": 1566993699, "creation_date": 1566992022, "question_id": 57691456, "link": "https://stackoverflow.com/questions/57691456/powerpoint-vba-put-selected-text-into-square-bracket", "title": "Powerpoint - VBA - Put selected text into square bracket", "body": "<p>I want to create a macro that will work on powerpoint to put the selected text into square brackets. I found a code working on Excel but I need to adapt it for PowperPoint. However, after few tries I can not figure how to correct it. \nCould you help me with that ? </p>\n\n<pre><code>Sub other_Brackets() ' Keyboard shortcut: Ctrl + Shift + T\nDim Form As String\nSet def = Selection\nFor Each bracket In Selection\n    bracket.Select\n    Form = ActiveCell.Formula\n    If Left(Form, 1) = \"[\" Or Right(Form, 1) = \"]\" Then\n        If Left(Form, 1) = \"[\" Then\n            Form = Right(Form, Len(Form) - 1)\n        End If\n        If Right(Form, 1) = \"]\" Then\n            Form = Left(Form, Len(Form) - 1)\n        End If\n        ActiveCell.Formula = Form\n    Else\n        ActiveCell.Formula = \"[\" &amp; Form &amp; \"]\"\n    End If\nNext\nApplication.GoTo def\nEnd Sub\n</code></pre>\n\n<p>Exemple : if I select in Powerpoint \"thisisatext\" and I activate the macro the result will be \"[thisisatext]\"; and if I am still on the selection \"[thisisatext]\" and I activate the macro the result will be \"thisisatext\".</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11988812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb909af482e74acaf5b6f9b995dfe13?s=128&d=identicon&r=PG&f=1", "display_name": "chrisprog", "link": "https://stackoverflow.com/users/11988812/chrisprog"}, "edited": false, "score": 0, "creation_date": 1566995117, "post_id": 57691394, "comment_id": 101828911, "body": "Thank you for your answer! Your solution works in the subroutine but I cannot make it work calling in from a cell in the spreadsheet as =DailyVar(some cells). Is it possible to do so?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 11, "user_id": 11988812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb909af482e74acaf5b6f9b995dfe13?s=128&d=identicon&r=PG&f=1", "display_name": "chrisprog", "link": "https://stackoverflow.com/users/11988812/chrisprog"}, "edited": false, "score": 0, "creation_date": 1567005616, "post_id": 57691394, "comment_id": 101835359, "body": "To use in a cell you need to enter it over the correct number of cells as an arrayfunction (control-shift enter)"}, {"owner": {"reputation": 11, "user_id": 11988812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb909af482e74acaf5b6f9b995dfe13?s=128&d=identicon&r=PG&f=1", "display_name": "chrisprog", "link": "https://stackoverflow.com/users/11988812/chrisprog"}, "edited": false, "score": 0, "creation_date": 1567007756, "post_id": 57691394, "comment_id": 101836586, "body": "This is what I tried but I get &quot;#VALUE!&quot; everywhere. That&#39;s why I thought there may have been an issue in the VBA code."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 11, "user_id": 11988812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb909af482e74acaf5b6f9b995dfe13?s=128&d=identicon&r=PG&f=1", "display_name": "chrisprog", "link": "https://stackoverflow.com/users/11988812/chrisprog"}, "edited": false, "score": 0, "creation_date": 1567008012, "post_id": 57691394, "comment_id": 101836733, "body": "Two possibilities: across not down - the array is returned as a set of cells across the spreadsheet not down a column. And how are you passing Quotes?"}, {"owner": {"reputation": 11, "user_id": 11988812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb909af482e74acaf5b6f9b995dfe13?s=128&d=identicon&r=PG&f=1", "display_name": "chrisprog", "link": "https://stackoverflow.com/users/11988812/chrisprog"}, "edited": false, "score": 0, "creation_date": 1567008676, "post_id": 57691394, "comment_id": 101837068, "body": "I tried both horizontally and vertically and I keep getting &quot;#VALUE!&quot;. I am passing Quotes as a range of cells. I would like to get the output from selecting the values in a range, e.g. =DailyVar(A1:A10)."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1567075421, "last_edit_date": 1567075421, "creation_date": 1566991829, "answer_id": 57691394, "question_id": 57691214, "link": "https://stackoverflow.com/questions/57691214/vba-return-an-array-into-a-spreadsheet-from-a-function/57691394#57691394", "title": "VBA: Return an array into a spreadsheet from a function", "body": "<p>Arrays are returned using variants</p>\n\n<pre><code>Function DailyVar(Quotes()) As Variant\nDim i As Long\nReDim t(UBound(Quotes))\n\nFor i = 1 To UBound(t)\n    t(i - 1) = (Quotes(i) - Quotes(i - 1)) / Quotes(i - 1)\nNext i\n\nDailyVar = t\n\nEnd Function\n\nSub test()\nDim q(3)\nq(0) = 3\nq(1) = 2\nq(2) = 1\nRange(\"b1:d1\").Formula = DailyVar(q)\nEnd Sub\n</code></pre>\n\n<p>EDIT - using a range rather than an array</p>\n\n<pre><code>Public Function DailyVar(Q As Range) As Variant\nDim i As Long\nDim Quotes As Variant\nQuotes = Q 'fill quotes as array - this is a 2D array even for a single row or column of cells\nReDim t(UBound(Quotes))\n\nFor i = 2 To UBound(t)\n    t(i - 2) = (Quotes(i, 1) - Quotes(i - 1, 1)) / Quotes(i - 1, 1)\nNext i\n\nDailyVar = t\n'or if you want them down a column\n'DailyVar = Application.WorksheetFunction.Transpose(t)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11988812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb909af482e74acaf5b6f9b995dfe13?s=128&d=identicon&r=PG&f=1", "display_name": "chrisprog", "link": "https://stackoverflow.com/users/11988812/chrisprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567075421, "creation_date": 1566991235, "question_id": 57691214, "link": "https://stackoverflow.com/questions/57691214/vba-return-an-array-into-a-spreadsheet-from-a-function", "title": "VBA: Return an array into a spreadsheet from a function", "body": "<p>I am trying to improve my VBA using a book called \"How to Implement Market Models Using VBA\" but I am having some issues with arrays. In particular, something that I have also tried to do in the past unsuccessfully, is to return an array from a function. </p>\n\n<p>Luckily, an extract of the book is available on Google Books at <a href=\"https://books.google.ch/books?id=CAVhBgAAQBAJ&amp;pg=PA15&amp;lpg=PA15&amp;dq=DailyVar+vba&amp;source=bl&amp;ots=NPGHdDmqxJ&amp;sig=ACfU3U0dzDQOs8YIk5JSNQ832RtNp12sHg&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwjkgK7dtaXkAhVH6qQKHdC1A_EQ6AEwAHoECAgQAQ#v=onepage&amp;q=DailyVar%20vba&amp;f=false\" rel=\"nofollow noreferrer\">this link</a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function DailyVar(Quotes!()) As Single()\n\nReDim t!(UBound(Quotes))\n\nFor i = 1 To UBound(t)\n    t(i) = (Quotes(i) - Quotes(i - 1)) / Quotes(i - 1)\nNext i\n\nDailyVar = t\n\nEnd Function\n</code></pre>\n\n<p>The code above is the on that I am trying from the book. However, if in a spreadsheet I use =DailyVar(some range with numbers) in a cell, the result is \"#VALUE!\". I tried to run the function in a range and using CTRL+Shift+Enter like for matrices in Excel but it doesn't work.</p>\n\n<p>How can I return arrays from functions into a spreadsheet? What am I doing wrong such that the code above doesn't work?</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1566990713, "post_id": 57691032, "comment_id": 101826443, "body": "Do this.... <code>Set SCT_table = SCT_ws.Range(&quot;A1&quot;, SCT_ws.Cells(SCT_num_rows, SCT_num_cols))</code> This has been covered many times in the past. You need to fully qualify the range"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566990802, "post_id": 57691032, "comment_id": 101826489, "body": "You can do either what @SiddharthRout said or add the sorting inside the <code>With SCT_ws</code> and then full qualify the range with a <code>.</code> in fron of <code>Cells...</code>"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 2, "creation_date": 1566991282, "post_id": 57691032, "comment_id": 101826716, "body": "The actual explanation is that if you use cells without explicitly specifying a sheet then VBA assumes you are referring to the activesheet. in the case of your sort, this means you are trying to sort cells on one sheet with a key defined on another"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566991637, "post_id": 57691032, "comment_id": 101826910, "body": "Here is <a href=\"https://stackoverflow.com/questions/18962890/2-ways-for-clearcontents-on-vba-excel-but-1-work-fine-why\">one</a> such question. If you search Google for <code>fully qualify your cells site:stackoverflow.com</code>, you will get many more links"}, {"owner": {"reputation": 152, "user_id": 5625204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8d3f54e4b9ebeba0f127fe5cff5c12?s=128&d=identicon&r=PG&f=1", "display_name": "Violet Flare", "link": "https://stackoverflow.com/users/5625204/violet-flare"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566993579, "post_id": 57691032, "comment_id": 101828022, "body": "@SiddharthRout If you make your answer a comment I&#39;ll accept, though I also needed to do the same for the Sort part of the code <code>SCT_table.Sort Key1:=SCT_ws.Cells(1, score_col), Order1:=xlAscending, Header:=xlYes</code> Also thanks for the link to the question, I wasn&#39;t sure what the problem was so I didn&#39;t know what to search. Thanks @Harassed Dad for the explanation also."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1566995683, "post_id": 57691032, "comment_id": 101829272, "body": "Unfortunately, I can&#39;t post an answer to this question as it would not be the right thing to do in my opinion... I will close it as a duplicate though..."}], "owner": {"reputation": 152, "user_id": 5625204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de8d3f54e4b9ebeba0f127fe5cff5c12?s=128&d=identicon&r=PG&f=1", "display_name": "Violet Flare", "link": "https://stackoverflow.com/users/5625204/violet-flare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1566995610, "answer_count": 0, "score": 0, "last_activity_date": 1566990573, "creation_date": 1566990573, "question_id": 57691032, "link": "https://stackoverflow.com/questions/57691032/vba-unable-to-set-range-without-selecting-sheet", "closed_reason": "Duplicate", "title": "VBA unable to set range without selecting sheet", "body": "<p>I'm setting a range which I've called <code>SCT_table</code> which would cover the table on worksheet one called <code>SCT_ws</code>, if this is not the active worksheet I get the error <code>Run-time error '1004'</code> and the <code>Set SCT_table</code> line is highlighted when I press debug. Now if I select this worksheet before setting the range (forcing it to be the active worksheet) it runs without a problem. Below is the code:</p>\n\n<pre><code>Sub Join_Suitable_changes()\n\nApplication.ScreenUpdating = False\n\nDim SCT_ws As Worksheet\nDim SCT_num_rows, SCT_num_cols, score_col As Long\nDim SCT_table As Range\n\nSet SCT_ws = ActiveWorkbook.Worksheets(1) \n\nscore_col = 7 \n\nSCT_num_rows = SCT_ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSCT_num_cols = SCT_ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'SCT_ws.Select 'Works with this uncommented\n\nSet SCT_table = SCT_ws.Range(\"A1\", Cells(SCT_num_rows, SCT_num_cols))\n'This causes a problem\n\nSCT_table.Sort Key1:=Cells(1, score_col), Order1:=xlAscending, Header:=xlYes\n'Sorts the table on column 7\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I tried this question <a href=\"https://stackoverflow.com/questions/40861557/cannot-set-a-range-variable-without-selecting-sheet-first\">Cannot set a range variable without selecting sheet first</a> which suggested using with, and when I changed the Set part of my code to the following:</p>\n\n<pre><code>With SCT_ws\n    Set SCT_table = .Range(\"A1\", .Cells(SCT_num_rows, SCT_num_cols))\nEnd With\n</code></pre>\n\n<p>I no longer need to select the WS in order to set the range (yay), however, I still need to select the WS in order for the <code>Sort</code> to work. So unfortunately this has not stopped the use of Select.</p>\n\n<p>I'd appreciate any explanation as to why this is the case and how I can avoid the use of Select.</p>\n"}, {"tags": ["java", "excel", "vba", "jxl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10307643"}, "edited": false, "score": 0, "creation_date": 1566991301, "post_id": 57690986, "comment_id": 101826732, "body": "If you want to download a file, no need to use jxl: it&#39;s just a file, we don&#39;t care what is inside (and there are other ways to download a file in Java). Apparently, if you try to open the file as a Workbook within jxl api, the macro is lost: not too surprising, as it has a specific format unrelated to worksheets, that is probably more difficult to parse: check in the documentation if it&#39;s supported."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10307643"}, "edited": false, "score": 0, "creation_date": 1566991571, "post_id": 57690986, "comment_id": 101826881, "body": "Note also that the library is <a href=\"https://sourceforge.net/projects/jexcelapi/files/\" rel=\"nofollow noreferrer\">ten years old</a>, and to deal with Excel files I would rather suggest <a href=\"https://poi.apache.org/\" rel=\"nofollow noreferrer\">Apache POI</a> (which seems to have some <a href=\"https://poi.apache.org/apidocs/dev/org/apache/poi/poifs/macros/VBAMacroReader.html\" rel=\"nofollow noreferrer\">support</a> for VBA)."}], "owner": {"reputation": 175, "user_id": 9523051, "user_type": "registered", "profile_image": "https://graph.facebook.com/2077462169199795/picture?type=large", "display_name": "Hamza Khadhri", "link": "https://stackoverflow.com/users/9523051/hamza-khadhri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567433419, "creation_date": 1566990429, "last_edit_date": 1567433419, "question_id": 57690986, "link": "https://stackoverflow.com/questions/57690986/excel-file-downloaded-without-vba-module", "title": "excel file downloaded without vba module", "body": "<p>I have developed a code wich allow me to download excel file based on a prepared template that conatains vba code and macro.</p>\n\n<p>The code below allow me to create <strong>calender</strong> workbook from <strong>templateee</strong>  file.</p>\n\n<pre><code>        String nomFichierExcel = \"D:\\\\Calendrier\"+annee+\"-\"+versionFac+\"-\"+versionPrel+\".xls\"; \n        String filePath = \"D:\\\\test3107\\\\test-calender-war\\\\CALWAS\\\\templateee.xls\";                    \n        WorkbookSettings ws = new WorkbookSettings() ;\n        ws.setEncoding(\"Cp1252\");\n        Workbook workbook = Workbook.getWorkbook(new File(filePath),ws); \n        WritableWorkbook copy = Workbook.createWorkbook(new File(nomFichierExcel), workbook ); \n</code></pre>\n\n<p>The problem is after downloading the excel file i cannot find the vba code and module when i press ALT + F11, also when i open the file i get this as error messge but i can see data after clicking OK button.</p>\n\n<blockquote>\n  <p>File error: data may have been lost </p>\n</blockquote>\n"}, {"tags": ["vba", "csv", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10603319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Clu-GlaR8KE/AAAAAAAAAAI/AAAAAAAABMc/XqAGK_XHk_A/photo.jpg?sz=128", "display_name": "Pandriej", "link": "https://stackoverflow.com/users/10603319/pandriej"}, "edited": false, "score": 0, "creation_date": 1567058832, "post_id": 57696349, "comment_id": 101850702, "body": "Thank you for this. Yes, skipping specification works, but it makes file too big. The purpose of this macro is to load .csv file that is too big for excel and divide it into smaller parts. If I &quot;divide&quot; it into one part without specification it makes the output file bigger in size than the input (and since its more than excel can take I cannot compare those 2). File size stays the same if I use Specification, but it kips the first row..."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1567008354, "creation_date": 1567008354, "answer_id": 57696349, "question_id": 57690854, "link": "https://stackoverflow.com/questions/57690854/export-to-csv-with-headers/57696349#57696349", "title": "Export to CSV with Headers", "body": "<p>Welcome to SO. \nTry this:</p>\n\n<pre><code>Public Sub Export()\n\n    Dim filepath As String\n        filepath = \"[A valid path]\\FileName.csv\"\n\n    DoCmd.TransferText acExportDelim, , \"QueryName\", filepath, True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10603319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Clu-GlaR8KE/AAAAAAAAAAI/AAAAAAAABMc/XqAGK_XHk_A/photo.jpg?sz=128", "display_name": "Pandriej", "link": "https://stackoverflow.com/users/10603319/pandriej"}, "edited": false, "score": 0, "creation_date": 1568205899, "post_id": 57872160, "comment_id": 102200531, "body": "Thank you. This is the problem - it doesn&#39;t work. I ended up writing code to open .csv file as .txt and adding a new line with headers to all exported files."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 2, "last_activity_date": 1568123014, "creation_date": 1568123014, "answer_id": 57872160, "question_id": 57690854, "link": "https://stackoverflow.com/questions/57690854/export-to-csv-with-headers/57872160#57872160", "title": "Export to CSV with Headers", "body": "<p>Well, the last argument, set to 'True', should give you your headers.  See the link below for more info.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.transfertext\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/access.docmd.transfertext</a></p>\n\n<pre><code>Use True (1) to use the first row of the text file as field names when importing, exporting, or linking. Use False (0) to treat the first row of the text file as normal data. If you leave this argument blank, the default (False) is assumed. This argument is ignored for Microsoft Word mail merge data files, which must always contain the field names in the first row.\n</code></pre>\n\n<p>Try Compact and Repair.  Maybe that will fix it.  I've seen Access do some weird things over the years, and often doing a CR will get everything straightened out.</p>\n"}], "owner": {"reputation": 11, "user_id": 10603319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Clu-GlaR8KE/AAAAAAAAAAI/AAAAAAAABMc/XqAGK_XHk_A/photo.jpg?sz=128", "display_name": "Pandriej", "link": "https://stackoverflow.com/users/10603319/pandriej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2572, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1594464260, "creation_date": 1566989866, "last_edit_date": 1594464260, "question_id": 57690854, "link": "https://stackoverflow.com/questions/57690854/export-to-csv-with-headers", "title": "Export to CSV with Headers", "body": "<p>I'm trying to export a query form Microsoft Access into <code>.csv</code> file.</p>\n\n<p>I need the export to have headers:</p>\n\n<pre><code>DoCmd.TransferText acExportDelim, \"CSV_TEST_SPECIFICATION\", \"tempQuery\", \"file.csv\", True\n</code></pre>\n\n<p>The code works fine except for the fact that there is no headers in the <code>file.csv</code>.</p>\n\n<p><code>CSV_TEST_SPECIFICATION</code> is the same specification used to import the original CSV.</p>\n\n<p>It includes first row as headers.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1566992087, "post_id": 57690687, "comment_id": 101827162, "body": "If I have understood you correctly.... You can use a formula <code>=ABS(SUMIF($C$2:$C$1000,C2,$D$2:$D$1000))</code> where <code>C</code> is <code>FUND_CODE</code> and <code>D</code> is <code>CASHFLOW_IN_FUND_CURRENCY</code>.  <b>OR</b> You can also sort data on <code>FUND_CODE</code> and then do the calculations in VBA? <b>OR</b> You can store the data in an array and create a unique collection of  <code>FUND_CODE</code> and then perform calculation in the array? Many ways to skin a cat..."}], "answers": [{"tags": [], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "is_accepted": true, "score": 0, "last_activity_date": 1566993395, "creation_date": 1566993395, "answer_id": 57691868, "question_id": 57690687, "link": "https://stackoverflow.com/questions/57690687/search-similar-string-using-vba-in-same-column/57691868#57691868", "title": "Search Similar String using vba in same column", "body": "<p>I created a class and got the values as a collection from the input file and got this resolved.</p>\n\n<p>Function CalculateReport() As Boolean</p>\n\n<pre><code>Dim bOutput As Boolean: bOutput = False\nDim colPrediction As Collection\nDim objPred As clsPrediction\nDim shtPred As Worksheet\nDim colFunds As New Collection\n\nOn Error GoTo ErrorAccessingFile\nSet shtPred = g_colInputFiles(\"txtPredictions\").GetSheets(1).GetSheet\nOn Error GoTo 0\n\n'Get Data from Input Files\nSet colPrediction = GetPredictionData(shtPred)\nDim col As Collection\n\n'Split the data by FundCode\nFor Each objPred In colPrediction\n    If ItemIsInCollection(colFunds, objPred.Fund_Code) Then\n        Set col = colFunds(objPred.Fund_Code)\n        col.Add objPred, objPred.getKey\n    Else\n        Set col = New Collection\n        col.Add objPred, objPred.getKey\n        colFunds.Add col, objPred.Fund_Code\n    End If\nNext objPred\n\nFor Each col In colFunds\n    If col.Count &gt; 1 Then\n        'Apply Formula\n\n    End If\nNext col\n</code></pre>\n"}], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57691868, "answer_count": 1, "score": 0, "last_activity_date": 1567432217, "creation_date": 1566989287, "last_edit_date": 1567432217, "question_id": 57690687, "link": "https://stackoverflow.com/questions/57690687/search-similar-string-using-vba-in-same-column", "title": "Search Similar String using vba in same column", "body": "<p>I need to search similar string which exist under same column from a input excel file and group them together and perform some calculation.</p>\n\n<p>Example say : I have input file named : Predictions</p>\n\n<pre><code>FUND_NAME   CLASS_NAME  FUND_CODE    CASHFLOW_IN_FUND_CURRENCY \nAA              BB              SSIS         19200\nVV              DD              SPIS         16200\nQQ              NN              BNIS         15830\nCC              DJ              SSIS         -6300\n</code></pre>\n\n<p>I want a code in VBA which should combine Similar Fund_Codes together and perform some logical calculations on CASHFLOW_IN_FUND_CURRENCY .</p>\n\n<p>Say When 1st nd 4th row has same fund code (SSIS) then I need to ABS(sum(19200-6300))</p>\n\n<p>I know the logic for calculations ,but couldn't find the logic to group the fund_code within same worksheet and same column.</p>\n\n<p>I had tried the Rachels method fuzzy logic in stack overlow but it didn't work ,</p>\n\n<p>I also tried the below code and it did not work .</p>\n\n<pre><code>Dim ws As Worksheet\n    Dim lRow As Long, i As Long\n    Set ws = ThisWorkbook.Sheets(\"TRANS\")\n    Dim rngFundCode As Range\n\n    lRow = Sheet1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    Set rngFundCode = Range(\"C:C\")\n\n    For i = 2 To lRow\n        Cells(i, 3) = Application.WorksheetFunction.VLookup(Cells(i, 1), rngFundCode, 2, False)\n    Next i\n</code></pre>\n\n<p>Could anyone ,let me know how to group the similr string within same column and prform some logic calculation on the other column </p>\n\n<pre><code>Dim ws As Worksheet\n    Dim lRow As Long, i As Long\n    Set ws = ThisWorkbook.Sheets(\"TRANS\")\n    Dim rngFundCode As Range\n\n    lRow = Sheet1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    Set rngFundCode = Range(\"C:C\")\n\n    For i = 2 To lRow\n        Cells(i, 3) = Application.WorksheetFunction.VLookup(Cells(i, 1), rngFundCode, 2, False)\n    Next i\n</code></pre>\n\n<p>I want a code in VBA which should combine Similar Fund_Codes together and perform some logical calculations on CASHFLOW_IN_FUND_CURRENCY .</p>\n\n<p>Say When 1st nd 4th row has same fund code (SSIS) then I need to ABS(sum(19200-6300))</p>\n"}, {"tags": ["excel", "vba", "ontime"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1566988691, "post_id": 57690468, "comment_id": 101825373, "body": "As far as I know, just by closing the whole instance of Excel will stop it, if you don&#39;t want to do it... I don&#39;t know how to stop that."}, {"owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "edited": false, "score": 0, "creation_date": 1566989626, "post_id": 57690468, "comment_id": 101825890, "body": "You can use windows <code>Task scheduler</code> to trigger <code>VBS</code> file which has code to open Excel file"}, {"owner": {"reputation": 51, "user_id": 9697042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGWgnsyRTCA/AAAAAAAAAAI/AAAAAAAAA34/GHXncS51m4o/photo.jpg?sz=128", "display_name": "p77u77n77k", "link": "https://stackoverflow.com/users/9697042/p77u77n77k"}, "edited": false, "score": 0, "creation_date": 1567000582, "post_id": 57690468, "comment_id": 101832301, "body": "Why not adding statement ?  <code>If Workbooks(&quot;....&quot;).IsOpen then </code> your code <code>Else</code>"}, {"owner": {"reputation": 2682, "user_id": 2662901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c91dbe3c7fdf96369fe85bf22f9fc29?s=128&d=identicon&r=PG", "display_name": "feetwet", "link": "https://stackoverflow.com/users/2662901/feetwet"}, "edited": false, "score": 0, "creation_date": 1609987127, "post_id": 57690468, "comment_id": 115993956, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/27005522/application-ontime-running-when-it-shouldnt\">Application.OnTime running when it shouldn&#39;t</a>"}, {"owner": {"reputation": 2682, "user_id": 2662901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c91dbe3c7fdf96369fe85bf22f9fc29?s=128&d=identicon&r=PG", "display_name": "feetwet", "link": "https://stackoverflow.com/users/2662901/feetwet"}, "edited": false, "score": 0, "creation_date": 1609987187, "post_id": 57690468, "comment_id": 115993968, "body": "Answered <a href=\"https://stackoverflow.com/q/27005522/2662901\">here</a>, and <a href=\"https://stackoverflow.com/q/45458979/2662901\">here</a>, and <a href=\"https://stackoverflow.com/q/50273166/2662901\">here</a> ..."}], "owner": {"reputation": 21, "user_id": 11820169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c5de321b36b3db1cac2c6096175024?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11820169/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567000255, "creation_date": 1566988564, "last_edit_date": 1567000255, "question_id": 57690468, "link": "https://stackoverflow.com/questions/57690468/stopping-application-ontime-when-the-workbook-is-closed", "title": "Stopping Application.ontime when the workbook is closed", "body": "<p>I have a very simple code below that works to run a macro at a set time. The issue I'm having is that if the workbook is closed, it will reopen itself to run the macro at the correct time. The only way to stop it is if the computer had been turned off/restarted. I have seen some answers to similar issues but I haven't fully understood the answers as my experience with VBA is very limited. They also had more code in their ontime request so I'm hoping that my issue might be a more simple fix.\nAny advice would be greatly appreciated.  </p>\n\n<pre><code>Private Sub Workbook_Open()\n\n\n\n    Application.OnTime TimeValue(\"08:10:00\"), \"ButtonRefreshDays\"\n\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11814366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d67460db8b27d9bccd3e873079d7ae7?s=128&d=identicon&r=PG&f=1", "display_name": "ComradeH", "link": "https://stackoverflow.com/users/11814366/comradeh"}, "edited": false, "score": 0, "creation_date": 1566995757, "post_id": 57691671, "comment_id": 101829306, "body": "I put this macro in the CrusherRoom_V10_Test.xlsm file, and the program is &quot;looped&quot; at the line rawData=Workbook.Open... Do you have any idea how to fix it? Thanks"}, {"owner": {"reputation": 33, "user_id": 11814366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d67460db8b27d9bccd3e873079d7ae7?s=128&d=identicon&r=PG&f=1", "display_name": "ComradeH", "link": "https://stackoverflow.com/users/11814366/comradeh"}, "edited": false, "score": 0, "creation_date": 1566996053, "post_id": 57691671, "comment_id": 101829480, "body": "In addition, while I&#39;m testing the code with the button in another &quot;dummy&quot; excel file, the problem is at the pasteSheet2.Cells line. It says run-time error 1004: Application-defined or object-defined error"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 33, "user_id": 11814366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d67460db8b27d9bccd3e873079d7ae7?s=128&d=identicon&r=PG&f=1", "display_name": "ComradeH", "link": "https://stackoverflow.com/users/11814366/comradeh"}, "edited": false, "score": 0, "creation_date": 1567005760, "post_id": 57691671, "comment_id": 101835444, "body": "The code is attempting to open the file it&#39;s actually in - that won&#39;t work. If you have the code in Crusherroom then you need to replace that &quot;open&quot; line with Set RawData = thisworkbook"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 33, "user_id": 11814366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d67460db8b27d9bccd3e873079d7ae7?s=128&d=identicon&r=PG&f=1", "display_name": "ComradeH", "link": "https://stackoverflow.com/users/11814366/comradeh"}, "edited": false, "score": 0, "creation_date": 1567005859, "post_id": 57691671, "comment_id": 101835505, "body": "And the other error is my fault - I missed an &quot;x&quot; off it should read xlPasteValues not lPasteValues"}, {"owner": {"reputation": 33, "user_id": 11814366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d67460db8b27d9bccd3e873079d7ae7?s=128&d=identicon&r=PG&f=1", "display_name": "ComradeH", "link": "https://stackoverflow.com/users/11814366/comradeh"}, "edited": false, "score": 0, "creation_date": 1567046649, "post_id": 57691671, "comment_id": 101848100, "body": "Thanks for your help. My code is working normally now."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1566992719, "creation_date": 1566992719, "answer_id": 57691671, "question_id": 57690356, "link": "https://stackoverflow.com/questions/57690356/how-to-copy-data-to-another-sheet-of-the-same-workbook-and-to-a-different-workbo/57691671#57691671", "title": "How to copy data to another sheet of the same workbook and to a different workbook?", "body": "<p>The first rule of VBA is Never Use Select</p>\n\n<p>Here's your code rewritten</p>\n\n<pre><code>Option Explicit\nSub ts()\nDim rawData As Workbook\nDim materialStock As Workbook\n\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim pasteSheet2 As Worksheet\n\nSet rawData = Workbooks.Open(\"D:\\Work\\Framas\\CrusherRoom_V10_Test.xlsm\")\nSet materialStock = Workbooks.Open(\"D:\\Work\\Framas\\MaterialStock_V01_Test.xlsm\")\n\nSet copySheet = rawData.Worksheets(\"VIE Screen\")\nSet pasteSheet = rawData.Worksheets(\"Crusher tracking\")\nSet pasteSheet2 = materialStock.Worksheets(\"Sheet1\")\n\n\nIf copySheet.Range(\"F23\").Value = \"OK\" Then\n'as written this code copies cells in whichever sheet is active - you should specify which sheet you mean\n    Range(\"O9\").Formula = Range(\"B7\").Value\n    Range(\"O18\").Formula = Range(\"B7\").Value\n    ' Copy to another sheet begins from here\n    copySheet.Range(\"O9:AR9\").Copy\n    pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    'copy to another workbook starts here\n    copySheet.Range(\"O18:AG18\").Copy\n    pasteSheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial lPasteValues\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I can't see anything wrong with it at present - but I don't have your files. A few points: Always use Option Explicit, always define your variables. \nIf you step through this code using F8 you can see what line is throwing the error. It may be a typo in the name of a sheet - do the workbooks actually open?</p>\n"}], "owner": {"reputation": 33, "user_id": 11814366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d67460db8b27d9bccd3e873079d7ae7?s=128&d=identicon&r=PG&f=1", "display_name": "ComradeH", "link": "https://stackoverflow.com/users/11814366/comradeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57691671, "answer_count": 1, "score": 0, "last_activity_date": 1567433429, "creation_date": 1566988225, "last_edit_date": 1567433429, "question_id": 57690356, "link": "https://stackoverflow.com/questions/57690356/how-to-copy-data-to-another-sheet-of-the-same-workbook-and-to-a-different-workbo", "title": "How to copy data to another sheet of the same workbook and to a different workbook?", "body": "<p>When opening both workbooks (though not neccessarily), I want to run a macro that will copy the raw data from the first sheet into another sheet of the same workbook, and copy another set of raw data from the first sheet into the third sheet which comes from another workbook.</p>\n\n<p>The first part (copy from 1 sheet to another sheet of the same workbook) is fine. But when I type new code for copying to another workbook, there is a problem. The current error is \"run time error '13' Type mismatched\"</p>\n\n<pre><code>Dim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet rawData = Workbooks.Open(\"D:\\Work\\Framas\\CrusherRoom_V10_Test.xlsm\")\nSet materialStock = Workbooks.Open(\"D:\\Work\\Framas\\MaterialStock_V01_Test.xlsm\")\n\nSet copySheet = rawData.Worksheets(\"VIE Screen\")\nSet pasteSheet = rawData.Worksheets(\"Crusher tracking\")\nSet pasteSheet2 = materialStock.Worksheets(\"Sheet1\")\n\ncopySheet.Select\nIf Range(\"F23\").Value = \"OK\" Then\n\nRange(\"B7\").Select\nSelection.Copy\nRange(\"O9\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nRange(\"B7\").Select\nSelection.Copy\nRange(\"O18\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\ncopySheet.Range(\"O9:AR9\").Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n\n' Copy to another sheet begins from here\n\ncopySheet.Range(\"O18:AG18\").Copy\npasteSheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1566988368, "creation_date": 1566988368, "answer_id": 57690412, "question_id": 57690269, "link": "https://stackoverflow.com/questions/57690269/vba-selection-based-on-cell-value/57690412#57690412", "title": "VBA Selection based on cell value", "body": "<p><strong>Try:</strong></p>\n\n<pre><code>Sub SELECTIE_VERZUIM()\n\n    Dim Cval As Variant\n\n    Cval = Sheet4.Range(\"A16\").Value\n\n    Sheet4.Range(\"D1:T\" &amp; Cval).Select\n\nEnd Sub\n</code></pre>\n\n<p>Also, you should avoid using <code>Select</code> in VBA</p>\n"}], "owner": {"reputation": 57, "user_id": 11950331, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAcuQ9mew9B3S-CSIDj_InuuR7J47WRX5sBVk2S=k-s128", "display_name": "Richa", "link": "https://stackoverflow.com/users/11950331/richa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 57690412, "answer_count": 1, "score": 0, "last_activity_date": 1567433434, "creation_date": 1566987938, "last_edit_date": 1567433434, "question_id": 57690269, "link": "https://stackoverflow.com/questions/57690269/vba-selection-based-on-cell-value", "title": "VBA Selection based on cell value", "body": "<p>My code returns with an error. The result is as wished, but the error message is rather annoying. How can I get rid of this? </p>\n\n<pre><code>Sub SELECTIE_VERZUIM()\n\nDim Cval As Variant\nDim Rng1 As Range\nCval = Sheet4.Range(\"A16\").Value\nSet Rng1 = Sheet4.Range(\"D1:T\" &amp; Cval).Select\n\nEnd Sub\n\n\n</code></pre>\n\n<blockquote>\n  <p><strong>Run-time error '424':</strong>\n  Object required</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1566988196, "post_id": 57690255, "comment_id": 101825102, "body": "Q: Is it achievable? A: Yes."}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 4641457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbw3f.png?s=128&g=1", "display_name": "T.J.L.", "link": "https://stackoverflow.com/users/4641457/t-j-l"}, "edited": false, "score": 0, "creation_date": 1567109230, "post_id": 57690513, "comment_id": 101875912, "body": "In one place you use <code>.Address</code>, in another you don&#39;t. This could also benefit from <code>select case</code> instead of <code>if-then-elseif</code>."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 158, "user_id": 4641457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xbw3f.png?s=128&g=1", "display_name": "T.J.L.", "link": "https://stackoverflow.com/users/4641457/t-j-l"}, "edited": false, "score": 0, "creation_date": 1567150345, "post_id": 57690513, "comment_id": 101885427, "body": "Thanks for the feedback, I like learning how to improve my excel skills. It&#39;s indeed sloppy to only use <code>.address</code> once, and I&#39;ve never used <code>select case</code> before. I&#39;ll read up and probably improve my answer."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1567153065, "last_edit_date": 1567153065, "creation_date": 1566988760, "answer_id": 57690513, "question_id": 57690255, "link": "https://stackoverflow.com/questions/57690255/selecting-one-cell-overwrites-text-in-another-cell/57690513#57690513", "title": "Selecting one cell overwrites text in another cell", "body": "<p>The following would do what you need.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Address = ActiveSheet.Range(\"A1\").Address Then\n    ActiveSheet.Range(\"B1\").Value = \"Hello\"\n    Else\n        If Target.Address = ActiveSheet.Range(\"A2\").Address Then\n            ActiveSheet.Range(\"B1\").Value = \"Goodbye\"\n        End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Alternatively you could use the Case statement rather than if-else (By suggestion of T.J.L.)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nSelect Case Target.Address\n    Case Range(\"A1\").Address\n    Range(\"B1\").Value = \"Hello\"\n        Case Range(\"$A$2\").Address\n        Range(\"B1\").Value = \"Goodbye\"\n    Case Else\n        Range(\"B1\").Value = \"Wrong cell selected\"\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1566989426, "creation_date": 1566989426, "answer_id": 57690726, "question_id": 57690255, "link": "https://stackoverflow.com/questions/57690255/selecting-one-cell-overwrites-text-in-another-cell/57690726#57690726", "title": "Selecting one cell overwrites text in another cell", "body": "<p>Place this in your worksheet objects code</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"A1\")) Is Nothing Then\n        Me.Range(\"B1\").Value2 = \"hello\"\n    ElseIf Not Intersect(Target, Me.Range(\"A2\")) Is Nothing Then\n        Me.Range(\"B1\").Value2 = \"goodbye\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11988557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3084a8cfe0e122620b9689f11c261ab1?s=128&d=identicon&r=PG&f=1", "display_name": "fatboylag", "link": "https://stackoverflow.com/users/11988557/fatboylag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "closed_date": 1566999967, "accepted_answer_id": 57690726, "answer_count": 2, "score": -1, "last_activity_date": 1567433439, "creation_date": 1566987909, "last_edit_date": 1567433439, "question_id": 57690255, "link": "https://stackoverflow.com/questions/57690255/selecting-one-cell-overwrites-text-in-another-cell", "closed_reason": "Needs more focus", "title": "Selecting one cell overwrites text in another cell", "body": "<p>I would like to select one cell and change the text in another cell.</p>\n\n<p>For example:</p>\n\n<p>When <strong>cell.A1</strong> is selected <strong>cell.B1</strong>'s text is <strong>\"hello\"</strong><br>\nWhen <strong>cell.A2</strong> is selected <strong>cell.B1</strong>'s text is <strong>\"goodbye\"</strong></p>\n\n<p>Is this achievable with Visual Basic for Applications in Excel?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "button"], "answers": [{"comments": [{"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1566993140, "post_id": 57690121, "comment_id": 101827774, "body": "Well, it is not exactly clean. But as a workaround does its job."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": -1, "last_activity_date": 1566987487, "creation_date": 1566987487, "answer_id": 57690121, "question_id": 57689890, "link": "https://stackoverflow.com/questions/57689890/add-a-button-and-assign-a-function-on-press/57690121#57690121", "title": "Add a button and assign a function on press", "body": "<p>I'd write another macro:</p>\n\n<pre><code>Sub ExecuteSendClick()\n\n    Send_Click ActiveSheet.Name\n\nEnd Sub\n</code></pre>\n\n<p>And assign that macro to the button.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9115612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dSENa.jpg?s=128&g=1", "display_name": "SimonXwk", "link": "https://stackoverflow.com/users/9115612/simonxwk"}, "is_accepted": false, "score": 0, "last_activity_date": 1615298118, "last_edit_date": 1615298118, "creation_date": 1615268293, "answer_id": 66541386, "question_id": 57689890, "link": "https://stackoverflow.com/questions/57689890/add-a-button-and-assign-a-function-on-press/66541386#66541386", "title": "Add a button and assign a function on press", "body": "<p>I believe you should assign a string value to the <code>.OnAction</code> property of a button object.</p>\n<p>If the function (<code>Send_click</code> in this case) to be called is set to be public, then you just need to construct an <code>OnAction</code> string like this:</p>\n<pre><code>With testBtn\n  .OnAction = &quot;'&quot; &amp; &quot;Send_click&quot; &amp; &quot; &quot; &amp; &quot;&quot;&quot;&quot; &amp; ActiveSheet.Name &amp; &quot;&quot;&quot;&quot; &amp; &quot;'&quot;\nEnd With\n</code></pre>\n<p>The string concatenation part should return something like:</p>\n<pre><code>'Send_click &quot;whatever_the_sheet_name&quot;'\n</code></pre>\n"}], "owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 57690121, "answer_count": 2, "score": 0, "last_activity_date": 1615298118, "creation_date": 1566986746, "last_edit_date": 1566987759, "question_id": 57689890, "link": "https://stackoverflow.com/questions/57689890/add-a-button-and-assign-a-function-on-press", "title": "Add a button and assign a function on press", "body": "<p>On vba, I'd like to add a button and assign to it a function with a parameter.</p>\n\n<p>That's code to the create the button (in module1):</p>\n\n<pre><code>Set testBtn = Worksheets(\"HOME\").Buttons.Add(Position.Left, Position.Top, Position.Width * 2, Position.Height * 2)\nWith testBtn\n           .OnAction = Send_click(ActiveSheet.Name)\n           .Caption = \"LOAD \" &amp; ActiveSheet.Name\n           .Name = \"LOAD \" &amp; ActiveSheet.Name\n           .Font.Bold = True\n End With\n</code></pre>\n\n<p>while the function to call is defined in another module as:</p>\n\n<pre><code>Function Send_click(sheetName As String)\n</code></pre>\n\n<p>However, the button appears as not clickable and a macro LOADxxx_click appears as assigned (where xxx is the name of the ActiveSheet.name) but it clearly doesn't exist.</p>\n\n<p>I have also tried suggestions I found <a href=\"https://stackoverflow.com/questions/29858176/how-to-call-a-macro-from-a-button-and-pass-arguments/31845993\">here</a> and also to specify the module:</p>\n\n<pre><code>.OnAction = Module4.Send_click(ActiveSheet.Name)\n</code></pre>\n\n<p>with no different results.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1567002033, "creation_date": 1567002033, "answer_id": 57694579, "question_id": 57689529, "link": "https://stackoverflow.com/questions/57689529/find-toc-in-shapes-i-e-textboxes/57694579#57694579", "title": "Find TOC in shapes (i.e. textboxes)", "body": "<p>The <code>TablesOfContents</code> collection is only available on a <code>Document</code> object. A TOC in the main body of the document will pick up items in textboxes; a TOC in a textbox will pick up items in the main body of the document. (At least, since Word 2010; there was a time when TOCs in text boxes were not \"visible\" to a TOC field in the main document body.)</p>\n\n<p>However, the VBA property <code>Document.TablesOfContents</code> does not pick up TOCs in text boxes, only in the main body. </p>\n\n<p>So, it's not possible to <em>directly</em> query the number of TOCs in a text box (or AutoShape - a drawing object). That said...</p>\n\n<p>TOCs are managed in the background by Word using the <code>TOC</code> field code. So it is possible to ascertain the number of TOC fields in a given <code>Range</code>. For example:</p>\n\n<pre><code>Sub GetAllToc()\n    Dim shp As Word.Shape\n    Dim tbRange As Range\n    Dim iCount As Long\n    Dim fld As Word.Field\n\n    Debug.Print \"TOCs in main Document body: \" &amp; ActiveDocument.TablesOfContents.Count\n\n    For Each shp In ActiveDocument.Shapes\n        If shp.Type = msoTextBox Or shp.Type = msoAutoShape Then\n            Set tbRange = shp.TextFrame.TextRange\n            For Each fld In tbRange.Fields\n                If fld.Type = wdFieldTOC Then\n                    iCount = iCount + 1\n                End If\n            Next\n        End If\n    Next shp\n    Debug.Print \"TOCs in text boxes: \" &amp; iCount\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10260801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0568dfb2d4674684732fbbaedadf1494?s=128&d=identicon&r=PG&f=1", "display_name": "Guyglk", "link": "https://stackoverflow.com/users/10260801/guyglk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 57694579, "answer_count": 1, "score": 1, "last_activity_date": 1567002033, "creation_date": 1566985676, "last_edit_date": 1566995804, "question_id": 57689529, "link": "https://stackoverflow.com/questions/57689529/find-toc-in-shapes-i-e-textboxes", "title": "Find TOC in shapes (i.e. textboxes)", "body": "<p>I am trying to write a macro that counts and locates TOCs within the document (a routine check rather than for a specific file). </p>\n\n<p>TOCs situated in the document's 'body' are easily accessible (via VBA).\nWord also lets users place TOC objects inside of shapes (textboxes), but these do not seem to be accessible via code. Granted, it is not that common to have TOCs placed within shapes, but if it is possible - it should be taken into account. </p>\n\n<p>This makes counting and detecting them unreliable.</p>\n\n<p>The only way I know and intuitively thought of was this:</p>\n\n<pre><code>For Each shp In ActiveDocument.Shapes\n       iCount = iCount + shp.TextFrame.TextRange.&lt;TableOfContents.Count&gt;    &lt;&lt;&lt; no access to TableOfContents\n    Next shp\n</code></pre>\n\n<p>What code do I need in order to find those TOCs?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 593, "user_id": 6255055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KWFHC.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6255055/michael"}, "edited": false, "score": 5, "creation_date": 1566985367, "post_id": 57689359, "comment_id": 101823502, "body": "please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducaple example</a>"}, {"owner": {"reputation": 11, "user_id": 11988110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee276e1e292b4885c725431e5a76e5b?s=128&d=identicon&r=PG&f=1", "display_name": "EricZhang1977", "link": "https://stackoverflow.com/users/11988110/ericzhang1977"}, "reply_to_user": {"reputation": 593, "user_id": 6255055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KWFHC.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/6255055/michael"}, "edited": false, "score": 0, "creation_date": 1566986639, "post_id": 57689359, "comment_id": 101824257, "body": "Thanks Michael, first time sign-in this website.  trying edit and put links."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1566999054, "post_id": 57689359, "comment_id": 101831327, "body": "Please do not upload code as images, paste in the question as plain text, and format as code"}, {"owner": {"reputation": 11, "user_id": 11988110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee276e1e292b4885c725431e5a76e5b?s=128&d=identicon&r=PG&f=1", "display_name": "EricZhang1977", "link": "https://stackoverflow.com/users/11988110/ericzhang1977"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1567042750, "post_id": 57689359, "comment_id": 101847423, "body": "@Luuklag, Thanks, finally, i get the paste the code successfully."}, {"owner": {"reputation": 11, "user_id": 11988110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee276e1e292b4885c725431e5a76e5b?s=128&d=identicon&r=PG&f=1", "display_name": "EricZhang1977", "link": "https://stackoverflow.com/users/11988110/ericzhang1977"}, "edited": false, "score": 0, "creation_date": 1567044726, "post_id": 57689359, "comment_id": 101847748, "body": "I try to &#39;.removeAttribute (&quot;readonly&quot;)&#39; but no luck."}, {"owner": {"reputation": 11, "user_id": 11988110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee276e1e292b4885c725431e5a76e5b?s=128&d=identicon&r=PG&f=1", "display_name": "EricZhang1977", "link": "https://stackoverflow.com/users/11988110/ericzhang1977"}, "edited": false, "score": 0, "creation_date": 1567342403, "post_id": 57689359, "comment_id": 101930037, "body": "I can send a click action to make the canlendar pop up, how to select or pick a date ?"}, {"owner": {"reputation": 11, "user_id": 11988110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee276e1e292b4885c725431e5a76e5b?s=128&d=identicon&r=PG&f=1", "display_name": "EricZhang1977", "link": "https://stackoverflow.com/users/11988110/ericzhang1977"}, "edited": false, "score": 0, "creation_date": 1567489602, "post_id": 57689359, "comment_id": 101966698, "body": "Finally\uff0cI figure out\uff0c case closed"}], "owner": {"reputation": 11, "user_id": 11988110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee276e1e292b4885c725431e5a76e5b?s=128&d=identicon&r=PG&f=1", "display_name": "EricZhang1977", "link": "https://stackoverflow.com/users/11988110/ericzhang1977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567066594, "creation_date": 1566985136, "last_edit_date": 1567064287, "question_id": 57689359, "link": "https://stackoverflow.com/questions/57689359/how-to-use-excel-vba-to-pick-up-a-date-from-a-web-popup-calendar", "title": "How to use Excel-VBA to pick up a date from a web popup calendar?", "body": "<p>I'm working on VBA code in the last step to fill a web form. The problem is that the cell value which I passed to the date field does not match the format. Even if I try to pass string \"yyyy-mm-dd\".\nWhen I click the field there is a popup calendar for picking up a date.</p>\n\n<p>Below is my codes and web html and screenshot:</p>\n\n<p>Error:<a href=\"https://i.stack.imgur.com/a14Ef.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a14Ef.jpg\" alt=\"Error\"></a>\nHTML Code:<a href=\"https://i.stack.imgur.com/JOg8t.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JOg8t.jpg\" alt=\"HTML Code\"></a></p>\n\n<pre><code>     Sub AuditBookings()\n\n    Dim IE As New SHDocVw.InternetExplorer\n    Dim HTMLDoc As MSHTML.HTMLDocument\n    Dim HTMLTable As MSHTML.IHTMLElement\n    Dim HTMLTables As MSHTML.IHTMLElementCollection\n    Dim i, j, n As Integer\n    Dim DataWs As Worksheet\n    Dim DataRange, CFRange As Range\n    Dim WebCF, WebCODate As String\n    IE.Visible = True\n    IE.navigate \"https://xxx/ebkassembly/login.aspx\"\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\n    Loop\n    Set HTMLDoc = IE.document\n    If IE.LocationURL &lt;&gt; \"https://xxx/Ebooking/Entry/Index2.aspx\" Then 'check login URL\n        HTMLDoc.getElementById(\"userName\").Value = ThisWorkbook.Worksheets(\"Menu\").Range(\"B1\").Value 'fill the username\n        HTMLDoc.getElementById(\"userPwd\").Value = ThisWorkbook.Worksheets(\"Menu\").Range(\"B2\").Value  'fill the password\n        HTMLDoc.getElementById(\"accSubmit\").Click\n        Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\n        Loop\n        Application.Wait (Now + TimeValue(\"0:00:10\"))\n        IE.navigate \"https://xxx/ebksettlement/HotelAudit/hotelAuditIndex.aspx\"\n        Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\n        Loop\n        Application.Wait (Now + TimeValue(\"0:00:10\"))\n    Else\n        IE.navigate \"https://xxx/ebksettlement/HotelAudit/hotelAuditIndex.aspx\"\n        Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\n        Loop\n        Application.Wait (Now + TimeValue(\"0:00:10\"))\n    End If\n    Set DataWs = ThisWorkbook.Worksheets(\"CtripReport\")\n    DataWs.Activate\n    i = 1\n    Set HTMLTable = HTMLDoc.getElementById(\"pendingtb\")\n    n = HTMLTable.Children(0).Children.Length 'get QTY of unaudited bookings\n    For i = i To n - 1\n        WebCF = HTMLTable.Children(0).Children(i).Children(7).all(0).innerText 'get confirmation number from web\n        If WebCF &lt;&gt; \"\" Then\n             Set DataRange = DataWs.Range(\"K2\", \"K\" &amp; n)  'set search range\n             Set CFRange = DataRange.Find(what:=WebCF, lookat:=xlPart)'start matching\n              If Not CFRange Is Nothing Then\n                     CFRange.Select\n                     HTMLTable.Children(0).Children(i).Children(1).all(5).Click 'click check-out button\n                     Application.Wait (Now + TimeValue(\"0:00:02\"))\n                     'HTMLTable.Children(0).Children(i).Children(3).all(3).Value = CFRange.Offset(0, -4).Value  ' fill check-out date\n                     HTMLTable.Children(0).Children(i).Children(3).all(3).Click\n                     HTMLTable.Children(0).Children(i).Children(3).all(3).Value = \"2019-08-27\"\n                     HTMLTable.Children(0).Children(i).Children(4).all(1).innerText = CFRange.Offset(0, -3).Value  ' fill guest name\n                     HTMLTable.Children(0).Children(i).Children(6).all(0).Value = CFRange.Offset(0, -1).Value  ' fill room number\n                     'HTMLTable.Children(0).Children(i).Children(7).all.innerText = CFRange.Value  ' fill confirmation number\n                     'HTMLTable.Children(0).Children(i).Children(9).all(1).Click  ' click save button\n              End If\n        End If\n     Next\n      'MsgBox \"Total \" &amp; ThisWorkbook.Worksheets(\"CtripReport\").Range(\"A2\", Range(\"A1\").End(xlDown)).Count &amp; \" records are scraped\"\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "64-bit", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1567259554, "creation_date": 1567259554, "answer_id": 57738601, "question_id": 57688776, "link": "https://stackoverflow.com/questions/57688776/is-it-possible-to-use-base64-encode-string-as-images-for-the-commandbarbutton-p/57738601#57738601", "title": "Is it possible to use base64 encode string as images for the CommandBarButton .Picture property in vba", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/office.commandbarbutton.picture\" rel=\"nofollow noreferrer\">CommandBarButton.Picture</a> property allows to set an <code>IPictureDisp</code> object representing the image of a CommandBarButton object.</p>\n\n<pre><code>Sub ChangeButtonImage() \n    Dim picPicture As IPictureDisp \n    Dim picMask As IPictureDisp \n\n    Set picPicture = stdole.StdFunctions.LoadPicture( _ \n        \"c:\\images\\picture.bmp\") \n    Set picMask = stdole.StdFunctions.LoadPicture( _ \n        \"c:\\images\\mask.bmp\") \n\n    'Reference the first button on the first command bar \n    'using a With...End With block. \n    With Application.CommandBars.FindControl(msoControlButton) \n        'Change the button image. \n        .Picture = picPicture \n\n        'Use the second image to define the area of the \n        'button that should be transparent. \n        .Mask = picMask \n    End With \nEnd Sub\n</code></pre>\n\n<p>You can try to restore an <code>IPictureDisp</code> interface from a base64 string. See <a href=\"https://stackoverflow.com/questions/12795440/using-base64-data-stored-in-customxmlpart-as-image-in-office?rq=1\">Using base64 data stored in CustomXMLPart as image in Office</a> for more information:</p>\n\n<pre><code>Type GUID\n  Data1 As Long\n  Data2 As Integer\n  Data3 As Integer\n  Data4(7) As Byte\nEnd Type\n\nPrivate Declare Function CreateStreamOnHGlobal Lib \"ole32.dll\" (ByRef hGlobal As Any,     ByVal fDeleteOnResume As Long, ByRef ppstr As Any) As Long\nPrivate Declare Function OleLoadPicture Lib \"olepro32.dll\" (ByVal lpStream As IUnknown, ByVal lSize As Long, ByVal fRunMode As Long, ByRef riid As GUID, ByRef lplpObj As Any) As Long\nPrivate Declare Function CLSIDFromString Lib \"ole32.dll\" (ByVal lpsz As Long, ByRef pclsid As GUID) As Long\n\nPrivate Const SIPICTURE As String = \"{7BF80980-BF32-101A-8BBB-00AA00300CAB}\"\n\nPublic Function PictureFromArray(ByRef b() As Byte) As IPicture\n  On Error GoTo errorhandler\n\n  Dim istrm As IUnknown\n  Dim tGuid As GUID\n\n  If Not CreateStreamOnHGlobal(b(LBound(b)), False, istrm) Then\n    CLSIDFromString StrPtr(SIPICTURE), tGuid\n    OleLoadPicture istrm, UBound(b) - LBound(b) + 1, False, tGuid, PictureFromArray\n  End If\n\n  Set istrm = Nothing\n  Exit Function\nerrorhandler:\n  Debug.Print \"Could not convert to IPicture!\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11932958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/128d025c3fd74c7b4842782bb171b590?s=128&d=identicon&r=PG&f=1", "display_name": "WebCool", "link": "https://stackoverflow.com/users/11932958/webcool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567259554, "creation_date": 1566983232, "last_edit_date": 1566983382, "question_id": 57688776, "link": "https://stackoverflow.com/questions/57688776/is-it-possible-to-use-base64-encode-string-as-images-for-the-commandbarbutton-p", "title": "Is it possible to use base64 encode string as images for the CommandBarButton .Picture property in vba", "body": "<p>I'm using mscomctl.ocx in 32 bit version of Access, but facing problems with the imagelist resorce when converting to 64bit Office 365 version of Access.  </p>\n\n<p>32bit version we are using this code (with imagelist):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set cbItem = cmdBar.Controls.Add(1)\nWith cbItem\n    .Caption = \"Refresh\"\n    .OnAction = \"=fuPub_ExRefresh()\"\n    .Picture = imgListComBar.ListImages(\"Refresh\").Picture\n    .enabled = True\nEnd With\n</code></pre>\n\n<p>In 64 bit, is it possible to use something like this...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set cbItem = cmdBar.Controls.Add(1)\nWith cbItem\n    .Caption = \"Refresh\"\n    .OnAction = \"=fuPub_ExRefresh()\"\n    .Picture = ...some base64 string/object ??\n    .enabled = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1566983258, "post_id": 57688638, "comment_id": 101822375, "body": "Check your variable names, at first u got Datachecks, later datachecks. It may have impact."}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 10691224, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nVX4WVXMfak/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hgXOlgktdPzOQzrEev7sP635qTUQ/mo/photo.jpg?sz=128", "display_name": "Fnk", "link": "https://stackoverflow.com/users/10691224/fnk"}, "is_accepted": true, "score": 2, "last_activity_date": 1566984468, "creation_date": 1566984468, "answer_id": 57689152, "question_id": 57688638, "link": "https://stackoverflow.com/questions/57688638/check-if-string-is-contained-into-another-one/57689152#57689152", "title": "Check if string is contained into another one", "body": "<p>Are you mixing up the sequence. To me it seems your code is looking for \"datacheck\" in \"setdata\", while my understanding is that you are looking for \"setdata\" in \"datacheck\".</p>\n\n<pre><code>Dim a as String         'The string to look for\nDim b as String         'The string to look in\nDim c as Long\n\na = \"A\"\nb = \"aabb AbAb BAAb\"\n\nc = InStr(b,a)         'Function looking for the first occurrence of a in b\nPrint.Debug c          'This will give the value of 6, the location \"A\" first appears in string b.\n</code></pre>\n\n<p>BR\nFnk</p>\n"}], "owner": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 57689152, "answer_count": 1, "score": 0, "last_activity_date": 1566984468, "creation_date": 1566982788, "question_id": 57688638, "link": "https://stackoverflow.com/questions/57688638/check-if-string-is-contained-into-another-one", "title": "Check if string is contained into another one", "body": "<p>I have problems with one string and I would love to have some help.\nThrough iteration I get those htmlelement innertex:</p>\n\n<p>31-12-2017</p>\n\n<p>31-12-2016</p>\n\n<p>31-12-2015\nEtc.</p>\n\n<p>I would like that one string inserted through inputbox will be searched in those elements, but the string contains only the year (for example 2017).\nI tried to use instr and instrrev and in both case the string doesn't match even if there is.</p>\n\n<p>This is part of my code:</p>\n\n<pre><code>Dim setdata as String\nDim datacheck as mshtml.ihtmlelement\nDim datachecks as mshtml.ihtmlelementCollection\n\nSetdata = application.inputbox 'etc.\n\nDatachecks = iedoc.getelementbyclassname(\"example\") 'it finds all the date in the page (I checked through debug.print)'\n\nFor each datacheck in datachecks:\nIf instr(setdata, datacheck.innertext, vbtextcompare) then 'i also tried instrrev'\nDebug.print \"ok\"\nElse\nDebug.print \"no\"\nEnd if\nNext datacheck\n</code></pre>\n\n<p>I always get no even if through inputbox I insert 2017 and the element collection.contains 31-12-2017.\nCan you help me?</p>\n"}, {"tags": ["excel", "vba", "object", "pdf", "acrobat"], "answers": [{"comments": [{"owner": {"reputation": 1606, "user_id": 8884381, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WRNLHm93hTI/AAAAAAAAAAI/AAAAAAAAATA/6LF5hhHs_S8/photo.jpg?sz=128", "display_name": "Amit Gupta", "link": "https://stackoverflow.com/users/8884381/amit-gupta"}, "edited": false, "score": 0, "creation_date": 1567684681, "post_id": 57688619, "comment_id": 102041615, "body": "Thanks for reply , I did try , It was giving the same error message."}, {"owner": {"reputation": 1606, "user_id": 8884381, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WRNLHm93hTI/AAAAAAAAAAI/AAAAAAAAATA/6LF5hhHs_S8/photo.jpg?sz=128", "display_name": "Amit Gupta", "link": "https://stackoverflow.com/users/8884381/amit-gupta"}, "edited": false, "score": 0, "creation_date": 1567684915, "post_id": 57688619, "comment_id": 102041766, "body": "Getting run time error &quot; Active X Component Can&#39;t create object&quot;"}], "tags": [], "owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "is_accepted": false, "score": 0, "last_activity_date": 1566982722, "creation_date": 1566982722, "answer_id": 57688619, "question_id": 57688384, "link": "https://stackoverflow.com/questions/57688384/creating-and-closing-pdf-generates-error-when-trying-to-exit-acrobat-object/57688619#57688619", "title": "Creating and closing pdf generates error when trying to exit Acrobat object", "body": "<p>As I still cannot comment - have you tried this approach?</p>\n\n<pre><code>AcroApp.Exit\nSet AcroApp = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1606, "user_id": 8884381, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WRNLHm93hTI/AAAAAAAAAAI/AAAAAAAAATA/6LF5hhHs_S8/photo.jpg?sz=128", "display_name": "Amit Gupta", "link": "https://stackoverflow.com/users/8884381/amit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574375001, "creation_date": 1566981992, "last_edit_date": 1574375001, "question_id": 57688384, "link": "https://stackoverflow.com/questions/57688384/creating-and-closing-pdf-generates-error-when-trying-to-exit-acrobat-object", "title": "Creating and closing pdf generates error when trying to exit Acrobat object", "body": "<p>I am trying to create an instance of a pdf document and then close it.</p>\n\n<p>I added references in Tools->References.</p>\n\n<p>I am getting error at the last two lines as highlighted.</p>\n\n<pre><code>Dim AcroApp As New Acrobat.AcroApp\nDim PartDocs() As Acrobat.CAcroPDDoc\n.\n.\n.\nIf Not PartDocs(0) Is Nothing Then PartDocs(0).Close\nSet PartDocs(0) = Nothing\n\n'Quit Acrobat application\n**AcroApp.Close\nSet AcroApp = Nothing**\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 2, "creation_date": 1566983479, "post_id": 57688182, "comment_id": 101822496, "body": "If you have a script that runs at calculate, and a script that changes values, it might clash whey they both trigger at the same time. Try switching off auto-calculate for the duration of the macro and see if that performs any better. <a href=\"https://stackoverflow.com/questions/49743732/turn-on-off-automatic-calculation-in-only-a-few-columns-in-excel\" title=\"turn on off automatic calculation in only a few columns in excel\">stackoverflow.com/questions/49743732/&hellip;</a>"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1566986158, "post_id": 57688182, "comment_id": 101823946, "body": "When using an event to trigger your code, it&#39;s usually a good idea to turn off event processing within your routine to avoid getting into a recursive loop. Application.EnableEvents=false at the beginning and =true at the end"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4495981, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001527811017/picture?type=large", "display_name": "Asxulxet", "link": "https://stackoverflow.com/users/4495981/asxulxet"}, "is_accepted": false, "score": 0, "last_activity_date": 1567012774, "creation_date": 1567012774, "answer_id": 57697281, "question_id": 57688182, "link": "https://stackoverflow.com/questions/57688182/my-script-breaks-excels-calculation-can-someone-help-me-identify-whats-wrong-w/57697281#57697281", "title": "My script breaks Excel&#39;s calculation can someone help me identify what&#39;s wrong with it?", "body": "<p>I followed the advice of Harassed Dad and put Application.EnableEvents = FALSE at the very beginning of the script and = TRUE at the very end. It did the trick. I didn't think that changing values would trigger calculation before the script had finished. Thanks guys.</p>\n"}], "owner": {"reputation": 1, "user_id": 4495981, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001527811017/picture?type=large", "display_name": "Asxulxet", "link": "https://stackoverflow.com/users/4495981/asxulxet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567012774, "creation_date": 1566981352, "question_id": 57688182, "link": "https://stackoverflow.com/questions/57688182/my-script-breaks-excels-calculation-can-someone-help-me-identify-whats-wrong-w", "title": "My script breaks Excel&#39;s calculation can someone help me identify what&#39;s wrong with it?", "body": "<p>I've set up a VBA code that sets up a form for the user to fill out information. I've set up another VBA code that runs upon sheet calculation that runs some checks and corrections to any information that is out of line. As soon as the second code runs all sheet calculation stops and I can only edit the first unlocked cell, even when sheet protection is off and I have selected another cell. All typing goes to the first unlocked cell. </p>\n\n<p>This script has worked when triggered by selection change or by running the script manually. I've searched the internet but all I find are list of settings (all of which I have checked).</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n'Transfer\n'\n\nIf Range(\"AAA1\").Value = \"Transfer\" And Range(\"AAB1\").Value = \"Not Empty\" Then\n    If Range(\"D3\").Value = \"0\" Or Range(\"D3\").Value = \"\" Then\n        Range(\"AAB1\").Value = \"Empty\"\n    End If\nEnd If\nIf Range(\"AAA1\").Value = \"Transfer\" And Range(\"AAB1\").Value = \"Empty\" Then\n    If Range(\"E3\").Value = Empty Or Range(\"F3\").Value = Empty Then\n        Else\n        Range(\"D3\").Value = Range(\"AA3\").Value\n        Range(\"AAB1\").Value = \"Not Empty\"\n    End If\nEnd If\nIf Range(\"D3\").Value &gt; Range(\"AA3\").Value And Range(\"AAA1\").Value = \"Transfer\" Then\n    Range(\"D3\").Value = Range(\"AA3\").Value\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The expected result is for cell D3's value to be automatically set to the max value (calculated in cell AA3 using the value in cell E3) when both cells E3 and F3 have been filled out and cell D3 is either empty or equal to zero. I use cell AAB1 as a \"switch\" so that the user can enter a custom amount without a hasle. Cell AAA1 is set by the first macro that sets up the form. It all works once. Then I encounter the problem described above.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": true, "score": 1, "last_activity_date": 1566985925, "creation_date": 1566985925, "answer_id": 57689605, "question_id": 57688086, "link": "https://stackoverflow.com/questions/57688086/excel-vba-copy-listobject-values-between-workbooks/57689605#57689605", "title": "Excel VBA - Copy Listobject values between workbooks", "body": "<p>You are passing <code>sha</code> as <strong>worksheet object</strong>, it must have always be either from owb or nwb.</p>\n\n<p>To correct it, you can use <code>sha.name</code></p>\n\n<pre><code>With nwb\n    Set nrng = sheets(sha.name).ListObjects(lis)\n    nrng.AutoFilter.ShowAllData\nEnd With\n</code></pre>\n\n<p>Otherwise, you can pass the worksheet name as a <strong>String</strong></p>\n\n<p>And bind the listobject this way</p>\n\n<pre><code>With owb\n    Set orng = Sheets(sha).ListObjects(lis)\n    orng.AutoFilter.ShowAllData\nEnd With\n\nWith nwb\n    Set nrng = Sheets(sha).ListObjects(lis)\n    nrng.AutoFilter.ShowAllData\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57689605, "answer_count": 1, "score": 0, "last_activity_date": 1567433446, "creation_date": 1566980978, "last_edit_date": 1567433446, "question_id": 57688086, "link": "https://stackoverflow.com/questions/57688086/excel-vba-copy-listobject-values-between-workbooks", "title": "Excel VBA - Copy Listobject values between workbooks", "body": "<p>I am using this code which works fine on the same workbook. </p>\n\n<pre><code>Sub san_import(owb As Workbook, nwb As Workbook, sha As Worksheet, lis As String, col As Long, res As Long, Optional ByVal off As Long = 0)\nDim orng As ListObject\nDim nrng As ListObject\nDim r_fix As Long\nDim c_fix As Long\nDim i, o As Long\n\nWith owb\n    Set orng = sha.ListObjects(lis)\n    orng.AutoFilter.ShowAllData\nEnd With\n\nWith nwb\n    Set nrng = sha.ListObjects(lis)\n    nrng.AutoFilter.ShowAllData\nEnd With\n\nr_fix = orng.ListRows.Count - nrng.ListRows.Count\nc_fix = orng.ListColumns.Count - nrng.ListColumns.Count\n\nWith nwb\n    If r_fix &gt; 0 Then\n        For i = 1 To r_fix\n           nrng.ListRows.Add AlwaysInsert:=True\n        Next i\n    End If\n\n    If c_fix &gt; 0 Then\n        For o = 1 To c_fix\n           nrng.ListColumns.Add\n        Next o\n    End If\n\n    sha.Activate\n    sha.Range(\"A1\").Select\nEnd With\n\nnrng.DataBodyRange.Offset(off).ClearContents\nnrng.DataBodyRange.Offset(off).Columns(col).Resize(, res).Value2 = orng.DataBodyRange.Offset(off).Columns(col).Resize(, res).Value2\n\nApplication.StatusBar = \"Processing \" &amp; sha.Name &amp; \"...\"\nEnd Sub\n</code></pre>\n\n<p>The problem arises when working with two different workbooks because the Listobject <code>orng</code> is not successfully set for the old workbook. I have tried different variations including activating the old workbook first, but none worked. Any help would be much appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1566980844, "post_id": 57687931, "comment_id": 101821002, "body": "I guess the only part that changes depending on the value of column G is line <code>.To = Sheets(&quot;Statuses&quot;).Range(&quot;H6&quot;).Value &amp; &quot;;&quot; &amp; Sheets(&quot;Statuses&quot;).Range(&quot;I6&quot;).Value</code>? In that case, make a secondary sub with a parameter related to this value, and call it from main Sub"}], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1566996174, "last_edit_date": 1566996174, "creation_date": 1566984480, "answer_id": 57689153, "question_id": 57687931, "link": "https://stackoverflow.com/questions/57687931/if-loops-on-excel-for-multiple-options/57689153#57689153", "title": "If loops on Excel for multiple options", "body": "<p>For demonstration purposes I will only show you how to create the <code>.To</code> field , without using all those <code>if-statements</code>. You can then build this logic into your existing code. For the sake of simplicity, I will assume that your set up in the first worksheet looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kdf8R.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kdf8R.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and on the <code>Statuses</code> worksheet, the setup looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aoYnD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aoYnD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In this case you can just use a lookup function like so:</p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim rng As Range, cell As Range\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim sendTo As String\nDim lookUpRng As Range\nDim emailsRng1 As Range\nDim emailsRng2 As Range\nSet sht1 = ThisWorkbook.Worksheets(\"Name of your worksheet\")\nSet sht2 = ThisWorkbook.Worksheets(\"Statuses\")\nSet lookUpRng = sht2.Range(\"G3:G27\")\nSet emailsRng1 = sht2.Range(\"H3:H27\")\nSet emailsRng2 = sht2.Range(\"I3:I27\")\n\nWith sht1\n    Set rng = Range(.Range(\"B3\"), .Range(\"B\" &amp; .Rows.Count).End(xlUp))\nEnd With\n\nFor Each cell In rng\n    sendTo = Application.WorksheetFunction.Lookup(cell.Value, lookUpRng, emailsRng1) &amp; \"; \" &amp; Application.WorksheetFunction.Lookup(cell.Value, lookUpRng, emailsRng2)\n    Debug.Print sendTo\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>The result would look like that:</p>\n\n<pre><code>email1.14; email2.14\nemail1.15; email2.15\nemail1.16; email2.16\nemail1.21; email2.21\nemail1.22; email2.22\nemail1.19; email2.19\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.19; email2.19\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.1; email2.1\nemail1.1; email2.1\nemail1.13; email2.13\nemail1.22; email2.22\nemail1.23; email2.23\nemail1.24; email2.24\nemail1.25; email2.25\nemail1.1; email2.1\nemail1.19; email2.19\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.17; email2.17\nemail1.18; email2.18\nemail1.19; email2.19\nemail1.20; email2.20\nemail1.1; email2.1\nemail1.1; email2.1\nemail1.22; email2.22\nemail1.23; email2.23\nemail1.25; email2.25\nemail1.1; email2.1\nemail1.25; email2.25\nemail1.25; email2.25\nemail1.25; email2.25\n</code></pre>\n\n<p>Another approach would be to define a <code>dictionary</code> and set up its <code>keys</code> to be the 25 options and the strings composed of the corresponding email addresses to be the <code>values</code>:</p>\n\n<pre><code>Dim dict As New Dictionary\n\nFor Each cell In lookUpRng\n    dict.Add cell.Value, cell.Offset(0, 1).Value &amp; \"; \" &amp; cell.Offset(0, 2).Value\nNext cell\nFor Each cell In rng\n    Debug.Print dict(cell.Value)\nNext cell\n</code></pre>\n\n<p>For that you would need a reference to <code>Microsoft Scripting Runtime</code> (VB editor>tools>references).</p>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 10691224, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nVX4WVXMfak/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hgXOlgktdPzOQzrEev7sP635qTUQ/mo/photo.jpg?sz=128", "display_name": "Fnk", "link": "https://stackoverflow.com/users/10691224/fnk"}, "is_accepted": false, "score": 0, "last_activity_date": 1566986947, "creation_date": 1566986947, "answer_id": 57689953, "question_id": 57687931, "link": "https://stackoverflow.com/questions/57687931/if-loops-on-excel-for-multiple-options/57689953#57689953", "title": "If loops on Excel for multiple options", "body": "<p>Assuming the only thing changing here is G6, H&amp;, I6 to G7, H7, I7 and so on for the next 25 options, can you then do a for loop within the for loop:</p>\n\n<pre><code>For i = 3 To r\n    With Cells(i, 1)\n\n        For x = 6 To 31\n\n            If .Value &lt;&gt; \"\" And Cells(i, 2) = Sheets(\"Statuses\").Range(\"G\" &amp; x).Value Then\n                Set objOutlook = CreateObject(\"Outlook.Application\")\n                Set objMail = objOutlook.CreateItem(0)\n\n                With objMail\n                    .SentOnBehalfOfName = \"xxx@xxx.com\"\n                    .To = Sheets(\"Statuses\").Range(\"H\" &amp; x).Value &amp; \";\" &amp; Sheets(\"Statuses\").Range(\"I\" &amp; x).Value\n                    .CC = \"xxx@xxx.com\"\n                    .Subject = \"Your \" &amp; Cells(i, 5).Value &amp; \" licence - \" &amp; Cells(i, 4).Value\n                    .HTMLBody = \"Dear \" &amp; Cells(i, 2) &amp; body &amp; Cells(i, 26).Text &amp; \" defect charges.\" &amp; body2 &amp; Cells(i, 27).Text &amp; body3\n                    .Display\n\n                End With\n            End If\n\n        Next x        \n\n    End With\nNext i\n</code></pre>\n\n<p>Good luck\nBR\nFnk</p>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566996174, "creation_date": 1566980456, "question_id": 57687931, "link": "https://stackoverflow.com/questions/57687931/if-loops-on-excel-for-multiple-options", "title": "If loops on Excel for multiple options", "body": "<p>I have the below code set up to draft an email based on the value in column B which works fine. (If there is any text in column A it will run this) </p>\n\n<p>Column B could have any of 25 options which are on the <code>Statuses</code> worksheet also, alongside the relevant email address relating to each option which is then entered  in the <code>.To</code> field. I'm wondering if there's any way that I can run the if loop without having to write each section out and amend 25 times (the below code shows two of the 25)</p>\n\n<pre><code>Option Explicit\nOption Compare Text 'ignore case sensitivity when comparing strings\n\nSub SendDraft()\n\nDim objOutlook As Object\nDim objMail As Object\nDim OL As Outlook.Application, ES As Worksheet, r As Long, i As Long\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\nDim path As String\nDim body As String\nDim body2 As String\nDim body3 As String\nDim body4 As String\n\n\nbody = \",&lt;br&gt;&lt;br&gt;Please find attached a draft invoice for \"\nbody2 = \"&lt;br&gt;&lt;br&gt;Please respond with any agreement or dispute no later than 4:30pm on &lt;b&gt;\"\nbody3 = \"&lt;/b&gt;, otherwise a full invoice will be raised to the value of the attached draft.&lt;br&gt;&lt;br&gt;Many thanks,\"\n\n\n    r = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 3 To r\n    With Cells(i, 1)\n\n            If .Value &lt;&gt; \"\" And Cells(i, 2) = Sheets(\"Statuses\").Range(\"G6\").Value Then\n                    Set objOutlook = CreateObject(\"Outlook.Application\")\n                    Set objMail = objOutlook.CreateItem(0)\n                    With objMail\n                    .SentOnBehalfOfName = \"xxx@xxx.com\"\n                    .To = Sheets(\"Statuses\").Range(\"H6\").Value &amp; \";\" &amp; Sheets(\"Statuses\").Range(\"I6\").Value\n                    .CC = \"xxx@xxx.com\"\n                    .Subject = \"Your \" &amp; Cells(i, 5).Value &amp; \" licence - \" &amp; Cells(i, 4).Value\n                    .HTMLBody = \"Dear \" &amp; Cells(i, 2) &amp; body &amp; Cells(i, 26).Text &amp; \" defect charges.\" &amp; body2 &amp; Cells(i, 27).Text &amp; body3\n                    .Display\n\nEnd With\nEnd If\n\nIf .Value &lt;&gt; \"\" And Cells(i, 2) = Sheets(\"Statuses\").Range(\"G7\").Value Then\n                    Set objOutlook = CreateObject(\"Outlook.Application\")\n                    Set objMail = objOutlook.CreateItem(0)\n                    With objMail\n                    .SentOnBehalfOfName = \"xxx@xxx.com\"\n                    .To = Sheets(\"Statuses\").Range(\"H7\").Value &amp; \";\" &amp; Sheets(\"Statuses\").Range(\"I7\").Value\n                    .CC = \"xxx@xxx.com\"\n                    .Subject = \"Your \" &amp; Cells(i, 5).Value &amp; \" licence - \" &amp; Cells(i, 4).Value\n                    .HTMLBody = \"Dear \" &amp; Cells(i, 2) &amp; body &amp; Cells(i, 26).Text &amp; \" defect charges.\" &amp; body2 &amp; Cells(i, 27).Text &amp; body3\n                    .Display\n\nEnd With\nEnd If\nEnd With\n\nNext i\n\nIf WorksheetFunction.CountA(Range(\"a3:a1000\")) = 0 Then\n        MsgBox \"No draft charge(s) to send - please enter text in column A for the appropriate draft charge(s) you wish to send.\"\nEnd If\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "userform"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1566984418, "post_id": 57687472, "comment_id": 101823016, "body": "Don&#39;t use underscores in method names! <code>Application.Run &quot;&#39;&quot; &amp; xlWb.Name &amp; &quot;&#39;!Apps.RefreshUserForm&quot;</code>will work."}, {"owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1566988026, "post_id": 57687472, "comment_id": 101825012, "body": "I &#39;ve tried this first but there was no change at all. Thank you though."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1566988818, "post_id": 57687472, "comment_id": 101825449, "body": "Strange. Now it works for me to with underscore, but it stopped working as I added one to function. Never the less, don&#39;t use underscores in methods as at least when you use interfaces, it fails see <a href=\"https://rubberduckvba.wordpress.com/2019/03/27/everything-you-ever-wanted-to-know-about-events/\" rel=\"nofollow noreferrer\">rubberduckvba.wordpress.com/2019/03/27/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1566984348, "creation_date": 1566984348, "answer_id": 57689118, "question_id": 57687472, "link": "https://stackoverflow.com/questions/57687472/how-to-reference-an-excel-userform-from-access-vba/57689118#57689118", "title": "How to reference an Excel UserForm from Access VBA", "body": "<p>Please try the following:</p>\n\n<p>In userform2, add a \"Refresh\" button and the following procedure:</p>\n\n<pre><code>Private Sub CommandButton_Refresh_Click()\n    Me.Repaint\nEnd Sub\n</code></pre>\n\n<p>If you have a <code>UserForm_Initialize</code> sub and <code>UserForm_Terminate</code> sub , you can include the procedures to simulate the unload-reload action.</p>\n\n<pre><code>Private Sub CommandButton_Refresh_Click()\n    Call UserForm_Terminate\n    Call UserForm_Initialize\n    Me.Repaint\nEnd Sub\n</code></pre>\n\n<p>If you need to unload the form and call it back later manually, then you will have to call it back from the actual loaded Excel window (e.g. with a form Button on the worksheet), but cannot be from Access or the xlWb hook.</p>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "edited": false, "score": 2, "creation_date": 1566987933, "post_id": 57689721, "comment_id": 101824969, "body": "The mistake was that I used the word &quot;Application&quot; to run the macro, as this refers to the Access application. Finally I replaced it with this: <code>AppXl.Run &quot;&#39;&quot; &amp; xlWb.Name &amp; &quot;&#39;!Apps.Refresh_UserForm&quot;</code> where <code>AppXl</code> is the object I had already declared to open the Excel application. I &#39;m marking this as the answer, because that&#39;s exactly the point. Thank you all for your time."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1566987105, "last_edit_date": 1566987105, "creation_date": 1566986258, "answer_id": 57689721, "question_id": 57687472, "link": "https://stackoverflow.com/questions/57687472/how-to-reference-an-excel-userform-from-access-vba/57689721#57689721", "title": "How to reference an Excel UserForm from Access VBA", "body": "<p>So this works for me:</p>\n\n<hr>\n\n<p><strong>Note</strong>: for demonstration purposes I created a xlsm file called \"Map1.xlsm\" with a userform called \"UserForm1\". Also, you'll need the \"Microsoft Excel 16.0 Object Library\" reference turned on.</p>\n\n<hr>\n\n<p>First, as mentioned above I created an Excel file with the below macro in Module1:</p>\n\n<p><strong>1).</strong> To open the UserForm for the first time (and refresh):</p>\n\n<pre><code>Sub Refresh_UserForm()\n    Unload UserForm1\n    UserForm1.Show False\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Within Access-VBA I created the following two macros (based on <a href=\"https://stackoverflow.com/a/32955714/9758194\">this</a>):</p>\n\n<p><strong>1).</strong> To open and use the Excel UserForm</p>\n\n<pre><code>Option Compare Database\nDim xlApp As Excel.Application, xlWB As Excel.Workbook\n\nSub mySub()\n    Set xlApp = CreateObject(\"Excel.Application\")\n    Set xlWB = xlApp.Workbooks.Open(\"C:\\...Path...\\Map1.xlsm\") 'Specify Path\n    xlApp.Visible = True\n    xlApp.Run \"Map1.xlsm!Refresh_UserForm\"\nEnd Sub\n</code></pre>\n\n<p><strong>2).</strong> To Refresh the Excel UserForm</p>\n\n<pre><code>Sub Refrsh()\n    Set xlApp = GetObject(, \"Excel.Application\")\n    xlApp.Run \"Map1.xlsm!Refresh_UserForm\"\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Hopefully this helps</p>\n"}], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 57689721, "answer_count": 2, "score": 2, "last_activity_date": 1566987105, "creation_date": 1566978811, "last_edit_date": 1566986553, "question_id": 57687472, "link": "https://stackoverflow.com/questions/57687472/how-to-reference-an-excel-userform-from-access-vba", "title": "How to reference an Excel UserForm from Access VBA", "body": "<h2>CASE:</h2>\n\n<ul>\n<li>I have created an Access database.</li>\n<li>Using Access-VBA I open an Excel workbook to do stuff.</li>\n<li>This workbook (<code>xlWb</code>) does complex calculations and also loads an Excel Userform (<code>UserForm2</code>) on open.</li>\n<li>So far everything OK. I open <code>xlWb</code>, <code>UserForm2</code> loads, I do stuff.</li>\n</ul>\n\n<h2>GOAL:</h2>\n\n<ul>\n<li><p>After this, I need to \"refresh\" <code>Userform2</code>.</p></li>\n<li><p>By the term \"refresh\" I mean either call a custom sub of this UserForm, or unload and reload <code>UserForm2</code>.</p></li>\n</ul>\n\n<h2>QUESTION:</h2>\n\n<ul>\n<li>How can I can reference <code>UserForm2</code> from my Access-VBA code? </li>\n</ul>\n\n<h2>WHAT I 'VE TRIED:</h2>\n\n<p>By searching I 've only found how to reference a UserForm from\n   another workbook.</p>\n\n<ul>\n<li>The first suggestion was to use <code>VBA.UserForms</code> to get a loaded UserForm.</li>\n</ul>\n\n<p>So I 've tried the following references: <code>VBA.UserForms(\"UserForm2\")</code>, <code>VBA.UserForms.Item(\"UserForm2\")</code>, <code>VBA.UserForms(0)</code>, <code>VBA.UserForms(1)</code>, all of which threw error: \"subscript out of range\", which implies that what I 'm writing is not a member of the collection.</p>\n\n<ul>\n<li>Another suggestion was to create a function that loads and unloads the object.</li>\n</ul>\n\n<p>So I wrote inside an <code>xlWb</code>'s module named <code>Apps</code> this:</p>\n\n<pre><code>Public Sub Refresh_UserForm()\n    Unload Userform2\n    Userform2.Show\nEnd Sub\n</code></pre>\n\n<p>and in the access sub this:</p>\n\n<pre><code>Application.Run \"'\" &amp; xlWb.Name &amp; \"'!Apps.Refresh_UserForm\"\n</code></pre>\n\n<p>This throws a </p>\n\n<blockquote>\n  <p>Run-time error 2517 cannot find the procedure\n  'calc_8.4.xls'!Apps.Refresh_UserForm'</p>\n</blockquote>\n\n<ul>\n<li>The same error is also generated when I tried a 3rd similar suggestion to create a function that returns an instance of the object.</li>\n</ul>\n\n<p>Every suggestion is very welcome thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1566978761, "post_id": 57687333, "comment_id": 101819922, "body": "You cannot select an invisible sheet. BTW you should avoid using Select at all."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1566979484, "post_id": 57687333, "comment_id": 101820259, "body": "Note that username can be up to <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/bb726984(v=technet.10)\" rel=\"nofollow noreferrer\">104 characters</a> but sheets names are limited to <a href=\"https://stackoverflow.com/questions/3681868/is-there-a-limit-on-an-excel-worksheets-name-length\">31 characters.</a> And I&#39;m not sure if the allowed chars are the same for the two."}], "answers": [{"comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1566980733, "post_id": 57687456, "comment_id": 101820934, "body": "To add to this, add the following to your &#39;this workbook&#39; object to hide the sheet upon workbook close. Otherwise it will still be open when the next person uses the workbook. <code>Private Sub Workbook_BeforeClose(Cancel As Boolean) ActiveWorkbook.Sheets(Environ(&quot;Username&quot;)).Visible = xlSheetVeryHidden End Sub</code>"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 3, "last_activity_date": 1566981257, "last_edit_date": 1566981257, "creation_date": 1566978754, "answer_id": 57687456, "question_id": 57687333, "link": "https://stackoverflow.com/questions/57687333/is-there-a-method-to-pass-the-name-of-the-sheet-to-sheet-select-function-via-a-s/57687456#57687456", "title": "Is there a method to Pass the name of the sheet to Sheet.select function via a string Variable?", "body": "<p>You cannot select a sheet that is Hidden. So you have to un-hide it First.</p>\n\n<p><strong>Use this:</strong></p>\n\n<pre><code>Sub Display_User_Specific_data()\n    Dim User_Name As String\n    User_Name = Environ(\"Username\")\n    ActiveWorkbook.Sheets(User_Name).Visible = xlSheetVisible\nEnd Sub\n</code></pre>\n\n<ul>\n<li>Also, Keep in mind that the user name will be of the form <code>mohit.bansal</code> if the name is <code>Mohit Bansal</code> , so your sheet name should be <strong><code>mohit.bansal</code></strong></li>\n</ul>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ssrdw.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ssrdw.gif\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Addition by @Pulitian</strong></p>\n\n<ul>\n<li>To add to this, add the following to your 'this workbook' object to hide the sheet upon workbook close. Otherwise it will still be open when the next person uses the workbook.</li>\n</ul>\n\n<hr>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean) \n    ActiveWorkbook.Sheets(Environ(\"Username\")).Visible = xlSheetVeryHidden \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10428953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f3gzUMeuE5w/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVEj2vNHMQNxlV4hfZb6Ip9ceUzyA/mo/photo.jpg?sz=128", "display_name": "Abhishek Singh", "link": "https://stackoverflow.com/users/10428953/abhishek-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 57687456, "answer_count": 1, "score": 1, "last_activity_date": 1566981257, "creation_date": 1566978275, "last_edit_date": 1566978612, "question_id": 57687333, "link": "https://stackoverflow.com/questions/57687333/is-there-a-method-to-pass-the-name-of-the-sheet-to-sheet-select-function-via-a-s", "title": "Is there a method to Pass the name of the sheet to Sheet.select function via a string Variable?", "body": "<p>I'm having a Workbook in which all sheets are hidden except a Base sheet <code>\"CRM_Competencies_Dashboard\"</code></p>\n\n<p>As soon as the user logs in I will pull the user id with <code>Environ(\"Username\")</code> function. Then I will store that value in a string variable <code>\"User_Name\"</code></p>\n\n<p>Now my goal is to Un-hide only that sheet.</p>\n\n<p>And there are a list of users who will access this workbook.\nEvery-time they open only their respective sheet should be visible</p>\n\n<p>I tried to Un-hide the sheet by using the below function but I didn't get a way to pass the sheet name as a variable as shown below</p>\n\n<pre><code>Sub Display_User_Specific_data()\nDim User_Name As String\nUser_Name = Environ(\"Username\")\nActiveWorkbook.Sheets(User_Name).Select\nActiveSheet.Visible = xlSheetVisible\nEnd Sub\n</code></pre>\n\n<p><code>Sheets(User_Name)</code> should become un-hidden. And the value of variable User_Name can change for different users.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1566979042, "post_id": 57687210, "comment_id": 101820059, "body": "Your question lacks any efforts of solving the problem yourself. Please take the  <a href=\"https://stackoverflow.com/tour\">tour</a> and learn <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a Good Question</a>, then edit your question and provide more detail before it gets locked."}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1566985343, "creation_date": 1566985343, "answer_id": 57689413, "question_id": 57687210, "link": "https://stackoverflow.com/questions/57687210/search-for-a-value-in-a-column-and-copy-row-to-new-sheet/57689413#57689413", "title": "Search for a value in a column and copy row to new sheet", "body": "<p>You can try this code:</p>\n\n<pre><code>Sub DataToSourceExtract()\n    Sheets(\"Data\").Columns(1).Find(\"Dest\").Resize(2).EntireRow.Copy _\n        Sheets(\"Source Extract\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10031790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c1e22cff28b7bb1d388cf930b2fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "niki1419", "link": "https://stackoverflow.com/users/10031790/niki1419"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1567433454, "creation_date": 1566977850, "last_edit_date": 1567433454, "question_id": 57687210, "link": "https://stackoverflow.com/questions/57687210/search-for-a-value-in-a-column-and-copy-row-to-new-sheet", "title": "Search for a value in a column and copy row to new sheet", "body": "<p>I have two sheets, 'Data' and 'Source extract'. I want a code to search for keyword 'Dest' in 1st column from sheet'Data' and copy entire row and its next row to Source extract B column</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 0, "creation_date": 1566977947, "post_id": 57687005, "comment_id": 101819517, "body": "Thank you for the help. Is there a reason for this, why does this make sense? And if I use the variables <code>var1</code>, <code>var2</code>, <code>var3</code> for nothing more than what I&#39;ve shown in my code, is there a reason I should use an array? Simply writing <code>var1 = True</code>, <code>var2 = True</code>, <code>var3 = True</code> would be fewer lines."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 1, "creation_date": 1566978378, "post_id": 57687005, "comment_id": 101819738, "body": "Like @Patrick Honorez said below, it is a copy of you variables, not a reference. In this case there is no need to do array or loop. It is simple case in which You can deal just like You wrote above."}, {"owner": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 1, "creation_date": 1566979064, "post_id": 57687005, "comment_id": 101820068, "body": "And it&#39;s impossible to put them as a reference in the array?"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 1, "creation_date": 1566979469, "post_id": 57687005, "comment_id": 101820255, "body": "I&#39;m not 100% sure, but rather not. Instead of array try scripting.dictionary object. Maybe it will help You to improve / move further with this topic :) <a href=\"https://stackoverflow.com/questions/17453272/how-do-i-reference-the-value-in-an-array-as-a-variable\" title=\"how do i reference the value in an array as a variable\">stackoverflow.com/questions/17453272/&hellip;</a>"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 0, "creation_date": 1574073163, "post_id": 57687005, "comment_id": 104087071, "body": "I described this problem also here <a href=\"https://simpleexcelvba.com/change-variables-value-in-array/\" rel=\"nofollow noreferrer\">simpleexcelvba.com/change-variables-value-in-array</a>"}], "tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": true, "score": 6, "last_activity_date": 1566977126, "creation_date": 1566977126, "answer_id": 57687005, "question_id": 57686894, "link": "https://stackoverflow.com/questions/57686894/vba-change-value-of-variables-in-an-array/57687005#57687005", "title": "VBA: Change value of variables in an array", "body": "<p>Assigning \"True\" to every element of array does not make your variables same value.\nNothing weird your var1 is still False, because You didn't change the value of var1, but the value of your array elements. :)</p>\n\n<p>Add something like this</p>\n\n<pre><code>var1 = arrTest(0)\nvar2 = arrTest(1)\nvar3 = arrTest(2)\n\nTest2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 4, "last_activity_date": 1566977337, "creation_date": 1566977337, "answer_id": 57687067, "question_id": 57686894, "link": "https://stackoverflow.com/questions/57686894/vba-change-value-of-variables-in-an-array/57687067#57687067", "title": "VBA: Change value of variables in an array", "body": "<p>When you do <code>arrTest = Array(var1, var2, var3)</code> you <strong>copy the values</strong> of your variables into the arrTest. You do NOT create a reference to those variables.  </p>\n\n<p>Since arrTest is declared in Test() its scope is limited to Test().  </p>\n\n<p>If you declare arrTest at the module level, you will be able to check arrTest values from Test2. But anyway they will be completely independent from varx.  </p>\n\n<p>The behaviour is different if we speak about <code>Objects</code>. When we write <code>Set x = obj1</code> we DO <strong>create a reference</strong>, and in that case a change in obj1 will be visible in x.</p>\n"}, {"comments": [{"owner": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 0, "creation_date": 1566979493, "post_id": 57687625, "comment_id": 101820264, "body": "But using variables inside the array (as a reference and not as a copy) is not possible?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 1, "creation_date": 1566980352, "post_id": 57687625, "comment_id": 101820723, "body": "@Alex - anything is possible with VBA, just the work around could be a bit more."}, {"owner": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 1, "creation_date": 1566992443, "post_id": 57687625, "comment_id": 101827371, "body": "I haven&#39;t done anything with <code>Container</code> objects, so I gotta familiarize myself with it, but in some way that&#39;s even better because I&#39;m gonna learn something new. Thank you!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "edited": false, "score": 1, "creation_date": 1567009788, "post_id": 57687625, "comment_id": 101837544, "body": "@Alex - <code>Container</code> is just a name of the class, it is not a real <code>Container</code>. It can be changed to anything else."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1567009823, "last_edit_date": 1567009823, "creation_date": 1566979359, "answer_id": 57687625, "question_id": 57686894, "link": "https://stackoverflow.com/questions/57686894/vba-change-value-of-variables-in-an-array/57687625#57687625", "title": "VBA: Change value of variables in an array", "body": "<p><code>arrTest</code> is a local variant variable for the <code>Test</code> sub. And this variable takes some public boolean values in it, which <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/modifiers/byval\" rel=\"nofollow noreferrer\">are passed ByVal</a>. If the array is declared outside the Subs itself, then it would be accessible from everywhere, exactly the way it is intended:</p>\n\n<pre><code>Option Explicit\nOption Base 0\n\nDim arrTest() As Variant\n\nSub Test()\n\n    Dim i\n    arrTest = Array(False, False, False)\n\n    For Each i In arrTest\n        Debug.Print i\n    Next\n\n    For i = LBound(arrTest) To UBound(arrTest)\n        arrTest(i) = True\n    Next\n\n    For Each i In arrTest\n        Debug.Print i\n    Next\n\n    Test2\n\nEnd Sub\n\nSub Test2()\n    Debug.Print arrTest(LBound(arrTest)) 'or arrTest(0)\nEnd Sub\n</code></pre>\n\n<p><strong>If you need to use variables inside array and pass them as a reference</strong>, and not as a copy, the OOP in VBA may help. Create a class \"Container\", holding a property <code>SomeValue</code>, encapsulated in <code>valueKept</code>. Creating <code>Class</code> is like creating a <code>Module</code> in VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3ehWx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3ehWx.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private valueKept As String\n\nPublic Property Get SomeValue() As String    \n    SomeValue = valueKept    \nEnd Property\n\nPublic Property Let SomeValue(ByVal myValue As String)    \n    valueKept = myValue    \nEnd Property\n</code></pre>\n\n<p>Then the <code>SomeValue</code> property of this class, could be changed ByRef, when the <code>Container</code> object is put in array:</p>\n\n<pre><code>Sub Test()\n\n    Dim myArr As Variant\n    Dim c1 As New Container\n    Dim c2 As New Container\n\n    c1.SomeValue = 5\n    c2.SomeValue = 10\n\n    myArr = Array(c1, c2)\n\n    Test2 myArr\n    Debug.Print c1.SomeValue '55\n\nEnd Sub\n\nSub Test2(myArr As Variant)\n    myArr(0).SomeValue = 55\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 10602575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81ece9bf2bbb7a3378a8986e2b9dc75?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10602575/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 0, "accepted_answer_id": 57687005, "answer_count": 3, "score": 7, "last_activity_date": 1567009823, "creation_date": 1566976688, "question_id": 57686894, "link": "https://stackoverflow.com/questions/57686894/vba-change-value-of-variables-in-an-array", "title": "VBA: Change value of variables in an array", "body": "<p>How do I permanently change the value of a variable in an array? I wrote some code that illustrates my problem:</p>\n\n<pre><code>Option Explicit\n    Dim var1 As Boolean, var2 As Boolean, var3 As Boolean\n\nSub Test()\n    Dim arrTest As Variant\n    Dim i\n\n    arrTest = Array(var1, var2, var3)\n\n    For Each i In arrTest\n        Debug.Print i\n    Next\n\n    For i = LBound(arrTest) To UBound(arrTest)\n        arrTest(i) = True\n    Next\n\n    For Each i In arrTest\n        Debug.Print i\n    Next\n\n    Test2\nEnd Sub\n\n\nSub Test2()\n    Debug.Print \"var1 in Sub Test2 : \" &amp; var1\n    If var1 Then\n        Debug.Print \"Hello\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><em>The output in the direct window is:</em> </p>\n\n<pre><code>False\nFalse\nFalse\nTrue\nTrue\nTrue\nvar1 in Sub Test2 : False\n</code></pre>\n\n<p>The first six lines make sense to me because I changed the value of the variables in <code>Test</code>. However, it obviously wasn't permanent or it was confined to that one sub and so \"Hello\" in <code>Test2</code> didn't get printed. </p>\n\n<p>How do I change this? I've read that <code>for each</code> loops are read-only, but why does the <code>for</code>-loop not work?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1566976819, "post_id": 57686791, "comment_id": 101819007, "body": "You tried If Application.WorksheetFunction.Subtotal(103, Worksheets(&quot;Database&quot;).ListObjects(&quot;Table1&quot;).ListColumns(1).&zwnj;&#8203;DataBodyRange) &gt;0 Then &quot;do something as not empty...&quot;  Else ........"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1566977072, "post_id": 57686791, "comment_id": 101819126, "body": "As far as my tests shows, DataBodyRange is always the full table body range, even when filtered."}, {"owner": {"reputation": 11, "user_id": 11987562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jV2Tjj2O974/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdxx-_DfLHtINQ00nfLXU8aXpotnw/photo.jpg?sz=128", "display_name": "Wiktor", "link": "https://stackoverflow.com/users/11987562/wiktor"}, "edited": false, "score": 0, "creation_date": 1566987134, "post_id": 57686791, "comment_id": 101824544, "body": "I&#39;ve tried Applications.WorksheetFunction.... but unfortunately after change it doesn&#39;t copy anything, even if there are comments."}], "owner": {"reputation": 11, "user_id": 11987562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jV2Tjj2O974/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdxx-_DfLHtINQ00nfLXU8aXpotnw/photo.jpg?sz=128", "display_name": "Wiktor", "link": "https://stackoverflow.com/users/11987562/wiktor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566999802, "creation_date": 1566976317, "last_edit_date": 1566999802, "question_id": 57686791, "link": "https://stackoverflow.com/questions/57686791/databodyrange-copy-when-table-filtered-is-empty", "title": "DataBodyRange copy when table (filtered) is empty", "body": "<p>I have database (excel table) with answers from which I need copy comments to other sheet. For each question answers are in different columns. Currently I have code that work properly if there are answers. But if there is not it returns whole database.</p>\n\n<p>So after some research i've tried If DataBodyRange Is Nothing but it looks like code is ignored. Results are the same as without this line.</p>\n\n<pre><code>Sub Filter_Comments()\n\nDept = \"Science\"\nWS = \"Comments\"\n\n'1st question comments\nWorksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter Field:=21, Criteria1:=Sheets(\"Dashboard\").Range(\"A7\").Value\nWorksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter Field:=6, Criteria1:=Dept\nWorksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter Field:=8, Criteria1:=\"&lt;&gt;\"\nIf Not Worksheets(\"Database\").ListObjects(\"Table1\").ListColumns(1).DataBodyRange Is Nothing Then\n    Worksheets(\"Database\").ListObjects(\"Table1\").ListColumns(6).DataBodyRange.Copy\n    Worksheets(WS).Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    Worksheets(\"Database\").ListObjects(\"Table1\").ListColumns(8).DataBodyRange.Copy\n    Worksheets(WS).Cells(Rows.Count, 3).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    Worksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter\nEnd If\n\n'2st question comments\nWorksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter Field:=21, Criteria1:=Sheets(\"Dashboard\").Range(\"A7\").Value\nWorksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter Field:=6, Criteria1:=Dept\nWorksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter Field:=10, Criteria1:=\"&lt;&gt;\"\nIf Not Worksheets(\"Database\").ListObjects(\"Table1\").ListColumns(1).DataBodyRange Is Nothing Then\n    Worksheets(\"Database\").ListObjects(\"Table1\").ListColumns(6).DataBodyRange.Copy\n    Worksheets(WS).Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    Worksheets(\"Database\").ListObjects(\"Table1\").ListColumns(10).DataBodyRange.Copy\n    Worksheets(WS).Cells(Rows.Count, 3).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n    Worksheets(\"Database\").ListObjects(\"Table1\").Range.AutoFilter\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>So, currently it works fine if there are comments, but not if filtered table is empty.</p>\n\n<p>The goal is to have all comments one by one in rows.\nCould You please help with walking around the empty table after filtering?</p>\n\n<p>Best,\nWiktor</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1566975256, "post_id": 57686406, "comment_id": 101818336, "body": "You&#39;d get that if <code>i</code> equals 0 when it tries to redim.  You&#39;re increasing the value of <code>I</code> if the <code>Find</code> function doesn&#39;t find anything.  Should the line be <code>If Not ret_cell Is Nothing Then</code> so it increases <code>I</code> if a value is found?"}, {"owner": {"reputation": 3, "user_id": 11914402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ofsi-txhCj0/AAAAAAAAAAI/AAAAAAAAAEo/FvTjq6DL-qc/photo.jpg?sz=128", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/11914402/aftab-khan"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1566976611, "post_id": 57686406, "comment_id": 101818909, "body": "It opposes what i want, but it removed the error but on the other hand it removes all the sheets data. i have to apply some check"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1566994289, "post_id": 57686406, "comment_id": 101828427, "body": "Not sure what you&#39;re trying to do as you haven&#39;t explained that part.  From the look of your code you&#39;re passing the function two ranges of cells.  You&#39;re then going through each cell in <code>sheet_range</code> and seeing if it also occurs in <code>ref_range</code>, if it&#39;s not you&#39;re adding the value to your array and returning an array of values that are missing from <code>ref_range</code>.  Is that correct?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1566994733, "post_id": 57686406, "comment_id": 101828680, "body": "Try using <code>ReDim Preserve missing_refs(UBound(missing_refs) - 1)</code> instead.  This will lower the upper limit by 1.  If <code>sheet_range</code> is 5 cells and nothing is found then it will return an array of 5 empty strings - <code>missing_refs(0)=&quot;&quot;, missing_refs(1)=&quot;&quot;</code>, etc."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 3, "user_id": 11914402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ofsi-txhCj0/AAAAAAAAAAI/AAAAAAAAAEo/FvTjq6DL-qc/photo.jpg?sz=128", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/11914402/aftab-khan"}, "edited": false, "score": 0, "creation_date": 1566995943, "post_id": 57692479, "comment_id": 101829415, "body": "I&#39;ve updated the code.  Is this closer to what you&#39;re after?"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1566995921, "last_edit_date": 1566995921, "creation_date": 1566995409, "answer_id": 57692479, "question_id": 57686406, "link": "https://stackoverflow.com/questions/57686406/how-can-i-remove-the-subscript-range-error-from-redim-preserve/57692479#57692479", "title": "How can i remove the Subscript range error from ReDim preserve", "body": "<p>Based on guess work on what you're after, you could use a collection instead of an array.</p>\n\n<pre><code>Sub Test()\n\n    Dim a As Collection\n    Dim b As Variant\n    Dim range_to_delete As Range\n    Dim range_to_delete_from As Range\n\n    Set range_to_delete_from = Sheet1.Range(\"B1:B5\")\n\n    Set a = get_missing_refs(Sheet1.Range(\"A1:A5\"), range_to_delete_from)\n\n    'Create a range from the missing value cells and then clear or delete.\n    If a.Count &gt; 0 Then\n        For Each b In a\n            If range_to_delete Is Nothing Then\n                Set range_to_delete = range_to_delete_from.Parent.Range(b)\n            Else\n                Set range_to_delete = Union(range_to_delete, range_to_delete_from.Parent.Range(b))\n            End If\n        Next b\n        'Delete the cells and move remaining cells up:\n        'range_to_delete.Delete Shift:=xlUp\n\n        'Or remove the value.\n        range_to_delete.ClearContents\n\n    Else\n        Debug.Print \"Nothing returned.\"\n    End If\n\nEnd Sub\n\nFunction get_missing_refs(ref_range As Range, sheet_range As Range) As Collection\n\n    Dim missing_refs As Collection\n    Dim c As Range\n    Dim ret_cell As Range\n\n    Set missing_refs = New Collection\n    For Each c In sheet_range\n        Set ret_cell = ref_range.Find(what:=c.Value, after:=ref_range.Cells(1), LookIn:=xlValues, LookAt _\n            :=xlWhole, Searchorder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n            False, SearchFormat:=False)\n\n        If ret_cell Is Nothing Then\n            missing_refs.Add c.Address\n        End If\n    Next c\n\n    Set get_missing_refs = missing_refs\n\nEnd Function\n</code></pre>\n\n<p>Have updated so that a range reference is returned for the missing values and the cells are either cleared or deleted.</p>\n"}, {"tags": [], "owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "is_accepted": true, "score": 0, "last_activity_date": 1567062012, "creation_date": 1567062012, "answer_id": 57704696, "question_id": 57686406, "link": "https://stackoverflow.com/questions/57686406/how-can-i-remove-the-subscript-range-error-from-redim-preserve/57704696#57704696", "title": "How can i remove the Subscript range error from ReDim preserve", "body": "<p>You can just add a check to see if value of i is less then 1</p>\n\n<p>If it is; it means the array you have created is empty. You can just return null in this case</p>\n\n<p>Your code will become:</p>\n\n<pre><code>Function get_missing_refs(ref_range, sheet_range)\n\nDim missing_refs() As String\nReDim missing_refs(sheet_range.Count)\nDim ret_cell As Range\nDim i As Long\nDim c As Range\n\ni = 0\n\nFor Each c In sheet_range\n    'Set ret_cell = ref_range.Find(what:=c.Value, after:=ref_range.Cells(1), LookIn:=xlValues, LookAt_:=xlWhole, Searchorder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n    Set ret_cell = ref_range.Find(what:=c.Value, after:=ref_range.Cells(1), LookIn:=xlValues, LookAt _\n        :=xlWhole, Searchorder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n\n    If ret_cell Is Nothing Then\n        missing_refs(i) = c.Value\n        i = i + 1\n    End If\n\nNext\n\nif i = 0 then\n    get_missing_refs = null\nelse\n    ReDim preserve missing_refs(i - 1)\n    get_missing_refs = missing_refs\nend if\n\n\nEnd Function\n</code></pre>\n\n<p>When calling this function you can check the array by using isnull function\nfor example you can write as below</p>\n\n<pre><code>ret_array = get_missing_refs(ref_range, sheet_range)\nif IsNull(ret_array) then\n    ' The return array is null\n    ' code for case where the returned array is null\nelse\n    ' The return array has value\n    ' code for case where the returned array has value \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11914402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ofsi-txhCj0/AAAAAAAAAAI/AAAAAAAAAEo/FvTjq6DL-qc/photo.jpg?sz=128", "display_name": "Aftab Khan", "link": "https://stackoverflow.com/users/11914402/aftab-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57704696, "answer_count": 2, "score": -1, "last_activity_date": 1567433476, "creation_date": 1566974629, "last_edit_date": 1567433476, "question_id": 57686406, "link": "https://stackoverflow.com/questions/57686406/how-can-i-remove-the-subscript-range-error-from-redim-preserve", "title": "How can i remove the Subscript range error from ReDim preserve", "body": "<p>Getting subscript error on ReDim preserve </p>\n\n<pre><code>Function get_missing_refs(ref_range, sheet_range)\n\n    Dim missing_refs() As String\n    ReDim missing_refs(sheet_range.Count)\n    Dim ret_cell As Range\n    Dim i As Long\n    Dim c As Range\n\n    i = 0\n\n    For Each c In sheet_range\n        'Set ret_cell = ref_range.Find(what:=c.Value, after:=ref_range.Cells(1), LookIn:=xlValues, LookAt_:=xlWhole, Searchorder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n        Set ret_cell = ref_range.Find(what:=c.Value, after:=ref_range.Cells(1), LookIn:=xlValues, LookAt _\n            :=xlWhole, Searchorder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n            False, SearchFormat:=False)\n\n        If ret_cell Is Nothing Then\n            missing_refs(i) = c.Value\n            i = i + 1\n        End If\n\n    Next\n\n   ReDim preserve missing_refs(i - 1)\n\n\n    get_missing_refs = missing_refs\n\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1566973573, "post_id": 57686152, "comment_id": 101817656, "body": "Yes, this line is quite unclear &quot;So, I want the button to adapt to the cell next to it as I copy it. Like it goes from say, A2 to A3 to A4&quot;. What are you trying to create, actual buttons to click? Or is it just a column with a header called Buttons? Also if that&#39;s column D, the cells to it&#39;s left would be column C, not A. Surely that&#39;s not all your code you got I may hope?"}, {"owner": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566975073, "post_id": 57686152, "comment_id": 101818251, "body": "@JvdV Yea I want to create actual buttons to click that have attached macro to it. For now I make simple button in column B that copy text from column A cell 2 to clipboard."}, {"owner": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1566975162, "post_id": 57686152, "comment_id": 101818290, "body": "My main problem is, how to copy buttons, like you do with cells fill tool and how to make macro adjust to cell left to it."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1566975780, "post_id": 57686152, "comment_id": 101818562, "body": "Something like <code>Worksheets(&quot;Sheet1&quot;).Shapes(Application.Caller).TopLeftCell</code> will return a reference to the top left cell that the button covers. <code>Application.Caller</code> will return the name of the button that was clicked."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "edited": false, "score": 0, "creation_date": 1566976898, "post_id": 57686579, "comment_id": 101819040, "body": "I guess it&#39;s based on my current active cell. When for example my click on column c cell 2, my button is in column D cell 2 it will copy text from cell 5 column F. I check that it&#39;s random. When I have button in column B it will copy cell 3 column D, etc.."}], "tags": [], "owner": {"reputation": 29, "user_id": 9211379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccdfa1f35ab5568cd1e21c23f7ab5204?s=128&d=identicon&r=PG&f=1", "display_name": "notBacon", "link": "https://stackoverflow.com/users/9211379/notbacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1566975896, "last_edit_date": 1566975896, "creation_date": 1566975358, "answer_id": 57686579, "question_id": 57686152, "link": "https://stackoverflow.com/questions/57686152/create-button-with-macro-that-will-copy-from-cell-left-of-button/57686579#57686579", "title": "Create button with macro, that will copy from cell left of button", "body": "<p>Your question is quite unclear.</p>\n\n<p>If you are looking for a macro that would allow your button to copy the cell to its left,</p>\n\n<p>you make your button as a range.</p>\n\n<p>When you select, obtain the column and row of your selection.</p>\n\n<pre><code>Sub copy()\n\nDim TargetCell As Range\n\nSet TargetCell = Selection\n\nTargetCell(ActiveCell.column - 1, ActiveCell.row).Copy\n\nEnd Sub\n</code></pre>\n\n<p>I hope this might be helpful to you in any way.</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "edited": false, "score": 0, "creation_date": 1566976780, "post_id": 57686680, "comment_id": 101818992, "body": "I have created button in column D cell 2 in order to copy text from column C cell 2, but I get run-time error &#39;9&#39;: out of range"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "edited": false, "score": 0, "creation_date": 1566977278, "post_id": 57686680, "comment_id": 101819229, "body": "@G.Dawid, as mentioned in my answer, you&#39;ll have to adapt the referenced sheet to the actual sheetname your buttons reside on. In other words, if <code>Sheet1</code> is not the correct sheetname, you&#39;ll recieve that error, and you&#39;ll just have to change it according to your actual sheet&#39;s name."}, {"owner": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "edited": false, "score": 0, "creation_date": 1575532991, "post_id": 57686680, "comment_id": 104600434, "body": "Is it posible to copy text that contains new lines with out quotes &quot;&quot;?"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1566976283, "last_edit_date": 1566976283, "creation_date": 1566975859, "answer_id": 57686680, "question_id": 57686152, "link": "https://stackoverflow.com/questions/57686152/create-button-with-macro-that-will-copy-from-cell-left-of-button/57686680#57686680", "title": "Create button with macro, that will copy from cell left of button", "body": "<p>This does essentially what you are trying to do:</p>\n\n<pre><code>Sub Test()\n\nDim rw As Long\nWith ThisWorkbook.Sheets(\"Sheet1\") 'Change accordingly\n    rw = .Shapes(Application.Caller).TopLeftCell.Row\n    .Cells(rw, 1).Copy\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Assign this macro to all the buttons you have created in the cells on column B</p>\n\n<hr>\n\n<p>If you need this on more buttons for example column D and F, and you want to copy respectively C and E, you could use a more generic piece of code:</p>\n\n<pre><code>Sub Test()\n\nDim rw As Long, cl As Long\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    rw = .Shapes(Application.Caller).TopLeftCell.Row\n    cl = .Shapes(Application.Caller).TopLeftCell.Column\n    .Cells(rw, cl - 1).Copy\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 10603470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c008cf6ed7fb8404812410db79268cd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Dawid", "link": "https://stackoverflow.com/users/10603470/g-dawid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57686680, "answer_count": 2, "score": -1, "last_activity_date": 1574363177, "creation_date": 1566973272, "last_edit_date": 1574363177, "question_id": 57686152, "link": "https://stackoverflow.com/questions/57686152/create-button-with-macro-that-will-copy-from-cell-left-of-button", "title": "Create button with macro, that will copy from cell left of button", "body": "<p>I have table like this, but bigger.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UOjB1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UOjB1.png\" alt=\"Excel data\"></a></p>\n\n<p>My code:</p>\n\n<pre><code>Sub copy()\n    Range(\"A2\").Copy\nEnd Sub\n</code></pre>\n\n<p>I want the button to adapt to the cell next to it as I copy it. From say, A2 to A3 to A4 etc.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1566972837, "last_edit_date": 1566972837, "creation_date": 1566972260, "answer_id": 57685973, "question_id": 57685870, "link": "https://stackoverflow.com/questions/57685870/convert-word-tables-to-text-with-manual-intervention/57685973#57685973", "title": "Convert word tables to text with Manual Intervention", "body": "<p><strong>You can simply use a <code>MsgBox</code> to ask and skip a Table.</strong></p>\n\n<p>Use this:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nDim tbl As Table\n\nFor Each tbl In ActiveDocument.Tables\n    If tbl.Cell(1, 1).Range.Text Like \"*Family number*\" Then\n\n        tbl.Select\n        If MsgBox(\"Skip Table ?\", vbYesNo) = vbNo Then\n            tbl.ConvertToText\n        End If\n    End If\n\nNext tbl\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Demo:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/LbYiE.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LbYiE.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57685973, "answer_count": 1, "score": 0, "last_activity_date": 1566985407, "creation_date": 1566971690, "last_edit_date": 1566985407, "question_id": 57685870, "link": "https://stackoverflow.com/questions/57685870/convert-word-tables-to-text-with-manual-intervention", "title": "Convert word tables to text with Manual Intervention", "body": "<p>I am trying to convert some tables to text but i need <strong><em>manual intervention</em></strong>.\nI am to select the table by loop but not able to stop it. \nI need to stop the loop at each table and select yes button to convert it or skip button to skip to next table.</p>\n\n<p>I have tried the code below .</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim tbl As Table\nDim t As Integer\n\nFor Each tbl In ActiveDocument.Tables\nIf tbl.Cell(1, 1).Range.Text Like \"*Family number*\" Then\ntbl.ConvertToText\nActivetable().Select\nCall CommandButton4_Click\n\n\nEnd If\n\nNext tbl\nEnd Sub\n\nPrivate Sub CommandButton4_Click()\nDim tbl As Table\nDim t As Integer\nFor t = 1 To ActiveDocument.Tables.Count\nActiveDocument.Tables(t).Select\n\nCall CommandButton5_Click\nNext t\n\nEnd Sub\n</code></pre>\n\n<p>I just want to manual click yes to convert the current selected table into text or click skip to select the next table in loop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1566965501, "post_id": 57684943, "comment_id": 101815519, "body": "You can try <code>ws.UsedRange.SpecialCells(xlCellTypeConstants).Cells</code> ... Assuming there are no formulas in the cells, you can change this in the If For Loop."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1566965659, "post_id": 57684943, "comment_id": 101815550, "body": "Also adding <code>Application.ScreenUpdating = False</code> in the beginning of the code and <code>True</code> in the end will make it significantly faster."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 3, "creation_date": 1566971808, "post_id": 57685092, "comment_id": 101817070, "body": "+ For a usefull technique. I used it myself so now and then and found that you would need to use <code>Application.FindFormat.Clear</code> and <code>Application.ReplaceFormat.Clear</code> to make this run properly if you use it more than once (or the two scripts after each other), because at least with me, the formats don&#39;t just clear but stay (you can check in the Find/Replace window). I normally used those lines right before and after the code."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1566972659, "post_id": 57685092, "comment_id": 101817349, "body": "Yes <b>.Find</b> retains the settings and needs to be reset..  I am on the road right now. Will include that in my answer in couple of hours :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 9, "last_activity_date": 1566976981, "last_edit_date": 1566976981, "creation_date": 1566966624, "answer_id": 57685092, "question_id": 57684943, "link": "https://stackoverflow.com/questions/57684943/vba-format-cell-based-on-fill-color-and-font-color/57685092#57685092", "title": "VBA format cell based on fill color and font color", "body": "<p>No Need to <strong>loop</strong>. You can search and replace using colors. Try this</p>\n\n<p><strong>Remove cell fill color if existing fill color is yellow</strong></p>\n\n<pre><code>With Application.FindFormat.Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nWith Application.ReplaceFormat.Interior\n    .Pattern = xlNone\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nCells.Replace What:=\"\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\nxlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True\n</code></pre>\n\n<p>If you had to do this manually, you would have done this</p>\n\n<p><a href=\"https://i.stack.imgur.com/A4uMa.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A4uMa.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Similarly for the font.</p>\n\n<p><strong>Set cell text color back to black only if existing font color is red.</strong></p>\n\n<pre><code>With Application.FindFormat.Font\n    .Subscript = False\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nWith Application.ReplaceFormat.Font\n    .Subscript = False\n    .ColorIndex = xlAutomatic\n    .TintAndShade = 0\nEnd With\nCells.Replace What:=\"\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\nxlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True\n</code></pre>\n\n<p>If you had to do this manually, you would have done this</p>\n\n<p><a href=\"https://i.stack.imgur.com/Mvi35.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mvi35.gif\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Note</strong>: The VBA <code>Find</code> uses parameters. Except <code>What:=</code>, rest of the parameters are optional. It is recommended that you provide those parameters. If you don\u2019t, then <code>Find</code> will use the existing settings. If you do not want to provide the optional parameters then it is a must to clear those parameters before you use <code>Find</code> else you will get undesired results. You can do that by <code>Application.FindFormat.Clear</code></p>\n\n<p>Similarly <code>Replace</code> uses parameters and if you do not want to provide the optional parameters then clear them using <code>Application.ReplaceFormat.Clear</code></p>\n"}], "owner": {"reputation": 131, "user_id": 2976568, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6010a57fd4e6b6bcfb25ecaf4fb284b1?s=128&d=identicon&r=PG&f=1", "display_name": "user2976568", "link": "https://stackoverflow.com/users/2976568/user2976568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 2, "accepted_answer_id": 57685092, "answer_count": 1, "score": 2, "last_activity_date": 1566976981, "creation_date": 1566965401, "last_edit_date": 1566971450, "question_id": 57684943, "link": "https://stackoverflow.com/questions/57684943/vba-format-cell-based-on-fill-color-and-font-color", "title": "VBA format cell based on fill color and font color", "body": "<p>I have an excel where I have to </p>\n\n<ol>\n<li><p>remove cell fill color if existing fill color is yellow </p></li>\n<li><p>set cell text color back to black only if existing font color is red. </p></li>\n</ol>\n\n<p>I have written a macro that simply loops over each cell and checks the font color / fill color</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Application.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n...\nFor Each Cell In ws.UsedRange.Cells\n   If Cell.Font.ColorIndex = 3 Then\n      Cell.Font.ColorIndex = 0\n   End If\n   If Cell.Interior.ColorIndex = 6 Then\n      Cell.Interior.Pattern = xlNone\n      Cell.Interior.TintAndShade = 0\n      Cell.Interior.PatternTintAndShade = 0\n   End If\nNext\n</code></pre>\n\n<p>It works as expected but it runs very slowly probably because it goes through each cell. Is there a to make this work faster ? I tried using conditional formatting with VBA but it cant seem to check for the cell color / cell font color...</p>\n"}, {"tags": ["arrays", "excel", "vba", "string", "loops"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1566959432, "post_id": 57684308, "comment_id": 101814522, "body": "I think Text to Columns would work quite nicely and avoid VBA entirely."}, {"owner": {"reputation": 5, "user_id": 4151382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1431ade09a23f2fadfaf6bc25d4ef2dc?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Heiler", "link": "https://stackoverflow.com/users/4151382/joe-heiler"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566960060, "post_id": 57684308, "comment_id": 101814608, "body": "@BigBen Wow! I didn&#39;t even know that existed!! I just did that and it works SO well thank you!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566960311, "post_id": 57684308, "comment_id": 101814649, "body": "No problem, glad to help out."}, {"owner": {"reputation": 5, "user_id": 4151382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1431ade09a23f2fadfaf6bc25d4ef2dc?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Heiler", "link": "https://stackoverflow.com/users/4151382/joe-heiler"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566960558, "post_id": 57684308, "comment_id": 101814693, "body": "@BigBen Ok so now that I have it all down to 3E, 3F, 3G etc, how can I filter it so that it is both in ascending numerical and alphabetical order? I need the whole data sheet to now be in order from 3 to 1000 as well as A-Z, so that 3A will come before 3G for example? I tried add filter but I don&#39; know how to apply it to both the number and the letter"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566960581, "post_id": 57684308, "comment_id": 101814694, "body": "Just to add to what @BigBen said, the <code>Text to Columns</code> Wizard on the data tab only lets you use a single character delimiter.  If you need more muscle, something that handles a delimiter with multiple characters then you can use <code>TextToColumns</code> in VBA or <code>Split Column by Delimiter</code> in Power Query."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566960632, "post_id": 57684308, "comment_id": 101814702, "body": "@JoeHeiler I would ask that as a new question."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566970552, "post_id": 57684308, "comment_id": 101816688, "body": "Since commnts are temporary, @BigBen or OP can post an answer <b>OR</b> mark it as a duplicate to some &quot;Text to Columns&quot; question which addresses the same issue :)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566991877, "post_id": 57684308, "comment_id": 101827060, "body": "@JoeHeiler feel free to post an answer or maybe just delete the question, or if you want me to add an answer I can, just let me know."}], "owner": {"reputation": 5, "user_id": 4151382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1431ade09a23f2fadfaf6bc25d4ef2dc?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Heiler", "link": "https://stackoverflow.com/users/4151382/joe-heiler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567026289, "creation_date": 1566959309, "last_edit_date": 1566960687, "question_id": 57684308, "link": "https://stackoverflow.com/questions/57684308/looping-a-string-split-through-column", "title": "Looping a String Split through Column", "body": "<p>I have a column full of data in a format I don't like, and need them in another format. Currently they are formatted like this: \"190826_095630_3E_1 (ROI 0)\" and I need just the \"3E\" portion. I have written a string split that uses the \"_\" and I figure I can then just take the column of data that is produced that I want, however I can only get this to work one cell at a time while I click each one. I tried to write a for loop but I am running into trouble, most likely because I used \"active.cell\". Does anyone have a better way to loop this split through my column? Alternatively if you also know how to just return the third string split (3E) I would really appreciate it. </p>\n\n<p>'No loop: This works for one cell</p>\n\n<pre><code>Option Explicit\n\nSub NameTest()\n    Dim txt As String\n    Dim i As Integer\n    Dim FullName As Variant\n\n\n    txt = ActiveCell.Value\n\n    FullName = Split(txt, \"_\")\n\n    For i = 0 To UBound(FullName)\n\n        Cells(1, i + 1).Value = FullName(i)\n\n    Next i\n\n\nEnd Sub\n\n\n'Attempt at a loop: \nOption Explicit\n\nSub NameTest()\n    Dim txt As String\n    Dim i As Integer\n    Dim FullName As Variant\n    Dim x As Integer\n\n    For x = 1 To 1000\n\n    txt = ActiveCell.Value\n\n    FullName = Split(txt, \"_\")\n\n    For i = 0 To UBound(FullName)\n\n        Cells(1, i + 1).Value = FullName(i)\n\n    Next i\n    Next x\n\nEnd Sub\n\n</code></pre>\n\n<p>I would like to get this to run until the last cell with data in a given column.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566953440, "post_id": 57683731, "comment_id": 101813586, "body": "Do you mean the order of sheets gets messed up and you want the cover sheet to always be the first tab?"}, {"owner": {"reputation": 43, "user_id": 11445361, "user_type": "registered", "profile_image": "https://graph.facebook.com/650951922/picture?type=large", "display_name": "Nick Vanderkooi", "link": "https://stackoverflow.com/users/11445361/nick-vanderkooi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566955583, "post_id": 57683731, "comment_id": 101813908, "body": "Yes - that&#39;s it Ben"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1566955659, "creation_date": 1566955659, "answer_id": 57683969, "question_id": 57683731, "link": "https://stackoverflow.com/questions/57683731/keep-a-sheet-in-first-position-in-a-workbook/57683969#57683969", "title": "Keep a sheet in first position in a workbook", "body": "<p>Use the <code>Workbook.Open</code> event to move that particular sheet to the first position when the workbook is opened.</p>\n\n<p>Add this code to the <code>ThisWorkbook</code> module and change <code>Sheet1</code> to the codename of that sheet:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Sheet1.Move Before:=Me.Sheets(1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11445361, "user_type": "registered", "profile_image": "https://graph.facebook.com/650951922/picture?type=large", "display_name": "Nick Vanderkooi", "link": "https://stackoverflow.com/users/11445361/nick-vanderkooi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 57683969, "answer_count": 1, "score": 0, "last_activity_date": 1567043748, "creation_date": 1566953111, "last_edit_date": 1567043748, "question_id": 57683731, "link": "https://stackoverflow.com/questions/57683731/keep-a-sheet-in-first-position-in-a-workbook", "title": "Keep a sheet in first position in a workbook", "body": "<p>I have a workbook with a cover sheet and the remaining sheets are not visible.  A tick-box displays tabs if ticked.</p>\n\n<p>The cover sheet gets moved around in the book.  I would like the cover sheet to always be in the first position.</p>\n\n<p>Is there a way to do this?</p>\n\n<pre><code>Sub CheckBoxA1_Click()\n    Sheets(\"A\").Visible = Not Sheets(\"A\").Visible\nEnd Sub\n\nSub CheckBox2_Click()\n    Sheets(\"B\").Visible = Not Sheets(\"B\").Visible\nEnd Sub\n</code></pre>\n\n<p>The macro works well though the cover sheet extends up in different places well other sheets become visible.  I would like it to be always in the first position. Is this possible?</p>\n"}, {"tags": ["excel", "vba", "ado"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11986401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9ae142a487159c6ef7d2c4d690c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/11986401/jjj"}, "edited": false, "score": 0, "creation_date": 1566957573, "post_id": 57683729, "comment_id": 101814223, "body": "Thanks Alyssa. Unfortunately it didn&#39;t work. I&#39;ve edited my original post."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 1, "user_id": 11986401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9ae142a487159c6ef7d2c4d690c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/11986401/jjj"}, "edited": false, "score": 0, "creation_date": 1567027963, "post_id": 57683729, "comment_id": 101844551, "body": "@JJJ I believe you are looking for <code>Range(...).NumberFormat = &quot;0.00&quot;</code> for that column you have highlighted in the picture. Also, make sure <code>TargetRange.Cells(2, 1)</code> is referring to the correct cells you want to format. You might need an <code>.offset()</code>."}], "tags": [], "owner": {"reputation": 21, "user_id": 11986500, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DgG9KkYOL_s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdECuw-poPECc6y2Wctw-QjwG4mHw/photo.jpg?sz=128", "display_name": "Alyssa Maquiling", "link": "https://stackoverflow.com/users/11986500/alyssa-maquiling"}, "is_accepted": false, "score": 2, "last_activity_date": 1566953438, "last_edit_date": 1566953438, "creation_date": 1566953042, "answer_id": 57683729, "question_id": 57683672, "link": "https://stackoverflow.com/questions/57683672/ado-function-copying-numbers-as-text/57683729#57683729", "title": "ADO function copying numbers as text", "body": "<p>You need to add number formatting of the cells:</p>\n\n<pre><code>TargetRange.Cells(x, y).NumberFormat = \"0\"\n</code></pre>\n\n<p>The above line makes the cell format as a <code>Number</code></p>\n\n<p>So your final code will look like:</p>\n\n<pre><code>' Paste data\nIf Not rsData.EOF Then\n    If Header = False Then\n        TargetRange.Cells(1, 1).CopyFromRecordset rsData\n        TargetRange.Cells(1, 1).NumberFormat = \"0\"\n    Else\n        If UseHeaderRow Then\n            For lCount = 0 To rsData.Fields.count - 1\n                TargetRange.Cells(1, 1 + lCount).value = _\n                rsData.Fields(lCount).name\n            Next lCount\n            TargetRange.Cells(2, 1).CopyFromRecordset rsData\n            TargetRange.Cells(2, 1).NumberFormat = \"0\"\n        Else\n            TargetRange.Cells(1, 1).CopyFromRecordset rsData\n            TargetRange.Cells(1, 1).NumberFormat = \"0\"\n        End If\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11986401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9ae142a487159c6ef7d2c4d690c4d8?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/11986401/jjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567433531, "creation_date": 1566952458, "last_edit_date": 1567433531, "question_id": 57683672, "link": "https://stackoverflow.com/questions/57683672/ado-function-copying-numbers-as-text", "title": "ADO function copying numbers as text", "body": "<p>Ado function that copies and pastes data from Excel spreadsheet is pasting numbers as text. How can I get the function to paste as number value?</p>\n\n<pre><code>' Copy data\nIf SourceSheet = \"\" Then\n    szSQL = \"SELECT * FROM \" &amp; SourceRange$ &amp; \";\"\nElse\n    szSQL = \"SELECT * FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; SourceRange$ &amp; \"];\"\nEnd If\n\n\n' Initialise recordset\nSet rsCon = CreateObject(\"ADODB.Connection\")\nSet rsData = CreateObject(\"ADODB.Recordset\")\n\nrsCon.Open szConnect\nrsData.Open szSQL, rsCon, 0, 1, 1\n\n' Paste data\nIf Not rsData.EOF Then\n    If Header = False Then\n        TargetRange.Cells(1, 1).CopyFromRecordset rsData\n    Else\n        If UseHeaderRow Then\n            For lCount = 0 To rsData.Fields.count - 1\n                TargetRange.Cells(1, 1 + lCount).value = _\n                rsData.Fields(lCount).name\n            Next lCount\n            TargetRange.Cells(2, 1).CopyFromRecordset rsData\n        Else\n            TargetRange.Cells(1, 1).CopyFromRecordset rsData\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p>I've tried Alyssa' solution and also added to it by selecting the full TargetRange and applying the correct formatting. However as can be seen below the format is applied, but the cell is still stored as text.</p>\n\n<p>E.g.</p>\n\n<pre><code>TargetRange.NumberFormat = \"0.0\\%\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OSa5c.png\" rel=\"nofollow noreferrer\">Excel picture</a></p>\n"}, {"tags": ["html", "excel", "vba", "powershell"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 3998184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1ea75591d0349efc20d67d583c6d12c3?s=128&d=identicon&r=PG&f=1", "display_name": "aric8456", "link": "https://stackoverflow.com/users/3998184/aric8456"}, "edited": false, "score": 0, "creation_date": 1567000292, "post_id": 57683655, "comment_id": 101832123, "body": "Thank you! See my post below, this was very helpful"}], "tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1566952265, "creation_date": 1566952265, "answer_id": 57683655, "question_id": 57683390, "link": "https://stackoverflow.com/questions/57683390/excel-export-to-html-cells-overlapping/57683655#57683655", "title": "Excel export to HTML cells overlapping", "body": "<p><strong>NOTE: There is no difference in the Working vs Non-Working HTML. I used a Diff compare, they're 100% the same.</strong></p>\n\n<blockquote>\n  <p>The excel file and the vba should be fine since it does work normally.</p>\n</blockquote>\n\n<p>Looks like you've hit KB257757: <a href=\"https://support.microsoft.com/en-au/help/257757/considerations-for-server-side-automation-of-office\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-au/help/257757/considerations-for-server-side-automation-of-office</a></p>\n\n<p>Somehow the Merge cells of the text \"should be updated every Monday, Wednesday, Friday morning\" is pushing the Alphabet to the right.</p>\n\n<p>I am suspicious of the <code>PublishObjects</code>, despite Server-Side Automation of Excel being unsupported can you see if this code works:</p>\n\n<pre><code>Workbook workbook = new Workbook(); \nworkbook.LoadFromFile(\"Book1.xlsx\"); \nWorksheet sheet = workbook.Worksheets[0]; \nsheet.SaveToHtml(\"sample.html\"); \n</code></pre>\n\n<p>If that doesn't fix things instead of using <code>PublishObjects</code> you could try to export the HTML file yourself, using this code: <a href=\"https://gist.github.com/jkatricak/801024\" rel=\"nofollow noreferrer\">https://gist.github.com/jkatricak/801024</a> and if you need to preserve HTML styles you can adapt:\n<a href=\"https://stackoverflow.com/questions/39210329/export-the-datagridview-to-excel-with-all-the-cells-format\">Export the dataGridView to Excel with all the cells format</a></p>\n\n<p>This would give you the option to format the HTML table with your own CSS, eg:</p>\n\n<pre><code>&lt;style type=\"text/css\"&gt;\n    table.tableizer-table {\n        font-size: 12px;\n        border: 1px solid #CCC; \n        font-family: Arial, Helvetica, sans-serif;\n    } \n    .tableizer-table td {\n        padding: 4px;\n        margin: 3px;\n        border: 1px solid #CCC;\n    }\n    .tableizer-table th {\n        background-color: #104E8B; \n        color: #FFF;\n        font-weight: bold;\n    }\n&lt;/style&gt;\n&lt;table class=\"tableizer-table\"&gt;\n&lt;thead&gt;&lt;tr class=\"tableizer-firstrow\"&gt;&lt;th&gt;A&lt;/th&gt;&lt;th&gt;B&lt;/th&gt;&lt;th&gt;C&lt;/th&gt;&lt;th&gt;D&lt;/th&gt;&lt;th&gt;E&lt;/th&gt;&lt;th&gt;F&lt;/th&gt;&lt;th&gt;G&lt;/th&gt;&lt;th&gt;H&lt;/th&gt;&lt;th&gt;I&lt;/th&gt;&lt;th&gt;J&lt;/th&gt;&lt;th&gt;K&lt;/th&gt;&lt;th&gt;L&lt;/th&gt;&lt;th&gt;M&lt;/th&gt;&lt;th&gt;N&lt;/th&gt;&lt;th&gt;O&lt;/th&gt;&lt;th&gt;P&lt;/th&gt;&lt;th&gt;Q&lt;/th&gt;&lt;th&gt;R&lt;/th&gt;&lt;th&gt;S&lt;/th&gt;&lt;th&gt;T&lt;/th&gt;&lt;th&gt;U&lt;/th&gt;&lt;th&gt;V&lt;/th&gt;&lt;th&gt;W&lt;/th&gt;&lt;th&gt;X&lt;/th&gt;&lt;th&gt;Y&lt;/th&gt;&lt;th&gt;Z&lt;/th&gt;&lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n</code></pre>\n\n<p>Essentially if the above methods are unhelpful you'll need to work around it. Microsoft came up with the XML format that you can use without Microsoft.Office.Excel.Interop.DLL with ClosedXML (or OpenXML if you're up for a challenge). You could try other paid for products like EPPPlus - YMMV.</p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 3998184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1ea75591d0349efc20d67d583c6d12c3?s=128&d=identicon&r=PG&f=1", "display_name": "aric8456", "link": "https://stackoverflow.com/users/3998184/aric8456"}, "is_accepted": false, "score": 1, "last_activity_date": 1567000259, "creation_date": 1567000259, "answer_id": 57694051, "question_id": 57683390, "link": "https://stackoverflow.com/questions/57683390/excel-export-to-html-cells-overlapping/57694051#57694051", "title": "Excel export to HTML cells overlapping", "body": "<p>@Jeremy Thompson</p>\n\n<p>You got my brain thinking along the right lines:\n<code>Somehow the Merge cells of the text \"should be updated every Monday, Wednesday, Friday morning\" is pushing the Alphabet to the right.</code> I simply added in an extra row between those two sections and it seems to have stabilized the two. We're cooking with gas now!</p>\n\n<p><strong>Excel</strong></p>\n\n<p><img src=\"https://i.imgur.com/Xh6Hg9B.png\" alt=\"excel\"></p>\n\n<p><strong>Web</strong>\n<img src=\"https://i.imgur.com/Ve5ZCrW.png\" alt=\"web\"></p>\n"}], "owner": {"reputation": 129, "user_id": 3998184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1ea75591d0349efc20d67d583c6d12c3?s=128&d=identicon&r=PG&f=1", "display_name": "aric8456", "link": "https://stackoverflow.com/users/3998184/aric8456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 57683655, "answer_count": 2, "score": 1, "last_activity_date": 1567171514, "creation_date": 1566949482, "last_edit_date": 1567171514, "question_id": 57683390, "link": "https://stackoverflow.com/questions/57683390/excel-export-to-html-cells-overlapping", "title": "Excel export to HTML cells overlapping", "body": "<p>I have an excel workbook that I am trying to export to an HTML format (vba script which is called from Powershell below). When I run it on my local machine (Win10, Office 2016) the formatting is perfectly fine. However, when I try to run the same script from the server where it is supposed to live (WS2012, Office 2016) the formatting is ruined (except, oddly in Internet Explorer on certain machines).</p>\n\n<p>I cannot figure out why the initiating computer is causing a problem with formatting for only this one section.</p>\n\n<p><strong>Original in Excel:</strong></p>\n\n<p><img src=\"https://i.imgur.com/QsoBHxe.png\" alt=\"excel\"></p>\n\n<p><strong>Working:</strong></p>\n\n<p><img src=\"https://i.imgur.com/DAjcqa2.png\" alt=\"working\"></p>\n\n<p><strong>Not working:</strong></p>\n\n<p><img src=\"https://i.imgur.com/GIzIA3i.png\" alt=\"not working\"></p>\n\n<p>So there's something between running on my local machine and on the server, the server had been on O'2013 but even after trying O'2016 it still doesn't work. I also disabled macro security in case that was screwing something up (it was disabled on my local) which didn't help either.</p>\n\n<p>The excel file and the vba should be fine since it does work normally.</p>\n\n<p><strong>Macro to export HTML:</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With ActiveWorkbook.PublishObjects.Add(xlSourceWorkbook, _\n\n        \"C:\\Tasks\\Phonebook-HTML\\Web\\Index.htm\", , , xlHtmlStatic, _\n\n        \"TELEPHONEBOOK_18991\", \"\")\n\n        .Publish (True)\n\n        .AutoRepublish = False\n\n    End With\n</code></pre>\n\n<p><strong>Working HTML:</strong></p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;tr height=\"59\" style=\"mso-height-source:userset;height:44.45pt\"&gt;\n\n  &lt;td height=\"59\" class=\"xl154\" style=\"height:44.45pt\"&gt;&lt;a href=\"sheet007.html#RANGE!A2\"&gt;&lt;span style=\"color:#0070C0;font-size:16.0pt;\n\n  font-weight:700\"&gt;A&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A27\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;B&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A94\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;C&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A157\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;D&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A215\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;E&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A227\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;F&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A247\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;G&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A281\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;H&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A328\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;I&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A334\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;J&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A354\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;K&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A391\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;L&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A422\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;M&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A503\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;N&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A517\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;O&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A534\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;P&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A585\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;Q&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A587\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;R&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A634\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;S&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A695\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;T&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A718\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;U&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A719\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;V&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A741\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;W&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"\"&gt;&lt;span style=\"color:#0070C0;font-size:16.0pt;\n\n  font-weight:700\"&gt;X&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A767\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;Y&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A771\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;Z&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n&lt;/tr&gt;\n</code></pre>\n\n<p><strong>NOT Working HTML:</strong></p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;tr height=\"59\" style=\"mso-height-source:userset;height:44.45pt\"&gt;\n\n  &lt;td height=\"59\" class=\"xl154\" style=\"height:44.45pt\"&gt;&lt;a href=\"sheet007.html#RANGE!A2\"&gt;&lt;span style=\"color:#0070C0;font-size:16.0pt;\n\n  font-weight:700\"&gt;A&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A27\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;B&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A94\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;C&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A157\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;D&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A215\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;E&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A227\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;F&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A247\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;G&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A281\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;H&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A328\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;I&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A334\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;J&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A354\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;K&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A391\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;L&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A422\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;M&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A503\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;N&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A517\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;O&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A534\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;P&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A585\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;Q&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A587\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;R&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A634\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;S&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A695\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;T&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A718\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;U&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A719\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;V&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A741\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;W&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"\"&gt;&lt;span style=\"color:#0070C0;font-size:16.0pt;\n\n  font-weight:700\"&gt;X&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A767\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;Y&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n  &lt;td class=\"xl154\"&gt;&lt;a href=\"sheet007.html#RANGE!A771\"&gt;&lt;span style=\"color:#0070C0;\n\n  font-size:16.0pt;font-weight:700\"&gt;Z&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n\n&lt;/tr&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "string", "edit"], "comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1566950388, "post_id": 57683388, "comment_id": 101813162, "body": "Read up on documentation about <code>Range</code> for determining what cells you want to test, <code>for</code> (or <code>foreach</code>) loops to iterate over them and text matching mechanisms such as but certainly not limited to <code>InStr</code>. In your case perhaps even regular epressions, they look scary but can be really handy. Without at least some code or demonstrable effort on your part, your question is destined to be voted away."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1566950557, "post_id": 57683388, "comment_id": 101813182, "body": "Text to columns - split on &quot;_&quot; and delete the columns you don&#39;t need?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1566952927, "post_id": 57683388, "comment_id": 101813514, "body": "another approach - look up <code>array</code> &amp; <code>split</code>"}, {"owner": {"reputation": 1198, "user_id": 3361377, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b2278758c8fd94df86e3e7f155e96bdb?s=128&d=identicon&r=PG&f=1", "display_name": "dcromley", "link": "https://stackoverflow.com/users/3361377/dcromley"}, "edited": false, "score": 0, "creation_date": 1566956947, "post_id": 57683388, "comment_id": 101814112, "body": "Is 3E always in position 15-16? is it always the 3rd substring (separated by _&#39;s)? Is there SOME rule to always find the 3E?"}], "owner": {"reputation": 5, "user_id": 4151382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1431ade09a23f2fadfaf6bc25d4ef2dc?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Heiler", "link": "https://stackoverflow.com/users/4151382/joe-heiler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1566961726, "answer_count": 0, "score": 0, "last_activity_date": 1566949477, "creation_date": 1566949477, "question_id": 57683388, "link": "https://stackoverflow.com/questions/57683388/editing-text-in-an-excel-column", "closed_reason": "Duplicate", "title": "Editing Text in an Excel Column", "body": "<p>I have a very large set of data with long names containing one specific part that is useful to me for the organization. What I am trying to do is to search through the whole column and separate out just the part that I want. As an example here is one data point \"190826_095630_3E_1\". What I need is for the column to be reduced to the \"3E\" portion of this name. I use all the data in lists of 3E-3L, 4E-4L, 5E-5L etc all the way down. I have no idea where to even begin on this one, I usually try to do some code but I can't figure out where to start. </p>\n\n<p>Expected results would be a vba code/macro that would take thousands of cells in column 1 with long names like \"190826_095630_3E_1\" and reduce the whole column down to \"3E\" so I can organize it and use it.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11826027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ca6660a86dbb375c65445ad352e245?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsWorld", "link": "https://stackoverflow.com/users/11826027/chipsworld"}, "edited": false, "score": 0, "creation_date": 1567014199, "post_id": 57683548, "comment_id": 101839347, "body": "You are awesome! I still get a little confused with some of this stuff, so appreciate the help immensely!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1566951124, "creation_date": 1566951124, "answer_id": 57683548, "question_id": 57682871, "link": "https://stackoverflow.com/questions/57682871/copy-values-from-multiple-sheets-to-one-sheet/57683548#57683548", "title": "Copy values from multiple sheets to one sheet", "body": "<p>Instead of pasting cell by cell you can collect all the values in an array then assign it when you're done looping over the input ranges.</p>\n\n<pre><code>Const NUM_VALS as Long  = 30\n\ndim vals() '&lt;&lt; array for your data\n\nWith SourceWS\n        Set DestCell = DestWS.Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\n        Redim vals(1 to 1, 1 to NUM_VALS)\n\n        For lloop = 1 To NUM_VALS  ' number must match total cells in range\n\n            Set SourceRng = Choose(lloop, Sheets(\"Formulas\").Range(\"v4\"), Sheets(\"Formulas\").Range(\"v5\"), Sheets(\"Formulas\").Range(\"v2\"), Sheets(\"Leave Calculations\").Range(\"b6\"), _\n            Sheets(\"Leave Calculations\").Range(\"c6\"), Sheets(\"Leave Calculations\").Range(\"d6\"), Sheets(\"Leave Calculations\").Range(\"d11\"), Sheets(\"Formulas\").Range(\"v3\"), _\n            Sheets(\"Leave Calculations\").Range(\"e15\"), Sheets(\"Leave Calculations\").Range(\"e16\"), Sheets(\"Leave Calculations\").Range(\"e21\"), _\n            Sheets(\"Formulas\").Range(\"b39\"), Sheets(\"Formulas\").Range(\"b57\"), Sheets(\"Formulas\").Range(\"c57\"), Sheets(\"Formulas\").Range(\"V10\"), _\n            Sheets(\"Formulas\").Range(\"B1\"), Sheets(\"Formulas\").Range(\"B9\"), Sheets(\"Formulas\").Range(\"B10\"), Sheets(\"Formulas\").Range(\"V22\"), _\n            Sheets(\"Formulas\").Range(\"V15\"), Sheets(\"Formulas\").Range(\"V16\"), Sheets(\"Formulas\").Range(\"V17\"), Sheets(\"Formulas\").Range(\"V18\"), _\n            Sheets(\"Formulas\").Range(\"V19\"), Sheets(\"Formulas\").Range(\"A2\"), Sheets(\"Formulas\").Range(\"V20\"), Sheets(\"Formulas\").Range(\"A2\"), Sheets(\"Formulas\").Range(\"A2\"), _\n            Sheets(\"Formulas\").Range(\"B58\"), Sheets(\"Formulas\").Range(\"v21\"), Sheets(\"Formulas\").Range(\"A2\"), Sheets(\"Formulas\").Range(\"v23\")) 'adjust the range\n\n            vals(1, lloop) = SourceRng.Value '&lt;&lt; add value to array\n\n\n        Next lloop\n        DestCell.Resize(1, NUM_VALS).Value = vals '&lt;&lt; assign the array\n End With\n</code></pre>\n\n<p>Also consider creating some variables for your worksheets to avoid all that repetition.</p>\n"}], "owner": {"reputation": 3, "user_id": 11826027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ca6660a86dbb375c65445ad352e245?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsWorld", "link": "https://stackoverflow.com/users/11826027/chipsworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57683548, "answer_count": 1, "score": 0, "last_activity_date": 1566951124, "creation_date": 1566944065, "question_id": 57682871, "link": "https://stackoverflow.com/questions/57682871/copy-values-from-multiple-sheets-to-one-sheet", "title": "Copy values from multiple sheets to one sheet", "body": "<p>Trying to find a streamlined way to accomplish the below code...</p>\n\n<p>Copy and Paste cell values from several different cells on two separate sheets to another sheet to the next available row...</p>\n\n<p>The second part of the code works great...once a row is established, and RW variable identifies the row number, it will update fine. </p>\n\n<p>The problem is the initial copy paste. The code works, but runs very, very slow. Looking for an alternative method to accomplish the same thing that would run faster and cleaner.</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\n    Dim response As Integer\n    Dim lkup As String\n    Dim SourceWS    As Worksheet, DestWS As Worksheet\n    Dim SourceRng   As Range, DestCell   As Range\n    Dim lloop As Long\n    Set SourceWS = Sheets(\"Leave Calculations\") ' Source Sheet\n    Set DestWS = Sheets(\"Historical\") 'Destination Sheet\n    lkup = Sheets(\"Formulas\").Range(\"V5\").Value\n\n\nresponse = MsgBox(\"Are you ready to print?\", vbYesNo, \"PRINT SHEET?\")\n\nIf response = 6 Then\n\nApplication.Dialogs(xlDialogPrinterSetup).Show\n\nActiveSheet.PrintOut\n\nOn Error Resume Next\nWith Sheets(\"historical\")\n    Dim Rw2 As Long, Fnd2 As Range\nSet Fnd2 = .Range(\"B:B\").Find(lkup, LookIn:=xlValues, LookAt:=xlPart, SearchDirection:=xlPrevious)\n If Not Fnd2 Is Nothing Then\n     Rw2 = Fnd2.Row\n 'Else\n     'MsgBox lkup &amp; \" not found in Historical Data\"\n End If\n             If Rw2 = 0 Then\n\n\n        ' Copy data to Historical form\n\n\n        Application.ScreenUpdating = 0\n\n\n            With SourceWS\n            Set DestCell = DestWS.Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\n            For lloop = 1 To 30 ' number must match total cells in range\n                Set SourceRng = Choose(lloop, Sheets(\"Formulas\").Range(\"v4\"), Sheets(\"Formulas\").Range(\"v5\"), Sheets(\"Formulas\").Range(\"v2\"), Sheets(\"Leave Calculations\").Range(\"b6\"), _\n                Sheets(\"Leave Calculations\").Range(\"c6\"), Sheets(\"Leave Calculations\").Range(\"d6\"), Sheets(\"Leave Calculations\").Range(\"d11\"), Sheets(\"Formulas\").Range(\"v3\"), _\n                Sheets(\"Leave Calculations\").Range(\"e15\"), Sheets(\"Leave Calculations\").Range(\"e16\"), Sheets(\"Leave Calculations\").Range(\"e21\"), _\n                Sheets(\"Formulas\").Range(\"b39\"), Sheets(\"Formulas\").Range(\"b57\"), Sheets(\"Formulas\").Range(\"c57\"), Sheets(\"Formulas\").Range(\"V10\"), _\n                Sheets(\"Formulas\").Range(\"B1\"), Sheets(\"Formulas\").Range(\"B9\"), Sheets(\"Formulas\").Range(\"B10\"), Sheets(\"Formulas\").Range(\"V22\"), _\n                Sheets(\"Formulas\").Range(\"V15\"), Sheets(\"Formulas\").Range(\"V16\"), Sheets(\"Formulas\").Range(\"V17\"), Sheets(\"Formulas\").Range(\"V18\"), _\n                Sheets(\"Formulas\").Range(\"V19\"), Sheets(\"Formulas\").Range(\"A2\"), Sheets(\"Formulas\").Range(\"V20\"), Sheets(\"Formulas\").Range(\"A2\"), Sheets(\"Formulas\").Range(\"A2\"), _\n                Sheets(\"Formulas\").Range(\"B58\"), Sheets(\"Formulas\").Range(\"v21\"), Sheets(\"Formulas\").Range(\"A2\"), Sheets(\"Formulas\").Range(\"v23\")) 'adjust the range\n                SourceRng.Copy\n                DestCell.Offset(, lloop - 1).PasteSpecial xlPasteValues\n            Next lloop\n            End With\n\n                With Application\n                    .CutCopyMode = 0\n                    .ScreenUpdating = 0\n                End With\n     Else:\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1566965015, "post_id": 57682820, "comment_id": 101815420, "body": "<a href=\"https://www.howtogeek.com/190897/how-can-you-open-and-edit-windows-.lnk-shortcut-files/\" rel=\"nofollow noreferrer\">Analyse .LNK files</a> to convert them to VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11507323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16767ee47111d6548af1ae824e06f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/11507323/roy"}, "edited": false, "score": 0, "creation_date": 1567142904, "post_id": 57684880, "comment_id": 101882804, "body": "Thank you for Wscript.  This solves half of my problem.  Next:  How to wait for the hidden executable in the ,lnk file to end?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 1, "user_id": 11507323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16767ee47111d6548af1ae824e06f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/11507323/roy"}, "edited": false, "score": 0, "creation_date": 1567144543, "post_id": 57684880, "comment_id": 101883243, "body": "As <a href=\"https://ss64.com/vb/run.html\" rel=\"nofollow noreferrer\">bWaitOnReturn</a> is true, it should do that, but using vba instead of lnk would solve that too."}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 0, "last_activity_date": 1566976431, "last_edit_date": 1566976431, "creation_date": 1566964772, "answer_id": 57684880, "question_id": 57682820, "link": "https://stackoverflow.com/questions/57682820/is-there-any-way-to-run-a-lnk-file-on-my-desktop-and-wait-for-it-to-complete/57684880#57684880", "title": "Is there any way to run a .lnk file on my desktop and wait for it to complete?", "body": "<p>You can use <a href=\"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wscript\" rel=\"nofollow noreferrer\">WScript</a> to execute<code>.LNK</code>files.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ExecuteLink(ByVal Path As String)\nConst dQuote As String = \"\"\"\"\n\nWith CreateObject(\"Wscript.shell\")\n    .Run dQuote &amp; Path &amp; dQuote, 4, True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But you still have to paste the clipboard data (can be <a href=\"https://docs.microsoft.com/en-us/office/vba/access/concepts/windows-api/retrieve-information-from-the-clipboard\" rel=\"nofollow noreferrer\">automated</a> too).</p>\n\n<p>Instead fetching data (from a query?) to clipboard, fetch data in VBA and insert it to the form.</p>\n\n<p>If you can't automate the selected field to insert you can use a <a href=\"https://stackoverflow.com/questions/770425/how-to-add-a-menu-item-to-the-default-right-click-context-menu\">context menu entry</a> to select a control and execute the VBA-Code. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11507323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16767ee47111d6548af1ae824e06f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/11507323/roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1567288743, "creation_date": 1567288743, "answer_id": 57741852, "question_id": 57682820, "link": "https://stackoverflow.com/questions/57682820/is-there-any-way-to-run-a-lnk-file-on-my-desktop-and-wait-for-it-to-complete/57741852#57741852", "title": "Is there any way to run a .lnk file on my desktop and wait for it to complete?", "body": "<p>As this is getting to complicated, I am going to start a new simpler thread on running \"Microsoft Solitaire Collection\" using Access VBA.</p>\n"}], "owner": {"reputation": 1, "user_id": 11507323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16767ee47111d6548af1ae824e06f90e?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/11507323/roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594549192, "creation_date": 1566943656, "last_edit_date": 1594549192, "question_id": 57682820, "link": "https://stackoverflow.com/questions/57682820/is-there-any-way-to-run-a-lnk-file-on-my-desktop-and-wait-for-it-to-complete", "title": "Is there any way to run a .lnk file on my desktop and wait for it to complete?", "body": "<p>I have several .lnk files on my desktop that fetch data from other files that I use in my database.  These files copy data to the clipboard that I then paste into the displayed form.  I want to do this in Access VBA, rather then jumping to the desktop and clicking on the file.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11986137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcc3408cb4410b9240a5dad502965e6?s=128&d=identicon&r=PG&f=1", "display_name": "TommyO", "link": "https://stackoverflow.com/users/11986137/tommyo"}, "edited": false, "score": 0, "creation_date": 1567697289, "post_id": 57682884, "comment_id": 102049004, "body": "Thank you so much for your quick and concise response. Do you have a good way to run this code by selecting the active chart instead of having to retype &quot;Chart x&quot; every time I want to apply this code to a new chart? I tried changing ChartObjects(&quot;Chart 10&quot;) to ActiveChart but it&#39;s returning a run time error &#39;438&#39;."}, {"owner": {"reputation": 35, "user_id": 11986137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcc3408cb4410b9240a5dad502965e6?s=128&d=identicon&r=PG&f=1", "display_name": "TommyO", "link": "https://stackoverflow.com/users/11986137/tommyo"}, "edited": false, "score": 0, "creation_date": 1567702021, "post_id": 57682884, "comment_id": 102051207, "body": "I am new to the site. If you have a moment will you take a look at my follow up question above."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 35, "user_id": 11986137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcc3408cb4410b9240a5dad502965e6?s=128&d=identicon&r=PG&f=1", "display_name": "TommyO", "link": "https://stackoverflow.com/users/11986137/tommyo"}, "edited": false, "score": 0, "creation_date": 1567712903, "post_id": 57682884, "comment_id": 102055598, "body": "Untested, but try <code>Set cht = ActiveChart</code>"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1566944546, "last_edit_date": 1566944546, "creation_date": 1566944182, "answer_id": 57682884, "question_id": 57682722, "link": "https://stackoverflow.com/questions/57682722/excel-vba-attempting-to-loop-through-chart-series-lines-bars-and-dynamically/57682884#57682884", "title": "EXCEL VBA Attempting to loop through chart series (lines, bars) and dynamically change based on RGB codes referenced in my spreadsheet", "body": "<p>Your code has the following issues:</p>\n\n<ol>\n<li>The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/rgb-function\" rel=\"nofollow noreferrer\"><code>RGB</code></a> function returns a <code>Long</code>, which should be the type of each color.</li>\n<li>You need to repeat the type when declaring variables, otherwise they are actually <code>Variant</code>s: <code>Dim color1 as Long, color2 as Long, color3 as Long, color4 as Long</code>.</li>\n<li>The result of <code>color &amp; i</code> is a <code>String</code>, not the variables you intend to work with.</li>\n</ol>\n\n<p>All that said, you don't need the color variables here, just a simple loop, something roughly like this (can be beautified but you get the idea):</p>\n\n<pre><code>Sub asdf()\n    Dim cht As Chart\n    Set cht = ActiveSheet.ChartObjects(\"Chart 10\").Chart\n\n    Dim i As Long\n    For i = 1 To cht.SeriesCollection.Count\n        cht.SeriesCollection(i).Format.Line.ForeColor.RGB = _\n            RGB(Range(\"B7\").Offset(i).Value, Range(\"C7\").Offset(i).Value, Range(\"D7\").Offset(i).Value)\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Sample Chart:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XRGNx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XRGNx.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 11986137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fcc3408cb4410b9240a5dad502965e6?s=128&d=identicon&r=PG&f=1", "display_name": "TommyO", "link": "https://stackoverflow.com/users/11986137/tommyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 57682884, "answer_count": 1, "score": 0, "last_activity_date": 1566944546, "creation_date": 1566942981, "last_edit_date": 1566943399, "question_id": 57682722, "link": "https://stackoverflow.com/questions/57682722/excel-vba-attempting-to-loop-through-chart-series-lines-bars-and-dynamically", "title": "EXCEL VBA Attempting to loop through chart series (lines, bars) and dynamically change based on RGB codes referenced in my spreadsheet", "body": "<p>I want to loop through the lines in an excel chart and change the colors and widths of the lines based off predetermined RGB codes that I have referenced in my spreadsheet. </p>\n\n<p>I tried changing how the colors are stored as variable (integer, variant, colorformat)</p>\n\n<pre><code>    Dim cht As Chart\n    Set cht = ActiveSheet.ChartObjects(\"Chart 10\").Chart\n\n    'loop through series in chart to format lines\n\n    Dim ser As Series\n    Dim i As Integer\n    Dim color1, color2, color3, color4, color5, color6 As ColorFormat\n\n    color1 = RGB(Range(\"B8\"), Range(\"c8\"), Range(\"d8\"))\n    color2 = RGB(Range(\"B9\"), Range(\"c9\"), Range(\"d9\"))\n    color3 = RGB(Range(\"B10\"), Range(\"c10\"), Range(\"d10\"))\n    color4 = RGB(Range(\"B11\"), Range(\"c11\"), Range(\"d11\"))\n\n    i = 1\n    For Each ser In cht.SeriesCollection\n        ser.Format.Line.ForeColor.RGB = \"color\" &amp; i\n        i = i + 1\n    Next ser\n</code></pre>\n\n<p>I expected the lines in my chart to change to the RGB codes I had laid out in my spreadsheet but various runtime errors returned.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1566942480, "post_id": 57682602, "comment_id": 101811702, "body": "What is your question? You post code without telling us the issues or problems you face."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1566942826, "post_id": 57682602, "comment_id": 101811793, "body": "Unless all your values are numeric, some of them will need quotes.  And I think you also need parentheses around the list of values."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11699461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60ff3ec322b3e2c765dcfae07197772?s=128&d=identicon&r=PG&f=1", "display_name": "CMW", "link": "https://stackoverflow.com/users/11699461/cmw"}, "edited": false, "score": 1, "creation_date": 1567024228, "post_id": 57682741, "comment_id": 101843186, "body": "It seems to be working but it goes into an infinite loop while inserting data to the ItemsQuerySP_Temp table. It is inserting same record infinitely. What could have gone wrong?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 3, "user_id": 11699461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60ff3ec322b3e2c765dcfae07197772?s=128&d=identicon&r=PG&f=1", "display_name": "CMW", "link": "https://stackoverflow.com/users/11699461/cmw"}, "edited": false, "score": 1, "creation_date": 1567031254, "post_id": 57682741, "comment_id": 101845382, "body": "You have to incorporate <code>Recordset.MoveNext</code>. See edit. I hadn&#39;t realized I left it out."}, {"owner": {"reputation": 3, "user_id": 11699461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60ff3ec322b3e2c765dcfae07197772?s=128&d=identicon&r=PG&f=1", "display_name": "CMW", "link": "https://stackoverflow.com/users/11699461/cmw"}, "edited": false, "score": 0, "creation_date": 1568151307, "post_id": 57682741, "comment_id": 102181655, "body": "Works great now! Thanks!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 3, "user_id": 11699461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60ff3ec322b3e2c765dcfae07197772?s=128&d=identicon&r=PG&f=1", "display_name": "CMW", "link": "https://stackoverflow.com/users/11699461/cmw"}, "edited": false, "score": 0, "creation_date": 1568152436, "post_id": 57682741, "comment_id": 102181999, "body": "Great to hear! Don&#39;t forget the StackOverflow way of saying <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work/5235#5235\">thanks</a>!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1567031158, "last_edit_date": 1567031158, "creation_date": 1566943046, "answer_id": 57682741, "question_id": 57682602, "link": "https://stackoverflow.com/questions/57682602/assign-recordset-to-variable-in-vba/57682741#57682741", "title": "Assign Recordset to Variable in VBA", "body": "<p>Possibly your issue is the lack of quotes around string variables which would raise SQL error. Since you use ADO parameters, continue to use parameters via <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/parameters-collection-dao\" rel=\"nofollow noreferrer\">QueryDef</a>, avoiding string concatenation (i.e., ampersands) or punctuation (i.e., quotes):</p>\n\n<p><strong>SQL</strong> <em>(save below as an MS Access saved query, adjust types as needed: <code>Text</code>, <code>Long</code>, <code>Double</code>, etc.)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS PrmItm Text, PrmJobNo Text, PrmRevNo Text, \n           PrmDUStatus Text, PrmLDUStatus Text, PrmUTrigger Text;\nINSERT INTO ItemsQuerySP_Temp \nVALUES(PrmItm, PrmJobNo, PrmRevNo, \n       PrmDUStatus, PrmLDUStatus, PrmUTrigger)\n</code></pre>\n\n<p><strong>VBA</strong> <em>(relevant section)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim qdef AS QueryDef\n\n' ... same as above...\nSet qdef = CurrentDb.QueryDefs(\"mySavedQuery\") \n\nWith rst\n   Do While Not .EOF\n\n        ' BIND PARAMETERS\n        qdef!PrmItm = rst.Fields(\"Item\")\n        qdef!PrmJobNo = rst.Fields(\"Job No\")\n        qdef!PrmRevNo = rst.Fields(\"Revision No\")\n        qdef!PrmDUStatus= rst.Fields(\"DateUpdatedStatus\")\n        qdef!PrmLDUStatus = rst.Fields(\"LastDateUpdatedStatus\")\n        qdef!PrmUTrigger = rst.Fields(\"UpdateTrigger\")\n\n        ' EXECUTE ACTION\n        qdef.Execute dbFailOnError\n        .MoveNext\n   Loop\nEnd With\n\nSet qdef = Nothing\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11699461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e60ff3ec322b3e2c765dcfae07197772?s=128&d=identicon&r=PG&f=1", "display_name": "CMW", "link": "https://stackoverflow.com/users/11699461/cmw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1796, "favorite_count": 0, "accepted_answer_id": 57682741, "answer_count": 1, "score": 0, "last_activity_date": 1567031158, "creation_date": 1566942171, "last_edit_date": 1567024482, "question_id": 57682602, "link": "https://stackoverflow.com/questions/57682602/assign-recordset-to-variable-in-vba", "title": "Assign Recordset to Variable in VBA", "body": "<p>I am trying to assign variables value from recordset and insert values into an Access table. I also need to clear the table and insert new set of data before inserting. The recordset is from a stored procedure in SQL Server. Following does not seem to work:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim conn As ADODB.Connection, cmd As ADODB.Command, rst As \nADODB.Recordset\nDim Itm As String, JobNo As Integer, RevNo As Integer, DUStatus As Date, LDUStatus As Date, UTrigger As String\n\n\nSet conn = New ADODB.Connection\nconn.ConnectionString = \"Provider='sqloledb';Data Source=SERVER;Initial Catalog='Database';Integrated Security='SSPI';\"\nconn.Open\n\n\nSet cmd = New ADODB.Command\nWith cmd\n    .ActiveConnection = conn\n    .CommandText = \"rg_ItemsQuerySP\"\n    .CommandType = adCmdStoredProc\n\n    .Parameters.Append .CreateParameter(\"@JobNo\", adInteger, adParamInput, , TempJobNo)\n    .Parameters.Append .CreateParameter(\"@RevNo\", adInteger, adParamInput, , TempRevNo)\nEnd With\n\nSet rst = cmd.Execute\n\nIf rst.EOF Then Exit Function\nrst.MoveLast\nrst.MoveFirst\n    With rst\n      Do While Not .EOF\n\n            Itm = rst.Fields(\"Item\")\n            JobNo = rst.Fields(\"Job No\")\n            RevNo = rst.Fields(\"Revision No\")\n            DUStatus = rst.Fields(\"DateUpdatedStatus\")\n            LDUStatus = rst.Fields(\"LastDateUpdatedStatus\")\n            UTrigger = rst.Fields(\"UpdateTrigger\")\n\n        DoCmd.RunSQL (\"INSERT INTO ItemsQuerySP_Temp values \" &amp; Itm &amp; \", \" &amp; JobNo &amp; \", \" &amp; RevNo &amp; \", \" &amp; DUStatus &amp; \", \" &amp; LDUStatus &amp; \", \" &amp; UTrigger &amp; \";\")\n        rst.MoveNext\n    Loop\n    End With\n\n   conn.Close\n   Set conn = Nothing\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1566968683, "post_id": 57682589, "comment_id": 101816200, "body": "If you use <code>Range.Find</code> the search <code>Range</code> object will move to the &quot;found&quot; range. Same as a <code>Selection</code> will if you were to use <code>Selection.Find</code>. Note that it&#39;s also possible to use <code>Find.Replace</code>. Try it as a user, first, to see how it works. Then record a macro to get the &quot;bare bones&quot; code. If you need further help, come back and post a new question with the recorded macro code and we can show you how to refine it for your requirements."}, {"owner": {"reputation": 305, "user_id": 11986067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f837baebef4ad3dc5f5dec7e39cd73?s=128&d=identicon&r=PG&f=1", "display_name": "Ling", "link": "https://stackoverflow.com/users/11986067/ling"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567022271, "post_id": 57682589, "comment_id": 101842419, "body": "Thank you for your help! So, for example this code should display a message box with the found text, right? <code>\u2026 Dim start_point As Range  Set start_point = ActiveDocument.Range test = start_point.Find.Execute(selectionName)  MsgBox start_point.Text      &#47;&#47;returns whole document and not the searched test MsgBox &quot;Range:&quot; &amp; test      &#47;&#47;returns false  test = Selection.Find.Execute(selectionName) MsgBox &quot;Selection:&quot; &amp; test      &#47;&#47;returns true</code>   Only the \u201cSlection.Find\u201d method finds the searched word and return true. \u201cRange.Find\u201d returns false (see example above)."}, {"owner": {"reputation": 305, "user_id": 11986067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f837baebef4ad3dc5f5dec7e39cd73?s=128&d=identicon&r=PG&f=1", "display_name": "Ling", "link": "https://stackoverflow.com/users/11986067/ling"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567022443, "post_id": 57682589, "comment_id": 101842509, "body": "Sorry for this horrible formatted answer. I\u2019m new to Stackoverflow, is there a way to write an readable answer?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567025326, "post_id": 57682589, "comment_id": 101843615, "body": "LIng, I&#39;m sorry - I should have mentioned you can use the <a href=\"https://stackoverflow.com/posts/57682589/edit\">edit</a> link below your question to add the code directly to the question. That will look much better :-) Good on you, though, for finding the <code>backtick</code>!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567077676, "post_id": 57682589, "comment_id": 101860153, "body": "See if the proposed approach in this Answer isn&#39;t what you&#39;re looking for? <a href=\"https://stackoverflow.com/questions/57477990/word-through-excel-how-to-select-a-portion-of-text/57493466#57493466\" title=\"word through excel how to select a portion of text\">stackoverflow.com/questions/57477990/&hellip;</a>"}, {"owner": {"reputation": 305, "user_id": 11986067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f837baebef4ad3dc5f5dec7e39cd73?s=128&d=identicon&r=PG&f=1", "display_name": "Ling", "link": "https://stackoverflow.com/users/11986067/ling"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1567280287, "post_id": 57682589, "comment_id": 101921197, "body": "Thank you for the link, the problem seems to be almost similar but I have some problems with the <code>Range.Find</code> function as described in my updated description."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 11986067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f837baebef4ad3dc5f5dec7e39cd73?s=128&d=identicon&r=PG&f=1", "display_name": "Ling", "link": "https://stackoverflow.com/users/11986067/ling"}, "is_accepted": true, "score": 0, "last_activity_date": 1567375957, "creation_date": 1567375957, "answer_id": 57749837, "question_id": 57682589, "link": "https://stackoverflow.com/questions/57682589/words-vba-creating-range-using-positions-of-searched-words/57749837#57749837", "title": "Words VBA: Creating Range using positions of searched words", "body": "<p>After a long time I was able to solve my problem.\nHere is the code that looks for the XML part and returns it as a Range object:</p>\n\n<pre><code>Private Function getXMLRange1(XMLStart As String):\n\n    'TEST\n    Dim test As Boolean\n\n    Dim XMLEnd As String\n    XMLEnd = \"&lt;/order&gt;\"\n\n    Dim range_start As Long\n    Dim range_end As Long\n\n    Dim start_point As Range\n    Dim start_pointNext As Range\n    Dim end_point As Range\n\n    Set start_point = ActiveDocument.Range\n\n\n    test = start_point.Find.Execute(XMLStart)\n'    MsgBox start_point.Text\n'    MsgBox \"Range start:\" &amp; test\n\n    start_point.Move Unit:=wdParagraph, Count:=2\n    Set end_point = ActiveDocument.Range(start_point.Start, ActiveDocument.Range.End)\n\n\n    test = end_point.Find.Execute(XMLEnd)\n'    MsgBox end_point.Text\n'    MsgBox \"Range end:\" &amp; test\n\n\n    range_start = start_point.End\n    range_end = end_point.End\n\n\n    Set getXMLRange1 = ActiveDocument.Range( _\n        Start:=range_start, _\n        End:=range_end)\n\nEnd Function\n</code></pre>\n\n<p>Range.Find and Selection.Find behave the equal way.</p>\n"}], "owner": {"reputation": 305, "user_id": 11986067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f837baebef4ad3dc5f5dec7e39cd73?s=128&d=identicon&r=PG&f=1", "display_name": "Ling", "link": "https://stackoverflow.com/users/11986067/ling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 57749837, "answer_count": 1, "score": 1, "last_activity_date": 1567375957, "creation_date": 1566942096, "last_edit_date": 1567280162, "question_id": 57682589, "link": "https://stackoverflow.com/questions/57682589/words-vba-creating-range-using-positions-of-searched-words", "title": "Words VBA: Creating Range using positions of searched words", "body": "<p>I have the following Problem: We wrote a specification with many external sources like XML Files etc. and every time the XML file changes, we have to modify the corresponding XML part in the specification. Actually, I managed to insert the Text of the XML File every time the document will be opened. My Problem is now that I can\u2019t search after the already inserted XML code which is outdated and should be replaced by this new one.</p>\n\n<p>After some useful hints from @Cindy Master I would adopt my code like this (code: one of my used functions which contains the difficult selection of the old xml which I can\u2019t manage to work):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function wasUpdated(strFilename As String, XMLStart As String, XMLEnd As String) As Boolean\n\n    Dim new_xml As String\n    FileToString new_xml, strFilename\n\n    Dim range_start As Long\n    Dim range_end As Long\n\n    Dim start_point As Range\n    Dim end_point As Range\n\n    Set start_point = ActiveDocument.Range\n    Set end_point = ActiveDocument.Range\n\n    start_point.Find.Execute(XMLStart)\n    end_point.Find.Execute(XMLEnd)\n\n    range_start = start_point.Start\n    range_end = end_point.End\n\n    Set rngParagraphs = ActiveDocument.Range( _\n        Start:=range_start, _\n        End:=range_end)\n\n    old_xml = rngParagraphs.Text\n\n    If new_xml = old_xml Then\n        wasUpdated = False\n    Else\n        wasUpdated = True\n    End If\nEnd Function\n</code></pre>\n\n<p>The Problem with this code is that the <code>start_point.Find.Execute(XMLStart)</code> function can\u2019t find the searched word. Strangely enough, the <code>Selection.Find.Execute(XMLStart)</code> works. Is there a difference between <code>Range.Find</code> and <code>Selection.Find</code> which I don\u2019t know?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": false, "score": 0, "last_activity_date": 1566942481, "creation_date": 1566942481, "answer_id": 57682643, "question_id": 57682177, "link": "https://stackoverflow.com/questions/57682177/convert-vba-email-program-to-html/57682643#57682643", "title": "Convert VBA Email program to HTML", "body": "<p>Bodyformat should be olFormatHTML if you're wanting a html body.</p>\n\n<p>The options are:\nolFormatHTML,\nolFormatPlain,\nolFormatRichText,\nolFormatUnspecified</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa211430(v%3Doffice.11)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa211430(v%3Doffice.11)</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8864971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd159639f6af917773cdadfdb947c1?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Grimes", "link": "https://stackoverflow.com/users/8864971/brad-grimes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566942481, "creation_date": 1566939454, "last_edit_date": 1566939969, "question_id": 57682177, "link": "https://stackoverflow.com/questions/57682177/convert-vba-email-program-to-html", "title": "Convert VBA Email program to HTML", "body": "<p>I have written an email program to send newest files. Is there a code to convert it to HTML. See code below    </p>\n\n<pre><code>Sub SendNewestFiles()\n    Dim objMail As Outlook.MailItem\n    Dim fldName As String\n    Dim sName As String\n\n    fldName = \"\\\\mgamain\\DATA\\General\\TINA FILES\\INVOICES TO EMAIL\\\"\n    i = 0\n    sName = Dir(fldName)\n    Do While Len(sName) &gt; 0\n\n    Set objMail = Application.CreateItem(olMailItem)\n\n\n    With objMail\n        .Subject = \"MGA INTERNATIONAL INVOICES\"\n        .BodyFormat = olFormatPlain\n        .Attachments.Add (fldName &amp; sName)\n        .Display ' .send\n    End With \n\n    sName = Dir \n    i = i + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "dcount"], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 2, "last_activity_date": 1566941913, "creation_date": 1566941913, "answer_id": 57682568, "question_id": 57682133, "link": "https://stackoverflow.com/questions/57682133/dcount-using-two-criteria/57682568#57682568", "title": "DCount using two Criteria", "body": "<p>Assuming that your table/query <code>ZeroAudit</code> contains a field called <code>VendorNumber</code>, and that your form also contains a field called <code>VendorNumber</code>, then the below present two possible methods:</p>\n\n<p>Using <code>DCount</code>:</p>\n\n<pre><code>If DCount(\"*\", \"ZeroAudit\", \"PONumber='\" &amp; Me.PONumber &amp; \"' and VendorNumber='\" &amp; Me.VendorNumber &amp; \"'\") = 0 Then\n    MsgBox \"Needs QA\"\nElse\n    MsgBox \"Does NOT Need QA \u2014 DIM and RETAIL CHECK REQUIRED\"\nEnd If\nMe.PONumber.SetFocus\n</code></pre>\n\n<p>Using <code>DLookup</code>:</p>\n\n<pre><code>If IsNull(DLookup(\"PONumber\", \"ZeroAudit\", \"PONumber='\" &amp; Me.PONumber &amp; \"' and VendorNumber='\" &amp; Me.VendorNumber &amp; \"'\")) Then\n    MsgBox \"Needs QA\"\nElse\n    MsgBox \"Does NOT Need QA \u2014 DIM and RETAIL CHECK REQUIRED\"\nEnd If\nMe.PONumber.SetFocus\n</code></pre>\n\n<p>Note that the <code>ElseIf</code> is not required since the return of <code>DCount</code> will either be positive or zero; hence if you are testing for zero, all other possibilities are covered by the <code>Else</code> statement.</p>\n"}], "owner": {"reputation": 45, "user_id": 11963138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d9c0ac0137a506759e44f897096d854?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie", "link": "https://stackoverflow.com/users/11963138/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57682568, "answer_count": 1, "score": 1, "last_activity_date": 1594549347, "creation_date": 1566939257, "last_edit_date": 1594549347, "question_id": 57682133, "link": "https://stackoverflow.com/questions/57682133/dcount-using-two-criteria", "title": "DCount using two Criteria", "body": "<p>I have an Access Form with two combo boxes, PO Number and Vendor Number. The Vendor Number will automatically filter to show only those who match the chosen PO Number (PO Numbers are sadly not unique; multiple unrelated vendors may have 2180965 as their PO Number, for example).</p>\n\n<p>Some POs are exempt from our inspection process, and we keep a list of them in a table called ZeroAudit. That table contains both the PO Number and Vendor Number for the exempt delivery.</p>\n\n<p>Before I found out that PO Numbers weren't unique, I was using this code to tell our team whether a given PO requires inspection. How can I update it to require that both the PO Number and Vendor Number match the ZeroAudit table entry to be exempt from QA?</p>\n\n<pre><code>Private Sub VendorNumber_AfterUpdate()\nDim IntX As Integer\nIntX = DCount(\"*\", \"ZeroAudit\", \"PONumber=\" &amp; Chr(34) &amp; Me.PONumber.Value &amp; Chr(34))\nDebug.Print Me.PONumber.Value\n\nIf IntX = 0 Then\n  MsgBox \"Needs QA\"\n  Me.PONumber.SetFocus\nElseIf IntX &gt; 0 Then\n  MsgBox \"Does NOT Need QA \u2014 DIM and RETAIL CHECK REQUIRED\"\n  Me.PONumber.SetFocus\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1566937688, "post_id": 57681756, "comment_id": 101810206, "body": "the 2nd and 3rd parameter of the AddShape command are the top and left  corner of the shape. You need to change these numbers to reflect your current position."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1566937875, "post_id": 57681756, "comment_id": 101810281, "body": "^ See the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shapes.addshape\" rel=\"nofollow noreferrer\"><code>AddShape</code></a> documentation for more detail."}], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1566938167, "post_id": 57681878, "comment_id": 101810377, "body": "@BigBen yes, thanks. That would be more accurate. I&#39;ll edit it."}, {"owner": {"reputation": 13, "user_id": 11985927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed7b1289ae95237b762e0acf5e8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "hamghani", "link": "https://stackoverflow.com/users/11985927/hamghani"}, "edited": false, "score": 0, "creation_date": 1566941559, "post_id": 57681878, "comment_id": 101811448, "body": "If I wanted to do this for an arrow and I added the same my left and my top parameters how do I make it so the arrow points to a random location or perhaps a fixed length to anywhere on the excel file?"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1566938179, "last_edit_date": 1566938179, "creation_date": 1566937972, "answer_id": 57681878, "question_id": 57681756, "link": "https://stackoverflow.com/questions/57681756/applying-custom-shortcut-for-a-shape-to-the-current-cell-i-am-on/57681878#57681878", "title": "Applying custom shortcut for a shape to the current cell I am on", "body": "<p>You need the top and left of the current cell and plug that into the AddShape parameters</p>\n\n<pre><code>Dim myTop As Double\nDim myLeft As Double\n    myTop = Selection.Top\n    myLeft = Selection.Left\n    ActiveSheet.Shapes.AddShape(msoShapeRectangle, myLeft, myTop, 96.75, 26.25). _\n        Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1566939131, "creation_date": 1566939131, "answer_id": 57682109, "question_id": 57681756, "link": "https://stackoverflow.com/questions/57681756/applying-custom-shortcut-for-a-shape-to-the-current-cell-i-am-on/57682109#57682109", "title": "Applying custom shortcut for a shape to the current cell I am on", "body": "<p>The current selection could be assigned to a range variable. Then, working with that range, one may use the <code>.Left</code>, <code>.Top</code>, <code>.Width</code> and <code>.Height</code> properties of the range. </p>\n\n<p>Another good idea is to declare the shape as a variable and work with it and not with the <code>Selection</code>, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">because it is a bad practice</a> - the selection can be a <code>Range</code> or a <code>Shape</code> object:</p>\n\n<pre><code>Sub RedSquareShapeNoFill()\n\n    Dim myShape As Shape\n    Dim wks As Worksheet: Set wks = ActiveSheet\n\n    Dim selectionRange As Range\n    Set selectionRange = Selection\n\n    Set myShape = wks.Shapes.AddShape(msoShapeRectangle, _\n                selectionRange.Left, _\n                selectionRange.Top, _\n                selectionRange.Width, _\n                selectionRange.Height)\n\n    With myShape.Line\n        myShape.Fill.Visible = msoFalse\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 0, 0)\n        .Transparency = 0\n        .Visible = msoTrue\n        .Weight = 1.5\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11985927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed7b1289ae95237b762e0acf5e8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "hamghani", "link": "https://stackoverflow.com/users/11985927/hamghani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 57682109, "answer_count": 2, "score": 1, "last_activity_date": 1566939131, "creation_date": 1566937314, "last_edit_date": 1566937582, "question_id": 57681756, "link": "https://stackoverflow.com/questions/57681756/applying-custom-shortcut-for-a-shape-to-the-current-cell-i-am-on", "title": "Applying custom shortcut for a shape to the current cell I am on", "body": "<p>I am trying to create a custom shape with a hotkey. I want it to automatically go to a specific cell I am currently on instead of the same area every single time I run it with my hotkey. </p>\n\n<pre><code>Sub RedSquareShapeNoFill()\n'\n' RedSquareShapeNoFill Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    ActiveSheet.Shapes.AddShape(msoShapeRectangle, 197.25, 44.25, 96.75, 26.25). _\n        Select\n    Selection.ShapeRange.Fill.Visible = msoFalse\n    With Selection.ShapeRange.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 0, 0)\n        .Transparency = 0\n    End With\n    With Selection.ShapeRange.Line\n        .Visible = msoTrue\n        .Weight = 1.5\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1566937311, "post_id": 57681698, "comment_id": 101810065, "body": "Also consider opening the file <code>For Output</code> if you&#39;re not writing a binary blob to it"}, {"owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1566938437, "post_id": 57681698, "comment_id": 101810473, "body": "How would I write it? @Cryostasys"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "edited": false, "score": 0, "creation_date": 1566938876, "post_id": 57681698, "comment_id": 101810599, "body": "Change ` Open FileName For Binary Access Write As FileNum   Put FileNum, , s   Close FileNum` To  <code>Open FileName For Output As #1 Print #1, s Close #1</code>"}, {"owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1566940362, "post_id": 57681698, "comment_id": 101811066, "body": "<code>s Close #1</code> is giving me error. do I need the s? @Cryostasys"}, {"owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1566940902, "post_id": 57681698, "comment_id": 101811257, "body": "I tried all this, still showing the double quotation marks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "edited": false, "score": 0, "creation_date": 1566943923, "post_id": 57681698, "comment_id": 101812045, "body": "The comment didn&#39;t let me line space things properly for display. The line structure for VBA should go by line numbers: 1 <code>Open FileName For Output As #1</code> 2 <code>Print #1, s</code> 3 <code>Close #1</code>  The s is the copy of the data that you made in the original code."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "is_accepted": false, "score": 3, "last_activity_date": 1566937031, "last_edit_date": 1566937031, "creation_date": 1566936979, "answer_id": 57681698, "question_id": 57681593, "link": "https://stackoverflow.com/questions/57681593/how-to-remove-double-quotation-marks-when-converting-from-excel-to-text-file/57681698#57681698", "title": "How to remove double quotation marks when converting from excel to text file?", "body": "<p>You should use <code>Print</code> not <code>Write</code> if you don't want the quote marks</p>\n"}], "owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566937031, "creation_date": 1566936479, "question_id": 57681593, "link": "https://stackoverflow.com/questions/57681593/how-to-remove-double-quotation-marks-when-converting-from-excel-to-text-file", "title": "How to remove double quotation marks when converting from excel to text file?", "body": "<p>Every time I use this code, for some reason, double quotation marks appear for cell's output from beginning to ending. Anyway how I can remove these quotation marks?</p>\n\n<p>I tried using a basic VBA, where it copies data from a certain column and converts it to a txt file.</p>\n\n<pre><code>Dim s As String, FileName As String, FileNum As Integer\n\n  ' Define full pathname of TXT file\n  FileName = ThisWorkbook.Path &amp; \"\\2019.con\"\n\n  ' Copy range to the clipboard\n  Range(\"A2\", Cells(Rows.Count, \"A\").End(xlUp)).Copy\n\n  ' Copy column content to the 's' variable via clipboard\n  With New DataObject\n     .GetFromClipboard\n     s = .GetText\n  End With\n  Application.CutCopyMode = False\n\n  ' Write s to TXT file\n  FileNum = FreeFile\n  If Len(Dir(FileName)) &gt; 0 Then Kill FileName\n  Open FileName For Binary Access Write As FileNum\n  Put FileNum, , s\n  Close FileNum\n</code></pre>\n\n<p><code>Actual Result:\n\"CONT=10\"\n\".\"\n\".\"\n\".\"</code></p>\n\n<p><code>Desired Result:\nCONT=10\n.\n.\n.\n</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1566933799, "post_id": 57680985, "comment_id": 101808709, "body": "First of all you can&#39;t place <code>If ... Then ...</code> in one line of code. Second of all you are missing about 8 instances of <code>End If</code>, so this code could never have worked in any sheet..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1566933843, "post_id": 57680985, "comment_id": 101808721, "body": "There&#39;s nothing in column A, i.e. <code>LR=1</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 3, "creation_date": 1566933865, "post_id": 57680985, "comment_id": 101808728, "body": "@DannyPapadopulos - you can do it on one line."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 3, "creation_date": 1566933911, "post_id": 57680985, "comment_id": 101808748, "body": "@Danny Papadopulos - Yes you can -- see the one line syntax provided in <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/if-then-else-statement\" rel=\"nofollow noreferrer\">this link</a>"}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1566933998, "post_id": 57680985, "comment_id": 101808781, "body": "Oh I didn&#39;t know, it looks so nasty to code like that I wouldn&#39;t have ever thought somebody would use that. Anyway, where are all those <code>End If</code>s?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 3, "creation_date": 1566934058, "post_id": 57680985, "comment_id": 101808800, "body": "@DannyPapadopulos For single line IF THEN no END IF is required."}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1566934154, "post_id": 57680985, "comment_id": 101808837, "body": "Thanks, I&#39;ll keep that in mind. At least I learned that. However I have no idea who would want to use this, makes the code 1000 chars wide lol"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 2, "creation_date": 1566934217, "post_id": 57680985, "comment_id": 101808866, "body": "Add LR and RW to you watch list and see what their values are as you step through the code.  Set a break point at your NEXT RW line to step through the first two iterations faster then step through 1 line at a time to see what is tripping."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 2, "creation_date": 1566934362, "post_id": 57680985, "comment_id": 101808927, "body": "use <code>Option Explicit</code> and declare all your variables !"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 2, "creation_date": 1566934370, "post_id": 57680985, "comment_id": 101808933, "body": "@DannyPapadopulos I tend to use it for simple short single line &quot;then&quot; commands  &#39;IF progress = 100 then Done = True&#39;.  Saves cluttering with excess ENDIF."}, {"owner": {"reputation": 41, "user_id": 6019363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e67b56257fd66a5ab3b7c01f84f8410?s=128&d=identicon&r=PG&f=1", "display_name": "kms5549", "link": "https://stackoverflow.com/users/6019363/kms5549"}, "edited": false, "score": 0, "creation_date": 1566934929, "post_id": 57680985, "comment_id": 101809134, "body": "problem solved! A was not always populated so stopped the count, using D works. thanks guys!"}, {"owner": {"reputation": 374, "user_id": 6509779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Oejm.jpg?s=128&g=1", "display_name": "Wilco", "link": "https://stackoverflow.com/users/6509779/wilco"}, "edited": false, "score": 0, "creation_date": 1566935229, "post_id": 57680985, "comment_id": 101809254, "body": "looks like you&#39;re deleting rows 1-4 at the very beginning and then looping over (new) row 2 - the last row that has data in it in column A (your LR var). I would add some debugging to figure out what it thinks LR is:  ``` LR = sht.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row  MsgBox LR ```"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 1, "creation_date": 1566935357, "post_id": 57680985, "comment_id": 101809305, "body": "@DannyPapadopulos I agree block syntax should be used most of the time, but inline/statement syntax is rather useful for guard clauses, e.g. <code>If Not condition Then Exit Sub</code> at the top of a procedure."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1566953047, "post_id": 57680985, "comment_id": 101813526, "body": "after <code>LR = sht.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> in the next line type <code>Debug.Print LR</code>. Step thru the code and see what value is printed to the immeadiate window"}], "owner": {"reputation": 41, "user_id": 6019363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e67b56257fd66a5ab3b7c01f84f8410?s=128&d=identicon&r=PG&f=1", "display_name": "kms5549", "link": "https://stackoverflow.com/users/6019363/kms5549"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566938331, "creation_date": 1566933505, "last_edit_date": 1566935277, "question_id": 57680985, "link": "https://stackoverflow.com/questions/57680985/vba-for-next-loop-is-stopping-after-second-row", "title": "VBA For Next Loop is stopping after second row", "body": "<p>I have a loop of checks to perform on a variable number of rows of data. This code works just fine on another report, but when copied and tweaked to check this report it is stopping the loop after 2 rows and then moving onto the next conditional formatting/sort in the code. I've googled and played around with this all day.. it seems that the last row is defined correctly and the For/Next is set up as it should be, so I cannot figure out why it's stopping. Do you guys have any ideas? I can add more code and context if you need it.</p>\n\n<pre><code>Dim sht As Worksheet, rw As Long\nDim LR As Long, rngRed As Range, rngRow As Range\n\nSet sht = Sheets(\"Page1_1\")\n\nsht.Rows(\"1:4\").Delete Shift:=xlUp 'delete cognos headers\n\nLR = sht.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor rw = 2 To LR\n    Set rngRed = Nothing   'reset range for problem cells\n\n    With sht.Rows(rw)\n        Set rngRow = .Cells(1).Resize(1, MAX_COLS) 'the row of data\n        'clear any previous fill\n        rngRow.Interior.ColorIndex = xlNone\n\n        'perform your checks\n        If Len(.Cells(1, \"A\").Value) = 0 Then BuildRange rngRed, .Cells(1, \"A\")\n        If Len(.Cells(1, \"A\").Value) = 0 Then BuildRange rngRed, .Cells(1, \"B\")\n        If (.Cells(1, \"B\").Value) &lt;= Date Then BuildRange rngRed, .Cells(1, \"A\")\n        If (.Cells(1, \"B\").Value) &lt;= Date Then BuildRange rngRed, .Cells(1, \"B\")\n        If (.Cells(1, \"G\").Value) = \"999999\" Then BuildRange rngRed, .Cells(1, \"G\")\n        If Len(.Cells(1, \"G\").Value) = 0 Then BuildRange rngRed, .Cells(1, \"G\")\n        If Len(.Cells(1, \"I\").Value) = 0 Then BuildRange rngRed, .Cells(1, \"I\")\n        If Len(.Cells(1, \"J\").Value) = 0 Then BuildRange rngRed, .Cells(1, \"J\")\n        'done checking\n\n        If Not rngRed Is Nothing Then\n            'found some problems, so color the row and then the problem cells\n            rngRow.Interior.Color = vbYellow\n            rngRed.Interior.Color = vbRed\n        End If\n\n    End With\nNext rw\n</code></pre>\n\n<p>It generates no debug or error messages, saves the file correctly, but only performs the checks on rows 1 and 2.</p>\n"}, {"tags": ["excel", "vba", "advanced-filter"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566933178, "post_id": 57680773, "comment_id": 101808475, "body": "try using <code>&gt; Now</code>"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566933884, "post_id": 57680773, "comment_id": 101808735, "body": "Same issue as <code>&gt;today()</code>"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566934491, "post_id": 57680773, "comment_id": 101808978, "body": "Can you show more of your code so the issue can be easily reproduced?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1566934721, "post_id": 57680773, "comment_id": 101809054, "body": "your formula must us the first cell in the data column as reference.  So say the date column in the data is in Column C and the first cell of data is C2 the formula in the criteria would be <code>=C2&gt;TODAY()</code>  it may show TRUE or FALSE but the filter will filter correctly. See <a href=\"https://www.ablebits.com/office-addins-blog/2016/09/14/use-advanced-filter-excel-criteria-range-examples/\" rel=\"nofollow noreferrer\">ablebits.com/office-addins-blog/2016/09/14/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1566934987, "post_id": 57680773, "comment_id": 101809156, "body": "With your data use <code>=A2&gt;TODAY()</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1566935015, "post_id": 57680773, "comment_id": 101809175, "body": "And the criteria range is <code>E1:E2</code>"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566935189, "post_id": 57680773, "comment_id": 101809241, "body": "Thanks, @ScottCraner. I tried that, but now it&#39;s filtering out everything. Is there something different about datetime data?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566935550, "post_id": 57680773, "comment_id": 101809373, "body": "remove the <code>Date</code> from E1  leave it blank but still keep the criteria range as E1:E2."}], "answers": [{"tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1566935475, "creation_date": 1566935475, "answer_id": 57681374, "question_id": 57680773, "link": "https://stackoverflow.com/questions/57680773/excel-advanced-filter-filter-values-greater-than-today/57681374#57681374", "title": "Excel - Advanced Filter: Filter values greater than today", "body": "<p>Your Criteria value should be:</p>\n\n<pre><code>Set Today as Date\n...\nToday = Date\n</code></pre>\n\n<p>if you are referring to today's date. Today is an Excel Function, not vba function.</p>\n\n<p>Sorry, but I can not make comments still. Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1566935801, "creation_date": 1566935801, "answer_id": 57681438, "question_id": 57680773, "link": "https://stackoverflow.com/questions/57680773/excel-advanced-filter-filter-values-greater-than-today/57681438#57681438", "title": "Excel - Advanced Filter: Filter values greater than today", "body": "<p>When using a formula in Advanced filter the formula itself is the filter.  Remove the title from the criteria and point the formula at the first cell in the column data to be filtered.  In this case:</p>\n\n<pre><code>=A2&gt;TODAY()\n</code></pre>\n\n<p>So:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iRCKd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iRCKd.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Criteria must include the blank cell above:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HqgYc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HqgYc.png\" alt=\"enter image description here\"></a></p>\n\n<p>And we get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tY6g9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tY6g9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "accepted_answer_id": 57681438, "answer_count": 2, "score": 0, "last_activity_date": 1566935801, "creation_date": 1566932393, "last_edit_date": 1566934848, "question_id": 57680773, "link": "https://stackoverflow.com/questions/57680773/excel-advanced-filter-filter-values-greater-than-today", "title": "Excel - Advanced Filter: Filter values greater than today", "body": "<p>I'm trying to make use of Advanced Filter instead of AutoFilter as I'm told it performs much better in VBA. However, I can't seem to figure out a way to filter data to <strong>only show dates greater than today</strong> since that is dynamic and relies on a formula. </p>\n\n<p>I've tried making my criteria range <code>&gt;today()</code> and <code>\"&gt;\"&amp;B2</code> where <code>B2</code> is <code>today()</code></p>\n\n<p>Any idea what I'm missing?</p>\n\n<p>Advanced Filter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uQLbN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uQLbN.png\" alt=\"enter image description here\"></a></p>\n\n<p>Data before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MxBKx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MxBKx.png\" alt=\"before\"></a></p>\n\n<p>Desired Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nqNH5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nqNH5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1566932564, "post_id": 57680758, "comment_id": 101808221, "body": "<code>myWorksheetName = Format(Now, &quot;mmm_dd_yyyy&quot;) &amp; &quot; Group Bene&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1566932872, "creation_date": 1566932872, "answer_id": 57680861, "question_id": 57680758, "link": "https://stackoverflow.com/questions/57680758/add-name-and-date-to-new-tab/57680861#57680861", "title": "Add name and date to new tab", "body": "<p>Simple concatenation here, with the <code>\" Group Bene\"</code> (including a space) <em>outside</em> the <code>Format</code>:</p>\n\n<pre><code>myWorksheetName = Format(Now, \"mmm_dd_yyyy\") &amp; \" Group Bene\"\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>Aug_27_2019 Group Bene\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11661025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15be80d8fc2e5b2de208c8ba5809574?s=128&d=identicon&r=PG&f=1", "display_name": "Lukec", "link": "https://stackoverflow.com/users/11661025/lukec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 57680861, "answer_count": 1, "score": 0, "last_activity_date": 1566938852, "creation_date": 1566932323, "last_edit_date": 1566938852, "question_id": 57680758, "link": "https://stackoverflow.com/questions/57680758/add-name-and-date-to-new-tab", "title": "Add name and date to new tab", "body": "<p>I want to create a new tab, then give the tab a name and the current date. like: Group Bene 8/27/2019</p>\n\n<p>I can get the tab to be named as a date, or as Group Bene, but I cannot get both on the same tab.</p>\n\n<pre><code>Sub Refresh()\n\nmyWorksheetName = Format(Now, \"mmmm_dd_yyyy\")\n\n'add new tab\nSheets.Add.Name = myWorksheetName\n</code></pre>\n\n<p>The above gives me the tab with the dat. I've tried:</p>\n\n<p>myWorksheetName = Format(Now, \"mmmm_dd_yyyy Group Bene\")</p>\n\n<p>myWorksheetName = Format(Now, \"mmmm_dd_yyyy\" + \"Group Bene\")</p>\n\n<p>myWorksheetName = Format(Now, \"mmmm_dd_yyyy\"&amp;\"Group Bene\")</p>\n\n<p>I get errors.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1566931416, "post_id": 57680458, "comment_id": 101807754, "body": "What format is the cell containing the number? What file format are you exporting this to? What does your code look like? Please <a href=\"https://stackoverflow.com/posts/57680458/edit\">edit your question</a> to clarify things"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566931461, "post_id": 57680458, "comment_id": 101807763, "body": "<code>format(left(Range(&quot;A1&quot;),9),&quot;0000000\\-00\\.&quot;) &amp; format(Mid(Range(&quot;A1&quot;),10),&quot;0000\\.0\\.00\\.0000&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1566932460, "post_id": 57680653, "comment_id": 101808183, "body": "@ScottCraner Can you just extend the format to do this all in one <code>TEXT</code> formula?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1566932616, "post_id": 57680653, "comment_id": 101808246, "body": "No, Excel will only use 15 significant digits, the end will be lost."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1566932661, "post_id": 57680653, "comment_id": 101808269, "body": "Noted. Thanks for the info, @ScottCraner I don&#39;t deal with text formulas too often."}, {"owner": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567047738, "post_id": 57680653, "comment_id": 101848287, "body": "Hey guys, thanks for the tips. Both functions returned partial results tho. Longest string returned this: 0055136-#.#.#.#.#. Scotts short one returned this: 0018459-82."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567086663, "post_id": 57680653, "comment_id": 101865581, "body": "@HenriqueFontanadeOliveira You specifically mentioned that the string size is 20..."}, {"owner": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567127660, "post_id": 57680653, "comment_id": 101880284, "body": "Yes the original string before adding the one dash and 4 dots. I think I didn&#39;t make myself very clear and I&#39;m sorry for that, English is a second language and sometimes I screw up. So the final string would be 25 digits long, like the example I used in my original post."}], "tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1566932303, "last_edit_date": 1566932303, "creation_date": 1566931826, "answer_id": 57680653, "question_id": 57680458, "link": "https://stackoverflow.com/questions/57680458/how-do-i-call-a-function-to-add-remove-dots-and-dashes-on-a-given-cell/57680653#57680653", "title": "How do I call a function to add/remove dots and dashes on a given cell", "body": "<p>This solution isn't VBA but we can make one, however if you're just looking to reformat the text and it is as you show with no variation (I sense a date is in there and the length of this string may vary), this should work for you. </p>\n\n<p>Assuming you data starts in cell A1, you can put this formula in row 1 somewhere and get the desired format.</p>\n\n<p><code>=LEFT(A1,7)&amp;\"-\"&amp;RIGHT(LEFT(A1,9),2)&amp;\".\"&amp;RIGHT(LEFT(A1,13),4)&amp;\".\"&amp;LEFT(RIGHT(A1,7),1)&amp;\".\"&amp;LEFT(RIGHT(A1,6),2)&amp;\".\"&amp;RIGHT(A1,4)</code></p>\n\n<p>Or as Scott had mentioned you can use the shorter:</p>\n\n<p><code>=TEXT(LEFT(A1,9),\"0000000\\-00\\.\")&amp;TEXT(MID(A1,10,20),\"0000\\.0\\.00\\.0000\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "reply_to_user": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567060787, "post_id": 57681363, "comment_id": 101851476, "body": "So do you first format a cell to text and then copy the 20-digit number into that cell? I observed that when I first paste the value and then format it, the excel tends to change the values (if there were zeros at the beginning - they are gone, and the last two digits change to zeros), which we do not want. Make sure the number in a cell has 20 digits and then try this: <code>Range(&quot;A1&quot;).Value = Format(Range(&quot;A1&quot;), &quot;@@@@@@@-@@.@@@@.@.@@.@@@@&quot;)</code> instead."}, {"owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "reply_to_user": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567184893, "post_id": 57681363, "comment_id": 101901752, "body": "@henriquef, so did it work for you? Tried it today and it works fine on my computer."}, {"owner": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567346520, "post_id": 57681363, "comment_id": 101930854, "body": "hey, it worked! But unless I&#39;m mistaken now I&#39;d have to edit the sub for every single cell id like to adjust, right? Or can we adapt the code to work on the selected cell."}, {"owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "reply_to_user": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "edited": false, "score": 0, "creation_date": 1567500788, "post_id": 57681363, "comment_id": 101971607, "body": "@henriquef, just look at my edited post, that should give you an idea of how to adapt the code to work on a selected cells :)"}], "tags": [], "owner": {"reputation": 237, "user_id": 11917441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Lx5.jpg?s=128&g=1", "display_name": "bajun65537", "link": "https://stackoverflow.com/users/11917441/bajun65537"}, "is_accepted": true, "score": 0, "last_activity_date": 1567373942, "last_edit_date": 1567373942, "creation_date": 1566935419, "answer_id": 57681363, "question_id": 57680458, "link": "https://stackoverflow.com/questions/57680458/how-do-i-call-a-function-to-add-remove-dots-and-dashes-on-a-given-cell/57681363#57681363", "title": "How do I call a function to add/remove dots and dashes on a given cell", "body": "<p>If I got you correctly, you want to change the values in a range so that they are in the needed format (with dots and dashes) so then you can export it somewhere else?</p>\n\n<p>Maybe something like that can help? I assume you have your 00101592420158100001 in a cell A1.</p>\n\n<pre><code>Sub x()\nRange(\"A1\").Value = Format(Range(\"A1\"), \"#######-##.####.#.##.####\")\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT 1:</strong> As the number in cell A1 starts with 00 I assumed that you have cell A1 formatted as text. So that the macro proposed by me will only add a certain dashes or dots.</p>\n\n<p><strong>EDIT 2:</strong> Why the code above was not working is the fact that in VBA the \"@\" character represents a displayed character, and \"#\" works for numbers.\nSo, as suggested in a comment below, the subroutine like this:</p>\n\n<pre><code>Sub x()\nRange(\"A1\").Value = Format(Range(\"A1\"), \"@@@@@@@-@@.@@@@.@.@@.@@@@\")\nEnd Sub\n</code></pre>\n\n<p>will do the trick. </p>\n\n<p>But as you want to choose a range to be formatted I would suggest using something more like that:</p>\n\n<pre><code>Sub forhenriquef()\n\nDim cell As Range\nDim rng As Range\n\nOn Error Resume Next\n\nSet rng = Application.InputBox(\"Choose the range, OK?\", \"Macro for henriquef\", Selection.Address, , , , , 8)\nIf rng Is Nothing Then Exit Sub\n\n     For Each cell In rng\n          cell.Value = Format(cell, \"@@@@@@@-@@.@@@@.@.@@.@@@@\")\n     Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11985519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD7S7y75KF-KgNXEffNINB4__RaMe_H85ud4BKGDg=k-s128", "display_name": "henriquef", "link": "https://stackoverflow.com/users/11985519/henriquef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 57681363, "answer_count": 2, "score": -1, "last_activity_date": 1567373942, "creation_date": 1566930880, "last_edit_date": 1567048032, "question_id": 57680458, "link": "https://stackoverflow.com/questions/57680458/how-do-i-call-a-function-to-add-remove-dots-and-dashes-on-a-given-cell", "title": "How do I call a function to add/remove dots and dashes on a given cell", "body": "<p>Here in Brazil we use a 20 number string to identify judicial cases, in a standardized manner, separated by a dots and dashes.</p>\n\n<p>The problem is in most systems we use, when you export to excel it takes away the dots and dashes, thus creating a problem when exporting that data to a system that actually needs the dots and dashes to work (some poorly coded excuse for a legal system).</p>\n\n<p>What I'm trying to do is use VBA to call a function that fixes the number so I can export it.</p>\n\n<p>The way the standardized number works is like this:</p>\n\n<blockquote>\n  <p>0010159-24.2015.8.10.0001<br>\n  (CaseNumber-VerifyingDigit.Year.Court.State.City)</p>\n</blockquote>\n\n<p>When I export my current data do Excel, it shows like this:</p>\n\n<blockquote>\n  <p>00101592420158100001</p>\n</blockquote>\n\n<p>And I need it to go back to the format above!</p>\n\n<p>I'm 100% stuck though, would love some input.</p>\n\n<p>Edit:</p>\n\n<p>To clarify some stuff.</p>\n\n<p>The string is always 20 numbers long, its a standardized number set by our National Council of Justice, it never changes. All the cases follow that 20 number string format.</p>\n\n<p>The cell with the number is always in text, so it doesn't show as scientific notation.</p>\n"}]