[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539217291, "post_id": 52750255, "comment_id": 92425179, "body": "So you want to remove duplicates from both lists?  That&#39;s not clear in your description..."}, {"owner": {"reputation": 55, "user_id": 10335668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f913f26b09167a7f4b116f1a4a22561?s=128&d=identicon&r=PG&f=1", "display_name": "kd99", "link": "https://stackoverflow.com/users/10335668/kd99"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539224237, "post_id": 52750255, "comment_id": 92426630, "body": "yes, remove duplicates from list A and B and paste them into C"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1539236469, "last_edit_date": 1539236469, "creation_date": 1539219014, "answer_id": 52750626, "question_id": 52750255, "link": "https://stackoverflow.com/questions/52750255/compare-two-lists-and-paste-into-new-list/52750626#52750626", "title": "Compare two lists and paste into new list", "body": "<p>Something like this would work:</p>\n\n<pre><code>Sub example1()\n\n    Dim ListA, ListB, ListC(), i As Long, n As Long, m\n\n    ListA = Range(\"H4:H10\").Value\n    ListB = Range(\"I4:I8\").Value\n    ReDim ListC(1 To UBound(ListA, 1), 1 To 1) 'size the \"dups\" array\n    n = 1\n\n    For i = 1 To UBound(ListA, 1)\n        m = Application.Match(ListA(i, 1), ListB, 0) '&lt;&lt; check for match\n        If Not IsError(m) Then '&lt;&lt; have a duplicate\n            ListC(n, 1) = ListA(i, 1) 'add to ListC\n            ListA(i, 1) = \"\"          '(optional) remove from original lists...\n            ListB(m, 1) = \"\"\n            n = n + 1\n        End If\n    Next i\n\n    'print to sheet...\n    Range(\"K4\").Resize(UBound(ListA, 1)).Value = Compact(ListA)\n    Range(\"L4\").Resize(UBound(ListB, 1)).Value = Compact(ListB)\n    Range(\"M4\").Resize(UBound(ListC, 1)).Value = Compact(ListC)\n\nEnd Sub\n\n'remove empty array locations...\nFunction Compact(arr)\n    Dim rv(), p As Long, i As Long\n    ReDim rv(1 To UBound(arr, 1), 1 To 1)\n    For i = 1 To UBound(arr, 1)\n        If Len(arr(i, 1)) &gt; 0 Then\n            p = p + 1\n            rv(p, 1) = arr(i, 1)\n        End If\n    Next i\n    Compact = rv\nEnd Function\n</code></pre>\n\n<p>This assumes listA/B each contains unique values (no repeats within one list)</p>\n"}], "owner": {"reputation": 55, "user_id": 10335668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f913f26b09167a7f4b116f1a4a22561?s=128&d=identicon&r=PG&f=1", "display_name": "kd99", "link": "https://stackoverflow.com/users/10335668/kd99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539236469, "creation_date": 1539215396, "question_id": 52750255, "link": "https://stackoverflow.com/questions/52750255/compare-two-lists-and-paste-into-new-list", "title": "Compare two lists and paste into new list", "body": "<p>I have two lists of Data. List A and B both contain letter grades. I want to compare the data and if both lists have the same letter, I want to move that letter to list C that is blank to start with. If the two lists do not have the same letter, keep the letter where it is. I want to use 2 arrays to store the data and then create three new arrays for new list a,b, and c. Here is what I have so far.</p>\n\n<pre><code>Sub example1()\nDim ListA As Range, ListB As Range, ListC As Range\n\n    Range(\"H4:H10\").Name = \"ListA\"\n    Range(\"I4:I6\").Name = \"ListB\"\n    Range(\"J4\", Range(\"J4\").End(xlDown)).Name = \"ListC\"\n\nDim A(1 To 7), B(1 To 3), i As Integer, j As Integer\n\n    For i = 1 To 7 'stores data in listA in array A\n        A(i) = Range(\"ListA\").Cells(i)\n    Next\n    For j = 1 To 3 'stores data in listB in array B\n            B(j) = Range(\"ListB\").Cells(j)\n    Next\n\n'select first from ListA and then compare data to listB\n' if it is not found, stop and go to next item\n'if it IS found, put in list C\nDim isfound As Boolean, letter As Variant, C(1 To 7), k As Integer\n\nFor i = 1 To 7\n    isfound = False\n        For j = 1 To 3\n            If A(i) = B(j) Then\n                isfound = True\n                letter = A(i)\n                Exit For\n            End If\n        Next\n        For k = 1 To 7\n        C(k) = Range(\"ListC\").Cells(k) 'this is the part I am stuck on. How         \n                                      do I get data to paste over to List C?\n            If isfound = True Then\n            C(k) = A(i) 'this says it will be equal to A(i) value if it is \n                         found.\n            End If\n        Next\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539239388, "post_id": 52750103, "comment_id": 92430637, "body": "You need to use the <code>ComboBox1_Change()</code> event if you want to trigger code on every change on ComboBox1 values. <code>ComboBox2_Change()</code> only triggers if ComboBox2 changes."}, {"owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539256014, "post_id": 52750103, "comment_id": 92440141, "body": "True, but because I want to force the user to fill in order, it does not suit me, is there any other way?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539257217, "post_id": 52750103, "comment_id": 92440877, "body": "<i>&quot;I want to force the user to fill in order&quot;</i> If ComboBox1 is changed simply reset ComboBox2 to 4, this forces the user to select again if he went one step back. This is a common praxis to force the right order. \u2022 A change in ComboBox1 will always only trigger the <code>ComboBox1_Change()</code> event."}], "owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593696218, "creation_date": 1539214106, "last_edit_date": 1593696218, "question_id": 52750103, "link": "https://stackoverflow.com/questions/52750103/how-to-restart-the-macro-when-changing-in-userform", "title": "How to restart the macro when changing in userform", "body": "<p>I do not know how to explain the problem, hope you understand</p>\n<p>I use the code to force the user to fill out the form in order</p>\n<p>The problem I have is 4 combobox</p>\n<p>The 1 opens the 3 or 4 by the value of 1</p>\n<p>If I change the value of 1, I have to write the value again in 2 to open the 3 or 4</p>\n<p>My problem is that he does not constantly check what the value is in 1, only when there is a change in 2</p>\n<p>How can I force the 2 to constantly check the value in 1?</p>\n<p>That's the code I have</p>\n<pre><code>Private Sub ComboBox2_Change()\nDim lLoc As Long\nlLoc = Me.ComboBox2.ListIndex\nIf lLoc = -1 Then\n    Me.ComboBox2.SetFocus\n        ComboBox3.Enabled = False\n        ComboBox4.Enabled = False\n    Else\n        ComboBox3.Enabled = True\n    End If\n    If ComboBox1.Text = &quot;abc&quot; Then\n        ComboBox4.Enabled = True\n    Else\n        ComboBox4.Enabled = False\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540368849, "post_id": 52753667, "comment_id": 92834668, "body": "Was this of any use?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1539240559, "last_edit_date": 1539240559, "creation_date": 1539239555, "answer_id": 52753667, "question_id": 52750020, "link": "https://stackoverflow.com/questions/52750020/set-html-content-createobjecthtmlfile-doesnt-work/52753667#52753667", "title": "Set HTML_Content = CreateObject(&quot;htmlfile&quot;) doesn&#39;t work", "body": "<p>So this isn't going to be a nice <em>here you go</em> answer. At least not at present.</p>\n\n<ol>\n<li><code>XMLHTTP</code> request will not work here. The page is dynamically loaded and the content simply isn't there via the method you are using; which is executed before this info is available.</li>\n<li><p>You should always use <code>Option Explicit</code> at the top of your module. You have numerous undeclared variables (e.g. <code>Web_URL As String</code>) which will be generated on the fly as variants. And you are not catching what look like either typos/inconsistent variable naming: <code>Dim htm As Object: Set HTML_Content = CreateObject(\"htmlfile\")</code>. </p>\n\n<p>I suspect that you wanted <code>Set htm = CreateObject(\"htmlfile\")</code> . This would be an object type consistent with your existing naming and declaration.  <code>HTML_Content</code> would be a string, and would not require the <code>Set</code> keyword which assigns an object reference. Here, I think you wanted  <code>HTML_Content = .responseText</code>, but in fact it is safer to ensure any returned string is unencoded with <code>HTML_Content = StrConv(.responseBody, vbUnicode)</code></p></li>\n<li><p>There is only one table of interest, as far as I can see, and it has an id. If you were to continue with your method then after this line: <code>For Each Tab1 In HTML_Content.getElementsByTagName(\"table\")</code>, each <code>Tab1</code> would be an <code>HTMLTable</code> object so you wouldn't need the next line with <code>iTable</code> variable. You are using a <code>For Each Loop</code> so are already iterating the parent collection. Simply, grab the table by its id: <code>With .document.getElementById(\"fxst-calendartable\")</code>. id is the fastest retrieval method available so should be preferred over all other methods when available.</p></li>\n<li><p>The table is either poorly designed or deliberately designed to make scraping difficult. You can neither copy the object <code>outerHTML</code> to clipboard and paste the table to Excel, nor simply loop table rows and table cells to get all the content displayed. And the content that is displayed is not in a nice legible fashion. You may have some luck with web queries but in my experience Javascript heavy pages like this don't mix well with data from web queries.</p></li>\n</ol>\n\n<p>So, with those points in mind:</p>\n\n<ol>\n<li>You are going to likely need to use a browser to navigate and ensure page content has loaded e.g.  <code>While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend</code>, possibly with some extra explicit wait time</li>\n<li>It is also likely you will need to inspect the html of the table closely to write something fit for purpose to grab the elements you are interested in, and write them out in a coherent fashion to the page. For example, it is clear you will need to consider the role and placement of div elements within the table for correct alignment of data in your output.</li>\n<li>You could simply dump the above approach and screen shot the timetable or print it out. Consider whether the effort of coding this is worth it over simply printing the page once a week (unless page is frequently updated).</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 9780678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "CatCaller", "link": "https://stackoverflow.com/users/9780678/catcaller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1196, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593696203, "creation_date": 1539213346, "last_edit_date": 1593696203, "question_id": 52750020, "link": "https://stackoverflow.com/questions/52750020/set-html-content-createobjecthtmlfile-doesnt-work", "title": "Set HTML_Content = CreateObject(&quot;htmlfile&quot;) doesn&#39;t work", "body": "<p>I have this code, which copy the content of a website to Excel:</p>\n<pre><code>Sub HTML_Table_To_Excel()\nDim htm As Object\nDim Tr As Object\nDim Td As Object\nDim Tab1 As Object\n\nWeb_URL = &quot;https://www.fxstreet.com/economic-calendar&quot;\n\n'Create HTMLFile Object\n Set HTML_Content = CreateObject(&quot;htmlfile&quot;)\n\n 'Get the WebPage Content to HTMLFile Object\n  With CreateObject(&quot;msxml2.xmlhttp&quot;)\n .Open &quot;GET&quot;, Web_URL, False\n  .send\n  HTML_Content.body.innerHTML = .responseText 'this is the highlighted part \n   for the error\n  End With\n Column_Num_To_Start = 1\n iRow = 1\n iCol = 1\n iTable = 1\n\n  'Loop Through Each Table and Download it to Excel in Proper Format\n     For Each Tab1 In HTML_Content.getElementsByTagName(&quot;table&quot;)\n   With HTML_Content.getElementsByTagName(&quot;table&quot;)(iTable)\n    For Each Tr In .Rows\n        For Each Td In Tr.Cells\n        Worksheets(&quot;Sheet1&quot;).Cells(iRow, iCol).Select\n        Worksheets(&quot;Sheet1&quot;).Cells(iRow, iCol) = Td.innerText\n        iCol = iCol + 1\n        Next Td\n    iCol = Column_Num_To_Start\n    iRow = iRow + 1\n    Next Tr\n  End With\n\n Next Tab1\n\n MsgBox &quot;Process Completed&quot;\n End Sub\n</code></pre>\n<p>This coding was working so well, but now is not working; &quot;a message appear: Run-Time '429': ActiveX component can't create object &quot;  ...... after this, If I select Debug, a part of the code will highlight:</p>\n<pre><code>  Set HTML_Content = CreateObject(&quot;htmlfile&quot;)\n</code></pre>\n<p>What's the problem?</p>\n"}, {"tags": ["excel", "vba", "forms", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1539212122, "post_id": 52749828, "comment_id": 92424033, "body": "<code>Workbooks.Open</code> returns the opened workbook. Use <code>Set wb = .Workbooks.Open(str_Excel_Filename)</code> instead of <code>ActiveWorkbook</code>. Also, if you&#39;re using late binding, why is <code>oExcel</code> declared as <code>Object</code>?"}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539290770, "post_id": 52749828, "comment_id": 92460052, "body": "I tried this code but had the same error.  In the <code>Select_Sentence_Form_Test</code> sub I have verified that <code>Set frmModelessForInput.Book1 = wb_open</code> properly sets workbook to the property.  But when I get to <code>cmdDone_Click</code> I get the following error when I try to validate <code>frmModelessForInput.Book1.Name</code> before I execute <code>Me.Book1.ActiveSheet.PasteSpecial Format:=&quot;Text&quot;, Link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True</code>  &#39;Error: Automation error: the callee [not server application] is not available and disappeared;...&#39;"}], "owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539267457, "creation_date": 1539211818, "last_edit_date": 1539267457, "question_id": 52749828, "link": "https://stackoverflow.com/questions/52749828/error-when-passing-workbook-object-to-vba-form", "title": "Error when passing workbook object to VBA form", "body": "<p>I am working on a VBA script with Microsoft Word that allows the user to select text that will be copied to the clipboard so that it can exported to an Excel file. The user will make a number of selections and finally indicate he/she is done when the contents of the clipboard will be copied to a template Excel file.</p>\n\n<p>The form (<code>frmModeLessForInput</code>) is a modeless form.  The form has two buttons \"Continue\" and \"Done\". The user is allowed to navigate the document and place the cursor anywhere in the document. Then when \"Continue\" is pressed the form will call a subroutine (<code>Highlight_Sentence</code>) to copy the selected text to a \"clipboard\" variable. When \"Done\" is pressed control will be passed to called subroutine which will then copy the clipboard to the Excel file.</p>\n\n<p>The problem I am having is that I don't seem to have correct code needed to pass workbook object in created in the MAIN MODULE to the form using a form property. \nBelow is the code.  I have inserted comments in the code in the <code>Select_Sentence_Form_Test</code> and <code>cmdDone</code> subroutines where I am having the problem passing the workbook object.</p>\n\n<p>Any assistance in resolving these problems is appreciated.  As VBA programming is a sideline for me I am still learning.</p>\n\n<pre><code>Option Explicit\nPublic str_clipboard As String\nPublic txt_active_document As String\nPublic i_how_many_sentences As Integer\nPublic str_active_document\nPublic str_Excel_Filename As String\nPublic i_starting_row_ID As Integer\nPublic i_rows_of_data As Integer\n</code></pre>\n\n<p>MAIN MODULE</p>\n\n<pre><code>Sub Master_Module_Test()\nDim oExcel As Object\nDim wb As Excel.Workbook 'Object\n   Set oExcel = New Excel.Application\n   str_Excel_Filename = \"C:\\Test\\Excel_Template.xlsx\"\n   Documents.Open (\"C:\\Test\\Doc_to_process.docx\")\n   oExcel.Workbooks.Open str_Excel_Filename\n   i_how_many_sentences = 0\n   i_starting_row_ID = 1\n   Set wb = ActiveWorkbook\n   Call Select_Sentence_Form_Test(wb)\nEnd Sub\n\nSub Select_Sentence_Form_Test(wb_open As Workbook)\n    Dim frm As frmModelessForInput\n    Set frm = New frmModelessForInput\n' At this point wb_open is instantiated, i.e. I get \"Excel_Template.xlsx\" for wb_open.name\n' But this code gives me an error \"Object or block not set\".  If I leave this statement out then \"Me.Book1.ActiveSheet.PasteSpecial...\" in cmd_Done in the frmModelessForInput module gives the same error\n    Set frmModelessForInput.Book1 = wb_open\n    With frmModelessForInput\n        .str_word_doc_filename = str_active_document\n        .str_no_copied = \"0\"\n        .Show False\n    End With\n    Set frm = Nothing\nEnd Sub\n</code></pre>\n\n<p>Below is the code for the frmModelessForInput form</p>\n\n<pre><code>Option Explicit\nPrivate m_Book1 As Workbook\n\n\nPublic Property Get Book1() As Workbook\n   Set Book1 = m_Book1\nEnd Property\n\nPublic Property Set Book1(ByRef Value As Workbook)\n   Set m_Book1 = Value\nEnd Property\n\nPrivate Sub UserForm_Activate()\n    'Position the form near the top-left of the window\n    'So that the user can work with the document\n    Me.Top = Application.ActiveWindow.Top + 15\n    Me.Left = Application.ActiveWindow.Left + 15\nEnd Sub\n\nPrivate Sub cmdContinue_Click()\n Dim str_clipboard, str_clipboard_line As String\n       Call Highlight_Sentence(str_clipboard_line)\n        i_how_many_sentences = i_how_many_sentences + 1 'Problem: VBA reports i_how_many_sentences as undefined even though it is a Public variable \n        frmModelessForInput.str_no_copied = i_how_many_sentences  'Same Problem\n    str_clipboard = str_clipboard + str_clipboard_line 'Problem: each time I select a new text/sentence str_clipboard does not contain the contents of the previous selection\nEnd Sub\n\n\n\nPrivate Sub cmdCancel_Click()\n    b_abort = True\nUnload frmModelessForInput\nEnd Sub\n\nPrivate Sub cmdContinue_Click()\n Dim str_clipboard_line As String\n Dim i_row_number As Integer\n i_row_number = i_how_many_sentences + i_starting_row_ID\n i_how_many_sentences = i_how_many_sentences + 1\n Call Highlight_Sentence_Test(str_clipboard_line, i_row_number)\n frmModelessForInput.str_no_copied = i_how_many_sentences\n str_clipboard = str_clipboard + str_clipboard_line\nEnd Sub\n\nPrivate Sub cmdDone_Click()\n '  When the \"Done\" button is pressed the contents of the str_clipboard variable is copied to the Windows clipboard\n    Dim str_filename As String\n    str_filename = getName(str_Excel_Filename)\n    MsgBox \"I will now copy the data to the Excel file.\"\n    Call SendToClipboard(str_clipboard) 'This sub puts the contents of str_clipboard into the Windows clipboard\n    ' Uses the Book1 property --- this is the code line that produces the error \"Object or block variable not set.  Activeworkbook.name shows that Excel_Template.xlsx is active\n    Me.Book1.ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True\n    Unload frmModelessForInput\n    MsgBox \"Done pasting data to: \" &amp; getName(str_Excel_Filename)\nEnd Sub\n\n\n\n\nPrivate Sub Highlight_Sentence(clipboard As String, i_row_no As Integer)\n    Dim txt_sentence, txt_page_no As String\n    Dim txt_section_index As String\n    With Selection\n     ' Collapse current selection.\n     .Collapse\n     ' Expand selection to current sentence.\n     .Expand Unit:=wdSentence\n    End With\n    clipboard = i_row_no &amp; vbTab &amp; txt_sentence &amp; vbCrLf\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539211929, "post_id": 52749753, "comment_id": 92423984, "body": "Use <code>RemoveDuplicates</code>"}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1539212372, "post_id": 52749753, "comment_id": 92424097, "body": "RemoveDuplicates will work if you only want to delete what&#39;s in those two columns.  If you need to delete the entire row then you need VBA.  <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/bb238869(v=office.12)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 1, "creation_date": 1539227782, "post_id": 52749753, "comment_id": 92427325, "body": "@Graham you can specify the whole range and then use just those two columns as the criteria and it will remove the full row based on those two columns with RemoveDuplicates and you can use Remove Duplicates in vba."}, {"owner": {"reputation": 6543, "user_id": 641914, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0ba99266166249a4a67b6347b7bec53f?s=128&d=identicon&r=PG", "display_name": "Graham", "link": "https://stackoverflow.com/users/641914/graham"}, "edited": false, "score": 0, "creation_date": 1539228532, "post_id": 52749753, "comment_id": 92427485, "body": "Interesting, perhaps you should post this as an answer instead of a comment?"}, {"owner": {"reputation": 103, "user_id": 1744026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc07b09f37b8b3f3fef064e69ac3740?s=128&d=identicon&r=PG", "display_name": "Chocolate Drop", "link": "https://stackoverflow.com/users/1744026/chocolate-drop"}, "edited": false, "score": 0, "creation_date": 1539265805, "post_id": 52749753, "comment_id": 92446418, "body": "What I posted in VBA works for what I need it, but Im trying a different approach for efficiency purposes and was hoping there was a a combination of of index/match functions I could do. So its easier for the user (not having to click any buttons/etc..)"}], "owner": {"reputation": 103, "user_id": 1744026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc07b09f37b8b3f3fef064e69ac3740?s=128&d=identicon&r=PG", "display_name": "Chocolate Drop", "link": "https://stackoverflow.com/users/1744026/chocolate-drop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593696179, "creation_date": 1539211301, "last_edit_date": 1593696179, "question_id": 52749753, "link": "https://stackoverflow.com/questions/52749753/creating-a-list-that-is-determined-by-two-columns-in-excel", "title": "Creating a list that is determined by two columns in excel", "body": "<p>I'm having trouble figuring out how to solve my problem.<br />\nI have two columns:</p>\n<pre><code>Client Name   Job Name \nCompany 1     Dealership \nCompany 1     Dealership \nCompany 1     Dealership \nCompany 2     Airport \nCompany 2     Airport \nCompany 3     Dealership \nCompany 3     Dealership \nCompany 1     Parking Lot \nCompany 1     Parking Lot \n</code></pre>\n<p>Using formulas (index, match, etc..) how do I make a new list\nwhere it only lists the the unique companies and their respective job names. My new list should look like</p>\n<pre><code>Client Name   Job Name\nCompany 1     Dealership\nCompany 2     Airport \nCompany 3     Dealership \nCompany 1     Parking Lot \n</code></pre>\n<p>Basically I have a different sheet that gets populated daily with companies that we bid jobs to. We can bid the same job name to multiple companies, and we work with many of the same companies over the season. The new list needs to be dynamic as every day a new bid is sent out.</p>\n<p>I have VBA code that works but I'm trying to do it a different way if possible</p>\n<pre><code>While Not Sheets(&quot;TempStore&quot;).Cells(x, 2).Value = &quot;&quot;\n    'Creating comparisons for client / project name\n    Set RngClient = Sheets(&quot;TempStore&quot;).Cells(x, 2)\n    Set RngProject = Sheets(&quot;TempStore&quot;).Cells(x, 3)\n    \n    'Looping from last row to specified first row\n    For LngRow = LngLastRow To (x + 1) Step -1\n        'Checking conditions\n        \n        If Sheets(&quot;TempStore&quot;).Cells(LngRow, 2).Value = RngClient And Sheets(&quot;TempStore&quot;).Cells(LngRow, 3).Value = RngProject Then\n\n            RngClient.Offset(0, 9).Value = RngClient.Offset(0, 9).Value + Sheets(&quot;TempStore&quot;).Cells(LngRow, 11).Value 'Total Cost\n            RngProject.Offset(0, 9).Value = RngProject.Offset(0, 9).Value + Sheets(&quot;TempStore&quot;).Cells(LngRow, 12) 'Total Sell\n            Sheets(&quot;TempStore&quot;).Rows(LngRow).Delete\n                       \n        End If\n                   \n    \n    Next LngRow\n    \n    x = x + 1\n\nWend\n</code></pre>\n<p>The code above is basically used to add up a column that are associated to client name and project name then delete the row once the match is found so in the end, I'm left with a non duplicates of client per job name.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539210739, "post_id": 52749650, "comment_id": 92423655, "body": "what do you want to return?"}, {"owner": {"reputation": 31, "user_id": 2378934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2fd6fc4bdf1e53b4cce9b6bbe220b2?s=128&d=identicon&r=PG", "display_name": "user2378934", "link": "https://stackoverflow.com/users/2378934/user2378934"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539210955, "post_id": 52749650, "comment_id": 92423735, "body": "I want to return the location of Column F that only has Rob (only one value) in it out of the whole 20 columns I have."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1539211156, "post_id": 52749650, "comment_id": 92423792, "body": "With a formula you will need a helper row that has the unique count, many answers on that specific problem.  Then you can use MATCH to return where that row equals 1."}, {"owner": {"reputation": 31, "user_id": 2378934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2fd6fc4bdf1e53b4cce9b6bbe220b2?s=128&d=identicon&r=PG", "display_name": "user2378934", "link": "https://stackoverflow.com/users/2378934/user2378934"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539211632, "post_id": 52749650, "comment_id": 92423901, "body": "do you have the formula with the helper row?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1539211694, "post_id": 52749650, "comment_id": 92423919, "body": "<code>=COUNTIF(A:A,A1) = COUNTA(A:A)</code> as long as there&#39;s always a value in the first row..."}, {"owner": {"reputation": 31, "user_id": 2378934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2fd6fc4bdf1e53b4cce9b6bbe220b2?s=128&d=identicon&r=PG", "display_name": "user2378934", "link": "https://stackoverflow.com/users/2378934/user2378934"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539212424, "post_id": 52749650, "comment_id": 92424121, "body": "@Tim Williams: I don&#39;t understand what it is doing"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539215754, "post_id": 52749650, "comment_id": 92424830, "body": "If the column only contains a single distinct value (and that value is present in row 1) then COUNTIF() will return how many instances of that value are in the column.  Since the column doesn&#39;t contain any other values then COUNTA() will return the same result and the formula evaluates to TRUE"}, {"owner": {"reputation": 31, "user_id": 2378934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2fd6fc4bdf1e53b4cce9b6bbe220b2?s=128&d=identicon&r=PG", "display_name": "user2378934", "link": "https://stackoverflow.com/users/2378934/user2378934"}, "edited": false, "score": 0, "creation_date": 1539216743, "post_id": 52749650, "comment_id": 92425044, "body": "Do I have to do this column by column or I can use this for a whole sheet and change the range?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539236336, "post_id": 52749650, "comment_id": 92429421, "body": "If you enter in ColA and drag over it will adjust for each column.  If you want something more specific it would help to explain what you want to do with the result."}, {"owner": {"reputation": 31, "user_id": 2378934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2fd6fc4bdf1e53b4cce9b6bbe220b2?s=128&d=identicon&r=PG", "display_name": "user2378934", "link": "https://stackoverflow.com/users/2378934/user2378934"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539294670, "post_id": 52749650, "comment_id": 92461486, "body": "@TimWilliams - I made some changes to the range and then dragged the formula over for my columns and it worked :). Thanks much for all the effort and explanation on this."}], "owner": {"reputation": 31, "user_id": 2378934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d2fd6fc4bdf1e53b4cce9b6bbe220b2?s=128&d=identicon&r=PG", "display_name": "user2378934", "link": "https://stackoverflow.com/users/2378934/user2378934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1556548447, "creation_date": 1539210681, "last_edit_date": 1556548447, "question_id": 52749650, "link": "https://stackoverflow.com/questions/52749650/return-a-column-that-has-one-value", "title": "Return a column that has one value", "body": "<p>How can I find a column that has a constant/only one value?</p>\n\n<p>For example, given this data I want to return column F.</p>\n\n<pre><code>ColumnA ....ColumnE  ColumnF\n   1        Apple     Rob\n   2        Orange    Rob\n   3        banana    Rob\n   4        Peach     Rob\n   5        Pears     Rob\n</code></pre>\n"}, {"tags": ["excel", "vba", "click", "submit"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1539210500, "post_id": 52749433, "comment_id": 92423585, "body": "So I am confused as to why you are creating a new Internet Explorer object and then turn around trying to find an existing one by it&#39;s title. Depending on how many times you&#39;ve attempted this code, you probably have tens if not a hundred open (and hidden) IE processes."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10486527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5042e1048e6356ed7bef98a2ce8b8e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/10486527/ken"}, "edited": false, "score": 0, "creation_date": 1539269940, "post_id": 52749805, "comment_id": 92449461, "body": "@K.Davis That definitely helped, thank you!  I figured out that the button was &quot;button&quot; and not another &quot;input&quot;, which helped me use .Click  My issue now is that once I run the macro once, the button on the page is disabled, or disabled = &quot;&quot;....Is there a way to enable it? If not, I have to click in the text box and hit backspace to have it be enabled again."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1539212061, "last_edit_date": 1539212061, "creation_date": 1539211725, "answer_id": 52749805, "question_id": 52749433, "link": "https://stackoverflow.com/questions/52749433/how-to-use-click-function/52749805#52749805", "title": "How to use click function?", "body": "<p>Okay, so first things first. <em>Do not <strong>create</em></strong> a new IE object if you are trying to find one that already exists. This will eventually start to bog down your computer having a hundred hidden Internet Explorers open in the background.</p>\n\n<p>So, get rid of this</p>\n\n<p><strike>  </p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\n\n'''''''''''''''''''''''''''''''\n'Switching to correct page\n'If it can't be found, ends the sub\n'If it is found, then switches to correct search bar and searches for information\n'''''''''''''''''''''''''''''''\n\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nFor x = 0 To (IE_count - 1)\n    On Error Resume Next    ' sometimes more web pages are counted than are open\n    my_url = objShell.Windows(x).document.Location\n    my_title = objShell.Windows(x).document.Title\n\n    If my_title = \"Parts Intelligence\" Then\n        Set IE = objShell.Windows(x)\n        marker = 1\n        Exit For\n    End If\nNext\nIf marker = 0 Then\n    MsgBox (\"A matching webpage was NOT found\")\nElse\n</code></pre>\n\n<p></strike>\nand instead use something like this function - which will return the IE object that matches a URL and Title.</p>\n\n<pre><code>Dim IE As Object\nDim MyURL As String\nDim objElement As Object\nDim objCollection As Object\n\nSet IE = getIE(\"https://myurl.com\", \"Parts Intelligence\")\n\nIf IE Is Nothing Then\n    Rem: Add what happens if browser isn't found\nEnd If\n</code></pre>\n\n<p></p>\n\n<pre><code>Function GetIE(sLocation As String, sDocTitle As String) As Object\n\n    Dim objShell As Object, objShellWindows As Object, o As Object\n    Dim sURL As String, sTitle As String\n    Dim RetVal As Object\n\n    Set RetVal = Nothing\n    Set objShell = CreateObject(\"shell.application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next\n        sURL = o.document.Location\n        sTitle = o.document.Title\n        On Error GoTo 0\n        If sURL Like \"*\" sLocation &amp; \"*\" And sTitle Like sDocTitle &amp; \"*\" Then\n            Set RetVal = o\n            Exit For\n        End If\n    Next o\n\n    Set GetIE = RetVal\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Now, as for your issue. It's difficult to say exactly what is causing this problem without having access to the website in question. However, I had a very similar experience before and what allowed me to get past it was <em>activating</em> the textbox by code.</p>\n\n<p>So, for your textbox, try using:</p>\n\n<pre><code>yourTextBoxObject.setActive\n</code></pre>\n\n<p>Then filling in the box. This should (hopefully) solve your problem with the button being disabled. With your code, it should look something like:</p>\n\n<pre><code>While i &lt; objCollection.Length\n        ''''Change name (case sensitive)\n        If objCollection(i).class = \"simple-search-text form-control short ng-valid ng-dirty ng-touched\" Then\n            ' Set text for search\n            objCollection(i).setActive\n            objCollection(i).Value = ActiveCell.Value\n        Else\n            ''''Change Type &amp; Name (case sensitive)\n            If objCollection(i).class = \"btn btn-icon\" Then\n                objCollection(i).Click\n                ' \"Search\" button is found\n            End If\n        End If\n        i = i + 1\nWend\n</code></pre>\n\n<h2>Your full code:</h2>\n\n<pre><code>Sub Part_Information()\n    '\n    ' Part_Information Macro\n    '\n    ' Keyboard Shortcut: Ctrl+a\n    '\n    ActiveCell.Select\n    Selection.Copy\n\n    Dim IE As Object\n    Dim MyURL As String\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    Dim IE As Object\n    Dim MyURL As String\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    Set IE = getIE(\"https://myurl.com\", \"Parts Intelligence\")\n\n    If IE Is Nothing Then\n        Rem: Add what happens if browser isn't found\n    End If\n\n    Set objCollection = IE.document.getElementsByTagName(\"input\")\n\n    i = 0\n    While i &lt; objCollection.Length\n        ''''Change name (case sensitive)\n        If objCollection(i).class = \"simple-search-text form-control short ng-valid ng-dirty ng-touched\" Then\n            ' Set text for search\n            objCollection(i).Value = ActiveCell.Value\n        Else\n            ''''Change Type &amp; Name (case sensitive)\n            If objCollection(i).class = \"btn btn-icon\" Then\n                objCollection(i).Click\n                ' \"Search\" button is found\n            End If\n        End If\n        i = i + 1\n    Wend\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Function GetIE(sLocation As String, sDocTitle As String) As Object\n\n    Dim objShell As Object, objShellWindows As Object, o As Object\n    Dim sURL As String, sTitle As String\n    Dim RetVal As Object\n\n    Set RetVal = Nothing\n    Set objShell = CreateObject(\"shell.application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next\n        sURL = o.document.Location\n        sTitle = o.document.Title\n        On Error GoTo 0\n        If sURL Like \"*\" sLocation &amp; \"*\" And sTitle Like sDocTitle &amp; \"*\" Then\n            Set RetVal = o\n            Exit For\n        End If\n    Next o\n\n    Set GetIE = RetVal\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10486527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5042e1048e6356ed7bef98a2ce8b8e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/10486527/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1609259737, "creation_date": 1539209288, "last_edit_date": 1609259737, "question_id": 52749433, "link": "https://stackoverflow.com/questions/52749433/how-to-use-click-function", "title": "How to use click function?", "body": "<p>Everything works in my code except for the .click at the end.<br />\nIt disables the button from clicking and it disables the operators ability to press 'enter' with the pasted text.<br />\nOnly after I click in the text box and enter characters, can I hit enter (or click the button) to search.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Part_Information()\n    '\n    ' Part_Information Macro\n    '\n    ' Keyboard Shortcut: Ctrl+a\n    '\n    ActiveCell.Select\n    Selection.Copy\n\n    Dim IE As Object\n    Dim MyURL As String\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)\n\n    '''''''''''''''''''''''''''''''\n    'Switching to correct page\n    'If it can't be found, ends the sub\n    'If it is found, then switches to correct search bar and searches for information\n    '''''''''''''''''''''''''''''''\n\n    Set objShell = CreateObject(&quot;Shell.Application&quot;)\n    IE_count = objShell.Windows.Count\n    For x = 0 To (IE_count - 1)\n        On Error Resume Next    ' sometimes more web pages are counted than are open\n        my_url = objShell.Windows(x).document.Location\n        my_title = objShell.Windows(x).document.Title\n\n        If my_title = &quot;Parts Intelligence&quot; Then\n            Set IE = objShell.Windows(x)\n            marker = 1\n            Exit For\n        End If\n    Next\n    If marker = 0 Then\n        MsgBox (&quot;A matching webpage was NOT found&quot;)\n    Else\n    \n        Set objCollection = IE.document.getElementsByTagName(&quot;input&quot;)\n \n        i = 0\n        While i &lt; objCollection.Length\n            ''''Change name (case sensitive)\n            If objCollection(i).class = &quot;simple-search-text form-control short ng-valid ng-dirty ng-touched&quot; Then\n                ' Set text for search\n                objCollection(i).Value = ActiveCell.Value\n            Else\n                ''''Change Type &amp; Name (case sensitive)\n                If objCollection(i).class = &quot;btn btn-icon&quot; Then\n                    objCollection(i).Click\n                    ' &quot;Search&quot; button is found\n                End If\n            End If\n            i = i + 1\n        Wend\n    \n    End If\nEnd Sub\n</code></pre>\n<p>This is from the webpage:</p>\n<p>Search Button &amp; Search Text Box:<br />\n<a href=\"https://i.stack.imgur.com/mBHcy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mBHcy.png\" alt=\"Search Button &amp; Search Text Box\" /></a></p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1539213216, "creation_date": 1539213216, "answer_id": 52750002, "question_id": 52749407, "link": "https://stackoverflow.com/questions/52749407/send-email-outlook-2013-as-a-background-process/52750002#52750002", "title": "Send email Outlook 2013 as a background process", "body": "<p>Instead of using the <code>Sleep()</code> API function, you can try creating a loop timer with the <code>DoEvents</code> function. </p>\n\n<p>Try seeing if this helps:</p>\n\n<pre><code>Dim startTimer as single, sleepTime as single\nsleepTime = 6\n\nWith oMail\n\nSet .Configuration = iConf\n.Subject = asunto\n.HTMLBody = emailText &amp; signatureEmail\n\n    destName = BrokerForm.LstBoxBrokers.List(emailLooper, 0)\n    emailAddress = BrokerForm.LstBoxBrokers.List(emailLooper, 1)\n\n    .HTMLBody = Replace(.HTMLBody, \"#name#\", destName)\n    .To = emailAddress\n    .From = senderEmail\n    .Send\n\n    emailsSent = emailsSent + 1\n\n    startTimer = Timer\n    Do While Timer &lt; startTimer + sleepTime\n        DoEvents\n    Loop\n\n    If emailLooper / 10 = Fix(emailLooper / 10) Then\n\n        startTimer = Timer\n        Do While Timer &lt; startTimer + sleepTime\n            DoEvents\n        Loop\n\n    End If\n\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1539251695, "creation_date": 1539251695, "answer_id": 52757198, "question_id": 52749407, "link": "https://stackoverflow.com/questions/52749407/send-email-outlook-2013-as-a-background-process/52757198#52757198", "title": "Send email Outlook 2013 as a background process", "body": "<p>As K.D\u1d00\u1d20\u026as mentioned, You could use Loop instead of using Sleep().</p>\n\n<p>Outlook will locks you out until sleep period has finished if you use <code>Sleep()</code>. You can use <code>CTRL+BREAK</code> to interrupt the macro, but Outlook won't accept input from the keyboard or mouse.</p>\n\n<p>For more information, you could refer to this link:</p>\n\n<p><a href=\"https://www.myonlinetraininghub.com/pausing-or-delaying-vba-using-wait-sleep-or-a-loop\" rel=\"nofollow noreferrer\">Pausing or Delaying VBA Using Wait, Sleep or A Loop</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10348043, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4leCaJaHbXE/AAAAAAAAAAI/AAAAAAAAAhs/97-LYFJwgpg/photo.jpg?sz=128", "display_name": "Andres Martinez", "link": "https://stackoverflow.com/users/10348043/andres-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52750002, "answer_count": 2, "score": 1, "last_activity_date": 1592900335, "creation_date": 1539209135, "last_edit_date": 1592900335, "question_id": 52749407, "link": "https://stackoverflow.com/questions/52749407/send-email-outlook-2013-as-a-background-process", "title": "Send email Outlook 2013 as a background process", "body": "<p>I wrote a small macro to send an email every Friday to about 20 people from different departments at the office.\nThe way I did this was to have a spreadsheet with a name and an email associated to it, and then looping through it changing the appropriate info. I want the email to go to each person, so no, the other recipients are not supposed to be CC'd or BCC'd.</p>\n\n<p>It works. However, to avoid problems, I put a pause so each email goes out every 6 seconds, in blocks of 10, with a pause of about 10 secs between blocks. I believe that pause is creating lag, and while the job is completed, I cannot use Outlook (to check other emails, or Tasks).</p>\n\n<p>Is there a way to have Outlook send each email in some sort of \"silent-mode\"?</p>\n\n<p>Here, code:</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n\nSub PrepareEmail()\n.\n.'A bunch of variable and simple data manipulation is done here.\n.\nFor emailLooper = 0 To BrokerForm.LstBoxBrokers.ListCount - 1\nSet oMail = CreateObject(\"CDO.Message\")\nSet iConf = CreateObject(\"CDO.Configuration\")\n\niConf.Load -1    ' CDO Source Defaults\nSet Flds = iConf.Fields\nWith Flds\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"mySMTPserver\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"username\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"password\"\n    .Update\nEnd With\n\nWith oMail\n\nSet .Configuration = iConf\n.Subject = asunto\n.HTMLBody = emailText &amp; signatureEmail\n\n    destName = BrokerForm.LstBoxBrokers.List(emailLooper, 0)\n    emailAddress = BrokerForm.LstBoxBrokers.List(emailLooper, 1)\n\n    .HTMLBody = Replace(.HTMLBody, \"#name#\", destName)\n    .To = emailAddress\n    .From = senderEmail\n    .Send\n\n    emailsSent = emailsSent + 1\n\n    Sleep (6000)\n\n    If emailLooper / 10 = Fix(emailLooper / 10) Then\n\n        Sleep (11000)\n\n    End If\n\nEnd With\n\n\nSet oMail = Nothing\nSet iConf = Nothing\nSet Flds = Nothing\n\nNext emailLooper\n</code></pre>\n"}, {"tags": ["excel", "vba", "cell"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1539208286, "post_id": 52749254, "comment_id": 92422933, "body": "This could be done with formulas. Do you have a table of each object with the price breakdown for quantities? Can you <a href=\"https://stackoverflow.com/posts/52749254/edit\">edit your question</a> and post sample data?"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539209519, "post_id": 52749376, "comment_id": 92423326, "body": "@ScottCraner typo call out dropped me. True. Didn&#39;t know that. Thanks as always.... That&#39;s just how I always set it up :0"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1539209674, "post_id": 52749376, "comment_id": 92423383, "body": "With Vlookup one only needs the minimum, the maximum is superfluous.  But really just wanted to tease about the typo."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1539210146, "last_edit_date": 1539210146, "creation_date": 1539208915, "answer_id": 52749376, "question_id": 52749254, "link": "https://stackoverflow.com/questions/52749254/excel-vba-change-cell-value-via-another-cell/52749376#52749376", "title": "Excel VBA - Change cell value via another cell?", "body": "<h2>Non VBA Soluion</h2>\n\n<p>If you build a table with the bottom and upper thresholds for a price, you can simply use a <code>VLOOKUP</code> and return the <strong>approximate</strong> match. </p>\n\n<p>In photo, <code>Column C</code> is the output from the equation that is shown in <code>Column D</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/v9OvI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v9OvI.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>VBA Solution</h2>\n\n<p>You can also use a simple <code>UDF</code>. Paste the code inside a <code>Module</code> and then you can call the function <code>PRICEINDX</code> from a cell just like any other equation. You can either manually type in a value like <code>PRICEINDX(164)</code> or select a cell that has the value to be tested like <code>PRICEINDX(A1)</code> </p>\n\n<p>You can also set up more complex thresholds easily by using <code>Select Case</code></p>\n\n<pre><code>Option Explicit\n\nPublic Function PRICEINDX(Target As Double) As Double\n\nDim ans As Double\n\nSelect Case Target\n    Case 0 To 100\n        ans = 2.5\n    Case 101 To 200\n        ans = 2.3\n    Case 201 To 300\n        ans = 2.1\n    Case Is &gt; 300\n        ans = 2\nEnd Select\n\nPRICEINDX = ans\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 2429852, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/63ccf634e3550756425a04e98553004d?s=128&d=identicon&r=PG", "display_name": "Marc Brooks", "link": "https://stackoverflow.com/users/2429852/marc-brooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 52749376, "answer_count": 1, "score": 0, "last_activity_date": 1539210146, "creation_date": 1539208104, "question_id": 52749254, "link": "https://stackoverflow.com/questions/52749254/excel-vba-change-cell-value-via-another-cell", "title": "Excel VBA - Change cell value via another cell?", "body": "<p>So VBA is completely new to me. I come from a C# background. \nCurrently creating an order form, whereby I can input the total amount I require of an object and then the price is calculated in a different cell.</p>\n\n<p>However I also want the price to change based off amount thresholds for that object.</p>\n\n<p>Say for example 0 - 100 will cost \u00a32.50 so I expect the answer to be anywhere within that range is multiplied by 2.50. Meanwhile if the amount exceeds 100 and becomes 120 I want the object price to now reflect \u00a32.30 and proceed to multiple the 120 by \u00a32.30.</p>\n\n<p>I've noticed a few tutorials on line but they don't exactly explain how I might be able to achieve the above. Wondering if anyone can point me in the right direction?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "edited": false, "score": 0, "creation_date": 1539208615, "post_id": 52748846, "comment_id": 92423037, "body": "I tried your solution, attached the result at the bottom of my question above. I also have more than 300 number of rows, I think your solution works for one row is there any way to update the range?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "edited": false, "score": 0, "creation_date": 1539262080, "post_id": 52748846, "comment_id": 92443922, "body": "I think this is still the right way to go though. I see the results, but you haven&#39;t explained what&#39;s wrong with them. They look fine to me."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1539205851, "creation_date": 1539205851, "answer_id": 52748846, "question_id": 52748680, "link": "https://stackoverflow.com/questions/52748680/extract-dates-from-a-string-in-excel-and-copied-over-to-a-new-row/52748846#52748846", "title": "extract dates from a string in excel and copied over to a new row", "body": "<p>Something like the following will get you in the ballpark:</p>\n\n<pre><code>Sub test()\n    'get that ugly b2 value into an array split by line\n    Dim b2Array As Variant\n    b2Array = Split(Sheet1.Range(\"B2\"), Chr(10))\n\n    'grab the value in a2\n    Dim a2Value As String\n    a2Value = Sheet1.Range(\"A2\").Value\n\n    'loop through the array (each line in B2 and output. Making use of more `split` here to grab values\n    Dim writeRow As Integer: writeRow = 1\n    For Each element In b2Array\n        Sheet2.Cells(writeRow, 1).Value = a2Value\n        Sheet2.Cells(writeRow, 2).Value = Trim(Split(Trim(element), \" \")(0))\n        Sheet2.Cells(writeRow, 3).Value = Trim(Replace(element, Split(Trim(element), \" \")(0), \"\"))\n        writeRow = writeRow + 1\n    Next\nEnd Sub\n</code></pre>\n\n<p>That's assuming this is on Sheet1 and you are wanting to output to Sheet2. </p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1539223538, "last_edit_date": 1539223538, "creation_date": 1539221857, "answer_id": 52750927, "question_id": 52748680, "link": "https://stackoverflow.com/questions/52748680/extract-dates-from-a-string-in-excel-and-copied-over-to-a-new-row/52750927#52750927", "title": "extract dates from a string in excel and copied over to a new row", "body": "<p>In Excel 2010 or later, you can do this using Power Query (aka Get&amp;Transform), and then refresh the query if you add more rows.</p>\n\n<ul>\n<li>Split Column 2 by <code>linefeed character</code> into <strong>Rows</strong></li>\n<li>Trim Column 2 to remove leading and trailing spaces</li>\n<li>Split by <code>space</code> into columns, but only the left-most space</li>\n</ul>\n\n<p>Here is the M-Code</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n\n    #\"Split Column by Delimiter\" = Table.ExpandListColumn(Table.TransformColumns\n            (Source, {{\"Column2\", Splitter.SplitTextByDelimiter(\"#(lf)\", QuoteStyle.Csv), \n            let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Column2\"),\n\n    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Split Column by Delimiter\",{{\"Column2\", type text}}),\n\n    #\"Added Custom\" = Table.AddColumn(#\"Changed Type1\", \"Trim\", each Text.Trim([Column2])),\n\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom\",{\"Column2\"}),\n\n    #\"Split Column by Delimiter1\" = Table.SplitColumn(#\"Removed Columns\", \n            \"Trim\", Splitter.SplitTextByEachDelimiter({\" \"}, QuoteStyle.Csv, false), {\"Trim.1\", \"Trim.2\"})\nin\n    #\"Split Column by Delimiter1\"\n</code></pre>\n\n<h2>Original data</h2>\n\n<p><a href=\"https://i.stack.imgur.com/kCXUA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCXUA.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Results</h2>\n\n<p><a href=\"https://i.stack.imgur.com/jC41a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jC41a.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593696126, "creation_date": 1539205087, "last_edit_date": 1593696126, "question_id": 52748680, "link": "https://stackoverflow.com/questions/52748680/extract-dates-from-a-string-in-excel-and-copied-over-to-a-new-row", "title": "extract dates from a string in excel and copied over to a new row", "body": "<p>How can I extract dates from String in Microsoft excel cell? I have the following information on Cell A</p>\n\n<p>In Cell A2 I have: <code>360485</code>\nIn Cell B2 I have (Note: Its wrap text in a single cell):    </p>\n\n<blockquote>\n<pre><code>  10/7 - comment 1\n  5/3/16 - comment 2\n  3/21/16 comment 3\n  1/26/16 - comment 4\"\n</code></pre>\n</blockquote>\n\n<p>I want to to get something like this </p>\n\n<blockquote>\n<pre><code>Col A    Col B      Col C\n360485  10/7/16   - comment 1\n360485  5/3/16    - comment 2\n360485  3/21/16     comment 3\n360485  1/26/16   - comment 4\"\n</code></pre>\n</blockquote>\n\n<p>@JNevill,</p>\n\n<p>Data in Col A: <code>600537L</code>\nData in Col B</p>\n\n<pre><code>6/21/17 - text comment 1 \n951396-LH/RH-951554\n10/27 - text comment 2\nnormal text\n2/5/16 - text comment 3\"\n</code></pre>\n\n<p>Result </p>\n\n<pre><code> Col A    Col B                      Col C\n600537L 6/21/2017             - text comment 1\n600537L 951396-LH/RH-951554 \n600537L 27-Oct               - text comment 2\n600537L normal               text\n600537L 2/5/2016             - text comment 3\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 3, "creation_date": 1539203555, "post_id": 52748308, "comment_id": 92421178, "body": "Change <code>ActiveCell</code> to <code>cell</code> and run it again. I think you&#39;ll find it working then. (You don&#39;t want the cell that is currently selected by the user in the workbook, you want the <code>cell</code> that is being defined in the loop). Also instead of <code>FormulaR1C1</code> use <code>Value</code> since you aren&#39;t doing any formula work here."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1539204697, "post_id": 52748308, "comment_id": 92421655, "body": "I would also not use <code>Dim cell as Range</code> since <code>cell</code> is too similar to the object <code>Cells</code>. Would be easy, and understandable, if someone were to mix the two up. Maybe use <code>myCell</code> as your variable? This way the two are easy to distinguish. <i>This won&#39;t fix your code. More of a &quot;best practice&quot; tip</i>"}, {"owner": {"reputation": 3, "user_id": 2563997, "user_type": "registered", "profile_image": "https://graph.facebook.com/649405902/picture?type=large", "display_name": "Paul Omeara", "link": "https://stackoverflow.com/users/2563997/paul-omeara"}, "edited": false, "score": 0, "creation_date": 1539204833, "post_id": 52748308, "comment_id": 92421714, "body": "Perfect! Thank you so so much! Worked like a charm!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539205094, "post_id": 52748308, "comment_id": 92421830, "body": "You can build a table and do this with a vlookup and avoid VBA"}, {"owner": {"reputation": 3, "user_id": 2563997, "user_type": "registered", "profile_image": "https://graph.facebook.com/649405902/picture?type=large", "display_name": "Paul Omeara", "link": "https://stackoverflow.com/users/2563997/paul-omeara"}, "edited": false, "score": 0, "creation_date": 1539206505, "post_id": 52748308, "comment_id": 92422339, "body": "Thanks urdearboy, however the sheet will change each week, and will be used by someone not familiar with excel and tables. So best to write a macro for them to run themselves each week."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2563997, "user_type": "registered", "profile_image": "https://graph.facebook.com/649405902/picture?type=large", "display_name": "Paul Omeara", "link": "https://stackoverflow.com/users/2563997/paul-omeara"}, "edited": false, "score": 0, "creation_date": 1539206372, "post_id": 52748658, "comment_id": 92422301, "body": "Thanks urdearboy, however this returned a highlighted error at : Set ws = ThisWorkbook.Sheets(&quot;Sheet1&quot;)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 3, "user_id": 2563997, "user_type": "registered", "profile_image": "https://graph.facebook.com/649405902/picture?type=large", "display_name": "Paul Omeara", "link": "https://stackoverflow.com/users/2563997/paul-omeara"}, "edited": false, "score": 0, "creation_date": 1539206759, "post_id": 52748658, "comment_id": 92422427, "body": "Updated. You need to change the sheet name in that line (<code>Sheet1</code>) to the actual sheet you want this to run on"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1539206734, "last_edit_date": 1539206734, "creation_date": 1539204983, "answer_id": 52748658, "question_id": 52748308, "link": "https://stackoverflow.com/questions/52748308/if-statement-inside-loop-in-vba-excel/52748658#52748658", "title": "If statement inside loop in VBA - excel", "body": "<p>If your test statement is to get longer you can also use <code>Select Case</code>. It may be a littler cleaner in this case, especially if multiple values are to return the same country. </p>\n\n<p>Also, <code>myCell</code> (or anything else) instead of <code>cell</code>. It is smart to avoid declaring your own variables that are that close to pre-defined objects. Can lead to confusion/errors later. </p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub Country()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim myCell As Range\n\nApplication.ScreenUpdating = False\n    For Each myCell In ws.Range(\"G11:G100\")\n        Select Case myCell.Offset(, -1).Value\n            Case \"AUBNE\"\n                myCell = \"AUSTRALIA\"\n            Case \"CNTAO\"\n                myCell = \"CHINA\"\n            Case Else\n                myCell = \"NA\"\n        End Select\n    Next myCell\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2563997, "user_type": "registered", "profile_image": "https://graph.facebook.com/649405902/picture?type=large", "display_name": "Paul Omeara", "link": "https://stackoverflow.com/users/2563997/paul-omeara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1539206734, "creation_date": 1539203294, "last_edit_date": 1539203440, "question_id": 52748308, "link": "https://stackoverflow.com/questions/52748308/if-statement-inside-loop-in-vba-excel", "title": "If statement inside loop in VBA - excel", "body": "<p>I am trying to write a Macro with a simple IF statement inside a loop in VBA for Excel. To be honest I have no idea what I am doing. I got the IF statement working, then tried to add a Loop around it - however the loop doesn't work.</p>\n\n<p>Basically I want to write a macro that checks cell F11, then adds the outcome of the IF statement to G11, then drops down to the next row, checks F12, add outcome to G12 etc etc until the end. Below is the code. If anyone could help me with this that would be great!</p>\n\n<pre><code>Sub Country()    \n    Dim cell As Range    \n    For Each cell In ActiveSheet.Range(\"G11:G100\")    \n        If ActiveCell.Offset(0, -1) = \"AUBNE\" Then\n            ActiveCell.FormulaR1C1 = \"AUSTRALIA\"    \n        ElseIf ActiveCell.Offset(0, -1) = \"CNTAO\" Then\n            ActiveCell.FormulaR1C1 = \"CHINA\"    \n        Else: ActiveCell.FormulaR1C1 = \"NA\"    \n        End If    \n    Next cell    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "subroutine"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539204121, "post_id": 52748224, "comment_id": 92421411, "body": "If there was an update, it&#39;s highly unlikely that it suddenly broke your code. Members don&#39;t just disappear between updates. More likely, <code>Selection</code> isn&#39;t the object type your code assumes it is. Don&#39;t work with <code>Selection</code>."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1539204383, "creation_date": 1539204383, "answer_id": 52748545, "question_id": 52748224, "link": "https://stackoverflow.com/questions/52748224/excel-vba-run-time-error438-object-doesnt-support-this-property-or-method/52748545#52748545", "title": "Excel VBA - run-time error&#39;438&#39;. Object doesnt support this property or method", "body": "<blockquote>\n<pre><code>    Worksheets(\"Errors\").Buttons.Add(350, 10, 200, 25).Select\n    Selection.OnAction = \"ADDOTHERMATL\"\n</code></pre>\n</blockquote>\n\n<p>You're assuming that <code>Worksheets(\"Errors\")</code> is the <code>ActiveSheet</code>, for <code>Selection</code> only ever refers to the selected object on the active sheet.</p>\n\n<p>Instead, keep a reference to the added button - the <code>Add</code> method returns that object:</p>\n\n<pre><code>Dim button As Object\nSet button = Worksheets(\"Errors\").Buttons.Add(350, 10, 200, 25)\n</code></pre>\n\n<p>Now set its <code>OnAction</code> property:</p>\n\n<pre><code>button.OnAction = \"ADDOTHERMATL\"\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9424434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb31de49901c1915ad3b3c6643e70922?s=128&d=identicon&r=PG&f=1", "display_name": "raider", "link": "https://stackoverflow.com/users/9424434/raider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 52748545, "answer_count": 1, "score": 2, "last_activity_date": 1593696105, "creation_date": 1539202978, "last_edit_date": 1593696105, "question_id": 52748224, "link": "https://stackoverflow.com/questions/52748224/excel-vba-run-time-error438-object-doesnt-support-this-property-or-method", "title": "Excel VBA - run-time error&#39;438&#39;. Object doesnt support this property or method", "body": "<p>I have an excel sheet that gives me run-time</p>\n<blockquote>\n<p>Error '438'. Object doesn't support this property or method. It has been working fine until now.\nAny help is much appreciated.</p>\n</blockquote>\n<p>When I press debug this part of the code : <code>Selection.OnAction = &quot;ADDOTHERMATL&quot;</code> is highlighted in yellow.</p>\n<pre><code>Dim QtyTblRange As String\n              QtyTblRange = Worksheets(&quot;Errors&quot;).UsedRange.Offset(MaxRowNum, 0).Resize(2, (n + 2)).Address\n        Worksheets(&quot;Errors&quot;).ListObjects.Add(xlSrcRange, Worksheets(&quot;Errors&quot;).Range(QtyTblRange), , xlYes).Name = &quot;QtyErrors&quot;\n    \n          MaxRow = Worksheets(&quot;JobNumConvert&quot;).Range(&quot;C&quot; &amp; Worksheets(&quot;JobNumConvert&quot;).Cells(Worksheets(&quot;JobNumConvert&quot;).Rows.Count, &quot;C&quot;).End(xlUp).Row).Address\n          Sheets(&quot;JobNumConvert&quot;).Range(&quot;C3:&quot; &amp; MaxRow).Copy\n          \n          MaxRow = Worksheets(&quot;Errors&quot;).Range(&quot;A&quot; &amp; Worksheets(&quot;Errors&quot;).Cells(Worksheets(&quot;Errors&quot;).Rows.Count, &quot;A&quot;).End(xlUp).Row).Address\n          Sheets(&quot;Errors&quot;).Range(MaxRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n         \n          Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).Range.AutoFilter Field:=(n + 1), Criteria1:=&quot;&lt;&gt;0&quot;, Operator:=xlAnd\n         \n               Worksheets(&quot;Errors&quot;).Cells.EntireColumn.AutoFit\n               \n        ActiveWorkbook.Worksheets(&quot;Syteline - Job Materials&quot;).ListObjects(&quot;JobAggregateTable&quot;).Sort.SortFields.Clear\n        Worksheets(&quot;Syteline - Job Materials&quot;).ListObjects(1).AutoFilter.ShowAllData\n    \n        Worksheets(&quot;Errors&quot;).Buttons.Add(350, 10, 200, 25).Select\n        ***Selection.OnAction = &quot;ADDOTHERMATL&quot;***\n        Selection.Characters.Text = &quot;Add Other Matl to Entry Sheet&quot;\n        With Selection.Characters(Start:=1, Length:=29).Font\n            .Name = &quot;Arial&quot;\n            .FontStyle = &quot;Regular&quot;\n            .Size = 10\n            .Strikethrough = False\n            .Superscript = False\n            .Subscript = False\n            .OutlineFont = False\n            .Shadow = False\n            .Underline = xlUnderlineStyleNone\n            .ColorIndex = xlAutomatic\n        End With\n        \n        Worksheets(&quot;Errors&quot;).Range(&quot;A4&quot;).FormulaR1C1 = &quot;BOM Errors: Results in this Table indicate that Syteline's standard BOM expects a material value where the HRB results reported none.&quot;\n        Worksheets(&quot;Errors&quot;).Range(&quot;A4&quot;).Font.Bold = True\n    \n        Worksheets(&quot;Errors&quot;).Range(MaxRow).Offset(-2, 0).FormulaR1C1 = &quot;Qty Errors: Results in this Table are filtered to display instances where the HRB material totals and the Entry Sheet Material totals differ.&quot;\n        Worksheets(&quot;Errors&quot;).Range(MaxRow).Offset(-2, 0).Font.Bold = True\n        \n        Worksheets(&quot;Errors&quot;).Range(&quot;A1&quot;).Activate\n    \n    End Sub\n    Sub ADDOTHERMATL()\n    \n    n = Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).ListColumns(&quot;Other Matl&quot;).Index\n    \n    Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).Range.AutoFilter Field:=(n), Criteria1:=&quot;&lt;&gt;&quot;, Operator:=xlAnd\n    \n    MaxRowNum = Worksheets(&quot;Entry Sheet&quot;).Range(&quot;B&quot; &amp; Worksheets(&quot;Entry Sheet&quot;).Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row).Row + 1\n    Dim OtherRows\n            With Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;)\n            For Each Line In .Range.SpecialCells(xlCellTypeVisible).Areas\n                OtherRows = OtherRows + Line.Rows.Count\n            Next\n        End With\n    \n            If OtherRows &lt;= 1 Then\n                Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).Sort.SortFields.Clear\n                Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).AutoFilter.ShowAllData\n                Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).Range.AutoFilter Field:=(n - 1), Criteria1:=&quot;&lt;&gt;0&quot;, Operator:=xlAnd\n                MsgBox &quot;No Other Material(s) selected.&quot;: Exit Sub\n            End If\n    \n        OtherRows = (OtherRows + MaxRowNum - 2)\n    \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;B&quot; &amp; MaxRowNum &amp; &quot;:B&quot; &amp; OtherRows).FormulaR1C1 = 10\n    \n           Sheets(&quot;Errors&quot;).Range(&quot;QtyErrors[Other Matl]&quot;).SpecialCells(xlCellTypeVisible).Copy\n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;C&quot; &amp; MaxRowNum &amp; &quot;:C&quot; &amp; OtherRows).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n          \n           Sheets(&quot;Errors&quot;).Range(&quot;QtyErrors[HRB Other Qty]&quot;).SpecialCells(xlCellTypeVisible).Copy\n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;E&quot; &amp; MaxRowNum &amp; &quot;:E&quot; &amp; OtherRows).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;F&quot; &amp; MaxRowNum &amp; &quot;:F&quot; &amp; OtherRows).FormulaR1C1 = &quot;LBS&quot;\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;H&quot; &amp; MaxRowNum &amp; &quot;:H&quot; &amp; OtherRows).FormulaR1C1 = &quot;MAIN&quot;\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;I&quot; &amp; MaxRowNum &amp; &quot;:I&quot; &amp; OtherRows).FormulaR1C1 = &quot;9999999&quot;\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;J&quot; &amp; MaxRowNum &amp; &quot;:J&quot; &amp; OtherRows).FormulaR1C1 = &quot;Data, Entry&quot;\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;K&quot; &amp; MaxRowNum &amp; &quot;:K&quot; &amp; OtherRows).FormulaR1C1 = &quot;Pending&quot;\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;L&quot; &amp; MaxRowNum &amp; &quot;:L&quot; &amp; OtherRows).FormulaR1C1 = 1\n            \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;M&quot; &amp; MaxRowNum &amp; &quot;:M&quot; &amp; OtherRows).FormulaR1C1 = 1\n        \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;N&quot; &amp; MaxRowNum &amp; &quot;:N&quot; &amp; OtherRows).FormulaR1C1 = &quot;= TODAY()-1&quot;\n        \n           Sheets(&quot;Errors&quot;).Range(&quot;QtyErrors[Pallet]&quot;).SpecialCells(xlCellTypeVisible).Copy\n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;Q&quot; &amp; MaxRowNum &amp; &quot;:Q&quot; &amp; OtherRows).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n           \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;O&quot; &amp; MaxRowNum &amp; &quot;:O&quot; &amp; OtherRows).FormulaR1C1 = &quot;=&quot;&quot;     &quot;&quot; &amp; LEFT(RC[2],5)&quot;\n           \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;P&quot; &amp; MaxRowNum &amp; &quot;:P&quot; &amp; OtherRows).FormulaR1C1 = &quot;=SUBSTITUTE(RIGHT(RC[1],2), 0, &quot;&quot;&quot;&quot;)&quot;\n        \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;R&quot; &amp; MaxRowNum &amp; &quot;:R&quot; &amp; OtherRows).FormulaR1C1 = &quot;1&quot;\n           \n           Sheets(&quot;Entry Sheet&quot;).Range(&quot;G&quot; &amp; MaxRowNum &amp; &quot;:G&quot; &amp; OtherRows).FormulaR1C1 = &quot;=IF(LEFT(INDEX(Summary!C[-6],MATCH('Entry Sheet'!RC[10],Summary!C[4],0)),1)=&quot;&quot;P&quot;&quot;,&quot;&quot;Poplar - STOCK&quot;&quot;,&quot;&quot;STOCK&quot;&quot;)&quot;\n           \n        With Sheets(&quot;Entry Sheet&quot;).UsedRange\n                .Copy\n                .PasteSpecial xlPasteValues\n        End With\n        \n        Worksheets(&quot;Entry Sheet&quot;).Range(&quot;A&quot; &amp; MaxRowNum &amp; &quot;:R&quot; &amp; OtherRows).Style = &quot;40% - Accent5&quot;\n        \n        Worksheets(&quot;Entry Sheet&quot;).Range(&quot;A1:R&quot; &amp; OtherRows).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17), Header:=xlYes\n    \n        Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).Sort.SortFields.Clear\n        Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).AutoFilter.ShowAllData\n        Worksheets(&quot;Errors&quot;).ListObjects(&quot;QtyErrors&quot;).Range.AutoFilter Field:=(n - 1), Criteria1:=&quot;&lt;&gt;0&quot;, Operator:=xlAnd\n    \n    \n    OtherRows = (OtherRows - MaxRowNum) + 1\n    \n    Worksheets(&quot;Errors&quot;).Activate\n    \n    MsgBox &quot;&quot; &amp; OtherRows &amp; &quot; Other Material Entries have been successfully inserted into the Entry Sheet Results.&quot;\n    \n    End Sub\n</code></pre>\n<p>Is there any update of change to Excel. Wondering because we have never had this issue.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539209898, "post_id": 52748163, "comment_id": 92423428, "body": "You can use a workbook Name to store the license key, or put it on a VeryHidden worksheet.  In the end though, there&#39;s nothing in Excel to stop a Google-capable user from defeating your protection: the best you can do using this approach is to stop casual attempts."}, {"owner": {"reputation": 25, "user_id": 8494365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EyaAv.png?s=128&g=1", "display_name": "Morkai_bde", "link": "https://stackoverflow.com/users/8494365/morkai-bde"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539212007, "post_id": 52748163, "comment_id": 92424008, "body": "That is the idea, lol, I want to build a system that is simple to implement, and to stop the people I work with from just copying everything, I don&#39;t want the license file to be on the local pc&#39;s, if it is on my server, I can easily switch my code off without hunting down stray copies, most of my users can only do basic things in excel, so I am not too worried about them getting past the protection"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1539212878, "post_id": 52748163, "comment_id": 92424225, "body": "SQLServer? new DB for you, new TBL -- both with passwords??"}], "owner": {"reputation": 25, "user_id": 8494365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EyaAv.png?s=128&g=1", "display_name": "Morkai_bde", "link": "https://stackoverflow.com/users/8494365/morkai-bde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539202982, "creation_date": 1539202695, "question_id": 52748163, "link": "https://stackoverflow.com/questions/52748163/how-do-i-save-a-value-from-a-cell-from-an-on-line-workbook-to-use-as-a-variable", "title": "How do I save a value from a cell from an on-line workbook to use as a variable in VBA", "body": "<p>I am expanding on an idea I had last year:\n <a href=\"https://stackoverflow.com/questions/45861131/how-do-i-get-the-cell-value-in-excel-using-an-environmental-variable-for-a-vba-i\">How do I get the Cell value in Excel using an environmental variable for a VBA If statement</a></p>\n\n<p>I want to use data from a license file on-line and data entered into the spreadsheet locally to verify if the license is valid and up to date</p>\n\n<p>I can copy the data I need from the on-line file to the local spreadsheet without any issues and check with normal formula, but I want to avoid doing that</p>\n\n<p>If possible, I'd like to save the data in variables instead to use for verification so that it makes it more difficult for someone to circumvent the protection</p>\n\n<pre><code>Sub Check_Key_Online()\nDim KeyFormula As String\n\nOn Error GoTo error\n\nKeyFormula = \"='\" &amp; \"SomeWebsiteURL/[\" &amp; Reg1.Range(\"D9\").Value &amp; \"]Lic'!$B$6\"\nWith Reg1.Range(\"G9\")\n.Formula = KeyFormula\n.Value = .Value\nEnd With\n\nMsgBox Reg1.Range(\"G9\").Value = Reg1.Range(\"D9\").Value\n\nGoTo exit1\n\nerror:\nMsgBox (IsError(KeyFormula))\n\nexit1:\nEnd Sub\n</code></pre>\n\n<p>The user will enter information, including a key, they key will then be taken to check which file to verify against on-line, once the file has been chosen and found to exist, I'd like the data to be saved in variables to check the validity</p>\n\n<p>PS. Ignore the error handling code, I still have to work on how to handle things if license is not found :P</p>\n"}, {"tags": ["excel", "vba", "excel-2010", "excel-charts", "excel-tables"], "answers": [{"tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1539208599, "creation_date": 1539208599, "answer_id": 52749325, "question_id": 52748120, "link": "https://stackoverflow.com/questions/52748120/how-to-set-range-of-table-data-for-use-with-chart/52749325#52749325", "title": "How to Set Range of Table Data for use with Chart", "body": "<p>I assume that the code above is producing \"Object Required\" error. I would recommend splitting the statement (ChartArea.SetSourceData) into multiple steps which will give you more control on the code and flexibility.</p>\n\n<p>To reference table ranges just create a ListObject variable and a Range variable, rest is explained below with examples.</p>\n\n<pre><code>Dim tbl As ListObject\nSet tbl = ActiveSheet.ListObjects(\"BMS_01_01_Module_01\")\n</code></pre>\n\n<p>As using so, one will be able to reference any part of the table really easily:</p>\n\n<pre><code>Dim rng As Range\n\n'Reference the whole table, including headers:\nSet rng = tbl.Range\n\n'Reference just the table data (no headers):\nSet rng = tbl.DataBodyRange\n\n'Reference just the data in a single column:\nSet rng = tbl.ListColumns(\"Cell 1 Voltage\").DataBodyRange\n\n'Reference the headers only\nSet rng = tbl.HeaderRowRange\n</code></pre>\n\n<hr>\n\n<p>Hence your code should be something similar as below:</p>\n\n<pre><code>chrt.ChartArea.SetSourceData Source:=tbl.ListColumns(\"Cell 1 Voltage\").DataBodyRange\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1539222216, "creation_date": 1539222216, "answer_id": 52750964, "question_id": 52748120, "link": "https://stackoverflow.com/questions/52748120/how-to-set-range-of-table-data-for-use-with-chart/52750964#52750964", "title": "How to Set Range of Table Data for use with Chart", "body": "<p>Try this.</p>\n\n<pre><code>Sub createChart()\n    Dim rng As Range\n    Dim obj As ChartObject\n    Dim chrt As Chart\n    Dim Lst As ListObject\n    Dim cm  As ListColumn\n    Dim Ws As Worksheet\n\n    Set Ws = ActiveSheet\n    Set Lst = Ws.ListObjects(\"BMS_01_01_Module_01\")\n    Set cm = Lst.ListColumns(\"Cell 1 Voltage\")\n    'Set cm = Lst.ListColumns(1)\n    Set rng = cm.DataBodyRange\n\n    'Table is named BMS_01_01_Module_01 and the column Name I want data from is Cell 1 Voltage\n    Set obj = Sheet1.ChartObjects.Add(200, 200, 400, 400)\n    With obj.Chart\n    'chrt.ChartArea.SetSourceData Source:=ActiveSheet.ListObjects(\"BMS_01_01_Module_01\").ListColumns(\"Cell 1 Voltage\").Range\n        .SetSourceData Source:=rng\n        .ChartType = xlLine\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 9257692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33edc4abba180ee38d3f1e90bb5bcac5?s=128&d=identicon&r=PG&f=1", "display_name": "VBANewbie", "link": "https://stackoverflow.com/users/9257692/vbanewbie"}, "is_accepted": true, "score": 0, "last_activity_date": 1539264064, "creation_date": 1539264064, "answer_id": 52761117, "question_id": 52748120, "link": "https://stackoverflow.com/questions/52748120/how-to-set-range-of-table-data-for-use-with-chart/52761117#52761117", "title": "How to Set Range of Table Data for use with Chart", "body": "<p>I ended up making some changes to my code.  I just wish there was a way to reference the table without having to activate the sheet the table is in first.  Note: the Chart and Tables are not on the same sheets.</p>\n\n<p>This is what ended up working for a single range:</p>\n\n<pre><code>Sub createChart()\nDim rng As Range\nDim cht As Object\nDim Ws As Worksheet\n\nSet cht = Sheet1.Shapes.addChart\n\nWorksheets(\"BMS_01_Module_01\").Activate\nSet Ws = ActiveSheet\n\nWs.ListObjects(\"BMS_01_Module_01\").ListColumns(\"Cell 1 Voltage\").Range.Select\ncht.Chart.SetSourceData Source:=Selection\ncht.Chart.ChartType = xlLine\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9257692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33edc4abba180ee38d3f1e90bb5bcac5?s=128&d=identicon&r=PG&f=1", "display_name": "VBANewbie", "link": "https://stackoverflow.com/users/9257692/vbanewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 52761117, "answer_count": 3, "score": -1, "last_activity_date": 1593591425, "creation_date": 1539202513, "last_edit_date": 1593591425, "question_id": 52748120, "link": "https://stackoverflow.com/questions/52748120/how-to-set-range-of-table-data-for-use-with-chart", "title": "How to Set Range of Table Data for use with Chart", "body": "<p>Using Excel 2010 I am trying to create a chart on Sheet1 using partial data from several different tables.  In the below example I am just trying to pull the data from one table as a start. I seem to be having difficulty setting the range of this data in this table.</p>\n\n<p>I will eventually loop through about 8 data columns of various lengths per table with approx. 21 tables.  So any help automating this would be great</p>\n\n<p>This is what I have so far...</p>\n\n<pre><code>Sub createChart()\n    Dim rng As Range\n    Dim chrt As Object\n\n    'Table is named BMS_01_01_Module_01 and the column Name I want data from is Cell 1 Voltage\n    Set chrt = Sheet1.Shapes.AddChart2\n    chrt.ChartArea.SetSourceData Source:=activesheetlistobjects(\"BMS_01_01_Module_01\").ListColumns(\"Cell 1 Voltage\").Range\n    chrt.ChartArea.ChartType = x1Line\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1539201723, "post_id": 52747845, "comment_id": 92420364, "body": "Does this need to be VBA? You could accomplish this with a formula.  In cell F1, use this formula and copy down: <code>=IF(COUNTIFS(A:A,A1,B:B,B1,C:C,C1,D:D,D1,E:E,E1)&lt;&gt;COUNTIFS(A&zwnj;&#8203;:A,A1,B:B,B1,C:C,C1,&zwnj;&#8203;D:D,D1),&quot;X&quot;,&quot;&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 10486174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Zy1k9JGV4I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtKHwF4TbLRrmUKKxfogjZeOGzsg/mo/photo.jpg?sz=128", "display_name": "Julian Wolpert", "link": "https://stackoverflow.com/users/10486174/julian-wolpert"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1539202500, "post_id": 52747845, "comment_id": 92420714, "body": "Thank you for your suggestion. It does need to be in VBA though."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539202817, "post_id": 52747845, "comment_id": 92420863, "body": "Then use <code>.Formula = ...</code>?  Taking a formula and applying in VBA is relatively trivial. Worst case, use the Macro Recorder to see how to do it."}, {"owner": {"reputation": 13, "user_id": 10486174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Zy1k9JGV4I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtKHwF4TbLRrmUKKxfogjZeOGzsg/mo/photo.jpg?sz=128", "display_name": "Julian Wolpert", "link": "https://stackoverflow.com/users/10486174/julian-wolpert"}, "edited": false, "score": 0, "creation_date": 1539206194, "post_id": 52747845, "comment_id": 92422235, "body": "This has helped a lot, thank you tigeravatar and BruceWayne. However, I do have an issue that I think may be caused by some of the data being asterisks. It looks like when one of the variables it is checking is an asterisk and there are other entries otherwise the same, it is comparing the whole group. Do you know what is causing this?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10486174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Zy1k9JGV4I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtKHwF4TbLRrmUKKxfogjZeOGzsg/mo/photo.jpg?sz=128", "display_name": "Julian Wolpert", "link": "https://stackoverflow.com/users/10486174/julian-wolpert"}, "edited": false, "score": 0, "creation_date": 1539638406, "post_id": 52792261, "comment_id": 92566863, "body": "This worked great, thank you! Your code was very easy to follow so I was able to modify it to fit my needs perfectly."}], "tags": [], "owner": {"reputation": 595, "user_id": 1237786, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f88fc95f445f0659730a2ad63c45f16a?s=128&d=identicon&r=PG", "display_name": "anefeletos", "link": "https://stackoverflow.com/users/1237786/anefeletos"}, "is_accepted": true, "score": 0, "last_activity_date": 1539428805, "creation_date": 1539428805, "answer_id": 52792261, "question_id": 52747845, "link": "https://stackoverflow.com/questions/52747845/excel-vba-compare-cell-values-when-other-values-in-row-meet-criteria/52792261#52792261", "title": "Excel VBA - compare cell values when other values in row meet criteria", "body": "<p>Changed a lot. Also in your question talking about checking 3 lines so I set a variable <code>vrange=3</code></p>\n\n<pre><code> Sub Compare()\n    Dim crit As Boolean\n    vrange = 3\n   'Sheet1.Activate\n   Endi = Sheet1.Cells(1, 1).End(xlDown).Row\n            For r = 1 To Endi\n              vmin = WorksheetFunction.max(1, r - vrange) - r\n              vmax = WorksheetFunction.min(Endi, r + vrange) - r\n               For v = vmin To vmax\n                crit = True\n                For c = 1 To 4\n                 crit = crit And Sheet1.Cells(r, c).value = Sheet1.Cells(r + v, c).value\n                Next c\n                If crit And Sheet1.Cells(r, 5).value &lt;&gt; Sheet1.Cells(r + v, 5).value Then\n                 Sheet1.Cells(r, 6).value = \"X\"\n                End If\n               Next v\n            Next r\n\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10486174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Zy1k9JGV4I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUtKHwF4TbLRrmUKKxfogjZeOGzsg/mo/photo.jpg?sz=128", "display_name": "Julian Wolpert", "link": "https://stackoverflow.com/users/10486174/julian-wolpert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 52792261, "answer_count": 1, "score": 1, "last_activity_date": 1593696092, "creation_date": 1539201360, "last_edit_date": 1593696092, "question_id": 52747845, "link": "https://stackoverflow.com/questions/52747845/excel-vba-compare-cell-values-when-other-values-in-row-meet-criteria", "title": "Excel VBA - compare cell values when other values in row meet criteria", "body": "<p>There is data in columns A through E. What I want to do is compare the values in column E when columns A, B, C, and D are the same, and to add a value of X to the row in column F if these conditions are met. I want to mark only those that have a mismatch in column E, but when I mark one row all the rows with the same A, B, C, and D values should be marked. </p>\n\n<p>For example, if A, B, C, and D are equal for the first three rows, I want to compare these entries. Since there is a mismatch in E3 when compared to E1 or E2, I want F1 through F3 to show as X. Since A, B, C, and D are equal in rows 4 and 5 but E4 and E5 match, I want it to ignore those cells.</p>\n\n<p>What I have now is:</p>\n\n<pre><code>Sub Compare()\n\nWorksheets(Sheet1).Activate\n        For w = 1 To Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row\n        For v = -10 To 10\n        If Sheet1.Cells(w, \"A\").Value = Sheet1.Cells(w + v, \"A\").Value And Sheet1.Cells(w, \"B\").Value = Sheet1.Cells(w + v, \"B\").Value And Sheet1.Cells(w, \"C\").Value = Sheet1.Cells(w + v, \"C\").Value And Sheet1.Cells(w, \"D\").Value = Sheet1.Cells(w + v, \"D\").Value And Sheet1.Cells(w, \"E\").Value &lt;&gt; Sheet1.Cells(w + v, \"E\").Value Then\n        Sheet1.Cells(w, \"F\").Value = \"X\"\n        End If\n        Next v\n        Next w\n\n\nEnd Sub\n</code></pre>\n\n<p>But it won't run. What do I need to change to get it working?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539200424, "post_id": 52747580, "comment_id": 92419777, "body": "Can you open Excel files like that via Hyperlinks? As a quick test, save that locally, update the path with the local path, and see if it works."}, {"owner": {"reputation": 53, "user_id": 5824965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0f4a7189dd6ff1c1508b8bcfeca88d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Boes", "link": "https://stackoverflow.com/users/5824965/m-boes"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539211457, "post_id": 52747580, "comment_id": 92423862, "body": "Yes Hyperlinks do work to open the desired file.   Because many people will be looking at the data and often, I would really like to have a macro perform the update without having to open copy and paste.  My error is when x.Sheets attempts to .copy.  The Run-time error results."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5824965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0f4a7189dd6ff1c1508b8bcfeca88d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Boes", "link": "https://stackoverflow.com/users/5824965/m-boes"}, "is_accepted": true, "score": 0, "last_activity_date": 1539218446, "creation_date": 1539218446, "answer_id": 52750560, "question_id": 52747580, "link": "https://stackoverflow.com/questions/52747580/vba-code-to-copy-range-of-data-from-closed-file-in-sharepoint-to-open-file/52750560#52750560", "title": "VBA code to copy range of data from closed file in SharePoint to open file", "body": "<p>Bruce was correct with the recommendation of simply using a Hyperlink in the cell.  This was attempted earlier but I must not have linked properly.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1540660283, "creation_date": 1540660283, "answer_id": 53024375, "question_id": 52747580, "link": "https://stackoverflow.com/questions/52747580/vba-code-to-copy-range-of-data-from-closed-file-in-sharepoint-to-open-file/53024375#53024375", "title": "VBA code to copy range of data from closed file in SharePoint to open file", "body": "<p>See if this works for you (comments included).</p>\n\n<pre><code>Sub OpenAndCloseWBFromSharePointFolder()\n\n'If nobody has the file checked out\nIf Workbooks.CanCheckOut(\"http://excel-pc:43231/Shared Documents/ExcelList.xlsb\") = True Then\nApplication.DisplayAlerts = False\n\n'Open the file on the SharePoint server\nWorkbooks.Open Filename:=\"http://excel-pc:43231/Shared Documents/ExcelList.xlsb\", UpdateLinks:=xlUpdateLinksNever\n\n'Close the workbook\nWorkbooks(\"ExcelList.xlsb\").Close\nApplication.DisplayAlerts = True\nElse\nApplication.DisplayAlerts = False\n\n'Open the File to check if you already have it checked out\nWorkbooks.Open Filename:=\"http://excel-pc:43231/Shared Documents/ExcelList.xlsb\", UpdateLinks:=xlUpdateLinksNever\n\n'See if doc can be checked in\nIf Application.Workbooks(\"ExcelList.xlsb\").CanCheckIn Then\n\n'Check In, Save and Close\nApplication.Workbooks(\"ExcelList.xlsb\").CheckIn SaveChanges:=True, Comments:=\"Checked-In before Delete\"\n\n'Open the file again\nWorkbooks.Open Filename:=\"http://excel-pc:43231/Shared Documents/ExcelList.xlsb\"\n\n'Close the workbook\nWorkbooks(\"ExcelList.xlsb\").Close\nEnd If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5824965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0f4a7189dd6ff1c1508b8bcfeca88d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Boes", "link": "https://stackoverflow.com/users/5824965/m-boes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2597, "favorite_count": 0, "accepted_answer_id": 52750560, "answer_count": 2, "score": 0, "last_activity_date": 1540660283, "creation_date": 1539200091, "question_id": 52747580, "link": "https://stackoverflow.com/questions/52747580/vba-code-to-copy-range-of-data-from-closed-file-in-sharepoint-to-open-file", "title": "VBA code to copy range of data from closed file in SharePoint to open file", "body": "<p>This question has been asked in different chats and I have tried to incorporate the varying solutions but without success.  I am attempting to open a SharePoint file and copy data from the file to the open file that has the macro within. The below solution is the last attempt I tried that did open the SharePoint file but would not select the desired range.  A Run-time error '9' Subscript out of range was returned.  If it makes it easier, my goal is to simply copy the entire sheet from the closed file into the open file.  Code used is below.  Any direction and or suggestions are appreciated.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim x As Workbook\nDim y As Workbook\n\nSet x = Workbooks.Open(\"http://employee.xtra.net/sites/Ops/Support%20Launch%20Docs/ep_timing_wb_report.xlsx\")\nSet y = ThisWorkbook\n\nx.Sheets(\"ep_timing_wb_report 1\").Range(\"A:AA\").Copy\ny.Sheets(\"ep_timing_wb_report\").Range(\"A:AA\").PasteSpecial\n\nx.close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539937194, "post_id": 52747541, "comment_id": 92689653, "body": "Did this answer your question please?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1539199906, "creation_date": 1539199906, "answer_id": 52747541, "question_id": 52747483, "link": "https://stackoverflow.com/questions/52747483/wrong-number-of-arguments-error-while-trying-to-save/52747541#52747541", "title": "wrong number of arguments error while trying to save?", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.savecopyas\" rel=\"nofollow noreferrer\">SaveCopyAs</a> doesn't take a password parameter. Only a filename.</p>\n\n<blockquote>\n  <p>Syntax expression. SaveCopyAs( <em>Filename</em> )</p>\n  \n  <p>expression A variable that represents a Workbook object.</p>\n  \n  <p>Parameters Name   Required/Optional   Data type   Description\n  Filename  Required    Variant Specifies the file name for the copy.</p>\n</blockquote>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1593696085, "creation_date": 1539199665, "last_edit_date": 1593696085, "question_id": 52747483, "link": "https://stackoverflow.com/questions/52747483/wrong-number-of-arguments-error-while-trying-to-save", "title": "wrong number of arguments error while trying to save?", "body": "<p>I keep getting a <code>wrong number of arguments or invalid property assignment</code> error when trying to tack on a <code>password:=\"xxxxxx\"</code> at the end of this line of code.</p>\n\n<pre><code>Wb.SaveCopyAs ThisWorkbook.Path &amp; Application.PathSeparator &amp; _\n          ValidFileName(Login &amp; \" - \" &amp; Last &amp; \" - \" &amp; \"Move to $15\" &amp; \".xlsx\"), Password:=\"xxxxxx\"\n</code></pre>\n\n<p>What could be causing this? The files saved fine beforehand, but stopped with that error once I tried including a password.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 2, "creation_date": 1539198891, "post_id": 52747224, "comment_id": 92419102, "body": "There are 2 problems I see.  First, in your class change the <code>Property Let</code> to <code>Property Set</code>.  Second, in the form code you need to say <code>Set o.First</code>.  There may be other issues, too."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1539199789, "post_id": 52747224, "comment_id": 92419517, "body": "Also, the <code>evFirst</code> object is identical to the <code>m_First</code> object. The <code>WithEvents</code> keyword simply allows you to write custom code for object you declared <code>WithEvents</code> for. Essentially, you don&#39;t need that <code>m_First</code> variable...."}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1539202513, "post_id": 52747224, "comment_id": 92420724, "body": "@BrianMStafford. No, you can use Let like a Set. You can make the case that you shouldn&#39;t from a coding style, but you can.(<a href=\"https://stackoverflow.com/questions/5042379/in-vb6-what-is-the-difference-between-property-set-and-property-let\" title=\"in vb6 what is the difference between property set and property let\">stackoverflow.com/questions/5042379/&hellip;</a>)"}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1539202675, "post_id": 52747224, "comment_id": 92420792, "body": "@Mistella. Yes, you are right. I do want that m_First for other reasons if I get this working, but it isn&#39;t doing anything in this simplified code I made to illustrate the problem"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1539203085, "post_id": 52747224, "comment_id": 92420979, "body": "It&#39;s not a coding style thing. It&#39;s about meeting expectations. Also, if your class has a <i>default member</i>, let-coercion will literally change how the member works, with identical code - that&#39;s objectively wrong, not a style thing at all. One is correct, the other is begging for future bugs to happen."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539204037, "post_id": 52747224, "comment_id": 92421379, "body": "Side note, the <code>RHS</code> argument of a <code>Property Let</code> or <code>Property Set</code> member is <i>always</i> passed <code>ByVal</code>, regardless of what the signature says: that explicit <code>ByRef</code> is misleading."}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539204363, "post_id": 52747224, "comment_id": 92421527, "body": "@MathieuGuindon. I didn&#39;t know that; does this explain the different ObjPtrs?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539204595, "post_id": 52747224, "comment_id": 92421610, "body": "I don&#39;t think so. It&#39;s not clear what <code>UserForm1.CommandButton1</code> is. I&#39;d assume it&#39;s an instance of <code>cButtonClass</code>, but the name is the default name of a design-time button, so I can&#39;t tell what&#39;s what just by looking at the code in the OP."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539204818, "post_id": 52747224, "comment_id": 92421707, "body": "Another side note - if you want/need to handle the events in the form&#39;s code-behind (i.e. to do anything more useful than just popping a dummy message box), you&#39;ll need to hold a reference to the form in the custom button class, and since the form holds a reference to the button class, you&#39;ll likely run into a circular reference. <a href=\"https://rubberduckvba.wordpress.com/2018/09/11/lazy-object-weak-reference/\" rel=\"nofollow noreferrer\">This recent article of mine</a> describes a work-around."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1539205136, "post_id": 52747224, "comment_id": 92421851, "body": "@Berryl - <code>ObjPtr</code> is not reliable after it has been wrapped in a <code>Variant</code>. You need to use <code>VarPtr</code> in that case. <code>Debug.Assert VarPtr(o.First) = VarPtr(f.CommandButton1)</code> should pass."}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539205699, "post_id": 52747224, "comment_id": 92422064, "body": "@MathieuGuindon. How would you go about firing the Button.Click event so a unit test wouldn&#39;t need to show the form? Happy to make that a separate question if the answer isn&#39;t a one-liner..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539205950, "post_id": 52747224, "comment_id": 92422149, "body": "Depends what you&#39;re testing. If you&#39;re testing the form because that&#39;s where your logic is, you have a design problem (Smart UI [anti]-pattern) and need to refactor towards a more MVP-like solution. I don&#39;t write unit tests for view-level logic, so my one-liner answer would be &quot;you don&#39;t&quot;. How would you go about doing the exact same thing in C#? You wouldn&#39;t, because you wouldn&#39;t have the form running the show in C# - so, do the same in VBA! (several articles about that on my blog)"}, {"owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "edited": false, "score": 0, "creation_date": 1539206643, "post_id": 52747224, "comment_id": 92422391, "body": "no, the logic is in a POCO. just looking for a way to test that the event hooks up properly, which I would do in C# also"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539207192, "post_id": 52747224, "comment_id": 92422574, "body": "Sounds like testing the framework itself to me. But anyway you could have a public <code>OnClick</code> method that fires the <code>Click</code> event."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539211836, "post_id": 52747224, "comment_id": 92423965, "body": "Anyway for testing you can make your wrapper class encapsulate the MSForms control with a Private WithEvents field, and then expose your own Click event for the form to handle. If you want to test the wiring-up between the form and the wrapper class without showing the form, you need an OnClick method on the wrapper to fire the event at will, and then the form needs to fire an event (that the presenter would handle) in response to that, e.g. SaveChangesClicked; the test setup then needs a WithEvents form instance that you just don&#39;t show. The actual button click can&#39;t be unit tested AFAIK."}], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 2, "last_activity_date": 1539203063, "creation_date": 1539203063, "answer_id": 52748253, "question_id": 52747224, "link": "https://stackoverflow.com/questions/52747224/vba-button-event-handler-implementation/52748253#52748253", "title": "VBA button event handler implementation", "body": "<p>Here is updated code reflecting the above comments.  It works as expected.  However, I don't have an answer yet for your other question concerning <code>ObjPtr</code>.</p>\n\n<p>Here's the class code:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents evFirst As MSForms.CommandButton\n\nProperty Get First() As MSForms.CommandButton\n    Set First = evFirst\nEnd Property\n\nProperty Set First(ByRef o As MSForms.CommandButton)\n    Set evFirst = o\nEnd Property\n\nPrivate Sub evFirst_Click()\n    MsgBox \"Class Click\"\nEnd Sub\n</code></pre>\n\n<p>Here's the sheet code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Tester()\n    Dim f As UserForm1\n    Dim o As cButtonClass\n\n    Set f = New UserForm1\n    Set o = New cButtonClass\n    Set o.First = f.CommandButton1\n    f.Show vbModal\n\n    Dim k1 As LongPtr: k1 = ObjPtr(o.First)\n    Dim k2 As LongPtr: k2 = ObjPtr(f.CommandButton1)\n    Debug.Assert k1 = k2 'NOPE!\nEnd Sub\n</code></pre>\n\n<p>Here's the userform code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   MsgBox \"UserForm Click\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11746, "user_id": 95245, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7a9645d49aa683c44714ba60392e9c5f?s=128&d=identicon&r=PG", "display_name": "Berryl", "link": "https://stackoverflow.com/users/95245/berryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 3, "accepted_answer_id": 52748253, "answer_count": 1, "score": 3, "last_activity_date": 1593696077, "creation_date": 1539198599, "last_edit_date": 1593696077, "question_id": 52747224, "link": "https://stackoverflow.com/questions/52747224/vba-button-event-handler-implementation", "title": "VBA button event handler implementation", "body": "<p>I want to handle the click on an <strong>CommandButton</strong> from within a class using the following class code</p>\n\n<pre><code>Option Explicit\n\nPrivate m_First                     As MSForms.CommandButton\nPrivate WithEvents evFirst          As MSForms.CommandButton\n\nProperty Get First() As MSForms.CommandButton\n    Set First = m_First\nEnd Property\nProperty Let First(ByRef o As MSForms.CommandButton)\n    Set m_First = o\n    Set evFirst = o\nEnd Property\n\nPrivate Sub evFirst_Click()\n    MsgBox \"It Worked!\"\nEnd Sub\n</code></pre>\n\n<p>In addition to it not working, am wondering why the reference for the Button in the form is different from that in the class, ie:</p>\n\n<pre><code>Sub Tester()\n    Dim f As New UserForm1\n    Dim o As New cButtonClass\n    o.First = f.CommandButton1\n\n    Dim k1 As LongLong: k1 = ObjPtr(o.First)\n    Dim k2 As LongLong: k2 = ObjPtr(f.CommandButton1)\n    Debug.Assert k1 = k2 'NOPE!\nEnd Sub\n</code></pre>\n\n<p>Why doesn't this work? What is the fix?</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7851812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2be7c8eeada09f944ad13ee4605abe1d?s=128&d=identicon&r=PG&f=1", "display_name": "Xenedra", "link": "https://stackoverflow.com/users/7851812/xenedra"}, "edited": false, "score": 0, "creation_date": 1539201283, "post_id": 52747235, "comment_id": 92420163, "body": "I tried to use Evaluate and it gave me &#39;Error 2015&#39; (I copied and pasted your line).  What does that mean?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 49, "user_id": 7851812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2be7c8eeada09f944ad13ee4605abe1d?s=128&d=identicon&r=PG&f=1", "display_name": "Xenedra", "link": "https://stackoverflow.com/users/7851812/xenedra"}, "edited": false, "score": 0, "creation_date": 1539201562, "post_id": 52747235, "comment_id": 92420285, "body": "@Xenedra sorry had a typo.  But once again I would suggest you use the variant array method, it will be quicker for larger ranges and it is easier to read."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1539201508, "last_edit_date": 1539201508, "creation_date": 1539198638, "answer_id": 52747235, "question_id": 52747143, "link": "https://stackoverflow.com/questions/52747143/max-of-the-difference-between-two-arrays-in-udf/52747235#52747235", "title": "Max of the difference between two arrays in UDF", "body": "<p>the <code>[]</code> are short hand for Evaluate which will return an array.</p>\n\n<p>So to use Range one would need to explicitly use Evaluate:</p>\n\n<pre><code>Application.Evaluate(\"MAX(\" &amp; Worksheets(\"Sheet1\").Range(\"A1:A5\").Address(1, 1, 1, 1) &amp; \"-\" &amp; Worksheets(\"Sheet2\").Range(\"A1:A5\").Address(1, 1, 1, 1) &amp; \")\")\n</code></pre>\n\n<p>But may be quicker to load the values into variant arrays and then iterate that to find the MAX:</p>\n\n<pre><code>Dim Sht1 as variant\nSht1 = Worksheets(\"Sheet1\").Range(\"A1:A5\").Value\n\nDim Sht2 as Variant\nSht2 = Worksheets(\"Sheet2\").Range(\"A1:A5\").Value\n\nDim Mx as Double\nMx = -99999999\n\nDim i as Long\nFor i = Lbound(Sht1,1) to Ubound(sht1,1)\n    If sht1(i,1) - sht2(i,1) &gt; Mx then Mx = sht1(i,1) - sht2(i,1)\nNext i\n\nDebug.Print Mx\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7851812, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2be7c8eeada09f944ad13ee4605abe1d?s=128&d=identicon&r=PG&f=1", "display_name": "Xenedra", "link": "https://stackoverflow.com/users/7851812/xenedra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 52747235, "answer_count": 1, "score": 1, "last_activity_date": 1593696068, "creation_date": 1539198252, "last_edit_date": 1593696068, "question_id": 52747143, "link": "https://stackoverflow.com/questions/52747143/max-of-the-difference-between-two-arrays-in-udf", "title": "Max of the difference between two arrays in UDF", "body": "<p>I have managed to get the function to work (subtracts one array from another and gives me the max of the differences) with the following code:</p>\n\n<pre><code>WorksheetFunction.Max([Sheet1!A1:A5 - Sheet2!A1:A5])\n</code></pre>\n\n<p>However, I really need to be able to refer to the ranges in this way: </p>\n\n<pre><code>WorksheetFunction.Max(Worksheets(\"Sheet1\").Range(\"A1:A5\") - Worksheets(\"Sheet2\").Range(\"A1:A5\"))\n</code></pre>\n\n<p>I have tried this and it does not work.  Why does one range method work and not the other?</p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1539196594, "post_id": 52746700, "comment_id": 92418040, "body": "What is the value of <code>SelectedSheet</code> when the error occurs? Does a sheet with that name actually exist?"}, {"owner": {"reputation": 11, "user_id": 10485828, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WOxEM47-iq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX3VXIXT672wOqe-g2tAfB4ZVFd9w/mo/photo.jpg?sz=128", "display_name": "Heather Longardner", "link": "https://stackoverflow.com/users/10485828/heather-longardner"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1539197184, "post_id": 52746700, "comment_id": 92418308, "body": "SelectedSheet  actually ties directly to one of 3 sheets...EA, LF, or SF.  when running the macro, pop up box comes up stating to select one of the 3 sheets. once selected, then run-time error happens"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1539198021, "post_id": 52746700, "comment_id": 92418698, "body": "I don&#39;t see where your userform value <code>SelectedSheet</code> is getting passed back into the sub."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1539198104, "post_id": 52746700, "comment_id": 92418726, "body": "just before the line that causes the error, add a temporary line: <code>MsgBox SelectedSheet</code> .  this will pop up a message box with the value of <code>selectedsheet</code>... is the value what you expect?"}, {"owner": {"reputation": 11, "user_id": 10485828, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WOxEM47-iq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX3VXIXT672wOqe-g2tAfB4ZVFd9w/mo/photo.jpg?sz=128", "display_name": "Heather Longardner", "link": "https://stackoverflow.com/users/10485828/heather-longardner"}, "edited": false, "score": 0, "creation_date": 1539198375, "post_id": 52746700, "comment_id": 92418845, "body": "No message box popped up, but it actually works"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539198444, "post_id": 52746700, "comment_id": 92418882, "body": "Recommended: <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA</a> . . if you can&#39;t get it figured out, can you add the code that assigns SelectedSheet it&#39;s value?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1539198473, "post_id": 52746700, "comment_id": 92418894, "body": "@HeatherLongardner -  <b>No</b> message box??  Then that section of code isn&#39;t running at all. Even if it&#39;s &quot;working&quot; now, I&#39;d suggest you use [F8] to step through the code line-by-line to try to figure out how it works  (instructions in the link above)"}], "owner": {"reputation": 11, "user_id": 10485828, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WOxEM47-iq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX3VXIXT672wOqe-g2tAfB4ZVFd9w/mo/photo.jpg?sz=128", "display_name": "Heather Longardner", "link": "https://stackoverflow.com/users/10485828/heather-longardner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539198343, "creation_date": 1539196450, "last_edit_date": 1539198343, "question_id": 52746700, "link": "https://stackoverflow.com/questions/52746700/run-time-error-1004-copy-selected-sheet-failure", "title": "Run time Error 1004 - copy selected sheet failure", "body": "<p>I'm trying to fix this error for a coworker, but extremely rusty on the code work. </p>\n\n<pre><code>Sub SelectPricingSheet() \n'Copy userform1 selected Pricing sheet after Import Sheet.\n\n    CreateSheetList                    ' Subroutine: Build list of Price sheets\n    Load UserForm1                     ' Load form to select price sheet\n    UserForm1.Show                     ' Show form to select price sheet\n\n    If SelectedSheet &lt;&gt; \"\" Then        ' Test no selected sheet\n        Sheets(SelectedSheet).Copy After:=Sheets(\"Import\") 'Copy selected sheet after Import Sheet\n    Else\n    End If                              ' No processing\nEnd Sub\n</code></pre>\n\n<p>Errors out at this line.</p>\n\n<pre><code>Sheets(SelectedSheet).Copy After:=Sheets(\"Import\")          ' Copy selected sheet after the Import Sheet\n</code></pre>\n"}, {"tags": ["excel", "vba", "activex"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10485838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9579f8ca2fcb06a7f7f83192cc5481c3?s=128&d=identicon&r=PG&f=1", "display_name": "Firewheeler", "link": "https://stackoverflow.com/users/10485838/firewheeler"}, "edited": false, "score": 0, "creation_date": 1539371484, "post_id": 52750556, "comment_id": 92492863, "body": "oxwilder This seems to be working well, but I have bunch of dropdowns and they are linked to each other. I am not sure how it will work then, i.e can the dropdown change value trigger a different list in an other dropdown?"}, {"owner": {"reputation": 1, "user_id": 10485838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9579f8ca2fcb06a7f7f83192cc5481c3?s=128&d=identicon&r=PG&f=1", "display_name": "Firewheeler", "link": "https://stackoverflow.com/users/10485838/firewheeler"}, "edited": false, "score": 0, "creation_date": 1539371585, "post_id": 52750556, "comment_id": 92492906, "body": "But I found a way to trigger the activex drop downs. By inserting &#39; Call Sheet1.ComboBox1_Click&#39; under the sub workbook_open(). For some reason, triggering one activex is enough to activate the other activex elements."}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1539218412, "creation_date": 1539218412, "answer_id": 52750556, "question_id": 52746639, "link": "https://stackoverflow.com/questions/52746639/excel-activex-combobox-activate-when-excel-workbook-is-opened/52750556#52750556", "title": "Excel Activex combobox activate when excel workbook is opened", "body": "<p>You can run code on workbook open automatically with <code>sub workbook_open()</code> and then create the combobox on that event as opposed to the click event:</p>\n\n<pre><code>Dim r As Range\nDim list As Object\nDim rng As Range\nDim rng1 As Range\n\n\nSet oDictionary = CreateObject(\"Scripting.Dictionary\")\n\nWith Sheet2\n    Set rng1 = .Range(\"C11\", .Cells(.Rows.Count, \"c\").End(xlUp))\n    For Each r In rng1.Cells\n\n        If Not oDictionary.Exists(r.Text) Then\n            Set list = CreateObject(\"System.Collections.ArrayList\")\n\n            oDictionary.Add r.Text, list\n        End If\n\n        If Not oDictionary(r.Text).Contains(r.Offset(0, 1).Value) Then\n            oDictionary(r.Text).Add r.Offset(0, 1).Value\n        End If\n\n    Next\nEnd With\n\nSet rng = Worksheets(1).Range(\"c11\") 'where the dropdown list will go\n    With rng\n        Set box1 = Worksheets(1).DropDowns.Add(.Left, .Top, .Width, .Height)\n            With box1\n              .Name = \"ComboBoxIn\" &amp; rng.Address(False, False)\n              .list = oDictionary.Keys\n            End With\n     End With\nend sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10485838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9579f8ca2fcb06a7f7f83192cc5481c3?s=128&d=identicon&r=PG&f=1", "display_name": "Firewheeler", "link": "https://stackoverflow.com/users/10485838/firewheeler"}, "is_accepted": true, "score": 0, "last_activity_date": 1539371710, "creation_date": 1539371710, "answer_id": 52785733, "question_id": 52746639, "link": "https://stackoverflow.com/questions/52746639/excel-activex-combobox-activate-when-excel-workbook-is-opened/52785733#52785733", "title": "Excel Activex combobox activate when excel workbook is opened", "body": "<p>Actually found a solution while tinkering with the workbook_open sub.</p>\n\n<p>By inserting <code>Call Sheet1.ComboBox1_Click</code> under the sub workbook_open(). For some reason, triggering one activex is enough to activate the other activex elements.</p>\n"}], "owner": {"reputation": 1, "user_id": 10485838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9579f8ca2fcb06a7f7f83192cc5481c3?s=128&d=identicon&r=PG&f=1", "display_name": "Firewheeler", "link": "https://stackoverflow.com/users/10485838/firewheeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 52785733, "answer_count": 2, "score": 0, "last_activity_date": 1593696009, "creation_date": 1539196160, "last_edit_date": 1593696009, "question_id": 52746639, "link": "https://stackoverflow.com/questions/52746639/excel-activex-combobox-activate-when-excel-workbook-is-opened", "title": "Excel Activex combobox activate when excel workbook is opened", "body": "<p>I have a few activex combobox and vb code in excel sheet 1. But everytime after I open the workbook, I need to open the code window and run the code to activate the combobox. Is there any way that I can automatically activate and run the code in sheet 1, belonging to combobox, once I open the workbook?</p>\n<p>I tried looking into other forums/questions but could not find any solution.\nsheet1.combobox1.activate in thisworkbook code is not working either. T</p>\n<p>Following is the code that is in sheet 1 that needs to be activated.</p>\n<pre><code>Public oDictionary As Object\n\nPrivate Sub ComboBox1_Click()\n    Dim r As Range\n    Dim list As Object\n\n    Set oDictionary = CreateObject(&quot;Scripting.Dictionary&quot;)\n\n    With Sheet2\n        For Each r In .Range(&quot;C11&quot;, .Cells(.Rows.Count, &quot;c&quot;).End(xlUp))  \n\n            If Not oDictionary.Exists(r.Text) Then                       \n                Set list = CreateObject(&quot;System.Collections.ArrayList&quot;)  \n\n                oDictionary.Add r.Text, list\n            End If\n\n            If Not oDictionary(r.Text).Contains(r.Offset(0, 1).Value) Then  \n                oDictionary(r.Text).Add r.Offset(0, 1).Value                \n            End If\n\n        Next\n    End With\n\n    ComboBox1.list = oDictionary.Keys  'Display the list in combobox 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539196066, "post_id": 52746341, "comment_id": 92417789, "body": "Have you tried <code>AutoFilter</code>?"}, {"owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539276323, "post_id": 52746341, "comment_id": 92452962, "body": "Yep, and that&#39;s not it."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539276410, "post_id": 52746341, "comment_id": 92453015, "body": "Okay, how about <code>AutoFilterClassic</code>? I&#39;m guessing it has to be on this list here: <a href=\"https://msdn.microsoft.com/en-us/library/dd909393(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/dd909393(v=office.12).aspx</a>"}, {"owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539285444, "post_id": 52746341, "comment_id": 92457568, "body": "Sadly, it&#39;s not on that list. I&#39;ve tried everything there that looks even remotely filter-related, with no luck."}], "owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593695992, "creation_date": 1539194901, "last_edit_date": 1593695992, "question_id": 52746341, "link": "https://stackoverflow.com/questions/52746341/excel-idmso-value-for-filter-by-selected-cells-value", "title": "Excel idMso value for &quot;Filter by Selected Cell&#39;s Value&quot;", "body": "<p>I cannot find the idMso value for the command \"Filter by Selected Cell's Value\" that appears on the contextual menu when right-clicking on a cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2wrXJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2wrXJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>My goal is to intercept this command and do some additional VBA work around the act of filtering, which is what I am currently able to do for the Ribbon's \"Filter\" command with the following RibbonUI XML.</p>\n\n<blockquote>\n<pre><code>&lt;commands&gt;\n    &lt;command idMso=\"Filter\" onAction=\"UserList_Main.RepurposeCommand\" /&gt;\n&lt;/commands&gt;\n</code></pre>\n</blockquote>\n\n<p>Anyone know what this idMso should be?</p>\n\n<p>(While we're at it, the other commands from that contextual menu could be useful as well, though By Value is the important one.)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539195443, "post_id": 52746334, "comment_id": 92417521, "body": "Guess this was an easy one, you got the same answer 3 times within 2 minutes. :)"}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539195634, "post_id": 52746334, "comment_id": 92417599, "body": "@vacip ya in retrospect I should have thought of that solution on my own. It seams so obvious now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539196471, "post_id": 52746334, "comment_id": 92417977, "body": "@Mike-SMT hindsight is always 20/20 ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1539195427, "post_id": 52746409, "comment_id": 92417505, "body": "Thank you for your answer. This worked well enough. If you would please add a simple example into your answer it would be worth up-voting. Link only answer don&#39;t age well due to links breaking."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1539195838, "post_id": 52746409, "comment_id": 92417688, "body": "Also the downside to doing this would be adding more lines to the code then needed. I think the accepted answer here is probably the best option in this case."}, {"owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "reply_to_user": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1539196671, "post_id": 52746409, "comment_id": 92418074, "body": "Thanks for the input @Mike-SMT"}], "tags": [], "owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "is_accepted": false, "score": 1, "last_activity_date": 1539195993, "last_edit_date": 1539195993, "creation_date": 1539195156, "answer_id": 52746409, "question_id": 52746334, "link": "https://stackoverflow.com/questions/52746334/workbook-worksheets-columns-with-numbers-instead-of-a-string/52746409#52746409", "title": "Workbook.Worksheets.Columns() with numbers instead of a string?", "body": "<p>If you know the first and last column that you want to change the width on you could convert the numbers to letters (see this site: <a href=\"https://www.thespreadsheetguru.com/the-code-vault/vba-code-to-convert-column-number-to-letter-or-letter-to-number\" rel=\"nofollow noreferrer\">Number to Letter</a>) and then convert the whole range.</p>\n\n<p>Here is an example of this method:</p>\n\n<pre><code>Dim start_column As String, end_column As String\nDim last_col As Integer\nlast_col = re_wb.Worksheets(1).Cells(1, re_wb.Worksheets(1).Columns.Count).End(xlToLeft).Column\n\nstart_column = Split(Cells(1, last_col + 1).Address, \"$\")(1)\nend_column = Split(Cells(1, last_col + 2).Address, \"$\")(1)\nre_wb.Worksheets(1).Columns(start_column &amp; \":\" &amp; end_column).ColumnWidth = 23\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539195427, "post_id": 52746434, "comment_id": 92417506, "body": "This can fail with an error 1004 if the ActiveSheet isn&#39;t <code>re_wb.Worksheets(1)</code>.  <code>EntireColumn</code> is also unnecessary."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539195481, "post_id": 52746434, "comment_id": 92417535, "body": "@Comintern true but if I simple did <code>re_wb.Worksheets(1).Cells(1,last_col + 1)</code> instead it should compensate for that problem."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539195532, "post_id": 52746434, "comment_id": 92417550, "body": "@Comintern true, your answer is better in that respect."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 1, "last_activity_date": 1539195267, "creation_date": 1539195267, "answer_id": 52746434, "question_id": 52746334, "link": "https://stackoverflow.com/questions/52746334/workbook-worksheets-columns-with-numbers-instead-of-a-string/52746434#52746434", "title": "Workbook.Worksheets.Columns() with numbers instead of a string?", "body": "<p>Range and EntireColumn are your friends here:</p>\n\n<pre><code>re_wb.Worksheets(1).Range(Cells(1,last_col + 1),Cells(1,last_col + 10)).entirecolumn.ColumnWidth = 23\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539195488, "post_id": 52746456, "comment_id": 92417536, "body": "For some reason I always use the .EntireColumn in such cases. Not sure why though, I&#39;ll research this..."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539195560, "post_id": 52746456, "comment_id": 92417563, "body": "@vacip I am not sure if entire column or just column would make a difference here. Both result in the same spacing for the entire column. Should be fine either way. Maybe the entire column option might cost more cpu time."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 4, "last_activity_date": 1539195350, "creation_date": 1539195350, "answer_id": 52746456, "question_id": 52746334, "link": "https://stackoverflow.com/questions/52746334/workbook-worksheets-columns-with-numbers-instead-of-a-string/52746456#52746456", "title": "Workbook.Worksheets.Columns() with numbers instead of a string?", "body": "<p>There's no such thing as a \"Column\" in the Excel object model - <code>Worksheet.Columns(foo)</code> returns a <code>Range</code>. Just build the appropriate <code>Range</code> and use that to set the column widths:</p>\n\n<pre><code>With re_wb.Worksheets(1)\n    .Range(.Cells(1, last_col + 1), .Cells(1, last_col + 2)).ColumnWidth = 23\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 2, "last_activity_date": 1539195403, "creation_date": 1539195403, "answer_id": 52746464, "question_id": 52746334, "link": "https://stackoverflow.com/questions/52746334/workbook-worksheets-columns-with-numbers-instead-of-a-string/52746464#52746464", "title": "Workbook.Worksheets.Columns() with numbers instead of a string?", "body": "<pre><code>Range(Cells(1, 1), Cells(1, 3)).EntireColumn.ColumnWidth = 15\n</code></pre>\n\n<p>Obviously you'll want to qualify what sheet you're refering to rather than just Range or Cells</p>\n"}, {"comments": [{"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1539196084, "post_id": 52746581, "comment_id": 92417797, "body": "There is a lot of useful examples here for sure.  I added an example to one of the answer below that is like this. It does not use a function thought. Simple in the line of code changing the column width."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1539196134, "last_edit_date": 1539196134, "creation_date": 1539195908, "answer_id": 52746581, "question_id": 52746334, "link": "https://stackoverflow.com/questions/52746334/workbook-worksheets-columns-with-numbers-instead-of-a-string/52746581#52746581", "title": "Workbook.Worksheets.Columns() with numbers instead of a string?", "body": "<p>You have a bunch of great examples here - personally I prefer to use a function that converts a number to a column letter - this way I don't have to change my syntax too much:</p>\n\n<pre><code>Function ColLetter(colnum As Long)\n\n    ColLetter = Split(Cells(1, colnum).Address, \"$\")(1)\n\nEnd Function\n</code></pre>\n\n<p>Using in your example:</p>\n\n<pre><code>re_wb.Worksheets(1).Columns(ColLetter(last_col + 1) &amp; \":\" &amp; ColLetter(last_col + 2)).ColumnWidth = 23\n</code></pre>\n"}], "owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 52746456, "answer_count": 5, "score": 2, "last_activity_date": 1593695983, "creation_date": 1539194884, "last_edit_date": 1593695983, "question_id": 52746334, "link": "https://stackoverflow.com/questions/52746334/workbook-worksheets-columns-with-numbers-instead-of-a-string", "title": "Workbook.Worksheets.Columns() with numbers instead of a string?", "body": "<p>Currently I am able to do one of two things.</p>\n\n<p>I can either use a string showing what columns I want to change the width of or I can use a column number one at a time like this:</p>\n\n<p>This works fine as a string.</p>\n\n<pre><code>re_wb.Worksheets(1).Columns(\"K:J\").ColumnWidth = 23\n</code></pre>\n\n<p>The problem is I am having to dynamically find the last column and then add two more columns to the sheet. This is accomplished with finding the last column then just adding a value to the 1st cell for a header using <code>+1</code> and <code>+2</code> on the last column number.</p>\n\n<pre><code>last_col = re_wb.Worksheets(1).Cells(1, re_wb.Worksheets(1).Columns.Count).End(xlToLeft).Column\nre_wb.Worksheets(1).Cells(1, last_col + 1).Value = \"Correct Per CL\"\nre_wb.Worksheets(1).Cells(1, last_col + 2).Value = \"Is reassignment needed?\"\n</code></pre>\n\n<p>For two columns its not such a big deal to write two lines with the last column number +1 and +2 respectively to edit their width but considering a range of columns can be worked with a string is it possible to use two sets of numbers? (Or more numbers depending on how many columns I may need to edit at once.)</p>\n\n<pre><code>re_wb.Worksheets(1).Columns(last_col + 1).ColumnWidth = 23\nre_wb.Worksheets(1).Columns(last_col + 2).ColumnWidth = 23\n</code></pre>\n\n<p>I have tried something like this:</p>\n\n<pre><code>re_wb.Worksheets(1).Columns(last_col + 1, last_col + 2).ColumnWidth = 23\n</code></pre>\n\n<p>With no luck. Seeing that I cannot predict what letter the column will be is it possible to define a range of columns using numbers or will I need to simply need to do one at a time like I already have above?</p>\n"}, {"tags": ["excel", "vba", "match", "worksheet-function", "variant"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539195037, "post_id": 52746257, "comment_id": 92417327, "body": "You can always add <code>If IsNumeric(userinput) Then userinput = CDec(userinput)</code> after the inputbox line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539195425, "post_id": 52746257, "comment_id": 92417502, "body": "<code>Inputbox</code> will return a string even if the user enters a number: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/inputbox-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 3127527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3237b5aa6fa30817903cd3f2983fb4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yahya.A", "link": "https://stackoverflow.com/users/3127527/yahya-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1539195880, "creation_date": 1539195880, "answer_id": 52746575, "question_id": 52746257, "link": "https://stackoverflow.com/questions/52746257/excel-vba-match-function-to-take-either-string-or-integer-variables-as-arg1/52746575#52746575", "title": "Excel VBA Match function to take either String or Integer variables as Arg1", "body": "<p>Thanks Scott Craner, it worked!. It is my first time to learn about the CDec function.</p>\n\n<p>This way (using the Val function) is also working. </p>\n\n<pre><code>Sub Return_Row()\nDim search_rng As Range\n\nuserinput = InputBox(\"Enter your number\")\n\nOn Error Resume Next\nIf IsNumeric(userinput) Then\n    userinput = Val(userinput)\n    Set search_rng = ActiveSheet.Range(\"A:A\")\n    N = Application.WorksheetFunction.Match(userinput, search_rng, 0)\nElse\n    Set search_rng = ActiveSheet.Range(\"B:B\")\n    N = Application.WorksheetFunction.Match(userinput, search_rng, 0)\nEnd If\n\nOn Error GoTo 0\n\n\nMsgBox N\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539197018, "post_id": 52746621, "comment_id": 92418233, "body": "I would advise using <code>Select Case VarType(userinput)</code> and thus switch over a built-in enum rather than using <code>TypeName</code> and dealing with hard-coded strings."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539198929, "post_id": 52746621, "comment_id": 92419114, "body": "@MathieuGuindon In general, I would agree with you. I chose <code>TypeName</code> in this instance thinking it would provide some clarity to the OP, but clearly, using <code>vbDouble</code> and <code>vbString</code> would have been equally illuminating, and less prone to typos."}, {"owner": {"reputation": 57, "user_id": 3127527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3237b5aa6fa30817903cd3f2983fb4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yahya.A", "link": "https://stackoverflow.com/users/3127527/yahya-a"}, "edited": false, "score": 0, "creation_date": 1539199531, "post_id": 52746621, "comment_id": 92419396, "body": "Thank you very much Ron! I started exploring the <code>Application.InputBox</code> method and it is very interesting. I wish I knew about this long time ago"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1539199204, "last_edit_date": 1539199204, "creation_date": 1539196055, "answer_id": 52746621, "question_id": 52746257, "link": "https://stackoverflow.com/questions/52746257/excel-vba-match-function-to-take-either-string-or-integer-variables-as-arg1/52746621#52746621", "title": "Excel VBA Match function to take either String or Integer variables as Arg1", "body": "<p>Here's another approach:</p>\n\n<pre><code>Sub foo()\n    Dim userinput\n    userinput = Application.InputBox(\"your value\", Type:=3)\n\nSelect Case TypeName(userinput)\n    Case \"Double\"\n        'do the numeric match\n    Case \"String\"\n        'do the string match\n    Case Boolean\n        'Cancel button routine\nEnd Select\nEnd Sub\n</code></pre>\n\n<p><code>Application.InputBox</code> unlike <code>InputBox</code> (which is really <code>VBA.InputBox</code>), allows you to specify the return types.</p>\n\n<p>As @MathieuGuindon points out, there are some benefits to using <code>VarType</code> instead of <code>TypeName</code>.  Below is code using the latter:</p>\n\n<pre><code>Option Explicit\nSub foo()\n    Dim userinput\n    userinput = Application.InputBouserinput(\"your value\", Type:=3)\n\nSelect Case VarType(userinput)\n    Case vbDouble\n        'do the numeric match\n    Case vbString\n        'do the string match\n    Case vbBoolean\n        'Cancel button was pressed\n        Stop\nEnd Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 3127527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3237b5aa6fa30817903cd3f2983fb4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yahya.A", "link": "https://stackoverflow.com/users/3127527/yahya-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1539199204, "creation_date": 1539194558, "question_id": 52746257, "link": "https://stackoverflow.com/questions/52746257/excel-vba-match-function-to-take-either-string-or-integer-variables-as-arg1", "title": "Excel VBA Match function to take either String or Integer variables as Arg1", "body": "<p>The following is part of a longer code. \nHow can I declare Arg1 in <code>Application.WorksheetFunction.Match</code> to be either an Integer or a String?</p>\n\n<p>I have data (numbers) in column A and numbers with underscores in column B. </p>\n\n<p>The user would enter either a number or a string in an inputbox and the match function will try to match the user input in column A but if it not matched, then it would try to match it in column B and return the match row. </p>\n\n<p>However, the matching will only work either if I use <code>Dim userinput As Integer</code> and that would be able to match in column A only; or use <code>Dim userinput As String</code> and that would be able to match it in column B only. Declaring <code>Dim userinput As Variant</code> would work just similar to <code>Dim userinput As String</code>. </p>\n\n<p>I could do some workaround but I would like to understand first why it is not able to match it in column A when declaring it as Variant?</p>\n\n<p>Following is the data I have in columns A and B, respectively. </p>\n\n<pre><code>W   WB\n25  25_0\n25  25_1\n25  25_2\n25  25_2\n25  25_3\n25  25_3\n25  25_3\n26  26_0\n26  26_0\n26  26_0\n26  26_1\n26  26_1\n</code></pre>\n\n<p>Following is the code: </p>\n\n<pre><code>Sub Return_Row()\nDim userinput As Variant, search_rng As Range\n\nuserinput = InputBox(\"Enter your number\")\n\nSet search_rng = ActiveSheet.Range(\"A:A\")\n\nOn Error Resume Next\nN = Application.WorksheetFunction.Match(userinput, search_rng, 0)\nOn Error GoTo 0\n\nIf N = 0 Then\n    Set search_rng = ActiveSheet.Range(\"B:B\")\n    N = Application.WorksheetFunction.Match(userinput, search_rng, 0)\nEnd If\n\nMsgBox N\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "edited": false, "score": 0, "creation_date": 1539194698, "post_id": 52746207, "comment_id": 92417157, "body": "Try some formatting, the question is unreadable in this way."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1539195884, "post_id": 52746207, "comment_id": 92417713, "body": "<a href=\"https://stackoverflow.com/questions/483813/modify-embedded-excel-workbook-in-word-document-via-vba\">This</a> could get you started"}, {"owner": {"reputation": 1259, "user_id": 4565439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c113834d5f883c5ad2cf161a29d66262?s=128&d=identicon&r=PG", "display_name": "EdHayes3", "link": "https://stackoverflow.com/users/4565439/edhayes3"}, "edited": false, "score": 0, "creation_date": 1539196823, "post_id": 52746207, "comment_id": 92418146, "body": "Why are you getting data from a word-embedded Excel file, and putting it into another file? Maybe you could do the reverse? Or maybe your time could be better spend replacing this solution with something more robust that doesn&#39;t rely on Office documents and VBA scripts."}, {"owner": {"reputation": 11, "user_id": 10485660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ca1b00ed7db169bad119b807193cd?s=128&d=identicon&r=PG&f=1", "display_name": "holdemfoldem081", "link": "https://stackoverflow.com/users/10485660/holdemfoldem081"}, "edited": false, "score": 0, "creation_date": 1539704879, "post_id": 52746207, "comment_id": 92594664, "body": "Thanks for replies everyone. For replies to some of the posts please see below. I&#39;ve been trying some of the code examples that were referenced, but they refer to the active document, which is not the doc I need to access. Rather, from within the active document, (vba code written in an excel spreadsheet), I need to access a spreadsheet that&#39;s   embedded inside a word doc. Any additional help appreciated. Ok, on to answers to above replies:Sorry about formatting. I just typed it in and hit &quot;enter&quot; at the end of each line will do better next time. As"}, {"owner": {"reputation": 11, "user_id": 10485660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ca1b00ed7db169bad119b807193cd?s=128&d=identicon&r=PG&f=1", "display_name": "holdemfoldem081", "link": "https://stackoverflow.com/users/10485660/holdemfoldem081"}, "edited": false, "score": 0, "creation_date": 1539705055, "post_id": 52746207, "comment_id": 92594789, "body": "to why I&#39;m having to process data from a spreadsheet that&#39;s embedded in a word doc in the first place, I&#39;m stuck with it cuz that&#39;s the way our dept is going to be given the data and we just have to live with it. :( Anyway thanks again all and any help appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1540658140, "creation_date": 1540658140, "answer_id": 53024077, "question_id": 52746207, "link": "https://stackoverflow.com/questions/52746207/storing-data-from-a-worksheet-embedded-in-ms-word/53024077#53024077", "title": "Storing data from a worksheet embedded in MS Word", "body": "<p>This will import data from all tables in all Word files in a folder.  This is just a small sample of what can be done with COM for Word and Excel (run the code from Excel).</p>\n\n<pre><code>Sub WordToExcel()\nDim wdApp As Word.Application\nDim wdDoc As Word.Document\nDim x As Integer\nDim strFilename As String\nDim strFolder As String\nDim temp As String\n\nSet wdApp = New Word.Application\n'initialise counter\nx = 1\n'search for first file in directory\nstrFolder = \"C:\\test\\\"\nstrFilename = Dir(strFolder &amp; \"*.doc\")\n'amemd folder name\nDo While strFilename &lt;&gt; \"\"\nSet wdDoc = wdApp.Documents.Open(strFolder &amp; strFilename)\ntemp = wdDoc.Tables(1).Cell(2, 1).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 0) = temp\ntemp = wdDoc.Tables(1).Cell(2, 2).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 1) = temp\n'etc\ntemp = wdDoc.Tables(1).Cell(2, 3).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 2) = temp\ntemp = wdDoc.Tables(1).Cell(2, 4).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 3) = temp\n\nwdDoc.Close\nx = x + 1\nstrFilename = Dir\nLoop\nwdApp.Quit\nSet wdDoc = Nothing\nSet wdApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10485660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ca1b00ed7db169bad119b807193cd?s=128&d=identicon&r=PG&f=1", "display_name": "holdemfoldem081", "link": "https://stackoverflow.com/users/10485660/holdemfoldem081"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540658140, "creation_date": 1539194355, "last_edit_date": 1539197584, "question_id": 52746207, "link": "https://stackoverflow.com/questions/52746207/storing-data-from-a-worksheet-embedded-in-ms-word", "title": "Storing data from a worksheet embedded in MS Word", "body": "<p>I am new to this board. I have searched through past answers to various questions related to mine but have not succeeded in finding a solution to my problem.</p>\n\n<p>What I need to do is:\n1) Using vba/vb within an Excel doc, locate an Excel spreadsheet which is embedded in a Word doc.\n2) Read data from its cells.\n3) Store that data in the cells of the current Excel doc.</p>\n\n<p>I have been able to locate the embedded Excel spreadsheet but can't see how to get it's data into the current spreadsheet's cells. Here's the code by which I have located the embedded spreadsheet:</p>\n\n<pre><code>Sub GetWordata()\n\n  Dim objWord As Object\n  Set objWord = CreateObject(\"Word.Application\")\n  Dim singleLine As Paragraph\n  Dim lineText As String\n  Dim word_app As word.Application\n  Dim wDoc As word.Document\n  Dim r As Integer\n  Dim i As Long, Rng As Range\n  Dim Evalue As String\n.\n.\n.\n  With activeDocument\n    For i = .InlineShapes.Count To 1 Step -1\n      With .InlineShapes(i)\n        If Not .OLEFormat Is Nothing Then\n          If Split(.OLEFormat.ClassType, \".\")(0) = \"Excel\" Then\n            MsgBox \"Excel File\"\n          End If\n        End If\n      End With\n    Next\n  End With\n</code></pre>\n\n<p>The message box in the code above displays, indicating that I have located the embedded spreadsheet.</p>\n\n<p>Thanks ahead for any help.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 4, "creation_date": 1539192974, "post_id": 52745865, "comment_id": 92416421, "body": "No, that&#39;s not possible at all."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1539193434, "post_id": 52745865, "comment_id": 92416624, "body": "Sounds like this would be better handled by <a href=\"https://stackoverflow.com/q/3014421/4088852\">a control array</a>."}, {"owner": {"reputation": 21, "user_id": 10479739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ea55751924a117fcc7b4dc28ec77eb?s=128&d=identicon&r=PG&f=1", "display_name": "fredrandal", "link": "https://stackoverflow.com/users/10479739/fredrandal"}, "edited": false, "score": 0, "creation_date": 1539196570, "post_id": 52745865, "comment_id": 92418023, "body": "Thanks -Comintern I&#39;ll take a look"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1539197242, "post_id": 52745865, "comment_id": 92418338, "body": "Not quite clear what you&#39;re asking here - do you mean you want to add lots of comboboxes that have the same code, or you want the same piece of code to run but with the combobox passed in as a variable?"}, {"owner": {"reputation": 21, "user_id": 10479739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ea55751924a117fcc7b4dc28ec77eb?s=128&d=identicon&r=PG&f=1", "display_name": "fredrandal", "link": "https://stackoverflow.com/users/10479739/fredrandal"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1539209529, "post_id": 52745865, "comment_id": 92423332, "body": "I tried clarifying my question by adding more details, thanks @Absinthe"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1539240924, "post_id": 52745865, "comment_id": 92431379, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47298349/making-modular-vba-function-ms-access\">Making modular VBA function (MS Access)</a>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1539241050, "post_id": 52745865, "comment_id": 92431453, "body": "You wouldn&#39;t want such repeated code. It is much cleaner to use <i>WithEvents</i> - it takes a little to get started with, but it pays off in the long run."}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1539265388, "creation_date": 1539265388, "answer_id": 52761630, "question_id": 52745865, "link": "https://stackoverflow.com/questions/52745865/is-it-possible-to-incorporate-a-private-sub-into-a-function-in-vba-access/52761630#52761630", "title": "Is it possible to incorporate a private sub into a function in VBA access?", "body": "<p>I'd probably suffix my comboboxes with a number and use use their <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.caller\" rel=\"nofollow noreferrer\">Caller</a> property to provide the parameter you want via their string name. E.G. create 3 comboboxes and call them cbo_1, cbo_2, and cbo_3. Then assign a single sub to them:</p>\n\n<pre><code>Sub CboHasChanged()\n\nDim cboNumber As Integer\n\nMsgbox Application.Caller &amp; \" is about to call the sub SqlDes!\", vbinformation\ncboNumber = CInt(Right(Application.Caller, 1))\nSqlDes cboNumber\n\nEnd Sub\n</code></pre>\n\n<p>You can make the string manipulation more complicated of course, to account for numbers with double digits and so on but I hope you get the idea - use the name of the combobox to provide the required value. </p>\n\n<p>By the way, you don't need to Call your sub like that, just put the sub name then any parameters without brackets, as I've done in the example.</p>\n\n<p>If you really want to write code with code <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">it is possible in VBA</a> but is an advanced topic.</p>\n"}], "owner": {"reputation": 21, "user_id": 10479739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ea55751924a117fcc7b4dc28ec77eb?s=128&d=identicon&r=PG&f=1", "display_name": "fredrandal", "link": "https://stackoverflow.com/users/10479739/fredrandal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594627407, "creation_date": 1539192890, "last_edit_date": 1594627407, "question_id": 52745865, "link": "https://stackoverflow.com/questions/52745865/is-it-possible-to-incorporate-a-private-sub-into-a-function-in-vba-access", "title": "Is it possible to incorporate a private sub into a function in VBA access?", "body": "<p>Basically I would like to use a function or sub to \"paste\" code so that I don't have to paste the same thing over and over again.  I'm kinda new with VBA so I'm not sure if there's an easier way to handle this.  I have many rows of combo boxes that will be determined by their corresponding text box in front of them. I would like to just place a function/subroutine with a number to designate the combo box. </p>\n\n<pre><code>Function cboAfterUpdate (x as Variant)\n    Private Sub cboOperation &amp;x&amp; _AfterUpdate()\n     'some other function that uses x'\n    End Sub\n End Funcion\n</code></pre>\n\n<p>I'm hoping it'll end like this...</p>\n\n<pre><code> cboAfterUpdate(5)\n</code></pre>\n\n<p>Will show..</p>\n\n<pre><code> Private Sub cboOperation5_AfterUpdate()\n   'some other function that uses 5'\n End Sub\n</code></pre>\n\n<p>In other words I'd like to do this</p>\n\n<pre><code>Private Sub cboOperation1_AfterUpdate()\nCall SqlDes(1)\nEnd Sub\nPrivate Sub cboOperation2_AfterUpdate()\nCall SqlDes(2)\nEnd Sub\nPrivate Sub cboOperation3_AfterUpdate()\nCall SqlDes(3)\nEnd Sub\n</code></pre>\n\n<p>up to 20 times since I have cboOperation(1-20) combo boxes.  How can I do that in one function without having to have to copy/paste/type 20 private sub events? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539250146, "post_id": 52745015, "comment_id": 92436534, "body": "Any solution regarding this cause I&#39;m really blocked"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539205324, "post_id": 52746433, "comment_id": 92421923, "body": "I tried this but it says Variable or object not defined  error  in this line &quot; ActiveChart.SeriesCollection(1).Points(i)&quot;"}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "edited": false, "score": 0, "creation_date": 1539206255, "post_id": 52746433, "comment_id": 92422256, "body": "What is the error code? Also, is the error on this line <code>Set cl = ActiveChart.SeriesCollection(1).Points(i)</code>, or is there a different line now with just <code>ActiveChart.SeriesCollection(1).Points(i)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539206434, "post_id": 52746433, "comment_id": 92422320, "body": "error is all  ActiveChart.SeriesCollection(1).Points(i)  see link <a href=\"https://i.postimg.cc/W19j1t1j/bcda.png\" rel=\"nofollow noreferrer\">i.postimg.cc/W19j1t1j/bcda.png</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539206464, "post_id": 52746433, "comment_id": 92422327, "body": "both lines in blue"}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "edited": false, "score": 0, "creation_date": 1539208057, "post_id": 52746433, "comment_id": 92422855, "body": "It sounds like you may have made a change to the chart, which introduced a new error. Apparently this part of your code still works: <code>ActiveChart.SeriesCollection(1).Values</code>, which means the problem is not with the portion <code>ActiveChart.SeriesCollection(1)</code>. It seems to be specific to the part that calls <code>.Points(i)</code>. Are there still points in the chart?"}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "edited": false, "score": 0, "creation_date": 1539264382, "post_id": 52746433, "comment_id": 92445427, "body": "What is the value of <code>i</code> in <code>Point(i)</code> when you get the error? Also, what is the exact error code (i.e. error number)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539264872, "post_id": 52746433, "comment_id": 92445732, "body": "There is no error but It&#39;s not pointing to the head of that highlighted Chart in that image red circle ......the problem that when the x(i) is &lt;1 then an arrow is created and go the right chart then point the right position like that image"}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "edited": false, "score": 0, "creation_date": 1539267228, "post_id": 52746433, "comment_id": 92447493, "body": "So you&#39;re saying there is no error now, but there is still a problem with the way the arrows are being drawn. Are all of the arrows converging at one point (i.e. 579, 131.25)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539267288, "post_id": 52746433, "comment_id": 92447548, "body": "yes and I need them to move according to the graph where x(i) &lt;1"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539290051, "post_id": 52746433, "comment_id": 92459770, "body": "can I ask  when Last question ? it worked perfectly and i will accept it  but is there away that I can add text to that arrow  for e.g the  the arrow is pointing and  says a specific text <a href=\"https://i.postimg.cc/6q19XJnB/3212.png\" rel=\"nofollow noreferrer\">i.postimg.cc/6q19XJnB/3212.png</a>"}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "edited": false, "score": 0, "creation_date": 1539291044, "post_id": 52746433, "comment_id": 92460158, "body": "Great, I&#39;m glad it worked for you! Please go ahead and accept the answer since it answers the scope of your original problem, and I&#39;ll see what I can find about labels."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539340722, "post_id": 52746433, "comment_id": 92476999, "body": "Any news Ken ? *"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1539512685, "post_id": 52746433, "comment_id": 92522127, "body": "ken I get an error in this line    .Position = xlLabelPositionAbove"}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "edited": false, "score": 1, "creation_date": 1539607557, "post_id": 52746433, "comment_id": 92551423, "body": "You can comment-out or delete the line <code>.Position = xlLabelPositionAbove</code>. It gets overridden later when setting <code>.Top</code>."}], "tags": [], "owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "is_accepted": true, "score": 0, "last_activity_date": 1539350981, "last_edit_date": 1539350981, "creation_date": 1539195263, "answer_id": 52746433, "question_id": 52745015, "link": "https://stackoverflow.com/questions/52745015/link-connectors-to-chartpoint-vba/52746433#52746433", "title": "Link Connectors to ChartPoint VBA", "body": "<pre><code>Public Sub fzerfgsdf()\n    '\n    ' fzerfgsdf Macro\n    '\n    Dim ws As Excel.Worksheet\n    Dim chrt As Excel.Chart\n    Dim sries As Excel.Series\n    Dim x As Variant\n    Dim clLeft As Double, clTop As Double\n    Dim clWidth As Double, clHeight As Double\n    Dim clBeginX As Double, clBeginY As Double, clEndX As Double, clEndY As Double\n    Dim cl As Excel.Point\n    Dim shpOval As Excel.Shape\n    Dim dl As Excel.DataLabel\n    Dim i As Long\n\n    clHeight = 30\n    clWidth = 15\n\n    Set ws = Application.ActiveSheet\n    Set chrt = ws.ChartObjects(\"Graphique 69\").Chart\n    Set sries = chrt.SeriesCollection(1)\n    x = sries.Values\n    For i = LBound(x) To UBound(x)\n        Debug.Print \"Point \"; i; \"=\"; x(i)\n        If (x(i) &lt; 1) And (x(i) &lt;&gt; 0) Then\n            Set cl = sries.Points(i)\n            With chrt.ChartArea\n                clBeginX = IIf(.Left + cl.Left - clWidth &lt; 0, 0, .Left + cl.Left - clWidth)\n                clBeginY = IIf(.Top + cl.Top - clHeight &lt; 0, 0, .Top + cl.Top - clHeight)\n                clEndX = .Left + cl.Left\n                clEndY = .Top + cl.Top\n            End With\n\n            Set shpOval = ws.Shapes.AddConnector(msoConnectorStraight, clBeginX, clBeginY, clEndX, clEndY)\n            shpOval.Line.EndArrowheadStyle = msoArrowheadOpen\n            shpOval.ShapeStyle = msoLineStylePreset20\n\n            cl.HasDataLabel = True\n            sries.HasLeaderLines = False\n            Set dl = cl.DataLabel\n            With dl\n                .Text = \"RFT 93%=&gt; 5P\"\n                .Position = xlLabelPositionAbove\n                .Format.AutoShapeType = msoShapeRectangularCallout\n                .Format.Line.Visible = msoFalse\n                .Top = cl.Top - clHeight - .Height - 5\n                .Left = cl.Left - clWidth - (.Width / 2)\n                With .Format.TextFrame2.TextRange.Font\n                    .Size = 12\n                    .Fill.ForeColor.RGB = RGB(255, 0, 0)\n                    .Bold = msoTrue\n                End With\n            End With\n        End If\n    Next\n\n    Set shpOval = Nothing\n    Set cl = Nothing\n    Set sries = Nothing\n    Set chrt = Nothing\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 52746433, "answer_count": 1, "score": 0, "last_activity_date": 1539350981, "creation_date": 1539189507, "last_edit_date": 1592644375, "question_id": 52745015, "link": "https://stackoverflow.com/questions/52745015/link-connectors-to-chartpoint-vba", "title": "Link Connectors to ChartPoint VBA", "body": "<p>I created a macro that add an arrow to chartPoint if value of that point is under 1  and different from 0<br />\nThe code works perfectly but When Itry to create The Arrow I get an error &quot;Object Required&quot; and I didn't manage to select the head of that shape and create arrow there .</p>\n<p>What I'm trying to do is described in the Image below\n<a href=\"https://i.stack.imgur.com/0I6wl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0I6wl.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/wNhwD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wNhwD.png\" alt=\"enter image description here\" /></a></p>\n<p>The code of Verifying Result and Add arrow is below</p>\n<pre><code>Sub fzerfgsdf()\n '\n '    fzerfgsdf Macro\n '\n\nDim clLeft As Double\nDim clTop As Double\nDim clWidth As Double\nDim clHeight As Double\n\nDim cl As Range\nDim shpOval As Shape\n\nActiveSheet.ChartObjects(&quot;Graphique 69&quot;).Activate\nx = ActiveChart.SeriesCollection(1).Values\nFor i = LBound(x) To UBound(x)\n  Debug.Print &quot;Point &quot;; i; &quot;=&quot;; x(i)\n  If x(i) &lt; 1 And x(i) &lt;&gt; 0 Then\n    ActiveChart.SeriesCollection(1).Points(i).Select\n\n\n    Set cl = ActiveChart.SeriesCollection(1).Points(i).Select  '&lt;-- Range(&quot;C2&quot;)\n\n    clLeft = cl.Left\n    clTop = cl.Top\n    clHeight = 131.25\n    clWidth = 579\n\n    Set shpOval = ActiveSheet.Shapes.AddConnector(msoConnectorStraight, clLeft, clTop, 579, 131.25)\n    shpOval.Select\n    selection.ShapeRange.Line.EndArrowheadStyle = msoArrowheadOpen\n    selection.ShapeRange.ShapeStyle = msoLineStylePreset20\n  End If\nNext i\nEnd Sub\n</code></pre>\n<p>I found solution for first problem which is creating shape  but I can't figure out how to locate that shape in the right place where the blue chart using a specific values see image</p>\n<pre><code>Sub fzerfgsdf()\n '\n' fzerfgsdf Macro\n '\nActiveSheet.ChartObjects(&quot;Graphique 69&quot;).Activate\n x = ActiveChart.SeriesCollection(1).Values\nFor i = LBound(x) To UBound(x)\nDebug.Print &quot;Point &quot;; i; &quot;=&quot;; x(i)\nIf x(i) &lt; 1 And x(i) &lt;&gt; 0 Then\nActiveSheet.ChartObjects(&quot;Graphique 69&quot;).Activate\n  ActiveChart.SeriesCollection(1).Points(i).Select\nDim clLeft As Double\nDim clTop As Double\nDim clWidth As Double\nDim clHeight As Double\n\nDim cl As Point\nDim shpOval As Shape\n\nSet cl = ActiveChart.SeriesCollection(1).Points(i)  '&lt;-- Range(&quot;C2&quot;)\n\nclLeft = cl.Left\n clTop = cl.Top\n clHeight = 131.25\n clWidth = 579\n\n  Set shpOval = ActiveSheet.Shapes.AddConnector(msoConnectorStraight, \n  clLeft, \n   clTop, 579, 131.25)\n   shpOval.Select\n   selection.ShapeRange.Line.EndArrowheadStyle = msoArrowheadOpen\n  selection.ShapeRange.ShapeStyle = msoLineStylePreset20\n  End If\n Next i\n End Sub\n</code></pre>\n<p>Could Anyone light in solving This ?</p>\n<p>Best Regards\nPolos</p>\n"}, {"tags": ["excel", "vba", "shapes", "right-align"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539189890, "post_id": 52744891, "comment_id": 92414808, "body": "Please post the code you&#39;ve tried and any error messages etc."}, {"owner": {"reputation": 79, "user_id": 9458879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9S4yg.png?s=128&g=1", "display_name": "QFarley", "link": "https://stackoverflow.com/users/9458879/qfarley"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539190647, "post_id": 52744891, "comment_id": 92415230, "body": "There&#39;s no one version of added code -I&#39;ve tried a bunch of different things.  I know that makes helping me here much more open-ended, but that&#39;s the nature of my request -general or specific guidance on the VBA code structure on how I could do this."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539190990, "post_id": 52744891, "comment_id": 92415398, "body": "That&#39;s not really how the site works so your question might be closed. Basically I think you have to set the left property of the shape as the left property of the cell minus the width of the shape."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9458879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9S4yg.png?s=128&g=1", "display_name": "QFarley", "link": "https://stackoverflow.com/users/9458879/qfarley"}, "edited": false, "score": 0, "creation_date": 1539189504, "post_id": 52744945, "comment_id": 92414560, "body": "Thank you for responding.  Yes, it was that MS webpage where I got the idea to try msoAlignRight, but I just couldn&#39;t get the syntax right in translating their brief example to my script."}], "tags": [], "owner": {"reputation": 1, "user_id": 8611860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fcac3aea0f3182e7dbec9f0320954ef?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Singh Chauhan", "link": "https://stackoverflow.com/users/8611860/prashant-singh-chauhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1539189245, "creation_date": 1539189245, "answer_id": 52744945, "question_id": 52744891, "link": "https://stackoverflow.com/questions/52744891/align-right-edge-of-shape-to-left-edge-of-target-cell/52744945#52744945", "title": "Align right edge of shape to left edge of target cell", "body": "<p>Have you tried ShapeRange's Align method for that. Like you said, you want to align right edge of your source shape to left edge of target shape. As described in <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.shaperange.align\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/word.shaperange.align</a>, this can be done using this method.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 9458879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9S4yg.png?s=128&g=1", "display_name": "QFarley", "link": "https://stackoverflow.com/users/9458879/qfarley"}, "edited": false, "score": 0, "creation_date": 1539202147, "post_id": 52745560, "comment_id": 92420552, "body": "This code was perfect!  Thank you so very much.  Question resolved. :)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1539191700, "creation_date": 1539191700, "answer_id": 52745560, "question_id": 52744891, "link": "https://stackoverflow.com/questions/52744891/align-right-edge-of-shape-to-left-edge-of-target-cell/52745560#52745560", "title": "Align right edge of shape to left edge of target cell", "body": "<p>Here is an illustration:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nDim s As Shape\n\nSet s = ActiveSheet.Shapes(\"Rectangle 1\")\n\nIf Target.Address = \"$G$10\" Then\n    With s\n        .Visible = True\n        .Left = Target.Left - s.Width - 10\n        .Top = Target.Top + (Target.Height - s.Height) / 2\n    End With\nElse\n    s.Visible = False\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wgN5Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wgN5Y.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 79, "user_id": 9458879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9S4yg.png?s=128&g=1", "display_name": "QFarley", "link": "https://stackoverflow.com/users/9458879/qfarley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 52745560, "answer_count": 2, "score": 0, "last_activity_date": 1575552843, "creation_date": 1539188997, "last_edit_date": 1575552843, "question_id": 52744891, "link": "https://stackoverflow.com/questions/52744891/align-right-edge-of-shape-to-left-edge-of-target-cell", "title": "Align right edge of shape to left edge of target cell", "body": "<p>I have a well working VBA script that when a target cell with the value, \"Click to Learn More\" is clicked, a corresponding informational pop-up shape is made visible.</p>\n\n<p>My hope is that I'll be able to add code that realigns the shape's right edge to the target cell's left edge, preferrably centered vertically as with the screenshot example. I've tried some suggestions using msoAlignRight, but I'm not enough of a VBA expert yet to know the right syntax -if that's even the right way of doing this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0DQaa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0DQaa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks for any suggestions!</p>\n\n<p>(The name of the corresponding shape is assigned to the variable, \"ImgName\", and the \"Click for More Information\" cell is the Target cell.)</p>\n"}, {"tags": ["excel", "vba", "ado"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1539188081, "post_id": 52744553, "comment_id": 92413731, "body": "A data type mismatch means you&#39;re trying to put data into the column that does not match the column&#39;s data type.  You can figure out which column it is using the debugger to step through your <code>for</code> loop until you reach the field that causes the error. We don&#39;t have your spreadsheet or your table to use to do that for you, so you&#39;ll need to do it yourself."}, {"owner": {"reputation": 9, "user_id": 10154421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XLbalmMU5Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qAQyUGsENECiELnGLyf766seakzw/mo/photo.jpg?sz=128", "display_name": "Joji5566", "link": "https://stackoverflow.com/users/10154421/joji5566"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1539188301, "post_id": 52744553, "comment_id": 92413852, "body": "Thanks Ken! Still quite new to VBA, apologies for the very basic question"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1539188396, "post_id": 52744553, "comment_id": 92413902, "body": "No problem. :-) When you figure out which field is causing the issue, you should be able to tell what&#39;s causing the mismatch. If not, you can ask here and we&#39;ll try to help figure it out."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1539188694, "post_id": 52744553, "comment_id": 92414073, "body": "Aside - This is a quintessential reason to use Excel only as the end use application (i.e., graphing/reporting) and not as data source for database. Access as a database maintains strict data type rules while Excel <i>anything</i> can be written in <i>any</i> cell! Consider using Access datasheet forms that resemble spreadsheets and will warn user of wrong input."}, {"owner": {"reputation": 9, "user_id": 10154421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XLbalmMU5Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qAQyUGsENECiELnGLyf766seakzw/mo/photo.jpg?sz=128", "display_name": "Joji5566", "link": "https://stackoverflow.com/users/10154421/joji5566"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1539189669, "post_id": 52744553, "comment_id": 92414668, "body": "Hi @KenWhite I used the Debugger and stepped through the first row (row 2) of the for clause from i=1 to i=35 and there did not seem to be any issues with that (all i values were ok)  i added in ERL into the error message box and it didnt state the name of the line with the error. Not sure what I should do as my next step"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1539189955, "post_id": 52744553, "comment_id": 92414849, "body": "It could be the first row, or the third row, or the 400th row. You could always look at the table to get a list of the data types for each column, and then visually scan the data for something out of place (e.g., finding <i>ABCD</i> in a spreadsheet column being assigned to a database column of type <i>Integer</i> or <i>Date</i>). And @Parfait is absolutely correct - if you stop trying to use Excel as your data entry tool and instead properly create an Access form that can validate the data as it is entered, you won&#39;t have these issues."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1539196589, "post_id": 52744553, "comment_id": 92418035, "body": "Please comment out &quot;On Error GoTo errorhandler:&quot; by putting an apostrophe before the line to disable your error handling, then run the code. When the error happens click Debug and tell us what line is highlighted."}, {"owner": {"reputation": 9, "user_id": 10154421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XLbalmMU5Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qAQyUGsENECiELnGLyf766seakzw/mo/photo.jpg?sz=128", "display_name": "Joji5566", "link": "https://stackoverflow.com/users/10154421/joji5566"}, "edited": false, "score": 0, "creation_date": 1539247204, "post_id": 52744553, "comment_id": 92434648, "body": "Hi Guys, thanks for your help and yes I understand that this would be better if it was all in access. (its excel based because i inherited an excel based form that I havent been able to pick apart). The issue was that the next row function was going to row 13 even when there was only 9 rows with data. This seemed to cause the error. This is now fixed :) Thanks for showing me how to use debugger!"}], "owner": {"reputation": 9, "user_id": 10154421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XLbalmMU5Xk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qAQyUGsENECiELnGLyf766seakzw/mo/photo.jpg?sz=128", "display_name": "Joji5566", "link": "https://stackoverflow.com/users/10154421/joji5566"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539187975, "creation_date": 1539187785, "last_edit_date": 1539187975, "question_id": 52744553, "link": "https://stackoverflow.com/questions/52744553/type-mismatch-error-in-ado-export-from-excel-to-access", "title": "Type Mismatch. Error in ADO export from Excel to Access", "body": "<p>I'm currently using VBA to transfer data to an access database from excel.</p>\n\n<p>I am able to run the code below to transfer the data from my 35 column excel table into my 35 column access table but I receive this error every time I do. I did not receive this error prior to it being 35 columns. Please could you explain where I am building in this error?</p>\n\n<p><a href=\"https://i.stack.imgur.com/xWqtX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xWqtX.png\" alt=\"Error Description\"></a></p>\n\n<pre><code>   Sub CopyDatatoAccess()\n    Dim DatabaseConn As ADODB.Connection\n    Dim DatabaseData As ADODB.Recordset\n    Dim Pathway\n    Dim x As Long, i As Long\n    Dim nextrow As Long\n\n    On Error GoTo errorhandler:\n\n    Pathway = Sheet18.Range(\"AP2\").Value\n    nextrow = Sheet18.Cells(Rows.Count, 1).End(xlUp).Row\n\n\n    Set DatabaseConn = New ADODB.Connection\n\n    If Sheet18.Range(\"A2\").Value = \"\" Then\n    MsgBox \"ARF form is not present for Upload\"\n    Exit Sub\n    End If\n\n    DatabaseConn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Pathway\n\n    Set DatabaseData = New ADODB.Recordset\n\nDatabaseData.Open Source:=\"ARFs\", _\n    ActiveConnection:=DatabaseConn, _\n    CursorType:=adOpenDynamic, _\n    LockType:=adLockOptimistic, _\n    Options:=adCmdTable\n\nFor x = 2 To nextrow\n    DatabaseData.AddNew\n    For i = 1 To 35\n        DatabaseData(Cells(1, i).Value) = Sheet18.Cells(x, i).Value\n        Next i\n        DatabaseData.Update\n    Next x\n\n    DatabaseData.Close\n    DatabaseConn.Close\n\n    Set DatabaseData = Nothing\n    Set DatabaseConn = Nothing\n\nMsgBox \"The ARF is now uploaded\"\nApplication.ScreenUpdating = True\n\n\n   On Error GoTo 0\n   Exit Sub\nerrorhandler:\n\n    Set DatabaseData = Nothing\n    Set DatabaseConn = Nothing\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Export_Data\"\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1539188314, "post_id": 52744524, "comment_id": 92413858, "body": "Use <code>Power Query</code> (aka <code>Get&amp;Transform</code> in Excel 2016+) to unpivot the <code>Amount</code> columns"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1539190061, "post_id": 52744524, "comment_id": 92414913, "body": "Unpivotting is also availabe in older XL versions if that is what you have. Just search on the term and you&#39;ll find a slew of help."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10485179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f446ac5c6580a870b5d75f92c54e8b?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/10485179/akash"}, "edited": false, "score": 0, "creation_date": 1539242001, "post_id": 52750083, "comment_id": 92431909, "body": "Thanks a lot for the answer! Great use of array. How would you modify if my number amount columns are not fixed, can vary more than 3? Also Header1-3 could vary, like Header1-6"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 13, "user_id": 10485179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f446ac5c6580a870b5d75f92c54e8b?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/10485179/akash"}, "edited": false, "score": 0, "creation_date": 1539353342, "post_id": 52750083, "comment_id": 92484008, "body": "The main principle is always the same: determine the initial range, paste the range into a variant (initial array), determine the size of the resulting array, while looping through the initial array perform calculation and write the results to the resulting array, determine the size of the resulting range and paste the resulting array into the resulting range. The difference: You have to find the row and column of the start of the headers, then you loop through the row and determine the last column. Then the same for &#39;X&#39; -Amounts. If you allow empty columns you have to add another variant..."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10485179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f446ac5c6580a870b5d75f92c54e8b?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/10485179/akash"}, "edited": false, "score": 0, "creation_date": 1539365398, "post_id": 52750083, "comment_id": 92490187, "body": "@akash Don&#39;t forget to mark the post as solved if you think this solved your problem. It&#39;s appreciated as it as it shows everyone else that this is solved and give the person who answered some credit he deserves. Take care :)"}, {"owner": {"reputation": 13, "user_id": 10485179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f446ac5c6580a870b5d75f92c54e8b?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/10485179/akash"}, "edited": false, "score": 0, "creation_date": 1539436655, "post_id": 52750083, "comment_id": 92507057, "body": "Thanks again for the clarity!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1539213954, "creation_date": 1539213954, "answer_id": 52750083, "question_id": 52744524, "link": "https://stackoverflow.com/questions/52744524/copy-from-range-and-append-below-vba-macro/52750083#52750083", "title": "Copy from range and append below VBA macro", "body": "<h1>From Range1 to Array1 to Array2 to Range2</h1>\n\n<h2>The Array - fast as lightning.</h2>\n\n<pre><code>Sub CopyAppendData()\n\n'-- Customize BEGIN --------------------\n  Const cStrCell As String = \"A1\" 'Initial data starting cell range\n  Const cIntEmpty As Integer = 1 'Empty rows between initial and resulting range\n  Const cStrCol4 As String = \"New Formatted Amt\" 'Title of 4th resulting column\n  Const cStrCol5 As String = \"Amount\" 'Title of 5th resulting column\n'-- Customize END ----------------------\n\n  Const cIntColIn As Integer = 6 'Number of columns of initial data\n  Const cIntColRs As Integer = 5 'Number of columns of resulting data\n''''''''''''''''''''''''''''''''''''''''\n  Dim oRngIn As Range\n  Dim oRngRs As Range\n''''''''''''''''''''''''''''''''''''''''\n  Dim arrIn As Variant\n  Dim arrRs() As Variant\n''''''''''''''''''''''''''''''''''''''''\n  Dim loRowIn1 As Long\n  Dim loRowIn2 As Long\n  Dim iColIn1 As Integer\n  Dim iColIn2 As Integer\n''''''''''''''''''''''''''''''''''''''''\n  Dim loRowRs1 As Long\n  Dim loRowRs2 As Long\n  Dim iColRs1 As Integer\n  Dim iColRs2 As Integer\n''''''''''''''''''''''''''''''''''''''''\n  Dim i As Integer\n  Dim j As Integer\n  Dim k As Integer\n  Dim str1 As String\n''''''''''''''''''''''''''''''''''''''''\n  'Calculating data for the initial range/array.\n  loRowIn1 = Range(cStrCell).Row\n  iColIn1 = Range(cStrCell).Column\n  iColIn2 = Range(cStrCell).Column + cIntColIn - 1\n  loRowIn2 = Columns(iColIn1).End(xlUp).Row\n  loRowIn2 = Cells(Rows.Count, iColIn1).End(xlUp).Row\n  Set oRngIn = Range(Cells(loRowIn1, iColIn1), Cells(loRowIn2, iColIn2))\n\n'  Debug.Print oRngIn.Address\n\n''''''''''''''''''''''''''''''''''''''''\n  'Paste initial range into initial array\n  arrIn = oRngIn\n\n'  str1 = \"Initial Array\" &amp; vbCrLf\n'  For i = LBound(arrIn) To UBound(arrIn)\n'    str1 = str1 &amp; vbCrLf\n'    For j = LBound(arrIn, 2) To UBound(arrIn, 2)\n'      str1 = str1 &amp; Chr(9) &amp; arrIn(i, j)\n'    Next\n'  Next\n'  Debug.Print str1\n\n''''''''''''''''''''''''''''''''''''''''\n  'Populate resulting array\n  ReDim arrRs(1 To (loRowIn2 - loRowIn1) * 3 + 1, 1 To cIntColRs)\n  'Header (1st row)\n  For i = 1 To 3: arrRs(1, i) = arrIn(1, i): Next\n  arrRs(1, 4) = cStrCol4: arrRs(1, 5) = cStrCol5\n  'Data\n  For k = 0 To 2\n    For j = 1 To 3\n      For i = 2 To UBound(arrIn)\n        arrRs((loRowIn2 - loRowIn1) * k + i, j) = arrIn(i, j)\n        arrRs((loRowIn2 - loRowIn1) * k + i, 4) = arrIn(1, 4 + k)\n        arrRs((loRowIn2 - loRowIn1) * k + i, 5) = arrIn(i, k + 4)\n      Next\n    Next\n  Next\n\n'  str1 = \"Resulting Array\" &amp; vbCrLf\n'  For i = LBound(arrRs) To UBound(arrRs)\n'    str1 = str1 &amp; vbCrLf\n'    For j = LBound(arrRs, 2) To UBound(arrRs, 2)\n'      str1 = str1 &amp; Chr(9) &amp; arrRs(i, j)\n'    Next\n'  Next\n'  Debug.Print str1\n\n''''''''''''''''''''''''''''''''''''''''\n  'Calculating data for the resulting range.\n  loRowRs1 = loRowIn2 + cIntEmpty + 1\n  loRowRs2 = loRowRs1 + (loRowIn2 - loRowIn1) * 3 '1 for resulting header\n  iColRs1 = iColIn1\n  iColRs2 = iColRs1 + cIntColRs - 1\n  Set oRngRs = Range(Cells(loRowRs1, iColRs1), Cells(loRowRs2, iColRs2))\n\n'  Debug.Print oRngRs.Address\n\n''''''''''''''''''''''''''''''''''''''''\n  'Paste resulting array into resulting range\n  oRngRs = arrRs\n\nEnd Sub\n</code></pre>\n\n<p>You can add some more rows:</p>\n\n<pre><code>Header1 Header2 Header3 S-Amount    P-Amount    Q-Amount\nAA      BB      CC      111         112         113\nAA1     BB1     CC1     222         223         224\nAA2     BB2     CC2     333         334         335\nAA3     BB3     CC3     444         445         446\nAA4     BB4     CC4     555         556         557\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10485179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f446ac5c6580a870b5d75f92c54e8b?s=128&d=identicon&r=PG&f=1", "display_name": "akash", "link": "https://stackoverflow.com/users/10485179/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 3, "accepted_answer_id": 52750083, "answer_count": 1, "score": 0, "last_activity_date": 1593695930, "creation_date": 1539187697, "last_edit_date": 1593695930, "question_id": 52744524, "link": "https://stackoverflow.com/questions/52744524/copy-from-range-and-append-below-vba-macro", "title": "Copy from range and append below VBA macro", "body": "<pre><code>Present Data                            \n                            \nHeader1 Header2 Header3         S-Amount    P-Amount    Q-Amount\nAA  BB  CC          111 112 113\nAA1 BB1 CC1         222 223 224\nAA2 BB2 CC2         333 334 335\n                            \n                            \n                            \n                            \n                            \nI want like below:                          \n                            \nHeader1 Header2 Header3 New Formatted Amt   Amount          \nAA  BB  CC  S-Amount    111         \nAA1 BB1 CC1 S-Amount    222         \nAA2 BB2 CC2 S-Amount    333         \nAA  BB  CC  P-Amount    112         \nAA1 BB1 CC1 P-Amount    223         \nAA2 BB2 CC2 P-Amount    334         \nAA  BB  CC  Q-Amount    113         \nAA1 BB1 CC1 Q-Amount    224         \nAA2 BB2 CC2 Q-Amount    335         \n</code></pre>\n<p>I want to use VBA macro to do the above reformatting of the data as shown. Can anyone give some suggestions!</p>\n"}, {"tags": ["excel", "vba", "loops", "collections"], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1539241706, "post_id": 52744829, "comment_id": 92431764, "body": "Right, to store the value is correct use c.value otherwise sys store only the address(), tnk"}], "tags": [], "owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "is_accepted": true, "score": 1, "last_activity_date": 1539188779, "creation_date": 1539188779, "answer_id": 52744829, "question_id": 52744509, "link": "https://stackoverflow.com/questions/52744509/popolate-collection-from-external-file-then-close-file-and-show-collection-ite/52744829#52744829", "title": "Popolate collection from external file, then close file, and show collection items", "body": "<p>Try <code>Belts.Add c.Value</code>, which will add the value in the cell to the collection as opposed to adding a reference to the range object to the collection. The value will still be available after the workbook is closed, as opposed to the reference which will no longer be available.</p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1539197628, "creation_date": 1539197628, "answer_id": 52746986, "question_id": 52744509, "link": "https://stackoverflow.com/questions/52744509/popolate-collection-from-external-file-then-close-file-and-show-collection-ite/52746986#52746986", "title": "Popolate collection from external file, then close file, and show collection items", "body": "<h1>Array version</h1>\n\n<p>Don't know much about collections but I think arrays is the way to go.</p>\n\n<pre><code>Option Explicit\nPublic Belts As Variant 'Public Belts As Collection\nPublic Sub mCaricaBelts()\nOn Error GoTo RigaErrore\n    Dim wb As Workbook, wbn As String\n    Dim sh As Worksheet\n    Dim rng As Range\n    Dim c As Range, v As Variant\n    Dim lrw As Long\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlManual\n        .StatusBar = _\n            \"Sto caricato la tabella Fasce\"\n    End With\n    wbn = \"Listino.xlsx\"\n'    If Not Belts Is Nothing Then\n'        Set Belts = Nothing\n'    End If\n\n'    Set Belts = New Collection\n    If AlreadyOpen(wbn) Then\n        Set wb = Workbooks(wbn)\n    Else\n        Set wb = Workbooks.Open(\"\\\\itcpifs01\\license$\\Listino.xlsx\")\n    End If\n    Set rng = wb.Worksheets(\"dbRatesSTD\").Range(\"C1\")\n    Set rng = Range(rng, rng.End(xlToRight))\n    'Be careful, this is a horizontal array.\n    Belts = rng\n'    For Each c In rng\n'        Belts.Add c\n'    Next\n\n' if I put the loop here, I can show results\n    For Each v In Belts\n       Debug.Print v\n    Next\n\n\nApplication.DisplayAlerts = False\n    wb.Close\nApplication.DisplayAlerts = True\n\n' if I put the loop here, I can't show results, Error 424 Object required\n    For Each v In Belts\n       Debug.Print v\n    Next\n\nRigaChiusura:\n    Set c = Nothing\n    Set rng = Nothing\n    Set sh = Nothing\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlAutomatic\n        .StatusBar = \"\"\n    End With\n    Exit Sub\n\nRigaErrore:\n    MsgBox Err.Number &amp; vbNewLine &amp; Err.Description\n    Resume RigaChiusura\n\nEnd Sub\n</code></pre>\n\n<p>I have older Excel so I can only imagine what <code>AlreadyOpen(wbn)</code> means, but here's the old way for the complete If statement for your code:</p>\n\n<pre><code>'Check if Excel file is opened:\nOn Error Resume Next\n  Set wb = Workbooks(wbn) 'Workbook is opened.\n  If Err then 'Workbook is closed.\n    Set wb = Workbooks.Open(\"\\\\itcpifs01\\license$\\Listino.xlsx\")\n    Err.Clear\n  End If\nOn Error GoTo RigaErrore 'Reactivate your 'first line error'.\n</code></pre>\n\n<p>There are no constants in your code. I would add this to the beginning of the code and make appropriate changes:</p>\n\n<pre><code>Const cStrTabella as String = \"Sto caricato la tabella Fasce\"\nConst cStrWbn as String = \"Listino.xlsx\"\nConst cStrWbp as String = \"\\\\itcpifs01\\license$\\Listino.xlsx\"\nConst cStrWs as String = \"dbRatesSTD\"\nConst cStrAddress as String = \"C1\"\n</code></pre>\n\n<p>Now it's much easier to change stuff and for someone else to modify it for a test and you can much faster get an answer for a problem.</p>\n"}], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52744829, "answer_count": 2, "score": 0, "last_activity_date": 1593695921, "creation_date": 1539187649, "last_edit_date": 1593695921, "question_id": 52744509, "link": "https://stackoverflow.com/questions/52744509/popolate-collection-from-external-file-then-close-file-and-show-collection-ite", "title": "Popolate collection from external file, then close file, and show collection items", "body": "<p>Is possible to popolate one pubblic collection from one external file?!?!?\nI can't show the collection items,\nto test this code I tried to loop the collection's item then\nif the loop is before close the wb source, the result show right\nbut if I close che wb source I can only count the items collection.item = 31 (right result) if I try debug.print collection(x) 'x are integer from 1 to 31</p>\n<p>I retrieve only Error 424.\nIs my code, wrong, or is not possible to polulate one collection from an external file and, in this case what I've to use?!?!</p>\n<p>Below my code:</p>\n<pre><code>option explicit\npublic Belts as collection\nPublic Sub mCaricaBelts()\nOn Error GoTo RigaErrore\n    Dim wb As Workbook, wbn As String\n    Dim sh As Worksheet\n    Dim rng As Range\n    Dim c As Range, v As Variant\n    Dim lrw As Long\n    \n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlManual\n        .StatusBar = _\n            &quot;Sto caricato la tabella Fasce&quot;\n    End With\n    wbn = &quot;Listino.xlsx&quot;\n    If Not Belts Is Nothing Then\n        Set Belts = Nothing\n    End If\n    \n    Set Belts = New Collection\n    If AlreadyOpen(wbn) Then\n        Set wb = Workbooks(wbn)\n    Else\n        Set wb = Workbooks.Open(&quot;\\\\itcpifs01\\license$\\Listino.xlsx&quot;)\n    End If\n    Set rng = wb.Worksheets(&quot;dbRatesSTD&quot;).Range(&quot;C1&quot;)\n    Set rng = Range(rng, rng.End(xlToRight))\n    For Each c In rng\n        Belts.Add c\n    Next\n\n' if I put the loop here, I can show results\n    For Each v In Belts\n       Debug.Print v\n    Next\n\n\nApplication.DisplayAlerts = False\n    wb.Close\nApplication.DisplayAlerts = True\n\n' if I put the loop here, I can't show results, Error 424 Object required\n    For Each v In Belts\n       Debug.Print v\n    Next\n\nRigaChiusura:\n    Set c = Nothing\n    Set rng = Nothing\n    Set sh = Nothing\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlAutomatic\n        .StatusBar = &quot;&quot;\n    End With\n    Exit Sub\n\nRigaErrore:\n    MsgBox Err.Number &amp; vbNewLine &amp; Err.Description\n    Resume RigaChiusura\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1539186078, "post_id": 52743825, "comment_id": 92412553, "body": "What do you mean by &quot;almost does not work&quot;?  I&#39;m not entirely sure why you&#39;re trying to <code>Hide</code> and <code>Unload</code> a form from inside its <code>Terminate</code> event - that event fire <i>in response to</i> being unloaded."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1539186335, "post_id": 52743928, "comment_id": 92412713, "body": "<a href=\"https://blogs.msdn.microsoft.com/ericlippert/2004/04/28/when-are-you-required-to-set-objects-to-nothing/\" rel=\"nofollow noreferrer\">Setting the default instances of the forms to <code>Nothing</code> after they are unloaded is not necessary.</a>"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539189401, "post_id": 52743928, "comment_id": 92414499, "body": "After I submitted the answer, I realized the reason the OP probably was having a problem was because they were performing the other form show -after- trying to hide and unload the form, and you&#39;re right, not only is it probably not necessary, in VBA it probably doesn&#39;t even work, especially if called from within the form you&#39;re unloading."}], "tags": [], "owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "is_accepted": true, "score": 0, "last_activity_date": 1539185815, "creation_date": 1539185815, "answer_id": 52743928, "question_id": 52743825, "link": "https://stackoverflow.com/questions/52743825/stop-in-close-and-open-userforms-vba/52743928#52743928", "title": "Stop in Close and Open userforms _VBA", "body": "<p>Skip the <code>formName.Hide</code> lines.  They are unnecessary.</p>\n\n<p>After the <code>Unload formName</code> statements add:</p>\n\n<pre><code>Set formName = Nothing\n</code></pre>\n\n<p>Also, make the <code>otherForm.Show</code> line precede the above two lines.</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1539189884, "post_id": 52744180, "comment_id": 92414804, "body": "Hi Nader! Your code will only be repeated once. For the second time error &quot;Run-time error &#39;400&#39;&quot;. - @Nader Nagazi"}, {"owner": {"reputation": 66, "user_id": 9849285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vOfDi.jpg?s=128&g=1", "display_name": "Nader Nagazi", "link": "https://stackoverflow.com/users/9849285/nader-nagazi"}, "reply_to_user": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1539277732, "post_id": 52744180, "comment_id": 92453719, "body": "Can you share your file with me?"}, {"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1539281094, "post_id": 52744180, "comment_id": 92455499, "body": "My file was exactly the text of your code and there was nothing superfluous. The correct answer is given by <i>Bill Hileman</i>. Thanks for the time you left."}], "tags": [], "owner": {"reputation": 66, "user_id": 9849285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vOfDi.jpg?s=128&g=1", "display_name": "Nader Nagazi", "link": "https://stackoverflow.com/users/9849285/nader-nagazi"}, "is_accepted": false, "score": 0, "last_activity_date": 1539186581, "creation_date": 1539186581, "answer_id": 52744180, "question_id": 52743825, "link": "https://stackoverflow.com/questions/52743825/stop-in-close-and-open-userforms-vba/52744180#52744180", "title": "Stop in Close and Open userforms _VBA", "body": "<p>Try this code:</p>\n\n<p><em>code Userform1:</em></p>\n\n<pre><code>Private Sub ShowUserform2_Click()\n    UserForm1.Hide\n    UserForm2.Show\nEnd Sub\n</code></pre>\n\n<p><em>Code userform2:</em></p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    UserForm1.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 52743928, "answer_count": 2, "score": 1, "last_activity_date": 1539186581, "creation_date": 1539185534, "question_id": 52743825, "link": "https://stackoverflow.com/questions/52743825/stop-in-close-and-open-userforms-vba", "title": "Stop in Close and Open userforms _VBA", "body": "<p>I created two forms. Pressing the button 1 opens the form number 2. By closing the form number 2, the form number 1 is displayed. But this action is only done once and it stops for the second time and almost does not work. Where does the code have a problem?</p>\n\n<p><em>code Userform1:</em></p>\n\n<pre><code>Private Sub ShowUserform2_Click()\n  UserForm1.Hide\n  Unload UserForm1\n  UserForm2.Show\nEnd Sub\n</code></pre>\n\n<p><em>Code userform2:</em></p>\n\n<pre><code>Private Sub UserForm_Terminate()\n  UserForm2.Hide\n  Unload UserForm2\n  UserForm1.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539184916, "post_id": 52743508, "comment_id": 92411834, "body": "Welcome to Stack Overflow - please make sure to add your code in the proper format so that we&#39;re able to view it easily - next time, just copy and paste the code from your module, highlight the whole block and press Ctrl + K."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1539185131, "post_id": 52743508, "comment_id": 92411986, "body": "And the syntax is <code>.getElementById</code>, not <code>getElementsById</code>."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539185668, "post_id": 52743733, "comment_id": 92412284, "body": "Nice and concise.+"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539190035, "post_id": 52743733, "comment_id": 92414897, "body": "@QHarr Now I <i>would</i> use querySelector, but I just wanted to fix his minor mistakes in current syntax :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539190144, "post_id": 52743733, "comment_id": 92414960, "body": "Lol. Your answer is better for explaining the error and you went with the fastest selector.  And glad to hear the love for querySelector! Wup wup."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1539190249, "post_id": 52743733, "comment_id": 92415020, "body": "@QHarr Oh yeah... querySelector (and you) have saved me countless hours in this monstrous program that I&#39;m wrapping up (hooray!)."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539190293, "post_id": 52743733, "comment_id": 92415041, "body": "Congrats on the progress!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1539185244, "creation_date": 1539185244, "answer_id": 52743733, "question_id": 52743508, "link": "https://stackoverflow.com/questions/52743508/filling-forms-in-an-ie-window-press-buttons-and-fill-in-text-boxes/52743733#52743733", "title": "Filling forms in an IE Window: Press buttons and fill in text boxes", "body": "<p>Try - changed <code>Elements</code> to <code>Element</code> and just stuck with <code>.getElementById</code> for the click as well.</p>\n\n<pre><code>IE.document.getElementById(\"ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_grdLineItems_ctl02_txtDescription\").Value = Range(\"A2\")\nIE.document.getElementById(\"ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_ButtonAdd\").Click\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10484860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DD_el6j_dK8/AAAAAAAAAAI/AAAAAAAATUQ/h06bfUCoSDI/photo.jpg?sz=128", "display_name": "ike chitima", "link": "https://stackoverflow.com/users/10484860/ike-chitima"}, "edited": false, "score": 0, "creation_date": 1539242215, "post_id": 52743966, "comment_id": 92432026, "body": "Hi, thank you for the pointers I have tried The query selector and I am obtaining the same error   Method &#39;Document&#39; of object &#39;IWEBBrowser2&#39; failed"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10484860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DD_el6j_dK8/AAAAAAAAAAI/AAAAAAAATUQ/h06bfUCoSDI/photo.jpg?sz=128", "display_name": "ike chitima", "link": "https://stackoverflow.com/users/10484860/ike-chitima"}, "edited": false, "score": 0, "creation_date": 1539242274, "post_id": 52743966, "comment_id": 92432063, "body": "Try declaring ie As New InternetExplorerMedium"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10484860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DD_el6j_dK8/AAAAAAAAAAI/AAAAAAAATUQ/h06bfUCoSDI/photo.jpg?sz=128", "display_name": "ike chitima", "link": "https://stackoverflow.com/users/10484860/ike-chitima"}, "edited": false, "score": 0, "creation_date": 1539257985, "post_id": 52743966, "comment_id": 92441315, "body": "Did that make a difference?"}, {"owner": {"reputation": 21, "user_id": 10484860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DD_el6j_dK8/AAAAAAAAAAI/AAAAAAAATUQ/h06bfUCoSDI/photo.jpg?sz=128", "display_name": "ike chitima", "link": "https://stackoverflow.com/users/10484860/ike-chitima"}, "edited": false, "score": 0, "creation_date": 1539347145, "post_id": 52743966, "comment_id": 92480524, "body": "No, have been experimenting with the site looking at the variables I do enter manually. The value is non existent until you save and then it writes it. Before saving there is no value. is this common?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1539185939, "creation_date": 1539185939, "answer_id": 52743966, "question_id": 52743508, "link": "https://stackoverflow.com/questions/52743508/filling-forms-in-an-ie-window-press-buttons-and-fill-in-text-boxes/52743966#52743966", "title": "Filling forms in an IE Window: Press buttons and fill in text boxes", "body": "<p>You have been given the best selector method in the existing answer, which is to use the element id attributes.</p>\n\n<p>Here is alternate syntax for the same thing using the CSS on the page and id selectors (\"<code>#</code>\").</p>\n\n<pre><code>With ie.document\n    .querySelector(\"#ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_grdLineItems_ctl02_txtDescription\").Value = Range(\"A2\")\n    .querySelector(\"#ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_ButtonAdd\").Click\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10484860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DD_el6j_dK8/AAAAAAAAAAI/AAAAAAAATUQ/h06bfUCoSDI/photo.jpg?sz=128", "display_name": "ike chitima", "link": "https://stackoverflow.com/users/10484860/ike-chitima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1558323193, "creation_date": 1539184506, "last_edit_date": 1558323193, "question_id": 52743508, "link": "https://stackoverflow.com/questions/52743508/filling-forms-in-an-ie-window-press-buttons-and-fill-in-text-boxes", "title": "Filling forms in an IE Window: Press buttons and fill in text boxes", "body": "<p>I am trying to automate filling in an IE site that is repetitive and time consuming.</p>\n\n<p>I wrote code that launches IE, makes it visible to the user, Dims the variables that it needs to fill in.</p>\n\n<p>I have found the ID and the name of the text box but I cannot fill it in.</p>\n\n<p>The site is a corporate site so I cannot attach the link.</p>\n\n<p>I can attach the HTLM code of the box I am trying to fill and button I'm am trying to click.</p>\n\n<p>TEXT BOX</p>\n\n<pre><code>&lt;input name=\"ctl00$m$g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af$ctl00$grdLineItems$ctl02$txtDescription\" \n type=\"text\"\n id=\"ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_grdLineItems_ctl02_txtDescription\"\n class=\"txtDescription\" \n onkeydown=\"return (event.keyCode!=13);\" \n style=\"width:680px;margin-top:2px;margin-bottom:2px\" /&gt;\n</code></pre>\n\n<p>BUTTON CLICK</p>\n\n<pre><code>&lt;input type=\"submit\"\n name=\"ctl00$m$g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af$ctl00$ButtonAdd\" \n value=\"Add New Item\"\n id=\"ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_ButtonAdd\"\n style=\"color:Black;background-color:White;font-size:Medium;font-weight:bold;width:150px;\"/&gt;\n</code></pre>\n\n<p>I tried different ways. I tried getting the text box by name but I am getting an error on the document command.</p>\n\n<p>MY CODE   </p>\n\n<pre><code>Sub Fill_in_eShipper()\n\nDim IE As Object Dim web_address As String\nDim number_of_elements As Integer \nDim MydataSet As Variant \nDim ObjCollection As Object \n\nWindows(\"eshipper filler.xlsm\").Activate\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nweb_address = Range(\"c2\") Range(\"D2\").Formula = \"=ROWS(A1:A161)-1\"\nnumber_of_elements = Range(\"d2\") \n\nIE.navigate web_address \nIE.Visible = True\n\nWhile IE.Busy DoEvents 'Wait till IE is done loading Wend\n\n'Number of elements to populate \nRange(\"A1\").Select\nRange(Selection, Selection.End(xlDown)).Select \n\nRange(\"D1\").Select\nActiveCell.FormulaR1C1 = \"=ROWS(RC[-3]:R[160]C[-3])-1\"   \n\nIE.document.getelementsbyid(\"ctl00_m_g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af_ctl00_grdLineItems_ctl02_txtDescription\").Value = Range(\"A2\")\nIE.document.All(\"ctl00$m$g_8fbfd2b6_3945_4bee_9a3b_20cfc2c846af$ctl00$ButtonAdd\").Click\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "matlab"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539185779, "post_id": 52743339, "comment_id": 92412358, "body": "for starters, the &quot;Errorfound&quot; section of your code will always run whether there&#39;s an error or not.  You can avoid that by putting an <code>Exit Sub</code> before that, at the point that the procedure should finish when complete (probably just before <code>Errorfound:</code>.)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539185920, "post_id": 52743339, "comment_id": 92412448, "body": "Also, have you referred to the documentation?  Are you able to get the example from <a href=\"https://www.mathworks.com/help/matlab/ref/getvariable.html\" rel=\"nofollow noreferrer\">this page</a> working, or do you have the same issue?"}, {"owner": {"reputation": 11, "user_id": 10484877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd22414517a773957c19f8af98ceff5?s=128&d=identicon&r=PG&f=1", "display_name": "Sol", "link": "https://stackoverflow.com/users/10484877/sol"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539186808, "post_id": 52743339, "comment_id": 92412998, "body": "Thank you for your help. To answer you second comment first, I get the exact same error with example code !"}, {"owner": {"reputation": 11, "user_id": 10484877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd22414517a773957c19f8af98ceff5?s=128&d=identicon&r=PG&f=1", "display_name": "Sol", "link": "https://stackoverflow.com/users/10484877/sol"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539187087, "post_id": 52743339, "comment_id": 92413149, "body": "@ashleedawg I also put Exit Sub before Errorfound: and the error description still remains blank."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1539188212, "post_id": 52743339, "comment_id": 92413795, "body": "I think the line needs a set operator since <code>DetA</code> is an object. Also, what is detA exactly?, late bound stuff can be difficult sometimes, you can&#39;t just assign a random object to your value. Find out what <code>getVariable</code> returns and assign the proper type. Also, your code will run into the <code>With Err</code> block, put an <code>Exit Sub</code>  before <code>Errorfound:</code>"}, {"owner": {"reputation": 11, "user_id": 10484877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd22414517a773957c19f8af98ceff5?s=128&d=identicon&r=PG&f=1", "display_name": "Sol", "link": "https://stackoverflow.com/users/10484877/sol"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1539189881, "post_id": 52743339, "comment_id": 92414803, "body": "@L8n Thank you for your help. I did put a <code>Set</code> operator for <code>DetA</code> and I get the same error. From what I have read online <code>DetA</code> is supposed to be set to <code>Object</code>. I have tried other datatypes, but to no avail. I have also added <code>Exit Sub</code> before <code>Errorfound:</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10484877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd22414517a773957c19f8af98ceff5?s=128&d=identicon&r=PG&f=1", "display_name": "Sol", "link": "https://stackoverflow.com/users/10484877/sol"}, "is_accepted": false, "score": 1, "last_activity_date": 1539223242, "creation_date": 1539223242, "answer_id": 52751078, "question_id": 52743339, "link": "https://stackoverflow.com/questions/52743339/invoking-matlab-function-from-vba/52751078#52751078", "title": "Invoking Matlab Function from VBA", "body": "<p>All,\nI finally managed to find the solution. Here is the code:</p>\n\n<pre><code>Sub Code()\n\nDim DMat(1 To 2, 1 To 2) As Double, MatLab As Object\nDim DbR(1 To 1) As Double\nDim DbI(1 To 1) As Double\n\nUpper = 100\nLower = 10\n\nFor i = 1 To 2\n    For j = 1 To 2\n        DMat(i, j) = ((Upper - Lower) * Rnd + Lower)\n        Sheet1.Cells(i + 3, j) = DMat(i, j)\n    Next\nNext\n\nSet MatLab = CreateObject(\"Matlab.Application\")\nMatLab.PutWorkspaceData \"A\", \"base\", DMat\nResult = MatLab.Execute(\"D = det(A) \")\nMatLab.GetFullMatrix \"D\", \"base\", DbR, DbI\nSheet1.Range(\"A8\").Value = DbR\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10484877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd22414517a773957c19f8af98ceff5?s=128&d=identicon&r=PG&f=1", "display_name": "Sol", "link": "https://stackoverflow.com/users/10484877/sol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539223242, "creation_date": 1539184053, "last_edit_date": 1539187793, "question_id": 52743339, "link": "https://stackoverflow.com/questions/52743339/invoking-matlab-function-from-vba", "title": "Invoking Matlab Function from VBA", "body": "<p>I am trying to invoke Matlab functions from VBA and wrote a simple example code to try it out. The code tries to calculate the determinant of a random 2x2 matrix. </p>\n\n<pre><code>Sub Code()\n    Dim DMat(1 To 2, 1 To 2) As Double, DetA As Object, Matlab As Object\n    Upper = 1000\n    Lower = 10\n    For i = 1 To 2\n        For j = 1 To 2\n            DMat(i, j) = ((Upper - Lower) * Rnd + Lower)\n            Sheet1.Cells(i + 1, j) = DMat(i, j)\n        Next\n    Next\n\n    Set Matlab = CreateObject(\"Matlab.Application\")\n\n    On Error GoTo Errorfound\n    Matlab.PutWorkspaceData \"A\", \"base\", DMat\n    Matlab.Execute \"Result = det(A);\"\n    DetA = Matlab.GetVariable(\"Result\", \"base\")\n\nErrorfound:\n    With Err\n        MsgBox \"Source: \" &amp; .Source &amp; vbCrLf &amp; \"Desc: \" &amp; .Description, _\n            vbCritical, \"Error \" &amp; CStr(.Number)\n        End With\n    Sheet1.Range(\"A6\").Value = DetA\nEnd Sub\n</code></pre>\n\n<p>I get a <strong>Runtime error 440</strong> on the line containing the <code>GetVariable</code> command. I tried to get a description, but it is always blank.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9B2Bh.jpg\" alt=\"enter image description here\"></p>\n\n<p>I have tried to use <code>GetWorkspaceData</code> instead of <code>GetVariable</code>, but the result is the same.</p>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539186407, "post_id": 52743234, "comment_id": 92412750, "body": "You&#39;re saying the first section of code runs even with the stray <code>&#39;</code> quote? Looking at the lines above it, I think there&#39;s an issue with that part of code.  Also, what are you expecting to be added to the database? A file?"}, {"owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539186674, "post_id": 52743234, "comment_id": 92412922, "body": "Unless I&#39;m missing something there is no stray quote, but the code I have does run and inserts into the database correctly. I&#39;m expecting to add JPG image files and maybe pdf&#39;s eventually."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539257625, "post_id": 52748096, "comment_id": 92441107, "body": "That gives &quot;Incorrect syntax near &#39;0xd8ff&#39;.  Using &#39; &quot; &amp; mstream.Read &amp; &quot; &#39; gets further saying &quot;Unclosed quotation mark after the character string &#39;?????????Ea&#39;."}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "reply_to_user": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539276918, "post_id": 52748096, "comment_id": 92453291, "body": "Try <code>updateQuery = updateQuery &amp; &quot;PII_Image1=&quot; &amp; mstream.Read &amp; &quot;,&quot;</code>. This intentionally avoids the convert and single quotes, because if your underlying field is binary then you can set it directly to a binary value."}, {"owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539283761, "post_id": 52748096, "comment_id": 92456791, "body": "That line gives &quot;Incorrect syntax near &#39;,&#39;.&quot; which I can fix by adding apostrophes like <code>updateQuery = updateQuery &amp; &quot;PII_Image1=&#39;&quot; &amp; mstream.Read &amp; &quot;&#39;,&quot;</code>  It then complains about not being able to convert from varchar to varbinary(max). We should be close because if I add msgbox mstream.read it does match both my working example and the in progress example."}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "reply_to_user": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539285123, "post_id": 52748096, "comment_id": 92457402, "body": "Just to confirm, what is the SQL data type of the field &quot;PII_Image1&quot;?"}, {"owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539285324, "post_id": 52748096, "comment_id": 92457499, "body": "It&#39;s varbinary(MAX)."}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "reply_to_user": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539286246, "post_id": 52748096, "comment_id": 92457892, "body": "Also, to confirm, are you removing the final comma or alternatively are you appending more fields to the SET statement, and then making sure there is no comma at the end of the SET statement?"}, {"owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539286955, "post_id": 52748096, "comment_id": 92458295, "body": "Yes at the end of the statement the comma is removed. If I comment out this line the rest of the statement runs normally."}, {"owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "reply_to_user": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539355236, "post_id": 52748096, "comment_id": 92485172, "body": "The reason your first approach works is because you are setting the binary field directly with a binary value. The reason the second approach doesn&#39;t work is because you are trying to put the binary value into a string and then use that string as an update command. The binary value has to be converted first. I don&#39;t know why I didn&#39;t realize that earlier. I revised my answer to include an additional function that converts the binary value to a hexidecimal string, which you can pass into your update string."}, {"owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "edited": false, "score": 0, "creation_date": 1539367071, "post_id": 52748096, "comment_id": 92490948, "body": "Excellent, that worked beautifully. If you&#39;d be willing to explain how this all worked further I&#39;d appreciate it. I&#39;m curious how the first example converted to hex. But either way I&#39;m thrilled. Thanks so much."}], "tags": [], "owner": {"reputation": 163, "user_id": 5447104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b234b0219305093e1adebeea9f5cc080?s=128&d=identicon&r=PG", "display_name": "Ken Love", "link": "https://stackoverflow.com/users/5447104/ken-love"}, "is_accepted": true, "score": 1, "last_activity_date": 1539355176, "last_edit_date": 1539355176, "creation_date": 1539202411, "answer_id": 52748096, "question_id": 52743234, "link": "https://stackoverflow.com/questions/52743234/inserting-files-into-sql-server-using-vba-issue/52748096#52748096", "title": "Inserting files into SQL Server using vba issue", "body": "<p>Use <code>updateQuery = updateQuery &amp; \"PII_Image1 = 0x\" &amp; BinaryToHex(mstream.Read) &amp; \"),\"</code></p>\n\n<p>Also, add the following function to your module:</p>\n\n<pre><code>'Simple binary-to-hex Function\n'2003 Antonin Foller, Motobit Software\n'BinaryToHex is byte-to-byte VBS function and it is suitable only for small amount of binary data - up to 100kB.\n'If you want to work with bigger size, please see HexString property of Motobit's ScriptUtil.ByteArray object.\n\nPrivate Function BinaryToHex(Binary)\n  Dim c1, Out, OneByte\n\n  'For each source byte\n  For c1 = 1 To LenB(Binary)\n    'Get the byte As hex\n    OneByte = Hex(AscB(MidB(Binary, c1, 1)))\n\n    'append zero For bytes &lt; 0x10\n    If Len(OneByte) = 1 Then OneByte = \"0\" &amp; OneByte\n\n    'join the byte To OutPut stream\n    Out = Out &amp; OneByte\n  Next\n\n  'Set OutPut value\n  BinaryToHex = Out\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5248780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c727629eae73c6c2a618b43098cc3f91?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5248780/zach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 52748096, "answer_count": 1, "score": 1, "last_activity_date": 1539355176, "creation_date": 1539183776, "last_edit_date": 1539186556, "question_id": 52743234, "link": "https://stackoverflow.com/questions/52743234/inserting-files-into-sql-server-using-vba-issue", "title": "Inserting files into SQL Server using vba issue", "body": "<p>I'm trying to incorporate the following code into my existing code.</p>\n\n<p>Here is my test code that works:</p>\n\n<pre><code>Sub test()\nDim con As ADODB.Connection\nDim rs As ADODB.recordSet\nSet con = New ADODB.Connection\nSet rs = New ADODB.recordSet\n\ncon.Open \"Provider=SQLOLEDB;Password=;User ID=;Initial \nCatalog='\" &amp; Worksheets(\"Settings\").Range(\"C2\").Value &amp; _\n        \"';Data Source='\" &amp; Worksheets(\"Settings\").Range(\"A2\").Value &amp; \"';\"\n\n'Open database connection\nrs.ActiveConnection = con\n\nrs.Open \"select * from QuoteData\", con, adOpenKeyset, \nadLockOptimistic\n\nSet mstream = New ADODB.Stream\nmstream.Type = adTypeBinary\nmstream.Open\nmstream.LoadFromFile \"c:\\temp\\pictures\\pic1.jpg\"\nrs.Fields(\"PII_Image1\").Value = mstream.Read\nrs.Update\nEnd Sub\n</code></pre>\n\n<p>This is the code I'm using in my existing code. UpdateQuery is part of a larger string. I want to integrate it with my existing update query.</p>\n\n<pre><code>Set mstream = New ADODB.Stream\nmstream.Type = adTypeBinary\nmstream.Open\nmstream.LoadFromFile \"c:\\temp\\pictures\\pic1.jpg\"\nupdateQuery = updateQuery &amp; \"PII_Image1=convert(varbinary(MAX),'mstream.Read'),\"\nmstream.Close\n</code></pre>\n\n<p>This code runs, but it only inserts something into the database that looks like '<code>0x6D73747265616D2E52656164</code>' which isn't correct. I'm trying to figure out why. If I take away the convert piece, it says it can't convert <code>varchar</code> to <code>varbinary(MAX)</code>.</p>\n"}, {"tags": ["excel", "vba", "listobject"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1539183810, "post_id": 52743096, "comment_id": 92411077, "body": "You&#39;re using <code>DataBodyRange</code> and OP is using <code>Range</code>. You&#39;ll be off by one row."}, {"owner": {"reputation": 336, "user_id": 1945756, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/FhWJ6.jpg?s=128&g=1", "display_name": "Stephen Ellwood", "link": "https://stackoverflow.com/users/1945756/stephen-ellwood"}, "edited": false, "score": 0, "creation_date": 1539185562, "post_id": 52743096, "comment_id": 92412233, "body": "Thankyou, you answered my question perfectly! I am still wondering why it does not need &quot;.value&quot; at the end though.  I did need to use found_cell-1 but that&#39;s no hardship."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 336, "user_id": 1945756, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/FhWJ6.jpg?s=128&g=1", "display_name": "Stephen Ellwood", "link": "https://stackoverflow.com/users/1945756/stephen-ellwood"}, "edited": false, "score": 0, "creation_date": 1539186305, "post_id": 52743096, "comment_id": 92412695, "body": "@StephenEllwood don&#39;t use <code>found_cell-1</code>, that&#39;s bad practice. Change <code>.DataBodyRange</code> to <code>.Range</code>."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1539279854, "last_edit_date": 1539279854, "creation_date": 1539183358, "answer_id": 52743096, "question_id": 52743019, "link": "https://stackoverflow.com/questions/52743019/trying-to-access-named-tables-with-vba-to-lookup-a-value/52743096#52743096", "title": "Trying to access named tables with VBA to lookup a value", "body": "<pre><code>Table.ListColumns(\"Schem Typ\").Range.Cells(found_Cell)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1539184038, "creation_date": 1539184038, "answer_id": 52743334, "question_id": 52743019, "link": "https://stackoverflow.com/questions/52743019/trying-to-access-named-tables-with-vba-to-lookup-a-value/52743334#52743334", "title": "Trying to access named tables with VBA to lookup a value", "body": "<p>Try this</p>\n\n<pre><code>Dim MyTable As ListObject\n\nSet MyTable = ThisWorkbook.ActiveSheet.ListObjects(\"Tabla_1\")\n\nDim ZZ As Long\n\nDim MySearch As String\n\nMySearch = \"caca\" 'change this whatever you want\n\nOn Error GoTo Errores:\nZZ = Application.WorksheetFunction.Match(MySearch, MyTable.ListColumns(1).Range, 0) - 1 'minus 1 to exclude header. Change 1 for number of column where you are searching\n\nDebug.Print MyTable.DataBodyRange.Cells(ZZ, 2).Value 'Change 2 for number of column you want to obtain\n\nClear_All:\nSet MyTable = Nothing\n\nExit Sub\n\nErrores:\nIf Err.Number = 1004 Then\n    MsgBox MySearch &amp; \" not found\"\n    GoTo Clear_All\nElse\n    MsgBox Err.Description\nEnd If\n</code></pre>\n\n<p>The code will use Match Function to find the value. IF not found, it will pop up a message (not the best error handling I must admit).</p>\n\n<p>Try to adapt it to your needs.</p>\n"}], "owner": {"reputation": 336, "user_id": 1945756, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/FhWJ6.jpg?s=128&g=1", "display_name": "Stephen Ellwood", "link": "https://stackoverflow.com/users/1945756/stephen-ellwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1471, "favorite_count": 0, "accepted_answer_id": 52743096, "answer_count": 2, "score": 0, "last_activity_date": 1539279854, "creation_date": 1539183089, "question_id": 52743019, "link": "https://stackoverflow.com/questions/52743019/trying-to-access-named-tables-with-vba-to-lookup-a-value", "title": "Trying to access named tables with VBA to lookup a value", "body": "<p>I am trying to find a value in a named table (i.e. a listobject) but failing miserably.\nI have a page containing a table of the same name as the page. So far  I have 3 working lines to find the word \"Area\" in the description column and return the row number.  This is:</p>\n\n<pre><code>Function CheckArea(ByVal My_Table As String)\n     Set Table = Worksheets(My_Table).ListObjects(My_Table)\n     Descriptions = Table.ListColumns(\"Description\").Range\n     found_cell = Application.Match(\"Area\", Descriptions, 0)\n</code></pre>\n\n<p>Once I have found the row, I want to access the information in the same row but a different column \"Schem typ\" and return the value contained.  I cannot find how to access a cell within the table by a named column and a referenced row.  If should be simple but I cannot find any examples out there. Can anyone help?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1539186740, "post_id": 52742993, "comment_id": 92412960, "body": "Hello and welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"https://stackoverflow.com/help\">help center</a> to learn what we&#39;ll do to help you. TL;DR: since you can&#39;t use VBA code, at least post what you&#39;ve tried (maybe include some screen shots) setting up in your Outlook rules. Be sure to blank out any private info like e-mail addresses leaving the first char or two and the last so we can tell it&#39;s an email address, etc."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1539270877, "post_id": 52742993, "comment_id": 92450060, "body": "What do you mean company requirements?"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 5512486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abb6ce1c7f293d0353d7f7205370a106?s=128&d=identicon&r=PG&f=1", "display_name": "Kalenji", "link": "https://stackoverflow.com/users/5512486/kalenji"}, "edited": false, "score": 0, "creation_date": 1539251715, "post_id": 52754942, "comment_id": 92437534, "body": "When I set up the rule I do not have the option to use a macro as a rule (company requirements)."}, {"owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "reply_to_user": {"reputation": 317, "user_id": 5512486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abb6ce1c7f293d0353d7f7205370a106?s=128&d=identicon&r=PG&f=1", "display_name": "Kalenji", "link": "https://stackoverflow.com/users/5512486/kalenji"}, "edited": false, "score": 0, "creation_date": 1539253434, "post_id": 52754942, "comment_id": 92438617, "body": "According to your comment, If you can&#39;t use a macro as rule, you might perform the vba code by yourselves in outlook &quot;Developer&quot;. This only issue is you can&#39;t  save attachment to your folder automaticly. You could download attachments from specific folder in Outlook, You could refer to this link: <a href=\"https://stackoverflow.com/questions/35994435/download-attachments-from-specific-folder-in-outlook\" title=\"download attachments from specific folder in outlook\">stackoverflow.com/questions/35994435/&hellip;</a>"}], "tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": -1, "last_activity_date": 1539244250, "creation_date": 1539244250, "answer_id": 52754942, "question_id": 52742993, "link": "https://stackoverflow.com/questions/52742993/save-email-attachment-based-on-the-email-originator-and-output-folder/52754942#52754942", "title": "Save email attachment based on the email originator and output folder", "body": "<p>You could create a rule, refer to this link:</p>\n\n<p><a href=\"https://www.extendoffice.com/documents/outlook/3747-outlook-auto-download-save-attachments-to-folder.html\" rel=\"nofollow noreferrer\">How To Automatically Download/Save Attachments From Outlook To A Certain Folder?</a></p>\n\n<pre><code>sSaveFolder = \"C:\\Users\\DT168\\Documents\\outlook-attachments\\\"\n</code></pre>\n\n<p>This vba code is means where you want to save attachment. You could change this to your Documents folder URL.</p>\n"}], "owner": {"reputation": 317, "user_id": 5512486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abb6ce1c7f293d0353d7f7205370a106?s=128&d=identicon&r=PG&f=1", "display_name": "Kalenji", "link": "https://stackoverflow.com/users/5512486/kalenji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1592900343, "creation_date": 1539182996, "last_edit_date": 1592900343, "question_id": 52742993, "link": "https://stackoverflow.com/questions/52742993/save-email-attachment-based-on-the-email-originator-and-output-folder", "title": "Save email attachment based on the email originator and output folder", "body": "<p>I do not have knowledge of VBA and I have researched stack overflow but can not get it working. Basically I want to save all attachments (csv files) that are moved by rule to my folder 'Test' in outlook and save in my Documents.\nThe rule move emails with attachments. </p>\n\n<p>When I set up the rule I do not have the option to use a macro as a rule (company requirements).</p>\n\n<p>Please help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539184888, "post_id": 52742947, "comment_id": 92411822, "body": "Seems to me your code will always paste everything in A1."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1539185074, "post_id": 52742947, "comment_id": 92411943, "body": "Not to mention that due to the <code>rownum = rownum + 1</code> and <code>rownum = rownum + 2</code> within a self incrementing loop, it won&#39;t see every <code>x</code> so often pastes the whole lot each time."}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1539185745, "post_id": 52742947, "comment_id": 92412342, "body": "This code is slightly modified as the data set I&#39;m using is not exactly as specified in the question; I had to do that for privacy reasons but probably should have been more clear in the question."}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1539184964, "post_id": 52743430, "comment_id": 92411871, "body": "No, that wouldn&#39;t work @DavesExcel. rownum increments for every cell, whereas colnum increments only when a <code>y</code> is found."}, {"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1539185827, "post_id": 52743430, "comment_id": 92412389, "body": "This is really good, thank you. The only issue I&#39;m coming across is that on some worksheets, there&#39;s no &quot;y&quot; rows at all. With the code I had in the question, it would pull rows between two &quot;x&quot; rows as well. Is there a way to amend this code to also do that? Like if there is no &quot;y&quot; to mark the end of the data being copied, could it come across another &quot;x&quot; and know when to stop?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1539186832, "post_id": 52743430, "comment_id": 92413009, "body": "See the edit. It&#39;ll now treat the last cell as a <code>Y</code>, regardless."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 2, "last_activity_date": 1539204115, "last_edit_date": 1539204115, "creation_date": 1539184294, "answer_id": 52743430, "question_id": 52742947, "link": "https://stackoverflow.com/questions/52742947/copy-data-from-between-two-cell-values-and-paste-copied-data-in-new-column-in-n/52743430#52743430", "title": "Copy data from between two cell values, and paste copied data in new column in new worksheet using VBA (Excel)", "body": "<p>There's a lot going on in that code that doesn't need to. Have a look at the below and see if you can follow what's happening:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim rownum As Long\n    Dim colnum As Long\n    Dim startrow As Long\n    Dim endrow As Long\n    Dim lastrow As Long\n\n    colnum = 1 'start outputting to this column\n\n    Dim rangetocopy As Range\n\n    With Worksheets(\"Sheet1\")\n         lastrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A\" &amp; lastrow)\n\n        For rownum = 1 To lastrow\n\n            If .Cells(rownum, 1).Value = \"x\" Then\n                startrow = rownum\n            End If\n\n            If .Cells(rownum, 1).Value = \"y\" Or rownum = lastrow Then\n\n                endrow = rownum\n                Set rangetocopy = Worksheets(\"Sheet1\").Range(\"A\" &amp; startrow &amp; \":A\" &amp; endrow)\n                rangetocopy.Copy Sheets(\"Sheet2\").Cells(1, colnum)\n                colnum = colnum + 1 ' set next output column\n            End If\n\n        Next rownum\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1539185929, "post_id": 52743686, "comment_id": 92412455, "body": "That&#39;s pretty cool-- to my limited understanding though, this wouldn&#39;t work if the data is actually text? I used the numbers (1,2,3,4,5,6) to make the question easier to follow, but the actual data is alphanumeric."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "edited": false, "score": 0, "creation_date": 1539192441, "post_id": 52743686, "comment_id": 92416161, "body": "@Tester_Y, yes, my first code works for &quot;numeric&quot; data, as per your example. See edit to manage alphanumeric data"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 2, "last_activity_date": 1539192393, "last_edit_date": 1539192393, "creation_date": 1539185111, "answer_id": 52743686, "question_id": 52742947, "link": "https://stackoverflow.com/questions/52742947/copy-data-from-between-two-cell-values-and-paste-copied-data-in-new-column-in-n/52743686#52743686", "title": "Copy data from between two cell values, and paste copied data in new column in new worksheet using VBA (Excel)", "body": "<p>you could use:</p>\n\n<ul>\n<li><p><code>SpecialCells()</code> method of <code>Range</code> object to catch \"numeric\" values range</p></li>\n<li><p><code>Areas</code> property of <code>Range</code> object to loop through each set of \"numeric\" range</p></li>\n</ul>\n\n<p>as follows:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    With Worksheets(\"Sheet1\")\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(xlCellTypeConstants, xlNumbers)\n            Dim area As Range\n            For Each area In .Areas\n                With Worksheets(\"Sheet2\")\n                    .Cells(1, .Columns.Count).End(xlToLeft).Offset(, 1).Resize(area.Rows.Count).Value = area.Value\n                End With\n            Next\n        End With\n    End With\n    Worksheets(\"Sheet2\").Columns(1).Delete\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>to manage data of any format (not only \"numeric\") between \"x\"s or \"x\"s and \"y\"s, then use</p>\n\n<ul>\n<li><p><code>AutoFilter()</code> method of <code>Range</code> object to filter data between \"x\"s or \"x\"s and \"ys\" \"</p></li>\n<li><p><code>SpecialCells()</code> method of <code>Range</code> object to catch not empty values range</p></li>\n<li><p><code>Areas</code> property of <code>Range</code> object to loop through each set of \"selected\" range</p></li>\n</ul>\n\n<p>as follows:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Dim area As Range\n\n    With Worksheets(\"Sheet1\")\n        With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp))\n            .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;x\", Operator:=xlAnd, Criteria2:=\"&lt;&gt;y\"\n            With .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).SpecialCells(xlCellTypeConstants) '.Offset(-1)\n                For Each area In .Areas\n                    With Worksheets(\"Sheet2\")\n                        .Cells(1, .Columns.Count).End(xlToLeft).Offset(, 1).Resize(area.Rows.Count).Value = area.Value\n                    End With\n                Next\n\n            End With\n        End With\n        .AutoFilterMode = False\n    End With\n    Worksheets(\"Sheet2\").Columns(1).Delete\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1539185972, "creation_date": 1539185972, "answer_id": 52743973, "question_id": 52742947, "link": "https://stackoverflow.com/questions/52742947/copy-data-from-between-two-cell-values-and-paste-copied-data-in-new-column-in-n/52743973#52743973", "title": "Copy data from between two cell values, and paste copied data in new column in new worksheet using VBA (Excel)", "body": "<p>This type was already mentioned, but since I wrote it, I'll share it as well, using range areas.</p>\n\n<p>This is also assuming layout is actual in the original question and that you are trying to extract a group of numbers.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim sh As Worksheet, ws As Worksheet\n    Dim RangeArea As Range\n\n    Set sh = Sheets(\"Sheet1\")\n    Set ws = Sheets(\"Sheet2\")\n\n    For Each RangeArea In sh.Columns(\"A\").SpecialCells(xlCellTypeConstants, 1).Areas\n\n        RangeArea.Copy ws.Cells(1, ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column + 1)\n\n    Next RangeArea\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 9873632, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tester_Y", "link": "https://stackoverflow.com/users/9873632/tester-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 52743430, "answer_count": 3, "score": -1, "last_activity_date": 1593698183, "creation_date": 1539182895, "last_edit_date": 1593698183, "question_id": 52742947, "link": "https://stackoverflow.com/questions/52742947/copy-data-from-between-two-cell-values-and-paste-copied-data-in-new-column-in-n", "title": "Copy data from between two cell values, and paste copied data in new column in new worksheet using VBA (Excel)", "body": "<p>I'm trying to copy all rows from between two cell values and paste the values in a new column in a new worksheet. Let's say my data is structured in one excel column as such:</p>\n<pre><code>x\n\n1\n2\n3\n\ny\nx\n\n4\n5\n6\n\ny\n</code></pre>\n<p>So I want to copy the 123 and the 456, paste them in a new worksheet in columns A and B respectively, like so:</p>\n<pre><code>  A   B\n1 1   4\n2 2   5\n3 3   6\n</code></pre>\n<p>The code that I have working copies the data just fine, but it only pastes them below each other. Is there any way to amend the following code to paste the copied data in a new column every time the loop runs through?</p>\n<pre><code>Private Sub CommandButton1_Click()\n\n   Dim rownum As Long\n   Dim colnum As Long\n   Dim startrow As Long\n   Dim endrow As Long\n   Dim lastrow As Long\n   rownum = 1\n   colnum = 1\n   lastrow = Worksheets(&quot;Sheet1&quot;).Range(&quot;A65536&quot;).End(xlUp).Row\n   With ActiveWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A&quot; &amp; lastrow)\n\n\n   For rownum = 1 To lastrow\n    Do\n       If .Cells(rownum, 1).Value = &quot;x&quot; Then\n          startrow = rownum\n       End If\n\n       rownum = rownum + 1\n\n\n   If (rownum &gt; lastrow) Then Exit For\n\n   Loop Until .Cells(rownum, 1).Value = &quot;y&quot;\n   endrow = rownum - 1\n   rownum = rownum + 2\n\n   Worksheets(&quot;Sheet1&quot;).Range(startrow &amp; &quot;:&quot; &amp; endrow).Copy\n\n\n   Sheets(&quot;Sheet2&quot;).Select\n   ActiveSheet.Range(&quot;A1&quot;).Select\n   ActiveSheet.Paste\n\n\n   Next rownum\n   End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "row"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1539183949, "last_edit_date": 1539183949, "creation_date": 1539182583, "answer_id": 52742842, "question_id": 52742726, "link": "https://stackoverflow.com/questions/52742726/assign-a-group-of-cells-defined-on-execution-to-a-range/52742842#52742842", "title": "Assign a group of cells, defined on execution, to a range", "body": "<p>Use a period <code>.</code> before <code>Range</code> or <code>Cells</code> references to fully qualify the <code>Worksheet</code> within the <code>With...End With</code> block.</p>\n\n<pre><code>With Workbooks(WorkbookB).Sheets(SheetNameFromArray)\n    Set rngWorkbookBToCompare = .Range(.Cells(i, 2), .Cells(i, LastSheetColumn))\nEnd With\n</code></pre>\n\n<p>And again:</p>\n\n<pre><code>With Workbooks(WorkbookA).Sheets(SheetNameFromArray)\n    Set rngWorkbookAToCompare = .Range(.Cells(FoundCell.Row, 2), .Cells(FoundCell.Row, LastSheetColumn))\nEnd With\n</code></pre>\n\n<p>Without the period, the <code>With...End With</code> has no effect. The <code>ActiveSheet</code> and <code>ActiveWorkbook</code> are implied since the <code>Range</code> and <code>Cells</code> calls are not fully qualified.</p>\n"}], "owner": {"reputation": 25, "user_id": 10025447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117b1b718ec2ed0f2e04f25525976870?s=128&d=identicon&r=PG&f=1", "display_name": "Jr.Dev", "link": "https://stackoverflow.com/users/10025447/jr-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52742842, "answer_count": 1, "score": 0, "last_activity_date": 1546799982, "creation_date": 1539182236, "last_edit_date": 1546799982, "question_id": 52742726, "link": "https://stackoverflow.com/questions/52742726/assign-a-group-of-cells-defined-on-execution-to-a-range", "title": "Assign a group of cells, defined on execution, to a range", "body": "<p>I am trying to assign a group of cells from two rows of two workbooks to two ranges. This information is used to do a <a href=\"https://stackoverflow.com/questions/52036852/copy-a-range-of-cells-defined-on-execution-to-an-array-excel-vba\">comparison of the contents of both workbooks rows by ID</a>. </p>\n\n<p>I tried using \"with\" statements.</p>\n\n<pre><code>Dim aWorkbookBInfo() As Variant, aWorkbookAInfo() As Variant, rngWorkbookBToCompare As Range, rngWorkbookAToCompare As Range\nDim SumToCheck As Integer, FoundCell As Range, aCellValues() As Integer\nReDim aCellValues(LastSheetColumn - 1)\nReDim aWorkbookBInfo(LastSheetColumn - 1)\nReDim aWorkbookAInfo(LastSheetColumn - 1)\nFor i = 2 To LastSheetRow\n    Set FoundCell = Workbooks(WorkbookA).Sheets(SheetNameFromArray).Range(\"A:A\").Find(What:=Workbooks(WorkbookB).Sheets(SheetNameFromArray).Cells(i, 1).Value)\n    If Not FoundCell Is Nothing Then\n        aCellValues(0) = 1\n        Workbooks(WorkbookB).Sheets(SheetNameFromArray).Cells(i, LastSheetColumn + 1).Value = FoundCell.Row\n        With Workbooks(WorkbookB).Sheets(SheetNameFromArray)\n            Set rngWorkbookBToCompare = Range(Cells(i, 2), Cells(i, LastSheetColumn))\n        End With\n        With Workbooks(WorkbookA).Sheets(SheetNameFromArray)\n            Set rngWorkbookAToCompare = Range(Cells(FoundCell.Row, 2), Cells(FoundCell.Row, LastSheetColumn))\n        End With\n        aWorkbookBInfo = rngWorkbookBToCompare\n        aWorkbookAInfo = rngWorkbookAToCompare\n        For j = 1 To LastSheetColumn - 1\n            If aWorkbookBInfo(1, j) = aWorkbookAInfo(1, j) Then\n                aCellValues(j) = 1 \n            Else\n                aCellValues(j) = 0\n            End If\n        Next j\n    Else\n    End If\nNext i \n</code></pre>\n\n<p>I would like to store the contents of the groups of cells from both workbooks without activating them, as I believe the process would be faster.</p>\n\n<p>What I tried gets only the information of the active workbook instead of both workbooks.</p>\n"}, {"tags": ["c++", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1539182595, "post_id": 52742665, "comment_id": 92410311, "body": "Hello, VBA runs in Excel. You can&#39;t (practically) run an Excel on a webserver. So no, no practical way to run a VBA code on a website. You will have to rewrite the comparison logic in another programming language, C#, java, whatever floats your boat. Use an SDK to manipulate Excel files (for example Office Open XML SDK)."}, {"owner": {"reputation": 1, "user_id": 10484785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d47c7fbb28fa4a76018f5eb072e47d9?s=128&d=identicon&r=PG&f=1", "display_name": "kinder1212", "link": "https://stackoverflow.com/users/10484785/kinder1212"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539291953, "post_id": 52742665, "comment_id": 92460522, "body": "@vacip if that possible direct put my template excel file on website then direct browser another compare file for comparing? or just only the way is rewrite the code in other language?thanks."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1539364556, "post_id": 52742665, "comment_id": 92489812, "body": "Hello, it is quite hard to understand what you are trying to say... No, there is no way to run VBA for Office outside Office (ok this is not literally true, but in your case it is true). So yes, the only way is to rewrite the code and rethink the logic."}], "owner": {"reputation": 1, "user_id": 10484785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d47c7fbb28fa4a76018f5eb072e47d9?s=128&d=identicon&r=PG&f=1", "display_name": "kinder1212", "link": "https://stackoverflow.com/users/10484785/kinder1212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539182048, "creation_date": 1539182048, "last_edit_date": 1592644375, "question_id": 52742665, "link": "https://stackoverflow.com/questions/52742665/how-to-compare-2-excel-file-online", "title": "How to compare 2 excel file online", "body": "<p>currently i have one Excel template  that content a lots of the VBA code for compare 2 excel file,but did have any idea to pull it into website for using online?</p>\n<p>For example the excel template are providing browse 2 excel file and after browse 2 excel into website and it will compare and provide a after compare file for download or maybe showing summary in website.</p>\n<h1>is that possible pull the VBA code into website for online compare?</h1>\n<p>Thanks and regards,</p>\n<p>kind1212</p>\n"}, {"tags": ["excel", "vba", "insert", "row", "userform"], "comments": [{"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 3, "creation_date": 1539179056, "post_id": 52741604, "comment_id": 92408083, "body": "The way you have defined SH, it is just a string value. You might be better off doing <code>For each SH in Worksheets</code> and then testing to see if SH.Name is one of the sheets of interest before doing anything to it."}, {"owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1539184292, "post_id": 52741604, "comment_id": 92411443, "body": "Thanks StoneGiant. I&#39;ve gone with a `If Not Sh.Name - &quot;....&quot; solution here. Thank you for the pointer,"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1539184720, "post_id": 52741604, "comment_id": 92411712, "body": "<b>Side Note:</b> Using <code>GoTo</code> in code outside of <code>On Error GoTo</code> is not recommended. (It has been frowned upon by coders for years.) It leads to code that is difficult to follow and maintain. In your example, I would use an <code>If...Then...Else...End If</code> construct."}, {"owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1539185016, "post_id": 52741604, "comment_id": 92411904, "body": "This is why I love this site! I am definitely not a coder but I am gradually learning! I&#39;ve used Xabier&#39;s code, below, which has removed these aspects but I am now thinking that I need to ensure I build your construct back in!"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1539183972, "post_id": 52741760, "comment_id": 92411197, "body": "Thanks Xabier - this has definitely moved me on. I have now got a &#39;Method or data member not found&#39; error on the <code>.SpecialCells(xlCellTypeConstants).ClearContents</code> line. Am I right in thinking that this line deletes any contents in the new row that has been copied from the row above?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1539184500, "post_id": 52741760, "comment_id": 92411576, "body": "@gbra to be honest I wasn&#39;t sure what you where trying to do there, but I&#39;ve now updated my answer to clear the contents of that row before adding the formulas, hope this helps. :)"}, {"owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1539184835, "post_id": 52741760, "comment_id": 92411782, "body": "Thanks Xabier. Sorry to be a pain in the @$$ but I&#39;m now getting a &#39;Next without For&#39; error at the <code>Next Sh</code> line. This is clearly my VBA ignorance but I thought that with the <code>For Each Sh In ThisWorkbook.Worksheet</code> line, this was the <code>For</code> that it would link with?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "edited": false, "score": 0, "creation_date": 1539185069, "post_id": 52741760, "comment_id": 92411940, "body": "@gbra Yes you are correct, the Next Sh is for the For Each Sh in ThisWorkbook.Worksheets, I was testing this and I didn&#39;t get any such error, can you double check that you copied the code properly? Sometimes you can get this error when you don&#39;t specify and End If, but that is not the case here, so I&#39;m unsure..."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1539184305, "last_edit_date": 1539184305, "creation_date": 1539179279, "answer_id": 52741760, "question_id": 52741604, "link": "https://stackoverflow.com/questions/52741604/how-to-loop-through-worksheets-to-add-a-new-row-with-formulae-and-formatting/52741760#52741760", "title": "How to loop through worksheets to add a new row with formulae and formatting", "body": "<p>As commented by StoneGiant, you aren't actually looping through your worksheets, you are also selecting the last row, without first selecting the sheet, which gives you an error, I would also recommend not using nested With statements, not only can it get confusing, it may actually not work as intended, I believe the revised code below will help you achieve what you want:</p>\n\n<pre><code>Private Sub cmbAdd_Click()\nDim Sh As Worksheet\nDim l As Long\nDim LastRow As Long\nDim LR As Long\n\nApplication.ScreenUpdating = False\n    ' IF THERE ARE MORE THAN 103 RECORDS, ADD A NEW ROW AND COPY FORMAT AND FORMULAE\n\n    For Each Sh In ThisWorkbook.Worksheets\n        ' Use the current worksheet\n        With Sh\n            LastRow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0)    ' Find the last used row in the table\n            If LastRow &lt; 103 Then GoTo Add_Record            ' If the row number is less than 103 go to the Add_Record section otherwise add a new row and copy all formats and formulae\n            .Rows(LastRow).Insert Shift:=xlDown\n            .Cells(.Rows.Count, \"A\").End(xlUp).EntireRow.Copy\n            .Cells(.Rows.Count, \"A\").End(xlUp).EntireRow.Offset(1, 0).EntireRow.PasteSpecial xlPasteFormats\n            .Cells(.Rows.Count, \"A\").End(xlUp).EntireRow.Offset(1, 0).EntireRow.ClearContents\n            .Cells(.Rows.Count, \"A\").End(xlUp).EntireRow.Offset(1, 0).EntireRow.PasteSpecial xlPasteFormulas\n        End With\n    Next Sh     ' Cycle through to the next worksheet in the array and repeat the 'add line' procedure\n\nAdd_Record:       ' COPY NEW CHILD FROM FORM TO SPREADSHEET\n\n    LR = Sheets(\"Pupil Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Set c = Range(\"A\" &amp; LR + 1)\n\n    With Me\n        c.Value = .TextBox14.Value\n        c.Offset(0, 1).Value = .TextBox1.Value\n        c.Offset(0, 2).Value = .TextBox2.Value\n        c.Offset(0, 3).Value = .TextBox3.Value\n        c.Offset(0, 4).Value = .TextBox4.Value\n        c.Offset(0, 5).Value = .TextBox24.Value\n        c.Offset(0, 7).Value = .TextBox25.Value\n        c.Offset(0, 8).Value = .TextBox26.Value\n        c.Offset(0, 9).Value = .TextBox5.Value\n        c.Offset(0, 11).Value = .TextBox27.Value\n        c.Offset(0, 12).Value = .TextBox28.Value\n        c.Offset(0, 13).Value = .TextBox29.Value\n        c.Offset(0, 14).Value = .TextBox30.Value\n        c.Offset(0, 15).Value = .TextBox34.Value\n        c.Offset(0, 16).Value = .TextBox31.Value\n        c.Offset(0, 17).Value = .TextBox32.Value\n        c.Offset(0, 18).Value = .TextBox33.Value\n        c.Offset(0, 21).Value = .TextBox35.Value\n        Call ClearControls\n    End With\n\n' FILL EMPTY CHARACTERISTICS CELLS\n\nDim rCell As Range, rRng As Range\n\n    For Each rRng In ActiveSheet.[A4].Resize(ActiveSheet.UsedRange.Rows.Count - 2)\n        If IsEmpty(rRng) Then GoTo NextRow\n        For Each rCell In rRng.Offset(0, 7).Resize(1, 17)\n            If IsEmpty(rCell) Then rCell.Value = \"N\"\n        Next rCell\nNextRow:\n    Next rRng\n\n' SORT DATA TO INCLUDE NEW CHILD\n\n Call ResortData\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6695551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b20a65a4ee195b97f0083bdce443a620?s=128&d=identicon&r=PG&f=1", "display_name": "gbra", "link": "https://stackoverflow.com/users/6695551/gbra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539184305, "creation_date": 1539178829, "question_id": 52741604, "link": "https://stackoverflow.com/questions/52741604/how-to-loop-through-worksheets-to-add-a-new-row-with-formulae-and-formatting", "title": "How to loop through worksheets to add a new row with formulae and formatting", "body": "<p>I have a series of protected worksheets which are used to collect pupil assessment data. These are locked to prevent users from deleting formulae or causing other issues so I need to be able to add new records to the spreadsheet/database using a userform.</p>\n\n<p>I have compiled the following code using advice from other questions and my (growing) knowledge of VBA, however my knowledge is still rudimentary!</p>\n\n<p>When I try to run the code, I receive an 'Object required' error at the <code>.Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Select</code> line, as indicated. I thought that I had defined and indicated the object as <code>Sh</code> using the <code>With Sh</code> line - is this not the case?</p>\n\n<p>I have included comments in the code to try to explain what I am attempting to achieve. Can anyone shed any light on what I am doing wrong here please?</p>\n\n<pre><code>Private Sub cmbAdd_Click()\nDim Sh As Variant\nDim l As Long\n\nDim LastRow As Long\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nApplication.ScreenUpdating = False\n'ActiveSheet.Unprotect Password:=\"L1lyL1ly\"\n\n\n    ' IF THERE ARE MORE THAN 103 RECORDS, ADD A NEW ROW AND COPY FORMAT AND FORMULAE\n\n    For Each Sh In Array(\"Pupil Data\", \"RWM\", \"Art\", \"Computing\", \"Design Technology\", \"Geography\", \"History_\", \"MFL\", \"Music\", \"PE\", \"RE\", \"Science\", \"Bookbands\", \"KS1 - TRP\")\n\n    ' Use the current worksheet\n    With Sh\n\n    ' !!!!!!!!!!!! THE ERROR OCCURS ON THE NEXT LINE !!!!!!!!!!!!!!!!\n\n        .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Select    ' Find the last used row in the table\n        If .Cells(.Rows.Count) &lt; 103 Then GoTo Add_Record            ' If the row number is less than 103 go to the Add_Record section otherwise add a new row and copy all formats and formulae\n\n        .Rows(Selection.Row).Insert Shift:=xlDown\n\n        With .Cells(.Rows.Count, \"A\").End(xlUp)\n            .EntireRow.Copy\n            With .Offset(1, 0).EntireRow\n                .PasteSpecial xlPasteFormats\n                .PasteSpecial xlPasteFormulas\n                On Error Resume Next\n                .SpecialCells(xlCellTypeConstants).ClearContents\n                On Error GoTo 0\n            End With\n        End With\n    End With\nNext Sh     ' Cycle through to the next worksheet in the array and repeat the 'add line' procedure\n\nAdd_Record:   ' COPY NEW CHILD FROM FORM TO SPREADSHEET\n\nDim LR As Long\n    LR = Sheets(\"Pupil Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Set c = Range(\"A\" &amp; LR + 1)\n\n    With Me\n        c.Value = .TextBox14.Value\n        c.Offset(0, 1).Value = .TextBox1.Value\n        c.Offset(0, 2).Value = .TextBox2.Value\n        c.Offset(0, 3).Value = .TextBox3.Value\n        c.Offset(0, 4).Value = .TextBox4.Value\n        c.Offset(0, 5).Value = .TextBox24.Value\n        c.Offset(0, 7).Value = .TextBox25.Value\n        c.Offset(0, 8).Value = .TextBox26.Value\n        c.Offset(0, 9).Value = .TextBox5.Value\n        c.Offset(0, 11).Value = .TextBox27.Value\n        c.Offset(0, 12).Value = .TextBox28.Value\n        c.Offset(0, 13).Value = .TextBox29.Value\n        c.Offset(0, 14).Value = .TextBox30.Value\n        c.Offset(0, 15).Value = .TextBox34.Value\n        c.Offset(0, 16).Value = .TextBox31.Value\n        c.Offset(0, 17).Value = .TextBox32.Value\n        c.Offset(0, 18).Value = .TextBox33.Value\n        c.Offset(0, 21).Value = .TextBox35.Value\n        Call ClearControls\n    End With\n\n' FILL EMPTY CHARACTERISTICS CELLS\n\nDim rCell   As Range, _\n        rRng    As Range\n\n    For Each rRng In ActiveSheet.[A4].Resize(ActiveSheet.UsedRange.Rows.Count - 2)\n        If IsEmpty(rRng) Then GoTo NextRow\n        For Each rCell In rRng.Offset(0, 7).Resize(1, 17)\n            If IsEmpty(rCell) Then rCell.Value = \"N\"\n        Next rCell\nNextRow:\n    Next rRng\n\n' SORT DATA TO INCLUDE NEW CHILD\n\n Call ResortData\n\nApplication.ScreenUpdating = True\n'ActiveSheet.Protect \"L1lyL1ly\", _                      'Remove the ' from the start of the line when password protected\n    'AllowFiltering:=True, _\n    'AllowSorting:=True, _\n    'AllowFormattingColumns:=True, _\n    'AllowFormattingRows:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8102422, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tLZqWVDbIKE/AAAAAAAAAAI/AAAAAAAAG04/7bB2w7ns84o/photo.jpg?sz=128", "display_name": "Franco", "link": "https://stackoverflow.com/users/8102422/franco"}, "edited": false, "score": 0, "creation_date": 1539179981, "post_id": 52741818, "comment_id": 92408659, "body": "thanks! but in that case I will have to write a sub for each chart... I was hoping to find a common solution"}, {"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "reply_to_user": {"reputation": 53, "user_id": 8102422, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tLZqWVDbIKE/AAAAAAAAAAI/AAAAAAAAG04/7bB2w7ns84o/photo.jpg?sz=128", "display_name": "Franco", "link": "https://stackoverflow.com/users/8102422/franco"}, "edited": false, "score": 0, "creation_date": 1539182017, "post_id": 52741818, "comment_id": 92409940, "body": "Aha! I modified it a little bit so it can be assigned to other charts as well."}], "tags": [], "owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "is_accepted": true, "score": 2, "last_activity_date": 1539181908, "last_edit_date": 1539181908, "creation_date": 1539179465, "answer_id": 52741818, "question_id": 52740414, "link": "https://stackoverflow.com/questions/52740414/how-to-unlock-a-chart-and-forbid-cutting-it/52741818#52741818", "title": "How to unlock a chart and forbid cutting it?", "body": "<p>You can assign a sub routine on that chart:</p>\n\n<pre><code>Private Sub Chart1_Click()\n    ActiveSheet.ChartObjects(1).CopyPicture\n    MsgBox \"Chart copied.\"\nEnd Sub\n</code></pre>\n\n<p>Since you're going to use it on multiple charts, you need to identify the name of the chart first:</p>\n\n<pre><code>Sub Chart_Click()\n\n    Dim chartName As String\n\n    chartName = ActiveSheet.Shapes(Application.Caller).Name\n    ActiveSheet.ChartObjects(chartName).CopyPicture\n    MsgBox \"Chart copied.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8102422, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tLZqWVDbIKE/AAAAAAAAAAI/AAAAAAAAG04/7bB2w7ns84o/photo.jpg?sz=128", "display_name": "Franco", "link": "https://stackoverflow.com/users/8102422/franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52741818, "answer_count": 1, "score": 1, "last_activity_date": 1539181908, "creation_date": 1539174916, "question_id": 52740414, "link": "https://stackoverflow.com/questions/52740414/how-to-unlock-a-chart-and-forbid-cutting-it", "title": "How to unlock a chart and forbid cutting it?", "body": "<p>I have an excel sheet containing several charts &amp; tables, the sheet is protected and all charts are locked.</p>\n\n<p>I would like to make it possible for the users to copy the charts.\nEither by right clicking and selecting copy or by triggering a macro at when clicking or double clicking a chart.</p>\n\n<p>I've tried playing around with the locked property of a chart &amp; the <code>ActiveChart.ProtectSelection</code> but if the chart is unlocked or selectable the users are still able to cut the chart away from the sheet.</p>\n\n<p>Assigning a macro to the chart also doesn't solve the problem as I haven't found a way to find out what chart has been clicked (and if possible I would avoid having to write a separatate sub for each chart..). </p>\n\n<p>I've tried using the <code>Chart1_BeforeDoubleClick</code> event but I can't get it to work (does it only work in a chart worksheet?)</p>\n\n<p>thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 5, "creation_date": 1539172832, "post_id": 52739762, "comment_id": 92404017, "body": "Merging cells is almost always a bad idea. Is there a real big need to do so? Adding your data as a table is perfectly fine, but adding column Letters can be helpfull"}, {"owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539187475, "post_id": 52739762, "comment_id": 92413379, "body": "Actually yes, coz I need to be able to just filter the customer and see all the other fields simultaneously. Even the raw data i have given above is the result of combining 3 different table with a particular logic."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539193718, "post_id": 52739836, "comment_id": 92416750, "body": "you are the savior. I assume xI in your code is typo and corrected it to 1 and the result works like a charm! Thanks a ton :)"}], "tags": [], "owner": {"reputation": 385, "user_id": 9564026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ricards Porins", "link": "https://stackoverflow.com/users/9564026/ricards-porins"}, "is_accepted": true, "score": 2, "last_activity_date": 1539175988, "last_edit_date": 1539175988, "creation_date": 1539173004, "answer_id": 52739836, "question_id": 52739762, "link": "https://stackoverflow.com/questions/52739762/merge-cells-with-same-data-in-adjacent-rows-over-two-columns/52739836#52739836", "title": "Merge cells with same data in adjacent rows over two columns", "body": "<p>Agree with the comment from Luuklag, merging cells is slippery slope, you could put your data into a <strong>pivot table</strong> and then just format it.</p>\n\n<p>Also</p>\n\n<pre><code>Set Rng = Range(\"B2:B21\")\nxRows = Rng(Rng.Count).Row\nFor i = 1 To xRows - 1\nFor j = i + 1 To xRows\n    If Rng.Cells(i, 1).Value &lt;&gt; Rng.Cells(j, 1).Value Then\n        Exit For\n    End If\nNext\nRange(\"B2\").Parent.Range(Rng.Cells(i, 1), Rng.Cells(j - 1, 1)).Merge\n\n'Merging 2nd column\nSet SubRng = Range(\"B2\").Parent.Range(Rng.Cells(i, 2), Rng.Cells(j - 1, 2))\ni = j - 1 ' dirty fix jumping i to correct range\nMsgBox SubRng.Address\nSubxRows = SubRng(SubRng.Count).Row\nFor l = xI To SubxRows - 1\n    For m = l + 1 To SubxRows\n        If m &gt; SubRng.Count Then Exit For\n\n        If SubRng.Cells(l, 1).Value &lt;&gt; SubRng.Cells(m, 1).Value Then\n            Exit For\n        End If\n    Next\n     Range(\"B2\").Parent.Range(SubRng.Cells(l, 1), SubRng.Cells(m - 1, 1)).Merge ' moved this line\nNext\n\nNext\n</code></pre>\n\n<p>The merge code needed to be outside of the \"For\" loop, just tested it and realized your loops need a tweak added a dirty quick fix to jump variable \"i\", this should work now. </p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539189775, "post_id": 52743340, "comment_id": 92414737, "body": "Hey @DisplayName How about the second column? Similar elements there need to be merged as well for the respective customer.... Also you solution seems like the data needs to be all in fixed places. My actual data is dynamic and the range may vary. Thanks for taking a look anyways."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539191394, "post_id": 52743340, "comment_id": 92415616, "body": "1) <i>&quot;How about the second column? Similar elements there need to be merged as well for the respective customer&quot;</i>: the &quot;after&quot; image was wrong, I edited with the correct image, while the code stays ok. 2) <i>&quot;Also you solution seems like the data needs to be all in fixed places.&quot;</i>: my solution expects data as you showed them in your question example (left of the arrow). So you may want to try it and then watch what happens"}, {"owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539200902, "post_id": 52743340, "comment_id": 92419979, "body": "Thank you! But i was looking for a dynamic code and @Ricards solution is inline with my code! Thanks again for your time and an innovative solution :)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539201936, "post_id": 52743340, "comment_id": 92420463, "body": "You are welcome. But could you explain what\u2019s dynamic in Ricards solution that isn\u2019t in mine? Thank you"}, {"owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 1, "creation_date": 1539242641, "post_id": 52743340, "comment_id": 92432269, "body": "After i just tried your macro, i see that it only removes the duplicates but does not actually merge! Also could you explain what is the actual logic applied here? By dynamic i mean the my data range is not restricted to number of rows and columns and variables. It actually varies and when i tried your macro over a different data set it did not produce result as expected! Here are some of data samples <a href=\"https://drive.google.com/file/d/1FQ09baQkJ8jZyvvqzQCThVzpzwqWsm-i/view?usp=drivesdk\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1FQ09baQkJ8jZyvvqzQCThVzpzwqWsm-i/&hellip;</a>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539243672, "post_id": 52743340, "comment_id": 92432808, "body": "1) <i>&quot; i see that it only removes the duplicates but does not actually merge! &quot;</i> -&gt; that&#39;s my exact answer preface <i>&quot;I&#39;d advice you not to merge anything and keep your data in place while properly formatting them to mimic merge&quot;</i> Data are kept in place and only &quot;hidden&quot; to mimic merge operation. Merging is something you want to avoid as much as possible"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539243738, "post_id": 52743340, "comment_id": 92432839, "body": "2) <i>&quot;Also could you explain what is the actual logic applied here?&quot;</i> -&gt;  Data are kept in place and only &quot;hidden&quot; to <i>mimic</i> merge operation. Merging is something you want to avoid as much as possible"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539244197, "post_id": 52743340, "comment_id": 92433059, "body": "3) <i>&quot;By dynamic i mean the my data range is not restricted to number of rows and columns and variables.&quot;</i> just adjust range references to your need. Just as you have to do with Ricards code (where it assumes a hard coded <code>Range(&quot;B2:B21&quot;)</code> range"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539244979, "post_id": 52743340, "comment_id": 92433466, "body": "4) &quot; i tried your macro over a different data set it did not produce result as expected! &quot; you only have to set the range references accordingly (as you have to do with Ricard code). For example, for your first data sample on the left you have to change all &quot;8&quot;s to &quot;13&quot;s (i.e. change <code>With Range(&quot;C3:E8&quot;)...</code> to <code>With Range(&quot;C3:E13&quot;)</code>, and so on)"}, {"owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539248685, "post_id": 52743340, "comment_id": 92435569, "body": "Ahh... I see the intention behind this macro. It works after correcting the range. This could definitely be useful. But in my case merge is like inevitable. The idea is that when you merge i can easily select all the details needed for a specific customer and the presentation in report is attractive. But i have to say your code is indeed quick and elegant. Definitely a thumbs up :) Thanks again!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "edited": false, "score": 0, "creation_date": 1539250022, "post_id": 52743340, "comment_id": 92436439, "body": "you are welcome. but let me tell you once more that <i>merge is hell</i> !"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1539191297, "last_edit_date": 1539191297, "creation_date": 1539184054, "answer_id": 52743340, "question_id": 52739762, "link": "https://stackoverflow.com/questions/52739762/merge-cells-with-same-data-in-adjacent-rows-over-two-columns/52743340#52743340", "title": "Merge cells with same data in adjacent rows over two columns", "body": "<p>I'd advice you not to merge anything and keep your data in place while properly formatting them to mimic merge</p>\n\n<p>as follows (assuming data in B2:E8, and headers in B2:E2)</p>\n\n<pre><code>Option Explicit\n\nSub MimicMerge()\n\n    With Range(\"C3:E8\").FormatConditions.Add(Type:=xlExpression, Formula1:=\"=$C3&lt;&gt;$C2\")\n        .Borders(xlTop).LineStyle = xlContinuous\n        .StopIfTrue = False\n    End With\n\n    With Range(\"C3:C8\").FormatConditions.Add(Type:=xlExpression, Formula1:=\"=AND($C3=$C2;$B3=$B2)\")\n        .Font.ThemeColor = xlThemeColorDark1\n        .StopIfTrue = False\n    End With\n\n    With Range(\"B3:E8\").FormatConditions.Add(Type:=xlExpression, Formula1:=\"=$B3&lt;&gt;$B2\")\n        .Borders(xlTop).LineStyle = xlContinuous\n        .StopIfTrue = False\n    End With\n\n    With Range(\"B3:B8\").FormatConditions.Add(Type:=xlExpression, Formula1:=\"=$B3=$B2\")\n        .Font.ThemeColor = xlThemeColorDark1\n        .StopIfTrue = False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>before</p>\n\n<p><a href=\"https://i.stack.imgur.com/1gPpj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1gPpj.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>after</p>\n\n<p><a href=\"https://i.stack.imgur.com/0bgMy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0bgMy.jpg\" alt=\"![enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1539192298, "creation_date": 1539192298, "answer_id": 52745715, "question_id": 52739762, "link": "https://stackoverflow.com/questions/52739762/merge-cells-with-same-data-in-adjacent-rows-over-two-columns/52745715#52745715", "title": "Merge cells with same data in adjacent rows over two columns", "body": "<p>Try this code (necessary comments in code):</p>\n\n<pre><code>Sub MergeCells()\n    ' to prevent warnings from showing - we would get when merging\n    Application.DisplayAlerts = False\n    Dim lastRow As Long, i As Long, firstColumn As Long, firstRow As Long, startMergeRow1 As Long, startMergeRow2 As Long\n    ' first column is A\n    firstColumn = 1\n    ' data starts in second row\n    firstRow = 2\n    lastRow = Cells(Rows.Count, firstColumn).End(xlUp).Row\n    startMergeRow1 = firstRow\n    startMergeRow2 = firstRow\n\n    For i = 2 To lastRow\n        ' if values in first column differ, then merge first and second column\n        If Cells(i, firstColumn) &lt;&gt; Cells(i + 1, firstColumn) Then\n            Range(Cells(startMergeRow1, firstColumn), Cells(i, firstColumn)).Merge\n            Range(Cells(startMergeRow2, firstColumn + 1), Cells(i, firstColumn + 1)).Merge\n            startMergeRow1 = i + 1\n            startMergeRow2 = i + 1\n        ' if values in second column differ, then merge only second column\n        ElseIf Cells(i, firstColumn + 1) &lt;&gt; Cells(i + 1, firstColumn + 1) Then\n            Range(Cells(startMergeRow2, firstColumn + 1), Cells(i, firstColumn + 1)).Merge\n            startMergeRow2 = i + 1\n        End If\n    Next\n\n    ' turn showing warnings on again\n    Application.DisplayAlerts = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5993149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50eb1cae07c3f8eba832ae64f6874572?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik", "link": "https://stackoverflow.com/users/5993149/kaushik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 52739836, "answer_count": 3, "score": 3, "last_activity_date": 1539192340, "creation_date": 1539172762, "last_edit_date": 1539192340, "question_id": 52739762, "link": "https://stackoverflow.com/questions/52739762/merge-cells-with-same-data-in-adjacent-rows-over-two-columns", "title": "Merge cells with same data in adjacent rows over two columns", "body": "<p>I am looking to merge the cells with same data;</p>\n\n<p>I would like to merge the cells with similar values as below in excel;</p>\n\n<pre><code>  |---------------------------|             |----------------------------|\n  |Customer | FG | RPL   | DC |             |Customer | FG | RPL   | DC  |\n  |---------+----+-------+----|             |---------+----+-------+-----|\n  |A        | x  | alpha | 1  |             |A        | x  | alpha | 1   |\n  |A        | x  | gamma | 5  |     ----&gt;   |         |    | gamma | 5   |\n  |A        | y  | alpha | 4  |             |         +----+-------+-----|\n  |A        | y  | gamma | NA |             |         | y  | alpha | 4   |\n  |B        | x  | gamma | 5  |             |         |    | gamma | NA  |\n  |C        | x  | alpha | 1  |             |---------+----+-------+-----|\n  |---------------------------|             |B        | x  | gamma | 5   |\n                                            |---------+----+-------+-----|\n                                            |C        | x  | alpha | 1   |\n                                            |----------------------------|\n</code></pre>\n\n<p>I tried this code but it won't merge the second column.</p>\n\n<pre><code>Set Rng = Range(\"B2:B8\")\nxRows = Rng(Rng.Count).Row\nFor i = 1 To xRows - 1\n    For j = i + 1 To xRows\n        If Rng.Cells(i, 1).Value &lt;&gt; Rng.Cells(j, 1).Value Then\n            Exit For\n        End If\n    Next\n    Range(\"B2\").Parent.Range(Rng.Cells(i, 1), Rng.Cells(j - 1, 1)).Merge\n\n    'Merging 2nd column\n    Set SubRng = Range(\"B2\").Parent.Range(Rng.Cells(i, 2), Rng.Cells(j - 1, 2))\n    MsgBox SubRng.Address\n    SubxRows = SubRng(SubRng.Count).Row\n    For l = i To SubxRows - 1\n        For m = l + 1 To SubxRows\n            If SubRng.Cells(l, 1).Value &lt;&gt; SubRng.Cells(m, 1).Value Then\n                Exit For\n            End If\n            Range(\"B2\").Parent.Range(SubRng.Cells(l, 1), SubRng.Cells(m - 1, 1)).Merge\n        Next\n    Next\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1435, "user_id": 6123961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hvp2R.png?s=128&g=1", "display_name": "L&#233;opold Houdin", "link": "https://stackoverflow.com/users/6123961/l%c3%a9opold-houdin"}, "edited": false, "score": 1, "creation_date": 1539171093, "post_id": 52739177, "comment_id": 92402978, "body": "What have you tried so far?"}, {"owner": {"reputation": 11, "user_id": 5695395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e84d5a6637627ee8627014f407cd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5695395/yusuf"}, "reply_to_user": {"reputation": 1435, "user_id": 6123961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hvp2R.png?s=128&g=1", "display_name": "L&#233;opold Houdin", "link": "https://stackoverflow.com/users/6123961/l%c3%a9opold-houdin"}, "edited": false, "score": 0, "creation_date": 1539171398, "post_id": 52739177, "comment_id": 92403140, "body": "I am able to highlight duplicates but in my case every entry is duplicate so can&#39;t highlight and delete."}, {"owner": {"reputation": 385, "user_id": 9564026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ricards Porins", "link": "https://stackoverflow.com/users/9564026/ricards-porins"}, "edited": false, "score": 2, "creation_date": 1539173262, "post_id": 52739177, "comment_id": 92404279, "body": "Your output and explanation do not match, form your explanation the output would be nil"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1539174030, "post_id": 52739177, "comment_id": 92404803, "body": "Why can&#39;t you highlight and delete - your comment says it highlights the duplicates correctly which in this case is all of them, but I can&#39;t see how that stops you from deleting all of them?  If it&#39;s a case of it shouldn&#39;t be highlighting them all then you need to change your parameters for what constitutes a duplicate."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539174346, "post_id": 52739177, "comment_id": 92404989, "body": "You say <code>If the values in column1 matches any cell in column2, the row should be deleted</code> yet in your example, the output includes <code>AB CD</code> even though <code>CD</code> is in column 22 (you said <i>any</i> cell)...  same for the the other example output.  You should probably re-think your explanation."}, {"owner": {"reputation": 11, "user_id": 5695395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e84d5a6637627ee8627014f407cd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5695395/yusuf"}, "edited": false, "score": 0, "creation_date": 1539177410, "post_id": 52739177, "comment_id": 92407022, "body": "May be I was not able to express my problem, I have edited the explanation for easier understanding."}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1539178005, "post_id": 52739177, "comment_id": 92407386, "body": "I made a clarification edit to the OP&#39;s question. Hopefully the clarification is correct and helps show why his output actually make sense."}], "answers": [{"tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": false, "score": 0, "last_activity_date": 1539178406, "creation_date": 1539178406, "answer_id": 52741458, "question_id": 52739177, "link": "https://stackoverflow.com/questions/52739177/compare-two-columns-in-excel-and-delete-the-duplicate-row/52741458#52741458", "title": "Compare two columns in excel and delete the duplicate row", "body": "<p>Try this...</p>\n\n<pre><code>Dim firstCell as Range\nDim secondCell as Range\n\nFor Each firstCell in Intersect(ActiveSheet.UsedRange, Range(\"A:A\"))\n    For Each secondCell in Intersect(ActiveSheet.UsedRange, Range(\"B:B\"))\n        If firstCell.Value = secondCell.Value Then\n            secondCell.EntireRow.Delete\n        End If\n    Next\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1539180585, "last_edit_date": 1539180585, "creation_date": 1539179867, "answer_id": 52741948, "question_id": 52739177, "link": "https://stackoverflow.com/questions/52739177/compare-two-columns-in-excel-and-delete-the-duplicate-row/52741948#52741948", "title": "Compare two columns in excel and delete the duplicate row", "body": "<p>I know that when I've run into these scenarios, I've always ended up kicking myself for deleting data. I always advocate TESTING data more thoroughly before I just decide to terminate something. So, even though I think the VBA approach is elegant, I would go for an equation approach first, and give myself some easy flags for a mass-deletion. Equations below, and in picture.</p>\n\n<p><a href=\"https://i.stack.imgur.com/R8teu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R8teu.png\" alt=\"Illustration of how testing data would allow sort/filter action\"></a></p>\n\n<p>Column C testing if this is the first occurrence of data:</p>\n\n<pre><code>=IFERROR(IF(ROW(A2)&lt;MATCH(A2,B:B,0),\"First\",\"Duplc\"),\"First\")\n</code></pre>\n\n<p>Column D, testing if this is the first occurrence of a data:</p>\n\n<pre><code>=IFERROR(IF(ROW(B2)&lt;MATCH(B2,A:A,0),\"First\",\"Duplc\"),\"First\")\n</code></pre>\n\n<p>Column E, testing for First/First, Duplicate/Duplicate, or new single first occurances of data:</p>\n\n<pre><code>=IF(AND(C2=\"First\",D2=\"First\"),\"Keep\",IF(AND(C2=\"Duplc\",D2=\"Duplc\"),\"Delete\",\"Review\"))\n</code></pre>\n\n<p>Any time I would see a \"Review\" cell, I'd test to make sure that I'm not deleting a valuable data point. Your data may be more simple than what I'm doing here, but I've regretted the ultra-powerful mass deletion.</p>\n"}], "owner": {"reputation": 11, "user_id": 5695395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e84d5a6637627ee8627014f407cd9e?s=128&d=identicon&r=PG&f=1", "display_name": "Yusuf", "link": "https://stackoverflow.com/users/5695395/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1082, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539180585, "creation_date": 1539170768, "last_edit_date": 1539177365, "question_id": 52739177, "link": "https://stackoverflow.com/questions/52739177/compare-two-columns-in-excel-and-delete-the-duplicate-row", "title": "Compare two columns in excel and delete the duplicate row", "body": "<p>I have below data in two columns in excel:</p>\n\n<pre><code>AB  CD\n\nEF  GH\n\nCD  AB\n\nGH  EF\n</code></pre>\n\n<p>If the values in column1 matches any cell in column2, the row should be deleted. Starting from cell A1, the duplicate value is found in B3 so 3rd row is deleted. Moving on to A2, the duplicate value is found in B4 so 4th row is deleted.</p>\n\n<p>Output should be </p>\n\n<pre><code>AB  CD\n\nEF  GH\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1539170613, "post_id": 52739045, "comment_id": 92402685, "body": "Help us to help you; <b>on which line of code does the macro fail ??</b>"}, {"owner": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 2, "creation_date": 1539170831, "post_id": 52739045, "comment_id": 92402818, "body": "Does this help?  <a href=\"https://stackoverflow.com/questions/14053873/runtime-error-5-invalid-procedure-call-or-argument\">Runttime error 5 invalid procedure call or argument</a>.  In fact there are a few questions answered on SO on this very topic if you search..."}, {"owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1539170840, "post_id": 52739045, "comment_id": 92402824, "body": "@Gary&#39;sStudent Ahh, it&#39;s line 9; &#39;ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=desktoppath &amp; &quot;\\&quot; &amp; _ flenm &amp; &quot;.pdf&quot;, OpenAfterPublish:=True&#39;"}, {"owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "reply_to_user": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 0, "creation_date": 1539171477, "post_id": 52739045, "comment_id": 92403183, "body": "@Ian I have checked out most of the answers on here but none of them seem to work, and I&#39;ve certainly not seen one regarding it not working on different machines. However, if you can see a place on SO where it&#39;s already been answered it would be helpful!   Just tried the code from the answer you suggested but it still threw the same error sadly."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539171657, "post_id": 52739045, "comment_id": 92403294, "body": "Does it work when you turn open after publish into false?"}, {"owner": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 0, "creation_date": 1539171668, "post_id": 52739045, "comment_id": 92403302, "body": "If you have further information, including what you&#39;ve tried, you should make sure that&#39;s added to the question so other new readers can find it easily (without having to trawl through comments) ;)  On the problem, one answer suggested that the path was too long - in your case this could affect different machines..."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539171700, "post_id": 52739045, "comment_id": 92403322, "body": "Also, do the desktop path&#39;s get printed correctly into your messageboxes?"}, {"owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539171932, "post_id": 52739045, "comment_id": 92403452, "body": "@Luuklag the &#39;open after publish&#39; change doesn&#39;t work sadly, and the path is correct, even on others machines."}, {"owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "reply_to_user": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 0, "creation_date": 1539172039, "post_id": 52739045, "comment_id": 92403532, "body": "@Ian Good shout, I&#39;ll update the answer! I don&#39;t think it&#39;s an issue with the path being too long (I did find that in another question) because the admin username is the longest out of all of them and it worked in that instance. Unless there would be something else that effects the length of the path I&#39;m not sure..."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539172354, "post_id": 52739045, "comment_id": 92403722, "body": "please have a look at <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and improve your question accordingly"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1539174705, "post_id": 52739045, "comment_id": 92405212, "body": "There is nothing wrong with the question. Like OP said, the code works fine for some computers but not for others, how much more explanation would you require. BTW the code works fine for me as well. Before the export line use <code>msgbox desktoppath &amp; &quot;\\&quot; &amp; flenm &amp; &quot;.pdf&quot;</code>, make sure there is no punctuation in the string. Also there may be a different way to get the dektop addres such as <code>fileNm = Environ(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop&quot;</code>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1152, "user_id": 4078718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7090024e46e43bf86eace985087357e0?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4078718/ian"}, "edited": false, "score": 1, "creation_date": 1539174919, "post_id": 52739045, "comment_id": 92405361, "body": "You are saying that the error is thrown with Excel 2007, right? Is it possible that you need for this version to install a <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=7\" rel=\"nofollow noreferrer\">plugin</a> being able to export to PDF. Also said int <a href=\"https://stackoverflow.com/questions/14053873/runtime-error-5-invalid-procedure-call-or-argument\">link</a> @Ian provided"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1539175233, "post_id": 52739045, "comment_id": 92405550, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14053873/runtime-error-5-invalid-procedure-call-or-argument\">Runtime Error : 5, Invalid Procedure call or argument</a>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1539175562, "post_id": 52739045, "comment_id": 92405761, "body": "@Storax- OP wants to save the workbook to the users desktop also xl 2007 started using saveas pdf"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1539176474, "post_id": 52739045, "comment_id": 92406409, "body": "@Davesexcel: Sorry, I am not sure what you mean maybe because of my English. My understanding is that the OP wants to export the Activesheet as PDF and that this is not working on several computers with Excel 2007. So, my guess is that on these computers the <i>2007 Microsoft Office Add-in: Microsoft Save as PDF or XPS</i> plugin is missing."}, {"owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "edited": false, "score": 0, "creation_date": 1539176481, "post_id": 52739045, "comment_id": 92406414, "body": "I can&#39;t actually edit the question; it won&#39;t allow me to for some reason."}, {"owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1539176814, "post_id": 52739045, "comment_id": 92406635, "body": "@Storax that sounds like a likely issue - I will test that and let you know"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1539177175, "post_id": 52739045, "comment_id": 92406863, "body": "Also something to think about, if the computers do not have any print driver installed, the saveas pdf will not work."}], "answers": [{"tags": [], "owner": {"reputation": 18, "user_id": 7015101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TP12f.jpg?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/7015101/julian"}, "is_accepted": true, "score": 0, "last_activity_date": 1539180754, "creation_date": 1539180754, "answer_id": 52742235, "question_id": 52739045, "link": "https://stackoverflow.com/questions/52739045/vba-run-time-error-5-invalid-procedure-call-or-argument-presenting-a-problem-o/52742235#52742235", "title": "VBA Run-time error &#39;5&#39; invalid procedure call or argument presenting a problem on certain machines when creating a .pdf with VBA", "body": "<p>I'm not allowed to answer my own question for some reason (I wasn't allowed to edit my answer either). </p>\n\n<p>I have found the answer based on suggestions given. The problem was the lack of this; </p>\n\n<p><a href=\"http://www.microsoft.com/en-gb/download/details.aspx?id=7\" rel=\"nofollow noreferrer\">http://www.microsoft.com/en-gb/download/details.aspx?id=7</a></p>\n\n<p>on the end users machines. We have tested it now and it works fine. </p>\n"}], "owner": {"reputation": 3, "user_id": 10296057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea22ae0cdb6ef92ed3aaaaac2ab14d4?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/10296057/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2156, "favorite_count": 1, "accepted_answer_id": 52742235, "answer_count": 1, "score": 0, "last_activity_date": 1593699382, "creation_date": 1539170332, "last_edit_date": 1593699382, "question_id": 52739045, "link": "https://stackoverflow.com/questions/52739045/vba-run-time-error-5-invalid-procedure-call-or-argument-presenting-a-problem-o", "title": "VBA Run-time error &#39;5&#39; invalid procedure call or argument presenting a problem on certain machines when creating a .pdf with VBA", "body": "<p>I've created an ActiveX button in Excel that should create a PDF document on the users desktop: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'file name as a cell value\nDim flenm As Range\n'path to the users desktop\nDim desktoppath As String\n\nSet flenm = Sheet1.Range(\"D21\")\ndesktoppath = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\")\n\n\n' pdf creation\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=desktoppath &amp; \"\\\" &amp; _\nflenm &amp; \".pdf\", OpenAfterPublish:=True\n\n\n' confirmation\nMsgBox (\"The PDF should be saved on your desktop as '\" &amp; flenm &amp; \".pdf'.\" &amp; vbNewLine _\n&amp; \" If you have issues with this, please let me know.\" &amp; vbNewLine _\n&amp; \" Save Location: \" &amp; desktoppath)\nEnd Sub\n</code></pre>\n\n<p>It works fine on my computer (Windows 7, Excel 2007, non-admin) and on one of my colleagues computer (Windows 10, Excel 2016, admin), but other than that on all the other machines I've tested (all Windows 7, Excel 2007, non-admin), it throws a Run-time error '5': invalid procedure. </p>\n\n<p>I can't work out what the issue is. Could it be something to do with having different PDF software, or something to do with permissions (although we've tried setting them all to be exactly the same), or just an error with the code? </p>\n\n<p>At any rate if anyone has any idea I would love to hear. If more information is required, please just ask. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 4, "creation_date": 1539170382, "post_id": 52738815, "comment_id": 92402574, "body": "I tried your code on some random data and both of the commands seem to work. Try to do a <code>debug.print datosGrafico.address</code> and check if it contains the desired range."}, {"owner": {"reputation": 111, "user_id": 6094347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2R60i.jpg?s=128&g=1", "display_name": "jinfo", "link": "https://stackoverflow.com/users/6094347/jinfo"}, "reply_to_user": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 0, "creation_date": 1539175567, "post_id": 52738815, "comment_id": 92405765, "body": "It shows: &quot;$Z$2:$AC$5&quot; which is correct. Which Office version do u have? Because I saw it works on 2010 but not on my 2016... Thanks! I added an snapshot in case it helps!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1539176403, "post_id": 52738815, "comment_id": 92406369, "body": "Was the sheet containing the chart active when you ran the code?  <code>dataosGrafico</code> will get it&#39;s data from whichever sheet is active when the code runs and it will look for a chart on the same sheet.  Try fully qualifying which sheet everything&#39;s on.... <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).ChartObjects....</code>"}, {"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "edited": false, "score": 0, "creation_date": 1539239566, "post_id": 52738815, "comment_id": 92430702, "body": "What about the <code>datosGrafico = Range(Range(&quot;Z2&quot;), Range(&quot;Z2&quot;).End(xlToRight).End(xlDown))</code> ? Is the sheet active where the data is placed?"}, {"owner": {"reputation": 111, "user_id": 6094347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2R60i.jpg?s=128&g=1", "display_name": "jinfo", "link": "https://stackoverflow.com/users/6094347/jinfo"}, "edited": false, "score": 0, "creation_date": 1539240805, "post_id": 52738815, "comment_id": 92431309, "body": "yes, of course, always active, i tried deleting all  other sheets too..."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 6094347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2R60i.jpg?s=128&g=1", "display_name": "jinfo", "link": "https://stackoverflow.com/users/6094347/jinfo"}, "is_accepted": true, "score": 0, "last_activity_date": 1539258509, "creation_date": 1539258509, "answer_id": 52759325, "question_id": 52738815, "link": "https://stackoverflow.com/questions/52738815/change-source-data-on-an-existing-chart-vba/52759325#52759325", "title": "Change Source data on an existing Chart (VBA)", "body": "<p>The new \"Pareto\" Chart on Excel 2016 is not compatible with this. So I did a \"homemade\" \"Pareto\" merging a normal column and linear charts to have \"permission\" to use the same code... And works, as always did. I think Pareto is some kind of protected chart.</p>\n"}], "owner": {"reputation": 111, "user_id": 6094347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2R60i.jpg?s=128&g=1", "display_name": "jinfo", "link": "https://stackoverflow.com/users/6094347/jinfo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 52759325, "answer_count": 1, "score": 0, "last_activity_date": 1539258509, "creation_date": 1539169563, "last_edit_date": 1539175618, "question_id": 52738815, "link": "https://stackoverflow.com/questions/52738815/change-source-data-on-an-existing-chart-vba", "title": "Change Source data on an existing Chart (VBA)", "body": "<p>I have an existing chart, named GRAFICO_PARETO.\nThis chart has a source data, let's say from A1 to G20 for example, and I want to change that range to another one but not from the front-end of Excel, but from vba.\nThe code I tried is like:</p>\n\n<pre><code>Dim datosGrafico As Range\nSet datosGrafico = Range(Range(\"Z2\"), Range(\"Z2\").End(xlToRight).End(xlDown))\n\n ActiveSheet.ChartObjects(\"GRAFICO_PARETO\").Chart.SetSourceData Source:=datosGrafico\n</code></pre>\n\n<p>But there's something Wrong, because I get an '445' error on execution time in the last code line.</p>\n\n<p>I'm doing this on Microsoft Excel 2016 in spanish.</p>\n\n<p>Thanks for your support.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vqy3c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vqy3c.png\" alt=\"CAPTURE\"></a></p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1539171853, "post_id": 52738569, "comment_id": 92403409, "body": "How many levels of nesting do you have in your actual data? This could get complicated."}, {"owner": {"reputation": 157, "user_id": 9397552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Edward144", "link": "https://stackoverflow.com/users/9397552/edward144"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1539172845, "post_id": 52738569, "comment_id": 92404027, "body": "At most it will be 4"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539174531, "post_id": 52738569, "comment_id": 92405118, "body": "I think it would be best to first determine the actual level of each subpart. This can get complicated as one needs to know what either the deepest, or the top most part is, which is hard to interpret from such a list of data. Would be best to have this at some fixed place when possible."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539179918, "post_id": 52738569, "comment_id": 92408611, "body": "Well, you can use some sort of back tracing mechanism for each item. Not the most efficient way to do it but it does work without knowing any fix points nor does it need information about the level depth. The deeper the levels get the more inefficient this method is. See my answer."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1539180223, "last_edit_date": 1539180223, "creation_date": 1539179374, "answer_id": 52741800, "question_id": 52738569, "link": "https://stackoverflow.com/questions/52738569/loop-through-a-range-to-create-a-tree-of-nested-data/52741800#52741800", "title": "Loop through a range to create a tree of nested data", "body": "<p>I suggest looping through your list of <code>Top Level Part</code> and <code>Sub Part</code> and use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction.Match\" rel=\"nofollow noreferrer\">WorksheetFunction.Match Method</a> to backwards trace the path of each entry.</p>\n\n<p>Outgoing from this list <code>Worksheets(\"List\")</code>:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/j0kyI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j0kyI.png\" alt=\"enter image description here\"></a></p>\n\n<p>It will return <code>Worksheets(\"Output\")</code>:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/HL14Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HL14Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Which only needs to be sorted by columns A B C and D to get the tree view character.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FindPathway()\n    Dim wsList As Worksheet\n    Set wsList = ThisWorkbook.Worksheets(\"List\")\n\n    Dim wsOutput As Worksheet\n    Set wsOutput = ThisWorkbook.Worksheets(\"Output\")\n\n    Dim LastRow As Long\n    LastRow = wsList.Cells(wsList.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim OutputRow As Long, oCol As Long\n    OutputRow = 2\n\n    Dim PathCol As Collection\n    Dim FoundRow As Long\n\n    Dim iRow As Long, cRow As Long\n    For iRow = 2 To LastRow\n        cRow = iRow\n        Set PathCol = New Collection\n        PathCol.Add wsList.Cells(cRow, \"B\").Value\n\n        Do 'loop until a root item is found\n            FoundRow = 0\n            On Error Resume Next\n                FoundRow = WorksheetFunction.Match(wsList.Cells(cRow, \"A\"), wsList.Columns(\"B\"), 0)\n            On Error GoTo 0\n\n            If FoundRow = 0 Then\n                'is a root\n                PathCol.Add wsList.Cells(cRow, \"A\").Value\n                For oCol = 0 To PathCol.Count - 1 'output all remembered items\n                    wsOutput.Cells(OutputRow, oCol + 1).Value = PathCol.Item(PathCol.Count - oCol)\n                Next oCol\n                OutputRow = OutputRow + 1\n            Else\n                'is a child\n                PathCol.Add wsList.Cells(cRow, \"A\").Value 'remember item\n                cRow = FoundRow 'go for the next child item\n            End If\n            DoEvents 'prevent unresponsive Excel\n        Loop Until FoundRow = 0\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p>Note that this method is very basic and not the fastest, because it doesn't recognize already traced paths, instead it always does a full trace for every item.</p>\n"}, {"tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": true, "score": 4, "last_activity_date": 1539181762, "creation_date": 1539181762, "answer_id": 52742569, "question_id": 52738569, "link": "https://stackoverflow.com/questions/52738569/loop-through-a-range-to-create-a-tree-of-nested-data/52742569#52742569", "title": "Loop through a range to create a tree of nested data", "body": "<p>i tried using dictionaries and a recursive function to present the results. you can tweak it a bit to only show the top parts. Currently it shows every item that is in column A. Column C is the output.</p>\n\n<p>The idea is that i am looping through the column A and i create a dictionary for each part and has entries in the dictionary the sub parts. </p>\n\n<p>When i present the results if an entry in the dictionary is also an entry in my top level dictionary i present it again.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8lAiB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8lAiB.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Public Sub sFindParts()\n\n  Dim topPartDict As New Dictionary, subPartDict As Dictionary, d As Dictionary\n  Dim topPartList As Range, part As Range\n  Dim outputLocation As Range\n  Dim i As Integer, indLvl As Integer\n  Dim k As Variant, p As Variant\n\n  Set outputLocation = Sheet2.Range(\"C1\")\n  Set topPartList = Sheet2.Range(\"A2:A8\")\n\n  For Each part In topPartList\n    If Not topPartDict.Exists(part.Value) Then\n      Set d = New Dictionary\n      d.Add Key:=part.Offset(0, 1).Value, item:=part.Offset(0, 1).Value\n      topPartDict.Add Key:=part.Value, item:=d\n      Set topPartDict(part.Value) = d\n    Else\n      Set d = topPartDict(part.Value)\n      d.Add Key:=part.Offset(0, 1).Value, item:=part.Offset(0, 1).Value\n      Set topPartDict(part.Value) = d\n    End If\n  Next part\n\n  indLvl = fPresentParts(outputLocation, topPartDict, topPartDict, 0)\n\nEnd Sub\n\n\nPrivate Function fPresentParts(ByRef location As Range, ByRef tpd As Dictionary, ByRef d As Dictionary, indLvl As Integer) As Integer\n  Dim k As Variant, v As Variant\n  Dim subPartsDict As Dictionary\n\n  For Each k In d.Keys()\n    If TypeOf d(k) Is Dictionary Then\n      Set v = d(k)\n      location.IndentLevel = indLvl\n      location.Value = k\n      Set location = location.Offset(1, 0)\n      indLvl = indLvl + 1\n      Set subPartsDict = v\n      indLvl = fPresentParts(location, tpd, subPartsDict, indLvl)\n    Else\n      If tpd.Exists(d(k)) And TypeOf tpd(d(k)) Is Dictionary Then\n        location.IndentLevel = indLvl\n        location.Value = d(k)\n        Set location = location.Offset(1, 0)\n        indLvl = indLvl + 1\n        indLvl = fPresentParts(location, tpd, tpd(d(k)), indLvl)\n      Else\n        location.IndentLevel = indLvl\n        location.Value = k\n        Set location = location.Offset(1, 0)\n      End If\n    End If\n\n  Next k\n  indLvl = indLvl - 1\n  fPresentParts = indLvl\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1539184836, "creation_date": 1539184836, "answer_id": 52743609, "question_id": 52738569, "link": "https://stackoverflow.com/questions/52738569/loop-through-a-range-to-create-a-tree-of-nested-data/52743609#52743609", "title": "Loop through a range to create a tree of nested data", "body": "<p>Throwing my hat in the ring.  The <code>tgr</code> sub can be customized for where to look for the data and where to output the results.  It will also keep track of what is actually top level and only perform the recursive search for those items and their sub parts.  The recursive search function is <code>FindAllSubParts</code></p>\n\n<pre><code>Sub tgr()\n\n    Const sDataSheet As String = \"Sheet2\"\n    Const sResultSheet As String = \"Sheet1\"\n    Const sTopPartsCol As String = \"A\"\n    Const sSubPartsCol As String = \"B\"\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rTopParts As Range\n    Dim rSubParts As Range\n    Dim TopPartCell As Range\n    Dim rTest As Range\n    Dim hTopParts As Object\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(sDataSheet)\n    Set wsDest = wb.Sheets(sResultSheet)\n    Set rTopParts = wsData.Range(sTopPartsCol &amp; \"2\", wsData.Cells(wsData.Rows.Count, sTopPartsCol).End(xlUp))\n    Set rSubParts = Intersect(rTopParts.EntireRow, wsData.Columns(sSubPartsCol))\n    Set hTopParts = CreateObject(\"Scripting.Dictionary\")\n\n    For Each TopPartCell In rTopParts.Cells\n        Set rTest = Nothing\n        Set rTest = rSubParts.Find(TopPartCell.Text, rSubParts.Cells(rSubParts.Cells.Count), xlValues, xlWhole, , xlNext, False)\n        If rTest Is Nothing And Not hTopParts.Exists(TopPartCell.Text) Then\n            hTopParts.Add TopPartCell.Text, TopPartCell.Text\n            wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1).Value = TopPartCell.Text\n            FindAllSubParts TopPartCell.Text, 1, rTopParts, rSubParts, wsDest, sTopPartsCol\n        End If\n    Next TopPartCell\n\nEnd Sub\n\nSub FindAllSubParts(ByVal arg_sTopPart As String, _\n                    ByVal arg_lSubIndex As Long, _\n                    ByVal arg_rTopParts As Range, _\n                    ByVal arg_rSubParts As Range, _\n                    ByVal arg_wsDest As Worksheet, _\n                    ByVal arg_sTopPartsCol As String)\n\n    Dim rFound As Range\n    Dim sFirst As String\n    Dim sSubPart As String\n\n    Set rFound = arg_rTopParts.Find(arg_sTopPart, arg_rTopParts.Cells(arg_rTopParts.Cells.Count), xlValues, xlWhole, , xlNext, False)\n    If Not rFound Is Nothing Then\n        sFirst = rFound.Address\n        Do\n            sSubPart = arg_rSubParts.Parent.Cells(rFound.Row, arg_rSubParts.Column).Text\n            arg_wsDest.Cells(arg_wsDest.Rows.Count, arg_sTopPartsCol).End(xlUp).Offset(1).Value = String(arg_lSubIndex, \"-\") &amp; sSubPart\n            FindAllSubParts sSubPart, arg_lSubIndex + 1, arg_rTopParts, arg_rSubParts, arg_wsDest, arg_sTopPartsCol\n            Set rFound = arg_rTopParts.Find(arg_sTopPart, rFound, xlValues, xlWhole, , xlNext, False)\n        Loop While rFound.Address &lt;&gt; sFirst\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9397552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Edward144", "link": "https://stackoverflow.com/users/9397552/edward144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 52742569, "answer_count": 3, "score": 4, "last_activity_date": 1593778874, "creation_date": 1539168748, "last_edit_date": 1593778874, "question_id": 52738569, "link": "https://stackoverflow.com/questions/52738569/loop-through-a-range-to-create-a-tree-of-nested-data", "title": "Loop through a range to create a tree of nested data", "body": "<p>I need to create a list of part numbers, which shows all other sub parts that are used to create that first part. </p>\n\n<p>So for example part <em>12345</em> is built by combining <em>abc</em> and <em>def</em>.</p>\n\n<p>I have a list of the top level parts, and a second list with two columns showing the top level on the left, and the sub part on the right.</p>\n\n<p>e.g:</p>\n\n<pre><code>| Top Level Part |                    | Top Level Part | Sub Part |\n| 123456         |                    | 123456         | abc      |\n| 234567         |                    | 123456         | def      |\n                                      | 234567         | ghi      |\n                                      | 234567         | jkl      |\n                                      | abc            | yyy      |\n                                      | abc            | zzz      |\n                                      | yyy            | 000000   |\n</code></pre>\n\n<p>I have used a for each loop to look through each part in the first table and compare it to the second, returning each sub part to the right. However I am struggling to go deeper than one level. </p>\n\n<p>What I want to be able to do is once the sub part is found to loop back through the list looking for that part number and returning it's sub part. And continuing until the part is no longer found. Effectively giving me a tree.</p>\n\n<pre><code>-123456\n--abc\n---yyy\n----000000\n---zzz\n--def\n-234567\n--ghi\n--jkl\n</code></pre>\n\n<p>The loop I am using initially is this:</p>\n\n<pre><code>Dim topList as range, top as range\nDim lookupList as range, lookup as range\nDim i as integer\n\nSet topList = .sheets(\"Sheet1\").range(\"A2:A100\")\nset lookupList = .sheets(\"Sheet2\").Range(\"A2:A1000\")\n\ni = 1\n\nFor Each top in topList\n    For Each lookup in lookupList\n        If (top = lookup) then\n            top.offset(0, i).value = lookup.offset(0, 1))\n\n            i = i + 1\n        End If\n    Next lookup\nNext top\n</code></pre>\n\n<p>I have considered using a while loop inside of this which would re scan the list for the sub part, changing the variable to the new part number each time one is found, and stop running once the part doesn't exist in the list. </p>\n\n<p>I can't come up with a working way to implement this though.</p>\n"}, {"tags": ["ms-access", "vba", "runtime-error", "type-mismatch"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1539168190, "post_id": 52738164, "comment_id": 92401300, "body": "Which line do you get the error on ? And why use an unbound form for this ? It&#39;s  much easier to use a bound form."}, {"owner": {"reputation": 11, "user_id": 10483540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6722d01720dcbbe0cfffdf6c2f42154e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Rahul", "link": "https://stackoverflow.com/users/10483540/abhishek-rahul"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1539168352, "post_id": 52738164, "comment_id": 92401383, "body": "Set rec = db.OpenRecordset(&quot;SELECT * FROM Datas&quot;), here i getting error"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1539168646, "post_id": 52738164, "comment_id": 92401551, "body": "Well that would indicate you probably don&#39;t have a table or query called Datas then? And why load a complete table into a recordset when all you want to do is add a record. Much more efficient to load an empty recordset <code>SELECT * FROM YourTable WHERE YourTablePrimaryKeyField = 0</code>"}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 6, "creation_date": 1539169067, "post_id": 52738164, "comment_id": 92401791, "body": "Maybe ADODB library is upper in References list, and <code>Dim rec As Recordset</code> makes <code>rec</code> to be ADODB.Recordset, not DAO.Recordset which returned from OpenRecordset.  Try this <code>Dim rec As DAO.Recordset</code>"}, {"owner": {"reputation": 11, "user_id": 10483540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6722d01720dcbbe0cfffdf6c2f42154e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Rahul", "link": "https://stackoverflow.com/users/10483540/abhishek-rahul"}, "edited": false, "score": 0, "creation_date": 1539169202, "post_id": 52738164, "comment_id": 92401886, "body": "Thank You so much, Minty. But as i mentioned that, i am new in MS Access, could you please help me out a code to save or record my data in table .... Many Thanks in advance"}, {"owner": {"reputation": 11, "user_id": 10483540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6722d01720dcbbe0cfffdf6c2f42154e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Rahul", "link": "https://stackoverflow.com/users/10483540/abhishek-rahul"}, "edited": false, "score": 0, "creation_date": 1539169544, "post_id": 52738164, "comment_id": 92402110, "body": "Thank you 4dmonster. Let me check."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1539170757, "post_id": 52738164, "comment_id": 92402771, "body": "Did run your code. No error on line <i>Set rec = db.OpenRecordset(&quot;SELECT * FROM Datas&quot;)</i> when using an existing table.  However, if one form is working with this code and the other is not, are they using the same database or different ones?"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 4, "creation_date": 1539172812, "post_id": 52738164, "comment_id": 92404002, "body": "Do yourself a favor and name the controls on the form according what they contain. Just a guess: <code>Processor Name</code> isn&#39;t stored in <code>Combo94</code> and <code>Processor ID</code> isn&#39;t stored in <code>Text2</code>."}], "owner": {"reputation": 11, "user_id": 10483540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6722d01720dcbbe0cfffdf6c2f42154e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Rahul", "link": "https://stackoverflow.com/users/10483540/abhishek-rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539168127, "creation_date": 1539167392, "last_edit_date": 1539168127, "question_id": 52738164, "link": "https://stackoverflow.com/questions/52738164/getting-run-time-error-13-type-mismatch-message-in-ms-access-vba", "title": "Getting &quot;Run-time error - 13: Type Mismatch&quot; message in ms-access VBA", "body": "<p>I have two forms in access that are running the same code. However while one works fine the other is giving me a <code>Run-time error - 13: Type Mismatch</code> message. I'm not sure where the problem is.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub cmdSave_Click()\n    Dim db As Database\n    Dim rec As Recordset\n\n    Set db = CurrentDb\n    Set rec = db.OpenRecordset(\"SELECT * FROM Datas\")\n\n    rec.AddNew\n    rec(\"Quality Checker Name\") = Me.Combo106\n    rec(\"Quality Checker ID\") = Me.Text15\n    rec(\"QC Level\") = Me.Combo90\n    rec(\"Date of QC\") = Me.Text21\n    rec(\"Processor Name\") = Me.Combo94\n    rec(\"Processor ID\") = Me.Text2\n    rec(\"Team Name\") = Me.Combo96\n    rec(\"Date of Processing\") = Me.Text108\n    rec(\"Property Ref #\") = Me.Text35\n    rec(\"Service Charge Date\") = Me.Text135\n    rec(\"Portfolio\") = Me.Combo32\n    rec(\"Process Name\") = Me.Combo38\n    rec(\"Sub Process Name\") = Me.Combo40\n    rec.Update\n\n    Set rec = Nothing\n    Set db = Nothing\n\n    Dim msg As Integer\n    msg = MsgBox(\"Do want to close the form\", vbYesNo)\n\n    If msg = vbYes Then\n        DoCmd.Close\n    ElseIf msg = vbNo Then\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Can someone please help.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 19, "user_id": 6492394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e4oZuJkrqig/AAAAAAAAAAI/AAAAAAAAJWw/zRTUu-ESyWg/photo.jpg?sz=128", "display_name": "hashim fajar", "link": "https://stackoverflow.com/users/6492394/hashim-fajar"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1539166832, "post_id": 52737924, "comment_id": 92400509, "body": "if i do any code without arguments its working"}, {"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "edited": false, "score": 0, "creation_date": 1539171957, "post_id": 52737924, "comment_id": 92403466, "body": "Can you describe how is it not working? Do you get an error message?"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1539171970, "post_id": 52737924, "comment_id": 92403477, "body": "Are you passing the MItem to the sub when you call it? Try to compile your project and it will tell you if you forgot something."}, {"owner": {"reputation": 19, "user_id": 6492394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e4oZuJkrqig/AAAAAAAAAAI/AAAAAAAAJWw/zRTUu-ESyWg/photo.jpg?sz=128", "display_name": "hashim fajar", "link": "https://stackoverflow.com/users/6492394/hashim-fajar"}, "edited": false, "score": 0, "creation_date": 1539186176, "post_id": 52737924, "comment_id": 92412624, "body": "Same code i used last week and working in other pc"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1539179858, "creation_date": 1539179858, "answer_id": 52741944, "question_id": 52737924, "link": "https://stackoverflow.com/questions/52737924/run-command-not-showing-if-vba-script-requires-any-arguments-be-passed-to-it/52741944#52741944", "title": "Run command not showing if VBA script requires any arguments be passed to it", "body": "<p>The run command can only be useful where code can run standalone. There is no point in making other code appear in the dialog box.</p>\n\n<p>To use code that requires a parameter, in this case a mailitem object, you need a mailitem first.</p>\n\n<p>You may run code that uses a parameter indirectly, from a button, like this.</p>\n\n<pre><code>Option Explicit\n\nSub runCodeThatRequiresParameter1()\n\n    Dim currItem As mailItem\n\n    ' First open an appropriate mailitem\n    Set currItem = ActiveInspector.currentItem\n\n    ' Pass item to SaveOutlookAttachmentsToDisk\n    SaveOutlookAttachmentsToDisk currItem\n\nEnd Sub\n\n\nSub runCodeThatRequiresParameter2()\n\n    Dim currItem As mailItem\n\n    ' First select an appropriate mailitem\n    Set currItem = ActiveExplorer.Selection(1)\n\n    ' Pass item to SaveOutlookAttachmentsToDisk\n    SaveOutlookAttachmentsToDisk currItem\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 6492394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e4oZuJkrqig/AAAAAAAAAAI/AAAAAAAAJWw/zRTUu-ESyWg/photo.jpg?sz=128", "display_name": "hashim fajar", "link": "https://stackoverflow.com/users/6492394/hashim-fajar"}, "edited": false, "score": 0, "creation_date": 1540706964, "post_id": 52756317, "comment_id": 92958709, "body": "we can create rule after successful  creation of module only"}], "tags": [], "owner": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "is_accepted": false, "score": 0, "last_activity_date": 1539248968, "creation_date": 1539248968, "answer_id": 52756317, "question_id": 52737924, "link": "https://stackoverflow.com/questions/52737924/run-command-not-showing-if-vba-script-requires-any-arguments-be-passed-to-it/52756317#52756317", "title": "Run command not showing if VBA script requires any arguments be passed to it", "body": "<p>I noticed that the first mothed has Item parameter as your provide, if so, you need to create a new rule, select the action for the execution of the script, select the script for this method, you can receive the message automatically save attachments to the disk. In addition, please check if is because that you don't create rules for outlook on these computers that causes they dont't work. </p>\n"}], "owner": {"reputation": 19, "user_id": 6492394, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e4oZuJkrqig/AAAAAAAAAAI/AAAAAAAAJWw/zRTUu-ESyWg/photo.jpg?sz=128", "display_name": "hashim fajar", "link": "https://stackoverflow.com/users/6492394/hashim-fajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52741944, "answer_count": 2, "score": 0, "last_activity_date": 1592900925, "creation_date": 1539166635, "last_edit_date": 1592900925, "question_id": 52737924, "link": "https://stackoverflow.com/questions/52737924/run-command-not-showing-if-vba-script-requires-any-arguments-be-passed-to-it", "title": "Run command not showing if VBA script requires any arguments be passed to it", "body": "<p>I have an Outlook VBA script but it doesn't run if any arguments are to be passed to it.</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>Public Sub SaveOutlookAttachmentsToDisk(MItem As Outlook.MailItem)\n    Dim oOutlookAttachment As Outlook.Attachment\n    Dim sSaveAttachmentsFolder As String\n    sSaveAttachmentsFolder = \"\\Document\\FTP\\\"\n    For Each oOutlookAttachment In MItem.Attachments\n        oOutlookAttachment.SaveAsFile sSaveAttachmentsFolder &amp; oOutlookAttachment.DisplayName\n    Next\nEnd Sub\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>Public Sub SaveOutlookAttachmentsToDisk()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "tsql"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539166905, "post_id": 52737813, "comment_id": 92400554, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10352211/vba-ado-connection-and-query-parameters\">VBA, ADO.Connection and query parameters</a>"}, {"owner": {"reputation": 4248, "user_id": 2333663, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1ea215872ccae10c90c25905859debe5?s=128&d=identicon&r=PG", "display_name": "Muflix", "link": "https://stackoverflow.com/users/2333663/muflix"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1539168463, "post_id": 52737813, "comment_id": 92401445, "body": "@ashleedawg but that is input parameter, i need output."}], "owner": {"reputation": 4248, "user_id": 2333663, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1ea215872ccae10c90c25905859debe5?s=128&d=identicon&r=PG", "display_name": "Muflix", "link": "https://stackoverflow.com/users/2333663/muflix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593591470, "creation_date": 1539166355, "last_edit_date": 1593591470, "question_id": 52737813, "link": "https://stackoverflow.com/questions/52737813/vba-get-output-parameter-from-stored-procedure", "title": "VBA get output parameter from stored procedure", "body": "<p>I have this code</p>\n\n<pre><code> ' Insert item into database\n    With cmd\n        .ActiveConnection = conn\n\n        .CommandText = \"exec myschema.usp_procedure\" _\n        &amp; \"'\" &amp; user &amp; \"',\" _\n        &amp; \"''\" ' output id\n\n        .CommandType = adCmdText\n        .CommandTimeout = 300\n        .Execute\n\n        Dim outputId As Integer\n        outputId = cmd.Parameters(\"outputId\").Value\n\n    End With\n</code></pre>\n\n<p>I am getting error</p>\n\n<pre><code>Item cannot be found in the collection corresponding to the requested name or ordinal\n</code></pre>\n\n<p>Whats wrong ? How can i retrieve the <code>@outputId int OUTPUT</code> parameter ?</p>\n\n<ul>\n<li>The stored procedure is executed properly, i can see new items in database</li>\n</ul>\n\n<p><strong>another try</strong></p>\n\n<pre><code>Dim outputId As Integer\n     With cmd\n            .ActiveConnection = conn\n\n            .CommandText = \"exec edi.usp_ImportOrderHeader\" _\n            &amp; \"'\" &amp; user &amp; \"',\" _\n            &amp; \"''\"\n\n            .Parameters.Append .CreateParameter(\"outputId\", adNumeric, adParamOutput, , outputId)\n\n            .CommandType = adCmdText\n            .CommandTimeout = 300\n\n            .Execute\n        End With\n</code></pre>\n\n<p>store procedure execute without error, but outputId is zero :/</p>\n"}, {"tags": ["vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1539165897, "post_id": 52737516, "comment_id": 92399921, "body": "Where is your vba code please? See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1539166938, "post_id": 52737516, "comment_id": 92400576, "body": "Idea - There is <code>While(True)</code> in the code."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539167167, "post_id": 52737516, "comment_id": 92400677, "body": "@QHarr the code is long.. what part would be better to post? Maybe when I call the internet explorer open instance?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1539167332, "post_id": 52737516, "comment_id": 92400775, "body": "@Vityata you mean some While loop?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539167511, "post_id": 52737516, "comment_id": 92400895, "body": "You have got rid of the reference to the IE instance with Set ieApp = Nothing"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1539167967, "post_id": 52737516, "comment_id": 92401160, "body": "So i need to erase that part of the code?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1539168507, "post_id": 52737516, "comment_id": 92401469, "body": "Well... yes because it will be out of scope at the end of the sub so dereferenced anyway. You don&#39;t need that line. But, I am not sure what you mean by crash?  What you should have is a line before the End Sub saying ieApp.Quit to close the application. If you haven&#39;t been closing IE instances over time this may be causing the crash. Open the task manager and see how many IE instances you have running."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539169292, "post_id": 52737516, "comment_id": 92401941, "body": "@QHarr I uploaded a screenshot of what I get. I tried with ieApp.Quit but I still have the same problem"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1539227489, "post_id": 52737516, "comment_id": 92427277, "body": "Try to post the code segment which is written after &quot;Set ieApp = Nothing&quot;. It can help us to narrow down the issue and find the cause for the issue.  Also try to make a test with any other machine and check IE get crashed on that machine or not. It can hep us to decide whether issue is machine specific or not."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1539244481, "post_id": 52737516, "comment_id": 92433214, "body": "@deepak-MSFT I tried in another machine but it&#39;s the same. After &quot;set ieApp = Nothing&quot; there&#39;s nothing else. I&#39;ll post the entire code cause It will be the only way we&#39;ll might solve it"}, {"owner": {"reputation": 604, "user_id": 3064448, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LOvOX.png?s=128&g=1", "display_name": "davinceleecode", "link": "https://stackoverflow.com/users/3064448/davinceleecode"}, "edited": false, "score": 0, "creation_date": 1576594667, "post_id": 52737516, "comment_id": 104945950, "body": "Please do note that when you use <code>querySelectorAll</code> using For-Each Loop it will crashes your IE browser. use For Loop instead."}], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539245353, "creation_date": 1539165478, "last_edit_date": 1539245353, "question_id": 52737516, "link": "https://stackoverflow.com/questions/52737516/vba-ie-crashes-after-macro-finishes-running", "title": "VBA - IE Crashes after macro finishes running", "body": "<p>I have automated some task that involve populating some boxes with information from Excel. Everything works perfect except for the fact that when the macro finishes IE crashes and stop responding and the website gets reloaded.</p>\n\n<p>Any ideas of why this happens?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub automateIE()\r\n\r\nDim wkb1 As Workbook\r\nDim ws1, ws2, ws3 As Worksheet\r\nSet ws1 = Sheets(\"ws1\")\r\n    \r\nDim ieApp As SHDocVw.InternetExplorer\r\n    Set ieApp = IEWindowFromTitle(\"website title\")   'this is a formula I'm using from someone else and it's after this code\r\n    If Not ieApp Is Nothing Then\r\n        Set ieDoc = ieApp.document\r\n    End If\r\n\r\nws2.Activate\r\nIf ws2.Range(\"A6\").Value &lt;&gt; \"\" Then\r\n    If ws2.Range(\"A6\").Offset(1).Value = \"\" Then\r\n        additems = 1\r\n        GoTo add_items                           'if I want to exit the for loop with \"Exit For\" IE crashes too so I chenged it to GoTo\r\n    ElseIf ws2.Range(\"A6\").Offset(2).Value = \"\" Then\r\n        additems = 2\r\n        GoTo add_items\r\n    Else\r\n        additems = ws2.Range(Range(\"A6\"), Range(\"A6\").End(xlDown)).Cells.Count\r\n        GoTo add_items\r\n    End If\r\nEnd If\r\n\r\nws3.Activate\r\nIf ws3.Range(\"A6\").Value &lt;&gt; \"\" Then\r\n    If ws3.Range(\"A6\").Offset(1).Value = \"\" Then\r\n        additems = 1\r\n    ElseIf ws3.Range(\"A6\").Offset(2).Value = \"\" Then\r\n        additems = 2\r\n    Else\r\n        additems = ws3.Range(Range(\"A6\"), Range(\"A6\").End(xlDown)).Cells.Count\r\n    End If\r\nEnd If\r\n\r\n\r\nadd_items:\r\nDim additemsbtn As HTMLDivElement\r\nSet additemsbtn = ieDoc.getElementById(\"MI_AddItem\")\r\nDim aNodeList As Object\r\nDim itemName As HTMLDivElement\r\nDim savebtn As HTMLDivElement\r\n\r\nadditemsbtn.Click\r\nSet aNodeList = ieDoc.querySelectorAll(\"[dojoinsertionindex]\")\r\n\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nDim repeatadd As Variant\r\nDim rest As Integer\r\n\r\nrepeatadd = (additems / 5)\r\nDim roundvalue() As String\r\nroundvalue() = Split(repeatadd, \",\")\r\n\r\nIf additems &lt; 6 Then\r\n    For i = 0 To additems\r\n        If aNodeList.Item(i).innerText Like additems Then\r\n            aNodeList.Item(i).Click\r\n            Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n            Exit For\r\n        End If\r\n    Next i\r\nElse\r\n    If additems Mod 5 = 0 Then\r\n        For i = 1 To repeatadd\r\n                aNodeList.Item(4).Click\r\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n        Next i\r\n    Else\r\n        If additems &lt; 75 Then\r\n            rest = additems Mod 5\r\n            For i = 1 To roundvalue(0)\r\n                aNodeList.Item(4).Click\r\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n            Next i\r\n            For i = 0 To rest\r\n                If aNodeList.Item(i).innerText Like rest Then\r\n                    aNodeList.Item(i).Click\r\n                    Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n                End If\r\n            Next i\r\n        ElseIf additems &gt;= 75 And additems &lt; 100 Then\r\n            ieDoc.getElementsByName(\"pageSize\")(0).Value = 100\r\n            ieDoc.getElementById(\"navlist\").Click\r\n            rest = additems Mod 5\r\n            For i = 1 To roundvalue(0)\r\n                aNodeList.Item(4).Click\r\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n            Next i\r\n            For i = 0 To rest\r\n                If aNodeList.Item(i).innerText Like rest Then\r\n                    aNodeList.Item(i).Click\r\n                    Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n                End If\r\n            Next i\r\n        End If\r\n    End If\r\nEnd If\r\n\r\nDim element As Object\r\nDim loopaux As Integer\r\nDim loopexit As Integer\r\nDim valueaux As String\r\n\r\nIf additems &gt; 20 Then\r\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\r\nEnd If\r\n\r\n'FROM HERE\r\nFor Each element In ieDoc.querySelectorAll(\"select\")\r\n    If element.Name Like \"itemLevelCustomFieldValue*\" Then\r\n    Else: GoTo nextelement\r\n    End If\r\n    If element.Value &lt;&gt; \"JJTMS\" Then\r\n    element.Focus\r\n    element.Value = \"something\"\r\n    element.FireEvent (\"onchange\")\r\n    loopaux = loopaux + 1\r\n    If loopaux = additems Then\r\n    GoTo exitfor\r\n    End If\r\n    End If\r\nnextelement:\r\nNext element\r\nexitfor:\r\nloopaux = 0\r\nloopexit = 6\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\n'FROM HERE\r\nFor Each element In ieDoc.querySelectorAll(\"select\")\r\n    If element.Name Like \"lineItemCategoryId*\" Then\r\n    element.Focus\r\n    If element.Name = valueaux Then\r\n    GoTo nextelement1\r\n    End If\r\n    If element.Name &lt;&gt; valueaux Then\r\n    For i = 6 To 6 + additems\r\n    element.Value = ws2.Range(\"AE\" &amp; i).Value\r\n    If loopexit = i Then Exit For\r\n    Next i\r\n    element.FireEvent (\"onchange\")\r\n    loopaux = loopaux + 1\r\n    loopexit = loopexit + 1\r\n    valueaux = element.Name\r\n    End If\r\n    If loopaux = additems Then\r\n    GoTo exitfor1\r\n    End If\r\n    \r\n    End If\r\nnextelement1:\r\nNext element\r\nexitfor1:\r\nloopaux = 0\r\nloopexit = 6\r\niSubcat = 6\r\n\r\n'TO HERE. This part of the code repeats four times but taking information from other columns o\r\n\r\n'copy to current\r\nFor Each element In ieDoc.querySelectorAll(\"input\")\r\n    If InStr(1, element.outerHTML, \"javascript:selectAll(this, 'selectedLineItems');\") &gt; 0 Then\r\n        element.Click\r\n        element.FireEvent (\"onclick\")\r\n        GoTo exitfor7\r\n    End If\r\n    Next element\r\nexitfor7:\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\nieDoc.getElementById(\"/images/buttons/save.gif\").Click\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\n\r\nDim copytocurrent1 As HTMLDivElement\r\nSet copytocurrent1 = ieDoc.getElementById(\"MI_Column_1\")\r\nDim copytocurrent2 As Object\r\ncopytocurrent1.Click\r\n\r\nFor Each element In ieDoc.querySelectorAll(\"span.dojoMenuItem2Label\")\r\n    If element.innerText Like \"Current\" Then\r\n        element.Click\r\n        element.FireEvent (\"onclick\")\r\n        GoTo exitfor8\r\n    End If\r\nNext element\r\nexitfor8:\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\n\r\nieDoc.getElementById(\"/images/buttons/save.gif\").Click\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\n\r\nieDoc.getElementById(\"2473\").getElementsByTagName(\"a\")(0).Click\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\nUserForm1.Show\r\n\r\nSet GMF = Workbooks(GMFname)\r\nGMF.Activate\r\n\r\nFor Each element In ieDoc.querySelectorAll(\"select\")\r\n    If element.innerText Like \"LOW SAVINGS*\" Then\r\n        Call Savings\r\n        element.Value = savings_comment\r\n        GoTo exitfor10\r\n    End If\r\nNext element\r\nexitfor10:\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\n\r\n'Repeats las loop five more times for different boxes\r\n\r\nieDoc.getElementById(\"/images/buttons/save.gif\").Click\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\n\r\n'it gets here, does everything in the code and then crashes\r\n\r\nEnd Sub\r\n\r\n\r\n\r\nPublic Function IEWindowFromTitle(sTitle As String) As SHDocVw.InternetExplorer\r\n\r\n    Dim objShellWindows As New SHDocVw.ShellWindows\r\n    Dim win As Object, rv As SHDocVw.InternetExplorer\r\n\r\n    For Each win In objShellWindows\r\n        If TypeName(win.document) = \"HTMLDocument\" Then\r\n            If UCase(win.document.Title) = UCase(sTitle) Then\r\n                Set rv = win\r\n                Exit For\r\n            End If\r\n        End If\r\n    Next\r\n\r\n    Set IEWindowFromTitle = rv\r\n\r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>In the code some names have been changed to generic names and some parts that are repeated have been deleted.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub automateIE()\r\n\r\nDim wkb1 As Workbook\r\nDim ws1, ws2, ws3 As Worksheet\r\nSet ws1 = Sheets(\"ws1\")\r\n    \r\nDim ieApp As SHDocVw.InternetExplorer\r\n    Set ieApp = IEWindowFromTitle(\"website title\")   'this is a formula I'm using from someone else and it's after this code\r\n    If Not ieApp Is Nothing Then\r\n        Set ieDoc = ieApp.document\r\n    End If\r\n\r\nws2.Activate\r\nIf ws2.Range(\"A6\").Value &lt;&gt; \"\" Then\r\n    If ws2.Range(\"A6\").Offset(1).Value = \"\" Then\r\n        additems = 1\r\n        GoTo add_items                           'if I want to exit the for loop with \"Exit For\" IE crashes too so I chenged it to GoTo\r\n    ElseIf ws2.Range(\"A6\").Offset(2).Value = \"\" Then\r\n        additems = 2\r\n        GoTo add_items\r\n    Else\r\n        additems = ws2.Range(Range(\"A6\"), Range(\"A6\").End(xlDown)).Cells.Count\r\n        GoTo add_items\r\n    End If\r\nEnd If\r\n\r\nws3.Activate\r\nIf ws3.Range(\"A6\").Value &lt;&gt; \"\" Then\r\n    If ws3.Range(\"A6\").Offset(1).Value = \"\" Then\r\n        additems = 1\r\n    ElseIf ws3.Range(\"A6\").Offset(2).Value = \"\" Then\r\n        additems = 2\r\n    Else\r\n        additems = ws3.Range(Range(\"A6\"), Range(\"A6\").End(xlDown)).Cells.Count\r\n    End If\r\nEnd If\r\n\r\n\r\nadd_items:\r\nDim additemsbtn As HTMLDivElement\r\nSet additemsbtn = ieDoc.getElementById(\"MI_AddItem\")\r\nDim aNodeList As Object\r\nDim itemName As HTMLDivElement\r\nDim savebtn As HTMLDivElement\r\n\r\nadditemsbtn.Click\r\nSet aNodeList = ieDoc.querySelectorAll(\"[dojoinsertionindex]\")\r\n\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nDim repeatadd As Variant\r\nDim rest As Integer\r\n\r\nrepeatadd = (additems / 5)\r\nDim roundvalue() As String\r\nroundvalue() = Split(repeatadd, \",\")\r\n\r\nIf additems &lt; 6 Then\r\n    For i = 0 To additems\r\n        If aNodeList.Item(i).innerText Like additems Then\r\n            aNodeList.Item(i).Click\r\n            Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n            Exit For\r\n        End If\r\n    Next i\r\nElse\r\n    If additems Mod 5 = 0 Then\r\n        For i = 1 To repeatadd\r\n                aNodeList.Item(4).Click\r\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n        Next i\r\n    Else\r\n        If additems &lt; 75 Then\r\n            rest = additems Mod 5\r\n            For i = 1 To roundvalue(0)\r\n                aNodeList.Item(4).Click\r\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n            Next i\r\n            For i = 0 To rest\r\n                If aNodeList.Item(i).innerText Like rest Then\r\n                    aNodeList.Item(i).Click\r\n                    Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n                End If\r\n            Next i\r\n        ElseIf additems &gt;= 75 And additems &lt; 100 Then\r\n            ieDoc.getElementsByName(\"pageSize\")(0).Value = 100\r\n            ieDoc.getElementById(\"navlist\").Click\r\n            rest = additems Mod 5\r\n            For i = 1 To roundvalue(0)\r\n                aNodeList.Item(4).Click\r\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n            Next i\r\n            For i = 0 To rest\r\n                If aNodeList.Item(i).innerText Like rest Then\r\n                    aNodeList.Item(i).Click\r\n                    Application.Wait (Now + TimeValue(\"0:00:01\"))\r\n                End If\r\n            Next i\r\n        End If\r\n    End If\r\nEnd If\r\n\r\nDim element As Object\r\nDim loopaux As Integer\r\nDim loopexit As Integer\r\nDim valueaux As String\r\n\r\nIf additems &gt; 20 Then\r\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\r\nEnd If\r\n\r\n'FROM HERE\r\nFor Each element In ieDoc.querySelectorAll(\"select\")\r\n    If element.Name Like \"itemLevelCustomFieldValue*\" Then\r\n    Else: GoTo nextelement\r\n    End If\r\n    If element.Value &lt;&gt; \"JJTMS\" Then\r\n    element.Focus\r\n    element.Value = \"something\"\r\n    element.FireEvent (\"onchange\")\r\n    loopaux = loopaux + 1\r\n    If loopaux = additems Then\r\n    GoTo exitfor\r\n    End If\r\n    End If\r\nnextelement:\r\nNext element\r\nexitfor:\r\nloopaux = 0\r\nloopexit = 6\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\n'FROM HERE\r\nFor Each element In ieDoc.querySelectorAll(\"select\")\r\n    If element.Name Like \"lineItemCategoryId*\" Then\r\n    element.Focus\r\n    If element.Name = valueaux Then\r\n    GoTo nextelement1\r\n    End If\r\n    If element.Name &lt;&gt; valueaux Then\r\n    For i = 6 To 6 + additems\r\n    element.Value = ws2.Range(\"AE\" &amp; i).Value\r\n    If loopexit = i Then Exit For\r\n    Next i\r\n    element.FireEvent (\"onchange\")\r\n    loopaux = loopaux + 1\r\n    loopexit = loopexit + 1\r\n    valueaux = element.Name\r\n    End If\r\n    If loopaux = additems Then\r\n    GoTo exitfor1\r\n    End If\r\n    \r\n    End If\r\nnextelement1:\r\nNext element\r\nexitfor1:\r\nloopaux = 0\r\nloopexit = 6\r\niSubcat = 6\r\n\r\n'TO HERE. This part of the code repeats four times but taking information from other columns o\r\n\r\n'copy to current\r\nFor Each element In ieDoc.querySelectorAll(\"input\")\r\n    If InStr(1, element.outerHTML, \"javascript:selectAll(this, 'selectedLineItems');\") &gt; 0 Then\r\n        element.Click\r\n        element.FireEvent (\"onclick\")\r\n        GoTo exitfor7\r\n    End If\r\n    Next element\r\nexitfor7:\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\nieDoc.getElementById(\"/images/buttons/save.gif\").Click\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\n\r\nDim copytocurrent1 As HTMLDivElement\r\nSet copytocurrent1 = ieDoc.getElementById(\"MI_Column_1\")\r\nDim copytocurrent2 As Object\r\ncopytocurrent1.Click\r\n\r\nFor Each element In ieDoc.querySelectorAll(\"span.dojoMenuItem2Label\")\r\n    If element.innerText Like \"Current\" Then\r\n        element.Click\r\n        element.FireEvent (\"onclick\")\r\n        GoTo exitfor8\r\n    End If\r\nNext element\r\nexitfor8:\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\n\r\nieDoc.getElementById(\"/images/buttons/save.gif\").Click\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\n\r\nieDoc.getElementById(\"2473\").getElementsByTagName(\"a\")(0).Click\r\n\r\nIf additems &gt; 20 Then\r\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\r\nElse\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\nEnd If\r\n\r\nUserForm1.Show\r\n\r\nSet GMF = Workbooks(GMFname)\r\nGMF.Activate\r\n\r\nFor Each element In ieDoc.querySelectorAll(\"select\")\r\n    If element.innerText Like \"LOW SAVINGS*\" Then\r\n        Call Savings\r\n        element.Value = savings_comment\r\n        GoTo exitfor10\r\n    End If\r\nNext element\r\nexitfor10:\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\n\r\n'Repeats las loop five more times for different boxes\r\n\r\nieDoc.getElementById(\"/images/buttons/save.gif\").Click\r\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\r\n\r\n'it gets here, does everything in the code and then crashes\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["html", "vba", "web-scraping", "screen-scraping"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539165428, "post_id": 52737361, "comment_id": 92399628, "body": "Have you written any code so far?"}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539165719, "post_id": 52737361, "comment_id": 92399803, "body": "thanks you sir for your replay"}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539165754, "post_id": 52737361, "comment_id": 92399830, "body": "thanks sir  here is some code i try but now working"}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539165958, "post_id": 52737361, "comment_id": 92399951, "body": "yes I written some of VBA macros"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539165963, "post_id": 52737361, "comment_id": 92399956, "body": "please include HTML using snippet tool provided via <a href=\"https://stackoverflow.com/posts/52737361/edit\">edit</a>. Not as an image. Include your code and the URL if possible."}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "edited": false, "score": 0, "creation_date": 1539166146, "post_id": 52737361, "comment_id": 92400066, "body": "<a href=\"http://www.justdial.com/Ahmedabad/Beauty-Parlours/page-3\" rel=\"nofollow noreferrer\">justdial.com/Ahmedabad/Beauty-Parlours/page-3</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539171088, "post_id": 52738451, "comment_id": 92402977, "body": "May I ask - what is the &quot;If-Modified-Since&quot; header for? Does it force latest version of the page and to ignore cache or something?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539171228, "post_id": 52738451, "comment_id": 92403054, "body": "That is supposed to be the idea. It solved a caching problem for one OP and is a suggestion I found on this site. However, as I understand it the server can still serve cached responses. I am not an expert on this. I have been discussing with others more in the know and have yet to find a way to ensure no cached results are ever served.  Apparently, a server can ignore what ever cache instructions you send to it, depending on its config. If I could create an MCVE that proved caching I would post as a question but I haven&#39;t been able to set up a test case myself :-("}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1539171728, "post_id": 52738451, "comment_id": 92403346, "body": "Awesome, I had problems with this a while back and it was so frustrating - I&#39;d also seen &quot;If-Modified-Since&quot; doing some unrelated PHP work I think and never tied the two together until seeing that on your GET request - look forward to trying this, thanks!!"}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "edited": false, "score": 0, "creation_date": 1539230556, "post_id": 52738451, "comment_id": 92427954, "body": "thanks you sir its perfect what I want... thanks a lot again"}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "edited": false, "score": 0, "creation_date": 1539242968, "post_id": 52738451, "comment_id": 92432449, "body": "Dear sir i try this code to work... its work perfect but some of number did not get.. almost 70% number did not get while its available on web page.... what could be the possible way to get 100 % work done,, please sir help me out"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539243125, "post_id": 52738451, "comment_id": 92432520, "body": "You asked for 10. It returns 10. If you have an additional request please ask a new question. Or have I misunderstood something?"}, {"owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "edited": false, "score": 0, "creation_date": 1539456476, "post_id": 52738451, "comment_id": 92512394, "body": "Hello Sir qharr I need one more help,  I want click java scrip but by VBA"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1611940103, "last_edit_date": 1611940103, "creation_date": 1539168321, "answer_id": 52738451, "question_id": 52737361, "link": "https://stackoverflow.com/questions/52737361/web-scraping-using-vba/52738451#52738451", "title": "Web scraping using VBA", "body": "<p>The tel numbers were not easy as I think they have purposefully been made difficult to scrape. I have found a way to decipher the values from the CSS pseudo ::before element content. The addresses and titles were straightforward CSS selections.</p>\n<hr />\n<p>I have since written a cleaner script in python <a href=\"https://stackoverflow.com/a/53676160/6241235\">here</a>.</p>\n<hr />\n<h2><strong>So, how do the various parts of the code work?</strong></h2>\n<p><strong>titles:</strong></p>\n<pre><code>Set titles = .querySelectorAll(&quot;.jcn [title]&quot;)\n</code></pre>\n<p>I target the titles as elements that have a <code>title</code> attribute with a parent <code>jcn</code> class attribute. The <code>&quot;.&quot;</code> indicates a class selector, the <code>&quot;[]&quot;</code> an attribute selector, and the <code>&quot; &quot;</code> in between is a descendant combinator.</p>\n<p><a href=\"https://i.stack.imgur.com/v5Utu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v5Utu.png\" alt=\"enter image description here\" /></a></p>\n<p><code>querySelectorAll</code> method of <code>document</code> returns a <code>nodeList</code> of all matching elements on the page i.e. the 10 titles.</p>\n<hr />\n<p><strong>addresses:</strong></p>\n<pre><code>Set addresses = .querySelectorAll(&quot;.desk-add.jaddt&quot;)\n</code></pre>\n<p>Addresses are targeted by their class attribute <code>desk-add jaddt</code>. As compound class names are not allowed, an additional <code>&quot;.&quot;</code> has to be replace the white space in the name.</p>\n<p><a href=\"https://i.stack.imgur.com/D7gk2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D7gk2.png\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p><strong>Telephone numbers (via deciphering contents within <code>storesTextToDecipher</code>) :</strong></p>\n<pre><code>Set storesTextToDecipher = .querySelectorAll(&quot;.col-sm-5.col-xs-8.store-details.sp-detail.paddingR0&quot;)\n</code></pre>\n<p>This is where the magic happens. The numbers are not available via the DOM directly as they are pseudo element content.</p>\n<p>If you inspect the relevant HTML you will find a series of pseudo <a href=\"https://www.w3schools.com/cssref/sel_before.asp\" rel=\"nofollow noreferrer\">::before elements</a>. VBA exposes no mechanism for applying pseudo selectors to try and get at this info in the CSS for the page.</p>\n<img src=\"https://i.stack.imgur.com/L1psj.png\" width=\"300\">\n<p>What you see is in fact a series of span elements that each have a class attribute beginning with <code>mobilesv</code>. These elements sit within a single parent element of class <code>col-sm-5 col-xs-8 store-details sp-detail paddingR0</code> (note again the compound class name).</p>\n<p>I initially gather a <code>nodeList</code> of all the parent elements.</p>\n<p>Sample of returned elements:</p>\n<img src=\"https://i.stack.imgur.com/VaA4t.png\" width=\"300\">\n<p>Each of these parent elements houses the class name (beginning with <code>mobilesv</code>)  elements that constitute the characters of the telephone number string. Some characters are numbers in the string, others represent the <code>+()-</code>.  Note: The 2|3 letter strings, in the class names, after <code>icon-</code> e.g. <code>dc</code>, <code>fe</code>.</p>\n<p>For example, the first search result on the page, for the initial number <code>9</code> in the telephone number:</p>\n<p><a href=\"https://i.stack.imgur.com/J21qz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J21qz.png\" alt=\"enter image description here\" /></a></p>\n<p>The actual CSS content for this pseudo element /telephone character can be observed in the CSS styling:</p>\n<p><a href=\"https://i.stack.imgur.com/en8SQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/en8SQ.png\" alt=\"enter image description here\" /></a></p>\n<p>Note the class name and before pseudo element selector:  <code>.icon-ji:before</code>\nAnd the content is <code>\\9d010</code>.</p>\n<p>Long story short.... you can extract the 2 or 3 letters after <code>icon-</code> i.e. <code>ji</code> in this case, and the number string after <code>\\9d0</code>, i.e. <code>10</code> in this case, and use these two bits of info to decipher the telephone number. This info is available in the response:</p>\n<img src=\"https://i.stack.imgur.com/kIhag.png\" width=\"350\">\n<p>See the same 2/3 letter strings that are associated with the class names of the telephone string on the left, and the content instructions on the right. A little maths deduces that the number on the right is 1 greater than the telephone number, for that class, shown in the image of the webpage. I simply create a dictionary that then maps the 2/3 letter abbreviation to the telephone number by parsing this section of the html.</p>\n<p>When looping over <code>storesTextToDecipher</code>, I use this dictionary to decipher the actual telephone number from the matching 2/3 letter abbreviation in the class name.</p>\n<hr />\n<p><strong>VBA:</strong></p>\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim sResponse As String, html As HTMLDocument\n    Set html = New HTMLDocument\n    With CreateObject(&quot;MSXML2.XMLHTTP&quot;)\n        .Open &quot;GET&quot;, &quot;https://www.justdial.com/Ahmedabad/Beauty-Parlours/page-3&quot;, False\n        .setRequestHeader &quot;If-Modified-Since&quot;, &quot;Sat, 1 Jan 2000 00:00:00 GMT&quot;\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n  \n    Dim cipherKey As String, cipherDict As Object\n    Set cipherDict = CreateObject(&quot;Scripting.Dictionary&quot;)\n    cipherKey = Split(Split(sResponse, &quot;smoothing:grayscale}.icon-&quot;)(1), &quot;.mobilesv&quot;)(0)\n    cipherKey = Replace$(cipherKey, &quot;:before{content:&quot;&quot;\\9d&quot;, Chr$(32))\n    \n    Dim arr() As String, tempArr() As String, i As Long, j As Long\n    arr = Split(cipherKey, &quot;&quot;&quot;}.icon-&quot;)\n    For i = LBound(arr) To UBound(arr)\n        tempArr = Split(arr(i), Chr$(32))\n        cipherDict(tempArr(0)) = Replace$(tempArr(1), &quot;&quot;&quot;}&quot;, vbNullString) - 1 'needs adjustment\n    Next\n\n    html.body.innerHTML = sResponse\n    Dim titles As Object, addresses As Object, storesTextToDecipher As Object\n    With html\n        Set titles = .querySelectorAll(&quot;.jcn [title]&quot;)\n        Set addresses = .querySelectorAll(&quot;.desk-add.jaddt&quot;)\n        Set storesTextToDecipher = .querySelectorAll(&quot;.col-sm-5.col-xs-8.store-details.sp-detail.paddingR0&quot;)\n    End With\n    \n    For i = 0 To titles.Length - 1\n        Debug.Print &quot;title: &quot; &amp; titles.item(i).innerText\n        Debug.Print &quot;address: &quot; &amp; addresses.item(i).innerText\n        Debug.Print GetStoreNumber(storesTextToDecipher.item(i), cipherDict)\n    Next\nEnd Sub\nPublic Function GetStoreNumber(ByVal storeInfo As Object, cipherDict As Object) As String\n    Dim html2 As HTMLDocument, elems As Object, telNumber As String, j As Long\n    Set html2 = New HTMLDocument\n    html2.body.innerHTML = storeInfo.innerHTML\n    Set elems = html2.querySelectorAll(&quot;b span&quot;)\n    For j = 0 To elems.Length - 1\n        On Error Resume Next\n        If cipherDict(Replace$(elems.item(j).className, &quot;mobilesv icon-&quot;, vbNullString)) &lt; 10 Then\n            telNumber = telNumber &amp; cipherDict(Replace$(elems.item(j).className, &quot;mobilesv icon-&quot;, vbNullString))\n        End If\n        On Error GoTo 0\n    Next\n   GetStoreNumber = telNumber\nEnd Function\n</code></pre>\n<hr />\n<p><strong>Sample output:</strong></p>\n<p><a href=\"https://i.stack.imgur.com/fq9hS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fq9hS.png\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p><strong>Edit: All page results</strong></p>\n<p>As you now want more than 10 the following uses the expected page result count (<code>NUMBER_RESULTS_ON_PAGE)</code> to gather the information from the page. It scrolls the page until the expected number of telephone numbers (which should be unique) are found, or the <code>MAX_WAIT_SEC</code> is hit. This means you avoid an infinite loop and can set your expected result count if you expect a different number. It does rely on each store having a telephone number listed - this seems a fairly reasonable assumption.</p>\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer, resultCountDict As Object, cipherDict As Object, t As Date\n    Const MAX_WAIT_SEC As Long = 300 'wait 5 minutes max before exiting loop to get all results\n    Const NUMBER_RESULTS_ON_PAGE As Long = 80\n    Const URL = &quot;https://www.justdial.com/Ahmedabad/Beauty-Parlours/page-3&quot;\n    \n    Dim titles As Object, addresses As Object, storesTextToDecipher As Object\n    \n    Application.ScreenUpdating = True\n    \n    Set resultCountDict = CreateObject(&quot;Scripting.Dictionary&quot;)\n    Set cipherDict = GetCipherDict(URL)\n    \n    With IE\n        .Visible = True\n        .Navigate2 URL\n       \n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        \n        With .document\n            t = Timer\n            Do\n                DoEvents\n                Set titles = .querySelectorAll(&quot;.jcn [title]&quot;)\n                Set addresses = .querySelectorAll(&quot;.desk-add.jaddt&quot;)\n                Set storesTextToDecipher = .querySelectorAll(&quot;.col-sm-5.col-xs-8.store-details.sp-detail.paddingR0&quot;)\n                Dim telNumber As String, i As Long\n                       \n                For i = 0 To titles.Length - 1\n                    telNumber = GetStoreNumber(storesTextToDecipher.item(i), cipherDict)\n                    If Not resultCountDict.Exists(telNumber) Then\n                        resultCountDict.Add telNumber, Array(titles.item(i).innerText, addresses.item(i).innerText, telNumber)\n                    End If\n                Next\n            \n                .parentWindow.execScript &quot;window.scrollBy(0, window.innerHeight);&quot;, &quot;javascript&quot;\n                \n                While IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop Until resultCountDict.Count = NUMBER_RESULTS_ON_PAGE\n\n        End With\n        .Quit\n    End With\n    \n    Dim key As Variant, rowCounter As Long\n    rowCounter = 1\n    With ThisWorkbook.Worksheets(&quot;Sheet1&quot;)\n        For Each key In resultCountDict.keys\n            .Cells(rowCounter, 1).Resize(1, 3) = resultCountDict(key)\n            rowCounter = rowCounter + 1\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetStoreNumber(ByVal storeInfo As Object, cipherDict As Object) As String\n    Dim html2 As HTMLDocument, elems As Object, telNumber As String, j As Long\n    Set html2 = New HTMLDocument\n    html2.body.innerHTML = storeInfo.innerHTML\n    Set elems = html2.querySelectorAll(&quot;b span&quot;)\n    For j = 0 To elems.Length - 1\n        On Error Resume Next\n        If cipherDict(Replace$(elems.item(j).className, &quot;mobilesv icon-&quot;, vbNullString)) &lt; 10 Then\n            telNumber = telNumber &amp; cipherDict(Replace$(elems.item(j).className, &quot;mobilesv icon-&quot;, vbNullString))\n        End If\n        On Error GoTo 0\n    Next\n   GetStoreNumber = telNumber\nEnd Function\n\nPublic Function GetCipherDict(ByVal URL As String) As Object\n    Dim sResponse As String, html As HTMLDocument\n    Set html = New HTMLDocument\n    With CreateObject(&quot;MSXML2.XMLHTTP&quot;)\n        .Open &quot;GET&quot;, URL, False\n        .setRequestHeader &quot;If-Modified-Since&quot;, &quot;Sat, 1 Jan 2000 00:00:00 GMT&quot;\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n\n    Dim cipherKey As String, cipherDict As Object\n    Set cipherDict = CreateObject(&quot;Scripting.Dictionary&quot;)\n    cipherKey = Split(Split(sResponse, &quot;smoothing:grayscale}.icon-&quot;)(1), &quot;.mobilesv&quot;)(0)\n    cipherKey = Replace$(cipherKey, &quot;:before{content:&quot;&quot;\\9d&quot;, Chr$(32))\n\n    Dim arr() As String, tempArr() As String, i As Long, j As Long\n    arr = Split(cipherKey, &quot;&quot;&quot;}.icon-&quot;)\n    For i = LBound(arr) To UBound(arr)\n        tempArr = Split(arr(i), Chr$(32))\n        cipherDict(tempArr(0)) = Replace$(tempArr(1), &quot;&quot;&quot;}&quot;, vbNullString) - 1 'needs adjustment\n    Next\n    Set GetCipherDict = cipherDict\nEnd Function\n</code></pre>\n<hr />\n<p><strong>EDIT:</strong></p>\n<p>Version for where more than one number is present at top (Please note that if you make too many requests or too quickly server will serve you random pages):</p>\n<pre><code>Option Explicit\n\nPublic Sub GetDetails()\n    Dim re As Object, decodeDict As Object, i As Long\n    Dim html As MSHTML.htmlDocument, responseText As String, keys(), values()\n    \n    Set decodeDict = CreateObject(&quot;Scripting.Dictionary&quot;)\n    Set re = CreateObject(&quot;vbscript.regexp&quot;)\n    Set html = New MSHTML.htmlDocument\n    \n    With CreateObject(&quot;MSXML2.XMLHTTP&quot;)\n        .Open &quot;GET&quot;, &quot;https://www.justdial.com/chengalpattu/Oasis-Pharma-Near-Saraswathi-Children-School-Revathypuram-Urapakkam/9999PXX44-XX44-181123145524-X8G7_BZDET&quot;, False\n        .setRequestHeader &quot;User-Agent&quot;, &quot;Mozilla/4.0&quot;\n        .send\n        responseText = .responseText\n        html.body.innerHTML = responseText\n    End With\n    \n    keys = GetMatches(re, responseText, &quot;-(\\w+):before&quot;)\n\n    If UBound(keys) = 0 Then Exit Sub\n    \n    values = GetMatches(re, responseText, &quot;9d0(\\d+)&quot;, True)\n   \n    For i = LBound(values) To UBound(values)\n        decodeDict(keys(i)) = values(i)\n    Next\n    \n    Dim itemsToDecode()\n    \n    decodeDict(keys(UBound(keys))) = &quot;+&quot;\n\n    itemsToDecode = GetValuesToDecode(html)\n    \n    PrintNumbers re, html, itemsToDecode, decodeDict\nEnd Sub\n\nPublic Function GetMatches(ByVal re As Object, ByVal inputString As String, ByVal sPattern As String, Optional ByVal numeric = False, Optional ByVal spanSearch = False) As Variant\n    Dim matches As Object, iMatch As Object, s As String, arrMatches(), i As Long\n\n    With re\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .Pattern = sPattern\n\n        If .Test(inputString) Then\n            Set matches = .Execute(inputString)\n            ReDim arrMatches(0 To matches.Count - 1)\n            For Each iMatch In matches\n                If numeric Then\n                    arrMatches(i) = iMatch.SubMatches.item(0) - 1\n                Else\n                    If spanSearch Then\n                        arrMatches(i) = iMatch\n                    Else\n                        arrMatches(i) = iMatch.SubMatches.item(0)\n                    End If\n                End If\n                i = i + 1\n            Next iMatch\n        Else\n            ReDim arrMatches(0)\n            arrMatches(0) = vbNullString\n        End If\n    End With\n    GetMatches = arrMatches\nEnd Function\n\nPublic Function GetValuesToDecode(ByVal html As MSHTML.htmlDocument) As Variant\n    Dim i As Long, elements As Object, results(), Class As String\n\n    Set elements = html.querySelectorAll(&quot;.telCntct span[class*='icon']&quot;)\n    \n    ReDim results(elements.Length - 1)\n    For i = 0 To elements.Length - 1\n        Class = elements.item(i).className\n        results(i) = Right$(Class, Len(Class) - InStrRev(Class, &quot;-&quot;))\n    Next\n    GetValuesToDecode = results\nEnd Function\n\nPublic Sub PrintNumbers(ByVal re As Object, ByVal html As htmlDocument, ByVal itemsToDecode As Variant, ByVal decodeDict As Object)\n    Dim output As String, i As Long\n\n    For i = LBound(itemsToDecode) To UBound(itemsToDecode)\n        output = output &amp; decodeDict(itemsToDecode(i))\n    Next\n    \n    Dim htmlToSearch As String, groups As Variant, startPos As Long, oldStartPos As Long\n    \n    htmlToSearch = html.querySelector(&quot;.telCntct&quot;).outerHTML\n\n    groups = GetMatches(re, htmlToSearch, &quot;mobilesv|,&quot;, False, True)\n \n    startPos = 1\n    \n    Dim totalNumbers As Long\n    \n    For i = LBound(groups) To UBound(groups)\n        If InStr(groups(i), &quot;,&quot;) &gt; 0 Then\n            totalNumbers = totalNumbers + 1\n            Debug.Print Mid$(output, startPos, IIf(startPos = 1, i, i - startPos))\n            startPos = i + 1\n        End If\n    Next\n    If totalNumbers = 1 Then Debug.Print Right$(output, Len(output) - startPos - 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4012999, "user_type": "registered", "profile_image": "https://graph.facebook.com/602806500/picture?type=large", "display_name": "Lalit Patel", "link": "https://stackoverflow.com/users/4012999/lalit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 1, "accepted_answer_id": 52738451, "answer_count": 1, "score": 1, "last_activity_date": 1611940103, "creation_date": 1539164961, "last_edit_date": 1569168550, "question_id": 52737361, "link": "https://stackoverflow.com/questions/52737361/web-scraping-using-vba", "title": "Web scraping using VBA", "body": "<p>I would like to extract data from this <a href=\"http://www.justdial.com/Ahmedabad/Beauty-Parlours/page-3\" rel=\"nofollow noreferrer\">URL</a>.</p>\n\n<p>I want to extract Title, mobile contact number and address from each of 10 business cards.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uBwk2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uBwk2.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is some code I tried but did not get success.</p>\n\n<pre><code>Public Sub GetValueFromBrowser()\n    On Error Resume Next\n    Dim Sn As Integer\n    Dim ie As Object\n    Dim url As String\n    Dim Doc As HTMLDocument\n    Dim element As IHTMLElement\n    Dim elements As IHTMLElementCollection\n\n    For Sn = 1 To 1\n\n        url = Sheets(\"Infos\").Range(\"C\" &amp; Sn).Value\n\n        Set ie = CreateObject(\"InternetExplorer.Application\")\n\n        With ie\n            .Visible = 0\n            .navigate url\n            While .Busy Or .readyState &lt;&gt; 4\n                DoEvents\n            Wend\n        End With    \n\n        Set Doc = ie.document\n        Set elements = Doc.getElementsByClassName(\" col-sm-5 col-xs-8 store-details sp-detail paddingR0\")\n\n        Dim count As Long\n        Dim erow As Long\n        count = 0\n        For Each element In elements\n            If element.className = \"lng_cont_name\" Then\n                erow = Sheet1.Cells(Rows.count, 1).End(xlUp).Offset(1, 0).Row\n                Cells(erow, 1) = Doc.getElementsByClassName(\"Store-Name\")(count).innerText\n                Cells(erow, 2) = Doc.getElementsByClassName(\"cont_fl_addr\")(count).innerText\n                count = count + 1\n            End If\n        Next element\n\n        If Val(Left(Sn, 2)) = 99 Then\n            ActiveWorkbook.Save\n        End If\n\n    Next Sn\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1539164862, "post_id": 52737141, "comment_id": 92399288, "body": "What have you tried ? Please share your VBA code. What is the desired outcome? And can you share the URL?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1539180166, "post_id": 52737141, "comment_id": 92408779, "body": "1. <b>Any error?</b> 2. What is <b>the present output</b>? 3. And, like QHarr asked, what is <b>the wanted output?</b> 4. See this: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1539238577, "creation_date": 1539238577, "answer_id": 52753430, "question_id": 52737141, "link": "https://stackoverflow.com/questions/52737141/with-vba-get-internet-explorer-to-select-item-from-list/52753430#52753430", "title": "With VBA get Internet explorer to select item from list", "body": "<p>I can see that you are using HTML Table and create DIV's in that.</p>\n\n<p>I try to search and find that there is no any method or property is available to select the text in DIV.</p>\n\n<p>I suggest you to use any HTML control to select its value. For example \"Select option\".</p>\n\n<p>You can try to create drop down using select and then use the code below to select any value in it.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Select_Item()\r\n    Dim post As Object, elem As Object\r\n\r\n    With CreateObject(\"InternetExplorer.Application\")\r\n        .Visible = True\r\n        .navigate \"C:\\Users\\WCS\\Desktop\\element.html\"  \r\n       \r\n       While .Busy = True Or .ReadyState &lt; 4: DoEvents: Wend\r\n\r\n        Set post = .Document.getElementById(\"ctl00_ContentPlaceHolder1_ddlCycleID\")\r\n       \r\n       For Each elem In post.getElementsByTagName(\"option\")\r\n            If InStr(elem.Value, \"10\") &gt; 0 Then elem.Selected = True: Exit For\r\n        Next elem\r\n    End With\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9998940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3213f76160cb6d662e6b484bb0faab?s=128&d=identicon&r=PG&f=1", "display_name": "Halagasch", "link": "https://stackoverflow.com/users/9998940/halagasch"}, "edited": false, "score": 0, "creation_date": 1539587475, "post_id": 52759292, "comment_id": 92540722, "body": "Thank you QHarr, for taking the time to give me a possible solution. Unfortunately, both do not seem to work. The first option gives me an Error 438, &quot;Object Doesn&#39;t Support This Property or Method&quot;. The second does nothing and continues the code as if nothing happened."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9998940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3213f76160cb6d662e6b484bb0faab?s=128&d=identicon&r=PG&f=1", "display_name": "Halagasch", "link": "https://stackoverflow.com/users/9998940/halagasch"}, "edited": false, "score": 0, "creation_date": 1539587551, "post_id": 52759292, "comment_id": 92540755, "body": "Ok. Will get back to you later."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1539258390, "creation_date": 1539258390, "answer_id": 52759292, "question_id": 52737141, "link": "https://stackoverflow.com/questions/52737141/with-vba-get-internet-explorer-to-select-item-from-list/52759292#52759292", "title": "With VBA get Internet explorer to select item from list", "body": "<p>You can try an attribute = value CSS selector:</p>\n\n<pre><code>ie.document.querySelector(\"[title='Vorige Week']\").Selected = True\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>ie.document.querySelector(\"[title='Vorige Week']\").Click\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9998940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3213f76160cb6d662e6b484bb0faab?s=128&d=identicon&r=PG&f=1", "display_name": "Halagasch", "link": "https://stackoverflow.com/users/9998940/halagasch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539655885, "creation_date": 1539164376, "last_edit_date": 1539655885, "question_id": 52737141, "link": "https://stackoverflow.com/questions/52737141/with-vba-get-internet-explorer-to-select-item-from-list", "title": "With VBA get Internet explorer to select item from list", "body": "<p>Good Day,</p>\n\n<p>I've searched for answers and solutions proveded on this site did not seem to help including selectedIndex and looping through arrays</p>\n\n<p>I've got the following HTML code making up a table from which I want to select the second option \"Vorige week\"</p>\n\n<pre><code>&lt;table cellspacing=\"0\" cellpadding=\"0\" title=\"\"  class=\"mstrListBlock\" \nid=\"id_mstr51\" style=\"display: table; width: auto;\"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td class=\"mstrListBlockCell\"&gt;\n&lt;span class=\"\"&gt;\n&lt;div class=\"mstrListBlockCaption\" style=\"display: none;\"/&gt;\n&lt;div class=\"mstrListBlockHeader\" style=\"display: none;\"&gt;\n&lt;div style=\"\" class=\"mstrListBlockContents\" \nid=\"ListBlockContents_id_mstr51\"&gt;\n&lt;div oncontextmenu=\"return \nmstr.behaviors.Generic.oncontextmenu(arguments[0], self, 'id_mstr51');\" \nonmouseup=\"try{mstr.$obj('id_mstr51').focus();}catch(localerr){}; return \nmstr.behaviors.Generic.clearBrowserHighlights(self)\" onmousedown=\"var retVal \n= mstr.behaviors.ListView.onmousedown(arguments[0], self, 'id_mstr51'); \ntry{mstr.$obj('id_mstr51').focus();}catch(localerr){}; return retVal\" \nondblclick=\"return mstr.behaviors.ListView.ondblclick(arguments[0], self, \n'id_mstr51')\" class=\"mstrListBlockListContainer\" id=\"id_mstr51ListContainer\" \nstyle=\"display: block;\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Huidige Week\"&gt;\n&lt;div class=\"mstrListBlockItemSelected\" title=\"Vorige Week\"&gt;\n&lt;div class=\"mstrBGIcon_fi mstrListBlockItemName\" style=\"background-position: \n2px 50%; padding-left: 23px;\"&gt;Vorige Week&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Afgesloten 4 Weken\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Afgesloten 8 Weken\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Huidige Periode\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Vorige Periode\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Afgesloten 2 Perioden\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Selectie Datum Hi\u00ebrarchie. Aangepast \nwegens IServer crash icm. Metric prompts.\"&gt;\n&lt;div class=\"mstrListBlockItem\" title=\"Gisteren\"&gt;\n</code></pre>\n\n<p>I think my problem is in deciding which element I need to use to get the desired outcome</p>\n\n<pre><code>Sub JDWReport()\n\nDim objIE As InternetExplorer\n\nSet objIE = New InternetExplorerMedium\nobjIE.Visible = True\n\nobjIE.navigate \"URL\"\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nobjIE.document.getElementById(\"Uid\").Value = \"username\"\nobjIE.document.getElementById(\"Pwd\").Value = \"password\"\nobjIE.document.getElementById(\"3054\").Click\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nobjIE.navigate \"URL2\"\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nobjIE.document.getElementsClassName(\"mstrBGIcon_fi \nmstrListBlockItemName\")(0).Click\n\nobjIE.Quit\nEnd Sub\n</code></pre>\n\n<p>See code above which I'm currently using.\nIt gets stuck with the line objIE.document.getElementsClassName(\"mstrBGIcon_fi \n    mstrListBlockItemName\")(0).Click\nI tried changing this line to different elements based on the HTML code and use .click .selectedindex=2 but those won't work.</p>\n\n<pre><code>&lt;div class=\"mstrListBlockItemSelected\" title=\"Vorige Week\"&gt;\n</code></pre>\n\n<p>Currently it says mstrListBlockItemSelected, however, when first navigating to the site, the class is defined as the rest, mstrListBlockItem.</p>\n\n<p>It will only change to selected if you click on the item in question (from a list of items). My ultimate goal would be to get the class with title \"Vorige Week\" to change from mstrListBlockItem to mstrListBlockItemSelected.</p>\n"}, {"tags": ["excel", "vba", "function", "sum"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539163851, "post_id": 52736801, "comment_id": 92398655, "body": "hi @vthomas I&#39;ve tried to use the sumifs as you described but it gave me an error. I&#39;ve now attached a second screenshot showing the column labels for each daily worksheet. If I told you that the column I need the data from (in addition to account name of course) is Value of trade $, how would you edit the sumif function? Thanks, its appreciated"}, {"owner": {"reputation": 11, "user_id": 10483193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7de1685bed8daf202228e5c4363b49?s=128&d=identicon&r=PG&f=1", "display_name": "vthomas", "link": "https://stackoverflow.com/users/10483193/vthomas"}, "reply_to_user": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539171971, "post_id": 52736801, "comment_id": 92403479, "body": "You want the criteria to apply on the column A and the formula to add up the content of column I. So you should use the formula with those columns: <code>=SUMIFS($A:$A;$I:$I;&quot;=ALBAR&quot;)</code>"}, {"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539174304, "post_id": 52736801, "comment_id": 92404963, "body": "I have tried that function and it is still producing an error. Thank you for the advice"}], "tags": [], "owner": {"reputation": 11, "user_id": 10483193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa7de1685bed8daf202228e5c4363b49?s=128&d=identicon&r=PG&f=1", "display_name": "vthomas", "link": "https://stackoverflow.com/users/10483193/vthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1539163297, "creation_date": 1539163297, "answer_id": 52736801, "question_id": 52736635, "link": "https://stackoverflow.com/questions/52736635/vba-to-sum-value-for-specific-cells/52736801#52736801", "title": "VBA to sum value for specific cells", "body": "<p>This can be done via a simple formula:  </p>\n\n<p><code>=SUMIFS(AccountRange;RevenueRange;\"=ALBAR\")</code></p>\n"}], "owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1539163736, "creation_date": 1539162752, "last_edit_date": 1539163736, "question_id": 52736635, "link": "https://stackoverflow.com/questions/52736635/vba-to-sum-value-for-specific-cells", "title": "VBA to sum value for specific cells", "body": "<p><a href=\"https://i.stack.imgur.com/D3efg.png\" rel=\"nofollow noreferrer\">worksheet column fields</a></p>\n\n<p>I am looking to see whether its possible to write a VBA which will do a basic sum function based on account name. The screenshot i've attached is of the master worksheet from my workbook. So, for the account named ALBAR, I would be looking to get a sum figure for their revenue by having a VBA which activates a sum function for all of their daily trading activity in the individual worksheets in the workbook. </p>\n\n<p>My question is, it possible to have this sum function in a VBA whereby it will search for the name ALBAR across the different worksheets in the excel file and return a sum figure for the master worksheet?</p>\n\n<p>Edit: I have now added a second picture detailing to columns for the daily worksheets where the master worksheet should derive its data from.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KDfDK.png\" rel=\"nofollow noreferrer\">Daily activity</a></p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539163513, "post_id": 52736820, "comment_id": 92398458, "body": "yes that is exactly what I expected. unfortunately there is nothing in the fields to see what makes it uniqe in the fields. I was thinking of looking for a name myself but unfortunately that does not result in the click action. then website is unfortunately not mine, so i cant fix it :("}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1539163350, "creation_date": 1539163350, "answer_id": 52736820, "question_id": 52736627, "link": "https://stackoverflow.com/questions/52736627/ie-getelementsbyid-with-same-id/52736820#52736820", "title": "ie getelementsbyID with same ID", "body": "<p>The <code>id</code> in HTLM must be unique. If it is not unique it is no valid HTML and should be fixed.</p>\n\n<p>HTML4:</p>\n\n<p><a href=\"http://www.w3.org/TR/html4/struct/global.html\" rel=\"nofollow noreferrer\">http://www.w3.org/TR/html4/struct/global.html</a></p>\n\n<p>Section 7.5.2:</p>\n\n<blockquote>\n  <p>id = name [CS]\n      This attribute assigns a name to an element. This name must be unique in a document.</p>\n</blockquote>\n\n<p>HTML5:</p>\n\n<p><a href=\"http://www.w3.org/TR/html5/dom.html#the-id-attribute\" rel=\"nofollow noreferrer\">http://www.w3.org/TR/html5/dom.html#the-id-attribute</a></p>\n\n<blockquote>\n  <p>The id attribute specifies its element's unique identifier (ID). The\n  value must be unique amongst all the IDs in the element's home subtree\n  and must contain at least one character. The value must not contain\n  any space characters.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539782894, "post_id": 52737413, "comment_id": 92627203, "body": "i use this variant of the code but is works the first time but not the seccont time. i tested uit by replaysing the &quot;for 0&quot; to &quot;for 1&quot; and then it does work,... but is does not work in a loop. (afther first i reload the first page)"}, {"owner": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539782903, "post_id": 52737413, "comment_id": 92627206, "body": "<i><b>Set Decl_list_0 = ie.document.querySelectorAll(&quot;[id=btnSelectDeclaratie]&quot;) For q = 0 To Decl_list_0.Length - 1     YN = 0     Decl_list_0.Item(q).Click</b></i>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539782943, "post_id": 52737413, "comment_id": 92627232, "body": "Can you formulate this as an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and ask as a question please?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539783043, "post_id": 52737413, "comment_id": 92627299, "body": "what do you mean?"}, {"owner": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539783394, "post_id": 52737413, "comment_id": 92627534, "body": "i dont know how i get the question ask in the right way. do you want me to open a new topic? then i have more options."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "edited": false, "score": 0, "creation_date": 1539783513, "post_id": 52737413, "comment_id": 92627624, "body": "You should ask as a new question because trying to debug here in comments is not effective. You can practice drafting the question using the question wizard I think. <a href=\"https://stackoverflow.com/questions/ask/wizard\">stackoverflow.com/questions/ask/wizard</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1539165519, "last_edit_date": 1539165519, "creation_date": 1539165147, "answer_id": 52737413, "question_id": 52736627, "link": "https://stackoverflow.com/questions/52736627/ie-getelementsbyid-with-same-id/52737413#52737413", "title": "ie getelementsbyID with same ID", "body": "<p>You can loop them by using querySelectorAll to gather all the elements with an id attribute whose values match what you are after. You can distinguish between them by index. This method will allow you to gather them even though the ids are repeating. However, the HTML you have shared downloads the same document so a loop doesn't seem necessary.  </p>\n\n<pre><code>Dim nodeList As Object, i As Long\nSet nodeList = ie.document.querySelectorAll(\"[id=DownloadButton]\")\nFor i = 0 to nodeList.Length-1\n    nodeList.item(i).Click\nNext\n</code></pre>\n\n<p>That loops all of the matching elements and clicks</p>\n\n<p>By index will be specific but if you familiarize yourself with CSS selectors there are a vast number of possibilities for specifying an element.</p>\n"}], "owner": {"reputation": 39, "user_id": 9172143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6303aefd700b7f0dbe0b3e2b1ad8c?s=128&d=identicon&r=PG&f=1", "display_name": "Michiel.D", "link": "https://stackoverflow.com/users/9172143/michiel-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 52737413, "answer_count": 2, "score": 2, "last_activity_date": 1593778890, "creation_date": 1539162734, "last_edit_date": 1593778890, "question_id": 52736627, "link": "https://stackoverflow.com/questions/52736627/ie-getelementsbyid-with-same-id", "title": "ie getelementsbyID with same ID", "body": "<p>i have a script that works with internet explorder (ie) and i need to loop the select fields, that it zelf is no ploblem bu the 4 elements got the same ID (on the same page).</p>\n\n<p>How do i let it loop through the 4 fields?\nCan i make them more spesified?</p>\n\n<p>the code i use is the following:</p>\n\n<pre><code>ie.document.getElementByID(\"DownloadImage\").Click\n</code></pre>\n\n<p>The ie code is the following:\nfield 1</p>\n\n<pre><code>&lt;a id=\"DownloadButton\" href=\"javascript:__doPostBack('ctl00$ctl00$MainContent$MainContent$ctl00$declaratiebestandView$RetourInformatieGrid$ctl03$DownloadButton','')\"&gt;CZ_Specificatie_150005697.pdf&lt;/a&gt;\n</code></pre>\n\n<p></p>\n\n<p>field 2</p>\n\n<pre><code>&lt;a id=\"DownloadButton\" href=\"javascript:__doPostBack('ctl00$ctl00$MainContent$MainContent$ctl00$declaratiebestandView$RetourInformatieGrid$ctl03$DownloadButton','')\"&gt;CZ_Specificatie_150005697.pdf&lt;/a&gt;&lt;input name=\"ctl00$ctl00$MainContent$MainContent$ctl00$declaratiebestandView$RetourInformatieGrid$ctl03$DownloadImage\" class=\"inlineButton\" id=\"DownloadImage\" type=\"image\" src=\"../images/download.png\" text=\"CZ_Specificatie_150005697.pdf\"&gt;\n</code></pre>\n\n<p>then it opens the download screen, and then my code continue's (and works :) )</p>\n"}, {"tags": ["vba", "ms-word", "webpage-screenshot"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10482810, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156032120268721/picture?type=large", "display_name": "Joshua Surat", "link": "https://stackoverflow.com/users/10482810/joshua-surat"}, "edited": false, "score": 0, "creation_date": 1539166084, "post_id": 52736794, "comment_id": 92400024, "body": "Ok it seems to be coming from the ie caption as I just ran it for the homepage and it worked!!! I know it is a very amateur ask... but how does one get the accurate page caption?"}], "tags": [], "owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "is_accepted": false, "score": 0, "last_activity_date": 1539163258, "creation_date": 1539163258, "answer_id": 52736794, "question_id": 52736384, "link": "https://stackoverflow.com/questions/52736384/using-a-macro-to-take-a-screenshot-of-a-website-and-then-pasting-it/52736794#52736794", "title": "Using a Macro to take a screenshot of a website and then pasting it", "body": "<p><code>ShellWindows</code> are Internet Explorer AND File Explorer windows.</p>\n\n<pre><code>Set objShell = CreateObject(\"Shell.Application\")\nSet AllWindows = objShell.Windows\nFor Each window in AllWindows\n    msgbox window.locationname &amp; vbcrlf &amp; typename(window.parent) &amp; vbcrlf &amp; window.name\nNext\n</code></pre>\n\n<p>Or the <code>window</code> object above being an IE object.</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\nie.Navigate2 \"www.google.com.au\"\nie.visible=true\nwscript.sleep 5000\nie.refresh2 \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10482810, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156032120268721/picture?type=large", "display_name": "Joshua Surat", "link": "https://stackoverflow.com/users/10482810/joshua-surat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539163258, "creation_date": 1539161894, "last_edit_date": 1539162648, "question_id": 52736384, "link": "https://stackoverflow.com/questions/52736384/using-a-macro-to-take-a-screenshot-of-a-website-and-then-pasting-it", "title": "Using a Macro to take a screenshot of a website and then pasting it", "body": "<p>I am trying to take a screenshot of the webpage linked below and then paste it into word. I have a bit of code that should do that but every time it runs it get a <code>hwnd = 0</code> error window. Can someone point me as to where I'm going wrong please.</p>\n\n<p>Web Page: <a href=\"https://www.makro.co.za/groceries-and-toiletries/protex-/br-soap-deep-clean-/br-1-x-150g--338971001EA\" rel=\"nofollow noreferrer\">https://www.makro.co.za/groceries-and-toiletries/protex-/br-soap-deep-clean-/br-1-x-150g--338971001EA</a></p>\n\n<pre><code>Sleep 5000\n\n'~~&gt; Get the caption of IE\nIECaption = \"Protex Soap Deep Clean (1 x 150g)- Lowest Prices &amp; Specials Online | Makro - Internet Explorer\"\n\n'~~&gt; Get handle of IE\nhwnd = FindWindow(vbNullString, IECaption)\n\nIf hwnd = 0 Then\n    MsgBox \"IE Window Not found!\"\n    Exit Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1539162648, "post_id": 52736555, "comment_id": 92397890, "body": "Thanks. Although i&#39;m wondering why my other worksheets extend using the same VBA code? Prior to the code running, there are no blank table rows but they create their own rows"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1539163091, "post_id": 52736555, "comment_id": 92398175, "body": "@Pherdindy I had similar strange behaviors with automatic (not) extending tables in Excel. I won&#39;t rely on that. Adding a new row before using it would be a good idea anyway and a stable process you can rely on."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1539163854, "post_id": 52736555, "comment_id": 92398661, "body": "So I actually deleted the entire table and created another one with the same headers and table name, and the code now expands it automatically like the others. Completely confused, but nice to know about table manipulation in the reference"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1539163996, "post_id": 52736555, "comment_id": 92398743, "body": "@Pherdindy I did this too. But then it stopped working again later (never found out why, guess it&#39;s just a bug). So adding a row yourself makes it secure, and you will never have to think about it again."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1539167760, "post_id": 52736555, "comment_id": 92401029, "body": "@P\u1d07\u029c I haven&#39;t had the same problem but your advice for &quot;Adding a new row before using it&quot; is an example of coding for expected or possible errors.  I&#39;ll be sure to use it when adding data below tables."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1539162460, "creation_date": 1539162460, "answer_id": 52736555, "question_id": 52736272, "link": "https://stackoverflow.com/questions/52736272/excel-table-not-expanding-when-vba-code-is-run-but-expands-when-any-letter-is-t/52736555#52736555", "title": "Excel table not expanding when VBA code is run, but expands when any letter is typed below it", "body": "<p>VBA does not extend the table automatically. </p>\n\n<p>You need to do add a row to the table before you write data into it:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListRows.Add\n</code></pre>\n\n<p>Also have a look at <a href=\"https://stackoverflow.com/a/43541508/3219613\">my answer here</a> and  <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">The VBA Guide To ListObject Excel Tables</a> for more information how to handle tables in Excel with VBA.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 52736555, "answer_count": 1, "score": 3, "last_activity_date": 1593778905, "creation_date": 1539161548, "last_edit_date": 1593778905, "question_id": 52736272, "link": "https://stackoverflow.com/questions/52736272/excel-table-not-expanding-when-vba-code-is-run-but-expands-when-any-letter-is-t", "title": "Excel table not expanding when VBA code is run, but expands when any letter is typed below it", "body": "<p>I use this code to copy my code from another workbook to another:</p>\n\n<pre><code>Dim PayMR_Data_Columns As Long, sourcePayMR As Range\n\nPayMR_Data_Columns = ThisWorkbook.Worksheets(\"Pay-MR\").Cells(1, Columns.Count).End(xlToLeft).Column\nSet sourcePayMR = ThisWorkbook.Worksheets(\"Pay-MR\").Range(\"A2:\" &amp; Col_Letter(PayMR_Data_Columns) &amp; Total_rows_PayMR)\n\n'Copies value from source to Payroll Data\nWith Workbooks(\"Payroll Data.xlsm\").Worksheets(\"Pay-MR Compiled\").Range(\"A\" &amp; Total_rows_PayMRCompiled + 1 &amp; \":\" &amp; Col_Letter(PayMR_Data_Columns) &amp; Total_rows_PayMRCompiled + Total_rows_PayMR - 1)\n    .Value = sourcePayMR.Value\nEnd With\n</code></pre>\n\n<p>Please refer to the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KZwO6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KZwO6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The white rows indicate that the table did not expand. On my other tables, the exact same code works and expands the table, but I do not understand why it does not expand in this case, but when I type a letter it does as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nEPoM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nEPoM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "copy", "range", "listobject"], "answers": [{"comments": [{"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1539185732, "post_id": 52736864, "comment_id": 92412334, "body": "First try I get and Error &quot;Range&#39; of object?_global&#39; failed"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1539185923, "post_id": 52736864, "comment_id": 92412450, "body": "Which line? Make sure you change the table names to the table names you got"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1539186493, "post_id": 52736864, "comment_id": 92412803, "body": "The names do not change since: Set tbl3 = ThisWorkbook.Sheets(1).ListObjects(&quot;table3&quot;) if I do: MsgBox tbl3.HeaderRowRange(1, 1).Value that gives &quot;name&quot;  which puzzels me. I am trying to understand what is actually the following doing: Range(tbl3.Name &amp; &quot;[&quot; &amp; tbl3.HeaderRowRange(1, 1).Value &amp; &quot;]&quot;).cells(1,1).value  it is the value of the first cell of a range. What is that range? It is a bit confusing because the content of the first cell of your header is &quot;name&quot; and tbl3.name is the name of the table itself."}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1539186555, "post_id": 52736864, "comment_id": 92412847, "body": "sorry I dont know how to add line breaks in comments. so bad edition"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1539187637, "post_id": 52736864, "comment_id": 92413485, "body": "is the first cell of the column range of the field selected"}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 1, "creation_date": 1539189156, "post_id": 52736864, "comment_id": 92414336, "body": "ABSOLUTLY IMPORTANT FROM FOXIFIRE ANSWER: see how when pasting the second table he uses End(xlDown).Offset(1, 0)  this moves the range cell down and offsets it one value down in order not to copy over the last name added."}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 1, "creation_date": 1539189307, "post_id": 52736864, "comment_id": 92414436, "body": "Another key point: Notice how what is inside the Range(...) its actually a string, so you can build the strings with the names of columns dinamically. like myNamesRange= TBL1.Name &amp; &quot;[names]&quot; and then do range(myNamesRang). it works!!!"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1539163993, "last_edit_date": 1539163993, "creation_date": 1539163465, "answer_id": 52736864, "question_id": 52736088, "link": "https://stackoverflow.com/questions/52736088/paste-data-ranges-of-listobjects-in-other-listobject-of-excel/52736864#52736864", "title": "Paste data - ranges of Listobjects in other Listobject of Excel", "body": "<p>Try this:</p>\n\n<pre><code>Dim TBL1 As ListObject\nDim TBL2 As ListObject\nDim TBL3 As ListObject\n\nSet TBL1 = ActiveSheet.ListObjects(\"TBL_1\")\nSet TBL2 = ActiveSheet.ListObjects(\"TBL_2\")\nSet TBL3 = ActiveSheet.ListObjects(\"TBL_3\")\n\nDim ZZ As Long\n\n'we clean TBL3 only if there is data\nIf Range(TBL3.Name &amp; \"[\" &amp; TBL3.HeaderRowRange(1, 1).Value &amp; \"]\").Cells(1, 1).Value &lt;&gt; \"\" Or _\n    Range(TBL3.Name &amp; \"[\" &amp; TBL3.HeaderRowRange(1, 1).Value &amp; \"]\").Count &gt; 1 Then TBL3.DataBodyRange.Delete\n\n\nRange(TBL1.Name &amp; \"[\" &amp; TBL1.HeaderRowRange(1, 1).Value &amp; \"]\").Copy\nRange(TBL3.Name &amp; \"[\" &amp; TBL3.HeaderRowRange(1, 1).Value &amp; \"]\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nRange(TBL1.Name &amp; \"[\" &amp; TBL1.HeaderRowRange(1, 3).Value &amp; \"]\").Copy\nRange(TBL3.Name &amp; \"[\" &amp; TBL3.HeaderRowRange(1, 3).Value &amp; \"]\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nRange(TBL2.Name &amp; \"[\" &amp; TBL2.HeaderRowRange(1, 1).Value &amp; \"]\").Copy\n\nRange(TBL3.Name &amp; \"[\" &amp; TBL3.HeaderRowRange(1, 1).Value &amp; \"]\").End(xlDown).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nRange(TBL2.Name &amp; \"[\" &amp; TBL2.HeaderRowRange(1, 3).Value &amp; \"]\").Copy\n\nRange(TBL3.Name &amp; \"[\" &amp; TBL3.HeaderRowRange(1, 3).Value &amp; \"]\").End(xlDown).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\n'we clean blanks\nFor ZZ = TBL3.DataBodyRange.Rows.Count To 1 Step -1\n    If TBL3.DataBodyRange.Cells(ZZ, 1).Value = \"\" Then TBL3.ListRows(ZZ).Delete\nNext ZZ\n\n\nSet TBL1 = Nothing\nSet TBL2 = Nothing\nSet TBL3 = Nothing\n</code></pre>\n\n<p>The code pastes all data in Column 1 and 3 of Tbl1 and Tbl2 into column 1 and 3 of Tbl3.</p>\n\n<p>After pasting, it checks if there is any blank, and if true, then it deletes that row of the table.</p>\n\n<p>I tried with this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/X4YkL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X4YkL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And after applying code, I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LrWjt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LrWjt.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Please, note that the code also <strong>deletes ALL data in TBL3 before pasting</strong>.</p>\n\n<p>Hope you can adap this to your needs.</p>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1591, "favorite_count": 0, "accepted_answer_id": 52736864, "answer_count": 1, "score": 1, "last_activity_date": 1539163993, "creation_date": 1539160968, "last_edit_date": 1539161990, "question_id": 52736088, "link": "https://stackoverflow.com/questions/52736088/paste-data-ranges-of-listobjects-in-other-listobject-of-excel", "title": "Paste data - ranges of Listobjects in other Listobject of Excel", "body": "<p>I am using VBA to move data between tables in excel (ListObjects)\nAnd I want to avoid loops for they are too much time consuming</p>\n\n<p>I have a first (origin) table called:tabl1\nand a second origin table: tbl2</p>\n\n<p>I have a destiny table called:tbl3\nthis table is empty, so databodyrange is nothing</p>\n\n<p>I would like to paste data from the two origin tables tbl1 and tbl2 into tbl3</p>\n\n<pre><code>Dim tbl1 As ListObject\nDim tbl2 As ListObject\nDim tbl3 As ListObject\nSet tbl1 = ThisWorkbook.Sheets(1).ListObjects(\"table1\")\nSet tbl2 = ThisWorkbook.Sheets(1).ListObjects(\"table2\")\nSet tbl3 = ThisWorkbook.Sheets(1).ListObjects(\"table3\")\n\n'delete the data of table 3\nIf Not tbl3.DataBodyRange Is Nothing Then\n    tbl3.DataBodyRange.Delete\nEnd If\n\n'Adding a first row to avoid that databodyrange isnothing\ntbl3.ListRows.Add\n'this code does not work\n'What I try to do is copy the range of column1 of table1 and paste it in the first \ntbl1.ListColumns(1).DataBodyRange.Copy Destination:=tbl3.ListColumns(1).DataBodyRange.Item(1).Address\n</code></pre>\n\n<p>I dont want to use loop (too slow)\nAnd I dont want to use \".select\": too error-prone.</p>\n\n<p>And of course, the data pasted in table three has to be part of the table.</p>\n\n<p>In this link I posted myself (and answered) a partial solution to the problem: \n<a href=\"https://stackoverflow.com/questions/52035816/excel-copy-data-from-several-columns-of-listobject-a-tablea-into-one-column-of\">Excel copy data from several columns of listobject A (tableA) into one column of listobject B (tableB) one after the other</a></p>\n\n<p>but I would really like to find a solution referring only to the name of listobjects and not to absolute positions in a sheet (otherwise moving the listobject would invalidate the solution).</p>\n\n<p>Here is the problem illustrated. Be aware that I put the three tables in one sheet for clarity purposes but the tables are distributed in different sheets.\n<a href=\"https://i.stack.imgur.com/Ma7iW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ma7iW.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the desired result:\n<a href=\"https://i.stack.imgur.com/osCeP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/osCeP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "dll"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1539161079, "post_id": 52736021, "comment_id": 92396917, "body": "Welcome to SO. You can&#39;t do what you want. Variables are in memory only during execution of code. To <i>save</i> the values, you need to store the value somewhere, i.e, a spreadsheet, a database or something. You have no posted anything about your project, so I will answer that you can save the value in a cell, save the workbook, and continue your project tomorrow"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1539161128, "post_id": 52736021, "comment_id": 92396943, "body": "Your question is too broad... There&#39;s a lot of different ways to do what you&#39;re asking for. Some of those are simple and others are more complicated. It depends of the nature of your goal. For example, why don&#39;t use the excel file itself to store your data?"}, {"owner": {"reputation": 1, "user_id": 10425408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5262fec084da2728fe0eb543a5600acf?s=128&d=identicon&r=PG&f=1", "display_name": "usercccc", "link": "https://stackoverflow.com/users/10425408/usercccc"}, "edited": false, "score": 0, "creation_date": 1539161874, "post_id": 52736021, "comment_id": 92397376, "body": "Hello, sorry for not having had better what I was asking.  I am preparing a form, in which some input data is requested from the user, and the code of the form, is making calculations and is sequentially obtaining components for a machine. The process is long, and I am looking for that if the user does not complete it once, I can leave it, and continue later. Or in case you want to recover the results already calculated once, just have to &quot;load&quot; them, do not re-enter all the data and calculate everything."}, {"owner": {"reputation": 1, "user_id": 10425408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5262fec084da2728fe0eb543a5600acf?s=128&d=identicon&r=PG&f=1", "display_name": "usercccc", "link": "https://stackoverflow.com/users/10425408/usercccc"}, "edited": false, "score": 0, "creation_date": 1539161887, "post_id": 52736021, "comment_id": 92397389, "body": "I&#39;ve been trying to do that, with a &quot;save&quot; button, which saves all the values I&#39;ve entered and calculated so far in an external file (for example .txt or .dat) and with an &quot;open&quot; button that allows loading all the data saved in that file and continue working.  I can not save this data in Excel cells, because the program is expected to be used to perform many different calculations."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1539161927, "post_id": 52736021, "comment_id": 92397419, "body": "Why can&#39;t you store them in a sheet in the file which is hidden, or very hidden?"}, {"owner": {"reputation": 1, "user_id": 10425408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5262fec084da2728fe0eb543a5600acf?s=128&d=identicon&r=PG&f=1", "display_name": "usercccc", "link": "https://stackoverflow.com/users/10425408/usercccc"}, "edited": false, "score": 0, "creation_date": 1539162264, "post_id": 52736021, "comment_id": 92397658, "body": "Because I&#39;m looking for a way to do it that involves not modifying the excel document.  On the one hand there is the Excel with the calculation program, and on the other hand there are the saved files, one for each calculation made that can be opened and revised if necessary."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1539163740, "post_id": 52736021, "comment_id": 92398596, "body": "If you don&#39;t want to store it in Excel, you could store them also somehow in a text file. But there is no out of the box way to do so, you have to program it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10425408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5262fec084da2728fe0eb543a5600acf?s=128&d=identicon&r=PG&f=1", "display_name": "usercccc", "link": "https://stackoverflow.com/users/10425408/usercccc"}, "edited": false, "score": 0, "creation_date": 1539165897, "post_id": 52737471, "comment_id": 92399922, "body": "Thank you very much for the help !!!!, I will try with this code, to see if I can get it to work and review the references."}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 1, "last_activity_date": 1539165340, "creation_date": 1539165340, "answer_id": 52737471, "question_id": 52736021, "link": "https://stackoverflow.com/questions/52736021/save-and-retrieve-the-value-of-the-variables/52737471#52737471", "title": "Save and retrieve the value of the variables", "body": "<p>I can show you how to save data on an external file. Let's imagine you want to save four values (for four variables) on the file <code>C:\\DATA.dat</code>. The four variables are <code>DAT1</code>, <code>DAT2</code>, <code>DAT3</code> and <code>DAT4</code> (a Boolean, an Integer, a Single and a String). You could use the next code (on a VBA module of your workbook) to do that:</p>\n\n<pre><code>Sub SaveDATA()\n\n    'Variables:\n        Dim FilePath As String: FilePath = \"C:\\DATA.dat\"\n        Dim FSO As New FileSystemObject: Dim Writer As TextStream\n\n        Dim DAT1 As Boolean: DAT1 = False\n        Dim DAT2 As Integer: DAT2 = 3\n        Dim DAT3 As Single: DAT3 = 3 / 7\n        Dim DAT4 As String: DAT4 = \"Another example\"\n\n    'Create/Overwrite the file:\n        Set Writer = FSO.CreateTextFile(FilePath, True)\n\n    'Write the file:\n        Writer.WriteLine (DAT1)\n        Writer.WriteLine (DAT2)\n        Writer.WriteLine (DAT3)\n        Writer.WriteLine (DAT4)\n\n    'Close the file:\n        Writer.Close\n\nEnd Sub\n</code></pre>\n\n<p>To retrieve the data you saved on the file you have to use something similar to the next code:</p>\n\n<pre><code>Sub ReadDATA()\n\n    'Variables:\n        Dim FilePath As String: FilePath = \"C:\\DATA.dat\"\n        Dim FSO As New FileSystemObject: Dim Reader As TextStream\n\n        Dim DAT1 As Boolean\n        Dim DAT2 As Integer\n        Dim DAT3 As Single\n        Dim DAT4 As String\n\n    'Open the file:\n        Set Reader = FSO.OpenTextFile(FilePath)\n\n    'Read the file:\n        DAT1 = Reader.ReadLine\n        DAT2 = Val(Reader.ReadLine)\n        DAT3 = Val(Reader.ReadLine)\n        DAT4 = Reader.ReadLine\n\n    'Close the file:\n        Reader.Close\n\nEnd Sub\n</code></pre>\n\n<p>For both macros to work, you have to import <code>Microsoft Scripting Runtime</code> reference (just go to <code>Tools -&gt; References</code> and check it.</p>\n\n<p>I won't do the rest of the work for you (for now)! That's up to you... Make some experiences! That's the best way to learn!</p>\n"}], "owner": {"reputation": 1, "user_id": 10425408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5262fec084da2728fe0eb543a5600acf?s=128&d=identicon&r=PG&f=1", "display_name": "usercccc", "link": "https://stackoverflow.com/users/10425408/usercccc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2485, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1593707455, "creation_date": 1539160776, "last_edit_date": 1593707455, "question_id": 52736021, "link": "https://stackoverflow.com/questions/52736021/save-and-retrieve-the-value-of-the-variables", "title": "Save and retrieve the value of the variables", "body": "<p>I am programming a macro in Excel-VBA to perform different calculations by phases within a project.</p>\n\n<p>I need to schedule a way to save the work I have calculated in one form at a time, so I can continue another day.</p>\n\n<p>Is there any way to write all the values of variables that have already been assigned or calculated, in a file (.txt, .dat ...)?</p>\n\n<p>So that the value of the stored variables can be recovered later, and continue working.</p>\n\n<p>It would work as the \"save\", \"save as\", \"open\" buttons. But with the variables entered or calculated in my form.</p>\n\n<p>How can all the variables that already have value be saved?</p>\n\n<p>If I program them to be saved one by one, I get an error as expected, when I try to save a variable that I have not yet calculated ...</p>\n\n<p>Thank you very much for the help!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1539160688, "post_id": 52735889, "comment_id": 92396720, "body": "This looks like a <i>&quot;here is my code please fix it&quot;</i> question. Also <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">\u201cCan someone help me?\u201d is not an actual question?</a>. I recommend to read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to improve your question and include in your question where exactly you got stuck (or errors) and what your difficulties are while tying to fix it. Reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might also help you to ask a better question."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1539160918, "post_id": 52735889, "comment_id": 92396838, "body": "Why don&#39;t you just compare the full filepath? Then you can&#39;t compare files in a different folder?"}, {"owner": {"reputation": 9, "user_id": 10482946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03478c0aff481cf670a5cebaf0b6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Morris", "link": "https://stackoverflow.com/users/10482946/alex-morris"}, "edited": false, "score": 0, "creation_date": 1539163415, "post_id": 52735889, "comment_id": 92398401, "body": "Thank you for the recommendation but unfortunately this is not &quot;my code&quot;, I do not know VB, I just found it and changed a bit where I could understand."}, {"owner": {"reputation": 9, "user_id": 10482946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03478c0aff481cf670a5cebaf0b6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Morris", "link": "https://stackoverflow.com/users/10482946/alex-morris"}, "edited": false, "score": 0, "creation_date": 1539163990, "post_id": 52735889, "comment_id": 92398736, "body": "Sam, ithis could work, but unfortunately I do not know how to do this..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539165593, "post_id": 52735889, "comment_id": 92399729, "body": "The thing is that people here can kindly help/assist you fixing your issues yourself. But the one who needs to fix it is still you. You work, we assist. \u2022 If you cannot do it it&#39;s probably a better way to hire and pay someone who does it for you. Let me try to explain it with an example: If you cannot drive the car at all you need to pay for the taxi or bus. But if you have a specific question like <i>&quot;How do I put in the reverse gear in a Mercedes Benz?&quot;</i> we can answer that."}, {"owner": {"reputation": 9, "user_id": 10482946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03478c0aff481cf670a5cebaf0b6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Morris", "link": "https://stackoverflow.com/users/10482946/alex-morris"}, "edited": false, "score": 0, "creation_date": 1539166952, "post_id": 52735889, "comment_id": 92400583, "body": "P\u1d07\u029c, I&#39;m pretty sure that you are experienced person here and you know what you are doing and advising and I respect your point of you, but I think that the change that is need to be done in this code is not global. Of course otherwise my attitude to the problem was appropriate. If I&#39;m wrong and this is a huge work here (not case of 1-2 strings) then sorry for bothering. But if the change is not sighnificant any hint could help. I can try to change the code myself, but I need to know where exactly:)"}], "owner": {"reputation": 9, "user_id": 10482946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03478c0aff481cf670a5cebaf0b6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Morris", "link": "https://stackoverflow.com/users/10482946/alex-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593707436, "creation_date": 1539160278, "last_edit_date": 1593707436, "question_id": 52735889, "link": "https://stackoverflow.com/questions/52735889/file-comparison-report", "title": "File comparison report", "body": "<p>The code below searches and compares the file names between two folders (including subfolders) reporting how many duplicates there are between folders. Subfolder names are identical. \nI need to prohibit to comare files from different subfolders. I mean macro should only compare files in subfolders with the same subfolder names even if in other folders there are files with the same file names.\nCan anyone help?</p>\n\n<p>Example:</p>\n\n<pre><code> **folder1**       **folder2**\nfirst_folder  vs  first_folder   \n  1.xml                 1.xml\n  2.xml                 2.xml\n\nsecond_folder vs  second_folder\n  1.xml                 1.xml\n</code></pre>\n\n<p>The macro should not search for and compare 1.xml file between first_folder and second_folder. Only files from the same folder name should be compared. </p>\n\n<p>Thank you in advance.</p>\n\n<pre><code>Sub CompareContentsofTwoFolders()\n     Dim fcount As Variant\n     Dim pth1 As String, pth2 As String\n     Dim r1 As Single, r2 As Single\n     Dim arrd() As Variant\n     Dim arru() As Variant\n     ReDim arrd(0 To 5, 0)\n     ReDim arru(0 To 2, 0)\n     With Application.FileDialog(msoFileDialogFolderPicker)\n         .Show\n         pth1 = .SelectedItems(1) &amp; \"\\\"\n     End With\n     With Application.FileDialog(msoFileDialogFolderPicker)\n         .Show\n         pth2 = .SelectedItems(1) &amp; \"\\\"\n     End With\n     Sheets.Add\n     Set x = ActiveSheet\n     Application.ScreenUpdating = False\n     x.Range(\"A1\") = \"Duplicate files\"\n     x.Range(\"A2\") = \"Path\"\n     x.Range(\"B2\") = \"File name\"\n     x.Range(\"C2\") = \"Size\"\n     x.Range(\"D2\") = \"Path\"\n     x.Range(\"E2\") = \"File name\"\n     x.Range(\"F2\") = \"Size\"\n     x.Range(\"A:F\").Font.Bold = False\n     x.Range(\"A1:F2\").Font.Bold = True\n     Recursive pth1\n\n     Lrow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n     x.Range(\"A2:C\" &amp; Lrow).Sort Key1:=x.Range(\"B1\"), Header:=xlYes\n     arr1 = x.Range(\"A3:C\" &amp; Lrow).Value\n     x.Range(\"A3:C\" &amp; Lrow).Clear\n     Recursive pth2\n     Lrow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n     x.Range(\"A2:C\" &amp; Lrow).Sort Key1:=x.Range(\"B1\"), Header:=xlYes\n     arr2 = x.Range(\"A3:C\" &amp; Lrow).Value\n     x.Range(\"A3:C\" &amp; Lrow).Clear\n     x.Range(\"H1\") = \"Total number of files in Folder 1: \" 'Modified No.1\n     x.Range(\"I1\") = UBound(arr1, 1)\n     x.Range(\"H2\") = \"Total number of files in Folder 2: \" 'Modified No.2\n     x.Range(\"I2\") = UBound(arr2, 1)\n     For r1 = LBound(arr1, 1) To UBound(arr1, 1)\n         chk = False\n             If r1 &gt; 1 Then\n                 If arr1(r1, 2) = arr1(r1 - 1, 2) Then\n                     For r3 = UBound(arrd, 2) To LBound(arrd, 2) Step -1\n                         If arrd(2, r3) &lt;&gt; \"\" And arrd(1, r3) &lt;&gt; arr1(r1, 2) Then Exit For\n                         If arrd(1, r3) = arr1(r1, 2) Then\n                             If r3 = UBound(arrd, 2) Then ReDim Preserve arrd(UBound(arrd, 1), UBound(arrd, 2) + 1)\n                             arrd(0, r3 + 1) = arr1(r1, 1)\n                             arrd(1, r3 + 1) = arr1(r1, 2)\n                             arrd(2, r3 + 1) = arr1(r1, 3)\n                             ReDim Preserve arrd(UBound(arrd, 1), UBound(arrd, 2) + 1)\n                             Exit For\n                         End If\n                     Next r3\n                     For r3 = UBound(arru, 2) To LBound(arru, 2) Step -1\n                         If arru(2, r3) &lt;&gt; \"\" And arru(1, r3) &lt;&gt; arr1(r1, 2) Then Exit For\n                         If arru(1, r3) = arr1(r1, 2) Then\n                             If r3 = UBound(arru, 2) Then ReDim Preserve arru(UBound(arru, 1), UBound(arru, 2) + 1)\n                             arru(0, r3 + 1) = arr1(r1, 1)\n                             arru(1, r3 + 1) = arr1(r1, 2)\n                             arru(2, r3 + 1) = arr1(r1, 3)\n                             ReDim Preserve arru(UBound(arru, 1), UBound(arru, 2) + 1)\n                             Exit For\n                         End If\n                     Next r3\n                     GoTo jmp\n                 End If\n             End If\n         For r2 = LBound(arr2, 1) To UBound(arr2, 1)\n             If arr2(r2, 2) = arr1(r1, 2) Then\n                 If chk = False Then\n                     arrd(0, UBound(arrd, 2)) = arr1(r1, 1)\n                     arrd(1, UBound(arrd, 2)) = arr1(r1, 2)\n                     arrd(2, UBound(arrd, 2)) = arr1(r1, 3)\n                 Else\n                     arrd(0, UBound(arrd, 2)) = \"\"\n                     arrd(1, UBound(arrd, 2)) = \"\"\n                     arrd(2, UBound(arrd, 2)) = \"\"\n                 End If\n                 arrd(3, UBound(arrd, 2)) = arr2(r2, 1)\n                 arrd(4, UBound(arrd, 2)) = arr2(r2, 2)\n                 arrd(5, UBound(arrd, 2)) = arr2(r2, 3)\n                 arr2(r2, 1) = \"\"\n                 ReDim Preserve arrd(UBound(arrd, 1), UBound(arrd, 2) + 1)\n                 chk = True\n             End If\n         Next r2\n         If chk = False Then\n                 arru(0, UBound(arru, 2)) = arr1(r1, 1)\n                 arru(1, UBound(arru, 2)) = arr1(r1, 2)\n                 arru(2, UBound(arru, 2)) = arr1(r1, 3)\n                 ReDim Preserve arru(UBound(arru, 1), UBound(arru, 2) + 1)\n         End If\njmp:\n     Next r1\n     For r2 = LBound(arr2, 1) To UBound(arr2, 1)\n         If arr2(r2, 1) &lt;&gt; \"\" Then\n             arru(0, UBound(arru, 2)) = arr2(r2, 1)\n             arru(1, UBound(arru, 2)) = arr2(r2, 2)\n             arru(2, UBound(arru, 2)) = arr2(r2, 3)\n             ReDim Preserve arru(UBound(arru, 1), UBound(arru, 2) + 1)\n         End If\n     Next r2\n     x.Range(\"A3\").Resize(UBound(arrd, 2) + 1, UBound(arrd, 1) + 1) = Application.Transpose(arrd)\n     x.Range(\"H3\") = \"Total number of duplicate files: \" 'Modified No.3\n     x.Range(\"I3\") = UBound(arrd, 2)\n     x.Range(\"H4\") = \"Total number of unique files: \" 'Modified No.4\n     x.Range(\"I4\") = UBound(arru, 2)\n     x.Range(\"A\" &amp; UBound(arrd, 2) + 3) = \"Unique files\"\n     x.Range(\"A\" &amp; UBound(arrd, 2) + 4) = \"Path\"\n     x.Range(\"B\" &amp; UBound(arrd, 2) + 4) = \"File name\"\n     x.Range(\"C\" &amp; UBound(arrd, 2) + 4) = \"Size\"\n     x.Range(\"A\" &amp; UBound(arrd, 2) + 3 &amp; \":C\" &amp; UBound(arrd, 2) + 4).Font.Bold = True\n     x.Range(\"A\" &amp; UBound(arrd, 2) + 5).Resize(UBound(arru, 2) + 1, UBound(arru, 1) + 1) = Application.Transpose(arru)\n\n     Application.ScreenUpdating = True\n     End Sub\n     Sub Recursive(FolderPath As String)\n     Dim Value As String, Folders() As String\n     Dim Folder As Variant, a As Long\n     ReDim Folders(0)\n     If Right(FolderPath, 2) = \"\\\\\" Then Exit Sub\n     Value = Dir(FolderPath, &amp;H1F)\n     Do Until Value = \"\"\n         If Value = \".\" Or Value = \"..\" Then\n\n         Else\n             If GetAttr(FolderPath &amp; Value) = 16 Or GetAttr(FolderPath &amp; Value) = 48 Then\n                 Folders(UBound(Folders)) = Value\n                 ReDim Preserve Folders(UBound(Folders) + 1)\n             Else\n                 If Right(Value, 4) = \".xml\" Then\n                    Lrow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n                    ActiveSheet.Range(\"A\" &amp; Lrow) = FolderPath\n                    ActiveSheet.Range(\"B\" &amp; Lrow) = Value\n                    ActiveSheet.Range(\"C\" &amp; Lrow) = FileLen(FolderPath &amp; Value)\n                End If\n             End If\n         End If\n         Value = Dir\n     Loop\n     For Each Folder In Folders\n         Recursive FolderPath &amp; Folder &amp; \"\\\"\n     Next Folder\n End Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1539162167, "post_id": 52735887, "comment_id": 92397578, "body": "<code>tried indenting the statement</code> indentation (unlike in python for example) has no influence in vba. Search for &quot;vba syntax&quot; if you need more information."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 2, "creation_date": 1539166513, "post_id": 52735887, "comment_id": 92400308, "body": "Beware! That \u201ci = i + 1\u201d inside a \u201cFor i = 20 To 1 Step -1\u201d loop results in an infinite loop!"}], "answers": [{"comments": [{"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 1, "creation_date": 1539185357, "post_id": 52735934, "comment_id": 92412122, "body": "For for/next loop counts backwards, but inside the loop i is incremented.  It will never exit the loop."}], "tags": [], "owner": {"reputation": 1034, "user_id": 2190035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efcb19df4ff78ab26426b9fefb63f83f?s=128&d=identicon&r=PG&f=1", "display_name": "user11909", "link": "https://stackoverflow.com/users/2190035/user11909"}, "is_accepted": false, "score": 4, "last_activity_date": 1539237372, "last_edit_date": 1539237372, "creation_date": 1539160454, "answer_id": 52735934, "question_id": 52735887, "link": "https://stackoverflow.com/questions/52735887/end-if-without-block-if-indented-but-still-doesnt-work/52735934#52735934", "title": "End If without Block if - Indented, but still doesn&#39;t work", "body": "<p>Remove the colon after <code>Else</code>.</p>\n\n<p>Replace <code>Exit For</code> with <code>Next</code>. With <code>Exit For</code> you can exit the For loop prematurely.</p>\n\n<p>As @Bill Hileman mentioned in the comments, the For loop will run infinite because <code>i</code> is incremented within the loop, but is decremented in the For loop body.</p>\n\n<pre><code>If TextBox1.Text = \"\" Then\n\n    MsgBox \"Please Enter Value\"\n\nElse\n    Sheets(\"confirmation\").Range(\"F7\").Value = ComboBox1.Value\n    Sheets(\"confirmation\").Range(\"F9\").Value = TextBox1.Value\n\n    For i = 20 To 1 Step -1\n        Rows(i &amp; \":33\").EntireRow.Hidden = False\n        Cells(13 + i, 1).Value = 20\n        i = i + 1\n    Next\n    UserForm1.Hide\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1539160489, "creation_date": 1539160489, "answer_id": 52735942, "question_id": 52735887, "link": "https://stackoverflow.com/questions/52735887/end-if-without-block-if-indented-but-still-doesnt-work/52735942#52735942", "title": "End If without Block if - Indented, but still doesn&#39;t work", "body": "<p>You need also to indicate where the for loop ends, with <code>next</code>. And you need to remove the <code>:</code></p>\n\n<pre><code>If ... Then\n  ....\nElse\n\n  For ...\n    ...\n    Exit For\n  Next\n\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6726449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209203697182225/picture?type=large", "display_name": "Conradie Fourie", "link": "https://stackoverflow.com/users/6726449/conradie-fourie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539237372, "creation_date": 1539160277, "question_id": 52735887, "link": "https://stackoverflow.com/questions/52735887/end-if-without-block-if-indented-but-still-doesnt-work", "title": "End If without Block if - Indented, but still doesn&#39;t work", "body": "<p>I constantly get the error \"End If without Block If\" although I have an End if for the beginning If and also tried indenting the statement. What is wrong?</p>\n\n<pre><code>If TextBox1.Text = \"\" Then\n\n    MsgBox \"Please Enter Value\"\n\nElse:\n    Sheets(\"confirmation\").Range(\"F7\").Value = ComboBox1.Value\n    Sheets(\"confirmation\").Range(\"F9\").Value = TextBox1.Value\n\n    For i = 20 To 1 Step -1\n        Rows(i &amp; \":33\").EntireRow.Hidden = False\n        Cells(13 + i, 1).Value = 20\n        i = i + 1\n    Exit For\n    UserForm1.Hide\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1539159465, "post_id": 52735496, "comment_id": 92396051, "body": "<a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">Here</a> is a good explanation"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 9849285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vOfDi.jpg?s=128&g=1", "display_name": "Nader Nagazi", "link": "https://stackoverflow.com/users/9849285/nader-nagazi"}, "is_accepted": false, "score": 0, "last_activity_date": 1539159623, "creation_date": 1539159623, "answer_id": 52735684, "question_id": 52735496, "link": "https://stackoverflow.com/questions/52735496/what-is-the-difference-between-me-object-and-userformname-object/52735684#52735684", "title": "What is the difference between Me-Object and UserFormName-Object?", "body": "<p>You can use <code>UserForm.Object</code> only when the UserForm is explicitly created (Using Insert -> User Form) and shown in the project explorer tree.\nIf the userform is not shown in the project explorer tree, then you will get an error \"Object not Found\" if you use <code>UserForm.Object</code></p>\n"}, {"comments": [{"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1539163676, "post_id": 52735727, "comment_id": 92398557, "body": "Thank you for the quick and comprehensive answer. I have <a href=\"https://stackoverflow.com/questions/52735130/how-does-one-get-the-userform-where-msforms-combobox-object-is-located\">another question</a> closely related to this. You may be able to answer that?"}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 3, "last_activity_date": 1539159742, "creation_date": 1539159742, "answer_id": 52735727, "question_id": 52735496, "link": "https://stackoverflow.com/questions/52735496/what-is-the-difference-between-me-object-and-userformname-object/52735727#52735727", "title": "What is the difference between Me-Object and UserFormName-Object?", "body": "<p>They refer to different objects. A UserForm is just a Class that has a Default Instance, a free object created when you call the class by name.</p>\n\n<blockquote>\n  <p>Me.Model.N</p>\n</blockquote>\n\n<p>References the object you instanced.</p>\n\n<blockquote>\n  <p>frmFilter.Model.N</p>\n</blockquote>\n\n<p>Refers to the Default Instance of the Userform, which has no model associated with it.</p>\n\n<p>Good write-up on this issue here: <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/</a></p>\n"}], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52735727, "answer_count": 2, "score": 0, "last_activity_date": 1593778929, "creation_date": 1539158948, "last_edit_date": 1593778929, "question_id": 52735496, "link": "https://stackoverflow.com/questions/52735496/what-is-the-difference-between-me-object-and-userformname-object", "title": "What is the difference between Me-Object and UserFormName-Object?", "body": "<p>I just found out that the Me-Object and UserFormName is not the same Object. Here my example: </p>\n\n<p>I have two custom classes FilterLine and FilterModel. All you need to know is that FitlerModel has a property N which is set to = if newed up. There is also a UserForm called frmFilter.</p>\n\n<pre><code>Sub testFilter()\nDim Filterm As FilterModel\n\nSet Filterm = New FilterModel\n\nWith New frmFilter\n    Set .Model = Filterm\n    .ExampleSub ' This is the interesting part\n    .Show\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Here the ExampleSub of the Userform frmFilter:</p>\n\n<pre><code>Public Sub ExampleSub()\nDebug.Print Me.Model.N ' gives a 0\n\nDebug.Print frmFilter.Model.N ' gives an error \"Object not Found\"\nEnd Sub\n</code></pre>\n\n<p><strong>I find this rather interesting what is going on here?</strong> Why are they different and how are they different?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 7046239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HqLuRnZShmU/AAAAAAAAAAI/AAAAAAAAADM/A7YMdrxmOeM/photo.jpg?sz=128", "display_name": "bob", "link": "https://stackoverflow.com/users/7046239/bob"}, "edited": false, "score": 0, "creation_date": 1539160905, "post_id": 52735719, "comment_id": 92396829, "body": "Thank you very much, it worked. I&#39;m sorry I cannot upvote as I am new."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1539161881, "post_id": 52735719, "comment_id": 92397381, "body": "Note that this is very static and you have to re-run this every time column B values change. Otherwise it will not recognize if someone added or deleted a value in B and therefore doesn&#39;t reflect that in the behavior of the drop down list. Therefore I recommend to use a <code>IF</code> formula (see my answer) as validation formula that reflects it immediately as the value in B changes."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1539160038, "last_edit_date": 1539160038, "creation_date": 1539159700, "answer_id": 52735719, "question_id": 52735411, "link": "https://stackoverflow.com/questions/52735411/change-drop-down-list-items-based-on-adjacent-cell-value-in-vba/52735719#52735719", "title": "Change drop down list items based on adjacent cell value in vba", "body": "<p><strong>VBA Solution</strong></p>\n\n<p>The following will achieve what you expect, it will loop through your column B and if empty it will add a drop-down as Data Validation on Column A with the value \"ADD\", if not empty it will add the list \"MODIFY\", \"ADD\", \"DELETE\":</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Worksheets(\"Sheet1\")\n'declare and set the worksheet you are using, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n'get the last row with data on Column B\n\nFor i = 2 To LastRow 'loop from Row 2 to Last\n    If ws.Cells(i, \"B\").Value &lt;&gt; \"\" Then\n        With ws.Cells(i, \"A\").Validation\n            .Delete\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n            xlBetween, Formula1:=\"MODIFY,ADD,DELETE\"\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .ShowInput = True\n            .ShowError = True\n        End With\n    Else\n        With ws.Cells(i, \"A\").Validation\n            .Delete\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n            xlBetween, Formula1:=\"ADD\"\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .ShowInput = True\n            .ShowError = True\n        End With\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1539159876, "creation_date": 1539159876, "answer_id": 52735768, "question_id": 52735411, "link": "https://stackoverflow.com/questions/52735411/change-drop-down-list-items-based-on-adjacent-cell-value-in-vba/52735768#52735768", "title": "Change drop down list items based on adjacent cell value in vba", "body": "<h3>Solution without VBA</h3>\n\n<p>You can do this with the <a href=\"https://support.office.com/en-us/article/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249\" rel=\"nofollow noreferrer\">Data Validation</a> tool of Excel:</p>\n\n<p>First you need to add all the drop down options (ADD, MODIFY, DELETE) into a range. That can be in the same worksheetor in any other worksheet. For my example I put them into range <code>F1:F3</code> of the same worksheet.</p>\n\n<p>Then select the whole column A and add a data validation from Ribbon Menu \u203a Data \u203a Data Tools \u203a Data Validation:<br>\n<a href=\"https://i.stack.imgur.com/d4hiO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d4hiO.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the <strong>Settings</strong> tab, under <strong>Allow</strong>, select <strong>List</strong> and use the following formula at <strong>Source</strong>:</p>\n\n<pre><code>=IF(B1&lt;&gt;\"\",$F$1:$F$3,$F$1)\n</code></pre>\n\n<p>Note that the first range <code>$F$1:$F$3</code> points to ADD, MODIFY, DELETE and the second range <code>$F$1</code> points to ADD only!</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539161607, "post_id": 52735804, "comment_id": 92397217, "body": "A note: I recommend to handle <code>Indirect</code> with care (or even stay away if possible) because it is <i>volatile</i>. This can cause heavy load on calculation times if it is used extensively because volatile functions always recalculate on <i>every</i> cell change. See my answer for a formula without <code>Indirect</code>."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1539160020, "creation_date": 1539160020, "answer_id": 52735804, "question_id": 52735411, "link": "https://stackoverflow.com/questions/52735411/change-drop-down-list-items-based-on-adjacent-cell-value-in-vba/52735804#52735804", "title": "Change drop down list items based on adjacent cell value in vba", "body": "<p>Name your list like below ,</p>\n\n<p><a href=\"https://i.stack.imgur.com/taqJY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/taqJY.png\" alt=\"enter image description here\"></a></p>\n\n<p>After that create a data validation with this formula</p>\n\n<blockquote>\n  <p>=INDIRECT(IF($C2&lt;>\"\",\"All\",\"One\"))</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/NLb7U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NLb7U.png\" alt=\"enter image description here\"></a></p>\n\n<p>You'll have the drop down as per your requirement</p>\n\n<p><a href=\"https://i.stack.imgur.com/lAnAH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lAnAH.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 547, "user_id": 7046239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HqLuRnZShmU/AAAAAAAAAAI/AAAAAAAAADM/A7YMdrxmOeM/photo.jpg?sz=128", "display_name": "bob", "link": "https://stackoverflow.com/users/7046239/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2950, "favorite_count": 1, "accepted_answer_id": 52735719, "answer_count": 3, "score": 0, "last_activity_date": 1593778940, "creation_date": 1539158619, "last_edit_date": 1593778940, "question_id": 52735411, "link": "https://stackoverflow.com/questions/52735411/change-drop-down-list-items-based-on-adjacent-cell-value-in-vba", "title": "Change drop down list items based on adjacent cell value in vba", "body": "<p>I have an excel sheet where I have a table with two columns and variable number of rows. Some of these rows will be filled and some empty. Column B contains some values and Column A has a drop down list in each cell.</p>\n\n<p>I want that if column B cell has some value then the adjacent column A cell should show 3 options in the drop down list - MODIFY, ADD, DELETE and when column B cell is empty then the adjacent column A cell should show only one option in its drop down list - ADD. Can it be done using VBA or excel formulas? </p>\n\n<p>Please don't confuse it with changing cell values based on drop down selection. It's the opposite.</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1539157963, "post_id": 52735185, "comment_id": 92395213, "body": "Every order should be in a new row even if it&#39;s from the same customer? Do you need them to be sorted for customers?"}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1539158048, "post_id": 52735185, "comment_id": 92395265, "body": "Yes, it doesn&#39;t matter if its the same customer ID. Every order creates a new row"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1539159282, "post_id": 52735185, "comment_id": 92395966, "body": "Just a advise, you can use the headers of the OrderTable as data validation for the order form products, this way you won&#39;t have to maintain twice the same list."}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1539159608, "post_id": 52735420, "comment_id": 92396131, "body": "This is excellent! Thanks Xabier for your answer, you&#39;re really a lifesaver :) , anyway, I thank you too for the bonus solution, even your first answer already gives what I need now. A million thanks again! :))"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1539159772, "post_id": 52735420, "comment_id": 92396205, "body": "@user71812 glad to be of assistance. :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 2, "last_activity_date": 1539158978, "last_edit_date": 1539158978, "creation_date": 1539158673, "answer_id": 52735420, "question_id": 52735185, "link": "https://stackoverflow.com/questions/52735185/excel-vba-insert-rows-under-the-column-if-adjacent-cell-value-matches-column-nam/52735420#52735420", "title": "Excel VBA insert rows under the column if adjacent cell value matches column names", "body": "<p>The following will achieve your expected results, it will use the .Find method to match the columns with the products entered then use them columns to add the values:</p>\n\n<pre><code>Sub Submit_OrderForm()\nDim ws As Worksheet: Set ws = Worksheets(\"OrderData\")\nDim wsOrderForm As Worksheet: Set wsOrderForm = Worksheets(\"OrderForm\")\nDim LastRow As Long\n\nLastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1 'Finds the last blank row\n\nSet Product1 = ws.Range(\"C4:H4\").Find(What:=wsOrderForm.Range(\"M9\").Value, lookat:=xlWhole)\n'find the column that matches the first product\nSet Product2 = ws.Range(\"C4:H4\").Find(What:=wsOrderForm.Range(\"M10\").Value, lookat:=xlWhole)\nSet Product3 = ws.Range(\"C4:H4\").Find(What:=wsOrderForm.Range(\"M11\").Value, lookat:=xlWhole)\n\nws.Cells(LastRow, \"B\").Value = wsOrderForm.Range(\"N6\").Value\nws.Cells(LastRow, Product1.Column).Value = wsOrderForm.Range(\"N9\").Value\nws.Cells(LastRow, Product2.Column).Value = wsOrderForm.Range(\"N10\").Value\nws.Cells(LastRow, Product3.Column).Value = wsOrderForm.Range(\"N11\").Value\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>If you want the same customers to be added into a single row, the following will achieve that:</p>\n\n<pre><code>Sub Submit_OrderForm()\nDim ws As Worksheet: Set ws = Worksheets(\"OrderData\")\nDim wsOrderForm As Worksheet: Set wsOrderForm = Worksheets(\"OrderForm\")\nDim LastRow As Long\n\nLastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1 'Finds the last blank row\n\ncustomerid = wsOrderForm.Range(\"N6\").Value\n\nSet customerfound = ws.Range(\"B:B\").Find(What:=customerid, lookat:=xlWhole)\nSet Product1 = ws.Range(\"C4:H4\").Find(What:=wsOrderForm.Range(\"M9\").Value, lookat:=xlWhole)\nSet Product2 = ws.Range(\"C4:H4\").Find(What:=wsOrderForm.Range(\"M10\").Value, lookat:=xlWhole)\nSet Product3 = ws.Range(\"C4:H4\").Find(What:=wsOrderForm.Range(\"M11\").Value, lookat:=xlWhole)\n\nIf Not customerfound Is Nothing Then\n    ws.Cells(customerfound.Row, Product1.Column).Value = ws.Cells(customerfound.Row, Product1.Column).Value + wsOrderForm.Range(\"N9\").Value\n    ws.Cells(customerfound.Row, Product2.Column).Value = ws.Cells(customerfound.Row, Product1.Column).Value + wsOrderForm.Range(\"N10\").Value\n    ws.Cells(customerfound.Row, Product3.Column).Value = ws.Cells(customerfound.Row, Product1.Column).Value + wsOrderForm.Range(\"N11\").Value\nElse\n    ws.Cells(LastRow, \"B\").Value = customerid\n    ws.Cells(LastRow, Product1.Column).Value = ws.Range(\"N9\").Value\n    ws.Cells(LastRow, Product2.Column).Value = ws.Range(\"N10\").Value\n    ws.Cells(LastRow, Product3.Column).Value = ws.Range(\"N11\").Value\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1539159952, "creation_date": 1539159952, "answer_id": 52735792, "question_id": 52735185, "link": "https://stackoverflow.com/questions/52735185/excel-vba-insert-rows-under-the-column-if-adjacent-cell-value-matches-column-nam/52735792#52735792", "title": "Excel VBA insert rows under the column if adjacent cell value matches column names", "body": "<p>you could use <code>Find()</code> method of <code>Range</code> object and loop through actual product input:</p>\n\n<pre><code>Sub Submit_OrderForm()\n    Dim ws As Worksheet\n    Dim lastRow As Long\n    Dim customerID As Variant\n\n    Set ws = Worksheets(\"OrderData\")\n\n    With Worksheets(\"OrderForm\")\n        customerID = .Range(\"N6\").Value\n        If IsEmpty(customerID) Then Exit Sub ' exit if no customer input\n        If WorksheetFunction.CountA(.Range(\"M9:M11\")) = 0 Then Exit Sub ' exit if no products input\n\n        lastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1 'finds the last blank row in OrderData data\n\n        ws.Cells(lastRow, 2).Value = customerID ' write customer Id\n        Dim cell As Range\n        For Each cell In .Range(\"M9:M11\").SpecialCells(xlCellTypeConstants) ' loop through products actual input\n            ws.Cells(lastRow, ws.Range(\"C4:H4\").Find(What:=cell.Value2, LookIn:=xlValues, lookat:=xlWhole).Column) = cell.Offset(, 1).Value\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1539160917, "creation_date": 1539160917, "answer_id": 52736069, "question_id": 52735185, "link": "https://stackoverflow.com/questions/52735185/excel-vba-insert-rows-under-the-column-if-adjacent-cell-value-matches-column-nam/52736069#52736069", "title": "Excel VBA insert rows under the column if adjacent cell value matches column names", "body": "<p>You can set a formula for the row to get the data, then overwrite it with the value.</p>\n\n<p>I also suggest you name your ranges, to make it easier to retrieve the values.</p>\n\n<pre><code>Sub Submit_OrderForm()\n    Dim ws As Worksheet, os as Worksheet\n    Dim LastRow As Long\n\n    Set os = WorkSheets(\"OrderForm\")\n    Set ws = Worksheets(\"OrderData\")\n    LastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1 'Finds the next blank row\n\n    ws.Range(LastRow, \"B\").Value = os.Range(\"N6\")\n    With ws.Range(LastRow, \"C\").Resize(,6)\n        .Formula = \"=IFERROR(VLOOKUP(C4,'OrderData'!$M$9:$N$11,2,FALSE),\"\"\"\")\"\n        .Value = .Value\n    end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 52735420, "answer_count": 3, "score": 0, "last_activity_date": 1593778954, "creation_date": 1539157704, "last_edit_date": 1593778954, "question_id": 52735185, "link": "https://stackoverflow.com/questions/52735185/excel-vba-insert-rows-under-the-column-if-adjacent-cell-value-matches-column-nam", "title": "Excel VBA insert rows under the column if adjacent cell value matches column names", "body": "<p>I have an <code>OrderForm</code> in sheet <code>OrderForm</code>, and a table <code>OrderTable</code> in Sheet <code>OrderData</code> that looks like this:\n<a href=\"https://i.stack.imgur.com/D6sFg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D6sFg.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now the maximum product number that one customerID can submit in one form is 3, and the list comes from the data validation from the the <code>productlist</code>. </p>\n\n<p>My goal is that everytime an <code>OrderForm</code> is submitted, then the record is automatically added as a new row in the <code>OrderTable</code>. </p>\n\n<p>Now the problem is, how do I get the amount entered for that order be stored in the column where the column name matches the product entered in M9:M11?</p>\n\n<p>So for example, if this customer ID is 151A, and he or she ordered Blueberry= 15, Apple= 20, and Plum=5, then I would want these amounts to be stored int eh <code>OrderTable</code> as a new record for customer 151A, with the amounts under the matching column names correspondingly.</p>\n\n<p>This is my code that I currently try, but I can't figure out the match-lookup part:</p>\n\n<pre><code>Sub Submit_OrderForm()\nDim ws As Worksheet\nDim LastRow As Long\n\nSet ws = Worksheets(\"OrderData\")\n\nLastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1 'Finds the last blank row\n\ncustomerid = Sheets(\"OrderForm\").Range(\"N6\").Value\n\n  'This is where I'm stuck. If column header matches the product chosen, Then:\n    ws.Range(\"C:H\").Value = Worksheets(\"OrderForm\").Range(\"N9\").Value  'Product 1\n    ws.Range(\"C:H\").Value = Worksheets(\"OrderForm\").Range(\"N10\").Value   'Product 2\n    ws.Range(\"C:H\").Value = Worksheets(\"OrderForm\").Range(\"N11\").Value  'Product 3\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Anyone knows how to deal with this problem? Thanks!</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1539171618, "post_id": 52737780, "comment_id": 92403268, "body": "Maybe I am doing something wrong but I don&#39;t get a .Parent property for my WithEvents MSForms.ComboBox. Does this depend on the Version of VBA?"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1539172219, "post_id": 52737780, "comment_id": 92403645, "body": "Oke, I tested this and <code>Me.Filter.Parent.Name</code> yields the right UserFormName. Which is nice. So altough it doesn&#39;t say Filter has a <code>.Parent</code> property it has one. BUT and here comes the big BUT: If I now want to access <code>Me.Filter.Parent.Model</code> the object doesn&#39;t exist. So maybe I am calling the default instance of the <code>Filter.Parent</code> could that be the case?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 1, "creation_date": 1539173416, "post_id": 52737780, "comment_id": 92404385, "body": "Is <code>Model</code> a procedure within the <code>UserForm</code>? I added this code to the form:  <code>Public Sub Model(): MsgBox Me.Name: End Sub</code> and then changed the <code>MsgBox</code> code in my <code>DblClick</code> event to <code>Filter.Parent.Model</code> and it ran the code."}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1539174396, "post_id": 52737780, "comment_id": 92405023, "body": "See Edit 2 Model is a property of the UserForm and of the custom type FilterModel. If a new FitlerModel gets created the constructor will set N=0 and the Collection to a new collection. But if the frmFilters defaults instance gets created the model is nothing. This will then cause parent.model to be empty. So I know now how to call the userform in which the comboBox is but it is obivousely not the one I indendet it to be in."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 1, "creation_date": 1539175227, "post_id": 52737780, "comment_id": 92405545, "body": "I can&#39;t see any <code>Collections</code> in your code or a reference to <code>N</code>?  Wouldn&#39;t it be better to have <code>IsCancelled</code> and <code>IsBack</code> as properties of <code>FilterModel</code> rather than as a <code>Type</code> that also contains the class?"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 1, "creation_date": 1539179699, "post_id": 52737780, "comment_id": 92408476, "body": "Oke I solved it using a workaround. I added another property into My FilterLine Class which is Called <code>ParentForm</code> this property is set using <code>set FilterLine.ParentForm =Me</code> in the frmFilter UserForm. And this makes this stuff work. You also may be right about the <code>IsBack</code> and <code>IsCancle</code> Stuff, but I am jsut getting started using this MVP structure so as long as it works and as long as I am not using default instances anymore I am happy."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1539166268, "creation_date": 1539166268, "answer_id": 52737780, "question_id": 52735130, "link": "https://stackoverflow.com/questions/52735130/how-does-one-get-the-userform-where-msforms-combobox-object-is-located/52737780#52737780", "title": "How does one get the UserForm where MSForms.ComboBox Object is located?", "body": "<p>You'd use <code>Filter.Parent</code>.  </p>\n\n<p>As an example:  </p>\n\n<p>Create a class named <code>Class1</code>.<br>\nAdd this code:  </p>\n\n<pre><code>Public WithEvents Filter As MSForms.ComboBox\n\nPrivate Sub Filter_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    MsgBox Filter.Parent.Name\nEnd Sub\n</code></pre>\n\n<p><code>UserForm1</code> contains a single combo-box named <code>ComboBox1</code>.<br>\nAdd this code to the form:  </p>\n\n<pre><code>Private colEvents As Collection\n\nPrivate Sub UserForm_Initialize()\n\n    Dim MyEvents As Class1\n\n    Set colEvents = New Collection\n    Set MyEvents = New Class1\n\n    Set MyEvents.Filter = Me.ComboBox1\n    colEvents.Add MyEvents\n\nEnd Sub\n</code></pre>\n\n<p>Open the form and double-click the combobox and it will tell you the name of the form.</p>\n"}], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 52737780, "answer_count": 1, "score": 0, "last_activity_date": 1593778976, "creation_date": 1539157511, "last_edit_date": 1593778976, "question_id": 52735130, "link": "https://stackoverflow.com/questions/52735130/how-does-one-get-the-userform-where-msforms-combobox-object-is-located", "title": "How does one get the UserForm where MSForms.ComboBox Object is located?", "body": "<p>Hi got a Class Called \"FilterLine\", It consist of 3 ComboBoxes which are filled depending on all other already selected filters. Here a simplification of the code:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents Filter As MSForms.Combobox\nPublic WithEvents Operator As MSForms.Combobox\nPublic WithEvents Options As MSForms.Combobox\nPublic index As Integer\n\n' This sub adds a new FilterLine and formats it\n\nPublic Sub Add()\n\n' Do Stuff with form in which it is embedded\n\nfrmFilter.Height = frmFilter.Height + 50\n\nEnd Sub\n\n' Other subs\n</code></pre>\n\n<p>Where frmFilter is the Userform. This is rather unelegant since I refer to the userform as a name and therefore the class could not be used without changes in another userform. The Userform should always be the userform where the default filter is located. <strong>But how does one get the userform from a ComboBox?</strong> </p>\n\n<p>For example with a range object you can do this:</p>\n\n<pre><code>dim rng as Range\n\nset rng = 'Whatever you want\n\nrng.Worksheet.activate\n</code></pre>\n\n<p>This will activate the worksheet where the range is located. But how does one get the UserForm instance from a MSForms.ComboBox? </p>\n\n<p>Edit: </p>\n\n<p>To clarify I call the Userform using this code:</p>\n\n<pre><code>Sub testFilter()\nDim Filterm As FilterModel\n\nSet Filterm = New FilterModel\n\nWith New frmFilter\n    Set .Model = Filterm\n    .SetDefaultFilter' This is the interesting part\n    .Show\nEnd With\nEnd Sub \n</code></pre>\n\n<p>Then the UserForm Instance.SetDefaultFilter sets the default filter with:</p>\n\n<pre><code>Public Sub SetDefaultFilterLine()\n\nDim DefaultFilterLine As New FilterLine\nSet DefaultFilterLine.Filter = frmFilter.DefaultFilter\nSet DefaultFilterLine.Operator = frmFilter.DefaultOperator\nSet DefaultFilterLine.Options = frmFilter.DefaultOptions\nDefaultFilterLine.index = 1\n\nMe.Model.FilterCol.Add DefaultFilterLine\n\n' This doesn't work because I cannot refer to the instance I newed up in the testFilter Sub. \nDefaultFilterLine.Add\nEnd Sub\n</code></pre>\n\n<p>DefaultFilterLine.Add doesn't work because the code uses frmFilter (which is it's default instance and has no model assigned to it). Therefore the question should probably be:</p>\n\n<p><strong>How can one refer to a Userform Instance in another module (class module in this case) ?</strong></p>\n\n<p><em>Edit 2:</em></p>\n\n<p>This is the relevant code of frmFilter: </p>\n\n<pre><code>Public DisableEvents As Boolean\n\nPrivate Type TView\n    Model As FilterModel\n    IsCancelled As Boolean\n    IsBack As Boolean\nEnd Type\n\nPrivate this As TView\n\nPublic Property Get Model() As FilterModel\n    Set Model = this.Model\nEnd Property\n\nPublic Property Set Model(ByVal value As FilterModel)\n    Set this.Model = value\n    'Validate\nEnd Property\n</code></pre>\n\n<p>Model is a property of the UserForm of the Type FilterModel. FilterModel (currently) only consists of a Integer N and a collection where all the FilterLine are stored.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539171362, "post_id": 52734807, "comment_id": 92403117, "body": "This request has been cross posted on a number of forums."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1539203637, "post_id": 52734807, "comment_id": 92421225, "body": "Indeed, including: <a href=\"http://www.vbaexpress.com/forum/showthread.php?63823-vba-Word-How-to-add-selected-text-into-right-click-menu-or-add-right-clicked-word-I\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a> &amp; <a href=\"http://www.msofficeforums.com/word-vba/40593-vba-word-how-add-selected-text-into.html\" rel=\"nofollow noreferrer\">msofficeforums.com/word-vba/&hellip;</a> &amp; <a href=\"https://social.msdn.microsoft.com/Forums/en-US/807da1d9-65ed-4f45-89f6-2b4ab18e532d/how-to-add-custom-menu-option-in-mouse-right-click-event-using-vba-word?forum=isvvba#323c6ea8-3be7-43bb-be8a-f4e64733076f\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>. For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1587159946, "post_id": 52734807, "comment_id": 108410363, "body": "The CommandBars object is obsolete and is retained only for backward compatibility. Instead, look into modifying the Ribbon UI (also called Fluent UI), or adding a macro to the Quick Access Toolbar."}], "owner": {"reputation": 43, "user_id": 6012755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d9fe34f7651966aec7e9574a6354ad?s=128&d=identicon&r=PG&f=1", "display_name": "fahad", "link": "https://stackoverflow.com/users/6012755/fahad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587954922, "creation_date": 1539156388, "last_edit_date": 1587954922, "question_id": 52734807, "link": "https://stackoverflow.com/questions/52734807/vba-word-adding-selected-text-into-right-click-menu-or-adding-right-clicked-tex", "title": "vba Word: Adding Selected text into right click menu or adding right clicked text into right click menu", "body": "<p>I want to add Selected text into right click menu as a .caption\nhere is my code</p>\n\n<pre><code>Public Sub CreateMacro()\nApplication.CommandBars(\"Text\").Reset\n\n    Dim MenuButton As CommandBarButton\n    With CommandBars(\"Text\")\n        Set MenuButton = .Controls.Add(msoControlButton)\n\n\n        With MenuButton\n            .Caption = Selection.Text\n\n\n\n\n            .Style = msoButtonCaption\n            .OnAction = \"Test_Macro\"\n        End With\n    End With\n\n\nEnd Sub\n\nPublic Sub Test_Macro()\n    MsgBox \"I work\"\n    ResetRightClick\n    CreateMacro\nEnd Sub\n\nSub ResetRightClick()\n\n    Application.CommandBars(\"Text\").Reset\n\nEnd Sub\n</code></pre>\n\n<p>on first attempt right click menu is displayed but empty caption, and on next times it show older caption (not current selection) until the menu item is clicked\nor how to add Right clicked word into right clicked menu</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539156212, "post_id": 52734564, "comment_id": 92394276, "body": "You can&#39;t. The user who knows the password can always use it to unprotect the workbook or worksheet. But have a look at the <code>UserInterfaceOnly</code> parameter of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\">Worksheet.Protect Method</a>. If you use this you don&#39;t have to unprotect your worksheet everytime you run a macro on it. It only protects the sheet from user manipulation but not VBA."}, {"owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539156321, "post_id": 52734564, "comment_id": 92394321, "body": "I&#39;ve seen codes that disable buttons in Excel like copying, there&#39;s no similar way to a sheet protection button?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 5, "creation_date": 1539156380, "post_id": 52734564, "comment_id": 92394354, "body": "Even if you can do that, the user can easily enable that button too. It would be easier not to tell users the password, so they can <i>not</i> unprotect and reprotect your sheet with another password."}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1539182987, "creation_date": 1539182987, "answer_id": 52742988, "question_id": 52734564, "link": "https://stackoverflow.com/questions/52734564/remove-sheet-protection-only/52742988#52742988", "title": "Remove sheet protection only", "body": "<p>You can protect a VBA project to prevent a user from seeing the code and then code in a password prior to execution of the rest of the code (Tools > VBA Project Properties)</p>\n\n<pre><code>Dim password As Variant\npword = Application.InputBox(\"Please enter password\", \"Enter Password\")\n\nSelect Case pword\n    Case Is = \"superstrongpassword\"\n        'insert code or maybe a GoTo statement?\n    Case Else\n        msgbox(\"Incorrect password\")\n        Exit sub\nEnd Select\n</code></pre>\n\n<p>GoTo statements can make code difficult to read and debug, but in this instance it seems like a straightforward usage.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593707471, "creation_date": 1539155339, "last_edit_date": 1593707471, "question_id": 52734564, "link": "https://stackoverflow.com/questions/52734564/remove-sheet-protection-only", "title": "Remove sheet protection only", "body": "<p>I have code that protects the workbook that is three stages: eliminating protection, run macros, and protection again.</p>\n\n<p>If the customer chooses another password manually, (he must know the password of the code) the protection cancellation code no longer works</p>\n\n<p>How can I disable the option of canceling protection, so you can cancel protection only with code, to prevent changes if the password?</p>\n"}, {"tags": ["vba", "tsql", "ms-access"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1539155332, "post_id": 52734218, "comment_id": 92393767, "body": "What is the datatype of column <code>Eingangsdatum</code>?"}, {"owner": {"reputation": 2812, "user_id": 9386667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tm47g.png?s=128&g=1", "display_name": "Badgy", "link": "https://stackoverflow.com/users/9386667/badgy"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1539155503, "post_id": 52734218, "comment_id": 92393853, "body": "@Santosh date type in the connected mysql server"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1539155565, "post_id": 52734218, "comment_id": 92393882, "body": "Query looks good. Try this <code>DCount(&quot;*&quot;, &quot;dbo_ABG_Wareneingang&quot;, &quot;Lieferant=&#39;&quot; &amp; Me.Lieferant &amp; &quot;&#39; AND Eingangsdatum= #&quot; &amp; Format(tempDatum, &#39;mm&#47;dd&#47;yyyy&#39;) &amp; &quot;#&quot;)</code>"}, {"owner": {"reputation": 2812, "user_id": 9386667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tm47g.png?s=128&g=1", "display_name": "Badgy", "link": "https://stackoverflow.com/users/9386667/badgy"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1539158002, "post_id": 52734218, "comment_id": 92395235, "body": "@Santosh still does not work, the &#39; &#39; around the data even bring an instant editor syntax error... i tried a lot im not sure why it does not work"}], "answers": [{"comments": [{"owner": {"reputation": 2812, "user_id": 9386667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tm47g.png?s=128&g=1", "display_name": "Badgy", "link": "https://stackoverflow.com/users/9386667/badgy"}, "edited": false, "score": 1, "creation_date": 1539158759, "post_id": 52735387, "comment_id": 92395676, "body": "Thanks for the solution, &quot;yyyy-mm-dd&quot; worked perfect and fixed the problem."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1539158499, "creation_date": 1539158499, "answer_id": 52735387, "question_id": 52734218, "link": "https://stackoverflow.com/questions/52734218/error-3075-in-vba-dcount-function-when-comparing-dates/52735387#52735387", "title": "Error 3075 in VBA DCount Function when Comparing Dates", "body": "<p>The error is caused by the fact, that in the format expression, \"/\" is not a slash by a placeholder for the localised <em>date separator</em> - which is a dot in Germany - and SQL fails on that.</p>\n\n<p><em>Escape</em> the slash to get it right, and make it a habit to use the ISO sequence, yyyy-mm-dd, as it works everywhere:</p>\n\n<pre><code>Format(tempDatum, \"yyyy\\/mm\\/dd\")\n</code></pre>\n"}], "owner": {"reputation": 2812, "user_id": 9386667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tm47g.png?s=128&g=1", "display_name": "Badgy", "link": "https://stackoverflow.com/users/9386667/badgy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52735387, "answer_count": 1, "score": 1, "last_activity_date": 1539158499, "creation_date": 1539154074, "question_id": 52734218, "link": "https://stackoverflow.com/questions/52734218/error-3075-in-vba-dcount-function-when-comparing-dates", "title": "Error 3075 in VBA DCount Function when Comparing Dates", "body": "<p>I have a VBA DCount Function and tested all variations but i can\u00b4t get it to work, i always get the error (translated from myself):</p>\n\n<blockquote>\n  <blockquote>\n    <p>\"Syntaxerror in Date in Query: </p>\n  </blockquote>\n\n<pre><code>dbo_ABG_Wareneingang.Lieferant = 'Lieferheld' AND [Eingangsdatum] = #10.10.2018'.\n</code></pre>\n</blockquote>\n\n<p>The query looks like this:</p>\n\n<pre><code>DCount(\"Lieferant\", \"dbo_ABG_Wareneingang\", \"dbo_ABG_Wareneingang.Lieferant = '\" &amp; Me.Lieferant &amp; \"' AND [Eingangsdatum] = #\" &amp; Format(tempDatum, \"mm/dd/yyyy\") &amp; \"#\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "spreadsheet"], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1539160917, "creation_date": 1539160917, "answer_id": 52736070, "question_id": 52734027, "link": "https://stackoverflow.com/questions/52734027/copy-row-and-add-value-vba/52736070#52736070", "title": "Copy Row and add value, VBA", "body": "<p>you could:</p>\n\n<ul>\n<li><p>use <code>SpecialCells()</code> method of <code>Range</code> object to loop through numeric values of a range</p></li>\n<li><p>use <code>Resize()</code> property of <code>Range</code> Object to avoid paste looping </p></li>\n</ul>\n\n<p>as follows:</p>\n\n<pre><code>Public Sub CopyData()\n    ' This routing will copy rows based on the quantity to a new sheet.\n    Dim rngSinglecell As Range\n    Dim rngQuantityCells As Range\n    Dim intCount As Long\n\n    ' Set this for the range where the Quantity column exists. This works only if there are no empty cells\n    Set rngQuantityCells = Range(\"K2\", Range(\"K2\").End(xlDown))\n    If WorksheetFunction.Count(rngQuantityCells) = 0 Then Exit Sub ' do nothing if no numbers in wanted range\n\n    For Each rngSinglecell In rngQuantityCells.SpecialCells(xlCellTypeConstants, xlNumbers) ' loop through numeric values of wanted range\n        ' Check if the number is greater than 0\n        If rngSinglecell.Value &gt; 0 Then\n            Range(rngSinglecell.Address).EntireRow.Copy Destination:=Sheets(\"Import\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngSinglecell.Value)\n            Cells(rngSinglecell.Row, \"M\").Value = \"Word\" ' &lt;-- added line\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10482425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kuHocprnEg8/AAAAAAAAAAI/AAAAAAAAAGU/_btJ5HRuWsw/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/10482425/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539160917, "creation_date": 1539153297, "last_edit_date": 1539154738, "question_id": 52734027, "link": "https://stackoverflow.com/questions/52734027/copy-row-and-add-value-vba", "title": "Copy Row and add value, VBA", "body": "<p>I am using the following script to copy data to a new sheet, it copies a row a certain number of times, based on a columns data. </p>\n\n<p>I need to add a line to the script to: add the value \"Word\" into column \"M\" and the current row that is being copied. </p>\n\n<p>Any help adding this to the script will be much appreciated. </p>\n\n<p>Thanks, </p>\n\n<pre><code>Public Sub CopyData()\n    ' This routing will copy rows based on the quantity to a new sheet.\n    Dim rngSinglecell As Range\n    Dim rngQuantityCells As Range\n    Dim intCount As Integer\n\n    ' Set this for the range where the Quantity column exists. This works only if there are no empty cells\n    Set rngQuantityCells = Range(\"K2\", Range(\"K2\").End(xlDown))\n\n    For Each rngSinglecell In rngQuantityCells\n        ' Check if this cell actually contains a number\n        If IsNumeric(rngSinglecell.Value) Then\n            ' Check if the number is greater than 0\n            If rngSinglecell.Value &gt; 0 Then\n                ' Copy this row as many times as .value\n                For intCount = 1 To rngSinglecell.Value\n                    ' Copy the row into the next emtpy row in sheet2\n\n\n                    'Change EntireRow.Copy to a range in the row.\n                    Range(rngSinglecell.Address).EntireRow.Copy Destination:=Sheets(\"Import\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n                    ' The above line finds the next empty row.\n\n\n                Next\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "haskell", "dll", "ghc"], "comments": [{"owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 0, "creation_date": 1539154084, "post_id": 52734002, "comment_id": 92393129, "body": "What path are you using. What bitness are all the files."}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "reply_to_user": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 0, "creation_date": 1539154456, "post_id": 52734002, "comment_id": 92393330, "body": "Paths in the excel to the dll is absolute; if you are referring to my path variable: I will update the question;  The system &amp; files are 64-bit Excel 2016 runs as a 32 Bit version"}, {"owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 1, "creation_date": 1539154577, "post_id": 52734002, "comment_id": 92393396, "body": "32 bit excel can only use 32 bit dlls. If it was a COM dll you can place it in 64 bit dllhost and access it as a 64 bit COM Exe from and COM client. DLL have to match bitness but EXE don&#39;t. Your dll isn&#39;t a COM DLL though."}, {"owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 0, "creation_date": 1539154799, "post_id": 52734002, "comment_id": 92393496, "body": "type <code>ghc &#47;?</code> if it obeys windows rules it will tell you."}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "reply_to_user": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 0, "creation_date": 1539154914, "post_id": 52734002, "comment_id": 92393561, "body": "Thanks; i did not think about this excel &quot;feature&quot;"}, {"owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "edited": false, "score": 2, "creation_date": 1539156571, "post_id": 52734002, "comment_id": 92394448, "body": "Programs load and call dll functions direct. They usually pass pointers to objects/variables. 32 bit programs can&#39;t handle 64 bit pointers."}], "owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539154489, "creation_date": 1539153222, "last_edit_date": 1539154489, "question_id": 52734002, "link": "https://stackoverflow.com/questions/52734002/ghc-compile-dll-for-use-in-vba", "title": "GHC compile DLL for use in VBA", "body": "<p>This is an alternative approach to this question here: <a href=\"https://stackoverflow.com/questions/52662440/export-haskell-lib-as-dll\">Export Haskell lib as DLL</a></p>\n\n<p>I am working with GHC version 8.6.1 [latest] and am following <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/win32-dlls.html#building-and-using-win32-dlls\" rel=\"nofollow noreferrer\">the documentation</a> for compiling a DLL from a haskell library for the subsequent use in VBA. </p>\n\n<p>My files look like this:</p>\n\n<p>Adder.hs:</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nmodule Adder where\n\nadder :: Int -&gt; Int -&gt; IO Int\nadder x y = return (x+y)\n\nforeign export ccall adder :: Int -&gt; Int -&gt; IO Int\n</code></pre>\n\n<p>StartEnd.c:</p>\n\n<pre><code>#include &lt;Rts.h&gt;\n\nvoid HsStart() {\n    int argc = 1;\n    char* argv[] = {\"ghcDll\", NULL};\n    char** args = argv;\n    hs_init(&amp;argc, &amp;args);\n}\n\nvoid HsEnd() {\n    hs_exit();\n}\n</code></pre>\n\n<p>I copied the folder <code>ghc-8.6.1\\lib\\include</code> to the build location and copied the two files into that folder (because I cannot figure out how to pass the -I[PATH] parameter correctly).</p>\n\n<p>Running these compilation steps, I get:</p>\n\n<pre><code>ghc -c Adder.hs\n    --&gt; no error\nghc -c StartEnd.c\n    --&gt; no error\nghc -shared -no-hs-main -o Adder.dll Adder.o Adder_stub.h StartEnd.o\n    --&gt; no error\n</code></pre>\n\n<p>and the files</p>\n\n<pre><code>Adder.dll\nAdder.dll.a\nAdder.hi\nAdder.o\nAdder_stub.h\nstartEnd.o\n</code></pre>\n\n<p>I tried using the third compilation command like it is in the documentation <code>ghc -shared -o Adder.dll Adder.o Adder_stub.h StartEnd.o</code> and with the parameter -no-hs-main just to be sure.</p>\n\n<p>My VBA script looks like this:</p>\n\n<pre><code>Private Declare Function Adder Lib \"PATH\\TO\\Adder.dll\" Alias \"adder\" _\n        (ByVal x As Long, ByVal y As Long) As Long\n\nPrivate Declare Sub HsStart Lib \"PATH\\TO\\Adder.dll\" ()\nPrivate Declare Sub HsEnd Lib \"PATH\\TO\\Adder.dll\" ()\n\nPublic Sub test()\n    HsStart\n    MsgBox \"12 + 5 = \" &amp; Adder(12, 5)\n    HsEnd\nEnd Sub\n</code></pre>\n\n<p>However, whenever I try to run the Sub test, I get the error message:</p>\n\n<pre><code>Run-Time error '48'\nFile not found:\nPATH\\TO\\Adder.dll\n</code></pre>\n\n<p>Can you please tell me where I made a mistake and how I can fix it?</p>\n\n<p>If it helps, the output of <code>dumpbin /EXPORTS Adder.dll</code> is this:</p>\n\n<pre><code>Microsoft (R) COFF/PE Dumper Version 14.00.24234.1\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n\nDump of file Adder.dll\n\nFile Type: DLL\n\n  Section contains the following exports for Adder.dll\n\n    00000000 characteristics\n    5BBD9533 time date stamp Wed Oct 10 07:59:15 2018\n        0.00 version\n           1 ordinal base\n       29737 number of functions\n       29737 number of names\n\n    ordinal hint RVA      name\n\n          1    0 004E0F18 ALLOC_BH_adm\n          ...\n          75   4A 00001681 HsEnd\n          76   4B 00001640 HsStart\n          ...\n          472  1D7 00001540 adder\n          ...\n</code></pre>\n\n<p>My Path: </p>\n\n<pre><code>C:\\Users\\scfa\\AppData\\Local\\Programs\\MiKTeX 2.9\\miktex\\bin\\x64\\;C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin;C:\\Users\\scfa\\Documents\\myProgramms\\dev_msys2\\mingw64\\bin;C:\\Users\\scfa\\Documents\\myProgramms\\dev_msys2\\mingw32\\bin;C:\\Users\\scfa\\Documents\\myProgramms\\ghc-8.6.1\\bin;C:\\Users\\scfa\\Documents\\myProgramms\\ghc-8.6.1\\mingw\\bin\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539151464, "post_id": 52733444, "comment_id": 92391929, "body": "It&#39;s not clear what the role of &quot;x&quot; is here...  Also your code looks like code from an event handler - is it?"}, {"owner": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539151716, "post_id": 52733444, "comment_id": 92392033, "body": "When the user make an x in column 14 in same row as a blue one, I want to select all of the &quot;filled&quot; cells which are touching each other and cut them to another sheet."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1539152062, "post_id": 52733444, "comment_id": 92392213, "body": "you should add some screenshots, really!"}, {"owner": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "edited": false, "score": 0, "creation_date": 1539152598, "post_id": 52733444, "comment_id": 92392474, "body": "Step 1 <a href=\"https://i.stack.imgur.com/tH0Pi.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/tH0Pi.png</a> Step 2 <a href=\"https://i.stack.imgur.com/9UAk0.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/9UAk0.png</a> Step 3 <a href=\"https://i.stack.imgur.com/mCWNR.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/mCWNR.png</a>  I really just need a way to select the area"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "edited": false, "score": 0, "creation_date": 1539154292, "post_id": 52733874, "comment_id": 92393242, "body": "Hi Tim,  What I&#39;ve done is to add your function to my piece of code, but I can&#39;t get i to work?  <code>Private Sub Worksheet_Change(ByVal Target As Range)     If Not Intersect(Target, Target.Worksheet.Range(&quot;N5:N1000&quot;)) Is Nothing Then         If Cells(Target.Row, 1).Interior.ColorIndex &lt;&gt; xlNone Then             If Cells(Target.Row, 14) = &quot;x&quot; Or Cells(Target.Row, 14) = &quot;X&quot; Then                          Range(&quot;A&quot; &amp; ActiveCell.Row).Select                         &#39;GetColorBlock             End If         End If    End If      End Sub </code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "edited": false, "score": 0, "creation_date": 1539195114, "post_id": 52733874, "comment_id": 92417367, "body": "On testing, this code has problem with row/column boundaries - I will try to fix later..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "edited": false, "score": 0, "creation_date": 1539235188, "post_id": 52733874, "comment_id": 92429073, "body": "Fixed my original code - should now do something close to what you need."}, {"owner": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "edited": false, "score": 0, "creation_date": 1539245845, "post_id": 52733874, "comment_id": 92433888, "body": "Thx, Tim. Works as inteded"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1539235151, "last_edit_date": 1539235151, "creation_date": 1539152678, "answer_id": 52733874, "question_id": 52733444, "link": "https://stackoverflow.com/questions/52733444/loop-through-color-filled-cells-until-blank/52733874#52733874", "title": "Loop through color filled cells until blank", "body": "<p>If you want to expand a single-cell range to cover a rectangular range of the same fill you can do something like:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Range\n\n    Set c = Application.Intersect(Target.Cells(1), Me.Range(\"N5:N1000\"))\n\n    If Not c Is Nothing Then\n        If Me.Cells(c.Row, 1).Interior.ColorIndex &lt;&gt; xlNone And _\n                        UCase(Me.Cells(Target.Row, 14)) = \"X\" Then\n\n            GetColorBlock(Me.Cells(c.Row, 1)).Select\n\n        End If\n    End If\n\nEnd Sub\n\n'Expand a single cell range to all neighboring cells with the same fill color\n'  (assumes colored range is rectangular)  \nFunction GetColorBlock(c As Range) As Range\n    Dim tl As Range, br As Range, clr As Long\n    clr = c.Interior.Color\n    Set tl = c\n    Set br = c\n    Do While tl.Row &gt; 1\n        If tl.Offset(-1, 0).Interior.Color &lt;&gt; clr Then Exit Do\n        Set tl = tl.Offset(-1, 0)\n    Loop\n    Do While tl.Column &gt; 1\n        If tl.Offset(0, -1).Interior.Color &lt;&gt; clr Then Exit Do\n        Set tl = tl.Offset(0, -1)\n    Loop\n    Do While br.Row &lt; Rows.Count\n        If br.Offset(1, 0).Interior.Color &lt;&gt; clr Then Exit Do\n        Set br = br.Offset(1, 0)\n    Loop\n    Do While br.Column &lt; Columns.Count\n        If br.Offset(0, 1).Interior.Color &lt;&gt; clr Then Exit Do\n        Set br = br.Offset(0, 1)\n    Loop\n    Set GetColorBlock = c.Worksheet.Range(tl, br)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10482231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215240887148242/picture?type=large", "display_name": "cpoulsen", "link": "https://stackoverflow.com/users/10482231/cpoulsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 52733874, "answer_count": 1, "score": 1, "last_activity_date": 1593778992, "creation_date": 1539150834, "last_edit_date": 1593778992, "question_id": 52733444, "link": "https://stackoverflow.com/questions/52733444/loop-through-color-filled-cells-until-blank", "title": "Loop through color filled cells until blank", "body": "<p>I'm trying to create an Excel document where I have filled cells (the related number of cells is different, some only 1 others 10+, columns are the same number)</p>\n\n<p>I want to make a selection of \"activeCell area\". So e.g. if the active cell is A11 then the filled area from A11 and all the way to E14 is selected (all blue cells).</p>\n\n<p>This is what I currently got, I assume I need a while loop, but I can't get it to work:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"N5:N1000\")) Is Nothing Then\n        If Cells(Target.Row, 1).Interior.ColorIndex &lt;&gt; xlNone Then\n            If Cells(Target.Row, 14) = \"x\" Or Cells(Target.Row, 14) = \"X\" Then\n                         Range(\"A\" &amp; ActiveCell.Row).Select\n\n            End If\n        End If\n   End If\n\nEnd Sub\n</code></pre>\n\n<p>Excel sheet:<br>\n<a href=\"https://i.stack.imgur.com/Ae5nH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ae5nH.png\" alt=\"Excel sheet\"></a></p>\n\n<p>Step 1:<br>\n<a href=\"https://i.stack.imgur.com/tH0Pi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tH0Pi.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 2:<br>\n<a href=\"https://i.stack.imgur.com/9UAk0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9UAk0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 3:<br>\n<a href=\"https://i.stack.imgur.com/mCWNR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mCWNR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "passwords", "spreadsheet"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1539152493, "post_id": 52733241, "comment_id": 92392413, "body": "Passwords may not be as tough as you hope, see : <a href=\"https://stackoverflow.com/q/11649064/4961700\">stackoverflow.com/q/11649064/4961700</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539153734, "post_id": 52733241, "comment_id": 92392989, "body": "Data you hand out to another person is always exposed. All kind of hiding the data in a sheet or protecting a sheet are insecure in a way. They only stop regular users from watching them but a professional might always crack it with more or less effort. The only secure way is <i>not</i> to hand out secret data at all by using a server/client setup, where only the server knows the raw data and hands out only the result to the client."}], "owner": {"reputation": 35, "user_id": 9156829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V4tRzglGhJw/AAAAAAAAAAI/AAAAAAAAABY/qVVmXNVTkIg/photo.jpg?sz=128", "display_name": "I Forte Si Daja", "link": "https://stackoverflow.com/users/9156829/i-forte-si-daja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593707496, "creation_date": 1539149793, "last_edit_date": 1593707496, "question_id": 52733241, "link": "https://stackoverflow.com/questions/52733241/make-password-invisible-to-protect-worksheets", "title": "Make password invisible to protect worksheets", "body": "<p>I have a simple code that I am wondering if there is a better way of hiding the password, besides from \"Locking the project from viewing\". I am setting the sheet in xlSheetVeryHidden, but still someone can see the pasword if they want to.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim ws As Worksheet\nSet ws = ThisWorkbook.Sheets(\"OpenLog\")\n\nIf Not ws.Visible = xlSheetVeryHidden Then ws.Visible = xlSheetVeryHidden\nws.Protect Password:=1214, UserInterFaceOnly:=True\n\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated</p>\n\n<p>Nick.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539155939, "post_id": 52733013, "comment_id": 92394116, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1539149142, "creation_date": 1539149142, "answer_id": 52733137, "question_id": 52733013, "link": "https://stackoverflow.com/questions/52733013/macro-to-copy-cells-four-rows-apart-without-using-select/52733137#52733137", "title": "Macro to copy cells four rows apart without using select", "body": "<p>I used this type of operation in one of my vba codes:</p>\n\n<pre><code>      'do copy from reference \"Answers_Source\" worksheet\n    wb.Sheets(\"Answers_Source\").Range(\"h1:z160\").Copy\n\n   'now paste the formulas into the student exam workbook\n   wb2.Sheets(\"Answers\").Range(\"h1:z160\").Paste     \n</code></pre>\n\n<p>So you can edit that to your situation.</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1539151584, "creation_date": 1539151584, "answer_id": 52733606, "question_id": 52733013, "link": "https://stackoverflow.com/questions/52733013/macro-to-copy-cells-four-rows-apart-without-using-select/52733606#52733606", "title": "Macro to copy cells four rows apart without using select", "body": "<p>you could use <code>Offset()</code> property of <code>Range</code> object</p>\n\n<pre><code>Sub Copy_Paste()\n    Dim i As Long\n    For i = 1 To 100\n        Sheets(\"Sheet1\").Range(\"A2,B2\").Offset(i - 1).Copy Destination:=Sheets(\"Sheet2\").Range(\"A1:B1\").Offset((i - 1) * 4)\n    Next\nEnd Sub\n</code></pre>\n\n<p>while if you only need paste values, then it's quicker:</p>\n\n<pre><code>Sub Copy_Paste_Values()\n    Dim i As Long\n    For i = 1 To 100\n        Sheets(\"Sheet2\").Range(\"A1:B1\").Offset((i - 1) * 4).Value = Sheets(\"Sheet1\").Range(\"A2,B2\").Offset(i - 1).Value\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1539152878, "creation_date": 1539152878, "answer_id": 52733915, "question_id": 52733013, "link": "https://stackoverflow.com/questions/52733013/macro-to-copy-cells-four-rows-apart-without-using-select/52733915#52733915", "title": "Macro to copy cells four rows apart without using select", "body": "<p>You know you can just say something like \"Range x values = Range y values\":</p>\n\n<pre><code>ws2.Range(\"A1:B4\").Value = ws1.Range(\"A1:B4\").Value\n</code></pre>\n\n<p>If you can define your ranges using <code>Range(Cells(1,1), Cells(4,2))</code> then I'm pretty sure you can do everything you want in one line</p>\n"}], "owner": {"reputation": 43, "user_id": 9911679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7038fdffb1b457b1377d005fa26afcb8?s=128&d=identicon&r=PG&f=1", "display_name": "bammerr", "link": "https://stackoverflow.com/users/9911679/bammerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1593707511, "creation_date": 1539148332, "last_edit_date": 1593707511, "question_id": 52733013, "link": "https://stackoverflow.com/questions/52733013/macro-to-copy-cells-four-rows-apart-without-using-select", "title": "Macro to copy cells four rows apart without using select", "body": "<p>This code copies the entries from Sheet1!A2, Sheet1!B2, etc. and pastes them onto Sheet2 with 3 rows between each entry. I want to duplicate this code without using .select. </p>\n\n<pre><code>Option Explicit\n\nSub Copy_Paste()\n\nDim i As Integer\nFor i = 1 To 100\n    Sheets(\"Sheet1\").Select \n    Range(\"A2,B2,C2,D2,E2\").Select \n    ActiveCell.Range(Cells(i, 1), Cells(i, 2)).Select\n    Selection.Copy \n    Sheets(\"Sheet2\").Select \n    Cells(((i - 1) * 4) + 1, 1).Select \n    ActiveSheet.Paste \nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This is what I have so far, but it is not working. </p>\n\n<pre><code>Option Explicit\n\nSub Copy_Paste()\n\nDim i As Integer\nFor i = 1 To 100\n    Dim ws1 As Worksheet, rng As Range, act As Range\n        Set ws1 = Worksheets(\"Data\")\n        Set rng = ActiveSheet.Range(\"A2,B2,C2,D2,E2\")\n        Set act = ActiveCell.Range(Cells(i, 1), Cells(i, 2))\n    Selection.Copy\n    Dim ws2 As Worksheet, rng2 As Range\n        Set ws2 = Worksheets(\"Calculate\")\n        Set rng2 = Cells(((i - 1) * 4) + 1, 1)\n    ActiveSheet.Paste\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "spreadsheet"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539147461, "post_id": 52732688, "comment_id": 92390588, "body": "If <code>Intersect</code> returns <code>Nothing</code>, what object reference is <code>.ClearContents</code> invoked against?"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539216673, "post_id": 52733860, "comment_id": 92425030, "body": "Will it matter if the <code>master</code> sheet contain a <code>script</code> that hides/unhides columns based off a specific value being entered in <code>column A</code>? Your code returns an error: <code>That command cannot be used on multiple selections</code>."}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539236664, "post_id": 52733860, "comment_id": 92429554, "body": "The first line. <code>Sub FilterAndCopy()</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539237109, "post_id": 52733860, "comment_id": 92429761, "body": "This cannot be. When you hit the error, click \u201cdebug\u201d button and you\u2019ll be brought to the offending line highlighted in yellow or blue"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1539239165, "post_id": 52733860, "comment_id": 92430540, "body": "so from then on, step through your code by hitting F8 until you reach the actual offending line"}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539299369, "post_id": 52733860, "comment_id": 92462670, "body": "Sorry. It&#39;s on the .SpecialCells line"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539585696, "post_id": 52733860, "comment_id": 92539889, "body": "see edited answer to handle any hidden column in &quot;Master&quot; sheet"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1539586913, "last_edit_date": 1539586913, "creation_date": 1539152623, "answer_id": 52733860, "question_id": 52732688, "link": "https://stackoverflow.com/questions/52732688/how-to-auto-copy-rows-to-new-sheet-vba-excel/52733860#52733860", "title": "how to auto-copy rows to new sheet VBA Excel", "body": "<p>I guess you start clearing \"X\" sheet from row 2 to preserve headers</p>\n\n<p>should this be the case, you can clear all \"X\" sheet rows and paste headers form \"Master\" sheet back</p>\n\n<pre><code>Option Explicit\n\nSub FilterAndCopy()\n    Dim sht1 As Worksheet, sht2 As Worksheet\n\n    Set sht1 = Sheets(\"Master\")\n    Set sht2 = Sheets(\"X\")\n\n    sht2.UsedRange.ClearContents\n    Dim rng As Range\n\n    With sht1.Cells(1, 1).CurrentRegion\n        .AutoFilter\n        .AutoFilter 1, \"X\"\n        For Each rng In .SpecialCells(xlCellTypeVisible).Areas ' loop through visible cells \"groups\"\n            rng.Copy sht2.Range(rng.Address) ' copy current group and paste it to 'sht2' (i.e. sheet \"X\") corresponding address\n        Next\n        .AutoFilter\n    End With\n\n    With sht2.UsedRange ' reference 'sht2' used range\n        .Columns(1).SpecialCells(xlCellTypeBlanks).EntireRow.Delete ' delete referenced sheet blank rows\n        .Rows(1).SpecialCells(xlCellTypeBlanks).EntireColumn.Delete ' delete referenced sheet blank columns\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Edited</strong> to account for possible \"Master\" sheet hidden columns</p>\n"}], "owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 52733860, "answer_count": 1, "score": 0, "last_activity_date": 1539586913, "creation_date": 1539146093, "last_edit_date": 1539221073, "question_id": 52732688, "link": "https://stackoverflow.com/questions/52732688/how-to-auto-copy-rows-to-new-sheet-vba-excel", "title": "how to auto-copy rows to new sheet VBA Excel", "body": "<p>I'm trying to <code>auto-copy</code> a row from a <code>master</code> <code>spreadsheet</code> to another <code>spreadsheet</code>. This should occur when the input value in the <code>master</code> is equal to <code>X</code>. </p>\n\n<p>So if <code>X</code> is entered into <code>Column A</code> in the <code>master</code>, then <code>auto-copy</code> to separate <code>spreadsheet</code> (let's call it X). Basically <code>Sheet X</code> should always contain an exact copy of all the <code>rows</code> in <code>master</code> where <code>Column A = X</code>.</p>\n\n<p>I'm not sure if this would affect the <code>auto-copy</code> but the <code>master sheet</code> contains a <code>script</code> that hides/unhides <code>Columns</code>. So if <code>X</code> is entered into <code>Column A</code> in the <code>master sheet</code> then <code>Column B,C</code> will be hidden and <code>D,E,F</code> will be shown. </p>\n\n<p>An example of what I'm trying to achieve is shown below:</p>\n\n<p><code>Master Sheet</code> contains this info. But if <code>X</code> is entered into <code>Column A</code> only <code>D,E,F</code> will be visible</p>\n\n<pre><code>A B C D E F\nX     4 5 6\nY 1 2 3 4 5\nX     1 2 3\n</code></pre>\n\n<p>X Sheet:</p>\n\n<pre><code>A D E F\nX 4 5 6\nX 1 2 3\n</code></pre>\n\n<p>This is what I've attempted </p>\n\n<pre><code>Sub FilterAndCopy()\nDim sht1 As Worksheet, sht2 As Worksheet\n\nSet sht1 = Sheets(\"Master\")\nSet sht2 = Sheets(\"X\")\n\nIntersect(sht2.UsedRange, sht2.Rows(\"2:\" &amp; Rows.Count)).ClearContents\n\nsht1.Cells(1, 1).CurrentRegion.AutoFilter\nsht1.Cells(1, 1).CurrentRegion.AutoFilter 1, \"X\"\nsht1.Cells(1, 1).CurrentRegion.Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Copy sht2.Cells(2, 1)\nsht1.Cells(1, 1).CurrentRegion.AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p>But it returns an Error:</p>\n\n<pre><code>Microsoft Visual Basic\nObject variable with block variable not set\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1539148606, "post_id": 52732153, "comment_id": 92390900, "body": "if <code>Me.cboentitynamefilter</code> emtpy than what would you like to have? ignore this filter or what, what you would like to acheive with` *`"}, {"owner": {"reputation": 40, "user_id": 5175457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcb029ed1d154af23501a4fda8475d9?s=128&d=identicon&r=PG&f=1", "display_name": "Eager Einstein", "link": "https://stackoverflow.com/users/5175457/eager-einstein"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1539151160, "post_id": 52732153, "comment_id": 92391806, "body": "i want to have all items in the Entity_Name to come out as a result of the query"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1539164750, "post_id": 52732153, "comment_id": 92399204, "body": "Why do you mean with &quot;all blank&quot;? Do you see any existing records in the result? What are <code>strEntityNameFilter</code>, <code>strAssignmentFilter</code> and <code>strFYFilter</code>? These look like String variables but we can&#39;t see the declaration. String variables can&#39;t be NULL, so there is probably no need to use the <code>Nz</code> function. How are your comboboxes set up (bound column, column widths)? How does the filter look like when you created it in the datasheet of the recordsource of the form?"}, {"owner": {"reputation": 40, "user_id": 5175457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcb029ed1d154af23501a4fda8475d9?s=128&d=identicon&r=PG&f=1", "display_name": "Eager Einstein", "link": "https://stackoverflow.com/users/5175457/eager-einstein"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1539230713, "post_id": 52732153, "comment_id": 92427997, "body": "@wolfgang kais, as mentioned earlier there are records having some data in Entity Name but no record is returned by use of the *.  The issue lies in the usage of the * charachter.  It seems to be syntactically wrong."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1539250522, "post_id": 52732153, "comment_id": 92436773, "body": "If it was syntactically wrong, you would receive a syntax error. And no, you did not mention that no record is returned when using the asterisk, you said that in the result, that field is &quot;all blank&quot;. You in fact mentioned only a very few things and you deny answering questions. Good luck!"}], "answers": [{"tags": [], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1539154681, "creation_date": 1539154681, "answer_id": 52734377, "question_id": 52732153, "link": "https://stackoverflow.com/questions/52732153/unable-to-filter/52734377#52734377", "title": "Unable to Filter", "body": "<p>I would do like this </p>\n\n<pre><code>Dim strCriteria AS string\n\nstrCriteria = \"1 = 1\"\n\nIf Len(Nz(Me.cboEntitynameFilter, \"\")) &gt; 0 Then\n    strCriteria = strCriteria &amp; \" and [Entity_Name] = \"\"\" &amp; Me.cboEntitynameFilter &amp; \"\"\"\"\nEnd If\n\n\nIf Len(Nz(Me.cboAssignmentFilter, \"\")) &gt; 0 Then\n    strCriteria = strCriteria &amp; \" and [Assignment] = \"\"\" &amp; Me.cboAssignmentFilter &amp; \"\"\"\"\nEnd If\n\n If Len(Nz(Me.cboFYFilter, \"\")) &gt; 0 Then\n    strCriteria = strCriteria &amp; \" and [Financial_Year] = \"\"\" &amp; Me.cboFYFilter &amp; \"\"\"\"\nEnd If\n\nMe.Filter = strCriteria\nMe.FilterOn = True\n</code></pre>\n\n<p>if any of the combobox or textbox didn't select than it will igonre those field.</p>\n"}], "owner": {"reputation": 40, "user_id": 5175457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abcb029ed1d154af23501a4fda8475d9?s=128&d=identicon&r=PG&f=1", "display_name": "Eager Einstein", "link": "https://stackoverflow.com/users/5175457/eager-einstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539154681, "creation_date": 1539141926, "question_id": 52732153, "link": "https://stackoverflow.com/questions/52732153/unable-to-filter", "title": "Unable to Filter", "body": "<p>I am trying to write an SQL code in my MS Access database whereby the filter on Entity_name is not working properly</p>\n\n<pre><code>Function FilterResults()\n\nDim strCriteria As String\nstrCriteria = \"\"\n\nIf Nz(Me.cboEntitynameFilter) &lt;&gt; \"\" Then\n    strEntityNameFilter = \"Entity_Name = '\" &amp; Me.cboEntitynameFilter &amp; \"'\"\nElse\n    strEntityNameFilter = \"Entity_Name = '*'\"\nEnd If\n\nIf Nz(Me.cboAssignmentFilter) &lt;&gt; \"\" Then\n    strAssignmentFilter = \" AND \" &amp; \"Assignment = '\" &amp; Me.cboAssignmentFilter &amp; \"'\" '&amp; \" AND \"\nEnd If\n\nIf Nz(Me.cboFYFilter) &lt;&gt; \"\" Then\n    strFYFilter = \" AND \" &amp; \"Financial_Year = '\" &amp; Me.cboFYFilter &amp; \"'\"\nEnd If\n\n\n    strCriteria = Nz(strEntityNameFilter, \"*\") &amp; Nz(strAssignmentFilter, \"*\") &amp; Nz(strFYFilter, \"*\")\n'    End If\n\n\n    If strCriteria = (\"Entity_Name = '*'\") Then\n        Me.Filter = \"\"\n        Me.FilterOn = False\n    Else\n        If strCriteria &lt;&gt; \"\" Then\n            Me.Filter = strCriteria\n            Me.FilterOn = True\n        End If\n    End If\n</code></pre>\n\n<p>End Function</p>\n\n<p>The strCriteria returned is \n<strong>Entity_Name = '*' AND Assignment = 'MFI'</strong></p>\n\n<p>The filter doesn't work and the Entity_Name is all blank.  What am I doing wrong.</p>\n\n<p>I am using this in MS-Access and building query in VBA</p>\n"}, {"tags": ["excel", "vba", "worksheet-function"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539144303, "post_id": 52731989, "comment_id": 92389846, "body": "<code>Target.Column</code> gives you the column number (for the first cell in Target).  You should take @Jeeped&#39;s advice below into account though."}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1539145052, "post_id": 52732102, "comment_id": 92390017, "body": "Spot on as usual.  I think that you should get bonus points for posting from your IPad??."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1539146718, "post_id": 52732102, "comment_id": 92390409, "body": "Actually a surface pro but i (honestly) only use one hand to type and mouse."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1539141412, "creation_date": 1539141412, "answer_id": 52732102, "question_id": 52731989, "link": "https://stackoverflow.com/questions/52731989/vba-getting-the-column-number-from-the-target-in-a-worksheet-change/52732102#52732102", "title": "VBA getting the column number from the Target in a worksheet change", "body": "<p>You need to deal with situations where Target is more than a single cell and disable event handling so when you change a value on the worksheet, the Worksheet_Change doesn't try to run on top of itself.</p>\n\n<p>This will put 'hello' into the cell immediately to the right of any cell within B:G that changes; essentially you would be adding 'hello' to columns C:H on the associated row of each cell in Target.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    if not intersect(target, Range(Cells(12, \"B\"), Cells(14, \"G\"))) is nothing then\n        on error goto safe_exit\n        application.enableevents = false\n        dim t as range \n        for each t in intersect(target, Range(Cells(12, \"B\"), Cells(14, \"G\")))\n            t.Offset(1,0) = \"hello\"\n        next t\n    End If\n\nsafe_exit:\n    application.enableevents = true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10382886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee9de46c4d92465b02866a85985b495?s=128&d=identicon&r=PG&f=1", "display_name": "icantcode", "link": "https://stackoverflow.com/users/10382886/icantcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539141412, "creation_date": 1539140605, "question_id": 52731989, "link": "https://stackoverflow.com/questions/52731989/vba-getting-the-column-number-from-the-target-in-a-worksheet-change", "title": "VBA getting the column number from the Target in a worksheet change", "body": "<p>I have a table of values that I need to fill out through a worksheet change function.\nWhat I am trying to do is change a cell in columns B-G, depending on where the target is.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf (Not Intersect(Target, Range(Cells(12, 2), Cells(14, 7))) Is Nothing) Then\n    Cells(16,Application.WorksheetFunction.Column(Target))=\"Hello\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I have similar bits of code in the same worksheet_change sub that work fine when I use <code>Target.Offset(1,0)</code> but since my possible target range is in more than 1 Row, I don't know how to make it so that it is always row 16 and the same column as the target....</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539193588, "post_id": 52731737, "comment_id": 92416691, "body": "You reply to <code>convo.GetRootItems(1)</code> in both cases so the result is the same. To get deeper in the conversation is more complex. <a href=\"https://stackoverflow.com/questions/39256143/set-all-mail-items-in-an-outlook-conversation-to-read-using-vba\" title=\"set all mail items in an outlook conversation to read using vba\">stackoverflow.com/questions/39256143/&hellip;</a> You might consider saving the entryID of the first reminder and creating the second reminder from that  rather than attempting to find it in the conversation."}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539216766, "post_id": 52731737, "comment_id": 92425052, "body": "Hi Niton, I already did as you suggest and I still get the same result. I edited my question with the example. As you can see from my code, the entry id value is different from first and second reminder. I have another macro that will retrieved all the entryID in my specified mailbox."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539303947, "post_id": 52764485, "comment_id": 92463575, "body": "Hi Niton, so, I dont need to use .GetRootItem(1) for both first and second reminder?"}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539304794, "post_id": 52764485, "comment_id": 92463708, "body": "Hi Niton. YOU ARE MY LIFE SAVER! I couldnt tell you how grateful I am to you! Thank you very much! But can you explain more on the .GetRootItem(1)? I am a novice in all of this. Thank you again."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1539273992, "creation_date": 1539273992, "answer_id": 52764485, "question_id": 52731737, "link": "https://stackoverflow.com/questions/52731737/send-outlook-email-in-nested-view-using-excel-vba/52764485#52764485", "title": "send outlook email in nested view using excel vba", "body": "<p>You are using the two different entryIDs to retrieve <code>convo.GetRootItems(1)</code> which is the originating item.</p>\n\n<p>The entryIDs already identify the mail you want to reply to.</p>\n\n<pre><code>If comboValue = \"First Reminder\" Then\n\n    entry = ws.Cells(j, \"G\") ' entryID of the parent mail\n    Set Mail = OutNS.GetItemFromID(entry) 'get handle on parent mail\n    Set newMail = Mail.reply 'new email as reply to parent mail\n\nEnd If\n\nIf comboValue = \"Second Reminder\" Then\n\n    entry = ws.Cells(j, \"Z\") ' entryID of first reminder\n    Set Mail = OutNS.GetItemFromID(entry) 'get handle on first reminder item\n    Set newMail = Mail.reply 'new email as reply to first reminder\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 52764485, "answer_count": 1, "score": 0, "last_activity_date": 1592900937, "creation_date": 1539138295, "last_edit_date": 1592900937, "question_id": 52731737, "link": "https://stackoverflow.com/questions/52731737/send-outlook-email-in-nested-view-using-excel-vba", "title": "send outlook email in nested view using excel vba", "body": "<p>I have a code that send two email reminder to user. The code attached below worked perfectly. My problem is that, I want the second reminder to be nested from the first reminder. </p>\n\n<pre><code>'create session\nDim OutApp As Object\nDim newMail As Object\nDim Emailto, sendfrom As String\n\n'create reply\nDim convo As Conversation\nDim convoItem\nDim entry As String\n\nFor J = ws.Cells(5, \"C\").Value To ws.Cells(6, \"C\").Value\n\n'get value from combo box\nIf combovalue = \"First Reminder\" Then\n'MsgBox combovalue\n\n'set a reply\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutNS = OutApp.GetNamespace(\"MAPI\")\nentry = ws.Cells(J, \"G\")\nSet mail = OutNS.GetItemFromID(entry) 'get handle on mail item\nSet convo = mail.GetConversation 'get handle on existing conversation\nSet convoItem = convo.GetRootItems(1) 'get convo root item\nSet newMail = convoItem.Reply 'new email as reply to convo\nEmailto = ws.Cells(J, \"D\").Value\nsendfrom = \"email\"\n\nOn Error Resume Next\nWith newMail\n.SendUsingAccount = sendfrom\n.To = Emailto\n.Subject = \"Test\"\n.VotingOptions = \"Acknowledge;\"\n.BodyFormat = olFormatHTML\n.HTMLBody = \"Body here\"\n.Send 'or use .Display to open Outlook's new message window before sending\nws.Cells(J, \"T\").Value = Date\nEnd With\n\nOn Error GoTo 0\nSet OutApp = Nothing\nSet newMail = Nothing\nEnd If\n\nIf combovalue = \"Second Reminder\" Then\n'MsgBox (\"Correct\")\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutNS = OutApp.GetNamespace(\"MAPI\")\nentry = ws.Cells(J, \"Z\")\nSet mail = OutNS.GetItemFromID(entry) 'get handle on mail item\nSet convo = mail.GetConversation 'get handle on existing conversation\nSet convoItem = convo.GetRootItems(1) 'get convo root item\nSet newMail = convoItem.Reply 'new email as reply to convo\nEmailto = ws.Cells(J, \"D\").Value\nsendfrom = \"email\"\n\nOn Error Resume Next\nWith newMail\n.SendUsingAccount = sendfrom\n.To = Emailto\n.BCC = \"\"\n.Subject = \"Test\"\n.VotingOptions = \"Acknowledge;\"\n.BodyFormat = olFormatHTML\n.HTMLBody = \"Body here\"\n.Send 'or use .Display to open Outlook's new message window before sending\nws.Cells(J, \"U\").Value = Date\nEnd With\n\nOn Error GoTo 0\nSet OutApp = Nothing\nSet newMail = Nothing\nEnd If\nNext J\n</code></pre>\n\n<p>the first reminder is nested on top of parent email, but for second reminder, instead of nested on top of first reminder and parent email, it was send as a separate mail nested on top of parent email. how can i solve this??</p>\n\n<p><em>EDIT</em>\nExample:</p>\n\n<p>1.parent email entry ID AABJ23</p>\n\n<p>2.first reminder will reply to parent email by setting the entryID to AABJ23\nthen I will get a new entry ID for the first reminder after i sent the email, ABBJ54</p>\n\n<p>3.second reminder will reply to first reminder email by setting the entry ID to ABBJ54</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539148300, "post_id": 52731689, "comment_id": 92390810, "body": "Can you not use the Application.screenupdsting property instead.."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539150179, "post_id": 52731689, "comment_id": 92391409, "body": "@StevenLaycock thanks for the suggestion, I use that as well, but it tends to reset itself during code execution (for want of a better way of explaining),  LockWindowUpdate has been much more robust. Actually the full code FreezeWord also contains <code>.ScreenUpdating = False</code> , but I took it out because  it was a potential distraction and I didn&#39;t feel like defending the apparent redundancy ;-)"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539152088, "post_id": 52731689, "comment_id": 92392228, "body": "Sounds like you need to audit the use of Application.screenupdating in your code. The only other simple solution I could suggest is to minimise the affected windows (with a suitable progress bar for the user so they don&#39;t panic when their document disappears.)."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539153056, "post_id": 52731689, "comment_id": 92392689, "body": "IIRCC <code>.ScreenUpdating</code> turns itself back on after things like: updating fields, showing hidden bookmarks, adding things to documents... I can&#39;t say for sure that it&#39;s these specific things, but these <i>kind</i> of things...   It was using <code>Application.Visible = False</code> ... that freaked people out :-/  It would be a chore to identify all the possible ways that <code>.ScreenUpdating</code> resets itself... I&#39;m more interested in understanding why LockWindowUpdate is not working and if there is something similar that I could use :-)"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539166245, "post_id": 52731689, "comment_id": 92400127, "body": "You could define an event that runs every X seconds which checks a flag to see if screen updating should be turned off and if so turn it off."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539166387, "post_id": 52731689, "comment_id": 92400230, "body": "Hmmm that&#39;s an interesting thought... I imagine I&#39;d need to have a few DoEvents to allow it to do its thing... Wonder what performance would be like..."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539167301, "post_id": 52731689, "comment_id": 92400752, "body": "Less than 10 seconds of googling got me to this.  <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-lockwindowupdate\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/api/winuser/&hellip;</a>  The pertinent part of which is  &quot;The purpose of the LockWindowUpdate function is to permit drag/drop feedback to be drawn over a window without interference from the window itself. ... Use the WM_SETREDRAW message to disable redrawing of a particular window.&quot; where WM_SETREDRAW is a link to   <a href=\"https://docs.microsoft.com/en-gb/windows/desktop/gdi/wm-setredraw\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-gb/windows/desktop/gdi/wm-setredraw</a>"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1539167786, "post_id": 52731689, "comment_id": 92401044, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/181611/discussion-between-slowlearner-and-steven-laycock\">continue this discussion in chat</a>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1539266401, "post_id": 52731689, "comment_id": 92446840, "body": "If you&#39;re getting screen flicker then you probably should review your code. Does it contain a lot of &quot;Selection&quot; and &quot;Activate&quot;? If yes, work directly with Word&#39;s objects, instead. That will greatly reduce screen flicker <i>and</i> speed things up considerably..."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1539302319, "post_id": 52731689, "comment_id": 92463224, "body": "Hi @CindyMeister thanks for the tip - I&#39;ve already stripped out all possible use of <code>Selection</code> - first step of every new interaction is to, e.g. <code>Set tmpRng = Selection.Range</code>, Selection is only used for those awkward times when manipulation is not possible with a range and <code>.Activate</code> is barely used, if at all."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1539302323, "post_id": 52731689, "comment_id": 92463226, "body": "Anyway, it&#39;s NOT so much flicker that I&#39;m trying to avoid... I just don&#39;t want my users to see all the changes as they occur on the document as they happen :-/   As a welcome side effect, I found that locking the screen significantly sped up code execution... and I want that performance gain back!"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1588214786, "creation_date": 1539137955, "last_edit_date": 1588214786, "question_id": 52731689, "link": "https://stackoverflow.com/questions/52731689/lockwindowsupdate-works-in-office-2010-but-not-office-2016", "title": "LockWindowsUpdate Works in Office 2010 but not Office 2016", "body": "<p>I have, for some time, been using the LockWindowUpdate API to prevent screen flicker and speed up code execution in MS Word.  It works in Office 2010 (64 Bit).</p>\n\n<p>It does not work as expected in Office 2016 (neither 32 nor 64 Bit) and I'm at a loss as to how to resolve - any tips, tricks, or explanations welcome.</p>\n\n<pre><code>#If Win64 And VBA7 Then\n    Private Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr\n    Private Declare PtrSafe Function LockWindowUpdate Lib \"user32\" (ByVal hWndLock As LongPtr) As LongPtr\n#Else\n    Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassname As String, ByVal lpWindowName As String) As Long\n    Private Declare Function LockWindowUpdate Lib \"user32\" (ByVal hWndLock As Long) As Long\n#End If\n</code></pre>\n\n<p>The following works in MS Word 2010, but not in Word 2016 both PCs are running Win 10. AFAICT the call to FindWindow is NOT the problem, I've confirmed that <code>docHandle</code> gets a non-zero value.</p>\n\n<pre><code>Public Sub FreezeWord()\n    #If VBA7 Then\n        Dim docHandle As LongPtr\n    #Else\n        Dim docHandle As Long\n    #End If\n\n    ' OpusApp = code name for MS Word\n    docHandle = FindWindow(\"OpusApp\", Application.ActiveDocument.Name &amp; \" - \" &amp; Application.Caption)\n\n    If CBool(docHandle) Then\n        LockWindowUpdate docHandle  ' Does not work: 32 bit, Word 2016\n    End If\nEnd Sub\n</code></pre>\n\n<p>Ref for more info: <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a> (scroll down to: Eliminating Screen Flicker During VBProject Code)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1539140846, "post_id": 52731940, "comment_id": 92389022, "body": "Correct me if I&#39;m wrong here, but I don&#39;t think this will work.  OP is using codenames and they can&#39;t be referenced in this manner.  You&#39;d have to loop through each worksheet in the workbook to test if the codename matched a value in your array of strings and only hide the rows if a match is found."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 1, "creation_date": 1539141049, "post_id": 52731940, "comment_id": 92389070, "body": "@ProfoundlyOblivious, What the OP was asking was there &quot;a better and more efficient way&quot;, which this is."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1539141232, "post_id": 52731940, "comment_id": 92389119, "body": "@Hery0502, As ProfoundlyOblivious stated there are multiple ways to accomplish this, but I like Arrays."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1539141535, "post_id": 52731940, "comment_id": 92389209, "body": "@ GMalc I&#39;m happy to eat my hat if I&#39;m mistaken but I&#39;m reasonably confident your solution will not work with codenames which were specifically stated.  But I don&#39;t disagree, it is an alternative and arraye are great."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 1, "creation_date": 1539149021, "post_id": 52731940, "comment_id": 92391018, "body": "@ProfoundlyOblivious: Nicely spotted."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1539140191, "creation_date": 1539140191, "answer_id": 52731940, "question_id": 52731512, "link": "https://stackoverflow.com/questions/52731512/hide-rows-across-multiple-sheets/52731940#52731940", "title": "Hide rows across multiple sheets", "body": "<p>Use an array of worksheets...</p>\n\n<pre><code>Dim ws As Worksheet\n    For Each ws In Worksheets(Array(\"Sheet6\", \"Sheet7\", \"Sheet8\"))\n        ws.Rows(\"16:17\").Hidden = True\n    Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 2, "last_activity_date": 1539140255, "creation_date": 1539140255, "answer_id": 52731948, "question_id": 52731512, "link": "https://stackoverflow.com/questions/52731512/hide-rows-across-multiple-sheets/52731948#52731948", "title": "Hide rows across multiple sheets", "body": "<p>There are several ways; one that comes to mind is adding them to a dictionary and using <code>For Each</code> to loop through it.</p>\n"}, {"comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 1, "creation_date": 1539151778, "post_id": 52732812, "comment_id": 92392063, "body": "Looks good!  I&#39;d consider replacing <code>arr(i).Rows.Hidden = True&#47;False</code>  with <code>arr(i).Rows.Hidden = not arr(i).Rows.Hidden</code> and renaming the sub &quot;ToggleRows&quot;... but that&#39;s just me.  +1"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1539154858, "post_id": 52732812, "comment_id": 92393527, "body": "@ProfoundlyOblivious: Thanks, nice going. The &#39;toggle&#39; idea was the cherry on top. Now it&#39;s a real beauty."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1569868221, "post_id": 52732812, "comment_id": 102727601, "body": "Still think this is a great answer. Wish I could give you another +1.  Like you, Gmalc showed me something new here, but I differ from you because I think the real cherry on top is how you solved the error that still remains in Gmalc&#39;s post."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1539155266, "last_edit_date": 1539155266, "creation_date": 1539146969, "answer_id": 52732812, "question_id": 52731512, "link": "https://stackoverflow.com/questions/52731512/hide-rows-across-multiple-sheets/52732812#52732812", "title": "Hide rows across multiple sheets", "body": "<h1>I Adore ARRAYS - A Working Solution</h1>\n\n<h2>Hide</h2>\n\n<pre><code>Sub HideRows()\n  Dim arr As Variant\n  Dim i As Integer\n  arr = Array(Sheet6, Sheet7, Sheet8)\n  For i = LBound(arr) To UBound(arr)\n    arr(i).Rows(\"16:17\").Hidden = True\n  Next\nEnd Sub\n</code></pre>\n\n<h2>Show All</h2>\n\n<pre><code>Sub ShowRows()\n  Dim arr As Variant\n  Dim i As Integer\n  arr = Array(Sheet6, Sheet7, Sheet8)\n  For i = LBound(arr) To UBound(arr)\n    arr(i).Rows.Hidden = False\n  Next\nEnd Sub\n</code></pre>\n\n<h2>Toggle</h2>\n\n<pre><code>Sub ToggleRows()\n  Dim arr As Variant\n  Dim i As Integer\n  arr = Array(Sheet6, Sheet7, Sheet8)\n  For i = LBound(arr) To UBound(arr)\n    arr(i).Rows(\"16:17\").Hidden = Not arr(i).Rows(\"16:17\").Hidden\n  Next\nEnd Sub\n</code></pre>\n\n<p>Thanks to:<br>\n<a href=\"https://stackoverflow.com/users/9679683/profoundlyoblivious\">ProfoundlyOblivious</a> for profoundly suggesting and providing the 'Toggle' version.<br>\n<a href=\"https://stackoverflow.com/users/6388698/gmalc\">GMalc</a> for providing the idea of yet another way (not ever seen by me) of using an Array.</p>\n"}], "owner": {"reputation": 91, "user_id": 7885601, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f6147c46368d8fb8a7575291618b859?s=128&d=identicon&r=PG&f=1", "display_name": "Hery0502", "link": "https://stackoverflow.com/users/7885601/hery0502"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 1, "accepted_answer_id": 52732812, "answer_count": 3, "score": 2, "last_activity_date": 1593707531, "creation_date": 1539136259, "last_edit_date": 1593707531, "question_id": 52731512, "link": "https://stackoverflow.com/questions/52731512/hide-rows-across-multiple-sheets", "title": "Hide rows across multiple sheets", "body": "<p>I want to hide rows 16 &amp; 17 across the following tabs in my workbook:</p>\n\n<ul>\n<li>Sheet6 (code name)</li>\n<li>Sheet7 (code name)</li>\n<li>Sheet8 (code name)</li>\n</ul>\n\n<p>There has to be a better and more efficient way to write this code:</p>\n\n<pre><code>    Sub Macro1()\n      Sheet6.Rows(\"16:17\").Hidden = True\n      Sheet7.Rows(\"16:17\").Hidden = True\n      Sheet8.Rows(\"16:17\").Hidden = True\n    End Sub\n</code></pre>\n\n<p>When this code runs, its take longer than I thought it would.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "runtime-error", "named-ranges"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1539135616, "post_id": 52731381, "comment_id": 92387969, "body": "In the &#39;Master Data&#39; worksheet&#39;s private code sheet all unqualified Range objects belong unconditionally to the &#39;Master Data&#39; worksheet so <code>Range(&quot;Data!$L$8:$L$9&quot;)</code> means &#39;give me the cells L8 and L9 on worksheet Data but I want them from the &#39;Master Data&#39; worksheet&#39;. You cannot find L8 and L9 from worksheet Data in the &#39;Master Data&#39; worksheet&#39; (it&#39;s impossible to resolve) so you get an error. Use <code>worksheets(&quot;Data&quot;).Range(&quot;L8:L9&quot;)</code> as qualifies where to look for the cells."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1539135764, "post_id": 52731381, "comment_id": 92388003, "body": "Conversely, in a public module code sheet, a Range object default to the active sheet but are not set in stone and can be overwritten so <code>Range(&quot;Data!L8:L9&quot;)</code> works to reference L8 and L9 from worksheet Data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1539135854, "post_id": 52731381, "comment_id": 92388019, "body": "tldr; Using <code>Range(&quot;Data!L8:L9&quot;)</code> style range references are unreliable. Don&#39;t use them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "edited": false, "score": 0, "creation_date": 1539136360, "post_id": 52731381, "comment_id": 92388123, "body": "Oh, so now that&#39;s mean if I want L8 and L9 to refer in master data, my code should be written like this -- worksheets(&quot; Master Data&quot;).Range(&quot;L8:L9&quot;). Am I correct? Can you fix my coding in the answer? So that it will be clear for me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1539136584, "post_id": 52731381, "comment_id": 92388168, "body": "I don&#39;t believe that AdvancedFilter accepts a CriteriaRange or a CopyToRange from another worksheet and if you wanted criteria or copyto from another worksheet why did you include Data! in the cell reference?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1539136810, "post_id": 52731381, "comment_id": 92388205, "body": "@Jeeped I think I&#39;ve used  AdvancedFilter with different worksheets before - I threw a quick test together and it worked."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1539138923, "post_id": 52731381, "comment_id": 92388630, "body": "I misspoke. The criteria can be on a different worksheet but the copyto range cannot."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1539141095, "post_id": 52731381, "comment_id": 92389078, "body": "@Jeeped where are you seeing that? I had the data on one sheet and the criteria on another and copied to a third with no problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1539141735, "post_id": 52731381, "comment_id": 92389271, "body": "@BigBen, I ran an advanced filter in xl2016. When I tried to set another worksheet for the copyto I received <a href=\"https://i.stack.imgur.com/cyO1N.png\" rel=\"nofollow noreferrer\">this</a>. Since I rarely rely on ActiveSheet, perhaps that is where the discrepancy comes from. Suffice to say that the copyto range can be another worksheet as long as that worksheet is the activesheet. To me, that doesn&#39;t mean you can do it anytime you wish to."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1539142821, "post_id": 52731381, "comment_id": 92389493, "body": "@jeeped I&#39;m working in Office 365. I used codenames within a simple script and didn&#39;t have any immediate error.  Testing various data sets, the filtered results were not always consistent and/or what was expected though. Not that it matters that much - I don&#39;t use advanced filter often. Was only curious because I could have sworn I used in an answer within the last week or so..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "edited": false, "score": 0, "creation_date": 1539138195, "post_id": 52731640, "comment_id": 92388478, "body": "If I put ActiveSheet, they will copy the code in the ActiveSheet and not in Master Data. Because from interface i will click on the macro and will key in the data from the user form."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1539138539, "post_id": 52731640, "comment_id": 92388545, "body": "In fact, in a worksheet&#39;s private code sheet, an unqualified Range implicitly belongs to that worksheet regardless on what is the activesheet. See <a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Is the . in .Range necessary when defined by .Cells?</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539139546, "post_id": 52731640, "comment_id": 92388754, "body": "@Ayra when you&#39;re in a <code>Worksheet</code> module, <code>Me</code> refers to <i>that worksheet</i>, and implicitly qualifies any unqualified <code>Range</code> calls, so you write explicit code and say <code>Me.Range(...)</code>. And in fact, <i>avoid ActiveSheet</i>. Use worksheet code names if they exist at compile-time, <i>otherwise</i> declare a local worksheet variable like you did, and work with that (e.g. why <code>Sheet1.Range</code> right after the <code>AdvancedFilter</code> call?). Ideally though... the <code>UserForm</code> <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">wouldn&#39;t even need to know</a> that there&#39;s a worksheet consuming its data."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1539137862, "last_edit_date": 1539137862, "creation_date": 1539137555, "answer_id": 52731640, "question_id": 52731381, "link": "https://stackoverflow.com/questions/52731381/what-range-should-i-do/52731640#52731640", "title": "What range should i do?", "body": "<blockquote>\n<pre><code>Range(\"Data!$L$8:$L$9\")\n</code></pre>\n</blockquote>\n\n<p>This unqualified <code>Range</code> call is in fact <em>implicitly</em> qualified with <code>ActiveSheet</code>, via a little bit of <em>default member</em> trickery and a bit of indirection. To keep things simple, we can say that this would be equivalent:</p>\n\n<pre><code>ActiveSheet.Range(\"Data!__:__\")\n</code></pre>\n\n<p>There's the problem: the address string is qualified with a sheet name, and the <code>Range</code> we mean to get with that string is taken from whatever the <code>ActiveSheet</code> is. If there's a match, we're lucky. Otherwise, boom.</p>\n\n<p>So here we are. Does this work?</p>\n\n<pre><code>ActiveSheet.Range(\"Data!$L$8:$L$9\")\n</code></pre>\n\n<p>Because this exemplified code throws the same error you're getting, for the same reason:</p>\n\n<pre><code>Sheet1.Range(\"Sheet2!A1\")\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 52731640, "answer_count": 1, "score": 1, "last_activity_date": 1593779006, "creation_date": 1539134957, "last_edit_date": 1593779006, "question_id": 52731381, "link": "https://stackoverflow.com/questions/52731381/what-range-should-i-do", "title": "What range should i do?", "body": "<p>Just wondering, why everytime I debug it will appear </p>\n\n<blockquote>\n  <p>Runtime Error 1004; Method 'Range' of object '_Global' failed</p>\n</blockquote>\n\n<p>and it will be highlight at row </p>\n\n<pre><code> DataSH.Range(\"A2\").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _\n            CriteriaRange:=Range(\"Data!$L$8:$L$9\"), CopyToRange:=Range(\"Data!$N$8:$T$8\"), _\n            Unique:=False\n</code></pre>\n\n<p>If the coding is in forms what should the range be? And the range is referred to Master Data sheet. Can anyone help me? </p>\n\n<pre><code>Private Sub cmdContact_Click()\n        Dim DataSH As Worksheet\n        Set DataSH = Sheet1\n        DataSH.Range(\"L8\") = Me.cboHeader.Value\n        DataSH.Range(\"L9\") = Me.txtSearch.Text\n        DataSH.Range(\"A2\").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _\n        CriteriaRange:=Range(\"Data!$L$8:$L$9\"), CopyToRange:=Range(\"Data!$N$8:$T$8\"), _\n        Unique:=False\n        lstEmployee.RowSource = Sheet1.Range(\"outdata\").Address(external:=True)\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539134918, "post_id": 52731338, "comment_id": 92387782, "body": "Please note the logic conflict I mentioned in an edit to above."}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539137486, "post_id": 52731338, "comment_id": 92388344, "body": "Yeh I noticed that when I was testing it out. The actual script will contain numerous values that will hide/unhide colums. The currently displayed columns will have to be the associated with the last placed value. I do have a query though. This script is for a master database. I&#39;m hoping to automatically copy specific values and columns into individual sheets. So all the X&#39;s into a separate sheet etc. will this be affected by the hide/unhide logic?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1539137947, "post_id": 52731338, "comment_id": 92388435, "body": "If you paste (or otherwise change the values) in a number of cells in column A, each will be processed. Since they receive the same processing, the last one processed will be the final result. This isn&#39;t every value in column A, only the ones that receive new values."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1539134866, "last_edit_date": 1539134866, "creation_date": 1539134538, "answer_id": 52731338, "question_id": 52731278, "link": "https://stackoverflow.com/questions/52731278/how-to-hide-unhide-columns-based-on-a-specific-value-vba/52731338#52731338", "title": "How to hide/unhide columns based on a specific value VBA", "body": "<p>You need Worksheet_Change, not Worksheet_SelectionChange.</p>\n\n<p>There is also some logic conflict. What if column A contains <strong>both</strong> an X and a Y? This routine makes the 'hide columns' decision on the last value placed in column A.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    if not intersect(target, range(\"a:a\")) is nothing then\n        on error goto safe_exit\n        application.enableevents = false\n        dim t as range \n        for each t in intersect(target, range(\"a:a\"))\n            select case ucase(t.value)\n                case \"X\"\n                    Columns(\"B:C\").EntireColumn.Hidden = True\n                    Columns(\"D:E\").EntireColumn.Hidden = false\n                case \"Y\"\n                    Columns(\"B:C\").EntireColumn.Hidden = false\n                    Columns(\"D:E\").EntireColumn.Hidden = true\n                case else\n                    'do nothing\n            end select\n        next t\n    End If\n\nsafe_exit:\n    application.enableevents = true\nEnd Sub\n</code></pre>\n\n<p>Get rid of the Worksheet_SelectionChange event procedure you've created after adding this to the worksheet's private code sheet.</p>\n"}], "owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 52731338, "answer_count": 1, "score": 1, "last_activity_date": 1539134866, "creation_date": 1539133948, "question_id": 52731278, "link": "https://stackoverflow.com/questions/52731278/how-to-hide-unhide-columns-based-on-a-specific-value-vba", "title": "How to hide/unhide columns based on a specific value VBA", "body": "<p>I am trying to create a <code>script</code> that hides or unhides specific <code>Columns</code> when a <code>value</code> is entered into a <code>Column</code> using <code>VBA</code>. </p>\n\n<p>For instance, if <code>X</code> is entered into any <code>cell</code> in <code>Column A</code> then hide <code>Columns B:C</code>. But if the <code>value</code> in <code>Column A</code> is <code>Y</code> then <code>Columns D:E</code> but show <code>Columns B:C</code>.</p>\n\n<p>This is what I've tried thus far:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Range(\"A\").Value = \"X\" Then\n        Columns(\"B:C\").EntireColumn.Hidden = True\n    ElseIf Range(\"A\").Value = \"Y\" Then\n        Columns(\"D:E\").EntireColumn.Hidden = True\n    Else\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 1, "creation_date": 1539133127, "post_id": 52731116, "comment_id": 92387412, "body": "Have you tried the <code>Show Report Filter Pages</code> option of the pivot already?"}], "answers": [{"tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1539135448, "creation_date": 1539135448, "answer_id": 52731428, "question_id": 52731116, "link": "https://stackoverflow.com/questions/52731116/loop-through-list-and-generate-reports/52731428#52731428", "title": "Loop Through List and Generate Reports", "body": "<p>the acceptance is the first step to learning. In general, the stackoverflow community encourages to invigorate the technical and logical parts of the brain by providing the hints to solution and not the exact solution. However, as you are very new, I am starting with giving off hints and later on the code to rectify your issue. You are going very well with your code, however some minor tweaks will optimize your code significantly.</p>\n\n<hr>\n\n<pre><code>Worksheets(\"HomePage\").Select\n\nDim lstRow As Long\nDim rngCell As Range\nDim rngSelection As Range\n\n'Let's find the last row with data in column A. \n'So that we only traverse the required range without the need of \n'deleting previous cells while using the For loop.\nlstRow = Worksheets(\"FeederList\").Range(\"A\" &amp; Application.Rows.Count).End(xlUp).Row\nSet rngSelection = Worksheets(\"FeederList\").Range(\"A2:A\" &amp; lstRow)\n\nFor Each rngCell In rngSelection.Cells\n    'Ignore all the cells with blank value or else the pivot table will throw the error\n    If Trim(rngCell.Value) &lt;&gt; vbNullString Then\n        'Sets the name in Home Page to the name in Feederlist cell F2\n            strPage = rngCell.Value\n            Worksheets(\"HomePage\").PivotTables(\"PivotTable1\").PivotFields(\"UNIQUE ID\"). _\n            CurrentPage = strPage\n\n        '   **Do a Bunch of Stuff**\n\n    End If\nNext\nrngSelection.Clear ' Optional - if the range really needs to be cleared\nMsgBox \"All Reports have been created.\", vbInformation + vbOKOnly\n</code></pre>\n\n<hr>\n\n<p>You need to understand the changes and ask any further questions that you might have. Below are the changes made to the original code.</p>\n\n<ul>\n<li>Introduced calculation of last cell in Column A having some data</li>\n<li>Introduced For Loop instead of using labels eliminating the need of deleting rows</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10481379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4a375844a1aeb482cce227908fd9a1?s=128&d=identicon&r=PG&f=1", "display_name": "JasonW88", "link": "https://stackoverflow.com/users/10481379/jasonw88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1593779019, "creation_date": 1539132236, "last_edit_date": 1593779019, "question_id": 52731116, "link": "https://stackoverflow.com/questions/52731116/loop-through-list-and-generate-reports", "title": "Loop Through List and Generate Reports", "body": "<p>I'm struggling with what I believe is a loop problem. I'm more of a \"backyard mechanic\" with Excel VBA so please excuse my simple question.</p>\n\n<p>I can't share the workbook due to proprietary information unfortunately but I have the code I use with some field name changes.</p>\n\n<p><strong>Background:</strong> I have a column that I take 1 cell at a time and feed it into a pivot table field and run reports. The way I have it now, I delete the current Row which returns the reference back to cell A2. Think of it like a programming Pez dispenser. Awful and very brute force I know. The row delete operation takes a lot of system resources and I'd like to optimize it. I've tried reading through here and a few other websites for the past couple hours but I can't make heads or tails of what I'm coming across.</p>\n\n<p>Any help would be very greatly appreciated!</p>\n\n<pre><code>Sub AutoReport()\n\nDim strPage As String\n\n\n\nWorksheets(\"HomePage\").Select\n\nBeginning:\n'Sets the name in Home Page to the name in Feederlist cell F2\n\nWith Sheet1\n    strPage = Worksheets(\"FeederList\").Range(\"A2\")\n    Worksheets(\"HomePage\").PivotTables(\"PivotTable1\").PivotFields(\"UNIQUE ID\"). _\n    CurrentPage = strPage\nEnd With\n\n\n**Do a Bunch of Stuff**\n\n\n\n' Feeds the next input into the machine\n\nMoveToNext:\n\nWorksheets(\"FeederList\").Activate\nWorksheets(\"FeederList\").Range(\"A2\").EntireRow.Delete\n\nIf Worksheets(\"FeederList\").Range(\"A2\") = \"\" Then\n\nMsgBox \"All Reports have been created.\", vbInformation + vbOKOnly\n\nExit Sub\nElse\n\nGoTo Beginning\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 4, "creation_date": 1539131816, "post_id": 52731048, "comment_id": 92387149, "body": "Did you run it with and without to see? It&#39;s an &quot;alias&quot;. It &quot;renames&quot; the column"}], "answers": [{"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": true, "score": 2, "last_activity_date": 1539146786, "creation_date": 1539146786, "answer_id": 52732785, "question_id": 52731048, "link": "https://stackoverflow.com/questions/52731048/as-keyword-sql-vba/52732785#52732785", "title": "As keyword SQL VBA", "body": "<p>The key word <code>AS</code> indcates, that you want to use an alias for your column name. </p>\n\n<pre><code>SELECT Sales FROM Table1 'The column name in the output query will be Sales\n\nSELECT Sales As Money FROM Table1 'The column name in the output query will be Money\n</code></pre>\n\n<p>To your second question it is not the same. If <code>Form1</code> is the active form and you use <code>me.ID</code> it will be the same like <code>Form1!ID</code>. Same when <code>Form2</code> is the active form and you use <code>me.ID</code> it will be <code>Form2!ID</code>. So <code>.me</code> refers always to the active form. But when you use <code>Forms!Form2!ID</code> it will always look for <code>Form2</code> even when <code>Form1</code> is the active form.</p>\n"}], "owner": {"reputation": 229, "user_id": 10305539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vmtmrWHPM-s/AAAAAAAAAAI/AAAAAAAAAHs/x9ECcI11M9o/photo.jpg?sz=128", "display_name": "greenn", "link": "https://stackoverflow.com/users/10305539/greenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 52732785, "answer_count": 1, "score": -4, "last_activity_date": 1594627498, "creation_date": 1539131632, "last_edit_date": 1594627498, "question_id": 52731048, "link": "https://stackoverflow.com/questions/52731048/as-keyword-sql-vba", "title": "As keyword SQL VBA", "body": "<p>I was looking at SQL statement for an example database which went something like this'</p>\n\n<pre><code>SELECT INDEX, SUM AS Total FROM INVD WHERE INV=[Forms]![ENTRY].[INV]\n</code></pre>\n\n<p>What does AS mean on the code above?</p>\n\n<p>Also is me.Entry same as [Forms]![ENTRY]</p>\n"}, {"tags": ["c#", "vba", "com", "activex", "typelib"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1539129876, "post_id": 52730815, "comment_id": 92386714, "body": "The <code>defaultbind</code> attribute is for <a href=\"https://docs.microsoft.com/en-us/windows/desktop/midl/defaultbind\" rel=\"nofollow noreferrer\">bindable members</a>, which are not the same as default properties. In order to make a property a default, it should have a dispatch ID of zero."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1539129989, "post_id": 52730815, "comment_id": 92386739, "body": "The default property always has id=0.  Your Value property is id 2.  We can&#39;t guess what you assigned.  Probably nothing, as the error message suggests."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1539130841, "post_id": 52730815, "comment_id": 92386936, "body": "Comintern and Hans, thanks a-ton  for the response. I corrected the DispId as 0 in the Interface and the IDL for the property and now it works without any error."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1539155805, "post_id": 52730815, "comment_id": 92394032, "body": "please answer yourself then"}], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539129521, "creation_date": 1539129521, "question_id": 52730815, "link": "https://stackoverflow.com/questions/52730815/c-com-default-property-is-throwing-error-no-438", "title": "C# COM, default property is throwing error no. 438", "body": "<p>I am writing an ActiveX COM control in C#. In this control I have a property called 'Value', which I am trying to expose as default property. </p>\n\n<p>Here is the Typelib definition:</p>\n\n<pre><code>[id(0x00000002), propget, bindable, requestedit, displaybind, defaultbind, helpstring(\"Returns/sets the current date.\")]\nHRESULT Value([out, retval] VARIANT* pRetVal);\n\n[id(0x00000002), propput, bindable, requestedit, displaybind, defaultbind, helpstring(\"Returns/sets the current date.\")]\nHRESULT Value([in] VARIANT pRetVal);\n</code></pre>\n\n<p>The Property implementation is simple :</p>\n\n<pre><code>public object Value\n        {\n            get { return BaseControl.Value.Date; }\n            set\n            {\n               DateTime dt;              \n                //BaseControl is a DateTimePicker control.\n               BaseControl.Value = DateTime.TryParse((value ?? \"\").ToString(), out dt) ? dt : DateTime.Today;\n            }\n        }\n</code></pre>\n\n<p>When using this control in VBA, I able to Set\\Get the <code>Value</code> property like this </p>\n\n<pre><code>Private Sub Test()\n    Me.DTPicker1.Value = Date - 5\nEnd Sub\n</code></pre>\n\n<p>But when I am trying to use the default version, </p>\n\n<pre><code>Private Sub Test2()\n    '/Default property access\n    Me.DTPicker1 = Date - 5\nEnd Sub\n</code></pre>\n\n<p>It throws the error, </p>\n\n<blockquote>\n  <p>438: Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>Any idea, why the default mode is not working?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539122778, "post_id": 52729951, "comment_id": 92385055, "body": "Is all of the code necessary? Show the code that is giving you a problem - the rest is irrelevant"}, {"owner": {"reputation": 13, "user_id": 10405580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xt3x9_7g_1w/AAAAAAAAAAI/AAAAAAAAAFA/_oRBsj9PGvA/photo.jpg?sz=128", "display_name": "Martin Lauf", "link": "https://stackoverflow.com/users/10405580/martin-lauf"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539122929, "post_id": 52729951, "comment_id": 92385111, "body": "wkb.SaveAs Filename:=relativePath   This line is throwing error"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1539123035, "post_id": 52729951, "comment_id": 92385135, "body": "You&#39;ve posted far too much code. Isolate the problem to a specific area, and then post only the code necessary to reproduce it. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Also, <i>program will throw an error</i> is not a problem description. What <i>specific</i> error does it <i>throw</i>? What is the exact error message? It&#39;s on your screen, right in front of you. It should be included in your post so we have that information as well."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1539123050, "post_id": 52729951, "comment_id": 92385142, "body": "It would be better if we could see an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> so we don&#39;t spend time parsing code that works."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1539123190, "post_id": 52729951, "comment_id": 92385186, "body": "<a href=\"https://stackoverflow.com/a/16839561/4539709\">stackoverflow.com/a/16839561/4539709</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1539123244, "post_id": 52729951, "comment_id": 92385197, "body": "Stop replying in comments. Instead, <a href=\"https://stackoverflow.com/posts/52729951/edit\">edit</a> your post, remove all of the code that is not necessary, and clearly state the problem and include the error message. Again, see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539123437, "post_id": 52729951, "comment_id": 92385259, "body": "See <a href=\"https://stackoverflow.com/q/16351249/4088852\">VBA check if file exists</a>."}, {"owner": {"reputation": 13, "user_id": 10405580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xt3x9_7g_1w/AAAAAAAAAAI/AAAAAAAAAFA/_oRBsj9PGvA/photo.jpg?sz=128", "display_name": "Martin Lauf", "link": "https://stackoverflow.com/users/10405580/martin-lauf"}, "edited": false, "score": 0, "creation_date": 1539123590, "post_id": 52729951, "comment_id": 92385299, "body": "My problem is not that the file exists, because if I press YES, file is replaced without error. But when user press No or CANCEL, program will stop work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539124094, "post_id": 52729951, "comment_id": 92385446, "body": "Do you always want to save the file? Or will there be times to actually want to use &quot;no&quot;/&quot;cancel&quot;?"}, {"owner": {"reputation": 13, "user_id": 10405580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xt3x9_7g_1w/AAAAAAAAAAI/AAAAAAAAAFA/_oRBsj9PGvA/photo.jpg?sz=128", "display_name": "Martin Lauf", "link": "https://stackoverflow.com/users/10405580/martin-lauf"}, "edited": false, "score": 0, "creation_date": 1539124401, "post_id": 52729951, "comment_id": 92385509, "body": "sometimes, want to avoid it. Because if user forgot to move(rename) previous file, he will want to keep it and not replace."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539126654, "post_id": 52730333, "comment_id": 92385987, "body": "You should clean up your code and remove all instances of <code>.Select</code> and <code>.Selection</code>. These are middle operators and are not necessary for navigating from place to place. You don&#39;t have to select a workbook/sheet/range to modify it (copy/move/delete/etc). All these do is slow your code down and make it harder to follow"}], "tags": [], "owner": {"reputation": 13, "user_id": 10405580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xt3x9_7g_1w/AAAAAAAAAAI/AAAAAAAAAFA/_oRBsj9PGvA/photo.jpg?sz=128", "display_name": "Martin Lauf", "link": "https://stackoverflow.com/users/10405580/martin-lauf"}, "is_accepted": false, "score": 0, "last_activity_date": 1539126032, "last_edit_date": 1539126032, "creation_date": 1539125371, "answer_id": 52730333, "question_id": 52729951, "link": "https://stackoverflow.com/questions/52729951/how-to-handle-error-when-user-press-no-or-cancel/52730333#52730333", "title": "How to handle error when user press NO or Cancel", "body": "<p>I was finally able to solve the problem this way.</p>\n\n<pre><code>Dim wkb As Workbook\nSet wkb = Workbooks.Add\nrelativePath = ThisWorkbook.Path &amp; \"\\\" &amp; \"WorkbookName.xlsx\"\n\nIf Not Dir(relativePath, vbDirectory) = vbNullString Then\nIf MsgBox(\"File already exists, do you want to continue and replace it?\", vbYesNo, \"Wanna replace existing file?\") = vbNo Then\nActiveWorkbook.Close savechanges:=False\nwkbcurrent.Activate\nColumns(\"U:U\").Select\nSelection.Delete Shift:=xlToLeft\nExit Sub\nEnd If\nElse\nEnd If\n\nApplication.DisplayAlerts = False\nwkb.SaveAs Filename:=relativePath\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10405580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xt3x9_7g_1w/AAAAAAAAAAI/AAAAAAAAAFA/_oRBsj9PGvA/photo.jpg?sz=128", "display_name": "Martin Lauf", "link": "https://stackoverflow.com/users/10405580/martin-lauf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539126032, "creation_date": 1539122520, "last_edit_date": 1539123471, "question_id": 52729951, "link": "https://stackoverflow.com/questions/52729951/how-to-handle-error-when-user-press-no-or-cancel", "title": "How to handle error when user press NO or Cancel", "body": "<p>I am working on macro to export some data to new workbook. Everything works as it should. </p>\n\n<p>But if the exported file already exists in directory, program asks if you want to replace it with a new one. </p>\n\n<p>If you press Yes, everything works perfect but if you press NO or CANCEL program will throw an error: </p>\n\n<p>Run-time error '1004':\nMethod SaveAs of object'_Workbook' failed</p>\n\n<p>I think I should to something with this line: </p>\n\n<pre><code>wkb.SaveAs Filename:=relativePath\n</code></pre>\n\n<p>but I have no idea how to do it. </p>\n\n<pre><code>Sub ExportData()\n\n    'create and save new workbook\n    Dim wkb As Workbook\n    Set wkb = Workbooks.Add\n    relativePath = ThisWorkbook.Path &amp; \"\\\" &amp; \"WorkbookName.xlsx\"\n    wkb.SaveAs Filename:=relativePath\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "runtime-error", "subscript"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539122031, "post_id": 52729822, "comment_id": 92384810, "body": "when it errors, look at what is stored in <code>myArr</code>.  You will find that all but the last item is blank.  Since there is no sheet with a blank name you will not find it and the error will be produced.  Look into RedimPreserve()."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539122089, "post_id": 52729822, "comment_id": 92384832, "body": "You will also want that inside the IF so you are not creating blanks in your array."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539125043, "post_id": 52729822, "comment_id": 92385661, "body": "<code>myArr()</code> doesn&#39;t have an index specified. You <b><i>should</i></b> be getting a run-time error 438."}], "owner": {"reputation": 1, "user_id": 10481000, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211859632599998/picture?type=large", "display_name": "Thimira Jayathilake", "link": "https://stackoverflow.com/users/10481000/thimira-jayathilake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539121836, "creation_date": 1539121745, "last_edit_date": 1539121836, "question_id": 52729822, "link": "https://stackoverflow.com/questions/52729822/i-get-subscript-out-of-range-error-when-selecting-sheets-in-an-array", "title": "I get subscript out of range error when selecting sheets in an array", "body": "<p>I'm getting a run-time error '9': subscript out of range on <strong>ActiveWorkbook.Sheets(myArr()).Select</strong> line. Please help.</p>\n\n<pre><code>Private Sub CommandButton1_Click()                                                      \n\nDim sH As Worksheet                                                             \nDim Assy As String\nDim Path As String\nDim ShName As String\nDim myArr() As Variant\nDim X As Integer\n\nIf CheckBox1.Value = True Then                                                      Worksheets(\"Supplier PDFs\").Activate                                        'make Supplier PDFs sheet active sheet\n    Assy = Range(\"C5\").Text                                                     'Assembly name\n    Path = Range(\"H5\").Text                                                     'Directory path name\n    If Assy = \"\" Or Path = \"\" Then                                              'If name or folder path is empty,\n        MsgBox \"An entry was left blank! Please provide name and/or filepath.\"  'Give error message\n        End\n    Else\n    End If\n\n    For Each sH In ActiveWorkbook.Worksheets                                    'for each worksheet\n        ReDim myArr(X)                                                          'redeclare matrix myArr with size X\n        sH.Activate                                                             'activate sheet\n        ShName = ActiveSheet.Name                                               'ShName is the name of the active sheet\n        ActiveSheet.PageSetup.FitToPagesWide = 1                                'Set page width to 1-page\n        ActiveSheet.PageSetup.Orientation = xlLandscape                         'Set orientation to landscape\n        ActiveSheet.PageSetup.Draft = False                                     'Print with graphics\n        ActiveSheet.PageSetup.PaperSize = xlPaperLetter                         'Set paper size to letter\n\n        If Range(\"F3\") = Assy And ActiveSheet.Visible = True Then               'if assembly level is right,\n            myArr(X) = ShName                                                   'update array element with sheet name\n            X = X + 1                                                           'index counter X\n        Else                                                                    'if not, do nothing\n        End If\n    Next sH                                                                     'end for loop\n\n\n    ReDim Preserve myArr(X)                                                     'reset myArr array size to 0\n    **ActiveWorkbook.Sheets(myArr()).Select**                                                      'select all sheets with sheetnames in myArr\n    ActiveSheet.PageSetup.PrintArea = \"$A$1:$R$26\"                              'Set print area to sheet limits\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    Path &amp; Assy &amp; \".pdf\", Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True                                                      'Set filename, quality, properties and open after publish\n                                                                                'reset myArr size to zero\n\n    If X &gt; 0 Then\n        X = X - 1\n    Else\n    End If\n\n    ReDim myArr(0)\nEnd If\n\nUnload Me\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 0, "creation_date": 1539121623, "post_id": 52729778, "comment_id": 92384688, "body": "Thanks, if I have a lot of options I&#39;ll have to post every time &quot;textbox1&quot;?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 1, "creation_date": 1539121666, "post_id": 52729778, "comment_id": 92384703, "body": "How many options? If you are using this format in your test statement, then yes, the object needs to stated every time."}, {"owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 0, "creation_date": 1539121838, "post_id": 52729778, "comment_id": 92384757, "body": "I can also use a variable like &quot;or1&quot; which is shorter for me"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 4, "creation_date": 1539121884, "post_id": 52729778, "comment_id": 92384772, "body": "@slomo then make a <a href=\"https://stackoverflow.com/a/30034704/1188513\">ContainsAny</a> function so that evaluation bails out as soon as one matches (<code>If...Then</code> will otherwise make every single comparison, even if the first is already <code>True</code>). But please, don&#39;t name anything <code>or1</code>... ever."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1539121513, "creation_date": 1539121513, "answer_id": 52729778, "question_id": 52729748, "link": "https://stackoverflow.com/questions/52729748/how-to-set-or-in-vba-in-excel/52729778#52729778", "title": "How to set &quot;or&quot; in VBA in excel", "body": "<p>You need to restate the test object</p>\n\n<pre><code>If textbox1.Text = \"abc def\" Or textbox1.Text = \"def\" Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 3, "last_activity_date": 1539124899, "creation_date": 1539124899, "answer_id": 52730277, "question_id": 52729748, "link": "https://stackoverflow.com/questions/52729748/how-to-set-or-in-vba-in-excel/52730277#52730277", "title": "How to set &quot;or&quot; in VBA in excel", "body": "<p>If you have many conditions, use Select Case:</p>\n\n<pre><code>Select Case textbox1.Text\n    Case \u201cabc def\u201d, \u201cdef\u201d, \u201cxyz\u201d\n        MsgBox \u201cNote that multiple values may be captured here, separated by commas\u201d\n    Case \u201cabc\u201d\n        MsgBox \u201cJust abc\u201d\n    Case Else\n        MsgBox \u201cEverything else\u201d\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52729778, "answer_count": 2, "score": 1, "last_activity_date": 1593779034, "creation_date": 1539121407, "last_edit_date": 1593779034, "question_id": 52729748, "link": "https://stackoverflow.com/questions/52729748/how-to-set-or-in-vba-in-excel", "title": "How to set &quot;or&quot; in VBA in excel", "body": "<p>I set \"if\" with the \"or\" condition and give an error</p>\n\n<p><code>If textbox1.Text = \"abc def\" Or \"def\" Then</code></p>\n\n<p>I understand that I'm not writing right?\nWhat is my problem?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 584, "user_id": 10043204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394373b4fe1295f2372b3acbd8e972c0?s=128&d=identicon&r=PG&f=1", "display_name": "Bear", "link": "https://stackoverflow.com/users/10043204/bear"}, "edited": false, "score": 0, "creation_date": 1539121216, "post_id": 52729658, "comment_id": 92384541, "body": "A quick internet search yielded <a href=\"https://web.stanford.edu/group/ttsclasses/cgi-bin/techietips/?p=1725\" rel=\"nofollow noreferrer\">this</a>. Hope that helps."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539121239, "post_id": 52729658, "comment_id": 92384552, "body": "Not sure what you mean by your bonus?"}, {"owner": {"reputation": 584, "user_id": 10043204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394373b4fe1295f2372b3acbd8e972c0?s=128&d=identicon&r=PG&f=1", "display_name": "Bear", "link": "https://stackoverflow.com/users/10043204/bear"}, "edited": false, "score": 0, "creation_date": 1539121291, "post_id": 52729658, "comment_id": 92384574, "body": "My guess is he wants someone to answer how to solve that secondary problem too. As in a &quot;bonus question&quot;..?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 584, "user_id": 10043204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394373b4fe1295f2372b3acbd8e972c0?s=128&d=identicon&r=PG&f=1", "display_name": "Bear", "link": "https://stackoverflow.com/users/10043204/bear"}, "edited": false, "score": 0, "creation_date": 1539121662, "post_id": 52729658, "comment_id": 92384702, "body": "@Bear I understand the concept but not the bonus question itself"}, {"owner": {"reputation": 584, "user_id": 10043204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394373b4fe1295f2372b3acbd8e972c0?s=128&d=identicon&r=PG&f=1", "display_name": "Bear", "link": "https://stackoverflow.com/users/10043204/bear"}, "edited": false, "score": 0, "creation_date": 1539121752, "post_id": 52729658, "comment_id": 92384730, "body": "Gotcha, he might be talking about how to link the sheets together. That&#39;s my take on it anyway."}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539286402, "post_id": 52729658, "comment_id": 92457969, "body": "Hello Bear. Thanks for the help. This option only adds a comment. Im looking for a button that adds all entries, saves all entries on sheet2, and adds them up on cell C2 as you are entering them."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1539122648, "post_id": 52729704, "comment_id": 92385015, "body": "This can be improved upon by using <code>Application.Inputbox</code> and validating the entry. +1 regardless"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539124458, "post_id": 52729704, "comment_id": 92385522, "body": "@urdearboy You&#39;re right, I kind of phoned it in for this one"}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539286530, "post_id": 52729704, "comment_id": 92458045, "body": "Thank you  Marcucciboy2. This is somewhat similar to what im looking for. Although it doesn&#39;t quite work. I will see if i can work with the help that you provided. Thank you."}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539286626, "post_id": 52729704, "comment_id": 92458098, "body": "@urdearboy, Where would i insert the Application.Inputbox, or what line should it replace on  Marcucciboy2 example?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539287012, "post_id": 52729704, "comment_id": 92458317, "body": "@HenryNavarro describe how it doesn&#39;t work. I made a little update that may help"}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539295333, "post_id": 52729704, "comment_id": 92461691, "body": "Take a look at this image. Hope it helps. ( <a href=\"https://ibb.co/dd403p\" rel=\"nofollow noreferrer\">ibb.co/dd403p</a> ) By clicking the &quot;Checks&quot; button (on cell D43), a pop up appears and asks for an amount. You enter the amount and press Enter. The pop up disappears and It then updates a cell (C43) by adding whatever amount you entered into the popup. See this other image ( <a href=\"https://ibb.co/hZW53p\" rel=\"nofollow noreferrer\">ibb.co/hZW53p</a> ). Note: These images are photo shopped. :)"}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539295782, "post_id": 52729704, "comment_id": 92461835, "body": "Also, if possible, all entries would be save on Sheet2, on column A."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539302283, "post_id": 52729704, "comment_id": 92463218, "body": "@HenryNavarro you still haven\u2019t described the problem you\u2019re having"}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539362554, "post_id": 52729704, "comment_id": 92488939, "body": "<a href=\"https://ibb.co/i8Z8PU\" rel=\"nofollow noreferrer\">ibb.co/i8Z8PU</a> - After pressing on the button, it just says Syntax Error."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539373681, "post_id": 52729704, "comment_id": 92493669, "body": "@HenryNavarro turns out <code>input</code> is a reserved word in vba, so I renamed it to <code>val</code> and now it should work"}, {"owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539376306, "post_id": 52729704, "comment_id": 92494613, "body": "This works now. Thank you. One last question. If i needed to enter multiple entries (check number, check date, check amount &amp; order number) to be saved on Sheet2, how can that be done? I tried to modify your code to ask me for all of that already, but it doesn&#39;t save anything after the first entry, and it doesn&#39;t record it into the second row on sheet2. Thank you in advance."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "edited": false, "score": 0, "creation_date": 1539388788, "post_id": 52729704, "comment_id": 92498085, "body": "@HenryNavarro why not open up another question? I think a question like that someone would be willing to answer"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 3, "last_activity_date": 1539373653, "last_edit_date": 1539373653, "creation_date": 1539121156, "answer_id": 52729704, "question_id": 52729658, "link": "https://stackoverflow.com/questions/52729658/excel-popup-button-to-ask-how-much-money-to-add-to-an-existing-cell-with-an-exis/52729704#52729704", "title": "excel popup button to ask how much money to add to an existing cell with an existing amount", "body": "<p><a href=\"https://support.office.com/en-us/article/assign-a-macro-to-a-form-or-a-control-button-d58edd7d-cb04-4964-bead-9c72c843a283\" rel=\"nofollow noreferrer\">Here\u2019s how to connect the macro to a button</a></p>\n\n<pre><code>Private Sub Button1_Click()\n    Dim val As Long\n    val = Application.InputBox(Prompt:=\"Enter Amount\", Type:=1)\n\n    Range(\"C43\").Value = Range(\"C43\").Value + val\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10480630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NBLtRpShcao/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVG2AMlScyF9zsJCky_xRojP7JDPQ/mo/photo.jpg?sz=128", "display_name": "Henry Navarro", "link": "https://stackoverflow.com/users/10480630/henry-navarro"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "closed_date": 1539138166, "accepted_answer_id": 52729704, "answer_count": 1, "score": -6, "last_activity_date": 1593766366, "creation_date": 1539120925, "last_edit_date": 1593766366, "question_id": 52729658, "link": "https://stackoverflow.com/questions/52729658/excel-popup-button-to-ask-how-much-money-to-add-to-an-existing-cell-with-an-exis", "closed_reason": "Needs more focus", "title": "excel popup button to ask how much money to add to an existing cell with an existing amount", "body": "<p>Let me rephrase my question. I am making an excel worksheet to close our registers. My worksheet counts all coins and loose dollar bills. When entering checks, i would like to have a button that saves all entries on sheet2 and adds them up on cell C2. Is it possible to have a button in excel that (when pushed) would ask to enter an amount, and the new amount would be added to a cell with an existing amount.</p>\n\n<p>Example: \"C2\" has the value of $4.50. \"D2\" has the \"Add Money\" button. When button is pushed, it would ask to enter an amount. Once you enter the amount ($12.75) and press \"ENTER\", \"C2\" will update itself to $17.25.</p>\n\n<p>Also, i would like to all entries to be save on the sheet2, so we can have a record of each new entry. </p>\n\n<p>Update on 9/1/19 - For those who want a button to add check entries, this is what I ended up using. This code (mainly thanks to Marcucciboy2) adds all the checks into a cell in sheet 1, but stores all the check info on sheet 2.</p>\n\n<pre><code>    Sub Checks()\n\n    Dim CheckNumber As String, CheckNumberlr As Long\n    CheckNumber = InputBox(\"Check Number\", \"Please Enter\")\n    If CheckNumber = \"\" Then\n        Exit Sub\n    Else\n        CheckNumberlr = Worksheets(\"Checks\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n        Worksheets(\"Checks\").Range(\"A\" &amp; CheckNumberlr).Value = CheckNumber\n\n    End If\n\n    Dim CheckDate As String, CheckDatelr As Long\n    CheckDate = InputBox(\"Check Date\", \"Please Enter\", Date)\n    If CheckDate = \"\" Then\n        Exit Sub\n    Else\n        CheckDatelr = Worksheets(\"Checks\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n        Worksheets(\"Checks\").Range(\"B\" &amp; CheckDatelr).Value = CheckDate\n\n    End If\n\n    Dim CheckAmount As String, CheckAmountlr As Long\n    CheckAmount = InputBox(\"Enter Check Amount\", \"Please Enter\")\n    If CheckAmount = \"\" Then\n        Exit Sub\n    Else\n        CheckAmountlr = Worksheets(\"Checks\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n        Worksheets(\"Checks\").Range(\"C\" &amp; CheckAmountlr).Value = CheckAmount\n\n    End If\n\n    Dim OrderNumber As String, OrderNumberlr As Long\n    OrderNumber = InputBox(\"If Available, Enter Order Number\", \"Please Enter\")\n    If OrderNumber = \"\" Then\n        Exit Sub\n    Else\n        OrderNumberlr = Worksheets(\"Checks\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row + 1\n        Worksheets(\"Checks\").Range(\"D\" &amp; OrderNumberlr).Value = OrderNumber\n\n    End If\n    End Sub\n</code></pre>\n\n<p>Thank you all for your time. </p>\n"}, {"tags": ["excel", "vba", "serial-port"], "owner": {"reputation": 661, "user_id": 3496060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/16917224/picture?type=large", "display_name": "user3496060", "link": "https://stackoverflow.com/users/3496060/user3496060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2446, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593779057, "creation_date": 1539119568, "last_edit_date": 1593779057, "question_id": 52729410, "link": "https://stackoverflow.com/questions/52729410/read-serial-port-using-the-get-comfile-record-in-excel-vba-seems-to-have-a", "title": "read serial port using the &quot;Get #COMfile, , record&quot; in Excel VBA seems to have a infinite timeout?", "body": "<p>The below code hangs until serial data is received.  I've tracked it down to the \"Get #COMfile, , record\" part, which I assume has an infinite timeout.  Is there a better way to do this so i can work with excel while simultaneously getting serial data?</p>\n\n<p>Note:  This code is ubiquitous, and MS documentation scarce.  Most posts on this topic are very old (&lt;= 2010).  I did find some documentation on the \"Get, Open, etc\" functions <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/get-statement\" rel=\"nofollow noreferrer\">here</a> but not enough to figure out why it waits for data to come in on the serial port before returning.</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64-Bit versions of Excel\nDim record As String * 1, emptyRecord As String * 1\nDim stopclick As Boolean\n\nSub stoploop()\n    stopclick = True\n    MsgBox (\"Finished.\")\nEnd Sub\nSub ReadCommPC()\n    Dim COMport As String\n    Dim COMfile As Integer\n    Dim COMstring As Variant\n    Dim baudrate As Long\n    Dim timeout As Date\n    Dim record_cat As Variant\n    Dim COLindex As Integer\n    Dim ROWindex As Integer\n\n    Dim cntr As Integer\n    cntr = 0\n\n    stopclick = False\n    COLindex = 0\n    ROWindex = 0\n\n    COMport = Sheets(\"Setup\").Range(\"C2\").Value\n    baudrate = Sheets(\"Setup\").Range(\"C3\").Value\n    timespan = Sheets(\"Setup\").Range(\"C4\") * 3\n    Sheets(\"Data\").Select\n    Range(\"A1\").Select\n\n     'Open COM# port with baud rate 9600, No parity, 8 data bits and 1 stop bit\n    COMfile = FreeFile\n    COMstring = COMport &amp; \":\" &amp; baudrate &amp; \",N,8,1\"\n\n    Open COMstring For Random As #COMfile Len = 1\n    record = \"\"\n    record_cat = \"\"\n    'timeout = Now + TimeValue(\"00:00:20\")  'if no data received in 20 sec give up\n    timeout = Now + (timespan / 86400) 'if no data received in 20 sec give up\n\n    'MsgBox (\"Now:\" &amp; Now &amp; \" Timeout:\" &amp; timeout)\n\n    Do While stopclick = False\n        DoEvents\n\n        Get #COMfile, , record\n'        'MsgBox (\"record:\" &amp; Asc(record))\n'        DoEvents   'Don't lock up excel while waiting\n'            'MsgBox (\"ASCII:\" &amp; Asc(record))\n'            If record &lt;&gt; \",\" And Asc(record) &lt;&gt; 13 And Asc(record) &lt;&gt; 10 And record &lt;&gt; emptyRecord Then\n'                record_cat = record_cat &amp; record\n'            End If\n'            'MsgBox (record_cat)\n'            If Asc(record) = 13 Then\n'            'MsgBox (\"Congratulations! You found an enter successfully Dave.\")\n'                Range(\"A1\").Offset(ROWindex, COLindex).Value = Trim(record_cat)\n'                COLindex = 0\n'                record_cat = \"\"\n'                record = \"\"\n'                'ActiveCell.Offset(1, 0).Select\n'                ROWindex = ROWindex + 1\n'                timeout = Now + TimeValue(\"00:00:20\")  'if no data received in 20 sec give up\n'            ElseIf record = \",\" Then\n'                'MsgBox (\"Here is a comma.\")\n'                Range(\"A1\").Offset(ROWindex, COLindex).Value = Trim(record_cat)\n'                record_cat = \"\"\n'                COLindex = COLindex + 1\n'                timeout = Now + TimeValue(\"00:00:20\")  'if no data received in 20 sec give up\n'            End If\n        Sleep 20\n        cntr = cntr + 1\n        Range(\"A1\").Value = cntr\n        If Now &gt;= timeout Then\n            MsgBox (\"Timed out. Program ending.\")\n            Close #COMfile\n            Exit Do\n        End If\n    Loop\n    Close #COMfile\n    Debug.Print \"Finished\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539119451, "post_id": 52729293, "comment_id": 92383897, "body": "@Scott Craner the edit still causes everything to be italicized and grey, I only want the &quot;No Action&quot; values in column C to do that, everything else normal formatting"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1539119596, "post_id": 52729293, "comment_id": 92383958, "body": "I just made the code more readable by aligning the line properly.  I did not change the code in any way.  It will not change how the code works.  But one note, are you always starting with a fresh canvas, are all the text non italicized and not grey before running the code?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539119756, "post_id": 52729293, "comment_id": 92384021, "body": "@ScottCraner I have a raw data file with no formatting, and then it&#39;s transferred to a template with a header. Then after it reads the data in, I would like it to find any of the &quot;No Actions&quot; in column C, but not any other rows"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539120269, "post_id": 52729293, "comment_id": 92384201, "body": "There is not enough here for us to figure out, it should do what you want.  There must be other issues with the code that is causing the issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539120638, "post_id": 52729293, "comment_id": 92384326, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, then <a href=\"https://stackoverflow.com/posts/52729293/edit\">edit</a> your question so that it contains one. FWIW I&#39;m with @ScottCraner on the edit, all it did was causing the <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a> to be <i>consistent</i>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539120789, "post_id": 52729293, "comment_id": 92384389, "body": "I&#39;d watch for leading/trailing spaces. Try <code>If Trim(.Cells(...).Value) = &quot;No Action&quot; Then</code>"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539120894, "post_id": 52729293, "comment_id": 92384423, "body": "@MathieuGuindon I added the rest of the script"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1539120933, "post_id": 52729293, "comment_id": 92384439, "body": "so much for &quot;minimal&quot;..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1539121517, "post_id": 52729293, "comment_id": 92384652, "body": "shouldn&#39;t <code>key1:=Range(&quot;c2&quot;)</code> be <code>key1:=.Range(&quot;c2&quot;)</code> to ensure you are using the correct key?  Not sure your problem but could be another problem in the future."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1539130749, "post_id": 52729293, "comment_id": 92386917, "body": "You could also <i>debug the code yourself</i> by stepping through it line-by-line in the loop and compare expected versus actual behavoir. You&#39;ll probably solve it very easily that way :)"}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1539179504, "post_id": 52741396, "comment_id": 92408354, "body": "is autofiltering going to slow down my script?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1539179637, "post_id": 52741396, "comment_id": 92408433, "body": "@nicklanta to be completely honest I&#39;m not sure, but I would think that formatting the whole range at once instead of looping through each row would actually speed it up, but I might be wrong here...."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1539179817, "post_id": 52741396, "comment_id": 92408557, "body": "I&#39;ll try it in a few minutes, I appreciate the help!"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1539185045, "post_id": 52741396, "comment_id": 92411923, "body": "what if certain sheets don&#39;t have any &quot;No Action&quot; values, it causes an error to occur"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1539185212, "post_id": 52741396, "comment_id": 92412044, "body": "@nicklanta I thought the code was for a specific Sheet (ie. Sheet1), but I&#39;ve now updated my answer to check for the value before filtering."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1539185255, "last_edit_date": 1539185255, "creation_date": 1539178213, "answer_id": 52741396, "question_id": 52729293, "link": "https://stackoverflow.com/questions/52729293/why-is-this-if-else-not-consistent/52741396#52741396", "title": "Why is this IF/ELSE not consistent?", "body": "<p>How about the following, instead of using a For Loop, the code below will AutoFilter Column C with the value \"No Action\", then it will make Italic and colour every visible row from Column A to AB:</p>\n\n<pre><code>With WB.Worksheets(\"Sheet1\")\n    .Cells.AutoFilter 'add AutoFilter\n    .Range(\"$A$1:$AB$50\").AutoFilter Field:=3, Criteria1:=\"No Action\"\n    .Range(\"$A$2:$AB$50\").SpecialCells(xlCellTypeVisible).Font.Italic = True\n    .Range(\"$A$2:$AB$50\").SpecialCells(xlCellTypeVisible).Font.Color = 8421504\n    .Cells.AutoFilter 'remove AutoFilter\nEnd With\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>To check for the value \"No Action\" on Column C before using the AutoFilter, you could do something like below:</p>\n\n<pre><code>With WB.Worksheets(\"Sheet1\")\n    Set FoundNoAction = .Range(\"C:C\").Find(What:=\"No Action\", Lookat:=xlWhole)\n    If Not FoundNoAction Is Nothing Then\n        .Cells.AutoFilter 'add AutoFilter\n        .Range(\"$A$1:$AB$50\").AutoFilter Field:=3, Criteria1:=\"No Action\"\n        .Range(\"$A$2:$AB$50\").SpecialCells(xlCellTypeVisible).Font.Italic = True\n        .Range(\"$A$2:$AB$50\").SpecialCells(xlCellTypeVisible).Font.Color = 8421504\n        .Cells.AutoFilter 'remove AutoFilter\n    End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1539185784, "creation_date": 1539185784, "answer_id": 52743917, "question_id": 52729293, "link": "https://stackoverflow.com/questions/52729293/why-is-this-if-else-not-consistent/52743917#52743917", "title": "Why is this IF/ELSE not consistent?", "body": "<p>I\u2019ll work with .findnext like this:</p>\n\n<pre><code>With sheets(youractionsheet).Range(\u201cA2:AB\u201d &amp; sheets(youractionsheet).cells(rows.count,3).end(xlup).row)\n Set myaction = .cells.find(what:=\u201cNo Action\u201d)\n\nIf not myaction is nothing then \n Do until myaction is nothing\n myaction.font.italic = true\n myaction.font.color = 8421504\n\n Set myaction = .findnext(myaction)\n\n Loop\nEnd if\n\nEnd with \n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1593779071, "creation_date": 1539118968, "last_edit_date": 1593779071, "question_id": 52729293, "link": "https://stackoverflow.com/questions/52729293/why-is-this-if-else-not-consistent", "title": "Why is this IF/ELSE not consistent?", "body": "<p>I need to reformat rows that have the string \"No Action\" in them in column C</p>\n\n<p>I use this: </p>\n\n<pre><code>Dim ActionRow as Long\n\n\nFor ActionRow = 2 To 50\n    If .Cells(ActionRow, 3).Value = \"No Action\" Then\n        .Range(\"A\" &amp; ActionRow &amp; \":AB\" &amp; ActionRow).Font.Italic = True\n        .Range(\"A\" &amp; ActionRow &amp; \":AB\" &amp; ActionRow).Font.Color = 8421504\n    End If\nNext ActionRow\n</code></pre>\n\n<p>Instead of just targeting rows with \"No action\" in column C, it targets every row, or tracks it inconsistently. How can I tell it to only find the string \"No Action\" in column C (3) and then execute the formatting?</p>\n\n<p>Rest of Code: </p>\n\n<pre><code>Option Explicit\n\n    Sub Main()\n      Dim Wb As Workbook\n      Dim Data, Last, BU7, Lvl7\n      Dim sourcerow As Long, sourcecol As Long, destrow As Long, destcol As Long\n      Dim rngDest As Range\n      Dim ActionRow As Long\n\n\n      'Refer to the template\n      Set Wb = Workbooks(\"Book1.xlsx\")\n      'Refer to the destination cell\n      Set rngDest = Wb.Sheets(\"Sheet1\").Range(\"A2\")\n      'Read in all data\n      With ThisWorkbook.Sheets(\"Data_\")\n        Data = .Range(\"Ab2\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n      End With\n      Wb.Activate\n      Application.ScreenUpdating = False\n\n      'Process the data\n      For sourcerow = 1 To UBound(Data, 1)\n        'Manager changes?\n        If Data(sourcerow, 15) &lt;&gt; Last Then\n          'Skip the first\n          If sourcerow &gt; 1 Then\n\n            'Scroll into the view\n            rngDest.Select\n            'Save a copy\n            Wb.SaveCopyAs ThisWorkbook.Path &amp; Application.PathSeparator &amp; _\n              ValidFileName(\"10.08.18\" &amp; \" - \" &amp; BU7 &amp; \" - \" &amp; Lvl7 &amp; \" - \" &amp; Last &amp; \".xlsx\")\n          End If\n          'Clear the employees\n\n          ActiveSheet.Range(\"A2:AB\" &amp; ActiveSheet.Columns.Count + 1).ClearContents\n          'Remember this manager\n\n          Last = Data(sourcerow, 15)\n          BU7 = Data(sourcerow, 18)\n          Lvl7 = Data(sourcerow, 25)\n\n          'Start the next round\n          destcol = 0\n        End If\n        'Write the employee data into the template\n            destrow = 0\n            For sourcecol = 1 To UBound(Data, 2)\n                If sourcecol = 1 Then\n                rngDest.Offset(destcol, destrow) = CStr(Format(Data(sourcerow, sourcecol), \"000000000\"))\n                    Else\n                    rngDest.Offset(destcol, destrow) = Data(sourcerow, sourcecol)\n                End If\n\n                    destrow = destrow + 1\n            Next\n\n        'Next column\n        destcol = destcol + 1\n\n        Next\n                With Wb.Worksheets(\"Sheet1\")\n\n                    For ActionRow = 2 To 50\n                            If .Cells(ActionRow, 3).Value = \"No Action\" Then\n                                .Range(\"A\" &amp; ActionRow &amp; \":AB\" &amp; ActionRow).Font.Italic = True\n                                .Range(\"A\" &amp; ActionRow &amp; \":AB\" &amp; ActionRow).Font.Color = 8421504\n                            End If\n                    Next ActionRow\n\n                .Columns(\"A:ab\").Sort key1:=Range(\"c2\"), _\n                order1:=xlAscending, Header:=xlYes\n\n        .Columns(\"A:A\").NumberFormat = \"000000000\"\n\n\n      End With\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1539119100, "post_id": 52729290, "comment_id": 92383761, "body": "Can you share what you have tried and which part your having trouble with?"}, {"owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1539120504, "post_id": 52729290, "comment_id": 92384273, "body": "I just added it to my question!"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1539143774, "post_id": 52729290, "comment_id": 92389715, "body": "That&#39;s very verbose code that should be providing some indication of what&#39;s going on and the best you can describe is &quot;can&#39;t seem to get this right&quot;.... Please explain the problem."}, {"owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539182582, "post_id": 52729290, "comment_id": 92410305, "body": "The problem is that when I run it, it returns the error message as written at the bottom of the code under &quot;GetAttachments_err&quot; and I don&#39;t know why"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539199565, "post_id": 52729290, "comment_id": 92419412, "body": "What following information do you see when you get the dialog box with &quot;Please note and report the following information.&quot;? Edit the post with the response. Do not answer in the comments."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539177521, "post_id": 52732657, "comment_id": 92407092, "body": "Thanks for your answer! I made the changes to sender name, attachment name, and save-to folder, but when I try to run it, it says &quot;Object doesn&#39;t support this property or method&quot; and highlights the line of code right under &#39;Get the inbox"}, {"owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539177743, "post_id": 52732657, "comment_id": 92407238, "body": "I&#39;ve been having this kind of problem with a lot of the codes I&#39;ve been using to try to accomplish this and I&#39;m not sure how to fix it"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539181524, "post_id": 52732657, "comment_id": 92409640, "body": "Your original code was written for Outlook, and meant to be run from Outlook.  Hence my code was written for Outlook as well.  If you&#39;re running it from Excel, you&#39;ll get that error.  Are you running it from Excel?"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539181763, "post_id": 52732657, "comment_id": 92409789, "body": "If you want the code to run from Excel, it will need to be re-written.  Do you want to run it from Excel?"}, {"owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539182658, "post_id": 52732657, "comment_id": 92410355, "body": "Yes, I want it to run from Excel. I&#39;m writing in the Visual Basic Studio on Excel 2013"}, {"owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "edited": false, "score": 0, "creation_date": 1539196051, "post_id": 52732657, "comment_id": 92417780, "body": "Thanks so much that worked! I guess my problem the whole time was what you said about the code being written to be executed in Outlook. That was awesome"}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 0, "last_activity_date": 1539188002, "last_edit_date": 1539188002, "creation_date": 1539145851, "answer_id": 52732657, "question_id": 52729290, "link": "https://stackoverflow.com/questions/52729290/download-an-excel-file-from-the-latest-email-in-outlook-inbox-using-excel-vba/52732657#52732657", "title": "Download an Excel file from the latest email in Outlook inbox using Excel VBA", "body": "<p><strong><em>Edit</em></strong>  <em>The macro has been edited to run from Excel, instead of Outlook.  It uses early binding, so you'll need to set a reference to Outlook's object library (VBE >> Tools >> References >> and select Microsoft Outlook Object Library).</em></p>\n\n<p>The following macro first filters the items from the inbox based on the specified sender name, then sorts them by received time and in descending order, and then gets the first item from the filtered and sorted list.  Lastly, it saves the specified attachement, if it exists.  Note that if a file with the same name as the attachment already exists, the existing file will be over-written.  Change the save to folder, sender name, and attachment name, where indicated.</p>\n\n<pre><code>Option Explicit\n\nSub GetLatestReport()\n\n    'Set a reference to Outlook's object library (Visual Basic &gt;&gt; Tools &gt;&gt; References &gt;&gt; check/select Microsoft Outlook Object Library)\n\n    Dim outlookApp              As Outlook.Application\n    Dim outlookInbox            As Outlook.MAPIFolder\n    Dim outlookRestrictItems    As Outlook.Items\n    Dim outlookLatestItem       As Outlook.MailItem\n    Dim outlookAttachment       As Outlook.Attachment\n    Dim attachmentFound         As Boolean\n\n    Const saveToFolder          As String = \"C:\\Users\\Domenic\\Desktop\" 'change the save to folder accordingly\n    Const senderName            As String = \"SenderName\" 'change the sender name accordingly\n    Const attachmentName        As String = \"AttachmentName\" 'change the attachment name accordingly\n\n    'Create an instance of Outlook\n    Set outlookApp = New Outlook.Application\n\n    'Get the inbox from Outlook\n    Set outlookInbox = outlookApp.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)\n\n    'Filter the items from the inbox based on the sender\n    Set outlookRestrictItems = outlookInbox.Items.Restrict(\"[SenderName] = '\" &amp; senderName &amp; \"'\")\n\n    'Check whether any items were found\n    If outlookRestrictItems.Count = 0 Then\n        MsgBox \"No items were found from \" &amp; senderName &amp; \"!\", vbExclamation\n        Exit Sub\n    End If\n\n    'Sort the filtered items by received time and in descending order\n    outlookRestrictItems.Sort Property:=\"[ReceivedTime]\", Descending:=True\n\n    'Get the latest item from the filtered and sorted items\n    Set outlookLatestItem = outlookRestrictItems(1)\n\n    'Loop through each attachment from the latest item until specified file is found\n    attachmentFound = False\n    For Each outlookAttachment In outlookLatestItem.Attachments\n        If Left(UCase(outlookAttachment.Filename), Len(attachmentName)) = UCase(attachmentName) Then\n            outlookAttachment.SaveAsFile saveToFolder &amp; \"\\\" &amp; outlookAttachment.DisplayName\n            attachmentFound = True\n            Exit For\n        End If\n    Next outlookAttachment\n\n    If attachmentFound Then\n        MsgBox \"The attachment was found and saved to '\" &amp; saveToFolder &amp; \"'!\", vbInformation\n    Else\n        MsgBox \"No attachment was found!\", vbExclamation\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10480824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319cc7ddbd71153f13193f545669c87a?s=128&d=identicon&r=PG&f=1", "display_name": "learningtocode123", "link": "https://stackoverflow.com/users/10480824/learningtocode123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 52732657, "answer_count": 1, "score": 1, "last_activity_date": 1592900951, "creation_date": 1539118955, "last_edit_date": 1592900951, "question_id": 52729290, "link": "https://stackoverflow.com/questions/52729290/download-an-excel-file-from-the-latest-email-in-outlook-inbox-using-excel-vba", "title": "Download an Excel file from the latest email in Outlook inbox using Excel VBA", "body": "<p>I receive a report once a week in the form of an Excel attachment (.xlsm). I need to access the latest email then download the Excel attachment within and save it to a specific path on my desktop.</p>\n\n<p>The mailbox is called \"ACBS MIS Reports\" and the attachment is always called \"Report on ACBS LC for AMLS - Month DD\". It will always be the latest email (at top of mailbox) that I'm interested in.</p>\n\n<p>This code returns the error message as written at the bottom of the code under \"GetAttachments_err\".</p>\n\n<pre><code>Sub GetAttachments()\n' This Outlook macro checks a the Outlook Inbox for messages\n' with attached files (of any type) and saves them to disk.\n' NOTE: make sure the specified save folder exists before\n' running the macro.\n\nOn Error GoTo GetAttachments_err\n\n'Declare Variables\n\nDim ns As Namespace\nDim Inbox As MAPIFolder\nDim Item As Object\nDim Atmt As Attachment\nDim FileName As String\nDim i As Integer\nSet ns = GetNamespace(\"MAPI\")\nSet Inbox = ns.GetDefaultFolder(olFolderInbox)\ni = 0\n\n'Check Inbox for messages and exit if none found\n\nIf Inbox.Items.Count = 0 Then\n    MsgBox \"There are no messages in the Inbox.\", vbInformation, _\n           \"Nothing Found\"\n    Exit Sub\nEnd If\n\n' Check each message for attachments\n\nFor Each Item In Inbox.Items\n'Save any attachments found\n    For Each Atmt In Item.Attachments\n    ' This path must exist! Change folder name as necessary.\n        FileName = \"C:\\Users\\jalanger\\Desktop\\Letters of Credit\\Macro Work\\Test\" &amp; Atmt.DisplayName\n        Atmt.SaveAsFile FileName\n        i = i + 1\n     Next Atmt\nNext Item\n\n' Show summary message\nIf i &gt; 0 Then\n    MsgBox \"I found \" &amp; i &amp; \" attached files.\" _\n    &amp; vbCrLf &amp; \"I have saved them into the C:\\Email Attachments folder.\" _\n    &amp; vbCrLf &amp; vbCrLf &amp; \"Have a nice day.\", vbInformation, \"Finished!\"\nElse\n    MsgBox \"I didn't find any attached files in your mail.\", vbInformation, \"Finished!\"\nEnd If\n'Clear memory\nGetAttachments_exit:\nSet Atmt = Nothing\nSet Item = Nothing\nSet ns = Nothing\nExit Sub\n\n'Handle errors\nGetAttachments_err:\nMsgBox \"An unexpected error has occurred.\" _\n    &amp; vbCrLf &amp; \"Please note and report the following information.\" _\n    &amp; vbCrLf &amp; \"Macro Name: GetAttachments\" _\n    &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n    &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n    , vbCritical, \"Error!\"\nResume GetAttachments_exit\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ado"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539123935, "post_id": 52729205, "comment_id": 92385416, "body": "How long does it take, and how long do you expect it to take?"}, {"owner": {"reputation": 5, "user_id": 625226, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a6041c612a69ffdd1137c7b168329ee?s=128&d=identicon&r=PG", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/625226/gonzalez"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539176720, "post_id": 52729205, "comment_id": 92406574, "body": "It takes about 10 seconds, under 3 would be efficient."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 625226, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a6041c612a69ffdd1137c7b168329ee?s=128&d=identicon&r=PG", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/625226/gonzalez"}, "edited": false, "score": 1, "creation_date": 1539120936, "post_id": 52729314, "comment_id": 92384440, "body": ".Thank you. Not making any difference. Only the file size changed."}, {"owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "reply_to_user": {"reputation": 5, "user_id": 625226, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a6041c612a69ffdd1137c7b168329ee?s=128&d=identicon&r=PG", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/625226/gonzalez"}, "edited": false, "score": 0, "creation_date": 1539121153, "post_id": 52729314, "comment_id": 92384513, "body": "Another thing, see answer here about data types, headings and casting - <a href=\"https://stackoverflow.com/questions/3232281/oledb-mixed-excel-datatypes-missing-data/\" title=\"oledb mixed excel datatypes missing data\">stackoverflow.com/questions/3232281/&hellip;</a>"}, {"owner": {"reputation": 5, "user_id": 625226, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a6041c612a69ffdd1137c7b168329ee?s=128&d=identicon&r=PG", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/625226/gonzalez"}, "edited": false, "score": 1, "creation_date": 1539180666, "post_id": 52729314, "comment_id": 92409090, "body": "No difference either"}], "tags": [], "owner": {"reputation": 2917, "user_id": 187519, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nzv7O.jpg?s=128&g=1", "display_name": "Hassan Voyeau", "link": "https://stackoverflow.com/users/187519/hassan-voyeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1539119050, "creation_date": 1539119050, "answer_id": 52729314, "question_id": 52729205, "link": "https://stackoverflow.com/questions/52729205/speed-up-query-from-table-using-ado-and-sql/52729314#52729314", "title": "Speed up query from table using ADO and SQL", "body": "<p>Consider using .xlsb copy of the file.</p>\n"}], "owner": {"reputation": 5, "user_id": 625226, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a6041c612a69ffdd1137c7b168329ee?s=128&d=identicon&r=PG", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/625226/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593779095, "creation_date": 1539118514, "last_edit_date": 1593779095, "question_id": 52729205, "link": "https://stackoverflow.com/questions/52729205/speed-up-query-from-table-using-ado-and-sql", "title": "Speed up query from table using ADO and SQL", "body": "<p>I have an Excel macro that reads data from another file using ADO and SQL. \nIt runs fine but it takes too long</p>\n\n<p>Here is the part of the code that connects to the other file.</p>\n\n<pre><code>With conn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .Mode = adModeRead\n    .CursorLocation = adUseClient\n    .Properties(\"Data Source\") = \"W:\\Store.xlsm\"\n    .Properties(\"Extended Properties\") = \"Excel 12.0 Macro;HDR=Yes;IMEX=1\"\n    .Open OpenForwardOnly, LockReadOnly, CmdText\nEnd With\n\nSet rs = conn.Execute(\"SELECT `main$`.`\" &amp; MasterField &amp; \"`  FROM `main$` `main$` WHERE `main$`.Num= '\" &amp; Hyperion &amp; \"'\")\n\nMaster = rs.Fields(0).Value\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel-2013"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539120919, "post_id": 52729201, "comment_id": 92384436, "body": "Instead of all the AND statements to check if nothing is one, you could just as well check if the sum of all 4 is smaller then 1."}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1539121121, "post_id": 52729591, "comment_id": 92384501, "body": "Thank you very much!  I still have a lot to learn in VBA, but y&#39;all help my knowledge increase significantly.  Thank you again."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1539121157, "post_id": 52729591, "comment_id": 92384515, "body": "Not a problem, we all started somewhere :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1539120553, "creation_date": 1539120553, "answer_id": 52729591, "question_id": 52729201, "link": "https://stackoverflow.com/questions/52729201/nested-if-possible-better-solution/52729591#52729591", "title": "Nested If - Possible better solution?", "body": "<p>Firstly, they don't need to be nested because they all have conflicting logic and will never \"cascade\" down like a nested <code>If</code> is intended to do.</p>\n\n<pre><code>If f &lt;&gt; 1 And g &lt;&gt; 1 And h &lt;&gt; 1 And i &lt;&gt; 1 Then '// If this is true\n    '...\n    If f = 1 And g &lt;&gt; 1 And h &lt;&gt; 1 And i &lt;&gt; 1 Then '// Then this can never be true\n</code></pre>\n\n<p>If you were going to keep this design then it should really be <code>If...ElseIf...</code> logic in place.</p>\n\n<hr>\n\n<p>Secondly, you have a lot of common logic so something like this should work because you don't have to repeat the same outcome for every condition:</p>\n\n<pre><code>Dim caption As String\n\ncaption = \"Lender items \" &amp; IIf(wsCalc.Range(\"LenderComplete\").Value &lt;&gt; vbNullString, \"COMPLETE\", \"NOT complete\") &amp; vbNewLine &amp; _\n          \"Processor items \" &amp; IIf(wsCalc.Range(\"ProcessorComplete\").Value &lt;&gt; vbNullString, \"COMPLETE\", \"NOT complete\") &amp; vbNewLine &amp; _\n          \"Keyer items \" &amp; IIf(wsCalc.Range(\"KeyerComplete\").Value &lt;&gt; vbNullString, \"COMPLETE\", \"NOT complete\") &amp; vbNewLine &amp; _\n          \"Checker items \" &amp; IIf(wsCalc.Range(\"CheckerComplete\").Value &lt;&gt; vbNullString, \"COMPLETE\", \"NOT complete\")\n\n\nWith ContLoanFile\n    .ContinueLP.BackColor = vbYellow\n    With .Label7\n        .Caption = caption\n        .Font.Size = 9\n    End With\nEnd With\n</code></pre>\n\n<p>No need for a loop and no need to test the same values multiple times.</p>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52729591, "answer_count": 1, "score": 1, "last_activity_date": 1539120553, "creation_date": 1539118503, "question_id": 52729201, "link": "https://stackoverflow.com/questions/52729201/nested-if-possible-better-solution", "title": "Nested If - Possible better solution?", "body": "<p>I am hoping to get some advice on a better solution to a massive nested <code>If</code> statement in VBA.  Becasue of the amount of conditions that would be possible the <code>If</code> statement is becoming extremely large.  I was thinking of using a <code>For</code> loop, but that seems like it would still require a significant amount of <code>If</code> conditions, and I also thought of a <code>Select Case</code>, but that doesnt really work either.</p>\n\n<p>The code below shows how I have the variables set for the <code>If</code> statements and most of the conditions.  Any help in streamlining this code would be greatly appreciated.</p>\n\n<pre><code>    If wsCalc.Range(\"LenderComplete\") &lt;&gt; vbNullString Then f = 1\nIf wsCalc.Range(\"ProcessorComplete\") &lt;&gt; vbNullString Then g = 1\nIf wsCalc.Range(\"KeyerComplete\") &lt;&gt; vbNullString Then h = 1\nIf wsCalc.Range(\"CheckerComplete\") &lt;&gt; vbNullString Then i = 1\n\nIf f &lt;&gt; 1 And g &lt;&gt; 1 And h &lt;&gt; 1 And i &lt;&gt; 1 Then\n    ContLoanFile.ContinueLP.BackColor = vbYellow\n    With ContLoanFile.Label7\n        .Caption = \"Lender items NOT complete.\" &amp; vbNewLine &amp; \"Processor items NOT complete.\" &amp; vbNewLine &amp; \"Keyer items NOT complete.\" &amp; vbNewLine &amp; \"Checker items NOT complete.\"\n        .Font.Size = 9\n    End With\n    If f = 1 And g &lt;&gt; 1 And h &lt;&gt; 1 And i &lt;&gt; 1 Then\n        ContLoanFile.ContinueLP.BackColor = vbYellow\n        With ContLoanFile.Label7\n            .Caption = \"Lender items COMPLETE.\" &amp; vbNewLine &amp; \"Processor items COMPLETE.\" &amp; vbNewLine &amp; \"Keyer items NOT complete.\" &amp; vbNewLine &amp; \"Checker items NOT complete.\"\n            .Font.Size = 9\n        End With\n        If f = 1 And g = 1 And h &lt;&gt; 1 And i &lt;&gt; 1 Then\n            ContLoanFile.ContinueLP.BackColor = vbYellow\n            With ContLoanFile.Label7\n                .Caption = \"Lender items COMPLETE.\" &amp; vbNewLine &amp; \"Processor items COMPLETE.\" &amp; vbNewLine &amp; \"Keyer items NOT complete.\" &amp; vbNewLine &amp; \"Checker items NOT complete.\"\n                .Font.Size = 9\n            End With\n            If f = 1 And g = 1 And h = 1 And i &lt;&gt; 1 Then\n                ContLoanFile.ContinueLP.BackColor = vbYellow\n                With ContLoanFile.Label7\n                    .Caption = \"Lender items COMPLETE.\" &amp; vbNewLine &amp; \"Processor items COMPLETE.\" &amp; vbNewLine &amp; \"Keyer items COMPLETE.\" &amp; vbNewLine &amp; \"Checker items NOT complete.\"\n                    .Font.Size = 9\n                End With\n                If f = 1 And g = 1 And h = 1 And i = 1 Then\n                    ContLoanFile.ContinueLP.BackColor = vbYellow\n                    With ContLoanFile.Label7\n                        .Caption = \"Lender items COMPLETE.\" &amp; vbNewLine &amp; \"Processor items COMPLETE.\" &amp; vbNewLine &amp; \"Keyer items COMPLETE.\" &amp; vbNewLine &amp; \"Checker items COMPLETE.\"\n                        .Font.Size = 9\n                    End With\n                    If f &lt;&gt; 1 And g = 1 And h = 1 And i = 1 Then\n                        ContLoanFile.ContinueLP.BackColor = vbYellow\n                        With ContLoanFile.Label7\n                            .Caption = \"Lender items NOT complete.\" &amp; vbNewLine &amp; \"Processor items COMPLETE.\" &amp; vbNewLine &amp; \"Keyer items COMPLETE.\" &amp; vbNewLine &amp; \"Checker items COMPLETE.\"\n                            .Font.Size = 9\n                        End With\n                        If f = 1 And g &lt;&gt; 1 And h = 1 And i = 1 Then\n                            ContLoanFile.ContinueLP.BackColor = vbYellow\n                            With ContLoanFile.Label7\n                                .Caption = \"Lender items COMPLETE.\" &amp; vbNewLine &amp; \"Processor items NOT complete.\" &amp; vbNewLine &amp; \"Keyer items COMPLETE.\" &amp; vbNewLine &amp; \"Checker items COMPLETE.\"\n                                .Font.Size = 9\n                            End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1539120198, "creation_date": 1539120198, "answer_id": 52729533, "question_id": 52729050, "link": "https://stackoverflow.com/questions/52729050/proper-method-for-making-changes-to-a-protected-spreadsheet-from-vba/52729533#52729533", "title": "Proper method for making changes to a protected spreadsheet from VBA", "body": "<blockquote>\n  <p><em>Is it not enough to unprotect the sheet at the beginning of a method that calls other methods that make changes to the sheet and reportected it at the end?</em></p>\n</blockquote>\n\n<p>This is why global state is such a pain in the neck. As far as your VBA project is concerned, sheet protection state is global. So if you do:</p>\n\n<pre><code>Public Sub Procedure1()\n    Sheet1.Unprotect PWD\n    Procedure2\n    'do stuff on Sheet1\n    Sheet1.Protect PWD\nEnd Sub\n</code></pre>\n\n<p>If <code>Procedure2</code> re-protects <code>Sheet1</code> before it exits, then <code>Sheet1</code> is protected again when <code>Procedure1</code> resumes to <code>do stuff on Sheet1</code>, and as you're experiencing, it doesn't like it much.</p>\n\n<p>So yes, you need to be sure that the sheet isn't protected before you try to modify it.</p>\n\n<blockquote>\n  <p><em>or do I literally have to prefix and postfix [...] around EVERY single line that changes the sheet data?</em></p>\n</blockquote>\n\n<p>You don't. I mean, you <em>do</em>, but you don't, <em>if you manage your global state in a sane way</em>. If anyone anywhere at any time can go in and re-protect the sheet you just unprotected, your <em>swear jar</em> can fill up rather quickly.</p>\n\n<p>Similarly, <code>Application.Calculation</code> is global; yet if anyone anywhere can set it back to <code>xlCalculationAutomatic</code> after you carefully made it <code>xlCalculationManual</code> in an effort to \"improve performance\" (same goes for <code>Application.ScreenUpdating</code>), then you'll ultimately find yourself triggering recalculations <em>and introduce very noticeable lags instead</em>.</p>\n\n<p>Global state is nice (hey I can access it from anywhere!), but also double-edged. If you don't structure things properly, global state quickly <em>spagghettifies</em> and becomes a tangled mess of inefficient back-and-forth toggles that you don't need, or want.</p>\n\n<p>The solution is to set yourself up for success, and <em>layer</em> your code properly. Have all the sheet-protection-toggling code in one place, and constrain yourself to only ever invoke that logic from one single layer - everything underneath isn't concerned with sheet protection, it's none of its business. If the sheet it means to work with is protected, then <strong>it's not its problem</strong> - code in the upper layer has a bug.</p>\n\n<p>In the above example, <code>Procedure2</code> would be layer 2, and it <strong>shouldn't be allowed to toggle sheet protection at all</strong>. Let <code>Procedure1</code> be responsible for that, and move the <code>do stuff on Sheet1</code> part to some new <code>Procedure3</code>, that 's just as carelessly assuming sheet protection is already handled.</p>\n\n<p>You can even encapsulate the toggling in a class, e.g. <code>Sheet1Protection</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Class_Initialize()\n    Sheet1.Unprotect PWD\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Sheet1.Protect PWD\nEnd Sub\n</code></pre>\n\n<p>And now you can do this:</p>\n\n<pre><code>Public Sub Procedure1\n    With New Sheet1Protection 'unprotects sheet1\n        Procedure2\n        Procedure3\n    End With ' object terminates, sheet1 is protected again\nEnd Sub\n</code></pre>\n\n<p>Notice that sheet protection is being toggled at the very last minute, when it's needed, and wraps all operations that need to run with the unprotected sheet.</p>\n\n<p>With tooling such as <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (an OSS add-in project for the VBE, which I manage &amp; contribute to) you can easily locate all the places where sheet protection is being toggled outside of <code>Sheet1Protection</code>, and remove them.</p>\n"}], "owner": {"reputation": 563, "user_id": 466139, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8327f8b24dafaf30cc4d478d0b227977?s=128&d=identicon&r=PG", "display_name": "TofuBug", "link": "https://stackoverflow.com/users/466139/tofubug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539120198, "creation_date": 1539117893, "question_id": 52729050, "link": "https://stackoverflow.com/questions/52729050/proper-method-for-making-changes-to-a-protected-spreadsheet-from-vba", "title": "Proper method for making changes to a protected spreadsheet from VBA", "body": "<p>Trying to work with a protected workbook (i have access to the password) with a VBA project (1 UserForm, 5 Class Modules, 1 Standard Module) </p>\n\n<p>I'm really confused about how to properly work with protected sheets in VBA.</p>\n\n<p>I've tried doing an </p>\n\n<pre><code>ActiveSheet.Unprotect PWD\n</code></pre>\n\n<p>followed after a method call with </p>\n\n<pre><code>ActiveSheet.protect PWD\n</code></pre>\n\n<p>Also tried </p>\n\n<pre><code>ActiveSheet.protect PWD, UserInterfaceOnly:=True\n</code></pre>\n\n<p>from the Workbook_open sub</p>\n\n<p>The issues is at random points its like the protection reverts to being protected and the parts of my VBA project that are making changes to the actual spreadsheet freak out. </p>\n\n<p>If i pause the debugger go over and manually unprotect the sheet and hit continue things go off without a hitch</p>\n\n<p>So what's going on here</p>\n\n<p>Is it not enough to unprotect the sheet at the beginning of a method that calls other methods that make changes to the sheet and reportected it at the end?</p>\n\n<p>or do I literally have to prefix and postfix </p>\n\n<pre><code>ActiveSheet.Unprotect PWD\nActiveSheet.Protect PWD\n</code></pre>\n\n<p>around EVERY single line that changes the sheet data?</p>\n\n<p>Because it seems like the protection cares nothing about anything my VBA project does internally ONLY when I try to do subsequent things with the worksheet</p>\n\n<p>I can post code later today when I get home if its needed</p>\n"}, {"tags": ["excel", "vba", "rpc"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1539118421, "post_id": 52729020, "comment_id": 92383452, "body": "Sometimes VBA code gets corrupted if Excel crashes (even if the issue wasn&#39;t with the code). In my experience, the best fix is to save all the coding (copy&amp;past to a text file is preferred over exporting and importing), save the file(s) with the code as XLSX, <b>close</b>, reopen, then reinsert the code. If it&#39;s the code from the XLAM file (add-in, right?), you may just have to recreate the XLAM."}, {"owner": {"reputation": 1, "user_id": 10270121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4ce5ae4e26517cb17a9890390bed0d?s=128&d=identicon&r=PG&f=1", "display_name": "Drusch", "link": "https://stackoverflow.com/users/10270121/drusch"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1539124764, "post_id": 52729020, "comment_id": 92385579, "body": "Thanks for the response Mistella, I tried your method and I still couldn&#39;t seem to get it to work, but I&#39;m going to try it once more just in case I messed up a step.In addition, I noticed that the code works if I edit any of the VBA at all.  So if I run the scripts, it won&#39;t work, but if after the first attempt I change the code in any way, either in the add in or in the file that references the add in, it works, or if I re-load the add in.  Again thanks so much for your response."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1539144665, "post_id": 52729020, "comment_id": 92389927, "body": "What if you change &quot;Is Addin&quot; in the project properties to false, save the XLSM, then change the property to true and re-save as XLAM?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1539177642, "post_id": 52729020, "comment_id": 92407175, "body": "@Drusch Make sure you close the workbook after saving as &quot;.xlsx&quot;. Otherwise it can retain some of the old compiled code, which can cause the issue to be carried into the new version. Same with exporting/importing modules instead of copy&amp;pasting the text - the issue may be carried along. Also, make sure that the code is doing proper &quot;cleanup&quot; (any variable requiring &quot;set&quot; should be set to  either nothing or empty as appropriate at the end of the code, clear/empty/unassign arrays, close out any applications) If too many no-longer-need objects are left floating around, they can also cause issues."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1539177828, "post_id": 52729020, "comment_id": 92407276, "body": "Also, just remembered, sometimes the issue seemed to stay if I overwrote the old file with the new file. If you&#39;re keeping the same name, rename/resave the old file, so the new file isn&#39;t overwriting anything."}, {"owner": {"reputation": 1, "user_id": 10270121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4ce5ae4e26517cb17a9890390bed0d?s=128&d=identicon&r=PG&f=1", "display_name": "Drusch", "link": "https://stackoverflow.com/users/10270121/drusch"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1539372607, "post_id": 52729020, "comment_id": 92493261, "body": "Thanks a lot @Mistella, I really appreciate the help and your time.  Also I&#39;m sorry for the delayed response, there was a big industry-wide issue in my field the last couple days and I was distracted from my issue.  I did everything you mentioned but none of it worked!  Luckily I bugged enough people around my company and got a fix.  Someone had a similar issue a few weeks ago and a developer had a fix.  You may know better than me what this is, but I edited the Excel registry with:  \u201cForceVBALoadFromSource\u201d=dword:00000001  Again thank you so much, I appreciate your help, it means a lot."}], "owner": {"reputation": 1, "user_id": 10270121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4ce5ae4e26517cb17a9890390bed0d?s=128&d=identicon&r=PG&f=1", "display_name": "Drusch", "link": "https://stackoverflow.com/users/10270121/drusch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593837429, "creation_date": 1539117745, "last_edit_date": 1593837429, "question_id": 52729020, "link": "https://stackoverflow.com/questions/52729020/excel-crashes-when-accessing-xlam-file", "title": "Excel Crashes When Accessing .xlam File", "body": "<p>I use an XLAM file to store a few subs for general spreadsheet purposes.  The XLAM is added and checked in the VBA editor's references and has worked for 4+ months without any issues.  Most of the functions are pretty basic, like creating PDF's or refreshing connections in whatever spreadsheet calls the subs that reside in the XLAM file.</p>\n\n<p>A few days ago, none of my morning processes ran, and when I checked what happened I had 10 \"recovered\" files which, when I went to check repairs, Excel said there was nothing wrong with them.  I tried to step through the subs to see where they failed, but each one crashed without an error message from VBA, they just failed completely.  I tried running the macros through a vbs file called from Powershell and I received the message \"The remote procedure call failed\" on the line which called the macro.</p>\n\n<p>I did not change any code in any of my workbooks or in the XLAM file, nor did I change the references to the XLAM in any way.  In addition, the code consistently works on my co-worker's machines.</p>\n\n<p>I've been calling the functions from the XLAM file as follows:</p>\n\n<pre><code>Call Project.Module.Function/Sub(argument)\n</code></pre>\n\n<p>Maybe it is an issue with the RPC but I really do not know, any help would be greatly appreciated, and I'm happy to post more code.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1539117973, "creation_date": 1539117973, "answer_id": 52729068, "question_id": 52728764, "link": "https://stackoverflow.com/questions/52728764/referencing-a-field-from-a-query-in-docmd-openreport-wherecondition-argument/52729068#52729068", "title": "Referencing a field from a query in DoCmd.OpenReport Wherecondition argument", "body": "<p>Cannot reference tables or queries directly like that. Use DLookup(). Or refer to control on form. Must concatenate variable to literal string, don't forget quote marks: </p>\n\n<p><code>DoCmd.OpenReport \"rptName\", , , \"CategoryID = \" &amp; Me.CategoryID</code></p>\n"}, {"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1539147509, "creation_date": 1539147509, "answer_id": 52732884, "question_id": 52728764, "link": "https://stackoverflow.com/questions/52728764/referencing-a-field-from-a-query-in-docmd-openreport-wherecondition-argument/52732884#52732884", "title": "Referencing a field from a query in DoCmd.OpenReport Wherecondition argument", "body": "<p>If the <code>CategoryID</code> is in a active form and a string you can use:</p>\n\n<pre><code>Docmd.OpenReport \"rptName\", , , \"CategoryID = '\" &amp; Me.CategoryID &amp; \"'\"\n</code></pre>\n\n<p>If the <code>CategoryID</code> is in a active form and a integer/double you can use:</p>\n\n<pre><code>Docmd.OpenReport \"rptName\", , , \"CategoryID = \" &amp; Me.CategoryID\n</code></pre>\n\n<p>If the <code>CategoryID</code> is in the mainform but the subform is active you can use:</p>\n\n<pre><code>Docmd.OpenReport \"rptName\", , , \"CategoryID = \" &amp; Me.Parent.CategoryID\n</code></pre>\n\n<p>And you always can use a total reference:</p>\n\n<pre><code>Docmd.OpenReport \"rptName\", , , \"CategoryID = \" &amp; Forms!YourForm!CategoryID\n</code></pre>\n\n<p>You can look <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">here</a> for further informations:</p>\n"}], "owner": {"reputation": 166, "user_id": 9726689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LQe-sp1mGnk/AAAAAAAAAAI/AAAAAAAAAJI/DTrlNKZfF38/photo.jpg?sz=128", "display_name": "Elizabeth Ham", "link": "https://stackoverflow.com/users/9726689/elizabeth-ham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539147509, "creation_date": 1539116483, "last_edit_date": 1592644375, "question_id": 52728764, "link": "https://stackoverflow.com/questions/52728764/referencing-a-field-from-a-query-in-docmd-openreport-wherecondition-argument", "title": "Referencing a field from a query in DoCmd.OpenReport Wherecondition argument", "body": "<p>I have a command button to open a report with a filter applied by a query. This is so that I can filter the report by the value of a field in a subreport of the parent report, otherwise the filter criteria would be more straightforward.\nI have set my <code>Wherecondition</code> as follows:</p>\n<pre><code>Private Sub CmdOpenReport_Click()\n    DoCmd.OpenReport &quot;rptName&quot;, , , CategoryID = [Queries].[qryFltrRptByCat]!CategoryID\nEnd Sub\n</code></pre>\n<p>When I click the button, I get the following error message:</p>\n<blockquote>\n<p>Run-time error '2465'</p>\n<p>Microsoft Access can't find the field referred to in your expression.</p>\n</blockquote>\n<p>What is the proper syntax to refer to the field in the query?</p>\n<p>The query looks for a value in the subform and finds the matching <code>CategoryID</code> for the subform value. This is because the data in the subform has a many-to-one relationship with the <code>CategoryID</code> in the parent form.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "concatenation", "formula"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1539114384, "creation_date": 1539114384, "answer_id": 52728298, "question_id": 52728283, "link": "https://stackoverflow.com/questions/52728283/if-then-concatenate-when-condition-is-met/52728298#52728298", "title": "If Then, concatenate when condition is met", "body": "<p>Assuming there are <em>only</em> New and Used, this can go in <code>B1</code> and drag down.</p>\n\n<pre><code>=IF(C1=\"New\",\"N\"&amp;A1,\"U\"&amp;A1)\n</code></pre>\n\n<p>If there are other options, then you can use this one:</p>\n\n<pre><code>=IF(C1=\"New\",\"N\"&amp;A1,IF(C1=\"Used\",\"U\"&amp;A1,\"\"),\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1539115337, "post_id": 52728451, "comment_id": 92382177, "body": "I assume <code>LEFT()</code> just defaults to the first character? Didn&#39;t realize that.  Clever answer! This would also be more easily scalable than my answer, if there are other words to add."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1539115066, "creation_date": 1539115066, "answer_id": 52728451, "question_id": 52728283, "link": "https://stackoverflow.com/questions/52728283/if-then-concatenate-when-condition-is-met/52728451#52728451", "title": "If Then, concatenate when condition is met", "body": "<p>Alternate:</p>\n\n<pre><code>=IF(OR(C1={\"New\",\"Used\"}),LEFT(C1)&amp;A1,\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 417, "user_id": 10317193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gKR4S.jpg?s=128&g=1", "display_name": "jeranon", "link": "https://stackoverflow.com/users/10317193/jeranon"}, "edited": false, "score": 0, "creation_date": 1539127820, "post_id": 52728758, "comment_id": 92386225, "body": "This is definitely the best for simplicity. If you want to have it returned blank if either contributing field is blank, I would try this: <code>=IF(OR(C1=&quot;&quot;,A1=&quot;&quot;),&quot;&quot;,LEFT(C1)&amp;A1)</code>"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 417, "user_id": 10317193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gKR4S.jpg?s=128&g=1", "display_name": "jeranon", "link": "https://stackoverflow.com/users/10317193/jeranon"}, "edited": false, "score": 0, "creation_date": 1539136403, "post_id": 52728758, "comment_id": 92388129, "body": "when I tested, the left of a blank was blank.  it did not throw an error."}, {"owner": {"reputation": 417, "user_id": 10317193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gKR4S.jpg?s=128&g=1", "display_name": "jeranon", "link": "https://stackoverflow.com/users/10317193/jeranon"}, "edited": false, "score": 0, "creation_date": 1539136916, "post_id": 52728758, "comment_id": 92388226, "body": "I hadn&#39;t tested either. Mine wasn&#39;t so much to prevent errors, as to just prevent &quot;Premature Concatenation&quot;. It&#39;s a real problem..."}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 4, "last_activity_date": 1539116453, "creation_date": 1539116453, "answer_id": 52728758, "question_id": 52728283, "link": "https://stackoverflow.com/questions/52728283/if-then-concatenate-when-condition-is-met/52728758#52728758", "title": "If Then, concatenate when condition is met", "body": "<p>In the case where its not a matter of IF in column C  but just whatever the first letter of column C is, drop the IF portion and go straight to the concatenation.</p>\n\n<pre><code>=LEFT(C1)&amp;A1\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10480492, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0EpqnO_nuzY/AAAAAAAAAAI/AAAAAAAAADg/CYTygfLTUls/photo.jpg?sz=128", "display_name": "Calnor", "link": "https://stackoverflow.com/users/10480492/calnor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 52728758, "answer_count": 3, "score": 2, "last_activity_date": 1539122735, "creation_date": 1539114299, "last_edit_date": 1539122735, "question_id": 52728283, "link": "https://stackoverflow.com/questions/52728283/if-then-concatenate-when-condition-is-met", "title": "If Then, concatenate when condition is met", "body": "<p>I want to simplify an everyday work task.  I am looking for a macro or a formula that will look at <code>Column C</code>, and if <em>New</em> is present, combine <code>N</code> with the data from <code>Column A</code>; if <em>Used</em> is present, combine <code>U</code> with the data from <code>Column A</code>.</p>\n\n<p><strong>Before:</strong></p>\n\n<pre><code>      A         B         c\n   123456                New\n   234657                Used\n   345678                New\n</code></pre>\n\n<p><strong>After:</strong></p>\n\n<pre><code>     A         B         c\n   123456   N123456     New\n   234657   U234567     Used\n   345678   N345678     New\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "conditional-formatting"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1539115846, "post_id": 52728263, "comment_id": 92382396, "body": "Access can call anything in the Excel object library like conditional formatting and vice versa. So if Excel can do it, Access can do it. But we need more information here. What is <i>ExecuteExcel4Macro</i>? Is this an Excel macro? What is the error? Include fuller block so we can see context."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1539115957, "post_id": 52728263, "comment_id": 92382449, "body": "@Parfait <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.executeexcel4macro\" rel=\"nofollow noreferrer\"><code>Application.ExecuteExcel4Macro</code></a>, but I agree, it&#39;s not clear what this has to do with the conditional formatting."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1539184615, "post_id": 52728263, "comment_id": 92411653, "body": "Access won&#39;t understand what <code>xlExpression</code> means - you&#39;ll need to update that to <code>2</code> (the numerical equivalent of xlExpression)."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1539185808, "creation_date": 1539185808, "answer_id": 52743924, "question_id": 52728263, "link": "https://stackoverflow.com/questions/52728263/vba-access-code-for-conditional-formatting-in-excel/52743924#52743924", "title": "VBA Access code for Conditional formatting in Excel", "body": "<p>I guess you're having trouble keeping track of what's selected, and <em>Access</em> hasn't got a clue what <code>xlExpression</code> <em>(2)</em>, <code>xlPasteFormats</code> <em>(-4122)</em> or <code>xlNone</code> <em>(-4142)</em> mean.  You'll need to use the numerical equivalent instead. </p>\n\n<p>I was surprised by the <code>MyXL.Application.ExecuteExcel4Macro \"File_Path_Name!(2,1,\"\"0.00%\"\")\"</code> line, but that's what I got when I recorded a macro to do it as well.  I'd still throw that line out and use <code>NumberFormat = \"\u00a3#,##0.00\"</code> instead. </p>\n\n<p>Try this code:   </p>\n\n<pre><code>Sub Test()\n\n    GetExcel_INV_Hist \"C:\\Path_To_My_Workbook\\Book1.xlsx\"\n\nEnd Sub\n\nPublic Sub GetExcel_INV_Hist(File_Path_Name As String)\n\n    Dim MyXL As Object\n    Dim MyWB As Object\n\n    Set MyXL = CreateXL\n\n    Set MyWB = MyXL.Workbooks.Open(File_Path_Name)\n\n    With MyWB.worksheets(\"Sheet1\")\n        .Columns(\"AA:AC\").NumberFormat = \"$#,##0.00_);[Red]($#,##0.00)\"\n        .Columns(\"Z:Z\").NumberFormat = \"0.00%\"\n\n        With .Columns(\"Z:Z\")\n            .FormatConditions.Add Type:=2, Formula1:=\"=$Y1=\"\"GM\"\"\" '2 = xlExpression\n            .FormatConditions(.FormatConditions.Count).SetFirstPriority\n            With .FormatConditions(1)\n                .NumberFormat = \"$#,##0.00\"\n            End With\n        End With\n\n    End With\n\nEnd Sub\n\nPublic Function CreateXL(Optional bVisible As Boolean = True) As Object\n\n    Dim oTmpXL As Object\n\n    On Error Resume Next\n    Set oTmpXL = GetObject(, \"Excel.Application\")\n\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo ERROR_HANDLER\n        Set oTmpXL = CreateObject(\"Excel.Application\")\n    End If\n\n    oTmpXL.Visible = bVisible\n    Set CreateXL = oTmpXL\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n        MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n            \" (\" &amp; Err.Description &amp; \") in procedure CreateXL.\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10480530, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fqs0H8tSkWQ/AAAAAAAAAAI/AAAAAAAAACw/QJ2zCF5YFWE/photo.jpg?sz=128", "display_name": "Richie2shoes", "link": "https://stackoverflow.com/users/10480530/richie2shoes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 52743924, "answer_count": 1, "score": 0, "last_activity_date": 1539593113, "creation_date": 1539114217, "last_edit_date": 1539593113, "question_id": 52728263, "link": "https://stackoverflow.com/questions/52728263/vba-access-code-for-conditional-formatting-in-excel", "title": "VBA Access code for Conditional formatting in Excel", "body": "<p>I have a database that exports a table to Excel and I need the cell formats in Column Z to be either Currency or Percentage based upon the value in Column Y.  I know I can do this in Excel with conditional formatting, but I am stumped on how to do it in Access.</p>\n\n<p>I tried this</p>\n\n<pre><code>Sub GetExcel_INV_Hist(File_Path_Name)\n\nDim MyXL As Object\n\nSet MyXL = CreateObject(\"Excel.Application\")\n    MyXL.Workbooks.Open (File_Path_Name)\n\n    MyXL.Visible = True\n\n' IHFormat Macro\n\nMyXL.Application.Columns(\"Z:AC\").Select\nMyXL.Application.Selection.NumberFormat = \"$#,##0.00_);[Red]($#,##0.00)\"\n\nMyXL.Application.Range(\"Z:Z\").Select\nMyXL.Application.Selection.NumberFormat = \"0.00%\"\nMyXL.Application.Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=$Y3 = \"\"GM\"\"\"\nMyXL.Application.Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nMyXL.Application.ExecuteExcel4Macro \"File_Path_Name!(2,1,\"\"0.00%\"\")\"\nMyXL.Application.Selection.FormatConditions(1).StopIfTrue = False\nMyXL.Application.Selection.Copy\nMyXL.Application.Range(\"Z4\").Select\nMyXL.Application.Range(Selection, Selection.End(xlDown)).Select\nMyXL.Application.Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>Which first changed the format of Z to currency, then I selected the first cell, Z3, checked to see if Y3 = GM and if it did, changed the format to percent.  Then select the rest of Z and did a Paste Special/Format.  It throws an error at the ExecuteExcel4Macro line.  I'm assuming because the conditional formatting wasn't done on the workbook the process creates.</p>\n\n<p>Thanks in advance for any help.</p>\n\n<p>Edit:  I recorded the macro in excel, so the line in question was created as part of the excel macro.  I've expanded my code and this is the error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AMY0R.png\" rel=\"nofollow noreferrer\">Errorsnip</a></p>\n\n<p>The rest of the formatting works perfectly.</p>\n\n<p>Thanks again</p>\n"}, {"tags": ["html", "ms-access", "vba"], "comments": [{"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1539121918, "post_id": 52728112, "comment_id": 92384778, "body": "I believe you are reading a line from the file and placing that inside your table element, but you are never splitting that information up and putting it in data cells to apply table row and table data formatting. If I am correct, start by creating a &lt;tr&gt; element (Table Row) for each strLine, then you could probably use a deliminator character to separate your data, apply a &lt;td&gt; (Table Data) element to each &quot;cell&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": true, "score": 0, "last_activity_date": 1539123055, "creation_date": 1539123055, "answer_id": 52730035, "question_id": 52728112, "link": "https://stackoverflow.com/questions/52728112/fixing-cell-padding-via-html-in-a-access-database/52730035#52730035", "title": "fixing cell padding via html in a access database", "body": "<p>Expanding on my comment from above, you can try to see if something like this works or gets you in the right direction (not tested):</p>\n\n<pre><code>Dim strCell() as string\n\nDo While Not EOF(1)\n    Input #1, strline\n    strCell() = Split(strline, vbTab) 'Replace vbTab with deliminator if needed\n\n    dim i as integer\n\n    for i = 0 to UBound(strCell)\n        strline = \"&lt;td&gt;\" &amp; strCell(i) &amp; \"&lt;/td&gt;\"\n    next\n\n    strHTML = strHTML &amp; \"&lt;tr&gt;\" &amp; strline &amp; \"&lt;/tr&gt;\"\nLoop\nClose 1\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52730035, "answer_count": 1, "score": 1, "last_activity_date": 1594627528, "creation_date": 1539113427, "last_edit_date": 1594627528, "question_id": 52728112, "link": "https://stackoverflow.com/questions/52728112/fixing-cell-padding-via-html-in-a-access-database", "title": "fixing cell padding via html in a access database", "body": "<p>I currently have a code in a database that sends an email with a table\nThe table currently is not formatted it correctly and Im unable to apply cell padding. Any ideas?\n<a href=\"https://i.stack.imgur.com/BsFL7.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Here is the code accompanying it</p>\n\n<pre><code>Function exporthtml()\n\nDim strline, strHTML, strMsg\nDim Cnt As String\nDim strFilt As String\nDim ACname As String\nDim filt As String\nDim strCC As String\n\nCnt = DCount(\"[PATS Action ID]\", \"tblPAT\", \"Bureau='\" &amp;    Form_frmMainPATS.cboBur.Value &amp; \"'\")\nACname = DLookup(\"FIRSTNAME\", \"qryAC\", \"Bureau='\" &amp;   Form_frmMainPATS.txtFull.Value &amp; \"'\")\nstrFilt = DLookup(\"WORKEMAIL\", \"qryAC\", \"Bureau='\" &amp;    Form_frmMainPATS.txtFull.Value &amp; \"'\")\n Dim OL As Outlook.Application\n\n Set OL = New Outlook.Application\n Set MyItem = Outlook.Application.CreateItem(olMailItem)\n\n\n Report_rptCurrentPATS.Filter = \"Bureau='\" &amp; Form_frmMainPATS.cboBur.Value &amp; \"'\"\nReport_rptCurrentPATS.FilterOn = True\n\nDoCmd.OutputTo acOutputReport, \"rptCurrentPATS\", acFormatHTML, \"R:\\Epi- Admin\\Administrative Collaboration\\Admin Review Meetings\\Weekly Administrative Reports\\Working Documents\\Bureau Status Report Updates\\TEST.html\"\n\nOpen \"R:\\Epi-Admin\\Administrative Collaboration\\Admin Review   Meetings\\Weekly Administrative Reports\\Working Documents\\Bureau Status Report Updates\\TEST.html\" For Input As 1\nDo While Not EOF(1)\nInput #1, strline\nstrHTML = strHTML &amp; strline\n  Loop\nClose 1\nIf Left(OL.Version, 2) = \"10\" Then\nMyItem.BodyFormat = olFormatHTML\nEnd If\nMyItem.To = strFilt\nMyItem.Subject = \"Updated PATS Status Report as of \" &amp; Date - 1\nMyItem.HTMLBody = \"&lt;BODY bgcolor='#E6E6FA'&gt;\" &amp; \"&lt;img src='R:\\Epi-Admin\\Fiscal Management and Reporting Unit\\Database\\PS Database\\logo.png' ALT='Banner'\" &amp; \"&lt;p&gt;\" &amp; \"&lt;FONT color = '#000000'&gt;\" &amp; \"Dear \" &amp; ACname &amp; \",\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;br/&gt;\" &amp; Form_frmMainPATS.cboBur.Value &amp; \" currently has \" &amp; Cnt &amp; \" pending personnel actions.\" &amp; \"&lt;/p&gt;\" &amp; \"&lt;p&gt;\" &amp; \"Please see the report below:\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;BODY&gt;\" &amp; \"&lt;table border= '1'&gt;\" &amp; \"&lt;bgcolor=#ffffff; cellspacing=10; table-layout: fixed; &gt;\" &amp; \"&lt;table header= '1' bgcolor='#fffff'&gt;\" &amp; strHTML &amp; \"&lt;/table&gt;\" &amp; \"&lt;/br&gt;\" &amp; \"&lt;br/&gt;\" &amp; \"&lt;/br&gt;\" &amp; \"&lt;/br&gt;\" &amp; \"&lt;p&gt; If you have any questions, please contact your desingated Personnel Coordinator\"\n</code></pre>\n\n<p>MyItem.Display\nEnd Function\nAny help would be appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1539113664, "post_id": 52728058, "comment_id": 92381428, "body": "My guess it that you have cells in the sum range that are errors; <code>#N&#47;A</code>,<code>#DIV&#47;0</code>,..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539114221, "post_id": 52728058, "comment_id": 92381639, "body": "If <code>CFcounter</code> is <code>0</code>, that will blow up. need more context."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1539117398, "post_id": 52728058, "comment_id": 92383026, "body": "My comment doesn&#39;t address your actual problem, but you might be able to handle the error more gracefully by using <code>Application.Sum()</code>, assigning the result to a <code>variant</code> type variable, then testing with <code>iserror</code> or <code>isnumeric</code> -- possibly."}], "owner": {"reputation": 3, "user_id": 9943118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fe993177657a3ea08f362232c904f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/9943118/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539114363, "creation_date": 1539113182, "last_edit_date": 1539114363, "question_id": 52728058, "link": "https://stackoverflow.com/questions/52728058/error-1004-unable-to-get-the-sum-property-of-the-worksheetfunction-class", "title": "Error &#39;1004&#39; Unable to get the sum property of the worksheetfunction class", "body": "<p>I keep getting the above error for this line of code and I can't seem to figure out why. </p>\n\n<pre><code>Worksheets(\"BEL CFs\").Range(\"F\" &amp; CFcounter + 5).Value = _\n     WorksheetFunction.Sum(Sheet7.Range(\"F2:F\" &amp; CFcounter))\n</code></pre>\n\n<p>Any help would be greatly appreciated. </p>\n"}]