[{"tags": ["excel", "vba", "templates", "ms-word", "paste"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1452125453, "post_id": 34645107, "comment_id": 57036265, "body": "Change <code>vbCr</code> to <code>vbCrLf</code>. A <i>carriage return</i> vbCrLf is Chr(13)&amp;Chr(10); a <i>line feed</i> vbLf is Chr(10). It&#39;s the difference between hitting Enter and hitting Shift+Enter in Word."}, {"owner": {"reputation": 113, "user_id": 3408729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ibECP.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/3408729/justin"}, "edited": false, "score": 0, "creation_date": 1452129602, "post_id": 34645107, "comment_id": 57037341, "body": "Still have a box in the xlsx - this is killing me; when I was using this for plain text a vbNewLine worked fine."}, {"owner": {"reputation": 113, "user_id": 3408729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ibECP.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/3408729/justin"}, "edited": false, "score": 0, "creation_date": 1452131030, "post_id": 34645107, "comment_id": 57037776, "body": "I ended up copying a bit from this excellent post: <a href=\"http://stackoverflow.com/questions/19962231/from-a-vba-excel-file-open-a-word-template-enter-a-number-and-print\" title=\"from a vba excel file open a word template enter a number and print\">stackoverflow.com/questions/19962231/&hellip;</a> and passing everything through the clipboard"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1452184295, "creation_date": 1452184295, "answer_id": 34660344, "question_id": 34645107, "link": "https://stackoverflow.com/questions/34645107/carrying-excel-char10-into-word-document/34660344#34660344", "title": "Carrying Excel CHAR(10) into word document", "body": "<p>Word uses neither Chr(10) nor Chr(13)&amp;Chr(10). Word uses Chr(13) for new paragraphs and Chr(11) for new lines. Note that these will NOT look correct in Excel, only in Word - there is no \"common denominator\" for new lines in the two applications!</p>\n"}], "owner": {"reputation": 113, "user_id": 3408729, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ibECP.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/3408729/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1681, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1452184295, "creation_date": 1452124617, "last_edit_date": 1495541722, "question_id": 34645107, "link": "https://stackoverflow.com/questions/34645107/carrying-excel-char10-into-word-document", "title": "Carrying Excel CHAR(10) into word document", "body": "<p>I have a fairly simple excel vba script to generate word documents from individual page templates. It's just a glorified search and replace to substitute template keys for cell values.</p>\n\n<p>When I try and copy a multiline cell into word, or insert a vbCr or vbNewLine using the method:</p>\n\n<pre><code>strReplace = TagArray(i, j)\nstrReplace = Replace(strReplace, Chr(10), vbCr)\nstrReplace = Replace(strReplace, vbNewLine, vbCr)\n</code></pre>\n\n<p>It just shows up in word as a ascii box character. If I just let Chr(10) or Chr(10) Chr(13) go through, word discards it and has no line breaks.</p>\n\n<p>How the heck do I preserve the multiline cell?</p>\n\n<p>Couldn't figure it out, so I borrowed the technique from here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5106743/generate-word-documents-in-excel-vba-from-a-series-of-document-templates\">Generate Word Documents (in Excel VBA) from a series of Document Templates</a></p>\n\n<p>and got rid of the Replace() and changed it too:</p>\n\n<pre><code>'Iterate through all of the keys to be replaced\n    For j = 0 To KeyCount - 1\n        strReplace = TagArray(i, j)\n        clipBoard.SetText IIf(strReplace = vbNullString, \"\", strReplace)\n        clipBoard.PutInClipboard\n\n        For Each storyRange In OutputDoc.StoryRanges\n            Do\n            With storyRange.Find\n                .MatchWildcards = True\n                .Text = KeyArray(j)\n                .Replacement.Text = \"^c\"\n                '.Replacement.Text = strReplace\n                .Execute Replace:=2\n            End With\n            Set storyRange = storyRange.NextStoryRange\n        Loop While Not storyRange Is Nothing\n      Next\n\n    Next j\n\nNext i\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5754805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b49860d56e2ee1d8faaf0ff17df72f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam E.", "link": "https://stackoverflow.com/users/5754805/adam-e"}, "edited": false, "score": 0, "creation_date": 1452132959, "post_id": 34646102, "comment_id": 57038305, "body": "Thanks for the help! Unfortunately I&#39;m still getting Error 75 which states &quot;Path/File Access Error,&quot; and the folders aren&#39;t generating. The mid-section of my script is now a carbon copy of your example. (from <code>DocNum = DocNum + 1</code> to <code>ActiveDocument.Close</code>. Any ideas why this would be the case?"}, {"owner": {"reputation": 1, "user_id": 5754805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b49860d56e2ee1d8faaf0ff17df72f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam E.", "link": "https://stackoverflow.com/users/5754805/adam-e"}, "edited": false, "score": 0, "creation_date": 1452133758, "post_id": 34646102, "comment_id": 57038541, "body": "I also do now have <code>Dim DocNum As Long, fPath As String</code> at the top of the script file below <code>Sub BreakOnPage()</code>, with the same result."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 5754805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b49860d56e2ee1d8faaf0ff17df72f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam E.", "link": "https://stackoverflow.com/users/5754805/adam-e"}, "edited": false, "score": 0, "creation_date": 1452140031, "post_id": 34646102, "comment_id": 57040079, "body": "Is there actually a user named &quot;User&quot; ?"}, {"owner": {"reputation": 1, "user_id": 5754805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b49860d56e2ee1d8faaf0ff17df72f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam E.", "link": "https://stackoverflow.com/users/5754805/adam-e"}, "edited": false, "score": 0, "creation_date": 1452200009, "post_id": 34646102, "comment_id": 57075527, "body": "No. The correct username is in the code I&#39;m using. When I don&#39;t try to implement any portion of the VBscript that creates a subdirectory/folder (beyond what is auto-generated by creating a .htm file), file generation is successful is that parent directory of &quot;mm_files&quot; (including the auto-generated .htm folders)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1452131546, "creation_date": 1452131546, "answer_id": 34646102, "question_id": 34644879, "link": "https://stackoverflow.com/questions/34644879/how-do-i-use-vba-to-create-multiple-directories-and-place-files-within-them-wor/34646102#34646102", "title": "How do I use VBA to create multiple directories and place files within them? Word 2013", "body": "<p>You add 1 to <code>DocNum</code> twice: once just before creating the folder, and then again when calling ChangeFileOpenDirectory. </p>\n\n<p>It would be better to pass the full path to <code>SaveAs</code>, instead of setting a default location.</p>\n\n<pre><code>Dim DocNum As Long, fPath As String\n'...\n\nDocNum = DocNum + 1\nfPath = \"C:\\Users\\User\\Desktop\\mm_files\" &amp; DocNum\nMkDir fPath\n\nActiveDocument.SaveAs FileName:=fPath &amp; \"\\Signature\" &amp; \".rtf\", _\n           FileFormat:=wdFormatRTF, AddToRecentFiles:=False\n\nActiveDocument.SaveAs FileName:=fPath &amp; \"\\Signature\" &amp; \".txt\", _\n           FileFormat:=wdFormatEncodedText, Encoding:=msoEncodingUSASCII, _\n           AddToRecentFiles:=False\n\nActiveDocument.SaveAs FileName:=fPath &amp; \"\\Signature\" &amp; \".htm\", _\n           FileFormat:=wdFormatHTML, AddToRecentFiles:=False\n\nActiveDocument.Close\n\n'...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5754805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23b49860d56e2ee1d8faaf0ff17df72f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam E.", "link": "https://stackoverflow.com/users/5754805/adam-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 397, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452131546, "creation_date": 1452123234, "last_edit_date": 1452124674, "question_id": 34644879, "link": "https://stackoverflow.com/questions/34644879/how-do-i-use-vba-to-create-multiple-directories-and-place-files-within-them-wor", "title": "How do I use VBA to create multiple directories and place files within them? Word 2013", "body": "<p>Please bear with me, I'm rather new to macros within Microsoft Office programs. Here's some background info: I'm working in a corporate environment as part of an IT team, using Microsoft Word 2013, and I'm on Windows 7. I have full read/write access to the C:\\ drive, which is where I'm working within. Any assistance is greatly appreciated.</p>\n\n<p>What I am trying to do is this: I want to create a script that first creates a file folder within a directory (that does not use \\ in the filepath), with the folder title being the document number +1 (or DocNum + 1), generates three files (.htm with respective HTML files in their own auto-generated folder, .txt., and .rtf) within that directory (each file has the exact same name), then moves back to the parent folder and repeats this process. The files are an email signature created from mail merging into a directory, then the directory file has the below script to create the files so we can push them down and lock them down for each user remotely.</p>\n\n<p>Here's where I'm getting stuck: Trying to create the subfolder with the name being the \"DocNum + 1\" scheme, then creating the files within it. I am getting an Error 75. I can create each subfolder manually, but of course want the script to work. Even after 2 hours of Google searches and playing around with the VBA script I have yet to figure this out.</p>\n\n<p>I do NOT need anything fancy (as defined by all sorts of error-correcting and double-checking code lines), and would prefer as bare-bones as possible (just enough to make it work as desired). I do not and cannot not install any extensions. Here's what I have so far (the entire script). Those more experienced with VBA can probably see what I'm trying to do here:</p>\n\n<pre><code>Sub BreakOnPage()\n   ' Used to set criteria for moving through the document by page.\n   Application.Browser.Target = wdBrowsePage\n\n   For i = 1 To ActiveDocument.BuiltInDocumentProperties(\"Number of Pages\")\n\n  ' Select and copy the text to the clipboard\n  ActiveDocument.Bookmarks(\"\\page\").Range.Copy\n\n  ' Open new document to paste the content of the clipboard into.\n  Documents.Add\n  Selection.Paste\n\n  ' Removes the break that is copied at the end of the page, if any.\n  Selection.TypeBackspace\n  Selection.TypeBackspace\n  ChangeFileOpenDirectory \"C:\\Users\\User\\Desktop\\mm_files\"\n  DocNum = DocNum + 1\n  MkDir (\"C:\\Users\\User\\Desktop\\mm_files\" &amp; DocNum)\n  ChangeFileOpenDirectory \"C:\\Users\\User\\Desktop\\mm_files\" &amp; DocNum + 1\n  ActiveDocument.SaveAs FileName:=\"Signature\" &amp; \".rtf\", FileFormat:=wdFormatRTF, AddToRecentFiles:=False\n  ActiveDocument.SaveAs FileName:=\"Signature\" &amp; \".txt\", FileFormat:=wdFormatEncodedText, Encoding:=msoEncodingUSASCII, AddToRecentFiles:=False\n  ActiveDocument.SaveAs FileName:=\"Signature\" &amp; \".htm\", FileFormat:=wdFormatHTML, AddToRecentFiles:=False\n  ActiveDocument.Close\n\n  ' Move the selection to the next page  in the document\n  Application.Browser.Next\n   Next i\n   ActiveDocument.Close savechanges:=wdDoNotSaveChanges\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "get", "element"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452124162, "post_id": 34644769, "comment_id": 57035893, "body": "should thead be details instead?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452151085, "post_id": 34644769, "comment_id": 57044061, "body": "What is <code>dados</code> here?"}, {"owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1452210457, "post_id": 34644769, "comment_id": 57080280, "body": "Hi, I updated the informations with more details and fix the wrong information about &quot;dados&quot;."}, {"owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1452639292, "post_id": 34644769, "comment_id": 57256779, "body": "Someone has any answer?"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452662108, "post_id": 34644769, "comment_id": 57263240, "body": "From your html sample data selection should be IE.document.getElementsByTagName(&quot;tr&quot;)(0).getElementsbyTagNa&zwnj;&#8203;me(&quot;td&quot;)"}, {"owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1452763001, "post_id": 34644769, "comment_id": 57315217, "body": "I tried this, but unique information that appears on sheet is &lt;td width=&quot;200px&quot; align=&quot;center&quot;&gt;&lt;/td&gt; and &lt;td width=&quot;200px&quot; align=&quot;center&quot;&gt;&lt;/td&gt; because the others owns the overflow hidden I think."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452826274, "post_id": 34644769, "comment_id": 57350168, "body": "Try debug.print IE.document.getElementsByTagName(&quot;tr&quot;).innerHTML and see what you get."}, {"owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1452868350, "post_id": 34644769, "comment_id": 57368533, "body": "Don&#39;t happens anything."}], "answers": [{"tags": [], "owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "is_accepted": false, "score": 0, "last_activity_date": 1453151339, "creation_date": 1453151339, "answer_id": 34864119, "question_id": 34644769, "link": "https://stackoverflow.com/questions/34644769/how-to-use-getelementsbytagname-with-td-with-overflow-hidden-on-vba/34864119#34864119", "title": "How to use getElementsByTagName with &lt;td&gt; with overflow: hidden on VBA?", "body": "<p>In your sample it numerates the Data, but not using it.  Also, the cell assignment should be cells(x,y).value.  Here is the working code.</p>\n\n<pre><code>Sub extractTablesData1()\n    'we define the essential variables\n\n    Dim IE As Object, Data As Object\n    Dim ticket As String\n\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    With IE\n        .Visible = False\n        .navigate (\"put your data url here\")\n\n\n        While IE.ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        Set Data = IE.document.getElementsByTagName(\"tr\")(0).getElementsByTagName(\"td\")\n\n        i = 1\n        For Each elemCollection In Data\n            ActiveWorkbook.Sheets(1).Cells(1, i).Value = elemCollection.innerHTML\n            i = i + 1\n        Next elemCollection\n\n    End With\n\n    IE.Quit\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "is_accepted": false, "score": 0, "last_activity_date": 1453370001, "creation_date": 1453370001, "answer_id": 34920361, "question_id": 34644769, "link": "https://stackoverflow.com/questions/34644769/how-to-use-getelementsbytagname-with-td-with-overflow-hidden-on-vba/34920361#34920361", "title": "How to use getElementsByTagName with &lt;td&gt; with overflow: hidden on VBA?", "body": "<p>It doesn't bring the information what I need (lasts <code>&lt;td&gt;</code>)</p>\n\n<pre><code>&lt;div id=\"posicionamentoContent\"&gt;\n  &lt;table class=\"grid\"&gt;\n  &lt;thead&gt;...&lt;/thead&gt;\n  &lt;tbody&gt;\n     &lt;tr id=\"937712\" class=\"gridrow\"&gt;\n         &lt;td width=\"200px\"&gt; Leonardo Peixoto &lt;/td&gt;\n         &lt;td width=\"200px\"&gt; 23/12/2015 09:45 &lt;/td&gt;\n         &lt;td width=\"200px\"&gt; SIM &lt;/td&gt;\n         &lt;td width=\"200px\"&gt; Telhado da loja com pontos de vazamento.&lt;/td&gt;\n         &lt;td width=\"200px\" align=\"center\"&gt;&lt;/td&gt;\n         &lt;td width=\"200px\" align=\"center\"&gt;&lt;/td&gt;\n     &lt;/tr&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1455222856, "post_id": 35318937, "comment_id": 58406172, "body": "Hi Felipe, could you adapt it into my code? I tried to do this but isn&#39;t worked. Thanks."}, {"owner": {"reputation": 378, "user_id": 5873079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/shhrX.jpg?s=128&g=1", "display_name": "Felipe Chagas", "link": "https://stackoverflow.com/users/5873079/felipe-chagas"}, "reply_to_user": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1455551767, "post_id": 35318937, "comment_id": 58528073, "body": "You only need to put the ID here: Set ieTable = ie.document.getElementById(<b>&quot;ID&quot;</b>) and try it. The last line before <b>end if</b> will paste on sheet1 then u will only need clean up the data."}, {"owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "edited": false, "score": 0, "creation_date": 1455650672, "post_id": 35318937, "comment_id": 58580508, "body": "Enjoing your great help, would you know how do I to ignorate the certificate error that appears on Internet Explorer 8? It is preventing that this script don&#39;t work in some pc&#39;s in my job. Is it poss&#237;ble to to this directly into the code?"}], "tags": [], "owner": {"reputation": 378, "user_id": 5873079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/shhrX.jpg?s=128&g=1", "display_name": "Felipe Chagas", "link": "https://stackoverflow.com/users/5873079/felipe-chagas"}, "is_accepted": false, "score": 1, "last_activity_date": 1455117341, "creation_date": 1455117341, "answer_id": 35318937, "question_id": 34644769, "link": "https://stackoverflow.com/questions/34644769/how-to-use-getelementsbytagname-with-td-with-overflow-hidden-on-vba/35318937#35318937", "title": "How to use getElementsByTagName with &lt;td&gt; with overflow: hidden on VBA?", "body": "<p>I wasn't able to read the page code due the proxy blocking me, but I faced a similar issue a while ago and the solution I found out was put all data on clipboard and paste. After that I clean the data on the sheet. </p>\n\n<p>Here the code I used to do that:</p>\n\n<pre><code>Set ieTable = ie.document.getElementById(\"ID\")\n            If Not ieTable Is Nothing Then\n                Set clip = New DataObject\n                clip.SetText \"&lt;html&gt;\" &amp; ieTable.outerHTML &amp; \"&lt;/html&gt;\"\n                clip.PutInClipboard\n                Sheet1.Range(\"A1\").Select\n                ActiveSheet.PasteSpecial Format:=\"Unicode Text\", link:=False, DisplayAsIcon:=False, NoHTMLFormatting:=True\n            End If\n</code></pre>\n\n<p>Considering that you need to isolate the 4 td lines, you can do that with a loop for every search. </p>\n"}], "owner": {"reputation": 1, "user_id": 5754724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199810516714635/picture?type=large", "display_name": "Leonardo Peixoto", "link": "https://stackoverflow.com/users/5754724/leonardo-peixoto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10887, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455117341, "creation_date": 1452122673, "last_edit_date": 1452787554, "question_id": 34644769, "link": "https://stackoverflow.com/questions/34644769/how-to-use-getelementsbytagname-with-td-with-overflow-hidden-on-vba", "title": "How to use getElementsByTagName with &lt;td&gt; with overflow: hidden on VBA?", "body": "<p>I am using the VBA automation to get some informations of a ticket system in my job. I am trying to get the value into the generated table but only information that doest'go to the column \"A\" on sheet \"Plan1\" is <code>&lt;td&gt;</code> which contains the overflow: hidden CSS atribute. I don't know if are them related but coincidently are the only data that don't appears. Someone can help me?</p>\n\n<p>HTML code:</p>\n\n<pre><code>&lt;div id=\"posicionamentoContent\"&gt;\n  &lt;table class=\"grid\"&gt;\n  &lt;thead&gt;...&lt;/thead&gt;\n  &lt;tbody&gt;\n     &lt;tr id=\"937712\" class=\"gridrow\"&gt;\n         &lt;td width=\"200px\"&gt; Leonardo Peixoto &lt;/td&gt;\n         &lt;td width=\"200px\"&gt; 23/12/2015 09:45 &lt;/td&gt;\n         &lt;td width=\"200px\"&gt; SIM &lt;/td&gt;\n         &lt;td width=\"200px\"&gt; Telhado da loja com pontos de vazamento.&lt;/td&gt;\n         &lt;td width=\"200px\" align=\"center\"&gt;&lt;/td&gt;\n         &lt;td width=\"200px\" align=\"center\"&gt;&lt;/td&gt;\n     &lt;/tr&gt;\n...\n...\n...\n</code></pre>\n\n<p>The complete code: <a href=\"http://i.stack.imgur.com/4BsFo.png\" rel=\"nofollow\">http://i.stack.imgur.com/4BsFo.png</a></p>\n\n<p>I need to get the first 4 <code>&lt;td&gt;</code> text ( Leonardo Peixoto, 23/12/2015 09:45, SIM and Telhado da loja com pontos de vazamento.) but they are only texts which I can't get.</p>\n\n<p>Obs: When I use developers tools (f12) to inspect each element, it shows me perfectly the information I need inside <code>&lt;td&gt;</code>. But when I open \"source code\" page to checkthe html, the code is like this:</p>\n\n<pre><code>&lt;div id=\"tabPosicionamento\" style=\"padding: 5px 0 5px 0;\"  class=\"ui-tabs-hide\"&gt;\n    div id=\"posicionamentoContent\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Example VBA:</p>\n\n<pre><code>    Sub extractTablesData1()\n     'we define the essential variables\n\n     Dim IE As Object, obj As Object\n     Dim ticket As String\n\n\n     Set IE = CreateObject(\"InternetExplorer.Application\")\n\n     ticket= InputBox(\"Enter the ticket code\")\n\n    With IE\n\n     .Visible = False\n     .navigate (\"https://www.example.com/details/\") &amp; ticket\n\n\n     While IE.ReadyState &lt;&gt; 4\n     DoEvents\n     Wend\n\n    ThisWorkbook.Sheets(\"Plan1\").Range(\"A1:K500\").ClearContents\n\n    Set data = IE.document.getElementsByClassName(\"thead\")(0).getElementsByTagName(\"td\")\n\n            i = 0\n            For Each elemCollection In data\n            ThisWorkbook.Sheets(\"Plan1\").Range(\"A\" &amp; i + 1) = data(i).innerText\n            i = i + 1\n\n            Next elemCollection\n\nEnd With\n\nIE.Quit\nSet IE = Nothing\n\n....\n\n....\n\nEnd Sub\n</code></pre>\n\n<p>This function returns in column <strong>\"A\"</strong> of sheet <strong>Plan1</strong> only <code>&lt;td class=info3\"&gt;&lt;/td&gt;</code> and <code>&lt;td class=info4\"&gt;&lt;/td&gt;</code> but I need <code>&lt;td class=info1\"&gt;&lt;/td&gt;</code> and <code>&lt;td class=info2 also.\"&gt;&lt;/td&gt;</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452120477, "post_id": 34643849, "comment_id": 57034500, "body": "<code>found a code which is copying values that are exactly 1</code> So modify it for <code>&lt;1</code>. Take the value, multiply by 1 then test if less than 1."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452276948, "post_id": 34644326, "comment_id": 57113137, "body": "This works ElbertV, is it possible for you to change the code so it copies the values also, and to show values from K,L,M from sheet1 in your example to the column F in sheet2?  Take into consideration that like in your example Line 16 have multiple values under 1 so in sheet2 we need new row for every value. Thank You really for your time and help"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452278051, "post_id": 34644326, "comment_id": 57113762, "body": "Check my Edit#1 and see if is ok. But I don&#39;t get the whole idea about a new row for each value. You say, if all the 3 values are under 1, you need a new row for each value, and then, for the line 16, (-5,-1,-10) you need two new rows??? It is that way??? In case it is, what values will be on each row? The same three values on the new rows, or one value in each row? After that some questions come to my mind... But please gimme all the detail, to help you in the correct way."}, {"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452278750, "post_id": 34644326, "comment_id": 57114121, "body": "I just run it and this is almost perfect. Only issue is that now all values are copied to the sheet2 and not just &lt;1. How to solve this? And regarding your question- If in Sheet1 Line 16 has -5,-1 and -10 i would like to have 3 new rows in sheet 2 Example Sheet 2 Line 16 Column A,B,C and in column F -5 Line 17 Column A B C and in column F -1 Line 18 Column A B C and in column F -10 If You could write that all values found goes to column F in sheet2 that would be perfection and a huuge time-saver."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452279140, "post_id": 34644326, "comment_id": 57114297, "body": "I ran the code again and for me, take only the rows (from sheet1) that contains a value (any of the three values,no matter wich one) &lt;1 and move it (only that rows) to sheet2. In sheet1 I have 32 lines, and as a result in sheet2 I get just 18 lines, and in that lines, every rows, has at least one value under 1. Please re-check your code, and tell me if everything is as I reply to you."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452279339, "post_id": 34644326, "comment_id": 57114405, "body": "And now, about adding the new lines... I&#39;m clear, if the three values are unde 1, you want every value (&lt;1) in a new row, and each value (&lt;1) in the column F, that is ok for me... But, what if not all the values are &lt;1, may be lik this {-9,6,-3} or like this {9-8,0} or this way {-2,6,4}."}, {"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452279951, "post_id": 34644326, "comment_id": 57114751, "body": "Yes, you are correct - only values &lt;1 should go into F column. In Your example (-9,6,-3) only -9 and -3 should go into sheet2. In second example only -8 should go into sheet2, third example only -2. Not entire row should be copied into sheet2 just names(columns A,B,C) and just value that is &lt;1."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452286424, "post_id": 34644326, "comment_id": 57118237, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/100189/discussion-between-elbertv-and-marko-m\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 1, "last_activity_date": 1452286311, "last_edit_date": 1452286311, "creation_date": 1452120467, "answer_id": 34644326, "question_id": 34643849, "link": "https://stackoverflow.com/questions/34643849/copy-rows-to-sheet2-in-value-in-range-is-met/34644326#34644326", "title": "Copy rows to sheet2 in value in range is met", "body": "<p>May this will help,</p>\n\n<pre><code>Sub moveData()\n    Dim rng As Range\n    Dim iniCol As Range\n    Dim i\n    Dim c\n    Dim myIndex\n    Dim cellVal\n    Dim totalCols\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n\n    Set sht1 = Sheets(\"Sheet1\")\n    Set sht2 = Sheets(\"Sheet2\")\n    Set rng = Range(\"K1:M32\")\n    Set iniCol = Range(\"K1:K32\")\n    totalCols = rng.Columns.Count 'Count the total of columns in the selectec range\n    myIndex = 0 'ini the index for rows in sheet2\n\n    For Each i In iniCol\n        For c = 1 To totalCols\n            cellVal = i.Offset(0, c - 1).Value\n            If cellVal &lt; 1 Then\n                myIndex = myIndex + 1\n                Range(Cells(i.Row, 1), Cells(i.Row, 3)).Copy \n                'Copy range from A to C\n                sht2.Activate\n                Range(Cells(myIndex, 1), Cells(myIndex, 3)).PasteSpecial xlPasteAll\n                'Paste range equal to copy range.\n                Application.CutCopyMode = False\n                sht1.Activate\n                Exit For\n            End If\n        Next c\n    Next i\nEnd Sub\n</code></pre>\n\n<p>In columns A, B, C and K, L, M</p>\n\n<pre><code>HMG BNA ALI                             -2  6   4\nHCM INH KJA                             6   5   2\nDDN EHJ AKK                             1   -7  -6\nOLG BMG AJC                             -7  1   0\nCGK PEA EFB                             6   5   2\nBGO CGI EOO                             8   -9  -2\nNHB CGP IEJ                             -2  3   -8\nPNK JBN HKJ                             6   5   2\nABC JIG NHB                             8   8   -10\nBBO EIL NDH                             -1  10  -7\nGJE PNK LNL                             2   8   10\nGMF HIF EFP                             6   5   2\nAIB EJP NDL                             -6  -5  8\nIKM IIA GDL                             6   5   0\nPCE KJA HPJ                             6   5   2\nFFE KFM CPB                             -5  -1  -10\nMHO IJL FCL                             6   5   2\nEPI PPF IOE                             -5  2   -5\nANO PAO HHG                             6   5   2\nMGL GII PEB                             -3  8   2\nPJK OKI GME                             -3  4   10\nAEP NMN JML                             6   5   2\nANE KBK NGJ                             -10 -7  -4\nJLJ IIH OLG                             6   5   2\nPLH HBK PIK                             -9  6   -3\nICC MEB LKO                             6   5   2\nMBH OGA JJA                             4   9   0\nIAN HBK ANJ                             6   5   2\nFNP FPE KLG                             2   2   8\nLAI ALE HHP                             6   5   2\nNLG IFG MDB                             -10 -8  0\nICE OHG BFH                             9   -8  0\n</code></pre>\n\n<p>Result: </p>\n\n<p>Just import this rows, only from A to C (if you want also the values just increase the column of the copy range)</p>\n\n<pre><code>HMG BNA ALI\nDDN EHJ AKK\nOLG BMG AJC\nBGO CGI EOO\nNHB CGP IEJ\nABC JIG NHB\nBBO EIL NDH\nAIB EJP NDL\nIKM IIA GDL\nFFE KFM CPB\nEPI PPF IOE\nMGL GII PEB\nPJK OKI GME\nANE KBK NGJ\nPLH HBK PIK\nMBH OGA JJA\nNLG IFG MDB\nICE OHG BFH\n</code></pre>\n\n<p>An image worth a thousand words\n<a href=\"https://i.stack.imgur.com/51C33.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/51C33.jpg\" alt=\"an image worth a thousand words\"></a></p>\n\n<p><strong>Edit #1</strong></p>\n\n<p>Here is the code as you ask in comments:</p>\n\n<pre><code>Sub moveData()\n    Dim rng As Range\n    Dim iniCol As Range\n    Dim i\n    Dim c\n    Dim myIndex\n    Dim cellVal\n    Dim totalCols\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n\n    Dim ABC 'var to store data from Cols A,B,C in Sheet1\n    Dim KLM 'var to store data from Cols K,L,M in Sheet1\n\n    Set sht1 = Sheets(\"Sheet1\")\n    Set sht2 = Sheets(\"Sheet2\")\n    Set rng = Range(\"K1:M32\")\n    Set iniCol = Range(\"K1:K32\")\n    totalCols = rng.Columns.Count 'Count the total of columns in the selectec range\n    myIndex = 0 'ini the index for rows in sheet2\n\n    For Each i In iniCol\n        For c = 1 To totalCols\n            cellVal = i.Offset(0, c - 1).Value\n            If cellVal &lt; 1 Then\n                myIndex = myIndex + 1\n                'Now anything is copied, instead is stored inside this two vars, cols A, B, C and K, L, M as well\n                ABC = Range(Cells(i.Row, 1), Cells(i.Row, 3))\n                KLM = Range(Cells(i.Row, 11), Cells(i.Row, 13))\n                '\n                sht2.Activate\n                Range(Cells(myIndex, 1), Cells(myIndex, 3)).Value = ABC\n                Range(Cells(myIndex, 6), Cells(myIndex, 8)).Value = KLM \n                'and put it back in sheet2 in cols 1=A to 3=C and 6=F to 8=H\n                '\n                'Application.CutCopyMode = False 'Not used anymore.\n                sht1.Activate\n                Exit For\n            End If\n        Next c\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Edit#2</strong></p>\n\n<p>Go over the values, and if any value is &lt;1 then put the value ONLY in column F, in one row, the next value in another cell. </p>\n\n<pre><code>Sub moveData()\n    Dim rng As Range\n    Dim iniCol As Range\n    Dim i\n    Dim v\n    Dim x\n    Dim myIndex\n    Dim cellVal\n    Dim totalCols\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n\n    Dim ABC() 'var to store data from Cols A,B,C in Sheet1\n    Dim KLM As Range 'var to store data from Cols K,L,M in Sheet1\n\n    Set sht1 = Sheets(\"Sheet1\")\n    Set sht2 = Sheets(\"Sheet2\")\n    Set rng = Range(\"K1:M32\")\n    Set iniCol = Range(\"K1:K32\")\n    totalCols = rng.Columns.Count 'Count the total of columns in the selectec range\n    myIndex = 0 'ini the index for rows in sheet2\n\n    For Each i In iniCol\n    x = -1\n        ABC = Range(Cells(i.Row, 1), Cells(i.Row, 3))\n        Set KLM = Range(Cells(i.Row, 11), Cells(i.Row, 13))\n        'Copy range from A to C\n\n        sht2.Activate\n\n        myIndex = Application.WorksheetFunction.CountA(Columns(1)) + 1\n        For Each v In KLM\n            If v.Value &lt; 1 Then\n                x = x + 1\n                Range(Cells(myIndex + x, 6), Cells(myIndex + x, 6)).Value = v.Value\n                Range(Cells(myIndex + x, 1), Cells(myIndex + x, 3)).Value = ABC\n            End If\n        Next v\n        'Paste range equal to copy range.\n        'Application.CutCopyMode = False\n        sht1.Activate\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This is my result:</p>\n\n<pre><code>HMG BNA ALI         -2\nDDN EHJ AKK         -7\nDDN EHJ AKK         -6\nOLG BMG AJC         -7\nOLG BMG AJC         0\nBGO CGI EOO         -9\nBGO CGI EOO         -2\nNHB CGP IEJ         -2\nNHB CGP IEJ         -8\nABC JIG NHB         -10\nBBO EIL NDH         -1\nBBO EIL NDH         -7\nAIB EJP NDL         -6\nAIB EJP NDL         -5\nIKM IIA GDL         0\nFFE KFM CPB         -5\nFFE KFM CPB         -1\nFFE KFM CPB         -10\nEPI PPF IOE         -5\nEPI PPF IOE         -5\nMGL GII PEB         -3\nPJK OKI GME         -3\nANE KBK NGJ         -10\nANE KBK NGJ         -7\nANE KBK NGJ         -4\nPLH HBK PIK         -9\nPLH HBK PIK         -3\nMBH OGA JJA         0\nNLG IFG MDB         -10\nNLG IFG MDB         -8\nNLG IFG MDB         0\nICE OHG BFH         -8\nICE OHG BFH         0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452124697, "post_id": 34644332, "comment_id": 57036061, "body": "@ Jeeped, when i tried to run your code I get an error : <code>Run  time error 13 Type mismatch</code> Can you please explain how to fix this?  @ ElbertV, this looks exactly like what I want but I am getting this error: error 9, subscript out of range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 1, "creation_date": 1452124943, "post_id": 34644332, "comment_id": 57036131, "body": "It would seem that you either have errors,  non-numeric text or text-that-looks-like-a-number within the values. None of these can be compared to a number (e.g. &lt;1). I could easily write a numeric check in but that will not solve bad data that may be thrown out when it should be accepted. What line is giving you this error message? I suspect <code>If vVALs(1, v) &gt;= 1 Or v &lt; 285 Then</code> but I am not sure."}, {"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452125919, "post_id": 34644332, "comment_id": 57036394, "body": "Yes, line 13. In sheet1 columns A,B,C,D have letters. Columns from E to JX have numbers(cell are drop down lists, maybe this is important to mention) And third section of sheet1 from JY to MV have numbers - because third section are results(from E-JX) most of them have numeric values but some have #DIV/0! So range to look for values under 1 should be just JY:MV Thank You so much for helping me"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452127113, "post_id": 34644332, "comment_id": 57036668, "body": "OK I&#39;ve broken out the two conditions within that section and added a safety for non-numeric values. Hard to guess what else could be wrong without seeing data."}, {"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452127951, "post_id": 34644332, "comment_id": 57036883, "body": "Yes, this is better but now In line 9 error : Subscript out of range."}, {"owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452128514, "post_id": 34644332, "comment_id": 57037043, "body": "Here are print screen`s of how xlsx file looks like, if you need any additional info please ask. <a href=\"http://postimg.org/image/f6klood21/\" rel=\"nofollow noreferrer\">postimg.org/image/f6klood21</a> <a href=\"http://postimg.org/image/c0zzyguft/\" rel=\"nofollow noreferrer\">postimg.org/image/c0zzyguft</a>  [url=<a href=\"http://postimg.org/image/c0zzyguft/][img]http://s28.postimg.org/c0zzyguft/image.png[/img][/url]\" rel=\"nofollow noreferrer\">postimg.org/image/c0zzyguft/][img]http://s28.postimg.or&zwnj;&#8203;g/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "edited": false, "score": 0, "creation_date": 1452128608, "post_id": 34644332, "comment_id": 57037074, "body": "uh... yeah... I&#39;ll get right on that as soon as I type out several test rows worth of 360 columns of data."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1452126995, "last_edit_date": 1452126995, "creation_date": 1452120494, "answer_id": 34644332, "question_id": 34643849, "link": "https://stackoverflow.com/questions/34643849/copy-rows-to-sheet2-in-value-in-range-is-met/34644332#34644332", "title": "Copy rows to sheet2 in value in range is met", "body": "<p>Collecting the values into a variant array will make quick work of running through them looking for valid values to bring over to Sheet2.</p>\n\n<pre><code>Sub copy_multi_less_than_one()\n    Dim rw As Long, cl As Long\n    Dim bCOPY As Boolean, v As Long, vVALs As Variant\n\n    'Application.ScreenUpdating = False\n\n    With Worksheets(\"Sheet1\")\n        With .Cells(1, 1).CurrentRegion\n            For rw = 2 To .Rows.Count\n                vVALs = .Cells(rw, 1).Resize(1, 360).Value2\n                bCOPY = False\n                For v = 5 To UBound(vVALs, 2)\n                    If v &lt; 285 Then\n                        vVALs(1, v) = vbNullString\n                    ElseIf application.sum(vVALs(1, v)) &gt;= 1 Then\n                        vVALs(1, v) = vbNullString\n                    Else\n                        bCOPY = True\n                    End If\n                Next v\n                If bCOPY Then\n                    With Worksheets(\"Sheet2\")\n                        .Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Resize(1, UBound(vVALs, 2)) = vVALs\n                    End With\n                End If\n            Next rw\n            'optionally delete the columns from E to JX\n            'Worksheets(\"Sheet2\").Columns(\"E:JX\").EntireColumn.Delete\n        End With\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5754604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a807878b28ba0beea6b9e48c56b026b?s=128&d=identicon&r=PG&f=1", "display_name": "Marko M.", "link": "https://stackoverflow.com/users/5754604/marko-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 1, "accepted_answer_id": 34644326, "answer_count": 2, "score": 4, "last_activity_date": 1452286311, "creation_date": 1452118472, "question_id": 34643849, "link": "https://stackoverflow.com/questions/34643849/copy-rows-to-sheet2-in-value-in-range-is-met", "title": "Copy rows to sheet2 in value in range is met", "body": "<p>I am complete newbee when it comes to Excel VBA</p>\n\n<p>I have a task to copy rows from sheet1 to sheet 2 if certain criteria is met.</p>\n\n<p>In sheet1 there are values in columns JY ending in column MV\nI would like if you can help me to write a macro to copy all rows to sheet2 containing values that are less than 1.\nit is possible that one row can have multiple &lt;1 values.</p>\n\n<p>For example: Row 16 can have under column jY 0.9  and under MA 0.5</p>\n\n<p>Best outcome will be to see only columns A,B,C,D and column with values less than 1 in sheet 2, but if that is not possible copying entire row would be fine.</p>\n\n<p>So far I have found a code which is copying values that are exactly 1</p>\n\n<p>Here is code that I would like to be changed:</p>\n\n<pre><code>    Sub SearchForNumber1()\nDim LSearchRow As Integer\nDim LCopyToRow As Integer\nOn Error GoTo Err_Execute\n'Start search in row 1\nLSearchRow = 1\n'Start copying data to row 2 in Sheet2 (row counter variable)\nLCopyToRow = 2\nWhile Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n'If value in column E = \"Mail Box\", copy entire row to Sheet2\nIf Range(\"B\" &amp; CStr(LSearchRow)).Value = \"1\" Then\n'Select row in Sheet1 to copy\nRows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\nSelection.Copy\n'Paste row into Sheet2 in next row\nSheets(\"Sheet2\").Select\nRows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\nActiveSheet.Paste\n'Move counter to next row\nLCopyToRow = LCopyToRow + 1\n'Go back to Sheet1 to continue searching\nSheets(\"Sheet1\").Select\nEnd If\nLSearchRow = LSearchRow + 1\nWend\n'Position on cell A3\nApplication.CutCopyMode = False\nRange(\"A3\").Select\nMsgBox \"All matching data has been copied.\"\nExit Sub\nErr_Execute:\nMsgBox \"An error occurred.\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452117422, "post_id": 34643520, "comment_id": 57033050, "body": "This looks like a weird blend of VBA and VB.net"}, {"owner": {"reputation": 4912, "user_id": 4974175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ixCeF.jpg?s=128&g=1", "display_name": "rll", "link": "https://stackoverflow.com/users/4974175/rll"}, "edited": false, "score": 0, "creation_date": 1452117521, "post_id": 34643520, "comment_id": 57033095, "body": "Take a look <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 5, "last_activity_date": 1452118499, "creation_date": 1452118499, "answer_id": 34643860, "question_id": 34643520, "link": "https://stackoverflow.com/questions/34643520/how-to-generate-a-string-of-random-characters-from-a-given-list-of-characters/34643860#34643860", "title": "How to generate a string of random characters from a given list of characters?", "body": "<p>In VBA <code>Rnd</code> is a function, not a class and strings can't be treated as arrays. You need to use the function <code>Mid</code> to extract individual characters.</p>\n\n<p>You can write a function to return a random string. The function can then be used by your event-handler:</p>\n\n<pre><code>Function RandString(n As Long) As String\n    'Assumes that Randomize has been invoked by caller\n    Dim i As Long, j As Long, m As Long, s As String, pool As String\n    pool = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    m = Len(pool)\n    For i = 1 To n\n        j = 1 + Int(m * Rnd())\n        s = s &amp; Mid(pool, j, 1)\n    Next i\n    RandString = s\nEnd Function\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>Sub test()\n    Randomize\n    MsgBox RandString(50)\nEnd Sub\n</code></pre>\n\n<p>Typical output looks like:</p>\n\n<pre><code>fvdDUV1csFLhzCmrvJtYx4wXr1QGqSai6yiGSC4ByzB53kG5E1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5232, "user_id": 4052855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHiYP.jpg?s=128&g=1", "display_name": "Nesar", "link": "https://stackoverflow.com/users/4052855/nesar"}, "is_accepted": false, "score": 0, "last_activity_date": 1606988404, "creation_date": 1606988404, "answer_id": 65123336, "question_id": 34643520, "link": "https://stackoverflow.com/questions/34643520/how-to-generate-a-string-of-random-characters-from-a-given-list-of-characters/65123336#65123336", "title": "How to generate a string of random characters from a given list of characters?", "body": "<p>Extending @John Coleman's answer.</p>\n<p>Here the &quot;Anonymise&quot; function will create a random string or number based on your input. If you pass a string, it will return a string, if you pass a number, it will return a number. Note that the length of the return value will be the same as your input value</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Public Function Anonymise(str As String)\nchunks = Split(str, \" \")\nDim ret As String\nret = \"\"\n\nIf IsNumeric(str) = False Then\n    For i = 0 To UBound(chunks) - LBound(chunks)\n        ret = ret + \" \" + RandString(Len(chunks(i)))\n    Next i\n    ret = Trim(ret)\n    Anonymise = StrConv(ret, vbProperCase)\nElse\n    For i = 0 To UBound(chunks) - LBound(chunks)\n        ret = ret + \" \" + RandNum(Len(chunks(i)))\n    Next i\n    ret = Trim(ret)\n    Anonymise = ret\nEnd If\nEnd Function\n\nFunction RandString(n As Long) As String\n    Dim i As Long, j As Long, m As Long, s As String, pool As String\n    pool = \"abcdefghijklmnopqrstuvwxyz\"\n    m = Len(pool)\n    For i = 1 To n\n        j = 1 + Int(m * Rnd())\n        s = s &amp; Mid(pool, j, 1)\n    Next i\n    RandString = s\nEnd Function\n\n\nFunction RandNum(n As Long) As String\n    Dim i As Long, j As Long, m As Long, s As String, pool As String\n    pool = \"0123456789\"\n    m = Len(pool)\n    For i = 1 To n\n        j = 1 + Int(m * Rnd())\n        s = s &amp; Mid(pool, j, 1)\n    Next i\n    RandNum = s\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 13, "user_id": 5754556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0njlWXau5zc/AAAAAAAAAAI/AAAAAAAAAOc/SV5MaWhtIBA/photo.jpg?sz=128", "display_name": "Hadi Mehrzad", "link": "https://stackoverflow.com/users/5754556/hadi-mehrzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3047, "favorite_count": 0, "accepted_answer_id": 34643860, "answer_count": 2, "score": 0, "last_activity_date": 1614882234, "creation_date": 1452117141, "last_edit_date": 1614882234, "question_id": 34643520, "link": "https://stackoverflow.com/questions/34643520/how-to-generate-a-string-of-random-characters-from-a-given-list-of-characters", "title": "How to generate a string of random characters from a given list of characters?", "body": "<p>How can I generate a string of random characters from a given list of characters?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command0_Click()\n    Dim pool As String\n    pool = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;\n    Dim count\n    count = 0\n    result.Text = &quot;&quot;\n    Randomize\n    Dim cc\n    cc As New Rnd\n    Dim strpos\n    strpos = &quot;&quot;\n    While count &lt;= Lengthh.Text\n        strpos = cc.Next(0, pool.length)\n        result.Text = result.Text &amp; pool(strpos)\n        count = count + 1\n    Wend\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "zip"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1452129239, "post_id": 34643398, "comment_id": 57037243, "body": "Unzip first. See here <a href=\"http://www.rondebruin.nl/win/s7/win002.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s7/win002.htm</a>  Stackoverflow link <a href=\"http://stackoverflow.com/questions/19809056/vba-script-to-unzip-files-its-just-creating-empty-folders\" title=\"vba script to unzip files its just creating empty folders\">stackoverflow.com/questions/19809056/&hellip;</a> if the source is lost in the future."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5754497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a62f98bba6ac925e43e8b718d0d3c26?s=128&d=identicon&r=PG&f=1", "display_name": "Matty mataytay", "link": "https://stackoverflow.com/users/5754497/matty-mataytay"}, "edited": false, "score": 0, "creation_date": 1452175087, "post_id": 34644037, "comment_id": 57059116, "body": "Are you saying that I should check to make sure the file I am downloading is a Zip file?  But even if I did check to make sure the attachments I was downloading is a Zip I feel that the same thing will still happen."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 1, "user_id": 5754497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a62f98bba6ac925e43e8b718d0d3c26?s=128&d=identicon&r=PG&f=1", "display_name": "Matty mataytay", "link": "https://stackoverflow.com/users/5754497/matty-mataytay"}, "edited": false, "score": 0, "creation_date": 1452183046, "post_id": 34644037, "comment_id": 57065008, "body": "What I&#39;m saying is that there might be other files, like embedded images, that show up as attachments when the email is processed and that perhaps you&#39;re seeing some stuff that isn&#39;t a zip and hence the weird looking result. Make sure that you are only processing zips and then you know for sure you&#39;re looking at a zip."}, {"owner": {"reputation": 1, "user_id": 5754497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a62f98bba6ac925e43e8b718d0d3c26?s=128&d=identicon&r=PG&f=1", "display_name": "Matty mataytay", "link": "https://stackoverflow.com/users/5754497/matty-mataytay"}, "edited": false, "score": 0, "creation_date": 1452195842, "post_id": 34644037, "comment_id": 57073056, "body": "The sample e-mails that I am using are all zip files of csv files."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 1, "user_id": 5754497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a62f98bba6ac925e43e8b718d0d3c26?s=128&d=identicon&r=PG&f=1", "display_name": "Matty mataytay", "link": "https://stackoverflow.com/users/5754497/matty-mataytay"}, "edited": false, "score": 0, "creation_date": 1452202369, "post_id": 34644037, "comment_id": 57076830, "body": "You&#39;re not understanding what I&#39;m suggesting. Try this:      For Each Item In SubFolder.Items         For Each Atmt In Item.Attachments             If right(Atmt.FileName, 4) = &quot;.zip&quot; Then                 FileName = &quot;H:\\exceptionDownload\\&quot; &amp; Item.Subject &amp; &quot; &quot; &amp; i &amp; Atmt.FileName                 Atmt.SaveAsFile FileName                 &#39;increment the log variable.                 i = i + 1             Next Atmt         Next Item  This will exclude an extraneous &quot;hidden&quot; objects in the email. It probably won&#39;t solve the problem, but it may aid in debugging."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1452406495, "post_id": 34644037, "comment_id": 57151324, "body": "I suggest you include some code <b>in your answer</b> to clarify what you mean. The code from <a href=\"http://stackoverflow.com/q/34644037/#comment57076830_34644037\">your comment</a> can also be incorporated into your answer -- comments are not the place for extended code."}], "tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": false, "score": -2, "last_activity_date": 1452432616, "last_edit_date": 1452432616, "creation_date": 1452119167, "answer_id": 34644037, "question_id": 34643398, "link": "https://stackoverflow.com/questions/34643398/using-vba-in-outlook-to-automatically-download-zip-floders-onto-computer/34644037#34644037", "title": "Using VBA in outlook to automatically download Zip floders onto computer", "body": "<p>I would try checking for the specific extension(s) you want, and ignore all others. You have a process that downloads attachments, but you have to exclude some stuff that doesn't show in the attachments because other objects, such as embedded images, are handled as attachments as well.</p>\n\n<p>Try this:</p>\n\n<pre><code>For Each Item In SubFolder.Items\n    For Each Atmt In Item.Attachments\n        If right(Atmt.FileName, 4) = \".zip\" Then\n            FileName = \"H:\\exceptionDownload\\\" &amp; Item.Subject &amp; \" \" &amp; i &amp; Atmt.FileName\n            Atmt.SaveAsFile FileName\n            'increment the log variable.\n            i = i + 1\n        End If\n    Next Atmt\nNext Item\n</code></pre>\n\n<p>This will exclude extraneous \"hidden\" objects in the email.</p>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 1880754, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8e6590b7616f23d2443a6a332b298a60?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1880754/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1466199967, "creation_date": 1466199967, "answer_id": 37890812, "question_id": 34643398, "link": "https://stackoverflow.com/questions/34643398/using-vba-in-outlook-to-automatically-download-zip-floders-onto-computer/37890812#37890812", "title": "Using VBA in outlook to automatically download Zip floders onto computer", "body": "<p>Here is the working code that I use. It might be a little more than what you are after, but hopefully you can adjust to suit. </p>\n\n<p>It handles both zip and non-zipped files, and discards and extensions that you want to ignore. It also can automatically download any cloud based attachments that are too big to send over email. It saves the zipped attachment to a temp folder before extracting the data. Saved and unzipped attachments are also routed to their appropriate folders.</p>\n\n<p><strong>SaveAttachments Method</strong>: This is the main method is run based upon an Outlook rule. The destination folder for the attachment is set according to the email's subject (the case statement). In the example code, if the subject is 'Test', then instead of downloading the attachment, it searches for an in-text hyperlink and downloads the cloud based attachment. If the attachement is a .zip file, then it downloads it to a temp folder and calls the 'Unzip Method'.</p>\n\n<p><strong>Unzip Method</strong>: This takes in the unzipped file and unzips it to the destination folder</p>\n\n<p><strong>IsInArray Function</strong>: Looks to see if the extension of the attachment is in the array of skipped attachment (eg jpg). Returns True or False.</p>\n\n<p><strong>LaunchURL Method</strong>: Searches through every word in the email and looks for the a URL that matches the defined URL for the cloud based attachment (fuzzy match on domain name). Names the file with the current sender, date and time. </p>\n\n<p><strong>DownloadFileFromWeb Function</strong>: Launches the URL for the cloud based attachment (as defined by the LaunchURL method) and saves it to the appropriate folder</p>\n\n<pre><code>Public Sub SaveAttachments(Item As Outlook.MailItem)\n\nDim objAttachments As Outlook.Attachments\nDim lngCount, i As Long\nDim strFile, sFileType, destinationFolder, destinationFolderPath, username, subject, rootFolderPath, tempFolderPath, tempFolder, ext, sender As String\nDim isZipped As Boolean\nDim skippedExts() As String\n\n\n'Gets username\n    username = VBA.Interaction.Environ$(\"UserName\")\n\n'Sets the root folder ************************* EDIT THIS *******************************\n    rootFolderPath = \"C:\\Users\\\" &amp; username &amp; \"\\Box Sync\\Save and Unzip Test\\\"\n\n\n'Sets the temp folder Name used to hold the zipped downloads ************************* EDIT THIS *******************************\n    tempFolder = \"Zip Files\"\n\n'List the extentions that you want to skip delimited by a bar '|' ************************* EDIT THIS *******************************\n    skippedExts = Split(\"jpg|jpeg|png|gif\", \"|\")\n\n\n\n'Sets the destination folder is set to match it's appropiate data sources ************************* EDIT THIS *******************************\n    Select Case Item.subject\n\n        Case \"Test\"\n            destinationFolder = \"TestFolder\"\n\n         Case Else\n            destinationFolder = \"DefaultFolder\"\n\n    End Select\n\n'********************************************************************************************************************************************\n\n'Sets the root path for non-zipped files\n    destinationFolderPath = rootFolderPath &amp; destinationFolder &amp; \"\\\"\n\n'Sets the temp folder path for the zip files\n    tempFolderPath = rootFolderPath &amp; tempFolderName &amp; \"\\\"\n\n'Launchs another method if the sender is Convetro to download the file from the URL\n    If destinationFolder = \"Test\" Then\n        Call LaunchURL(Item, destinationFolderPath)\n        Exit Sub\n    End If\n\n\nIf Item.Attachments.Count &gt; 0 Then\n\n    Set objAttachments = Item.Attachments\n\n    'Counts the number of attachments\n        lngCount = objAttachments.Count\n\n\n    For i = lngCount To 1 Step -1\n\n        'Resets the Boolean\n            isZipped = False\n\n        'Get the file name of the attachment\n            strFile = objAttachments.Item(i).fileName\n\n        'Gets the file extention\n            ext = Split(strFile, \".\")(UBound(Split(strFile, \".\")))\n\n        'If the attachment is an image, then skip it (calls the function to check whether the ext is in the array 'skippedExts')\n            If IsInArray(ext, skippedExts) = True Then\n                GoTo NextAttachment\n            End If\n\n        'If the attachment is a zip, then the path is set to a temp folder.\n            If ext = \"zip\" Then\n                strFolderpath = tempFolderPath\n                isZipped = True\n            Else\n                strFolderpath = destinationFolderPath\n            End If\n\n        'Combine with the path to the folder\n            strFile = strFolderpath &amp; strFile\n\n        'Save the attachment as a file\n            objAttachments.Item(i).SaveAsFile strFile\n\n        'Calls the Unzip method to unzip the saved attachment\n        If isZipped = True Then\n            Call Unzip(strFile, destinationFolderPath)\n        End If\n\n\nNextAttachment:\n    Next i\nEnd If\n\n\nEnd Sub\n\n\nSub Unzip(ByVal strFile As Variant, ByVal destinationFolderPath As String)\n\nDim FSO, oApp As Object\nDim destinationPath As Variant\n\n'Sets the folderpath string as a variant\n    destinationPath = destinationFolderPath\n\n'Extract the files into the newly created folder\n    Set oApp = CreateObject(\"Shell.Application\")\n    oApp.NameSpace(destinationPath).CopyHere oApp.NameSpace(strFile).Items\n\n\n    On Error Resume Next\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n    FSO.deletefolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\n\nEnd Sub\n\n\n    Private Function IsInArray(ByVal stringToBeFound As String, ByVal arr As Variant) As Boolean\n      IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\n    End Function\n\nPrivate Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" (ByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\nPrivate Declare PtrSafe Function DeleteUrlCacheEntry Lib \"wininet.dll\" Alias \"DeleteUrlCacheEntryA\" (ByVal lpszUrlName As String) As Long\n\n\nSub LaunchURL(itm As MailItem, ByVal destinationPath As String)\n\n    Dim bodyString As String\n    Dim bodyStringSplitLine\n    Dim bodyStringSplitWord\n    Dim splitLine\n    Dim splitWord\n    Dim fileName, URL As String\n\n'Defines 'bodyString' as the body of text in the email\n    bodyString = itm.Body\n\n'Breaks the body copy into multiple lines\n    bodyStringSplitLine = Split(bodyString, vbCrLf)\n\n\n'Sets the desired name of the file ************ Edit here *******************\n    fileName = \"MySender--\" &amp; Format(Now(), \"yyyy-mm-dd--hh-mm-ss\") &amp; \".csv\"\n\n\n'Loop to run through ever line in the email and split it into a bunch of words\n    For Each splitLine In bodyStringSplitLine\n        bodyStringSplitWord = Split(splitLine, \" \")\n\n\n        'Loop to run through ever word in the line, and test whether it's the link we are looking for\n        For Each splitWord In bodyStringSplitWord\n\n            'A test to see whther the word is the URL link that we are looking for *************************** Edit here **********************************\n            If Left(splitWord, 34) = \"&lt;https://myURLtobedownloaded.com/\" Then\n\n                'Deletes the \"&lt;&gt;\" from the URL\n                URL = splitWord\n                URL = Replace(Replace(URL, \"&lt;\", \"\"), \"&gt;\", \"\")\n\n                'If the word is the URL link, then it calls the function DownloadFileFromWeb and saves it to the destination folder\n                Call DownloadFileFromWeb(URL, destinationPath &amp; fileName)\n\n            End If\n        Next\n\n    Next\n\n    Set itm = Nothing\n\nEnd Function\n\n\nPrivate Function DownloadFileFromWeb(URL As String, SavePath As String) As Boolean\nDim MyLink As String\nDim Ret As Long\n\n'First delete the file from cache:\n    DeleteUrlCacheEntry URL\n\n'Download the file and return result:\n    DownloadFileFromWeb = False\n    Ret = URLDownloadToFile(0, URL, SavePath, 0, 0)\n    DoEvents\n\n    If Ret = 0 Then DownloadFileFromWeb = True\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5754497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a62f98bba6ac925e43e8b718d0d3c26?s=128&d=identicon&r=PG&f=1", "display_name": "Matty mataytay", "link": "https://stackoverflow.com/users/5754497/matty-mataytay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1566, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529390114, "creation_date": 1452116655, "last_edit_date": 1592644375, "question_id": 34643398, "link": "https://stackoverflow.com/questions/34643398/using-vba-in-outlook-to-automatically-download-zip-floders-onto-computer", "title": "Using VBA in outlook to automatically download Zip floders onto computer", "body": "<p>I want to use VBA in Outlook to download a series of zip files. I have coded up to the point where it successfully go through all the emails in my subfolder and download whatever attachment is inside. It tested it on an excel attachment and it worked well.</p>\n<p>However the files that I am trying to download are Zip files.</p>\n<p>When I run the script on emails containing Zips I get this weird looking file.</p>\n<h3>screen shot of weird looking result</h3>\n<p><img src=\"https://i.stack.imgur.com/4KHAg.jpg\" alt=\"screen shot of weird looking result\" /></p>\n<p>below is my code.\nPlease help!</p>\n<pre><code>Sub GetAttachments()\n    'declaring an error statement\n    On Error GoTo GetAttachments_err\n        \n    'Declaring my variables\n    'NameSpace: Obj tha gives you access to all outlooks folders\n    Dim ns As NameSpace\n    'This will refer to a mail folder\n    Dim Inbox As MAPIFolder\n    Dim Item As Object\n    'Attachment we are looking for\n    Dim Atmt As Attachment\n    'Used to create a name and save path for each attachment as it is saved.\n    Dim FileName As String\n    'Counter to log the progress of the macro\n    Dim i As Integer\n    'to look in the subfliter i am filtering all the exception reports to\n    Dim SubFolder As MAPIFolder\n    \n    'setting the variables\n    Set ns = GetNamespace(&quot;MAPI&quot;)\n    Set Inbox = ns.GetDefaultFolder(olFolderInbox)\n    Set SubFolder = Inbox.Folders(&quot;Post-Algo: Mapping Exception Reports&quot;)\n    i = 0\n    \n    'if statment to check if there are any messages in the inbox folder and abandon search if there are none.\n    If SubFolder.Items.Count = 0 Then\n        MsgBox &quot;There are no messages in the Inbox.&quot;, vbInformation, _\n           &quot;Nothing Found&quot;\n        Exit Sub\n    End If\n    \n    'starts looking for attachments if there are items in the file\n    If SubFolder.Items.Count &gt; 0 Then\n        'looks at each item in the inbox\n        For Each Item In SubFolder.Items\n            'looks at each attachment\n            For Each Atmt In Item.Attachments\n                'creates a file name by appending the fiel name\n                'remember to change the path to the desired location and to creat the file path.\n                FileName = &quot;H:\\exceptionDownload\\&quot; &amp; Item.Subject &amp; &quot; &quot; &amp; i &amp; Atmt.FileName\n                'saves the file under that name.\n                Atmt.SaveAsFile FileName\n                'increment the log variable.\n                i = i + 1\n            Next Atmt\n        Next Item\n    End If\n    \n    \n    If i &gt; 0 Then\n        MsgBox &quot;I found &quot; &amp; i &amp; &quot; attached files.&quot; _\n           &amp; vbCrLf &amp; &quot;I have saved them into the H:\\exceptionDownload\\.&quot; _\n           &amp; vbCrLf &amp; vbCrLf &amp; &quot;Have a nice day.&quot;, vbInformation, &quot;Finished!&quot;\n    Else\n        MsgBox &quot;I didn't find any attached files in your mail.&quot;, vbInformation, _\n        &quot;Finished!&quot;\n    End If\n    \n' Clear the values of the variables\nGetAttachments_exit:\n   Set Atmt = Nothing\n   Set Item = Nothing\n   Set ns = Nothing\n   Exit Sub\n\n'error handling\nGetAttachments_err:\n   MsgBox &quot;An unexpected error has occurred.&quot; _\n      &amp; vbCrLf &amp; &quot;Please note and report the following information.&quot; _\n      &amp; vbCrLf &amp; &quot;Macro Name: GetAttachments&quot; _\n      &amp; vbCrLf &amp; &quot;Error Number: &quot; &amp; Err.Number _\n      &amp; vbCrLf &amp; &quot;Error Description: &quot; &amp; Err.Description _\n      , vbCritical, &quot;Error!&quot;\n   Resume GetAttachments_exit\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "grouping"], "comments": [{"owner": {"reputation": 1, "user_id": 5754429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e2321230b9d0fa7e776ba060d353ef?s=128&d=identicon&r=PG&f=1", "display_name": "msu50000", "link": "https://stackoverflow.com/users/5754429/msu50000"}, "edited": false, "score": 0, "creation_date": 1452184989, "post_id": 34643105, "comment_id": 57066453, "body": "Thank you to Rick Smith for getting the images in there."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5754429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e2321230b9d0fa7e776ba060d353ef?s=128&d=identicon&r=PG&f=1", "display_name": "msu50000", "link": "https://stackoverflow.com/users/5754429/msu50000"}, "edited": false, "score": 0, "creation_date": 1452200878, "post_id": 34661504, "comment_id": 57076052, "body": "Dave, thanks for the information. I&#39;ve been trying to use that towards what I&#39;m trying to accomplish, without much luck. Each record in the data I have is basically a data point, so for example: if company A shows up 20 times in the data with different addresses, company B shows up 15 times. I need those 20 records for Company A condensed into 1 with the number 20 in the next field. And so forth for Company B, C, D, etc..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "edited": false, "score": 0, "creation_date": 1452458151, "post_id": 34661504, "comment_id": 57167075, "body": "This should give you what you want.  <a href=\"http://www.techonthenet.com/access/functions/numeric/count.php\" rel=\"nofollow noreferrer\">techonthenet.com/access/functions/numeric/count.php</a>"}], "tags": [], "owner": {"reputation": 639, "user_id": 4598964, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10153689452664899/picture?type=large", "display_name": "Dave B", "link": "https://stackoverflow.com/users/4598964/dave-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1452187735, "creation_date": 1452187735, "answer_id": 34661504, "question_id": 34643105, "link": "https://stackoverflow.com/questions/34643105/sorting-totaling-and-grouping-by-state/34661504#34661504", "title": "Sorting, totaling and grouping by state", "body": "<p>You should have a look at this post, it might help you. </p>\n\n<p><a href=\"http://www.fontstuff.com/access/acctut04.htm\" rel=\"nofollow\">http://www.fontstuff.com/access/acctut04.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5754429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54e2321230b9d0fa7e776ba060d353ef?s=128&d=identicon&r=PG&f=1", "display_name": "msu50000", "link": "https://stackoverflow.com/users/5754429/msu50000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459413492, "creation_date": 1452115668, "last_edit_date": 1459413492, "question_id": 34643105, "link": "https://stackoverflow.com/questions/34643105/sorting-totaling-and-grouping-by-state", "title": "Sorting, totaling and grouping by state", "body": "<p>Very inexperienced MS Access 2013 user here. I have a large set of records I'm working with. The columns I'm working with are STATE and COMPANY NAME. There are hundreds of different company names and they change from week to week on my source excel file. They also duplicate themselves within each state, for instance: a certain company may have 15 records in one state and 2 in another</p>\n\n<p>What I'd like to be able to produce is a simple click report in Access so I can sort by State. For example, the data I'm pulling into access is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gdRX8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gdRX8.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is just an example of TX. I'd like Access to produce a report that looks like this for each state or group of states:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nXqY3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nXqY3.png\" alt=\"enter image description here\"></a></p>\n\n<p>As I said previously, the names of the companies will change week to week. They also will come and go. So one week ABC1 might not have any records and the next they could be back to 5. Any ideas on if this is possible with Access? I'd prefer not to sort with excel, I'd like to simply save the source file each week I get it and click on the report in Access. Thanks in advance for your time and energy, it is greatly appreciated. </p>\n"}, {"tags": ["r", "excel", "vba"], "comments": [{"owner": {"reputation": 12339, "user_id": 5020008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ephyn.png?s=128&g=1", "display_name": "Heroka", "link": "https://stackoverflow.com/users/5020008/heroka"}, "edited": false, "score": 0, "creation_date": 1452115624, "post_id": 34642908, "comment_id": 57032085, "body": "It can certainly be done in R; is there anything you&#39;ve already tried yourself?"}, {"owner": {"reputation": 25, "user_id": 5754436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437178e7e9585a161d84dd11385199b3?s=128&d=identicon&r=PG&f=1", "display_name": "kumar", "link": "https://stackoverflow.com/users/5754436/kumar"}, "reply_to_user": {"reputation": 12339, "user_id": 5020008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ephyn.png?s=128&g=1", "display_name": "Heroka", "link": "https://stackoverflow.com/users/5020008/heroka"}, "edited": false, "score": 0, "creation_date": 1452115686, "post_id": 34642908, "comment_id": 57032115, "body": "I used melt function but that gives first column and then the second column"}, {"owner": {"reputation": 12339, "user_id": 5020008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ephyn.png?s=128&g=1", "display_name": "Heroka", "link": "https://stackoverflow.com/users/5020008/heroka"}, "edited": false, "score": 1, "creation_date": 1452116085, "post_id": 34642908, "comment_id": 57032316, "body": "In R, <a href=\"http://stackoverflow.com/questions/12044616/alternate-interweave-or-interlace-two-vectors\">this</a> might be useful. You could try something like <code>c(t(as.matrix(dat)))</code>."}, {"owner": {"reputation": 4273, "user_id": 4380497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68532781248c6eb05994709155e27466?s=128&d=identicon&r=PG&f=1", "display_name": "ExperimenteR", "link": "https://stackoverflow.com/users/4380497/experimenter"}, "edited": false, "score": 0, "creation_date": 1452140374, "post_id": 34642908, "comment_id": 57040178, "body": "<code>data.frame(unlist(dat))</code>, or <code>stack(dat)</code> or <code>reshape2::melt(dat)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5754436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437178e7e9585a161d84dd11385199b3?s=128&d=identicon&r=PG&f=1", "display_name": "kumar", "link": "https://stackoverflow.com/users/5754436/kumar"}, "edited": false, "score": 0, "creation_date": 1452116130, "post_id": 34643212, "comment_id": 57032338, "body": "Simple and effective solution. Thanks"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1452116139, "last_edit_date": 1452116139, "creation_date": 1452116015, "answer_id": 34643212, "question_id": 34642908, "link": "https://stackoverflow.com/questions/34642908/how-to-merge-two-columns-into-one-column-with-each-entry-into-a-new-row-using-ma/34643212#34643212", "title": "How to merge two columns into one column with each entry into a new row using macro in excel?", "body": "<p>With data in columns <strong>A</strong> and <strong>B</strong>, in another cell enter:</p>\n\n<pre><code>=OFFSET($A$1,ROUNDUP(ROWS($1:1)/2,0)-1,MOD(ROWS($1:1)-1,2))\n</code></pre>\n\n<p>and copy down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OGhqX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OGhqX.png\" alt=\"enter image description here\"></a></p>\n\n<p>NOTE:</p>\n\n<p><strong>Any</strong> rectangular block of data can be mapped into a single column with formulas similar to this.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2071046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/249ce975349d0285e10ad3ec803aab2f?s=128&d=identicon&r=PG", "display_name": "user2071046", "link": "https://stackoverflow.com/users/2071046/user2071046"}, "is_accepted": false, "score": 0, "last_activity_date": 1452124325, "last_edit_date": 1452124325, "creation_date": 1452117020, "answer_id": 34643494, "question_id": 34642908, "link": "https://stackoverflow.com/questions/34642908/how-to-merge-two-columns-into-one-column-with-each-entry-into-a-new-row-using-ma/34643494#34643494", "title": "How to merge two columns into one column with each entry into a new row using macro in excel?", "body": "<p>If you are looking for a macro specifically, here is some quick VBA code to help:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MergeColumns()\n    'Declare some indexing variables\n    Dim a, b, c, x As Integer\n\n    ' x is where we want to put the column of merged numbers\n    x = 3\n\n    ' b is the index for which column to pickup\n    ' start this at 1\n    ' c is the row we wan to pick up, start it at 2\n    b = 1\n    c = 2\n\n    ' Next loop through all the numbers on the left side\n    For a = 2 To 7\n        ' first set our first cell to the correct value\n        Cells(a, x) = Cells(c, b)\n\n        ' now we change the indexes\n        If b = 1 Then\n            ' change to the next colum\n            b = 2\n        Else\n            ' otherwise b = 2 and we need to move rows\n            b = 1\n            c = c + 1\n        End If\n    Next a\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/hVnC8.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1452124387, "last_edit_date": 1452124387, "creation_date": 1452118676, "answer_id": 34643908, "question_id": 34642908, "link": "https://stackoverflow.com/questions/34642908/how-to-merge-two-columns-into-one-column-with-each-entry-into-a-new-row-using-ma/34643908#34643908", "title": "How to merge two columns into one column with each entry into a new row using macro in excel?", "body": "<p>Here is my answer, hope to help anyone. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub rangeToColumn()\n    Dim rng As Range\n    Dim i 'index of cells\n    Dim f\n\n    Set rng = Range(\"A1:B3\")\n    i = 0\n\n    For Each f In rng\n        i = i + 1\n        Cells(i, 3).Value = f.Value\n        'Cells({a}, {b}).Value = {c}\n        '\n        'a = the row you want to put the value, using the index will put the value in separated rows\n        'b = you can use the column you want, or used hardcoded as  I did.\n        'c = storing each cell into the c var, you will be able to take the values or any other property.\n    Next f\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1452125145, "creation_date": 1452125145, "answer_id": 34645187, "question_id": 34642908, "link": "https://stackoverflow.com/questions/34642908/how-to-merge-two-columns-into-one-column-with-each-entry-into-a-new-row-using-ma/34645187#34645187", "title": "How to merge two columns into one column with each entry into a new row using macro in excel?", "body": "<p>This formula uses Index.  Just for future reference, as it is similar to Gary's Students answer.  But Indirect is volatile, as in it will recalculate if there is any change.  The index formula will only reevaluate when the data it is referencing changes:</p>\n\n<pre><code>=INDEX($A$1:$B$3,QUOTIENT(ROW(1:1)-1,2)+1,MOD(ROW(1:1)+1,2)+1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bzVNN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bzVNN.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 5754436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437178e7e9585a161d84dd11385199b3?s=128&d=identicon&r=PG&f=1", "display_name": "kumar", "link": "https://stackoverflow.com/users/5754436/kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 0, "accepted_answer_id": 34643212, "answer_count": 4, "score": 0, "last_activity_date": 1452125145, "creation_date": 1452114989, "last_edit_date": 1531161705, "question_id": 34642908, "link": "https://stackoverflow.com/questions/34642908/how-to-merge-two-columns-into-one-column-with-each-entry-into-a-new-row-using-ma", "title": "How to merge two columns into one column with each entry into a new row using macro in excel?", "body": "<p>I have data in excel in the following format:<br>\n|4  | 5|<br>\n|8  | 3|<br>\n|6  | 2|</p>\n\n<p>and I want output in the form:<br>\n4<br>\n5<br>\n8<br>\n3<br>\n6<br>\n2<br>\nHow this could be done using Macro in excel? Or can it be done using dataframe in R?</p>\n"}, {"tags": ["vba", "outlook", "outlook-addin", "outlook-2016"], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": false, "score": 0, "last_activity_date": 1452116694, "last_edit_date": 1495542681, "creation_date": 1452116694, "answer_id": 34643413, "question_id": 34642844, "link": "https://stackoverflow.com/questions/34642844/choose-subject-for-outlook-mail/34643413#34643413", "title": "Choose subject for Outlook mail", "body": "<p>I am not aware of a way of doing this directly in an outlook mail, but it is possible to write a VBA macro to create the email and do the drop down. Here's a link that'll get you started:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22747284/open-new-message-in-outlook-by-excel-vba\">Open new message in Outlook by Excel VBA</a></p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1452158396, "creation_date": 1452158396, "answer_id": 34651338, "question_id": 34642844, "link": "https://stackoverflow.com/questions/34642844/choose-subject-for-outlook-mail/34651338#34651338", "title": "Choose subject for Outlook mail", "body": "<p>No, it is not. The Outlook extensibility model doesn't provide anything for that. </p>\n\n<p>As for the Ribbon, Outlook doesn't support Fluent UI customizations from VBA macros. You may consider developing an add-in instead where you can:</p>\n\n<ol>\n<li>Add a custom ribbon controls. See <a href=\"https://msdn.microsoft.com/en-us/library/bb386104.aspx\" rel=\"nofollow\">Walkthrough: Creating a Custom Tab by Using the Ribbon Designer</a>.</li>\n<li>Create a form region where you can choose subject lines. See <a href=\"https://msdn.microsoft.com/en-us/library/bb386301.aspx\" rel=\"nofollow\">Creating Outlook Form Regions</a>.</li>\n<li>Use Windows API functions for subclassing Outlook windows and placing custom forms on top of the window (right below the subject line). See <a href=\"https://code.msdn.microsoft.com/windowsdesktop/Creating-Adjacent-Windows-00090e4a\" rel=\"nofollow\">Creating Adjacent Windows In Outlook</a> .</li>\n<li>Or use third-party components for creating such forms. See <a href=\"https://www.add-in-express.com/add-in-net/outlook-regions.php\" rel=\"nofollow\">Advanced Outlook view and form regions</a> for more inforamtion. </li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 5368753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1dd4aa9bfa0a408649fb03ec759203b?s=128&d=identicon&r=PG&f=1", "display_name": "Joep", "link": "https://stackoverflow.com/users/5368753/joep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 34651338, "answer_count": 2, "score": 0, "last_activity_date": 1593517766, "creation_date": 1452114766, "last_edit_date": 1593517766, "question_id": 34642844, "link": "https://stackoverflow.com/questions/34642844/choose-subject-for-outlook-mail", "title": "Choose subject for Outlook mail", "body": "<p>Is it possible to make a dropdown menu in outlook mail for selecting subject title from it? Subject titles will be taken from an excel list.  Near the subject title that has come automatically into the subject line, I would like to be able to type something else.</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5668272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65649a0af44d344810a3bf5eced7390e?s=128&d=identicon&r=PG&f=1", "display_name": "D.Hio", "link": "https://stackoverflow.com/users/5668272/d-hio"}, "edited": false, "score": 0, "creation_date": 1452156756, "post_id": 34648265, "comment_id": 57046697, "body": "Thanks for the tip with Slicer. I probably overcomplicated the task I had. One last question: is there a way to add multiple selections for the slicer? I added the Slicer but the problem is that I can select only one company at once. Thanks a lot!"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 0, "last_activity_date": 1452146854, "last_edit_date": 1452146854, "creation_date": 1452146230, "answer_id": 34648265, "question_id": 34642459, "link": "https://stackoverflow.com/questions/34642459/vba-run-macro-to-manipulate-a-pivot-on-values-in-3-different-drop-down-cells/34648265#34648265", "title": "VBA: run macro to manipulate a pivot on values in 3 different drop down cells", "body": "<p>For the scheme and company fields an easy way to do this without vba is to either simply use slicers,  or use a separate pivot connected to the first via a slicer that has nothing but those two fields in it as page fields,  because these behave pretty much exactly as drop downs. I've outlined this further at <a href=\"http://dailydoseofexcel.com/archives/2014/08/16/sync-pivots-from-dropdown/\" rel=\"nofollow\">http://dailydoseofexcel.com/archives/2014/08/16/sync-pivots-from-dropdown/</a>. In fact is there any reason why you don't simply add them as page fields on the main pivot and allow users to filter it directly? </p>\n\n<p>Dynamically choosing what to display in the values fields is pretty easy, but I can't post code right now because I'm on holiday without a laptop.  Is there any reason why you don't simply show both? The user can simply ignore the one they don't need. Plus it saves them from having to use the drop down in the event that they want to see both. </p>\n"}], "owner": {"reputation": 3, "user_id": 5668272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65649a0af44d344810a3bf5eced7390e?s=128&d=identicon&r=PG&f=1", "display_name": "D.Hio", "link": "https://stackoverflow.com/users/5668272/d-hio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 34648265, "answer_count": 1, "score": 0, "last_activity_date": 1452146854, "creation_date": 1452113275, "last_edit_date": 1531161705, "question_id": 34642459, "link": "https://stackoverflow.com/questions/34642459/vba-run-macro-to-manipulate-a-pivot-on-values-in-3-different-drop-down-cells", "title": "VBA: run macro to manipulate a pivot on values in 3 different drop down cells", "body": "<p>I am relatively new to VBA.</p>\n\n<p>I have a <code>PivotTable</code> summing the data from another Excel sheet. It has 3 data fields: <code>fees</code>, <code>items</code> and <code>volume</code> for companies from \u201da\u201d to \u201di\u201d. The pivot has also 2 report filters (scheme and category).</p>\n\n<p>Now what I basically need to do is to run following macros depending on values in the dropdown:</p>\n\n<ol>\n<li>set the filter in the \u201dscheme\u201d report filter depending on the value in the respective dropdown</li>\n<li>delete all the rows in the pivot except the company from the respective dropdown </li>\n<li>delete the data fields in the pivot except the one mentioned in the respective drop-down.</li>\n</ol>\n\n<p>I found solutions for setting filters in pivot, for deleting the rows and deleting/adding data fields. My problem is to make it work depending on the dropdowns. </p>\n\n<p>I also found the solution for making it work on one drop-down. The question I have is how to approach the problem with 3 drop/downs?</p>\n\n<p>Thanks in advance, any help would be really appreciated! </p>\n\n<p>[<img src=\"https://i.stack.imgur.com/OINOs.png\" alt=\"This image should show what I am attempting to do:\">]</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1452124229, "post_id": 34644541, "comment_id": 57035911, "body": "I like the solution a lot, the only problem is I am designing a template for co-workers to use, and I want there to be as few compatibility issues as possible when I pass the file around. Is there an internal way of accomplishing the same thing?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1452125605, "post_id": 34644541, "comment_id": 57036307, "body": "On the assumption you don&#39;t want to require the user to add a printer, updated code to use file generation code"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1452125672, "last_edit_date": 1452125672, "creation_date": 1452121489, "answer_id": 34644541, "question_id": 34642387, "link": "https://stackoverflow.com/questions/34642387/how-to-save-each-individual-sheet-as-a-txt-file/34644541#34644541", "title": "how to save each individual sheet as a txt file", "body": "<p>You can use a Generic Text printer, and the <code>PrintOut</code> method to achieve this</p>\n\n<p>First, if you havn't already, add a Generic Text Printer</p>\n\n<ol>\n<li>From <code>Add Printer</code> dialog, select <code>File</code> port</li>\n<li>Select <code>Generic</code> then <code>Generic / Text Only</code></li>\n<li>Name it as you wish</li>\n</ol>\n\n<p>This code sends each worksheet to this printer</p>\n\n<pre><code>Sub SaveWorkbookAsText(wb As Workbook, Optional FldName As String = vbNullString)\n    Dim NewPath As String\n    Dim GenericTextOnlyPrinter As String\n    Dim ws As Worksheet\n\n    '&lt;~~~ Change this string to match your Generic Text Only Printer Name\n    GenericTextOnlyPrinter = \"Text Only (File)\"\n\n    NewPath = ThisWorkbook.Path &amp; Application.PathSeparator\n\n    If FldName &lt;&gt; vbNullString Then\n        NewPath = NewPath &amp; FldName\n        If Right$(NewPath, 1) &lt;&gt; Application.PathSeparator Then\n            NewPath = NewPath &amp; Application.PathSeparator\n        End If\n    End If\n\n    For Each ws In wb.Worksheets\n        ws.PrintOut _\n          ActivePrinter:=GenericTextOnlyPrinter, _\n          PrintToFile:=True, _\n          PrToFileName:=NewPath &amp; ws.Name &amp; \".txt\", _\n          IgnorePrintAreas:=True\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Alternatively, without depending on a printer, generate the file in code</p>\n\n<pre><code>Sub SaveWorkbookAsText(wb As Workbook, Optional FldName As String = vbNullString)\n    Dim NewPath As String\n    Dim ws As Worksheet\n    Dim dat As Variant\n    Dim rw As Long, cl As Long\n    Dim FileNum As Integer\n    Dim Line As String\n\n    NewPath = ThisWorkbook.Path &amp; Application.PathSeparator\n\n    If FldName &lt;&gt; vbNullString Then\n        NewPath = NewPath &amp; FldName\n        If Right$(NewPath, 1) &lt;&gt; Application.PathSeparator Then\n            NewPath = NewPath &amp; Application.PathSeparator\n        End If\n    End If\n\n    For Each ws In wb.Worksheets\n        FileNum = FreeFile\n        Open NewPath &amp; ws.Name &amp; \".txt\" For Output As #FileNum    ' creates the file\n\n        dat = ws.UsedRange.Value\n        ' in case the sheet contains only 0 or 1 cells\n        If TypeName(dat) &lt;&gt; \"Variant()\" Then\n            dat = ws.UsedRange.Resize(, 2)\n        End If\n\n        For rw = 1 To UBound(dat, 1)\n            Line = vbNullString\n            For cl = 1 To UBound(dat, 2) - 1\n                Line = Line &amp; dat(rw, cl) &amp; vbTab\n            Next\n            Print #FileNum, Line &amp; dat(rw, cl)\n        Next\n        Close #FileNum\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 34644541, "answer_count": 1, "score": 1, "last_activity_date": 1452125672, "creation_date": 1452113009, "question_id": 34642387, "link": "https://stackoverflow.com/questions/34642387/how-to-save-each-individual-sheet-as-a-txt-file", "title": "how to save each individual sheet as a txt file", "body": "<p>I have a code that creates sheets in a certain format that I then want to save as text files. I have been using Sheet.SaveAs and then naming the file differently. Is there a more robust way of saving files and moving them around? My current code runs as follows:</p>\n\n<pre><code>    OldPath = ThisWorkbook.Path &amp; \"\\\"     ' current path to this workbook\n    OldFile = OldPath &amp; ShtName &amp; \".txt\"  ' location of file upon creation\n\n    NewPath = OldPath &amp; FldName &amp; \"\\\"     ' path for the folder where file will be moved\n    NewFile = NewPath &amp; ShtName &amp; \".txt\"  ' location of file after moving\n                                                                                             '[3] CREATE INPUT FILES\n    ThisWorkbook.Sheets(ShtName).SaveAs OldFile, FileFormat:=xlTextWindows\n    ThisWorkbook.SaveAs OldPath &amp; ThisFileName, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n\n    If Len(Dir(NewPath, vbDirectory)) &lt;&gt; 0 And NewPath &lt;&gt; \"\" Then  'MOVE FILES TO A FOLDER\n    Else\n        MkDir NewPath  ' create folder for input files to be moved if not yet created\n    End If\n\n    If Len(Dir(NewFile)) &lt;&gt; 0 Then  \n    ' delete an old version of file if it is already in folder\n        SetAttr NewFile, vbNormal\n        Kill NewFile\n    End If\n\n    Name OldFile As NewFile \n</code></pre>\n\n<p>This method feels cumbersome but I don't want to have to resort to using Shell, as I feel that would be less robust, unless someone recommends that instead.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "edited": false, "score": 1, "creation_date": 1452114084, "post_id": 34642368, "comment_id": 57031285, "body": "Correct me if I&#39;m wrong but if you want to only trigger the updating of other workbooks after you leave a row you need to establish exactly what condition you want that to be. For example you could add a check before your message box to see if the currently selected cell is still on the same row and if it isn&#39;t then run the update. Is  something like that what you are wanting?"}, {"owner": {"reputation": 153, "user_id": 5754299, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153876240694600/picture?type=large", "display_name": "Sebastian Araneda", "link": "https://stackoverflow.com/users/5754299/sebastian-araneda"}, "reply_to_user": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "edited": false, "score": 0, "creation_date": 1452114508, "post_id": 34642368, "comment_id": 57031484, "body": "No, that message box is only a leftover from a code I took from elsewhere.  What I need is that, if you edit some cells from the same row, nothing happens, but when you select a cell in another row, I need it to open the other workbook and update some information there with the changes in the row.  I could leave it like that, but since each row represents a specific company project, all that opening and closing of Workbooks would be very annoying if someone just wants to update one project."}, {"owner": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "edited": false, "score": 1, "creation_date": 1452115745, "post_id": 34642368, "comment_id": 57032142, "body": "Then yes, you mean what I was saying. I was referring to the msg box location as the location for the check, either built into the existing if statement or as a nested if statement before any of the actual update code was run."}], "answers": [{"comments": [{"owner": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "edited": false, "score": 0, "creation_date": 1452123096, "post_id": 34644772, "comment_id": 57035525, "body": "Thanks for posting this. I got sidetracked at work and didn&#39;t get around to posting it myself."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "edited": false, "score": 0, "creation_date": 1452124278, "post_id": 34644772, "comment_id": 57035926, "body": "@Bryan No problem.  Figured something like that as you obviously knew what you were doing."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1452122691, "creation_date": 1452122691, "answer_id": 34644772, "question_id": 34642368, "link": "https://stackoverflow.com/questions/34642368/running-a-vba-code-whenever-you-change-the-row-youre-editing/34644772#34644772", "title": "Running a VBA code whenever you change the row you&#39;re editing", "body": "<p>Use a global variable in the worksheet module to accomplish this.  The currRow variable is set to 0 when the sheet is activated (in case you switch to another sheet).  Then check the row of the target vs. the row previously on.</p>\n\n<pre><code>Private currRow As Long\n\nPrivate Sub Worksheet_Activate()\n\n    currRow = 0\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If currRow = Target.Row Then\n       'Do Nothing\n    Else\n       If currRow &lt;&gt; 0 Then\n                 'Do Rest of code then set the target to the new row\n       End If\n       currRow = Target.Row\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5754299, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153876240694600/picture?type=large", "display_name": "Sebastian Araneda", "link": "https://stackoverflow.com/users/5754299/sebastian-araneda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 34644772, "answer_count": 1, "score": 0, "last_activity_date": 1452122691, "creation_date": 1452112929, "last_edit_date": 1452113119, "question_id": 34642368, "link": "https://stackoverflow.com/questions/34642368/running-a-vba-code-whenever-you-change-the-row-youre-editing", "title": "Running a VBA code whenever you change the row you&#39;re editing", "body": "<p>I need to run a code in excel VBA whenever you change the row you're working on.</p>\n\n<p>My code updates other Workbooks whenever you edit something, but since all the information in a row is supposed to update 1 Workbook, I want it to open and update that other Workbook only when you stop working in a row (any row)</p>\n\n<p>Right now I have a code that updates the other workbook when I change a cell, so this is what I have.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"A1:C10\")\n    Dim WB As Workbook\n    Dim dirFile As String\n    Dim strFile As String\n    Dim Actual As Workbook\n    Static lngRow As Long\n    Dim linea\n    Set Actual = ActiveWorkbook\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n        MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n        dirFile = \"N:\\Otros\\sebastian\\TEST 2\\\"\n        strFile = Trim(Cells(Target.Row, 1).Value)\n        If Len(Dir(dirFile &amp; strFile &amp; \".xlsx\")) = 0 Then\n            Application.Visible = False\n\n            linea = Target.Row\n            Set WB = Workbooks.Add\n            ' ESTILO\n            ' __________________________\n            WB.Worksheets(1).Columns(\"A\").ColumnWidth = 28\n            ' ___________________________\n            'DATOS\n            '____________________________\n\n            WB.Worksheets(1).Cells(1, 1).Value = \"Titulo de Proyecto\"\n            WB.Worksheets(1).Cells(1, 2).Value = Actual.Worksheets(1).Cells(linea, 2)\n            WB.SaveAs (dirFile &amp; strFile &amp; \".xlsx\")\n            WB.Close\n            Application.Visible = True\n\n\n        End If\n\n\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1452119515, "post_id": 34642819, "comment_id": 57034076, "body": "In addition to that, you must use <code>Private Declare</code> in a form module, or put it into a public module."}, {"owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "edited": false, "score": 0, "creation_date": 1452177053, "post_id": 34642819, "comment_id": 57060594, "body": "I did the changes, still same issue"}, {"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1452178324, "post_id": 34642819, "comment_id": 57061522, "body": "I&#39;d suggest you check again, as the above example works fine for me once I put <code>Private Declare</code> instead of <code>Declare</code> for the function"}], "tags": [], "owner": {"reputation": 6051, "user_id": 62477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5de80ba94b348835287cdb2ea8f3a9c?s=128&d=identicon&r=PG", "display_name": "HardCode", "link": "https://stackoverflow.com/users/62477/hardcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1452114689, "creation_date": 1452114689, "answer_id": 34642819, "question_id": 34642312, "link": "https://stackoverflow.com/questions/34642312/ms-access-vba-error/34642819#34642819", "title": "Ms- Access, VBA Error", "body": "<p>Your <code>Declare Function</code> statement needs to be outside (above) <code>Private Sub Command0_Enter()</code>.</p>\n"}], "owner": {"reputation": 3158, "user_id": 580950, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/de4ca8cc3d001e153e0e5ef0289467cf?s=128&d=identicon&r=PG", "display_name": "user580950", "link": "https://stackoverflow.com/users/580950/user580950"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452177093, "creation_date": 1452112688, "last_edit_date": 1452177093, "question_id": 34642312, "link": "https://stackoverflow.com/questions/34642312/ms-access-vba-error", "title": "Ms- Access, VBA Error", "body": "<p>I have written the following code on click of a button in a Form, which should return current screen size in Ms-Access</p>\n\n<pre><code>Option Compare Database\n\nDeclare Function GetSystemMetrics32 Lib \"User32\" _\n    Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n\n\nPrivate Sub Command0_Enter()\n\n\nDim w As Long, h As Long\n    w = GetSystemMetrics32(0) ' width in points\n    h = GetSystemMetrics32(1) ' height in points\n\nEnd Sub\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<blockquote>\n  <p>The expression On Open you entered as the event property setting\n  produced the following error: Only comments may appear after End Sub,\n  End Function or end property</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/F4wwX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4wwX.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "edited": false, "score": 1, "creation_date": 1452440740, "post_id": 34643322, "comment_id": 57160685, "body": "I think something like this will get you going in the right direction.  <a href=\"http://www.fontstuff.com/access/acctut18.htm\" rel=\"nofollow noreferrer\">fontstuff.com/access/acctut18.htm</a>  OR  <a href=\"http://www.fontstuff.com/access/acctut19.htm\" rel=\"nofollow noreferrer\">fontstuff.com/access/acctut19.htm</a>"}], "tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": true, "score": 0, "last_activity_date": 1452116408, "last_edit_date": 1495535288, "creation_date": 1452116408, "answer_id": 34643322, "question_id": 34641999, "link": "https://stackoverflow.com/questions/34641999/select-multiple-items-from-listbox-to-attach-in-email/34643322#34643322", "title": "Select Multiple Items from Listbox to Attach in Email", "body": "<p>Try these two links:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2933113/access-2007-cycling-through-values-in-a-list-box-vba\">cycling through values in a MS Access list box</a></p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/827423\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/827423</a></p>\n\n<p>They show two different ways of processing multiple listbox selections.</p>\n"}], "owner": {"reputation": 47, "user_id": 5103793, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-bWGNXKsd0d4/AAAAAAAAAAI/AAAAAAAAADc/dqLQEyupGTE/photo.jpg?sz=128", "display_name": "JB28", "link": "https://stackoverflow.com/users/5103793/jb28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "accepted_answer_id": 34643322, "answer_count": 1, "score": 0, "last_activity_date": 1593517797, "creation_date": 1452111573, "last_edit_date": 1593517797, "question_id": 34641999, "link": "https://stackoverflow.com/questions/34641999/select-multiple-items-from-listbox-to-attach-in-email", "title": "Select Multiple Items from Listbox to Attach in Email", "body": "<p>I've built a database that holds multiple files, such as user manuals. One of the forms I created in Access is a search field which uses queries to find the particular file the user's looking for. The search narrows the results into a list box, upon which double clicking will open the file for you. The results are also narrowed down into tabs based on the type of document. I've implemented a feature that if you single select the (file) result to highlight it and then click on a button, it inserts that file into a new message in MS Outlook. This works great but I want to select more than just one file in the same email. I've been searching everywhere online and can't seem to find the proper solution. I'll list my code below. </p>\n\n<p>This first piece is coded in my search form.</p>\n\n<pre><code>Private Sub cmdEMail_Click()\n\nDim fpath As String\n\n'Find out what tab user is on\nSelect Case Me!tabResults.Value\nCase 0\n    If IsNull(lstManResults.Column(5, lstManResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstManResults.Column(5, lstManResults.ListIndex)\n    End If\nCase 1\n    If IsNull(lstBullResults.Column(5, lstBullResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstBullResults.Column(5, lstBullResults.ListIndex)\n    End If\nCase 2\n    If IsNull(lstSubResults.Column(5, lstSubResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstSubResults.Column(5, lstSubResults.ListIndex)\n    End If\nCase 3\n        If IsNull(lstPicResults.Column(5, lstPicResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstPicResults.Column(5, lstPicResults.ListIndex)\n    End If\nCase 4\n    If IsNull(lstWarrResults.Column(5, lstWarrResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstWarrResults.Column(5, lstWarrResults.ListIndex)\n    End If\nCase 5\n    If IsNull(lstPartResults.Column(5, lstPartResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstPartResults.Column(5, lstPartResults.ListIndex)\n    End If\nCase 6\n    If IsNull(lstSchemResults.Column(5, lstSchemResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstSchemResults.Column(5, lstSchemResults.ListIndex)\n    End If\nCase 7\n    If IsNull(lstAppResults.Column(5, lstAppResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstAppResults.Column(5, lstAppResults.ListIndex)\n    End If\nCase 8\n    If IsNull(lstSpecResults.Column(5, lstSpecResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstSpecResults.Column(5, lstSpecResults.ListIndex)\n    End If\nCase 9\n    If IsNull(lstInternalResults.Column(5, lstInternalResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstInternalResults.Column(5, lstInternalResults.ListIndex)\n    End If\nCase 10\n    If IsNull(lstAddenSuppResults.Column(5, lstAddenSuppResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstAddenSuppResults.Column(5, lstAddenSuppResults.ListIndex)\n    End If\nCase 11\n    If IsNull(lstVideoResults.Column(5, lstVideoResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstVideoResults.Column(5, lstVideoResults.ListIndex)\n    End If\nCase 12\n    If IsNull(lstTechTipsResults.Column(5, lstTechTipsResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstTechTipsResults.Column(5, lstTechTipsResults.ListIndex)\n    End If\nCase 13\n    If IsNull(lstArchiveResults.Column(5, lstArchiveResults.ListIndex)) Then\n        Exit Sub\n    Else\n        fpath = lstArchiveResults.Column(5, lstArchiveResults.ListIndex)\n    End If\nEnd Select\n\nEmailDoc fpath\n\nEnd Sub\n</code></pre>\n\n<p>This code is the function I created to handle the email operations:</p>\n\n<pre><code>Function EmailDoc(ByVal fpath As String)\n\n'Get Outlook if it isn't open already\nSet outlookApp = CreateObject(\"Outlook.Application\")\nSet outlookItem = outlookApp.CreateItem(0)\n\nIf Err &lt;&gt; 0 Then\n    'Outlook wasn't running, start it\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n    Started = True\nEnd If\n\nWith outlookItem\n    .to = \"\"\n    .Subject = \"Requested Document\"\n    .Body = \"Thank you\"\n    .attachments.Add (fpath)\n\n    .display\n\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Any help at all would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "spreadsheet"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1452111138, "post_id": 34641851, "comment_id": 57029631, "body": "The variable would end up with the formula and not the result of said formula.  So say in Cell(1,1) there is a formula <code>=Sum(1,1)</code>,  the <code>.Value</code> would return 2 but the <code>.Formula</code> would return <code>=Sum(1,1)</code> as a string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1452111371, "post_id": 34641851, "comment_id": 57029781, "body": "Here are some links in a rough order of relevancy to your question: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">Range.Value property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow noreferrer\">Range.Formula property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217.aspx\" rel=\"nofollow noreferrer\">Range.Text property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553.aspx\" rel=\"nofollow noreferrer\">Range.Value2 property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a>"}, {"owner": {"reputation": 753, "user_id": 2379922, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kU1l6.jpg?s=128&g=1", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/2379922/justin-l"}, "edited": false, "score": 0, "creation_date": 1452111868, "post_id": 34641851, "comment_id": 57030095, "body": "So when you do <code>Cell(1,1).Value</code> is <code>Cell</code> considered some type of subset of <code>Range</code>? Because I did see those <i>Range</i> properties, but didn&#39;t realize they were related to <i>Cell</i>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1452111908, "post_id": 34641851, "comment_id": 57030120, "body": "I would tend to disagree with &#39;the video&#39;. The close relationship (interchangeability) between Range.Value and Range.Formula would seem to dictate that the formula is going to be stuffed into <code>cellVal1</code> not the formula&#39;s result (aka .Value). If <code>cellVal1</code> was a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a> then that cell would be be gaining a formula, not the formula&#39;s result. I guess that can be expected from someone using <code>Row</code> as a variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1452112098, "post_id": 34641851, "comment_id": 57030226, "body": "For <b>almost all</b> intents and purposes, <code>Cells(&lt;row&gt;, &lt;column&gt;)</code> can be treated as a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a> with all the inherent properties and methods attached. The primary difference is in the method of defining the scope. Range can be readily more than a single cell but Cells requires the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa176182%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Cells.Resize</a> to be more than a single cell."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1452112216, "post_id": 34642119, "comment_id": 57030281, "body": "Big <b>plus</b> for avoiding the use of <b>Row</b> as a variable the way &#39;the video&#39; did."}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 5, "last_activity_date": 1452112219, "last_edit_date": 1452112219, "creation_date": 1452112017, "answer_id": 34642119, "question_id": 34641851, "link": "https://stackoverflow.com/questions/34641851/what-is-worksheet-cellsrow-col-formula/34642119#34642119", "title": "What is worksheet.Cells(row,col).Formula", "body": "<p>The <code>.formula</code> part takes the formula inside the cell and <code>.value</code> only take the value you can see. </p>\n\n<p><a href=\"https://i.stack.imgur.com/2uw84.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2uw84.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>A1 = 2\nA2 = 4\nA3 = 6\n</code></pre>\n\n<p>In <code>A3</code> there is a formula <code>=A1+A2</code> if you use <code>.formula</code>, to put the formula inside <code>cellVal1</code> using <code>cellVal1 = Cells(3, 1).Formula</code> (that is equal to <code>Range(\"A3\").formula</code>) you get <code>=A1+A2</code>, but if you use <code>.value</code> you got <code>6</code>. Remember if you try to store a string inside a int type varible, you get an error, because the formula is a string. </p>\n\n<p>TIP: if you use <code>.formulaR1C1</code> you'll get <code>=R[-2]C+R[-1]C</code></p>\n"}], "owner": {"reputation": 753, "user_id": 2379922, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kU1l6.jpg?s=128&g=1", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/2379922/justin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4991, "favorite_count": 1, "accepted_answer_id": 34642119, "answer_count": 1, "score": 5, "last_activity_date": 1452112391, "creation_date": 1452111001, "last_edit_date": 1452112391, "question_id": 34641851, "link": "https://stackoverflow.com/questions/34641851/what-is-worksheet-cellsrow-col-formula", "title": "What is worksheet.Cells(row,col).Formula", "body": "<p>I was watching a <a href=\"https://www.youtube.com/watch?v=deUsurvhesM\" rel=\"nofollow\">tutorial</a> for comparing two excel worksheets and came across this:</p>\n\n<pre><code>cellVal1 = ws1.Cells(row, col).Formula\n</code></pre>\n\n<p>In the video he says that this assigns the value of the specified cell to the <code>cellVal1</code>. I've only seen people use <code>ws.Cells(row, col).Value</code> and can't seem to find anything about <code>.Formula</code> with regards to <code>.Cells(&lt;row&gt;,&lt;col&gt;)</code></p>\n\n<p>What does <code>.Formula</code> do and is it different than <code>.Value</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1452112475, "post_id": 34641823, "comment_id": 57030424, "body": "A quick google search pulled this <a href=\"http://www.excelforum.com/excel-general/513885-how-to-select-one-by-one-picture-on-my-sheet-with-vba.html\" rel=\"nofollow noreferrer\">forum post</a> up. Then you&#39;ll just need to grab the <code>.Name</code> property to get the name. I didn&#39;t see anything about the file path in the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff193908.aspx\" rel=\"nofollow noreferrer\">MSDN page</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1358, "user_id": 345901, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7a0329710866b0740339107c66e966c1?s=128&d=identicon&r=PG", "display_name": "Jk_", "link": "https://stackoverflow.com/users/345901/jk"}, "edited": false, "score": 0, "creation_date": 1452806009, "post_id": 34642385, "comment_id": 57342877, "body": "Hi ElbertV, thank you for your answer and sorry for the time I took to answered you. The function works great however, it outputs the name of the image but not the correct one. For example in the E column, I have an image in each cell. Then I want to output the name in the F column. Does it make sense?"}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1452112997, "creation_date": 1452112997, "answer_id": 34642385, "question_id": 34641823, "link": "https://stackoverflow.com/questions/34641823/output-the-filename-of-an-inserted-image-inside-excel-file/34642385#34642385", "title": "Output the filename of an inserted image inside Excel file", "body": "<p>Hope this help you. </p>\n\n<pre><code>Sub takePictureNames()\n    Dim i As Integer 'use as index\n    Dim Pic 'to store pictures in worhsheet\n\n    i = 0 'init the index\n\n    For Each Pic In ActiveSheet.Shapes\n        i = i + 1 'add 1 every time\n        Cells(i, 1).Value = Pic.Name\n        'Cells({a}, {b}).value = {c}\n        'a = the row. Using the index to take a row at the time\n        'b = define the columns you want, with a variable or hardcoded as I did\n        'c = inside the Pic variable, you store a picture, one at the time, and then take the name of the pic\n        'Remember: The name of the picture is the name that excel gives to the picture once is inserted, not an\n        'actual file name. But if you want to use it to run a macro, will be usefull to that that name (the excel name)\n    Next Pic\nEnd Sub\n</code></pre>\n\n<p>Explanations in the comments. </p>\n"}], "owner": {"reputation": 1358, "user_id": 345901, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7a0329710866b0740339107c66e966c1?s=128&d=identicon&r=PG", "display_name": "Jk_", "link": "https://stackoverflow.com/users/345901/jk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1195, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1452112997, "creation_date": 1452110899, "last_edit_date": 1531161705, "question_id": 34641823, "link": "https://stackoverflow.com/questions/34641823/output-the-filename-of-an-inserted-image-inside-excel-file", "title": "Output the filename of an inserted image inside Excel file", "body": "<p>I received from a client a large .xlsx file with hundreds of images directly inserted into the file.</p>\n\n<p>I'm trying to output the name (or even better the filename) of the image in a new column programmatically or with a macro.</p>\n\n<p>Could you please point me in the right direction? </p>\n\n<p>Thank you in advance for your time.</p>\n"}, {"tags": ["validation", "excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 5, "creation_date": 1452110538, "post_id": 34641624, "comment_id": 57029239, "body": "Why isn&#39;t data validation working?  What&#39;s your setup for that? You could edit the Error Alert to say something to the user."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1452112307, "post_id": 34641624, "comment_id": 57030338, "body": "the custom data validation formula <code>=AND(LEN(A1)=9,NOT(ISNUMBER(--LEFT(A1,1))),NOT(ISNUMBER(--MI&zwnj;&#8203;D(A1,2,1))),ISNUMBER&zwnj;&#8203;(--RIGHT(A1,7)))</code> works for me, and as @BruceWayne stated you can customize the error message.  any vba would just be reinventing what is inherent in excel.."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452115829, "post_id": 34643104, "comment_id": 57032182, "body": "Change the <code>[A1]</code> in your IF statement to <code>Target</code>.  Then the OP can change the test range to a larger number of cells."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452115886, "post_id": 34643104, "comment_id": 57032212, "body": "It wouldn&#39;t work like that - you have to make sure target is only a single cell in that case. You would have to change more than the <code>[A1]</code> is what i&#39;m saying, in case someone pastes in a range. That&#39;s fine too, but not what OP asked for. You could modify it to use <code>If Target.CountLarge &gt; 1 Then Exit Sub</code> and this would still monitor single cell changes."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452116051, "post_id": 34643104, "comment_id": 57032293, "body": "Yes, you are right, but you could make sure it is one cell, then check if it intersects a larger range. You are probably correct in that the OP only wants one cell.  I was just making a note if a larger range of checked cells is desired."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452116144, "post_id": 34643104, "comment_id": 57032345, "body": "For larger ranges, you could change <code>[A1]</code> to <code>[A1:A10]</code> and use, <code>For Each c in Intersect(Target,[A1:A10]) If Not c Like &quot;[A-z][A-z]#######&quot; Then ...</code>"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 2, "last_activity_date": 1452118148, "last_edit_date": 1452118148, "creation_date": 1452115664, "answer_id": 34643104, "question_id": 34641624, "link": "https://stackoverflow.com/questions/34641624/cell-with-specific-values-only/34643104#34643104", "title": "Cell with specific values only", "body": "<p>As everyone has stated, use data validation.</p>\n\n<p>Here is a macro, however.</p>\n\n<p>Change <code>[A1]</code> to the cell you want to monitor.</p>\n\n<p>Put this in the worksheet object of the sheet with the cell you want to monitor.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, [A1]) Is Nothing Then\n    If Not [A1] Like \"[A-z][A-z]#######\" Then\n        [A1].Select\n        MsgBox (\"Invalid value in A1!\")\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Edit: Just because, here is a solution for multiple cells.</p>\n\n<p>This will also display one messagebox that lists the incorrect cells.</p>\n\n<p>It will also color the cells red if they are incorrect.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim MonRange As Range\n'What range do we want to monitor?\nSet MonRange = [A1:A10]\n'---------------------------------\nIf Not Intersect(Target, MonRange) Is Nothing Then\n    Dim c As Range, Inc As String\n    Inc = \"Incorrect Cells: \" &amp; Chr(13) &amp; \"-----------------\" &amp; Chr(13)\n    For Each c In Intersect(Target, MonRange)\n        If Not c Like \"[A-z][A-z]#######\" Then\n            Inc = Inc &amp; c.Address(False,False) &amp; \",\"\n            c.Interior.Color = RGB(230, 180, 180)\n        Else\n            c.Interior.ColorIndex = xlNone\n        End If\n    Next c\n    If Len(Inc) &lt;&gt; 36 Then MsgBox (Left(Inc,Len(Inc)-1))\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1452118148, "creation_date": 1452110060, "last_edit_date": 1531161705, "question_id": 34641624, "link": "https://stackoverflow.com/questions/34641624/cell-with-specific-values-only", "title": "Cell with specific values only", "body": "<p>I need a macro to show a msgbox whenever an invalid value is posted. I need that cell to only accept values in this format \"LLXXXXXXX\" where L is letter and X is number. I'm using Data validation to show an error message. Any ideas?</p>\n"}, {"tags": ["vba", "if-statement", "indentation"], "comments": [{"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 2, "creation_date": 1452108278, "post_id": 34640985, "comment_id": 57027765, "body": "Indentation doesn&#39;t matter to the compiler, it&#39;s just for the benefit of humans."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1452108409, "post_id": 34640985, "comment_id": 57027838, "body": "Alright I for some reason thought indentation mattered? Then mind schooling me on my obvious oversight then?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1452109492, "post_id": 34640985, "comment_id": 57028562, "body": "If you have programmed in Python then you might have internalized the notion that indentation matters. In principle it doesn&#39;t matter in VBA -- though white space in the form of newlines does matter as a statement terminator. Nevertheless -- consistent indentation is an overwhelmingly good idea, even if no one but you is likely to read the code since among other things it is a major aid in debugging."}], "answers": [{"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1452110381, "post_id": 34641295, "comment_id": 57029134, "body": "thanks for pointing out all of the syntax errors. The main issue is still that the end of the code where &quot; If Awarding = &quot;Both Halfs Same Term&quot; &quot; occurs is the final output of the user form when i have &quot;Awarding = &quot;First Half All Credits in One Half&quot; Or Awarding = &quot;Second Half Only&quot; &quot;"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1452111479, "post_id": 34641295, "comment_id": 57029840, "body": "What does that mean?  The &quot;final output of the user form&quot;?  What line of code is producing this output?  What line is causing it to go on the user form?  What inputs are you giving (in terms of the variable Awarding), and what exactly is happening as a result of this input?  After stepping through the code, how is the program being executed?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1452111724, "post_id": 34641295, "comment_id": 57030012, "body": "Additionally, if the fixes I provided are resulting in the same problem, then I would update the question to include the code with the fixed syntax and then explain what the problem is including the answers to the questions I&#39;ve posed in the previous comment."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 2, "last_activity_date": 1452108823, "creation_date": 1452108823, "answer_id": 34641295, "question_id": 34640985, "link": "https://stackoverflow.com/questions/34640985/multiple-if-statements-indentation-error/34641295#34641295", "title": "Multiple If Statements Indentation Error?", "body": "<p>The problem appears to be in your first block.</p>\n\n<p>Your code (with added indentations to show the flow):  </p>\n\n<pre><code>If Awarding = \"First Half All Credits in One Half\" Or Awarding = \"Second Half Only\" Then\n     If LEU.Value &lt;&gt; \"\" And PLEU &lt; CalcElig Then\n         Payment1.Value = PLEU\n         If PAmtUnused &lt; CalcElig Then\n            'This will write over Payment1.Value if both If conditions are satisfied.\n             Payment1.Value = PAmtUnused\n         Else: Payment1.Value = Payment1.Value = Round(CLng(PSchAward) *      PTotalAyWeeks / PMinAyWeeks / 2, 0)\n      'The else condition will write over Payment1.Value if the second If condition is not satisfied.\n         End If\n'Payment1.Value is NEVER set if the first IF statement evaluates to FALSE,\n' and it is written over if the first IF statement evaluates to TRUE!!\n         PPayment1 = Payment1.Value\n         PPayment2 = 0\n         TotalPayment = PPayment1 + PPayment2\n     End If\nEnd If\n</code></pre>\n\n<p>What you probably meant (due to the other blocks):</p>\n\n<pre><code>If Awarding = \"First Half All Credits in One Half\" Or Awarding = \"Second Half Only\" Then\n    If LEU.Value &lt;&gt; \"\" And PLEU &lt; CalcElig Then\n        Payment1.Value = PLEU\n    ElseIf PAmtUnused &lt; CalcElig Then\n        Payment1.Value = PAmtUnused\n    Else: Payment1.Value = Payment1.Value = Round(CLng(PSchAward) *      PTotalAyWeeks / PMinAyWeeks / 2, 0)\n    End If\n\n    PPayment1 = Payment1.Value\n    PPayment2 = 0\n    TotalPayment = PPayment1 + PPayment2\n\nEnd If\n</code></pre>\n\n<p>There is also an additional problem.</p>\n\n<p>This line of code: </p>\n\n<pre><code>Else: Payment1.Value = Payment1.Value = Round(CLng(PSchAward) *      PTotalAyWeeks / PMinAyWeeks / 2, 0)\n</code></pre>\n\n<p>is going to put either TRUE or FALSE in Payment1.  It is the same as:</p>\n\n<pre><code> Else: Payment1.Value = (Payment1.Value = Round(CLng(PSchAward) *      PTotalAyWeeks / PMinAyWeeks / 2, 0))\n</code></pre>\n\n<p>where the portion in parentheses is evaluated as to whether the two values on either side of the equals sign are equal.</p>\n\n<p>You probably meant to only have one equality: </p>\n\n<pre><code>Else: Payment1.Value = Round(CLng(PSchAward) *      PTotalAyWeeks / PMinAyWeeks / 2, 0)\n</code></pre>\n\n<p>The best way to figure out errors like this is to step through the code and see what exactly is happening and how the program is running through the code compared to what you expect.</p>\n"}, {"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1452125818, "creation_date": 1452125818, "answer_id": 34645299, "question_id": 34640985, "link": "https://stackoverflow.com/questions/34640985/multiple-if-statements-indentation-error/34645299#34645299", "title": "Multiple If Statements Indentation Error?", "body": "<p>Even though OpiesDad was a great help it turns out there was some REALLY bad syntax issues. I had to retool the whole thing to be less cluttered and to make more sense. The solution is INF different than the original post but I wanted to make to post a response. </p>\n\n<p>Main point of contention:</p>\n\n<pre><code>Trying to separate calculations \nMultiple static value declarations\nBeing dumb\n</code></pre>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 34641295, "answer_count": 2, "score": -1, "last_activity_date": 1452125818, "creation_date": 1452107759, "question_id": 34640985, "link": "https://stackoverflow.com/questions/34640985/multiple-if-statements-indentation-error", "title": "Multiple If Statements Indentation Error?", "body": "<p>So, I think I am doing something wrong but need a little guidance. </p>\n\n<p>Below Code is supposed a calculation one way based on a combobox \"Awarding\" result. Currently my calculation is doing the calculation incorrectly (as it is thinking it is \"both halfs same term\"). I believe this is due to my indentation or incorrect use of multiple nested if statements.</p>\n\n<pre><code> If Awarding = \"First Half All Credits in One Half\" Or Awarding = \"Second Half Only\" Then\n     If LEU.Value &lt;&gt; \"\" And PLEU &lt; CalcElig Then\n         Payment1.Value = PLEU\n     If PAmtUnused &lt; CalcElig Then\n         Payment1.Value = PAmtUnused\n     Else: Payment1.Value = Payment1.Value = Round(CLng(PSchAward) *      PTotalAyWeeks / PMinAyWeeks / 2, 0)\n     End If\n\n     PPayment1 = Payment1.Value\n     PPayment2 = 0\n     TotalPayment = PPayment1 + PPayment2\n     End If\n End If\n\n\n If Awarding = \"Both Halfs Same Term\" Then\n     If LEU.Value &lt;&gt; \"\" And PLEU &lt; CalcEligA Then\n         Payment1.Value = PLEU\n     ElseIf PAmtUnused &lt; CalcEligA Then\n         Payment1.Value = PAmtUnused\n     Else: Payment1.Value = CalcEligA\n     End If\n\n\n     PPayment1 = Payment1.Value\n\n\n     If LEU.Value &lt;&gt; \"\" And PLEU &gt; 0 Then\n         Payment2.Value = PLEU - PPayment1\n     Else: Payment2.Value = CalcEligB\n     End If\n\n     If PAmtUnused - PPayment1 &lt; PLEU - PPayment1 Then\n         Payment2.Value = PAmtUnused - PPayment1\n     ElseIf PAmtUnused - PPayment1 &lt; CalcEligB Then\n         Payment2.Value = PAmtUnused - PPayment1\n     Else: Payment2.Value = CalcEligB\n     End If\n\n\n     PPayment2 = Payment2.Value\n\n     TotalPayment = PPayment1 + PPayment2\n\n     End If\n\n End If\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452107834, "post_id": 34640823, "comment_id": 57027499, "body": "What have you tried? You should at least be able to get going by doing your steps with the Macro Recorder, then take a look at the code.  Then, you can tweak it to get close to the final solution, then you can come here and ask for help on specific things.  Please review <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> for more tips on asking a &quot;good&quot; question."}, {"owner": {"reputation": 515, "user_id": 2740307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07851182a3725e0dc4f2f76ac979ff40?s=128&d=identicon&r=PG&f=1", "display_name": "Bernheart", "link": "https://stackoverflow.com/users/2740307/bernheart"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452108639, "post_id": 34640823, "comment_id": 57027989, "body": "Hi Bruce, I have done all you have wrote before asking.  Simply I can&#39;t tell Excel to wait for my values."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1452108931, "post_id": 34640823, "comment_id": 57028202, "body": "Welcome to SO.  This is not a free code-writing service but exists to help others with code or functions they are trying to develop.  As such, we expect to see clear cut questions with examples of data, attempted code, actual output, desired output, research efforts to solve the problem, etc.  Please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>; and also <a href=\"http://stackoverflow.com/help/mcve\">How to Provide an Example</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452109141, "post_id": 34640823, "comment_id": 57028321, "body": "So you have a macro so far? Please post it!"}], "answers": [{"comments": [{"owner": {"reputation": 515, "user_id": 2740307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07851182a3725e0dc4f2f76ac979ff40?s=128&d=identicon&r=PG&f=1", "display_name": "Bernheart", "link": "https://stackoverflow.com/users/2740307/bernheart"}, "edited": false, "score": 0, "creation_date": 1452447552, "post_id": 34642483, "comment_id": 57163340, "body": "Thank you for your contribute"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 1, "last_activity_date": 1452113347, "creation_date": 1452113347, "answer_id": 34642483, "question_id": 34640823, "link": "https://stackoverflow.com/questions/34640823/add-values-with-macro-in-excel/34642483#34642483", "title": "Add values with Macro in Excel", "body": "<p>You can edit this code as needed:</p>\n\n<pre><code>Sub test()\n\n Dim mInfoCol As String\n Dim mImportCol As String\n Dim mDateCol As String\n Dim mRow As Long\n\n mInfoCol = \"A\"\n mImportCol = \"C\"\n mDateCol = \"E\"\n mRow = 3\n\n Rows(mRow).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n Range(mInfoCol &amp; mRow).Value = InputBox(\"info?\", , \"some info\")\n Range(mImportCol &amp; mRow).Value = InputBox(\"import?\", , \"200\")\n Range(mDateCol &amp; mRow).Value = Now()\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 515, "user_id": 2740307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07851182a3725e0dc4f2f76ac979ff40?s=128&d=identicon&r=PG&f=1", "display_name": "Bernheart", "link": "https://stackoverflow.com/users/2740307/bernheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 34642483, "answer_count": 1, "score": 1, "last_activity_date": 1452113347, "creation_date": 1452107311, "last_edit_date": 1531161705, "question_id": 34640823, "link": "https://stackoverflow.com/questions/34640823/add-values-with-macro-in-excel", "title": "Add values with Macro in Excel", "body": "<p>I want to create a table in Excel to manage my money.\nI'd like to insert money import simply by clicking a button (\"insert import\"); than Excel has to create a new row, select the right cell and expect the value that I want to insert.</p>\n\n<p>I have tried to do it on my own by registering a Macro; but I am not able to tell Excel to expect my values.</p>\n\n<p>My expectation:\nI want to create a Macro, actived from a button that creates a new row for inserting two values, \"info\" and \"import\". Info is the derivation of money; import is the value of money. Than Excel wait for me to compile \"info\" cell. Once compiled, I press enter and Excel goes to \"import\" cell; than Excel wait again for me to compile \"import\" cell. Than I press enter and I finish the operation. \nThe result is a row with my values and the date of the operation.</p>\n\n<p>How can I do?</p>\n\n<p>Here I insert the code of the Macro:</p>\n\n<pre><code>    Sub Macro5()\n    Rows(\"3:3\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"A3\").Select\n    ActiveCell.FormulaR1C1 = \"\"\n    Range(\"C3\").Select\n    ActiveCell.FormulaR1C1 = \"\"\n    Range(\"E3\").Select\n    ActiveCell.FormulaR1C1 = \"1/6/2016 20:41\"\n    Range(\"F5\").Select\nEnd Sub\n</code></pre>\n\n<p>As you can see, this code is not useful, since it simply active cells without asking what I want to write in. What's more, date does not update when I run the Macro.</p>\n"}, {"tags": ["vba", "excel", "vbscript", "excel-2007"], "comments": [{"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 1, "creation_date": 1452110223, "post_id": 34640400, "comment_id": 57029022, "body": "Instead of &#39;xlApp.ActiveWorkbook.Close&#39; try &#39;xlBook.Close&#39; as ActiveWorkbook might not be set if run from scheduler."}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1452110491, "post_id": 34640400, "comment_id": 57029213, "body": "although using a different file and macro, this code works for me and closes properly. is it possible something in <code>SortData</code> is causing the problem? maybe post that as well..."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1452111105, "post_id": 34640400, "comment_id": 57029598, "body": "Set <code>xlApp.Visible = True</code> and see what&#39;s happening. Make sure the lingering process is actually from the script and not an artifact from something else."}, {"owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "reply_to_user": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1452112145, "post_id": 34640400, "comment_id": 57030243, "body": "@Fink - Changing <code>xlApp.ActiveWorkbook.Close</code> to <code>xlBook.Close</code> makes no difference. @AnsgarWiechers - Everything appears to close at the end of the macro. No errors or message boxes appear while it runs or during closing."}], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "edited": false, "score": 0, "creation_date": 1452109606, "post_id": 34640886, "comment_id": 57028645, "body": "Tried this code out and it&#39;s still leaving the process running."}], "tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1452107508, "creation_date": 1452107508, "answer_id": 34640886, "question_id": 34640400, "link": "https://stackoverflow.com/questions/34640400/excel-process-still-running-after-quitting-application-in-vbscript/34640886#34640886", "title": "Excel Process Still Running After Quitting Application in VBScript", "body": "<p>Try this out and see if it helps:</p>\n\n<pre><code>Dim xlApp\nDim xlBook\n'Create a shell\nDim WsShell \nSet WsShell = CreateObject(\"WScript.Shell\")\n\nSet xlApp = CreateObject(\"Excel.Application\")\nSet xlBook = xlApp.Workbooks.Open(\"\\\\File\\Path\\XL.xlsm\", 0, True)\n\nxlApp.Visible = False\n\nxlApp.Run \"SortData\"\n\n'Close the workbook, may want to save\nxlApp.ActiveWorkbook.Close true\n\nSet xlBook = Nothing\nSet xlApp = Nothing\nSet WsShell = Nothing\n'Close the script\nWScript.Quit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "edited": false, "score": 0, "creation_date": 1452187248, "post_id": 34651238, "comment_id": 57068032, "body": "This throws a compile error: &quot;Expected Function or variable&quot;"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "edited": false, "score": 0, "creation_date": 1453198419, "post_id": 34651238, "comment_id": 57485935, "body": "refering to an older thread on another Homepage: <a href=\"http://www.mrexcel.com/forum/excel-questions/395568-excel-visual-basic-applications-how-exit-all-macros.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>   try to add &quot;End&quot; in the Document_close()-Sub"}, {"owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "edited": false, "score": 0, "creation_date": 1453234222, "post_id": 34651238, "comment_id": 57509957, "body": "I tried adding<code>End</code> to <code>Private Sub Workbook_BeforeClose(Cancel As Boolean)</code> in the excel book but the process still shows that it&#39;s open. I also confirmed that the macro was running so I know that&#39;s not an issue."}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 0, "last_activity_date": 1452158133, "creation_date": 1452158133, "answer_id": 34651238, "question_id": 34640400, "link": "https://stackoverflow.com/questions/34640400/excel-process-still-running-after-quitting-application-in-vbscript/34651238#34651238", "title": "Excel Process Still Running After Quitting Application in VBScript", "body": "<p>Try to add the following to the beginning of \"SortData\" or somewhere after opening this workbook:</p>\n\n<pre><code>If ActiveWorkbook.Close then\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1593, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452158133, "creation_date": 1452105745, "last_edit_date": 1452112215, "question_id": 34640400, "link": "https://stackoverflow.com/questions/34640400/excel-process-still-running-after-quitting-application-in-vbscript", "title": "Excel Process Still Running After Quitting Application in VBScript", "body": "<p>I have a VBScript that runs every day to sort out an Excel file that is uploaded every night to a shared drive. The issue I am running into is that even after I quit the Excel application, the Excel process is still running in the task manager. I want to make sure that Excel is terminated fully every time the VBScript is run.</p>\n\n<p>Interestingly, I have also tried to close Excel from within the VBA in the macro and it still does not terminate the process but if I run the macro directly (by opening Excel and running the macro from there) the process does terminate properly.</p>\n\n<p>The code I use is below:</p>\n\n<pre><code>Dim xlApp\nDim xlBook\n\nSet xlApp = CreateObject(\"Excel.Application\")\nSet xlBook = xlApp.Workbooks.Open(\"\\\\File\\Path\\XL.xlsm\", 0, True)\n\nxlApp.Visible = False\n\nxlApp.Run \"SortData\"\n\nxlApp.ActiveWorkbook.Close false\n\nxlApp.Quit\n\nSet xlBook = Nothing\nSet xlApp = Nothing\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Below is the code run in the Excel macro \"SortData\":</p>\n\n<pre><code>Public Sub SortData()\n\nDim Dummy As String\nDim MyPath As String\nDim FilesInPath As String\nDim MyFiles() As String\nDim CheckFile As String\nDim Conc(100000) As String\nDim TheSelection As String\nDim TS As String\nDim TheDate As Date\nDim CheckDate As Date\nDim Newest As Date\nDim TheFile As Object\nDim i, n, j As Long\nDim Count As Long\nDim FNum As Long\n\nDim YearC(), Model(), SupNum(), SupName(), B5(), BPN(), MBPN(), PartName(), PackType(), QTY(), Rank(), PackWeight(), PartWeight(), Dunnage() As Variant\nDim Updated As Variant\n\nApplication.ScreenUpdating = False\n\nMyPath = \"\\\\File\\Path\\Sorted Parts Lists\\\"\nTheDate = Date\n\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\n\nIf FilesInPath = \"\" Then GoTo Good\n\nFNum = 0\n\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve MyFiles(1 To FNum)\n    MyFiles(FNum) = MyPath &amp; FilesInPath\n    FilesInPath = Dir()\nLoop\n\nNewest = \"1/1/2000\" 'Arbitrary start date\nSet TheFile = CreateObject(\"Scripting.FileSystemObject\")\nFor FNum = LBound(MyFiles) To UBound(MyFiles)\n    CheckFile = MyFiles(FNum)\n    Updated = TheFile.Getfile(CheckFile).DateLastModified\n    If Updated &gt; Newest Then 'Find the newest file in the folder\n        Newest = Updated\n    End If\nNext FNum\n\nIf Newest &gt;= TheDate - 7 Then GoTo TheEnd\n\nGood:\n\nDim FilePath As String\nFilePath = \"\\\\File\\Path\\Parts List.xls\"\nWorkbooks.Open Filename:=FilePath\nActiveWorkbook.Sheets(1).Select\n\nReDim YearC(100000)\nReDim Model(100000)\nReDim SupNum(100000)\nReDim SupName(100000)\nReDim B5(100000)\nReDim BPN(100000)\nReDim MBPN(100000)\nReDim PartName(100000)\nReDim PackType(100000)\nReDim QTY(100000)\nReDim Rank(100000)\nReDim PackWeight(100000)\nReDim PartWeight(100000)\nReDim Dunnage(100000)\n\nRange(\"BB:HJ,Y:AZ,V:V,T:T,S:S,J:O,E:E\").Select\nSelection.Delete Shift:=xlToLeft\n\nRange(\"K:K\").Select\nSelection.Delete Shift:=xlToLeft\n\ni = 0\nCount = 0\nRange(\"D1\").Select\nTheSelection = Trim(Selection.Value)\n\nDo While TheSelection &lt;&gt; \"\"\n    Select Case TheSelection\n        Case \"AE\", \"HCM ST+ENG\", \"SIOO\"\n            GoTo NextRow\n        Case Else\n    End Select\n\n    'Check for duplicates\n    Dummy = TheSelection &amp; Trim(Selection.Offset(0, 3).Value)\n    For n = 0 To i\n        If Conc(n) = Dummy Then\n            GoTo NextRow\n        End If\n    Next n\n\n    If i &lt;&gt; 0 Then Conc(i) = Dummy\n\n    YearC(i) = Selection.Offset(0, -3).Value\n    Model(i) = Selection.Offset(0, -2).Value\n    SupNum(i) = Selection.Offset(0, -1).Value\n    SupName(i) = Selection.Value\n    B5(i) = Selection.Offset(0, 1).Value\n    BPN(i) = Selection.Offset(0, 2).Value\n    MBPN(i) = Selection.Offset(0, 3).Value\n    PartName(i) = Selection.Offset(0, 4).Value\n    PackType(i) = Selection.Offset(0, 5).Value\n    QTY(i) = Selection.Offset(0, 6).Value\n    Rank(i) = Selection.Offset(0, 7).Value\n    PackWeight(i) = Selection.Offset(0, 8).Value\n    PartWeight(i) = Selection.Offset(0, 9).Value\n    Dunnage(i) = Selection.Offset(0, 10).Value\n\n    i = i + 1\nNextRow:\n\nCount = Count + 1\nSelection.Offset(1, 0).Select\nTheSelection = Trim(Selection.Value)\n\nIf Count &gt; 100000 Then\n    Debug.Print \"Escaped\"\n    Exit Sub\nEnd If\n\nLoop\nReDim Preserve YearC(i)\nReDim Preserve Model(i)\nReDim Preserve SupNum(i)\nReDim Preserve SupName(i)\nReDim Preserve B5(i)\nReDim Preserve BPN(i)\nReDim Preserve MBPN(i)\nReDim Preserve PartName(i)\nReDim Preserve PackType(i)\nReDim Preserve QTY(i)\nReDim Preserve Rank(i)\nReDim Preserve PackWeight(i)\nReDim Preserve PartWeight(i)\nReDim Preserve Dunnage(i)\n\n'Range(\"A1:N\" &amp; Count).ClearContents\n\nSheets.Add After:=Worksheets(Worksheets.Count)\nSheets(Worksheets.Count).Name = \"Sorted Data\"\nSheets(Worksheets.Count).Select\n\nActiveSheet.Range(\"A1:A\" &amp; i).Value = WorksheetFunction.Transpose(YearC)\nActiveSheet.Range(\"B1:B\" &amp; i).Value = WorksheetFunction.Transpose(Model)\nActiveSheet.Range(\"C1:C\" &amp; i).Value = WorksheetFunction.Transpose(SupNum)\nActiveSheet.Range(\"D1:D\" &amp; i).Value = WorksheetFunction.Transpose(SupName)\nActiveSheet.Range(\"E1:E\" &amp; i).Value = WorksheetFunction.Transpose(B5)\nActiveSheet.Range(\"F1:F\" &amp; i).Value = WorksheetFunction.Transpose(BPN)\nActiveSheet.Range(\"G1:G\" &amp; i).Value = WorksheetFunction.Transpose(MBPN)\nActiveSheet.Range(\"H1:H\" &amp; i).Value = WorksheetFunction.Transpose(PartName)\nActiveSheet.Range(\"I1:I\" &amp; i).Value = WorksheetFunction.Transpose(PackType)\nActiveSheet.Range(\"J1:J\" &amp; i).Value = WorksheetFunction.Transpose(QTY)\nActiveSheet.Range(\"K1:K\" &amp; i).Value = WorksheetFunction.Transpose(Rank)\nActiveSheet.Range(\"L1:L\" &amp; i).Value = WorksheetFunction.Transpose(PackWeight)\nActiveSheet.Range(\"M1:M\" &amp; i).Value = WorksheetFunction.Transpose(PartWeight)\nActiveSheet.Range(\"N1:N\" &amp; i).Value = WorksheetFunction.Transpose(Dunnage)\n\nActiveSheet.Range(\"A1:N1\").AutoFilter\nActiveSheet.Columns.AutoFit\n\nTS = TheDate\nj = Len(TS)\nDummy = \"\"\nFor i = 1 To j\n    If Mid(TheDate, i, 1) = \"/\" Then\n        Dummy = Dummy &amp; \"-\"\n    Else: Dummy = Dummy &amp; Mid(TS, i, 1)\n    End If\nNext i\n\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs MyPath &amp; \"Sorted DC Parts List \" &amp; Dummy &amp; \".xlsx\", 51\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nExit Sub\n\nTheEnd:\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "office365", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5753603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7cfca31e74e9bc14d24e6b503bc7c6?s=128&d=identicon&r=PG&f=1", "display_name": "jonesab13", "link": "https://stackoverflow.com/users/5753603/jonesab13"}, "edited": false, "score": 0, "creation_date": 1453988661, "post_id": 35047130, "comment_id": 57848913, "body": "Thanks for the workaround, I&#39;ll try it out.  Downside would be that I was hoping for something a little more direct.  The document I am putting the code in is used by ~70 people as a starting point to generate individual work instructions for experiments. Was simply trying to automate a default file name to help with standardization.  Your option would be better then the event handler I&#39;ve been trying as that hijacks the SaveAs for all open word documents which won&#39;t work in my application.  Thanks again!"}], "tags": [], "owner": {"reputation": 1, "user_id": 5848327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bd7fc9b9ec4511f1968aa4ee8b017?s=128&d=identicon&r=PG&f=1", "display_name": "Adam B. MSFT", "link": "https://stackoverflow.com/users/5848327/adam-b-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1453925586, "creation_date": 1453925586, "answer_id": 35047130, "question_id": 34640262, "link": "https://stackoverflow.com/questions/34640262/vba-to-generate-a-default-file-name-when-save-as-is-selected-in-word-2016/35047130#35047130", "title": "VBA to generate a default file name when Save As is selected in Word 2016", "body": "<p>Thanks for reporting this. I have a potential workaround that I hope will help. </p>\n\n<p>Could you use the SendKeys method (<a href=\"https://msdn.microsoft.com/en-us/library/office/gg278655.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg278655.aspx</a>) to send the keyboard shortcut (F12 for the Save As dialog, full list: <a href=\"http://aka.ms/Tf6yv0\" rel=\"nofollow\">http://aka.ms/Tf6yv0</a>) to the application e.g.</p>\n\n<pre><code>App.SendKeys(\"{F12}\")\n</code></pre>\n\n<p>when you need the Save As dialog to be displayed?</p>\n\n<p>I hope this helps. Thanks again for bringing this issue to our attention, we will be looking further into the root cause.</p>\n"}], "owner": {"reputation": 3, "user_id": 5753603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f7cfca31e74e9bc14d24e6b503bc7c6?s=128&d=identicon&r=PG&f=1", "display_name": "jonesab13", "link": "https://stackoverflow.com/users/5753603/jonesab13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1529, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459759215, "creation_date": 1452105263, "last_edit_date": 1459759215, "question_id": 34640262, "link": "https://stackoverflow.com/questions/34640262/vba-to-generate-a-default-file-name-when-save-as-is-selected-in-word-2016", "title": "VBA to generate a default file name when Save As is selected in Word 2016", "body": "<p>I have VBA that, in Word 2010, will default a file name into the Save As screen when the user selects the Save As file option.  Word 2016 (Office 365) has a different interface with a screen to select a save location (OneDrive, This PC,etc) prior to the \"standard\" Save As dialog box appearing which seems to have broken the code to generate a specified default file name.</p>\n\n<p>The code (with title simplified) is</p>\n\n<pre><code>  Sub FileSaveAs()\n\n  With Dialogs(wdDialogFileSaveAs)\n    .Name = \"MyTitle\"\n    .Show\n  End With\n\n  End Sub\n</code></pre>\n\n<p>If I run the code in Developer to Debug, it works fine, with the Save As screen appearing and the file name defaulting but it does not work in the live environment where the file name defaults to the previous document name.</p>\n\n<p>Based on web research, I have tried additional code to change the properties of the document place the name in the title as this is supposed to then default when Save As is selected but that also doesn't work.</p>\n\n<p>Any suggestions or recommendations on how to resolve this would be appreciated. </p>\n\n<p>Thanks!</p>\n\n<p>Update 1/11/16: \n  Have been able to get a little closer by using the following:\n  Application.DocumentBeforeSave Event\n  example here <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838299.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff838299.aspx</a>\n  tied to Using Events with Application Object \n  example here <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821218.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff821218.aspx</a></p>\n\n<p>Had to add</p>\n\n<pre><code>Cancel=True\n</code></pre>\n\n<p>to the end of the event procedure code or the Save as Dialog box will open twice.\nStill a bit clunky and seems to be limited to run only before the first user generated save event but almost workable.</p>\n\n<p>Wanted to share what I found in case it helps others but any other suggestions for improvement would be appreciated as it still doesn't seem like the best solution.\nThanks again!</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1452103871, "post_id": 34639831, "comment_id": 57025026, "body": "Why not use <a href=\"http://stackoverflow.com/questions/9140318/how-to-use-and-in-if-statement-vba\">AND</a>? You don&#39;t seem to be doing anything unless all conditions are met."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1452106125, "last_edit_date": 1452106125, "creation_date": 1452104214, "answer_id": 34639962, "question_id": 34639831, "link": "https://stackoverflow.com/questions/34639831/too-many-iterations-syntax-needed-to-highlight-the-cell-row-only-after-satifsyi/34639962#34639962", "title": "Too many iterations: syntax needed to highlight the cell row only after satifsying all criteria", "body": "<p>As @Raystafarian commented as I was typing, use <code>And</code> in your if statment instead of all the loops:</p>\n\n<pre><code>Sub SWAPS100()\n\nDim rng As Range, lCount As Long, LastRow As Long\nDim cell As Object\n\nSheets(\"Output\").Activate\n\nWith ActiveSheet\n\n    LastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each cell In .Range(\"E2:E\" &amp; LastRow) 'new position\n        If cell = \"N\" And cell.Offset(, 16) = \"SW\" And cell.Offset(, 5) = 100 _\n            And cell.Offset(, 4) = 100 Then\n            With cell.EntireRow.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = 6382079\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n        End If\n    Next cell\n\n\nEnd With\n</code></pre>\n\n<p>With looping each row individually it will go slow and will most likely always justify.  As long as you have one cell in each column that justifies the if statement then it will color all rows.</p>\n\n<p>Also this can be done with Conditional Formatting with the following formula:</p>\n\n<pre><code>=AND($E2=\"N\",$U2=\"SW\",$J2=100,$I2=100)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1452108059, "creation_date": 1452108059, "answer_id": 34641067, "question_id": 34639831, "link": "https://stackoverflow.com/questions/34639831/too-many-iterations-syntax-needed-to-highlight-the-cell-row-only-after-satifsyi/34641067#34641067", "title": "Too many iterations: syntax needed to highlight the cell row only after satifsying all criteria", "body": "<p>While the aforementioned <a href=\"https://support.office.com/en-au/article/Use-a-formula-to-apply-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow\">Conditional Formatting</a> with a native worksheet formula is a better solution for 'on-the-fly' updates, a series of <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow\">AutoFilter methods</a> applied to the columns would be much faster than any procedure involving looping through the cells.</p>\n\n<pre><code>Sub SWAPS100()\n\n    Application.ScreenUpdating = False\n    With Sheets(\"Output\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        With .Cells(1, 1).CurrentRegion\n            .AutoFilter Field:=5, Criteria1:=\"N\"\n            .AutoFilter Field:=9, Criteria1:=100\n            .AutoFilter Field:=10, Criteria1:=100\n            .AutoFilter Field:=21, Criteria1:=\"SW\"\n            With .Resize(.Rows.Count - 1, 1).Offset(1, 4)\n                If CBool(Application.Subtotal(103, .Cells)) Then\n                    .Cells.EntireRow.Interior.Color = 6382079\n                End If\n            End With\n        End With\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 34639962, "answer_count": 2, "score": 1, "last_activity_date": 1452108059, "creation_date": 1452103784, "question_id": 34639831, "link": "https://stackoverflow.com/questions/34639831/too-many-iterations-syntax-needed-to-highlight-the-cell-row-only-after-satifsyi", "title": "Too many iterations: syntax needed to highlight the cell row only after satifsying all criteria", "body": "<p>I think I have an issue with the order of my <code>For</code> <code>IF</code> and <code>Next</code> statements, I am trying to only highlight the row where all conditions are meet, instead when my code makes it to the highlighting part all rows are individually highlighted and the code seems to run quite slow, I believe I am performing too many iterations?</p>\n\n<pre><code>Sub SWAPS100()\n\nDim rng As Range, lCount As Long, LastRow As Long\nDim cell As Object\n\nSheets(\"Output\").Activate\n\nWith ActiveSheet\n\n    LastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each cell In .Range(\"E2:E\" &amp; LastRow) 'new position\n        If cell = \"N\" Then\n        Debug.Print\n                            For Each cell1 In .Range(\"U2:U\" &amp; LastRow) 'Secuirty type\n                                If cell1 = \"SW\" Then\n                                    For Each cell2 In .Range(\"J2:J\" &amp; LastRow) 'prior px\n                                        If cell2 = 100 Then\n                                            For Each cell3 In .Range(\"I2:I\" &amp; LastRow) 'current px\n                                                    If cell3 &lt;&gt; 100 Then\n\n            'With cell.Interior\n        With cell.EntireRow.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 6382079\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n        End With\n                                                            End If\n                                                        Next cell3\n                                                        End If\n                                                    Next cell2\n                                                    End If\n                                                Next cell1\n                                                End If\n                                            Next cell\n\n\nEnd With\n</code></pre>\n"}, {"tags": ["c#", "vba", "messagebox"], "comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 4, "creation_date": 1452102389, "post_id": 34639344, "comment_id": 57024193, "body": "Why did you write your own <code>MessageBox.Show</code> method?  There&#39;s nothing in it that will &quot;show&quot; the <code>MessageBox</code>."}, {"owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "edited": false, "score": 1, "creation_date": 1452102414, "post_id": 34639344, "comment_id": 57024207, "body": "remove your <code>MessageBox</code> class.  I&#39;m guessing you clicked the auto-generate class and method option before you added a reference to <code>System.Windows.Forms</code>"}, {"owner": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "edited": false, "score": 0, "creation_date": 1452102512, "post_id": 34639344, "comment_id": 57024271, "body": "This built-in <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.messagebox(v=vs.110).aspx\" rel=\"nofollow noreferrer\">class</a> didn&#39;t work for you?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5753550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72b336a02496315573bdd577b1bca3e?s=128&d=identicon&r=PG&f=1", "display_name": "ohmygrabovski", "link": "https://stackoverflow.com/users/5753550/ohmygrabovski"}, "edited": false, "score": 0, "creation_date": 1452130836, "post_id": 34639436, "comment_id": 57037709, "body": "Is there a way for me to see how the MessageBox.Show method has been implemented in WinForms?"}, {"owner": {"reputation": 2159, "user_id": 2537247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635f75f5db8d59ac20b8d2cc81d0061e?s=128&d=identicon&r=PG", "display_name": "lenkan", "link": "https://stackoverflow.com/users/2537247/lenkan"}, "reply_to_user": {"reputation": 11, "user_id": 5753550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72b336a02496315573bdd577b1bca3e?s=128&d=identicon&r=PG&f=1", "display_name": "ohmygrabovski", "link": "https://stackoverflow.com/users/5753550/ohmygrabovski"}, "edited": false, "score": 0, "creation_date": 1452175573, "post_id": 34639436, "comment_id": 57059471, "body": "@ohmygrabovski - You can use a decompiler. But why do you need that?"}], "tags": [], "owner": {"reputation": 2159, "user_id": 2537247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635f75f5db8d59ac20b8d2cc81d0061e?s=128&d=identicon&r=PG", "display_name": "lenkan", "link": "https://stackoverflow.com/users/2537247/lenkan"}, "is_accepted": false, "score": 0, "last_activity_date": 1452131084, "last_edit_date": 1452131084, "creation_date": 1452102463, "answer_id": 34639436, "question_id": 34639344, "link": "https://stackoverflow.com/questions/34639344/message-box-not-showing-up-using-messageboxbutton-showstring-string-button/34639436#34639436", "title": "Message box NOT showing up using MessageBoxButton.Show(string, string, button)", "body": "<p>Remove your own <em>MessageBox</em> class. </p>\n\n<pre><code>public sealed class MessageBox\n{\n    static public void Show(string input1, string input2, MessageBoxButtons button) { }\n}\n</code></pre>\n\n<p>Its <em>Show</em> method does not contain any implementation and does not let you call the <a href=\"https://msdn.microsoft.com/en-us/library/0x49kd7z(v=vs.110).aspx\" rel=\"nofollow\">MessageBox.Show</a> method implemented in WinForms.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5753550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72b336a02496315573bdd577b1bca3e?s=128&d=identicon&r=PG&f=1", "display_name": "ohmygrabovski", "link": "https://stackoverflow.com/users/5753550/ohmygrabovski"}, "edited": false, "score": 0, "creation_date": 1452188427, "post_id": 34640406, "comment_id": 57068755, "body": "I modified my code however, the box still is not showing up. I&#39;m not sure if my return type is correct?"}, {"owner": {"reputation": 1789, "user_id": 5509738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207860835627188/picture?type=large", "display_name": "Karen Payne", "link": "https://stackoverflow.com/users/5509738/karen-payne"}, "reply_to_user": {"reputation": 11, "user_id": 5753550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72b336a02496315573bdd577b1bca3e?s=128&d=identicon&r=PG&f=1", "display_name": "ohmygrabovski", "link": "https://stackoverflow.com/users/5753550/ohmygrabovski"}, "edited": false, "score": 0, "creation_date": 1452188513, "post_id": 34640406, "comment_id": 57068806, "body": "Best to show the new code by revising your question and indicate that you have modified it."}], "tags": [], "owner": {"reputation": 1789, "user_id": 5509738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207860835627188/picture?type=large", "display_name": "Karen Payne", "link": "https://stackoverflow.com/users/5509738/karen-payne"}, "is_accepted": false, "score": 0, "last_activity_date": 1452105766, "creation_date": 1452105766, "answer_id": 34640406, "question_id": 34639344, "link": "https://stackoverflow.com/questions/34639344/message-box-not-showing-up-using-messageboxbutton-showstring-string-button/34640406#34640406", "title": "Message box NOT showing up using MessageBoxButton.Show(string, string, button)", "body": "<p>Others have pointed out the solution, implement the show method. You might also consider having a special class of wrappers for showing a dialog to the user something like the following which has hard-coded buttons and the buttons are setup so the no or cancel button is the default. Lastly when using them we simply ask for true or false rather than a dialog result which at least for me is cleaner code.</p>\n\n<p>Not so crazy for the function name QuestionOkayCancel but the naming here is for anyone reading to get the idea and many would surely change the function name is my guess.</p>\n\n<pre><code>using System.Windows.Forms;\nnamespace Windowspplication1_cs\n{\n    public static class SpecialMyDialogs\n    {\n        public static bool Question(string Text)\n        {\n            return (MessageBox.Show(Text, \"Question\", MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button2) == DialogResult.Yes);\n        }\n        public static bool Question(string Text, string Title)\n        {\n            return (MessageBox.Show(Text, Title, MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button2) == DialogResult.Yes);\n        }\n        public static bool QuestionOkayCancel(string Text)\n        {\n            return (MessageBox.Show(Text, \"Question\", MessageBoxButtons.OKCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button2) == DialogResult.Yes);\n        }\n        public static bool QuestionOkayCancel(string Text, string Title)\n        {\n            return (MessageBox.Show(Text, Title, MessageBoxButtons.OKCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button2) == DialogResult.Yes);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5753550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72b336a02496315573bdd577b1bca3e?s=128&d=identicon&r=PG&f=1", "display_name": "ohmygrabovski", "link": "https://stackoverflow.com/users/5753550/ohmygrabovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1452131084, "creation_date": 1452102112, "last_edit_date": 1452102592, "question_id": 34639344, "link": "https://stackoverflow.com/questions/34639344/message-box-not-showing-up-using-messageboxbutton-showstring-string-button", "title": "Message box NOT showing up using MessageBoxButton.Show(string, string, button)", "body": "<p>I have a reference set up already for <code>System.Windows.Form</code> and I'm not really sure what I'm missing. All I need is for a message box to show up when I change views on the info path form which shows Ok/Cancel and the two strings?</p>\n\n<pre><code>using Microsoft.Office.InfoPath;\nusing System;\nusing System.Windows.Forms;\nusing System.Xml;\nusing System.Xml.XPath;\n\n\nnamespace Form1\n{\n    public sealed class MessageBox\n    {\n     static public void Show(string input1, string input2, MessageBoxButtons button) { }\n    } \n\n   public partial class FormCode\n   {\n\n\n\n          public void InternalStartup()\n          {}\n\n          public void FormEvents_ViewSwitched(object sender,   ViewSwitchedEventArgs e)\n              {\n                string string1 = \"Error\";\n                string string2 = \"Empty field found on form\";\n                MessageBoxButtons button = MessageBoxButtons.OKCancel;\n                MessageBox.Show(string1, string2, button);\n              }\n      }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["excel", "vba", "vbscript", "ms-word", "shared"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452109153, "post_id": 34639160, "comment_id": 57028327, "body": "You could store it in a file someplace.  But I have found that sometimes it is useful to store certain constants as a Custom Property of one or both documents"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3681913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163f4c38cde3807543a9189d9e3fedcd?s=128&d=identicon&r=PG&f=1", "display_name": "user3681913", "link": "https://stackoverflow.com/users/3681913/user3681913"}, "edited": false, "score": 0, "creation_date": 1452138587, "post_id": 34642073, "comment_id": 57039714, "body": "Thank you! This worked great except for initially I kept getting a run-time error 1004, something about VBproject object failed. I searched that error and found that I needed to go into the Trust Center options in my Excel file and check the option to Trust access to VBA Project Object Model. Once I did that, everything was great."}], "tags": [], "owner": {"reputation": 21, "user_id": 5753505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PMsJN.jpg?s=128&g=1", "display_name": "BArms", "link": "https://stackoverflow.com/users/5753505/barms"}, "is_accepted": false, "score": 2, "last_activity_date": 1452111839, "creation_date": 1452111839, "answer_id": 34642073, "question_id": 34639160, "link": "https://stackoverflow.com/questions/34639160/using-vbscript-to-hold-user-types-and-constants-to-share-between-word-and-excel/34642073#34642073", "title": "Using VBscript to hold user types and constants to share between Word and Excel VBA?", "body": "<p>You could store them in a .bas file, and import an update.  For excel, import using:</p>\n\n<pre><code>Public Sub GetModules()\n    ThisWorkbook.VBProject.VBComponents(\"modCommons\").Name = \"DELETEME\"\n    ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(\"DELETEME\")\n    ThisWorkbook.VBProject.VBComponents.Import (\"C:\\modCommons.bas\")\nEnd Sub\n</code></pre>\n\n<p>modCommons.bas</p>\n\n<pre><code>Attribute VB_Name = \"modCommons\"\n    Public Const itest As Integer = 101\n    Public Const itest2 As Integer = 102\n\n    Public Sub TestSub\n        msgbox \"test success\"\n    End Sub\n</code></pre>\n\n<p>For Word, replace ThisWorkbook with ThisDocument.</p>\n"}], "owner": {"reputation": 1, "user_id": 3681913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163f4c38cde3807543a9189d9e3fedcd?s=128&d=identicon&r=PG&f=1", "display_name": "user3681913", "link": "https://stackoverflow.com/users/3681913/user3681913"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452115520, "creation_date": 1452101557, "last_edit_date": 1452115520, "question_id": 34639160, "link": "https://stackoverflow.com/questions/34639160/using-vbscript-to-hold-user-types-and-constants-to-share-between-word-and-excel", "title": "Using VBscript to hold user types and constants to share between Word and Excel VBA?", "body": "<p>I am using VBA to automate some tasks in and between some Word and Excel files (Office 2010). Right now I have the VBA code that is used only by Word stored in the Word file, and the VBA code that is used only by Excel stored in the Excel file, with the cross-application VBA stuff stored in the Word file. However, there are some user-defined types and constants that I would like to use in both the Word-specific and Excel-specific VBA code. Is there an application-neutral way I can store these shared data types and constants in a separate module, such as maybe in VBscript, where it can be used by both Excel and Word, without having to define them in both places? If so, how do I reference that outside file in each template?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5752880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153435936182861/picture?type=large", "display_name": "Drinkperrier", "link": "https://stackoverflow.com/users/5752880/drinkperrier"}, "edited": false, "score": 0, "creation_date": 1452181616, "post_id": 34640437, "comment_id": 57063923, "body": "Many thanks! I just add this following line to change the top margin and  It works! Many thanks again! I never though about margins. mydoc.Sections(1).PageSetup.TopMargin = InchesToPoints(1.7)"}], "tags": [], "owner": {"reputation": 1, "user_id": 3681913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163f4c38cde3807543a9189d9e3fedcd?s=128&d=identicon&r=PG&f=1", "display_name": "user3681913", "link": "https://stackoverflow.com/users/3681913/user3681913"}, "is_accepted": false, "score": 0, "last_activity_date": 1452106203, "last_edit_date": 1452106203, "creation_date": 1452105850, "answer_id": 34640437, "question_id": 34638897, "link": "https://stackoverflow.com/questions/34638897/adding-page-number-and-new-line-after-a-border-line-in-ms-word-header-by-a-vba-e/34640437#34640437", "title": "Adding Page number and new line after a border line in MS Word header by a VBA excel program", "body": "<p>Either of the following will create a space after the bottom border line in your header:<br></p>\n\n<p>1) Increase the size of the top margin in the page layout/formatting. (This is the distance between the top edge of the paper and the first line of non-header text on the page.) <br>\n2) In the paragraph formatting of the header text, increase the \"spacing after\" setting. Set the option for eliminating spacing between paragraphs of the same style or you might end up creating space between all the lines of your heading text.<br></p>\n\n<p>You can do either of these in your VBA code.</p>\n"}], "owner": {"reputation": 21, "user_id": 5752880, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153435936182861/picture?type=large", "display_name": "Drinkperrier", "link": "https://stackoverflow.com/users/5752880/drinkperrier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 820, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452158959, "creation_date": 1452100736, "last_edit_date": 1452100823, "question_id": 34638897, "link": "https://stackoverflow.com/questions/34638897/adding-page-number-and-new-line-after-a-border-line-in-ms-word-header-by-a-vba-e", "title": "Adding Page number and new line after a border line in MS Word header by a VBA excel program", "body": "<p>I have a little problem with my vba program.</p>\n\n<p>I have a program in VBA excel to create a new word document. I would like to add a Header in my word document, but I am new to VBA in word. So I don't know how to do it.</p>\n\n<p>In my header, I would like to have some information from Excel on the left side and the page number \" Page X of Y\"  on the right side. One more thing, I was able to add a border line under my header, but I don't know how to add a extra line after the border to keep a space between header and normal text.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim objword As Word.Application\nDim mydoc As Word.document\nDim WRng As Word.Range\nSet objword = CreateObject(\"Word.application\")\nSet mydoc = objword.Documents.Add\n\n'HEADER\n\nSet WRng = mydoc.Sections(1).Headers(wdHeaderFooterPrimary).Range\n\nWRng.Text = wsexcel.Range(\"A5\") &amp; \" \" &amp; wsexcel.Range(\"B5\") &amp; vbtab &amp; **Page  number of total**\nWRng.Borders(wdBorderBottom).LineStyle = wdLineStyleSingle\n\n**???? Add space after the border line???** \n</code></pre>\n\n<p>Header example</p>\n\n<p><a href=\"https://i.stack.imgur.com/a3KC0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a3KC0.png\" alt=\"Header example\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bjpuG.jpg\" rel=\"nofollow noreferrer\">code</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452099420, "post_id": 34638302, "comment_id": 57022178, "body": "@Nathan_Sav: i am not sure where to put this is can you help me putting this in my code."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1452099589, "post_id": 34638302, "comment_id": 57022308, "body": ".offset(0,5).value = environ(&quot;UserName&quot;)"}, {"owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452100316, "post_id": 34638302, "comment_id": 57022829, "body": "@Nathan_Sav:Thanks. but how do i hide the sheet in the existing VBA code. Also, if not can you provide some insight which can help me that if some one tries to bypass the code it should not fire the sheet should not unlock at all."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1452100559, "post_id": 34638302, "comment_id": 57022999, "body": ".hidden = true.  I think you&#39;re best of googling this, if &quot;hiding a worksheet vba&quot; returned no useful answers i&#39;d be surprised."}, {"owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452100713, "post_id": 34638302, "comment_id": 57023117, "body": "@Nathan_Sav: Thank you for the help but what about the code that people use to crack the protected sheet. I want to stop it so that the user does not crack the sheet in any means."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452100823, "post_id": 34638302, "comment_id": 57023196, "body": "That&#39;s not in the original question, i&#39;d raise another one, or google it 1st...... Dont fully understand what you are asking either :)"}], "owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452098789, "creation_date": 1452098789, "last_edit_date": 1531164843, "question_id": 34638302, "link": "https://stackoverflow.com/questions/34638302/vba-to-capture-user-name", "title": "VBA to capture user name", "body": "<p>Below is the code to capture the time and date with the value being changed in an excel sheet1. The code fires correctly however it does not capture the User name i want to capture the user name and also to hide the sheet which captures this data.</p>\n\n<pre><code>Dim vOldVal 'Must be at top of module\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim bBold As Boolean\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nOn Error Resume Next\n\nWith Application\n.ScreenUpdating = False\n     .EnableEvents = Falseenter code here\n\nEnd With\n\nIf IsEmpty(vOldVal) Then vOldVal = \"Empty Cell\"\nbBold = Target.HasFormula\nWith Sheet3\n        .Unprotect Password:=\"Secret\"\n            If .Range(\"A1\") = vbNullString Then\n                .Range(\"A1:E1\") = Array(\"CELL CHANGED\", \"OLD VALUE\", _\n                    \"NEW VALUE\", \"TIME OF CHANGE\", \"DATE OF CHANGE\")\n            End If\nWith .Cells(.Rows.Count, 1).End(xlUp)(2, 1)\n              .Value = Target.Address\n              .Offset(0, 1) = vOldVal\n                  With .Offset(0, 2)\n                    If bBold = True Then\n                      .ClearComments\n                      .AddComment.Text Text:= _\n                           \"OzGrid.com:\" &amp; Chr(10) &amp; \"\" &amp; Chr(10) &amp; _\n                              \"Bold values are the results of formulas\"\n                    End If\n                      .Value = Target\n                      .Font.Bold = bBold\n                  End With\n            .Offset(0, 3) = Time\n            .Offset(0, 4) = Date\n\n        End With\n.Cells.Columns.AutoFit\n        .Protect Password:=\"Secret\"\n\n    End With\n\nvOldVal = vbNullString\nWith Application\n     .ScreenUpdating = True\n     .EnableEvents = True\nEnd With\nOn Error GoTo 0\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nvOldVal = Target\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1452098287, "post_id": 34638011, "comment_id": 57021432, "body": "You need to trap the error N/A is display, the contents of the cell is something like Error 2042, so use IsError"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452098364, "post_id": 34638011, "comment_id": 57021473, "body": "<code>If worksheetfunction.IsError(Cells(i, 10)) then...</code> as @Nathan_Sav said"}, {"owner": {"reputation": 61, "user_id": 5694718, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-_Yx8mgI7JZU/AAAAAAAAAAI/AAAAAAAABHA/-DiszcMWxHE/photo.jpg?sz=128", "display_name": "Mohammad Imran", "link": "https://stackoverflow.com/users/5694718/mohammad-imran"}, "edited": false, "score": 0, "creation_date": 1452098760, "post_id": 34638011, "comment_id": 57021727, "body": "I tried your suggestion your suggestion and it does seem to work but talking ages to execute. I guess this is because the file has more than 10000 rows.  This is what I did   <code>Dim i As Long For i = Cells(Rows.Count, 10).End(xlUp).Row To 1 Step -1 If worksheetfunction.IsError(Cells(i, 10)) Then Cells(i, 1).EntireRow.Delete Next i</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452098921, "post_id": 34638011, "comment_id": 57021839, "body": "Turn your calculations off at the beginning and turn them back on at the end."}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1452099531, "creation_date": 1452099531, "answer_id": 34638530, "question_id": 34638011, "link": "https://stackoverflow.com/questions/34638011/delete-all-rows-with-errors-in-a-column/34638530#34638530", "title": "Delete All Rows With Errors in a column", "body": "<p>Try this code:</p>\n\n<pre><code>Dim i As Long\nFor i = Cells(Rows.Count, 10).End(xlUp).Row To 1 Step -1\nIf Cells(i, 10).Text = \"#N/A\" Then Cells(i, 1).EntireRow.Delete\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1452099659, "creation_date": 1452099659, "answer_id": 34638569, "question_id": 34638011, "link": "https://stackoverflow.com/questions/34638011/delete-all-rows-with-errors-in-a-column/34638569#34638569", "title": "Delete All Rows With Errors in a column", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a> with the <strong>xlSpecialCellsValue</strong> constant as <strong>xlErrors</strong> to quickly identify all cells in column J with errors. It wasn't disclosed whether the cells were formulas or typed constants so I've added code to examine both through the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow\">xlCellType Enumeration</a> types.</p>\n\n<pre><code>Sub del_error_rows()\n    With Worksheets(\"Sheet3\")\n        On Error Resume Next\n        With .Columns(10).SpecialCells(xlCellTypeFormulas, xlErrors)\n            .EntireRow.Delete\n        End With\n        With .Columns(10).SpecialCells(xlCellTypeConstants, xlErrors)\n            .EntireRow.Delete\n        End With\n        On Error GoTo 0\n    End With\nEnd Sub\n</code></pre>\n\n<p>The <code>On Error Resume Next</code> is necessary in case there are no cells with that particular error configuration. In that case, the SpecialCells would be <code>Nothing</code> and you must bypass any error thrown from attempting to handle nothing.</p>\n"}], "owner": {"reputation": 61, "user_id": 5694718, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-_Yx8mgI7JZU/AAAAAAAAAAI/AAAAAAAABHA/-DiszcMWxHE/photo.jpg?sz=128", "display_name": "Mohammad Imran", "link": "https://stackoverflow.com/users/5694718/mohammad-imran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1845, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1452100248, "creation_date": 1452097982, "last_edit_date": 1452100248, "question_id": 34638011, "link": "https://stackoverflow.com/questions/34638011/delete-all-rows-with-errors-in-a-column", "title": "Delete All Rows With Errors in a column", "body": "<p>I am working on a VBA code and part of the code is needed to delete all the rows in the sheet where the text in the column \"J\" is \"#N/A\". I have written a code but but I get a Type mismatch error when debugging it.</p>\n\n<p>Here is the code</p>\n\n<pre><code>Dim i As Long\nFor i = Cells(Rows.Count, 10).End(xlUp).Row To 1 Step -1\nIf Cells(i, 10) = \"#N/A\" Then Cells(i, 1).EntireRow.Delete\nNext i\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452185180, "post_id": 34637839, "comment_id": 57066599, "body": "Why would you not use Word&#39;s built-in Find capacity, using wildcards, which would let you insert the MergeField directly into the target Range. Relying on the Start and End values is extremely unreliable, as you&#39;ve discovered..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5752606, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--wskve3T8IE/AAAAAAAAAAI/AAAAAAAABBY/d7SLIoswln4/photo.jpg?sz=128", "display_name": "Polyphil", "link": "https://stackoverflow.com/users/5752606/polyphil"}, "edited": false, "score": 0, "creation_date": 1452185199, "post_id": 34654615, "comment_id": 57066610, "body": "Your solution works perfectly fine. Thanks a lot @bibadia."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "is_accepted": false, "score": 1, "last_activity_date": 1452174104, "last_edit_date": 1452174104, "creation_date": 1452168037, "answer_id": 34654615, "question_id": 34637839, "link": "https://stackoverflow.com/questions/34637839/replacing-the-text-of-a-given-range-by-a-merge-field/34654615#34654615", "title": "Replacing the text of a given Range by a merge field", "body": "<p>If you use Alt-F9 to see what is actually happening in your document, you will probably see that the second and subsequent fields in each paragraph are being inserted inside the first field that the code inserted.</p>\n\n<p>This is because field insertion changes the number of characters in the document's range. Nothing will adjust the range start and end values recorded in your MatchCollection's Match objects automatically. </p>\n\n<p>The usual way to deal with this kind of thing is to iterate backwards through the document, i.e. backwards through the paragraphs, then backwards through the Match items.</p>\n\n<p>Another thing that appeared relevant here was that the m variable was undeclared. I think it probably needs to be declared as a Regex Match object.</p>\n\n<p>So you need code more like this:</p>\n\n<pre><code>Sub lookForFields()\n    '\n    ' lookForFields Macro\n    '\n    Dim m As VBScript_RegExp_55.Match\n    Dim theMatch As Long\n    Dim thePara As Long\n    Dim para As Paragraph\n    Dim lineText As String\n    Dim regEx As New RegExp\n    Dim strPattern As String: strPattern = \"\\&lt;(.*?)\\&gt;\"\n    Dim strInput As String\n    Dim region As Word.Range\n    Dim allmatches As MatchCollection\n    Dim currentWord As String\n\n    Debug.Print (vbCrLf + \"------------------\")\n    Dim res As String\n    With regEx\n        .Global = True\n        .MultiLine = False\n        .IgnoreCase = True\n        .Pattern = strPattern\n    End With\n    For thePara = ActiveDocument.Paragraphs.Count To 1 Step -1\n      Set para = ActiveDocument.Paragraphs(thePara)\n        txt = para.Range.Text\n        Set allmatches = regEx.Execute(txt)\n        For theMatch = allmatches.Count - 1 To 0 Step -1\n          Set m = allmatches(theMatch)\n            Set rng = ActiveDocument.Range(Start:=m.FirstIndex + para.Range.Start, End:=m.FirstIndex + Len(m.Value) + para.Range.Start)\n            Set myField = ActiveDocument.Fields.Add(Range:=rng, Type:=wdFieldMergeField, Text:=m.Value)\n            rng.HighlightColorIndex = wdYellow\n        Next\n    Next\n    Set m = Nothing\n    Set para = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5752606, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--wskve3T8IE/AAAAAAAAAAI/AAAAAAAABBY/d7SLIoswln4/photo.jpg?sz=128", "display_name": "Polyphil", "link": "https://stackoverflow.com/users/5752606/polyphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459758711, "creation_date": 1452097450, "last_edit_date": 1459758711, "question_id": 34637839, "link": "https://stackoverflow.com/questions/34637839/replacing-the-text-of-a-given-range-by-a-merge-field", "title": "Replacing the text of a given Range by a merge field", "body": "<p>I'm creating a VBA macro which looks for words between <code>&lt;&gt;</code> markers in a Word document, and turns them into merge fields.</p>\n\n<p>This is the first script I came up with</p>\n\n\n\n<pre><code>Sub lookForFields()\n    '\n    ' lookForFields Macro\n    '\n    Dim para As Paragraph\n    Dim lineText As String\n    Dim regEx As New RegExp\n    Dim strPattern As String: strPattern = \"\\&lt;(.*?)\\&gt;\"\n    Dim strInput As String\n    Dim region As Word.Range\n    Dim allmatches As MatchCollection\n    Dim currentWord As String\n\n    Debug.Print (vbCrLf + \"------------------\")\n    Dim res As String\n    With regEx\n        .Global = True\n        .MultiLine = False\n        .IgnoreCase = True\n        .Pattern = strPattern\n    End With\n    For Each para In ActiveDocument.Paragraphs\n        txt = para.Range.Text\n        Set allmatches = regEx.Execute(txt)\n        For Each m In allmatches\n            Set rng = ActiveDocument.Range(Start:=m.FirstIndex + para.Range.Start, End:=m.FirstIndex + Len(m.Value) + para.Range.Start)\n            'Set myField = ActiveDocument.Fields.Add(Range:=rng, Type:=wdFieldMergeField, Text:=m.Value)\n            rng.HighlightColorIndex = wdYellow\n        Next m\n    Next para\nEnd Sub\n</code></pre>\n\n<p>The following instruction correctly highlights the words I'd like to have converted:</p>\n\n<pre><code>rng.HighlightColorIndex = wdYellow\n</code></pre>\n\n<p>However, if I uncomment</p>\n\n<pre><code>Set myField = ActiveDocument.Fields.Add(Range:=rng, Type:=wdFieldMergeField, Text:=m.Value)\n</code></pre>\n\n<p>Merge fields won't be created if there are more than one in a paragraph. \nThe created merge fields also somehow don't seem \"valid\" since right clicking them to edit their properties replaces them with an \"unknow switch\" error.\nHow should I go about this one?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1452097077, "post_id": 34637666, "comment_id": 57020611, "body": "Dont think you need the And, just use 2 lines of code."}], "answers": [{"tags": [], "owner": {"reputation": 5684, "user_id": 1657610, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/kcTi0.png?s=128&g=1", "display_name": "Reg Edit", "link": "https://stackoverflow.com/users/1657610/reg-edit"}, "is_accepted": false, "score": 2, "last_activity_date": 1452097341, "creation_date": 1452097341, "answer_id": 34637810, "question_id": 34637666, "link": "https://stackoverflow.com/questions/34637666/vba-excel-issue-with-check-digit-formula/34637810#34637810", "title": "VBA (Excel) issue with Check Digit formula", "body": "<p>Your  bitwise <code>And</code> is very strange&mdash;I think you mean</p>\n\n<pre><code>If barcode(i) Mod 2 = 0 Then\n    evenscount = evenscount + 1\n    evensnumbers = evensnumbers + barcode(i)\nElse\n    oddscount = oddscount + 1\n    oddsnumbers = oddsnumbers + barcode(i)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1471515530, "creation_date": 1471515530, "answer_id": 39015640, "question_id": 34637666, "link": "https://stackoverflow.com/questions/34637666/vba-excel-issue-with-check-digit-formula/39015640#39015640", "title": "VBA (Excel) issue with Check Digit formula", "body": "<p>I wrote something like that <a href=\"http://idevlop.blogspot.lu/2013/07/check-digit-et-validation-de-code-ean.html\" rel=\"nofollow\">here</a>. Here is the code: </p>\n\n<pre><code>Function IsCodeValid(sNumber As String) As Boolean\n    On Error Resume Next\n    If Len(sNumber) &lt; 8 Then Exit Function\n    IsCodeValid = (Right(sNumber, 1) = CheckDigit(Left(sNumber, Len(sNumber) - 1)))\n    If Err.Number &lt;&gt; 0 Then Debug.Print Now, sNumber, Err.Number, Err.Description\nEnd Function\n\nFunction CheckDigit(ByVal gtin As String) As String\n'general purpose check digit calculator\n'given all figures except last one, calculate check digit as used for GTIN-8, GTIN-12, EAN13, EDI GLN, etc...\n'parameter: number as string, WITHOUT the last digit\n'           works with string length up to 254 char\n'returns:   the last digit\n'author:    Patrick Honorez - www.idevlop.com\n'notes:     provided without any warranties\n'           Copyleft as long as you keep this header intact\n'help for algorithm can be found here:\n'           http://www.gs1.org/barcodes/support/check_digit_calculator#how\n\n    Dim m() As String, lSum As Long, i As Integer\n    Dim chk As Integer, large As Long, mult As Byte\n    'store string into an array\n    m = Split(StrConv(gtin, vbUnicode), Chr(0))\n    mult = 3    'multiplier initial value is 3\n    'calc right to left to start with 3 as multiplier\n    For i = UBound(m) - 1 To 0 Step -1  'ignore last value of array: it's always = to chr(0)\n        lSum = lSum + Val(m(i)) * mult\n        If mult = 3 Then mult = 1 Else mult = 3 'swap multiplier value between 3 and 1\n    Next i\n    'find difference between lSum and the 10 that's equal or greater\n    large = (lSum \\ 10) * 10\n    If large &lt; lSum Then large = large + 10\n    chk = large - lSum\n    CheckDigit = CStr(chk)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5651120, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e951d15a93fc11d5a87df989d8472fc?s=128&d=identicon&r=PG&f=1", "display_name": "j. m", "link": "https://stackoverflow.com/users/5651120/j-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471515530, "creation_date": 1452096846, "last_edit_date": 1452098948, "question_id": 34637666, "link": "https://stackoverflow.com/questions/34637666/vba-excel-issue-with-check-digit-formula", "title": "VBA (Excel) issue with Check Digit formula", "body": "<p>i recently wrote this short function but with little experience in VBA im failing to see why this isn't working.</p>\n\n<pre><code>Sub barcodedigit()\nDim barcode(12) As Variant\nDim i As Integer\nDim oddscount As Integer\nDim evenscount As Integer\nDim evensnumbers As Integer\nDim oddsnumbers As Integer\nDim finalnumber As Double\nDim remainder As Integer\noddsnumbers = 0\nevensnumbers = 0\n\nFor i = 1 To 12\n\nbarcode(i) = InputBox(\"Please enter number\" &amp; i)\n\nNext i\n\nFor i = 1 To 12\nIf barcode(i) Mod 2 = 0 Then\nevenscount = evenscount + 1 And evensnumbers = evensnumbers + barcode(i)\n\nElse\n\noddscount = oddscount + 1 And oddsnumbers = oddsnumbers + barcode(i)\n\n\nEnd If\n\nNext i\n\noddsnumbers = oddsnumbers * 3\n\nfinalnumber = oddsnumbers + evensnumbers\n\nremainder = finalnumber Mod 10\n\nMsgBox (\"Oddscount is equal to \" &amp; oddscount &amp; vbNewLine &amp; \"Remainder is   equal to\" &amp; \" \" &amp; remainder)\nEnd Sub\n</code></pre>\n\n<p>My issue here is that this is setting every result to 0 (oddscount &amp; remainder) even though this should logically work.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>edit:: removing and worked perfectly!</p>\n"}, {"tags": ["vba", "automation"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1452096878, "post_id": 34637642, "comment_id": 57020476, "body": "Change the code so that is does what the button makes it do in response to a command line &quot;app.exe /doitnow&quot; then use the built in Windows Task Scheduler to run it periodically."}, {"owner": {"reputation": 291, "user_id": 1611900, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d99f97998d6cc5d29df9282b00585531?s=128&d=identicon&r=PG", "display_name": "CoMo G-Dawg", "link": "https://stackoverflow.com/users/1611900/como-g-dawg"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1452099120, "post_id": 34637642, "comment_id": 57021990, "body": "Okay, I can see how this would be great for a local task.  My issue is that I need this to happen on a server, or even the mainframe.  I&#39;m going to edit the original to add more details.  Thanks for your response!"}, {"owner": {"reputation": 5542, "user_id": 3733070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77040a282f8bbe1a953f305d970f73df?s=128&d=identicon&r=PG&f=1", "display_name": "404", "link": "https://stackoverflow.com/users/3733070/404"}, "edited": false, "score": 0, "creation_date": 1452101937, "post_id": 34637642, "comment_id": 57023886, "body": "Change your tags to get better answers, this isn&#39;t vbscript."}, {"owner": {"reputation": 291, "user_id": 1611900, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d99f97998d6cc5d29df9282b00585531?s=128&d=identicon&r=PG", "display_name": "CoMo G-Dawg", "link": "https://stackoverflow.com/users/1611900/como-g-dawg"}, "edited": false, "score": 0, "creation_date": 1452108189, "post_id": 34637642, "comment_id": 57027722, "body": "Done.  Thanks.  Like I said, I&#39;m new to VB, period.  There&#39;s no &quot;VB&quot; or &quot;visual-basic&quot; tags out there, so I went with what I could find."}], "answers": [{"tags": [], "owner": {"reputation": 291, "user_id": 1611900, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d99f97998d6cc5d29df9282b00585531?s=128&d=identicon&r=PG", "display_name": "CoMo G-Dawg", "link": "https://stackoverflow.com/users/1611900/como-g-dawg"}, "is_accepted": true, "score": -1, "last_activity_date": 1452113593, "creation_date": 1452113593, "answer_id": 34642538, "question_id": 34637642, "link": "https://stackoverflow.com/questions/34637642/how-can-i-schedule-vb-functionality/34642538#34642538", "title": "How can I schedule VB functionality?", "body": "<p>It turns out that we are going to use an ESP scheduler to run the executable on the server.</p>\n"}], "owner": {"reputation": 291, "user_id": 1611900, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d99f97998d6cc5d29df9282b00585531?s=128&d=identicon&r=PG", "display_name": "CoMo G-Dawg", "link": "https://stackoverflow.com/users/1611900/como-g-dawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 34642538, "answer_count": 1, "score": 1, "last_activity_date": 1452113593, "creation_date": 1452096754, "last_edit_date": 1452107722, "question_id": 34637642, "link": "https://stackoverflow.com/questions/34637642/how-can-i-schedule-vb-functionality", "title": "How can I schedule VB functionality?", "body": "<p>I am brand-flipping-new to visual basic.  I've been a Java/JSP programmer for about 15 years.  Never programmed in VB before in my life, but I've been handed a task to automate some functionality that is in a VB tool that was developed by someone else.  The functionality works, but currently it requires opening the tool and pushing a button.  We need this functionality to run every hour.  Can this be done in the VB code?  Or is this something I'll have to work into another technology (like my Java code)?</p>\n\n<p><em>edit</em><br/>\nWhat I've got is a button on a VB form that reads from a text log file and then processes the text and, based on the content, parses and stores it in a database.  I need this to happen on regular intervals and not on a local system.  The log file is written by a web service to a distributed server and the database is on a mainframe.  I've been tasked to do this using VB, but I really do not know if or how this could be done.</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4829486, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eFyjUNAVlSI/AAAAAAAAAAI/AAAAAAAAAFk/MUtOy2eBl6g/photo.jpg?sz=128", "display_name": "Sipko", "link": "https://stackoverflow.com/users/4829486/sipko"}, "edited": false, "score": 0, "creation_date": 1452173147, "post_id": 34637776, "comment_id": 57057733, "body": "Ok I have tried something out. Though since no new mail has been received since I have set it up.  The only thing what I wonder about is how this is called? I mean, I had to create it as a class module in order to not give me errors.  But is this class Called automatically or do I need to create a regular module to call it?"}, {"owner": {"reputation": 158, "user_id": 5752441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bGkme.jpg?s=128&g=1", "display_name": "Pure", "link": "https://stackoverflow.com/users/5752441/pure"}, "reply_to_user": {"reputation": 15, "user_id": 4829486, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eFyjUNAVlSI/AAAAAAAAAAI/AAAAAAAAAFk/MUtOy2eBl6g/photo.jpg?sz=128", "display_name": "Sipko", "link": "https://stackoverflow.com/users/4829486/sipko"}, "edited": false, "score": 0, "creation_date": 1452180567, "post_id": 34637776, "comment_id": 57063141, "body": "This code should be added into the Module called ThisOutlookSession. <a href=\"http://stackoverflow.com/questions/5660028/how-to-enable-thisoutlooksession-in-outlook-2007\" title=\"how to enable thisoutlooksession in outlook 2007\">stackoverflow.com/questions/5660028/&hellip;</a>"}], "tags": [], "owner": {"reputation": 158, "user_id": 5752441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bGkme.jpg?s=128&g=1", "display_name": "Pure", "link": "https://stackoverflow.com/users/5752441/pure"}, "is_accepted": false, "score": 0, "last_activity_date": 1452097224, "creation_date": 1452097224, "answer_id": 34637776, "question_id": 34637279, "link": "https://stackoverflow.com/questions/34637279/outlook-rules-perhaps-with-vba/34637776#34637776", "title": "Outlook rules, perhaps with VBA", "body": "<p>If you wanted to use VBA in Outlook. You could do something like this, which will allow you to process a new message when it comes in with a reply.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n  Dim Ns As Outlook.NameSpace\n  Dim Folder As Outlook.MAPIFolder\n\n  Set Ns = Application.GetNamespace(\"MAPI\")\n  Set Folder = Ns.GetDefaultFolder(olFolderInbox)\n  Set Items = Folder.Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n  If TypeOf Item Is Outlook.MailItem Then\n  ProcessNewMessage Item\n  End If\nEnd Sub\n\nPrivate Sub ProcessNewMessage(NewMail As Outlook.MailItem)\n    'DO WHAT YOU NEED TO WHEN NEW MAIL ARRIVES HERE\n    'E.G\n    'MsgBox NewMail.Subject\nEnd Sub\n</code></pre>\n\n<p>You just need to program what to do when the message arrives. Check what the subject contains etc.</p>\n"}], "owner": {"reputation": 15, "user_id": 4829486, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eFyjUNAVlSI/AAAAAAAAAAI/AAAAAAAAAFk/MUtOy2eBl6g/photo.jpg?sz=128", "display_name": "Sipko", "link": "https://stackoverflow.com/users/4829486/sipko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452097224, "creation_date": 1452095633, "question_id": 34637279, "link": "https://stackoverflow.com/questions/34637279/outlook-rules-perhaps-with-vba", "title": "Outlook rules, perhaps with VBA", "body": "<p>I've been having some trouble with setting up rules in outlook. The reason for my issue is that the outlook rule definitions and conditions seem not capable enough.</p>\n\n<p>What I want to do.\nI get automated messages from a ticketing systems with a subject like \"comments added\" when ever someone replied to my e-mail inside the system.</p>\n\n<p>I want to:</p>\n\n<ol>\n<li>Move those items into a specific folder.</li>\n<li>Add 2 categories</li>\n<li>play a notification sound,</li>\n<li>Flag it to follow up today,</li>\n</ol>\n\n<p>Now, using rules, Whenever I complete a task and a new e-mail from that system comes in. That rule will run again and Flag all the completed tasks again.\nBut I want to make an exception for mails which are already flagged as completed.</p>\n\n<p>Is it possible?\nI was thinking about using VBA. Perhaps someone here has some pointers as to where I could start?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452096205, "post_id": 34636975, "comment_id": 57020042, "body": "so you want into insert <i>n</i> rows based on how many cells on a given row have actual data in them? So if a row has 5 cells filled in, insert 5 rows, if 2 have data, insert 2 rows ...?"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452098181, "post_id": 34636975, "comment_id": 57021367, "body": "Yes, yes, exactly! The only problem is that I can&#39;t seem to get the variable to work. Only for the range N - R, which should just be the  &quot;.Range(&quot;[ColumnLetter]&quot; &amp; x).Value&quot;. I have a different bit of code which I&#39;ve tried to get to work as well, but to no avail."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452099488, "post_id": 34636975, "comment_id": 57022228, "body": "see my answer, I utilized the <code>CountA</code> function to cell how cells are filled with data for each row and used that result to insert the number of rows."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 1, "creation_date": 1452104248, "post_id": 34638243, "comment_id": 57025261, "body": "Thanks @Jeeped ! I haven&#39;t really been delving into the world of variables since it hasn&#39;t been exactly necessary in writing code for my projects, but I suppose now is as good a time as any. This worked perfectly, and was insanely fast - the process clocked in at less than 2 seconds. O_O"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1452098608, "creation_date": 1452098608, "answer_id": 34638243, "question_id": 34636975, "link": "https://stackoverflow.com/questions/34636975/inserting-blank-rows-depending-on-number-of-cells-in-each-column-filled/34638243#34638243", "title": "Inserting blank rows depending on number of cells (in each column) filled", "body": "<p>I find that storing the values in variant arrays can help.</p>\n\n<pre><code>Sub expand_Entries()\n    Dim v As Long, vAMZs As Variant, vVALs As Variant\n    Dim rw As Long, c1 As Long, c2 As Long, c As Long, cs As Long\n\n    With Worksheets(\"Sheet2\")\n        c1 = Application.Match(\"status\", .Rows(1), 0)\n        c2 = .Cells(1, Columns.Count).End(xlToLeft).Column\n        For rw = .Cells(Rows.Count, 1).End(xlUp).Row To 2 Step -1\n            cs = Application.CountA(.Cells(rw, c1 + 1).Resize(1, c2 - c1))\n            If CBool(cs) Then\n                vVALs = .Cells(rw, 1).Resize(1, c1 - 1).Value2\n                With .Cells(rw, c1).Resize(1, cs + 1)\n                    vAMZs = .Cells.Value2\n                    .Offset(0, 1).ClearContents\n                End With\n                For c = UBound(vAMZs, 2) To LBound(vAMZs, 2) + 1 Step -1\n                    .Cells(rw + 1, 1).Resize(1, c1 - 1).EntireRow.Insert\n                    .Cells(rw + 1, 1).Resize(1, c1 - 1) = vVALs\n                    .Cells(rw + 1, 8) = vAMZs(1, c)\n                Next c\n            End If\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1452104706, "post_id": 34638512, "comment_id": 57025516, "body": "Thanks a bunch for the assist! :) This definitely helped and I&#39;ll have to remember this syntax for later spreadsheets. It looks like an Excel refresher course for me is in order."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1452099453, "creation_date": 1452099453, "answer_id": 34638512, "question_id": 34636975, "link": "https://stackoverflow.com/questions/34636975/inserting-blank-rows-depending-on-number-of-cells-in-each-column-filled/34638512#34638512", "title": "Inserting blank rows depending on number of cells (in each column) filled", "body": "<p>You can use a the <code>CountA</code> Worksheet Function inside your <code>IF</code> block to determine the count of filled cells. Then just replace the <code>8</code>'s with the count of each row.</p>\n\n<p>See code:</p>\n\n<pre><code>  If .Cells(R, Col) = \"Yes\" Then\n\n        'get count\n        Dim iCells As Integer\n        iCells = WorksheetFunction.CountA(.Range(\"A\" &amp; R &amp; \":R\" &amp; R))\n\n        .Cells(R, Col).Offset(1, 0).Resize(iCells, 1).EntireRow.Insert\n        .Cells(R, StartRow).Offset(1, 0).Resize(iCells, 1).Value = .Cells(R, 1).Value\n\n        For C = 1 To iCells Step 1\n           .Cells(R, Y).Offset(C, 0).Value = .Cells(R, Col).Offset(0, C).Value\n        Next C\n\n        .Cells(R, Col) = \"Done\"\n\n  End If\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 34638243, "answer_count": 2, "score": 0, "last_activity_date": 1452099453, "creation_date": 1452094701, "last_edit_date": 1452098757, "question_id": 34636975, "link": "https://stackoverflow.com/questions/34636975/inserting-blank-rows-depending-on-number-of-cells-in-each-column-filled", "title": "Inserting blank rows depending on number of cells (in each column) filled", "body": "<p>I have a small sample example sheet of data, which will be filled with much more data if I can get this process to work. </p>\n\n<p>What I am trying to do is, based upon the number of cells that are filled in each row, insert the same number of blank lines under that same row and copy everything down all columns that are blank. I have attached two screenshots - a before and after of what the start and end look like, as well as the code used for implementing the blank row insert. So far, all it does is add 8 rows consistently, and is using an older version of Excel. I'm trying to translate it into the new VBA format, but I can't seem to get it to work.</p>\n\n<p>Start: <a href=\"https://i.stack.imgur.com/tOXgB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tOXgB.png\" alt=\"enter image description here\"></a></p>\n\n<p>The result I'm trying to achieve:\n<a href=\"https://i.stack.imgur.com/sHEyU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sHEyU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code: </p>\n\n<pre><code>Sub IfYes()\nDim Col As Variant\nDim Y As Variant\nDim BlankRows As Long\nDim LastRow As Long\nDim R As Long\nDim C As Long\nDim StartRow As Long\nCol = \"AS\"\nY = \"Y\"\nStartRow = 1\nBlankRows = 1\nLastRow = Cells(Rows.Count, Col).End(xlUp).Row\nApplication.ScreenUpdating = False\nWith ActiveSheet\n  For R = LastRow To StartRow + 1 Step -1\n      If .Cells(R, Col) = \"Yes\" Then\n            .Cells(R, Col).Offset(1, 0).Resize(8, 1).EntireRow.Insert\n            .Cells(R, StartRow).Offset(1, 0).Resize(8, 1).Value = .Cells(R, 1).Value\n            For C = 1 To 8 Step 1\n               .Cells(R, Y).Offset(C, 0).Value = .Cells(R, Col).Offset(0, C).Value\n            Next C\n            .Cells(R, Col) = \"Done\"\n      End If\n  Next R\nEnd With\nApplication.ScreenUpdating = True\n   End Sub\n</code></pre>\n\n<p>I also have another bit of code that I've been trying to use to get this to function properly.</p>\n\n<pre><code>Dim wb1 As Workbook, ws1 As Worksheet\nDim lRow As Long\nDim LastRow As Range\nDim StartRow As Range\nDim i As Long\n\nSet wb1 = Application.Workbooks.Open(\"Z:\\Employee Folders\\Jason\\crystal spreadsheet - start.xls\")\nSet ws1 = wb1.Worksheets(\"AMZStart\")\n\nWith ws1\nFor lRow = Cells(Cells.Rows.Count, \"B\").End(xlUp).Row To 1 Step -1\n    If Cells(lRow, \"B\") = \"AMZ\" Then Rows(lRow).Offset(1, 0).EntireRow.Insert\nNext lRow\nLastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\nStartRow = 1\nFor i = StartRow To LastRow\nIf Cells(i, \"C\") = \"\" And i &gt; StartRow Then\nCells(i, \"C\").Formula = \"=SUM(C\" &amp; StartRow &amp; \":C\" &amp; i - 1 &amp; \")\"\nStartRow = i + 1\nEnd If\nNext\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "edited": false, "score": 1, "creation_date": 1452440599, "post_id": 34637195, "comment_id": 57160625, "body": "In addition to what &#39;destination-data&#39; gave you, please see this link.  <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a>  Just play around with it for a while.  You can definitely do what you described.  You probably just need to spend a little time on it."}, {"owner": {"reputation": 3437, "user_id": 240385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZEcfq.jpg?s=128&g=1", "display_name": "jason", "link": "https://stackoverflow.com/users/240385/jason"}, "edited": false, "score": 0, "creation_date": 1453651731, "post_id": 34637195, "comment_id": 57685394, "body": "Thanks!  This was helpful!"}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 0, "last_activity_date": 1452095392, "creation_date": 1452095392, "answer_id": 34637195, "question_id": 34636795, "link": "https://stackoverflow.com/questions/34636795/adding-a-repeater-to-a-ms-access-report/34637195#34637195", "title": "Adding a repeater to a MS-Access Report", "body": "<p>Yes you can do this with both forms and reports.  You need the <a href=\"https://support.office.com/en-za/article/Create-a-form-that-contains-a-subform-a-one-to-many-form-ddf3822f-8aba-49cb-831a-1e74d6f5f06b?ui=en-US&amp;rs=en-ZA&amp;ad=ZA\" rel=\"nofollow\">SubForm control</a>.  This allows you embed one form/report within another.  You can also define which fields to join on.  This allows the main/outer report to filter the sub/inner report.</p>\n\n<p>The link above contains detailed instructions taken from the Office website.</p>\n"}], "owner": {"reputation": 3437, "user_id": 240385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZEcfq.jpg?s=128&g=1", "display_name": "jason", "link": "https://stackoverflow.com/users/240385/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 34637195, "answer_count": 1, "score": 0, "last_activity_date": 1452095392, "creation_date": 1452094115, "question_id": 34636795, "link": "https://stackoverflow.com/questions/34636795/adding-a-repeater-to-a-ms-access-report", "title": "Adding a repeater to a MS-Access Report", "body": "<p>I haven't worked in Access in quite some time.  But, I have a report that has a main query, with grouping.  The report is based on a database like this:</p>\n\n<p>Each office has many divisions.<br>\nEach Division has many projects</p>\n\n<p>So, I group by office.  But, each division has a lot of other relationships I would like to include in the report.  Like Staff members.  Is there a way to create a secondary, and more, query and loop through that to add data to the report?</p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "microsoft-edge"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1452094396, "post_id": 34636368, "comment_id": 57018781, "body": "Begin here:  <a href=\"https://msdn.microsoft.com/en-us/library/hh772401%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 22783, "user_id": 1113772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uLSIj.png?s=128&g=1", "display_name": "Paul Sweatte", "link": "https://stackoverflow.com/users/1113772/paul-sweatte"}, "edited": false, "score": 0, "creation_date": 1480727843, "post_id": 34636368, "comment_id": 69097771, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31302304/will-microsoft-edge-support-com-automation-internetexplorer-object\">Will Microsoft Edge support COM automation (InternetExplorer object)?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 9755520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a166fc9e855ffbdff566f2bd18c7159?s=128&d=identicon&r=PG&f=1", "display_name": "MW982", "link": "https://stackoverflow.com/users/9755520/mw982"}, "edited": false, "score": 2, "creation_date": 1607623408, "post_id": 34637356, "comment_id": 115337434, "body": "If you want to have VBA capability to automate Microsoft Edge, please take the opportunity to upvote this issue on the MS development site and bring it to their attention:   <a href=\"https://office365.uservoice.com/forums/264636-general/suggestions/38614222-vba-capability-to-automate-microsoft-edge\" rel=\"nofollow noreferrer\">office365.uservoice.com/forums/264636-general/suggestions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 3, "last_activity_date": 1452095863, "last_edit_date": 1495542271, "creation_date": 1452095863, "answer_id": 34637356, "question_id": 34636368, "link": "https://stackoverflow.com/questions/34636368/is-it-possible-to-create-and-use-a-microsoft-edge-variable-object-in-vba/34637356#34637356", "title": "Is it possible to create and use a Microsoft Edge variable / object in VBA?", "body": "<p>Unfortunately Edge doesn't have an API VBA can use.</p>\n\n<p>IE will continue to work.</p>\n\n<p>Sources:</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/148d9639-0747-41bc-82b5-1469ff5bd1b5/excel-vba-coding-switching-from-internet-explorer-to-microsoft-edge?forum=iewebdevelopment\" rel=\"nofollow noreferrer\">MSDN Social</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/31784247/switching-from-internet-explorer-to-microsoft-edge\">SO</a></p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 4633897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WcKCi.jpg?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/4633897/lucas"}, "edited": false, "score": 0, "creation_date": 1528417455, "post_id": 50751086, "comment_id": 88511444, "body": "Thanks for the heads-up. What Windows features are you referring to?"}, {"owner": {"reputation": 160, "user_id": 2852000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWazM.jpg?s=128&g=1", "display_name": "OGCJN", "link": "https://stackoverflow.com/users/2852000/ogcjn"}, "reply_to_user": {"reputation": 85, "user_id": 4633897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WcKCi.jpg?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/4633897/lucas"}, "edited": false, "score": 0, "creation_date": 1528544254, "post_id": 50751086, "comment_id": 88554757, "body": "I meant that in Windows 10 one can uninstall internet explorer using &quot;Turn windows features on or off&quot; dialog - therefore there is no guarantee that IE is available on a client machine."}], "tags": [], "owner": {"reputation": 160, "user_id": 2852000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWazM.jpg?s=128&g=1", "display_name": "OGCJN", "link": "https://stackoverflow.com/users/2852000/ogcjn"}, "is_accepted": false, "score": 1, "last_activity_date": 1528411256, "creation_date": 1528411256, "answer_id": 50751086, "question_id": 34636368, "link": "https://stackoverflow.com/questions/34636368/is-it-possible-to-create-and-use-a-microsoft-edge-variable-object-in-vba/50751086#50751086", "title": "Is it possible to create and use a Microsoft Edge variable / object in VBA?", "body": "<p>Correction to the answer by destination-data: </p>\n\n<p>IE will continue to work <strong>unless</strong> you actually uninstall it using windows features. Which was the case for one of my clients and the code that used\n<code>Set ie = CreateObject(\"InternetExplorer.Application\")</code>\nbroke. Be aware! </p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10585600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47cc924473468b6f489dee9633059a6?s=128&d=identicon&r=PG&f=1", "display_name": "jordanda557", "link": "https://stackoverflow.com/users/10585600/jordanda557"}, "is_accepted": false, "score": 2, "last_activity_date": 1580403326, "last_edit_date": 1580403326, "creation_date": 1580401950, "answer_id": 59990470, "question_id": 34636368, "link": "https://stackoverflow.com/questions/34636368/is-it-possible-to-create-and-use-a-microsoft-edge-variable-object-in-vba/59990470#59990470", "title": "Is it possible to create and use a Microsoft Edge variable / object in VBA?", "body": "<pre><code>Sub OpenEdge()\n\nActiveWorkbook.FollowHyperlink Address:=\"microsoft-edge:https://www.google.com\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4633897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WcKCi.jpg?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/4633897/lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12625, "favorite_count": 1, "accepted_answer_id": 34637356, "answer_count": 3, "score": 4, "last_activity_date": 1580403326, "creation_date": 1452092918, "question_id": 34636368, "link": "https://stackoverflow.com/questions/34636368/is-it-possible-to-create-and-use-a-microsoft-edge-variable-object-in-vba", "title": "Is it possible to create and use a Microsoft Edge variable / object in VBA?", "body": "<p>I have some VBA code that pulls stock prices from the web. My code uses an InternetExplorer object / document to do so. However, if possible, I would like to use a Microsoft Edge object / document instead.</p>\n\n<p>In my current code:</p>\n\n<ol>\n<li><p>I initialize an InternetExplorer variable: <code>Dim ie As InternetExplorer</code></p></li>\n<li><p>Then I create an object: <code>Set ie = CreateObject(\"InternetExplorer.Application\")</code></p></li>\n</ol>\n\n<p>I'm wondering if it is possible to use a Microsoft Edge instead of Internet Explorer object / document in my code. Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1452095927, "post_id": 34636359, "comment_id": 57019862, "body": "Which line returns the error?  Can you run the query directly in your RDBMS?"}, {"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1452096697, "post_id": 34636359, "comment_id": 57020368, "body": "The line it errors out on is <code>rs.UpdateBatch</code> it updates another spreadsheet I&#39;m using as a backend. My employer dislikes Access Databases but requires something that can do a similar job so not sure how I would test it directly?"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1452098177, "post_id": 34636359, "comment_id": 57021363, "body": "Try calling the <a href=\"https://msdn.microsoft.com/en-us/library/ms676529(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Update</a> method instead.  You&#39;ll need to do with within the loop before moving onto the next item.  <a href=\"https://books.google.co.uk/books?id=FIQnCgAAQBAJ&amp;pg=PA164&amp;lpg=PA164&amp;dq=Query+too+complex+UpdateBatch&amp;source=bl&amp;ots=FjqSKiUWkc&amp;sig=z4V3DppeyzpfefZVT5VEeN6NTvU&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwjipu6GzpXKAhWBSXIKHTDoCW0Q6AEISDAG#v=onepage&amp;q=Query%20too%20complex%20UpdateBatch&amp;f=false\" rel=\"nofollow noreferrer\">UpdateBatch can struggle</a> with certain data sources, large volumes, and datasets without a primary key."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1452100532, "post_id": 34636359, "comment_id": 57022977, "body": "Your employer dislikes Access but is OK with using Excel as a Database?"}, {"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452154741, "post_id": 34636359, "comment_id": 57045703, "body": "@TimWilliams correct"}, {"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1452157937, "post_id": 34636359, "comment_id": 57047436, "body": "@destination-data Thanks for the suggestion, I tried as you said and I get no error now, but the database does not seem to actually update. I added this <code>rs.Update</code> within the loop as well as <code>Debug.Print rs!MonthCheck9</code> (for checking) and deleted <code>rs.UpdateBatch</code> the debug check returns &quot;1&quot; (correctly), but my actual file does not update. I tested in a simple sql update query to check field names etc and it worked fine."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1452158522, "post_id": 34636359, "comment_id": 57047816, "body": "What file type are you using? Can you also include the connection string?"}, {"owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1452159091, "post_id": 34636359, "comment_id": 57048218, "body": "@destination-data File type is an .xlsx. I&#39;ve added connection string as requested. Though I have not manipulated an open rs like the above elsewhere in the code, all other select/insert/update queries are working correctly (just as an FYI)"}], "owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452158940, "creation_date": 1452092866, "last_edit_date": 1452158940, "question_id": 34636359, "link": "https://stackoverflow.com/questions/34636359/vba-query-too-complex-error-using-rs-updatebatch-ms-sql", "title": "VBA &quot;Query too complex&quot; error using rs.UpdateBatch (MS SQL)", "body": "<p>Getting the \"Query too complex\" VBA error when trying to run the below code and can't quite seem to figure out why?</p>\n\n<pre><code>Public Sub Update9MonthsDB(ByVal colSelection As Collection)\n\nDim rs As ADODB.Recordset\nDim strSQL As String\n\nCall Open_Conn(strDb)\n\nSet rs = New ADODB.Recordset\n\nrs.ActiveConnection = CON\nrs.CursorType = adOpenKeyset\nrs.CursorLocation = adUseClient\nrs.LockType = adLockBatchOptimistic\nrs.Open (\"Select * From [PortfolioDB$]\")\n\nFor Each Item In colSelection\n\n    strSQL = \"Grid_Ref='\" &amp; Item &amp; \"'\"\n\n    rs.Find strSQL\n    Debug.Print rs!Grid_Ref\n    rs(\"MonthCheck9\") = \"1\"\n    Debug.Print rs!MonthCheck9\n\nNext Item\n\nrs.UpdateBatch\nrs.Close\n\nCall Close_Conn\n\nEnd Sub\n</code></pre>\n\n<p>My connection string is used elsewhere in the code and is working fine for normal update/select etc statements. My debug prints show that the collection is not empty and returns the correct value with the other debug value check. But as soon as it gets to rs.UpdateBatch, it crashes out to \"Query too complex\" error.</p>\n\n<p>EDIT: Just to clarify sorry, this is updating an excel spreadsheet acting as a database (back end)</p>\n\n<p>EDIT: Connection string below as requested in comments.</p>\n\n<pre><code>Sub Open_Conn(strDb As String)\nOn Error GoTo conError\n    Debug.Print (Time() &amp; \" - Connecting to: \" &amp; strDb)\n    Set CON = New ADODB.Connection\n    CON.Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    CON.Open \"Data Source=\" &amp; strDb &amp; \";\" &amp; _\n    \"Extended Properties=\"\"Excel 12.0 XML;HDR=Yes\"\"\"\n    Debug.Print (Time() &amp; \" - Connected\")\n    Exit Sub\nconError:\n    logevents (\"There was an error processing the connection: \" &amp; strSQL &amp; _        \n    vbNewLine &amp; vbTab &amp; vbTab &amp; vbTab &amp; vbTab &amp; Error(Err))\n    Resume Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 8233104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1358f30d9b1b303c7d574d2cce29e112?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8233104/vincent"}, "is_accepted": false, "score": 1, "last_activity_date": 1536138698, "last_edit_date": 1536138698, "creation_date": 1498768887, "answer_id": 44834653, "question_id": 34636358, "link": "https://stackoverflow.com/questions/34636358/excel-freezes-when-expanding-group-of-rows-with-conditional-formatting/44834653#44834653", "title": "Excel freezes when expanding group of rows with conditional formatting", "body": "<p>I got a similar bug with Excel 2013 (15.0.4569.1504) MSO (15.0.4719.1000) 32 Bit.</p>\n\n<p>The bug could be reproduced as such :</p>\n\n<ul>\n<li>Expand a group so that the new rows will exceed the bottom of the \nscreen and force the screen to scroll up.   </li>\n<li>Similarly, unhide rows\nin the same conditions.</li>\n</ul>\n\n<p>I was able to find several other workaround :</p>\n\n<ul>\n<li>Change the height of the first row</li>\n<li>Remove \"Heading\" (from Ribbon View - Heading).</li>\n<li>Remove Those 3 options TOEGETHER (from option - advanced).\n\n<ul>\n<li>Show horizontal scroll bar</li>\n<li>Show vertical scroll bar</li>\n<li>Show sheet Tabs</li>\n</ul></li>\n<li>Change Screen zoom</li>\n<li>UnFreezing panel</li>\n<li>Delete ALL conditionnal formating</li>\n<li>Use another computer.</li>\n</ul>\n\n<p>The following actions had no impacts :</p>\n\n<ul>\n<li><p>Groups are not involved, unhiding rows is the key :</p>\n\n<ul>\n<li>reduce nesting group level => Freeze</li>\n<li>Delete all groups and rebuild them => Freeze</li>\n</ul></li>\n<li><p>Other graphical components are not involved : </p>\n\n<ul>\n<li>Delete comments => Freeze</li>\n<li>Delete VBA components (buttons) => Freeze</li>\n<li>Clean unused format (with XlStyleTool) => Freeze</li>\n<li>Unmerge cells => Freeze</li>\n</ul></li>\n<li><p>One single conditional formatting leads to the problem  :</p>\n\n<ul>\n<li>Delete some conditional formatting => Freeze</li>\n<li>changing condition formulas => Freeze</li>\n<li>changing option (stop if true) => Freeze</li>\n<li>changing format => Freeze</li>\n<li>Delete all conditional formatting, save file under another name and create one new conditional formatting => Freeze</li>\n</ul></li>\n<li><p>File format is not involved : </p>\n\n<ul>\n<li>Saving the file to Excel 2003 format and use it in compatibility mode. => Freeze</li>\n<li>Copy the sheet to another workbook. => Freeze</li>\n<li>Using page Break view instead of normal. => Freeze</li>\n</ul></li>\n<li><p>Disable Hardware Acceleration => Freeze</p></li>\n<li>Disable Add-in => Freeze</li>\n</ul>\n\n<p>My conclusion is that it is a graphical bug linked to my video driver in very specific conditions. I just increased the first row size which fixed the problem.</p>\n\n<p>My graphical card and drivers are : </p>\n\n<ul>\n<li>AMD Radeon HD 7400M Series - BIOS Version 013.009.000.010</li>\n<li>Catalyst Version  15.7.1</li>\n<li>Windows 7 - 64 Bit - Sp1</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9174270, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ybv-5I1JtqA/AAAAAAAAAAI/AAAAAAAAGJg/nI2roARj1xQ/photo.jpg?sz=128", "display_name": "SLC", "link": "https://stackoverflow.com/users/9174270/slc"}, "is_accepted": false, "score": 0, "last_activity_date": 1515090432, "creation_date": 1515090432, "answer_id": 48101421, "question_id": 34636358, "link": "https://stackoverflow.com/questions/34636358/excel-freezes-when-expanding-group-of-rows-with-conditional-formatting/48101421#48101421", "title": "Excel freezes when expanding group of rows with conditional formatting", "body": "<p>I had the same issue in one particular sheet. My workaround was set the same font for all the sheet (font and size)</p>\n"}], "owner": {"reputation": 85, "user_id": 2517056, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0325736c166073da4f0f278518be635d?s=128&d=identicon&r=PG", "display_name": "AFisher", "link": "https://stackoverflow.com/users/2517056/afisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4279, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1536138698, "creation_date": 1452092861, "question_id": 34636358, "link": "https://stackoverflow.com/questions/34636358/excel-freezes-when-expanding-group-of-rows-with-conditional-formatting", "title": "Excel freezes when expanding group of rows with conditional formatting", "body": "<p><strong>Issue:</strong> Excel freezes when expanding group of rows which contain conditional formatting. I can save using <code>CTRL + S</code>, but worksheet functionality and toolbar buttons lock up.</p>\n\n<p><strong>Working solution:</strong> Deleting the conditional formatting, which consists of:</p>\n\n<ul>\n<li>Rule: <code>=AND($C7&lt;&gt;\"\",$C7&lt;&gt;0)</code></li>\n<li>Applies to: <code>=$C$7:$AB$84</code></li>\n</ul>\n\n<p><strong>Excel version:</strong> Excel 2016</p>\n\n<p><strong>File Type:</strong> .xlsb</p>\n\n<p><strong>Background details:</strong> Rows were initially grouped with a macro. VBA code which groups the rows:</p>\n\n<pre><code>ws.Range(ws.Cells(firstRow, 1), ws.Cells(lastRow, 1)).Rows.Group\nws.Outline.ShowLevels RowLevels:=1\n</code></pre>\n\n<p><code>Screenupdating</code> is set to <code>True</code>. There are no other row groups. Beyond failure to expand the group, I have not come accross any other issues with the file.</p>\n\n<p>How can I prevent this without deleting the conditional formatting?</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1452100588, "post_id": 34636229, "comment_id": 57023012, "body": "Yes, it&#39;s possible.  What happened when you tried Tony&#39;s solution?"}, {"owner": {"reputation": 21, "user_id": 5752589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e37b411f7fc01eef813b17726d246c?s=128&d=identicon&r=PG&f=1", "display_name": "Ole Kristian H.", "link": "https://stackoverflow.com/users/5752589/ole-kristian-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452161102, "post_id": 34636229, "comment_id": 57049580, "body": "Hi, tanks for the answer. Noting spesial happend when using this solution. I had hoped that the code showed me som hidden start point in the HTMLBoddy. But it only showed the [CR],  [LF], [NBSP] and [TAB] in the text."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5752589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e37b411f7fc01eef813b17726d246c?s=128&d=identicon&r=PG&f=1", "display_name": "Ole Kristian H.", "link": "https://stackoverflow.com/users/5752589/ole-kristian-h"}, "edited": false, "score": 0, "creation_date": 1452160479, "post_id": 34640076, "comment_id": 57049152, "body": "Hi, thanks for the answer. That was the same impression I had after googling this. But I hoped that it was a small opportunity that the signature had some hidden start reference that was saved after the mail was sendt. I have tried Regex too. Tried making a pattern that could recognize the start position.But I gave up. Thanks again for the response!"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 2, "last_activity_date": 1452104641, "creation_date": 1452104641, "answer_id": 34640076, "question_id": 34636229, "link": "https://stackoverflow.com/questions/34636229/is-it-possible-to-delete-the-signature-from-a-email-body-when-importing-it-from/34640076#34640076", "title": "Is it possible to delete the signature from a email body, when importing it from outlook to excel using VBA", "body": "<p>Unfortunately, it's nearly impossible unless you can expect some unique text that can signify where the signature begins so you can strip it out.  This is possible during compose mode, where any signature is enclosed with the <code>&lt;span style='mso-bookmark:_MailAutoSig'&gt;</code> block.  However, that block is removed when the email is sent and is not present in the received copy.</p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1452164528, "creation_date": 1452164528, "answer_id": 34653492, "question_id": 34636229, "link": "https://stackoverflow.com/questions/34636229/is-it-possible-to-delete-the-signature-from-a-email-body-when-importing-it-from/34653492#34653492", "title": "Is it possible to delete the signature from a email body, when importing it from outlook to excel using VBA", "body": "<p>Eric's suggestion makes any sense only in case HTML based messages. </p>\n\n<p>But users may prefer composing items in plain text. In that case the suggested way of searching bookmarks will fail. You need to know the signature content and search it in the body.</p>\n\n<p>By default you can find the Signatures folder in the following location;</p>\n\n<p>Windows XP</p>\n\n<ul>\n<li>C:\\Documents and Settings\\%username%\\Application Data\\Microsoft\\Signatures</li>\n</ul>\n\n<p>Windows 8, Windows 7 and Windows Vista</p>\n\n<ul>\n<li>C:\\Users\\%username%\\AppData\\Roaming\\Microsoft\\Signatures\nLook for the following files and folders;</li>\n</ul>\n\n<p>[signature_name].htm - This file is used when creating HTML messages.</p>\n\n<p>[signature_name].rtf - This file is used when creating Rich Text messages.</p>\n\n<p>[signature_name].txt - This file is used when creating Plain Text message.</p>\n\n<p>[signature_name]_files - This folder is used in Outlook to store supporting files for your signature such as formatting, images and/or business cards (vcf-files).</p>\n\n<p>So, you can check the folder for a corresponding signature file, read the file content and try to find such text in the message body depending on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869979.aspx\" rel=\"nofollow\">BodyFormat</a> used.</p>\n\n<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a> - a string representing the clear-text body of the Outlook item.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a> - a string representing the HTML body of the specified item.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">Word editor</a> - the Microsoft Word Document Object Model of the message being displayed. The WordEditor property of the Inspector class returns an instance of the Document class from the Word object model which you can use to set up the message body.</li>\n</ol>\n\n<p>You can read more about all these ways in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. It us up to you which way is to choose to customize the signature in the message body.</p>\n"}], "owner": {"reputation": 21, "user_id": 5752589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e37b411f7fc01eef813b17726d246c?s=128&d=identicon&r=PG&f=1", "display_name": "Ole Kristian H.", "link": "https://stackoverflow.com/users/5752589/ole-kristian-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1123, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1452164528, "creation_date": 1452092477, "last_edit_date": 1495535298, "question_id": 34636229, "link": "https://stackoverflow.com/questions/34636229/is-it-possible-to-delete-the-signature-from-a-email-body-when-importing-it-from", "title": "Is it possible to delete the signature from a email body, when importing it from outlook to excel using VBA", "body": "<p>I wonder if it is possible to remove the signature from a email body, when importing that email into excel?</p>\n\n<p>I am trying out the suggested solution from <a href=\"https://stackoverflow.com/questions/11876549/how-to-copy-outlook-mail-message-into-excel-using-vba-or-macros/12146315#12146315\">Tony Dallimore from this earlier posted topic</a>,  to import email from Outlook into excel.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452215127, "post_id": 34636338, "comment_id": 57081610, "body": "Doesn&#39;t seem to do anything different. Maybe if I try adding to the first row where the cell in column A is blank."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452261168, "post_id": 34636338, "comment_id": 57102475, "body": "@Advancin - My apologies. I forgot to add 1 to the <code>lRow</code> to offset the last used row by 1, meaning the next available row. See my edited answer."}, {"owner": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452268009, "post_id": 34636338, "comment_id": 57107225, "body": "That&#39;s working, but it&#39;s skipping a row in between each one. So it&#39;s pasting the information, then skip row, then paste the information, etc...haha"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452270085, "post_id": 34636338, "comment_id": 57108815, "body": "did you step-through the code to see why it&#39;s doing that? perhaps there are some blank tables in the word document that you do not realize? Either way, stepping through the code line-by-line will surely tell you where the flaw is and then you (or I) can adjust from there. Please do that and let me know what happens, because I cannot test it without data. When doing this pay attention to the value of <code>lRow</code> during each loop."}, {"owner": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452538655, "post_id": 34636338, "comment_id": 57204012, "body": "This is so weird! I&#39;ve gotten it working by doing <code>lRow - 1</code> instead of just <code>lRow</code>. Any idea why it would be this is the case?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452539041, "post_id": 34636338, "comment_id": 57204233, "body": "@Advancin -  Its hard to say without being able to see the data you are working with."}, {"owner": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "edited": false, "score": 0, "creation_date": 1452539314, "post_id": 34636338, "comment_id": 57204396, "body": "Roger that. Thank you for the help with this! I&#39;m marking your answer as correct but will update my original question with my correct solution as well. Have a great one ;)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1452261125, "last_edit_date": 1452261125, "creation_date": 1452092810, "answer_id": 34636338, "question_id": 34636220, "link": "https://stackoverflow.com/questions/34636220/import-data-from-specific-cells-in-word-table-to-specific-cells-in-excel-workboo/34636338#34636338", "title": "Import Data from Specific Cells in Word Table to Specific Cells in Excel Workbook start on the first blank row upon each import", "body": "<p>You can find the next available row in the sheet and write to that row each time with the below modifications to your <code>For Loop</code></p>\n\n<pre><code>For iTable = 1 To TableNo\n\n       Dim lRow As Long\n       lRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row +1\n\n        With .tables(TableNo)\n\n            'copy cell contents from Word table cells to Excel cells\n            'copy cell contents from Word table cells to Excel cells in column B and C\n            Cells(lRow, \"A\") = WorksheetFunction.Clean(.cell(14, 2).Range.Text)\n            Cells(lRow, \"B\") = WorksheetFunction.Clean(.cell(2, 2).Range.Text) 'need to post current date\n            Cells(lRow, \"C\") = WorksheetFunction.Clean(.cell(16, 2).Range.Text)\n            Cells(lRow, \"D\") = WorksheetFunction.Clean(.cell(15, 2).Range.Text)\n            Cells(lRow, \"E\") = WorksheetFunction.Clean(.cell(1, 2).Range.Text)\n            Cells(lRow, \"H\") = WorksheetFunction.Clean(.cell(7, 2).Range.Text)\n            Cells(lRow, \"I\") = WorksheetFunction.Clean(.cell(8, 2).Range.Text)\n            Cells(lRow, \"S\") = WorksheetFunction.Clean(.cell(3, 2).Range.Text) 'need to post name of negotiatoe\n\n        End With\n\nNext iTable\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 2517410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/954d33313e5be812807e5109679151b8?s=128&d=identicon&r=PG", "display_name": "Advancin", "link": "https://stackoverflow.com/users/2517410/advancin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 34636338, "answer_count": 1, "score": 2, "last_activity_date": 1452539442, "creation_date": 1452092456, "last_edit_date": 1452539442, "question_id": 34636220, "link": "https://stackoverflow.com/questions/34636220/import-data-from-specific-cells-in-word-table-to-specific-cells-in-excel-workboo", "title": "Import Data from Specific Cells in Word Table to Specific Cells in Excel Workbook start on the first blank row upon each import", "body": "<p>I've got part of this going with a VBA script I found that I slightly modified. I need to import some information from a word table into excel. The problem I'm having is that the script overwrites the first row and I need it to go to the first blank row each time it's used.</p>\n\n<p>Here is what I've got:</p>\n\n<pre><code>Sub ImportWordTable()\nDim wdDoc As Object\nDim wdFileName As Variant\nDim TableNo As Integer 'table number in Word\nDim iTable As Integer  'table number index\nDim iRow As Long     'row index in Excel\nDim iCol As Integer  'column index in Excel\n\nwdFileName = Application.GetOpenFilename(\"Word files (*.docx),*.docx\", , _\n\"Browse for file containing table to be imported\")\n\nIf wdFileName = False Then Exit Sub '(user cancelled import file browser)\n\nSet wdDoc = GetObject(wdFileName) 'open Word file\n\nWith wdDoc\nTableNo = wdDoc.tables.Count\nIf TableNo = 0 Then\nMsgBox \"This document contains no tables\", _\nvbExclamation, \"Import Word Table\"\nElseIf TableNo &gt; 1 Then\nTableNo = InputBox(\"This Word document contains \" &amp; TableNo &amp; \" tables.\" &amp; vbCrLf &amp; _\n\"Enter table number of table to import\", \"Import Word Table\", \"1\")\nEnd If\n\n'Range(\"A1\") = \"Table #\"\n'Range(\"B1\") = \"Cell (3,2)\"\n'Range(\"C1\") = \"Cell (4,2)\"\n\nFor iTable = 1 To TableNo\nWith .tables(TableNo)\n'copy cell contents from Word table cells to Excel cells\n'copy cell contents from Word table cells to Excel cells in column B and C\nCells(iTable + 1, \"A\") = WorksheetFunction.Clean(.cell(14, 2).Range.Text)\nCells(iTable + 1, \"B\") = WorksheetFunction.Clean(.cell(2, 2).Range.Text) 'need to post current date\nCells(iTable + 1, \"C\") = WorksheetFunction.Clean(.cell(16, 2).Range.Text)\nCells(iTable + 1, \"D\") = WorksheetFunction.Clean(.cell(15, 2).Range.Text)\nCells(iTable + 1, \"E\") = WorksheetFunction.Clean(.cell(1, 2).Range.Text)\nCells(iTable + 1, \"H\") = WorksheetFunction.Clean(.cell(7, 2).Range.Text)\nCells(iTable + 1, \"I\") = WorksheetFunction.Clean(.cell(8, 2).Range.Text)\nCells(iTable + 1, \"S\") = WorksheetFunction.Clean(.cell(3, 2).Range.Text) 'need to post name of negotiatoe\nEnd With\nNext iTable\nEnd With\n</code></pre>\n\n<p>Scott's answer is correct for this. Something strange with the data or something in my file is causing abnormal behavior so below is what is working for me.</p>\n\n<pre><code>Sub ImportWordTable()\nDim wdDoc As Object\nDim wdFileName As Variant\nDim TableNo As Integer 'table number in Word\nDim iTable As Integer  'table number index\nDim iRow As Long     'row index in Excel\nDim iCol As Integer  'column index in Excel\n\nwdFileName = Application.GetOpenFilename(\"Word files (*.docx),*.docx\", , _\n\"Browse for file containing table to be imported\")\n\nIf wdFileName = False Then Exit Sub '(user cancelled import file browser)\n\nSet wdDoc = GetObject(wdFileName) 'open Word file\n\nWith wdDoc\nTableNo = wdDoc.tables.Count\nIf TableNo = 0 Then\nMsgBox \"This document contains no tables\", _\nvbExclamation, \"Import Word Table\"\nElseIf TableNo &gt; 1 Then\nTableNo = InputBox(\"This Word document contains \" &amp; TableNo &amp; \" tables.\" &amp; vbCrLf &amp; _\n\"Enter table number of table to import\", \"Import Word Table\", \"1\")\nEnd If\n\n'Range(\"A1\") = \"Table #\"\n'Range(\"B1\") = \"Cell (3,2)\"\n'Range(\"C1\") = \"Cell (4,2)\"\n\nFor iTable = 1 To TableNo\n\n       Dim lRow As Long\n       lRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row + 1\n\n        With .tables(TableNo)\n\n            'copy cell contents from Word table cells to Excel cells\n            'copy cell contents from Word table cells to Excel cells in column B and C\n            Cells(lRow - 1, \"A\") = WorksheetFunction.Clean(.cell(14, 2).Range.Text)\n            Cells(lRow - 1, \"B\") = WorksheetFunction.Clean(.cell(2, 2).Range.Text) 'need to post current date\n            Cells(lRow - 1, \"C\") = WorksheetFunction.Clean(.cell(16, 2).Range.Text)\n            Cells(lRow - 1, \"D\") = WorksheetFunction.Clean(.cell(15, 2).Range.Text)\n            Cells(lRow - 1, \"E\") = WorksheetFunction.Clean(.cell(1, 2).Range.Text)\n            Cells(lRow - 1, \"H\") = WorksheetFunction.Clean(.cell(7, 2).Range.Text)\n            Cells(lRow - 1, \"I\") = WorksheetFunction.Clean(.cell(8, 2).Range.Text)\n            Cells(lRow - 1, \"S\") = WorksheetFunction.Clean(.cell(3, 2).Range.Text) 'need to post name of negotiatoe\n\n        End With\n\nNext iTable\nEnd With\n\nSet wdDoc = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452094413, "post_id": 34636071, "comment_id": 57018796, "body": "Are you calling this function from a worksheet cell, and the return in the cell is #NAME?  If that is the case, where did you put the code?  It should normally be in a Regular module in the same workbook.  Did you name the module with the same name as the function?  Also, did you set a reference to Regular Expressions under tools/references?"}, {"owner": {"reputation": 3, "user_id": 3589514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c89b3dc4da1315768db698cedc5ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Haybuck", "link": "https://stackoverflow.com/users/3589514/haybuck"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452094676, "post_id": 34636071, "comment_id": 57018984, "body": "Yes, I am calling this from a worksheet cell, and the return in the cell is #NAME.  The code is in a module in the workbook.  The module and function do have the same name.  I have turned on the reference to regular expressions.  Everything works fine when I copy-paste the code in step 2 of the link I provided verbatim, however when I do this, it causes the #NAME error, implying it&#39;s an issue with code, not naming schema, location, or references."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452094716, "post_id": 34636071, "comment_id": 57019019, "body": "How and where did you put the VBA code?"}, {"owner": {"reputation": 3, "user_id": 3589514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c89b3dc4da1315768db698cedc5ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Haybuck", "link": "https://stackoverflow.com/users/3589514/haybuck"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452094763, "post_id": 34636071, "comment_id": 57019049, "body": "Sorry, just edited my original reply. Accidentally hit enter early."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452094936, "post_id": 34636071, "comment_id": 57019171, "body": "If your module and function have the same name, Excel does not know which you are referring to.  So they need to have different names, or you need to use a fully qualified name."}, {"owner": {"reputation": 3, "user_id": 3589514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c89b3dc4da1315768db698cedc5ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Haybuck", "link": "https://stackoverflow.com/users/3589514/haybuck"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452095028, "post_id": 34636071, "comment_id": 57019238, "body": "Whelp. That did it. Thank you!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452095168, "post_id": 34636071, "comment_id": 57019325, "body": "I will add that as an answer in the thread, with a more full explanation and suggestions"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3589514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c89b3dc4da1315768db698cedc5ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Haybuck", "link": "https://stackoverflow.com/users/3589514/haybuck"}, "edited": false, "score": 0, "creation_date": 1452094506, "post_id": 34636896, "comment_id": 57018864, "body": "Except when I use the one from the example verbatim, it works. I&#39;ve already turned on the reference."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452094864, "post_id": 34636896, "comment_id": 57019114, "body": "If there were a missing reference, it would give a compile error in the vbe, not a #NAME error in the cell."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1452094940, "post_id": 34636896, "comment_id": 57019176, "body": "Ah, so if you execute in the Immediate window (a.k.a. the Debug Window) it works, right? Make sure the function is in a Module and not in the worksheet class. This will also cause that."}], "tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": 0, "last_activity_date": 1452094456, "creation_date": 1452094456, "answer_id": 34636896, "question_id": 34636071, "link": "https://stackoverflow.com/questions/34636071/regex-extraction-name-error/34636896#34636896", "title": "RegEx Extraction #NAME error", "body": "<p>Looks to me that you are missing the reference to the Reg Expression library. \nI think this is Microsoft VBScript Regular Expressions in the References dialog box (Tools:Referneces in the VBIDE)...</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1452095290, "creation_date": 1452095290, "answer_id": 34637154, "question_id": 34636071, "link": "https://stackoverflow.com/questions/34636071/regex-extraction-name-error/34637154#34637154", "title": "RegEx Extraction #NAME error", "body": "<p>It seems you have named the module and the function the same.  When that happens, Excel doesn't know which you mean, so returns the #NAME error.  There are two fixes:</p>\n\n<ol>\n<li><p>Change the name of one or the other.  I will frequently prefix all regular module names with <code>mod</code> so as to avoid this problem:  <code>modextractGroupName</code></p></li>\n<li><p>Call the function with a fully qualified name:</p></li>\n</ol>\n\n<hr>\n\n<pre><code>=extractGroupName.extractGroupName(A1)\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 3, "user_id": 3589514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61c89b3dc4da1315768db698cedc5ae8?s=128&d=identicon&r=PG&f=1", "display_name": "Haybuck", "link": "https://stackoverflow.com/users/3589514/haybuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 34637154, "answer_count": 2, "score": 0, "last_activity_date": 1453606681, "creation_date": 1452092052, "last_edit_date": 1495541717, "question_id": 34636071, "link": "https://stackoverflow.com/questions/34636071/regex-extraction-name-error", "title": "RegEx Extraction #NAME error", "body": "<p>I'm trying to create my own VBA Function based on the one in step two at this link. <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n\n<p>However, I get a #NAME error. Where am I going wrong here? I've tested my RegEx on <a href=\"https://regex101.com\" rel=\"nofollow noreferrer\">https://regex101.com</a>.</p>\n\n<pre><code>Function extractGroupName(Myrange As Range) As String\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim strOutput As String\n\n    strPattern = \"^.*Name:(.*);Id\"\n\n    If strPattern &lt;&gt; \"\" Then\n        strInput = Myrange.Value\n        strReplace = \"$1\"\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n\n        If regEx.Test(strInput) Then\n            extractGroupName = regEx.Replace(strInput, \"$1\")\n        Else\n            extractGroupName = \"ERROR: NOT FOUND\"\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452091899, "post_id": 34635522, "comment_id": 57016988, "body": "if you are trying to have more then 256 series in a chart, it&#39;s not possible, as that is the limit Excel imposes. If you are <i>trying to avoid</i> some other issue, please restate your question :)"}, {"owner": {"reputation": 909, "user_id": 4274408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46c3ba48a771760b978c30df044b20a9?s=128&d=identicon&r=PG&f=1", "display_name": "martinkabe", "link": "https://stackoverflow.com/users/4274408/martinkabe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452092064, "post_id": 34635522, "comment_id": 57017119, "body": "First I&#39;d like to avoid this issue :-)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452092371, "post_id": 34635522, "comment_id": 57017376, "body": "<i>First I&#39;d like to avoid this issue</i> - which issue, the 255 chart series limit? It&#39;s not possible <a href=\"https://support.office.com/en-us/article/Excel-specifications-and-limits-CA36E2DC-1F09-4620-B726-67C00B05040F\" rel=\"nofollow noreferrer\">See Data series in one chart in this link</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452092478, "post_id": 34635522, "comment_id": 57017445, "body": "Why do you think you need them as separate series for each row?"}, {"owner": {"reputation": 909, "user_id": 4274408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46c3ba48a771760b978c30df044b20a9?s=128&d=identicon&r=PG&f=1", "display_name": "martinkabe", "link": "https://stackoverflow.com/users/4274408/martinkabe"}, "edited": false, "score": 0, "creation_date": 1452092806, "post_id": 34635522, "comment_id": 57017673, "body": "Rory, I&#39;m also using piece of code late for access to particular bubble (row) for color changing."}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 1, "last_activity_date": 1452548852, "creation_date": 1452548852, "answer_id": 34731745, "question_id": 34635522, "link": "https://stackoverflow.com/questions/34635522/how-to-avoid-a-chart-may-only-have-up-to-256-series-issue-excel-vba/34731745#34731745", "title": "How to avoid &quot;A Chart may only have up to 256 series&quot; issue (Excel VBA)", "body": "<p>You only need as many series as you have colors. Certainly you don't need more than 255 colors, since no human would be able to distinguish more than a dozen in a cluttered bubble chart.</p>\n\n<p>Set up the data with four columns for X, Y, bubble size, and bubble color. Append another column for each color in the bubble color column, and use the color name as the column header. Use an IF formula in these columns to put the Y value for each color into the appropriate column.</p>\n\n<p>In my example, I have X and Y in columns A and B, bubble size and color in C and D, plus the bubble color names in E1:G1. The formula in cell E2 is</p>\n\n<p><code>=IF($D2=E$1,$B2,NA())</code></p>\n\n<p>and I've filled this into E2:G16. The result is the Y value if the column header matches the color, and #N/A otherwise, which will not plot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tTGbx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tTGbx.png\" alt=\"data for bubble chart\"></a></p>\n\n<p>Select A2:C19 and create the bubble chart (top left chart). </p>\n\n<p>Click the Select Data button on the Chart Tools > Design tab of the ribbon, select the only series in the chart, and Edit it, so cell E1 is used for the name, and E2:E16 is used for the Y values. Keep A2:A16 as the X values and C2:C16 as the bubble size. This series will have the default color for the first series, which in Excel 2013 and 2016 is blue (top right chart).</p>\n\n<p>Stay in or return to the Edit Data dialog, and add a series. Use cell F1 for series name, A2:A16 as X values, F2:F16 as Y values, and C2:C16 as the bubble size. This series will use the default second color, orange (bottom left chart).</p>\n\n<p>Add one more series, use cell G1 for series name, A2:A16 as X values, G2:G16 as Y values, and C2:C16 as the bubble size. This series uses the default third color, gray (bottom right chart).</p>\n\n<p>Note that all series use the same X values and bubble sizes, but different Y values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GSspL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GSspL.png\" alt=\"evolution of bubble chart\"></a></p>\n"}], "owner": {"reputation": 909, "user_id": 4274408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46c3ba48a771760b978c30df044b20a9?s=128&d=identicon&r=PG&f=1", "display_name": "martinkabe", "link": "https://stackoverflow.com/users/4274408/martinkabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452548852, "creation_date": 1452090502, "last_edit_date": 1531164843, "question_id": 34635522, "link": "https://stackoverflow.com/questions/34635522/how-to-avoid-a-chart-may-only-have-up-to-256-series-issue-excel-vba", "title": "How to avoid &quot;A Chart may only have up to 256 series&quot; issue (Excel VBA)", "body": "<p>I'm trying to build bubble chart from a scratch in excel. Below is piece of code I'm using. Everything works fine until SeriesCollection.NewSeries reaches 256. Then I'm getting error message: A Chart may only have up to 256 series.</p>\n\n<p>Can you anybody help me, how to avoid this issue. Is there any more elegant solution? Thanks a lot for any of your hint or advice.</p>\n\n<p><strong>Source code for my bubble chart:</strong></p>\n\n<pre><code>With wsAnalytics.ChartObjects.Add(Left:=0, Width:=995, Top:=0, Height:=580)\n  For i = 1 To Range(\"Config_BubbleChartData\").Rows.Count\n    .Chart.SeriesCollection.NewSeries\n    .Chart.SeriesCollection(i).name = Range(\"Config_BubbleChartData\").Rows(i).Cells(1, 1)\n    .Chart.SeriesCollection(i).XValues = Range(\"Config_BubbleChartData\").Rows(i).Cells(1, 3)\n    .Chart.SeriesCollection(i).Values = Range(\"Config_BubbleChartData\").Rows(i).Cells(1, 4)\n\n    Select Case BubbleColor\n        Case 1\n        .Chart.SeriesCollection(i).Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\n        Case 2\n        .Chart.SeriesCollection(i).Format.Fill.ForeColor.RGB = RGB(0, 0, 255)\n        Case 3\n        .Chart.SeriesCollection(i).Format.Fill.ForeColor.RGB = RGB(0, 255, 0)\n    End Select\n    If i = 1 Then .Chart.ChartType = xlBubble3DEffect\n    .Chart.SeriesCollection(i).BubbleSizes = \"=\" &amp;     Range(\"Config_BubbleChartData\").Parent.name _\n            &amp; \"!\" &amp; Range(\"Config_BubbleChartData\").Rows(i).Cells(1, 5).Address(1, 1, xlR1C1)\n  Next i\n</code></pre>\n"}, {"tags": ["excel", "vba", "find", "duplicates"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452090258, "post_id": 34635009, "comment_id": 57015851, "body": "Do you need to do it in VBA?  It can be done by formula...."}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452091819, "post_id": 34635009, "comment_id": 57016925, "body": "It doesn&#39;t have to be done in VBA. I just hadn&#39;t found a way to do it in a single cell without using VBA until now."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452092505, "post_id": 34635009, "comment_id": 57017469, "body": "My contestants are in A1:C11 with B &amp; C being their predictions.  The actual results are in E2 &amp; F2"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452092568, "post_id": 34635009, "comment_id": 57017512, "body": "H2 to H11, you have the array formula =IFERROR(SMALL(IF((($B$2:$B$11=$E$2)*($C$2:$C$11=$F$2)),ROW(&zwnj;&#8203;$B$2:$B$11)-1),ROWS(&zwnj;&#8203;$B$2:$B3)),&quot;&quot;)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452092594, "post_id": 34635009, "comment_id": 57017531, "body": "I2 to I11, you have the normal formula =IFERROR(INDEX($A$2:$A$11,H2,1),&quot;&quot;)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452092611, "post_id": 34635009, "comment_id": 57017549, "body": "The use concatenate to combine the results, so i had 2 winners, so was"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452092666, "post_id": 34635009, "comment_id": 57017589, "body": "=CONCATENATE(I2,IF(I3&lt;&gt;&quot;&quot;, &quot; and &quot; &amp; I3,&quot;&quot;)) and so on...."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452092708, "post_id": 34635009, "comment_id": 57017619, "body": "gives me the result &quot;Person 3 and Person 8&quot;"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452094009, "post_id": 34635009, "comment_id": 57018508, "body": "@Nathan_Sav  =IFERROR(SMALL(IF((($C$9:$C$21=$B$3)),ROW($C$9:$C$21)-1),ROW&zwnj;&#8203;S($C$9:$C9)),&quot;&quot;) =IFERROR(INDEX($A$9:$A$21,I9,1),&quot;&quot;)"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452094013, "post_id": 34635009, "comment_id": 57018514, "body": "=CONCATENATE(J9,IF(J10&lt;&gt;&quot;&quot;, &quot; and &quot; &amp; J10,&quot;&quot;))"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452094037, "post_id": 34635009, "comment_id": 57018525, "body": "Still not working for me using it for my sheet. Suggestions"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452094201, "post_id": 34635009, "comment_id": 57018632, "body": "Without seeing what you&#39;ve done or your sheet, no suggestions :)"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452094269, "post_id": 34635009, "comment_id": 57018693, "body": "If I edit my post, can I attach my current worksheet?"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452094675, "post_id": 34635009, "comment_id": 57018982, "body": "I&#39;ve shown an image of what my worksheet looks like right now"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452095082, "post_id": 34635009, "comment_id": 57019275, "body": "You havent applied my formula correctly, you are only checking b3, and you need to fill it down 19:i21.  Look at my original comments, ((($B$2:$B$11=$E$2)*($C$2:$C$11=$F$2) and I2 to I11 etc...  They are array formula also, so ctrl+shift+enter."}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452095596, "post_id": 34635009, "comment_id": 57019629, "body": "@Nathan_Sav It was copied down but I hadn&#39;t made it an array. Now I have but I get no result. I&#39;m not sure what else I should be checking beside B3 because that&#39;s the only relevant number. unless I&#39;m misunderstanding what the first function truly does."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452095997, "post_id": 34635009, "comment_id": 57019914, "body": "Sorry, i had it in my head for some reason, the contestants picked 2 numbers, also you are looking for &quot;the random number is 5&quot;"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452096144, "post_id": 34635009, "comment_id": 57020004, "body": "I&#39;ve simply changed the format of that cell so that what ever number is returned has &quot;The Random Number Is &quot; in front of it."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452096847, "post_id": 34635009, "comment_id": 57020456, "body": "I&#39;ve just copied your sheet, and used =IFERROR(SMALL(IF($C$9:$C$20=$B$3,ROW($C$9:$C$20)-8),ROWS($I&zwnj;&#8203;$9:$I9)),&quot;&quot;) and it works fine.   I cant attach an image for some reason to show you"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452098163, "post_id": 34637692, "comment_id": 57021356, "body": "Thanks. This helps except for 1 thing. When I hit F9 to refresh my page and get a new Random number, I do not get The correct winner. I&#39;ve copied in this Code into VBA and then used the ListWinners command but It doesn&#39;t always give me the correct answer. Suggestions?"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452098484, "post_id": 34637692, "comment_id": 57021553, "body": "I figured out my problem. I had &quot;=ListWinners(A9:B21,D9:D21)&quot; and it needed to be A9:A21. Now it works. Thank you so much. Any chance we can add a clause in this code? Right now if a contestant doesn&#39;t guess and leaves their answer at &quot;0&quot; and the random number chooses &quot;1&quot;, they win even though they aren&#39;t playing. Can it check column &quot;C&quot; first to make sure a number between the specified Max and Min of the Random number is entered?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452099379, "post_id": 34637692, "comment_id": 57022153, "body": "Just make the default value something like <b>9999</b> rather than <b>0</b>"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452105173, "post_id": 34637692, "comment_id": 57025798, "body": "I just shut my page down and when I re-opened this workbook, I&#39;m getting a Name Error for ListWinners. Thoughts on what I did wrong? Did I somehow screw up inserting the Module into VBA?"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452105758, "post_id": 34637692, "comment_id": 57026191, "body": "I also noticed that row 5 of your code has &quot;delta &quot; spelled in the singular and everywhere else in the code it is &quot;deltas&quot;. Is that on purpose?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452106490, "post_id": 34637692, "comment_id": 57026663, "body": "The <code>delta</code> variable is Declared, but not used...........................se my <b>EDIT#1:</b>"}, {"owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "edited": false, "score": 0, "creation_date": 1452106873, "post_id": 34637692, "comment_id": 57026889, "body": "Thank you. You have been sooooo helpful. Don&#39;t know what changed but I re-saved my worksheet and unable to run VBA the re-saved again to run VBA again. Then I deleted my former ListWinners Module and copy-pasted your current ListWinners Module code using your instructions. Works again. Thanks."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1452106344, "last_edit_date": 1525816150, "creation_date": 1452096923, "answer_id": 34637692, "question_id": 34635009, "link": "https://stackoverflow.com/questions/34635009/how-do-i-find-the-cell-address-of-duplicates-using-vba/34637692#34637692", "title": "How do I find the cell address of duplicates using VBA", "body": "<p>How about the following <em>UDF()</em>:</p>\n\n<pre><code>Option Explicit\n\nPublic Function ListWinners(people As Range, deltas As Range) As String\n   Dim wf As WorksheetFunction\n   Dim i As Long, delta As Long, msg As String\n   Dim WinningValue As Long\n   Set wf = Application.WorksheetFunction\n   ListWinners = \"\"\n   msg = \" wins\"\n   WinningValue = wf.Min(deltas)\n   For i = 1 To deltas.Rows.Count\n      If deltas(i) = WinningValue Then\n         If ListWinners = \"\" Then\n            ListWinners = people(i)\n         Else\n            ListWinners = ListWinners &amp; \" &amp; \" &amp; people(i)\n            msg = \" tie\"\n         End If\n      End If\n   Next i\n   ListWinners = ListWinners &amp; msg\nEnd Function\n</code></pre>\n\n<p>In your posted example, use it like:</p>\n\n<pre><code>=ListWinners(A9:A21,C9:C21)\n</code></pre>\n\n<p>to display the winner list in a <strong>single cell.</strong></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>User Defined Functions (UDFs) are very easy to install and use:</p>\n\n<ol>\n<li>ALT-F11  brings up the VBE window</li>\n<li>ALT-I\nALT-M opens a fresh module</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you save the workbook, the UDF will be saved with it.\nIf you are using a version of Excel later then 2003, <strong>you must save\nthe file as .xlsm rather than .xlsx</strong></p>\n\n<p>To remove the UDF:</p>\n\n<ol>\n<li>bring up the VBE window as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To use the UDF from Excel:</p>\n\n<pre><code>=ListWinners(A1:A100,B1:B100)\n</code></pre>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>and for specifics on UDFs, see:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/WritingFunctionsInVBA.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/WritingFunctionsInVBA.aspx</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n"}], "owner": {"reputation": 55, "user_id": 5752380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60a6182fa992acb0f0968bae9bed955?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Moffatt", "link": "https://stackoverflow.com/users/5752380/jordan-moffatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 34637692, "answer_count": 1, "score": 4, "last_activity_date": 1452106344, "creation_date": 1452088918, "last_edit_date": 1452099016, "question_id": 34635009, "link": "https://stackoverflow.com/questions/34635009/how-do-i-find-the-cell-address-of-duplicates-using-vba", "title": "How do I find the cell address of duplicates using VBA", "body": "<p>I'm brand new to using VBA within excel. I'm not even 100% sure on how to insert a module correctly to begin with so this will be a big help.</p>\n\n<p>I've set up a worksheet that randomizes a number between 1 and 100. </p>\n\n<pre><code>B3  =RANDBETWEEN(C6,F6)\n</code></pre>\n\n<p>I have 13 contestants. Each gets to guess a number. Goal is to be closest to the randomized number. (Guess a number between x &amp; y. Closest wins \"The Prize\")</p>\n\n<p>Contestants are listed in A9:B21. (i.e; \"Contestant #1\")</p>\n\n<p>Their guesses are listed in C9:C21.</p>\n\n<p>The difference between the randomized number and the guess is listed in D9:D21</p>\n\n<pre><code>D9:D21  =IF(C9&gt;$B$3,C9-$B$3,IF($B$3&gt;C9,$B$3-C9,0))\n</code></pre>\n\n<p>Cells F9:F21 let you know who won and doesn't count any guesses that are less than 1 and more than 100.</p>\n\n<pre><code>F9:F21  =IF(C9&lt;1,,IF(C9&gt;100,,IF(D9=MIN($D$9:$D$21),A9&amp;\" Wins\",)))\n</code></pre>\n\n<p>Unfortunately, every time I try to reference in cell C6 or F6 instead of 1 or 100 I only get the result of 0.</p>\n\n<p>In F8 I have a notification that pops up if there is a tie. Still not sure if this code is the best way to do this.</p>\n\n<pre><code>F8  =IF(COUNTIF(F9:F21,\"*\")&gt;1,\"Tie Breaker Needed\",\"\")\n</code></pre>\n\n<p><strong>Here's my question</strong>. I know how to recognize duplicates and I can highlight them if I want to. I can't seem to find a way to have a single cell tell me exactly who has won even if there is a tie. </p>\n\n<p>I.e; If Contestant #7 Wins --- Cell would say \"Contestant #7 Wins\"\n     If Contestants #7 &amp; #10 win --- Cell should say Contestant #7 &amp; Contestant #10 Tie. </p>\n\n<p>Is there a command or VBA module that could do this for me? I tried the VBA module below that I found but it only returns #NAME? No matter what I do. </p>\n\n<p>Either this code works and I'm not inserting the module correctly or this module doesn't work for my situation and I need something new.</p>\n\n<p>Help me Oh Great Excel Sages of the Online Realm.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P3J89.png\" rel=\"nofollow noreferrer\">Image of My Excel Worksheet</a>\n<a href=\"https://i.stack.imgur.com/NpeUc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NpeUc.png\" alt=\"Here&#39;s my Updated worksheet\"></a></p>\n\n<pre><code>Option Explicit\n\nFunction LookupCSVResults(lookupValue As Integer, lookupRange As Range, resultsRange As Range) As String\n\n    Dim s As String 'Results placeholder\n    Dim sTmp As String  'Cell value placeholder\n    Dim r As Long   'Row\n    Dim c As Long   'Column\n    Const strDelimiter = \"|||\"  'Makes InStr more robust\n\n    s = strDelimiter\n    For r = 1 To lookupRange.Rows.Count\n        For c = 1 To lookupRange.Columns.Count\n            If lookupRange.Cells(r, c).Value = lookupValue Then\n                'I know it's weird to use offset but it works even if the two ranges\n                'are of different sizes and it's the same way that SUMIF works\n                sTmp = resultsRange.Offset(r - 1, c - 1).Cells(1, 1).Value\n                If InStr(1, s, strDelimiter &amp; sTmp &amp; strDelimiter) = 0 Then\n                    s = s &amp; sTmp &amp; strDelimiter\n                End If\n            End If\n        Next\n    Next\n\n    'Now make it look like CSV\n    s = Replace(s, strDelimiter, \",\")\n    If Left(s, 1) = \",\" Then s = Mid(s, 2)\n    If Right(s, 1) = \",\" Then s = Left(s, Len(s) - 1)\n\n    LookupCSVResults = s 'Return the function\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1452088560, "post_id": 34634581, "comment_id": 57014654, "body": "Try changing <code>...Find(newStartDate, ...</code> in second last line to <code>...Find(newStartDate.Value, ...</code>"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1452088647, "post_id": 34634581, "comment_id": 57014716, "body": "@PankajR Still comes up empty, but I think the problem exists in the fact that 1/1/2014 doesn&#39;t exist, but it should then find 1/2/2014 instead.  Don&#39;t think it is the proper code to do that?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452088700, "post_id": 34634581, "comment_id": 57014754, "body": "yes, this is the problem @StormsEdge. Are you dates sorted in order?"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452088722, "post_id": 34634581, "comment_id": 57014775, "body": "@ScottHoltzman Yes sir they are.  And I should add they always will be."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452088999, "post_id": 34634581, "comment_id": 57014968, "body": "Try to change <code>LookIn:=xlValues</code> to <code>LookIn:=xlFormulas</code>"}], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1452089593, "post_id": 34635066, "comment_id": 57015378, "body": "Unfortunately I don&#39;t think I can utilize this method.  The data set I am trying to analyze has nearly 100K rows in it.  To loop through everyone of those looking for a date just froze my excel and I have to do that for each one.  Thank you for the effort though I greatly appreciate it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1452089840, "post_id": 34635066, "comment_id": 57015558, "body": "you aren&#39;t looping through each row... you are checking for the <code>newStartDate</code> in column A and adding a day each time it can&#39;t find it. Presumably, it shouldn&#39;t take too many loops to find the first <i>actual</i> start date. Perhaps there is more about your situation I don&#39;t understand."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1452089938, "post_id": 34635066, "comment_id": 57015622, "body": "Is it possible that because the dates are initialized to ranges rather than dates?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1452090757, "post_id": 34635066, "comment_id": 57016154, "body": "@StormsEdge - I have edited my post. Use <code>.Value</code> instead of <code>.Value2</code>. Apologies. I got them mixed up.  Also <code>Dim masterList as Worksheet</code>. The way you have it now, it&#39;s dimensioned as a Variant Object (not a Worksheet). I just tested it on a sample worksheet and it works."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1452091024, "post_id": 34635066, "comment_id": 57016353, "body": "I will try that in a few moments and let you know.  Thanks for your help as always!  If you don&#39;t mind explaining, what&#39;s the difference between .value and .Value2?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1452091752, "post_id": 34635066, "comment_id": 57016875, "body": "@StormsEdge - See this <a href=\"http://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">SO Post</a> for more on <code>.Value</code> v <code>.Value2</code> While <code>Value2</code> is generally best. In some cases, such as this, you need <code>.Value</code>."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1452090710, "last_edit_date": 1452090710, "creation_date": 1452089076, "answer_id": 34635066, "question_id": 34634581, "link": "https://stackoverflow.com/questions/34634581/error-finding-multiple-date-ranges-in-excel-list/34635066#34635066", "title": "Error Finding multiple date ranges in Excel List", "body": "<p>Yes, the <code>Find</code> function will look for an <em>exact</em> match, if you set the <code>LookAt</code> argument to <code>xlWhole</code>. (Setting it to <code>xlPart</code> would find matches where the search string exists in part of the cell. So, the <code>Find</code> function won't work in the way you suspected here.</p>\n\n<p>I was thinking you could use a <code>VLOOKUP</code> or <code>MATCH</code> function to find the next closest date to <code>newStartDate</code> but after testing, it didn't work the way I thought it would. </p>\n\n<p>However, this loop while work. If I find a more efficient way, I will update the answer.</p>\n\n<pre><code>'Find addresses for dates\nDim i as Integer\ni = 0\n\nDo \n\n    Set newStartDateFinder = masterList.Range(\"A:A\").Find(newStartDate.Value +i, LookIn:=xlValues, LookAt:=xlWhole)\n    i = i + 1\n\nLoop Until Not newStartDateFinder is Nothing\n\nDebug.Print newStartDateFinder.Address\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 34635066, "answer_count": 1, "score": 0, "last_activity_date": 1452090710, "creation_date": 1452087692, "last_edit_date": 1452088046, "question_id": 34634581, "link": "https://stackoverflow.com/questions/34634581/error-finding-multiple-date-ranges-in-excel-list", "title": "Error Finding multiple date ranges in Excel List", "body": "<p>Getting an object variable or with variable not set error.  All i'm trying to do is position myself to be able to analyze data from the newStartDate to the newEndDate and compare it to the data in between oldStartDate and oldEndDate.  Stuck on the finding the addresses of the dates in the \"Master List\"  Unsure why i'm struggling with this it's a simple task, but I can't seem to solve the error.  Any thoughts?  I have read the other posts similar to this and can't seem to figure out what i'm doing differently. Thanks in advance Code below: </p>\n\n<p>Note: 1/1/14 is the date set in the range of newStartDate.  This date does not exist as business was not conducted until the second.  I had found in a post that that the \"Set newStartDateFinder\" line at the bottom would find the next closest date if the exact date was not found..i'm beginning to think that's not the case since when I attempt to run the debugger it appears to be empty.</p>\n\n<pre><code>Option Explicit\nSub Gather_Calculate_Performance()\n\n'Variable declaration\nDim EBM As Workbook\nDim masterList, controlOut As Worksheet\nDim newStartDate As Range\nDim newEndDate As Range\nDim oldStartDate As Range\nDim oldEndDate As Range\nDim newStartDateFinder As Range\nDim newEndDateFinder As Range\nDim oldStartDateFinder As Range\nDim oldEndDateFinder As Range\n\n'Setting main objects\nSet EBM = Workbooks(\"Monthly Analysis (DEV)\")\nSet masterList = EBM.Sheets(\"Master List\")\nSet controlOut = EBM.Sheets(\"Control.Output\")\n\n'setting main variables\nSet newStartDate = controlOut.Range(\"B\" &amp; 5)\nSet newEndDate = controlOut.Range(\"B\" &amp; 6)\nSet oldStartDate = controlOut.Range(\"D\" &amp; 5)\nSet oldEndDate = controlOut.Range(\"D\" &amp; 6)\n\n'Find addresses for dates\nSet newStartDateFinder = masterList.Range(\"A:A\").Find(newStartDate, LookIn:=xlValues, LookAt:=xlWhole)\nDebug.Print newStartDateFinder.Address\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452087255, "post_id": 34634378, "comment_id": 57013756, "body": "what is the point of being able to see the data on the sheets, but not being able to navigate them? In other words, if you don&#39;t want people to be able to navigate to the sheets but you want the data to be seen... it&#39;s not making sense. Do you want only certain people (like you as the developer) to see the sheets?"}, {"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 2, "creation_date": 1452087592, "post_id": 34634378, "comment_id": 57013970, "body": "go to excel option &gt; Advanced &gt; Display options  and Uncheck &#39;Show sheet tabs&#39;. This will hide the sheet tabs, so visually to a user it will show only main page. Make sure you have navigation link intact. However this will not disable changing sheet by Ctrl + PgDn."}, {"owner": {"reputation": 15, "user_id": 5752389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fe3aed83f1e8a13f245b423bc59e77?s=128&d=identicon&r=PG&f=1", "display_name": "atreides7887", "link": "https://stackoverflow.com/users/5752389/atreides7887"}, "edited": false, "score": 0, "creation_date": 1452088532, "post_id": 34634378, "comment_id": 57014634, "body": "Disabling the sheet tabs is exactly what I was after. Seems like such a simple solution. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 3758099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gE6bK.jpg?s=128&g=1", "display_name": "tc_NYC", "link": "https://stackoverflow.com/users/3758099/tc-nyc"}, "is_accepted": false, "score": 0, "last_activity_date": 1452098608, "creation_date": 1452098608, "answer_id": 34638244, "question_id": 34634378, "link": "https://stackoverflow.com/questions/34634378/excel-disabel-ability-to-manually-change-sheets-but-dont-hide-them/34638244#34638244", "title": "Excel - Disabel ability to manually change sheets (but don&#39;t hide them)", "body": "<p>You can disable the editing of the sheet tab names by turning them off on the excel options as mentioned in the comment above. The downside to this approach is the user won't be able to see what sheet they are on (which I find incredibly frustrating). </p>\n\n<p>The better method in my mind is to set up an event listener for when the user changes the name of the tab. You can then send a pop up box that appears when the user attempts to change the tab name. </p>\n"}], "owner": {"reputation": 15, "user_id": 5752389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fe3aed83f1e8a13f245b423bc59e77?s=128&d=identicon&r=PG&f=1", "display_name": "atreides7887", "link": "https://stackoverflow.com/users/5752389/atreides7887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452098608, "creation_date": 1452087059, "last_edit_date": 1531161705, "question_id": 34634378, "link": "https://stackoverflow.com/questions/34634378/excel-disabel-ability-to-manually-change-sheets-but-dont-hide-them", "title": "Excel - Disabel ability to manually change sheets (but don&#39;t hide them)", "body": "<p>Apologies if this is a really stupid question but I've not been able to find a solution.</p>\n\n<p>I've got a main page on my Excel workbook with a number of filter options and some buttons linked to vba code. When clicking the button it takes you another tab with a load of data filtered appropritately. There is a button there that removes the filters and takes you back.</p>\n\n<p>This all works fine but what I want to do is stop people being able to manually change sheets but clicking on the tabs at the bottom of the screen. So far the only method I've found is hiding them, but this obviously doesn't work as you then can't see that data.</p>\n"}, {"tags": ["vba", "selenium"], "answers": [{"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1452175782, "creation_date": 1452175782, "answer_id": 34657233, "question_id": 34633271, "link": "https://stackoverflow.com/questions/34633271/vba-selenium-find-row-number-by-text/34657233#34657233", "title": "VBA Selenium find row number by text", "body": "<p>To get the cells form the targeted row:</p>\n\n<pre><code>Private Assert As New Assert\n\nSub Script1()\n    Dim driver As New FirefoxDriver\n    driver.Get \"http://www.godmode-trader.de/rohstoffe/gold-preis,133979\"\n    driver.FindElementByLinkText(\"alle B\u00f6rsenpl\u00e4tze anzeigen\").Click\n\n    Set row_forex = driver.FindElementsByXPath(\"//div[@id='instrument_quote_source']//tr[contains(.,'FOREX')]/td\")\n    Debug.Print row_forex(1).Text  ' &gt; FOREX\n    Debug.Print row_forex(2).Text  ' &gt; $/Unze\n    Debug.Print row_forex(3).Text  ' &gt; 1.103,64\n    driver.Quit\nEnd Sub\n</code></pre>\n\n<p>Another solution would be to return all the values and then work with the desired row:</p>\n\n<pre><code>Sub Script2()\n    Dim driver As New FirefoxDriver\n    driver.Get \"http://www.godmode-trader.de/rohstoffe/gold-preis,133979\"\n    driver.FindElementByLinkText(\"alle B\u00f6rsenpl\u00e4tze anzeigen\").Click\n\n    Dim values()\n    values = driver.FindElementByCss(\"#instrument_quote_source table\").AsTable.Data()\n    For r = 1 To UBound(values)\n      If values(r, 1) Like \"FOREX\" Then\n        Debug.Print values(r, 1)  ' &gt; FOREX\n        Debug.Print values(r, 2)  ' &gt; $/Unze\n        Debug.Print values(r, 3)  ' &gt; 1.103,64\n        Exit For\n      End If\n    Next\n    driver.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5748665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2489d8e6ae4dbc4dceb1f8dd88e6db22?s=128&d=identicon&r=PG", "display_name": "INN", "link": "https://stackoverflow.com/users/5748665/inn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452175782, "creation_date": 1452083590, "last_edit_date": 1452087067, "question_id": 34633271, "link": "https://stackoverflow.com/questions/34633271/vba-selenium-find-row-number-by-text", "title": "VBA Selenium find row number by text", "body": "<p>I use the following code to locate the table row containing the text.</p>\n\n<pre><code>TabName = (driver.findElementByXPath(\"//div[@id='instrument_quote_source']/div/div/table/tbody/tr[3]/td[1]/span\").Text)\n</code></pre>\n\n<p>The Result is FOREX.</p>\n\n<p>If I try to detect the row by the name FOREX and it doesn't work. I try this with:</p>\n\n<pre><code>TabName = driver.findElementByXPath(\"//div[@id='instrument_quote_source']/div/div/table/tbody/tr[td[contains(text(),'FOREX')]]/td[1]/span\").Text\n</code></pre>\n\n<p>How can we identify the same place in the table by using only the name. Thanks.\nI  tried already many combinations :(</p>\n\n<p>Here is the macro:</p>\n\n<pre><code>Sub Test()\n  Dim PageTimeoutms As Long\n  Dim ProcessOk As Boolean\n  Dim TabName As String\n\n  PageTimeoutms = 20000\n  driver.Start \"firefox\", \"http://www.godmode-trader.de/rohstoffe/gold-preis,133979\"\n  driver.Timeouts.ImplicitWait = 3000\n  driver.Timeouts.Server = PageTimeoutms\n  ProcessOk = driver.get(\"http://www.godmode-trader.de/rohstoffe/gold-preis,133979\", PageTimeoutms)\n  driver.findElementByLinkText(\"alle B\u00f6rsenpl\u00e4tze anzeigen\", PageTimeoutms).Click\n\n  'TabName = (driver.findElementByXPath(\"//div[@id='instrument_quote_source']/div/div/table/tbody/tr[3]/td[1]/span\").Text)\n  TabName = driver.findElementByXPath(\"//div[@id='instrument_quote_source']/div/div/table/tbody/tr[td[contains(text(),'FOREX')]]/td[1]/span\").Text\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452083770, "post_id": 34633171, "comment_id": 57011451, "body": "You need to format as text, so if typename(bla(0,0))=&quot;String&quot; then activesheet.range(&quot;a1&quot;).numberformat=&quot;@&quot;"}, {"owner": {"reputation": 63, "user_id": 3092940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed89fd965c8e7a56eee17d3e0d58a0b?s=128&d=identicon&r=PG", "display_name": "user142295", "link": "https://stackoverflow.com/users/3092940/user142295"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452085307, "post_id": 34633171, "comment_id": 57012489, "body": "Thanks. I know that is possible, but I consider it is a workaround. Just imagine an array of 1000x1000 with different datatypes. You would need to loop over all of the entries in the sheet and individually use an excel function to set the correct Datatype. That completely eliminates the speed advantage of the dump method. Is this the only way to solve the problem without looping over each and every entry of the array?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1452085967, "post_id": 34633171, "comment_id": 57012958, "body": "Why do you want to pass it as a string?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452086416, "post_id": 34633171, "comment_id": 57013234, "body": "Where is the array populated, can you prefix numeric entries with &#39; on population to make them text?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452086743, "post_id": 34633171, "comment_id": 57013443, "body": "why not just format the entire range after the dump: <code>ActiveSheet.Range(&quot;A1&quot;).Resize(2,2).NumberFormat = &quot;@&quot;</code>"}, {"owner": {"reputation": 63, "user_id": 3092940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed89fd965c8e7a56eee17d3e0d58a0b?s=128&d=identicon&r=PG", "display_name": "user142295", "link": "https://stackoverflow.com/users/3092940/user142295"}, "edited": false, "score": 0, "creation_date": 1452088509, "post_id": 34633171, "comment_id": 57014608, "body": "Thanks for the answers. The array is used in a lot of internal operations. Prepending a &#39; to every string is not an option."}, {"owner": {"reputation": 63, "user_id": 3092940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed89fd965c8e7a56eee17d3e0d58a0b?s=128&d=identicon&r=PG", "display_name": "user142295", "link": "https://stackoverflow.com/users/3092940/user142295"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452088600, "post_id": 34633171, "comment_id": 57014688, "body": "@Scott Holtzman: I used that approach. The values do display ok in Excel after that operation. But excel still considers them as numbers. That means, a comparison operation in excel between a number formatted as string and the string containing the same content will result into &quot;FALSE&quot;. My aim is exactly that excel does that kind of comparison (i.e., the string &quot;123&quot; that is found elsewhere on an excel sheet should be equal to the &quot;123&quot; entry in the array that is copied to the sheet) ."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452089526, "post_id": 34633171, "comment_id": 57015323, "body": "I don&#39;t know what your comparison operation is exactly, but what about forcing the string in the operation ... for example <code>=vlookup(text(A1,&quot;@&quot;),Sheet2!A1:B1000,2,0)</code>"}, {"owner": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "edited": false, "score": 0, "creation_date": 1452090934, "post_id": 34633171, "comment_id": 57016289, "body": "I think you actually need to apply your formatting prior to dumping in your arrays data ie. <code>ActiveSheet.Range(&quot;A1&quot;).Resize(2,2).NumberFormat = &quot;@&quot;</code> followed by <code>Activesheet.Range(&quot;A1&quot;).Resize(2,2).Value = bla</code>. If you set the <code>NumberFormat</code> afterwards Excel does appear to continue to register the existing values as a numeric (with no green triangle in the top left hand corner of the cell to indicate a numeric held as text)."}, {"owner": {"reputation": 63, "user_id": 3092940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed89fd965c8e7a56eee17d3e0d58a0b?s=128&d=identicon&r=PG", "display_name": "user142295", "link": "https://stackoverflow.com/users/3092940/user142295"}, "reply_to_user": {"reputation": 398, "user_id": 4215263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUqKk.png?s=128&g=1", "display_name": "andshrew", "link": "https://stackoverflow.com/users/4215263/andshrew"}, "edited": false, "score": 0, "creation_date": 1452359437, "post_id": 34633171, "comment_id": 57138828, "body": "@andshrew: Your solution was the one that I finally used. If you do not do the Numberformat BEFORE the dumping, you end up with nicely formatted numbers that are not considered strings by excel. Then, the only workaround would be what Scott recommends. But I did not want to do this workaround in all the other parts of my excel sheets, I wanted to have the same datatype (string) in excel as in my variant. All other things would have complicated everything. So I ended up using andshrew&#39;s approach. I actually found out about that before andshrew&#39;s  comment, so this is just for completeleness."}, {"owner": {"reputation": 63, "user_id": 3092940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed89fd965c8e7a56eee17d3e0d58a0b?s=128&d=identicon&r=PG", "display_name": "user142295", "link": "https://stackoverflow.com/users/3092940/user142295"}, "edited": false, "score": 0, "creation_date": 1452359449, "post_id": 34633171, "comment_id": 57138834, "body": "Thanks for all the comments!"}], "owner": {"reputation": 63, "user_id": 3092940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed89fd965c8e7a56eee17d3e0d58a0b?s=128&d=identicon&r=PG", "display_name": "user142295", "link": "https://stackoverflow.com/users/3092940/user142295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452083272, "creation_date": 1452083272, "last_edit_date": 1531164843, "question_id": 34633171, "link": "https://stackoverflow.com/questions/34633171/dumping-an-array-to-a-sheet-changes-the-datatype", "title": "Dumping an array to a sheet changes the datatype", "body": "<p>I have a very simple question.\nIt seems that some automatic Type Conversion is going on when I dump an Array to a sheet.\nEasy example:</p>\n\n<pre><code>Dim bla as variant\nredim bla(0 to 1, 0 to 1)\nbla(0,0) = \"123\"\nActivesheet.Range(\"A1\").Resize(2,2).Value = bla\n</code></pre>\n\n<p>Result:\nThe cell \"A1\" contains a NUMERIC VALUE with the value 123 instead of a string.\nIs this the expected behaviour?\nAre there workarounds that make excel discover that i actually passed a string?\nThe system (i.e., vba) knows that it is a string. EG:</p>\n\n<pre><code>TypeName(bla(0,0))\n</code></pre>\n\n<p>returns \"String\"</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5752150, "user_type": "registered", "profile_image": "https://graph.facebook.com/964126973679895/picture?type=large", "display_name": "Max Wessels", "link": "https://stackoverflow.com/users/5752150/max-wessels"}, "edited": false, "score": 0, "creation_date": 1452084193, "post_id": 34633354, "comment_id": 57011739, "body": "that doesn&#39;t seem to have any effect on my output in excel.. Thanks for the reply though"}, {"owner": {"reputation": 1, "user_id": 5006223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mb0ZU4u7ec8/AAAAAAAAAAI/AAAAAAAABq0/Bci38ibQQaY/photo.jpg?sz=128", "display_name": "Simon Pilepich", "link": "https://stackoverflow.com/users/5006223/simon-pilepich"}, "reply_to_user": {"reputation": 1, "user_id": 5752150, "user_type": "registered", "profile_image": "https://graph.facebook.com/964126973679895/picture?type=large", "display_name": "Max Wessels", "link": "https://stackoverflow.com/users/5752150/max-wessels"}, "edited": false, "score": 0, "creation_date": 1452217376, "post_id": 34633354, "comment_id": 57082163, "body": "just updated the 7 to an 8. are your first 7 characters spaces? I would use a msg box before the split to confirm the character count."}, {"owner": {"reputation": 1, "user_id": 5752150, "user_type": "registered", "profile_image": "https://graph.facebook.com/964126973679895/picture?type=large", "display_name": "Max Wessels", "link": "https://stackoverflow.com/users/5752150/max-wessels"}, "edited": false, "score": 0, "creation_date": 1452333872, "post_id": 34633354, "comment_id": 57130320, "body": "Simon, many thanks for thinking with me on this. However, I decided to use a different software: qlikview. I got a working script in that."}], "tags": [], "owner": {"reputation": 1, "user_id": 5006223, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mb0ZU4u7ec8/AAAAAAAAAAI/AAAAAAAABq0/Bci38ibQQaY/photo.jpg?sz=128", "display_name": "Simon Pilepich", "link": "https://stackoverflow.com/users/5006223/simon-pilepich"}, "is_accepted": false, "score": 0, "last_activity_date": 1452217386, "last_edit_date": 1452217386, "creation_date": 1452083858, "answer_id": 34633354, "question_id": 34633127, "link": "https://stackoverflow.com/questions/34633127/importing-txt-to-excel-whilst-skipping-first-7-characters-and-moving-to-the-next/34633354#34633354", "title": "Importing TXT to excel whilst skipping first 7 characters and moving to the next colomn after each file", "body": "<p>can you use this in your loop?</p>\n\n<pre><code>TextLine = FileText.ReadLine\n\nTrimmedLine = Mid(TextLine, 8)\n\n' Parse the line into | delimited pieces\nItems = Split(TrimmedLine, \"|\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5752150, "user_type": "registered", "profile_image": "https://graph.facebook.com/964126973679895/picture?type=large", "display_name": "Max Wessels", "link": "https://stackoverflow.com/users/5752150/max-wessels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452333766, "creation_date": 1452083141, "last_edit_date": 1452333766, "question_id": 34633127, "link": "https://stackoverflow.com/questions/34633127/importing-txt-to-excel-whilst-skipping-first-7-characters-and-moving-to-the-next", "title": "Importing TXT to excel whilst skipping first 7 characters and moving to the next colomn after each file", "body": "<p>Dear members of Stackoverflow, </p>\n\n<p>My script is still lacking some functionality. It requires two extra functions: \n - Skip the first 7 characters, put the remainder of the line into a cell.\n - After completing a txt move 1 colomn left and go back to row 1</p>\n\n<p>My script is the following:</p>\n\n<p>Sub ReadFilesIntoActiveSheet()\n    Dim fso As FileSystemObject\n    Dim folder As folder\n    Dim file As file\n    Dim FileText As TextStream\n    Dim TextLine As String\n    Dim Items() As String\n    Dim i As Long\n    Dim cl As Range</p>\n\n<pre><code>' Get a FileSystem object\nSet fso = New FileSystemObject\n\n' get the directory you want\nSet folder = fso.GetFolder(\"F:\\Google Drive\\IBE project - Heamoscan\\Data\")\n\n' set the starting point to write the data to\nSet cl = ActiveSheet.Cells(1, 1)\n\n' Loop thru all files in the folder\nFor Each file In folder.Files\n    ' Open the file\n    Set FileText = file.OpenAsTextStream(ForReading)\n\n    ' Read the file one line at a time\n    Do While Not FileText.AtEndOfStream\n        TextLine = FileText.ReadLine\n\n        ' Parse the line into | delimited pieces\n        Items = Split(TextLine, \"|\")\n\n        ' Put data on one row in active sheet\n        For i = 0 To UBound(Items)\n            cl.Offset(0, i).Value = Items(i)\n        Next\n        i = 0\n        ' Move to next row\n        Set cl = cl.Offset(1, 0)\n\n    Loop\n\n    Set cl = cl.Offset(0, 1)\n\n    ' Clean up\n    FileText.Close\nNext file\n\nSet FileText = Nothing\nSet file = Nothing\nSet folder = Nothing\nSet fso = Nothing\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Any suggestions are very welcome!\nMany thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 2, "creation_date": 1452082266, "post_id": 34632569, "comment_id": 57010564, "body": "I think you just neet to replace this line <code>Sheets.Add.Name = MyNewSheet.Value</code> with this <code>ActiveSheet.name =MyNewSheet.Value</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452082350, "post_id": 34632569, "comment_id": 57010621, "body": "Not sure, but dim ws as excel.worksheet:set ws=masterSheet.Copy ThisWorkbook.Sheets(Sheets.Count):ws.name=mynewsheet.value"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452083563, "post_id": 34632569, "comment_id": 57011327, "body": "@DanBeard, You are welcome, I post this as answer"}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1452083523, "creation_date": 1452083523, "answer_id": 34633252, "question_id": 34632569, "link": "https://stackoverflow.com/questions/34632569/dynamically-copy-a-worksheet-multiple-times-and-rename-using-vba-in-excel/34633252#34633252", "title": "Dynamically copy a worksheet multiple times and rename using VBA in Excel", "body": "<p>So we just need to replace this line:</p>\n\n<pre><code>Sheets.Add.Name = MyNewSheet.Value\n</code></pre>\n\n<p>with this line:</p>\n\n<pre><code>ActiveSheet.Name = MyNewSheet.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1452083580, "creation_date": 1452083580, "answer_id": 34633266, "question_id": 34632569, "link": "https://stackoverflow.com/questions/34632569/dynamically-copy-a-worksheet-multiple-times-and-rename-using-vba-in-excel/34633266#34633266", "title": "Dynamically copy a worksheet multiple times and rename using VBA in Excel", "body": "<p>Loop through the list and copy the sheet if the sheet does not already exist.</p>\n\n<pre><code>Sub CopyMaster()\n    Dim ws As Worksheet, sh As Worksheet\n    Dim Rws As Long, rng As Range, c As Range\n    Set sh = Sheets(\"Overview\")\n    Set ws = Sheets(\"Master\")\n\n    With sh\n        Rws = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        Set rng = .Range(.Cells(1, 1), .Cells(Rws, 1))\n    End With\n    For Each c In rng.Cells\n        If WorksheetExists(c.Value) Then\n            MsgBox \"Sheet \" &amp; c &amp; \" exists\"\n        Else:\n            ws.Copy After:=Worksheets(Worksheets.Count)\n            Worksheets(Worksheets.Count).Name = c.Value\n\n        End If\n    Next c\nEnd Sub\nFunction WorksheetExists(WSName As String) As Boolean\n    On Error Resume Next\n    WorksheetExists = Worksheets(WSName).Name = WSName\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 3128020, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e989415860e36ed95d0499e568817736?s=128&d=identicon&r=PG&f=1", "display_name": "Dannyboy", "link": "https://stackoverflow.com/users/3128020/dannyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6873, "favorite_count": 0, "accepted_answer_id": 34633252, "answer_count": 2, "score": 1, "last_activity_date": 1537945094, "creation_date": 1452081408, "question_id": 34632569, "link": "https://stackoverflow.com/questions/34632569/dynamically-copy-a-worksheet-multiple-times-and-rename-using-vba-in-excel", "title": "Dynamically copy a worksheet multiple times and rename using VBA in Excel", "body": "<p>I am trying to dynamically generate a custom number of worksheets based on a template that we use regularly in excel using VBA. </p>\n\n<p>I have created an \"Overview\" page where we can input a range which will be used to name the new worksheets but then would like to use a hidden \"Master\" worksheet to generate the content of these new worksheets.</p>\n\n<p>My code below currently generates the correct number of pages based on the range AND copies our master template page but does not combine the two and leaves them in separate pages.</p>\n\n<pre><code>Sub test()\nDim MyNames As Range, MyNewSheet As Range\n\nSet masterSheet = ThisWorkbook.Worksheets(\"Master\")\nSet MyNames = Range(\"A1:A6\").CurrentRegion  ' load range into variable\n\nFor Each MyNewSheet In MyNames.Cells    ' loop through cell range\n    masterSheet.Copy ThisWorkbook.Sheets(Sheets.Count) 'copy master template sheet\n    Sheets.Add.Name = MyNewSheet.Value\nNext MyNewSheet\n\nMyNames.Worksheet.Select    ' move selection to original sheet\nEnd Sub\n</code></pre>\n\n<p>As you can see, the code generates both the named (blank) worksheets AND copies my master worksheet which defaults to naming as \"Master()\".\n<a href=\"https://i.stack.imgur.com/ymSb7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymSb7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "excel-2010", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5481671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1362bde4f5438fbcac4ab5faef8a377?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Shaikh", "link": "https://stackoverflow.com/users/5481671/ali-shaikh"}, "edited": false, "score": 0, "creation_date": 1452079898, "post_id": 34631639, "comment_id": 57009174, "body": "Thanks for your answer this however selects the data but ow can I select the columns? I want to set the column width to autofit for all the columns with data. When I use Range(&quot;A1&quot;).CurrentRegion.Select this selects only the cells and not whole columns"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1452082219, "post_id": 34631639, "comment_id": 57010532, "body": "You should have asked &quot;How to autofit columns with data&quot;!"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1452087177, "last_edit_date": 1452087177, "creation_date": 1452078496, "answer_id": 34631639, "question_id": 34631587, "link": "https://stackoverflow.com/questions/34631587/vba-to-select-columns-with-headers-in-excel-how-to-auto-fit-columns-with-data/34631639#34631639", "title": "VBA to select columns with headers in excel (How to auto-fit columns with data?)", "body": "<p>One easy way is to use something like <code>range(\"A1\").CurrentRegion</code>.<br>\nTo address the columns: <code>range(\"A1\").CurrentRegion.Columns</code>.\nAbout \"selecting\": this is generally useless and just slowing down your code. Never <code>Select</code> unless you have a serious justification for it.</p>\n"}, {"tags": [], "owner": {"reputation": 285, "user_id": 5542029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cM8EM.gif?s=128&g=1", "display_name": "Arazio", "link": "https://stackoverflow.com/users/5542029/arazio"}, "is_accepted": false, "score": 0, "last_activity_date": 1452080014, "creation_date": 1452080014, "answer_id": 34632134, "question_id": 34631587, "link": "https://stackoverflow.com/questions/34631587/vba-to-select-columns-with-headers-in-excel-how-to-auto-fit-columns-with-data/34632134#34632134", "title": "VBA to select columns with headers in excel (How to auto-fit columns with data?)", "body": "<p>Not sure if this could be useful to you, but what if you were to select all the cells that have data in them? Here's a little Macro for you, just edit the ranges to match you criteria</p>\n\n<pre><code>Sub Macro1()\n\nDim LR As Long, cell As Range, rng As Range\nWith Sheets(\"Sheet1\")\n    LR = .Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n    For Each cell In .Range(\"A1:G\" &amp; LR)\n        If cell.Value &lt;&gt; \"\" Then\n            If rng Is Nothing Then\n                Set rng = cell\n            Else\n                Set rng = Union(rng, cell)\n            End If\n        End If\n    Next cell\n    rng.Select\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1452086753, "post_id": 34632831, "comment_id": 57013451, "body": "That answer has nothing to do with the question!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1452082225, "creation_date": 1452082225, "answer_id": 34632831, "question_id": 34631587, "link": "https://stackoverflow.com/questions/34631587/vba-to-select-columns-with-headers-in-excel-how-to-auto-fit-columns-with-data/34632831#34632831", "title": "VBA to select columns with headers in excel (How to auto-fit columns with data?)", "body": "<p>Autofit columns with data</p>\n\n<pre><code>Sub AutoFit()\n    Rows(\"1:1\").SpecialCells(xlCellTypeConstants, 23).Columns.AutoFit\nEnd Sub\n</code></pre>\n\n<p>Or possibly</p>\n\n<pre><code>Sub AutoFitCell()\n  Cells.SpecialCells(xlCellTypeConstants, 23).Columns.AutoFit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5481671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1362bde4f5438fbcac4ab5faef8a377?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Shaikh", "link": "https://stackoverflow.com/users/5481671/ali-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 34632831, "answer_count": 3, "score": 0, "last_activity_date": 1452087177, "creation_date": 1452078346, "last_edit_date": 1531161705, "question_id": 34631587, "link": "https://stackoverflow.com/questions/34631587/vba-to-select-columns-with-headers-in-excel-how-to-auto-fit-columns-with-data", "title": "VBA to select columns with headers in excel (How to auto-fit columns with data?)", "body": "<p>Using VBA how can I select all the columns with headers in Excel? or all the columns which are not blank? Basically select all the columns with data in them.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1452079701, "post_id": 34631530, "comment_id": 57009050, "body": "On the for or the xarray line?"}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1452082192, "post_id": 34631530, "comment_id": 57010518, "body": "The collection object in VBA is pretty limited. In this case it will not be an enumerable collection of CContract objects so For Each will not work. Use a counter instead."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452127079, "post_id": 34631530, "comment_id": 57036660, "body": "Or declare contract as variant."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5751870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711ecd81e78c67c9d9485d8f65d687c4?s=128&d=identicon&r=PG&f=1", "display_name": "user5751870", "link": "https://stackoverflow.com/users/5751870/user5751870"}, "is_accepted": false, "score": 0, "last_activity_date": 1452239101, "creation_date": 1452239101, "answer_id": 34671878, "question_id": 34631530, "link": "https://stackoverflow.com/questions/34631530/why-am-i-getting-an-object-required-error-in-this-vba-code/34671878#34671878", "title": "Why am I getting an object required error in this VBA code", "body": "<p>thank you for your replies, they are appreciated. The problem was that the function that called this sub had the instantiation of the collection in an if statement, so if the condition was not met the collection was not made an instance. When I took it out of the if statement, the code compiled successfully.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 5751870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/711ecd81e78c67c9d9485d8f65d687c4?s=128&d=identicon&r=PG&f=1", "display_name": "user5751870", "link": "https://stackoverflow.com/users/5751870/user5751870"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452239101, "creation_date": 1452078198, "last_edit_date": 1452078494, "question_id": 34631530, "link": "https://stackoverflow.com/questions/34631530/why-am-i-getting-an-object-required-error-in-this-vba-code", "title": "Why am I getting an object required error in this VBA code", "body": "<p>The error seems to occur at the start of the for loop, here is the code</p>\n\n<pre><code>Sub constructContractScurves(contractCollection As Collection)\n\n    Dim xArray() As Variant\n    Dim yArray() As Variant\n    Dim ans As Boolean\n    Dim contract As CContract\n\n    For Each contract In contractCollection\n        xArray = constructXarray(contract.numMonths)\n        yArray = constructYarray(xArray, contract.numMonths)\n        ans = utilityMod.populateSheet(xArray, yArray, \"S-Curve-BW\", 49, 7)\n    Next contract\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5751758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898646d40c5c91fb7c99279828df0bbf?s=128&d=identicon&r=PG&f=1", "display_name": "ShadowPenguin", "link": "https://stackoverflow.com/users/5751758/shadowpenguin"}, "edited": false, "score": 0, "creation_date": 1452077513, "post_id": 34631254, "comment_id": 57007739, "body": "ok this works, but how comes that brackets are allowed in this case, while they cause an error when u have 2 Parameters in so many other cases?"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1452077822, "post_id": 34631254, "comment_id": 57007921, "body": "assignments using function calls require <code>()</code> around the arguments, the called routines must be <code>Function xxx()</code>, procedure calls don&#39;t have <code>()</code> around arguments and the called routine must be a <code>Sub xxx()</code>"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 0, "last_activity_date": 1452077553, "last_edit_date": 1452077553, "creation_date": 1452077385, "answer_id": 34631254, "question_id": 34631152, "link": "https://stackoverflow.com/questions/34631152/vba-function-2-parameter-1-return-not-working/34631254#34631254", "title": "vba function 2 parameter 1 return not working", "body": "<p>Retrieving a value from functions requires parentheses</p>\n\n<pre><code>x = getConst(1, 0)\n</code></pre>\n\n<p>but when you call them as a procedure (without retrieving the return value) then you can forget the paraenthesis:</p>\n\n<pre><code>getConst 1, 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1452077602, "creation_date": 1452077602, "answer_id": 34631325, "question_id": 34631152, "link": "https://stackoverflow.com/questions/34631152/vba-function-2-parameter-1-return-not-working/34631325#34631325", "title": "vba function 2 parameter 1 return not working", "body": "<p>The single problem you have is the missing brackets around the function call in <code>Sub Test()</code> ... i.e.</p>\n\n<pre><code>x = getConst(1, 0)\n</code></pre>\n\n<p>You should rethink the use of Integer variables when in your actual function you multiply by decimals.</p>\n\n<pre><code>Sub test()\nDim x As Integer\n\n    x = getConst(1, 0)\n    MsgBox \"Value \" &amp; x\n\nEnd Sub\n\nFunction getConst(ry As Integer, rx As Integer) As Integer\n' getConst = 3 'actually that one:\n' getConst = 34 * ry * ry - 30 * ry + 8.5 * rx * rx + 7.5 * rx \n' but that should make any difference\n\n    getConst = 34 * ry ^ 2 - 30 * ry + 8.5 * rx ^ 2 + 7.5 * rx\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5751758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898646d40c5c91fb7c99279828df0bbf?s=128&d=identicon&r=PG&f=1", "display_name": "ShadowPenguin", "link": "https://stackoverflow.com/users/5751758/shadowpenguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 34631254, "answer_count": 2, "score": 0, "last_activity_date": 1452077602, "creation_date": 1452077088, "last_edit_date": 1531164843, "question_id": 34631152, "link": "https://stackoverflow.com/questions/34631152/vba-function-2-parameter-1-return-not-working", "title": "vba function 2 parameter 1 return not working", "body": "<p>I want to have a function, where i can insert 2 Integers and it Returns me one Integer as a result</p>\n\n<pre><code>Sub test()\nDim x As Integer\nx = getConst 1, 0 ' here is where i get the error message\nMsgBox \"Vakue\" &amp; x\nEnd Sub\n\nFunction getConst(ry As Integer, rx As Integer) As Integer\ngetConst = 3 'actually that one: getConst = 34 * ry * ry - 30 * ry + 8.5 * rx * rx + 7.5 * rx, but that should make any difference\nEnd Function\n</code></pre>\n\n<p>Im used to Java coding, and it should work somewhat like that, but it says \"Erwartet: Anweisungsende\" so in english ~\"Expectet end of clause\"</p>\n"}, {"tags": ["c++", "arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1880, "user_id": 4281182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teZv4.png?s=128&g=1", "display_name": "Sel&#231;uk Cihan", "link": "https://stackoverflow.com/users/4281182/sel%c3%a7uk-cihan"}, "edited": false, "score": 1, "creation_date": 1452082105, "post_id": 34630875, "comment_id": 57010458, "body": "That is because you are losing the memory pointed to by testArray, by assigning testArray a newly allocated memory address. Since the buffer is given to your function by the caller, you should increase the array size at the caller site and provide the size of that buffer as a second parameter to the arrayTest method."}, {"owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "reply_to_user": {"reputation": 1880, "user_id": 4281182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teZv4.png?s=128&g=1", "display_name": "Sel&#231;uk Cihan", "link": "https://stackoverflow.com/users/4281182/sel%c3%a7uk-cihan"}, "edited": false, "score": 0, "creation_date": 1452082866, "post_id": 34630875, "comment_id": 57010891, "body": "@Sel&#231;ukCihan This makes sense. Thank you."}], "owner": {"reputation": 832, "user_id": 3939193, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fb094ece8706efc178637c692fb93d2?s=128&d=identicon&r=PG&f=1", "display_name": "DrDonut", "link": "https://stackoverflow.com/users/3939193/drdonut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452128231, "creation_date": 1452076261, "last_edit_date": 1531164843, "question_id": 34630875, "link": "https://stackoverflow.com/questions/34630875/change-size-vba-array-in-c", "title": "Change size vba array in C++", "body": "<p>I have a VBA macro in Excel which calls a DLL written in C++. The function in this DLL returns an array to the macro, which is then put into the Excel sheet.</p>\n\n<p>VBA macro:</p>\n\n<pre><code>Private Declare Function arrayTestEXL Lib \"C:\\Path\\To\\Lib\\calcDLL.dll\" (ByRef testArray As Double) As Long\nSub testArrayTest()\nDim testArray(0, 9) As Double\nDim rngResults As Range\nDim errorCode As Integer\n\nerrorCode = arrayTestEXL(testArray(0, 0))\nSet rngResults = Range(Cells(4, 4), Cells(4, 13))\nrngResults.Value = testArray\n\nEnd Sub\n</code></pre>\n\n<p>And the C++ code is:</p>\n\n<pre><code>int _stdcall arrayTest(double* testArray)\n{\n    for (int i = 0; i &lt; 10; i++)\n        testArray[i] = i;\n    return 0;\n}\n</code></pre>\n\n<p>This works. Now I want to change the size of the array from within the C++ function.</p>\n\n<p>If I add:</p>\n\n<pre><code>testArray = (double*) malloc(10 * sizeof(double))\n</code></pre>\n\n<p>To the function (before the loop obviously), then suddenly all the values become 0 as they are put into Excel.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452077652, "post_id": 34630704, "comment_id": 57007815, "body": "Hello, You can remove the Edits and answer your own question and then mark it as the correct answer."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5702884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d16d0bbe30feb11a05a24822a6ed26f7?s=128&d=identicon&r=PG&f=1", "display_name": "SamCramphorn", "link": "https://stackoverflow.com/users/5702884/samcramphorn"}, "edited": false, "score": 0, "creation_date": 1452076988, "post_id": 34630946, "comment_id": 57007410, "body": "Thanks, I did a U turn and it worked out much better:  <code>Private Sub CommandButton1_Click() Dim myData As DataObject Dim Output As String  Output = UCase(InputBox(&quot;Type Text Here&quot;))  If Output = &quot;&quot; Then End Else End If Set myData = New DataObject myData.SetText Output myData.PutInClipboard MsgBox (Output + &quot; text has been copied&quot;) End Sub </code>"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1452076474, "creation_date": 1452076474, "answer_id": 34630946, "question_id": 34630704, "link": "https://stackoverflow.com/questions/34630704/copy-variables-contents-to-clipboard-vba-excel-2013/34630946#34630946", "title": "Copy Variable&#39;s Contents to Clipboard VBA (Excel 2013)", "body": "<p>You would be better declaring Output as an object variable (or, more specifically, as a range).</p>\n\n<p>You can then use the value of the range within the messagebox, whilst also copying the value to the clipboard.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim Output As Range\n    Set Output = Range(\"Output\")\n\n    Output.Copy\n    MsgBox (Output + \" Text has been copied\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 0, "last_activity_date": 1452077539, "last_edit_date": 1452077539, "creation_date": 1452077002, "answer_id": 34631122, "question_id": 34630704, "link": "https://stackoverflow.com/questions/34630704/copy-variables-contents-to-clipboard-vba-excel-2013/34631122#34631122", "title": "Copy Variable&#39;s Contents to Clipboard VBA (Excel 2013)", "body": "<p>I assume you want the <code>Values</code> of a <code>Range</code> which is called \"Output\"</p>\n\n<p>The script below will add join (like the WorkSheetFunction \"Concantenate\") and then display it in the <code>MsgBox</code> and copy it to the ClipBoard.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim Output As Range\n    Dim MyString As String\n    Dim OutputText As DataObject\n\n    Set OutputText = New DataObject\n    Set Output = Range(\"A1:A5\")\n\n    MyString = \"\"\n\n    For Each cell In Output\n\n        MyString = MyString &amp; cell.Value &amp; \" \"\n\n    Next cell\n\n    OutputText.SetText MyString\n    OutputText.PutInClipboard\n\n    MsgBox (MyString + \" Text has been copied\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 5702884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d16d0bbe30feb11a05a24822a6ed26f7?s=128&d=identicon&r=PG&f=1", "display_name": "SamCramphorn", "link": "https://stackoverflow.com/users/5702884/samcramphorn"}, "is_accepted": true, "score": 4, "last_activity_date": 1452082972, "creation_date": 1452082972, "answer_id": 34633069, "question_id": 34630704, "link": "https://stackoverflow.com/questions/34630704/copy-variables-contents-to-clipboard-vba-excel-2013/34633069#34633069", "title": "Copy Variable&#39;s Contents to Clipboard VBA (Excel 2013)", "body": "<p>I did a 180 on it and changed it around,</p>\n\n<p>Solution below:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim myData As DataObject\nDim Output As String\n\nOutput = UCase(InputBox(\"Type Text Here\"))\n\nIf Output = \"\" Then\nEnd\nElse\nEnd If\nSet myData = New DataObject\nmyData.SetText Output\nmyData.PutInClipboard\nMsgBox (Output + \" text has been copied\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5702884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d16d0bbe30feb11a05a24822a6ed26f7?s=128&d=identicon&r=PG&f=1", "display_name": "SamCramphorn", "link": "https://stackoverflow.com/users/5702884/samcramphorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22576, "favorite_count": 0, "accepted_answer_id": 34633069, "answer_count": 3, "score": 2, "last_activity_date": 1452082972, "creation_date": 1452075752, "last_edit_date": 1452082922, "question_id": 34630704, "link": "https://stackoverflow.com/questions/34630704/copy-variables-contents-to-clipboard-vba-excel-2013", "title": "Copy Variable&#39;s Contents to Clipboard VBA (Excel 2013)", "body": "<p>I know this should be a super easy solution but I can't fathom it out. </p>\n\n<p>I'm just making a simple button which copies the values in the range of 'Output' to my clipboard.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Output As String\n    Output = Range(\"Output\")\n    MsgBox (Output + \" Text has been copied\")\nEnd Sub\n</code></pre>\n\n<p>I want Output to copy to my clipboard. </p>\n\n<p>Edit:</p>\n\n<p>Many Thanks\nSam</p>\n"}, {"tags": ["excel", "error-handling", "range", "assign", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452075785, "post_id": 34630245, "comment_id": 57006623, "body": "The first one looks correct, lets see the code"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452087798, "post_id": 34630245, "comment_id": 57014097, "body": "try <code>.Value2</code> instead of <code>.Value</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452101159, "post_id": 34630245, "comment_id": 57023411, "body": "The &quot;Value&quot; of <code>1498.</code> is <code>1498</code> (since there is no decimal portion) - it&#39;s not clear why this is a problem in your calculations ?  If the cells you want to transfer data from are formatted as Text then you&#39;ll need to format the destination cells similarly."}, {"owner": {"reputation": 79, "user_id": 4933413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/314eb9f45216c4b1485225bbbcd96b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/4933413/oliver"}, "edited": false, "score": 0, "creation_date": 1452230472, "post_id": 34630245, "comment_id": 57085608, "body": "Tim Williams, thank you for your response. i wlll try to explain what i want to do: via code i want to open excel file and transfer content of its sheet to newly created sheet in main workbook. The newly opened xls ile is downloaded from some software and i do not want to open it and format. i need 1498. (with point) because there is sheet with table which uses vlookup function to derive some content from new added sheet. and i need calculate sums for two cases separately 1498 and 1498."}], "owner": {"reputation": 79, "user_id": 4933413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/314eb9f45216c4b1485225bbbcd96b6d?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/4933413/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452075567, "creation_date": 1452074346, "last_edit_date": 1531161705, "question_id": 34630245, "link": "https://stackoverflow.com/questions/34630245/vba-range-assignment-error", "title": "vba, range assignment, error", "body": "<p>Due to optimization issue, i want to assign one range in one workbook to the same size range in another workbook without any loop and without any copy paste methods.</p>\n\n<p>I tried to use following statement</p>\n\n<pre><code>ThisWorkbook.Worksheets(newSheetName).Range(\"A1:L1000\").Value = Workbooks(wkbName).Worksheets(1).Range(\"A1:L1000\").Value, \n</code></pre>\n\n<p>but there is problem with it. If cell contains string like \"1498.\", it transforms to 1498 (without point) which brings later some wrong calculations.  In addition, i tried to use</p>\n\n<pre><code>set ThisWorkbook.Worksheets(newSheetName).Range(\"A1:L1000\") = Workbooks(wkbName).Worksheets(1).Range(\"A1:L1000\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ThisWorkbook.Worksheets(newSheetName).Range(\"A1:L1000\").Value = Workbooks(wkbName).Worksheets(1).Range(\"A1:L1000\").text \n</code></pre>\n\n<p>but it does nothing, empty sheet appears.</p>\n\n<p>I would appreciate it if someone could help me out.</p>\n\n<p>People keep saying due to more efficient work loops should be avoided to using range assingment but it turns out in case of my data loops are only option.</p>\n\n<p>Thank you in advance.  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 257, "user_id": 5662362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9bacf16a9f4c5b0d533e798df9b69d58?s=128&d=identicon&r=PG&f=1", "display_name": "Ethun_Hunt", "link": "https://stackoverflow.com/users/5662362/ethun-hunt"}, "is_accepted": true, "score": 0, "last_activity_date": 1452078192, "creation_date": 1452078192, "answer_id": 34631526, "question_id": 34630126, "link": "https://stackoverflow.com/questions/34630126/use-v-lookup-to-the-cell-number/34631526#34631526", "title": "Use V-Lookup to the cell number", "body": "<p>I don't think there is a need of VBA for this task. As the names in \"Sheet1\" has to be updated by looking into the data in \"Sheet2\". Following formula can be used to find the updated names (by looking into data from the \"Sheet2\").</p>\n\n<pre><code>=IFERROR(VLOOKUP(A2,Sheet2!A2:B3,2,FALSE),B2)\n</code></pre>\n\n<p>IFERROR is used so as to retain the names which were not found in \"Sheet2\" data. Have a look at following screenshot for the example.</p>\n\n<p><a href=\"https://i.stack.imgur.com/A57fe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A57fe.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 9666, "user_id": 1419175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PRKSW.jpg?s=128&g=1", "display_name": "Dave Sexton", "link": "https://stackoverflow.com/users/1419175/dave-sexton"}, "is_accepted": false, "score": 0, "last_activity_date": 1452084342, "creation_date": 1452084342, "answer_id": 34633517, "question_id": 34630126, "link": "https://stackoverflow.com/questions/34630126/use-v-lookup-to-the-cell-number/34633517#34633517", "title": "Use V-Lookup to the cell number", "body": "<p>Easiest way is on a third sheet create 3 headings in row A: ID, Name and Source. Copy your data from sheet 1 into the first two columns and fill the third column with the text sheet 1. Do the same for sheet 2 but paste it below your sheet 1 data. You should end up with something like this:</p>\n\n<pre><code>ID  Name   Source\n1   Thomas Sheet 1\n2   Jerry  Sheet 1\n3   Spike  Sheet 2\n1   Tom    Sheet 2\n</code></pre>\n\n<p>Then just create a pivot table from this data with source as the column, name as the row and a count of name for the data. It should look something like this:</p>\n\n<pre><code>Name    Sheet 1  Sheet 2  Total\nThomas  1        0        1\nJerry   1        0        1\nSpike   0        1        1\nTom     0        1        1 \n</code></pre>\n\n<p>You can then sort on the Total column to find the duplicates which will have a total of two.</p>\n\n<p>One other advantage of using this method is that it is quite easy to expand it to compare three or more lists.</p>\n"}], "owner": {"reputation": 43, "user_id": 5144451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8fc3f591785d3adb6db7d9e921d81143?s=128&d=identicon&r=PG&f=1", "display_name": "Colm Donnelly", "link": "https://stackoverflow.com/users/5144451/colm-donnelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 34631526, "answer_count": 2, "score": 0, "last_activity_date": 1452084342, "creation_date": 1452074046, "last_edit_date": 1452077555, "question_id": 34630126, "link": "https://stackoverflow.com/questions/34630126/use-v-lookup-to-the-cell-number", "title": "Use V-Lookup to the cell number", "body": "<p>So I have been given the task of comparing to worksheets in excel and if there is a match replacing the data from one cell with another, for example, I have 2 columns in 2 excel sheets, ID and name, I want to compare the IDs in sheet 1 with the IDs in sheet two and if it finds a match update the name linked with that ID.</p>\n\n<p>Sheet 1</p>\n\n<pre><code>ID     Name\n1      Thomas\n2      Jerry\n</code></pre>\n\n<p>Sheet 2</p>\n\n<pre><code>ID    Name\n3     Spike\n1     Tom\n</code></pre>\n\n<p>So in the example above, I need the code to see that ID 1 is in both sheets and change the name in sheet 1 to match sheet 2, so that it looks like this:</p>\n\n<pre><code>ID    Name\n1     Tom\n2     Jerry\n</code></pre>\n\n<p>I'm trying to use the Vlookup, which has allowed me to find out if it is existing or not, but then I don't know how to change the cell to match the existing one, here is my code so far:</p>\n\n<pre><code>Range(\"C2\").Select\nActiveCell.Formula = _\n    \"=IF(ISNA(VLOOKUP([@[ID]], 'Sheet2'!A:B,1,FALSE)), \"\"New\"\", \"\"Existing\"\")\"\n\nDo While Len(Range(\"A\" &amp; r).Formula) &gt; 0\n\nIf (Range(\"C\" &amp; r).Value = \"Existing\") Then\n   Sheets(\"Sheet2\").Range(\"A\" &amp; r &amp; \":B\" &amp; r).Copy _\n   Destination:=Sheets(\"sheet1\").Range(\"A\" &amp; r &amp; \":B\" &amp; r)\nElse\nEnd If\n</code></pre>\n\n<p>I need to be able to get the cell number from the Vlookup so that I can use it in the if statement to pull in the correct data. There may be a simpler way to do this, if so I am open to changing everything.</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["arrays", "vba", "variables", "naming"], "comments": [{"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1452074544, "post_id": 34630108, "comment_id": 57005869, "body": "No that&#39;s not possible in VBA; it doesn&#39;t have reflection. Actually not sure about reflection either..."}], "answers": [{"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 1, "last_activity_date": 1452086742, "last_edit_date": 1495535275, "creation_date": 1452075025, "answer_id": 34630469, "question_id": 34630108, "link": "https://stackoverflow.com/questions/34630108/vba-naming-of-variables-from-array/34630469#34630469", "title": "VBA - Naming of variables from array", "body": "<p>You might be able to use a <a href=\"https://msdn.microsoft.com/en-us/library/x4k5wbx4%28v=vs.84%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">dictionary</a> to accomplish your purpose. You add key/value pairs to the dictionary. Then you can use the key to get the value.</p>\n\n<p>Set a reference to MS Scripting runtime ('Microsoft Scripting Runtime')</p>\n\n<pre><code>Components = \"AA,BB,CC\"\nValues = \"101,102,103\"\nComponentsArr = Split(Components, \",\")\nValuesArr = Split(Values, \",\")\n\nDim dict As New Scripting.Dictionary\nFor i = LBound(ComponentsArr) To UBound(ComponentsArr)\n    Call dict.Add(ComponentsArr(i), ValuesArr(i))\nNext i\n\nIf dict.Exists(\"AA\") Then\n    Debug.Print dict.Item(\"AA\") 'prints 101\nEnd If\n</code></pre>\n\n<p>See also: <a href=\"https://stackoverflow.com/a/915333/2559297\">https://stackoverflow.com/a/915333/2559297</a></p>\n"}, {"comments": [{"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1452699885, "post_id": 34651857, "comment_id": 57286712, "body": "Sure that works great. I took the first four lines as-is and focused on the dictionary aspect. Focusing on one idea can be an effective teaching tool."}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 1, "last_activity_date": 1453204574, "last_edit_date": 1453204574, "creation_date": 1452159836, "answer_id": 34651857, "question_id": 34630108, "link": "https://stackoverflow.com/questions/34630108/vba-naming-of-variables-from-array/34651857#34651857", "title": "VBA - Naming of variables from array", "body": "<p>It might be easier to do it like the following:</p>\n\n<pre><code>Components = Array(\"AA\", \"BB\", \"CC\")\nValues = Array(\"101\", \"102\", \"103\")\n</code></pre>\n\n<p>Then you wouldn't need ComponentsArr and ValuesArr.</p>\n\n<pre><code>For i = LBound(Components) To UBound(Components)\n    dict.Add(Components(i), Values(i))\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5751547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ba85c897f9c0e1caa5cb9235c33317?s=128&d=identicon&r=PG&f=1", "display_name": "marmou", "link": "https://stackoverflow.com/users/5751547/marmou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1453204574, "creation_date": 1452073987, "question_id": 34630108, "link": "https://stackoverflow.com/questions/34630108/vba-naming-of-variables-from-array", "title": "VBA - Naming of variables from array", "body": "<p>Good Morning.\nIs possible naming of variables with composition of text and another variables ?\nOnly for an example (not functional):</p>\n\n<pre><code>Components = \"AA,BB,CC\"\nValues = \"101,102,103\"\nComponentsArr = Split(Components)\nValuesArr = Split(Values)\nFor i = 1 To UBound(ComponentsArr)\n    Let \"Var\" &amp; ComponentsArr(i) = ValuesArr(i)\nNext i\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1452074536, "post_id": 34630022, "comment_id": 57005862, "body": "The ampersand <code>&amp;</code> is just for string concatenation, it&#39;s not specific to the function of the line continuation marker <code>_</code> but is often used in conjunction with it because it tends to be long strings that are split out onto separate lines."}], "answers": [{"tags": [], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "is_accepted": true, "score": 5, "last_activity_date": 1452074527, "last_edit_date": 1452074527, "creation_date": 1452074153, "answer_id": 34630178, "question_id": 34630022, "link": "https://stackoverflow.com/questions/34630022/difference-between-line-separation-and-in-access-vb/34630178#34630178", "title": "Difference between line separation &quot;&amp; _&quot; and &quot; _&quot; in Access - VB", "body": "<p>VBA (as well as VB6, VBScript and earlier versions of VB.NET) does not support multi-line string literals:</p>\n\n<pre><code>' Doesn't work\nmyString = \"a\nb c\"\n\n' Doesn't work either, because _ does not have a special meaning when\n' inside double quotes.\nmyString = \"a _\nb c\"\n</code></pre>\n\n<p>Thus, you need to split your string into multiple strings. You can concatenate them with the <code>&amp;</code> operator:</p>\n\n<pre><code>myString = \"a \" &amp; \"b c\"       ' yields \"a b c\"\n</code></pre>\n\n<p>And <em>then</em> you can split your line <em>outside</em> the string at any place between two tokens:</p>\n\n<pre><code>myString = \"a \" &amp; _\n           \"b c\"              ' my personal preference\n\n' or\n\nmyString = \"a \" _\n           &amp; \"b c\"\n\n' or\n\nmyString = \"a \" _\n           &amp; _\n           \"b c\"\n\n' or even\n\nmyString _\n    = _\n    \"a \" _\n    &amp; _\n    \"b c\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1452074752, "creation_date": 1452074752, "answer_id": 34630372, "question_id": 34630022, "link": "https://stackoverflow.com/questions/34630022/difference-between-line-separation-and-in-access-vb/34630372#34630372", "title": "Difference between line separation &quot;&amp; _&quot; and &quot; _&quot; in Access - VB", "body": "<p>&amp; = join two strings, _ = line separator</p>\n\n<p>unlike c# or Java, VBA code lines does not end with a maker (;), instead VBA IDE uses each line as one code line.  which forces you to join strings from each line with the &amp; sign.</p>\n\n<p>also be aware of max line continuation is 25 above this number you will get an error (too many line continuation)</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264236.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264236.aspx</a></p>\n"}], "owner": {"reputation": 253, "user_id": 4344039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/acb49c2644939a41a31aed4b05791c0a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4344039/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12718, "favorite_count": 1, "accepted_answer_id": 34630178, "answer_count": 2, "score": 2, "last_activity_date": 1452074752, "creation_date": 1452073727, "question_id": 34630022, "link": "https://stackoverflow.com/questions/34630022/difference-between-line-separation-and-in-access-vb", "title": "Difference between line separation &quot;&amp; _&quot; and &quot; _&quot; in Access - VB", "body": "<p>I can't seem to find anything specific on this.\nI know that in order to split up a piece of code over multiple lines, you simply add <strong>\" _\"</strong> to the end of the line.</p>\n\n<p>However, I've noticed that some of my lines of code only work when I use <strong>\"&amp; _\"</strong>, and the following line includes an extra set of speech marks, where they wouldn't be included if it was on one line, why is this?</p>\n\n<p><strong>Code on one line:</strong></p>\n\n<pre><code>Msg1 = MsgBox(\"Removing an LPA will remove ALL of their details from the database, including their documents - You cannot undo this action. Do you wish to continue?\", vbYesNo, \"WARNING!\")\n</code></pre>\n\n<p><strong>Code line separated that works:</strong></p>\n\n<pre><code>Msg1 = MsgBox(\"Removing an LPA will remove ALL of their details from the database,\" &amp; _\n\"including their documents - You cannot undo this action. Do you wish to\" &amp; _\n\" continue?\", vbYesNo, \"WARNING!\")\n</code></pre>\n\n<p><strong>Code line separated that doesn't work:</strong></p>\n\n<pre><code>Msg1 = MsgBox(\"Removing an LPA will remove ALL of their details from the database, _\nincluding their documents - You cannot undo this action. Do you wish to _\ncontinue?\", vbYesNo, \"WARNING!\")\n</code></pre>\n\n<p>So what is the difference between <strong>\"&amp; _\"</strong> and <strong>\" _\"</strong>?</p>\n\n<p>Can you not continue a string on a new line without closing and opening a new set of speech marks?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1452095452, "post_id": 34629783, "comment_id": 57019514, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34625656/how-to-close-the-word-document-if-it-is-opened-using-excel-vba\">How to close the word document if it is opened using excel vba</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 2, "last_activity_date": 1452074093, "creation_date": 1452074093, "answer_id": 34630150, "question_id": 34629783, "link": "https://stackoverflow.com/questions/34629783/how-to-close-the-manually-opened-word-document-using-excel-vba/34630150#34630150", "title": "How to Close the Manually opened word document using Excel VBA", "body": "<p>Assuming you don't already have a hook on the Word app, something like this should do the trick:</p>\n\n<pre><code>Set wordApp = GetObject(, \"Word.Application\")\n\n    For Each wdDoc In wordApp.Documents\n        If wdDoc.Name = \"close_me.docx\" Then '// rename to your doc\n            wdDoc.Close SaveChange:=False '// change to true if required\n            DoEvents\n            Exit For\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 34630150, "answer_count": 1, "score": 0, "last_activity_date": 1452095286, "creation_date": 1452073078, "last_edit_date": 1452095286, "question_id": 34629783, "link": "https://stackoverflow.com/questions/34629783/how-to-close-the-manually-opened-word-document-using-excel-vba", "title": "How to Close the Manually opened word document using Excel VBA", "body": "<p>Before running the excel vba code, I have opened the Word document manually, is it possible to close that particular Word Document which is opened through Excel VBA</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452076170, "post_id": 34629060, "comment_id": 57006888, "body": "Could you please share your code so that we can test it on our side?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452084159, "post_id": 34629060, "comment_id": 57011712, "body": "Hello Christian, if I understand well you solved your own problem right? If so, please do not forget to accept your own answer when it will be possible. Just for your information, the fact that you see ?? instead of the cyrillic characters in the VBE is because the Editor does not support those characters, hence the replacement you did with the Chr() elements looks necessary and correct to me."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452084317, "post_id": 34629060, "comment_id": 57011826, "body": "P.s. I guess you noticed that in your macro you&#39;re applying the formatting only to <code>Selection</code>, that means you have to run the macro after having previously selected the range you want to apply the change. If you want it to make it automatically, you can always replace your <code>Selection</code> with something like <code>Range(&quot;A1:A10&quot;)</code> (or whatever is your desired range)."}, {"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452247977, "post_id": 34629060, "comment_id": 57093851, "body": "Hello Matteo, thank you for your additional suggestions. Using &quot;Selection&quot; is on purpose here, due to the way I intend to use this macro. For &quot;accepting the answer&quot;: sorry, this may sound stupid: I do not see no button or the like to do this... What am I missing?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452258015, "post_id": 34629060, "comment_id": 57100382, "body": "I don&#39;t know, I can&#39;t see it cause I&#39;m not the person who asked :) But you should see it right below the number of likes and the two upvote/downvote arrows, maybe try to hover the mouse on it and see if it appears (but I think you need to wait 48 hours before being able to accept it)."}, {"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452348830, "post_id": 34629060, "comment_id": 57134941, "body": "Ah! Now I see it. A grey v-shaped tick-mark..."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "edited": false, "score": 0, "creation_date": 1453461039, "post_id": 34629061, "comment_id": 57621939, "body": "On 21/01/2016 I altered the initial solution in order to fix a bug causing the currency symbol appear twice when the value is 0 (represented by hyphen). Documentation on this is now included in the macro code depicted above."}], "tags": [], "owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "is_accepted": true, "score": 0, "last_activity_date": 1453460907, "last_edit_date": 1453460907, "creation_date": 1452070634, "answer_id": 34629061, "question_id": 34629060, "link": "https://stackoverflow.com/questions/34629060/in-excel-set-currency-format-to-currencies-with-exotic-symbols-glyphs/34629061#34629061", "title": "In Excel, set currency format to currencies with exotic symbols (glyphs)", "body": "<p>I found a solution for the problem. </p>\n\n<p>The recorded macro consists of the following line of code: </p>\n\n<pre><code>Selection.NumberFormat = \"_-* #,##0.00 [$??.-402]_-;-* #,##0.00 [$??.-402]_-;_-* \"\"-\"\"?? [$??.-402]_-;_-@_-\"\n</code></pre>\n\n<p>The string between the quotation marks defines the number format. You can look this up also by clicking Home --> Format --> Format Cells --> Custom, to get the current definition displayed.</p>\n\n<p>In this line of code, everywhere where \"\u043b\u0432.\" (for Bulgarian Lev) is expected, Excel's VBA machine put two question marks. That's obviously a bug in the system. But luckily it can be fixed by altering the line by replacing each ?? by \" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \" like this:</p>\n\n<pre><code>  Selection.NumberFormat = \"_-* #,##0.00 [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;-* #,##0.00 [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;_-* \"\"-\"\"\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \" [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;_-@_-\"\n</code></pre>\n\n<p>ChrW(1083) generates the Cyrillic \u043b</p>\n\n<p>ChrW(1074) generates the Cyrillic \u0432</p>\n\n<p>Mind the additional quotation marks that limit the string sections before and after each occurence of \" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \"!!</p>\n\n<p>For identifying other character codes (Decimal notation) for other exotic currencies that are not displayed correctly, look them up in any character code table such as <a href=\"http://www.tamasoft.co.jp/en/general-info/unicode-decimal.html\" rel=\"nofollow\">http://www.tamasoft.co.jp/en/general-info/unicode-decimal.html</a>.</p>\n\n<p>PS: Here is the complete macro, with some annotation:</p>\n\n<pre><code>Sub SetCurrencyLeva()\n\n' Purpose: Set the number format of a range of cells to \"Currency:  Bulgarian Lev\", with correctly displayed Cyrillic letters\n' For using it, mark (select) the range of cells you want to format, then run the macro\n\n' Explanation: in VBA, Cyrillic glyphs cannot be set directly; therefore we generate them using the ChrW() function\n\n' This is what Excel's macro recorder initially produced\n    Selection.NumberFormat = \"_-* #,##0.00 [$??.-402]_-;-* #,##0.00 [$??.-402]_-;_-* \"\"-\"\"?? [$??.-402]_-;_-@_-\"\n     'Left here for documentation. Value will be overwritten by the next line of code\n\n' Adjusted string that makes Cyrillic letters appear correctly, with ChrW(1083) vor Cyrillic l, and ChrW(1074) for Cyrillic v\n\n    Selection.NumberFormat = \"_-* #,##0.00 [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;-* #,##0.00 [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;_-* \"\"-\"\" [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;_-@_-\"\n\n' Note: on 21/01/2016 I slightly changed the string above in order to fix a bug (double currency symbol when value is 0). The previous, faulty string was: \n\n   'Selection.NumberFormat = \"_-* #,##0.00 [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;-* #,##0.00 [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;_-* \"\"-\"\"\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \" [$\" &amp; ChrW(1083) &amp; ChrW(1074) &amp; \".-402]_-;_-@_-\"\n    '(Left here for documentation)\n\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 34629061, "answer_count": 1, "score": 0, "last_activity_date": 1453460907, "creation_date": 1452070634, "last_edit_date": 1452080333, "question_id": 34629060, "link": "https://stackoverflow.com/questions/34629060/in-excel-set-currency-format-to-currencies-with-exotic-symbols-glyphs", "title": "In Excel, set currency format to currencies with exotic symbols (glyphs)", "body": "<p>In Excel (2010) I have a problem to programmatically assign currency formats to cells. </p>\n\n<p>I often need to assign the currency format \"Bulgarian Lev\" (symbol: \u043b\u0432.) to columns in my Excel spreadsheets. Doing this manually (using what Excel's ribbon offers) is unacceptably tedious work, because MS has managed to hide my preferred currencies under tons of Arabic and Asian currencies, and I have not figured out a shortcut how to quickly scroll down to exactly \"Bulgarian Lev\".</p>\n\n<p>Therefore I tried to record a macro for this procedure. With the procedure recorded once, it should then be possible to repeat the assignment on any range of cells in any worksheet by just running the Macro. </p>\n\n<p>However, when using this Macro testwise on a bunch of cells, they happened to look like this: </p>\n\n<p>500,00 ??.</p>\n\n<p>whereas expected was:</p>\n\n<p>500,00 \u043b\u0432.</p>\n\n<p>Obviously, Excel in this case does not cope with the Cyrillic letters. </p>\n\n<p>Any solution available for this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5751266, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dnORIcMvCsg/AAAAAAAAAAI/AAAAAAAAAIE/9eykMafjehE/photo.jpg?sz=128", "display_name": "Murat AZIMOGLU", "link": "https://stackoverflow.com/users/5751266/murat-azimoglu"}, "edited": false, "score": 0, "creation_date": 1452075111, "post_id": 34628769, "comment_id": 57006185, "body": "Thanks for the answer. I&#39;ve tried it with both ways mentioned below but doesn&#39;t worked ;   1 - IN MODULE : Option Explicit  Sub CopyToOtherCell()  Code...  End Sub     Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) CopyToOtherCell End Sub 2 \u2013 IN \u201cThis Workbook\u201d (With Workbook &amp; Beforesave selected above)  Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) Dim LastRow.... Code..... End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5751266, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dnORIcMvCsg/AAAAAAAAAAI/AAAAAAAAAIE/9eykMafjehE/photo.jpg?sz=128", "display_name": "Murat AZIMOGLU", "link": "https://stackoverflow.com/users/5751266/murat-azimoglu"}, "edited": false, "score": 0, "creation_date": 1452073997, "post_id": 34629272, "comment_id": 57005509, "body": "Hello. Thanks for the answer. Yes I&#39;m trying to use it as below ;"}, {"owner": {"reputation": 1, "user_id": 5751266, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dnORIcMvCsg/AAAAAAAAAAI/AAAAAAAAAIE/9eykMafjehE/photo.jpg?sz=128", "display_name": "Murat AZIMOGLU", "link": "https://stackoverflow.com/users/5751266/murat-azimoglu"}, "edited": false, "score": 0, "creation_date": 1452156942, "post_id": 34629272, "comment_id": 57046824, "body": "Thanks a lot for your comment I did it."}], "tags": [], "owner": {"reputation": 634, "user_id": 2478928, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9e1fe8ece423a7c689c4821f4340da94?s=128&d=identicon&r=PG", "display_name": "Bishonen_PL", "link": "https://stackoverflow.com/users/2478928/bishonen-pl"}, "is_accepted": false, "score": 1, "last_activity_date": 1452071383, "creation_date": 1452071383, "answer_id": 34629272, "question_id": 34628769, "link": "https://stackoverflow.com/questions/34628769/how-to-place-excel-vba-code-on-save-event/34629272#34629272", "title": "How to place excel VBA code on save event", "body": "<p>Not sure if I understood your question correctly, but the <strong>BeforeSave</strong> Event fires just before saving the file.</p>\n\n<p>So you would need to put the following in ThisWorkbook module:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As   Boolean)\n\nCopyToOtherCell\n\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5751266, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dnORIcMvCsg/AAAAAAAAAAI/AAAAAAAAAIE/9eykMafjehE/photo.jpg?sz=128", "display_name": "Murat AZIMOGLU", "link": "https://stackoverflow.com/users/5751266/murat-azimoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9594, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452071383, "creation_date": 1452069630, "last_edit_date": 1452070272, "question_id": 34628769, "link": "https://stackoverflow.com/questions/34628769/how-to-place-excel-vba-code-on-save-event", "title": "How to place excel VBA code on save event", "body": "<p>I want to run below VBA code when I save the excel document. I can able to run this code at once but (Not on save) it's not working anymore. Could you please help me how can I run this code on save?</p>\n\n<p>It's in Module : </p>\n\n<pre><code>'Option Explicit\n'\n'Sub CopyToOtherCell()\n'\n'Dim LastRow As Integer, i As Integer, erow As Integer\n'\n'LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n'\n'For i = 2 To LastRow\n'    If Cells(i, 12).Value = Date Then\n'        Range(Cells(i, 1), Cells(i, 12)).Select\n'        Selection.Copy\n'        Workbooks.Open Filename:=\"C:\\Users\\Murat\\Desktop\\Proposal_Admin.xlsx\"\n'        Worksheets(\"sheet1\").Select\n'        erow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n'        ActiveSheet.Cells(erow, 1).Select\n'        ActiveSheet.Paste\n'        ActiveWorkbook.Save\n'        ActiveWorkbook.Close\n'        Application.CutCopyMode = False\n'    End If\n'Next i\n'\n'End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VjCGS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VjCGS.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "variables", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5751134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad3d1b9cc65a06e45ce6787998a5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Onesong", "link": "https://stackoverflow.com/users/5751134/onesong"}, "edited": false, "score": 0, "creation_date": 1452216640, "post_id": 34628970, "comment_id": 57081976, "body": "Thank you so much for your help. This certainly worked. Have a great day."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 11, "user_id": 5751134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad3d1b9cc65a06e45ce6787998a5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Onesong", "link": "https://stackoverflow.com/users/5751134/onesong"}, "edited": false, "score": 0, "creation_date": 1452252336, "post_id": 34628970, "comment_id": 57096642, "body": "Mark it as the answer"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1452070374, "creation_date": 1452070374, "answer_id": 34628970, "question_id": 34628376, "link": "https://stackoverflow.com/questions/34628376/excel-vba-assigning-values-to-variables-with-similar-names-using-for-next-loop/34628970#34628970", "title": "excel vba, assigning values to variables with similar names using for next loop", "body": "<p>This should do it.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    For x = 1 To 30\n        Controls(\"Textbox\" &amp; x).Value = \"Hello \" &amp; x\n    Next x\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452079580, "post_id": 34629984, "comment_id": 57008986, "body": "The textboxes are in a userform, not on the worksheet"}], "tags": [], "owner": {"reputation": 2503, "user_id": 1792540, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/00a116dbd784e6357445f496f6453947?s=128&d=identicon&r=PG", "display_name": "sndyuk", "link": "https://stackoverflow.com/users/1792540/sndyuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1452073626, "creation_date": 1452073626, "answer_id": 34629984, "question_id": 34628376, "link": "https://stackoverflow.com/questions/34628376/excel-vba-assigning-values-to-variables-with-similar-names-using-for-next-loop/34629984#34629984", "title": "excel vba, assigning values to variables with similar names using for next loop", "body": "<p>How about this:</p>\n\n<pre><code>For x = 1 To 30\n  Sheets(1).Shapes(\"textbox \" &amp; x).TextFrame.Characters.Text = \"Hello\"\nNext x\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5751134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad3d1b9cc65a06e45ce6787998a5d75?s=128&d=identicon&r=PG&f=1", "display_name": "Onesong", "link": "https://stackoverflow.com/users/5751134/onesong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452073626, "creation_date": 1452067862, "last_edit_date": 1531164843, "question_id": 34628376, "link": "https://stackoverflow.com/questions/34628376/excel-vba-assigning-values-to-variables-with-similar-names-using-for-next-loop", "title": "excel vba, assigning values to variables with similar names using for next loop", "body": "<p>Brand new to stackoverflow and am also quite new to programming. I am very grateful for this incredible resource. Thank you!<br>\nI have 30 TextBoxes on my Userform. TextBox1 TextBox2......TextBox30. I would like to assign values to all of them quickly using a For Next Loop. Just not too sure how.\nExample:</p>\n\n<pre><code>For X=1 to 30\n   TextBox &amp; X.Value =\"Hello\"\nNext X\n</code></pre>\n\n<p>Thank you in advance for any help.</p>\n"}, {"tags": ["c#", "vba", "interop", "visio", "visio2013"], "answers": [{"tags": [], "owner": {"reputation": 2403, "user_id": 3611781, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/298c319afae81b89ad95f9190126e625?s=128&d=identicon&r=PG&f=1", "display_name": "Dah Sra", "link": "https://stackoverflow.com/users/3611781/dah-sra"}, "is_accepted": true, "score": 0, "last_activity_date": 1453295703, "creation_date": 1453295703, "answer_id": 34901084, "question_id": 34628229, "link": "https://stackoverflow.com/questions/34628229/creating-link-to-sub-process-in-visio-using-c-or-vba/34901084#34901084", "title": "creating link to sub process in visio using c# or vba", "body": "<p>For linking a single page to multiple shape sub-process is done by adding the page name as hyperlink for that shapes , to which we need sub-process to be created.</p>\n\n<pre><code> Visio.Hyperlink vsoHyperlink = ParentShape.AddHyperlink();\n      vsoHyperlink.SubAddress = PageName;\n</code></pre>\n\n<blockquote>\n  <p><strong>ParentShape</strong> - the shape for which the sup-process (or ) composite to be created.</p>\n  \n  <p><strong>PageName</strong>- the name of the page or diagram in visio, which needs to be treated as sup-process (or ) composite </p>\n</blockquote>\n"}], "owner": {"reputation": 2403, "user_id": 3611781, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/298c319afae81b89ad95f9190126e625?s=128&d=identicon&r=PG&f=1", "display_name": "Dah Sra", "link": "https://stackoverflow.com/users/3611781/dah-sra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 1, "accepted_answer_id": 34901084, "answer_count": 1, "score": 0, "last_activity_date": 1453295703, "creation_date": 1452067227, "last_edit_date": 1452067573, "question_id": 34628229, "link": "https://stackoverflow.com/questions/34628229/creating-link-to-sub-process-in-visio-using-c-or-vba", "title": "creating link to sub process in visio using c# or vba", "body": "<p>Hi i am creating visio shapes programatically using c#.\nIn visio am creating composite diagrams ( sub - process ) using the below code.</p>\n\n<pre><code> Visio.Shape    ParentShape = myShape;\n ParentShape.CreateSubProcess();  //it will create a sub diagram for the shape\n</code></pre>\n\n<p>using this am creating  subprocess(composite) diagram for the shape.\nBut now i need to link a sub process diagram to one or more parent shapes.\n In Visio it can be simply done by clicking <strong>Link to SubProcess</strong> option.\nBut i want to acheive it in visio API..Is it possible to acheive it ..??</p>\n\n<p><strong>Question is:</strong></p>\n\n<p>How to assign a page to multiple shapes as sub-process in API .?</p>\n"}, {"tags": ["vba", "excel", "automation"], "comments": [{"owner": {"reputation": 164, "user_id": 5452289, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f814ff3fcfa9d0324e513706ee517ce?s=128&d=identicon&r=PG&f=1", "display_name": "Gazal", "link": "https://stackoverflow.com/users/5452289/gazal"}, "edited": false, "score": 1, "creation_date": 1452079599, "post_id": 34628078, "comment_id": 57008997, "body": "Hello, My problem is solved now. Solution is : copy the csv file data as we copy excel data i.e. same as by take csv file as a workbook.  Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "is_accepted": false, "score": -1, "last_activity_date": 1534542564, "creation_date": 1534542564, "answer_id": 51903274, "question_id": 34628078, "link": "https://stackoverflow.com/questions/34628078/how-to-copy-data-from-csv-file-paste-into-powerpoint-using-vba/51903274#51903274", "title": "How to copy data from csv file &amp; paste into powerpoint using vba", "body": "<p>@Gazal solved this problem by:</p>\n\n<ol>\n<li>Pasting the data into a blank workbook in <code>Excel</code></li>\n<li>Copying it from <code>Excel</code> and pasting it into <code>Powerpoint</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 5452289, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f814ff3fcfa9d0324e513706ee517ce?s=128&d=identicon&r=PG&f=1", "display_name": "Gazal", "link": "https://stackoverflow.com/users/5452289/gazal"}, "is_accepted": true, "score": 0, "last_activity_date": 1564138301, "creation_date": 1564138301, "answer_id": 57218556, "question_id": 34628078, "link": "https://stackoverflow.com/questions/34628078/how-to-copy-data-from-csv-file-paste-into-powerpoint-using-vba/57218556#57218556", "title": "How to copy data from csv file &amp; paste into powerpoint using vba", "body": "<p>Copy the csv file data as we copy excel data \ni.e. Take csv file as a workbook.</p>\n"}], "owner": {"reputation": 164, "user_id": 5452289, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f814ff3fcfa9d0324e513706ee517ce?s=128&d=identicon&r=PG&f=1", "display_name": "Gazal", "link": "https://stackoverflow.com/users/5452289/gazal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "accepted_answer_id": 57218556, "answer_count": 2, "score": 1, "last_activity_date": 1564138301, "creation_date": 1452066680, "question_id": 34628078, "link": "https://stackoverflow.com/questions/34628078/how-to-copy-data-from-csv-file-paste-into-powerpoint-using-vba", "title": "How to copy data from csv file &amp; paste into powerpoint using vba", "body": "<p>I am having problem while copying data from csv file &amp; paste it to power point.\nI am successfully doing it while importing excel into power point but having trouble with csv file.</p>\n\n<p>Any suggestion would be very helpful.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["html", "vba", "internet-explorer"], "owner": {"reputation": 11, "user_id": 5729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92725ee7944f2a7e7bf03a0354b3f2d4?s=128&d=identicon&r=PG&f=1", "display_name": "Naveed Gul", "link": "https://stackoverflow.com/users/5729784/naveed-gul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452065816, "creation_date": 1452064420, "last_edit_date": 1452065816, "question_id": 34627566, "link": "https://stackoverflow.com/questions/34627566/how-to-load-picture-to-server-from-local-drive", "title": "how to load picture to server from local drive", "body": "<p>hi friends i have a problem how to load a picture to server in microsoft access  vba though i have done some coding but that not working  </p>\n\n<pre><code>Private Sub Command0_Click()\nDim IE As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Navigate \"https://visa.mofa.gov.sa/Omra/addOmraVisa\"\nIE.Visible = True\nDo While IE.Busy: DoEvents: Loop\nDo While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\nIE.Document.all(\"ApplicationNumber\").Value = 65371771\nIE.Document.getElementById(\"EmbbasyCode\").Value = \"210\"\nIE.Document.all(\"CommandName\").Click\nIE.getElementsByTagName(\"PersonalPhoto\").src = \"file:///d:\\pic\\AE5902663.jpg\"\n   Do While IE.Busy: DoEvents: Loop\n   Do While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n   End Sub\n\n\n\n  [1]: http://i.stack.imgur.com/90g1n.jpg\n\n\n   &lt;td rowspan=\"5\" class=\"requestphoto\"&gt;\n                        &lt;img id=\"image\" runat=\"server\" width=\"150px\" height=\"150px\" src='/Omra/GetImage?358485787' /&gt;\n                        &lt;div class=\"t-widget t-upload\"&gt;&lt;div class=\"t-button t-upload-button\"&gt;&lt;span&gt;Select...&lt;/span&gt;&lt;input id=\"PersonalPhoto\" name=\"PersonalPhoto\" type=\"file\" /&gt;&lt;/div&gt;&lt;/div&gt;\n                        &lt;br /&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;\n</code></pre>\n\n<p>jQuery(document).ready(function(){\njQuery('#EmbbasyCode').tDropDownList({data:[{\"Text\":\"\",\"Value\":\"\"},{\"Text\":\"Islamabad\",\"Value\":\"210\"},{\"Text\":\"Karachi\",\"Value\":\"231\"}], index:1});\njQuery('#PersonalPhoto').tUpload({multiple:false, showFileList:false, async:{\"saveUrl\":\"/Omra/SaveOmraPersonalPhoto\",\"removeUrl\":\"/Omra/RemovePersonalPhoto\",\"autoUpload\":true}, onSuccess:OnSuccess, onError:OnError, onRemove:OnRemove});\njQuery('#COMING_THROUGH').tDropDownList({data:[{\"Text\":\"By Air\",\"Value\":\"2\"},{\"Text\":\"By Land\",\"Value\":\"1\"},{\"Text\":\"By Sea\",\"Value\":\"3\"},{\"Text\":\"Open\",\"Value\":\"4\"}]});});</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "edited": false, "score": 0, "creation_date": 1452068784, "post_id": 34627266, "comment_id": 57002409, "body": "Selection.PasteSpecial will always paste result to the current selection, but I don&#39;t see any .select  before"}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "reply_to_user": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "edited": false, "score": 0, "creation_date": 1452073086, "post_id": 34627266, "comment_id": 57004914, "body": "Paste Special is to paste a Numeric Value in the destination sheet because the value is obtained through a formula and there will be a Referencing error. And even if I move the Paste Special the output is still not being pasted under the correct header and it&#39;s because we have defined that it need to be pasted in &quot;B&quot; (if you check &quot;erow&quot; &amp; pasting code below) we want the location to be based on the Correct Region which has been selected and it should be random."}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "reply_to_user": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "edited": false, "score": 0, "creation_date": 1452073772, "post_id": 34627266, "comment_id": 57005367, "body": "I&#39;m attaching a screenshot of the main sheet. maybe this will help you. This is how the selection is made = Date &gt; Region (UK &amp; EMEA/APAC) &gt; Tag (Finance/Sales) &gt; Sum the number of Marketing for Region (APAC) - All this happen in different sheet and then it search in this sheet for Region (APAC) &gt; Paste Topic (GHI) &gt; Sum Total (9) &gt; Tag (Marketing)."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452073968, "post_id": 34627266, "comment_id": 57005494, "body": "Is sheet1 and &quot;Raw&quot; sheet the same sheet? Why is <code>erow</code> as string?  ________________________________________________________ Show a pic of the other sheets. Better yet attach a link to a sample workbook. Like with Google Drive. Don&#39;t use a link where somebody has to sign up to open the file."}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "edited": false, "score": 0, "creation_date": 1452140283, "post_id": 34627266, "comment_id": 57040153, "body": "Here is the link for a sample workbook. <a href=\"https://drive.google.com/file/d/0B-yHv8Pmuj12Sk83VENZZ21MZWs/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B-yHv8Pmuj12Sk83VENZZ21MZWs/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "edited": false, "score": 0, "creation_date": 1452140416, "post_id": 34639283, "comment_id": 57040188, "body": "Hi Tim, you can download the file from Google Drive link. This is what I&#39;m trying to achieve = Select Date, Region, Tag and Run the ExtractData2 macro. You&#39;ll see the result in Sheet1. Post this I&#39;m trying to paste this data under the correct Region and with the result in Sheet1. Hope this help."}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "edited": false, "score": 0, "creation_date": 1452495937, "post_id": 34639283, "comment_id": 57177619, "body": "Can someone help on this?"}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "edited": false, "score": 0, "creation_date": 1452504783, "post_id": 34639283, "comment_id": 57181936, "body": "Well I guess I&#39;ve to close the thread as No-one seems to be able to answer the query. Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1452101920, "creation_date": 1452101920, "answer_id": 34639283, "question_id": 34627266, "link": "https://stackoverflow.com/questions/34627266/copying-pasting/34639283#34639283", "title": "Copying &amp; Pasting", "body": "<p>It's difficult to tell from your code exactly what you're doing but something like this should work:</p>\n\n<pre><code>Sub DataPasting()\n\n    Dim RegionColumn 'variant\n    Dim erow As Long\n    Dim shtRaw As Worksheet, shtSaT As Worksheet, shtOne As Worksheet\n\n    Set shtRaw = ThisWorkbook.Sheets(\"Raw\")\n    Set shtSaT = ThisWorkbook.Sheets(\"Stories &amp; Topics\")\n    Set shtOne = ThisWorkbook.Sheets(\"Sheet1\")\n\n    ApplicationUpdating = False\n\n    RegionColumn = Application.Match(shtRaw.Range(\"H1\").Value, _\n                                     shtSaT.Range(\"A1:Z1\"), 0)\n\n    If Not IsError(RegionColumn) Then\n\n        erow = shtSaT.Cells(Rows.Count, \"B\").End(xlUp).Row\n\n        shtSaT.Cells(erow, RegionColumn).Resize(1, 2).Value = shtOne.Range(\"I2:J2\").Value\n\n    End If\n\n    ApplicationUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1452126569, "creation_date": 1452063121, "last_edit_date": 1531161705, "question_id": 34627266, "link": "https://stackoverflow.com/questions/34627266/copying-pasting", "title": "Copying &amp; Pasting", "body": "<p>Objective: I'm trying to copy, find and paste data as per the find (that is Region).</p>\n\n<p>Problem: I'm getting the desired output when I'm defining where to paste the data. But this is not what the macro is suppose to do. It's suppose to look for that Region name and then paste the data under the appropriate title and so on.</p>\n\n<p>Here is what I've written so far:</p>\n\n<pre><code>Sub DataPasting()\n\nApplicationUpdating = False\n\nSheets(\"Sheet1\").Range(\"I2:J2\").Copy        'copy and pasting the data set from Sheet1\nSheets(\"Stories &amp; Topics\").Select\n\n    Dim RegionColumn As Long\n    Dim erow As String\n\n\n    RegionColumn = Application.WorksheetFunction.Match(Sheets(\"Raw\").Range(\"H1\"), Sheets(\"Stories &amp; Topics\").Range(\"A1:Z1\"), False)\n\n    erow = ThisWorkbook.Worksheets(\"Stories &amp; Topics\").Cells(Rows.Count, \"B\").End(xlUp).Row\n\n     ThisWorkbook.Worksheets(\"Stories &amp; Topics\").Paste (ThisWorkbook.Worksheets(\"Stories &amp; Topics\").Range(\"B\" &amp; erow + 1))\n\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n\nApplicationUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p>Note:</p>\n\n<p>Sheet1 = Sheet from where the data is to be copied\nStories &amp; Topics = Destination sheet where the data has to be pasted</p>\n\n<p>I also tried Vlookup and Match but no use.</p>\n\n<p><a href=\"https://i.stack.imgur.com/a7zmu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a7zmu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1452079919, "post_id": 34628818, "comment_id": 57009184, "body": "This does the opposite of what the OP wants, doesn&#39;t it?"}, {"owner": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "reply_to_user": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1452082063, "post_id": 34628818, "comment_id": 57010431, "body": "Right !  Like Axel answer so : For Each cell In ActiveSheet.Range(&quot;A1:Z500&quot;)     cell.Value= Replace(cell.Value, &quot;sht&quot;, ChrW(1097))     cell.Value = Replace(cell.Value, &quot;Sht&quot;, ChrW(1095)) Next"}], "tags": [], "owner": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "is_accepted": false, "score": 0, "last_activity_date": 1452069868, "creation_date": 1452069868, "answer_id": 34628818, "question_id": 34626788, "link": "https://stackoverflow.com/questions/34626788/in-excel-use-range-replace-method-to-substitute-characters-but-do-not-affect/34628818#34628818", "title": "In Excel, use &quot;Range.Replace&quot; method to substitute characters, but do not affect formulae", "body": "<p>You have to look in .Formula properties, default Range result give the .Value (ie result), not value.</p>\n\n<p>I will suggest use a loop like :</p>\n\n<pre><code>For Each cell In ActiveSheet.Range(\"A1:Z500\")\n    cell.Formula = Replace(cell.Formula, \"sht\", ChrW(1097))\n    cell.Formula = Replace(cell.Formula, \"Sht\", ChrW(1095))\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "edited": false, "score": 0, "creation_date": 1452080166, "post_id": 34631727, "comment_id": 57009322, "body": "This looks like exactly the elegant solution I was searching for. &#39;Range.HasFormula&#39; is the element I was not aware of, but felt it should exist. Thanks!"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 6, "last_activity_date": 1452082791, "last_edit_date": 1452082791, "creation_date": 1452078767, "answer_id": 34631727, "question_id": 34626788, "link": "https://stackoverflow.com/questions/34626788/in-excel-use-range-replace-method-to-substitute-characters-but-do-not-affect/34631727#34631727", "title": "In Excel, use &quot;Range.Replace&quot; method to substitute characters, but do not affect formulae", "body": "<p><code>Range.Replace</code> will always search in formulas.</p>\n\n<p>There is a <code>HasFormula</code> property in the <code>Range</code> object. But for using this you must iterate over all cells in the given <code>Range</code>. If this <code>Range</code> is quite big then this will take quite long if you are trying <code>Replace</code> in each of the cells. So I would only trying <code>Replace</code> if the cell is not empty, is not numeric and not has a formula.</p>\n\n<pre><code>Sub test()\n\n Dim oRange As Range\n\n For Each oRange In ActiveSheet.Range(\"A1:Z500\")\n  If Not IsEmpty(oRange) And Not IsNumeric(oRange.Value) And Not oRange.HasFormula Then\n    oRange.Replace What:=\"sht\", Replacement:=ChrW(1097), MatchCase:=True\n    oRange.Replace What:=\"Sht\", Replacement:=ChrW(1065), MatchCase:=True\n  End If\n Next\n\nEnd Sub\n</code></pre>\n\n<p>Oh and you must set <code>MatchCase</code> if the replace shall be case sensitive.</p>\n\n<p><strong>Second approach:</strong></p>\n\n<p>You also could use the <code>VBA</code> <code>Replace</code> instead of  <code>Range.Replace</code> as showed in the other answer. But not with <code>Range.Formula</code> but with <code>Range.Value</code>.</p>\n\n<p>This could be faster.</p>\n\n<pre><code>Sub test2()\n\n Dim oRange As Range\n\n For Each oRange In ActiveSheet.Range(\"A1:Z500\")\n  If Not IsEmpty(oRange) And Not IsNumeric(oRange.Value) And Not oRange.HasFormula Then\n    oRange.Value = Replace(oRange.Value, \"sht\", ChrW(1097), , , vbBinaryCompare)\n    oRange.Value = Replace(oRange.Value, \"Sht\", ChrW(1065), , , vbBinaryCompare)\n  End If\n Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 462, "user_id": 4398133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-blMIco4TG98/AAAAAAAAAAI/AAAAAAAAAMo/em6vtWOWMe0/photo.jpg?sz=128", "display_name": "Christian Geiselmann", "link": "https://stackoverflow.com/users/4398133/christian-geiselmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44122, "favorite_count": 1, "accepted_answer_id": 34631727, "answer_count": 2, "score": 1, "last_activity_date": 1452082791, "creation_date": 1452060904, "last_edit_date": 1452079412, "question_id": 34626788, "link": "https://stackoverflow.com/questions/34626788/in-excel-use-range-replace-method-to-substitute-characters-but-do-not-affect", "title": "In Excel, use &quot;Range.Replace&quot; method to substitute characters, but do not affect formulae", "body": "<p>I want to create a macro for Excel (2010) to substitute characters of the Latin alphabet with their equivalents from the Cyrillic alphabet. </p>\n\n<p>At first glance, this seems to be quite easy, e.g. like this:</p>\n\n<pre><code>ActiveSheet.Range(\"A1:Z500\").Replace \"sht\", ChrW(1097) '--&gt; \u0449\nActiveSheet.Range(\"A1:Z500\").Replace \"Sht\", ChrW(1095) '--&gt; \u0429\n'And so on for all relevant characters and character combinations\n</code></pre>\n\n<p>However, when I run this on my active worksheet, not only the cell values are affected but also formulae. Which makes them worthless, because e.g. Sum(B1:B3) will become \u0421\u0443\u043c(\u04111:\u04113) [i.e. using Cyrillic letters] which, for Excel, is gibberish. </p>\n\n<p>Therefore the question: is there a way to tell Excel to use the Replace method only on cell values, not on formulae?</p>\n\n<p>Note: a dirty workaround could be to include a procedure that on each cell in the range first checks if it starts with an \"=\", and if so, leave the cell contents unchanged. But perhaps there is a better, less home-brewed way?</p>\n"}, {"tags": ["ajax", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530552164, "creation_date": 1530552164, "answer_id": 51140991, "question_id": 34626455, "link": "https://stackoverflow.com/questions/34626455/excel-vba-to-deal-with-ajax/51140991#51140991", "title": "Excel VBA to Deal With AJAX", "body": "<p>You haven't shown how you are getting the html.</p>\n\n<p>You can use a CSS selector.</p>\n\n<p>General for first input button</p>\n\n<pre><code>input[type=button]\n</code></pre>\n\n<p>This says element(s) with <code>input</code> tag having attribute <code>type</code> whole value is <code>'button'</code></p>\n\n<p>You apply with the querySelector method, or querySelectorAll if more than one match and then use index for required element.</p>\n\n<pre><code>ie.document.querySelector(\"input[type=button]\").Click\n</code></pre>\n\n<p>If in an HTMLDocument variable e.g. <code>htmlDoc</code> then</p>\n\n<pre><code>htmlDoc.querySelector(\"input[type=button]\").Click\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5389196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7c2e389cd15daa27eaba9424d85551?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt01", "link": "https://stackoverflow.com/users/5389196/hunt01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1530552164, "creation_date": 1452059274, "last_edit_date": 1531164843, "question_id": 34626455, "link": "https://stackoverflow.com/questions/34626455/excel-vba-to-deal-with-ajax", "title": "Excel VBA to Deal With AJAX", "body": "<p>I am practicing to use excel vba to download information from website: <a href=\"http://mops.twse.com.tw/mops/web/t05sr01_1\" rel=\"nofollow\">http://mops.twse.com.tw/mops/web/t05sr01_1</a></p>\n\n<p>But I have no idea how to download the data behind click button, as the image shown: <a href=\"http://i.stack.imgur.com/KZHiZ.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/KZHiZ.jpg</a></p>\n\n<p>I excerpt its web code as below. Could anyone explain me how to code in excel vba to get its data?</p>\n\n<p>Thank you very mush.</p>\n\n<p>Web code:</p>\n\n<pre><code>&lt;td style='text-align:left !important;' nowrap&gt;\u9d3b\u6d77&lt;/td&gt;\n&lt;td style='text-align:left !important;'&gt;105/01/05&lt;/td&gt;\n&lt;td style='text-align:left !important;'&gt;11:41:00&lt;/td&gt;\n&lt;td style='text-align:left !important;'&gt;\u8aaa\u660e\u5a92\u9ad4\u5831\u5c0e&lt;/td&gt;\n&lt;td&gt;&lt;input type='button' value='\u8a73\u7d30\u8cc7\u6599' onclick=\"document.fm_t05sr01_1.SEQ_NO.value='1';document.fm_t05sr01_1.SPOKE_TIME.value='114100';document.fm_t05sr01_1.SPOKE_DATE.value='20160105';document.fm_t05sr01_1.COMPANY_NAME.value='?E??';document.fm_t05sr01_1.COMPANY_ID.value='2317';document.fm_t05sr01_1.skey.value='2317201601051';document.fm_t05sr01_1.hhc_co_name.value='?E??';ajax1(this.form,'table01');\"&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "module"], "comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452060947, "post_id": 34626284, "comment_id": 56999115, "body": "Welcome to StackOverflow. For information: The answers to your questions are easily found by using a Google search. Generally here its more of a &quot;Help me find out where my code is not working&quot; and not a &quot;give me a code for&quot;. Having said that I still answered your question to the best of my ability. maybe post another question or edit your question to include some code from your current Macro and give an explanation where you not sure what to do, this way people can comment or assist."}, {"owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452063246, "post_id": 34626284, "comment_id": 57000019, "body": "For sure. Sorry I found the website today and got all excited and started spamming questions. Thank you for spending some time to help me out! :)"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452063332, "post_id": 34626284, "comment_id": 57000054, "body": "No problem, its all about learning friend. Just remember to upvote and tick the answer you found to your question. Enjoy the site!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "edited": false, "score": 0, "creation_date": 1452063161, "post_id": 34626726, "comment_id": 56999980, "body": "Thanks a ton for your in depth explanation!"}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": -1, "last_activity_date": 1452061200, "last_edit_date": 1452061200, "creation_date": 1452060651, "answer_id": 34626726, "question_id": 34626284, "link": "https://stackoverflow.com/questions/34626284/vba-basic-commands-syntax/34626726#34626726", "title": "VBA basic commands/ syntax", "body": "<p>There are a few <code>Loop</code> statements:</p>\n\n<hr>\n\n<pre><code>a = 10\nc = 1\nDo While c &lt; a\n  'somescript\n  c = c + 1\nLoop\n</code></pre>\n\n<hr>\n\n<pre><code>a = 10\nc = 1\nWhile c &lt; a\n  'some script\n  c = c + 1\nWend\n</code></pre>\n\n<hr>\n\n<pre><code>c = 1     \nDo Until c = 10\n  'some script\n  c = c + 1\nLoop\n</code></pre>\n\n<hr>\n\n<pre><code>For Each Paragraph In ThisDocument.Paragraphs\n        'some script\nNext Paragraph\n</code></pre>\n\n<hr>\n\n<pre><code>For i = 0 To 100\n    'some script\nNext i\n</code></pre>\n\n<hr>\n\n<p>A description can be found <a href=\"http://www.excelfunctions.net/VBA-Loops.html\" rel=\"nofollow\">here</a>. and it will depend on your application as to what loop you want to use.</p>\n\n<p>To execute a Marco from a cell you would use the a Sub in the Microsoft Excel Objects - Sheet in your Project and then use one of the following:</p>\n\n<pre><code>Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n\n<p>To use the data from an adjacent cell you would use <code>Offset</code>, example below:</p>\n\n<pre><code>Sub SomeSub()\n\n    Dim rng As Range\n    Dim rng2 As Range\n    'cell B3 is set to the rng\n    Set rng = Cells(2, 3)\n    'cell B4 is set to the rng2\n    Set rng2 = rng.Offset(0, 1)\n    'cell B4 will be activated\n    rng2.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 34626726, "answer_count": 1, "score": -2, "last_activity_date": 1452061200, "creation_date": 1452058444, "question_id": 34626284, "link": "https://stackoverflow.com/questions/34626284/vba-basic-commands-syntax", "title": "VBA basic commands/ syntax", "body": "<p>I am currently trying to write a program which can facilitate the transfer of specific information from one Excel workbook to another.</p>\n\n<p>Currently I am only able to transfer information from a single preselected (hard coded into the module) cell to another workbook.</p>\n\n<p>I have a couple of questions regarding the VBA commands which will help me code this more efficiently.</p>\n\n<p>Firstly, what are the types of loops in VBA and can someone quickly go over how they are used?</p>\n\n<p>Secondly, is there a way for the module for work off of a cell the USER manually selects with the mouse? As in the user manually clicks a cell on the screen and the program runs based off of the location of that cell?</p>\n\n<p>Lastly, what is the function which would let me select adjacent cells from the currently selected position?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1452063928, "post_id": 34626126, "comment_id": 57000273, "body": "Zorder is a method of a Shape or ShapeRange object.  Try <code>ws.Shapes(&quot;toeBox&quot;).ZOrder msoBringToFront</code>"}, {"owner": {"reputation": 123, "user_id": 5266309, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/RHteE.png?s=128&g=1", "display_name": "Dan W", "link": "https://stackoverflow.com/users/5266309/dan-w"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452130784, "post_id": 34626126, "comment_id": 57037699, "body": "@Tim Thanks heaps! That was too easy! I didn&#39;t even think to reference it as a shape. I really appreciate that help :)"}], "owner": {"reputation": 123, "user_id": 5266309, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/RHteE.png?s=128&g=1", "display_name": "Dan W", "link": "https://stackoverflow.com/users/5266309/dan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452059531, "creation_date": 1452057584, "last_edit_date": 1531164843, "question_id": 34626126, "link": "https://stackoverflow.com/questions/34626126/1004-zorder-method-of-oleobject-class-failed-change-oleobjects-zorder", "title": "&#39;1004&#39;: ZOrder method of OLEObject class failed - Change OLEObjects zOrder", "body": "<p>Just want to know if I can change the ZOrder of an OLEObject in excel VBA I have tried the following lines of code </p>\n\n<pre><code>Set ws = ActiveSheet\n...\nws.OLEObjects(\"toeBox\").ZOrder msoBringToFront\n</code></pre>\n\n<p>and I get the following error message:</p>\n\n<p><em>Run-Time error '1004': ZOrder method of OLEObject class failed</em></p>\n\n<p>Any help would be great!</p>\n\n<p>Thanks</p>\n\n<p>Dan</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1452059215, "post_id": 34625879, "comment_id": 56998457, "body": "Take a look at this question <a href=\"http://stackoverflow.com/questions/7747877/asynchronous-file-downloads-from-within-vba-excel\" title=\"asynchronous file downloads from within vba excel\">stackoverflow.com/questions/7747877/&hellip;</a>."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452059561, "post_id": 34625879, "comment_id": 56998598, "body": "I don&#39;t know how that applies here as I don&#39;t have any knowledge of excel VBA. What I am asking that is there any way I can still working with word while VBA is running?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1452059681, "post_id": 34625879, "comment_id": 56998651, "body": "FWIW, you could certainly work in a different INSTANCE of the Word application. But a different window does not mean a different instance. Word is pseudoSDI meaning it opens multiple windows within the same application instance. The question is, whether you want to start a new instance as part of your code, as a different macro, as an icon..."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452059682, "post_id": 34625879, "comment_id": 56998653, "body": "You have to use asynchronous operation, that question provide you with the how to download a file from internet asynchronously."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452059930, "post_id": 34625879, "comment_id": 56998741, "body": "@CindyMeister: I want above vba to run in one window and continue working in another window."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452059953, "post_id": 34625879, "comment_id": 56998749, "body": "@Jules: I will try that method and get back."}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 775, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452060286, "creation_date": 1452056117, "last_edit_date": 1452060286, "question_id": 34625879, "link": "https://stackoverflow.com/questions/34625879/can-we-continue-doing-work-while-macro-is-running-on-another-ms-word-instance", "title": "Can we continue doing work while macro is running on another MS-WORD instance?", "body": "<p>Is it possible to run another microsoft word instance while macros is running in any of document?\nCurrently I am not able to run what I am asking for.</p>\n\n<p>My code overview is below.</p>\n\n<pre><code>With ActiveDocument.Range\nIf .Hyperlinks.Count &gt; 0 Then\nURL = .Hyperlinks(1).Address\nWith IE\n    .Visible = False\n    .navigate URL\nDo Until .readyState = 4: DoEvents: Loop\nIE.ExecWB 17, 0 '// SelectAll\nIE.ExecWB 12, 2 '// Copy selection\nEnd With\nsome paste and formate\n</code></pre>\n\n<p>The problem with above code is as it does .readyState = 4, I am not able to do any work. Is there any solution to my problem?</p>\n\n<p><strong>Edit</strong>\nAfter having some knowledge from comments, I would like to add.</p>\n\n<p>I have saved VBA in word module. Can I run that macro asynchronously from anywhere else by opening specific document, and still continue working on other document of word.\nI tried that from excel but still I was not able to open any other word instance.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452059189, "post_id": 34625412, "comment_id": 56998447, "body": "Try On Error Resume Next instead which will suppress the error. GoTo label doesn&#39;t suppress the error, it just jumps execution after it occurs and you&#39;re not actually handling it. I really don&#39;t like recommending Resume Next because it gets misused. The &quot;correct&quot; way would be to loop the Variables collection to determine whether it still exists but that is, of course, more work."}, {"owner": {"reputation": 159, "user_id": 5584590, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d078ac7989871b5fd3923091b7b2021c?s=128&d=identicon&r=PG&f=1", "display_name": "codiplex", "link": "https://stackoverflow.com/users/5584590/codiplex"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452059730, "post_id": 34625412, "comment_id": 56998672, "body": "I already tried that but I still get the error."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452059802, "post_id": 34625412, "comment_id": 56998690, "body": "Then please provide a complete code snippet so that we can see the entire scenario."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "is_accepted": false, "score": 1, "last_activity_date": 1452074084, "creation_date": 1452074084, "answer_id": 34630144, "question_id": 34625412, "link": "https://stackoverflow.com/questions/34625412/vba-run-time-error-5825-object-has-been-deleted/34630144#34630144", "title": "VBA: Run-time error &#39;5825&#39; Object has been deleted", "body": "<p>You should be able to avoid this if you are not interested in whether the Variable existed or not.</p>\n\n<pre><code>ActiveDocument.Variables(\"time1\") = \"\"\n</code></pre>\n\n<p>should remove a Variable called \"time\" if there is one, and execute without errors if there is not.</p>\n\n<p>In a similar way,</p>\n\n<pre><code>ActiveDocument.Variables(\"time1\") = \"something\"\n</code></pre>\n\n<p>will create the Variable if it does not exist.</p>\n\n<p>This is one of the things that makes Variables slightly easier to work with than Custom Document Properties, although it does mean that empty variables are not allowed.</p>\n"}], "owner": {"reputation": 159, "user_id": 5584590, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d078ac7989871b5fd3923091b7b2021c?s=128&d=identicon&r=PG&f=1", "display_name": "codiplex", "link": "https://stackoverflow.com/users/5584590/codiplex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3834, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452074084, "creation_date": 1452052840, "question_id": 34625412, "link": "https://stackoverflow.com/questions/34625412/vba-run-time-error-5825-object-has-been-deleted", "title": "VBA: Run-time error &#39;5825&#39; Object has been deleted", "body": "<p>I was putting this code <code>ActiveDocument.Variables(\"time1\").Delete</code> before <code>End Sub</code> and I get that error \"Object has been deleted\" so that if a variable \"time1\" exist, it will be deleted at the end of the procedure. I understand why I get that code because \"time1\" has already deleted on the first run but I want to skip and end the sub if it encounter errors. I tried to do this</p>\n\n<pre><code>On Error Goto here\nActiveDocument.Variables(\"time1\").Delete\n\nhere:\nEnd sub\n</code></pre>\n\n<p>but I still get that Error. Why is it that the error handler did not work?</p>\n"}, {"tags": ["vba", "excel", "module"], "comments": [{"owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "edited": false, "score": 0, "creation_date": 1452057710, "post_id": 34625110, "comment_id": 56997957, "body": "Sorry Jeeped, I actually modified a bit of your code and MY code did not work."}, {"owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "edited": false, "score": 0, "creation_date": 1452057723, "post_id": 34625110, "comment_id": 56997962, "body": "Your&#39;s by itself worked perfectly fine"}, {"owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "edited": false, "score": 0, "creation_date": 1452058052, "post_id": 34625110, "comment_id": 56998071, "body": "Hi Jeeped, sorry I&#39;m new to this forum and I&#39;m unsure how to personally message you for questions. Is it possible for you to go over quickly how for loops work in VBA? Also, is there a function that can select the right cell adjacent to the currently selected cell? Lastly, is there a way to run the program in which I have posted by having the USER select the cell in which the information is to be extracted from?"}, {"owner": {"reputation": 323, "user_id": 1367849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/CMoLn.gif?s=128&g=1", "display_name": "AirUp", "link": "https://stackoverflow.com/users/1367849/airup"}, "edited": false, "score": 0, "creation_date": 1452058424, "post_id": 34625110, "comment_id": 56998191, "body": "Hi, this worked for me like a charm. Some checking might be needed. Take it as a help to google around these class and function names   <code>Const source As String = &quot;\\\\...some...path...to...server...file.xlsm&quot;  Set ext_wb = Workbooks.Open(source)  ThisWorkbook.Sheets(&quot;SOURCESHEET&quot;).Range(&quot;D1:H1&quot;).Copy                   ext_wb.Sheets(&quot;TARGETSHEET&quot;).Range(&quot;D1:H1&quot;).PasteSpecial Paste:=xlPasteValues</code>"}, {"owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "reply_to_user": {"reputation": 323, "user_id": 1367849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/CMoLn.gif?s=128&g=1", "display_name": "AirUp", "link": "https://stackoverflow.com/users/1367849/airup"}, "edited": false, "score": 0, "creation_date": 1452058509, "post_id": 34625110, "comment_id": 56998223, "body": "Thanks a bunch Curzon!"}], "owner": {"reputation": 33, "user_id": 5750400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69dae94433b4722da9d6db4b3a63d4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Will Cheng", "link": "https://stackoverflow.com/users/5750400/will-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452052027, "creation_date": 1452050657, "last_edit_date": 1452050749, "question_id": 34625110, "link": "https://stackoverflow.com/questions/34625110/copying-and-pasting", "title": "Copying and Pasting", "body": "<p>I very recently got into VBA coding, however, even though the code compiles without any hiccups, it still fails to do it's intended purpose.\nEssentially, this is merely a test program created to copy and paste information from one workbook to another in a specific cell.</p>\n\n<pre><code>Sub CopyOpenItems()\n\n   ' CopyOpenItems Macro  \n   ' Copy open items to sheet.  \n   ' Keyboard Shortcut: Ctrl+Shift+O  \n   '  \n   Dim wbTarget As Workbook 'workbook where the data is to be pasted  \n   Dim wbThis As Workbook 'workbook from where the data is to copied  \n   Dim wsTarget As Worksheet  \n   Dim wsThis As Worksheet  \n   Dim strName As String   'name of the source sheet/ target workbook  \n\n   'set to the current active workbook (the source book)  \n   Set wbThis = ActiveWorkbook  \n\n   'get the active sheetname of the book \n   strName = ActiveSheet.Name  \n\n   'open target workbook  \n   Set wbTarget = Workbooks.Open(\"C:\\Users\\Administrator\\Desktop\\Excel Testing\\Excel Info Testing 2.xlsx\")  \n\n   'set variable to current worksheet  \n   Set wsThis = ActiveSheet  \n\n   'set variable to target worksheet \n   Set wsTarget = wbTarget.Worksheets(strName)  \n\n   wsThis.Range(\"C6\").Select  \n\n   'clear any thing on clipboard to maximize available memory \n   Application.CutCopyMode = False  \n\n   'copy the range from source book  \n   wsThis.Range(\"C6\").Copy  \n\n   'paste the data on the target book  \n   wsTarget.Range(\"E5\").PasteSpecial  \n\n   'clear any thing on clipboard to maximize available memory  \n   Application.CutCopyMode = False  \n\n   'save the target book  \n   wbTarget.Save  \n\n   'close the workbook  \n   wbTarget.Close  \n\n   'clear memory  \n   Set wbTarget = Nothing  \n   Set wbThis = Nothing  \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "scheduled-tasks", "vba"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 1, "creation_date": 1452049337, "post_id": 34624869, "comment_id": 56995633, "body": "Task scheduler should be able to do this even if the user is not logged in...   have you set up a task and it&#39;s not running?"}, {"owner": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1452052296, "post_id": 34624869, "comment_id": 56996392, "body": "Sorry I am new to this, and I have no idea how to start. I tried searching online and got answers to creating a vbs script and saving excel as xls but I can&#39;t seem to do that in excel 2010. May I know how I can start working on it?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1452071058, "post_id": 34624869, "comment_id": 57003666, "body": "You could start by googling task scheduler."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "edited": false, "score": 0, "creation_date": 1452675211, "post_id": 34629135, "comment_id": 57269385, "body": "Thanks for your help!"}, {"owner": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "reply_to_user": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "edited": false, "score": 0, "creation_date": 1452764551, "post_id": 34629135, "comment_id": 57316217, "body": "If it&#39;s okay for you, accept answer to close topic ;o)"}], "tags": [], "owner": {"reputation": 254, "user_id": 2804365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4427ca6ca72295d48145b77bb04a61f3?s=128&d=identicon&r=PG", "display_name": "grominet", "link": "https://stackoverflow.com/users/2804365/grominet"}, "is_accepted": true, "score": 2, "last_activity_date": 1452070917, "creation_date": 1452070917, "answer_id": 34629135, "question_id": 34624869, "link": "https://stackoverflow.com/questions/34624869/running-macros-at-scheduled-time-when-pc-is-locked/34629135#34629135", "title": "Running macros at scheduled time when pc is locked", "body": "<pre><code>Sub tempo()\n    tps = Now + TimeValue(\"00:01:00\") 'your refresh rate\n    Application.OnTime tps, \"message_ctrl\"\nEnd Sub\n\nSub message_ctrl()\n     Call Module1.test  'your macro\n     Call tempo 'this just relaunch schedule when test() finished\nEnd Sub\n</code></pre>\n\n<p>Here exemple to refresh every minutes, but you can define day or anything.\nYou need to start once tempo() or message_ctrl() to start cycle. Maybe at workbook_open.\nThe key here is the <strong>Application.OnTime</strong> function.</p>\n"}], "owner": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2458, "favorite_count": 1, "accepted_answer_id": 34629135, "answer_count": 1, "score": 1, "last_activity_date": 1452126642, "creation_date": 1452049056, "last_edit_date": 1531161705, "question_id": 34624869, "link": "https://stackoverflow.com/questions/34624869/running-macros-at-scheduled-time-when-pc-is-locked", "title": "Running macros at scheduled time when pc is locked", "body": "<p>Background: Windows 7, Office 2010</p>\n\n<p>I currently have 2 macros running by buttons, one macro calculates and extracts data and the other macro selects a specific range and sends an email to a specified email.</p>\n\n<p>May I know how I can get this 2 macros to run at a scheduled time when my pc is locked - i.e. (on 'switch user' screen)?</p>\n\n<p>Thank you and I sincerely appreciate any help I can get! </p>\n"}, {"tags": ["excel", "vba", "io"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1452099574, "post_id": 34624410, "comment_id": 57022297, "body": "The only &quot;standards&quot; you should consider are in regard to &quot;how&quot; the library will be used, by whom(, and maybe how often). The general rule I use for this sort of interface is to model the read/write functions on existing &quot;standard&quot; library calls for reading/writing files (Windows, DOS, Linux, etc). Just pick one that makes sense for you, your company, your industry and that is likely to be well understood. When designing an API such as this, the most important thing is abstraction -- letting the library handle as much of the format-specific work as possible."}, {"owner": {"reputation": 63, "user_id": 4459212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b088384df474caf84d980a85550a5c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Rovsom", "link": "https://stackoverflow.com/users/4459212/rovsom"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1452464942, "post_id": 34624410, "comment_id": 57169351, "body": "Thanks for the info @PeterT, that&#39;s really helpful - given me some more things to read up on.  Cheers."}], "owner": {"reputation": 63, "user_id": 4459212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b088384df474caf84d980a85550a5c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Rovsom", "link": "https://stackoverflow.com/users/4459212/rovsom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1452045270, "creation_date": 1452045270, "question_id": 34624410, "link": "https://stackoverflow.com/questions/34624410/standard-method-for-creating-file-read-write-library", "title": "Standard method for creating file read/write &#39;library&#39;?", "body": "<p>I am attempting to create a file read/write 'library' using Excel VBA for an old file format.  Just for info, the format is LIS79, an old oil industry format for writing well-site data to tape - largely streams of wellbore measurements like density, resistance, temperature etc. The full spec is <a href=\"http://w3.energistics.org/LIS/lis-79.pdf\" rel=\"nofollow\">here</a> (PDF doc) - it's pretty long and boring.</p>\n\n<p>As I'm using Excel VBA I guess it's not really a library, but a collection of subs and functions etc.</p>\n\n<p>I have been tapping away for a month or so and am making good progress, though it's becoming increasingly complicated - the number of subs and functions I need to write keeps on growing.</p>\n\n<p>I figure I'm probably not the fist person to try and write a file read/write library from it's specification. So I've been searching StackExchange, searched using Google and browsed programming books at the local university library, to see if any sort of standard process or method might exist that would make the whole task a bit simpler.  Alas I haven't been able to find anything, though I have no formal programming background so it's possible I don't know precisely what to search for.</p>\n\n<p>Does anyone know of a standard method, procedure or guidelines for creating file read/write libraries that you could refer me to?</p>\n\n<p>Or is it just a matter of persevering - file read/write libraries can be long and complicated things to create?</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["excel", "vba", "loops", "charts"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4793824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/469dabb90e0e9a472f862f45b18c9b95?s=128&d=identicon&r=PG&f=1", "display_name": "user4793824", "link": "https://stackoverflow.com/users/4793824/user4793824"}, "edited": false, "score": 0, "creation_date": 1452104692, "post_id": 34626060, "comment_id": 57025511, "body": "Thanks! I tried to run it but I got run time error 1004, application-defined or object-defined error on   Set rng = ActiveSheet.Range(MyArray(i, 1))"}, {"owner": {"reputation": 102, "user_id": 5079012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaafC.jpg?s=128&g=1", "display_name": "nfloria", "link": "https://stackoverflow.com/users/5079012/nfloria"}, "reply_to_user": {"reputation": 25, "user_id": 4793824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/469dabb90e0e9a472f862f45b18c9b95?s=128&d=identicon&r=PG&f=1", "display_name": "user4793824", "link": "https://stackoverflow.com/users/4793824/user4793824"}, "edited": false, "score": 0, "creation_date": 1452115447, "post_id": 34626060, "comment_id": 57031991, "body": "I&#39;m also having issues now.  I didn&#39;t when I answered - Let me look at it."}, {"owner": {"reputation": 102, "user_id": 5079012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaafC.jpg?s=128&g=1", "display_name": "nfloria", "link": "https://stackoverflow.com/users/5079012/nfloria"}, "reply_to_user": {"reputation": 25, "user_id": 4793824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/469dabb90e0e9a472f862f45b18c9b95?s=128&d=identicon&r=PG&f=1", "display_name": "user4793824", "link": "https://stackoverflow.com/users/4793824/user4793824"}, "edited": false, "score": 0, "creation_date": 1452119740, "post_id": 34626060, "comment_id": 57034164, "body": "Ok - I edited the code above.  The only time I get errors now is if I don&#39;t delete all of the charts before running the sub again (because of how code-created charts are named we end up with duplicate named charts).  I also added your sample data in the fields for the first graph (B8:E17) just to test it and all worked out."}], "tags": [], "owner": {"reputation": 102, "user_id": 5079012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaafC.jpg?s=128&g=1", "display_name": "nfloria", "link": "https://stackoverflow.com/users/5079012/nfloria"}, "is_accepted": false, "score": 0, "last_activity_date": 1452119508, "last_edit_date": 1452119508, "creation_date": 1452057176, "answer_id": 34626060, "question_id": 34624029, "link": "https://stackoverflow.com/questions/34624029/how-can-i-write-a-loop-in-vba-for-this-code/34626060#34626060", "title": "How can I write a loop in vba for this code", "body": "<p>Using named ranges and some arrays you can loop through it.\nFirst, create named ranges for the ranges for each chart.</p>\n\n<p>I added a small table in the spreadsheet and named each one the text in the first cell of the range (i.e., Chart1,... Chart7).  The other ranges each go in the next cell, so the range named \"Chart 1\" is 4 cells.</p>\n\n<p>(I also used the same ranges and cells that you did in your code above)</p>\n\n<p>Chart1  B8:E17  C24 C1 <br>\nChart2  G8:J17  H24 H1 <br>\nChart3  L8:O17  M24 H1 <br>\nChart4  B82:E91 C51 C75 <br>\nChart5  G82:J91 H51 H75 <br>\nChart6  L82:O91 M51 R75 <br>\nChart7  Q82:T91 R51 R75 <br></p>\n\n<pre><code>Sub FormatChartNIX_Modified()\n\nDim rng As Range\nDim cht As Object\nDim ser As Series\nDim tmpCHR As ChartObject\nDim MyArray(1 To 7, 0 To 3) As String\nDim i As Integer\n\n\nFor i = LBound(MyArray) To UBound(MyArray)\n        'Set Values - possibly with named ranges\n        Dim vArray() As Variant\n        Dim strNamedRange As String\n\n        strNamedRange = \"Chart\" &amp; i\n\n        Set rng = Worksheets(\"Sheet1\").Range(strNamedRange)\n        vArray = rng\n\n        Dim j As Integer\n\n        For j = LBound(MyArray, 2) To UBound(MyArray, 2)\n\n            MyArray(i, j) = vArray(1, j + 1)\n            Debug.Print MyArray(i, j)\n\n        Next j\n\n    Next i\n\n    For i = LBound(MyArray) To UBound(MyArray)\n\n            With ActiveSheet\n                Set rng = .Range(MyArray(i, 1))                     '1 represents the data range\n                Set cht = .Shapes.AddChart\n                cht.Chart.SetSourceData Source:=rng, PlotBy:=xlRows\n                cht.Chart.ChartType = xlColumnStacked\n\n                .ChartObjects(i).Top = .Range(MyArray(i, 2)).Top    '0 represents the chart name\n                .ChartObjects(i).Left = .Range(MyArray(i, 2)).Left  '2 represents the cell identifying the chart location\n                .ChartObjects(i).Activate\n                With ActiveChart\n                .Axes(xlValue).Select\n                .Axes(xlValue).Delete\n                .HasTitle = True\n                .ChartTitle.Text = ActiveSheet.Range(MyArray(i, 3)).Text '3 represents the cell where the title text is located\n                End With\n            End With\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Do that, run the sub and it will create 7 charts as described in the table - using a loop.</p>\n"}], "owner": {"reputation": 25, "user_id": 4793824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/469dabb90e0e9a472f862f45b18c9b95?s=128&d=identicon&r=PG&f=1", "display_name": "user4793824", "link": "https://stackoverflow.com/users/4793824/user4793824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452119508, "creation_date": 1452042332, "question_id": 34624029, "link": "https://stackoverflow.com/questions/34624029/how-can-i-write-a-loop-in-vba-for-this-code", "title": "How can I write a loop in vba for this code", "body": "<pre><code>59.30   15                16                   17\n1    1,162,912,036.90    1,248,737,016.99    1,306,573,912.08 \n2    245,665,383.94      261,416,880.69      276,613,283.05 \n3    393,313,441.29      379,169,039.15      418,680,492.19 \n4    13,920,572.74       14,464,854.92       15,120,474.58 \n5    54,501,581.55       56,319,351.21       58,832,588.24 \n6    15,165,376.28       11,694,942.56       10,809,661.03 \n7    194,397,643.30      170,427,013.85      182,567,862.46 \n8    15,165,376.28       11,694,942.56       10,809,661.03 \n9    2,079,876,036.00    2,142,229,099.38    2,269,198,273.62\n     3%                  6%\n</code></pre>\n\n<p>There are 7 tables like the above data in one excel tab in different area.I want to create a stacked column chart for each table. I wrote a code to create. Just want to know is that possiable to use loop to solve this problem? Code attached.</p>\n\n<p>Sub FormatChartNIX()\n    'PURPOSE: Create a chart (chart dimensions are not required)</p>\n\n<pre><code>Dim rng As Range\nDim cht As Object\nDim ser As Series\nDim tmpCHR As ChartObject\n\n'Chart1\n        'Your data range for the chart\n          Set rng = ActiveSheet.Range(\"B8:E17\")\n\n        'Create a chart\n          Set cht = ActiveSheet.Shapes.AddChart\n\n        'Give chart some data\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n\n        'Determine the chart type\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(1).Top = .Range(\"C24\").Top\n         .ChartObjects(1).Left = .Range(\"C24\").Left\n         End With\n        ActiveSheet.ChartObjects(1).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\nActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"c1\")\n\n'Chart2\n           Set rng = ActiveSheet.Range(\"G8:J17\")\n          Set cht = ActiveSheet.Shapes.AddChart\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(2).Top = .Range(\"H24\").Top\n         .ChartObjects(2).Left = .Range(\"H24\").Left\n         End With\n         ActiveSheet.ChartObjects(2).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\nActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"h1\")\n'Chart3\n           Set rng = ActiveSheet.Range(\"L8:o17\")\n          Set cht = ActiveSheet.Shapes.AddChart\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(3).Top = .Range(\"M24\").Top\n         .ChartObjects(3).Left = .Range(\"M24\").Left\n         End With\n         ActiveSheet.ChartObjects(3).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\nActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"h1\")\n'Chart4\n           Set rng = ActiveSheet.Range(\"B82:E91\")\n          Set cht = ActiveSheet.Shapes.AddChart\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(4).Top = .Range(\"C51\").Top\n         .ChartObjects(4).Left = .Range(\"C51\").Left\n         End With\n                   ActiveSheet.ChartObjects(4).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\nActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"c75\")\n 'Chart5\n           Set rng = ActiveSheet.Range(\"G82:J91\")\n          Set cht = ActiveSheet.Shapes.AddChart\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(5).Top = .Range(\"H51\").Top\n         .ChartObjects(5).Left = .Range(\"H51\").Left\n         End With\n                   ActiveSheet.ChartObjects(5).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\n ActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"h75\")\n\n'Chart6\n           Set rng = ActiveSheet.Range(\"L82:o91\")\n          Set cht = ActiveSheet.Shapes.AddChart\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(6).Top = .Range(\"M51\").Top\n         .ChartObjects(6).Left = .Range(\"M51\").Left\n         End With\n                   ActiveSheet.ChartObjects(6).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\n ActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"m75\")\n 'Chart7\n           Set rng = ActiveSheet.Range(\"Q82:T91\")\n          Set cht = ActiveSheet.Shapes.AddChart\n          cht.chart.SetSourceData Source:=rng, PlotBy:=xlRows\n          cht.chart.ChartType = xlColumnStacked\n        With ActiveSheet\n         .ChartObjects(7).Top = .Range(\"R51\").Top\n         .ChartObjects(7).Left = .Range(\"R51\").Left\n         End With\n                   ActiveSheet.ChartObjects(7).Activate\nActiveChart.Axes(xlValue).Select\nSelection.delete\n ActiveChart.HasTitle = True\nActiveChart.ChartTitle.Text = ActiveSheet.Range(\"r75\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "charts", "axes"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1452038137, "post_id": 34623112, "comment_id": 56992361, "body": "Have you tried recording a macro?"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4459212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b088384df474caf84d980a85550a5c9c?s=128&d=identicon&r=PG&f=1", "display_name": "Rovsom", "link": "https://stackoverflow.com/users/4459212/rovsom"}, "is_accepted": false, "score": 0, "last_activity_date": 1452050576, "creation_date": 1452050576, "answer_id": 34625097, "question_id": 34623112, "link": "https://stackoverflow.com/questions/34623112/how-can-i-write-a-vba-to-delete-all-x-lables-for-all-charts-in-the-spreadsheet/34625097#34625097", "title": "How can I write a vba to delete all x lables for all charts in the spreadsheet?", "body": "<p>So you want to \"delete all x labels\" or \"remove all vertical labels on the left hand side\"?  That reads as though you are first referring to the horizontal x-axis and then to the vertical y-axis - bit confusing.  Helps if you use the Excel terminology - vertical or horizontal axis.  And remove axis, axis title or axis tick labels?</p>\n\n<p>That aside...  you can loop through all chart objects in a worksheet like this:</p>\n\n<pre><code>Sub loopCharts()\n\nDim i As Integer\n\nFor i = 1 to ActiveSheet.ChartObjects.Count\n\n    'do some stuff with the chart\n\nNext i  \n\nEnd Sub\n</code></pre>\n\n<p>For example, if you want to delete the vertical axis:</p>\n\n<pre><code>Sub delVertAxisAllCharts()\n\nDim i As Integer\n\nFor i = 1 to ActiveSheet.ChartObjects.Count\n\n    ActiveSheet.ChartObjects(i).Chart.Axes(xlValue).Delete\n\nNext i  \n\nEnd Sub\n</code></pre>\n\n<p>If you just want to remove the horizontal tick labels:</p>\n\n<pre><code>Sub remHorizTickLabels()\n\nDim i As Integer\n\nFor i = 1 to ActiveSheet.ChartObjects.Count\n\n    ActiveSheet.ChartObjects(i).Chart.Axes(xlCategory).TickLabelPosition = xlNone\n\nNext i  \n\nEnd Sub\n</code></pre>\n\n<p>Hope that helps...</p>\n"}], "owner": {"reputation": 25, "user_id": 4793824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/469dabb90e0e9a472f862f45b18c9b95?s=128&d=identicon&r=PG&f=1", "display_name": "user4793824", "link": "https://stackoverflow.com/users/4793824/user4793824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1956, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452050576, "creation_date": 1452036443, "question_id": 34623112, "link": "https://stackoverflow.com/questions/34623112/how-can-i-write-a-vba-to-delete-all-x-lables-for-all-charts-in-the-spreadsheet", "title": "How can I write a vba to delete all x lables for all charts in the spreadsheet?", "body": "<p>I have 7 stacked column charts in one tab. I want to write a vba to remove all vertical labels on the left hand side in all charts. I thought it would be simple but it's not!</p>\n"}, {"tags": ["asp.net", "vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1452038777, "post_id": 34623047, "comment_id": 56992582, "body": "From the <a href=\"http://www.controlbyweb.com/x310/x-310_users_manual.pdf\" rel=\"nofollow noreferrer\">X310 manual</a> (PDF) you linked above (page 115) - &quot;Note: If the Control Password is enabled in the setup pages, the password will be required to access the log file&quot; Can you disable the control password (and thus not need to worry about authentication) or do you require to have that password in place?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1452040128, "post_id": 34623047, "comment_id": 56993007, "body": "See page 95 of that same manual, which describes how to pass the username/password (as a base-64-encoded version of username:password)"}], "owner": {"reputation": 11, "user_id": 5749837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479a7432292c1b495548d8326d803dc1?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Pupo", "link": "https://stackoverflow.com/users/5749837/bruno-pupo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 686, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1477459704, "creation_date": 1452036061, "last_edit_date": 1477459704, "question_id": 34623047, "link": "https://stackoverflow.com/questions/34623047/excel-vba-web-server-authentication-popup", "title": "Excel VBA - Web Server Authentication popup", "body": "<p>I am trying to query into my spreadsheet a web relay device (ControlByWeb X310)<a href=\"http://www.controlbyweb.com/x310/x-310_users_manual.pdf\" rel=\"nofollow noreferrer\">X310</a> basically a IoT device.  It has a built-in web servver and when I manually browse its URL for the first time it pops up with a web server login page (not a browser HTML window):</p>\n\n<p><img src=\"https://i.stack.imgur.com/z1ltu.jpg\" alt=\"enter image description here\"></p>\n\n<p>I've recorded a macro of adding this log data via an Excel insert \"from Web\" data connection.  It basically uses recorded the following VBA:</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;http://111.111.111.111:8080/log.txt\", Destination:=Range(\"$A$1\"))....\n</code></pre>\n\n<p>Within the last item end With statement \".Refresh BackgroundQuery:=False\" takes a while to do it's thing but returns nothing. If I've previously manually logged into the web page via my edge browser and authenticated access, then this command returns exactly what I need.  I have thousands of these devices sitting on the internet that I need to collect data from so a script that will loop through each would be very practical.  </p>\n\n<p>Is there a command or syntax for the QueryTables object that can pass a user id and password to the login pop-up?  Something like:</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;http://111.111.111.111:8080/log.txt\", ID:=\"name\", PWD:=\"password\"\n</code></pre>\n\n<p>... does not work.</p>\n\n<p>I've searched high and low and found a lot of info on login by scraping HTML but the pop-up I get is being service up by the web server authentication. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452034058, "post_id": 34622632, "comment_id": 56990865, "body": "<code>Do Until x = coelhoviado</code> What&#39;s <code>coelhoviado</code>?"}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452034537, "post_id": 34622632, "comment_id": 56991104, "body": "sorry, its written lastcell as i defined previously instead of coelhoviado. But still not working"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452034785, "post_id": 34622632, "comment_id": 56991189, "body": "<code>lastcell = Range(&quot;A400&quot;)</code> <code>lastcell</code> is a range, not number. (Don&#39;t you need a <code>set</code>?)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452034788, "post_id": 34622632, "comment_id": 56991191, "body": "Move your <code>x=x+1</code> after you <code>end if</code>.  it only increments on the deletes.  It needs to increment every loop."}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1452035796, "creation_date": 1452035796, "answer_id": 34622999, "question_id": 34622632, "link": "https://stackoverflow.com/questions/34622632/macro-to-delete-all-the-rows-containing-specific-values/34622999#34622999", "title": "macro to delete all the rows containing specific values", "body": "<p>Try this code:</p>\n\n<pre><code>Sub test()\n Dim lastcell As Long\n Dim i As Long\n Dim ws As Worksheet\n Dim rng As Range\n\n Set ws = Sheets(\"Sistema\")\n lastcell = 400\n\n For i = lastcell To 1 Step -1\n  Set rng = ws.Range(\"A\" &amp; i)\n  If Left(rng.Value, 3) = \"LF \" Or Left(rng.Value, 3) = \"LFS\" Or _\n    Left(rng.Value, 4) = \"LF00\" Or Left(rng.Value, 3) = \"LFT\" Then\n        rng.EntireRow.Delete Shift:=xlUp\n  End If\n Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 809, "favorite_count": 0, "closed_date": 1452046768, "answer_count": 1, "score": -1, "last_activity_date": 1452046785, "creation_date": 1452033997, "last_edit_date": 1531161705, "question_id": 34622632, "link": "https://stackoverflow.com/questions/34622632/macro-to-delete-all-the-rows-containing-specific-values", "closed_reason": "Duplicate", "title": "macro to delete all the rows containing specific values", "body": "<p>I have been working on a code to delete all the rows if there is a specific value in cells from column A. It works fine and delete all the rows I need, however the loop keeps going and it does not understand that should stop at cell \"A400\". Could you help me? Thank you!</p>\n\n<pre><code>Sub apaga1()\nDim PULO As String\nSheets(\"Sistema\").Activate\nCells.Find(\"LF00\").Activate\nActiveCell.Offset(1, 0).Select\nlastcell = Range(\"A400\")\n'APAGAR LFs\nDo Until x = coelhoviado\n    If Left(ActiveCell, 3) = \"LF \" Or Left(ActiveCell, 3) = \"LFS\" Or\n    Left(ActiveCell, 4) = \"LF00\" Or Left(ActiveCell, 3) = \"LFT\" Then\n        ActiveCell.EntireRow.Delete Shift:=xlUp\n        ActiveCell.Offset(-1, 0).Select\n        x = x + 1\n    End If\n    ActiveCell.Offset(1, 0).Select\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452032440, "post_id": 34622186, "comment_id": 56990133, "body": "Can we see the code you are trying?  It may be how you entered.  Try <a href=\"http://www.techonthenet.com/excel/formulas/date_vba.php\" rel=\"nofollow noreferrer\">Date()</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452033244, "post_id": 34622186, "comment_id": 56990490, "body": "You will need to put your code in your original post, using the &quot;edit&quot; link."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452034380, "post_id": 34622186, "comment_id": 56991027, "body": "Try: <code>ListLondon = WorkSheetFunction.CountIf(Sheets(&quot;Sheet1&quot;).Range(&quot;a1:a1998&quot;)&zwnj;&#8203;, &quot;London&quot;, Sheets(&quot;Sheet1&quot;).Range(&quot;K1:K1998&quot;), &quot;&lt;&quot; &amp; Date)</code>"}, {"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452034856, "post_id": 34622186, "comment_id": 56991220, "body": "I have tried that code and am getting the following error:complier error:  Can&#39;t find project or library. Thanks for your help so far on this!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452035063, "post_id": 34622186, "comment_id": 56991300, "body": "Yeah sorry forgot the <code>s</code>: <code>listlondon = WorksheetFunction.CountIfs(Sheets(&quot;Sheet1&quot;).Range(&quot;a1:a1998&quot;&zwnj;&#8203;), &quot;London&quot;, Sheets(&quot;Sheet1&quot;).Range(&quot;K1:K1998&quot;), &quot;&lt;&quot; &amp; Date)</code>"}, {"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452035313, "post_id": 34622186, "comment_id": 56991383, "body": "Mmm. I&#39;ve google&#39;d the error and it refers to a reference that appears to be mising on my PC. So the chances are your code is spot on - but I will not be able to fully test it until tomorrow on my work pc. Seem to be missing refedit.dll - or at least thats what is highlighted under references."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452035478, "post_id": 34622186, "comment_id": 56991443, "body": "There must be something more to the code than the lines provided.  Because using excel - vba there is nothing that should throw that error.  One question though, are you using a Mac?  You may need to change the <code>Sheets(...)</code> with <code>worksheets(...)</code>"}, {"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452035911, "post_id": 34622186, "comment_id": 56991591, "body": "I also checked out that article regards Mac version of Excel. I am using Windows 7 with Excel 2007. I will have a look at the renaming of the sheets"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "edited": false, "score": 0, "creation_date": 1452032968, "post_id": 34622319, "comment_id": 56990350, "body": "Thanks for the quick replies! Here is the actual code I am playing about with in VBA:"}], "tags": [], "owner": {"reputation": 75, "user_id": 5251872, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6bd8650a3e113b94989fde94caf1706?s=128&d=identicon&r=PG", "display_name": "ToMmY_hun", "link": "https://stackoverflow.com/users/5251872/tommy-hun"}, "is_accepted": false, "score": 0, "last_activity_date": 1452032665, "creation_date": 1452032665, "answer_id": 34622319, "question_id": 34622186, "link": "https://stackoverflow.com/questions/34622186/today-function-equivalent-in-vba-in-combination-with-countifs/34622319#34622319", "title": "Today function equivalent in VBA in combination with countifs", "body": "<ol>\n<li><p>You have to read the values of the cells to your VBA code. I recommend you to use Excel.Range object to do that. It can interpret the range like the edit line of the Excel, something like</p>\n\n<p>Dim foo as Excel.Range</p>\n\n<p>set foo = yourworksheet.Range(\"A1:B3\")</p></li>\n<li><p>Read the Date type data into VBA Date type variable by iterating through the cells.</p></li>\n<li><p>Examine relation between the read data and the current date. Current date can be read by using the <em>DateTime.Now</em> function.</p></li>\n<li><p>Increment a variable based on a decision</p></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 5735043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953abb3863b90584d60cc5a46d61a2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Pickles", "link": "https://stackoverflow.com/users/5735043/mr-pickles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 867, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452033980, "creation_date": 1452032127, "last_edit_date": 1531164843, "question_id": 34622186, "link": "https://stackoverflow.com/questions/34622186/today-function-equivalent-in-vba-in-combination-with-countifs", "title": "Today function equivalent in VBA in combination with countifs", "body": "<p>I am having some problem with using a  countifs formula in Excel / VBA. I have got the formula working perfect in Excel but ideally I want to use this in VBA with my form. Here is the formula in Excel which works a treat:</p>\n\n<pre><code>=COUNTIFS(Sheet1!A:A,\"Place\",Sheet1!K:K,\"&lt;\"&amp;TODAY()) \n</code></pre>\n\n<p>will count the names places that are now in the past</p>\n\n<pre><code>=COUNTIFS(Sheet1!A:A,\"place\",Sheet1!K:K,\"&gt;\"&amp;TODAY())\n</code></pre>\n\n<p>will count the names places that are current</p>\n\n<p>I have five different Places in column A and hundreds of different dates in column K. The above formulas work well in Excel and return the correct values. I have spent hours trying to get this to work in VBA with my userform but keep getting various errors. The first part is not the problem but as soon as I get to the &amp;today function it falls apart. From what I can see the &amp;today function is not available in VBA and the &amp;Date seems to be the recommendation. I have tried this but still get no where. I'm missing a trick (or several) here and I would really like to get this working in VBA rather than using the current formulas in Excel. The returned results are then displayed in textboxes on my form.</p>\n\n<p>All ideas and feedback much welcome!</p>\n\n<p>Second edit</p>\n\n<p>================================</p>\n\n<p>Thanks for the quick replies! Here is the actual code I am playing about with in VBA</p>\n\n<pre><code> 'Count events by area'\nDim ListLondon As Long\n\nListLondon = .CountIf(Range(\"a1:a1998\"), \"London\"), (\"Sheet1!K1:K1998\"), \"&lt;\" &amp; Date)\n\nEnd With\n\nMe.TextBox1 = ListLondon\n</code></pre>\n\n<p>I know the second part of the count if is all wrong regards the date - that's how I've left it for now. I am really hoping to use the current layout and a working Date / Today code at the end. Please show me what I've done wrong here!</p>\n\n<p>====</p>\n\n<p>oops - can see a mistake already - but the initial problem remains around the date issue. I should of used countifs as using multiple criteria.</p>\n"}, {"tags": ["vba", "excel", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1452030181, "post_id": 34621624, "comment_id": 56989100, "body": "<code>(DOT)Offset(1)</code>... :-P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452195021, "post_id": 34621624, "comment_id": 57072590, "body": "@JoshPowell if this worked for you, please mark it as correct, by hitting the green check by the answer."}, {"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452269556, "post_id": 34621624, "comment_id": 57108393, "body": "Subscript out of range (9) on line &quot;.Range(.Cells(cell.Row, 2), .Cells(cell.Row, 4)).Copy Sheets(cell.Value).Range(&quot;B&quot; &amp; Sheets(cell.Value).Rows.Count).End(xlUp).Offset(1)&quot;"}, {"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452269670, "post_id": 34621624, "comment_id": 57108476, "body": "I also prefer the second, because it creates only the sheets I need as opposed to having all of them, even if there aren&#39;t any in that size..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452269859, "post_id": 34621624, "comment_id": 57108628, "body": "@JoshPowell that would mean that one of your sheets is not named exactly like one of the sizes found in column C.  As to the second, the creation of a sheet was not in your question as a requirement.  I will let you work with tigeravatar, you are in good hands with him."}, {"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452270009, "post_id": 34621624, "comment_id": 57108750, "body": "I double and triple checked the names of the sheets. And I didn&#39;t realize how nice that would be until I saw that. Thank you for your help however. I was very good to see both these options as a learning experience, and I believe I am starting to understand the language much more now, which was the goal anyway."}, {"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452270323, "post_id": 34621624, "comment_id": 57108974, "body": "I&#39;d be willing to send a file so you can see what I&#39;m talking about. If I can get either to work correctly, that&#39;s my goal."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1452281881, "last_edit_date": 1452281881, "creation_date": 1452029666, "answer_id": 34621624, "question_id": 34621490, "link": "https://stackoverflow.com/questions/34621490/if-cell-value-is-specific-size-copy-3-cells-in-that-row-to-new-sheet/34621624#34621624", "title": "If Cell.Value is specific size, Copy 3 cells in that row to new sheet", "body": "<p>Name the sheets the size and use this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nwith sheets(\"Main\")\n    For Each Cell In .Range(\"C2\",.range(\"C\" &amp; .rows.count).end(xlup))\n        .range(.cells(cell.row,2),.cells(cell.row,4)).copy sheets(cell.value).range(\"B\" &amp; sheets(cell.value).rows.count).end(xlup).offset(1)               \n    next cell\nEnd with\nEnd sub\n</code></pre>\n\n<p>Since the sheet is named as the size, the one line is sufficient. It copies only B to D on the row found and puts it in the next available row on the sheet named as the size.</p>\n\n<p>Note: This will not work if the sheets are not named the same as the size in column C on the main sheet.</p>\n\n<p>One should also avoid using the <code>.select</code> whenever possible, as it will slow down the code.</p>\n\n<p>EDIT: with this layout:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LC6Jd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LC6Jd.png\" alt=\"enter image description here\"></a></p>\n\n<p>I change the code to:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim mws As Worksheet\nDim tws As Worksheet\n\nSet mws = Sheets(\"Main\")\n\nWith mws\n    For Each cell In .Range(\"B3\", .Range(\"B\" &amp; .Rows.Count).End(xlUp))\n        If Not SheetExists(cell.Value) Then\n            Set tws = ActiveWorkbook.Sheets.Add\n            tws.Name = cell.Value\n            .Range(\"A2:D2\").Copy tws.Range(\"A1\")\n\n        Else\n            Set tws = Sheets(cell.Value)\n        End If\n        .Range(.Cells(cell.Row, 1), .Cells(cell.Row, 4)).Copy tws.Range(\"A\" &amp; tws.Rows.Count).End(xlUp).Offset(1)\n        tws.Columns(\"A:D\").AutoFit\n    Next cell\nEnd With\nEnd Sub\nFunction SheetExists(SName As String, _\n                     Optional ByVal WB As Workbook) As Boolean\n\n    On Error Resume Next\n    If WB Is Nothing Then Set WB = ActiveWorkbook\n    SheetExists = CBool(Len(WB.Sheets(SName).Name))\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452269094, "post_id": 34623204, "comment_id": 57108010, "body": "I tried this, and it only works some of the time.Which is weird. More often than not I get the error &quot;type mismatch (13)&quot; on line &quot;For Each vSize In aUnqSizes&quot;"}, {"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452269206, "post_id": 34623204, "comment_id": 57108102, "body": "B                  C               D ----------------------------------------- <b>Name</b>         | Size          | #    | ----------------------------------------- Joe              1-Youth Small\t2 Ben             1-Youth Small\t7 Bob             1-Youth Small\t10 Joe              1-Youth Small\t13 Joe              1-Youth Small\t22 Joe              1-Youth Small\t32 Joe              1-Youth Small\t99 Joe              1-Youth Small\t1 Joe              1-Youth Small\t3 Joe              3-Youth Large\t6 Joe              3-Youth Large\t11 Joe              3-Youth Large\t21"}, {"owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452271629, "post_id": 34623204, "comment_id": 57109882, "body": "think you can help me understand whats going on?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "edited": false, "score": 0, "creation_date": 1452274621, "post_id": 34623204, "comment_id": 57111770, "body": "@JoshPowell I have updated the answer and it should now work properly for all cases."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452280107, "post_id": 34623204, "comment_id": 57114838, "body": "Whats interesting is that this is not like the data he sent me in an email."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452280744, "post_id": 34623204, "comment_id": 57115163, "body": "@ScottCraner Weird, hopefully I&#39;m not chasing my tail &gt;&lt;"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452280773, "post_id": 34623204, "comment_id": 57115184, "body": "@ScottCraner Out of curiosity, does this code work on the data he emailed you?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1452280988, "post_id": 34623204, "comment_id": 57115297, "body": "No, name was in column D, The second part of B and column C were in column B and C was the number.  Column A was a line number.  The data started in row 3 with row 2 being the titles and row 1 being empty."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1452274605, "last_edit_date": 1452274605, "creation_date": 1452036990, "answer_id": 34623204, "question_id": 34621490, "link": "https://stackoverflow.com/questions/34621490/if-cell-value-is-specific-size-copy-3-cells-in-that-row-to-new-sheet/34623204#34623204", "title": "If Cell.Value is specific size, Copy 3 cells in that row to new sheet", "body": "<p>Alternate method with lots of bells and whistles.  Scott Craner's answer is likely far more practical considering your current experience level, but for anybody looking for a more advanced approach:</p>\n\n<p><strong>EDIT</strong> In comments, OP provided sample data:</p>\n\n<pre><code>_____B_____  __C__  _D_\nName         Size     #\nJoe 1-Youth  Small    2\nBen 1-Youth  Small    7\nBob 1-Youth  Small   10\nJoe 1-Youth  Small   13\nJoe 1-Youth  Small   22\nJoe 1-Youth  Small   32\nJoe 1-Youth  Small   99\nJoe 1-Youth  Small    1\nJoe 1-Youth  Small    3\nJoe 3-Youth  Large    6\nJoe 3-Youth  Large   11\nJoe 3-Youth  Large   21\n</code></pre>\n\n<p>Updated code and verified it works with the provided sample data and the original data:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim wsMain As Worksheet\n    Dim rCopy As Range\n    Dim rUnqSizes As Range\n    Dim SizeCell As Range\n    Dim sName As String\n    Dim lAnswer As Long\n    Dim i As Long\n\n    Set wb = ActiveWorkbook\n    Set wsMain = wb.Sheets(\"Main\")\n\n    lAnswer = MsgBox(Title:=\"Run Preference\", _\n                     Prompt:=\"Click YES to override existing data.\" &amp; _\n                     Chr(10) &amp; \"Click NO to append data to bottom of sheets.\" &amp; _\n                     Chr(10) &amp; \"Click CANCEL to quit macro and do nothing.\", _\n                     Buttons:=vbYesNoCancel)\n\n    If lAnswer = vbCancel Then Exit Sub\n\n    With wsMain.Range(\"C1\", wsMain.Cells(Rows.Count, \"C\").End(xlUp))\n        If .Parent.FilterMode Then .Parent.ShowAllData\n        On Error Resume Next\n        .AdvancedFilter xlFilterInPlace, , , True\n        Set rUnqSizes = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n        On Error GoTo 0\n        If rUnqSizes Is Nothing Then\n            MsgBox \"No Data found in column C\", , \"No Data\"\n            Exit Sub\n        End If\n        If .Parent.FilterMode Then .Parent.ShowAllData\n\n        For Each SizeCell In rUnqSizes\n            sName = SizeCell.Value\n            For i = 1 To 7\n                sName = Replace(sName, \":\\/?*[]\", \" \")\n            Next i\n            sName = WorksheetFunction.Trim(Left(sName, 31))\n            If Not Evaluate(\"ISREF('\" &amp; sName &amp; \"'!A1)\") Then\n                wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count)).Name = sName\n                Set ws = wb.Sheets(sName)\n                wsMain.Range(\"B1:D1\").Copy\n                ws.Range(\"B1\").PasteSpecial xlPasteAll\n                ws.Range(\"B1\").PasteSpecial xlPasteColumnWidths\n                Application.CutCopyMode = False\n            Else\n                Set ws = wb.Sheets(sName)\n            End If\n            .AutoFilter 1, SizeCell.Value\n            Set rCopy = Intersect(wsMain.Range(\"B:D\"), .Offset(1).Resize(.Rows.Count - 1).EntireRow)\n            If lAnswer = vbNo Then\n                rCopy.Copy ws.Cells(Rows.Count, \"B\").End(xlUp).Offset(1)\n            Else\n                ws.Range(\"B2:D\" &amp; Rows.Count).Clear\n                rCopy.Copy ws.Range(\"B2\")\n            End If\n        Next SizeCell\n        If .Parent.FilterMode Then .Parent.ShowAllData\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2145993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235bbfb0711b13c08adfb357d1f07691?s=128&d=identicon&r=PG", "display_name": "Josh Powell", "link": "https://stackoverflow.com/users/2145993/josh-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 34623204, "answer_count": 2, "score": 0, "last_activity_date": 1452281881, "creation_date": 1452029103, "last_edit_date": 1452030315, "question_id": 34621490, "link": "https://stackoverflow.com/questions/34621490/if-cell-value-is-specific-size-copy-3-cells-in-that-row-to-new-sheet", "title": "If Cell.Value is specific size, Copy 3 cells in that row to new sheet", "body": "<p>I have an excel document that I fill out with tshirt sizes, names, and numbers. The goal here is... once the form is filled out, I can hit a button that will copy all the smalls and put them onto a new sheet, all the mediums, onto another, and so on. I CAN select the whole row, but I ONLY WANT to copy a few cells. I am also pasting them at this point into the same row on the new sheet as they were in the old sheet. I just want them to show up on the next available line. Here are some examples...</p>\n\n<p>IN EXCEL SHEET(1) \"MAIN\"</p>\n\n<pre><code>B                  C               D\n-----------------------------------------\n**Name**         | Size          | #    |\n-----------------------------------------\nJoe                Small           1              There are other\nSarah              X-Small         3              instructions over\nPeter              Large           6              here on this side\nSam                Medium          12             of the document\nBen                Small           14             that are important\nRick               Large           26\n</code></pre>\n\n<p>IN EXCEL SHEET(2) \"SMALL\" AS IT SHOULD BE</p>\n\n<pre><code>B                  C               D\n-----------------------------------------\n**Name**         | Size          | #    |\n-----------------------------------------\nJoe                Small           1\nBen                Small           14\n</code></pre>\n\n<p>IN EXCEL SHEET(2) \"SMALL\" WHAT IS HAPPENING</p>\n\n<pre><code>B                  C               D\n-----------------------------------------\n**Name**         | Size          | #    |\n-----------------------------------------\nJoe                Small           1              There are other\n\n\n\nBen                Small           14             that are important\n</code></pre>\n\n<p>HERE IS MY VBA CODE SO FAR</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nFor Each Cell In Sheets(1).Range(\"B:B\")\n    If Cell.Value = \"Small\" Then\n        matchRow = Cell.Row\n        Rows(matchRow &amp; \":\" &amp; matchRow).Select\n        Selection.Copy\n\n        Sheets(\"Small\").Select\n        ActiveSheet.Rows(matchRow).Select\n        ActiveSheet.Paste\n        Sheets(\"Main\").Select\n    End If\nNext\n</code></pre>\n\n<p>ON TO THE NEXT SIZE...</p>\n\n<p>In the first part, I am selecting the entire row because that is the row that contains the variable that I want in Column B, but I don't need the entire row, I only need to select Column B though D in that row.</p>\n\n<p>Now I understand \"matchRow\" is also why the data is pasting on the same row as it was copied from, but I'm not sure how to make it go to next available line either.</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452027356, "post_id": 34620902, "comment_id": 56987736, "body": "<code>Range(Cells(i, 1), Cells(i, 26)).Copy | .Cells(erow, 1).PasteSpecial</code> you&#39;re only copy/pasting columns A to Z. How does AD come into play? Also, perhaps you might want to consider conditional formatting instead of <code>worksheet_change</code> event."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452027853, "post_id": 34620902, "comment_id": 56987982, "body": "That is part of this mystery. I have nothing that is affecting or altering the cells in column AD, but somehow they are. And Conditional Formatting does not work. When we have multiple records using the same incident number, we only need to use one date. So, the users are copying and pasting the date into the next 3 rows down. This messes up the ranges in the CF rule (even absolute referencing). So this bit of code has proved invaluable."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452028074, "post_id": 34620902, "comment_id": 56988109, "body": "As much as I want it to be true, computers are not sentient (yet) so someone is altering column AD or you have other code or I am missing something. Try deleting AD and start fresh? I don&#39;t know :/"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452028339, "post_id": 34620902, "comment_id": 56988243, "body": "@findwindow Well, I would believe that someone could possibly alter the cells in column AD. But....I created this new today and did all the testing myself. I thought I might be missing something as well, that is why I am posting here. I just don&#39;t see how those cells are all of a sudden containing some sort of invisible value. Thanks for trying though findwindow. All your assistance in the past has been very helpful."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452028533, "post_id": 34620902, "comment_id": 56988353, "body": "With all that said, we may not find where this phantom value is coming from. But my question is: How do I code the removal of this &#39;null&#39; value that is making the Worksheet Change sub believe there is a value in the cell? And, can this be added to the &#39;Remove Duplicates&#39; sub?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452028692, "post_id": 34620902, "comment_id": 56988431, "body": "Null values are a pain so easiest (for me) to just delete column. Worksheet Change is a built in event. You can&#39;t add it to your own sub. Edit: hmmm my code may be bad. Hold on."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452029319, "post_id": 34620902, "comment_id": 56988720, "body": "Add <code>x = Target.Row</code> and change previous line to<code>If ActiveSheet.Cells(x, &quot;AD&quot;).Value &lt;&gt; &quot;&quot; Then</code> Edit: You placed the worksheet change code in the sheet module in question yes? Not in a separate module."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452029567, "post_id": 34620902, "comment_id": 56988826, "body": "Yes, it is in the worksheet object."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452031012, "post_id": 34620902, "comment_id": 56989505, "body": "@findwindow Should I &quot;Add&quot; or replace that bit of code from your comment?"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452031876, "post_id": 34620902, "comment_id": 56989883, "body": "is column &quot;AD&quot; contain formulas?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452032056, "post_id": 34620902, "comment_id": 56989966, "body": "Add the first line. Replace the second. I don&#39;t think it actually makes a difference XD"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452032079, "post_id": 34620902, "comment_id": 56989973, "body": "@Fadi No. There are no formulas anywhere in the workbook."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452032515, "post_id": 34620902, "comment_id": 56990163, "body": "@findwindow Sorry to report that did not work. it did not cause any errors, but it did not correct the issue."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452034681, "post_id": 34620902, "comment_id": 56991160, "body": "So I have run another test. Rows 12 through 22 are blank. I added zero&#39;s into AD12:AD22. All turned to green text as per the Worksheet_Change sub. Then I ran the Extract code that copies and pastes the data into the Swivel workbook. Once this completed I find it strange that A12:AD22 is now all black text. The zero&#39;s are still in the cells I placed earlier. So, something in that copy and paste sub is where the culprit is. Hope this helps."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1452035271, "post_id": 34620902, "comment_id": 56991369, "body": "Wait. Which book is the code residing in? The worksheet change code needs to be in destination book, not source. In other words, you need to copy paste Swivel into destination book (where code is). Edit: should&#39;ve mentioned this earlier... should qualify your ranges."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452036069, "post_id": 34620902, "comment_id": 56991647, "body": "@findwindow Good questions. I edited my original question to address your questions and hope that helps clarify."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452036340, "post_id": 34620902, "comment_id": 56991744, "body": "I would qualify your ranges (really everything) in your extract sub. <code>Range(Cells(i, 1), Cells(i, 26)).Copy</code> can refer to anything even if it looks like it&#39;s working. Other than that, I am out of ideas :/ Going home. Edit: also, do you really need formatting? If not, set ranges to each other... someone wrote code for me that works amazingly well. Will dig up tomorrow."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452036867, "post_id": 34620902, "comment_id": 56991912, "body": "@findwindow Thanks. I appreciate all the effort Going home too. :)"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452108305, "post_id": 34620902, "comment_id": 57027784, "body": "@findwindow I figured out the issue. It was not anything with the code (per se). See my answer. Thank you for all the help and effort you put into this."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452274183, "post_id": 34620902, "comment_id": 57111485, "body": "@findwindow found the answer."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452274243, "post_id": 34620902, "comment_id": 57111519, "body": "@Fadi Figured it out. Thank you and findwindow for all the assistance."}], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452032960, "post_id": 34622291, "comment_id": 56990346, "body": "@ Fadi Variable &#39;i&#39; is not defined"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452033118, "post_id": 34622291, "comment_id": 56990431, "body": "@IronMan, ok i change it, try it again"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452033326, "post_id": 34622291, "comment_id": 56990517, "body": "This did not work either. This is a tough one. So, how do I run the Remove Duplicates code and then immediately check the cells in column AD where there is data in the row from columns A through Z only, and delete the &#39;invisible&#39; contents in AD?"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452033693, "post_id": 34622291, "comment_id": 56990700, "body": "@IronMan, sorry,if this did not work , I don&#39;t know other way to check if the cells contain invisible data."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452034033, "post_id": 34622291, "comment_id": 56990847, "body": "No apologies. Thanks for trying. I appreciate the effort."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 1, "creation_date": 1452034236, "post_id": 34622291, "comment_id": 56990946, "body": "@IronMan, I hope someone can help us to know what is the problem."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452108230, "post_id": 34622291, "comment_id": 57027744, "body": "I figured it out. Please see answer above. Even though this is not a VBA code issue, I feel that this question and answer still bring value to this site as sometimes you need to look beyond the code when there is an issue, even when it looks as though it is the code that appears to be the problem."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 1, "creation_date": 1452544565, "post_id": 34622291, "comment_id": 57207313, "body": "I used the code you provided as a call in the Remove_Duplicates sub. This has done the trick and works instantly."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1452545407, "post_id": 34622291, "comment_id": 57207782, "body": "@IronMan, thank you, I have similar problem and really want to know what is the reason of this problem, but i&#39;m not using filter at all, maybe someday I will add a new question, but now I can&#39;t do that because my code is very long."}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 1, "last_activity_date": 1452033017, "last_edit_date": 1452033017, "creation_date": 1452032544, "answer_id": 34622291, "question_id": 34620902, "link": "https://stackoverflow.com/questions/34620902/code-to-remove-null-values/34622291#34622291", "title": "Code to remove &#39;NULL&#39; values", "body": "<p>test this code:</p>\n\n<pre><code>Sub test()\n\nDim LastRow As Long\ndim i as long\nLastRow = 100 'change this to the last row (if it work)\nApplication.EnableEvents = True\n\n For i = 2 To LastRow\n  If Trim(Range(\"AD\" &amp; i).Value) = \"\" Then Range(\"AD\" &amp; i).ClearContents\n Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1452120354, "post_id": 34640040, "comment_id": 57034460, "body": "Cool. As previously mentioned, instead of copy paste, you may consider <a href=\"http://stackoverflow.com/questions/34028430/deleting-via-autofilter-takes-too-long\">this</a>. That answer deserves far more upvotes than it has."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1452121381, "post_id": 34640040, "comment_id": 57034859, "body": "@findwindow I will try that, thanks. And I gave it an upvote (hint...hint) XD."}], "tags": [], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1452104501, "creation_date": 1452104501, "answer_id": 34640040, "question_id": 34620902, "link": "https://stackoverflow.com/questions/34620902/code-to-remove-null-values/34640040#34640040", "title": "Code to remove &#39;NULL&#39; values", "body": "<p>We extract the file from an internal site. It was brought to my attention that the reporting team had changed their preferences in their instance of the reporting tool to export files using Excel XP/2003 version settings. All the code I have compiled was using the same report, but in 2007 and newer formatting. Once this change in preferences was changed for the reporting team to use 2007 and newer for the exports, this issue was corrected. So in the end, the code was fine and there was no ghost. This proves that communication and Change Management are excellent tools. Thanks to everyone who tried to help figure this one out. All your effort is greatly appreciated.</p>\n"}, {"comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1452275546, "post_id": 34682735, "comment_id": 57112339, "body": "that is good, but make sure there is no formulas that return empty string in your used range, because this way will delete them."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1452275900, "post_id": 34682735, "comment_id": 57112553, "body": "@Fadi There are no formula&#39;s in these workbooks, but I will keep that in mind for future reference."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452275903, "post_id": 34682735, "comment_id": 57112561, "body": "Ok i&#39;m sorry I asked you this before and you tell me there is no formula in the workbook, I just forget that."}], "tags": [], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1452274070, "creation_date": 1452274070, "answer_id": 34682735, "question_id": 34620902, "link": "https://stackoverflow.com/questions/34620902/code-to-remove-null-values/34682735#34682735", "title": "Code to remove &#39;NULL&#39; values", "body": "<p>The problem was that there are lots of \"fake empty\" cells in the worksheet. I have not been able to figure out where these came from, but I found this code and integrated it into the Remove_Duplicates sub to <strong>ClearContents</strong>:</p>\n\n<pre><code>Sub Remove_Duplicates()\n'\nApplication.ScreenUpdating = False\n\nDim usedrng As Range\n\n    ActiveSheet.Range(\"$A$1:$Z$2000\").RemoveDuplicates Columns:=Array(10, 11, 12, 13, 14, 15, 16), Header:=xlYes\n\n    For Each usedrng In ActiveSheet.UsedRange\n        If usedrng.Value = \"\" Then\n            usedrng.ClearContents\n        End If\n    Next\n\nRange(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>So now, this code works as intended:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'\nDim r As Range\nSet r = Target.EntireRow\n\n    If Target.row = 1 Then Exit Sub ' Don\u2019t change header color\n\n    If r.Cells(1, \"AD\").Value &lt;&gt; \"\" Then \n        r.Font.Color = RGB(0, 176, 80)\n    Else\n        r.Font.ColorIndex = 1\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thanks to everyone who helped get me to this point.</p>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2720, "favorite_count": 1, "accepted_answer_id": 34622291, "answer_count": 3, "score": 3, "last_activity_date": 1452274070, "creation_date": 1452026684, "last_edit_date": 1531164843, "question_id": 34620902, "link": "https://stackoverflow.com/questions/34620902/code-to-remove-null-values", "title": "Code to remove &#39;NULL&#39; values", "body": "<p>Let me give a quick layout what our process is:</p>\n\n<p>I export a report into Excel (Let's call this workbook \"Raw Data\"). I run an Extract macro on the imported file:</p>\n\n<pre><code>Sub Extract_Sort_1601_January()\n'\nDim ANS As Long\n\nANS = MsgBox(\"Is the January 2016 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\nIf ANS = vbNo Or IsWBOpen(\"Swivel - Master - January 2016\") = False Then\n    MsgBox \"The required workbook is not currently open. Please open the correct file and restart the Extract process. This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n    Exit Sub\nEnd If\n\n    Cells.EntireRow.Hidden = False\n\nApplication.ScreenUpdating = False\n\n    ' This line autofits the columns C, D, O, and P\n    Range(\"C:C,D:D,O:O,P:P\").Columns.AutoFit\n\nDim LR As Long\n\n    For LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n        If Range(\"B\" &amp; LR).Value &lt;&gt; \"1\" Then\n            Rows(LR).EntireRow.Delete\n        End If\n    Next LR\n\nWith ActiveWorkbook.Worksheets(\"Extract\").Sort\n    With .SortFields\n        .Clear\n        .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"D2:D2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"O2:O2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"J2:J2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"K2:K2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Add Key:=Range(\"L2:L2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:Z2000\")\n    .Apply\nEnd With\nCells.WrapText = False\nSheets(\"Extract\").Range(\"A2\").Select\n\n    Dim LastRow As Integer, i As Integer, erow As Integer\n\n    LastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        If Cells(i, 2) = \"1\" Then\n\n            ' As opposed to selecting the cells, this will copy them directly\n            Range(Cells(i, 1), Cells(i, 26)).Copy\n\n            ' As opposed to \"Activating\" the workbook, and selecting the sheet, this will paste the cells directly\n            With Workbooks(\"Swivel - Master - January 2016.xlsm\").Sheets(\"Swivel\")\n                erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                .Cells(erow, 1).PasteSpecial xlPasteAll\n            End With\n            Application.CutCopyMode = False\n        End If\n    Next i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This copies data from the \"extract\" file into another workbook (This workbook is called \"Swivel\"). This part completes successfully. Once this is completed, in the \"Swivel\" workbook, we then run a remove duplicates macro:</p>\n\n<pre><code>Sub Remove_Duplicates()\n'\nApplication.ScreenUpdating = False\n\n    ActiveSheet.Range(\"$A$1:$Z$2000\").RemoveDuplicates Columns:=Array(10, 11, 12, 13, 14, 15, 16), Header:=xlYes\n    ActiveWindow.SmallScroll Down:=6\n\nRange(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Somewhere between the copying of data into the 'Swivel' workbook and running the Remove Duplicates macro, there is a null value (I think) inserted into the cells in column AD in the rows just pasted in. I only know this because this code is running in the worksheet for changes:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'\nDim r As Range\nSet r = Target.EntireRow\n\n    If Target.row = 1 Then Exit Sub ' Don\u2019t change header color\n\n    If r.Cells(1, \"AD\").Value &lt;&gt; \"\" Then \n        r.Font.Color = RGB(0, 176, 80)\n    Else\n        r.Font.ColorIndex = 1\n    End If\nEnd Sub\n</code></pre>\n\n<p>For clarification, here is where the above subs reside:</p>\n\n<p><strong>Extract_Sort_1601_January</strong> is part of an Add-in I created for the \"raw data\" file.</p>\n\n<p><strong>Remove_Duplicates</strong> is in a module in the \"Swivel\" workbook.</p>\n\n<p><strong>WorkSheet_Change</strong> is in the Sheet1 object in the \"Swivel\" workbook.</p>\n\n<ol>\n<li>Data from the reporting site is exported to the \"raw data\" workbook</li>\n<li>Extract_Sort_1601_January copies data into the existing \"Swivel\"\nworkbook (In this case that workbook name is \"Swivel - Master -\nJanuary 2016.xlsm\")</li>\n<li>Remove_Duplicates is initiated on the \"Swivel\" workbook.</li>\n</ol>\n\n<p>If there is no data in column AD of the \"Swivel\" workbook, the text in that row should be black. However, that is not the case after running the Remove Duplicates macro, the text is green. If I go to the 'empty' cell (column AD) in that row and click delete, then the row changes to black text. I also checked to see if there is a space in the cell, but there is not. How do I code the removal of this 'null' value that is making the Worksheet Change sub believe there is a value in the cell? And, can this be added to the 'Remove Duplicates' sub?</p>\n\n<p>Thanks for all the assistance!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 1, "creation_date": 1452027151, "post_id": 34620532, "comment_id": 56987636, "body": "HansUp, thanxs so much.  I&#39;m sincerely grateful for your help."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1452025359, "last_edit_date": 1452025359, "creation_date": 1452025217, "answer_id": 34620532, "question_id": 34620336, "link": "https://stackoverflow.com/questions/34620336/how-to-cycle-through-textbox-controls-access-vba/34620532#34620532", "title": "How to cycle through Textbox Controls Access VBA", "body": "<p><code>pfrm.Controls.visible</code> does not compile because <code>Controls</code> is a collection. <code>Visible</code> is a supported property for members of that collection, but not supported on the collection itself. </p>\n\n<p>Loop through <code>pfrm.Controls</code>, check whether each of them is a <code>Visible</code> text box, and <code>MsgBox</code> the names of those which are ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim ctl As Control\nFor Each ctl In pfrm.Controls\n    If ctl.ControlType = acTextBox And ctl.Visible = True Then\n        MsgBox ctl.Name\n    End If\nNext ctl\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 34620532, "answer_count": 1, "score": 1, "last_activity_date": 1452025439, "creation_date": 1452024427, "last_edit_date": 1452025439, "question_id": 34620336, "link": "https://stackoverflow.com/questions/34620336/how-to-cycle-through-textbox-controls-access-vba", "title": "How to cycle through Textbox Controls Access VBA", "body": "<p>I wanted a code that would cycle thru the names of text box controls on a form whose <code>Visible</code> = true.  I know this code is constructed incorrectly, but I need to ask if anyone can point me in the right direction.</p>\n\n<pre><code>Public Sub TxtBoxNamevisible(ByRef pfrm As Form)\nDim ctl As Control\nDim txtbx As TextBox\n\nFor Each txtbx In pfrm.Controls.visible = true\nMsgBox txtbx.Name\nNext txtbx\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1452025657, "post_id": 34620078, "comment_id": 56986869, "body": "1 - When debugging comment out On Error lines. 2 - Where does item come from?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 1, "creation_date": 1452025964, "post_id": 34620078, "comment_id": 56987003, "body": "Something is weird here - how can you be seeing the window for the forwarded item with calling oMail.Display??"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1452027760, "post_id": 34620078, "comment_id": 56987947, "body": "Are you sure that you have passed an item to the procedure?  And Eric is correct, you shouldn&#39;t see a window if you haven&#39;t used the Display method."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1452031303, "post_id": 34620078, "comment_id": 56989645, "body": "@EricLegault yes, it is wierd because the same thing was working some months back and i didn&#39;t have any problem. The window opens without me having used the display method. Also the item comes from searching my mail box by a subject and then forwarding that item. Thanks."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1452046011, "post_id": 34620078, "comment_id": 56994794, "body": "BTW, you only need the lines of code in that procedure starting with Set oMail - the Class check is redundant as anything but a MailItem param will throw an error in the calling procedure."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1452064278, "post_id": 34620078, "comment_id": 57000402, "body": "When you say - <b>&quot;using vba in excel&quot;</b>, are you running the code in Excel?"}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "edited": false, "score": 0, "creation_date": 1453198220, "post_id": 34620078, "comment_id": 57485794, "body": "That&#39;s just something I found:  <a href=\"https://msdn.microsoft.com/en-us/library/ff458119%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ff458119%28v=office.11%29.a&zwnj;&#8203;spx</a>  Maybe this will help :)"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1452071007, "creation_date": 1452071007, "answer_id": 34629170, "question_id": 34620078, "link": "https://stackoverflow.com/questions/34620078/error-in-forwarding-an-email/34629170#34629170", "title": "Error in forwarding an email", "body": "<p>Try disable error handlers while debugging code.</p>\n\n<p>MSDN  <a href=\"https://msdn.microsoft.com/en-us/library/aa231191%28v=vs.60%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Turning Off Error Handling</a></p>\n\n<pre><code>Option Explicit\nSub ForwardEmail(olItem As Outlook.MailItem)\n    If olItem.class = olMail Then\n        '// Forward Email\n        Set olItem = olItem.Forward\n        '// Append The Subject\n        olItem.Subject = \"BlaBla \" &amp; olItem.Subject\n        '//  Add Recipient\n        olItem.Recipients.Add \"Om3r &lt;i@me.com&gt;\"\n        '// add msg\n        olItem.HTMLBody = \"Have a good day\" + olItem.HTMLBody\n        '// Dispaly or use .Send\n        olItem.Display\n'        olItem.Send\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593307809, "creation_date": 1452023417, "last_edit_date": 1593307809, "question_id": 34620078, "link": "https://stackoverflow.com/questions/34620078/error-in-forwarding-an-email", "title": "Error in forwarding an email", "body": "<pre><code>Sub ForwardEmail(item As Outlook.MailItem)\nDim oMail As MailItem\n\nOn Error GoTo Release\n\nIf item.Class = olMail Then\n    Set oMail = item.Forward\n    oMail.Subject = oMail.Subject\n    oMail.HTMLBody = \"Have a good day.\" &amp; vbCrLf &amp; oMail.HTMLBody\n    oMail.Recipients.Add \"abc@xyz.com\"\nEnd If\n\nRelease:\nSet oMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>Hi, I am trying to forward an email from outlook using vba in excel. I am getting an error in the line   <strong>Set oMail = item.Forward</strong>. I see an outlook window but then it also gives an error saying \"Application defined or object defined error\" . </p>\n\n<p>I am able to compose an email using vba but not forward. I see an forward window but the code stops on the line above and I am not able to add subject and other things. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1452023251, "post_id": 34619976, "comment_id": 56985551, "body": "You could add some additional columns to COUNTIF(col = &quot;Jack&quot;), get a SUMIF (col where col = &quot;Jack&quot;) and write your MEAN against those two."}, {"owner": {"reputation": 365, "user_id": 5749226, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lxxap.jpg?s=128&g=1", "display_name": "GGA", "link": "https://stackoverflow.com/users/5749226/gga"}, "reply_to_user": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1452023429, "post_id": 34619976, "comment_id": 56985663, "body": "but how can i count only the &quot;Jack&quot; in the past 30 days? I can sum the value for the days but for the names?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1452023517, "post_id": 34619976, "comment_id": 56985708, "body": "Have you tried the <a href=\"https://support.office.com/en-us/article/AVERAGEIFS-function-48910C45-1FC0-4389-A028-F7C5C3001690\" rel=\"nofollow noreferrer\">AVERAGEIFS function</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 5749226, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lxxap.jpg?s=128&g=1", "display_name": "GGA", "link": "https://stackoverflow.com/users/5749226/gga"}, "edited": false, "score": 0, "creation_date": 1452023733, "post_id": 34620107, "comment_id": 56985851, "body": "if i write this in my first cell and then try to drag the function to the bottom of the datasets i think the mean would be wrong because the countif would show the total values of jack and the summit the sum of the values in the past 30 days where there is jack, which is different from the total values of jack from the dataset."}, {"owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "reply_to_user": {"reputation": 365, "user_id": 5749226, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lxxap.jpg?s=128&g=1", "display_name": "GGA", "link": "https://stackoverflow.com/users/5749226/gga"}, "edited": false, "score": 0, "creation_date": 1452023779, "post_id": 34620107, "comment_id": 56985882, "body": "That&#39;s why I suggested doing an additional row for the date ranges."}], "tags": [], "owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "is_accepted": false, "score": 0, "last_activity_date": 1452023534, "creation_date": 1452023534, "answer_id": 34620107, "question_id": 34619976, "link": "https://stackoverflow.com/questions/34619976/conditional-mean-calculation-in-excel/34620107#34620107", "title": "Conditional mean calculation in excel", "body": "<p>Add columns for these two fomulas:</p>\n\n<pre><code>=COUNTIF(A1:A4,\"Jack\")\n=SUMIF(A1:A4,\"Jack\",C10:C13)\n</code></pre>\n\n<p>That will give you the count, and it will give you the sum.  With those two you can calculate the mean.\nThat's the basic idea, anyway.\nOf course, you can add another count for the date ranges.  It's all the same sort of thing.</p>\n"}, {"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1452023849, "post_id": 34620181, "comment_id": 56985932, "body": "Damn you are quick! :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1452024022, "last_edit_date": 1452024022, "creation_date": 1452023805, "answer_id": 34620181, "question_id": 34619976, "link": "https://stackoverflow.com/questions/34619976/conditional-mean-calculation-in-excel/34620181#34620181", "title": "Conditional mean calculation in excel", "body": "<p>Try the <a href=\"https://support.office.com/en-us/article/AVERAGEIFS-function-48910C45-1FC0-4389-A028-F7C5C3001690\" rel=\"nofollow noreferrer\">AVERAGEIFS function</a> with the <a href=\"https://support.office.com/en-us/article/edate-function-1586b161-4361-4a6d-939b-9d96eae962a8\" rel=\"nofollow noreferrer\">EDATE function</a> giving you a one month window.</p>\n\n<pre><code>=AVERAGEIFS(C:C, A:A, \"Jack\", B:B, \"&gt;\"&amp;EDATE(TODAY(), -1), B:B, \"&lt;=\"&amp;TODAY())\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/2mt4i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2mt4i.png\" alt=\"averageifs_dated\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1452024133, "post_id": 34620224, "comment_id": 56986101, "body": "While this could work, using &#39;natural&#39; array functions (like AVERAGEIFS) instead of &#39;forced&#39; array functions gives increased performance, is more readable, and is more foolproof (can&#39;t enter the cell and accidentally exit without CSE). Good principle for cases where a &#39;forced&#39; array formula is required, however."}, {"owner": {"reputation": 3093, "user_id": 1741053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qhvrB.jpg?s=128&g=1", "display_name": "Bjorn Stiel", "link": "https://stackoverflow.com/users/1741053/bjorn-stiel"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1452024611, "post_id": 34620224, "comment_id": 56986336, "body": "I concur, forced array formulae are a bit of a double-edged sword (by the way, I like the term &#39;forced&#39; array formula, first time I come across it in all those years...)"}], "tags": [], "owner": {"reputation": 3093, "user_id": 1741053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qhvrB.jpg?s=128&g=1", "display_name": "Bjorn Stiel", "link": "https://stackoverflow.com/users/1741053/bjorn-stiel"}, "is_accepted": false, "score": 1, "last_activity_date": 1452023986, "creation_date": 1452023986, "answer_id": 34620224, "question_id": 34619976, "link": "https://stackoverflow.com/questions/34619976/conditional-mean-calculation-in-excel/34620224#34620224", "title": "Conditional mean calculation in excel", "body": "<p>You can use a nested array formula (Ctrl+Shift+Enter instead of Enter):</p>\n\n<p>=AVERAGE(IF($A$2:$A$15=A2,IF($B$2:$B$15>=TODAY()-30,$C$2:$C$15,\"\"),\"\"))</p>\n"}], "owner": {"reputation": 365, "user_id": 5749226, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lxxap.jpg?s=128&g=1", "display_name": "GGA", "link": "https://stackoverflow.com/users/5749226/gga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 34620181, "answer_count": 3, "score": 0, "last_activity_date": 1452024266, "creation_date": 1452023041, "last_edit_date": 1452023101, "question_id": 34619976, "link": "https://stackoverflow.com/questions/34619976/conditional-mean-calculation-in-excel", "title": "Conditional mean calculation in excel", "body": "<p>I have a dataset organized as following :</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nhi0U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nhi0U.png\" alt=\"My dataset\"></a></p>\n\n<p>The column A is the name</p>\n\n<p>The column B is the date</p>\n\n<p>The column C is the value registered for that person in that day</p>\n\n<p>How can i calculate for the whole dataset a mean of the value of that person in the 30 past days without manually ordering for name and making the mean checking the date?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1452022725, "post_id": 34619801, "comment_id": 56985280, "body": "Have you tried recording a macro?"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1452023042, "post_id": 34619801, "comment_id": 56985434, "body": "Record a macro and then attempt to generalize the code if you need to."}, {"owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "edited": false, "score": 0, "creation_date": 1452028937, "post_id": 34619801, "comment_id": 56988549, "body": "There is no record macro option in my developer tab"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1452096226, "post_id": 34619801, "comment_id": 57020057, "body": "The last release of Office that included a PPT macro recorder was Office 2003."}], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": true, "score": 2, "last_activity_date": 1452036404, "creation_date": 1452036404, "answer_id": 34623104, "question_id": 34619801, "link": "https://stackoverflow.com/questions/34619801/delete-personal-information-from-ppt-documnet-using-vba/34623104#34623104", "title": "Delete personal information from PPT documnet using VBA", "body": "<p>Try:</p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff746376.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/ff746376.aspx</a></p>\n\n<p>This shows how to get a list of all document properties, and an example on how to change one of them.</p>\n"}], "owner": {"reputation": 55, "user_id": 5704672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d1094dc230803537902eb8366c09a87?s=128&d=identicon&r=PG&f=1", "display_name": "change33", "link": "https://stackoverflow.com/users/5704672/change33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 34623104, "answer_count": 1, "score": 0, "last_activity_date": 1452036404, "creation_date": 1452022325, "last_edit_date": 1452022716, "question_id": 34619801, "link": "https://stackoverflow.com/questions/34619801/delete-personal-information-from-ppt-documnet-using-vba", "title": "Delete personal information from PPT documnet using VBA", "body": "<p>I am trying to automate the process of deleting the \"Author\" and \"Last Modified By\" name stamp on a PowerPoint document. If you open MSFT Office document and click \"File\" then \"Info\", on the right hand side it shows \"Related People\" and gives you the name of the Author and whoever modified the document last. </p>\n\n<p>To delete it manually, you would have to go back to file -> info -> check for issues -> inspect document -> make sure all boxes are checked -> click inspect document -> it should come up with a pop-up menu and highlight \"Document properties and personal information\" -> click remove all.</p>\n\n<p>Anyone have any thoughts?</p>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 621, "user_id": 4671894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/478e2a0eeaf1eacc27445dac63c64b76?s=128&d=identicon&r=PG", "display_name": "Ahmed Anwar", "link": "https://stackoverflow.com/users/4671894/ahmed-anwar"}, "edited": false, "score": 0, "creation_date": 1452022245, "post_id": 34619730, "comment_id": 56985038, "body": "I think your question&#39;s incomplete. There&#39;s no &quot;B.)&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1452023096, "post_id": 34619730, "comment_id": 56985462, "body": "Hypothetically speaking, I don&#39;t see this as any different from loading a function from an imported system DLL. If you can import a C level function like FindWindowEx from user32.dll and toss around HWND vars, then loading a collection from an imported custom DLL function should be the same thing. On the other hand, have you considered a custom VBA class?"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1452024655, "post_id": 34619730, "comment_id": 56986363, "body": "I understand VB.NET isn&#39;t VBA, however VBA does have Collection in the object library"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1452024713, "post_id": 34619730, "comment_id": 56986400, "body": "I was referring to the use of the VB.NET tag which states <i>DO NOT USE this tag for VB6, VBA, or VBScript questions.</i>"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1452024744, "post_id": 34619730, "comment_id": 56986416, "body": "Easy there, tex. I&#39;ll remove the tag...."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1452024871, "post_id": 34619730, "comment_id": 56986491, "body": "@Jeeped - I found a workaround with this particular class using recurrence, although I&#39;m leaving this question open in the hope of learning something new"}, {"owner": {"reputation": 797, "user_id": 2756489, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/p7Fwh.png?s=128&g=1", "display_name": "Bennett Yeo", "link": "https://stackoverflow.com/users/2756489/bennett-yeo"}, "edited": false, "score": 0, "creation_date": 1452025329, "post_id": 34619730, "comment_id": 56986715, "body": "Instead of writing a .dll file, you could try <a href=\"https://msdn.microsoft.com/en-us/library/ms233843.aspx\" rel=\"nofollow noreferrer\">serialization</a> and writing to file such as <a href=\"https://msdn.microsoft.com/en-us/library/ms762271(v=vs.85).aspx\" rel=\"nofollow noreferrer\">xml</a>. C#, C++, Visual Basic and VBA and many other programming languages are all capable of reading and de-serializing the object from the xml. This might be an easier solution."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1452025561, "post_id": 34619730, "comment_id": 56986821, "body": "I&#39;m using the DLL as a wrapper for iTextSharp to read and write PDFs from Excel VBA"}], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1452025698, "post_id": 34620609, "comment_id": 56986890, "body": "I was able to workaround using recurrence (The class I&#39;m writing already had Lists that were accessible anyway), but I&#39;m definitely keeping this in mind. Thanks!"}], "tags": [], "owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "is_accepted": true, "score": 1, "last_activity_date": 1452025560, "creation_date": 1452025560, "answer_id": 34620609, "question_id": 34619730, "link": "https://stackoverflow.com/questions/34619730/passing-a-list-from-c-to-vba/34620609#34620609", "title": "Passing a List from C# to VBA", "body": "<p>A) Convert a List into a Collection, can be done:</p>\n\n<pre><code>[ClassInterface(ClassInterfaceType.AutoDual)]\npublic class PdfReaderPage\n{        \n    public int Foo;\n}\n\n[ClassInterface(ClassInterfaceType.AutoDual)]\npublic class AccessibleFromVBA\n{\n    public Microsoft.VisualBasic.Collection PdfReaderPages()\n    {\n        /* 1. make a List of PdfReaderPage elements */\n        var csharp_list = new List&lt;PdfReaderPage&gt;()\n        { \n            new PdfReaderPage() {Foo=1},\n            new PdfReaderPage() {Foo=2},\n            new PdfReaderPage() {Foo=3}\n        };\n        /* 2. convert it into a vb collection */\n        var vb_coll = new Microsoft.VisualBasic.Collection();\n        csharp_list.ForEach(x =&gt; vb_coll.Add(x));\n        /* 3. deliver it */\n        return vb_coll;\n    }\n}\n</code></pre>\n\n<p>There is just one curious thing to observe: In C#, the Collection instance will actually contain one item more than the Count reports, because collections are 0-based in C# and 1-based in VBA, the item at index [0] always contains the static localized string \"empty placeholder to adjust for 1-based array.\"</p>\n"}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "accepted_answer_id": 34620609, "answer_count": 1, "score": 1, "last_activity_date": 1452025560, "creation_date": 1452022062, "last_edit_date": 1452024776, "question_id": 34619730, "link": "https://stackoverflow.com/questions/34619730/passing-a-list-from-c-to-vba", "title": "Passing a List from C# to VBA", "body": "<p>I'm writing a DLL in C# that is to be used in VBA. One method I am writing will get a List of a custom type (PdfReaderPage). My question is this: Can I pass a List of a custom type into a VB Collection? I had this in mind to do</p>\n\n<pre><code>public Microsoft.VisualBasic.Collection GetPageByKeyWord(String keyword)\n{\n    //Do some code to find correct page list\n    //Get List&lt;PdfReaderPage&gt; myList\n    Microsoft.VisualBasic.Collection VbCollection = myList;\n    return VbCollection;\n}\n</code></pre>\n\n<p>Except I'm not sure if I can either A.) Convert a List into a Collection or B.) Am even going at this the best way. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452020647, "post_id": 34619134, "comment_id": 56984084, "body": "Check out <a href=\"https://www.youtube.com/watch?v=CEM0pp5SjMU\" rel=\"nofollow noreferrer\">this video</a>, is that what you&#39;re looking to do?  Or <a href=\"http://trumpexcel.com/2013/11/picture-lookup-in-excel-using-named-ranges/\" rel=\"nofollow noreferrer\">this thread</a>?"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452024732, "post_id": 34619134, "comment_id": 56986411, "body": "That is a way to do it if the images are in the same workbook. I have the pictures in another folder under their respective names but not in a workbook. I was looking to linking that folder somehow to this worksheet. My first thought was a hyperlink but I am stuck."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452025469, "post_id": 34619134, "comment_id": 56986790, "body": "Any reason you can&#39;t just copy them into the workbook on some helper sheet (ie &quot;Images&quot;) and then pull from there? Or are you trying to pull the images from a network location or folder (i.e. C:\\Users\\Me\\Pictures\\myImage.jpg)?"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452026898, "post_id": 34619134, "comment_id": 56987483, "body": "Yes the pictures are on a network drive. I thought it might be easier to do it this way but I might have to copy and paste each picture into the workbook somewhere. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1452026924, "post_id": 34620822, "comment_id": 56987505, "body": "Thank you. I will try it out later and let you know. I appreciate the response."}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 1, "last_activity_date": 1452026393, "creation_date": 1452026393, "answer_id": 34620822, "question_id": 34619134, "link": "https://stackoverflow.com/questions/34619134/import-image-based-on-vlookup-result/34620822#34620822", "title": "import image based on vlookup result", "body": "<p>If you put a picture into your worksheet in the location that you want then you can just use that pictures properties to insert a new picture (after deleting the old one). Alternatively, you could set the size properties as constants. Paste this code into a module:</p>\n\n<pre><code>Const PicturePath = \"C:\\Users\\Public\\Pictures\\Sample Pictures\\\"\nSub ChangePicture(PictureName)\n    Dim p As Picture\n    Dim ptop, pleft, pwidth, pheight\n    On Error GoTo errorhandler\n    For Each p In ActiveSheet.Pictures\n        ptop = p.Top\n        pleft = p.Left\n        pwidth = p.Width\n        pheight = p.Height\n        p.Delete\n    Next p\n\n    ActiveSheet.Pictures.Insert (PicturePath &amp; PictureName)\n\n    For Each p In ActiveSheet.Pictures\n        p.Top = ptop\n        p.Left = pleft\n        p.Width = pwidth\n        p.Height = pheight\n    Next p\n    Exit Sub\n errorhandler:\n    MsgBox \"Error loading file, check the filename to make sure it is valid.\", _\n        vbCritical, \"ChangePicture\"\nEnd Sub\n</code></pre>\n\n<p>then add this code to the worksheet with your picture names</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Target.Value &lt;&gt; \"\" Then\n    ChangePicture Target.Value\nEnd If\nEnd Sub\n</code></pre>\n\n<p>In the worksheet, if you have a list of picture names like</p>\n\n<pre><code> Desert.jpg\n Jellyfish.jpg\n Koala.jpg\n</code></pre>\n\n<p>then when you click on one, the code will run and insert your new picture in place of the old one. This should at least get you started, and you can tweak the code to suit your purposes. Make sure you have a picture in your worksheet, that is the size and position that you want, and then the new picture will be in the same place, and the same size.</p>\n"}], "owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1452026393, "creation_date": 1452019763, "last_edit_date": 1531161705, "question_id": 34619134, "link": "https://stackoverflow.com/questions/34619134/import-image-based-on-vlookup-result", "title": "import image based on vlookup result", "body": "<p>I have a Vlookup set up from a selection in a drop down window. This is easy. What I am finding difficult is once I select a name, I need their image to show up in an area of my worksheet. Any help would be appreciated. I am using Excel 2010. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2035, "user_id": 1768737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6c5d404c916367b21e31a9306de2146?s=128&d=identicon&r=PG&f=1", "display_name": "HCarrasko", "link": "https://stackoverflow.com/users/1768737/hcarrasko"}, "edited": false, "score": 0, "creation_date": 1452020765, "post_id": 34619102, "comment_id": 56984143, "body": "welcome to StackOverflow, please format you code in future questions and add relevant information that help to solve tu problem. Also, leave thanks are not required."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452020969, "post_id": 34619102, "comment_id": 56984272, "body": "I think that <code>&quot;</code> is making the code crashing because it&#39;s a special character, while I&#39;m not sure why <code>?</code> is cutting the rest of the string (it might be related to the <code>Body</code> property of your email object, but it&#39;s the first time I hear about it). However, if you store these characters from the cell to a variable, you shouldn&#39;t have any issue so I think we&#39;re missing a relevant part of code. Can we please have a minimal example to reproduce the error?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452021768, "post_id": 34619102, "comment_id": 56984766, "body": "Try using one of the functions from here: <a href=\"http://stackoverflow.com/questions/218181/how-can-i-url-encode-a-string-in-excel-vba\" title=\"how can i url encode a string in excel vba\">stackoverflow.com/questions/218181/&hellip;</a>"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1452032011, "post_id": 34619102, "comment_id": 56989937, "body": "Do you have to use the <code>ShellExecute</code> command to generate the email? I&#39;ve had lots of success by creating an <code>Outlook</code> object and then creating an email object and adding the body and attachments and such. Working this angle would probably step around your problem here."}, {"owner": {"reputation": 43, "user_id": 5749074, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206449864379739/picture?type=large", "display_name": "Scott Tichenor", "link": "https://stackoverflow.com/users/5749074/scott-tichenor"}, "edited": false, "score": 0, "creation_date": 1452118300, "post_id": 34619102, "comment_id": 57033489, "body": "<code>~?</code> did not work. Sorry."}, {"owner": {"reputation": 43, "user_id": 5749074, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206449864379739/picture?type=large", "display_name": "Scott Tichenor", "link": "https://stackoverflow.com/users/5749074/scott-tichenor"}, "edited": false, "score": 0, "creation_date": 1452119565, "post_id": 34619102, "comment_id": 57034095, "body": "It appears the nitty gritty of what is going on is described on page 4 here:  <a href=\"http://www.ietf.org/rfc/rfc2368.txt\" rel=\"nofollow noreferrer\">link</a>  This article was linked to in the link provided at the end of @stucharo &#39;s solution. It will hopefully make sense to all. I appreciate the help and hope this is usefull to others at some point."}], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": true, "score": 1, "last_activity_date": 1452113137, "last_edit_date": 1452113137, "creation_date": 1452112754, "answer_id": 34642325, "question_id": 34619102, "link": "https://stackoverflow.com/questions/34619102/using-a-string-with-a-from-excel-cell-content-in-visual-basic/34642325#34642325", "title": "Using a String with a ? from Excel cell content in visual basic", "body": "<p>The first header after the address should be preceded by <code>?</code> and there should be no internet unsafe characters.  In VBA, the <code>\"</code> character will end the string and there will be illegal code outside what VBA thinks is the string.</p>\n\n<p>Replacing <code>?</code> and <code>\"</code> with their hex equvalents in your body string should work.</p>\n\n<p>Try:</p>\n\n<pre><code>strBody = Replace(strBody, \"\"\"\", \"%22\") 'to replace the \"\nstrBody = Replace(strBody, \"?\", \"%3F\") 'to replace the ?\n</code></pre>\n\n<p>before you pass <code>strBody</code> to the <code>ShellExecute</code> command.</p>\n\n<p>You can read more about using the <code>mailto:</code> protocol here: <a href=\"https://msdn.microsoft.com/en-us/library/aa767737%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa767737%28v=vs.85%29.aspx</a></p>\n"}], "owner": {"reputation": 43, "user_id": 5749074, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206449864379739/picture?type=large", "display_name": "Scott Tichenor", "link": "https://stackoverflow.com/users/5749074/scott-tichenor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 34642325, "answer_count": 1, "score": 4, "last_activity_date": 1452118254, "creation_date": 1452019648, "last_edit_date": 1452118254, "question_id": 34619102, "link": "https://stackoverflow.com/questions/34619102/using-a-string-with-a-from-excel-cell-content-in-visual-basic", "title": "Using a String with a ? from Excel cell content in visual basic", "body": "<p>I am using </p>\n\n<pre><code>Range(\"$AC\" &amp; Right(ActiveCell.Address, 2)).Value\n</code></pre>\n\n<p>to grab the content of the <code>AC</code> column in the row of the selected cell. The content of the cell is a comment, I want a user to be able to write to include in an email I am generating with my macro. For instance, as of now if you have \"Comment to student 3.\" without the quotes in the cell, it is added to the body of the email. The comment is included in the string <code>strBody</code> and then incorporated in the email using the following two commands (with the target email address stored in <code>strTo</code>):</p>\n\n<pre><code>strURL = strTo &amp; \"&amp;Body=\" &amp; strBody\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ShellExecute 0&amp;, vbNullString, strURL, vbNullString, vbNullString, vbNormalFocus\n</code></pre>\n\n<p>No problems so far. UNLESS the user uses a special character, like a <code>?</code> or a <code>\"</code> in the content of the Excel cell. Using the <code>?</code> cuts the rest of the string off while using a <code>\"</code> creates an error and fails to even generate the email.</p>\n\n<p>So here is the question: Is there a way I can code the grab to format the content of the cell so that a special character is ignored? Or is there a way I can have the user type their comment so that the <code>?</code> is just treated as a <code>?</code>. Note I have tried <code>\\?</code> <code>/?</code> <code>\"?\"</code> <code>\"?</code> <code>'?</code> and even something like <code>Microsoft.Visual.Chr(34)</code>.</p>\n\n<p>EDIT:</p>\n\n<p>@stucharo 's answer below worked great! Thanks. For those asking for a minimal code to see what was going on (it's still kind of a mystery to me as I am just Frankinstein'ing this stuff together) here it is:</p>\n\n<pre><code>Private Declare PtrSafe Function ShellExecute Lib \"shell32.dll\" _\nAlias \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation As String, _\nByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, _\nByVal nShowCmd As Long) As Long\n\nSub EmailStudent()\n    strTo = \"mailto:Address@bmail.com\"\n    strSubject = \"Email Subject\"\n    strBody1 = Range(\"'Sheet1'!A1\")\n    strBody2 = Range(\"'Sheet1'!A2\")\n    strBody3 = Range(\"'Sheet1'!A3\")\n    strBody = strBody1 &amp; \"%0D%0A%0D%0A\" &amp; strBody2 &amp; \"%0D%0A%0D%0A\" &amp; strBody3\n    strBody = Replace(strBody, \"?\", \"%3F\")\n    strURL = strTo &amp; \"&amp;subject=\" &amp; strSubject &amp; \"&amp;Body=\" &amp; strBody\n    ShellExecute 0&amp;, vbNullString, strURL, vbNullString, vbNullString, vbNormalFocus\nEnd Sub\n</code></pre>\n\n<p>The text in A1 A2 and A3 of Sheet1 should be included in the body of an email. You need to have an outlook client running. I included the fix for question marks, if you remove the Replace command and put a question mark in A2, any text after it, including the text in A3, will no longer show up in the email.</p>\n"}, {"tags": ["vba", "excel", "loops", "newline"], "comments": [{"owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "edited": false, "score": 1, "creation_date": 1452018761, "post_id": 34618684, "comment_id": 56983076, "body": "To do as you ask isn&#39;t going to solve your problem.  Will there be more than nine possibilities in a cell?  How does the data wind up in a single cell?  Is there a hidden character that you can use as a delimiter?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1452019814, "post_id": 34618684, "comment_id": 56983615, "body": "You can use <code>Split()</code> to separate the content on the period: combine the first two elements of the array back and then loop over the remaining items adding the required numbers and newline&#39;s"}, {"owner": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "reply_to_user": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "edited": false, "score": 0, "creation_date": 1452182313, "post_id": 34618684, "comment_id": 57064427, "body": "@Tony Large amount of data was exported to multiple spreadsheets and I have no way of accessing original database contents. Number of possibilities ranged from 1 - 50, but most often its within 1-15 range. As far as I know, there&#39;s no hidden character that I could use as a delimiter."}, {"owner": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452182357, "post_id": 34618684, "comment_id": 57064468, "body": "@TimWilliams Thank you for the advice, I&#39;ll look into that way of solving the problem. Will let you know of results."}, {"owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "edited": false, "score": 0, "creation_date": 1452209607, "post_id": 34618684, "comment_id": 57079994, "body": "What do you mean by &quot;blank row&quot;? Does the data remain in the same cell separated by carriage returns, or do you want to split the data to subsequent rows?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 1, "creation_date": 1452182646, "post_id": 34620176, "comment_id": 57064704, "body": "Thanks a lot for this piece of code, its working!  Is it possible to alter the code so that it covers range - e.g. cells A1-A50 and stores in cells B1-B50? (i presume that editing to cover the range is not difficult, but is it possible to store results again in a single cell instead of sorting in cell range?) - The reason I&#39;m asking is because it would be great if we could still keep single cell contents within 1 cell, but just add blank rows after number[.][space][text] @ElbertV"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 0, "creation_date": 1452184354, "post_id": 34620176, "comment_id": 57065977, "body": "Well, I just add some new code to the answer... check it and tell me if it is ok."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 0, "creation_date": 1452184730, "post_id": 34620176, "comment_id": 57066262, "body": "Re-check the answer pls, and see if is what you need."}, {"owner": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 0, "creation_date": 1452189319, "post_id": 34620176, "comment_id": 57069292, "body": "It looks much better now, there&#39;s just one small detail (its totally fine if this is not fixable, but hopefully it is - just let me know pls): If there are 10 elements (1. textA2. textB3. textC4. textD5. textE6. textF7. textG8. textH9. textI10. textJ), after running the code, 9th element looks like this &quot;9. textI1&quot; - it picks up 1 for some reason. If it does not pick up 1, in scenario with e.g. 15 entries, there&#39;s a row with only 1 in it (as 10th element) @ElbertV"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 0, "creation_date": 1452200286, "post_id": 34620176, "comment_id": 57075702, "body": "Ready... when comes with a one more digit in the secuence won&#39;t let a 1"}, {"owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "reply_to_user": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 0, "creation_date": 1452209212, "post_id": 34620176, "comment_id": 57079864, "body": "@TTZD That&#39;s why I asked if there were more than 9 elements.  Do the numbers always start at 1, and are they always sequential?"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1452213395, "post_id": 34620176, "comment_id": 57081138, "body": "Yes with this code it is necessary to be sequential numbers and starting from 1, would be necessary another implementation to take unsorted numbers. If there more than 1000 this code can handle it. Just remember that could be a mess if the string insode the cell is too big. And would be great if you check my answer as the right answer... just saying :)"}, {"owner": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "edited": false, "score": 0, "creation_date": 1452240334, "post_id": 34620176, "comment_id": 57089487, "body": "@ElbertV your answer solved the issue. Much appreciated."}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": true, "score": 0, "last_activity_date": 1452200233, "last_edit_date": 1452200233, "creation_date": 1452023762, "answer_id": 34620176, "question_id": 34618684, "link": "https://stackoverflow.com/questions/34618684/excel-vba-script-to-add-multiple-rows-in-cells-after-number-dot-char/34620176#34620176", "title": "Excel-Vba script to add multiple rows in cells after number + dot char", "body": "<p>Hope this help you: </p>\n\n<pre><code>Sub parsingText()\nDim a 'to store the parsed text\nDim t\nDim myAscii As Integer\n\na = Split(Range(\"A1\"), \".\")\n\nFor t = 1 To UBound(a)\n    myAscii = Asc(Right(a(t), 1)) 'ASCII code of the last char\n    If myAscii &gt;= 48 And myAscii &lt;= 57 Then 'the 0-9 numbers are 48-57 ASCII codes\n        Cells(t, 2).Value = t &amp; \". \" &amp; Left(a(t), Len(a(t)) - Len(t)) 'Take just the text and replace the index counter\n    Else\n        Cells(t, 2).Value = t &amp; \". \" &amp; a(t) 'If the last text has no index (as the 5th)\n    End If\nNext t\n</code></pre>\n\n<p>End Sub</p>\n\n<p><strong>Note</strong>: in <code>Cells(t, 2).Value</code> I use the column B, you can grab any other. And the text ALWAYS has the same format <code>number[.][space][text]</code></p>\n\n<pre><code>RANGE A1: 1. textA2. textB3. textC4. textD5. textE\n</code></pre>\n\n<p>RESULT: </p>\n\n<pre><code>Range B1:   1.  textA\nRange B2:   2.  textB\nRange B3:   3.  textC\nRange B4:   4.  textD\nRange B5:   5.  textE\n</code></pre>\n\n<p>New Edit: As you ask in the comments</p>\n\n<p>Add an big range for the source data.</p>\n\n<pre><code>Sub parsingText()\nDim a 'to store the parsed text\nDim t\nDim myAscii As Integer\nDim rng As Range\nDim R\n\nSet rng = Range(\"A1:A50\")\n\nFor Each R In rng\n    a = Split(R, \".\")\n    For t = 1 To UBound(a)\n        myAscii = Asc(Right(a(t), 1)) 'ASCII code of the last char\n        If t = 1 Then\n            If myAscii &gt;= 48 And myAscii &lt;= 57 Then 'the 0-9 numbers are 48-57 ASCII codes\n                Cells(R.Row, 2).Value = t &amp; \". \" &amp; Left(a(t), Len(a(t)) - Len(t))  'Take just the text and replace the index counter\n            Else\n                Cells(R.Row, 2).Value = t &amp; \". \" &amp; a(t) 'If the last text has no index (as the 5th)\n            End If\n        Else\n            If myAscii &gt;= 48 And myAscii &lt;= 57 Then 'the 0-9 numbers are 48-57 ASCII codes\n                Cells(R.Row, 2).Value = Cells(1, 2).Value &amp; vbCrLf &amp; t &amp; \". \" &amp; Left(a(t), Len(a(t)) - Len(t + 1)) 'Take just the text and replace the index counter\n                'Here the update.\n            Else\n                Cells(R.Row, 2).Value = Cells(1, 2).Value &amp; vbCrLf &amp; t &amp; \". \" &amp; a(t) 'If the last text has no index (as the 5th)\n            End If\n        End If\n    Next t\nNext R\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5749065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb3785b40ffb17df05a00e904cf0d76?s=128&d=identicon&r=PG&f=1", "display_name": "TTZD", "link": "https://stackoverflow.com/users/5749065/ttzd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 1, "accepted_answer_id": 34620176, "answer_count": 1, "score": 0, "last_activity_date": 1452200233, "creation_date": 1452018249, "question_id": 34618684, "link": "https://stackoverflow.com/questions/34618684/excel-vba-script-to-add-multiple-rows-in-cells-after-number-dot-char", "title": "Excel-Vba script to add multiple rows in cells after number + dot char", "body": "<p>Hopefully you'll be able to assist me with the issue that has been causing headaches for quite a while. I'm too much of a rookie in order to figure this out all by myself, so here it goes:</p>\n\n<p>Is there a way to make VBA go through all the cells in column and add a blank row after each number+dot character </p>\n\n<p>Sample data in a cell:\n1. textA2. textB3. textC4. textD5. textE</p>\n\n<p>Desired output after script:<br />\n1. textA <br />\n2. textB <br />\n3. textC <br />\n4. textD <br />\n5. textE <br /></p>\n\n<p>Thank you all.</p>\n"}, {"tags": ["vba", "csv", "save"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1452018713, "creation_date": 1452018713, "answer_id": 34618827, "question_id": 34618668, "link": "https://stackoverflow.com/questions/34618668/save-as-different-file-type/34618827#34618827", "title": "Save as different file type", "body": "<pre><code>Filename := ActiveWorkbook.Path &amp; \"\\\" &amp; Replace(ActiveWorkbook.Name,\".xlsx\", \".csv\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5746906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/780fba48bcc8a05016c43178b98e9a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5746906/jorge"}, "edited": false, "score": 0, "creation_date": 1452077525, "post_id": 34625035, "comment_id": 57007743, "body": "Thank you for your feedback, it did work and allows to apply the code for different file types, good job!"}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 0, "last_activity_date": 1452050659, "last_edit_date": 1452050659, "creation_date": 1452050141, "answer_id": 34625035, "question_id": 34618668, "link": "https://stackoverflow.com/questions/34618668/save-as-different-file-type/34625035#34625035", "title": "Save as different file type", "body": "<p>If you want to make it more failsafe, in case your extension may be xls, xlsm, xlsb, you can do something like this:</p>\n\n<pre><code>Dim parts As Variant\n\nparts = Split(ActiveWorkbook.Name, \".\")\nparts(UBound(parts)) = \"csv\"\n\nActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; _\n    Join(parts, \".\"), FileFormat:=xlCSV, CreateBackup:=False\n</code></pre>\n\n<p>It's probably not 100% bulletproof, although I'm struggling to think of a situation where it would not work as expected.</p>\n"}], "owner": {"reputation": 13, "user_id": 5746906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/780fba48bcc8a05016c43178b98e9a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/5746906/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5574, "favorite_count": 1, "accepted_answer_id": 34625035, "answer_count": 2, "score": 1, "last_activity_date": 1565587897, "creation_date": 1452018180, "last_edit_date": 1550351352, "question_id": 34618668, "link": "https://stackoverflow.com/questions/34618668/save-as-different-file-type", "title": "Save as different file type", "body": "<p>I would like to make my macro able to save a xlsx file as csv exactly with the same name when running it.</p>\n\n<p>This is what I tried: </p>\n\n<pre><code>ActiveWorkbook.saveas Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; _\n    ActiveWorkbook.Name &amp; \".csv\", FileFormat:=xlCSV, CreateBackup:=False\n</code></pre>\n\n<p>However, it saves the file as .xlsx.csv (i.e, a file called prices.xlsx is saves as prices.xlsx.csv)\nHow could I save the file with a different file extension, without the .xlsx?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11, "user_id": 5749025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af44099c76d7453598af2dbbc825ff12?s=128&d=identicon&r=PG&f=1", "display_name": "cairnswk", "link": "https://stackoverflow.com/users/5749025/cairnswk"}, "edited": false, "score": 0, "creation_date": 1452417548, "post_id": 34618626, "comment_id": 57153406, "body": "Below is the code I found that worked for what I wanted to do."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5749025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af44099c76d7453598af2dbbc825ff12?s=128&d=identicon&r=PG&f=1", "display_name": "cairnswk", "link": "https://stackoverflow.com/users/5749025/cairnswk"}, "is_accepted": false, "score": 0, "last_activity_date": 1452418945, "last_edit_date": 1452418945, "creation_date": 1452418288, "answer_id": 34703935, "question_id": 34618626, "link": "https://stackoverflow.com/questions/34618626/display-message-label-on-form-when-form-goes-into-edit-mode/34703935#34703935", "title": "Display Message Label on form when form goes into EDIT mode", "body": "<p>Below is the code I found that works for what I wanted to do. There are also a few little font and forecolor codes in the label.</p>\n\n<p>On the firm I also created a label so I could determine what value was being updated from the combo box.</p>\n\n<p>Create this code on the actual combo box itself on the AfterUpdate event</p>\n\n<pre><code>Private Sub ActivityCriteria_AfterUpdate()\n'Create a label and show in the label what is being selected on the label caption\nAcMessage.ForeColor = vbRed\n'vbCrLf equals line break\nAcMessage.Caption = \"Value passed: \" &amp; vbCrLf &amp; ActivityCriteria.Text\nAcMessage.FontWeight = Heavy\n\n'Run If statement to determine the value of the combo list\nIf Me.ActivityCriteria.Text() = \"IA - Individual Assist\" Then\n'Provide the options if the statement is true\nAcMessage.ForeColor = vbBlue\nAcMessage.FontWeight = Heavy\nMe.IndividualName.Visible = True\nMe.MemberOrgName.Visible = False\nMe.ExtOrganisationName.Visible = False\n\n    'Ask the ElseIf statement to determine next value from the combo list\n    ElseIf Me.ActivityCriteria.Text() = \"MA - Members Assisted\" Then\n    'Provide the options if the statement is true\n    AcMessage.ForeColor = vbMagenta\n    AcMessage.FontWeight = Heavy\n    Me.IndividualName.Visible = False\n    Me.MemberOrgName.Visible = True\n    Me.ExtOrganisationName.Visible = False\n\n        'Another ElseIf statement to determine next value from the combo list\n        ElseIf Me.ActivityCriteria.Text() = \"CA - Community Assisted\" Then\n        'Provide the options for this statement if true\n        AcMessage.ForeColor = RGB(255, 128, 0)\n        AcMessage.FontWeight = Heavy\n        Me.IndividualName.Visible = False\n        Me.MemberOrgName.Visible = False\n        Me.ExtOrganisationName.Visible = True\n\n            'Otherwise in all other cases\n            Else\n            'Do this option\n            AcMessage.ForeColor = RGB(138, 43, 266)\n            AcMessage.FontWeight = Heavy\n            Me.IndividualName.Visible = False\n            Me.MemberOrgName.Visible = False\n            Me.ExtOrganisationName.Visible = False\n    End If\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<p>After spending several days on this it appears to work well, and I hope it will help someone else or at lease give them ideas of what is possible.</p>\n"}], "owner": {"reputation": 11, "user_id": 5749025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af44099c76d7453598af2dbbc825ff12?s=128&d=identicon&r=PG&f=1", "display_name": "cairnswk", "link": "https://stackoverflow.com/users/5749025/cairnswk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452419783, "creation_date": 1452018068, "last_edit_date": 1452419783, "question_id": 34618626, "link": "https://stackoverflow.com/questions/34618626/display-message-label-on-form-when-form-goes-into-edit-mode", "title": "Display Message Label on form when form goes into EDIT mode", "body": "<p>I have a form that allows data entry with an EDIT button on it.</p>\n\n<p>When the EDIT button is pressed, the form goes into edit mode, but I would like to have a label or similar ON the form that becomes visible displaying \"EDIT MODE\".</p>\n\n<p>I'm new to Access events and VBA etc so any help would be greatly appreciated, thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452018067, "post_id": 34618342, "comment_id": 56982675, "body": "Do you have multiple recordsets open?  If Yes you could put them in an array and use the array index to specify which one you want.  Or use a Dictionary."}, {"owner": {"reputation": 968, "user_id": 1028115, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/77466223bbaf32481cbb412f574667b3?s=128&d=identicon&r=PG", "display_name": "Matthew Walk", "link": "https://stackoverflow.com/users/1028115/matthew-walk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452018959, "post_id": 34618342, "comment_id": 56983181, "body": "Really?  Interesting.  You can have an array or dictionary of type ADBO.Recordset in VBA?  Sounds like that could work... let me see."}], "owner": {"reputation": 968, "user_id": 1028115, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/77466223bbaf32481cbb412f574667b3?s=128&d=identicon&r=PG", "display_name": "Matthew Walk", "link": "https://stackoverflow.com/users/1028115/matthew-walk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452017056, "creation_date": 1452017056, "last_edit_date": 1531164843, "question_id": 34618342, "link": "https://stackoverflow.com/questions/34618342/can-a-vba-additem-command-refer-to-variable-recordset", "title": "Can a VBA .additem command refer to variable Recordset?", "body": "<p>In the code example below, can the \"local_Manufacturer\" ADBO.Recordset object somehow be replaced by a variable name?  I've tried to replace it with a string that matches the name of the ADBO.Recordset I want to use, but it gives a compile error stating that the \"Qualifier must be a collective\". </p>\n\n<pre><code>With Me.Controls(\"Manufacturer\")\n    .Clear\n    Do\n        .AddItem local_Manufacturer![Manufacturer]\n        local_Manufacturer.MoveNext\n        Loop Until local_Manufacturer.EOF\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452016145, "post_id": 34617881, "comment_id": 56981624, "body": "Where does the error occur?"}, {"owner": {"reputation": 27, "user_id": 5729203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae13d8494824387fd495bf3c496460?s=128&d=identicon&r=PG&f=1", "display_name": "K. Sante", "link": "https://stackoverflow.com/users/5729203/k-sante"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452036680, "post_id": 34617881, "comment_id": 56991859, "body": "The error occur at the end of the first do until loop. I want to parse the data from the first to when another surface is found in the data. Thank you"}], "owner": {"reputation": 27, "user_id": 5729203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ae13d8494824387fd495bf3c496460?s=128&d=identicon&r=PG&f=1", "display_name": "K. Sante", "link": "https://stackoverflow.com/users/5729203/k-sante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452016142, "creation_date": 1452015345, "last_edit_date": 1452016142, "question_id": 34617881, "link": "https://stackoverflow.com/questions/34617881/organise-data-from-csv", "title": "Organise data from CSV", "body": "<p>I have this csv file which I want to organize into a struct. I am measuring some surfaces and under every surface there are sections and under every section there are a number of runs. I want to extract every elements from the first surface until the next surface and so on, until the data is grouped according the number of surfaces that appear in the data. I want to write a general code that will parse data from measurement that will be taken.  Now, my code for the surfaces can only store the last elements under each surface and tell me \"subscript out of range. I am stacked and I need help. below are the data and code so far. Thank you</p>\n\n<pre><code>SURFACE\nSECTION\nRUN\n-0.07764007\n0.07762\n42\n0.07801\n-0.07747896\n0.07744\n-0.07753022\n0.07759\n-0.07729586\n0.07747\n-0.07753753\n0.07741\n-0.07742768\nRUN\n-0.077435\n0.07747\n-0.07757416\n0.07726\n-0.07761077\n0.07756\n-0.07750092\n-57\n-0.07712009\n0.07771\n-0.07769133\n0.07769\n-0.07713472\n0.07733\n-0.07726657\n0.0774\n-0.07731783\n0.07743\n-0.07754486\n0.07752\n-0.07755219\n0.07745\n-0.07723726\nSECTION\nRUN\n-0.07785247\n0.07765\n-0.07742036\n-0.0776\n-0.07742036\n0.07747\n-0.07729586\n0.07741\n-0.07744966\n0.07724\n-0.07753753\n0.0773\n-0.07747896\n0.07759\n-0.07746429\n0.07771\nSURFACE\nSECTION\nRUN\n-0.07753753\n0.07786\n-0.07729586\n0.07743\n-0.07762542\n0.07763\n-0.07723726\n0.07735\n-0.077955\n-71\n-0.07681249\n0.07727\n-0.0775229\n0.07733\n-0.07747896\n0.07738\n-0.07714205\n0.07746\n-0.07737642\n0.07744\n-0.07761809\n0.07727\n-0.07755951\n0.07754\n-0.07792571\n</code></pre>\n\n<p>code </p>\n\n<pre><code> Sub report()\n\n Dim FilePath As String, LineFromFile As Variant, LineItems As Variant\n Dim SURF() As Variant\n\n Dim surface As String, Section As String, run As String\n Dim DATA() As Variant, counter_surf  As Long, counter_sect As Long   \n Dim Snumbs() As Variant, j As Long, S As Integer, i As Long, q As Long\n Dim n As Long, m As Long, counter As Long\n Dim Endoffileflag As Boolean, errorflag As Boolean\n\n\n\nsurface = \"SURFACE\"\nSection = \"SECTION\"\nrun = \"RUN\"\ncounter = 0\ncounter_surf = 0\ncounter_sect = 0\ncounter_run = 0\nEndoffileflag = False\nerrorflag = False\n\nFilePath = Application.GetOpenFilename(\"Cvv Files (*.csv), *.csv\")\n\n\nOpen FilePath For Input As #1\n\nDo Until EOF(1)\nLine Input #1, LineFromFile\n\nLineItems = Split(LineFromFile, \",\")\n\n\n\n\nFor i = LBound(LineItems) To UBound(LineItems)\n\n\nReDim Preserve DATA(i)\n\nDATA(i) = Mid(LineItems(i), 2, Len(LineItems(i)) - 2)\n\nIf DATA(i) &lt;&gt; surface And DATA(i) &lt;&gt; Section And DATA(i) &lt;&gt; run Then\nDATA(i) = CDbl(DATA(i))\nEnd If\nActiveCell.Offset(i).Value = DATA(i)\nNext i\n\nLoop\n\n'For j = LBound(DATA) To UBound(DATA)\n Do\n\nIf DATA(counter) = surface Then\nReDim Preserve SURF(counter_surf)\n'If DATA(j + 1) &lt;&gt; surface Then\n Do\n\n  SURF(counter_surf) = DATA(counter)\n  counter = counter + 1\n Loop Until DATA(counter) = surface And counter &lt;= UBound(DATA)\n 'End If\n    'counter = counter + 1\n\n End If\n counter_surf = counter_surf + 1\nLoop Until counter &gt;= UBound(DATA)\n'Next j\nClose #1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1089, "user_id": 746845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de7558eef3e153f0f69e99717932c8bc?s=128&d=identicon&r=PG", "display_name": "emsworth", "link": "https://stackoverflow.com/users/746845/emsworth"}, "edited": false, "score": 0, "creation_date": 1452014500, "post_id": 34617417, "comment_id": 56980608, "body": "Can you elaborate on what the expected behavior is and what the actual output is?  Does the script fail, output the wrong info, something else?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1452014393, "creation_date": 1452014393, "answer_id": 34617564, "question_id": 34617417, "link": "https://stackoverflow.com/questions/34617417/5941-error-the-requested-member-of-the-collection-does-not-exist-word-macro/34617564#34617564", "title": "5941 Error The requested member of the collection does not exist Word Macro", "body": "<p>The error is telling you that the bookmark SerialNumber does not exist in the document. If you select the place in the document (or template) and insert a bookmark with that name it should solve the problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 5748768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1214337591927499/picture?type=large", "display_name": "Dwayne Bellot", "link": "https://stackoverflow.com/users/5748768/dwayne-bellot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3712, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459260941, "creation_date": 1452013961, "last_edit_date": 1459260941, "question_id": 34617417, "link": "https://stackoverflow.com/questions/34617417/5941-error-the-requested-member-of-the-collection-does-not-exist-word-macro", "title": "5941 Error The requested member of the collection does not exist Word Macro", "body": "<p>Good Day all. I'm far from a programmer however i need assistance finding out the error with this VBA script. It is run in a word document for repair order form. Its purpose is to increase the order number by one for each print. The counter updates a .txt file To identify the next number needed to print. That as far as my understanding goes. The code is below.</p>\n\n<pre><code>Sub serialNumberPrint()\n'\n' SerialNumber Macro\n'\n'\nDim Message As String, Title As String, Default As String, NumCopies As Long\nDim Rng1 As Range\n\n' Set prompt.\nMessage = \"Enter the number of copies that you want to print\"\n' Set title.\nTitle = \"Print\"\n' Set default.\nDefault = \"1\"\n\n' Display message, title, and default value.\nNumCopies = Val(InputBox(Message, Title, Default))\nSerialNumber = System.PrivateProfileString(\"C:\\Users\\GaleR\\Documents\\SettingsSerial.Txt\", _\n\"MacroSettings\", \"SerialNumber\")\n\nIf SerialNumber = \"\" Then\n    SerialNumber = 1\nEnd If\n\nSet Rng1 = ActiveDocument.Bookmarks(\"SerialNumber\").Range\nCounter = 0\n\nWhile Counter &lt; NumCopies\n    Rng1.Delete\n    Rng1.Text = Format(SerialNumber, \"000#\")\n    ActiveDocument.PrintOut\n    SerialNumber = SerialNumber + 1\n    Counter = Counter + 1\nWend\n\n'Save the next number back to the Settings.txt file ready for the next use.\nSystem.PrivateProfileString(\"C:\\Users\\GaleR\\Documents\\SettingsSerial.txt\", \"MacroSettings\", _\n        \"SerialNumber\") = SerialNumber\n\n'Recreate the bookmark ready for the next use.\nWith ActiveDocument.Bookmarks\n    .Add Name:=\"SerialNumber\", Range:=Rng1\nEnd With\n\nActiveDocument.Save\n\n\nEnd Sub\n</code></pre>\n\n<p>The debug brings me to this line:</p>\n\n<pre><code> Set Rng1 = ActiveDocument.Bookmarks(\"SerialNumber\").Range\n</code></pre>\n\n<p>I am at wits end and am not sure how to proceed. I apologize beforehand for my lack of knowledge but really do need the assistance.</p>\n"}, {"tags": ["javascript", "vba", "excel", "internet-explorer-11"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452014376, "post_id": 34617352, "comment_id": 56980521, "body": "I dont think the tab is the trigger, it will be exiting the text box, page.getElementsByName(&quot;ZipCode&quot;).Item(0).innerText=&quot;12345&quot; &amp; poss Chr() for tab??? or exit the control???"}, {"owner": {"reputation": 449, "user_id": 1965524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z38Yc.jpg?s=128&g=1", "display_name": "drognisep", "link": "https://stackoverflow.com/users/1965524/drognisep"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452014857, "post_id": 34617352, "comment_id": 56980856, "body": "I think I understand, so you think the event is triggered by exiting that field. If so, how do I get focus, add the data, and exit the field? The code you have is essentially equivalent to what I have above with the same results: the number is entered, but it doesn&#39;t respond to the entry or the tab."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452014931, "post_id": 34617352, "comment_id": 56980907, "body": "You don&#39;t need to use <code>SendKeys()</code> at all for this, you need to learn how to use the DOM object - can you provide the source code for the form you&#39;re trying to complete? @Nathan_Sav fyi - you can use the <code>vbTab</code> constant for a tab ;)"}, {"owner": {"reputation": 449, "user_id": 1965524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z38Yc.jpg?s=128&g=1", "display_name": "drognisep", "link": "https://stackoverflow.com/users/1965524/drognisep"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1452016858, "post_id": 34617352, "comment_id": 56982030, "body": "@MacroMan I&#39;ve posted the source for that particular field and linked to the page in the edit."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1452080220, "post_id": 34617352, "comment_id": 57009354, "body": "Cheers @MacroMan, i wasnt writing the code, just trying to stir some thoughts with OP :)"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530382149, "creation_date": 1530382149, "answer_id": 51117380, "question_id": 34617352, "link": "https://stackoverflow.com/questions/34617352/how-to-trigger-a-specific-web-page-event-with-a-vba-macro/51117380#51117380", "title": "How to trigger a specific web page event with a vba macro", "body": "<p>It would help if you showed more HTML from the site and explained why TAB was necessary? If you are selecting another field then reference that element directly.</p>\n\n<p>For the element you are showing, it has an id so use it:</p>\n\n<pre><code>page.getElementById(\"ZipCode\").innerText = \"myValue\"\n</code></pre>\n\n<p>There is no javascript to trigger on that element.</p>\n"}], "owner": {"reputation": 449, "user_id": 1965524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z38Yc.jpg?s=128&g=1", "display_name": "drognisep", "link": "https://stackoverflow.com/users/1965524/drognisep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1530382149, "creation_date": 1452013783, "last_edit_date": 1531164843, "question_id": 34617352, "link": "https://stackoverflow.com/questions/34617352/how-to-trigger-a-specific-web-page-event-with-a-vba-macro", "title": "How to trigger a specific web page event with a vba macro", "body": "<p>Let me start off by saying that I have VERY limited knowledge of web development, so please correct me if I'm wrong about what's going on here. </p>\n\n<p>What I'm trying to accomplish is to duplicate the manual use of <a href=\"https://www.titleclose.com/Consumer/Welcome\" rel=\"nofollow\">this</a> form - specifically entering the zip code and pressing TAB - with VBA.</p>\n\n<p>I'm able to create a new IE instance and navigate to the page with this function:</p>\n\n<pre><code>' Get reference to (maybe) already initialized reference\nPublic Function getSite(url As String) As InternetExplorer\n    Dim oShell As Object\n\n    ' curIE is declared as \"Private curIE As InternetExplorer\" at module level\n    If curIE Is Nothing Then\n      Set curIE = New InternetExplorer\n      curIE.Visible = True\n      curIE.navigate url\n      Set oShell = CreateObject(\"WScript.Shell\")\n\n      ' Probably redundant, could I get some clarification on this?\n      While (curIE.readyState &lt;&gt; READYSTATE_COMPLETE) Or curIE.Busy ' Wait until it has settled and loaded\n\n      Wend\n\n      ' Maximize the window\n      Application.Wait Now + TimeValue(\"00:00:01\")\n      oShell.SendKeys \"% \"\n      Application.Wait Now + TimeValue(\"00:00:01\")\n      oShell.SendKeys \"x\"\n      Set getSite = curIE\n    Else\n      If curIE.LocationURL &lt;&gt; url Then\n        curIE.navigate url\n      End If\n\n      Set getSite = curIE\n    End If\nEnd Function\n</code></pre>\n\n<p>And I can get the <code>ZipCode</code> element with this snippet, but I can't seem to do the actual work of entering data:</p>\n\n<pre><code>Dim page As HTMLDocument: Set page = getSitePage(curIE.LocationURL) 'Does the work of the GetSite function and gets the document\nDim oShell As Object: Set oShell = CreateObject(\"WScript.Shell\")\n\nApplication.Wait Now + TimeValue(\"00:00:01\") 'Seems to help prevent timing issues, is there a better way?\n\npage.getElementsByName(\"ZipCode\").Item(0).Click\noShell.SendKeys \"12345{TAB}\"\n</code></pre>\n\n<p>I've tried just setting the <code>Value</code> property of that element and using <code>oShell.SendKeys</code> to send a tab, but the field doesn't seem to get focus when its value is set in this way. This is the key part right here, because it would be WAY too time consuming to create a look up function for every county in every state, when I know the site can perform the look up itself.</p>\n\n<p>If there's a way to work with the javascript or whatever backing logic is performing the function I'm trying to trigger and someone can show me how, that would be grand. Thanks SO!</p>\n\n<p><strong>EDIT:</strong> Here's the source for the ZipCode field that I'm trying to interact with:</p>\n\n<pre><code>&lt;input name=\"ZipCode\" class=\"form-control input-lg valid\" id=\"ZipCode\" aria-invalid=\"false\" aria-required=\"true\" aria-describedby=\"ZipCode-error\" type=\"text\" placeholder=\"Zip Code (Required)\" value=\"\" data-val-required=\"Zip Code is required\" data-val=\"true\" data-val-regex-pattern=\"^\\d{5}(-\\d{4})?$\" data-val-regex=\"Zip Code format is not valid\" autocomplete=\"false\"&gt;\n</code></pre>\n\n<p>And I don't want to clutter up this post with the whole source, but it can be found <a href=\"https://www.titleclose.com/Consumer/Welcome\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": ["excel", "vba", "outlook", "range"], "owner": {"reputation": 11, "user_id": 5748727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d8b1dd09df4f36d850a056b169a272?s=128&d=identicon&r=PG&f=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/5748727/josh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1595046735, "creation_date": 1452013714, "last_edit_date": 1595046735, "question_id": 34617336, "link": "https://stackoverflow.com/questions/34617336/pasting-an-image-to-outlook-2013-using-vba-through-late-binding-produces-a-small", "title": "Pasting an image to Outlook 2013 using VBA through Late Binding produces a small image", "body": "<p>I am using the technique found <a href=\"https://stackoverflow.com/questions/29092999/pasting-an-excel-range-into-an-email-as-a-picture\">here</a> to paste a range as a picture into Outlook.</p>\n<p>As users are on different versions of Office, we must use late binding techniques.</p>\n<p>When the image is pasted, it is much smaller than the original.</p>\n<p>When you manually paste the image, it is pasted as its original size.</p>\n<p>I have tried different pasting methods. Is there is a work-around for this?</p>\n<p>Small Image<br />\n<a href=\"https://i.stack.imgur.com/illvI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/illvI.png\" alt=\"enter image description here\" /></a></p>\n<p>Original Size Image<br />\n<a href=\"https://i.stack.imgur.com/COaw4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/COaw4.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "edited": false, "score": 0, "creation_date": 1452268197, "post_id": 34652586, "comment_id": 57107372, "body": "Thanks Kathara. What you&#39;re saying makes perfect sense. Hopefully with updates 2016&#39;s VBA editor gets better over time, but they need some drastic improvements to get to where they were in 2011&#39;s version."}, {"owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "reply_to_user": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "edited": false, "score": 0, "creation_date": 1452268398, "post_id": 34652586, "comment_id": 57107518, "body": "No problem. I have had some problems with vba on mac myself and sometimes it really gets frustrating. Up until now I haven&#39;t heard the best of office 2016 (I think for windows) as it seemed that there are a lot of bugs. It would be cool if they could upgrade the functionality of vba on Mac with this version. But I guess we just have to wait and see :) Good luck with your codes anyway."}], "tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 0, "last_activity_date": 1452161945, "creation_date": 1452161945, "answer_id": 34652586, "question_id": 34617291, "link": "https://stackoverflow.com/questions/34617291/can-excel-2011-and-excel-2016-work-from-the-same-macro-workbook-source-on-osx/34652586#34652586", "title": "Can Excel 2011 and Excel 2016 work from the same macro workbook source on OSX?", "body": "<p>I think I have to disappoint you. I don't think this is possible especially because with every change of version (from 2000 to 2003 to 2010 to 2013) there have always been changes in the vba coding. On Mac this is even a bigger issue as they have added and reduced the functionalities over and over again. Also a lot of code that works on office for windows is not working on Mac as the functionality of the Mac OS and the Windows OS are completely different. I have been working on office for Mac 2011 for about 4 months with vba and it has been really hard to create some codes which on windows would have worked easily.</p>\n\n<p>Also would I not recommend doing what you want as functions which may have worked on 2011 may not work on 2016 as they have changed/deletet/recreated functions when changing the Office-Versions before. So this might provide a huge resource for errors.</p>\n\n<p>If I'm wrong with all this I will be happy to learn otherwise :)</p>\n\n<p>But as I said, this is just my point of view and maybe someone more experienced might help you out with a solution.</p>\n"}], "owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1086, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593729035, "creation_date": 1452013584, "last_edit_date": 1593729035, "question_id": 34617291, "link": "https://stackoverflow.com/questions/34617291/can-excel-2011-and-excel-2016-work-from-the-same-macro-workbook-source-on-osx", "title": "Can Excel 2011 and Excel 2016 work from the same macro workbook source on OSX?", "body": "<p>This may be extremely specific, but I use macros a lot in my job. We recently got Excel 2016 for Mac in my office, which is universes better than Excel 2011 except for the VBA editor which has taken a huge hit in functionality and ease of use.</p>\n\n<p>Lately, I've been editing macros using my Excel 2011 personal macro workbook then copy/pasting all code over to my Excel 2016 personal macro workbook, which can be a hassle and is prone to error at some point in the future. Is it possible to have 2011 and 2016 source from the same personal macro workbook, so that when I edit in 2011, it automatically changes what is used in 2016?</p>\n\n<p>If someone has a solution for this, this could also potentially be a great way to share regularly updated macros among co-workers.</p>\n"}, {"tags": ["vba", "excel", "line"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1452012718, "post_id": 34616903, "comment_id": 56979433, "body": "A good start point would be to do it in Excel recording it as a macro, then inspect the code and apply accordingly"}, {"owner": {"reputation": 1400, "user_id": 215452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hsWhj.jpg?s=128&g=1", "display_name": "bhs", "link": "https://stackoverflow.com/users/215452/bhs"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452012891, "post_id": 34616903, "comment_id": 56979538, "body": "Can I record a macro that will select all lines only ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1452013170, "post_id": 34616903, "comment_id": 56979734, "body": "1. iterate through all shapes, 2. test if shape is line, 3. do code, 4. loop."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1452549431, "post_id": 34616903, "comment_id": 57209999, "body": "Do any of the SmartArt Styles which you can apply to the org chart have lines without shadows? I&#39;m using Excel 2016 for Windows, and none of the styles have shadows on the lines, so I suspect you&#39;re using Mac Excel, which includes shadows on all of its charts by default."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1452549686, "post_id": 34616903, "comment_id": 57210147, "body": "I&#39;d also use <code>Line.Shadow.Visible = False</code> instead of messing with transparency."}], "answers": [{"comments": [{"owner": {"reputation": 1400, "user_id": 215452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hsWhj.jpg?s=128&g=1", "display_name": "bhs", "link": "https://stackoverflow.com/users/215452/bhs"}, "edited": false, "score": 1, "creation_date": 1452014951, "post_id": 34617173, "comment_id": 56980920, "body": "I&#39;m not sure how this is going to format but it turned out all of the shapes were grouped so I went with this that works. Thank you for the pointer though. Much appreciated.                                                                    Sub RemoveLineShadows() For Each Shp In ORG.Shapes If Shp.Type = msoGroup Then For X = 1 To Shp.GroupItems.Count  If Shp.GroupItems(X).Type = msoLine Then  Shp.GroupItems(X).Shadow.Transparency = 1#  End If  Next X  End If Next Shp End Sub"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1452015076, "last_edit_date": 1452015076, "creation_date": 1452013237, "answer_id": 34617173, "question_id": 34616903, "link": "https://stackoverflow.com/questions/34616903/remove-a-shadow-from-all-lines/34617173#34617173", "title": "Remove a shadow from all lines", "body": "<p>This should do the trick - it loops through all shapes, checks if they're a line, then removes the shadow.</p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nDim shapeObj\nFor Each shapeObj In ActiveSheet.Shapes\n    If shapeObj.Type = 9 Then\n        Dim objName$\n        objName = shapeObj.Name\n        ws.Shapes.Range(Array(objName)).Shadow.Visible = msoFalse\n    End If\nNext shapeObj\n\nEnd Sub\n</code></pre>\n\n<p>Edit: Turns out, per OP, the shapes are grouped, so he used this to get it:</p>\n\n<pre><code>Sub RemoveLineShadows()\nFor Each Shp In ORG.Shapes\n    If Shp.Type = msoGroup Then\n        For X = 1 To Shp.GroupItems.Count\n            If Shp.GroupItems(X).Type = msoLine Then\n                Shp.GroupItems(X).Shadow.Transparency = 1\n            End If\n        Next X\n    End If\nNext Shp\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10113331, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/514a837608d2e7d543fdd49e203f18b8?s=128&d=identicon&r=PG", "display_name": "user10113331", "link": "https://stackoverflow.com/users/10113331/user10113331"}, "is_accepted": false, "score": 0, "last_activity_date": 1532135926, "last_edit_date": 1532135926, "creation_date": 1532134720, "answer_id": 51451941, "question_id": 34616903, "link": "https://stackoverflow.com/questions/34616903/remove-a-shadow-from-all-lines/51451941#51451941", "title": "Remove a shadow from all lines", "body": "<pre><code>Sub qqq()\nDim x As Shape\n    For Each x In ActiveSheet.Shapes\n        x.Shadow.Visible = msoFalse\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1400, "user_id": 215452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hsWhj.jpg?s=128&g=1", "display_name": "bhs", "link": "https://stackoverflow.com/users/215452/bhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 1, "accepted_answer_id": 34617173, "answer_count": 2, "score": 0, "last_activity_date": 1532135926, "creation_date": 1452012405, "last_edit_date": 1452013692, "question_id": 34616903, "link": "https://stackoverflow.com/questions/34616903/remove-a-shadow-from-all-lines", "title": "Remove a shadow from all lines", "body": "<p>I've just inherited an Excel app that draws an org chart. Each shape is connected by a <code>Line</code></p>\n\n<p>However, I need to remove the shadow that is drawn when each line is added. How do I get a collection of <code>Lines</code> so that I can do something like </p>\n\n<pre><code>Line.Shadow.Transparency = 1.0\n</code></pre>\n\n<p>I'm a bit of a vba newbie :-)</p>\n"}, {"tags": ["html", "vba", "csv", "asp-classic"], "comments": [{"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1452012064, "post_id": 34616728, "comment_id": 56978976, "body": "I know similar questions like this have been asked on SO but nothing compares to how simple I need this to be :)"}, {"owner": {"reputation": 23985, "user_id": 863110, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d721f4c46282afc254f3ea0cd05df30?s=128&d=identicon&r=PG", "display_name": "Mosh Feu", "link": "https://stackoverflow.com/users/863110/mosh-feu"}, "edited": false, "score": 1, "creation_date": 1452012852, "post_id": 34616728, "comment_id": 56979510, "body": "Please add this comment to the question."}, {"owner": {"reputation": 4377, "user_id": 2087551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/844e45943efd31e58cd4c1faac3a192c?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2087551/john"}, "edited": false, "score": 2, "creation_date": 1452019859, "post_id": 34616728, "comment_id": 56983636, "body": "Another option is to use your csv file as if it were a database, you can connect to it with the OLEDB Jet driver, see this article.  What it doesn&#39;t make clear is that you use the csv file name as the name of your table.  <a href=\"http://www.htmlgoodies.com/primers/database/connect-to-csv-data-files-using-microsoft-data-access-components.html\" rel=\"nofollow noreferrer\">htmlgoodies.com/primers/database/&hellip;</a>"}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "reply_to_user": {"reputation": 4377, "user_id": 2087551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/844e45943efd31e58cd4c1faac3a192c?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2087551/john"}, "edited": false, "score": 0, "creation_date": 1452023344, "post_id": 34616728, "comment_id": 56985604, "body": "Thanks for the input @John"}], "answers": [{"comments": [{"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 1, "creation_date": 1452092907, "post_id": 34617591, "comment_id": 57017753, "body": "Just a quick note - make sure you&#39;re not going to be using the bar character anywhere else."}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1452094593, "post_id": 34617591, "comment_id": 57018919, "body": "I figured it&#39;s extremely uncommon in this application so I think that&#39;s the best character to use! Do you have any suggestions for an even less common character in an entirely text based web app?"}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 1, "creation_date": 1452155256, "post_id": 34617591, "comment_id": 57045947, "body": "No - if you&#39;re happy that this is not going to be used, then that&#39;s fine. I like to define a constant value to hold the delimiter character (<code>Const C_SEPARATOR = &quot;|&quot;</code> for instance), then you can change quickly and easily for everything."}], "tags": [], "owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "is_accepted": true, "score": 1, "last_activity_date": 1452014480, "creation_date": 1452014480, "answer_id": 34617591, "question_id": 34616728, "link": "https://stackoverflow.com/questions/34616728/importing-csv-values-into-a-webpage-and-including-commas-using-split/34617591#34617591", "title": "Importing CSV values into a webpage and including commas using split()", "body": "<p>Well folks the answer was right in front of my face. Kind of silly really but for this application, it will suffice. </p>\n\n<p>I swapped out the , delimiter with a |. So the new code looks like this:</p>\n\n<pre><code>sRows = oInStream.readLine\narrRows = Split(sRows,\"|\")\n</code></pre>\n\n<p>This may not be a great solution but for this simple application it is all that is necessary. </p>\n"}], "owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 34617591, "answer_count": 1, "score": 0, "last_activity_date": 1452014480, "creation_date": 1452011938, "last_edit_date": 1452013855, "question_id": 34616728, "link": "https://stackoverflow.com/questions/34616728/importing-csv-values-into-a-webpage-and-including-commas-using-split", "title": "Importing CSV values into a webpage and including commas using split()", "body": "<p>EDIT: I know similar questions like this have been asked on SO but nothing compares to how simple I need this to be :)</p>\n\n<p>I have a classic-asp web page that reads a CSV file and spits it onto the page using HTML. The content in the CSV file however contains some paragraphs with properly formed sentences.</p>\n\n<p>In short, I need to display the grammar of these paragraphs which includes commas.</p>\n\n<p>This is a snippet of what my parsing looks like:</p>\n\n<pre><code>    sRows = oInStream.readLine\n    arrRows = Split(sRows,\",\")\n\n    If arrRows(0) = aspFileName And arrRows(1) = \"minCamSys\" Then\n        minCamSys1= arrRows(2)\n        minCamSys2= arrRows(3)\n        minCamSys3= arrRows(4)\n</code></pre>\n\n<p>How can I alter my Split() so that I can display commas without breaking the CSV format. </p>\n\n<p>I would prefer to use double quotes around the data that contains a comma (as is usually the CSV standard when importing to Excel). For example:</p>\n\n<pre><code>Peter,Jeff,\"Jim was from Ontario, Canada\",Scott\n</code></pre>\n\n<p>I would like to avoid the use of a library as this is a simple in-house application.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel", "xmlhttprequest", "testrail"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1452040245, "post_id": 34616579, "comment_id": 56993042, "body": "Have you tried: <code>.Open &quot;POST&quot;, &quot;https:&#47;&#47;testrail.&lt;server&gt;.com&#47;index.php?&#47;api&#47;v2&#47;get_case&#47;3 HTTP&#47;1.1&quot;, False, user, pass</code> without doing any encoding? See <a href=\"https://msdn.microsoft.com/en-us/library/ms757849(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Open method documentation</a>"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1452041792, "post_id": 34616579, "comment_id": 56993513, "body": "Actually, not sure why the &quot;HTTP:1/1&quot; part is in the URL so try without that too"}], "owner": {"reputation": 558, "user_id": 4148676, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh6.googleusercontent.com/-sbHqmzM75wA/AAAAAAAAAAI/AAAAAAAAANQ/aLgd4DZAwqk/photo.jpg?sz=128", "display_name": "unknownSPY", "link": "https://stackoverflow.com/users/4148676/unknownspy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 710, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452011487, "creation_date": 1452011487, "question_id": 34616579, "link": "https://stackoverflow.com/questions/34616579/authentication-error-when-trying-to-connect-to-testrail-using-http-request", "title": "Authentication error when trying to connect to TestRail using HTTP request", "body": "<p>Im trying to set up a connection to the TestRail API within VBA for Excel but I keep getting this error</p>\n\n<pre><code>\"{\"error\":\"Authentication failed: invalid or missing user\\/password or session cookie.\"}\"\n</code></pre>\n\n<p>This is the HTTP request</p>\n\n<pre><code>userPass = user + \":\" + pass\n\nDim TAuth As New MSXML2.XMLHTTP60\n\nuserPass = Base64Encode(userPass)\nuserPass = \"Basic \" + userPass\n\nWith TAuth\n    .Open \"POST\", \"https://testrail.&lt;server&gt;.com/index.php?/api/v2/get_case/3 HTTP/1.1\", False\n    .SetRequestHeader \"Content-Type\", \"application/json\"\n    .SetRequestHeader \"Accept\", \"application/json\"\n    .SetRequestHeader \"Authorization\", userPass\n    .send\n    sStatus = .Status\n    sErg = .responseText\n\nEnd With\n</code></pre>\n\n<p>Now I am using the correct username/password variables and the server address is accurate and Base64Encode() is working correctly.</p>\n\n<p>Why am I recieving the Auth failed error?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452009922, "post_id": 34615786, "comment_id": 56977480, "body": "you need to reference the other sheet in the other workbook, so it would be like other_workbook.sheet1.range(&quot;A2:BC&quot; &amp; last_row).value = Range(&quot;$A2:BC$&quot; &amp; last_row).value or something similar.  There are many posts on here doing the same thing, and if conditions are met."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 3, "last_activity_date": 1452010898, "creation_date": 1452010898, "answer_id": 34616389, "question_id": 34615786, "link": "https://stackoverflow.com/questions/34615786/copy-and-paste-to-the-last-row-in-a-new-worksheet/34616389#34616389", "title": "Copy and paste to the last row in a new worksheet", "body": "<p>You could try this:</p>\n\n<pre><code>Option Explicit\n\n    Sub CandP()\n\n    Dim Last_Row1 As Long, Last_Row2 As Long\n    Dim WB1 As Workbook, WB2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    Set WB1 = ThisWorkbook ' Workbook where you want to copy the data\n    Set ws1 = WB1.Sheets(\"Sheet1\") ' Change the name of your Sheet\n    Set WB2 = Workbooks.Open(\"C:\\Desktop\\vba\\Newsheet.xlsm\") ' Enter the address of the Workbook you want to paste the data\n    Set ws2 = WB2.Sheets(\"Sheet1\") ' Change the name of your Sheet\n\n    Last_Row1 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row ' Determine the lastrow of the data to copy\n    Last_Row2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1 ' Determine the next empty row in order to paste the data\n\n    ws1.Range(\"A2:BC\" &amp; Last_Row1).Copy ws2.Range(\"A\" &amp; Last_Row2)\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5743923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a772d8d530bf855aa752a5a400c764c?s=128&d=identicon&r=PG&f=1", "display_name": "MCharm88", "link": "https://stackoverflow.com/users/5743923/mcharm88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10426, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1473707434, "creation_date": 1452009106, "last_edit_date": 1452011415, "question_id": 34615786, "link": "https://stackoverflow.com/questions/34615786/copy-and-paste-to-the-last-row-in-a-new-worksheet", "title": "Copy and paste to the last row in a new worksheet", "body": "<p>I'm currently trying to copy from one worksheet and paste into a new worksheet using VBA. however i have the following variables </p>\n\n<ul>\n<li>The worksheet with data being copied is dynamic. the columns stay the same but the rows change every week.   </li>\n<li>The new worksheet which the data will be added to is dynamic. The Columns are the same but the new worksheet rows increase every week( e.g row 700 one week row 800 the next). </li>\n<li>The columns (A and BC) that are being copied and pasted are consistent.</li>\n<li>The data should be pasted on columns A- BC on the next available row\nof the new worksheet</li>\n</ul>\n\n<p>I've currently managed to come up with the following code but i keep getting error's and don't know where i am going wrong as i am new to VBA. </p>\n\n<pre><code> Sub CandP()\n'\n'\n\nDim Last_Row As Long\n\nApplication.ScreenUpdating = False\n\nLast_Row = Range(\"A2:BC2\" &amp; Rows.Count).End(xlUp).Row\nRange(\"A2:BC2\").Copy\nWindows(\"Newsheet.xlsm\").Activate\nRange(\"$A2:BC$\" &amp; last_row).FillDown\n\nEnd Sub\n</code></pre>\n\n<p>All help is appreciated, Thank you </p>\n"}]