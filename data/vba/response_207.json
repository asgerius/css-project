[{"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1545942037, "post_id": 53938280, "comment_id": 94739388, "body": "Added a tricky way to return a zero-based array <b>without loops</b> (using the <code>ListBox.List</code> property of a temporary UserForm) - @philipsK"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "is_accepted": false, "score": 2, "last_activity_date": 1545871036, "last_edit_date": 1545871036, "creation_date": 1545869163, "answer_id": 53938412, "question_id": 53938280, "link": "https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value/53938412#53938412", "title": "May I return a 0-base array from ws.usedrange.value?", "body": "<p>It <strong>cannot</strong> be done. Retrieving values into an variant array from the worksheet's cells <strong>always</strong> returns a 1-based 2-D array regardless of whether you are dealing with a single column or single row or multiple columns and/or rows.</p>\n\n<p><code>Option Base 0</code> (which is the default in any case) cannot change this behavior.</p>\n\n<p>Caveat: Application.Transpose applied once or twice can return a 1-D zero-based array of a single column or single row.</p>\n\n<p><strong>Option 1: Simply convert the array on the fly</strong></p>\n\n<pre><code>dim arr1 as variant, arr2 as variant, i as long\n\n'for multiple row values in a single column\narr1 = range(\"a1:a9\").value\nredim arr2(lbound(arr1, 1) - 1)\n\nfor i = lbound(arr1, 1) to ubound(arr1, 1)\n    arr2(i-1) = arr1(i, 1)\nnext i\n\nfor i=lbound(arr2) to ubound(arr2)\n    debug.print i\n    debug.print arr2(i)\nnext i\n\n'for multiple column values in a single row\narr1 = range(\"a1:i1\").value\nredim arr2(lbound(arr1, 2) - 1)\n\nfor i = lbound(arr1, 2) to ubound(arr1, 2)\n    arr2(i-1) = arr1(i, 2)\nnext i\n\nfor i=lbound(arr2) to ubound(arr2)\n    debug.print i\n    debug.print arr2(i)\nnext i\n</code></pre>\n\n<p><strong>Option 2: Transpose the values as they are received</strong></p>\n\n<pre><code>dim arr as variant\n\narr = application.transpose(range(\"a1:a9\").value)\n\nfor i=lbound(arr) to ubound(arr)\n    debug.print i\n    debug.print arr(i)\nnext i\n\narr = application.transpose(application.transpose(range(\"a1:i1).value))\n\nfor i=lbound(arr) to ubound(arr)\n    debug.print i\n    debug.print arr(i)\nnext i\n</code></pre>\n\n<p>Note that in Option 2 you only transpose once when converting a single column's rows into a 1-D array. However, you need to transpose twice to convert a single row's columns into a 1-D array.</p>\n\n<p>Transpose has a functional limit of either a signed or unsigned integer's overflow limit (I cannot remember which at the moment).</p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545871707, "creation_date": 1545871707, "answer_id": 53938646, "question_id": 53938280, "link": "https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value/53938646#53938646", "title": "May I return a 0-base array from ws.usedrange.value?", "body": "<h1>One to Zero Based</h1>\n\n<pre><code>Sub OneToZeroBased()\n\n  Const cStrSheet As Variant = \"Sheet1\"   ' Worksheet Name/Index\n\n  Dim vntSrc As Variant                   ' Source Array\n  Dim vntTgt As Variant                   ' Target Array\n  Dim i As Long                           ' Row Counter\n  Dim j As Integer                        ' Column Counter\n\n  With Worksheets(cStrSheet)\n    If .Cells.Find(\"*\", .Cells(.Rows.Count, .Columns.Count), -4123, , 1) _\n        Is Nothing Then Exit Sub\n    vntSrc = .Range(.Cells(.Cells.Find(\"*\", _\n        .Cells(.Rows.Count, .Columns.Count)).Row, .Cells.Find(\"*\", _\n        .Cells(.Rows.Count, .Columns.Count), , , 2).Column), .Cells(.Cells _\n        .Find(\"*\", , , , 1, 2).Row, .Cells.Find(\"*\", , , , 2, 2).Column)) _\n        .Value\n  End With\n\n  ReDim vntTgt(UBound(vntSrc, 1) - 1, UBound(vntSrc, 2) - 1)\n  For i = 1 To UBound(vntSrc)\n    For j = 1 To UBound(vntSrc, 2)\n      vntTgt(i - 1, j - 1) = vntSrc(i, j)\n'      Debug.Print i - 1 &amp; \"   \" &amp; j - 1 &amp; \"   \" &amp; vntTgt(i - 1, j - 1)\n    Next\n  Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 2, "last_activity_date": 1545894254, "creation_date": 1545894254, "answer_id": 53941046, "question_id": 53938280, "link": "https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value/53941046#53941046", "title": "May I return a 0-base array from ws.usedrange.value?", "body": "<p>working with a <code>UsedRange</code> makes me think you're always dealing with a 2D array</p>\n\n<p>so just paste the 2D 1-based array values into a properly sized 2D 0-based one:</p>\n\n<pre><code>Function getWSarr(pWs As Worksheet) As Variant\n    Dim arr1 As Variant, arr0 As Variant\n    Dim nRows As Long, nCols As Long, i As Long, j As Long\n\n    arr1 = pWs.UsedRange.Value\n    nRows = UBound(arr1, 1) - 1\n    nCols = UBound(arr1, 2) - 1\n    ReDim arr0(0 To nRows, 0 To nCols)\n    For i = 0 To nRows\n        For j = 0 To nCols\n            arr0(i, j) = arr1(i + 1, j + 1)\n        Next\n    Next\n    getWSarr = arr0\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1545941565, "last_edit_date": 1545941565, "creation_date": 1545941164, "answer_id": 53950312, "question_id": 53938280, "link": "https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value/53950312#53950312", "title": "May I return a 0-base array from ws.usedrange.value?", "body": "<p><strong>Alternative without Loops</strong></p>\n\n<p><strong>Yes</strong>, it's possible to change the array base via a tricky assignment to the <code>.List</code> property of a <em><code>Listbox</code></em> in a <em>UserForm</em>, which accepts a 1-based array as <em>Input</em>, but returns a <strong>zero-based array list</strong> by default. (The helper function <strong><code>transformArray</code></strong> creates a temporary userform on the fly just to allow the described use of a listbox control).</p>\n\n<p><strong>Calling code example</strong></p>\n\n<pre><code>Sub ChangeBase()\n' Calling example as one liner\n Dim v\n v = transformArray(getWSarr(ThisWorkbook.Worksheets(\"MySheet\")))   ' &lt;~~ change to your sheet name\n End Sub\n</code></pre>\n\n<p><em>Just in case you prefer two logical steps:</em></p>\n\n<pre><code>  Sub ChangeBase()\n  ' Calling example in two steps (of course you can reduce this to a one liner, see above :-)\n   Dim vOne, vZero\n  '[1] Get 1-based 2-dim array from used range in given sheet using OP's function getWSarr\n   vOne = getWSarr(ThisWorkbook.Worksheets(\"MySheet\"))   ' &lt;~~ change to your sheet name\n  '[2] transform to 0-based array\n   vZero = transformArray(vOne)\n  End Sub\n</code></pre>\n\n<p><strong>Helper functions</strong></p>\n\n<pre><code>Function transformArray(ByRef v) As Variant()\n' Purpose: return zero-based array instead of 1-based input array\n' Method:  use the fact that ListBox.List returns a zero based array, but accepts 1-based arrays for import\n' Ref.:    \"Microsoft Forms 2.0 Object Library\" - MSForms (FM20.dll),\n'          \"Microsoft Visual Basic for Applications Extensibility 5.3\" - VBIDE (VBE6EXT.OLB)\n Dim myForm       As Object\n Dim NewListBox   As MSForms.ListBox\n\n' Add temporary UserForm\n  Set myForm = ThisWorkbook.VBProject.VBComponents.Add(3)   ' Add UserForm\n' Create temporary ListBox\n  Set NewListBox = myForm.designer.Controls.Add(\"Forms.listbox.1\")\n  With NewListBox\n       .ColumnCount = UBound(v, 2) + 1                      ' define column count\n       .List = v                                            ' fill listbox with 1-based original array\n      ' ~~~~~~~~~~~~~~~~~~~~~~~~\n      ' Return transformed array\n      ' ~~~~~~~~~~~~~~~~~~~~~~~~\n        transformArray = .List                              ' &lt;~~ return transformed array\nEnd With\n\n'Delete the never shown form\n ThisWorkbook.VBProject.VBComponents.Remove myForm\n\nEnd Function\n\n\nFunction getWSarr(pWs As Worksheet) As Variant\n' Note:    identical function as used in original post (OP)\n' Purpose: get 1-based 2-dim array from used range in a given worksheet\n    getWSarr = pWs.UsedRange.Value\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1546098290, "post_id": 53964235, "comment_id": 94779420, "body": "Appreciate that you <i>too</i> are demonstrating a different approach, which not only proves that <i>many roads lead to Rome</i>, but allows to learn again and again at this site +1)"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 2, "last_activity_date": 1546031371, "last_edit_date": 1546031371, "creation_date": 1546030794, "answer_id": 53964235, "question_id": 53938280, "link": "https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value/53964235#53964235", "title": "May I return a 0-base array from ws.usedrange.value?", "body": "<p>I'd say simply looping the values into a zero-based array is <em>safest &amp; simplest.</em></p>\n\n<p>You could however fool around with some memory-copy stuff from WinAPI:</p>\n\n<pre><code>Public Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (Destination As Any, Source As Any, ByVal Length As Long)\n\nPublic Function MultiDimOneToZeroArray(ByVal s As Variant) As Variant\n    'Do your own check first that s is a one-based array etc\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Dim arr() As Variant\n    ReDim arr(0 To UBound(s) - 1, 0 To UBound(s, 2) - 1)\n\n    CopyMemory ByVal VarPtr(arr(0, 0)), ByVal VarPtr(s(1, 1)), UBound(s) * UBound(s, 2) * 16\n\n    MultiDimOneToZeroArray = arr\nEnd Function\n</code></pre>\n\n<p>Call it like so:</p>\n\n<pre><code>Sub test()\n    Dim s() As Variant\n    s = Sheet1.Range(\"A1:E20\").Value2\n\n    Dim arr As Variant\n    arr = MultiDimOneToZeroArray(s)\n\nEnd Sub\n</code></pre>\n\n<p>Obviously you can wrap your func so:</p>\n\n<pre><code>Function getZeroBasedWSarr(pWs As Worksheet) As Variant\n    getZeroBasedWSarr = MultiDimOneToZeroArray(pWs.UsedRange.Value)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 1, "accepted_answer_id": 53964235, "answer_count": 5, "score": 3, "last_activity_date": 1578481772, "creation_date": 1545867959, "last_edit_date": 1578481772, "question_id": 53938280, "link": "https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value", "title": "May I return a 0-base array from ws.usedrange.value?", "body": "<p>I like how efficient this function is. Unfortunately I wish the function returned a zero-based array! Any suggestions? I've attempted <code>Option Base 0</code> already (although that is the default).</p>\n\n<pre><code>Function getWSarr(pWs As Worksheet) As Variant\n    getWSarr = pWs.UsedRange.Value\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545881853, "post_id": 53938171, "comment_id": 94718521, "body": "Please share the relevant html using the snippet tool via <a href=\"https://stackoverflow.com/posts/53938171/edit\">edit</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545868321, "post_id": 53938310, "comment_id": 94716613, "body": "There is also the point of treating a collection (e.g. <code>getElementsByClassName</code> (plural)) as a single element. <code>getElementsByClassName(&quot;blah-blah&quot;)(0).click</code> might be a better approach."}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546281730, "post_id": 53938310, "comment_id": 94818559, "body": "It works fine with getElementsByClassName(&quot;blah-blah&quot;)(0).click!"}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546282169, "post_id": 53938310, "comment_id": 94818684, "body": "I can now Access the web and click on the desired &quot;max&quot; button. If I am logged in to the web previous to running the code then the new IE window logs me in automatically which is good. Then the code clicks the &quot;max&quot; button and triggers a download Action. BUT there is a last prompt  warning that reads: &quot;Do you want to open or save &quot;filename.csv&quot; from barchart.com?  I tried SendKeys commands to select SAVE on that prompt so that it saves automattically. Unfortunately Sendkeys does not help much as Tabs Keep changing on the web. The prompts also Comes after changing IE Settings... Any ideas??"}, {"owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "reply_to_user": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546369966, "post_id": 53938310, "comment_id": 94833536, "body": "@Alfred try changing the settings in IE to automatically download files when clicked on so that the prompt doesn&#39;t show up in the first place."}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546448391, "post_id": 53938310, "comment_id": 94857269, "body": "Jane: IE11 browser does not allow it. There is no way to click to allow automatic download of files without prompting...one week trying and Blogs just to save you time.Using Windows 10"}], "tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 1, "last_activity_date": 1545868181, "creation_date": 1545868181, "answer_id": 53938310, "question_id": 53938171, "link": "https://stackoverflow.com/questions/53938171/from-excel-vba-click-button-on-web/53938310#53938310", "title": "From EXCEL VBA Click Button on Web", "body": "<p>That site won't let you download the csv unless you are logged in.  the class you specified is linked to a jQuery that checks your login status and throws an error if you aren't.  To download it through excel you would first need to go to the website and create an account, then write code to log you in, then download the csv, and it should work.  I don't know the exact syntax for this but hopefully this will point you in the right direction.  </p>\n\n<p>Also I would recommend trying Selenium.  Its a popular webcrawling software so it should be easy to find help with this.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546428125, "post_id": 53992103, "comment_id": 94847464, "body": "Hi, I tried also Selenium but after installing Selenium Type Library and SeleniumWrapper Type Library still does not work. Can you send me the link for the ChromeDriver you are using so I can test your code? thx!"}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546428690, "post_id": 53992103, "comment_id": 94847742, "body": "Please note that the correct URL is: Const URL = &quot;<a href=\"https://www.barchart.com/futures/quotes/ZWF|530P/price-history/historical\" rel=\"nofollow noreferrer\">barchart.com/futures/quotes/ZWF|530P/price-history/historic&zwnj;&#8203;al</a>&quot;, and that as soon as you access it it will change to a slightly different URL address that is useless."}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546428800, "post_id": 53992103, "comment_id": 94847809, "body": "In your code above you use the &quot;transformed&quot; URL that does not work:<a href=\"https://www.barchart.com/futures/quotes/ZWF9%7C530P/price-history/historical\" rel=\"nofollow noreferrer\">barchart.com/futures/quotes/ZWF9%7C530P/price-history/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546428857, "post_id": 53992103, "comment_id": 94847838, "body": "You can create for free any login and password. Once you are logged in in a browser, launching again from scratch that browser remembers your login and it does not prompt you to relogin"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546429017, "post_id": 53992103, "comment_id": 94847925, "body": "I tested and worked for me. I can try something updated later today."}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546447949, "post_id": 53992103, "comment_id": 94857047, "body": "Please note that the links has now changed to:<a href=\"https://www.barchart.com/futures/quotes/ZWH9|530P/price-history/historical\" rel=\"nofollow noreferrer\">barchart.com/futures/quotes/ZWH9|530P/price-history/histo&zwnj;&#8203;rical</a>"}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546448085, "post_id": 53992103, "comment_id": 94857121, "body": "QHarr: I cannot get the ChromeDriver to work. I already installed SeleniumBasic and Selenium is also an addon on Chrome....what have you installed to  make the Chrome Driver work?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546449151, "post_id": 53992103, "comment_id": 94857599, "body": "You download latest chromedriver and chrome. Place the chromedriver in the same folder as selenium basic files. Add a reference to selenium type library via vbe &gt; tools &gt; references"}, {"owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546471387, "post_id": 53992103, "comment_id": 94866064, "body": "Hi QHarr, is there a way we can talk? I find the process really complicated."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546471602, "post_id": 53992103, "comment_id": 94866122, "body": "It\u2019s late but yes you can normally join me in the dawghaus. There is a link on my profile. When in that room you use @qharr to notify me. Or someone else can ping me or even help you in my place."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "edited": false, "score": 0, "creation_date": 1546621566, "post_id": 53992103, "comment_id": 94921898, "body": "Seems from IE now I can initiate download with ie.document.querySelector(&quot;[data-ref=historical]&quot;).Click"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1546621551, "last_edit_date": 1546621551, "creation_date": 1546298614, "answer_id": 53992103, "question_id": 53938171, "link": "https://stackoverflow.com/questions/53938171/from-excel-vba-click-button-on-web/53992103#53992103", "title": "From EXCEL VBA Click Button on Web", "body": "<p>With IE - you can simply use the following to initiate the download provided login not requested.</p>\n\n<pre><code>ie.document.querySelector(\"[data-ref=historical]\").Click\n</code></pre>\n\n<p>Longer login version:</p>\n\n<p>Well that threw up horror after horror with both IE and Selenium including login details not accepted (for IE) as detected as bot, page not found errors thrown after login, stale element references, element not clickable...... The following is the horrific war I waged successfully to get the download. In the morning I will see if I can find a better way.</p>\n\n<pre><code>Option Explicit\nPublic Sub Download()\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const URL = \"https://www.barchart.com/futures/quotes/ZWF9%7C530P/price-history/historical\"\n    Const JS_WAIT_CLICKABLE = _\n    \"var target = this, endtime = Date.now() + arguments[0];\" &amp; _\n    \"(function check_clickable() {\" &amp; _\n    \"  var r = target.getBoundingClientRect(), x = r.left+r.width/2, y = r.top+r.height/2;\" &amp; _\n    \"  for (var e = document.elementFromPoint(x , y); e; e = e.parentElement)\" &amp; _\n    \"    if (e === target){ callback(target); return; }\" &amp; _\n    \"  if (Date.now() &gt; endtime) { callback(target); return; }\" &amp; _\n    \"  setTimeout(check_clickable, 60);\" &amp; _\n    \"})();\"                                      'by @florentbr\n\n    With d\n        .Start \"Chrome\"\n        .get URL, timeout:=100000\n        .FindElementByCss(\"[data-ref=historical]\").Click\n\n        With .FindElementsByCss(\"input.form-input\")\n            .item(1).SendKeys \"name\"\n            .item(2).SendKeys \"password\"\n        End With\n        .FindElementByCss(\"[value=GO]\").Click\n        .GoBack\n        .GoBack\n        Application.Wait Now + TimeSerial(0, 0, 5)\n        With .FindElementByCss(\"[data-ref=historical]\")\n            .ExecuteAsyncScript(JS_WAIT_CLICKABLE, 10000) _\n        .Click\n        End With\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 2690044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1c3d9fd96c6d4db0bf3d542e95ce7a98?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/2690044/alfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1546621551, "creation_date": 1545866527, "last_edit_date": 1546282507, "question_id": 53938171, "link": "https://stackoverflow.com/questions/53938171/from-excel-vba-click-button-on-web", "title": "From EXCEL VBA Click Button on Web", "body": "<p>I am using VBA in Excel and I am trying to access a webpage and then click on a link to trigger a CSV download on my PC.</p>\n\n<p>With VBA I am able so far to open  IE and access the required Webpage. But after inspecting the HTML code of the page (F12) and using getElementsByClassName and other methods I cannot product a clickable object that will trigger the download from my code. </p>\n\n<p>Sub Automate_IE_Enter_Data()\n'This will load a webpage in IE\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim HWNDSrc As Long</p>\n\n<pre><code>'Create InternetExplorer Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n'Set IE.Visible = True to make IE visible, or False for IE to run in the background\nIE.Visible = True\n\n'Define URL\n'URL = \"https://www.automateexcel.com/excel/vba\"\nURL = \"https://www.barchart.com/futures/quotes/ZWF9|530P/price-history/historical\"\n\n'Navigate to URL\nIE.Navigate URL\n\n' Statusbar let's user know website is loading\nApplication.StatusBar = URL &amp; \" is loading. Please wait...\"\n\n' Wait while IE loading...\n'IE ReadyState = 4 signifies the webpage has loaded (the first loop is set to avoid inadvertantly skipping over the second loop)\n'Do While IE.ReadyState = 4: DoEvents: Loop\nDo Until IE.ReadyState = 4: DoEvents: Loop\n\n'Webpage Loaded\nApplication.StatusBar = URL &amp; \" Loaded\"\n\n'Get Window ID for IE so we can set it as activate window\nHWNDSrc = IE.hWnd\n'Set IE as Active Window\nSetForegroundWindow HWNDSrc\n\nSet IEAppColl = IE.Document.getElementsByClassName(\"bc-glyph-download\")(0)\n</code></pre>\n\n<p>IEAppColl.Click</p>\n\n<p>Application.Wait Now + TimeValue(\"00:00:10\")</p>\n\n<p>SetForegroundWindow HWNDSrc</p>\n\n<p>Application.Wait Now + TimeValue(\"00:00:05\")</p>\n\n<p>End Sub</p>\n\n<p>Expected: 1) Open on IE the following URL: \n<a href=\"https://www.barchart.com/futures/quotes/ZWF9|530P/price-history/historical\" rel=\"nofollow noreferrer\">https://www.barchart.com/futures/quotes/ZWF9|530P/price-history/historical</a>\n2) Click the \"max\" link on the Daily Prices section to download a CSV file</p>\n\n<p>1) is OK\n2) produces the error: Object does not support this property or method.</p>\n\n<p>I am not click as to how to replicat the clicking of the \"max\" link in my VBA Code. Not sure I am using ist correct name.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10836767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T0EOzzbaMiI/AAAAAAAAAAI/AAAAAAAAABM/qdDoRBGvj_U/photo.jpg?sz=128", "display_name": "HellowThar", "link": "https://stackoverflow.com/users/10836767/hellowthar"}, "edited": false, "score": 0, "creation_date": 1545865998, "post_id": 53938010, "comment_id": 94716202, "body": "As far as the last Else, I know I could have kept it shorthand but I felt like looking at that visually might have helped me figure out my issue. Plus as you stated I could just change it to elseif if I ever wanted to add another template."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1545864948, "creation_date": 1545864948, "answer_id": 53938010, "question_id": 53937877, "link": "https://stackoverflow.com/questions/53937877/vba-excel-automatic-template-selection/53938010#53938010", "title": "VBA Excel Automatic Template Selection", "body": "<p>You need to move <code>Leftcell</code> inside your loop and increment it with every iteration:</p>\n\n<pre><code>For CustRow = 8 To LastRow\n    LeftCell = .Range(\"B\" &amp; CustRow).Value\n            If LeftCell = 6 Then\n                Set WordDoc = WordApp.Documents.Open(\"C:\\Users\\jhabermann\\Desktop\\Excel VBA Test Environment\\Template 1.docx\", ReadOnly:=False) 'Open Template\n            ElseIf LeftCell = 4 Then\n                Set WordDoc = WordApp.Documents.Open(\"C:\\Users\\jhabermann\\Desktop\\Excel VBA Test Environment\\Template 2\", ReadOnly:=False) 'Open Template\n            Else: LeftCell = 3\n                Set WordDoc = WordApp.Documents.Open(\"C:\\Users\\jhabermann\\Desktop\\Excel VBA Test Environment\\Template 3.docx\", ReadOnly:=False) 'Open Template\n            End If\n\n                For CustCol = 5 To 10 'Move through 3 columns\n                    TagName = .Cells(7, CustCol).Value  'Tag Name\n                    TagValue = .Cells(CustRow, CustCol).Value 'Tag Value\n                    With WordDoc.Content.Find\n                        .Text = TagName\n                        .Replacement.Text = TagValue\n                        .Wrap = wdFindContinue\n                        .Execute Replace:=wdReplaceAll, Forward:=True, Wrap:=wdFindContinue\n                    End With\n                Next CustCol\n    WordDoc.PrintOut\n    WordDoc.Close\n    Kill (FileName) 'Deletes the Word File just created\nNext CustRow\n</code></pre>\n\n<p>As a note, not sure what you're doing on that <code>Else: LeftCell = 3</code> line - why set <code>LeftCell</code> to anything? I think you meant for another <code>ElseIf</code> there.</p>\n"}], "owner": {"reputation": 3, "user_id": 10836767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T0EOzzbaMiI/AAAAAAAAAAI/AAAAAAAAABM/qdDoRBGvj_U/photo.jpg?sz=128", "display_name": "HellowThar", "link": "https://stackoverflow.com/users/10836767/hellowthar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 53938010, "answer_count": 1, "score": 0, "last_activity_date": 1545891556, "creation_date": 1545863838, "last_edit_date": 1545891556, "question_id": 53937877, "link": "https://stackoverflow.com/questions/53937877/vba-excel-automatic-template-selection", "title": "VBA Excel Automatic Template Selection", "body": "<p>I am writing a VBA script that I want to do smarter mail merge functions with.</p>\n\n<p>Basically, I have 3 word templates that are formatted differently with replacement tags in different places. We'll call these templates 1-3.</p>\n\n<p>I have a table where each row has the necessary replacement data as strings, with a max of 6 strings per row.  To the left of this table, in column B, I have the number of strings in the table listed, and based on this number I want it to choose the correct template.  I think I may have the LeftCell dim configured incorrectly, or my code is choosing a template correctly the first time, but applying it to all the other rows.  If I run the script it always seems to choose the first template.</p>\n\n<pre><code>Sub CreateWordDocuments()\nDim CustRow, CustCol, LastRow, LeftCell, TemplRow As Long\nDim DocLoc, TagName, TagValue, TemplName, FileName As String\nDim WordDoc, WordApp As Object\nDim WordContent As Word.Range\nWith Sheet1\n\nIf .Range(\"B3\").Value = Empty Then\n    MsgBox \"Please select a template from the dropdown list\"\n    .Range(\"G3\").Select\n    Exit Sub\nEnd If\n    TemplRow = .Range(\"B3\").Value 'Set Template Row\n    TemplName = .Range(\"G3\").Value 'Set Template Name\n    DocLoc = Sheet2.Range(\"F\" &amp; TemplRow).Value 'Word Doc Filename\n\n    'Open Word Template\n    On Error Resume Next 'If Word is already running\n    Set WordApp = GetObject(\"Word.Application\")\n    If Err.Number &lt;&gt; 0 Then\n    'Launch a new instance of Word\n    Err.Clear\n    'On Error GoTo Error_Handler\n    Set WordApp = CreateObject(\"Word.Application\")\n    WordApp.Visible = True 'Make the application visible to the user\n    End If\n\n\n    LastRow = .Range(\"E999\").End(xlUp).Row 'Determine last row\n    LeftCell = .Range(\"B\" &amp; (ActiveCell.Row)).Value\n    For CustRow = 8 To LastRow\n                If LeftCell = 6 Then\n                    Set WordDoc = WordApp.Documents.Open(\"C:\\Users\\jhabermann\\Desktop\\Excel VBA Test Environment\\Template 1.docx\", ReadOnly:=False) 'Open Template\n                ElseIf LeftCell = 4 Then\n                    Set WordDoc = WordApp.Documents.Open(\"C:\\Users\\jhabermann\\Desktop\\Excel VBA Test Environment\\Template 2\", ReadOnly:=False) 'Open Template\n                Else: LeftCell = 3\n                    Set WordDoc = WordApp.Documents.Open(\"C:\\Users\\jhabermann\\Desktop\\Excel VBA Test Environment\\Template 3.docx\", ReadOnly:=False) 'Open Template\n                End If\n\n                    For CustCol = 5 To 10 'Move through 3 columns\n                        TagName = .Cells(7, CustCol).Value  'Tag Name\n                        TagValue = .Cells(CustRow, CustCol).Value 'Tag Value\n                        With WordDoc.Content.Find\n                            .Text = TagName\n                            .Replacement.Text = TagValue\n                            .Wrap = wdFindContinue\n                            .Execute Replace:=wdReplaceAll, Forward:=True, Wrap:=wdFindContinue\n                        End With\n                    Next CustCol\n    WordDoc.PrintOut\n    WordDoc.Close\n    Kill (FileName) 'Deletes the Word File just created\nNext CustRow\nWordApp.Quit\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Ignore the few lines of code regarding b3 and g3, I am saving that for later functionality to perhaps choose different sets of templates.</p>\n"}, {"tags": ["excel", "vba", "date-formatting"], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1546220428, "last_edit_date": 1546220428, "creation_date": 1545873186, "answer_id": 53938744, "question_id": 53937703, "link": "https://stackoverflow.com/questions/53937703/copyfromrecordset-incorrectly-formats-cells-as-date/53938744#53938744", "title": "CopyFromRecordset incorrectly formats cells as Date?", "body": "<p>One cell is sufficient for a Range to format the column in a numeric format.</p>\n\n<pre><code>DataRange = \"a13\"\nWith ActiveSheet.Range(DataRange)\n    With ActiveSheet.Range(DataRange).CurrentRegion\n        .ClearContents\n        .CurrentRegion.Columns(\"SO\").NumberFormatLocal = \"0_ \"\n    End With\n    .CopyFromRecordset rs\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8909806, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206414096774484/picture?type=large", "display_name": "PessimisticPaperClip", "link": "https://stackoverflow.com/users/8909806/pessimisticpaperclip"}, "edited": false, "score": 0, "creation_date": 1545938817, "post_id": 53939938, "comment_id": 94738371, "body": "This worked!  This is great because it still allows me to clear the contents of the range.  I didn&#39;t realize that one cell worked as the range.  Thanks again!"}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1545886694, "creation_date": 1545886694, "answer_id": 53939938, "question_id": 53937703, "link": "https://stackoverflow.com/questions/53937703/copyfromrecordset-incorrectly-formats-cells-as-date/53939938#53939938", "title": "CopyFromRecordset incorrectly formats cells as Date?", "body": "<p>I've encountered this problem before; it can be solved by using Cells property of the Range:</p>\n\n<pre><code>With ActiveSheet.Range(dataRange)\n    .ClearContents\n    .Cells(1,1).CopyFromRecordset rs\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8909806, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206414096774484/picture?type=large", "display_name": "PessimisticPaperClip", "link": "https://stackoverflow.com/users/8909806/pessimisticpaperclip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1421, "favorite_count": 0, "accepted_answer_id": 53939938, "answer_count": 2, "score": 0, "last_activity_date": 1578481812, "creation_date": 1545862247, "last_edit_date": 1578481812, "question_id": 53937703, "link": "https://stackoverflow.com/questions/53937703/copyfromrecordset-incorrectly-formats-cells-as-date", "title": "CopyFromRecordset incorrectly formats cells as Date?", "body": "<p>I have an excel sheet that loads data from a database, then puts it in an Excel Table using the CopyFromRecordset VBA command.  My problem is, a number of cells (which should be integers) keep getting formatted as a date, no matter what I do.  I've changed the number format in Excel to Number, but whenever I reload data from the database, the format switches back to date.</p>\n\n<p>The datatype in the database is Integer, and yet, when I load data from the DB, Excel still changes the cell format to Date.  Even if an end-user enters an integer into the cell after loading data, excel changes it to a date.  For example, if I enter 5 into the cells, excel changes it to 1/5/1900.</p>\n\n<p>Why would Excel keep changing these cells to dates, even after the format dropdown is changed to something else?</p>\n\n<p>Things I've tried:</p>\n\n<ul>\n<li><p>Changed the format from date to number, general, &amp; text.  It reverts to Date on CopyFromRecordset</p></li>\n<li><p>deleting the column and making a new one formatted as Number.  It still reverts on CopyFromRecordset</p></li>\n<li><p>Cast the datatype to integer in the select statement</p></li>\n</ul>\n\n<p>Any other ideas?</p>\n\n<p>A portion of the VBA code that loads the data from the database:</p>\n\n<pre><code>SQLStr = \"Select ......, [SO] FROM v_TRACKING\"\nSet Cn = New ADODB.Connection\nCn.Open \"Driver={SQL Server Native Client 11.0};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; \";Trusted_connection=yes;\"\nrs.Open SQLStr, Cn, adOpenStatic\n\ndataRange = \"a13:az\" &amp; (rs.RecordCount + 12)\n\nWith ActiveSheet.Range(dataRange)\n    .ClearContents\n    .CopyFromRecordset rs\nEnd With\n</code></pre>\n\n<p>All other columns stay formatted correctly, but for some reason the SO column gets formatted as a date.  I've been banging my head against a wall about this for a few days now, so <em>any</em> ideas would be appreciated :)</p>\n"}, {"tags": ["vba", "divide"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545860817, "post_id": 53937492, "comment_id": 94715025, "body": "1) <code>Dim pair as Range</code>, 2) <code>accumulator as Range</code>. 3) <code>Range(&quot;G&quot; &amp; Found).Value = pair.Value</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545860899, "post_id": 53937492, "comment_id": 94715063, "body": "Can you show a sample of some data and then show an output?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545860982, "post_id": 53937492, "comment_id": 94715088, "body": "It&#39;s hard-coded here that you are either diving by 10 or taking <code>Mod 10</code>"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1545865661, "post_id": 53937492, "comment_id": 94716137, "body": "Fix   Val(Left(pair, InStr(pair, &quot;-&quot;))) - 1   so that trailing right paren is moved 4 pos to the left.    Also, Fix indentation because   Range(&quot;G&quot; &amp; found)  only executes when  Right(pair, 2) = 15 .  Lastly, provide some sample data  for (&quot;B30, F30, J30&quot;) and for their Offset(0, 1)"}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1545874356, "post_id": 53937492, "comment_id": 94717458, "body": "Hi, I have added my Excel image. The output from cell D30 would be a 1.20 (12.00 divided by 10 cells) in each of the 10 cells:A36, D36, G36, J36, M36, A40, D40, G40, J40, M40 with the exception of cell G40 which would have a value of 9.20 (1.00 from the div. by 12 and 8.00 as the extra above 12.00). Cell G40 is selected via the first number in cell B30 which is the number 8. Thanks so much for your help."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1545915235, "post_id": 53937492, "comment_id": 94729361, "body": "@NANCYSKYES, should <code>If pair.Offset(0, 1) &lt;= 12</code> be  <code>If pair.Offset(0, 2) &lt;= 12</code> (in your image, <code>pair.Offset(0,1)</code> appears to be empty)? All of your ranges implicitly refer to whichever sheet happens to be active whilst the code is running. It would be good to qualify the <code>workbook</code> and <code>worksheet</code>, so that the code outputs to the expected range."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1545927741, "post_id": 53937492, "comment_id": 94734336, "body": "Hi chillin you are right on the (0, 1) it should have been 2, my error. The empty cell is correct, I&#39;m just not showing any data in it at the moment. I have tried the above changes but I can&#39;t get the macro to work."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1545934825, "post_id": 53937492, "comment_id": 94736924, "body": "I forgot to mention that&#39;s it&#39;s the division issue that I&#39;m trying to solve."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1545939707, "post_id": 53937492, "comment_id": 94738674, "body": "Could you assist in the actual code to Fix &quot;Val(Left(pair, InStr(pair, &quot;-&quot;))) - 1 so that trailing right paren is moved 4 pos to the left.&quot;"}], "owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545873959, "creation_date": 1545860676, "last_edit_date": 1545873959, "question_id": 53937492, "link": "https://stackoverflow.com/questions/53937492/macro-not-dividing-as-it-should", "title": "Macro not dividing as it should", "body": "<p>I have a macro that works but only when dividing up to 19.00. When 20.00 or higher is the number to be divided it divides to only 10.00 and that\u2019s it.  What it\u2019s suppose to do is divide any number up to 12.00 into 10 cells and any number over 12.00 it\u2019s suppose to write the excess amount to the first number in the found pair.</p>\n\n<p>Also, my macro refers to \u201cRange(\"G\" &amp; found).Value = pair\u201d at the end but nothing gets written. What I really need is to delete this or make it flexible to be written to specific cells, so it could be changed in the future or as I said just delete it.</p>\n\n<p>If someone could take a look and see what I\u2019m not seeing it sure would be appreciated.</p>\n\n<pre><code>Sub DIVIDE()\nApplication.ScreenUpdating = False\n\nDim pair As Variant, accumulator As Variant\nDim findFifteen As Double\nDim remainder As Long, found As Long\n\nfound = 1\n\nFor Each pair In Range(\"B30, F30, J30\")\nIf Right(pair, 2) = 15 Then\n    If pair.Offset(0, 1) &lt;= 12 Then\n        findFifteen = pair.Offset(0, 2) / 10\n        remainder = 0\n    Else\n        findFifteen = 1\n        remainder = pair.Offset(0, 2) Mod 10\n    End If\n\n    For Each accumulator In Range(\"A36, D36, G36, J36, M36, A40, D40, G40, J40, M40\")\n        If accumulator.Offset(-1, 0) = Val(Left(pair, InStr(pair, \"-\") - 1) Then\n            accumulator.Value = accumulator.Value + remainder\n        End If\n        accumulator.Value = accumulator.Value + findFifteen\n    Next accumulator\nRange(\"G\" &amp; found).Value = pair\nfound = found + 1\nEnd If\nNext pair\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NtiRq.jpg\" rel=\"nofollow noreferrer\">EXCEL IMAGE</a></p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545859029, "post_id": 53936598, "comment_id": 94714481, "body": "What do you mean <i>&quot;It closes the window with ie.Quit&quot;</i> - is that a line in your code?"}, {"owner": {"reputation": 509, "user_id": 6504003, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3a3ad98346f899ce98ee63955a59848?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Georgali", "link": "https://stackoverflow.com/users/6504003/maria-georgali"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545859348, "post_id": 53936598, "comment_id": 94714569, "body": "I mean it goes immediately to ie.quit without run ie.navigate..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545859433, "post_id": 53936598, "comment_id": 94714594, "body": "Are you giving it enough time to load? Typically when navigating URLs you need to use something like <code>While IE.Busy Or IE.ReadyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend</code> before your next line. If that doesn&#39;t work, try <code>Application.Wait Now + TimeValue(&quot;0:00:05&quot;)</code>"}, {"owner": {"reputation": 509, "user_id": 6504003, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3a3ad98346f899ce98ee63955a59848?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Georgali", "link": "https://stackoverflow.com/users/6504003/maria-georgali"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545860944, "post_id": 53936598, "comment_id": 94715075, "body": "Its working I tested 4-5 times, shall I put everytime the delay before I logout? because some sites they seemed to logout normaly. Thank you"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545863534, "post_id": 53936598, "comment_id": 94715708, "body": "Whenever you&#39;re navigating or clicking a button during run-time, you should absolutely use a delay of some sort. I&#39;ll add what I use below."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545881939, "post_id": 53936598, "comment_id": 94718538, "body": "There is almost certainly a better way. Is this a public url?"}, {"owner": {"reputation": 509, "user_id": 6504003, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3a3ad98346f899ce98ee63955a59848?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Georgali", "link": "https://stackoverflow.com/users/6504003/maria-georgali"}, "edited": false, "score": 0, "creation_date": 1545895273, "post_id": 53936598, "comment_id": 94721622, "body": "No unfortunately it is a login webpage"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1545863643, "creation_date": 1545863643, "answer_id": 53937856, "question_id": 53936598, "link": "https://stackoverflow.com/questions/53936598/can-not-logout-from-a-menu-button-with-vba/53937856#53937856", "title": "Can not logout from a menu button with vba", "body": "<p>I use this subroutine when doing any kind of web automation or screen scraping:</p>\n\n<pre><code>Sub Wait()\n\nWhile (IE.Busy Or IE.READYSTATE &lt;&gt; 4): DoEvents: Wend\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\nEnd Sub\n</code></pre>\n\n<p>I've found that the checking the ready state isn't always 100% reliable, so if time isn't of the essence, I use a 2 second buffer.</p>\n\n<p>So in your code it would look like:</p>\n\n<pre><code>ie.Navigate \"http://b2b.site.net/el/?mylogout=\"\nWait\nie.Quit\n</code></pre>\n\n<p>Alteratively, if you don't like seeing that extra line:</p>\n\n<pre><code>ie.Navigate \"http://b2b.site.net/el/?mylogout=\": Wait\nie.Quit\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 6504003, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3a3ad98346f899ce98ee63955a59848?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Georgali", "link": "https://stackoverflow.com/users/6504003/maria-georgali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 53937856, "answer_count": 1, "score": 0, "last_activity_date": 1578481836, "creation_date": 1545854640, "last_edit_date": 1578481836, "question_id": 53936598, "link": "https://stackoverflow.com/questions/53936598/can-not-logout-from-a-menu-button-with-vba", "title": "Can not logout from a menu button with vba", "body": "<p>I login to a webpage and when I try to logout it is just closes the window with </p>\n\n<pre><code>ie.Navigate \"http://b2b.site.net/el/?mylogout=\"\nie.Quit\n</code></pre>\n\n<p>and is not logout first\nI use the following to logout</p>\n\n<pre><code>ie.Navigate \"http://b2b.site.net/el/?mylogout=\"\n</code></pre>\n\n<p>And I tried with the following</p>\n\n<pre><code>ie.Document.getElementsByClassName(\"logout\").Click\n</code></pre>\n\n<p>the html part is</p>\n\n<pre><code>&lt;div class=\"header_user_info\"&gt;\n        &lt;a class=\"logout\" href=\"http://b2b.site.net/el/?mylogout=\" rel=\"nofollow\" title=\"Disconnect me\"&gt;\n        Disconnect\n    &lt;/a&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What I am doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545852868, "post_id": 53936247, "comment_id": 94712779, "body": "So you want to fill it with all the data in row 2, from column B til whatever column doesn&#39;t contain data?"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545853219, "post_id": 53936369, "comment_id": 94712859, "body": "+1 but also noting (for OP) that if you are using a <code>With</code> block, you can delete the <code>Sheets(&quot;Sheetname&quot;)</code> from your code unless its looking at a different sheet"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1545853607, "post_id": 53936369, "comment_id": 94712977, "body": "Thanks - and I noticed that as well. Hard to tell what their intent is."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 3, "last_activity_date": 1545853010, "creation_date": 1545853010, "answer_id": 53936369, "question_id": 53936247, "link": "https://stackoverflow.com/questions/53936247/loop-until-the-last-column-in-a-row-and-fill-combobox/53936369#53936369", "title": "Loop until the last column in a row and fill comboBox", "body": "<p>I think what you're looking for is:</p>\n\n<pre><code>Sheets(\"Sheetname\").Range(Cells(2, 2), Cells(2, Cells(2, Columns.Count).End(xlToLeft).Column))\n</code></pre>\n\n<p>Note - it looks like in your example you were using a <code>With</code> block - so add periods in front of all those cells to make sure your ranges are fully qualified.</p>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1545853631, "post_id": 53936390, "comment_id": 94712983, "body": "Probably the cleaner solution (storing a variable)."}, {"owner": {"reputation": 223, "user_id": 5132818, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FsnGv.jpg?s=128&g=1", "display_name": "xAminex", "link": "https://stackoverflow.com/users/5132818/xaminex"}, "edited": false, "score": 0, "creation_date": 1545853979, "post_id": 53936390, "comment_id": 94713077, "body": "hi Urdeaboy thanks for your answer but how can I loop on every cell and check if it&#39;s blank or not, if it&#39;s not I&#39;ll add it to my combobox ?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 223, "user_id": 5132818, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FsnGv.jpg?s=128&g=1", "display_name": "xAminex", "link": "https://stackoverflow.com/users/5132818/xaminex"}, "edited": false, "score": 0, "creation_date": 1545854258, "post_id": 53936390, "comment_id": 94713166, "body": "Updated @xAminex"}, {"owner": {"reputation": 223, "user_id": 5132818, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FsnGv.jpg?s=128&g=1", "display_name": "xAminex", "link": "https://stackoverflow.com/users/5132818/xaminex"}, "edited": false, "score": 0, "creation_date": 1545854716, "post_id": 53936390, "comment_id": 94713304, "body": "thanks urdearboy, I&#39;ll run the code and let you know. if it works I&#39;ll mark your answer as accepted :)"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 4, "last_activity_date": 1545856025, "last_edit_date": 1545856025, "creation_date": 1545853151, "answer_id": 53936390, "question_id": 53936247, "link": "https://stackoverflow.com/questions/53936247/loop-until-the-last-column-in-a-row-and-fill-combobox/53936390#53936390", "title": "Loop until the last column in a row and fill comboBox", "body": "<p>I would use a variable (<code>LC</code>) to store the column index of your last used column for readability. You should also declare a <code>Worksheet</code> variable, or use a <code>With Block</code> to ensure all of your objects are properly qualified. </p>\n\n<pre><code>Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim LC As Long\n\nLC = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column\n\nws.Range(ws.Cells(2, 2), ws.Cells(2, LC)).[what?]\n</code></pre>\n\n<hr>\n\n<p>Here is how you could implement a <code>Column Loop</code></p>\n\n<pre><code>Option Explicit\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim LC As Long\n\nLC = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column\n\nFor i = 2 To LC\n    If ws.Cells(2, i) = \"\" Then\n        MsgBox \"Blank Cell: \" &amp; ws.Cells(2, i).Address(False, False)\n    Else\n        MsgBox \"Non-Blank Cell: \" &amp; ws.Cells(2, i).Address(False, False)\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 2, "last_activity_date": 1545855869, "last_edit_date": 1545855869, "creation_date": 1545854518, "answer_id": 53936582, "question_id": 53936247, "link": "https://stackoverflow.com/questions/53936247/loop-until-the-last-column-in-a-row-and-fill-combobox/53936582#53936582", "title": "Loop until the last column in a row and fill comboBox", "body": "<h1>Fill Combo With Row (Resize Version)</h1>\n\n<h2>ActiveSheet</h2>\n\n<pre><code>Private Sub UserForm_Activate()\n\n   Const cStrFirst As String = \"A2\"           ' First Cell Range\n\n   Dim vntRange As Variant                    ' Range Array\n   Dim i As Integer                           ' Columns Counter\n\n   vntRange = Range(cStrFirst).Resize(, Cells(Range(cStrFirst).Row, _\n       Columns.Count).End(xlToLeft).Column)\n\n   For i = 1 To UBound(vntRange, 2)\n     If vntRange(1, i) &lt;&gt; \"\" Then\n       ComboBox1.AddItem vntRange(1, i)\n     End If\n   Next\n\nEnd Sub\n</code></pre>\n\n<h2>Any Sheet</h2>\n\n<pre><code>Private Sub UserForm_Activate()\n\n   Const cStrSheet As Variant = \"Sheetname\"   ' Sheet Name/Index\n   Const cStrFirst As String = \"A2\"           ' First Cell Range\n\n   Dim vntRange As Variant                    ' Range Array\n   Dim i As Integer                           ' Columns Counter\n\n   With Worksheets(cStrSheet)\n     vntRange = .Range(cStrFirst).Resize(, .Cells(.Range(cStrFirst).Row, _\n       .Columns.Count).End(xlToLeft).Column)\n   End With\n\n   For i = 1 To UBound(vntRange, 2)\n     If vntRange(1, i) &lt;&gt; \"\" Then\n       ComboBox1.AddItem vntRange(1, i)\n     End If\n   Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545857786, "post_id": 53936768, "comment_id": 94714139, "body": "May I suggest swapping 65536 with a number better representing the last row? Also you could move <code>xrow2 = xrow2 + 1</code> outside of the <code>If</code> block, no need for the extra line :)"}, {"owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545862347, "post_id": 53936768, "comment_id": 94715454, "body": "good point I fixed the latter.  I used 2 to 65536 because that was the range that OP used in his example."}], "tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 2, "last_activity_date": 1545862006, "last_edit_date": 1545862006, "creation_date": 1545855787, "answer_id": 53936768, "question_id": 53936247, "link": "https://stackoverflow.com/questions/53936247/loop-until-the-last-column-in-a-row-and-fill-combobox/53936768#53936768", "title": "Loop until the last column in a row and fill comboBox", "body": "<pre><code>dim xrow1 as long, xrow2 as long, ws1 as Worksheet, ws2 as Worksheet\n\nset ws1 = ThisWorkbook.Worksheets(\"worksheet1\")\nset ws2 = ThisWorkbook.Worksheets(\"worksheet2\")\nxrow2 = 2\n\nfor xrow1 = 2 to 65536\n    if ws1.cells(xrow1, 1) = \"\" Then\n    else\n        ws1.cells(xrow1, 1).value = ws2.cells(xrow2, 1).value     \n    end if\n    xrow2 = xrow2 + 1\nnext xrow1\n</code></pre>\n\n<p>This would copy all the values in the first column of ws1 to ws2 and skip over all of the blank rows. I'm not familiar with the specific syntax for a combo box, but I assume if you altered my code slightly, you could make it work.</p>\n\n<p>If you want me to code something specific to your project, let me see what you have written so far and/or some of the data you want transferred.</p>\n"}], "owner": {"reputation": 223, "user_id": 5132818, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FsnGv.jpg?s=128&g=1", "display_name": "xAminex", "link": "https://stackoverflow.com/users/5132818/xaminex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "accepted_answer_id": 53936390, "answer_count": 4, "score": 0, "last_activity_date": 1578481906, "creation_date": 1545852132, "last_edit_date": 1578481906, "question_id": 53936247, "link": "https://stackoverflow.com/questions/53936247/loop-until-the-last-column-in-a-row-and-fill-combobox", "title": "Loop until the last column in a row and fill comboBox", "body": "<p>How to fill my ComboBox1 with all the values of a row without blanks from B2 until the End of the row?</p>\n\n<p>I know :</p>\n\n<pre><code>Sheets(\"Sheetname\").Range(\"A2:A\" &amp; .Range(\"A65536\").End(xlUp).Row).Value\n</code></pre>\n\n<p>but this is the code to loop until the last row in a column, I want to do the opposite.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10835876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1904aa14e6158d75dbf265cffbe618?s=128&d=identicon&r=PG&f=1", "display_name": "Bloodrazor", "link": "https://stackoverflow.com/users/10835876/bloodrazor"}, "edited": false, "score": 0, "creation_date": 1545967385, "post_id": 53939095, "comment_id": 94745002, "body": "I am trying to work on this, just doesn&#39;t seem to do anything no matter what I do and how I run the code. I managed to get it to at least give me an error with the line below; &#39;Item.SaveAs sPath &amp; sName, olMSG&#39; it gives me Run-time error &#39;-21447286788 (800300fc)&#39;: The Operation Failed. I have modified default folder locations so I&#39;m trying something generic first such as c:\\test\\ and I have no idea how to use the code more or less...I mean I get the idea of what the commands are doing but I&#39;m quite sure problem might be just in the fact that I don&#39;t have enough knowledge in coding."}, {"owner": {"reputation": 5, "user_id": 10835876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1904aa14e6158d75dbf265cffbe618?s=128&d=identicon&r=PG&f=1", "display_name": "Bloodrazor", "link": "https://stackoverflow.com/users/10835876/bloodrazor"}, "edited": false, "score": 0, "creation_date": 1545968531, "post_id": 53939095, "comment_id": 94745211, "body": "I&#39;ve figure it out (had file path mistake in the code)! This is genius! So much fun Thank you so much for that! Quick question: in my understanding enviro = CStr(Environ(&quot;USERPROFILE&quot;)) let&#39;s VB know that we are working within certain user files correct? I understand I can actually input whole destination in that command. Could I also restrict this code to react to only certain group of emails? For example we receive ton of emails with the headline NEW SALE or NEW PURCHASE could I use this fact for VB to react only to those mails?"}], "tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": true, "score": 0, "last_activity_date": 1545877553, "creation_date": 1545877553, "answer_id": 53939095, "question_id": 53935490, "link": "https://stackoverflow.com/questions/53935490/exporting-new-email-to-file/53939095#53939095", "title": "Exporting new email to file", "body": "<p>You could use this code, paste it in the ThisOutlookSession module. </p>\n\n<p>To test this code sample without restarting Outlook, click in the Application_Startup procedure then click Run.</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n  Dim Ns As Outlook.NameSpace\n  Set Ns = Application.GetNamespace(\"MAPI\")\n  Set Items = Ns.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n  If TypeOf Item Is Outlook.MailItem Then\n\n  Dim sPath As String\n  Dim dtDate As Date\n  Dim sName As String\n  Dim enviro As String\n\n  enviro = CStr(Environ(\"USERPROFILE\"))\n\n  sName = Item.Subject\n  ReplaceCharsForFileName sName, \"_\"\n\n  dtDate = Item.ReceivedTime\n  sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(dtDate, \"-hhnnss\", _\n    vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; sName &amp; \".msg\"\n\n' use My Documents for older Windows.\n    sPath = enviro &amp; \"\\Documents\\\"\n  Debug.Print sPath &amp; sName\n  Item.SaveAs sPath &amp; sName, olMSG\n\n  End If\n\nEnd Sub\n\nPrivate Sub ReplaceCharsForFileName(sName As String, _\n  sChr As String _\n)\n  sName = Replace(sName, \"/\", sChr)\n  sName = Replace(sName, \"\\\", sChr)\n  sName = Replace(sName, \":\", sChr)\n  sName = Replace(sName, \"?\", sChr)\n  sName = Replace(sName, Chr(34), sChr)\n  sName = Replace(sName, \"&lt;\", sChr)\n  sName = Replace(sName, \"&gt;\", sChr)\n  sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://www.slipstick.com/outlook/archive-outlook/save-incoming-messages-hard-drive/\" rel=\"nofollow noreferrer\">Save all incoming messages to the hard drive</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/49250227/save-outlook-mail-automatically-to-a-specified-folder\">Save outlook mail automatically to a specified folder</a></p>\n"}], "owner": {"reputation": 5, "user_id": 10835876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1904aa14e6158d75dbf265cffbe618?s=128&d=identicon&r=PG&f=1", "display_name": "Bloodrazor", "link": "https://stackoverflow.com/users/10835876/bloodrazor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 53939095, "answer_count": 1, "score": 0, "last_activity_date": 1592699066, "creation_date": 1545847451, "last_edit_date": 1592699066, "question_id": 53935490, "link": "https://stackoverflow.com/questions/53935490/exporting-new-email-to-file", "title": "Exporting new email to file", "body": "<p>There are a few sources from which we receive specific emails. The easiest way to categorize them is by mail title or even source email address.</p>\n\n<p>We are trying to automatically save all incoming emails to file, whether it's a TXT or PDF so we can pull up a back up file when there is a problem with the network, email or whatever else is malfunctioning.</p>\n\n<p>I tried to create a macro from a few similar topics;</p>\n\n<pre><code>Private Sub Application_Startup()\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox  As Outlook.MAPIFolder\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    If TypeOf Item Is Outlook.MailItem Then\n        SaveMailAsFile Item ' call sub\n    End If\nEnd Sub\n\nPublic Sub SaveMailAsFile(ByVal Item As Object)\n\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim Items As Outlook.Items\n    Dim ItemSubject As String\n    Dim NewName As String\n    Dim RevdDate As Date\n    Dim Path As String\n    Dim Ext As String\n    Dim i As Long\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Inbox.Items.Restrict(\"[Subject] = 'VVAnalyze Results'\")\n\n    Path = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\Backup Reports\\\"\n    ItemSubject = Item.Subject\n    RevdDate = Item.ReceivedTime\n    Ext = \"txt\"\n\n    For i = Items.Count To 1 Step -1\n        Set Item = Items.Item(i)\n\n        DoEvents\n\n        If Item.Class = olMail Then\n            Debug.Print Item.Subject ' Immediate Window\n            Set SubFolder = Inbox.Folders(\"Temp\") ' &lt;--- Update Fldr Name\n\n            ItemSubject = Format(RevdDate, \"YYYYMMDD-HHNNSS\") _\n                                                    &amp; \" - \" &amp; _\n                                            Item.Subject &amp; Ext\n\n            ItemSubject = FileNameUnique(Path, ItemSubject, Ext)\n\n            Item.SaveAs Path &amp; ItemSubject, olTXT\n            Item.Move SubFolder\n        End If\n    Next\n\n    Set olNs = Nothing\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set Items = Nothing\n\nEnd Sub\n\n\n'// Check if the file exists\nPrivate Function FileExists(FullName As String) As Boolean\nDim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    If fso.FileExists(FullName) Then\n        FileExists = True\n    Else\n        FileExists = False\n    End If\n\n    Exit Function\nEnd Function\n\n'// If the same file name exist then add (1)\nPrivate Function FileNameUnique(Path As String, _\n                               FileName As String, _\n                               Ext As String) As String\nDim lngF As Long\nDim lngName As Long\n    lngF = 1\n    lngName = Len(FileName) - (Len(Ext) + 1)\n    FileName = Left(FileName, lngName)\n\n    Do While FileExists(Path &amp; FileName &amp; Chr(46) &amp; Ext) = True\n        FileName = Left(FileName, lngName) &amp; \" (\" &amp; lngF &amp; \")\"\n        lngF = lngF + 1\n    Loop\n\n    FileNameUnique = FileName &amp; Chr(46) &amp; Ext\n\n    Exit Function\nEnd Function\n</code></pre>\n\n<p>While I understand that Outlook cache is available even off line some are insisting to have back up files on a physical hard drive.</p>\n\n<p>I know I could manually select those files and create a copy by drag&amp;drop but that is insufficient.</p>\n\n<p>I am aware of\n<a href=\"https://www.techhit.com/messagesave/screenshots.html\" rel=\"nofollow noreferrer\">https://www.techhit.com/messagesave/screenshots.html</a>. It would be difficult to have this idea accepted because GDPR blah blah blah.</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 2, "creation_date": 1545844858, "post_id": 53935051, "comment_id": 94710283, "body": "1-D arrays are zero-based by default, not 1-based. <code>ReDim Signals(1)</code> creates an array of <code>Signals(0 to 1)</code> with two elements, not one."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1545844894, "post_id": 53935051, "comment_id": 94710294, "body": "Your problem goes away if you use a scripting.dictionary."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545845109, "post_id": 53935051, "comment_id": 94710369, "body": "@Freeflow The OP clearly states that the issue is about arrays and information about dictionaries and collections is not desired."}, {"owner": {"reputation": 28, "user_id": 10836028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b40c79963a9230f0d0895ebf435b769?s=128&d=identicon&r=PG&f=1", "display_name": "DBraun", "link": "https://stackoverflow.com/users/10836028/dbraun"}, "edited": false, "score": 0, "creation_date": 1545845237, "post_id": 53935051, "comment_id": 94710415, "body": "@user10829321 Ah okay, so I know Arrays are zero-based but I didn&#39;t know if I needed to initialize it as Signals(0) to make have it contain one value."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545845260, "post_id": 53935051, "comment_id": 94710423, "body": "Welcome to Stack Overflow :-) It helps others to help you when all relevant information is included in the question. Sometimes, it&#39;s possible to guess, but not always. This question is missing a description of <i>how</i> the code doesn&#39;t work. If there&#39;s an error, the error message should be included as well as the line of code that triggers the error. If the result is incorrect it helps to have a description of the desired result as well as the result the code produces."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1545845649, "post_id": 53935051, "comment_id": 94710556, "body": "I appreciate that the OP isn&#39;t interested in a collection or dictionary answer but the use of a dictionary is the easiest way to the array that the OP desires.  With a scripting.dictionary you can obtain an array of the items using the .Items method.  Consequently I&#39;d recommend a dictionary as an intermediate step to getting the desired array."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545845849, "post_id": 53935051, "comment_id": 94710610, "body": "The fastest solution for unique values using Autofilter: <a href=\"https://stackoverflow.com/questions/53891590/vba-create-empty-lists-and-then-append-elements-to-that-list/53892239#53892239\">Spare a Column</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1545846000, "post_id": 53935051, "comment_id": 94710662, "body": "FWIW arrays being zero-based is just a default; <code>Option Base</code> controls the lower bound of implicitly-sized arrays, with the default being <code>Option Base 0</code>. Also... keeping this an &quot;array problem&quot; makes it an inefficient O(n^2) solution. Resizing an array is a costly operation, and repeatedly resizing it by one incurs serious overhead. If you don&#39;t know how many items you&#39;re going to need from the start, you shouldn&#39;t be using an array. Knowing what data structure to use, and when to use them, is more important than knowing how to abuse arrays."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545845578, "post_id": 53935122, "comment_id": 94710532, "body": "<code>inlist = True</code> should be followed by <code>exit for</code> but <code>iserror(application.match(Cells(n, colnum).Value, list, 0))</code> would be true if there were no matches in the array without the loop."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545845823, "post_id": 53935122, "comment_id": 94710604, "body": "@user10829321 Thanks for your suggestions - I&#39;ve added the simpler solution to my answer."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545846304, "post_id": 53935122, "comment_id": 94710752, "body": "@user10829321 It&#39;s fine, I appreciate the criticism, and you are right. I had acknowledged this was a poor answer on the original thread, band-aid solutions are ugly :)"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1545846263, "last_edit_date": 1545846263, "creation_date": 1545845055, "answer_id": 53935122, "question_id": 53935051, "link": "https://stackoverflow.com/questions/53935051/check-if-value-is-in-an-array-and-if-its-not-add-it-to-the-end/53935122#53935122", "title": "Check if Value is in an Array and if it&#39;s not add it to the end", "body": "<p>I posted a solution to this issue using arrays in a similar question a couple days ago - using column B for your case, this would do the trick.</p>\n\n<p>Aside from this solution, you have several problems in your current code - you're testing against each individual element in your current array without checking them all first, you're not using <code>ReDim Preserve</code>, and you need <code>(0 to 0)</code>, not just a single <code>(0)</code> or <code>(1)</code>. You're also naming your subroutine \"Signals\" while attempting to declare a variable \"Signals\" in the subroutine as well... That'll cause all kinds of issues.</p>\n\n<pre><code>Sub Test()\n\nDim list() As Variant\nDim inlist As Boolean\nDim n As Long, i As Long, j As Long, endrow As Long, colnum As Long\n\nReDim list(0 To 0)\ninlist = False\nj = 0\ncolnum = 2 'Column B in this case\nendrow = Cells(Rows.Count, colnum).End(xlUp).Row\n\nFor n = 1 To endrow\n    For i = 0 To UBound(list)\n        If list(i) = Cells(n, colnum).Value Then\n            inlist = True\n            Exit For\n        End If\n    Next i\n\n    If inlist = False Then\n        ReDim Preserve list(0 To j)\n        list(j) = Cells(n, colnum).Value\n        j = j + 1\n    End If\n\n    inlist = False\nNext n\n\nFor i = 0 To UBound(list)\n    Debug.Print list(i)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Even simpler solution thanks to @user10829321's suggestions:</p>\n\n<pre><code>Sub Test()\n\nDim list() As Variant\nDim n As Long, i As Long, j As Long, endrow As Long, colnum As Long\n\nReDim list(0 To 0)\nj = 0\ncolnum = 2 'Column B in this case\nendrow = Cells(Rows.Count, colnum).End(xlUp).Row\n\nFor n = 1 To endrow\n    If IsError(Application.Match(Cells(n, colnum).Value, list, 0)) Then\n        ReDim Preserve list(0 To j)\n        list(j) = Cells(n, colnum).Value\n        j = j + 1\n    End If\nNext n\n\nFor i = 0 To UBound(list)\n    Debug.Print list(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28, "user_id": 10836028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b40c79963a9230f0d0895ebf435b769?s=128&d=identicon&r=PG&f=1", "display_name": "DBraun", "link": "https://stackoverflow.com/users/10836028/dbraun"}, "edited": false, "score": 0, "creation_date": 1545847811, "post_id": 53935440, "comment_id": 94711157, "body": "thank you for taking the time to show me the correct method for approaching the problem!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545847883, "post_id": 53935440, "comment_id": 94711182, "body": "You can get rid of the .Exists check if you use the shorthand/overwrite dictionary .Add method, e.g. <code>interim_dic.Item(element) = element</code>. While it won&#39;t make much difference for 17-32 records, it actually makes a big improvement for larger (100K) records."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545848598, "post_id": 53935440, "comment_id": 94711434, "body": "Yes.  But I assumed that the OP wasn&#39;t familiar with dictionaries so I tried to keep it as simple as I could."}, {"owner": {"reputation": 28, "user_id": 10836028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b40c79963a9230f0d0895ebf435b769?s=128&d=identicon&r=PG&f=1", "display_name": "DBraun", "link": "https://stackoverflow.com/users/10836028/dbraun"}, "edited": false, "score": 0, "creation_date": 1545927689, "post_id": 53935440, "comment_id": 94734314, "body": "@Freeflow So can you explain why you&#39;re using .value2 instead of .value; I&#39;m reading another thread regarding the explanation which summarized basically says always use .value2 but I would like your input regarding this particular situation. \\n it would be nice of you to explain the &quot;Signals(ByRed this_worksheet_range As excel.range)&quot; OH IS IT SIMPLY YOUR WAY OF TELLING ME TO USE MY OWN RANGE IN PLACE OF THAT VARIABLE YOU HAVE FOR EXAMPLE &quot;myArray = Sheets(WsName).Range(&quot;B1&quot;).values2&quot;"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1545997019, "post_id": 53935440, "comment_id": 94753413, "body": ".Value takes note of the locale whereas .Value2 doesn&#39;t.  Your initial question was to get an array of unique values from an excel range.  That&#39;s a function description.  When I looked at your code it was easy to consolidate things into a function which took an excel range and returned the desired array.  Organizing code into functions/subs that do one thing and one thing well makes your code more readable and easier to update/maintain."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 1, "last_activity_date": 1545847182, "creation_date": 1545847182, "answer_id": 53935440, "question_id": 53935051, "link": "https://stackoverflow.com/questions/53935051/check-if-value-is-in-an-array-and-if-its-not-add-it-to-the-end/53935440#53935440", "title": "Check if Value is in an Array and if it&#39;s not add it to the end", "body": "<p>An optional, if perhaps unwanted, solution using a scripting dictionary to give an array.</p>\n\n<pre><code>Public Function Signals(ByRef this_worksheet_range As excel.Range) As Variant()\n\nDim myArray()       As Variant\nDim element         As Variant\nDim interim_dic     As Scripting.Dictionary\n\n    myArray = this_worksheet_range.values2\n\n    Set interim_dic = New Scripting.Dictionary\n\n    For Each element In myArray\n        If Not interim_dic.Exists(element) Then\n            interim_dic.Add Key:=element, Item:=element\n        End If\n    Next\n\n    Signals = interim_dic.Items\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 10836028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b40c79963a9230f0d0895ebf435b769?s=128&d=identicon&r=PG&f=1", "display_name": "DBraun", "link": "https://stackoverflow.com/users/10836028/dbraun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53935122, "answer_count": 2, "score": 0, "last_activity_date": 1545847182, "creation_date": 1545844597, "last_edit_date": 1545845743, "question_id": 53935051, "link": "https://stackoverflow.com/questions/53935051/check-if-value-is-in-an-array-and-if-its-not-add-it-to-the-end", "title": "Check if Value is in an Array and if it&#39;s not add it to the end", "body": "<p>I'm trying to create an array with only unique values (Signal Names). For example my spreadsheet looks like this</p>\n\n<p>Voltage\nVoltage\nVoltage\nCurrent\nCurrent\nCurrent\netc....</p>\n\n<p>I've got 32 signals however, I want this to work even if I don't know I have 32 signals explicitly i.e. 17 signals. </p>\n\n<p>Signals(\"Voltage\", \"Current\", \"Etc....\")</p>\n\n<p><strong>IN THE CODE BELOW</strong></p>\n\n<p>I realize I'm trying to ReDim an array within a loop and that's the problem. I'm just not able to think of another way of doing this. I would prefer to keep it as an array problem and not a dictionary or collection problem for now.</p>\n\n<pre><code>Public Sub Signals()\n\nDim myArray() As Variant\nDim Signals() As Variant\nDim element As Variant\nDim intA As Integer\n\nWsName = ActiveSheet.Name\n\nintRows = Sheets(WsName).Range(\"B2\", Sheets(WsName).Range(\"B\" &amp; Sheets(WsName).Rows.Count).End(xlUp)).Rows.Count\nintRows = intRows + 1\n\nReDim Signals(1)\nSignals(1) = Sheets(WsName).Cells(4, 2).Value\n\nFor intA = 4 To intRows\n    For Each element In Signals()\n        If element &lt;&gt; Sheets(WsName).Cells(intA, 2) Then\n            ReDim Signals(UBound(Signals) + 1) 'This throws the error\n            Signals(UBound(Signals)) = Sheets(WsName).Cells(intA, 2).Value\n        End If\n    Next element\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>How the code doesn't work - RunTime Error '10' Array is temporarily fixed or locked.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545843880, "post_id": 53934886, "comment_id": 94709954, "body": "You might be better off using the macro recorder to record a new macro."}, {"owner": {"reputation": 21, "user_id": 10835953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6144331641ded80cc2a62ecb00f695?s=128&d=identicon&r=PG&f=1", "display_name": "Katharina", "link": "https://stackoverflow.com/users/10835953/katharina"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1545844301, "post_id": 53934886, "comment_id": 94710097, "body": "I used Makro-Recoder for Powerpoint 2003. But for the actual version I don&#39;t know how to use one. Do you have an advice?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545844742, "post_id": 53934886, "comment_id": 94710242, "body": "@Katharina You can&#39;t record macros in PowerPoint 2016 + anymore - what are you trying to do exactly? Your question isn&#39;t clear."}, {"owner": {"reputation": 21, "user_id": 10835953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6144331641ded80cc2a62ecb00f695?s=128&d=identicon&r=PG&f=1", "display_name": "Katharina", "link": "https://stackoverflow.com/users/10835953/katharina"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545939093, "post_id": 53934886, "comment_id": 94738473, "body": "@dwirony I want to delete all highlighting &quot;on&quot; text in all shapes of a powerpoint file :-)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545939141, "post_id": 53934886, "comment_id": 94738495, "body": "I don&#39;t know what you mean by &quot;on&quot; - so you want to un-highlight all highlighted text in powerpoint?"}, {"owner": {"reputation": 21, "user_id": 10835953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6144331641ded80cc2a62ecb00f695?s=128&d=identicon&r=PG&f=1", "display_name": "Katharina", "link": "https://stackoverflow.com/users/10835953/katharina"}, "edited": false, "score": 1, "creation_date": 1545939425, "post_id": 53934886, "comment_id": 94738586, "body": "Yes - un-highlight and/or hide. I just added two Makros from Word to my Question, which will perhaps better show the request."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545939797, "post_id": 53934886, "comment_id": 94738705, "body": "@Katharina I&#39;m not on office 365, but you could maybe try finding text then using a find/replace on it with the same word - that might remove the highlighting."}, {"owner": {"reputation": 21, "user_id": 10835953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6144331641ded80cc2a62ecb00f695?s=128&d=identicon&r=PG&f=1", "display_name": "Katharina", "link": "https://stackoverflow.com/users/10835953/katharina"}, "edited": false, "score": 0, "creation_date": 1545941516, "post_id": 53934886, "comment_id": 94739226, "body": "Unfortunately there is too many highlighted text..."}], "owner": {"reputation": 21, "user_id": 10835953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6144331641ded80cc2a62ecb00f695?s=128&d=identicon&r=PG&f=1", "display_name": "Katharina", "link": "https://stackoverflow.com/users/10835953/katharina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1563971536, "creation_date": 1545843599, "last_edit_date": 1563971536, "question_id": 53934886, "link": "https://stackoverflow.com/questions/53934886/powerpoint-vba-delete-hide-highlight-on-all-text", "title": "Powerpoint vba: Delete/Hide Highlight on all text", "body": "<p>In PowerPoint for Office 365 there is a new functionality:\n<a href=\"https://support.office.com/en-us/article/highlight-your-text-28623777-d955-4fcf-bbc5-a50051552219\" rel=\"nofollow noreferrer\">Text highlighting</a>.</p>\n\n<p>With this new function I can highlight text in shapes but want to delete or hide this later on (for a student version of the ppt).\nFor Word I <a href=\"https://docs.microsoft.com/de-de/office/vba/api/word.find.highlight\" rel=\"nofollow noreferrer\">found a macro which works</a>:</p>\n\n<pre><code>Sub UnHighlight\n    Dim rngTemp As Range\n    Set rngTemp = ActiveDocument.Range(Start:=0, End:=0)\n    With rngTemp.Find\n        .ClearFormatting\n        .Highlight = True\n        With .Replacement\n            .ClearFormatting\n            .Highlight = False\n        End With\n        .Execute Replace:=wdReplaceAll, Forward:=True,\n        FindText:=\"\", _\n        ReplaceWith:=\"\", Format:=True\n    End With\nEnd sub\n</code></pre>\n\n<p>Any idea to adapt this for powerpoint?</p>\n\n<hr>\n\n<p>Adapting <a href=\"https://docs.microsoft.com/de-de/office/vba/api/word.view.showhighlight\" rel=\"nofollow noreferrer\">something like this from WORD</a> for POWERPOINT would also be helpful:</p>\n\n<pre><code>Sub PrintWithoutHighlight()\n    With ActiveDocument\n        .ActiveWindow.View.Showhighlight = False\n        .PrintOut\n    End With\nEnd Sub\n</code></pre>\n\n<p>Or Hide Highlighting:</p>\n\n<pre><code>Sub HighlightingHide()\n    ActiveDocument.ActiveWindow.View.Showhighlight = _\n        Not ActiveDocument.ActiveWindow.View.Showhighlight\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "lookup"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 3, "creation_date": 1545844658, "post_id": 53934782, "comment_id": 94710207, "body": "<i>I am using r1c1 because it is <b>quicker</i></b> Quicker? What?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1545846133, "post_id": 53934782, "comment_id": 94710698, "body": "You <i>really</i> need to use <code>Option Explicit</code> and properly declare all your variables - it&#39;s hard to know if <code>SSheet</code> is a typo or a variable. Also, try to avoid using so many comments - comments are supposed to increase readability, not hinder it."}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1545858518, "creation_date": 1545858518, "answer_id": 53937184, "question_id": 53934782, "link": "https://stackoverflow.com/questions/53934782/vba-formula-r1c1-help-need/53937184#53937184", "title": "Vba Formula R1C1 help need", "body": "<p>Your code is difficult to follow. Ignoring the details, seems like you want to:</p>\n\n<ul>\n<li>Loop through all worksheets (except two) in <code>cbook</code>.</li>\n<li>For each worksheet you loop through, you want to perform a few VLOOKUPs between <code>cbook</code> and <code>pbook</code>.</li>\n<li>and hard code the results of the VLOOKUPs as static values in <code>cbook</code>.</li>\n</ul>\n\n<p>Maybe try the below and see how far you get. You will need to change the file paths in the code to match your own.</p>\n\n<p>It's likely my code doesn't do everything you want/yours did. It's also advisable that you <strong>make copies</strong> of your current workbook and previous workbook and have the code refer to those copies when you run it.</p>\n\n<pre><code>Option Explicit\n\nSub LookUpRangeInPreviousWorkbook()\n\n    Dim currentWorkbook As Workbook\n    Set currentWorkbook = Workbooks.Open(\"C:\\Users\\user\\misc.xlsb\") ' If you're putting your VBA code into currentWorkbook and running it from there, then you may as well just use 'Thisworkbook'\n\n    Dim previousWorkbook As Workbook\n    Set previousWorkbook = Workbooks.Open(\"C:\\Users\\user\\lol.xlsb\") ' JRDCPriorNoBrk is not assigned anywhere in your code, hence it's not assigned anywhere in mine.\n\n    Dim sheetsToSkip As Variant\n    sheetsToSkip = Array(\"Original\", \"JobReq &amp; DataChg INST\")\n\n    Dim currentSheet As Worksheet ' The worksheet from the current workbook that is being looped over. Make the variable name better if possible.\n\n    For Each currentSheet In currentWorkbook.Worksheets\n        If IsError(Application.Match(currentSheet.Name, sheetsToSkip, 0)) Then\n\n            'unprotects sheets so user can run macro\n            currentSheet.Unprotect\n\n            With previousWorkbook.Worksheets(currentSheet.Name) ' This will throw an error if the previous workbook does not contain the current sheet in the current workbook\n                Dim lastRowInPreviousWorkbook As Long\n                lastRowInPreviousWorkbook = .Cells(.Rows.Count, \"AF\").End(xlUp).Row\n\n                Dim rangeAddressFromPreviousWorkbook As String ' This doesn't change below, so just assign it once here.\n                rangeAddressFromPreviousWorkbook = .Range(\"AF2:AJ\" &amp; lastRowInPreviousWorkbook).Address(RowAbsolute:=True, ColumnAbsolute:=True, ReferenceStyle:=xlA1, External:=True)\n            End With\n\n            With currentSheet\n                Dim lastRowInCurrentWorkbook As Long\n                lastRowInCurrentWorkbook = .Cells(.Rows.Count, \"AF\").End(xlUp).Row\n\n                With .Range(\"AG2:AG\" &amp; lastRowInCurrentWorkbook)\n                    .Formula = \"=VLOOKUP(AF2,\" &amp; rangeAddressFromPreviousWorkbook &amp; \", 2, 0)\"\n                    .Value = .Value\n                End With\n                With .Range(\"AH2:AH\" &amp; lastRowInCurrentWorkbook)\n                    .Formula = \"=VLOOKUP(AF2,\" &amp; rangeAddressFromPreviousWorkbook &amp; \", 3, 0)\"\n                    .Value = .Value\n                End With\n                With .Range(\"AI2:AI\" &amp; lastRowInCurrentWorkbook)\n                    .Formula = \"=VLOOKUP(AF2,\" &amp; rangeAddressFromPreviousWorkbook &amp; \", 4, 0)\"\n                    .Value = .Value\n                End With\n                With .Range(\"AJ2:AJ\" &amp; lastRowInCurrentWorkbook)\n                    .Formula = \"=VLOOKUP(AF2,\" &amp; rangeAddressFromPreviousWorkbook &amp; \", 5, 0)\"\n                    .Value = .Value\n                End With\n            End With\n\n            ' Do you need re-protect the sheet now? Loop proceeds to next sheet in a few lines.\n        End If\n    Next currentSheet\n\n    ' You might need to save either/both files -- or do something of that nature here.\n\n    MsgBox (\"Copying from the prior list is complete.\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4687580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b01efcf438b72336c616e0962630332?s=128&d=identicon&r=PG&f=1", "display_name": "Michele", "link": "https://stackoverflow.com/users/4687580/michele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545858518, "creation_date": 1545842993, "last_edit_date": 1545843120, "question_id": 53934782, "link": "https://stackoverflow.com/questions/53934782/vba-formula-r1c1-help-need", "title": "Vba Formula R1C1 help need", "body": "<p>I would like to use the r1c1 formula to do a lookup for the values in column AF from the current workbook (cbook) and compare that to the values in the prior workbook (pbook).  I am using r1c1 because it is quicker, but am open to other methods.</p>\n\n<p>I would like to copy the values from columns AG, AH, AI and AJ.  I have done research to create the correct code, but and struggling with the range and address (Srng.Address) as well as adding the name of the worksheet to the variable.  </p>\n\n<p>Srng is the path and filename of the prior workbook, but the .Address give the cell where the variable exists.  (I have a variable workbook (InstVariable) and the cell is in C28, but I need the string value).  I have tried with many unsuccessful attempts to define the Srang, which is the path with Worksheet name of the prior workbook.  The worksheet should be the name of the current workbook.</p>\n\n<p>Here is part of my code below.  Any help is appreciated!</p>\n\n<pre><code> 'Current List Template\n    Dim cbook As Workbook\n    Set cbook = ActiveWorkbook\n\n\n    'Prior List Template\n    Dim pbook As Workbook\n    'Workbook\n   ' Set pbook = Workbooks.Open(JRDCPriorNoBrk)\n\n    cbook.Activate\n\n\n    '********************\n    'Turns off screen updates (no flashes)\n    '********************\n    With Application\n        '.Calculation = xlCalculationManual\n        .ScreenUpdating = False\n    End With\n\n\n\n\n    'Make sure user is on JobReq &amp; DataChg INST tab to run macro\n    Sheets(\"JobReq &amp; DataChg INST\").Activate\n\n\n    'unshare the workbook to run macro\n    'ActiveWorkbook.SaveAs ActiveWorkbook.FullName, accessmode:=xlExclusive\n    Application.DisplayAlerts = False\n   ' ActiveWorkbook.ExclusiveAccess\n\n\nFor Each xworksheet In ActiveWorkbook.Worksheets\n\n    xworksheet.Activate\n\nIf ActiveSheet.Name = \"Original\" Or ActiveSheet.Name = \"JobReq &amp; DataChg INST\" Then GoTo NotThisSheet\n\n    'unprotects sheets so user can run macro\n    ActiveSheet.Unprotect\n\n\n    'ActiveSheet.Range(\"AG2\").Select\n\n    Dim Srng As Range\n    Dim LastRow As Long\n\n    'Set Srng = Worksheets(\"Coniguration\").Range(\"_Configuration\")\n    'Set Srng = ActiveSheet.Range(\"AF2:AJ18\")\n\n    'pbook.Worksheet (cbook.ActiveSheet.Name)\n     'LastRowp = .Cells(.Rows.Count, \"AF\").End(xlUp).Row\n\n\n     'Set Srng = pbook.Worksheet(ActiveSheet.Name)\n     'Set Srng = PathJRDCPrior.ActiveSheet.Range(\"AF2:AJ\" &amp; LastRowp)\n\n\n\n\n\n    With ActiveSheet\n\n\n     'With pbook.Worksheets(cbook.ActiveSheet.Name)\n    'With Worksheets(\" &amp; PathJRDCPrior &amp; \")\n        'current worksheet last row\n        LastRow = .Cells(.Rows.Count, \"AF\").End(xlUp).Row\n\n        'prior worksheet last row\n        'MsgBox (cbook.ActiveSheet.Name)\n        With pbook.Worksheets(cbook.ActiveSheet.Name)\n        'pbook.Worksheets (cbook.ActiveSheet.Name)\n        LastRowp = .Cells(.Rows.Count, \"AF\").End(xlUp).Row\n        SSheet = cbook.ActiveSheet.Name\n        Set SPath = PathJRDCPrior\n\n        'Set Srng = PathJRDCPrior.ActiveSheet.Range(\"AF2:AJ\" &amp; LastRowp)\n        'Srng = pbook.Worksheets(cbook.ActiveSheet.Name).Range(\"AF2:AJ\" &amp; LastRowp)\n        Set Srng = Worksheets(SSheet).Range(\"AF2:AJ\" &amp; LastRowp)\n        End With\n       ' MsgBox (Srng)\n\n        With cbook.ActiveSheet.Range(\"AG2:AG\" &amp; LastRow)\n                   With cbook.ActiveSheet.Range(\"AG2:AG\" &amp; LastRow)\n            **.FormulaR1C1 = \"=VLOOKUP(RC32,\" &amp; Srng.Address(, , xlR1C1, True) &amp; \", 2, 0)\"**\n\n\n            .Value = .Value\n        End With\n        With cbook.ActiveSheet.Range(\"AH2:AH\" &amp; LastRow)\n            .FormulaR1C1 = \"=VLOOKUP(RC32,\" &amp; Srng.Address(, , xlR1C1, True) &amp; \", 3, 0)\"\n            .Value = .Value\n        End With\n        With cbook.ActiveSheet.Range(\"AI2:AI\" &amp; LastRow)\n            .FormulaR1C1 = \"=VLOOKUP(RC32,\" &amp; Srng.Address(, , xlR1C1, True) &amp; \", 4, 0)\"\n            .Value = .Value\n        End With\n        With cbook.ActiveSheet.Range(\"AJ2:AJ\" &amp; LastRow)\n            .FormulaR1C1 = \"=VLOOKUP(RC32,\" &amp; Srng.Address(, , xlR1C1, True) &amp; \", 5, 0)\"\n            .Value = .Value\n        End With\n           End With\n\nNotThisSheet:\nNext xworksheet\n\n'share workbook\nActiveWorkbook.SaveAs ActiveWorkbook.FullName, accessmode:=xlShared\nApplication.DisplayAlerts = True\n\nMsgBox (\"Copying from the prior list is complete.\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1545843079, "post_id": 53934777, "comment_id": 94709721, "body": "change <code>activeworksheet</code> to <code>ActiveSheet</code>"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545843323, "post_id": 53934777, "comment_id": 94709797, "body": "@DisplayName it still keeps naming them as a copy of sheet1. Could it be the <code>For Each</code> loop where it&#39;s <code>ws.copy after:=mainwb.sheets</code>?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545843527, "post_id": 53934777, "comment_id": 94709849, "body": "which cell in which worksheet of which workbook you want to name new worksheets after?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545843638, "post_id": 53934777, "comment_id": 94709880, "body": "whatever sheet I grab from the folder. So I go in, grab the first workbook (sheet1) in that pathway, and whatever the value is in cell <code>B1</code> of that workbookwhat I want to name the worksheet as when it is moved to the <code>MainWb</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545843703, "post_id": 53934777, "comment_id": 94709902, "body": "then <code>ActiveSheet.Name = ws.Range(&quot;B1&quot;).Value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545844329, "post_id": 53934961, "comment_id": 94710115, "body": "that worked! One last thing, what if I wanted <code>MainWB</code> to just be a brand new <code>Book1.xlsx</code>?   Would that be <code>Set MainWB = Workbooks.Add</code>?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545844552, "post_id": 53934961, "comment_id": 94710176, "body": "I guess so, but ...its&#39; easy to test it yourself!"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1545844037, "creation_date": 1545844037, "answer_id": 53934961, "question_id": 53934777, "link": "https://stackoverflow.com/questions/53934777/name-a-copy-of-a-sheet-the-value-in-a-cell-in-original-sheet/53934961#53934961", "title": "Name a copy of a Sheet the value in a cell in original sheet", "body": "<p>after <code>.Copy()</code> method of <code>Sheet</code> object, the newly created sheet becomes the <em>active</em> one, while <code>ws</code> still holds reference to the <em>original</em> sheet </p>\n\n<p>so go like follows</p>\n\n<pre><code>        For Each ws In wb.Sheets\n            ws.Copy After:=MainWB.Sheets(MainWB.Sheets.Count)\n\n            ActiveSheet.Name = ws.Range(\"B1\").Value\n        Next\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53934961, "answer_count": 1, "score": 0, "last_activity_date": 1549291501, "creation_date": 1545842980, "last_edit_date": 1549291501, "question_id": 53934777, "link": "https://stackoverflow.com/questions/53934777/name-a-copy-of-a-sheet-the-value-in-a-cell-in-original-sheet", "title": "Name a copy of a Sheet the value in a cell in original sheet", "body": "<p>This script loops through a file pathway and combines all workbooks into a master workbook and sections each workbook into a worksheet within the master file. </p>\n\n<p>I have a line <code>ws.Name = activeworksheet.Range(\"B1\").Value</code> that names the sheets as a copy of the first workbook's worksheet Sheet1 and names every sheet after that like Sheet1(2).</p>\n\n<p><a href=\"https://i.stack.imgur.com/j3lT9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j3lT9.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>How can this be changed to the value in cell B1 of the workbook it is consolidating into the master workbook?</p>\n\n<p>rest of script: </p>\n\n<pre><code>Option Explicit\n\nSub CombineWorkbooks()\n\n    Dim MainWB As Workbook\n    Dim sDirPath As String\n    Dim sFileName As String\n    Dim sFilePath As String\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    sDirPath = \"M:\\New folder\"\n\n    sFileName = Dir(sDirPath &amp; \"\\*.xlsx\")\n\n    Set MainWB = ThisWorkbook\n\n    Do While Len(sFileName) &gt; 0\n\n        sFilePath = sDirPath &amp; \"\\\" &amp; sFileName\n\n        Set wb = Workbooks.Open(Filename:=sFilePath)\n\n        For Each ws In wb.Sheets\n            ws.Copy After:=MainWB.Sheets(MainWB.Sheets.Count)    \n            ws.Name = activeworksheet.Range(\"B1\").Value\n        Next ws\n\n        wb.Close SaveChanges:=False\n\n        sFileName = Dir\n    Loop\nEnd Sub  \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545859623, "post_id": 53934559, "comment_id": 94714648, "body": "I have done this for a dataset of thousands without this issue. Can you identify a record producing blank? Modify the SQL statement to pull only that record. Is PDF good?"}, {"owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545863646, "post_id": 53934559, "comment_id": 94715738, "body": "I already did that and the pdf was good. I&#39;m trying other solutions here and i found out that if I limit my loop to get only the first 200 lines it works perfectly. Don&#39;t know if this can be a problem with access memory?"}, {"owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545864443, "post_id": 53934559, "comment_id": 94715886, "body": "Think I found the problem but got another one. If I remove the line &quot;On Error Resume Next&quot; I get run-time error &#39;2501&#39; after sometime. Any idea why this might be happening?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545875779, "post_id": 53934559, "comment_id": 94717631, "body": "When I did this I was outputting about 65,000 records. I had to do it in batches of 5,000 or the program crashed. What is the exact error message?"}, {"owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545947709, "post_id": 53934559, "comment_id": 94741150, "body": "Error 2010 cannot open any more tables"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545948533, "post_id": 53934559, "comment_id": 94741385, "body": "The PDFs are not auto opening? I think the OutputTo command AutoStart argument defaults to False. So if PDFs are not opening that must the case and not the issue. Sorry, I have no other solution than to run small batches. As I said, I could do batches of 5000 records."}, {"owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545951464, "post_id": 53934559, "comment_id": 94742116, "body": "They are auto opening but after awhile it stops"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545967957, "post_id": 53934559, "comment_id": 94745100, "body": "Set AutoStart argument to False. True must be the default."}], "owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545841588, "creation_date": 1545841588, "question_id": 53934559, "link": "https://stackoverflow.com/questions/53934559/vba-code-to-convert-rows-into-pdf-files-start-to-print-blank-pages-after-sometim", "title": "VBA Code to convert rows into PDF files start to print blank pages after sometime", "body": "<p>I wrote a VBA code to print every row of my table into pdf files while creating directories for them.</p>\n\n<p>At first it look great, it doesn't show any kind of error but when the loop ends (around 1200 rows) if I go check the files created, some worked perfectly while others are just blank pages.</p>\n\n<p>Any idea why this might be happening?</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command0_Click()\nDim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim ps As DAO.Recordset\n    Dim MyFileName As String\n    Dim mypath As String\n    Dim temp As String\n\n\n    'mypath = \"C:\\Docs\\\"\n\n    Set db = CurrentDb()\n\n    Set rs = db.OpenRecordset(\"SELECT * FROM [TABLE]\", dbOpenSnapshot)\n\n   Do While Not rs.EOF\n        On Error Resume Next\n        b = \"C:\\Docs\\\" &amp; rs(\"ENTERPRISE\")\n        MkDir (b)\n\n        b1 = \"C:\\Docs\\\" &amp; rs(\"ENTERPRISE\") &amp; \"\\\" &amp; \"ECONOMICS\"\n        MkDir (b1)\n\n        b2 = \"C:\\Docs\\\" &amp; rs(\"ENTERPRISE\") &amp; \"\\\" &amp; \"ECONOMICS\" &amp; \"\\\" &amp; Year(rs(\"DATE\")) &amp; \"-\" &amp; Month(rs(\"DATE\"))\n        MkDir (b2)\n\n        a = b2 &amp; \"\\\" &amp; rs(\"NUM\") &amp; \"-\" &amp; rs(\"ITEM\")\n        MkDir (a)\n\n        mypath = a &amp; \"\\\"\n        temp = rs(\"DOC_LANC\")\n        MyFileName = rs(\"NUM\") &amp; rs(\"ITEM\") &amp; \".PDF\"\n\n        DoCmd.OpenReport \"PDF\", acViewReport, , \"[DOC_LANC]='\" &amp; temp &amp; \"'\"\n        DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, mypath &amp; MyFileName\n        DoCmd.Close acReport, \"PDF\"\n        DoEvents\n\n        rs.MoveNext\n\n    Loop\n\n    rs.Close\n    Set rs = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerquery"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 3, "creation_date": 1545838818, "post_id": 53933945, "comment_id": 94708301, "body": "I think I would need to see your code to help with this. Could you add it to the question?"}, {"owner": {"reputation": 1567, "user_id": 7179349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664b43aa7208663483a4c815f000907?s=128&d=identicon&r=PG&f=1", "display_name": "Wedge", "link": "https://stackoverflow.com/users/7179349/wedge"}, "edited": false, "score": 2, "creation_date": 1545841398, "post_id": 53933945, "comment_id": 94709123, "body": "Error handling in Power Query should be handled in Power Query, not VBA. However if something is going wrong enough it&#39;s causing a message like that, it&#39;s likely something that needs to be addressed and not ignored (I&#39;ll sometimes see a message like that if Power Query is capping out the available system memory)."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545841482, "post_id": 53933945, "comment_id": 94709150, "body": "<code>On Error Resume Next</code> will capture errors thrown by the VBA compiler, not the Excel application."}, {"owner": {"reputation": 11, "user_id": 10835677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a47edbf8ecab78b8b2cfe5a113e23af?s=128&d=identicon&r=PG&f=1", "display_name": "TimQ", "link": "https://stackoverflow.com/users/10835677/timq"}, "edited": false, "score": 0, "creation_date": 1545842068, "post_id": 53933945, "comment_id": 94709364, "body": "the code is pretty simple  On Error Resume Next ActiveWorkbook.RefreshAll ActiveWorkbook.RefreshAll ActiveWorkbook.Calculation = xlAutomatic"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545842326, "post_id": 53933945, "comment_id": 94709470, "body": "@TimQ Why do you have 2 <code>RefreshAll</code>s in there?"}, {"owner": {"reputation": 11, "user_id": 10835677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a47edbf8ecab78b8b2cfe5a113e23af?s=128&d=identicon&r=PG&f=1", "display_name": "TimQ", "link": "https://stackoverflow.com/users/10835677/timq"}, "edited": false, "score": 0, "creation_date": 1545843407, "post_id": 53933945, "comment_id": 94709815, "body": "Because power query stinks and sometimes doesn&#39;t fully update on one refresh. This is just a example of the code, i have a Application.Wait() line in between the two refresh statements. When the error comes it occurs on both cycles of the refresh code"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1545846134, "post_id": 53933945, "comment_id": 94710700, "body": "Even if the query refresh is set to Background, I believe you still need the <code>Application.CalculateUntilAsyncQueriesDone</code> call to make the VBA code wait. That could also explain why you&#39;re getting the error - it may be because you&#39;re calling a refresh on queries that are already being refreshed...."}, {"owner": {"reputation": 11, "user_id": 10835677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a47edbf8ecab78b8b2cfe5a113e23af?s=128&d=identicon&r=PG&f=1", "display_name": "TimQ", "link": "https://stackoverflow.com/users/10835677/timq"}, "edited": false, "score": 0, "creation_date": 1545847060, "post_id": 53933945, "comment_id": 94710942, "body": "I have the same code that i run on 20+ different files daily, and only some give the error. I researched before and the code waits for the queries to finish executing before it calculates the workbook"}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "edited": false, "score": 2, "creation_date": 1602592781, "post_id": 55022299, "comment_id": 113764301, "body": "Wrapping <code>try...otherwise</code> around the M query is an interesting way of handing it.  I want future readers to know that this method hides all the power query <i>steps</i> so for debugging you won&#39;t be able to see the actual error until you remove the try...otherwise. Also be aware that returning an error instead of your expected query columns may mess up the formatting on the sheet by inserting columns to the left of the table.  Correcting the error does not restore the column positions so things can get messy."}], "tags": [], "owner": {"reputation": 39, "user_id": 11132804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d817fe31ab403f864c0e1fdc9b1b3455?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas S", "link": "https://stackoverflow.com/users/11132804/jonas-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1551872537, "creation_date": 1551872537, "answer_id": 55022299, "question_id": 53933945, "link": "https://stackoverflow.com/questions/53933945/error-handling-power-query-refresh-with-vba/55022299#55022299", "title": "Error handling Power Query refresh with VBA", "body": "<p>Within Power Query you can wrap you code as (assuming this is Query1):</p>\n\n<pre><code>try\n  let\n  ....\n\n  in\n  ...\n\notherwise\n  \"Error\"\n</code></pre>\n\n<p>and then having one error wrapping query for all queries as:</p>\n\n<pre><code>if Query1 = \"Error\" then \"Error\" \nelse if Query2 = \"Error\" then  \"Error\"\n...\nelse \"No Error\"\n</code></pre>\n\n<p>which you can then load to Excel as a new sheet and check with VBA macro whether the value of such a cell contains \"Error\" or not.</p>\n"}], "owner": {"reputation": 11, "user_id": 10835677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a47edbf8ecab78b8b2cfe5a113e23af?s=128&d=identicon&r=PG&f=1", "display_name": "TimQ", "link": "https://stackoverflow.com/users/10835677/timq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2087, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1578481927, "creation_date": 1545837902, "last_edit_date": 1578481927, "question_id": 53933945, "link": "https://stackoverflow.com/questions/53933945/error-handling-power-query-refresh-with-vba", "title": "Error handling Power Query refresh with VBA", "body": "<p>I have a VBA code that refreshes my data connections twice and then calculates the workbook. I added On Error Resume Next, but when there is an error with the query refreshing it ignores my VBA error handling and shows an error saying \"Unexpected Error, Something went wrong. If the problem continues, please restart Excel.\" After i click cancel it continues with my code but the one query that caused the error still shows its running even though the other queries ran after it. I turned off background refresh on all connections already and i am just trying to find some VBA code where i can handle the error with power query. </p>\n\n<p>Eventually i would want my code to cancel the query that caused the error and refresh it individually after all the code is done.</p>\n\n<p>How do we handle errors in power query with VBA?</p>\n\n<p>Current code:</p>\n\n<pre><code>On Error Resume Next \nActiveWorkbook.RefreshAll \nActiveWorkbook.RefreshAll \nActiveWorkbook.Calculation = xlAutomatic\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545838161, "post_id": 53933939, "comment_id": 94708101, "body": "<i>dataSheet</i> needs to be defined as the object (not in the code you&#39;ve displayed).  Beyond that, the code works for me.  The error was a run-time 424 when i ran your code as is (2 lines) which states an object is required."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545839588, "creation_date": 1545839588, "answer_id": 53934205, "question_id": 53933939, "link": "https://stackoverflow.com/questions/53933939/how-to-hide-multiple-columns-in-excel-sheet/53934205#53934205", "title": "How to hide multiple columns in Excel sheet?", "body": "<h1>Constants and References</h1>\n\n<pre><code>Sub AllCol()\n\n  Const cVntSheet As Variant = \"Sheet1\"   ' Worksheet Name/Index\n  Const cStrRange As String = \"J:M\"       ' Range Address\n\n  Dim dataSheet As Worksheet              ' Worksheet\n\n  ' Create a reference to the worksheet.\n  Set dataSheet = Worksheets(cVntSheet)\n\n  ' Hide the range.\n  dataSheet.Columns(cStrRange).Hidden = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1545840735, "creation_date": 1545840735, "answer_id": 53934399, "question_id": 53933939, "link": "https://stackoverflow.com/questions/53933939/how-to-hide-multiple-columns-in-excel-sheet/53934399#53934399", "title": "How to hide multiple columns in Excel sheet?", "body": "<p>Swap <code>Sheet1</code> with your actual sheet name. </p>\n\n<pre><code>Sub HideMe()\n\n    ThisWorkbook.Sheets(\"Sheet1\").Columns(\"J:M\").Hidden = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Notice this can be done in one line. If you want to use variables (workbook or worksheets), they should build the above string when combined</p>\n\n<p>Something like: </p>\n\n<pre><code>Dim wb as Workbook: Set wb = ThisWorkbook\nDim ws as Worksheet: Set ws = wb.Sheets(\"Sheet1\")\nDim hm as String: hm = \"J:M\"\n\nws.Columns(hm).Hidden = True\n</code></pre>\n\n<p>If you substitute your variables into the last line, you will end up with the exact same line of code shown in the first sub. </p>\n"}], "owner": {"reputation": 1, "user_id": 10835590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eeb99a231b351f290de5456abe9d8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Thejaswi Gali", "link": "https://stackoverflow.com/users/10835590/thejaswi-gali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549108136, "creation_date": 1545837870, "last_edit_date": 1549108136, "question_id": 53933939, "link": "https://stackoverflow.com/questions/53933939/how-to-hide-multiple-columns-in-excel-sheet", "title": "How to hide multiple columns in Excel sheet?", "body": "<p>I'm using 4 sequential columns from sheet 1 to generate charts in sheet 2. I want to hide those 4 columns in sheet 1.</p>\n\n<p>I've tried the below code to hide the columns:</p>\n\n<pre><code>Set allColumns = dataSheet.Columns(\"J:M\")\nallColumns.Hidden = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 268, "user_id": 8803825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDkmN.png?s=128&g=1", "display_name": "krobelusmeetsyndra", "link": "https://stackoverflow.com/users/8803825/krobelusmeetsyndra"}, "edited": false, "score": 0, "creation_date": 1545841353, "post_id": 53933888, "comment_id": 94709104, "body": "Check if <a href=\"https://stackoverflow.com/questions/51948424/using-multiple-language-english-chinese-japanese-in-vba\">this</a> helps."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1545842556, "post_id": 53933888, "comment_id": 94709552, "body": "Check my response in this post <a href=\"https://stackoverflow.com/questions/53509921/vba-macro-to-search-a-text-string-and-replace-with-hyperlink-works-only-with-eng/53526940#53526940\" title=\"vba macro to search a text string and replace with hyperlink works only with eng\">stackoverflow.com/questions/53509921/&hellip;</a>. Notice how it uses the <code>ChrW</code> unicode values for non-Latin characters."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8293298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8e4b1df09ababeb1a2dd2227551bd67?s=128&d=identicon&r=PG&f=1", "display_name": "tehoo", "link": "https://stackoverflow.com/users/8293298/tehoo"}, "edited": false, "score": 0, "creation_date": 1545842526, "post_id": 53934523, "comment_id": 94709539, "body": "Thanks for your kind answer. Actually whole code I wrote is   Sub change()     Dim c As Range              word1 = InputBox(Prompt:=&quot;Before&quot;, Title:=&quot;change&quot;)     word2 = InputBox(Prompt:=&quot;After&quot;, Title:=&quot;change&quot;)                    For Each c In Selection                 c.Value = Replace(c.Value, word1, word2)          Next End Sub  Unfortunately the word I want to change to is random. I there any good way for this ?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 67, "user_id": 8293298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8e4b1df09ababeb1a2dd2227551bd67?s=128&d=identicon&r=PG&f=1", "display_name": "tehoo", "link": "https://stackoverflow.com/users/8293298/tehoo"}, "edited": false, "score": 0, "creation_date": 1545857353, "post_id": 53934523, "comment_id": 94714010, "body": "@tehoo you\u2019d have to just keep adding names for each replacement you\u2019d like to do"}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1545841392, "creation_date": 1545841392, "answer_id": 53934523, "question_id": 53933888, "link": "https://stackoverflow.com/questions/53933888/change-specific-word-to-arabic-characters-including-the-character-%e3%83%bc/53934523#53934523", "title": "Change specific word to Arabic characters, including the character &quot;\u30fc&quot;", "body": "<p>Try storing \u30b0\u30ec\u30fc\u30d7 in a Named Range. Formulas > Name Manager > New ></p>\n\n<p>\"ReplaceText\", Refers To:\n=\"\u30b0\u30ec\u30fc\u30d7\"</p>\n\n<p>Then adjust your For Loop with:</p>\n\n<pre><code>c.Value = Replace(c.Value, \"grape\", Evaluate(Names(\"ReplaceText\").Value))\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 67, "user_id": 8293298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8e4b1df09ababeb1a2dd2227551bd67?s=128&d=identicon&r=PG&f=1", "display_name": "tehoo", "link": "https://stackoverflow.com/users/8293298/tehoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545842188, "creation_date": 1545837593, "last_edit_date": 1545842188, "question_id": 53933888, "link": "https://stackoverflow.com/questions/53933888/change-specific-word-to-arabic-characters-including-the-character-%e3%83%bc", "title": "Change specific word to Arabic characters, including the character &quot;\u30fc&quot;", "body": "<p>I want to change \"grape\" to \u30b0\u30ec\u30fc\u30d7 and below is the code I wrote,<br>\nbut If I insert \"\u30fc\" it is displayed as \"?\".</p>\n\n<p>How can I solve this problem...??</p>\n\n<pre><code>Sub change_name()\n\n    Dim c As Range\n\n    For Each c In Selection\n            c.Value = Replace(c.Value, \"grape\", \"\u30b0\u30ec?\u30d7\")       \n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838075, "post_id": 53933864, "comment_id": 94708076, "body": "there are many ways of doing that but the right answer depends on your actual dat layout: show it"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838183, "post_id": 53933864, "comment_id": 94708110, "body": "all I need is a way to just define rows 1:62 and Column B: columns.count. Pretty straight forward, just imagine dummy data in that range"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838250, "post_id": 53933864, "comment_id": 94708128, "body": "then <code>.Range(&quot;B1:B62&quot;)</code>"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838385, "post_id": 53933864, "comment_id": 94708163, "body": "So, <code>Data = .Range(&quot;B1:B62&quot;, .Cells(1, Columns.Count).End(xlToLeft)).Column</code> ?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838522, "post_id": 53933864, "comment_id": 94708205, "body": "if you want to &quot;define rows 1:62 and Column B&quot;, its&#39; just <code>.Range(&quot;B1:B62&quot;)</code>, otherwise give more details about how you need to build your range up"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838616, "post_id": 53933864, "comment_id": 94708236, "body": "@DisplayName will always have 62 rows in column B for that dimension, but then my columns will always fluctuate. I need to incorporate 62 rows in Column B but then up until the last column. It could be 5 columns, or it could be 300, it will always vary."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838686, "post_id": 53933864, "comment_id": 94708258, "body": "and which row will hold the <i>&quot;last (not empty) column&quot;</i>?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545838759, "post_id": 53933864, "comment_id": 94708281, "body": "row 62.   All I need is something like .Range(&quot;b1:b62&quot;, &amp; columns B through last used columns)"}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545838962, "post_id": 53934099, "comment_id": 94708349, "body": "thank you, I guess I wasn&#39;t sure what you were initially asking. this worked, much apprecaited"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545839157, "post_id": 53934099, "comment_id": 94708417, "body": "you are welcome. see edited answer for a further step. if it solved your question you may consider marking answer as accepted. thank you"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1545839590, "post_id": 53934099, "comment_id": 94708563, "body": "I actually just added the script at the bottom of my post, I&#39;m getting a subscript out of range error on the line I sectioned out"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1545839111, "last_edit_date": 1545839111, "creation_date": 1545838899, "answer_id": 53934099, "question_id": 53933864, "link": "https://stackoverflow.com/questions/53933864/how-can-i-change-this-range-to-something-more-dynamic/53934099#53934099", "title": "How can I change this range to something more dynamic?", "body": "<p>based on further clarifications in comments:</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Profiles\")\n    Data = .Range(\"B1\", .Cells(62, .Columns.Count).End(xlToLeft))\nEnd With\n</code></pre>\n\n<p>while if you want to keep column B last row dynamic (and always catch last column along this latter):</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Profiles\")\n    Data = .Range(\"B1\", .Cells(.Cells(.Rows.Count, 2).End(xlUp).Row, .Columns.Count).End(xlToLeft))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 53934099, "answer_count": 1, "score": 1, "last_activity_date": 1578481965, "creation_date": 1545837441, "last_edit_date": 1578481965, "question_id": 53933864, "link": "https://stackoverflow.com/questions/53933864/how-can-i-change-this-range-to-something-more-dynamic", "title": "How can I change this range to something more dynamic?", "body": "<p>I have a range that I define before executing an array macro, but I have to flip the way that I am defining it. It used to be a fixed amount of columns, but now its transposed and its a fixed amount of rows. </p>\n\n<p>How can I change this to express <code>62 rows</code> and columns <code>B to columns.count</code>?</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Profiles\")\nData = .Range(\"bj1\", .Range(\"B\" &amp; Rows.Count).End(xlUp))\nEnd With\n</code></pre>\n\n<p>Or even taking it a step further, how could I just do columns &amp; rows.count?</p>\n\n<p>Whole script: </p>\n\n<pre><code>Option Explicit\n\nSub Main()\n  Dim wb As Workbook\n  Dim Data, Last, JobFamily\n  Dim i As Long, j As Long, k As Long, a As Long\n  Dim Dest As Range\n\n  'Refer to the template\n  Set wb = Workbooks(\"Book2.xlsx\")\n  'Refer to the destination cell\n  Set Dest = wb.Sheets(\"Sheet11\").Range(\"B1\")\n  'Read in all data\n  With ThisWorkbook.Sheets(\"Profiles\")\n    Data = .Range(\"B1\", .Cells(.Cells(.Rows.Count, 2).End(xlUp).Row, .Columns.Count).End(xlToLeft))\nEnd With\n  wb.Activate\n  Application.ScreenUpdating = False\n\n  'Process the data\n  For i = 1 To UBound(Data)\n    'Manager changes?\n    If Data(1, i) &lt;&gt; Last Then\n      'Skip the first\n      If i &gt; 1 Then\n        'Scroll into the view\n        Dest.Select\n        'Save a copy\n        wb.SaveCopyAs ThisWorkbook.Path &amp; Application.PathSeparator &amp; _\n          ValidFileName(Last &amp; \".xlsx\")\n      End If\n      'Clear the employees\n      Dest.Resize(, Columns.Count - Dest.Column).EntireColumn.ClearContents\n      'Remember this manager\n      Last = Data(1, i)\n      'Start the next round\n      j = 0\n    End If\n    'Write the employee data into the template\n    a = 0\n    For k = 1 To UBound(Data, 2)\n      Dest.Offset(a, j) = Data(k, i)\n      a = a + 1\n    Next\n    'Next column\n    j = j + 1\n  Next\nEnd Sub\n</code></pre>\n\n<p>getting a <code>subscript out of range</code> error on this line : </p>\n\n<pre><code>Dest.Offset(a, j) = Data(k, i)\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1545837056, "post_id": 53933711, "comment_id": 94707760, "body": "You need to use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/redim-statement\" rel=\"nofollow noreferrer\">ReDim</a> but I would probably prefer another data structure like a dictionary or collection."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1545837139, "post_id": 53933711, "comment_id": 94707797, "body": "Or a collection of dictionaries! You have the three keys you want to associate values for each time. With the array idea I would have had the increment in the rows argument and held the columns constant with 0,1,2. Also, oversize at start and redim at end using a counter variable."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1545837340, "post_id": 53933711, "comment_id": 94707867, "body": "@Storax How can I do that?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1545838101, "post_id": 53933711, "comment_id": 94708089, "body": "How can you do what? Using Redim is described in the link I provided."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1545838181, "post_id": 53933711, "comment_id": 94708109, "body": "@Storax Sorry, I should have specified better. How could I use a dictionary in this case? Also, I am now trying redim, but the array dimensions are getting out of control for some reason"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1545841502, "last_edit_date": 1545841502, "creation_date": 1545838321, "answer_id": 53934007, "question_id": 53933711, "link": "https://stackoverflow.com/questions/53933711/feeding-multiple-values-in-a-loop-to-an-array-with-vba/53934007#53934007", "title": "Feeding multiple values in a loop to an array with VBA", "body": "<p>try with these steps:</p>\n\n<p>1) temporarily size the array to the maximum number of files</p>\n\n<p>2) keep track of found files</p>\n\n<p>3) finally resize array to actual number of found files</p>\n\n<p>As follows (I only show relevant snippet):</p>\n\n<pre><code>ii = -1 '&lt;&lt;&lt; initialize the counter fo found files to -1: it's more convenient for its subsequent updating and usage\nReDim outputarray(0 To 2, 0 To Folder.Files.Count) As Variant ' &lt;&lt;&lt; temporarily size the array to the maximum number of files\n\nFor Each File In Folder.Files\n    Set oFS = CreateObject(\"Scripting.FileSystemObject\")\n    'Set w2 = File\n\n    filePath = File.Path\n    strFilename = File.Name\n    dateC = File.dateCreated\n    If InStr(LCase(File.Path), LCase(\"xls\")) &lt;&gt; 0 Then\n        Set w2 = Workbooks.Open(filePath)\n        For lRow2 = 1 To w2.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n            If w2.Sheets(1).Range(\"A\" &amp; lRow2).Value = \"Test Name\" Then\n                ii = ii + 1 '&lt;&lt;&lt; update the number of found files\n                outputarray(0, ii) = strFilename\n                outputarray(1, ii) = filePath\n                outputarray(2, ii) = dateC\n            End If\n        Next lRow2\n        w2.Close False\n    End If\n    Set oFS = Nothing\nNext File\n\nReDim Preserve outputarray(0 To 2, 0 To ii) As Variant '&lt;&lt;&lt; finally resize array to actual number of found files\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>edit</p>\n</blockquote>\n\n<p>BTW you can avoid the double nested writing loops and use a one shot statement:</p>\n\n<pre><code>w.Sheets(\"ControlSheet\").Range(\"A1\").Resize(UBound(outputarray, 1) + 1, UBound(outputarray, 2) + 1).Value = outputarray\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 3, "last_activity_date": 1545838889, "creation_date": 1545838889, "answer_id": 53934096, "question_id": 53933711, "link": "https://stackoverflow.com/questions/53933711/feeding-multiple-values-in-a-loop-to-an-array-with-vba/53934096#53934096", "title": "Feeding multiple values in a loop to an array with VBA", "body": "<p>I would use a dictionary and a \"class\" like in the following example.\nThe class fInfo looks like that</p>\n\n<pre><code>Option Explicit\n\nPublic fileName As String\nPublic filepath As String\nPublic fileDateCreated As Date\n</code></pre>\n\n<p>Then you could test it like that</p>\n\n<pre><code>Sub AnExample()\n\nDim dict As New Scripting.Dictionary\nDim fInfo As fileInfo\n\nDim filepath As String\nDim strFilename As String\nDim dateC As Date\nDim i As Long\n\n    For i = 1 To 2\n        filepath = \"Path\\\" &amp; i\n        strFilename = \"Name\" &amp; i\n        dateC = Now + 1\n\n        Set fInfo = New fileInfo\n        With fInfo\n            .filepath = filepath\n            .fileName = strFilename\n            .fileDateCreated = dateC\n        End With\n        dict.Add i, fInfo\n    Next i\n\n    For i = 1 To dict.Count\n        With dict.Item(i)\n            Debug.Print .filepath, .fileName, .fileDateCreated\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>In your code maybe like that</p>\n\n<pre><code>    For lRow2 = 1 To w2.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n        If w2.Sheets(1).Range(\"A\" &amp; lRow2).Value = \"Test Name\" Then\n            Set fInfo = New fileInfo\n            With fInfo\n                .filepath = filepath\n                .fileName = strFilename\n                .fileDateCreated = dateC\n            End With\n            dict.Add ii, fInfo\n'            outputarray(0, ii) = strFilename    ' THE ERROR STARTS HERE\n'            outputarray(1, ii) = filepath\n'            outputarray(2, ii) = dateC\n'            ii = ii + 1\n        End If\n    Next lRow2\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 1, "accepted_answer_id": 53934007, "answer_count": 2, "score": 2, "last_activity_date": 1578481984, "creation_date": 1545836521, "last_edit_date": 1578481984, "question_id": 53933711, "link": "https://stackoverflow.com/questions/53933711/feeding-multiple-values-in-a-loop-to-an-array-with-vba", "title": "Feeding multiple values in a loop to an array with VBA", "body": "<p><strong>Scenario:</strong> I am reading through folders and subfolders of a directory, if the found file is an \".xls\" it opens. I then run another condition that, if true, will try to pass some values to the array. </p>\n\n<p><strong>Objective:</strong> I am defining my array without dimensions, because I don't know how many files will feed into it. For each file that fulfills the conditions, I am trying to get 3 values (name, path, date) and add to the array. Each file would be added to a new row of the array.</p>\n\n<p><strong>Ex. of array:</strong></p>\n\n<p>If 3 files fulfill the condition...</p>\n\n<pre><code>name1    path1    date1\nname2    path2    date2\nname3    path3    date3\n</code></pre>\n\n<p><strong>Issue:</strong> when I run, I get a subscript out of range error when I try to pass the values to the array. How can I fix that?</p>\n\n<p><strong>Code1:</strong> This starts the loop through folders</p>\n\n<pre><code>Public Sub getInputFileInfo()\n    Dim FileSystem As Object\n    Dim HostFolder As String\n\n    ' User selects where to search for files:\n    HostFolder = GetFolder()\n\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    DoFolder FileSystem.GetFolder(HostFolder)\n\nEnd Sub\n</code></pre>\n\n<p><strong>Code2:</strong> This gets the data:</p>\n\n<pre><code>Public Sub DoFolder(Folder)\n\n    Dim strFilename As String, filePath As String\n    Dim dateC As Date\n    Dim oFS As Object\n    Dim outputarray() As Variant\n    Dim ii As Long, lRow As Long, lCol As Long, lRow2 As Long\n    Dim w2, w As Workbook\n    Set w = ThisWorkbook\n\n    ii = 1\n\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next SubFolder\n    Dim File\n    For Each File In Folder.Files\n        Set oFS = CreateObject(\"Scripting.FileSystemObject\")\n        'Set w2 = File\n\n        filePath = File.Path\n        strFilename = File.Name\n        dateC = File.dateCreated\n        If InStr(LCase(File.Path), LCase(\"xls\")) &lt;&gt; 0 Then\n            Set w2 = Workbooks.Open(filePath)\n            For lRow2 = 1 To w2.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n                If w2.Sheets(1).Range(\"A\" &amp; lRow2).Value = \"Test Name\" Then\n                    outputarray(0, ii) = strFilename ' THE ERROR STARTS HERE\n                    outputarray(1, ii) = filePath\n                    outputarray(2, ii) = dateC\n                    ii = ii + 1\n                End If\n            Next lRow2\n            w2.Close False\n        End If\n        Set oFS = Nothing\n    Next File\n\n    For lRow = 1 To UBound(outputarray, 1)\n        For lCol = 1 To UBound(outputarray, 2)\n            w.Sheets(\"ControlSheet\").Cells(lRow, lCol).Value = outputarray(lRow, lCol).Value\n        Next lCol\n    Next lRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "reference"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10835497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b364b8a89a527e1e57f523a09ed55f6?s=128&d=identicon&r=PG&f=1", "display_name": "Dan P", "link": "https://stackoverflow.com/users/10835497/dan-p"}, "edited": false, "score": 0, "creation_date": 1545836423, "post_id": 53933604, "comment_id": 94707553, "body": "That makes sense why I was having trouble then. Thanks for the help and the suggestion!"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 0, "last_activity_date": 1545835855, "creation_date": 1545835855, "answer_id": 53933604, "question_id": 53933473, "link": "https://stackoverflow.com/questions/53933473/how-to-reference-cell-ax-value-where-x-is-an-integer-that-goes-from-1-until/53933604#53933604", "title": "How to reference cell &quot;A(x.Value)&quot; where x is an Integer that goes from 1 until &quot;A(x.Value)&quot; = NULL", "body": "<p>Integers are not Objects in VBA.</p>\n\n<blockquote>\n  <p>If Workbooks(\"Training_TEST\").Sheets(2).Range(\"A\" &amp; x) = Null Then</p>\n</blockquote>\n\n<p>You should watch <a href=\"https://www.youtube.com//watch?v=KHO5NIcZAc4&amp;index=1&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction</a> video series on YouTube.</p>\n\n<p>Here are some relevant videos:</p>\n\n<ul>\n<li><a href=\"https://www.youtube.com//watch?v=N1mADWqzWy4&amp;index=8&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 8 -\nVariables</a></li>\n<li><a href=\"https://www.youtube.com//watch?v=7Ugoj7hpUEA&amp;index=9&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 9 - Object\nVariables</a></li>\n<li><a href=\"https://www.youtube.com//watch?v=c8reU-H1PKQ&amp;index=5&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 5 - Selecting Cells (Range, Cells,\nActivecell, End,\nOffset)</a></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 10835497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b364b8a89a527e1e57f523a09ed55f6?s=128&d=identicon&r=PG&f=1", "display_name": "Dan P", "link": "https://stackoverflow.com/users/10835497/dan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53933604, "answer_count": 1, "score": 0, "last_activity_date": 1545835855, "creation_date": 1545835142, "question_id": 53933473, "link": "https://stackoverflow.com/questions/53933473/how-to-reference-cell-ax-value-where-x-is-an-integer-that-goes-from-1-until", "title": "How to reference cell &quot;A(x.Value)&quot; where x is an Integer that goes from 1 until &quot;A(x.Value)&quot; = NULL", "body": "<p>I am trying to run through a column in an Excel sheet and search through column A until it finds the first cell that is empty in column A. I need to do it by using a variable x, where x starts at 1 and increases after each run of the loop. </p>\n\n<p>Ideally, I would like to do something like:</p>\n\n<p>Workbooks(\"Name1\").Sheets(2).Range(\"A.(x.Value)\") </p>\n\n<p>but I do not think this will work and am not sure how to do this correctly as I am not too familiar with VBA. Wondering if anyone can help me out with a way to do this, if it is even possible. I have the loops created that I need, I am only having difficulties referencing the cell defined by an integer.</p>\n\n<p>Here is a piece of what I have set up:</p>\n\n<pre><code>    Dim x As Integer\n    Dim y As Integer\n    Dim z As Integer\n    Dim status As Boolean\n\n    x = 13\n    y = 2\n    z = 2\n\n   If Workbooks(\"Training_TEST\").Sheets(2).Range(\"A(x.Value)\") = Null Then\n            status = False\n        Else\n            status = True\n\n   End If\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "excel-formula", "excel-addins"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1545833589, "post_id": 53933121, "comment_id": 94706693, "body": "Have you tried making the cell reference parameter into a range parameter? (Assuming vba coding)"}, {"owner": {"reputation": 203, "user_id": 7024324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GSGHO.jpg?s=128&g=1", "display_name": "Sourabh Mishra", "link": "https://stackoverflow.com/users/7024324/sourabh-mishra"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1545835646, "post_id": 53933121, "comment_id": 94707284, "body": "@Mistella No i am not sure about the VBA coding. I am writing this addin in c#. But can you give the sample code in VBA to do that. I&#39;ll try to convert it into c#."}, {"owner": {"reputation": 203, "user_id": 7024324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GSGHO.jpg?s=128&g=1", "display_name": "Sourabh Mishra", "link": "https://stackoverflow.com/users/7024324/sourabh-mishra"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1545836076, "post_id": 53933121, "comment_id": 94707416, "body": "@Mistella Did you meant passing the range like this &quot;=Data(a$1:a$1, &quot;KMP&quot;)&quot; ? Still it&#39;s getting triggered twice."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1545836379, "post_id": 53933121, "comment_id": 94707530, "body": "With the cell selected, go to the Formula ribbon and click on Evaluate Formula under the Formula Auditing group. It will let you step through the calculations and see how Excel is evaluating it. See if you can spot where the error is when doing that."}], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 1, "last_activity_date": 1545837877, "creation_date": 1545837877, "answer_id": 53933940, "question_id": 53933121, "link": "https://stackoverflow.com/questions/53933121/excel-udf-takes-empty-parameter-in-unwanted-second-invocation/53933940#53933940", "title": "Excel UDF takes empty parameter in unwanted second invocation", "body": "<p>I'm not sure how VBA code translate to c# for Excel, so I'll try to give a comprehensive explanation/example.</p>\n\n<hr>\n\n<p>In VBA, there are two main ways to pass a reference for an excel cell (or Range) to a UDF.</p>\n\n<ol>\n<li><p>Using a string parameter (i.e. <code>Data(name as String)</code>)</p></li>\n<li><p>Using a Range Object parameter (i.e. <code>Data(name as Range)</code> or more broadly <code>Data(name as Object)</code>)</p></li>\n</ol>\n\n<p>When the string parameter is used, the range's value is usually accessed in the code via <code>Worksheet(\"Name\").Range(\"String Param\")).Value</code>. When the object parameter is used, the code generally looks like <code>RangeParam.Value</code>.</p>\n\n<p>There are also times when a range is hard-coded into or indirectly referenced by a UDF. I would avoid doing this; especially if that range contains a formula.</p>\n\n<hr>\n\n<p>When Excel is doing calculations, it performs multiple steps.</p>\n\n<ol>\n<li>Initiate calculations in each cell to determine the range parameters. (This is used to determine dependencies.)</li>\n<li>Create the dependency tree with the proper order of calculations.</li>\n<li>Do the finalized calculations in the determined order.</li>\n</ol>\n\n<p>The important things to understand from this are:</p>\n\n<ul>\n<li>If a range is referenced via a string parameter, Excel may not understand the dependency.</li>\n<li>If a range is referenced in the calculation, but hardcoded in, indirectly referenced, or otherwise not passed in as a parameter, Excel will not understand the dependency.</li>\n<li>If the UDF will get differing results depending on the number of times it's run, then there will be unexpected results (from Excel's multi-step dependency-determinations).</li>\n</ul>\n\n<hr>\n\n<p>A few other notes:</p>\n\n<p>If an error occurs in a UDF, how that's dealt with can vary a tad between whether the UDF being used in the worksheet or whether it's being called via other code.</p>\n\n<p>I don't think you'll be able to prevent Excel from running the calculation twice, as that's part of how it's determining dependencies (unless I'm completely misunderstanding what you wrote). However, I would also expect that the calculation with the empty value of <code>A1</code> would occur <strong>before</strong> the final calculation value with the actual result. If the second (final) calculation result is the one with the blank <code>A1</code>, then I'm not sure what to tell you, besides checking that all cells/ranges being referenced in a UDF are being passed into that UDF as parameter objects.</p>\n"}, {"tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1545839566, "creation_date": 1545839566, "answer_id": 53934202, "question_id": 53933121, "link": "https://stackoverflow.com/questions/53933121/excel-udf-takes-empty-parameter-in-unwanted-second-invocation/53934202#53934202", "title": "Excel UDF takes empty parameter in unwanted second invocation", "body": "<p>Make sure that cell A3 is empty before you insert the UDF into cell A1.  The only way that the \"Data\" UDF gets called is if it already exists in the sheet you're adding it to.  To clarify - If there is no formula in cell A3, then there's no way the \"Data\" UDF can get called.  But changing the value in cell A1 by inserting the \"Period\" UDF will trigger the formula in cell A3 to recalculate, since one of the parameters being passed into it just got changed.\nAnother option would predicated on needing just the values and not the actual UDFs in the cells.  In that case simply set the \".Value2\" of the cells using the \"Data\" and \"Period\" functions, passing the \"Period\" value as a function into the \"Data\" function.</p>\n\n<pre><code>Range rngPeriod; //Set to cell \"A1\"\nRange rngDate; //Set to cell \"A3\"\nrngPeriod.Value2 = GetPeriod(\"KMP\", \"27-12-18\");\nrngData.Value2 =Data(GetPeriod(\"KMP\", \"27-12-18\"),\"KMP\");\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 7024324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GSGHO.jpg?s=128&g=1", "display_name": "Sourabh Mishra", "link": "https://stackoverflow.com/users/7024324/sourabh-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1549156067, "creation_date": 1545832951, "last_edit_date": 1549156067, "question_id": 53933121, "link": "https://stackoverflow.com/questions/53933121/excel-udf-takes-empty-parameter-in-unwanted-second-invocation", "title": "Excel UDF takes empty parameter in unwanted second invocation", "body": "<p>In my project the argument of one UDF is the result of another UDF function.</p>\n\n<p>For example:</p>\n\n<pre><code>GetPeriod(string name, string date) {\n           // logic \n          }\n\nData(string name, string period) {\n          // logic\n          }\n</code></pre>\n\n<p>I am using these UDF in two different cells as</p>\n\n<pre><code>cell a1: =GetPeriod(\"KMP\", \"27-12-18\")\ncell a3: =Data(a$1,\"KMP\")\n</code></pre>\n\n<p>I am using the result of one UDF (GetPeriod) as a parameter in another UDF(Data).</p>\n\n<p>The issue here is the Data UDF is triggered twice: one time with the actual result, and one time with empty value of cell A1.</p>\n\n<p>I tried setting calculation mode to manual, but it still gets invoked twice.</p>\n\n<p>Is there any possible problem with this design or is there any way to set up the precedence in UDF so that Excel understands which UDF to trigger first?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545833451, "post_id": 53933095, "comment_id": 94706652, "body": "Start here:<a href=\"https://stackoverflow.com/a/43166192/9912714\">Removing special characters VBA Excel</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1545833456, "post_id": 53933095, "comment_id": 94706656, "body": "Where do these symbols come from? What&#39;s the origin of the data in the list? Are these non-Latin characters? Then it may be a question of the <i>font</i> with which the cells have been formatted. Try applying a Unicode font to them."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545850208, "post_id": 53933095, "comment_id": 94711977, "body": "Whatta names! LOL! \ud83d\ude06"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1546019124, "post_id": 53933095, "comment_id": 94762270, "body": "Added a tricky solution permitting to analyze your string inputs via so called <code>Byte</code> arrays. - Further hint: It&#39;s good use and also helpful for other readers to mark one of the received answers as accepted if you found it helpful (acceptance is indicated by a colored checkmark next to the answer). C.f. <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 10305053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-20FmAO5JSvo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMCRyHo6lTVn-gWAbATBo5V_29WbQ/mo/photo.jpg?sz=128", "display_name": "Walton Surratt", "link": "https://stackoverflow.com/users/10305053/walton-surratt"}, "is_accepted": false, "score": 0, "last_activity_date": 1545850723, "creation_date": 1545850723, "answer_id": 53936016, "question_id": 53933095, "link": "https://stackoverflow.com/questions/53933095/detecting-non-standard-symbols/53936016#53936016", "title": "Detecting non-standard symbols", "body": "<p>The best method is to validate each character in the string so that you can eliminate any symbols or characters that are not expected. Here's the code for a simple function that checks if a string has ONLY lowercase or uppercase letters (no spaces or special characters/symbols).</p>\n\n<pre><code>Public Function IsValidName(Name As String) As Boolean\n\n    Dim ValidCharacters As String, Position As Integer, Character As String\n\n    'STEP 1: set up valid characters for string\n    ValidCharacters = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\n    'STEP 2: start position at first character\n    Position = 1\n\n    While Position &lt;= Len(Name)\n        'Get single character from current position in Name\n        Character = Mid(Name, Position, 1)\n\n        'Locate the position of the character in the ValidCharacters string\n        '   If InStr() returns 0, then the character was not found in the string\n        If InStr(ValidCharacters, Character) = 0 Then\n            IsValidName = False\n            Exit Function\n        End If\n\n        'Increment position\n        Position = Position + 1\n    Wend\n\n    'STEP 3: all characters were found in ValidCharacters string - return TRUE\n    IsValidName = True\nEnd Function\n</code></pre>\n\n<p>You can also modify the function to parse out any symbols in the name and return only the valid characters. See the function below:</p>\n\n<pre><code>Public Function ParseName(Name As String) As String\n\n    Dim ValidCharacters As String, Position As Integer, Character As String, ValidName As String\n\n    'STEP 1: set up valid characters for string\n    ValidCharacters = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\n    'STEP 2: start position at first character\n    Position = 1\n\n    While Position &lt;= Len(Name)\n        'Get single character from current position in Name\n        Character = Mid(Name, Position, 1)\n\n        'Locate the position of the character in the ValidCharacters string\n        '   If InStr() is NOT 0, then the character was found and can be added to the ValidName\n        If InStr(ValidCharacters, Character) &lt;&gt; 0 Then\n            ValidName = ValidName &amp; Character\n        End If\n\n        'Increment position\n        Position = Position + 1\n    Wend\n\n    'STEP 3: all characters were found in ValidCharacters string - return TRUE\n    ParseName = ValidName\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1546016078, "creation_date": 1546016078, "answer_id": 53961799, "question_id": 53933095, "link": "https://stackoverflow.com/questions/53933095/detecting-non-standard-symbols/53961799#53961799", "title": "Detecting non-standard symbols", "body": "<p><strong>Analyze standard and non-standard characters via <code>Byte</code> Array</strong></p>\n\n<p>This example uses OP's first line string \"\u266bmuz\u266b\" of variable <code>s</code> assigned to a <code>Byte</code> array which allows to analyze each character code represented by two bytes per character. This 2-byte architecture allows to detect non-standard characters, get their decimal or hexadecimal values (~~> cf. <code>ChrW</code> and <code>AscW</code> function). Furthermore this example isolates the standard characters in a final <code>s</code> variable. Feel free to modify code in any wanted direction :-)</p>\n\n<p><strong>Hint</strong></p>\n\n<p>A very helpful site to search non-standard characters by direct Input can be found at <a href=\"https://unicode-table.com/en/blocks/\" rel=\"nofollow noreferrer\">https://unicode-table.com/en/blocks/</a></p>\n\n<pre><code>Sub DedectNonStandardSymbols()\n' Meth: analyze a Byte-array consisting of 2 bytes with a pair of character codes;\n'       e.g. code sequence 96 followed by 0 represents the standard character \"a\"\n' Note: VBA handles strings in Unicode encoded as UTF-16, so\n'       each \u2018character\u2019 of the string corresponds at least to a 16 bit WORD (2 bytes) of memory.\n' Hint: For details about Windows' Little Endian architecture\n'       where the lowest significant byte appears first in memory, followed by the most significant byte at the next address.\n'       see http://support.microsoft.com/kb/102025\n  Dim by() As Byte, by2() As Byte, s As String\n  Dim i&amp;, ii&amp;, dec&amp;\n' build example string (cf. 1st example string in OP)\n  s = ChrW(&amp;H266B) &amp; \"muz\" &amp; ChrW(&amp;H266B)     ' beamed eighth notes surrounding the standard characters \"muz\"\n' get byte sequences\n  by = s: ReDim by2(0 To UBound(by))\n' loop through array and detect non standard characters\n  For i = LBound(by) To UBound(by) Step 2\n      dec = by(i + 1) * 16 * 16 + by(i)       ' 2nd word (byte)\n      Debug.Print i / 2 + 1, by(i) &amp; \", \" &amp; by(i + 1), _\n            \"dec \" &amp; dec &amp; \"/hex &amp;H\" &amp; WorksheetFunction.Dec2Hex(Format(dec, \"0\")), _\n            \"=&gt; \"\"\" &amp; ChrW(dec) &amp; \"\"\"\" &amp; IIf(by(i + 1) = 0, \"\", \" (non-standard char)\")\n      If by(i + 1) = 0 Then\n         by2(ii) = by(i): by2(ii + 1) = 0: ii = ii + 2\n      End If\n  Next i\n  ReDim Preserve by2(0 To ii - 1)\n  s = by2\n  Debug.Print \"String without non-standard chars: \"\"\" &amp; s &amp; \"\"\"\"\nEnd Sub\n</code></pre>\n\n<p><strong>Example output in VBE's immediate window</strong></p>\n\n<pre><code> 1            107, 38       dec 9835/hex &amp;H266B         =&gt; \"?\" (non-standard char)\n 2            109, 0        dec 109/hex &amp;H6D            =&gt; \"m\"\n 3            117, 0        dec 117/hex &amp;H75            =&gt; \"u\"\n 4            122, 0        dec 122/hex &amp;H7A            =&gt; \"z\"\n 5            107, 38       dec 9835/hex &amp;H266B         =&gt; \"?\" (non-standard char)\n String without non-standard chars: \"muz\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10835398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T2Ms18cYXss/AAAAAAAAAAI/AAAAAAAAAmQ/ZhvcH_BKMbc/photo.jpg?sz=128", "display_name": "Kepler b452", "link": "https://stackoverflow.com/users/10835398/kepler-b452"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1546016078, "creation_date": 1545832823, "last_edit_date": 1545833216, "question_id": 53933095, "link": "https://stackoverflow.com/questions/53933095/detecting-non-standard-symbols", "title": "Detecting non-standard symbols", "body": "<p>I have a problem with my Excel list. I have names of users which include non-standard symbols. how can I detect or find them by VBA? can anyone suggest solution for this?</p>\n\n<p>Some of them here, but there are a lot of user names that contain symbols</p>\n\n<ul>\n<li>\u266bmuz\u266b </li>\n<li>BOSS\ud83d\udc54 </li>\n<li>h\u2764\ufe0f </li>\n<li>name\u261d</li>\n</ul>\n\n<p>and so on</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 117, "user_id": 7189905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-UUllNzz7XxY/AAAAAAAAAAI/AAAAAAAAACI/jpCmskrJeFM/photo.jpg?sz=128", "display_name": "Ruiru", "link": "https://stackoverflow.com/users/7189905/ruiru"}, "edited": false, "score": 0, "creation_date": 1545831323, "post_id": 53932727, "comment_id": 94705901, "body": "Maybe i can use INDIRECT() since the excel files are all opened? Can someone guide me on how to use this function?"}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1545833885, "creation_date": 1545833885, "answer_id": 53933276, "question_id": 53932727, "link": "https://stackoverflow.com/questions/53932727/vlookup-directory-pointing-to-a-specific-directory/53933276#53933276", "title": "vlookup directory pointing to a specific directory", "body": "<p>You creating multiple instances of Excel.  Eliminate all but the first <code>CreateObject(\"Excel.Application\")</code>'</p>\n\n<blockquote>\n<pre><code> Set xlApp = CreateObject(\"Excel.Application\")\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1545838420, "creation_date": 1545838420, "answer_id": 53934028, "question_id": 53932727, "link": "https://stackoverflow.com/questions/53932727/vlookup-directory-pointing-to-a-specific-directory/53934028#53934028", "title": "vlookup directory pointing to a specific directory", "body": "<h1>Excel in VBScript</h1>\n\n<pre><code>Option Explicit\n\nDim xlApp, xlBook, shell\nDim folderPath\n\n'  Set shell = CreateObject(\"WScript.Shell\")\n'  shell.Run \"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\ _\n'      &amp; \"TABLE_COUNT_SCRIPT\\All_in_one.bat\", 1, True\n\n  folderPath = \"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\\" _\n      &amp; \"TABLE_COUNT_SCRIPT\\\"\n\n  ' To avoid multiple instances of Excel, when it is running,\n  ' the GetObject Method has to be used, but when Excel is not running\n  ' the CreateObject Method has to be used to open it.\n  On Error Resume Next\n  ' When Excel is running:\n  Set xlApp = GetObject(, \"Excel.Application\")      ' Excel is running\n  If Err Then\n    Set xlApp = CreateObject(\"Excel.Application\")   ' Excel not running.\n  End If\n  On Error GoTo 0\n\n  With xlApp\n    .Visible = True\n    .DisplayAlerts = False\n\n    .Workbooks.Open (folderPath &amp; \"Assetco\\Assetco.csv\")\n    .Workbooks.Open (folderPath &amp; \"BIOS\\BIOS.csv\")\n' .Workbooks.Open(folderPath &amp; \"FDS\\FDS.csv\")\n' .Workbooks.Open(folderPath &amp; \"FTTH\\FTTH.csv\")\n' .Workbooks.Open(folderPath &amp; \"FTTH_Filter\\ftth_union_filter_queries.csv\")\n' .Workbooks.Open(folderPath &amp; \"Gtech_Filter\\Gtech_filter_queries.csv\")\n' .Workbooks.Open(folderPath &amp; \"Gtechv1\\Gtech.csv\")\n' .Workbooks.Open(folderPath &amp; \"MARS\\MARS.csv\")\n' .Workbooks.Open(folderPath &amp; \"MARS_Filter\\mars_filter_queries.csv\")\n' .Workbooks.Open(folderPath &amp; \"WOMS\\WOMS.csv\")\n' .Workbooks.Open(folderPath &amp; \"Workflow\\WORKFLOW.csv\")\n' .Workbooks.Open(folderPath &amp; \"Workflow_Filter\\workflow_filter_queries.csv\")\n\n    folderPath = \"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\\" _\n        &amp; \"Union_queries\\\"\n\n    .Workbooks.Open (folderPath &amp; \"ASSETCO_union.csv\")\n    .Workbooks.Open (folderPath &amp; \"BIOS_union.csv\")\n' .Workbooks.Open(folderPath &amp; \"FDS_union.csv\")\n' .Workbooks.Open(folderPath &amp; \"FTTH_union.csv\")\n' .Workbooks.Open(folderPath &amp; \"GTECH_union.csv\")\n' .Workbooks.Open(folderPath &amp; \"MARS_union.csv\")\n' .Workbooks.Open(folderPath &amp; \"WOMS_union.csv\")\n' .Workbooks.Open(folderPath &amp; \"WORKFLOW_union.csv\")\n\n    Set xlBook = .Workbooks.Open(folderPath _\n        &amp; \"extraction_report_template.xlsm\", 0, True)\n    .Run \"Macro1\"\n\n    .DisplayAlerts = True\n    .Quit\n\n  End With\n\n  Set xlApp = Nothing\n\n  WScript.Quit\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 7189905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-UUllNzz7XxY/AAAAAAAAAAI/AAAAAAAAACI/jpCmskrJeFM/photo.jpg?sz=128", "display_name": "Ruiru", "link": "https://stackoverflow.com/users/7189905/ruiru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53934028, "answer_count": 2, "score": 2, "last_activity_date": 1545838420, "creation_date": 1545830766, "question_id": 53932727, "link": "https://stackoverflow.com/questions/53932727/vlookup-directory-pointing-to-a-specific-directory", "title": "vlookup directory pointing to a specific directory", "body": "<p>I am having this problem when running my vba script. It is supposed to open up 4 excel files and one template with a macro. Then it activate the macro and populate each table with vlookup to the specific excel file. The 2 sheets have 3 columns, 2 columns are looking for 1 excel file and the 3rd column looks for the 2nd excel file. But when i run the script, the first 2 columns are #NA whereas the 3rd column has the file directory to the excel file. When i do it manually(Manually open all 4 excel files and click on a button to run the macro), it successfully populate all 3 columns for both sheets. What could be the problem? I searched around and vlookup searches for excel files that are opened, thats why i open the 4 excel files before running the macro to populate the tables.\nThis is my VBA Script:</p>\n\n<pre><code>Option Explicit\n\nDim xlApp, xlBook, shell\nDim folderPath\n\n\n' Set shell = CreateObject(\"WScript.Shell\")   \n' shell.Run \"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\TABLE_COUNT_SCRIPT\\All_in_one.bat\", 1, True\n\n\nfolderPath = \"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\TABLE_COUNT_SCRIPT\\\"\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\nxlApp.DisplayAlerts = False\n\nxlApp.Workbooks.Open(folderPath &amp; \"Assetco\\Assetco.csv\")\nxlApp.Workbooks.Open(folderPath &amp; \"BIOS\\BIOS.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"FDS\\FDS.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"FTTH\\FTTH.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"FTTH_Filter\\ftth_union_filter_queries.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"Gtech_Filter\\Gtech_filter_queries.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"Gtechv1\\Gtech.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"MARS\\MARS.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"MARS_Filter\\mars_filter_queries.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"WOMS\\WOMS.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"Workflow\\WORKFLOW.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"Workflow_Filter\\workflow_filter_queries.csv\")\n\nfolderPath = \"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\Union_queries\\\"\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\nxlApp.DisplayAlerts = False\n\nxlApp.Workbooks.Open(folderPath &amp; \"ASSETCO_union.csv\")\nxlApp.Workbooks.Open(folderPath &amp; \"BIOS_union.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"FDS_union.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"FTTH_union.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"GTECH_union.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"MARS_union.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"WOMS_union.csv\")\n' xlApp.Workbooks.Open(folderPath &amp; \"WORKFLOW_union.csv\")\n\nset xlBook = xlApp.Workbooks.Open(\"C:\\Users\\NLTAdmin\\Desktop\\Extraction_Automation\\extraction_report_template.xlsm\",0,True)\nxlApp.Run \"Macro1\"\n\nxlApp.DisplayAlerts = True\nxlApp.Quit\n\nSet xlApp = Nothing\n\nWScript.Quit\n</code></pre>\n\n<p>The first Workbooks.open is suppose to open the excel files to populate the first 2 columns, whereas the 2nd Workbooks.Open is to populate the 3rd column. Only the 3rd column gets populated.\n3rd column has the file directory and is populated:\n<a href=\"https://i.stack.imgur.com/Mmo0z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mmo0z.jpg\" alt=\"3rd column has the file directory\"></a>\n1st and 2nd column unable to be found\n<a href=\"https://i.stack.imgur.com/jNrT3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jNrT3.jpg\" alt=\"1st column\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545834136, "post_id": 53932709, "comment_id": 94706853, "body": "You should use the actual instance of the Userform not it&#39;s code name.  Read: <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">Rubberduck VBA: UserForm1.Show</a>"}, {"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1545838723, "post_id": 53932709, "comment_id": 94708266, "body": "Thanks, TinMan, I will read that article"}], "owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1545830685, "creation_date": 1545830685, "question_id": 53932709, "link": "https://stackoverflow.com/questions/53932709/dynamic-userform-name-in-a-class-module", "title": "Dynamic UserForm Name in a Class Module", "body": "<p>I have this code in a Class Module</p>\n\n<pre><code>Public WithEvents chk As MSForms.CheckBox\n\nPrivate Sub chk_Click()\n    Dim c As Object, sName As String\n\n    For Each c In ThisWorkbook.VBProject.VBComponents\n         If c.Type = 3 Then\n             If IsLoaded(c.Name) Then\n                If chk = True Then\n                    UserForm1.lblCount.Caption = CInt(UserForm1.lblCount.Caption) + 1\n                Else\n                    UserForm1.lblCount.Caption = CInt(UserForm1.lblCount.Caption) - 1\n                End If\n            End If\n         End If\n    Next\n\nEnd Sub\n\nFunction IsLoaded(formName As String) As Boolean\n    Dim frm As Object\n\n    For Each frm In VBA.UserForms\n        If frm.Name = formName Then\n            IsLoaded = True\n            Exit Function\n        End If\n    Next frm\n    IsLoaded = False\n\nEnd Function\n</code></pre>\n\n<p>This works fine when UserForm 1 is loaded. However, UserForm1 gets created at runtime by code in a standard module and the created Userform could be named UserForm2 or UserForm3 or UserForm4 etc.</p>\n\n<p>c.Name returns the correct userform name, I am struggling to get \"UserForm1\" replaced with \"c.Name\"</p>\n\n<p>Any suggestions greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1545828020, "post_id": 53931515, "comment_id": 94704831, "body": "What have you tried so far?  Showing your code is a great way to start a post on this forum.  Note that StackOverflow is a collaborative site for helping with <i>specific</i> coding issues, not a code-for-you service."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8533165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7da11ebac0051e079393010ee767e46?s=128&d=identicon&r=PG&f=1", "display_name": "AshokKumarKonanki", "link": "https://stackoverflow.com/users/8533165/ashokkumarkonanki"}, "edited": false, "score": 0, "creation_date": 1545917527, "post_id": 53932923, "comment_id": 94730334, "body": "Above code each time inserting values to newly created sheet which is causing duplication of records.Please help me in this. I am not expert in macros"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 3, "user_id": 8533165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7da11ebac0051e079393010ee767e46?s=128&d=identicon&r=PG&f=1", "display_name": "AshokKumarKonanki", "link": "https://stackoverflow.com/users/8533165/ashokkumarkonanki"}, "edited": false, "score": 0, "creation_date": 1545921577, "post_id": 53932923, "comment_id": 94731799, "body": "Ashok, did you put in your preferred if statement to allow only the desired data to be pulled?  If not, then all data will be pulled over to the new sheet.  Note that I gave you a general type of macro to help you get to where you&#39;re trying to be.  You would need to add your own additional information."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1545831894, "creation_date": 1545831894, "answer_id": 53932923, "question_id": 53931515, "link": "https://stackoverflow.com/questions/53931515/creating-new-sheet-based-on-the-row-with-new-header-names/53932923#53932923", "title": "Creating new sheet based on the row with new header names", "body": "<p>Something like this should be the goal:</p>\n\n<pre><code>Dim lrs as long, lrd as long, i as long\nlrs = Sheets(\"Summary\").cells(Sheets(\"Summary\").Rows.Count,1).end(xlup).row\nWith Sheets(\"EMDN_SW_Project\") 'longer to type than \"Summary\"\n    for i = 2 to lrs 'assumes header in row 1\n        'if statement if needed\n            lrd = .cells(.rows.count,1).end(xlup).row\n            .cells(lrd+1,1).value = Sheets(\"Summary\").cells(i,1).value\n        'end if\n    next i\nEnd With\n</code></pre>\n\n<p>I would recommend formatting at the end with the desired format, as opposed to assessing the formatting as you go (much slower).</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 11306926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jueZb.jpg?s=128&g=1", "display_name": "Patouf", "link": "https://stackoverflow.com/users/11306926/patouf"}, "is_accepted": false, "score": 0, "last_activity_date": 1576846392, "creation_date": 1576846392, "answer_id": 59425606, "question_id": 53931515, "link": "https://stackoverflow.com/questions/53931515/creating-new-sheet-based-on-the-row-with-new-header-names/59425606#59425606", "title": "Creating new sheet based on the row with new header names", "body": "<p>Maybe somthing like that can help you. Creating a sheet for evey entries in a specific column of a Table.</p>\n\n<pre><code>Private Sub CreateSheets()\n    Dim ws As Worksheet\n    Dim RowCount As Integer\n    Dim TempName As String\n    Dim ImportTable As ListObject\n\n    Set ws = ThisWorkbook.Worksheets(\"WorkSheetName\") \n    Set ImportTable = ws.ListObjects(\"TableName\")\n\n    RowCount = ImportTable.ListRows.Count\n\n    'create a sheet for each value in a specific column of a table\n    For i = 1 To RowCount\n        TempName = ImportTable.DataBodyRange.Cells(i, ImportTable.ListColumns(\"ChoosedColumn\").Index)\n        Sheets.Add.Name = TempName\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8533165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7da11ebac0051e079393010ee767e46?s=128&d=identicon&r=PG&f=1", "display_name": "AshokKumarKonanki", "link": "https://stackoverflow.com/users/8533165/ashokkumarkonanki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1578482017, "creation_date": 1545823992, "last_edit_date": 1578482017, "question_id": 53931515, "link": "https://stackoverflow.com/questions/53931515/creating-new-sheet-based-on-the-row-with-new-header-names", "title": "Creating new sheet based on the row with new header names", "body": "<p>I have to create new sheet using macros based by naming the first column value (Active cell) and need to give different header names and specific column values need to copy to the newly created sheet.</p>\n\n<p>Note: A few column values need to copy from the source sheet to new sheet and need to give name for new sheet first column values of active cell. It should not apply for all column values, I mean name should be active cell value only.</p>\n\n<p>As per the attached screen shots, I need to create value of project name column we need to create new sheet (second screen shot required output).</p>\n\n<p><img src=\"https://i.stack.imgur.com/3GXXn.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/MlI74.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "outlook", "onenote"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546217141, "post_id": 53930323, "comment_id": 94802682, "body": "Can you try exporting the OneNote as HTML, then parsing the HTML to find the table?"}, {"owner": {"reputation": 81, "user_id": 4561350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xfffn.jpg?s=128&g=1", "display_name": "Konrad Gajewski", "link": "https://stackoverflow.com/users/4561350/konrad-gajewski"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546255452, "post_id": 53930323, "comment_id": 94810970, "body": "@RyanWildry - nah... I need this to be seamless and working without user intervention. Unless this all be done by the code itself, which I understand you are suggesting. Still I do not know how to do that. A good thought though."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 2, "creation_date": 1546448765, "post_id": 53930323, "comment_id": 94857437, "body": "It looks like you want us to write some code for you. While many users are willing to produce code for a coder in distress, they usually only help when the poster has already tried to solve the problem on their own. A good way to demonstrate this effort is to include the code you&#39;ve written so far, example input (if there is any), the expected output, and the output you actually get (console output, tracebacks, etc.). The more detail you provide, the more answers you are likely to receive. Check the <a href=\"https://stackoverflow.com/tour\">FAQ</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 81, "user_id": 4561350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xfffn.jpg?s=128&g=1", "display_name": "Konrad Gajewski", "link": "https://stackoverflow.com/users/4561350/konrad-gajewski"}, "reply_to_user": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1546598683, "post_id": 53930323, "comment_id": 94909985, "body": "@fcsr Not really. Just pointing in the right direction would be enough. Provided this direction solves my problem."}, {"owner": {"reputation": 791, "user_id": 6206578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75198f2136c95a1402ccc100f944bcf?s=128&d=identicon&r=PG&f=1", "display_name": "fcsr", "link": "https://stackoverflow.com/users/6206578/fcsr"}, "edited": false, "score": 0, "creation_date": 1546600032, "post_id": 53930323, "comment_id": 94910648, "body": "Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>."}], "owner": {"reputation": 81, "user_id": 4561350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xfffn.jpg?s=128&g=1", "display_name": "Konrad Gajewski", "link": "https://stackoverflow.com/users/4561350/konrad-gajewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1546084970, "creation_date": 1545817931, "question_id": 53930323, "link": "https://stackoverflow.com/questions/53930323/how-to-get-data-form-a-onenote-table-to-a-outlook-macro", "title": "How to get data form a OneNote table to a Outlook macro?", "body": "<p>I am working on a complex macro that will source data from many places and based on this data create a message and an appointment in Outlook. One of those places I need to take data from is a table placed inside a OneNote tab, that people put an email into. All I need is that email inside the Outlook macro so I can feed this into the e-mail being created. Seems easy, but...</p>\n\n<p>So far I have not found an answer on SO or other places, that was clear enough for me to understand. I presume one would have to add OneNote in References, and thus gaining some VB command/commands/datasources that would do that, but I am a bit of a newbie when it comes to this. Can you advise, or at least point in the right direction?</p>\n\n<p>(I use MS Office 365/Win10)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545834658, "post_id": 53930061, "comment_id": 94707014, "body": "Could you share the code you wrote to solve your problem?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 0, "creation_date": 1545841538, "post_id": 53930368, "comment_id": 94709171, "body": "Hello @user10829321 , your proposed solution works pretty good, except the fact that it changes only to strings in column A. Any clue how to apply this solution to all worksheet, where the title of the cell is &quot;Orgnisation&quot;, I have more than one cell with the same name. Many thanks for your support"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "is_accepted": true, "score": 1, "last_activity_date": 1545818213, "creation_date": 1545818213, "answer_id": 53930368, "question_id": 53930061, "link": "https://stackoverflow.com/questions/53930061/change-color-of-part-of-the-string-between-backslashes/53930368#53930368", "title": "Change color of part of the string between backslashes", "body": "<p>To manipulate the properties of a substring within a cell's string value, you need to use the Range.Characters property. This requires a starting point and a length to identify the substring.</p>\n\n<p>Since you want the positions of the trailing backslashes, using InStrRev would likely be more efficient than InStr in determining these positions.</p>\n\n<pre><code>Sub redBetweenBackslashes()\n\n    Dim i As Long, s As Long, e As Long, str As String\n\n    With Worksheets(\"sheet4\")\n        For i = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            str = .Cells(i, \"A\").Value2\n            e = InStrRev(str, Chr(92), -1, vbBinaryCompare) - 1\n            If e &gt; 0 Then\n                s = InStrRev(str, Chr(92), e, vbBinaryCompare) + 1\n                If s &gt; 1 Then\n                    With .Cells(i, \"A\").Characters(Start:=s, Length:=e - s + 1)\n                        .Font.Color = vbRed\n                        .Font.Bold = True\n                    End With\n                End If\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I've added Bold formatting to the red font color.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LLvkK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LLvkK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "is_accepted": false, "score": 0, "last_activity_date": 1545818234, "creation_date": 1545818234, "answer_id": 53930374, "question_id": 53930061, "link": "https://stackoverflow.com/questions/53930061/change-color-of-part-of-the-string-between-backslashes/53930374#53930374", "title": "Change color of part of the string between backslashes", "body": "<p>You need something like the above using instrrev</p>\n\n<pre><code>Function MarkRed()\nDim R As Long\nFor R = 28 To 29 ' just a sample\n    MarkTextRed (Cells(R, 2))\nNext\nEnd Function\n\nPublic Function MarkTextRed(myCell As Range)\nDim T As String\nDim b As Integer, c As Integer\nT = myCell.Value\nb = InStrRev(T, \"\\\")\nc = InStrRev(T, \"\\\", b - 1)\nIf c &lt; b Then\n    With myCell.Characters(Start:=c + 1, Length:=(b - c - 1)).Font\n        .Color = -16776961\n    End With\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1545829174, "accepted_answer_id": 53930368, "answer_count": 2, "score": -1, "last_activity_date": 1578482097, "creation_date": 1545816667, "last_edit_date": 1578482097, "question_id": 53930061, "link": "https://stackoverflow.com/questions/53930061/change-color-of-part-of-the-string-between-backslashes", "closed_reason": "Needs more focus", "title": "Change color of part of the string between backslashes", "body": "<p>I am stuck with this problem: I would like to loop in all the worksheets of a woorkbook performing this specific action: changing the color to  the part of a string between the last backslashes, in the Organisation column:</p>\n\n<p>This is the original data \n<a href=\"https://i.stack.imgur.com/F2eND.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F2eND.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is how I would like to change the string as follow:\n<a href=\"https://i.stack.imgur.com/2h0rr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2h0rr.png\" alt=\"enter image description here\"></a></p>\n\n<p>The part of the string that I would like to change color doesn't have the same lenght (otherwise I could solve the issue with the Right function). Do you have any suggestion how I can code a subroutine to solve that? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 183, "user_id": 7162907, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BYQMoQipln4/AAAAAAAAAAI/AAAAAAAAACI/SlkqFiU9IS8/photo.jpg?sz=128", "display_name": "Farhad Mortezapour", "link": "https://stackoverflow.com/users/7162907/farhad-mortezapour"}, "edited": false, "score": 0, "creation_date": 1545817441, "post_id": 53929940, "comment_id": 94701139, "body": "This error has the following causes and solutions: 1- You misspelled the object or member name. Check the spelling of the names and check the Type statement or the object documentation to determine what the members are and the proper spelling of the object or member names. 2- You specified a collection index that&#39;s out of range. Check the Count property to determine whether a collection member exists. Note that collection indexes begin at 1 rather than zero, so the Count property returns the highest possible index number."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545825822, "post_id": 53929940, "comment_id": 94704044, "body": "What is tv_hiearchy and does it have the member (method) SetFocus?"}], "owner": {"reputation": 11, "user_id": 10815639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EbrY0uPQ4yo/AAAAAAAAAAI/AAAAAAAAADw/Z1P0Md11OCI/photo.jpg?sz=128", "display_name": "PP24", "link": "https://stackoverflow.com/users/10815639/pp24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 876, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558769741, "creation_date": 1545815924, "last_edit_date": 1558769741, "question_id": 53929940, "link": "https://stackoverflow.com/questions/53929940/method-or-data-member-not-found-error-in-excel-vba-2016", "title": "Method or Data Member not found error in excel VBA 2016", "body": "<p>When I run the following code it throws a compile error:</p>\n\n<blockquote>\n  <p>Method or data member not found</p>\n</blockquote>\n\n<p>and highlights <code>.tv_Hierarchy</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/26fFS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/26fFS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Even defining <code>Option Explicit</code> in the beginning still it throws the same error.</p>\n\n<p>The entire code.</p>\n\n<pre><code>Option Compare Text\nOption Explicit\n\nDim OTvw As TreeView\nDim oNode As Node\nDim sStartMember As String\nDim sDimension As String\nDim DimMembers As Collection\nDim HierMembers As Collection    \n\nPrivate Sub lbx_MemData_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n\nOn Error GoTo ErrorHandler:\n\nDim sMemberKey As String\n\n'Show the duplicate member in the hierarchy\nIf Me.lbx_MemData.List(1, 1) = \"Duplicate Member\" Then\n    If Left(Me.lbx_MemData.value, 11) = \"Hier Parent\" Then\n        Cancel = True\n        sMemberKey = Me.lbx_MemData.List(Me.lbx_MemData.ListIndex, 1)\n        Me.tv_Hierarchy.SetFocus\n        Me.tv_Hierarchy.nodes.Item(sMemberKey).Selected = True\n    End If\nEnd If\n\nExitHere:\nExit Sub\n\nErrorHandler:\nSelect Case Err\n    Case Else\n        MsgBox \"Error # \" &amp; Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Error$, \nvbExclamation, AddInShortName + \" - LbxMemDatDblCli\"\n        Resume ExitHere:\nEnd Select\n\nEnd Sub\n\n\nPrivate Sub UserForm_Activate()\n\nOn Error GoTo ErrorHandler:\n\n'Dim\nDim oDim As proCubeApi.Dimension\n\n'Init performed?\nIf bInit = True Then\n    Exit Sub\nEnd If\n\n'Initialise\nSet OTvw = Me.tv_Hierarchy\n\n'Refresh User Selections\nMe.cbx_Dimension.Clear\nMe.tbx_Member.Text = \"\"\n\n'Refresh Form\nClearForm\n\n'Mark the dimension members to clear\nKeepDimMembers = False\n\n'Setup proCube Connection\nIf ModproCubeAPI.CreateDBConnection(dbs, DB) = False Then\n    Me.Hide\n    Exit Sub\nEnd If\n\n'Validate as admin Group\nIf Mod_Util_Sec.IsMemberOfGroup(\"Plc appadmin\") = False Then\n    MsgBox \"You could not be validated as part of the security group responsible for applicagtion administration. The administrator must add you as part of this group before you may proceed.\", vbCritical\n    Me.Hide\n    Exit Sub\nEnd If\n\n'Add all dimensions to dimension selector\nFor Each oDim In DB.Dimensions\n    Me.cbx_Dimension.AddItem (oDim.Name)\nNext oDim\n\n'Init True\nbInit = True\n\nExitHere:\nExit Sub\n\nErrorHandler:\nSelect Case Err\n    Case Else\n        MsgBox \"Error # \" &amp; Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Error$, \nvbExclamation, AddInShortName + \" - UseForAct\"\n        Resume ExitHere:\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pdf", "listbox", "report"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545829303, "post_id": 53929578, "comment_id": 94705241, "body": "Short answer: <i>Yes</i>.  Where is the location of the listbox contents?  If this is a sheet in excel, then you can save that sheet as a pdf, if it&#39;s generated via code, you would need to post to a readable location and save that as a pdf."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545854634, "post_id": 53929578, "comment_id": 94713274, "body": "Hi Cyril. The listbox is in a userform. The contents are displayed within the listbox when I click on a searchbox. It is generated via code."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545854910, "post_id": 53929578, "comment_id": 94713370, "body": "Alright, given that the the listbox is most likely generated from an array in your code, populating the userform1.listbox1, you should be able to append that array to a sheet, then .move that sheet and pdf that file."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545855005, "post_id": 53929578, "comment_id": 94713400, "body": "Can you post the code how the listbox is populated?"}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545856388, "post_id": 53929578, "comment_id": 94713750, "body": "Hi Cyril, I have added how my listbox would be populated in the question"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545927978, "post_id": 53946676, "comment_id": 94734440, "body": "Sorry I don&#39;t quite get the 1st code in the answer. Which for X Loop are we talking about?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545928196, "post_id": 53946676, "comment_id": 94734537, "body": "@Kev The one which populates the list box, including the line of code in italics from my post (copied it from your code).  Your second for X is just a count, so you wouldn&#39;t have the data to put into the helper sheet."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545928213, "post_id": 53946676, "comment_id": 94734544, "body": "With Sheets(arr(i)) throws up an error says &quot;it is our of scope&quot;"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545928508, "post_id": 53946676, "comment_id": 94734652, "body": "@Kev did you change your array to match what you wanted to be looked at (actual sheet names)?  <i>arr = array(&quot;Sheet1&quot;,&quot;Sheet3&quot;)</i> was an example"}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545932477, "post_id": 53946676, "comment_id": 94736151, "body": "sorry still doesn&#39;t work for me as I dont understand where to put the 1st code you supplied within the X loop"}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545932613, "post_id": 53946676, "comment_id": 94736193, "body": "Basically I want a button on my userform that when clicked, it generates a pdf file that contains the contents of my listbox. My listbox can display contents from multiple sheets. So this would be in some kind of array"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545932905, "post_id": 53946676, "comment_id": 94736298, "body": "@Kev see my edit for where the code would go... the preceding parenthetical statement is very important."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545935375, "post_id": 53946676, "comment_id": 94737124, "body": "thank you. But to my original question how can I just save my listbox contents as a pdf. Dont really want to add another worksheet to the workbook as it will be locked down"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545936240, "post_id": 53946676, "comment_id": 94737440, "body": "@Kev unless you append the data somewhere that can be saved as a pdf, you won&#39;t be able."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545936977, "post_id": 53946676, "comment_id": 94737719, "body": "Is there any other recommended way to do this? Basically just export the userform listbox contents to a word document, csv, pdf, etc?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545937059, "post_id": 53946676, "comment_id": 94737741, "body": "What i had suggested was the helper sheet within excel (keeps one VBA structure); you could also add to a .txt, .csv, .docx, etc.  That&#39;s pretty much it... take data from VBA, put it in a readable format (csv/etc.) then use that readable format."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1545932867, "last_edit_date": 1545932867, "creation_date": 1545921151, "answer_id": 53946676, "question_id": 53929578, "link": "https://stackoverflow.com/questions/53929578/save-userfrom-listbox-contents-as-pdf-file/53946676#53946676", "title": "Save Userfrom Listbox Contents as PDF file", "body": "<p>You'll want to add a helper sheet so when you append to the listbox (<em>Me.ListBox1.List(ListBox1.ListCount - 1, X - 1) = ws.Cells(i, X)</em>) that same information is pasted to the helper sheet, to maintain the list allowing you to PDF that sheet.  </p>\n\n<p>Something like this should get you to there, inside of your <em>For X</em> loop:</p>\n\n<pre><code>With Sheets(\"Sheet3\")\n    .Cells(.Rows.Count,1).End(xlUp).Row,1).Value = ws.Cells(i, X)\nEnd With\n</code></pre>\n\n<p>Note that in your code you are consolidating a much larger list, so an efficient way to only collect that consolidated list would be to put it in its own location to utilize later.</p>\n\n<p>You can add a loop to your PDF macro to account for this other sheet, such as:</p>\n\n<pre><code>Dim i as long, arr as variant\narr = array(\"Sheet1\",\"Sheet3\")\nFor i = lbound(arr) to ubound(arr) \n    With Sheets(arr(i))\n        'PDFing macro\n    End with\nNext i\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Hopefully a little more clear (note that you may need to add a sheet to the workbook, as i am arbitrarily using Sheet3):</p>\n\n<pre><code>For X = 1 To 8\n    Me.ListBox1.List(ListBox1.ListCount - 1, X - 1) = ws.Cells(i, X)\n    With Sheets(\"Sheet3\")\n        .Cells(.Rows.Count,1).End(xlUp).Row,1).Value = ws.Cells(i, X)\n    End With\nNext X\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 53946676, "answer_count": 1, "score": 0, "last_activity_date": 1578482126, "creation_date": 1545813907, "last_edit_date": 1578482126, "question_id": 53929578, "link": "https://stackoverflow.com/questions/53929578/save-userfrom-listbox-contents-as-pdf-file", "title": "Save Userfrom Listbox Contents as PDF file", "body": "<p>Below is the macro assigned to my \"Generate Report\" CommandButton to save the active worksheet as a pdf file. I am trying to use this macro to save the contents of my userform listbox as a PDF instead. Is this achievable?</p>\n\n<pre><code>Sub PDFActiveSheet()\nDim ws As Worksheet\nDim strPath As String\nDim myFile As Variant\nDim strFile As String\nOn Error GoTo errHandler\n\nSet ws = ActiveSheet\n\n'enter name and select folder for file\n' start in current workbook folder\nstrFile = Replace(Replace(ws.Name, \" \", \"\"), \".\", \"_\") _\n            &amp; \"_\" _\n            &amp; Format(Now(), \"yyyymmdd\\_hhmm\") _\n            &amp; \".pdf\"\nstrFile = ThisWorkbook.Path &amp; \"\\\" &amp; strFile\n\nmyFile = Application.GetSaveAsFilename _\n    (InitialFileName:=strFile, _\n        FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n        Title:=\"Select Folder and FileName to save\")\n\nIf myFile &lt;&gt; \"False\" Then\n\n    ws.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=myFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n\n     With ws.PageSetup\n         .CenterHeader = \"Asset List\"\n         .Orientation = xlPortrait\n         .Zoom = True\n         .FitToPagesTail = False\n         .FitToPagesWide = 1\n     End With\n\n    MsgBox \"PDF file has been created.\"\nEnd If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\nEnd Sub\n</code></pre>\n\n<p>Below is how the Userform listbox is populated by using the textboxsearch with search button.</p>\n\n<pre><code>Private Sub SearchButton_Click()\n\n'ListBox1.Clear\nListBox1.RowSource = \"\"\nListBox1.ColumnHeads = False\n\n'listbox column headers\n Me.ListBox1.AddItem\n For A = 1 To 8\n     Me.ListBox1.List(0, A - 1) = Sheet2.Cells(1, A)\n Next A\n Me.ListBox1.Selected(0) = True\n\n\n'Populating listbox1 from search\n Dim i As Long\n Dim ws As Worksheet\n\n Dim SheetList(0 To 1) As String\n Dim k As Integer\n\nSheetList(0) = \"Sheet1\"\nSheetList(1) = \"Sheet2\"\n\n  For k = LBound(SheetList) To UBound(SheetList)\n     Set ws = Sheets(SheetList(k))\n\n     For i = 2 To ws.Range(\"A100000\").End(xlUp).Offset(1, 0).Row\n         For j = 1 To 8\n             H = Application.WorksheetFunction.CountIf(ws.Range(\"A\" &amp; i, \"H\" &amp; i), ws.Cells(i, j))\n             If H = 1 And LCase(ws.Cells(i, j)) = LCase(Me.SearchTextBox) Or H = 1 And _\n             ws.Cells(i, j) = Val(Me.SearchTextBox) Then\n                 Me.ListBox1.AddItem\n                 For X = 1 To 8\n                     Me.ListBox1.List(ListBox1.ListCount - 1, X - 1) = ws.Cells(i, X)\n                 Next X\n             End If\n         Next j\n     Next i\n Next k\n\n'Count the listbox rows when populated\n With Me.ListBox1\n For X = 0 To .ListCount - 1\n     Total = X\n Next X\n End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping", "request-headers"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545815259, "post_id": 53928849, "comment_id": 94700323, "body": "What your python code is printing out above is response headers. Where are you printing request headers? req is the response ... &lt;class &#39;requests.models.Response&#39;&gt;"}, {"owner": {"reputation": 140, "user_id": 10568531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355807cad6f3abdf401e57032a6e6dc?s=128&d=identicon&r=PG&f=1", "display_name": "robots.txt", "link": "https://stackoverflow.com/users/10568531/robots-txt"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1545817116, "post_id": 53928849, "comment_id": 94701019, "body": "Right you are @QHarr. That is indeed response headers. However, what I wanted to achieve is get the cookies on the fly (instead of hardcoding) but <code>xmlhttp</code> request doesn&#39;t have that feature so I got success using <code>serverxmlhttp</code> request."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545817307, "post_id": 53928849, "comment_id": 94701096, "body": "Indeed. That is a slightly different question and I would have referred you here: <a href=\"https://stackoverflow.com/a/39801506/6241235\">stackoverflow.com/a/39801506/6241235</a>  .  Nice answer that one! The answer to your above question is kinda as per below."}, {"owner": {"reputation": 140, "user_id": 10568531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355807cad6f3abdf401e57032a6e6dc?s=128&d=identicon&r=PG&f=1", "display_name": "robots.txt", "link": "https://stackoverflow.com/users/10568531/robots-txt"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545818059, "post_id": 53928849, "comment_id": 94701347, "body": "Check out what I&#39;ve posted out there in your linked post. Perhaps the easiest one @QHarr."}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 10568531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355807cad6f3abdf401e57032a6e6dc?s=128&d=identicon&r=PG&f=1", "display_name": "robots.txt", "link": "https://stackoverflow.com/users/10568531/robots-txt"}, "edited": false, "score": 0, "creation_date": 1545813839, "post_id": 53929536, "comment_id": 94699916, "body": "Is it supposed to be an answer <code>why do i need this</code> @Irregular Expression? Btw, where did i ask how to set request headers? My question is how can I get request headers? Thanks."}, {"owner": {"reputation": 91, "user_id": 10546161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4zdwlINpFD4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAE_fkKxkVu18gFasOrUHarMMNZvQ/mo/photo.jpg?sz=128", "display_name": "Irregular Expression", "link": "https://stackoverflow.com/users/10546161/irregular-expression"}, "reply_to_user": {"reputation": 140, "user_id": 10568531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355807cad6f3abdf401e57032a6e6dc?s=128&d=identicon&r=PG&f=1", "display_name": "robots.txt", "link": "https://stackoverflow.com/users/10568531/robots-txt"}, "edited": false, "score": 0, "creation_date": 1545816228, "post_id": 53929536, "comment_id": 94700655, "body": "There&#39;s no API in XMLHTTP to get <i>request</i> headers. You can log/monitor your networking to check for <b>unexpected</b> headers in your requests, also you can (and should) set all <b>expected</b> headers by yourself with setRequestHeaders(). That&#39;s all."}, {"owner": {"reputation": 91, "user_id": 10546161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4zdwlINpFD4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAE_fkKxkVu18gFasOrUHarMMNZvQ/mo/photo.jpg?sz=128", "display_name": "Irregular Expression", "link": "https://stackoverflow.com/users/10546161/irregular-expression"}, "reply_to_user": {"reputation": 140, "user_id": 10568531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355807cad6f3abdf401e57032a6e6dc?s=128&d=identicon&r=PG&f=1", "display_name": "robots.txt", "link": "https://stackoverflow.com/users/10568531/robots-txt"}, "edited": false, "score": 0, "creation_date": 1545816681, "post_id": 53929536, "comment_id": 94700837, "body": "<a href=\"https://stackoverflow.com/questions/37120655/how-do-i-get-the-request-headers-of-a-winhttp-request?rq=1\" title=\"how do i get the request headers of a winhttp request\">stackoverflow.com/questions/37120655/&hellip;</a> - maybe, this&#39;ll be helpful."}], "tags": [], "owner": {"reputation": 91, "user_id": 10546161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4zdwlINpFD4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAE_fkKxkVu18gFasOrUHarMMNZvQ/mo/photo.jpg?sz=128", "display_name": "Irregular Expression", "link": "https://stackoverflow.com/users/10546161/irregular-expression"}, "is_accepted": false, "score": 0, "last_activity_date": 1545813648, "creation_date": 1545813648, "answer_id": 53929536, "question_id": 53928849, "link": "https://stackoverflow.com/questions/53928849/cant-find-any-way-to-get-request-headers/53929536#53929536", "title": "Can&#39;t find any way to get request headers", "body": "<p>You should set your request headers programmatically with a .setRequestHeader() method or it'll be default IE settings. \nWhy do you need to get back the data you've already got?</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1545820399, "last_edit_date": 1545820399, "creation_date": 1545814057, "answer_id": 53929602, "question_id": 53928849, "link": "https://stackoverflow.com/questions/53928849/cant-find-any-way-to-get-request-headers/53929602#53929602", "title": "Can&#39;t find any way to get request headers", "body": "<p>Python <code>.headers</code> (assuming using <code>requests</code> library) provides the response headers, not the request headers. You add custom request headers in the dict passed with the <code>get</code>. Just as you have seen you can read response headers in vba with <code>getAllResponseHeaders</code> and send custom headers with <code>setRequestHeader</code> in key,value pairs.</p>\n\n<p>I would normally use something like Fiddler/Dev tools network tab/Wireshark to see what request headers are sent then mimic those or read the associated API guidance specifying what custom request headers are expected.</p>\n\n<p>Here is a snapshot of Fiddler request header capture for that url</p>\n\n<p><a href=\"https://i.stack.imgur.com/4PTQw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4PTQw.png\" alt=\"enter image description here\"></a></p>\n\n<p>There might be a way with WinHTTP using <a href=\"https://docs.microsoft.com/en-gb/windows/desktop/api/winhttp/nf-winhttp-winhttpqueryheaders\" rel=\"nofollow noreferrer\">winhttpqueryheaders</a> but haven't researched enough and it is far simpler to just use the network tab in most cases. </p>\n\n<p>There is no method associated with the xmlhttp request/response to get the request headers. Have a look at the <a href=\"https://xhr.spec.whatwg.org/#the-response-attribute\" rel=\"nofollow noreferrer\">specification</a> (WHATWG living <a href=\"https://xhr.spec.whatwg.org/\" rel=\"nofollow noreferrer\">standard</a>) for associated methods (may be some variation in VBA implementation):</p>\n\n<p><img src=\"https://i.stack.imgur.com/2O7rd.png\" height=\"300\"></p>\n\n<p>To deal with cookies look at MSXML2.ServerXMLHTTP. <a href=\"https://stackoverflow.com/questions/39709562/how-to-set-and-get-jsessionid-cookie-in-vba/39801506#39801506\">Example</a>.</p>\n"}], "owner": {"reputation": 140, "user_id": 10568531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e355807cad6f3abdf401e57032a6e6dc?s=128&d=identicon&r=PG&f=1", "display_name": "robots.txt", "link": "https://stackoverflow.com/users/10568531/robots-txt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 1, "accepted_answer_id": 53929602, "answer_count": 2, "score": 1, "last_activity_date": 1578482205, "creation_date": 1545809379, "last_edit_date": 1578482205, "question_id": 53928849, "link": "https://stackoverflow.com/questions/53928849/cant-find-any-way-to-get-request-headers", "title": "Can&#39;t find any way to get request headers", "body": "<p>I'm trying to get the <code>request headers</code> using vba. In other languages like <code>python</code> there is a very easy way to get that <code>.headers</code>. However, in case of vba I'm getting stuck.\nI know though there is a way in vba to get <code>response headers</code> by using <code>.getAllResponseHeaders</code>.</p>\n\n<p>How can I get <code>request headers</code> using vba?</p>\n\n<p>This is how I got <code>response headers</code>:</p>\n\n<pre><code>Sub GetRequestHeaders()\n    Const URL$ = \"https://stackoverflow.com/questions/tagged/web-scraping\"\n    Dim Http As New XMLHTTP60, S$\n\n    With Http\n        .Open \"GET\", URL, False\n        .send\n        S = .getAllResponseHeaders\n        MsgBox S\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1545833986, "creation_date": 1545833986, "answer_id": 53933292, "question_id": 53928823, "link": "https://stackoverflow.com/questions/53928823/how-can-i-find-multiple-occurences-of-a-text-inside-a-selection-word-vba/53933292#53933292", "title": "How can I find multiple occurences of a text inside a selection (Word VBA)", "body": "<p>The approach I use is to work with <em>two</em> <code>Range</code> objects: one for the selected text, one for the actual search. For each pass through the loop, after collapsing the search range it's set to the end point of the selection range.</p>\n\n<p>In order to make \"copies\" of a <code>Range</code> use the <code>Duplicate</code> property.</p>\n\n<pre><code>Sub FindOnlyInSelection()\n    Dim rngSel As Word.Range\n    Dim rngSearch As Word.Range\n\n    Set rngSel = Selection.Range\n    Set rngSearch = rngSel.Duplicate\n\n    Do While rngSearch.Find.Execute(findText:=\"App.?\", MatchWholeWord:=True, Forward:=True) = True\n        'routine to change numbering (replace text) and increment counter\n        rngSearch.Collapse Direction:=wdCollapseEnd\n        rngSearch.End = rngSel.End\n    Loop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545835307, "post_id": 53933441, "comment_id": 94707206, "body": "The code I proposed worked fine in my tests - but then, you didn&#39;t include the &quot;routine to change numbers and increment counter&quot; so there could be something in there that&#39;s changing how it works. For this reason I also can&#39;t give my opinion whether the code proposed above is &quot;ok&quot;. If it works, it works &lt;shrug&gt;. Personally, I wouldn&#39;t be happy with something that involves using rngSearch.Select twice - I imagine there&#39;s room for optimization..."}], "tags": [], "owner": {"reputation": 47, "user_id": 10743427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531a3f36ae3e81c98621ae918be871c2?s=128&d=identicon&r=PG", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439", "link": "https://stackoverflow.com/users/10743427/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9"}, "is_accepted": false, "score": 0, "last_activity_date": 1545834920, "creation_date": 1545834920, "answer_id": 53933441, "question_id": 53928823, "link": "https://stackoverflow.com/questions/53928823/how-can-i-find-multiple-occurences-of-a-text-inside-a-selection-word-vba/53933441#53933441", "title": "How can I find multiple occurences of a text inside a selection (Word VBA)", "body": "<p>Cindy Meister. I guess I didn't really understand your suggestion because it leads to an infinite loop changing the same region over and over again. But I tried another way: I removed the line \"rngSearch.Collapse Direction:=wdCollapseEnd\" and \u00fcsed the next code:</p>\n\n<pre><code>Set originalRange = Selection.Range\nendPos = originalRange.End\n\nSet rngSearch = originalRange.Duplicate\nWith rngSearch.Find\n    Do While .Execute(FindText:=keyword, MatchWholeWord:=True, Forward:=True) = True\n        With rngSearch\n        rngSearch.Select\n        startPos = rngSearch.End\n\n        'routine to change numbers and increment counter\n\n        rngSearch.Select\n        rngSearch.Start = startPos\n        rngSearch.End = endPos\n        End With\n    Loop\nEnd With\n</code></pre>\n\n<p>This code works well. Could you comment if it is ok?</p>\n"}], "owner": {"reputation": 47, "user_id": 10743427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531a3f36ae3e81c98621ae918be871c2?s=128&d=identicon&r=PG", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439", "link": "https://stackoverflow.com/users/10743427/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 53933292, "answer_count": 2, "score": 1, "last_activity_date": 1545844562, "creation_date": 1545809231, "last_edit_date": 1545844562, "question_id": 53928823, "link": "https://stackoverflow.com/questions/53928823/how-can-i-find-multiple-occurences-of-a-text-inside-a-selection-word-vba", "title": "How can I find multiple occurences of a text inside a selection (Word VBA)", "body": "<p>I need to change the numbering of several hundred appendixes to a document. And the numbering should have different prefixes. So I want to select a part of the document and run a macro for the selection. But I can use <code>Find.Execute</code> only for the whole document, not for a selection. How should the code look for my task?</p>\n\n<p>When I select a part of the document and run the macro, the selection collapses and code execution continues till the end of the document instead of to the end of the selection. I tried to store the End position of selection but it gives an infinite loop.</p>\n\n<p>My code</p>\n\n<pre><code>Set rngSearch = Selection.Range\n\n    Do While rngSearch.Find.Execute(FindText:=\"App.\u2116\", MatchWholeWord:=True, Forward:=True) = True\n        'routine to change numbering (replace text) and increment counter\n        rngSearch.Collapse Direction:=wdCollapseEnd\n\n    Loop\n</code></pre>\n\n<p>I also tried to loop through the document paragraphs but it was way too slow (several minutes without a result).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1545806532, "post_id": 53927801, "comment_id": 94697858, "body": "<code>CSV</code> can&#39;t do it. It would require macro enable workbook <code>.xlsm</code> file format."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1545810846, "post_id": 53927801, "comment_id": 94699071, "body": "Maybe he is talking about CSV injection although I do not know if this working on a MAC"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1545812485, "post_id": 53927801, "comment_id": 94699547, "body": "I just tested it with a CSV file containing a line similar to <i>&quot;=cmd|&#39; /C move filename1 filename2</i> and it&#39;s indeed working on a windows machine. For CSV injection you can look <a href=\"http://georgemauer.net/2017/10/07/csv-injection.html\" rel=\"nofollow noreferrer\">here</a>. But the question is: Why do you want to do it like that?"}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 10829193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIZ1aD5vQgk/AAAAAAAAAAI/AAAAAAAABZI/J2iqCeVC_Ms/photo.jpg?sz=128", "display_name": "Hossam Azab", "link": "https://stackoverflow.com/users/10829193/hossam-azab"}, "is_accepted": false, "score": 0, "last_activity_date": 1545807948, "creation_date": 1545807948, "answer_id": 53928597, "question_id": 53927801, "link": "https://stackoverflow.com/questions/53927801/moving-a-file-with-an-excel-macro/53928597#53928597", "title": "Moving a file with an excel macro", "body": "<p>CSV is a limited in functionality excel format (only for integration between various platforms or applications programmed with other languages)\nyou can do this with \".xlsm or .xlsb\" formats only</p>\n\n<p>i found this code in another thread</p>\n\n<pre><code>Sub MoveFiles()\nDim sourceFolderPath As String, destinationFolderPath As String\nDim FSO As Object, sourceFolder As Object, file As Object\nDim fileName As String, sourceFilePath As String, destinationFilePath As String\nApplication.ScreenUpdating = False\nsourceFolderPath = \"D:\\SourceFolder\"\ndestinationFolderPath = \"D:\\DestinationFolder\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet sourceFolder = FSO.Getfolder(sourceFolderPath)\nFor Each file In sourceFolder.Files\nfileName = file.Name\nIf InStr(fileName, \".xlsx\") Then ' Only xlsx files will be moved\n    sourceFilePath = file.Path\n    destinationFilePath = destinationFolderPath &amp; \"\\\" &amp; fileName\n    FSO.MoveFile Source:=sourceFilePath, Destination:=destinationFilePath\nEnd If ' If InStr(sourceFileName, \".xlsx\") Then' Only xlsx files will be moved\nNext\n'Don't need set file to nothing because it is initialized in for each loop \n'and after this loop is automatically set to Nothing\nSet sourceFolder = Nothing\nSet FSO = Nothing\nEnd Sub\n</code></pre>\n\n<p>you can find a suitable answers here\n\"stackoverflow.com/questions/38456928/move-files-from-one-folder-to-another\"</p>\n"}, {"tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1545915294, "last_edit_date": 1545915294, "creation_date": 1545811030, "answer_id": 53929138, "question_id": 53927801, "link": "https://stackoverflow.com/questions/53927801/moving-a-file-with-an-excel-macro/53929138#53929138", "title": "Moving a file with an excel macro", "body": "<p>Use <code>Name...AS</code> statement</p>\n\n<p>See: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/name-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/name-statement</a></p>\n\n<pre><code>Sub moveFile()\n    dim oldname as string, newname as string\n    oldname = \"C:\\document.docx\"\n    newname = \"C:\\public\\document.docx\"\n\n    name oldname as newname\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 9872841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07aeef46cbf6242c14920b49279e3996?s=128&d=identicon&r=PG&f=1", "display_name": "Hysii", "link": "https://stackoverflow.com/users/9872841/hysii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1578482237, "creation_date": 1545802324, "last_edit_date": 1578482237, "question_id": 53927801, "link": "https://stackoverflow.com/questions/53927801/moving-a-file-with-an-excel-macro", "title": "Moving a file with an excel macro", "body": "<p>I would like my csv to be able to run a command the moves a file from location the home directory to the public directory on Windows. </p>\n\n<p>I have tried various syntax's, all prefix with =cmd', which is used to execute a command. </p>\n\n<pre><code>=cmd|\u2019move C:\\document.docx C:\\public\\document.docx\u2019!\n</code></pre>\n\n<p>This should be moving this file to the public directory, which is accessible through the web. However, I am not able to retrieve it. I am running MacOS, so I'm not able to test this locally. The target box is remote. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545803695, "post_id": 53927738, "comment_id": 94697141, "body": "I made an edit. Could you try it again with the merged column as shown in my first picture. It will help to reproduce my problem."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545804961, "post_id": 53927738, "comment_id": 94697435, "body": "Are you trying to keep the merged cells?"}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545805024, "post_id": 53927738, "comment_id": 94697452, "body": "No need of keeping the cells merged."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545805163, "post_id": 53927738, "comment_id": 94697494, "body": "How exactly would you like the output to look like? Exactly like in the first picture, just without merged cells?"}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545805247, "post_id": 53927738, "comment_id": 94697514, "body": "Yes exactly. So, column B and C would just be column B. Then the rest just follows. Total of 4 columns which would range from A to D."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545806196, "post_id": 53927738, "comment_id": 94697761, "body": "You could use a loop to remove the extra cells."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545806997, "post_id": 53927738, "comment_id": 94697978, "body": "I tried your solution. There is nothing copied over to the other worksheet."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545807381, "post_id": 53927738, "comment_id": 94698088, "body": "I am not sure about what exactly your data looks like. I have recreated the problem based on the image above and it seems to work (see my images)."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545808407, "post_id": 53927738, "comment_id": 94698351, "body": "Oh. It works. Its very slow though if the files are huge. Is it because of the for loop that causes it to take up time? The macro I made is used to collate data from multiple worksheet into one. So, it would be doing it for 30+ files of about 1000 rows each and 17 columns."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545809340, "post_id": 53927738, "comment_id": 94698637, "body": "Updated the loop to no longer go through each cell. Should be faster now."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545810134, "post_id": 53927738, "comment_id": 94698866, "body": "Oh wow. It is much faster than before and does exactly what I want it do. Could you explain the for loop part a little bit. Thank you so much!"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 1, "creation_date": 1545810944, "post_id": 53927738, "comment_id": 94699092, "body": "Glad to help. Added a short loop explanation to my solution."}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": true, "score": 2, "last_activity_date": 1545810821, "last_edit_date": 1545810821, "creation_date": 1545801760, "answer_id": 53927738, "question_id": 53927380, "link": "https://stackoverflow.com/questions/53927380/copy-and-paste-from-one-worksheet-to-another/53927738#53927738", "title": "Copy and Paste from one worksheet to another", "body": "<p>Your macro works fine for me. However, you could try to set the ranges equal using <code>.value</code> rather than <code>.copy</code>:</p>\n\n<pre><code>Dim to_rng as Range\nDim rng_loop as Range\n\nWorkbooks.Open (Folderpath &amp; Filename)\n    Lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    Lastcolumn = ActiveSheet.Cells(2, Columns.Count).End(xlToLeft).Column\n    Application.DisplayAlerts = False\n    erow = ThisIsAWS.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    Set to_rng = ThisIsAWS.Range(ThisIsAWS.Cells(erow, 1), ThisIsAWS.Cells(erow + Lastrow - 2, Lastcolumn))\n    to_rng.value = ActiveSheet.range(ActiveSheet.cells(2,1), ActiveSheet.cells(Lastrow, Lastcolumn)).value\n\n    For loop1 = Lastcolumn To 1 Step -1\n        Set rng_loop = ThisIsAWS.Range(ThisIsAWS.Cells(erow, loop1), ThisIsAWS.Cells((erow + Lastrow - 2), loop1))\n        If WorksheetFunction.CountA(rng_loop) = 0 Then\n            rng_loop.Delete shift:=xlToLeft\n        End If\n    Next loop1\n\n    ActiveWorkbook.Close\n    Filename = Dir\n</code></pre>\n\n<p>The loop moves backwards (step -1) through each column in the added range and if all cells in the range column are empty (CountA = 0), then it deletes the column by shifting the entire row to the left.</p>\n\n<p>Original data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wwCRA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wwCRA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Data added to other file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ayVMp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ayVMp.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545804913, "post_id": 53927739, "comment_id": 94697420, "body": "I am getting an error message from this line <code>.Range(.Cells(2, 1), .Cells(Lastrow, Lastcolumn)).Copy Destination:=ThisIsAWS.Range(Cells(erow, 1), Cells(erow, Lastcolumn))</code>. The error is Run-time Error &#39;1004&#39; Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545806115, "post_id": 53927739, "comment_id": 94697741, "body": "DSM: Try &#39;.Range(.Cells(2, 1), .Cells(Lastrow, Lastcolumn)).Copy Destination:=ThisIsAWS.Cells(erow, 1)&#39;."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545808586, "post_id": 53927739, "comment_id": 94698389, "body": "your solution works but it leaves behind the merged cells. How to get rid of them? Would doing it like in VBA Pete&#39;s solution the way?"}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1545810253, "post_id": 53927739, "comment_id": 94698891, "body": "Thank you so much for your help! I found a way to use your solution as well by adding a few lines of code to get rid of the merged columns."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545806054, "last_edit_date": 1545806054, "creation_date": 1545801768, "answer_id": 53927739, "question_id": 53927380, "link": "https://stackoverflow.com/questions/53927380/copy-and-paste-from-one-worksheet-to-another/53927739#53927739", "title": "Copy and Paste from one worksheet to another", "body": "<h1>Closed Too Early</h1>\n\n<pre><code>  With Workbooks.Open(Folderpath &amp; Filename).ActiveSheet\n    Lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Lastcolumn = .Cells(2, .Columns.Count).End(xlToLeft).Column\n    erow = ThisIsAWS.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    .Range(.Cells(2, 1), .Cells(Lastrow, Lastcolumn)).Copy _\n        Destination:=ThisIsAWS.Cells(erow, 1)\n    .Parent.Close False\n  End With\n  Filename = Dir\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53927738, "answer_count": 2, "score": 2, "last_activity_date": 1581752553, "creation_date": 1545798063, "last_edit_date": 1581752553, "question_id": 53927380, "link": "https://stackoverflow.com/questions/53927380/copy-and-paste-from-one-worksheet-to-another", "title": "Copy and Paste from one worksheet to another", "body": "<p>I am collating data of different worksheet.</p>\n\n<p>The problem is when copying data into the destination file, all the data are placed into one column.</p>\n\n<p>The code below is a snippet of the part where the problem occurs.</p>\n\n<pre><code>Workbooks.Open (Folderpath &amp; Filename)\nLastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastcolumn = ActiveSheet.Cells(2, Columns.Count).End(xlToLeft).Column\nRange(Cells(2, 1), Cells(Lastrow, Lastcolumn)).Copy\nApplication.DisplayAlerts = False\nActiveWorkbook.Close\nerow = ThisIsAWS.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nThisIsAWS.Paste Destination:=ThisIsAWS.Range(Cells(erow, 1), Cells(erow, Lastcolumn))\nFilename = Dir\n</code></pre>\n\n<p>This is how a file would look initially.<br>\n<a href=\"https://i.stack.imgur.com/IRRhe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IRRhe.png\" alt=\"Source\"></a></p>\n\n<p>After going through the macro, it ends up like this.<br>\n<a href=\"https://i.stack.imgur.com/FrvuR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FrvuR.png\" alt=\"![Destination\"></a></p>\n\n<p>When I do it manually where I copy (ctrl + c) and paste (ctrl + v) using the same data, it comes out fine.</p>\n\n<p>For the source file, the data might have been placed in a table, so would this play a role to why it ends up in one column in the destination file? </p>\n\n<p>EDIT: Source picture. I might have found the problem but still in need of a solution. The column B and C are merged together in this picture. Could this be it?</p>\n"}, {"tags": ["excel", "vba", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545806290, "post_id": 53927371, "comment_id": 94697787, "body": "What\u2019s the value of \u201cstr\u201d when you reach \u201cIf Replace(str, 0, &quot;&quot;) &lt;&gt; &quot;&quot; Then\u201d statement in the <i>not working</i> loop?"}, {"owner": {"reputation": 35, "user_id": 10339610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXmni.jpg?s=128&g=1", "display_name": "Mathieu Klein", "link": "https://stackoverflow.com/users/10339610/mathieu-klein"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545806931, "post_id": 53927371, "comment_id": 94697960, "body": "This is the value that shows when I reach that line in the code.  Watch :   : Str : &quot;1858000148640200664000&quot; : String * -1 : Module1.transformData"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545828635, "post_id": 53927371, "comment_id": 94705029, "body": "If str has the value \u201c1858000148640200664000\u201d then the result of \u201cReplace(str, 0, &quot;&quot;)\u201d is \u201c1858148642664\u201d, hence the check \u201cIf Replace(str, 0, &quot;&quot;) &lt;&gt; &quot;&quot;\u201d returns True and there you follow up with \u201cnLastRowOut = i + 1\u201d and \u201cGoTo copySections\u201d. If that is not the wanted behavior then you have to change the  \u201dIf\u201d condition"}, {"owner": {"reputation": 35, "user_id": 10339610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXmni.jpg?s=128&g=1", "display_name": "Mathieu Klein", "link": "https://stackoverflow.com/users/10339610/mathieu-klein"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545873131, "post_id": 53927371, "comment_id": 94717302, "body": "I found the issue. There was a formula in a cell in row 220 for the sheets that were not working. That&#39;s why the loop was not working and pasting the data in 221. Your comment helped me figure it out. Thanks a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10339610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXmni.jpg?s=128&g=1", "display_name": "Mathieu Klein", "link": "https://stackoverflow.com/users/10339610/mathieu-klein"}, "edited": false, "score": 0, "creation_date": 1545873215, "post_id": 53937744, "comment_id": 94717317, "body": "You are right! I made the fix. Thanks a lot for pointing that out. I found out the issue I was having already but I will fix this as well. Thanks a lot!"}], "tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": false, "score": 1, "last_activity_date": 1545862665, "creation_date": 1545862665, "answer_id": 53937744, "question_id": 53927371, "link": "https://stackoverflow.com/questions/53927371/how-to-fix-loop-initializing-only-some-of-the-time-in-excel-vba/53937744#53937744", "title": "How to fix loop initializing only some of the time in Excel VBA?", "body": "<p>The code for the nLastRowOut doesn't look right.. </p>\n\n<p>Change this:</p>\n\n<p><code>nLastRowOut = .Range(\"A500\").End(xlUp).Row + 1</code></p>\n\n<p>to this:</p>\n\n<p><code>nLastRowOut = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1</code></p>\n"}], "owner": {"reputation": 35, "user_id": 10339610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZXmni.jpg?s=128&g=1", "display_name": "Mathieu Klein", "link": "https://stackoverflow.com/users/10339610/mathieu-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545862665, "creation_date": 1545797964, "question_id": 53927371, "link": "https://stackoverflow.com/questions/53927371/how-to-fix-loop-initializing-only-some-of-the-time-in-excel-vba", "title": "How to fix loop initializing only some of the time in Excel VBA?", "body": "<p>I have an excel VBA macro that transfers some data from one workbook to another. The workbook that the data is sent to is set up with 12 worksheets, each one representing a month. When the user initiates the macro, it determines which sheet to paste the data into from some of the data being transferred. I bring this up because the issue I am having is dependent on the sheet the data will be pasted to. Part of the macro is a do while loop that finds the next available row to paste the data to. This loop only activates on certain sheets. The loop is skipped in other sheets.  (For example, the loop will activate if the data will be pasted into the December sheet but not the November sheet or the January Sheet.) </p>\n\n<p>I have stepped through the macro two times. The first time I set the the data to be pasted to the december sheet and the loop worked correctly. </p>\n\n<p>The second time I set the data to be pasted in the January sheet and the loop was skipped over. </p>\n\n<pre><code>With wbOut.Sheets(strSheet)\n        .Activate\n        nLastRowOut = .Range(\"A500\").End(xlUp).Row + 1\n        i = 220\n        nLastRowOut = i\n        Do While (i &gt; 41)\n              str = .Range(\"A\" &amp; i).Value &amp; .Range(\"B\" &amp; i).Value &amp; .Range(\"C\" &amp; i).Value &amp; .Range(\"D\" &amp; i).Value &amp; .Range(\"E\" &amp; i).Value &amp; .Range(\"F\" &amp; i).Value &amp; .Range(\"G\" &amp; i).Value &amp; .Range(\"H\" &amp; i).Value &amp; .Range(\"I\" &amp; i).Value &amp; .Range(\"J\" &amp; i).Value &amp; .Range(\"K\" &amp; i).Value &amp; .Range(\"L\" &amp; i).Value &amp; .Range(\"M\" &amp; i).Value\n              If Replace(str, 0, \"\") &lt;&gt; \"\" Then\n                    nLastRowOut = i + 1\n                    GoTo copySections\n              End If\n              i = i - 1\n        Loop\n</code></pre>\n\n<p>The next available row should be found and and then used to paste the data. </p>\n\n<p>What is actually happening 75% of the time is that the loop is skipped over and the data is pasted in row 221 instead of the next available row.</p>\n"}, {"tags": ["excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545798934, "post_id": 53927361, "comment_id": 94696268, "body": "I can&#39;t find CStr anywhere in the code. In which line does the error occur? Is ComboBox1 on a form or on a worksheet? Why is NROW declared as Variant instead of Long?"}, {"owner": {"reputation": 23, "user_id": 10833625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qg2Aqym-MMs/AAAAAAAAAAI/AAAAAAAAAD4/B3tWNGYApwE/photo.jpg?sz=128", "display_name": "Dipesh Vora", "link": "https://stackoverflow.com/users/10833625/dipesh-vora"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545825828, "post_id": 53927361, "comment_id": 94704047, "body": "@VBasic2008 I used Cstr() earlier but it did not solve my problem so i removed it.ComboBox1 is on Form, Dont know abt the declaration for NROW, i might have changes it a couple of times to find the solution. it was a &quot;String&quot; earlier"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545826353, "post_id": 53927361, "comment_id": 94704222, "body": "My code containing the WorksheetFunction version of Match will allow numbers. But the most important flaw was that you had no error handling in case a value wasn&#39;t found. Remember in Excel you use =IF(ISERROR(MATCH(whatever)),&quot;&quot;,MATCH(whatever)). You should try it."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10833625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qg2Aqym-MMs/AAAAAAAAAAI/AAAAAAAAAD4/B3tWNGYApwE/photo.jpg?sz=128", "display_name": "Dipesh Vora", "link": "https://stackoverflow.com/users/10833625/dipesh-vora"}, "edited": false, "score": 0, "creation_date": 1545836149, "post_id": 53927482, "comment_id": 94707446, "body": "Now it is not showing error but also does nothing when a &quot;Number&quot; is selected from the Combobox List"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 23, "user_id": 10833625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qg2Aqym-MMs/AAAAAAAAAAI/AAAAAAAAAD4/B3tWNGYApwE/photo.jpg?sz=128", "display_name": "Dipesh Vora", "link": "https://stackoverflow.com/users/10833625/dipesh-vora"}, "edited": false, "score": 0, "creation_date": 1545836743, "post_id": 53927482, "comment_id": 94707661, "body": "@DipeshVora check if there are spaces or difference in format"}, {"owner": {"reputation": 23, "user_id": 10833625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qg2Aqym-MMs/AAAAAAAAAAI/AAAAAAAAAD4/B3tWNGYApwE/photo.jpg?sz=128", "display_name": "Dipesh Vora", "link": "https://stackoverflow.com/users/10833625/dipesh-vora"}, "edited": false, "score": 0, "creation_date": 1545839669, "post_id": 53927482, "comment_id": 94708580, "body": "Thanks . I will go with code given by @vbasic2008 as it does what is required"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1545799207, "creation_date": 1545799207, "answer_id": 53927482, "question_id": 53927361, "link": "https://stackoverflow.com/questions/53927361/type-mismatch-if-number-provided-where-string-is-required-excel-vba/53927482#53927482", "title": "Type mismatch if Number provided where string is required - Excel VBA", "body": "<p>You are missing error handling in case <code>Application.Match</code> can't find the value in the list. Also, there is no need to select rows in order to delete them.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nApplication.ScreenUpdating = False\n\nDim WS As Worksheet, NROW As Long\nSet WS = ThisWorkbook.Sheets(\"ClientList\")\nDim Q As Integer\n\nIf Not IsError(Application.Match(ComboBox1.Value, WS.Range(\"A:A\"), 0)) Then\n\n    Q = MsgBox(\"Do you want to delete this record\", vbQuestion + vbYesNo)\n\n    If Q = vbYes Then\n        NROW = Application.Match(ComboBox1.Value, WS.Range(\"A:A\"), 0)\n        WS.Range(\"A\" &amp; NROW).EntireRow.Delete\n        MsgBox \"RECORD DELETED\"\n    Else\n        'do nothing\n    End If\nEnd If\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10833625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qg2Aqym-MMs/AAAAAAAAAAI/AAAAAAAAAD4/B3tWNGYApwE/photo.jpg?sz=128", "display_name": "Dipesh Vora", "link": "https://stackoverflow.com/users/10833625/dipesh-vora"}, "edited": false, "score": 0, "creation_date": 1545839706, "post_id": 53927558, "comment_id": 94708590, "body": "It Works . Thanks A lot :)"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1545799951, "creation_date": 1545799951, "answer_id": 53927558, "question_id": 53927361, "link": "https://stackoverflow.com/questions/53927361/type-mismatch-if-number-provided-where-string-is-required-excel-vba/53927558#53927558", "title": "Type mismatch if Number provided where string is required - Excel VBA", "body": "<h1>WorksheetFunction</h1>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Application.ScreenUpdating = False\n\n  Dim WS As Worksheet, NROW As Long\n  Set WS = ThisWorkbook.Sheets(\"ClientList\")\n  Dim Q As Integer\n\n  If IsError(WorksheetFunction.Match(ComboBox1.Value, WS.Range(\"A:A\"), 0)) _\n          Then Exit Sub\n  NROW = WorksheetFunction.Match(ComboBox1.Value, WS.Range(\"A:A\"), 0)\n\n  Q = MsgBox(\"Do you want to delete this record\", vbQuestion + vbYesNo)\n  If Q = vbYes Then\n      ActiveSheet.Range(\"A\" &amp; NROW).EntireRow.Delete\n      MsgBox \"RECORD DELETED\"\n    'Else\n      ' do nothing\n  End If\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10833625, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qg2Aqym-MMs/AAAAAAAAAAI/AAAAAAAAAD4/B3tWNGYApwE/photo.jpg?sz=128", "display_name": "Dipesh Vora", "link": "https://stackoverflow.com/users/10833625/dipesh-vora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53927558, "answer_count": 2, "score": 2, "last_activity_date": 1578482288, "creation_date": 1545797827, "last_edit_date": 1578482288, "question_id": 53927361, "link": "https://stackoverflow.com/questions/53927361/type-mismatch-if-number-provided-where-string-is-required-excel-vba", "title": "Type mismatch if Number provided where string is required - Excel VBA", "body": "<p>If the value in the \"ComboBox1.Value\" is a number there is a Run-Time error '13' : Type Mismatch</p>\n\n<p>I have already used Cstr() to convert it to string but still shows error</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nApplication.ScreenUpdating = False\n\nDim WS As Worksheet, NROW As Variant\nSet WS = ThisWorkbook.Sheets(\"ClientList\")\nDim Q As Integer\n\nNROW = Application.Match(ComboBox1.Value, WS.Range(\"A:A\"), 0)\n    ActiveSheet.Range(\"A\" &amp; NROW).Select\n    Q = MsgBox(\"Do you want to delete this record\", vbQuestion + vbYesNo)\n\n    If Q = vbYes Then\n        ActiveCell.EntireRow.Delete\n        MsgBox \"RECORD DELETED\"\n    Else\n        'do nothing\n    End If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545793546, "post_id": 53927014, "comment_id": 94695614, "body": "Could you be more specific about it? What is copied in which row/column and pasted where?"}, {"owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545795484, "post_id": 53927014, "comment_id": 94695845, "body": "Hi @VBasic2008 I&#39;ve updated the code to show my full code. The copy and paste doesn&#39;t really affect what I&#39;m asking. It&#39;s more of the selection of the active cell that will determine what&#39;s to be copied and pasted."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545797784, "post_id": 53927014, "comment_id": 94696096, "body": "So, what is your problem here? I have noticed the following: Variables a and c are unknown (probably calculated in the code before this code). You have For k = 1 to 20 and you have from 6 to 30 in the comments. Sheet2&#39;s name is &#39;LightOn SKU&#39; but sheet10 is at one time referred to as &#39;Dependency Matrix&#39; and later as &#39;DMP&#39;.Sheet5&#39;s name is unknown. The code can be optimized."}, {"owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545801491, "post_id": 53927014, "comment_id": 94696677, "body": "Currently, ActiveCell is only reading from one cell, but I like for it to read from multiple selections. I agree the code is not the best, it&#39;s just a fast and dirty code. I&#39;m coding for the first time."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545801947, "post_id": 53927014, "comment_id": 94696769, "body": "It is unclear on what sheet the activecell is supposed to be?"}, {"owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545801991, "post_id": 53927014, "comment_id": 94696780, "body": "The ActiveCell is from Sheet2"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545824951, "creation_date": 1545824951, "answer_id": 53931692, "question_id": 53927014, "link": "https://stackoverflow.com/questions/53927014/how-to-do-multiple-select-with-activecell/53931692#53931692", "title": "How to do multiple select with ActiveCell", "body": "<h1>Still Unclear</h1>\n\n<pre><code>Sub ACCopy2()\n\n  Dim a As Long\n  Dim c As Long\n  Dim r As Long\n  Dim i As Long\n  Dim k As Integer\n  Dim b As Long\n</code></pre>\n\n<blockquote>\n<pre><code>  a = Sheet10.Cells(Rows.Count, 1).End(xlUp).Row\n  c = Sheet2.Cells(Rows.Count, 5).End(xlUp).Row\n\n  For r = 1 To c ' from Row 1 to the last row of \"Sheet 2(LightOn SKU)\"\n    Debug.Print (\"r = \" &amp; r)\n    For i = 2 To a ' from Row 1 to the last row of \"DMP\"\n      Debug.Print (\"i = \" &amp; i)\n      ' if selected cell matches (i,1) of \"Sheet10 (DMP)\"\n      If Sheet2.Cells(r, 1).Value = Sheet10.Cells(i, 1).Value Then\n        Debug.Print (\"Sheet2 =\" &amp; Sheet2.Cells(r, 1).Value)\n        For k = 1 To 20 ' from Column 1 to Column 20\n          Debug.Print (\"k = \" &amp; k)\n\n          ' if value of (i,k) of \"Sheet10 (DMP)\" = (r,4) of\n          ' \"Sheet2 (LightOn SKU)\"\n          If Sheet10.Cells(i, k).Value = Sheet2.Cells(r, 4).Value Then\n            With Sheet5\n              b = Sheet5.Cells(Rows.Count, 1).End(xlUp).Row\n              Sheet2.Range(\"A\" &amp; r &amp; \":G\" &amp; r).Copy .Cells(b + 1, 1)\n              .Range(\"A\" &amp; r &amp; \":L\" &amp; r).Borders.Color = vbBlack\n            End With\n          End If\n\n        Next\n      End If\n    Next\n  Next\n</code></pre>\n</blockquote>\n\n<pre><code>End Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10753947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LVwhyrsldtk/AAAAAAAAAAI/AAAAAAAAJr4/XU947Cbu67U/photo.jpg?sz=128", "display_name": "Gary Tang", "link": "https://stackoverflow.com/users/10753947/gary-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545824951, "creation_date": 1545793276, "last_edit_date": 1545804184, "question_id": 53927014, "link": "https://stackoverflow.com/questions/53927014/how-to-do-multiple-select-with-activecell", "title": "How to do multiple select with ActiveCell", "body": "<p>I'm trying to make multiple selections from Sheet2. The value is from the same column but different rows (thinking if using ActiveCell.Offset(1,0) will be feasible). </p>\n\n<p>My code takes the value from an ActiveCell select and runs a macro compares it to another sheet (Sheet10) with some information to copy and paste in a target sheet (Sheet5).</p>\n\n<p>The following is the code that I have right now.</p>\n\n<pre><code>a = Sheet10.Cells(Rows.Count, 1).End(xlUp).Row\nc = Sheet2.Cells(Rows.Count, 5).End(xlUp).Row\n\nFor Each cell In Range(ActiveCell, ActiveCell.Offset(1, 0))\n\nFor i = 2 To a 'from Row 1 to the last row of \"DMP\"\nDebug.Print (\"i = \" &amp; i)\n\nIf cell.Value = Sheet10.Cells(i, 1).Value Then 'if selected cell matches (i,1) of \"Sheet10 (DMP)\"\n    Debug.Print (\"ActiveCell =\" &amp; ActiveCell.Value)\n\n    For k = 1 To 20 'from Column 1 to Column 20\n        Debug.Print (\"k = \" &amp; k)\n\n        For r = 1 To c 'from Row 1 to the last row of \"Sheet 2(LightOn SKU)\"\n            Debug.Print (\"r = \" &amp; r)\n\n            If Sheet10.Cells(i, k).Value = Sheet2.Cells(r, 4).Value Then 'if value of (i,k) of \"Sheet10 (DMP)\" = (r,4) of \"Sheet2 (LightOn SKU)\"\n\n                Sheet2.Range(\"A\" &amp; r &amp; \":G\" &amp; r).Copy\n                Sheet5.Activate\n                b = Sheet5.Cells(Rows.Count, 1).End(xlUp).Row\n                Sheet5.Cells(b + 1, 1).Select\n                ActiveSheet.Paste\n                Range(\"A\" &amp; r &amp; \":L\" &amp; r).Borders.Color = vbBlack\n             End If\n\n        Next\n\n    Next\n\nEnd If\n\nNext\n\nNext\n</code></pre>\n\n<p>Right now, it's running on an endless loop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "edited": false, "score": 0, "creation_date": 1545799854, "post_id": 53926856, "comment_id": 94696408, "body": "Thanks so much Harun24HR...It worked!!"}], "answers": [{"comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "edited": false, "score": 0, "creation_date": 1545806425, "post_id": 53927322, "comment_id": 94697827, "body": "Glad to know! If you found it working, then accept the answer so that other user can see the question is solved."}, {"owner": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "edited": false, "score": 0, "creation_date": 1546452854, "post_id": 53927322, "comment_id": 94859096, "body": "Thanks again..and I still have another requirement that if I have two toytypes like toy1 and toy11. When I filter from toy1 both the data from toy1 and toy11 get filtered and comes accordingly. What should we change?"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": true, "score": 0, "last_activity_date": 1545797764, "last_edit_date": 1545797764, "creation_date": 1545797285, "answer_id": 53927322, "question_id": 53926856, "link": "https://stackoverflow.com/questions/53926856/how-to-make-dependent-combo-boxes/53927322#53927322", "title": "How to make dependent combo boxes?", "body": "<p>Its very interesting that I was working on a project which had similar requirements. I couldn't finish it up full project. Here is code to meet your requirement. Here when you will select any value to <code>cboToyType</code> and will go to <code>cboWheel</code> it will take little time to run the code. You can optimize codes to faster it.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim ws As Worksheet\n\n    Set ws = Sheets(\"Sheet1\")\n    ws.Range(\"Z:Z\").ClearContents\n    ws.Columns(\"A:A\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"Z1\"), Unique:=True\n    ws.Range(\"Z1\").ClearContents\n\n    Me.cboToyType.RowSource = ws.Range(\"Z2\").CurrentRegion.Address\n    Set ws = Nothing\nEnd Sub\n\n\nPrivate Sub btnOK_Click()\n    Unload Me\nEnd Sub\n\n\nPrivate Sub cboToyType_AfterUpdate()\nDim ws As Worksheet\nApplication.ScreenUpdating = False\n\n    Set ws = Sheets(\"Sheet1\")\n    ws.Range(\"AB:AD\").ClearContents\n    ws.Range(\"A:C\").AutoFilter Field:=1, Criteria1:=Me.cboToyType\n    ws.Range(\"B:B\").Copy ws.Range(\"AB1\")\n    ws.Range(\"AB:AB\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n    ws.Range(\"C:C\").Copy ws.Range(\"AD1\")\n    ws.Range(\"AD:AD\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n    ws.Range(\"A:C\").AutoFilter\n    ws.Range(\"AB1\").ClearContents\n    ws.Range(\"AD1\").ClearContents\n\n    Me.cboWheel.RowSource = ws.Range(\"AB2\").CurrentRegion.Address\n    Me.cboName.RowSource = ws.Range(\"AD2\").CurrentRegion.Address\n    Set ws = Nothing\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://drive.google.com/file/d/11FDuXGf998n5LNAQnX_NDZDpfEI8IPR5/view?usp=sharing\" rel=\"nofollow noreferrer\">Sample File Download Link</a></p>\n"}], "owner": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 53927322, "answer_count": 1, "score": 1, "last_activity_date": 1568955006, "creation_date": 1545790843, "last_edit_date": 1568955006, "question_id": 53926856, "link": "https://stackoverflow.com/questions/53926856/how-to-make-dependent-combo-boxes", "title": "How to make dependent combo boxes?", "body": "<p>I have a table like this.<br>\n<a href=\"https://i.stack.imgur.com/bgtjG.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bgtjG.gif\" alt=\"enter image description here\"></a></p>\n\n<p>I need to get two dependent combo boxes.</p>\n\n<ul>\n<li>1st combo - should have options toy 1 and toy 2</li>\n<li>2nd combo - based on combo 1 selection No of wheels list should be shown </li>\n<li>3rd combo - based on combo 1 selection Name should be shown</li>\n</ul>\n\n<p>I tried the following code.<br>\nWhen form initializes, I get combo1 list<br>\nAnd when combo 1 selected, I load combo 2 and 3</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim i As Long\n   For i = 2 To 9\n     Me.ComboBox1.AddItem Cells(i, 1)\n   Next\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    Me.ComboBox2.Value = Application.WorksheetFunction.VLookup(Me.ComboBox1.Value, Sheets(\"sheet1\").Range(\"A2:C9\"), 2, 0)\n    Me.ComboBox3.Value = Application.WorksheetFunction.VLookup(Me.ComboBox1.Value, Sheets(\"sheet1\").Range(\"A2:C9\"), 3, 0)\nEnd Sub\n</code></pre>\n\n<p>The problem is, when I run, combo1 is not only 2 selections of toy1 and toy2, but it repeat toy1 4 times and toy2 4 times.</p>\n\n<p>When I select combo 2 and 3, only single value is shown, not the whole list.</p>\n"}, {"tags": ["excel", "vba", "checkbox", "ribbon"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545793713, "post_id": 53926781, "comment_id": 94695632, "body": "You&#39;ll have to be more specific and provide some code. What does the Ribbon checkbox do?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545811770, "post_id": 53926781, "comment_id": 94699318, "body": "As @VBasic2008, mentioned.. your question or problem statement should be specific. Please provide the code you have used so far. Many times it gives the clue what you are trying to achieve."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1547127964, "post_id": 53926781, "comment_id": 95091171, "body": "You cannot set the checkbox state directly. You need to invalidate the ribbon (or the individual checkbox control) when the value <code>rv</code> changes to force Excel to redraw the control when needed."}], "owner": {"reputation": 1, "user_id": 10833378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PFwp6Oo8oFQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaF4xXKFznEEkwOxwr8wjP0vKaeew/mo/photo.jpg?sz=128", "display_name": "\uc624\uc885\ud658", "link": "https://stackoverflow.com/users/10833378/%ec%98%a4%ec%a2%85%ed%99%98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545822501, "creation_date": 1545789535, "last_edit_date": 1545822501, "question_id": 53926781, "link": "https://stackoverflow.com/questions/53926781/i-need-a-help-to-change-checkbox-state-when-i-change-sheet-with-each-different-s", "title": "I need a help to change checkbox state when I change sheet with each different state in EXCEL VBA", "body": "<p>I am developing some VBA macro that has Ribbon checkbox.\nHow can I change a checkbox state when I change sheet with each different state in EXCEL VBA. \nI use a callback function \"Workbook_sheetAcivate\" at workbook module.\nBut I can't control checkbox state at this module.</p>\n\n<p>Here is the checkbox code:</p>\n\n<pre><code>Sub checkBox1_getPressed(control As IRibbonControl, ByRef returnedVal)\n    rv = Cells(7, 13)\n    MsgBox \"\uccb4\ud06c\ubc15\uc2a41 , rv : \" &amp; rv \n    If rv = 1 Then \n        returnedVal = True\n      Else\n        returnedVal = False\n    End If\n   'oxIRibbonUI.Invalidate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545789531, "post_id": 53926766, "comment_id": 94695077, "body": "It would help to know what column contains the <i>1,2,3,1S,2S,3S</i> value(s) which I assume is at least one of the filter fields. Also, confirm that Sheets(&quot;SHIFTS&quot;) is the Worksheet_Change&#39;s worksheet."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545790474, "post_id": 53926766, "comment_id": 94695191, "body": "The filter is applied at column A, but the data entered are in columns B to AG. Also Sheets(&quot;SHIFTS&quot;) is the Worksheet_Change&#39;s worksheet"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545790701, "post_id": 53926766, "comment_id": 94695221, "body": "Correct me if I&#39;m wrong but there is no point on reapplying a filter when a new value is introduced unless that value is in a column that may change the filter results; i.e. one of the filter fields."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545790759, "post_id": 53926766, "comment_id": 94695228, "body": "Column A just counts if the row isn&#39;t blank and then filters the empty rows out"}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545791002, "post_id": 53926766, "comment_id": 94695260, "body": "Yes you are right. So I just need the filter to be reapplied only when a value at column A changes value from 0 to 1, but not when every other change is made (1 to 2, 2 to 3 etc.)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545791536, "post_id": 53926840, "comment_id": 94695347, "body": "@RagnarNightwalker, This works for values with an <i>S</i> typed or pasted into column A. That was the original question. I&#39;m unclear on how the recent comment about <i>&#39;column A changes value from 0 to 1, but not when every other change is made (1 to 2, 2 to 3 etc.)&#39;</i> fits into the original question."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545791741, "post_id": 53926840, "comment_id": 94695366, "body": "Thanks but this is not the case. I figured out the mistake so I now changed the formulas in column A to return only 0 and 1 depending on if the row is empty or not. So I just now need the macro to run only when there is a value change in column A, but not when there is an entry everywhere else in the sheet."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545791924, "post_id": 53926840, "comment_id": 94695389, "body": "Sorry but I got confused. I turned a simple issue into a complex one for no reason. I&#39;m relatively new to macro using in Excel."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "reply_to_user": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545792265, "post_id": 53926840, "comment_id": 94695436, "body": "OK, a change in the result of a formula does not trigger a worksheet_change. For that, you need to use worksheet_calculate with a list of values in column A  &#39;remembered&#39; from the previous calculation cycle and that would appear to be a completely different question. See <a href=\"https://stackoverflow.com/questions/53737344/put-timestamp-when-formula-changes/53737792?r=SearchResults&amp;s=4|0.0000#53737792\">this</a>."}, {"owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "edited": false, "score": 0, "creation_date": 1545793176, "post_id": 53926840, "comment_id": 94695561, "body": "Thanks for your replies and for your time."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "is_accepted": false, "score": 0, "last_activity_date": 1545790553, "creation_date": 1545790553, "answer_id": 53926840, "question_id": 53926766, "link": "https://stackoverflow.com/questions/53926766/conditional-autofilter/53926840#53926840", "title": "Conditional Autofilter", "body": "<p>If your <em>1,2,3,1S,2S,3S</em> are in column A then this should reapply the existing AutoFilter whenever an <em>nS</em> value is typed or pasted into column A.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A:A\"), UsedRange) Is Nothing Then\n        On Error GoTo bye\n        Application.EnableEvents = False\n        Dim t As Range\n        For Each t In Intersect(Target, Range(\"A:A\"), UsedRange)\n            If CBool(InStr(1, t.Value, \"s\", vbTextCompare)) Then\n                If AutoFilterMode Then _\n                    AutoFilter.ApplyFilter\n                Exit For\n            End If\n        Next t\n    End If\n\nbye:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>If all operations are performed on the Worksheet_Change's worksheet, parent worksheet references are automatically implicit on a worksheet's private code sheet.</p>\n"}], "owner": {"reputation": 13, "user_id": 10833382, "user_type": "registered", "profile_image": "https://graph.facebook.com/2167373643591214/picture?type=large", "display_name": "Ragnar Nightwalker", "link": "https://stackoverflow.com/users/10833382/ragnar-nightwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549098936, "creation_date": 1545789354, "last_edit_date": 1549098936, "question_id": 53926766, "link": "https://stackoverflow.com/questions/53926766/conditional-autofilter", "title": "Conditional Autofilter", "body": "<p>I use this macro to reapply a filter every time a change is made to the data of a sheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   Sheets(\"SHIFTS\").AutoFilter.ApplyFilter\n\nEnd Sub\n</code></pre>\n\n<p>I need the filter to be reapplied only when the data entry contains a specific character.</p>\n\n<p>e.g. User can input values 1,2,3,1S,2S,3S</p>\n\n<p>I need the filter to be reapplied only when the character \"S\" is in the entered value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 8437004, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212772461240938/picture?type=large", "display_name": "Soo-Ah Yoon", "link": "https://stackoverflow.com/users/8437004/soo-ah-yoon"}, "edited": false, "score": 0, "creation_date": 1545782943, "post_id": 53926429, "comment_id": 94694358, "body": "what I want to use left function is range variable."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1545784757, "post_id": 53926429, "comment_id": 94694570, "body": "<code>offest</code> should be <code>offset</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545784922, "post_id": 53926429, "comment_id": 94694588, "body": "vlookup doesn&#39;t take more than a single value in its <i>lookup_value</i> argument. For that matter, neither does Left."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545785061, "post_id": 53926429, "comment_id": 94694605, "body": "I&#39;m unclear what .End you are attempting with <i>3</i>. xlUp is -4162."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545785476, "post_id": 53926429, "comment_id": 94694648, "body": "Also, what is the purpose of looking up <code>LEFT(Range([B4], Cells(Rows.Count, &quot;B&quot;).End(3))) </code> within <code>B2:B439</code> on the same worksheet?"}, {"owner": {"reputation": 1, "user_id": 8437004, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212772461240938/picture?type=large", "display_name": "Soo-Ah Yoon", "link": "https://stackoverflow.com/users/8437004/soo-ah-yoon"}, "edited": false, "score": 0, "creation_date": 1545788105, "post_id": 53926429, "comment_id": 94694888, "body": "I&#39;d like to use vlookup using left function because the ref value is too long to check. the 3 letter is enough to check for vlookup ref value."}, {"owner": {"reputation": 1, "user_id": 8437004, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212772461240938/picture?type=large", "display_name": "Soo-Ah Yoon", "link": "https://stackoverflow.com/users/8437004/soo-ah-yoon"}, "edited": false, "score": 0, "creation_date": 1545788267, "post_id": 53926429, "comment_id": 94694910, "body": "and I am sorry that  is not real code.  in fact, Set table_array = Range(&quot;B2:G349&quot;) is Set table_array = Worksheets(&quot;refSheet1&quot;).Range(&quot;B2:G349&quot;)"}, {"owner": {"reputation": 1, "user_id": 8437004, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212772461240938/picture?type=large", "display_name": "Soo-Ah Yoon", "link": "https://stackoverflow.com/users/8437004/soo-ah-yoon"}, "edited": false, "score": 0, "creation_date": 1545788328, "post_id": 53926429, "comment_id": 94694917, "body": "Do I have to use For each function to change whole value of ref table range before using vlookup?"}, {"owner": {"reputation": 261, "user_id": 7634135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02a8e232898c11cbc32a93ea8f55520e?s=128&d=identicon&r=PG&f=1", "display_name": "lcc", "link": "https://stackoverflow.com/users/7634135/lcc"}, "edited": false, "score": 0, "creation_date": 1545811269, "post_id": 53926429, "comment_id": 94699185, "body": "I guess the error is literally caused by the first 3 letters of your <code>vlookup</code> value are not match with all the values in the <code>table_array</code>. For example, <code>DAC</code> is not match with <code>DAC1231123</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1545823797, "creation_date": 1545823797, "answer_id": 53931472, "question_id": 53926429, "link": "https://stackoverflow.com/questions/53926429/how-to-write-excel-vba-coding-for-left-function-inside-vlookup-or-covert-from-e/53931472#53931472", "title": "how to write excel vba coding for left function inside vlookup, or covert from excel function to vba?", "body": "<p>Use variant Array.</p>\n\n<pre><code>Sub test()\n    Dim lookFor As Variant\n    Dim Table As Variant\n    Dim vResult() As Variant\n    Dim table_array_col As Integer\n    Dim lookFor_col As Integer\n    Dim c As Integer\n    Dim LookC As Integer\n    Dim i As Long, j As Long\n    Dim r As Long, r2 As Long\n\n    c = 5 '&lt;~~ col\n    LookC = 4\n\n\n    lookFor = Range([B4], Cells(Rows.Count, \"B\").End(3))\n    Table = Range(\"B2:G349\")\n\n\n    r = UBound(lookFor, k)\n    r2 = UBound(Table, 1)\n\n    ReDim vResult(1 To r, 1 To 1)\n\n    For i = 1 To r\n        For j = 1 To r2\n            If Left(lookFor(i, 1), 3) = Table(j, 1) Then\n                vResult(i, 1) = Table(j, c)\n                Exit For\n            End If\n        Next j\n    Next i\n    Cells(2, LookC).Resize(r, 1) = vResult\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8437004, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212772461240938/picture?type=large", "display_name": "Soo-Ah Yoon", "link": "https://stackoverflow.com/users/8437004/soo-ah-yoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578482337, "creation_date": 1545782821, "last_edit_date": 1578482337, "question_id": 53926429, "link": "https://stackoverflow.com/questions/53926429/how-to-write-excel-vba-coding-for-left-function-inside-vlookup-or-covert-from-e", "title": "how to write excel vba coding for left function inside vlookup, or covert from excel function to vba?", "body": "<p>I would like to use below function from excel on vba. Can I have a good solution?</p>\n\n<p>=IFERROR(VLOOKUP(LEFT(B4,3),B2:G349,5,FALSE),\"\")</p>\n\n<p>I will appreciate if I get a solution!  </p>\n\n<pre><code>Dim lookFor As Range\nDim table_array As Range\nDim varResult As Variant\nDim table_array_col As Integer\nDim lookFor_col As Integer\n\nOn Error Resume Next\n\nSet lookFor = Range([B4], Cells(Rows.Count, \"B\").End(3)) \nSet table_array = Range(\"B2:G349\")\ntable_array_col = 5\nvarResult = Application.VLookup(left(lookFor.Value,3), table_array, table_array_col, 0)\nlookFor_col = 2\nlookFor.offest(0, lookFor_col) = varResult\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545829525, "post_id": 53926381, "comment_id": 94705308, "body": "Is your value a blank space (<i>Target.Offset(0, 1).Value &lt;&gt; &quot; &quot;</i>) or IsEmpty(Target.Offset(0, 1)) your intention?"}, {"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545838200, "post_id": 53926381, "comment_id": 94708115, "body": "either gives the same result, but it doesn&#39;t solve the issue."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545838528, "post_id": 53926381, "comment_id": 94708208, "body": "you&#39;ll need to put in some more safety lines in your code, which should prevent the crash, e.g., <i>If Target.Count &gt; 1 Then Exit Sub</i>, as you could be having issues with just specifying the target.  Additionally, <i>If Intersect(Target, Columns(3)) Is Nothing Then Exit Sub</i> would also only run the code for column C.  my guess is that the offset values on the target, possible generated from an undesired target, fulfill some criteria, and that provides some issue, though I don&#39;t know how that would inherently crash your code."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545839130, "post_id": 53926381, "comment_id": 94708407, "body": "Are you possibly triggering each messagebox?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545839392, "post_id": 53926381, "comment_id": 94708495, "body": "You&#39;re combining in C and looking to offset -1 and -2 for your checks... just caught that as i went to type the code out in my answer.  offset(0,1) from C is D, and offset(0,2) from C is E.  You have stated that first names are in A, last names are in B."}, {"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545842058, "post_id": 53926381, "comment_id": 94709361, "body": "heyy.... i have tried your advise but Im still having the issue....still giving an empty string... and still crashing,"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1545844103, "post_id": 53926381, "comment_id": 94710027, "body": "Please update your post with your modified code.  I have input an answer with the hopes that it might alleviate your issue.  Given your description, the &quot;blank&quot; msgbox was showing up after deletion, which should require a whole row being selected, and the target.count should have resolved that from running the macro.  Maybe describe in slightly more detail what you have done and when the error occurs (provide any error codes if those have been showing up, though it looks like you&#39;re crashing excel given your original post)?"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545849055, "post_id": 53934162, "comment_id": 94711590, "body": "Yes Edit 1 is a much better idea!  Thanks much Cyril. The code knocks off 2 main factors: I don&#39;t have to worry about adding a new column, and my code does not crash!\ud83d\udc4d"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545850219, "post_id": 53934162, "comment_id": 94711982, "body": "Glad that worked for you!  If this resolved your issue or got you where you need to be, please mark as answered so this question can be listed as Answered in the inquiry queue."}, {"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545871439, "post_id": 53934162, "comment_id": 94717060, "body": "hello Again the program still crashes"}, {"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545871817, "post_id": 53934162, "comment_id": 94717110, "body": ".... I don&#39;t know how exactly but during my testing, by putting repeated last names and/or first names and leaving the other field(s) blank, a black cell is still displayed and/then also eventually crashes."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545915074, "post_id": 53934162, "comment_id": 94729304, "body": "please update your post with the whole updated sub, as an edit.  given I was testing this yesterday and not having issues with my edit 1, i want to see with what you&#39;re working.  my only other initial issue is to ensure that your target is within the range a1:b12..."}, {"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545927342, "post_id": 53934162, "comment_id": 94734157, "body": "What about testing for first names only as an additional feature  ?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545927762, "post_id": 53934162, "comment_id": 94734341, "body": "I will say that would be a separate question, though i&#39;ll try to direct you a bit.  the 2 lines directly after <i>r = Target.Row</i> would need to be modified, as well as the messagebox.  Essentially you won&#39;t care what is in colB if you&#39;re assessing colA.  Your bigger issue is having both as a change event and not triggering BOTH scenarios.  Only one type of change event can occur per worksheet (e.g., selection change, change, double click, etc.).  I would highly recommend using conditional formatting for the other scenarios (assessing first/last name individually)."}, {"owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545928181, "post_id": 53934162, "comment_id": 94734530, "body": "<code>If Application.CountIf(Range(&quot;B1:B12&quot;), Cells(r, 2).Value) &gt; 1 Then &#39;checks for first name         MsgBox (&quot;The name &quot; &amp; Cells(r, 1).Value &amp; &quot; &quot; &amp; Cells(r, 2).Value &amp; &quot; already exists.&quot; &amp; vbNewLine &amp; &quot;Please enter a new name.&quot;)         Cells(r, 1).ClearContents         Cells(r, 2).ClearContents         Cells(r, 1).Select     End If</code> &#39; i was trying this as an alternative but it didnt work thats why i asked"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "edited": false, "score": 0, "creation_date": 1545928357, "post_id": 53934162, "comment_id": 94734583, "body": "Two things:  1)  if you want to use that, ensure that you only have 1 worksheet_change() within the worksheet, and 2) watch the uses of each column (1 = A =  first name, 2 = B = last name).  Try posting another question specific to adding ADDITIONAL worksheet_change() items to an existing worksheet_change event, since you need to put in some if-statements or switches to ensure only one is activated at a time, preventing msgbox spam, etc."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1545922371, "last_edit_date": 1545922371, "creation_date": 1545839317, "answer_id": 53934162, "question_id": 53926381, "link": "https://stackoverflow.com/questions/53926381/how-to-delete-duplicate-values/53934162#53934162", "title": "How to delete duplicate values?", "body": "<p>If i wanted to create a sheet with</p>\n\n<pre><code>-2        -1       0\nColA      ColB     ColC\nFirst1    Last1    First1Last1\nFirst2    Last2    First2Last2\nFirst3    Last3    First3Last3\nFirst4    Last4\n</code></pre>\n\n<p>I would personally start with conditional formatting for ColC to flag what is a duplicate, in case there is an issue, which circumvents a messagebox.  </p>\n\n<p>If i did need a messagebox, i would set up similar to what you have:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Columns(3)) Is Nothing Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n    If Application.CountIfs(Range(\"C1:C12\"),Target.Value) &gt; 1 Then 'checks for first/last name\n        MsgBox(\"The name \" &amp; Target.Offset(0,-2).Value &amp; \" \" &amp; Target.Offset(0,-1).Value &amp; \" already exists.\" &amp; vbNewLine &amp; \"Please enter a new name.\")\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>Given the data entry for colA and colB, would this be more appropriate?  I utilized the row of the target, so the negative offset shouldn't be of concern, since you know that colA is first name and colB is last name.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    Dim r as long\n    r = target.row\n    If isempty(cells(r,1)) or isempty(cells(r,2)) then exitsub\n    If Application.CountIfs(Range(\"B1:B12\"),cells(r,2).Value,Range(\"A1:A12\"),cells(r,1).Value) &gt; 1 Then 'checks for first/last name\n        MsgBox(\"The name \" &amp; cells(r,1).Value &amp; \" \" &amp; cells(r,2).Value &amp; \" already exists.\" &amp; vbNewLine &amp; \"Please enter a new name.\")\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit2:</strong></p>\n\n<p>In verifying the use of no values and some values, this macro has been working for my testing (i added the clear contents and .select so you are back on the line you should be adding data); i also added a range specification related to the intersect in case you are adding values like first/last to a random place outside of a1:b12:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    If Intersect(Target, Range(Cells(1, 1), Cells(12, 2))) Is Nothing Then Exit Sub\n    Dim r As Long\n    r = Target.Row\n    If IsEmpty(Cells(r, 1)) Or IsEmpty(Cells(r, 2)) Then Exit Sub\n    If Application.CountIfs(Range(\"B1:B12\"), Cells(r, 2).Value, Range(\"A1:A12\"), Cells(r, 1).Value) &gt; 1 Then 'checks for first/last name\n        MsgBox (\"The name \" &amp; Cells(r, 1).Value &amp; \" \" &amp; Cells(r, 2).Value &amp; \" already exists.\" &amp; vbNewLine &amp; \"Please enter a new name.\")\n        Cells(r, 1).ClearContents\n        Cells(r, 2).ClearContents\n        Cells(r, 1).Select\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4233526, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000694931946/picture?type=large", "display_name": "Dermot Johnson", "link": "https://stackoverflow.com/users/4233526/dermot-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53934162, "answer_count": 1, "score": 0, "last_activity_date": 1575095449, "creation_date": 1545782170, "last_edit_date": 1575095449, "question_id": 53926381, "link": "https://stackoverflow.com/questions/53926381/how-to-delete-duplicate-values", "title": "How to delete duplicate values?", "body": "<p>I dynamically update the cells in columns A and B, and join both values on each row (using &amp;) and place the values in column C.</p>\n\n<p>My purpose is fulfilled by detecting duplicate names when firstName (Column A values) and LastName (column B values) are entered twice. An empty value (observed when the msgbox is displayed) pops up when I delete the duplicate name followed by the first occurrence.</p>\n\n<p>This is an issue at times, especially because sometimes the msgbox does not go away. ie the code crashes.</p>\n\n<p>How can I prevent the empty value, or msgBox from being displayed? I suspect something is wrong with my if statement.</p>\n\n<p>VBA code I placed in the worksheet </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf WorksheetFunction.CountIf(Range(\"c1:c12\"), Target.Offset(0, 1).Value) &gt; 1 And _\n  Target.Offset(0, 1).Value &lt;&gt; \" \" Then\n    MsgBox Target.Offset(0, 1).Value &amp; \" is a Duplicate Entry\" &amp; vbNewLine &amp; _\n    \" ENTER A NEW NAME\", vbInformation, \"Duplicate Detected\"\n    Target.Offset(0, 0).Value = \" \"\n    Target.Offset(0, 0).Select\nElseIf WorksheetFunction.CountIf(Range(\"c1:c12\"), Target.Offset(0, 2).Value) &gt; 1 And _\n  Target.Offset(0, 1).Value &lt;&gt; \" \" Then\n    MsgBox Target.Offset(0, 2).Value &amp; \" is a Duplicate Entry\" &amp; vbNewLine &amp; _\n    \" ENTER A NEW NAME\", vbInformation, \"Duplicate Detected\"\n    Target.Offset(0, 0).Value = \" \"\n    Target.Offset(0, 0).Select\nElse: Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "rubberduck"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1545796851, "post_id": 53926116, "comment_id": 94695984, "body": "You most likely don&#39;t <i>need</i> an <code>End</code> statement."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1545841252, "post_id": 53926116, "comment_id": 94709067, "body": "The great answer given provides example code which is what the question I feel could have benefited from including."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1545888571, "post_id": 53926116, "comment_id": 94719666, "body": "@QHarr a great answer by no other than the author of the RD fakes API =)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1545795337, "post_id": 53926414, "comment_id": 94695828, "body": "TL;DR: Don&#39;t use <code>End</code> unless your only option is to yank the plug and nuke the runtime environment."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 6, "last_activity_date": 1545782686, "creation_date": 1545782686, "answer_id": 53926414, "question_id": 53926116, "link": "https://stackoverflow.com/questions/53926116/can-rubberduck-test-if-a-program-ends/53926414#53926414", "title": "Can RubberDuck test if a program ends?", "body": "<h2>tldr; No</h2>\n\n<p>Rubberduck unit tests are executed in the context of the VBA runtime - that is, the VBA unit test code is being run from inside the host application.  Testing results are reported back to Rubberduck via its API. If you look at the VBA code generated when you insert a test module, it gives a basic idea of the architecture of how the tests are run.  Take for example this unit test from our integration test suite:</p>\n\n<pre><code>'HERE BE DRAGONS.  Save your work in ALL open windows.\n'@TestModule\n'@Folder(\"Tests\")\n\nPrivate Assert As New Rubberduck.AssertClass\nPrivate Fakes As New Rubberduck.FakesProvider\n\n'@TestMethod\nPublic Sub InputBoxFakeWorks()\n    On Error GoTo TestFail\n\n    Dim userInput As String\n    With Fakes.InputBox\n        .Returns vbNullString, 1\n        .ReturnsWhen \"Prompt\", \"Second\", \"User entry 2\", 2\n        userInput = InputBox(\"First\")\n        Assert.IsTrue userInput = vbNullString\n        userInput = InputBox(\"Second\")\n        Assert.IsTrue userInput = \"User entry 2\"\n    End With\n\nTestExit:\n    Exit Sub\nTestFail:\n    Assert.Fail \"Test raised an error: #\" &amp; Err.Number &amp; \" - \" &amp; Err.Description\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Broken down:</h2>\n\n<p>This creates a managed class that \"listens\" for Asserts in the code being tested and evaluates the condition for passing or failing the test.</p>\n\n<pre><code>Private Assert As New Rubberduck.AssertClass     \n</code></pre>\n\n<p>The <code>FakesProvider</code> is a utility object for setting the hooks in the VB runtime to \"ignore\" or \"spoof\" calls from inside the VB runtime to, say, the <code>InputBox</code> function.</p>\n\n<p>Since the <code>Fakes</code> object is declared <code>As New</code>, the <code>With</code> block instantiates a <code>FakesProvider</code> for the test. The <code>InputBox</code> method of <code>Fakes</code> This sets a hook on the <code>rtcInputBox</code> function in vbe7.dll which redirects all traffic from VBA to that function to the Rubberduck implementation. This is now counting calls, tracking parameters passed, providing return values, etc.</p>\n\n<pre><code>    With Fakes.InputBox\n</code></pre>\n\n<p>The Returns and ReturnsWhen calls are using the VBA held COM object to communicate the test setup of the faked calls to <code>InputBox</code>. In this example, it configures the <code>InputBox</code> object to return a <code>vbNullString</code> for call one, and \"User entry 2\" when passed a <code>Prompt</code> parameter of <code>\"Second\"</code> for call number two.</p>\n\n<pre><code>        .Returns vbNullString, 1\n        .ReturnsWhen \"Prompt\", \"Second\", \"User entry 2\", 2\n</code></pre>\n\n<p>This is where the AssertClass comes in. When you run unit tests from the Rubberduck UI, it determines the COM interface for the user's code. Then, it calls invokes the test method via that interface. Rubberduck then uses the <code>AssertClass</code> to test runtime conditions. The <code>IsTrue</code> method takes a <code>Boolean</code> as a parameter (with an optional output message). So on the line of code below, VB evaluates the expression <code>userInput = vbNullString</code> and passes the result as the parameter to <code>IsTrue</code>. The Rubberduck <code>IsTrue</code> implementation then sets the state of the unit test based on whether or not the parameter passed from VBA meets the condition of the <code>AssertClass</code> method called.</p>\n\n<pre><code>        Assert.IsTrue userInput = vbNullString\n</code></pre>\n\n<hr>\n\n<h2>What this means in relation to your question:</h2>\n\n<p>Note that in the breakdown of how the code above executes, <strong><em>everything is executing in the VBA environment</em></strong>. Rubberduck is providing VBA a \"window\" to report the results back via the <code>AssertClass</code> object, and simply (for some values of \"simply\") providing hook service through the <code>FakesProvider</code> object. VBA \"owns\" both of those objects - they are just provided through Rubberduck's COM provider.</p>\n\n<p>When you use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/end-statement\" rel=\"noreferrer\"><code>End</code></a> statement in VBA, it forcibly terminates execution at that point. The Rubberduck COM objects are no longer actively referenced by the client (your test procedure), and it's undefined as to whether or not that decrements the reference count on the COM object.  It's like yanking the plug from the wall.  The only thing that Rubberduck can determine at this point is that the COM client has disconnected.  In your case that manifests as a COM exception caught inside Rubberduck.  Since Rubberduck has no way of knowing <em>why</em> the object it is providing has lost communication, it reports the result of the test as \"Inconclusive\" - it did not run to completion.</p>\n\n<hr>\n\n<p>That said, the solution is to refactor your code to not use <code>End</code>. Ever. Quoting the documentation linked above <code>End</code>...</p>\n\n<blockquote>\n  <p>Terminates execution immediately. Never required by itself but may be placed anywhere in a procedure to end code execution, close files opened with the Open statement, and to clear variables.</p>\n</blockquote>\n\n<p>This is nowhere near graceful, and if you have references to other COM objects (other than Rubberduck) there is no guarantee that they will be terminated reliably.</p>\n\n<hr>\n\n<p>Full disclosure, I contribute to the Rubberduck project and authored some of the code described above. If you want to get a better understanding of how unit testing functions (and can read c#), the implementations of the COM providers <a href=\"https://github.com/rubberduck-vba/Rubberduck/tree/next/Rubberduck.Main/ComClientLibrary\" rel=\"noreferrer\">can be found at this link</a>.</p>\n"}], "owner": {"reputation": 734, "user_id": 1114105, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/13afb6aa9cb7529e42065d49e53a477a?s=128&d=identicon&r=PG", "display_name": "user1114", "link": "https://stackoverflow.com/users/1114105/user1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 53926414, "answer_count": 1, "score": 4, "last_activity_date": 1545782686, "creation_date": 1545778529, "last_edit_date": 1545779992, "question_id": 53926116, "link": "https://stackoverflow.com/questions/53926116/can-rubberduck-test-if-a-program-ends", "title": "Can RubberDuck test if a program ends?", "body": "<p>I'm developing tests with RubberDuck, and would like to test MsgBox outputs from a program. The catch is that the program ends right after outputting the MsgBox - there's literally an \"End\" Statement. </p>\n\n<p>When running a RubberDuck test and using Fakes.MsgBox.Returns, there's an inconclusive yellow result with message \"Unexpected COM exception while running tests\"</p>\n\n<p>I've tried placing an \"Assert.Fail\" at the end of the test; however, it seems like the program ending throws things off.</p>\n\n<p>Is it possible for a test in RubberDuck to detect if the program ends?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545771575, "post_id": 53925559, "comment_id": 94692728, "body": "This may not be the problem, but I notice that after the <code>Me.Undo</code>, you look up the <code>Id</code>, <code>EmpNr</code>, but then use <code>FindRecord</code> to search on <code>EmpNum</code>. Perhaps you meant to use <code>FindRecord</code> with <code>EmpNr</code>?"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545771638, "post_id": 53925559, "comment_id": 94692740, "body": "Or, when you say &quot;it shows the value again&quot;, are you talking about the popup notification, or the search for the matching record in the table?"}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545772196, "post_id": 53925559, "comment_id": 94692815, "body": "is it possible to send you an example of the database and you can have a look?"}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545772523, "post_id": 53925559, "comment_id": 94692853, "body": "@AnnL. yes its the matching record"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1545772652, "post_id": 53925559, "comment_id": 94692866, "body": "Use BeforeUpdate events to validate input."}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545772894, "post_id": 53925559, "comment_id": 94692899, "body": "@Vanzie Was I on the right track with my first comment? Because I notice that you look up <code>EmpNr</code>, but don&#39;t do anything with it. Were you intending to use it with <code>FindRecord</code>?"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545772945, "post_id": 53925559, "comment_id": 94692905, "body": "@Vanzie Unfortunately, the laptop I&#39;m using doesn&#39;t have Office installed, so it wouldn&#39;t do any good for you to send me the database."}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545772973, "post_id": 53925559, "comment_id": 94692910, "body": "@Vanzie (Also, your employer would probably object to you sending data outside the company!)"}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "edited": false, "score": 0, "creation_date": 1545773135, "post_id": 53925559, "comment_id": 94692936, "body": "still shows same problem"}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545773216, "post_id": 53925559, "comment_id": 94692951, "body": "@AnnL. there will be no information within the tables as you can enter your own xyz  to test"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545773572, "post_id": 53925559, "comment_id": 94693014, "body": "@Vanzie Can you post a screen shot of your form? I just have some questions about how you set it up, and the easiest way for me to get answers is to see what the form looks like."}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545773776, "post_id": 53925559, "comment_id": 94693048, "body": "@AnnL. i removed the EmpNr lookup and DIM but it still gives me the same problem. Like for example i add person A to the database and continue to add person B. Now i add person C but accidentally use the same employee number as person B for person C. Now after clearing the notification it should find the record of the employee with that employee number and display that information which should be person B&#39;s information but it keeps displaying person A&#39;s details (no matter how many persons you add it keeps displaying info for A)"}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "reply_to_user": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545774114, "post_id": 53925559, "comment_id": 94693098, "body": "@AnnL. i have added a link in the body of the question"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545774181, "post_id": 53925559, "comment_id": 94693112, "body": "This is a wild guess, but try changing <code>acCurrent</code> to <code>acAll</code>.  See if that makes a difference."}, {"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "edited": false, "score": 0, "creation_date": 1545774325, "post_id": 53925559, "comment_id": 94693132, "body": "seems to have worked!"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545774663, "post_id": 53925559, "comment_id": 94693183, "body": "yay!  I will write this up as a solution, then. It would be nice if you could mark it as accepted when I&#39;m done."}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1545859032, "post_id": 53925559, "comment_id": 94714484, "body": "Here&#39;s a link to a quick demo of how StackOverflow works. It should demonstrate someone marking an answer as accepted."}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1546520896, "post_id": 53925559, "comment_id": 94881910, "body": "@Vanzie Never provided the link!  <a href=\"https://stackoverflow.com/tour\">Demo of marking an answer as accepted</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "edited": false, "score": 0, "creation_date": 1545847211, "post_id": 53925856, "comment_id": 94710983, "body": "This will definitely be the answer but I doubt I will run into this problem with other ID fields as each table as it&#39;s own unique ID fields. But thank you for you help. I&#39;m still new so I have no idea how to mark as the answer"}, {"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "reply_to_user": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "edited": false, "score": 0, "creation_date": 1545858849, "post_id": 53925856, "comment_id": 94714438, "body": "@Vanzie You see, by the answer, where there&#39;s a number and an up-triangle and a down-triangle?  You should see a checkmark below it. If you click on that, it should mark this answer as &quot;Accepted&quot;.  And I believe you&#39;ll even get points for accepting an answer!"}], "tags": [], "owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1545774998, "creation_date": 1545774998, "answer_id": 53925856, "question_id": 53925559, "link": "https://stackoverflow.com/questions/53925559/docmd-findrecord-isnt-finding-the-record-in-access-vba-code/53925856#53925856", "title": "DoCmd.FindRecord isn&#39;t finding the record in Access VBA code", "body": "<p>I <em>think</em> the problem you are having is that this command:</p>\n\n<pre><code> DoCmd.FindRecord EmpNum, , , , , acCurrent\n</code></pre>\n\n<p>...searches in the <em>current</em> field.  But if there isn't a current field (because the form doesn't have the focus), or if the current field is some other field (such as ID), the \"find\" won't find a match, and the record you're looking at won't change.</p>\n\n<p>The simplest fix would be to change your code to this:</p>\n\n<pre><code> DoCmd.FindRecord EmpNum, , , , , acAll\n</code></pre>\n\n<p>That will search for the value of <code>EmpNum</code> in ALL the fields.  </p>\n\n<p>But, if there's a chance that the value for <code>EmpNum</code> might also appear in other fields than <code>txtEmpNumber</code> (for example, if someone has <code>EmpNum = 12</code> and someone else is <code>ID = 12</code>), this will eventually start \"finding\" the wrong record.</p>\n\n<p>So I think the best thing to do would be to make sure your current field is <code>txtEmpNumber</code> before you execute the <code>FindRecord</code>.  </p>\n\n<pre><code>Me.txtEmpNumber.SetFocus\nDoCmd.FindRecord EmpNum, , , , , acCurrent\n</code></pre>\n\n<p>That will ensure it <em>only</em> looks in <code>txtEmpNumber</code> when it's trying to find the record.</p>\n"}], "owner": {"reputation": 1, "user_id": 10832925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a469f182e503d947e3a5d55d49aa7874?s=128&d=identicon&r=PG&f=1", "display_name": "Vanzie", "link": "https://stackoverflow.com/users/10832925/vanzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546420209, "creation_date": 1545771276, "last_edit_date": 1546420209, "question_id": 53925559, "link": "https://stackoverflow.com/questions/53925559/docmd-findrecord-isnt-finding-the-record-in-access-vba-code", "title": "DoCmd.FindRecord isn&#39;t finding the record in Access VBA code", "body": "<p>I am not sure if there is another post like this but i think my question is a little different.</p>\n\n<p>I am currently designing a database to track employee training given by employer. My current error I find is adding an employee by using a bound form (frmAddEmployee) to my employees table (tblEmployees).</p>\n\n<p>What I have at the moment that works is VBA code that shows a notification when you enter a value into a textbox for the employee number and it finds a duplicate record in the table. The VBA will also show the record in the same form that corresponds with the value you have entered when you clear the notification. </p>\n\n<p>Here's the code I use for the txtEmpNumber after update:</p>\n\n<pre><code>Private Sub txtEmpNumber_AfterUpdate()\nDim EmpNum As String\nDim stLinkCriteria As String\nDim EmpNr As Integer\n\n'Assign the entered employee number to a variable\nEmpNum = Me.txtEmpNumber.Value\nstLinkCriteria = \"[EmpNumber] = \" &amp; \"'\" &amp; EmpNum &amp; \"'\"\nIf Me.txtEmpNumber = DLookup(\"[EmpNumber]\", \"tblEmployees\", stLinkCriteria) Then\n    MsgBox \"This employee number, \" &amp; EmpNum &amp; \", has already been entered in database.\" _\n           &amp; vbCr &amp; vbCr &amp; \"Please check the number.\", vbExclamation, \"Duplicate information\"\n    Me.Undo\n    'show the record of matched employee number from the employees table\n    EmpNr = DLookup(\"[EmpID]\", \"tblEmployees\", stLinkCriteria)\n    Me.DataEntry = False\n    DoCmd.FindRecord EmpNum, , , , , acCurrent\n    Me.cmdSave.Enabled = False\n    Me.cmdNew.Enabled = True\nElse\n    Me.txtIDNumber.Enabled = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The notification shows there is a duplicate value, for example 1234 and shows the record in the table for 1234 but when I try a different value like 5678 then it shows the value again for 1234 and not 5678.</p>\n\n<p>Any ideas how to fix this problem?</p>\n\n<p><img src=\"https://i.stack.imgur.com/2gCxo.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["ms-access", "stored-procedures", "properties", "vba", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1545767741, "creation_date": 1545767741, "answer_id": 53925258, "question_id": 53924300, "link": "https://stackoverflow.com/questions/53924300/ms-access-2007-operation-not-supported-error-for-properties-cachesize-prepar/53925258#53925258", "title": "MS Access 2007: &quot;Operation not supported&quot; error for properties CacheSize, Prepare, and StillExecuting of all queries", "body": "<p>These properties are only supported for ODBCDirect workspaces, which are only supported in JET, not in ACE, and only for external connections. </p>\n\n<p>The properties are present and documented, but that doesn't mean you can use them when querying Access itself, nor that you should use them. If you want to asynchronously execute queries, you should use ADO, not DAO.</p>\n"}], "owner": {"reputation": 640, "user_id": 5803910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e96477b88f83ffbe7edd8e993d8f235?s=128&d=identicon&r=PG", "display_name": "NewSites", "link": "https://stackoverflow.com/users/5803910/newsites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 53925258, "answer_count": 1, "score": 1, "last_activity_date": 1594625282, "creation_date": 1545758642, "last_edit_date": 1594625282, "question_id": 53924300, "link": "https://stackoverflow.com/questions/53924300/ms-access-2007-operation-not-supported-error-for-properties-cachesize-prepar", "title": "MS Access 2007: &quot;Operation not supported&quot; error for properties CacheSize, Prepare, and StillExecuting of all queries", "body": "<p>In Access VBA, the <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydef-properties-dao\" rel=\"nofollow noreferrer\">properties of queries</a> include CacheSize, Prepare, and StillExecuting. I have looked at these properties for all stored queries of four different Access databases, and the request always yields error 3251, \"Operation is not supported for this type of object.\" This happens in a loop over all queries, and it also happens if I make the request in the immediate window, such as with:</p>\n\n<pre><code>debug.Print CurrentDb.QueryDefs(0).CacheSize\n</code></pre>\n\n<p>The documentation linked above for query properties says it applies to Access 2013. I'm using Access 2007, but in the VBA editor, the popup list of properties that comes up when I type <code>CurrentDb.QueryDefs(0).</code> includes CacheSize, Prepare, and StillExecuting, so the problem is not that those properties are not supported in my version of Access.</p>\n\n<p>Why am I not able to get the values of these properties for stored queries?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545759562, "post_id": 53924095, "comment_id": 94690440, "body": "What have you tried? Please share your code and explain where you are stuck."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545816903, "post_id": 53925723, "comment_id": 94700932, "body": "This will fail (I think) as you are passing a string to index into a collection (and that string cannot be implicitly converted) You can also combine your two Do While Loops into one and upgrade method to .Navigate2. You don&#39;t need to set objects to Nothing either as they will dereferenced when out of scope at end of sub."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1545870300, "post_id": 53925723, "comment_id": 94716912, "body": "See this link: <a href=\"https://www.reddit.com/r/vba/comments/88jfz0/code_help_trying_to_click_the_google_search_button/\" rel=\"nofollow noreferrer\">reddit.com/r/vba/comments/88jfz0/&hellip;</a>"}], "tags": [], "owner": {"reputation": 162, "user_id": 9885313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OO60u.png?s=128&g=1", "display_name": "ThePoetCoder", "link": "https://stackoverflow.com/users/9885313/thepoetcoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1545773174, "creation_date": 1545773174, "answer_id": 53925723, "question_id": 53924095, "link": "https://stackoverflow.com/questions/53924095/clicking-a-button-on-webpage-using-vba/53925723#53925723", "title": "clicking a button on webpage using vba", "body": "<p>You'll need a reference to \"Microsoft Internet Controls\" which is essentially controlling Internet Explorer from VBA. If you can give me the website address I can be of more specific help, but this should get you started if it doesn't solve it for you:</p>\n\n<pre><code>Public Sub ButtonClicker()\n    Dim IE As InternetExplorer\n    Dim website_address As String: website_address = \"YOUR ADDRESS GOES HERE\"\n    Dim button_name As String: button_name = \"action\"\n    Dim button_class As String: button_class = \"btn btn-default\"\n    Dim open_in_IE As Boolean: open_in_IE = False  'Change to True if you want to see it in action\n    Dim button_collection As Object\n    Dim button As Object\n\n    On Error GoTo error_handler\n\n    If IE Is Nothing Then Set IE = New InternetExplorer\n        With IE\n            .Navigate website_address\n\n            Do While .Busy\n                DoEvents\n            Loop\n\n            Do While .ReadyState &lt;&gt; 4\n                DoEvents\n            Loop\n\n            .Visible = open_in_IE\n        End With\n\n        Set button_collection = IE.Document.getElementsByName(button_name)\n            Set button = button_collection(button_class)  'Inspect Locals here to see what comes through\n                button.Click\n            Set button = Nothing\n        Set button_collection = Nothing\n\n        IE.Quit\n        Set IE = Nothing\n    Exit Sub\n\nerror_handler:\n    Debug.Print \"IE Error: \" &amp; Err.Number &amp; \" - \" &amp; Err.Description\n    If Not (IE Is Nothing) Then\n        IE.Quit\n        Set IE = Nothing\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10740456, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cvSL1Fhz_iE/AAAAAAAAAAI/AAAAAAAAKoI/VAMRLCGLoFw/photo.jpg?sz=128", "display_name": "rohail nisar", "link": "https://stackoverflow.com/users/10740456/rohail-nisar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1545814883, "accepted_answer_id": 53925723, "answer_count": 1, "score": 0, "last_activity_date": 1545773174, "creation_date": 1545756583, "question_id": 53924095, "link": "https://stackoverflow.com/questions/53924095/clicking-a-button-on-webpage-using-vba", "closed_reason": "Needs more focus", "title": "clicking a button on webpage using vba", "body": "<p>i am trying to get a code working , but i am unable to make it click a sumbit button as the web doesnt have that button by its id, following is the html line i am trying to click, how can i click this button via vba code.</p>\n\n<pre><code> &lt;button type=\"submit\" class=\"btn btn-default\" value=\"Login\" \n name=\"action\"&gt;Submit&lt;/button&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1545748005, "post_id": 53923095, "comment_id": 94688102, "body": "That is a very well asked question. While it is different to the one I voted for as a duplicate target, I believe the accepted answer there covers your situation perfectly."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545748941, "post_id": 53923095, "comment_id": 94688296, "body": "There is obviously tons of ways but here is a funny one if you wanna stick to columns: &#39;For Each r in Range(Range(&quot;A1:B15&quot;).Columns(2).Address)&#39;."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545755753, "post_id": 53923095, "comment_id": 94689698, "body": "Your first code only needs <b>.Cells</b> and <b>.Address</b> to work."}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "edited": false, "score": 0, "creation_date": 1545747575, "post_id": 53923134, "comment_id": 94688001, "body": "Thank you for your quick answer. It works! But I think it&#39;s a little complicated. I want a still simpler one. There should be one, I suppose."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1545751194, "post_id": 53923134, "comment_id": 94688781, "body": "Although I haven&#39;t found a scenario where this code would trump the columns solutions, I think it is not correct to downvote inspiring working solutions like this one."}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1545747252, "creation_date": 1545747252, "answer_id": 53923134, "question_id": 53923095, "link": "https://stackoverflow.com/questions/53923095/i-cant-access-each-cell-of-columns2-unlike-rangebb-what-kind-of-ran/53923134#53923134", "title": "I can&#39;t access each cell of &#39;Columns(2)&#39; unlike &#39;&#39;Range(&quot;B:B&quot;)&#39; What kind of range is &#39;Columns(2)&#39;?", "body": "<p>Perhaps using Resize &amp; Offset will help:</p>\n\n<pre><code>Sub test1()\n    Dim r As Range\n\n    For Each r In Range(\"A1:B15\").Resize(Range(\"A1:B15\").Rows.Count, 1).Offset(0, 1)\n        Debug.Print r.Address\n    Next r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "edited": false, "score": 1, "creation_date": 1545748479, "post_id": 53923183, "comment_id": 94688188, "body": "&#39;Range(&quot;A1:B15&quot;).Columns(2).Cells&#39; is good enough."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1545748126, "last_edit_date": 1545748126, "creation_date": 1545747662, "answer_id": 53923183, "question_id": 53923095, "link": "https://stackoverflow.com/questions/53923095/i-cant-access-each-cell-of-columns2-unlike-rangebb-what-kind-of-ran/53923183#53923183", "title": "I can&#39;t access each cell of &#39;Columns(2)&#39; unlike &#39;&#39;Range(&quot;B:B&quot;)&#39; What kind of range is &#39;Columns(2)&#39;?", "body": "<p>add Cells : Columns(2).Cells</p>\n\n<pre><code>Sub test2()\n    Dim r As Range, TargetColumn As Range\n    Set TargetColumn = Range(\"A1:B15\").Columns(2).Cells\n\n    Debug.Print TargetColumn.Count  '//count is  1, not 15\n    For Each r In TargetColumn\n        Debug.Print r.Address       '//$B$1:$B$15\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>debug result</p>\n\n<p><a href=\"https://i.stack.imgur.com/N61oD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N61oD.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "edited": false, "score": 0, "creation_date": 1545748643, "post_id": 53923208, "comment_id": 94688222, "body": "&#39;Range(&quot;A1:B15&quot;).Columns(2).Rows&#39; is also useful in this case. I didn&#39;t think of it. Thank you for the enlightenment."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1545747909, "creation_date": 1545747909, "answer_id": 53923208, "question_id": 53923095, "link": "https://stackoverflow.com/questions/53923095/i-cant-access-each-cell-of-columns2-unlike-rangebb-what-kind-of-ran/53923208#53923208", "title": "I can&#39;t access each cell of &#39;Columns(2)&#39; unlike &#39;&#39;Range(&quot;B:B&quot;)&#39; What kind of range is &#39;Columns(2)&#39;?", "body": "<p>I am not sure what you want but maybe that's what you after</p>\n\n<pre><code>Sub test11()\n    Dim r As Range\n\n    For Each r In Range(\"A1:B15\").Columns(2).Rows\n        Debug.Print r    \n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>This will loop through the single cells of column 2 and it will not run into a run time error as the line debug.print r will take the default item of the single cell which is value, r is still a range though.</p>\n"}], "owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "closed_date": 1545747944, "accepted_answer_id": 53923183, "answer_count": 3, "score": 2, "last_activity_date": 1578482381, "creation_date": 1545746926, "last_edit_date": 1578482381, "question_id": 53923095, "link": "https://stackoverflow.com/questions/53923095/i-cant-access-each-cell-of-columns2-unlike-rangebb-what-kind-of-ran", "closed_reason": "Duplicate", "title": "I can&#39;t access each cell of &#39;Columns(2)&#39; unlike &#39;&#39;Range(&quot;B:B&quot;)&#39; What kind of range is &#39;Columns(2)&#39;?", "body": "<p>I want to get the whole second column in range(\"A1:B15\").\nOf course , I can use 'Range(\"B1:B15\")' but the range may change according to the situations like different WorkSheets. So I need to get the range of the second column dynamically.</p>\n\n<p>The following code I made first pops up an error(Runtime error 13: Type mismatch).</p>\n\n<pre><code>Sub test1()\n    Dim r As Range\n\n    For Each r In Range(\"A1:B15\").Columns(2)\n        Debug.Print r     '// Runtime Error '13': Type mismatch.\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>I thought that 'Columns(2)' is a kind of range, each cell of which can be accessed one by one.\nTo my disappointment, here 'Range(\"A1:B15\").Columns(2)' is not a normal series of range.\nThough, 'Range(\"A1:B15\").Columns(2)' has an Address: '$B$1:$B:$15.'\nI couldn't understand this, at first.</p>\n\n<p>To find out why the error occurs, I tried the following code.</p>\n\n<pre><code>Sub test2()\n    Dim r As Range, TargetColumn As Range\n    Set TargetColumn = Range(\"A1:B15\").Columns(2)\n\n    Debug.Print TargetColumn.Count  '//count is  1, not 15\n    For Each r In TargetColumn\n        Debug.Print r.Address       '//$B$1:$B$15\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>'TargetColumn.count' is not 15, but 1.\n'r.address' is only \"$B$1:$B$15.\", not a series of \"$B$1, $B$2, $B$3 ....\"\nSo 'Columns(2)' is not a normal series of range, but only a single range like a merged cells of range(\"$B$1:$B$15\").</p>\n\n<p>To bypass the type mismatch error, I changed the code like this:</p>\n\n<pre><code>Sub test3()\n    Dim r As Range, TargetColumn As Range\n\n    Set TargetColumn = Range(\"A1:B15\").Columns(2)\n    ' get the range using the address : Range(\"A1:B15\")\n    For Each r In Range(TargetColumn.Address)   \n        Debug.Print r.Address, r.Value          ' works well\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>'Columns(2)' is not a normal series of range but a collection of range areas. It does have an address, which can be used in 'Range(Address).'</p>\n\n<p>For example, 'Columns(1).address' is '$A$1:$A$15.' and 'Columns(2).address' is '$B$1:$B$15.' \nSo the 'Columns' object is a collection of each columns.\nIt is just like 'Union(range(\"$A$1:$A$15\"), range(\"$B$1:$B$15\"))'.\nTherefore, we can not access directly each cell in 'Columns(2).'</p>\n\n<p>Is there an easier and simpler way to get a column range so that I can access each cell in the column range?\nI believe there must be a better way  than 'Range(Range(\"A1:B15\").Columns(2).address)' or 'Range(\"A1:B15\").Columns(2)' which fails to run. 'Range(\"A1:B15\").Columns(2).EntireRow' returns the whole range of \"B:B\" which I don't like to use.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545748323, "post_id": 53922838, "comment_id": 94688160, "body": "What is the value of tmp? Insert &#184;Debug.Print tmp after &#184;tmp = some_text_generator_returning_string()&#168;. I get the error only if the range is out of bounds e.g. &#168;Range(Cells(1, Columns.Count), Cells(1, Columns.Count)).Cells(1, 9).Value = tmp&#168;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545759363, "post_id": 53922838, "comment_id": 94690400, "body": "What line errors out?"}], "owner": {"reputation": 900, "user_id": 1587451, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca143c644b5da7796f746de7bbaedb80?s=128&d=identicon&r=PG", "display_name": "user1587451", "link": "https://stackoverflow.com/users/1587451/user1587451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545744698, "creation_date": 1545744698, "question_id": 53922838, "link": "https://stackoverflow.com/questions/53922838/assigning-string-to-range-value", "title": "Assigning string to Range.value", "body": "<p>I have an odd problem. This below does not work. I get a 1004 runtime error.</p>\n\n<pre><code>    Dim tmp As String\n    tmp = some_text_generator_returning_string()\n    some_range.Cells(1, 9).Value = tmp\n</code></pre>\n\n<p>If I do this</p>\n\n<pre><code>    Dim tmp As String\n    tmp = some_text_generator_returning_string()\n    tmp = \"foobar\" &amp; tmp\n    some_range.Cells(1, 9).Value = tmp\n</code></pre>\n\n<p>It works. Why is that?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545761880, "post_id": 53922637, "comment_id": 94690847, "body": "Hi SandPiper, thank you but unfortunately I am getting an error code at ws = ActiveWorkbook ...... &quot;This object does not support this method&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "edited": false, "score": 0, "creation_date": 1545761948, "post_id": 53922637, "comment_id": 94690863, "body": "You need to <b>Set</b> ws = ActiveWorkbook.Sheets(SheetList(k)). Object type vars are Set, not simple assignment."}, {"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545763245, "post_id": 53922637, "comment_id": 94691086, "body": "@SandPiper thank you I have managed to do get it working by changing ws = ActiveWorkbook.Sheets(SheetList(k)) to Set ws = Sheets(SheetList(k))"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545763402, "post_id": 53922637, "comment_id": 94691114, "body": "@Kev Using <code>Set ws = ActiveWorkbook.Sheet2</code> will only work if <code>Sheet2</code> is the actual name in VBA, not the caption. I&#39;m glad you got it working though!"}], "tags": [], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "is_accepted": true, "score": 1, "last_activity_date": 1545744044, "last_edit_date": 1545744044, "creation_date": 1545743056, "answer_id": 53922637, "question_id": 53922554, "link": "https://stackoverflow.com/questions/53922554/how-to-search-multiple-worksheets/53922637#53922637", "title": "How to search multiple worksheets?", "body": "<p>You're going to have to change the reference to <code>Sheet2</code> if you want to look at multiple sheets. There's no way around that. But, it will make your code more flexible. Start by doing this:</p>\n\n<pre><code>Private Sub SearchButton_Click()\n\n'ListBox1.Clear\n    ListBox1.RowSource = \"\"\n    ListBox1.ColumnHeads = False\n\n'listbox column headers\n Me.ListBox1.AddItem\n For A = 1 To 8\n Me.ListBox1.List(0, A - 1) = Sheet2.Cells(1, A)\n Next A\n Me.ListBox1.Selected(0) = True\n\nDim ws As Worksheet             'This is the new line of code where you define your worksheet\nSet ws = ActiveWorkbook.Sheet2  'Replace all references below to Sheet2 with this\n\n 'Populating listbox from search\n Dim i As Long\n\n For i = 2 To ws.Range(\"A100000\").End(xlUp).Offset(1, 0).Row\n For j = 1 To 8\n H = Application.WorksheetFunction.CountIf(ws.Range(\"A\" &amp; i, \"H\" &amp; i), Sheet2.Cells(i, j))\n If H = 1 And LCase(Sheet2.Cells(i, j)) = LCase(Me.TextBox2) Or H = 1 And _\n ws.Cells(i, j) = Val(Me.TextBox2) Then\n Me.ListBox1.AddItem\n For X = 1 To 8\n Me.ListBox1.List(ListBox1.ListCount - 1, X - 1) = Sheet2.Cells(i, X)\n Next X\n End If\n Next j\n Next i\n End Sub\n</code></pre>\n\n<p>Now that you're generalized your Sub, you can modify the value of <code>ws</code> to repeat the code as much as you need to. If it is every sheet in your workbook, you can use a <code>For Each</code> loop, like</p>\n\n<pre><code>For Each ws In ActiveWorkbook\n    'All your code for the ws here\nNext ws\n</code></pre>\n\n<p>Or, you can define the worksheets in an array beforehand.</p>\n\n<pre><code>Dim SheetList(0 to 2) As String\nDim k As Integer\n\nSheetList(0) = \"Sheet 2 Name\"\nSheetList(1) = \"Sheet 4 Name\"\nSheetList(2) = \"Sheet 3 Name\"\nSheetList(3) = \"Sheet 6 Name\"\n\nFor k = LBound(SheetList) To UBound(SheetList)\n    ws = ActiveWorkbook.Sheets(SheetList(k))\n    'The rest of your code from above\nNext k\n</code></pre>\n\n<p>You didn't specify in your question what kind of sheets how many, or how they are organized. But, these options should be enough to get you where you are trying to go.</p>\n"}], "owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53922637, "answer_count": 1, "score": 2, "last_activity_date": 1562303050, "creation_date": 1545742304, "last_edit_date": 1562303050, "question_id": 53922554, "link": "https://stackoverflow.com/questions/53922554/how-to-search-multiple-worksheets", "title": "How to search multiple worksheets?", "body": "<p>I search any text within Worksheet2 and display the results in ListBox1.</p>\n\n<pre><code>Private Sub SearchButton_Click()\n\n    'ListBox1.Clear\n    ListBox1.RowSource = \"\"\n    ListBox1.ColumnHeads = False\n\n    'listbox column headers\n    Me.ListBox1.AddItem\n    For A = 1 To 8\n        Me.ListBox1.List(0, A - 1) = Sheet2.Cells(1, A)\n    Next A\n    Me.ListBox1.Selected(0) = True\n\n    'Populating listbox from search\n    Dim i As Long\n\n    For i = 2 To Sheet2.Range(\"A100000\").End(xlUp).Offset(1, 0).Row\n        For j = 1 To 8\n            H = Application.WorksheetFunction.CountIf(Sheet2.Range(\"A\" &amp; i, \"H\" &amp; i), Sheet2.Cells(i, j))\n            If H = 1 And LCase(Sheet2.Cells(i, j)) = LCase(Me.TextBox2) Or H = 1 And _\n                Sheet2.Cells(i, j) = Val(Me.TextBox2) Then\n                    Me.ListBox1.AddItem\n                    For X = 1 To 8\n                        Me.ListBox1.List(ListBox1.ListCount - 1, X - 1) = Sheet2.Cells(i, X)\n                    Next X\n            End If\n       Next j\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I want to search multiple worksheets instead but don't know how to achieve this without changing the code completely.</p>\n"}, {"tags": ["excel", "vba", "string", "find"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7745782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be7106174b0b5a939be251172778d1da?s=128&d=identicon&r=PG&f=1", "display_name": "OneMinute", "link": "https://stackoverflow.com/users/7745782/oneminute"}, "edited": false, "score": 0, "creation_date": 1545746281, "post_id": 53922818, "comment_id": 94687722, "body": "I&#39;m sorry, I misspoke. I&#39;m actually looking for the cell range otherwise this function is perfect!  I didn&#39;t know about it. Thank you so much for your answer!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "is_accepted": true, "score": 0, "last_activity_date": 1545747939, "last_edit_date": 1545747939, "creation_date": 1545744545, "answer_id": 53922818, "question_id": 53922469, "link": "https://stackoverflow.com/questions/53922469/excel-vba-find-string-with-largest-value-in-adjacent-cell/53922818#53922818", "title": "Excel VBA Find String with largest value in adjacent cell", "body": "<p>Newer Excel versions have a MAXIFS function. If you receive a #NAME? error when attempting this worksheet function, try one of these alternatives.</p>\n\n<pre><code>=aggregate(14, 7, b2:b5/(a2:a5=\"blue\"), 1)\n=max(index(b2:b5-(a2:a5&lt;&gt;\"blue\")*1e99, , ))\n</code></pre>\n\n<p>Use VBA to set a range object var to the cell contining the maximum number.</p>\n\n<pre><code>Sub main()\n\n    Debug.Print maxnumfromcolor(Range(\"b2:b5\"), Range(\"a2:a5\"), \"blue\")\n\n    Dim rng As Range\n\n    Set rng = maxrngfromcolor(Range(\"b2:b5\"), Range(\"a2:a5\"), \"blue\")\n    Debug.Print rng.Address\n\nEnd Sub\n\nFunction maxnumfromcolor(rng1 As Range, rng2 As Range, str As String) As Double\n\n    Dim i As Long\n\n    Set rng1 = Intersect(rng1, rng1.Parent.UsedRange)\n    Set rng2 = rng2.Resize(rng1.Rows.Count, rng1.Columns.Count)\n\n    maxnumfromcolor = 0\n\n    For i = 1 To rng1.Cells.Count\n\n        If LCase(rng2.Cells(i).Value2) = LCase(str) Then\n            maxnumfromcolor = _\n                Application.Max(rng1.Cells(i).Value2, maxnumfromcolor)\n        End If\n\n    Next i\n\nEnd Function\n\nFunction maxrngfromcolor(rng1 As Range, rng2 As Range, str As String) As Range\n\n    Dim i As Long, mx As Double\n\n    Set rng1 = Intersect(rng1, rng1.Parent.UsedRange)\n    Set rng2 = rng2.Resize(rng1.Rows.Count, rng1.Columns.Count)\n\n    mx = 0\n\n    For i = 1 To rng1.Cells.Count\n\n        If LCase(rng2.Cells(i).Value2) = LCase(str) Then\n            If mx &lt; rng1.Cells(i).Value2 Then\n                Set maxrngfromcolor = rng1.Cells(i)  'use rng2 for 'blue cell\n                mx = rng1.Cells(i).Value2\n            End If\n        End If\n\n    Next i\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 7745782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be7106174b0b5a939be251172778d1da?s=128&d=identicon&r=PG&f=1", "display_name": "OneMinute", "link": "https://stackoverflow.com/users/7745782/oneminute"}, "edited": false, "score": 0, "creation_date": 1545748522, "post_id": 53922986, "comment_id": 94688196, "body": "Thank you very much for your time and answer! Very useful!!"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 1, "last_activity_date": 1545745975, "creation_date": 1545745975, "answer_id": 53922986, "question_id": 53922469, "link": "https://stackoverflow.com/questions/53922469/excel-vba-find-string-with-largest-value-in-adjacent-cell/53922986#53922986", "title": "Excel VBA Find String with largest value in adjacent cell", "body": "<p>You can use the MaxIfs for newer versions like so:</p>\n\n<pre><code>Function MaxIf(maxRange As Range, conditionRange As Range, conditionString As String) As Double\n\n    If Application.Version &gt;= 16 Then\n        MaxIf = Application.WorksheetFunction.MaxIfs(maxRange, conditionRange, conditionString)\n    Else\n        Dim FormulaString As String\n        FormulaString = \"MAX(IF(\" &amp; conditionRange.Address &amp; \"=\"\"\" &amp; conditionString &amp; \"\"\", \" &amp; maxRange.Address &amp; \", -9e99))\"\n        MaxIf = CDbl(conditionRange.Parent.Evaluate(FormulaString))\n    End If\nEnd Function\n\n'''''\n\nSub test()\n    MsgBox MaxIf(Sheet1.Range(\"B:B\"), Sheet1.Range(\"A:A\"), \"blue\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7745782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be7106174b0b5a939be251172778d1da?s=128&d=identicon&r=PG&f=1", "display_name": "OneMinute", "link": "https://stackoverflow.com/users/7745782/oneminute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 53922818, "answer_count": 2, "score": 0, "last_activity_date": 1545747939, "creation_date": 1545741503, "question_id": 53922469, "link": "https://stackoverflow.com/questions/53922469/excel-vba-find-string-with-largest-value-in-adjacent-cell", "title": "Excel VBA Find String with largest value in adjacent cell", "body": "<p>I have a column with some text and another with numbers as below:</p>\n\n<pre><code>--------  -----\n| GREY |  | 4 |\n--------  -----\n| BLUE |  | 3 |\n--------  -----\n| BLUE |  | 5 |\n--------  -----\n| GREY |  | 1 |\n--------  -----\n</code></pre>\n\n<p>I'd like to find all the cells containing a certain string (let's say \"Blue\", see above), then the one with the highest value in the adjacent cell (which would give \"5\" here).</p>\n\n<p>I know the FIND method and also how to get the largest value of a range (Application.WorksheetFunction.Max) but I have no idea how to combine both.</p>\n\n<p>Could anybody help me please?\nThank you in advance and sorry for my english!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 54, "user_id": 10829193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIZ1aD5vQgk/AAAAAAAAAAI/AAAAAAAABZI/J2iqCeVC_Ms/photo.jpg?sz=128", "display_name": "Hossam Azab", "link": "https://stackoverflow.com/users/10829193/hossam-azab"}, "edited": false, "score": 0, "creation_date": 1545742197, "post_id": 53922376, "comment_id": 94686850, "body": "you can adopt this method <a href=\"https://stackoverflow.com/questions/28428061/how-to-check-date-format-in-excel\" title=\"how to check date format in excel\">stackoverflow.com/questions/28428061/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10831865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd98f34745226440b2fc0dc5adf84f8?s=128&d=identicon&r=PG&f=1", "display_name": "JPK", "link": "https://stackoverflow.com/users/10831865/jpk"}, "edited": false, "score": 0, "creation_date": 1545753526, "post_id": 53922491, "comment_id": 94689262, "body": "date   01/04/2018   05/04/2018      07/04/2018    08/04/2018    i have above data in a workbook name &quot;ravi&quot; and sheet name &quot;sheet1&quot; and data start from &quot;A1&quot; TILL &quot;A4&quot;, ABOVE CODE IS NOT WORKING."}, {"owner": {"reputation": 23, "user_id": 10831865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd98f34745226440b2fc0dc5adf84f8?s=128&d=identicon&r=PG&f=1", "display_name": "JPK", "link": "https://stackoverflow.com/users/10831865/jpk"}, "edited": false, "score": 0, "creation_date": 1545758938, "post_id": 53922491, "comment_id": 94690319, "body": "Thanks a lot, i was making mistake , its working properly. Thanks a Lot Dear."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10829321"}, "is_accepted": true, "score": 0, "last_activity_date": 1545741685, "creation_date": 1545741685, "answer_id": 53922491, "question_id": 53922376, "link": "https://stackoverflow.com/questions/53922376/clear-all-cells-which-do-not-have-a-valid-date/53922491#53922491", "title": "Clear all cells which do not have a valid date", "body": "<p>VBA has an IsDate function that is pretty reliable in determining whether a cell's content is a legitimate date or not.</p>\n\n<pre><code>sub scrubNonDates()\n\n    dim i as long\n\n    with worksheets(\"sheet1\")\n        for i=2 to .cells(.rows.count, \"A\").end(xlup).row\n            if not ISDATE(.cells(i, \"A\")) then .cells(i, \"A\").clear\n        next i\n    end with\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10831865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd98f34745226440b2fc0dc5adf84f8?s=128&d=identicon&r=PG&f=1", "display_name": "JPK", "link": "https://stackoverflow.com/users/10831865/jpk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53922491, "answer_count": 1, "score": -2, "last_activity_date": 1545757416, "creation_date": 1545740712, "last_edit_date": 1545757416, "question_id": 53922376, "link": "https://stackoverflow.com/questions/53922376/clear-all-cells-which-do-not-have-a-valid-date", "title": "Clear all cells which do not have a valid date", "body": "<p>I have entries in column A starting from A2. Some cells contain dates, some are blanks, some cells contains text and numbers.</p>\n\n<p>I want to clear cells which do not contain a valid date.</p>\n"}, {"tags": ["excel", "vba", "selenium-webdriver", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 18769, "user_id": 965146, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/vSVWj.jpg?s=128&g=1", "display_name": "Shree", "link": "https://stackoverflow.com/users/965146/shree"}, "edited": false, "score": 1, "creation_date": 1545720839, "post_id": 53920031, "comment_id": 94682428, "body": "Hossam Azab, please write your answer in English, as Stack Overflow is an <a href=\"https://meta.stackoverflow.com/a/297680\">English only site</a>."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545721425, "post_id": 53920031, "comment_id": 94682523, "body": "Thanks a lot Hossam. I will try to adopt this idea. Thank you very much"}, {"owner": {"reputation": 54, "user_id": 10829193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIZ1aD5vQgk/AAAAAAAAAAI/AAAAAAAABZI/J2iqCeVC_Ms/photo.jpg?sz=128", "display_name": "Hossam Azab", "link": "https://stackoverflow.com/users/10829193/hossam-azab"}, "edited": false, "score": 0, "creation_date": 1545723413, "post_id": 53920031, "comment_id": 94682887, "body": "i must have 20 reputations"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545723584, "post_id": 53920031, "comment_id": 94682912, "body": "So you have another 9 points :) .. wait for a member to vote you up. I first votes. Now you have 26 points"}], "tags": [], "owner": {"reputation": 54, "user_id": 10829193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIZ1aD5vQgk/AAAAAAAAAAI/AAAAAAAABZI/J2iqCeVC_Ms/photo.jpg?sz=128", "display_name": "Hossam Azab", "link": "https://stackoverflow.com/users/10829193/hossam-azab"}, "is_accepted": true, "score": 3, "last_activity_date": 1545722936, "last_edit_date": 1545722936, "creation_date": 1545720666, "answer_id": 53920031, "question_id": 53919961, "link": "https://stackoverflow.com/questions/53919961/check-if-file-downloaded-to-resume-the-code/53920031#53920031", "title": "Check if file downloaded to resume the code", "body": "<p>you can check for files count in DOWNLOAD_DIRECTORY before download procedure code and then check again after it. If the count increased by one, so it is downloaded.\njust an IDEA</p>\n\n<p>i found a code that i used to count files for attendance . you can take an advantage of it</p>\n\n<pre><code>Sub Attfiles()\n\n    Dim AttFolder As String, path As String, count As Integer\n    AttFolder = \"D:\\attdata\"\n\n    path = AttFolder &amp; \"\\*.xls\" '\u0645\u0645\u0643\u0646 \u062a\u063a\u064a\u0631 \u0627\u0644\u0627\u0645\u062a\u062f\u0627\u062f \u0647\u0646\u0627\n\n    Filename = Dir(path)\n\n    Do While Filename &lt;&gt; \"\"\n       count = count + 1\n        Filename = Dir()\n    Loop\n\n    Range(\"A5\").Value = count\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 53920031, "answer_count": 1, "score": 2, "last_activity_date": 1578491787, "creation_date": 1545720007, "last_edit_date": 1578491787, "question_id": 53919961, "link": "https://stackoverflow.com/questions/53919961/check-if-file-downloaded-to-resume-the-code", "title": "Check if file downloaded to resume the code", "body": "<p>I have a code that enables me to login a website with credentials. I have replaced those with hidden1, hidden2 and hidden3 in the code for privacy.\nThe code login to the website then navigate to specific page that has two drop down lists.\nFrom the first list that has four options (this is fixed to four options), I select an option and after that the second drop down is updated according to list1\nBut List2 is changeable as the options are not known\nThe next step is to click a button that goes to another page with two elements that I clicked so as to export a pdf file.\nEverything is fine till now.</p>\n\n<p>The problem is that I have put waiting line for 15 seconds so as to wait for the download and I am searching for more efficient way to check if the file downloaded or not using selenium vba.</p>\n\n<p>Here's the code </p>\n\n<pre><code>Private Sub Test()\nDim bot         As New Selenium.WebDriver\nDim sList1      As SelectElement\nDim sList2      As SelectElement\nDim By          As New By\nDim fso         As Object\nDim myFolder    As Object\nDim objFile     As Object\nDim fil         As String\nDim fn          As String\nDim dteFile     As Date\nDim n           As Integer\nDim x           As Integer\nDim j           As Integer\n\nConst DOWNLOAD_DIRECTORY As String = \"C:\\Users\\Future\\Desktop\\Files\"\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nIf Len(Dir(DOWNLOAD_DIRECTORY, vbDirectory)) = 0 Then MkDir DOWNLOAD_DIRECTORY\n\nWith bot\n    .SetPreference \"download.default_directory\", DOWNLOAD_DIRECTORY\n    .SetPreference \"download.directory_upgrade\", True\n    .SetPreference \"download.prompt_for_download\", False\n\n    .Start \"chrome\", \"http://primprep.emis.gov.eg\"\n    .Get \"/\"\n\n    .FindElementById(\"ContentPlaceHolder1_TextBox1\").SendKeys \"hidden1\"\n    .FindElementById(\"ContentPlaceHolder1_TextBox3\").SendKeys \"hidden2\"\n    .FindElementById(\"ContentPlaceHolder1_TextBox2\").SendKeys \"hidden3\"\n    .FindElementById(\"ContentPlaceHolder1_Button2\").Click\n\n    .FindElementById(\"Button1\").Click\n    .Wait 1000\nmLoop:\n    n = n + 1\n    If n = 5 Then Stop\n    x = 0\nsPoint:\n    Set sList1 = .FindElementById(\"ContentPlaceHolder1_Dedara\").AsSelect\n    sList1.SelectByIndex n\n    .Wait 2000\n    Set sList2 = .FindElementById(\"ContentPlaceHolder1_Dschool\").AsSelect\n\n    For j = x + 1 To sList2.Options.Count\n        If x + 1 &gt;= sList2.Options.Count Then GoTo mLoop\n\n        fil = Format(n, \"00\") &amp; \"-\" &amp; Format(j, \"00\") &amp; \"-\" &amp; Application.Trim(sList2.Options(j + 1).Text) &amp; \".pdf\"\n        sList2.SelectByIndex j\n        .FindElementById(\"ContentPlaceHolder1_Button1\").Click\n        .Wait 2000\n\n        If .IsElementPresent(By.ID(\"ContentPlaceHolder1_Label2\")) Then\n            If .FindElementById(\"ContentPlaceHolder1_Label2\").Text = \"\u0644\u0627 \u064a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0639\u0631\u0636\u0647\u0627\" Then\n                Debug.Print \"No Data For This School &gt;&gt; \" &amp; Application.Trim(Replace(fil, \".pdf\", \"\"))\n                x = x + 1\n                GoTo sPoint\n            End If\n        End If\n\n        Do\n        Loop While .FindElementsById(\"IconImg_CrystalReportViewer1_toptoolbar_print\").Count = 0\n        .FindElementById(\"IconImg_CrystalReportViewer1_toptoolbar_print\").Click\n\n        Do\n        Loop While .FindElementsByCss(\"[id^='theBttnbobjid']\").Count = 0\n        .FindElementByCss(\"[id^='theBttnbobjid']\").Click\n        Application.Wait Now + TimeSerial(0, 0, 15)\n\n        'I need a way to check if the file downloaded or not instead of waiting for 15 seconds\n        'as sometimes the file took no time and sometimes the file may took over 15 seconds\n\n        Set myFolder = fso.GetFolder(DOWNLOAD_DIRECTORY)\n        dteFile = DateSerial(1900, 1, 1)\n        For Each objFile In myFolder.Files\n            If objFile.DateLastModified &gt; dteFile And fso.GetExtensionName(objFile.Path) = \"pdf\" Then\n                dteFile = objFile.DateLastModified\n                fn = objFile.name\n            End If\n        Next objFile\n        If fn &lt;&gt; vbNullString And Not fso.FileExists(DOWNLOAD_DIRECTORY &amp; \"\\\" &amp; fil) Then\n            fso.MoveFile DOWNLOAD_DIRECTORY &amp; \"\\\" &amp; fn, DOWNLOAD_DIRECTORY &amp; \"\\\" &amp; fil\n        End If\n\n        .FindElementById(\"ContentPlaceHolder1_Button2\").Click\n        .Wait 2000\n        x = x + 1\n        GoTo sPoint\n    Next j\n\n    GoTo mLoop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I have searched for such a topic and found a link but it was for Java selenium. And I need to deal with VBA selenium.\nRegards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 782, "user_id": 7953365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9227fa856add381a91b7e014c317bca1?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/7953365/ankur"}, "edited": false, "score": 1, "creation_date": 1545717630, "post_id": 53919685, "comment_id": 94681822, "body": "could you check for case-sensitive equality and try after trimming the SaveLocation value"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 2, "creation_date": 1545718022, "post_id": 53919685, "comment_id": 94681882, "body": "i.e. use \u201cSelect Case UCase(SaveLocation)\u201d or \u201cSelect Case WorksheetFunction.Trim(UCase(SaveLocation))\u201d"}, {"owner": {"reputation": 21, "user_id": 10814191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad946b2072b2856d94b576ec52717ee?s=128&d=identicon&r=PG&f=1", "display_name": "N.Almeida", "link": "https://stackoverflow.com/users/10814191/n-almeida"}, "edited": false, "score": 0, "creation_date": 1545718463, "post_id": 53919685, "comment_id": 94681955, "body": "\u201cSelect Case WorksheetFunction.Trim(UCase(SaveLocation))\u201d this works perfect. thanks for the help."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545723010, "post_id": 53919685, "comment_id": 94682825, "body": "@N.Almeida, you are welcome"}], "owner": {"reputation": 21, "user_id": 10814191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad946b2072b2856d94b576ec52717ee?s=128&d=identicon&r=PG&f=1", "display_name": "N.Almeida", "link": "https://stackoverflow.com/users/10814191/n-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574319005, "creation_date": 1545717093, "last_edit_date": 1574319005, "question_id": 53919685, "link": "https://stackoverflow.com/questions/53919685/selecting-case-when-a-string-is-matched", "title": "Selecting case when a string is matched", "body": "<p>I have a code to check the storage path of an Excel file and save it to different locations based on a input provided. I have a Vlookup function to get the input which works.</p>\n\n<p>When I use a case statement the control jumps over all cases even though the value is met.</p>\n\n<pre><code>Private Sub CommandButton6_Click()\n\n    Dim strName As String\n    Set wbA = ActiveWorkbook\n    Set wsA = ActiveSheet\n    Dim StrPath As String\n    Dim myFirstColumn As Long\n    Dim myLastColumn As Long\n    Dim myColumnIndex As Long\n    Dim myFirstRow As Long\n    Dim myLastRow As Long\n    Dim SaveLocation As String\n    Dim myTableArray As Range\n\n    myLookupValue = wsA.Range(\"B2\").Value\n    myFirstColumn = 2\n    myLastColumn = 8\n    myColumnIndex = 7\n    myFirstRow = 19\n    myLastRow = 78\n\n\n    With Worksheets(\"List\")\n        Set myTableArray = .Range(.Cells(myFirstRow, myFirstColumn), \n    .Cells(myLastRow, myLastColumn))\n    End With\n    myVlookupResult = WorksheetFunction.VLookup(myLookupValue, myTableArray, \n    myColumnIndex, False)\n    strName = wsA.Range(\"B5\").Value\n    Worksheets(\"Sheet1\").Unprotect Password:=123456\n    wsA.Range(\"A6\").Clear ' new line for date and time\n    wsA.Range(\"A6\").Value = wsA.Range(\"G5\").Value ' new line for date and time\n    Range(\"A6\").Select\n        With Selection.Font\n            .ThemeColor = xlThemeColorDark1\n            .TintAndShade = 0\n        End With\n        If ActiveSheet.CheckBoxes.Count &gt; 0 Then\n            ActiveSheet.CheckBoxes.Visible = True\n            ActiveSheet.CheckBoxes.Enabled = False\n        End If\n    Worksheets(\"Sheet1\").Protect Password:=123456\n    SaveLocation = myVlookupResult\n    Select Case SaveLocation\n    Case \"MCT\"\n    StrPath = \"MCT Gates\"\n    Case \"BG\"\n    StrPath = \"Secondary Screening Gates\"\n    End Select\n    ActiveWorkbook.SaveAs \n\n      Filename:= StrPath &amp; \"/For Approval/\" &amp; strName &amp; \".xlsm\" _\n    , FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n    Worksheets(\"Sheet1\").Protect Password:=123456\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545711460, "post_id": 53918454, "comment_id": 94681096, "body": "Loop through your range using <code>Step 6</code>. You can nest another loop that loops <code>for x = 1 to 6</code> to find your max. Or you can assign a range and then use the worksheet function Max. Man I wish I had my computer. This looks like a fun one"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545711971, "post_id": 53918454, "comment_id": 94681164, "body": "The outer loop should be step 7***"}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1545735714, "post_id": 53918454, "comment_id": 94685328, "body": "@urdearboy As I might have more or less than 6 results generated within 60 seconds, I cannot use Step 6. In fact, there might even be no results at all or 5, 10, 20 etc."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545762527, "post_id": 53918454, "comment_id": 94690969, "body": "Could you graphically show what you have and what you want to achieve?"}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545772346, "post_id": 53918454, "comment_id": 94692834, "body": "@JohnyL I have prepared something, however I cannot upload it as I don&#39;t have enough reputation yet. Is there a way to send you a direct message? Thanks!"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1545777993, "post_id": 53918454, "comment_id": 94693692, "body": "FormatDateTime(Now, vbLongTime) make value to String,  So you can&#39;t use max function."}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "reply_to_user": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1545779249, "post_id": 53918454, "comment_id": 94693878, "body": "@Dy.Lee The max function refers to values in column B, whereas column C has timestamps as a reference point so that the time difference can be calculated. This is needed to see whether or not one minute intervall has been reached."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1545782822, "post_id": 53918454, "comment_id": 94694339, "body": ".Offset(1, 1) = timevalue( FormatDateTime(Now, vbLongTime))"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1545792858, "post_id": 53918454, "comment_id": 94695511, "body": "you can upload your image to imgur.com and <a href=\"https://stackoverflow.com/posts/53918454/edit\">edit your question</a> to add a link to it. SOmeone with enough reputation is likely to embed it for you"}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545828304, "post_id": 53918454, "comment_id": 94704919, "body": "@JohnyL I have edited my post by adding a link to visualisation. Thanks!"}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1545828335, "post_id": 53918454, "comment_id": 94704932, "body": "@cybernetic.nomad thanks for your help, I have uploaded the image!"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "edited": false, "score": 0, "creation_date": 1545772280, "post_id": 53924553, "comment_id": 94692828, "body": "thanks for your efforts, however your code doesn&#39;t reflect my intention. Many thanks anyway!"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "edited": false, "score": 0, "creation_date": 1545792819, "post_id": 53924553, "comment_id": 94695503, "body": "@rocka if the code doesn&#39;t reflect your intentions, as you say, can you please explain why/how it doesn&#39;t accomplish what you want? It would help anyone else figure it out."}, {"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "reply_to_user": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "edited": false, "score": 0, "creation_date": 1545804114, "post_id": 53924553, "comment_id": 94697237, "body": "@rocka well I think I got that you intend to calculate Max value from column B. I edited to code to work for the calculation using helper column D to mark the change of minute"}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "edited": false, "score": 0, "creation_date": 1545828686, "post_id": 53924553, "comment_id": 94705043, "body": "@PankajR thank you for your help. The edited code gives me the maximum value once the range of values in column B has been formed, i.e. the code calculates the maximum only after 60 seconds, although I need to calculate the maximum on the go, with each iteration I need to know what the maximum is. I have uploaded the image, it might be helpful. Thanks again for working on this problem."}], "tags": [], "owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "is_accepted": false, "score": 0, "last_activity_date": 1545803949, "last_edit_date": 1545803949, "creation_date": 1545761008, "answer_id": 53924553, "question_id": 53918454, "link": "https://stackoverflow.com/questions/53918454/maximum-value-in-an-expanding-range/53924553#53924553", "title": "Maximum value in an expanding range", "body": "<p>One way of solving this is to check the time at each iteration and if the minute is different populate column E on the go.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim lastrow As Long\n\nlastrow = Worksheets(1).Cells(Rows.Count, 2).End(xlUp).Row\n\nWith Worksheets(1).Cells(lastrow, 2)\n    .Offset(1, 0) = Cells(2, 1).Value\n    .Offset(1, 1) = FormatDateTime(Now, vbLongTime)\n    If Minute(.Offset(1, 1).Value) &lt;&gt; Minute(.Offset(0, 1).Value) Then\n        .Offset(1, 2) = \"Change\"\n        .Offset(0, 3).End(xlUp).Offset(1, 0) = WorksheetFunction.Max(Range(.Offset(0, 0), .Offset(0, 2).End(xlUp).Offset(0, -2)))\n    End If\nEnd With\n</code></pre>\n\n<p>You can do away with <code>Generator</code> function. It will not be needed here. The additional line compares the minute value of recently added timestamp to the previous value and if its different i.e. minute changed then it marks the row that helps in calculating Max value in column E. </p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "edited": false, "score": 0, "creation_date": 1545916703, "post_id": 53945726, "comment_id": 94729992, "body": "Thank you very much! Amazing job, it reflects my intention and performs exactly what I was trying to implement!!!"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 0, "last_activity_date": 1545916537, "creation_date": 1545916537, "answer_id": 53945726, "question_id": 53918454, "link": "https://stackoverflow.com/questions/53918454/maximum-value-in-an-expanding-range/53945726#53945726", "title": "Maximum value in an expanding range", "body": "<p>You can track start cell of the minute range and calculate the time difference. If difference is more than 60 seconds, adjust result cell. The comments in code explain everything. Call it in your <code>Worksheet_Calculate</code>. Note that you can equally have <code>Private</code> variables as <code>Static</code>.</p>\n\n<p>In standard module:</p>\n\n<pre><code>Private start_cell As Range\nPrivate end_cell As Range\nPrivate result_cell As Range\n\nSub UpdateResult()\n\n    Dim r%, diff%\n    Dim rng As Range\n\n    With Sheets(\"Tabelle1\")\n\n        '// Calculate last added cell\n        Set end_cell = .Cells(.Rows.Count, \"C\").End(xlUp)\n\n        '// Check whether the last cell is first cell\n        If (end_cell.Address(0, 0) = \"C2\") Then\n            '// Experiment just began. Set initial data.\n            Set result_cell = .Range(\"E2\")\n            Set start_cell = .Range(\"C2\")\n        Else\n            '// Experiment is in progress.\n            '// Calculate seconds diff.\n            diff = DateDiff(\"s\", start_cell, end_cell)\n            If diff &gt; 60 Then\n                '// Shift result cell\n                '// and update start_cell\n                Set start_cell = end_cell\n                Set result_cell = result_cell.Offset(1)\n            End If\n        End If\n\n        '// After calculating all required cells,\n        '// write down values.\n        Set rng = Range(start_cell, end_cell)\n        result_cell.Value = WorksheetFunction.Max(rng.Offset(, -1))\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 53945726, "answer_count": 2, "score": 1, "last_activity_date": 1578491783, "creation_date": 1545696020, "last_edit_date": 1578491783, "question_id": 53918454, "link": "https://stackoverflow.com/questions/53918454/maximum-value-in-an-expanding-range", "title": "Maximum value in an expanding range", "body": "<p>How do I deal with the following task? In cell A2 I have a formula that iterates and delivers results on continuous basis. With each iteration the results are listed in B2, B3 etc. </p>\n\n<p>At the same time in C2, C3 etc I capture the corresponding timestamps. Basically, after several iterations I have a list of results in column B and a list of timestamps in column C. I have managed to code this part.</p>\n\n<p>Now to my problem: As I have timestamps, I will know at one point that there are e.g. 6 results being generated within the 1st minute. The range of results we are looking at is therefore B2:B7. </p>\n\n<p>Based on that expanding range, I need to capture the max result in E2 as the range changes with each iteration until it reaches B7. As I don\u2019t know how many results will be generated within the 1st minute, I need to update E2 with each iteration. Once the 2nd minute starts, I want to be able to do the same and capture the max result in E3. The new range will obviously start in B8 and expand depending on how many calculations are done in A2. </p>\n\n<p>If I could do it for 10 minutes, I would have 10 max results shown in a range from E2 to E11. </p>\n\n<p>Below is my code. Only partly it performs what I have described above. Any ideas how to make it work? Your help is highly appreciated! Thanks!  </p>\n\n<p>Under the following link I have visualised the problem:\n<img src=\"https://i.imgur.com/gMnYWWA.jpg\" alt=\"img1\"></p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim lastrow As Long\n\nlastrow = Worksheets(1).Cells(Rows.Count, 2).End(xlUp).Row\n\nWith Worksheets(1).Cells(lastrow, 2)\n    .Offset(1, 0) = Cells(2, 1).Value\n    .Offset(1, 1) = FormatDateTime(Now, vbLongTime)\nEnd With\n\nCall Generator\n\nEnd Sub\n\nSub Generator()\nDim icount As Long\nDim rcount As Long\n\nicount = 2\nrcount = 2\nFor tcount = 1 To 10\n    Do While DateDiff(\"s\", Cells(2, 3), Cells(icount, 3)) &lt;= tcount * 60 \n        Cells(tcount + 1, 5) = WorksheetFunction.Max(Range(Cells(rcount,   2), Cells(icount, 2))) \n        icount = icount + 1\n    Loop\nrcount = icount\nNext tcount\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1545693231, "post_id": 53918265, "comment_id": 94679300, "body": "Hi, what have you tried so far?"}, {"owner": {"reputation": 11, "user_id": 10409318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lQdEt9K0PPQ/AAAAAAAAAAI/AAAAAAAAABE/ikjxoYkzwtU/photo.jpg?sz=128", "display_name": "Andrew Le Duc", "link": "https://stackoverflow.com/users/10409318/andrew-le-duc"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1545693431, "post_id": 53918265, "comment_id": 94679330, "body": "I have tried if functions aswell as vlookup, but I cant seem to even get in the right direction."}, {"owner": {"reputation": 11, "user_id": 10409318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lQdEt9K0PPQ/AAAAAAAAAAI/AAAAAAAAABE/ikjxoYkzwtU/photo.jpg?sz=128", "display_name": "Andrew Le Duc", "link": "https://stackoverflow.com/users/10409318/andrew-le-duc"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1545695045, "post_id": 53918265, "comment_id": 94679514, "body": "I tried =if(ROSTER!A:A=&quot;ACCESSOIRES&quot;;ROSTER!B2;&quot;&quot;) but it doesnt seem to copy over everything."}, {"owner": {"reputation": 11, "user_id": 10409318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lQdEt9K0PPQ/AAAAAAAAAAI/AAAAAAAAABE/ikjxoYkzwtU/photo.jpg?sz=128", "display_name": "Andrew Le Duc", "link": "https://stackoverflow.com/users/10409318/andrew-le-duc"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1545698763, "post_id": 53918265, "comment_id": 94679951, "body": "@0m3r - <a href=\"https://i.imgur.com/x4nHCso.png\" rel=\"nofollow noreferrer\">i.imgur.com/x4nHCso.png</a> is what it would look like for now. (ALS = IF in my language fyi), anyhow... somehow in that screenshot, A6 doesnt show, A10 doesnt work etc"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1545699242, "post_id": 53918265, "comment_id": 94679989, "body": "Work with <code>INDEX</code> &amp; <code>MATCH</code>"}, {"owner": {"reputation": 11, "user_id": 10409318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lQdEt9K0PPQ/AAAAAAAAAAI/AAAAAAAAABE/ikjxoYkzwtU/photo.jpg?sz=128", "display_name": "Andrew Le Duc", "link": "https://stackoverflow.com/users/10409318/andrew-le-duc"}, "edited": false, "score": 1, "creation_date": 1545701010, "post_id": 53918265, "comment_id": 94680142, "body": "<code>=INDEX(ROSTER!$A$2:$A$20;MATCH(&quot;GROUND FLOOR&quot;;ROSTER!$F$2:$F$20;0))</code> Seems to work but if I drag it down it keeps copying the first name."}, {"owner": {"reputation": 11, "user_id": 10409318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lQdEt9K0PPQ/AAAAAAAAAAI/AAAAAAAAABE/ikjxoYkzwtU/photo.jpg?sz=128", "display_name": "Andrew Le Duc", "link": "https://stackoverflow.com/users/10409318/andrew-le-duc"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1545701124, "post_id": 53918265, "comment_id": 94680156, "body": "Despite the 2 downvotes, I now atleast know I need to use <code>index</code> and <code>match</code>. Thank you for that @0m3r. Getting late, will work on this tomorrow."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545992759, "creation_date": 1545992759, "answer_id": 53957009, "question_id": 53918265, "link": "https://stackoverflow.com/questions/53918265/extract-the-value-from-the-c-column-if-the-f-column-contains-specific-text/53957009#53957009", "title": "Extract the value from the C column if the F column contains specific text", "body": "<p>You can try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim i As Long\n    Dim LastRowSR As Long, LastRowSH1 As Long\n    Dim strSection As String, strNumber As String, strStart As String, strEnd As String, strName As String\n\n    'Sort Table in Roster Sheet\n    With ThisWorkbook.Worksheets(\"ROSTER\")\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add2 Key:=Range(\"F1\"), _\n        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\n        LastRowSR = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        With .Sort\n            .SetRange Range(\"A2:F\" &amp; LastRowSR)\n            .Header = xlNo\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    End With\n\n    'Headers Formating\n    With ThisWorkbook.Worksheets(\"HEADCOUNT\")\n        .Cells.Clear\n\n        With .Range(\"A1\")\n            .Value = \"Headcount\"\n            .Font.Bold = True\n            .Font.Color = -16776961\n            .HorizontalAlignment = xlLeft\n            .VerticalAlignment = xlBottom\n        End With\n\n        .Range(\"B1\").Value = \"06:00\"\n        .Range(\"C1\").Value = \"07:00\"\n        .Range(\"D1\").Value = \"08:00\"\n        .Range(\"E1\").Value = \"09:00\"\n        .Range(\"F1\").Value = \"10:00\"\n        .Range(\"G1\").Value = \"11:00\"\n        .Range(\"H1\").Value = \"12:00\"\n        .Range(\"I1\").Value = \"13:00\"\n        .Range(\"J1\").Value = \"13:30\"\n        .Range(\"K1\").Value = \"14:00\"\n        .Range(\"L1\").Value = \"15:00\"\n        .Range(\"M1\").Value = \"16:00\"\n        .Range(\"N1\").Value = \"17:00\"\n\n        With .Range(\"B1:N1\")\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlBottom\n        End With\n\n        With .Range(\"E1,J1,N1\")\n            .Font.Bold = True\n        End With\n\n        .Range(\"J1\").Font.Color = -65281\n\n        With .Range(\"O1:Q1\")\n            .Merge\n            .Value = \"Shift\"\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlBottom\n        End With\n\n        With .Range(\"O2\")\n            .Value = \"Number:\"\n            .HorizontalAlignment = xlCenter\n            .VerticalAlignment = xlBottom\n        End With\n\n        With .Range(\"P2\")\n            .Value = \"Start\"\n            .HorizontalAlignment = xlLeft\n            .VerticalAlignment = xlBottom\n        End With\n\n        With .Range(\"Q2\")\n            .Value = \"End\"\n            .HorizontalAlignment = xlLeft\n            .VerticalAlignment = xlBottom\n        End With\n\n        .Range(\"P2:Q2\").Interior.Color = 65535\n\n    End With\n\n    'Loop Roster\n    With ThisWorkbook.Worksheets(\"ROSTER\")\n\n        For i = 2 To LastRowSR\n\n            strName = .Range(\"A\" &amp; i).Value\n            strNumber = .Range(\"B\" &amp; i).Value\n            strStart = Format(.Range(\"D\" &amp; i).Value, \"hh:mm\")\n            strEnd = Format(.Range(\"E\" &amp; i).Value, \"hh:mm\")\n            strSection = .Range(\"F\" &amp; i).Value\n\n            With ThisWorkbook.Worksheets(\"HEADCOUNT\")\n\n                LastRowSH1 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n                If LastRowSH1 = 1 Then\n                    With .Range(\"A\" &amp; LastRowSH1 + 1)\n                        .Value = strSection\n                        .Font.Bold = True\n                    End With\n                    .Range(\"A\" &amp; LastRowSH1 + 2).Value = strName\n                    .Range(\"O\" &amp; LastRowSH1 + 2).Value = strNumber\n                    .Range(\"P\" &amp; LastRowSH1 + 2).Value = strStart\n                    .Range(\"Q\" &amp; LastRowSH1 + 2).Value = strEnd\n                ElseIf strSection = .Range(\"A\" &amp; LastRowSH1 - 1).Value Then\n                    .Range(\"A\" &amp; LastRowSH1 + 1).Value = strName\n                    .Range(\"O\" &amp; LastRowSH1 + 1).Value = strNumber\n                    .Range(\"P\" &amp; LastRowSH1 + 1).Value = strStart\n                    .Range(\"Q\" &amp; LastRowSH1 + 1).Value = strEnd\n                Else\n                    With .Range(\"A\" &amp; LastRowSH1 + 2)\n                        .Value = strSection\n                        .Font.Bold = True\n                    End With\n                        .Range(\"A\" &amp; LastRowSH1 + 3).Value = strName\n                        .Range(\"O\" &amp; LastRowSH1 + 3).Value = strNumber\n                        .Range(\"P\" &amp; LastRowSH1 + 3).Value = strStart\n                        .Range(\"Q\" &amp; LastRowSH1 + 3).Value = strEnd\n                End If\n\n                .UsedRange.Columns.AutoFit\n\n            End With\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10409318, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lQdEt9K0PPQ/AAAAAAAAAAI/AAAAAAAAABE/ikjxoYkzwtU/photo.jpg?sz=128", "display_name": "Andrew Le Duc", "link": "https://stackoverflow.com/users/10409318/andrew-le-duc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1576180318, "creation_date": 1545692975, "last_edit_date": 1576180318, "question_id": 53918265, "link": "https://stackoverflow.com/questions/53918265/extract-the-value-from-the-c-column-if-the-f-column-contains-specific-text", "title": "Extract the value from the C column if the F column contains specific text", "body": "<p>So I would like to extract the data from a row if the column contains a specific word. So if Column F contains the word \"FITNESS\", I would like the names, numbers, start and end time of the corresponding rows to be copied over to another tab. </p>\n\n<p><a href=\"https://i.stack.imgur.com/iQxYG.png\" rel=\"nofollow noreferrer\">Roster</a> - \"ROSTER\"  TAB</p>\n\n<p><a href=\"https://i.stack.imgur.com/WWB0d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WWB0d.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ss5eC.png\" rel=\"nofollow noreferrer\">Headcount</a> - \"HEADCOUNT\" TAB</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dh1X4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dh1X4.png\" alt=\"enter image description here\"></a></p>\n\n<p>So basically I want to extract the number, name, start and end time of each individual, into the correct part of the headcount tab. So in A3 I would end up with Ila Yokum and O3 her number, P3 her start time and Q3 her end time. In A4 Cherrie Errico and O4 her number. In A10 I would end up with Carlos Bigham. Etc. Etc.</p>\n\n<p>I tried the following, but it doesn't copy over everything correctly.</p>\n\n<pre><code>=if(ROSTER!A:A=\"ACCESSOIRES\";ROSTER!B2;\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/imjvA.png\" rel=\"nofollow noreferrer\">Works for A3-A5 but not for A10?</a></p>\n\n<p>The roster would change on a daily basis, and more or less people of each section could be on the roster, as well as different starting/end times. However, the section and number is always linked to the person.</p>\n\n<p>Any help is appreciated and thanks in advance,</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545687450, "post_id": 53917466, "comment_id": 94678528, "body": "What kind of query is Query1? Can you use the <a href=\"https://stackoverflow.com/posts/53917466/edit\">edit</a> link below the question to add the SQL behind the query? Or, if you use this query in Access, itself, does it prompt for information?"}, {"owner": {"reputation": 1, "user_id": 10830180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c5a7d911a624310a701680aaeb6a84?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBird888", "link": "https://stackoverflow.com/users/10830180/blackbird888"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545687753, "post_id": 53917466, "comment_id": 94678571, "body": "I&#39;ve updated it to show query1. Thanks for your help!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545693513, "post_id": 53917466, "comment_id": 94679343, "body": "Do those other queries have popup input prompts?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10830180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c5a7d911a624310a701680aaeb6a84?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBird888", "link": "https://stackoverflow.com/users/10830180/blackbird888"}, "edited": false, "score": 0, "creation_date": 1545846030, "post_id": 53918256, "comment_id": 94710670, "body": "Thanks for your help. So I created an inputbox function and it works for the ST field. However, I get a data mismatch type error when I do that for the dates. Below is an example of the code working with the anticipated dates I choose to use."}, {"owner": {"reputation": 1, "user_id": 10830180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c5a7d911a624310a701680aaeb6a84?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBird888", "link": "https://stackoverflow.com/users/10830180/blackbird888"}, "edited": false, "score": 0, "creation_date": 1545846184, "post_id": 53918256, "comment_id": 94710719, "body": "Here is my code below:     &quot;Select MED, RX, HSAHRA, ACR, ML, SUM(MBRS) AS    SUMOFMBRS, SUM(PREM) AS SUMOFPREM, SUM(CLMSTAT)AS      SUMOFCLMSTAT &quot; &amp; _          &quot;FROM WEST &quot; &amp; _          &quot;WHERE ST = &#39;&quot; &amp; myInputBoxVariable &amp; &quot;&#39; &quot; &amp; _          &quot;and DATE BETWEEN 201710 AND 201809 &quot; &amp; _          &quot;GROUP BY MED, RX, HSAHRA, ACR, ML &quot; &amp; _          &quot;ORDER BY MED, RX, HSAHRA, ACR, ML &quot;"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 2, "last_activity_date": 1545693446, "last_edit_date": 1545693446, "creation_date": 1545692789, "answer_id": 53918256, "question_id": 53917466, "link": "https://stackoverflow.com/questions/53917466/run-time-error-3061-too-few-parameters-expected-3/53918256#53918256", "title": "Run-time error &#39;3061&#39;. Too few parameters. Expected 3", "body": "<p>User should input criteria into controls on form then reference those controls as parameter inputs:</p>\n\n<pre><code>strSQL = \"SELECT MED, RX, HSAHRA, ACR, ML, Sum(MBRS) AS SumOfMBRS, Sum(PREM) AS SumOfPREM, Sum(CLMSTAT) AS SumOfCLMSTAT\nFROM W \" &amp; _\n\"WHERE [DATE] Between #\" &amp; Me.tbxStart &amp; \"# And #\" &amp; Me.tbxEnd &amp; \"# AND [ST]='\" &amp; Me.tbxState &amp; \"' \" &amp; _\n\"GROUP BY MED, RX, HSAHRA, ACR, ML \" &amp; _\n\"ORDER BY MED, RX, HSAHRA, ACR, ML;\"\n</code></pre>\n\n<p>Or in your case, reference cells of worksheet. If you want to use popups for user input, will have to use InputBox() function.</p>\n"}], "owner": {"reputation": 1, "user_id": 10830180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96c5a7d911a624310a701680aaeb6a84?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBird888", "link": "https://stackoverflow.com/users/10830180/blackbird888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545693446, "creation_date": 1545683487, "last_edit_date": 1545692037, "question_id": 53917466, "link": "https://stackoverflow.com/questions/53917466/run-time-error-3061-too-few-parameters-expected-3", "title": "Run-time error &#39;3061&#39;. Too few parameters. Expected 3", "body": "<p>I am trying to use VBA to pull data from access into excel. I am able to use this script for other query's, but when for this specific query, I get this parameter error. The break happens here:</p>\n\n<p><code>Set rs = A.CurrentDb().QueryDefs(\"Query1\").OpenRecordset()</code></p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\nDim A As Object\nDim rs As Object\n\nApplication.DisplayAlerts = False\n\nSet A = CreateObject(\"Access.Application\")\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nA.Visible = True\nA.OpenCurrentDatabase (\"Y:\\UW\\B\\201811.accdb\")\nA.DoCmd.OpenQuery (\"Query1\")\n\nSet rs = A.CurrentDb().QueryDefs(\"Query1\").OpenRecordset()\n\nIf Not rs.EOF Then\nws.Range(\"A2\").CopyFromRecordset rs\nEnd If\n\nFor iCols = 0 To rs.Fields.Count - 1\nWorksheets(\"Sheet1\").Cells(1, iCols + 1).Value = rs.Fields(iCols).Name\nNext\nrs.Close\n\n Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Here is query1:</p>\n\n<pre><code>SELECT W.MED, W.RX, W.HSAHRA, W.ACR, W.ML, Sum(W.MBRS) AS             \nSumOfMBRS, Sum(W.PREM) AS SumOfPREM, Sum(W.CLMSTAT) AS SumOfCLMSTAT\nFROM W\nWHERE (((W.[DATE]) Between [Enter Start Date:] And [Enter End Date:]) AND \n((W.[ST])=[Enter State:]))\nGROUP BY W.MED, W.RX, W.HSAHRA, W.ACR, W.ML\nORDER BY W.MED, W.RX, W.HSAHRA, W.ACR, W.ML;\n</code></pre>\n\n<p>Also, how do i convert query1 into a sqlstring? </p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver"], "answers": [{"tags": [], "owner": {"reputation": 15697, "user_id": 458214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef09f4a6e7e0803825d17212d2dba67?s=128&d=identicon&r=PG", "display_name": "ewwink", "link": "https://stackoverflow.com/users/458214/ewwink"}, "is_accepted": false, "score": 1, "last_activity_date": 1545691849, "creation_date": 1545691849, "answer_id": 53918191, "question_id": 53917383, "link": "https://stackoverflow.com/questions/53917383/set-preference-method-giving-compile-error-as-argument-not-optional-in-seleniu/53918191#53918191", "title": "Set preference method giving compile error as &quot;Argument not optional&quot; in SeleniumVBA", "body": "<p>Try remove the parentheses </p>\n\n<pre><code>driver.AddArgument \"--no-sandbox\"\n</code></pre>\n\n<p>if still not solved try with</p>\n\n<pre><code>driver.Get \"https:www.gmail.com/\"\ndriver.AddArgument \"--no-sandbox\"\ndriver.SetPreference \"user-data-dir\", \"C:/Users/sagar/AppData/Local/Google/Chrome/User Data/Default\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1545728727, "post_id": 53918244, "comment_id": 94683852, "body": "Very nice. Not sure how I missed this question but you ain&#39;t left much wriggle room ;-))) +"}, {"owner": {"reputation": 31, "user_id": 10001858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2tNRWDE1Kuw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3oeY-3gXTCBh_iBrobOuCbxTWWYg/mo/photo.jpg?sz=128", "display_name": "Sagar Sagar", "link": "https://stackoverflow.com/users/10001858/sagar-sagar"}, "edited": false, "score": 0, "creation_date": 1546239653, "post_id": 53918244, "comment_id": 94806308, "body": "driver.SetPreference &quot;user-data-dir=C:/Users/sagar/AppData/Local/Google/Chrome/Us&zwnj;&#8203;er Data/Default&quot;, True is working for now.... Thanks everyone :)"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1545864883, "last_edit_date": 1545864883, "creation_date": 1545692642, "answer_id": 53918244, "question_id": 53917383, "link": "https://stackoverflow.com/questions/53917383/set-preference-method-giving-compile-error-as-argument-not-optional-in-seleniu/53918244#53918244", "title": "Set preference method giving compile error as &quot;Argument not optional&quot; in SeleniumVBA", "body": "<p>You have a couple of other issues with your code. First, you need to set the profile of the user directory <strong>prior</strong> to starting Chrome. So, this would need to be set before using the <code>.Get()</code> method.</p>\n\n<p>Also, if you are using <code>Dim .. As New</code> in your declaration, you do not need to <code>Set .. = New</code> later on.</p>\n\n<p>Finally, instead of using <code>.SetPreference()</code> to grab your user profile, just use <code>.SetProfile()</code> with <code>persistent:=True</code>.</p>\n\n<p>And I should also mention that you do not need to include <code>\\Default</code> to the profile, this is included automatically; and a personal preference would be for me to use <code>%USERPROFILE%</code> instead of hard coding the username in the filepath.</p>\n\n<pre><code>Dim driver As New ChromeDriver\n\ndriver.SetProfile \"%USERPROFILE%\\AppData\\Local\\Google\\Chrome\\User Data\", True\ndriver.AddArgument \"--no-sandbox\"\ndriver.Get \"https://www.gmail.com/\"\n</code></pre>\n\n<hr>\n\n<p>For your specific issue, that error code implies that you are missing a required argument. <code>.SetPreference</code> requires <strong>two</strong> arguments:</p>\n\n<ol>\n<li>Key</li>\n<li>Value</li>\n</ol>\n\n<p>But you only provided one.</p>\n"}], "owner": {"reputation": 31, "user_id": 10001858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2tNRWDE1Kuw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3oeY-3gXTCBh_iBrobOuCbxTWWYg/mo/photo.jpg?sz=128", "display_name": "Sagar Sagar", "link": "https://stackoverflow.com/users/10001858/sagar-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1578543963, "creation_date": 1545682574, "last_edit_date": 1578543963, "question_id": 53917383, "link": "https://stackoverflow.com/questions/53917383/set-preference-method-giving-compile-error-as-argument-not-optional-in-seleniu", "title": "Set preference method giving compile error as &quot;Argument not optional&quot; in SeleniumVBA", "body": "<p>I am trying to use the <code>SetPreference()</code> method in Selenium with VBA to login to website using user details.</p>\n\n<p>Below is the code.</p>\n\n<pre><code>Sub setttt()\n\n    Dim driver As New ChromeDriver    \n    Set driver = New ChromeDriver\n    driver.Get (\"https:www.gmail.com/\")    \n    driver.AddArgument (\"--no-sandbox\")      \n    driver.SetPreference (\"user-data-dir=C:/Users/sagar/AppData/Local/Google/Chrome/User Data/Default\")\n    driver.Wait (500)\n\nEnd Sub\n</code></pre>\n\n<p>I am getting a compile error  </p>\n\n<blockquote>\n  <p>Argument not optional</p>\n</blockquote>\n\n<p>Please help if I am missing anything here. </p>\n"}, {"tags": ["performance", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1545682566, "post_id": 53917318, "comment_id": 94677572, "body": "Don&#39;t know whether it has performance impact but you can&#39;t dim multiple variables in one go; <code>Dim lat1, long1, lat2, long2, theta As Double</code>. Should read <code>Dim lat1 As Double, Dim long1 As Double, Dim lat2 as Double, Dim long2 As Double, Dimtheta As Double</code>"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1545682653, "post_id": 53917318, "comment_id": 94677586, "body": "Same for this line of code, <code>Dim deg2rad, rad2deg As Double</code>. Should be <code>Dim deg2rad As Double, Dim rad2deg As Double</code>. Non-declared variables will get the default being Variant."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1545683341, "post_id": 53917318, "comment_id": 94677717, "body": "Why &quot;33143&quot;? This is a magic number that has no explanation in your code."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1545683461, "post_id": 53917318, "comment_id": 94677745, "body": "&quot;Don&#39;t use VBA&quot; is not an answer - but why not set up a calculated query? You get the source ZipCode from a text input."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1545683481, "post_id": 53917318, "comment_id": 94677752, "body": "Are ZipCodes strings or doubles? Hint: They should be strings as they are identifiers, not numbers."}, {"owner": {"reputation": 77, "user_id": 7488033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VI8tn.jpg?s=128&g=1", "display_name": "Preston White", "link": "https://stackoverflow.com/users/7488033/preston-white"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1545683867, "post_id": 53917318, "comment_id": 94677816, "body": "@AJD Thanks for the help. 33143 is the number of zip codes I have in the table. Also I would set the program up as a calculated query but access does not have the built in functions I need"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1545684377, "post_id": 53917318, "comment_id": 94677892, "body": "This screams out for update queries. Looping through 10&#39;s of thousands of records in an interpreted language is not a good idea when the DB engine is designed to do the same thing."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1545685074, "post_id": 53917318, "comment_id": 94678011, "body": "Preston: You build up the functions in a calculated field in the query. Check out the ExpressionBuilder that appears on a right click (context menu) when creating a table or query."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1545689009, "post_id": 53917318, "comment_id": 94678775, "body": "Is this a multi-user database? Multiple simultaneous users will conflict with each other writing Distance into table."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 2, "last_activity_date": 1545770681, "last_edit_date": 1545770681, "creation_date": 1545690259, "answer_id": 53918077, "question_id": 53917318, "link": "https://stackoverflow.com/questions/53917318/faster-way-to-calculate-distance-between-two-locations-zip-codes/53918077#53918077", "title": "Faster way to calculate distance between two locations (ZIP codes)", "body": "<p>Applying comments to revise code, consider following which assumes ArcCos() is a public custom UDF. Also, two query objects are referenced as data sources. One is a query of the ZipCodes table which calculates the lat and long values. The other is a query that joins Clinics table to the above query.</p>\n\n<pre><code>Private Sub Command65_Click()\nDim StartTime As Double\nDim lat1 As Double, long1 As Double\nDim Distance As Integer\n'Dim Variables\n\nStartTime = Timer\n\nlat1 = DLookup(\"lat\", \"qryLatLongZip\", \"Zip='\" &amp; Me.Text2 &amp; \"'\")\nlong1 = DLookup(\"long\", \"qryLatLongZip\", \"Zip='\" &amp; Me.Text2 &amp; \"'\")\n\nCurrentDb.Execute \"UPDATE qryClinicsLatLongZip SET Distance = ArcCos(Sin(\" &amp; lat1 &amp; \") * Sin(lat) + Cos(\" &amp; lat1 &amp; \") * Cos(lat) * Cos(\" &amp; long1 &amp; \"-long)) * (180 / 3.14159265359) * 60 * 1.1515\"\n\nMe.Filter = \"Distance&lt;=\" &amp; Me.Text1\nMe.FilterOn = True\n'Filter the form with calculated distance by prompted radius\n\nMsgBox \"This code ran successfully in \" &amp; Round(Timer - StartTime, 2) &amp; \" seconds\", vbInformation\n\nEnd Sub\n</code></pre>\n\n<p>However, in a multi-user database, users will conflict with each other writing Distance to shared table. If there are multiple users then db would have to be split and a temp table (table is permanent, records are temporary) in frontend for writing records to and that would be report RecordSource. A solution avoiding record edit/saving would be most desirable and now I see an answer has been provided doing exactly that. </p>\n"}, {"comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 2, "creation_date": 1545698376, "post_id": 53918469, "comment_id": 94679918, "body": "Access can process about 100,000 records in one second. I like your approach. I was about to suggest that a query updates the table with the distance, and then query on that. A UDF() in a query is certainly slower (100x), but I think with performance, your approach eliminates the need for a temp table. Up-voted!"}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 7, "last_activity_date": 1545697808, "last_edit_date": 1545697808, "creation_date": 1545696353, "answer_id": 53918469, "question_id": 53917318, "link": "https://stackoverflow.com/questions/53917318/faster-way-to-calculate-distance-between-two-locations-zip-codes/53918469#53918469", "title": "Faster way to calculate distance between two locations (ZIP codes)", "body": "<p>I just did a test with a table of 1,976 restaurant locations:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ID  lon        lat       poi_name                                     \n--  ---------  --------  ---------------------------------------------\n 1   -114.063   51.0466  Palomino Smokehouse: Calgary, AB             \n 2   -114.055   51.0494  Bookers BBQ Grill and Crab Shack: Calgary, AB\n 3  -86.97871  34.58037  Big Bob Gibson's Original: Decatur, AL       \n 4  -87.01763  34.56587  Big Bob Gibson's #2: Decatur, AL             \n 5    -86.364  32.26995  DJ's Old Post Office: Hope Hull, AL          \n...\n</code></pre>\n\n<p>Using the <code>GreatCircleDistance</code> function available from ...</p>\n\n<p><a href=\"http://www.cpearson.com/excel/LatLong.aspx\" rel=\"noreferrer\">http://www.cpearson.com/excel/LatLong.aspx</a></p>\n\n<p>... I ran the following query to calculate the distance from a given point</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS prmLon IEEEDouble, prmLat IEEEDouble;\nSELECT BBQ2.ID, BBQ2.lon, BBQ2.lat, BBQ2.poi_name, \n    GreatCircleDistance([prmLat],[prmLon],[lat],[lon],True,False) AS km\nFROM BBQ2;\n</code></pre>\n\n<p>and the results came back in less than a second.</p>\n\n<p>Then to return results within a certain number of kilometers from a given point I used </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS prmLon IEEEDouble, prmLat IEEEDouble, prmWithinKm IEEEDouble;\nSELECT * FROM\n(\n    SELECT BBQ2.ID, BBQ2.lon, BBQ2.lat, BBQ2.poi_name, \n        GreatCircleDistance([prmLat],[prmLon],[lat],[lon],True,False) AS km\n    FROM BBQ2\n)\nWHERE km &lt;= [prmWithinKm];\n</code></pre>\n\n<p>and again, the results came back in less than a second.</p>\n"}], "owner": {"reputation": 77, "user_id": 7488033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VI8tn.jpg?s=128&g=1", "display_name": "Preston White", "link": "https://stackoverflow.com/users/7488033/preston-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 53918469, "answer_count": 2, "score": 2, "last_activity_date": 1545770681, "creation_date": 1545681906, "last_edit_date": 1545696449, "question_id": 53917318, "link": "https://stackoverflow.com/questions/53917318/faster-way-to-calculate-distance-between-two-locations-zip-codes", "title": "Faster way to calculate distance between two locations (ZIP codes)", "body": "<p>I am writing a VBA script that finds ZIP Codes inside of a specified radius. I have an Access Database with multiple records in a table. Each record has a Name, Address, and Zip Code field on the table. The VBA code on access prompts the user for a zip code and search radius then calculates the distance between the user input zip code and the zip code for each record. Once each distance is calculated the record is displayed to the form as long as it falls within the radius input field. </p>\n\n<p>The code that I have written works but the execution time takes too long (around 30 secs for 2000ish records). How can I decrease the time it takes for this VBA code to run? Here is the code I have written:</p>\n\n<pre><code>Private Sub Command65_Click()\nDim StartTime As Double\nDim SecondsElapsed As Double\nDim i, j As Integer\nDim db As Database\nDim rs As Recordset\nDim ZIP, r As Double\nDim arr(33144, 3) As Double\nDim lat1, long1, lat2, long2, theta As Double\nDim Distance As Integer\nDim deg2rad, rad2deg As Double\nConst PI As Double = 3.14159265359\n'Dim Variables\n\nStartTime = Timer\ndeg2rad = PI / 180\nrad2deg = 180 / PI\n\nr = Text1.Value\nZIP = Text2.Value\n'Get radius and prompted zip code from form\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"US Zip Codes\")\n'Open the Table named \"US Zip Codes\"\n\nFor i = 0 To 33143\n    arr(i, 0) = rs.Fields(\"ZIP\")\n    arr(i, 1) = rs.Fields(\"LAT\")\n    arr(i, 2) = rs.Fields(\"LNG\")\n    rs.MoveNext\nNext i\n'Loop through each Zip Code record and store the Zip Code, Lattitude Point, and Longitude Point to an array\n\nFor i = 0 To 33143\n    If ZIP = arr(i, 0) Then\n        lat1 = arr(i, 1) * deg2rad\n        long1 = arr(i, 2) * deg2rad\n    End If\nNext i\n'Loop through the zip code array to get Zip Code's corresponding LAT and LONG\n\nSet rs = db.OpenRecordset(\"Clinics\")\n'Open the Table named \"Clinics\"\n\nFor j = 0 To 2094\n    If rs(\"Clinic ZIP\") = ZIP Then\n        Distance = 0\n        'If Zip Code 1 and Zip Code 2 are equal to each other, Distance = 0\n    ElseIf rs(\"Clinic ZIP\") &lt;&gt; \"\" Then\n        zip2 = rs(\"Clinic ZIP\")\n        For i = 0 To 33143\n            If zip2 = arr(i, 0) Then\n                lat2 = arr(i, 1) * deg2rad\n                long2 = arr(i, 2) * deg2rad\n            End If\n        Next i\n        'Loop through the zip code array to get the second Zip Code's corresponding LAT and LONG\n        theta = long1 - long2\n        Distance = ArcCOS(Sin(lat1) * Sin(lat2) + Cos(lat1) * Cos(lat2) * Cos(theta)) * rad2deg * 60 * 1.1515\n        'Calculate Distance between the two zip codes\n    Else\n        Distance = 999\n        'Set Arbitrary Value if the zip code field is empty\n    End If\n    rs.Edit\n    rs.Fields(\"Distance\") = Distance\n    rs.Update\n    rs.MoveNext\nNext j\n\nMe.Filter = \"Distance&lt;=\" &amp; r\nMe.FilterOn = True\n'Filter the table with calculated distance by prompted radius\nForms(\"Zip Search\").Requery\nrs.Close\nSet rs = Nothing\ndb.Close\n\nSecondsElapsed = Round(Timer - StartTime, 2)\nMsgBox \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 3, "creation_date": 1545676896, "post_id": 53916738, "comment_id": 94676339, "body": "<i>I am writing VBA</i> And where&#39;s your VBA? \ud83d\ude09"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1545677156, "post_id": 53916738, "comment_id": 94676391, "body": "And what is the question?"}, {"owner": {"reputation": 1, "user_id": 10762035, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C_rzWr1jV78/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iIUh-NoDy3-BjKtYXEugujBIJfSQ/mo/photo.jpg?sz=128", "display_name": "Arpit Vijay", "link": "https://stackoverflow.com/users/10762035/arpit-vijay"}, "edited": false, "score": 0, "creation_date": 1545677434, "post_id": 53916738, "comment_id": 94676454, "body": "The question is that I want to format the table according to column valueC however first there are some extra string that need to be cleaned up first and then i have to separate the ids in one row to multiple rows  also need to add the other elements as it is in the blank fields so that reference wont impact to customer ID--I am currently looking up some videos for table referencing so that I can write on my own but still I need help it seems."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1545681867, "post_id": 53916738, "comment_id": 94677434, "body": "That&#39;s not a question, but a list of requirements. S.O. is not a free code writing service. Please <a href=\"https://stackoverflow.com/posts/53916738/edit\">edit your question</a> to let us know what you&#39;ve tried so far."}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1545683804, "creation_date": 1545683804, "answer_id": 53917499, "question_id": 53916738, "link": "https://stackoverflow.com/questions/53916738/cleaning-excel-table-using-vba-without-impacting-the-entire-table-and-formatting/53917499#53917499", "title": "Cleaning Excel Table using VBA without impacting the entire table and formatting", "body": "<p>I think your question was not clear in regard to the \"steps\" that you want to perform on your data (i.e. the exact logic or transformation that needs to be applied).</p>\n\n<p>Based purely on your images and your comment, I make the \"steps\" to be:</p>\n\n<ol>\n<li>Split any customer IDs in column <code>valueC</code> into multiple rows.</li>\n<li>If column <code>valueC</code> does not contain customer IDs (i.e. is blank or contains non-customer ID text), leave it untouched.</li>\n</ol>\n\n<p>My answer uses Power Query instead of VBA. If you are interested in trying it out, in Excel try clicking <code>Data &gt; Get Data &gt; From Other Sources &gt; Blank Query</code>, then click <code>Advanced Editor</code> near the top-left, copy-paste the code below, then click <code>Done</code>.</p>\n\n<p>You might need to change the name of the table in the first line of the code (below), as it was <code>\"Table1\"</code> for me, but I imagine yours is named something else. Also, the code below is case-sensitive. So if there is no column named exactly <code>valueC</code>, then you will get an error.</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    fxProcessSomeText = (textToProcess as any) =&gt;\n        let\n            canBeSplit = Text.StartsWith(textToProcess, \"### customer id\"),\n            result = if textToProcess is null then null else if canBeSplit then Text.Split(Text.BetweenDelimiters(textToProcess, \"### customer id\", \" ###\"), \",\") else {textToProcess}\n        in\n            result,\n    invokeFunction = Table.TransformColumns(Source, {{\"valueC\", fxProcessSomeText}}),\n    expanded = Table.ExpandListColumn(invokeFunction, \"valueC\"),\n    reindex =\n        let\n            removeIndex = Table.RemoveColumns(expanded, {\"index\"}),\n            addIndex = Table.AddIndexColumn(removeIndex, \"index\", 1, 1),\n            moveIndex = Table.ReorderColumns(addIndex, List.Distinct(List.InsertRange(Table.ColumnNames(addIndex), 0, {\"index\"})))\n        in\n            moveIndex\nin\n    reindex\n</code></pre>\n\n<p>My output table contains more rows than yours. Also, the value in column <code>valueA</code>, row 11 is <code>1415</code> for me (it is <code>1234</code> in your request output). Not sure if this is a mistake in your example, or if I'm missing some logic.</p>\n"}], "owner": {"reputation": 1, "user_id": 10762035, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C_rzWr1jV78/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iIUh-NoDy3-BjKtYXEugujBIJfSQ/mo/photo.jpg?sz=128", "display_name": "Arpit Vijay", "link": "https://stackoverflow.com/users/10762035/arpit-vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1545683804, "creation_date": 1545676279, "last_edit_date": 1545677133, "question_id": 53916738, "link": "https://stackoverflow.com/questions/53916738/cleaning-excel-table-using-vba-without-impacting-the-entire-table-and-formatting", "title": "Cleaning Excel Table using VBA without impacting the entire table and formatting", "body": "<p>Hi I am trying to change to write VBA for excel to clean up data elements that has extra information without impacting the other elements.</p>\n\n<p>I am writing VBA for the first time my table is in the middle of the sheet.</p>\n\n<p>Given Table and Requested Output.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kVYDn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVYDn.png\" alt=\"Given Table and Requested Output.\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 734, "user_id": 1114105, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/13afb6aa9cb7529e42065d49e53a477a?s=128&d=identicon&r=PG", "display_name": "user1114", "link": "https://stackoverflow.com/users/1114105/user1114"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1545674006, "post_id": 53916346, "comment_id": 94675623, "body": "Looking to understand this better. Is this a known bug in Excel? Is this something in my environment? Is this expected behavior? And if so, what&#39;s the rationale, and is there a workaround so variables are not converted to doubles?"}, {"owner": {"reputation": 734, "user_id": 1114105, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/13afb6aa9cb7529e42065d49e53a477a?s=128&d=identicon&r=PG", "display_name": "user1114", "link": "https://stackoverflow.com/users/1114105/user1114"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1545674248, "post_id": 53916346, "comment_id": 94675689, "body": "Why does this happen? Is there a workaround so variables are not converted to doubles?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1545674525, "post_id": 53916346, "comment_id": 94675755, "body": "I don&#39;t think you can return a <code>vbLong</code> from a cell on a worksheet - how would Excel store a long in a cell? It has to be stored a double, no?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1545674822, "post_id": 53916346, "comment_id": 94675820, "body": "I think what you are looking for, (although I&#39;m guessing) is a way to understand the underlying types of data in a cell. I think maybe what you are looking for is:  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlrangevaluedatatype\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a> <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Value(12)</code>. This will return the XML of the field, which will contain the underlying type Excel thinks the cell is."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 2, "creation_date": 1545675550, "post_id": 53916346, "comment_id": 94676011, "body": "If you have to check the type of a value you\u2019re setting via code, then check the code variable type itself. If you have to check the type of a value already in a cell, you want to use some numeric check like \u201cCInt(cell.Value) = cell.Value\u201d and handle the approximation"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 2, "creation_date": 1545678215, "post_id": 53916346, "comment_id": 94676655, "body": "It&#39;s because for Excel all values are double. You can test it with <code>MsgBox TypeName(ActiveCell.Value)</code> - and you will always get <code>Double</code>."}], "owner": {"reputation": 734, "user_id": 1114105, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/13afb6aa9cb7529e42065d49e53a477a?s=128&d=identicon&r=PG", "display_name": "user1114", "link": "https://stackoverflow.com/users/1114105/user1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545677283, "creation_date": 1545673285, "last_edit_date": 1545677283, "question_id": 53916346, "link": "https://stackoverflow.com/questions/53916346/excel-converting-all-numeric-values-in-worksheets-to-doubles", "title": "Excel converting all numeric values in Worksheets to Doubles", "body": "<p>I'm testing the output of a VBA program in Excel, and to my surprise it seems like all numeric outputs on the worksheet are converted to vartype 5 (Double). I've reproduced this in different worksheets and workbooks.</p>\n\n<p>Part of the vba code assigns a long variable to the value of a cell</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").value = longVar\n</code></pre>\n\n<p>Although longVar is declared as a Long, varType(ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").value) yields 5 which is the vbDouble type.</p>\n\n<p>Why does this happen? Is there a workaround so variables are not converted to doubles?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545671486, "post_id": 53915492, "comment_id": 94675038, "body": "You have two worksheets: Sheet1 and 1. In Sheet1&#39;s cell C11 you have the criteria which you want to check against the values in 1&#39;s A column and write A-F to Sheet1. In what range or worksheet will you put the A-F data for the cell C11 not to be overwritten? Use short W1 and W2 if you&#39;re introducing another worksheet or specify the target range."}, {"owner": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545671794, "post_id": 53915492, "comment_id": 94675114, "body": "Hey thanks for your reply. I need the value from A to F to be copied to Sheet1 B14 to G513 (assuming there are max 500 rows to be copied)"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545671889, "post_id": 53915492, "comment_id": 94675139, "body": "Will have a solution shortly."}, {"owner": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545673239, "post_id": 53915492, "comment_id": 94675434, "body": "Thanks much! Looking forward to solve this."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "edited": false, "score": 0, "creation_date": 1545668504, "post_id": 53915567, "comment_id": 94674372, "body": "Thank you very much for your quick response. Based on your feedback, I edited my code as below.      Set targetSheet = targetWorkbook.Worksheets(&quot;Sheet1&quot;)     Dim sourceSheet As Worksheet     Set sourceSheet = customerWorkbook.Worksheets(1)      If targetSheet.Range(&quot;C11&quot;).Value = sourceSheet.Range(&quot;A:A&quot;) Then     targetSheet.Range(&quot;B14&quot;, &quot;G500&quot;).Value = sourceSheet.Range(&quot;A2&quot;,      &quot;G500&quot;).Value      Else      Exit Sub      End If  However, I get an error for this line &quot;If targetSheet.Range(&quot;C11&quot;).Value = sourceSheet.Range(&quot;A:A&quot;) Then&quot;. Can you help me with whats going wrong?"}, {"owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "reply_to_user": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "edited": false, "score": 0, "creation_date": 1545669232, "post_id": 53915567, "comment_id": 94674535, "body": "Ive made a slight adjustment as this way would work for a specific set of cells for example If (&quot;A1) then or A2 etc, if you want it to loop through the entire column then you are going to need a for loop"}, {"owner": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "edited": false, "score": 0, "creation_date": 1545669779, "post_id": 53915567, "comment_id": 94674646, "body": "Not sure if this is the reason my code is wrong (I am not very fluent with VBA so pardon me, I am trying!) - I see that you are using customersheet.range and targetsheet.range. Shouldn&#39;t this be targetsheet.range (&quot;C11&quot;).value = sourcesheet.range (&quot;A:A).value? I have defined targetsheet as my main workbook that contain the unique ID in cell C11 and the sourcesheet is workbook 2 that contains the the unique ID in column A."}], "tags": [], "owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "is_accepted": false, "score": 0, "last_activity_date": 1545669166, "last_edit_date": 1545669166, "creation_date": 1545667789, "answer_id": 53915567, "question_id": 53915492, "link": "https://stackoverflow.com/questions/53915492/copy-values-to-workbook-1-main-workbook-from-workbook-2-when-a-cell-value-in-w/53915567#53915567", "title": "Copy values to Workbook 1 (Main Workbook) from Workbook 2 when a cell value in Workbook 1 matches to column value in Workbook 2", "body": "<p>You're going to want to add an If statement at the end. I havent tested this, but it should give you an idea of how to get this working.</p>\n\n<pre><code>'Your need to change this to what you need\nDim CustomerSheet = Customerworkbook.Worksheets(\"Sheet1\")\n\nIf Customersheet.range(\"C11\").value = targetSheet.range(\"A1\").value then\n    targetSheet.Range(\"B14\", \"G500\").Value = sourceSheet.Range(\"A2\", \"G500\").Value\nElse\n    Exit Sub\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "edited": false, "score": 0, "creation_date": 1545675440, "post_id": 53916502, "comment_id": 94675986, "body": "Worked perfectly fine! Thanks a ton! I am going to work by myself to see if I can tweak this code to copy based on multiple criteria! Very interesting! Thank you once again!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1545674578, "creation_date": 1545674578, "answer_id": 53916502, "question_id": 53915492, "link": "https://stackoverflow.com/questions/53915492/copy-values-to-workbook-1-main-workbook-from-workbook-2-when-a-cell-value-in-w/53916502#53916502", "title": "Copy values to Workbook 1 (Main Workbook) from Workbook 2 when a cell value in Workbook 1 matches to column value in Workbook 2", "body": "<h1>Who Is Who, What Is What</h1>\n\n<p>In this workbook check cell C11 against the values in source workbook's A column. When found, copy the range of the row and 6 contiguous columns (A-F) to this workbook starting from B14 (B-G). Do all of this until the last row of data in source workbook is reached.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Const filter As String = \"Text files (*.xls*),*.xls*\"\n  Const caption As String = \"Please Select the Tiger Calendar file\"\n\n  Const wsTarget As Variant = \"Sheet1\"  ' Target Worksheet Name/Index\n  Const cTgtFirst As String = \"B14\"     ' Target First Cell Range\n  Const cTgtSearch As String = \"C11\"    ' Target Search Value Cell Range\n  Const wsSource As Variant = 1         ' Source Worksheet Name/Index\n  Const cSrcFirst As Long = 2           ' Source First Row\n  Const cSrcFirstCol As Variant = \"A\"   ' Source First Column Letter/Number\n  Const cColumns As Integer = 6         ' Number of Columns\n\n  Dim customerFilename As String\n  Dim sourceSheet As Worksheet\n  Dim i As Long\n  Dim rngTarget As Range\n\n  customerFilename = Application.GetOpenFilename(filter, , caption)\n\n  Set sourceSheet = Workbooks.Open(customerFilename).Worksheets(wsSource)\n\n  With sourceSheet\n    Set rngTarget = ThisWorkbook.Worksheets(wsTarget).Range(cTgtFirst)\n    For i = cSrcFirst To .Cells(.Rows.Count, cSrcFirstCol).End(xlUp).Row\n      If .Cells(i, cSrcFirstCol) = rngTarget.Parent.Range(cTgtSearch) Then\n        .Cells(i, cSrcFirstCol).Resize(, cColumns).Copy _\n            rngTarget.Resize(, cColumns)\n        Set rngTarget = rngTarget.Offset(1, 0)\n      End If\n    Next\n  End With\n\n  sourceSheet.Parent.Close False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10348798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d421b53748cab244c8e60095fc8ad967?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/10348798/santhosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53916502, "answer_count": 2, "score": 2, "last_activity_date": 1545674578, "creation_date": 1545667150, "question_id": 53915492, "link": "https://stackoverflow.com/questions/53915492/copy-values-to-workbook-1-main-workbook-from-workbook-2-when-a-cell-value-in-w", "title": "Copy values to Workbook 1 (Main Workbook) from Workbook 2 when a cell value in Workbook 1 matches to column value in Workbook 2", "body": "<p>I am working on a code to copy data to Workbook 1 (Main Workbook) from Workbook 2 based on a criteria.</p>\n\n<p>The criteria is - If the value of cell C11 in Workbook 1 (Main Workbook) is equal to column A of Workbook 2, then copy all the data from Workbook 2 columns A to F to Workbook 1 (Main Workbook). Please note that there could be multiple matching values (in Workbook 2) that may need to be copied to Workbook 1.</p>\n\n<p>I have tried the below code that pull all the data perfectly. Now I am trying to see if there is a code which can be applied to copy data based on criteria.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n' Get Tiger calendar workbook...\nDim customerBook As Workbook\nDim filter As String\nDim caption As String\nDim customerFilename As String\nDim customerWorkbook As Workbook\nDim targetWorkbook As Workbook\n\n' make weak assumption that active workbook is the target\nSet targetWorkbook = Application.ActiveWorkbook\n\n' get the Tiger calendar workbook\nfilter = \"Text files (*.xlsx),*.xlsx\"\ncaption = \"Please Select the Tiger Calendar file\"\ncustomerFilename = Application.GetOpenFilename(filter, , caption)\n\nSet customerWorkbook = Application.Workbooks.Open(customerFilename)\n\n' assume range is A1 - M10000 in sheet1\n' copy data from Tiger calendar to target workbook\nDim targetSheet As Worksheet\nSet targetSheet = targetWorkbook.Worksheets(\"Sheet1\")\nDim sourceSheet As Worksheet\nSet sourceSheet = customerWorkbook.Worksheets(1)\n\ntargetSheet.Range(\"B14\", \"G500\").Value = sourceSheet.Range(\"A2\", \"G500\").Value\n\n' Close customer workbook\ncustomerWorkbook.Close\n\nEnd Sub\n</code></pre>\n\n<p>For example, if Cell C11 in Workbook 1 = 1232223 (Product ID), then the data copied should be all the sales details related to the product ID. The bulk data is available in Workbook 2.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 10829193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIZ1aD5vQgk/AAAAAAAAAAI/AAAAAAAABZI/J2iqCeVC_Ms/photo.jpg?sz=128", "display_name": "Hossam Azab", "link": "https://stackoverflow.com/users/10829193/hossam-azab"}, "is_accepted": false, "score": 0, "last_activity_date": 1545725915, "creation_date": 1545725915, "answer_id": 53920569, "question_id": 53914091, "link": "https://stackoverflow.com/questions/53914091/how-to-repeat-title-rows-from-page-2-when-printing/53920569#53920569", "title": "How to repeat title rows from page 2 when printing", "body": "<p>the answer is very easy but didn't see it clearly \nit will be a slight change into code \ni have already these rows repeated all over the file so i will fix just three rows\nthe code will print the first page without any repeated rows as headers\nand then will print from page 2 to last page with those fixed rows then remove them again from headers</p>\n\n<pre><code>Sub printonlyselection()\n Dim lPages As Long\n lPages = Application.ExecuteExcel4Macro(\"GET.DOCUMENT(50)\")\n   With ActiveSheet.PageSetup\n    Selection.PrintOut From:=1, To:=1\n    .PrintTitleRows = \"$5:$7\"\n    Selection.PrintOut From:=2, To:=lPages\n    .PrintTitleRows = \"\"\n   End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 54, "user_id": 10829193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CIZ1aD5vQgk/AAAAAAAAAAI/AAAAAAAABZI/J2iqCeVC_Ms/photo.jpg?sz=128", "display_name": "Hossam Azab", "link": "https://stackoverflow.com/users/10829193/hossam-azab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578486128, "creation_date": 1545658099, "last_edit_date": 1578486128, "question_id": 53914091, "link": "https://stackoverflow.com/questions/53914091/how-to-repeat-title-rows-from-page-2-when-printing", "title": "How to repeat title rows from page 2 when printing", "body": "<p>I have a lot of data that i want to print.\nI want to repeat some rows as title rows but do not want it to appear in first page.</p>\n\n<p>Title rows will be always from the fifth row to the seventh row of my selection not the page.</p>\n\n<p>So I tried this code and did not succeed.</p>\n\n<pre><code>Sub printonlyselection()\n    Dim lPages As Long\n    lPages = Application.ExecuteExcel4Macro(\"GET.DOCUMENT(50)\")\n    With ActiveSheet.PageSetup\n        Selection.PrintOut From:=1, To:=1\n        .PrintTitleRows = Selection.Rows(\"5:7\")\n        Selection.PrintOut From:=2, To:=lPages\n        .PrintTitleRows = \"\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Any help will appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545666779, "post_id": 53913502, "comment_id": 94673859, "body": "The code in the link does already check text boxes. Text boxes belong to the <code>Shapes</code> collection, so <code>For Each oShp In rngStory.ShapeRange</code> covers it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545666787, "post_id": 53913502, "comment_id": 94673861, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33733113/macro-to-update-all-fields-in-a-word-document\">Macro to update all fields in a word document</a>"}, {"owner": {"reputation": 13, "user_id": 10828147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171fabfa519c864c050b8406eda2c5f5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Semenov", "link": "https://stackoverflow.com/users/10828147/alexander-semenov"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545732274, "post_id": 53913502, "comment_id": 94684591, "body": "Thank you a lot for the answers, but this macro doesn&#39;t work for my problem. I attached a link to the test document."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10828147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171fabfa519c864c050b8406eda2c5f5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Semenov", "link": "https://stackoverflow.com/users/10828147/alexander-semenov"}, "edited": false, "score": 0, "creation_date": 1545728967, "post_id": 53917891, "comment_id": 94683905, "body": "Thank you a lot! This code really works. I tried to apply switching to Print Preview and come back, but it din&#39;t help me because I didn&#39;t use the line <code>.Fields.Update</code>."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1545687892, "creation_date": 1545687892, "answer_id": 53917891, "question_id": 53913502, "link": "https://stackoverflow.com/questions/53913502/macro-to-update-fields-in-shapes-textboxes-in-footer-in-microsoft-word/53917891#53917891", "title": "Macro to update fields in shapes (textboxes) in footer in Microsoft Word", "body": "<p>You might try:</p>\n\n<pre><code>Sub UpdateFields()\nApplication.ScreenUpdating = False\nWith ActiveDocument\n  .Fields.Update\n  .PrintPreview\n  .ClosePrintPreview\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>As for the textboxes, you can replace them with single-cell tables, with wrapping if necessary. Unlike textboxes, the content even of wrapped tables remains associated with the underlying text layer.</p>\n"}], "owner": {"reputation": 13, "user_id": 10828147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/171fabfa519c864c050b8406eda2c5f5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Semenov", "link": "https://stackoverflow.com/users/10828147/alexander-semenov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 53917891, "answer_count": 1, "score": 0, "last_activity_date": 1545732119, "creation_date": 1545654679, "last_edit_date": 1545732119, "question_id": 53913502, "link": "https://stackoverflow.com/questions/53913502/macro-to-update-fields-in-shapes-textboxes-in-footer-in-microsoft-word", "title": "Macro to update fields in shapes (textboxes) in footer in Microsoft Word", "body": "<p>There are excellent macros to update all fields in Microsoft Word documents (including headers and footers).\nJust like this one:\n<a href=\"https://stackoverflow.com/questions/33733113/macro-to-update-all-fields-in-a-word-document\">Macro to update all fields in a word document</a></p>\n\n<p>But what if headers and footers contain text boxes with fields? Sure, it would be better to not have any textbox there, but what if there is no other solution?</p>\n\n<p>For instance, it could be applied to a problem like that:</p>\n\n<p>We should make a text document template with standard form like this one:\n<a href=\"https://i.stack.imgur.com/WhUsL.jpg\" rel=\"nofollow noreferrer\">GOST standard form for text documents</a>\nEvery sheet contains a frame with a bottom table and a left-side table with some fields, like a document number, revisions, etc.</p>\n\n<p>As for me, the better way to do it is to use references to Custom Document Properties in fields placed in a footer. But there should be tables which take a lot of space shrinking the main text area. To prevent this, we could move these tables into a large text box on a different layer. The only problem is how to update fields in this text box...</p>\n\n<p>It could be achieved following these steps:</p>\n\n<pre><code>Get Active Document\nIterate through Footers in Active Document\n  Iterate through Shapes in Footers in Active Document\n    If the Shape has Text then\n      Update Fields in the Shape\n    End IF\n  Next\nNext\n</code></pre>\n\n<p>So, the way to the object is:\nActiveDocument -> Footer -> TextBox -> Field</p>\n\n<p>The problem is how to go there. Microsoft Word-VB reference says nothing about the situations like that.    </p>\n\n<p>Test document:\n<a href=\"https://drive.google.com/file/d/11Ekrv_jz8F2cjJKZpnWhYd_rYVu_y9Ay/view?usp=sharing\" rel=\"nofollow noreferrer\">Test MS-Word document with fields in a footer</a>  </p>\n\n<p>Document has 4 custom properties to change:</p>\n\n<ul>\n<li>Document Number</li>\n<li>Document Name</li>\n<li>Product Type</li>\n<li>Parent Number  </li>\n</ul>\n"}, {"tags": ["vba", "logic"], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1545654250, "creation_date": 1545654250, "answer_id": 53913433, "question_id": 53913217, "link": "https://stackoverflow.com/questions/53913217/trouble-with-coding-a-logical-test-in-vba/53913433#53913433", "title": "Trouble with coding a logical test in VBA", "body": "<p>The \u201cOr\u201d clause works differently, here the relevant snippet:</p>\n\n<pre><code>If Application.CountIf(Range(\"C\" &amp; a).Resize(, 6), 0.7) + Application.CountIf(Range(\"C\" &amp; a).Resize(, 6), 0.8) &gt; 0 Then\n    If (Cells(a, b) = 0.7 Or Cells(a, b) = 0.8)  And (Cells(a, (b - 1)) = 0.9 Or Cells(a, (b - 1)) = 1) Then\n        If Msg = \"\" Then\n            Msg = Cells(24, b)\n        Else\n            Msg = Msg &amp; \", \" &amp; Cells(24, b)\n        End If\n    End If\nNext b\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10828890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878798e8018c4804d7a72c97b1452607?s=128&d=identicon&r=PG&f=1", "display_name": "Ewen999", "link": "https://stackoverflow.com/users/10828890/ewen999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545665538, "creation_date": 1545653103, "last_edit_date": 1545665538, "question_id": 53913217, "link": "https://stackoverflow.com/questions/53913217/trouble-with-coding-a-logical-test-in-vba", "title": "Trouble with coding a logical test in VBA", "body": "<p>I'm creating an improved schedule for my workplace, trying to implement macros to error check data that is input manually.</p>\n\n<p>I've got one code that works as expected, but when I've changed the logical test, it ceases to work.</p>\n\n<p>I'm not skilled in VBA coding myself, so I'm looking for some assistance.</p>\n\n<pre><code>Sub ErrorMsg2()\n  Dim a As Long, b As Long\n  Dim Msg As String\n\n  For a = 28 To 44 Step 4\n       For b = 4 To 8\n        If Application.CountIf(Range(\"C\" &amp; a).Resize(, 6), \"(=0.7 or =0.8)\") Then\n              If Cells(a, b) = (0.7 Or 0.8) And Cells(a, (b - 1)) = (0.9 Or 1) Then\n                 If Msg = \"\" Then Msg = Cells(24, b) Else Msg = Msg &amp; \", \" &amp; Cells(24, b)\n              End If\n           End If\n           Next b\n           MsgBox Range(\"A\" &amp; a) &amp; \" Has been scheduled a night shift followed by a day shift on \" &amp; Msg &amp; vbNewLine &amp; \"Please Rectify.\" &amp; vbNewLine &amp; _\n          \"Press OK to acknowledge.\", vbExclamation + vbOKOnly, \"Error\"\n       Msg = \"\"\n  Next a\nEnd Sub\n</code></pre>\n\n<p>For example if cell D28 = 0.8 and cell C28 = 1, the message box should appear.</p>\n\n<p>However the message box is appearing when b = 9.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1545653069, "post_id": 53913007, "comment_id": 94669879, "body": "So if the data contains 1/1/2017 you want to keep it, but delete 31/12/2018?"}, {"owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1545654903, "post_id": 53913007, "comment_id": 94670399, "body": "What I want is any date which is before 01/01/2018 to be removed, however I don&#39;t want it to look at the year as that of course is going to change. It should only be the month before in the data so if January remove December, if February remove January dates etc"}], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "edited": false, "score": 0, "creation_date": 1545655446, "post_id": 53913551, "comment_id": 94670568, "body": "Perfect, I knew it would be simple, Just couldn&#39;t see it."}], "tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": true, "score": 1, "last_activity_date": 1545654912, "creation_date": 1545654912, "answer_id": 53913551, "question_id": 53913007, "link": "https://stackoverflow.com/questions/53913007/deleting-rows-which-contain-a-day-and-month-but-ignore-year/53913551#53913551", "title": "Deleting rows which contain a day and month but ignore year", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/day-function\" rel=\"nofollow noreferrer\">Day</a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/month-function\" rel=\"nofollow noreferrer\">Month</a> functions to test e.g. to remove before 10th April:</p>\n\n<pre><code>If Day(Iws.Cells(Delete, 6)) &lt; 10 And Month(Iws.Cells(Delete, 6)) &lt; 4 Then Iws.Rows(Delete).EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53913551, "answer_count": 1, "score": 0, "last_activity_date": 1578543991, "creation_date": 1545651911, "last_edit_date": 1578543991, "question_id": 53913007, "link": "https://stackoverflow.com/questions/53913007/deleting-rows-which-contain-a-day-and-month-but-ignore-year", "title": "Deleting rows which contain a day and month but ignore year", "body": "<p>I want to remove rows which are anything before the start of a certain month, so for example anything before the 1st of January needs removing from downloaded SAP data. I was just writing up the code when I thought what about different years?</p>\n\n<p>How do I set it to remove anything less than 01/01 rather then 01/01/2018?</p>\n\n<pre><code>Sub Filtration()\nDim Wb As Workbook\nDim Front As Worksheet\nDim Iws As Worksheet\nDim Ows As Worksheet\nDim x As Long\nDim Delete As Long\nDim L As String\nDim Answer As Integer\nDim Month As String\n\nSet Wb = ThisWorkbook\nSet Front = Wb.Worksheets(\"Front\")\nSet Iws = Wb.Worksheets(\"Input\")\nSet Ows = Wb.Worksheets(\"Output\")\n\nIws.Columns(\"F\").Replace What:=\".\", Replacement:=\"/\", SearchOrder:=xlByColumns, MatchCase:=True\n\nFor Delete = Iws.Cells(Rows.Count, 6).End(xlUp).Row To 3 Step -1\n\nWith Iws.Cells(Delete, 6)\n        If Month = \"January\" Then\n        L = Left(Iws.Cells(Delete, 6), 5)\n           If L &lt; \"01/01\" Then Rows(Delete).EntireRow.Delete\n        End If\n End With\nNext Delete     \n</code></pre>\n\n<p>the above I know is not working, but it hopefully will show you what I am looking to achieve, where the code looks through each row finds that there is a date for lets say 31/12 and remove that row.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545661077, "post_id": 53912637, "comment_id": 94672256, "body": "Also those two do not work:    1. For Each Sl In pp.Slides  Sl.Charts.Count Next Sl    2. For Each Sl In pp.Slides  Sl.Shapes.Count Next Sl"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545664715, "post_id": 53912637, "comment_id": 94673325, "body": "Please take a moment to read in the site&#39;s <a href=\"https://stackoverflow.com/help\">help center</a> about asking questions on Stack Overflow. Notice that a question should cover only <b>one</b> query, not multiple topics. For one thing, the site&#39;s goal is a Q&amp;A repository: people should be able to identify whether or not a topic is relevant to their problem based on the title and a bit of text. Also, no single person may know the answer to multiple questions. Since you&#39;re supposed to mark <i>one</i> answer as &quot;the&quot; answer, that makes it difficult - another reason the site does not allow &quot;broad&quot; questions."}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545665537, "post_id": 53912637, "comment_id": 94673523, "body": "Thanks Cindy, was not aware of this. How were you able to post the code correctly? I tried it 1000x times and each time some of the code was outside the grey area :/"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1545665982, "post_id": 53912637, "comment_id": 94673624, "body": "It&#39;s a problem with the combination bullets/numbering and code blocks. You need a &quot;paragraph&quot; of text with  no bullet/number in order for the code block to work correctly. I grind my teeth every time I run into it... &lt;sigh&gt; IN this case, it wasn&#39;t a problem because I wanted to make it not so obvious that your question covers two topics..."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1545665875, "creation_date": 1545665875, "answer_id": 53915302, "question_id": 53912637, "link": "https://stackoverflow.com/questions/53912637/difference-between-oleobjects-and-chart/53915302#53915302", "title": "Difference between OLEObjects and chart", "body": "<p>In earlier versions of Microsoft Office (2007 and earlier) charts were, indeed, OLE objects, based on the Excel charting engine. A reference to the Excel object model was required in order to work with early binding.</p>\n\n<p>Starting in Office 2010, with the introduction of new charting and graphics engines in the Microsoft Office suite, working with charts changed significantly. Among other things, the chart object model was \"imported\" into the various Office applications' object models, making a reference to an external library no longer necessary in order to work with charting functionality. The Office application object models now also have a <code>Chart</code> object.</p>\n\n<p>All this is the case, even though creation and manipulation of charts is still done via the Excel application interface. (Indeed, it's not (no longer) possible to <em>hide</em> the Excel application when automating a chart.)</p>\n\n<p>So, as far as the Office applications are concerned, Excel charts are now (for 8+ years) \"native\" parts of their object models and are no longer OLE objects.</p>\n\n<pre><code>sh.OLEFormat.Object.Count\n</code></pre>\n\n<p>returns an error because a single object does not have a <code>Count</code> property. The code is not querying <code>Count</code> on a collection of <code>Shapes</code>, only on the single <code>Shape</code> object. You'd need a variable to add up the number of times the loop encounters a <code>msoLinkedOLEObject</code> (something like <code>i = i + 1</code>). </p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545678752, "post_id": 53915905, "comment_id": 94676771, "body": "@Cindy Meister: You are absolute machine, or rather master (Meister is German for Master, but you probably already new that :D)   Thanks so much! The backround information you gave me is so impressive!  My own lack of knowledge leads me to some follow-up questions, though. I hope that is fine, but of course I don&#39;t expect to answer everything, since you already took so much time to answer me comprehensivley.  anyways here some questions regarding your answer:  1.In Case a chart is an OLE, does that mean, that the chart contains an OLE, or that it is an Object type of its own?"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545679042, "post_id": 53915905, "comment_id": 94676845, "body": "2. What do you refer to, when you say &quot;external&quot; library? 3. Regarding the error: The first part I understood, but why does the   For Each Sl In pp.Slides Sl.Charts.Count Next Sl   not work? I am not referring to the number of charts in each slide?  4. Since I am new here: Is it possible to &quot;upvote&quot; your post or something like that?  5. Do you give tutoring / private courses in VBA? I would defintely book a session :)  Kind regards Michael"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545679081, "post_id": 53915905, "comment_id": 94676854, "body": "Also how can I add paragraphs in the comments? It is so bad to read like this, sry"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545679139, "post_id": 53915905, "comment_id": 94676869, "body": "Steven: Thanks also I have to check out the code first. But I think I also have one follow-up question, if that is alright"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545755763, "post_id": 53915905, "comment_id": 94689702, "body": "@Underhook32 Follow-up questions are fine. And to upvote Cindy&#39;s post, click the little upward pointing triangle next to it (though depending on your reputation, this might or might not appear ... I don&#39;t really know). Paragraphs in comments: I don&#39;t believe it&#39;s possible."}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545814887, "post_id": 53915905, "comment_id": 94700189, "body": "@ Steve: Thanks for replying! I upvoted the comments of the both of you!  The follow-up questions for you would be: You wrote: &quot;[...] pointed out, the charts might be &quot;PowerPoint-native&quot; charts (type msoChart) with no connection to Excel.&quot;     Here is the thing that confuses me. The chart I am talking about DOES have a connection to Excel (by which I mean, that chart depends on data input in Excel) and is addressed with &quot;msochart&quot;. So we are not talking about the same thing or on other words, that chart would not be &quot;Power-Point native&quot; but is also not an OLEObject?  Kind regards Mike"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1545843403, "post_id": 53915905, "comment_id": 94709813, "body": "@Underhook32 If in doubt, check the .Type property of the selected shape. If it&#39;s 3, then it&#39;s a native PPT chart. If 7, it&#39;s an Embedded OLE object, if 10, a Linked OLE object"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1545670306, "creation_date": 1545670306, "answer_id": 53915905, "question_id": 53912637, "link": "https://stackoverflow.com/questions/53912637/difference-between-oleobjects-and-chart/53915905#53915905", "title": "Difference between OLEObjects and chart", "body": "<pre><code>Dim x as Long \nDim y as Long\nFor Each Sl In pp.Slides\n    For Each sh In Sl.Shapes\n        If sh.Type = msoLinkedOLEObject Then\n           x = x + 1\n        End If\n     Next sh\n     ' Show how many OLE objects on this slide\n     MsgBox Cstr(x) &amp; \" OLE objects on Slide \" &amp; Cstr(Sl.SlideIndex)\n     y = y + x\n Next Sl\n ' Show total OLE objects in presentation\n MsgBox Cstr(y) &amp; \" OLE objects in presentation\"\n</code></pre>\n\n<p>If you want to count <em>embedded</em> (type msoEmbeddedOLEObject) as well as linked charts, you'll need to adjust the code. And as Cindy has pointed out, the charts might be \"PowerPoint-native\" charts (type msoChart) with no connection to Excel.</p>\n"}], "owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545670306, "creation_date": 1545649693, "last_edit_date": 1545664876, "question_id": 53912637, "link": "https://stackoverflow.com/questions/53912637/difference-between-oleobjects-and-chart", "title": "Difference between OLEObjects and chart", "body": "<p>What is the difference between a chart that is linked to Excel and an OLEObject? I thought OLE = Object linking and embedding. My chart (which I thought is an object) is linked, so how is it not an OLEObject? In PPT one is labelled as a chart and the other (OLEObject) as an Object. I am confused.</p>\n\n<p>Also, the line <code>MsgBox sh.OLEFormat.Object.Count</code> results in </p>\n\n<blockquote>\n  <p>error 430</p>\n</blockquote>\n\n<p>instead of returning the number of OLEObjects in my PPT Presentation. Why</p>\n\n<pre><code> For Each Sl In pp.Slides\n    For Each sh In Sl.Shapes\n        If sh.Type = msoLinkedOLEObject Then\n           MsgBox sh.OLEFormat.Object.Count\n        End If\n     Next sh\n Next Sl\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium-webdriver", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1545647003, "post_id": 53911876, "comment_id": 94668040, "body": "Usual question.... is there an url associated with the download?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545648105, "post_id": 53911876, "comment_id": 94668382, "body": "Thanks a lot for reply. I have attached the html part. I think it is java script too"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1545652195, "post_id": 53911876, "comment_id": 94669621, "body": "Can you share the url @YasserKhalil? I think there is a way to download and save those files in desktop without even knowing the exact address of the path."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545679325, "post_id": 53912638, "comment_id": 94676914, "body": "more robust would be to see if you can grab the file name from the html and use that when you do the MoveFile at the end. Is the filename of the download present in the html?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545700799, "post_id": 53912638, "comment_id": 94680125, "body": "As for this line <code>Application.Wait Now + TimeSerial(0, 0, 5)</code>, I think it is to wait till the file is downloaded completely .. Is there another approach to check for the completeness of the downloading process then to resume the code?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545727020, "post_id": 53912638, "comment_id": 94683529, "body": "You could loop the download folder looking for a change in file count"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545728585, "post_id": 53912638, "comment_id": 94683823, "body": "Thanks a lot. I already worked on that idea. Thank you very much"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545728923, "post_id": 53912638, "comment_id": 94683891, "body": "yeah I have just seen your posted question. As usual, remember to include  timed loop (probably time to convert that loop into a function returning a boolean, or just a separate timer sub) to prevent possible infinite loop. Consider any error handling for file locking as downloading to a folder at the same time monitoring it can have some unexpected consequences. Partly why I had to abandon my original answer using command line."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1545662363, "last_edit_date": 1545662363, "creation_date": 1545649703, "answer_id": 53912638, "question_id": 53911876, "link": "https://stackoverflow.com/questions/53911876/download-file-to-specific-directory-using-selenium/53912638#53912638", "title": "Download file to specific directory using selenium", "body": "<p>You specify the default download at the start with <code>SetPreference</code>. You could then rename the file by finding the latest modified file in that folder (in this case I use file system object with .csv mask)</p>\n\n<p>If you have an actual URL for download then use <a href=\"https://stackoverflow.com/a/52245239/6241235\">URLMon or binary download</a>.</p>\n\n<pre><code>Option Explicit\nPublic Sub SpecifyDownloadFolder()\n    Dim d As WebDriver, filename As String, myFolder As Object\n    Const URL = \"https://www.stats.govt.nz/large-datasets/csv-files-for-download/\"\n    Const DOWNLOAD_DIRECTORY As String = \"C:\\Users\\User\\Downloads\"\n    Const FILE_NAME As String = \"myNewCsv.csv\"\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")   \n    Set d = New ChromeDriver\n    With d\n        .SetPreference \"download.default_directory\", DOWNLOAD_DIRECTORY\n        .SetPreference \"download.directory_upgrade\", True 'safeguard\n        .SetPreference \"download.prompt_for_download\", False 'safeguard\n        .get URL\n        .FindElementByCss(\"h3 [download]\").Click\n        Application.Wait Now + TimeSerial(0, 0, 5)\n        d.Quit\n    End With\n\n    Set myFolder = fso.GetFolder(DOWNLOAD_DIRECTORY)\n\n    Dim objFile As Object, dteFile As Date\n\n    dteFile = DateSerial(1900, 1, 1)\n    For Each objFile In myFolder.Files\n        If objFile.DateLastModified &gt; dteFile And fso.GetExtensionName(objFile.Path) = \"csv\" Then\n            dteFile = objFile.DateLastModified\n            filename = objFile.NAME\n        End If\n    Next objFile\n    If filename &lt;&gt; vbNullString And Not fso.FileExists(DOWNLOAD_DIRECTORY &amp; \"\\\" &amp; FILE_NAME) Then\n       fso.MoveFile DOWNLOAD_DIRECTORY &amp; \"\\\" &amp; filename, DOWNLOAD_DIRECTORY &amp; \"\\\" &amp; FILE_NAME\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1380, "favorite_count": 0, "accepted_answer_id": 53912638, "answer_count": 1, "score": 2, "last_activity_date": 1545670727, "creation_date": 1545645562, "last_edit_date": 1545670727, "question_id": 53911876, "link": "https://stackoverflow.com/questions/53911876/download-file-to-specific-directory-using-selenium", "title": "Download file to specific directory using selenium", "body": "<p>I am scraping a website with credentials and I have to click an element (button) that exports a pdf file (not as save as window).</p>\n\n<p>The button directly exports the pdf file to <code>C:\\Users\\User\\Downloads</code>.</p>\n\n<p>How can I change the directory to the desktop instead?</p>\n\n<p>Also how to rename the file?</p>\n\n<p>The code used to click this button</p>\n\n<pre><code>On Error Resume Next\nDo While .FindElementByXPath(\"//*[@id='theBttnbobjid_1545645103945_dialog_submitBtn']\") Is Nothing\n    DoEvents\nLoop\nOn Error GoTo 0\n.FindElementByXPath(\"//*[@id='theBttnbobjid_1545645103945_dialog_submitBtn']\").Click\n</code></pre>\n\n<p>This is the html related to that button</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;tbody&gt;&lt;tr valign=\"middle\"&gt;&lt;td height=\"21\" width=\"5\" style=\"background-image:url('aspnet_client/system_web/4_0_30319/crystalreportviewers13/js/crviewer/../dhtmllib/images/skin_standard/button.gif');background-position:0px 0px;\"&gt;&lt;/td&gt;&lt;td id=\"theBttnCenterImgbobjid_1545648005071_dialog_submitBtn\" align=\"center\" class=\"wizbutton\" style=\"padding-left:3px;padding-right:3px;background-image:url('aspnet_client/system_web/4_0_30319/crystalreportviewers13/js/crviewer/../dhtmllib/images/skin_standard/button.gif');background-position:0px -42px;\"&gt;&lt;nobr&gt;&lt;a id=\"theBttnbobjid_1545648005071_dialog_submitBtn\" href=\"javascript:void(0)\" class=\"wizbutton\" role=\"button\"&gt;Export&lt;/a&gt;&lt;/nobr&gt;&lt;/td&gt;&lt;td height=\"21\" width=\"5\" style=\"background-image:url('aspnet_client/system_web/4_0_30319/crystalreportviewers13/js/crviewer/../dhtmllib/images/skin_standard/button.gif');background-position:0px -21px;\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba", "selenium-webdriver", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545645272, "post_id": 53911610, "comment_id": 94667495, "body": "Thanks a lot for great help. That worked better than mine"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1545656641, "post_id": 53911610, "comment_id": 94670927, "body": "why hello there! +"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1545644202, "creation_date": 1545644202, "answer_id": 53911610, "question_id": 53911498, "link": "https://stackoverflow.com/questions/53911498/wait-until-specific-elements-loaded/53911610#53911610", "title": "Wait until specific elements loaded", "body": "<p>You can try looping your elements until they become available.</p>\n\n<pre><code>On Error Resume Next\nDo While .FindElementById(\"theBttnbobjid_1545642213647_dialog_submitBtn\") Is Nothing\n    DoEvents\nLoop\nOn Error Goto 0\n</code></pre>\n\n<p>I would also consider adding a timer to your loop if for some reason the the webpage hangs - which if this is the case you could reload the webpage or perform some other error handling operation.</p>\n"}, {"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545656463, "post_id": 53913609, "comment_id": 94670870, "body": "Thanks a lot for help. I have noticed that this <code>#theBttnbobjid_1545642213647_dialog_submitBtn</code> is changeable. How can I deal with it in this case ..? I am dealing with many pages and each time has different selector !! that&#39;s too weird"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545656661, "post_id": 53913609, "comment_id": 94670930, "body": "Yes that is true ..I have inspected another page and this was the result <code>theBttnbobjid_1545656314367_dialog_submitBtn</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545656732, "post_id": 53913609, "comment_id": 94670946, "body": "I think so.. can it be implemented by partial text? But when searching for <code>dialog_submitBtn</code> I found three instances but the beginning is different in the three so can we rely on the start part too <code>theBttnbobjid</code>?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545657364, "post_id": 53913609, "comment_id": 94671156, "body": "I tried such a selector <code>theBttnbobjid_*_dialog_submitBtn</code> but doesn&#39;t select anything.. I see your edit but how to include the start part too?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545657445, "post_id": 53913609, "comment_id": 94671181, "body": "Ok It is there but this is for start only"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545657612, "post_id": 53913609, "comment_id": 94671243, "body": "I am sorry. I thought I have posted the html part but it seems I have posted in in another thread at this <a href=\"https://stackoverflow.com/questions/53911876/download-file-to-specific-directory-using-selenium-excel-vba?noredirect=1#comment94669621_53911876\">LINK</a> ... I have included the html part too here"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545658015, "post_id": 53913609, "comment_id": 94671363, "body": "I found two instances with that beginning .. so if possible I need a solution for start and end parts together ..so as to get just one instance"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545658415, "post_id": 53913609, "comment_id": 94671473, "body": "The second one .. is the target"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545658510, "post_id": 53913609, "comment_id": 94671502, "body": "Is it always the second one? If so you can use the method above but when you come to interact with the target use index .FindElementsByCss(&quot;[id^=&#39;theBttnbobjid&#39;]&quot;)(2) . I  think indices are 1 based in selenium otherwise use 1."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545658916, "post_id": 53913609, "comment_id": 94671625, "body": "Thank you very much for awesome help. You are a legend"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1545658890, "last_edit_date": 1545658890, "creation_date": 1545655290, "answer_id": 53913609, "question_id": 53911498, "link": "https://stackoverflow.com/questions/53911498/wait-until-specific-elements-loaded/53913609#53913609", "title": "Wait until specific elements loaded", "body": "<p>You can shorten this to </p>\n\n<pre><code>Do \nLoop While .FindElementsByCss(\"#theBttnbobjid_1545642213647_dialog_submitBtn\").Count = 0 \n</code></pre>\n\n<p>Though you should set a timeout</p>\n\n<pre><code>Const MAX_WAIT_SEC As Long = 10\nDim t \nt = Timer\nDo \n    If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\nLoop While .FindElementsByCss(\"#theBttnbobjid_1545642213647_dialog_submitBtn\").Count = 0 \n</code></pre>\n\n<p>There won't be an error and there is no need to yield control. If the item is not found the <code>.Count</code> will be zero.</p>\n\n<p>If the id is dynamic and you have a constant substring (which only occurs for one id attribute on the page (to be safe - may not be essential) you can use ^, *, $ operators in css). For example, if the start string is constant across pages change the css selector to</p>\n\n<pre><code>[id^='theBttnbobjid']\n</code></pre>\n\n<p>If occurs more than once, and the index is constant across pages then use the index to interact later e.g.</p>\n\n<pre><code>.FindElementsByCss(\"[id^='theBttnbobjid']\")(2)\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2010, "favorite_count": 0, "accepted_answer_id": 53913609, "answer_count": 2, "score": 3, "last_activity_date": 1545670809, "creation_date": 1545643471, "last_edit_date": 1545670809, "question_id": 53911498, "link": "https://stackoverflow.com/questions/53911498/wait-until-specific-elements-loaded", "title": "Wait until specific elements loaded", "body": "<p>I am trying to scrape a website and there are many elements I am dealing with. I need to wait for elements to be loaded.</p>\n\n<p>This is my try till now but I am waiting a long time and sometimes I get errors.</p>\n\n<pre><code>.FindElementById(\"ContentPlaceHolder1_Button1\").Click\n.Wait 2000\nGoBack1:\nSet elePrint = .FindElementById(\"IconImg_CrystalReportViewer1_toptoolbar_print\", timeout:=20000, Raise:=False)\nIf elePrint Is Nothing Then\n    Application.Wait Now() + TimeValue(\"00:00:01\"): GoTo GoBack1\nElse\n    elePrint.Click\nEnd If\nGoBack2:\nSet eleExport = .FindElementById(\"theBttnbobjid_1545642213647_dialog_submitBtn\", timeout:=20000, Raise:=False)\nIf eleExport Is Nothing Then\n    Application.Wait Now() + TimeValue(\"00:00:01\"): GoTo GoBack2\nElse\n    eleExport.Click\nEnd If\n</code></pre>\n\n<p>Is there a better way for doing this?</p>\n\n<p>This is the html part</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;tbody&gt;&lt;tr valign=\"middle\"&gt;&lt;td height=\"21\" width=\"5\" style=\"background-image:url('aspnet_client/system_web/4_0_30319/crystalreportviewers13/js/crviewer/../dhtmllib/images/skin_standard/button.gif');background-position:0px 0px;\"&gt;&lt;/td&gt;&lt;td id=\"theBttnCenterImgbobjid_1545656314367_dialog_submitBtn\" align=\"center\" class=\"wizbutton\" style=\"padding-left:3px;padding-right:3px;background-image:url('aspnet_client/system_web/4_0_30319/crystalreportviewers13/js/crviewer/../dhtmllib/images/skin_standard/button.gif');background-position:0px -42px;\"&gt;&lt;nobr&gt;&lt;a id=\"theBttnbobjid_1545656314367_dialog_submitBtn\" href=\"javascript:void(0)\" class=\"wizbutton\" role=\"button\"&gt;Export&lt;/a&gt;&lt;/nobr&gt;&lt;/td&gt;&lt;td height=\"21\" width=\"5\" style=\"background-image:url('aspnet_client/system_web/4_0_30319/crystalreportviewers13/js/crviewer/../dhtmllib/images/skin_standard/button.gif');background-position:0px -21px;\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1545643198, "post_id": 53911422, "comment_id": 94666831, "body": "VBA isn&#39;t the best solution for this. You really should consider using conditional formatting."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1545644103, "post_id": 53911422, "comment_id": 94667122, "body": "@K.D\u1d00\u1d20\u026as, I tend to avoid conditional formatting as much as possible since it can increase both file calculation time and its size. But that&#39;s my feeling"}, {"owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1545756177, "post_id": 53911422, "comment_id": 94689790, "body": "@K.D\u1d00\u1d20\u026as, thanks for your suggestion, unfortunately I can&#39;t add any conditional formatting to the workbook, this Macro should refer to other Workbooks."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 0, "creation_date": 1545760206, "post_id": 53911579, "comment_id": 94690553, "body": "Hi @DisplayName, it works pretty good. I&#39;m going to implement ( and adapt) it in the code I have! Thank you again for your great support!!! It is simple and clear."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1545644366, "last_edit_date": 1545644366, "creation_date": 1545643978, "answer_id": 53911579, "question_id": 53911422, "link": "https://stackoverflow.com/questions/53911422/find-text-and-change-color/53911579#53911579", "title": "Find text and change color", "body": "<p>you could use <code>Find()</code> method and build a helper Function:</p>\n\n<pre><code>Function GetCellsWithValue(sht As Worksheet, val As Variant, foundCells As Range) As Boolean\n    Dim found As Range\n    Dim firstAddress As String\n    With sht.UsedRange\n        Set foundCells = .Resize(1, 1).Offset(.Rows.Count) ' fill foundCells with a \"dummy\" found one to avoid 'If Not foundCells Is Nothing' check before any 'Union()' method call\n\n        Set found = .Find(what:=val, lookat:=xlPart, LookIn:=xlValues)\n        If Not found Is Nothing Then\n            firstAddress = found.Address\n            Do\n                Set foundCells = Union(foundCells, found)\n                Set found = .FindNext(found)\n            Loop While found.Address &lt;&gt; firstAddress\n        End If\n\n        Set foundCells = Intersect(.Cells, foundCells) ' get rid of the \"dummy\" found cell\n    End With\n\n    GetCellsWithValue = Not foundCells Is Nothing\nEnd Function\n</code></pre>\n\n<p>that you could use in your \"main\" sub as follows:</p>\n\n<pre><code>Option Explicit\n\nSub CellMarked()\n\n    Dim fndlist As Variant, val As Variant, sht As Worksheet\n    Dim foundCells As Range\n\n    fndlist = Array(\"Column1\", \"Column2\")\n\n    For Each sht In ActiveWorkbook.Worksheets\n    With sht\n        For Each val In fndlist\n            If GetCellsWithValue(sht, val, foundCells) Then foundCells.Font.Color = 255\n        Next\n    End With\n    Next sht\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 0, "creation_date": 1545756254, "post_id": 53912305, "comment_id": 94689803, "body": "thanks for your suggestion, unfortunately this Macro don&#39;t use the .find Function"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545648088, "creation_date": 1545648088, "answer_id": 53912305, "question_id": 53911422, "link": "https://stackoverflow.com/questions/53911422/find-text-and-change-color/53912305#53912305", "title": "Find text and change color", "body": "<p>Change \"strToFind\" and try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim strToFind As String\n    Dim rng As Range, cell As Range\n    Dim ws As Worksheet\n\n    'String to Find is \"Test\"\n    strToFind = \"Test\"\n\n    With ThisWorkbook\n\n        For Each ws In .Worksheets\n            With ws\n                Set rng = .UsedRange\n\n                For Each cell In rng\n                    If cell.Value = strToFind Then\n                        cell.Interior.Color = RGB(255, 0, 0)\n                    End If\n                Next cell\n            End With\n\n        Next ws\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 0, "creation_date": 1545759403, "post_id": 53913365, "comment_id": 94690413, "body": "Hi @VBasic2008, to search <code>MatchCase := False </code> , I made this change <code>Set rngFind = .Cells.Find(what:=fndlist(x), lookat:=xlPart, SearchOrder:=xlByRows, MatchCase:=True, SearchFormat:=False)?</code>,  I hope  it makes sense. The code works pretty good!  Thanks a lot  I was wondering if you can better explain this piece of the code <code>.Cells(.Rows.Count, Columns.Count), -4163, 2, 1 </code> Thanks in advance"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 1, "creation_date": 1545761156, "post_id": 53913365, "comment_id": 94690732, "body": "@M.Kuz: When entering parameters (-4163 or xlValues) without arguments (Lookin) they must be in a certain order: What, After, LookIn, LookAt, SearchOrder, SearchDirection, MatchCase, MatchByte, SearchFormat. The first 2 are self explaining. The next 3 are LookIn, LookAt and SearchOrder they are saved each time, that&#39;s why they are omitted in later searches in the code. SearchDirection is xlNext and MatchCase is False by default. MatchCase True means Aa and aa are different. The parameters can be used with values like I did, and with constants like you did."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 1, "creation_date": 1545761421, "post_id": 53913365, "comment_id": 94690769, "body": "@M.Kuz: When you omit the second parameter (After) the search starts from the top left cell which is evaluated last. When you write After:= .Cells(.Rows.Count, Columns.Count) it starts from the bottom right cell which is evaluated last i.e. the first top left cell is evaluated first. -4613, 2, 1 means xlValues, xlPart, xlByRows for the 3 (saving) arguments LookIn, LookAt and SearchOrder. To see the corresponding values of the parameters just stop the code after a find line and hover over the parameter. I would suggest that you read the VIsual Basic Help for the Find method carefully."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 0, "creation_date": 1545763616, "post_id": 53913365, "comment_id": 94691155, "body": "@M.Kuz: I think MatchCase should be omitted (False), because if you have column1 instead of Column1 it won&#39;t be found. Also the search format, it doesn&#39;t do anything in this case. And as I mentioned you don&#39;t have to use the 3 (saving) arguments if they have been used right before the &#39;Set rngFind&#39; line i.e. the &#39;If Not .Cells.Find&#39; line. I think you should leave everything as it is."}, {"owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "edited": false, "score": 0, "creation_date": 1545774027, "post_id": 53913365, "comment_id": 94693090, "body": "Hi Thanks a lot for your clarification, it has been really exaustive, and It is really helpul to improve my coding skills. I totally agree with you about MatchCase that should set to false, my mistake."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545654186, "last_edit_date": 1545654186, "creation_date": 1545653885, "answer_id": 53913365, "question_id": 53911422, "link": "https://stackoverflow.com/questions/53911422/find-text-and-change-color/53913365#53913365", "title": "Find text and change color", "body": "<h1>Find Text Apply Fill</h1>\n\n<pre><code>Sub CellMarked()\n\n  Dim rngFind As Range, rngU As Range\n  Dim fndlist As Variant\n  Dim strFirst As String\n  Dim i As Integer, x As Integer\n\n  fndlist = Array(\"Column1\", \"Column2\")\n\n  For i = 1 To Worksheets.Count\n\n    With Worksheets(i)\n\n      For x = 0 To UBound(fndlist)\n        ' Check if worksheet has no values.\n        If Not .Cells.Find(\"*\", .Cells(.Rows.Count, Columns.Count), -4163, 2, 1) _\n            Is Nothing Then\n          ' Find string.\n          Set rngFind = .Cells.Find(fndlist(x), _\n              .Cells(.Rows.Count, Columns.Count))\n          If Not rngFind Is Nothing Then\n            If Not rngU Is Nothing Then\n              Set rngU = Union(rngU, rngFind) ' All other occurrences.\n             Else\n              Set rngU = rngFind ' First occurrence.\n            End If\n            strFirst = rngFind.Address\n            ' Check for other occurrences.\n            Do\n              Set rngFind = .Cells.FindNext(rngFind)\n              If rngFind.Address &lt;&gt; strFirst Then\n                Set rngU = Union(rngU, rngFind)\n               Else\n                Exit Do\n              End If\n            Loop\n          End If\n        End If\n      Next\n\n      ' Apply formatting.\n      If Not rngU Is Nothing Then\n        rngU.Interior.Color = 255\n        ' rngU.Font.Color = 255\n        Set rngU = Nothing\n      End If\n\n    End With\n\n  Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10824526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd404e1805d8322ec0033d04c7722a4d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Kuz", "link": "https://stackoverflow.com/users/10824526/m-kuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "accepted_answer_id": 53911579, "answer_count": 3, "score": 1, "last_activity_date": 1610587013, "creation_date": 1545643084, "last_edit_date": 1610587013, "question_id": 53911422, "link": "https://stackoverflow.com/questions/53911422/find-text-and-change-color", "title": "Find text and change color", "body": "<p>I would like to loop all the worksheets of a workbook changing the color of a cell with a specific string in it.</p>\n<p>I use <code>.Replace</code> (I need MatchCase and lookat).<br />\nIt replaces the text without regarding Case. (e.g. if in the array it is lowercase and the string found is uppercase it will be changed to lowercase). The only way to bypass this is to use <code>MatchCase:= false</code> and list all options, and it could be really inefficient.</p>\n<p>Could I perform the action using <code>.Find</code> or another function?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CellMarked()\n\nDim fndlist As Variant, x As Integer, sht as worksheet\n\nfndlist = Array(&quot;Column1&quot;, &quot;Column2&quot;)\n\nFor Each sht In ActiveWorkbook.Worksheets\n    With sht\n        For x = LBound(fndlist) To UBound(fndlist)\n            .Cells.Replace What:=fndlist(x), Replacement:=fndlist(x), _\n              lookat:=xlPart, SearchOrder:=xlByRows, MatchCase:=True, _\n              SearchFormat:=False, ReplaceFormat:=True\n            Application.ReplaceFormat.Font.Color = 255\n        Next x\n    End With\nnext sht\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "for-loop", "optimization", "vb6"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1545646500, "post_id": 53911304, "comment_id": 94667886, "body": "This will always result in the same answer so why are you calculating it each time? Just work it out once and hard code the answer (Output wil be something like 8*10^8 I think) Whoops just noticed you&#39;&#39;re using &amp;  so this will be a very long string not a number . So it&#39;s doing a long to string conversion everytime through the loop - no wonder it&#39;s taking a while - even more reason to hard code the string"}, {"owner": {"reputation": 7658, "user_id": 3195477, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/PK4P1.jpg?s=128&g=1", "display_name": "StayOnTarget", "link": "https://stackoverflow.com/users/3195477/stayontarget"}, "edited": false, "score": 0, "creation_date": 1546433008, "post_id": 53911304, "comment_id": 94849671, "body": "Why can&#39;t you use the title you wanted as the actual title?"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1545648598, "creation_date": 1545648598, "answer_id": 53912400, "question_id": 53911304, "link": "https://stackoverflow.com/questions/53911304/visual-basic-topic/53912400#53912400", "title": "Visual Basic Topic", "body": "<p>I can hardly guess what's that for, but an intermediate step with arrays speeds it up  </p>\n\n<pre><code>Public Sub Form_Load2()\n    Const n As Long = 500, n2 As Long = 200\n\n    Dim Output As String\n    Dim i As Long, i2 As Long\n\n    ReDim vals(1 To n2) As String\n    For i = 1 To n\n        For i2 = 1 To n2\n            vals(i2) = i * i2\n        Next\n        Output = Output &amp; Join(vals, \"\")\n    Next\n    Debug.Print Output\nEnd Sub\n</code></pre>\n\n<p>With <code>i</code> and <code>i2</code> limited, respectively, to 500 and 200 it is almost instantaneous</p>\n\n<p>it's up to you to try larger number, but I'll advise you to keep little steps..</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c87a585df04fc37ee72d25fe918cfb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandr M.", "link": "https://stackoverflow.com/users/5766312/aleksandr-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1545652531, "last_edit_date": 1545652531, "creation_date": 1545650134, "answer_id": 53912717, "question_id": 53911304, "link": "https://stackoverflow.com/questions/53911304/visual-basic-topic/53912717#53912717", "title": "Visual Basic Topic", "body": "<p>This will be a bit faster then the solution provided by @DisplayName</p>\n\n<pre><code>Public Sub Form_Load()\nConst I_MAX     As Long = 990\nConst I2_MAX    As Long = 990\n\nDim Output  As String\nDim i       As Long\nDim i2      As Long\nDim lCount  As Long\nDim arr     As Variant\n\nlCount = 0\nReDim arr(I_MAX * I2_MAX)\n\nFor i = 1 To I_MAX\n    For i2 = 1 To I2_MAX\n        arr(lCount) = i * i2\n        lCount = lCount + 1\n    Next\nNext\n\nOutput = Join(arr, vbNullString)\nDebug.Print Output\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10830235, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6cf2c13b19dfa19e54056ca8e8520ec2?s=128&d=identicon&r=PG", "display_name": "yowyow", "link": "https://stackoverflow.com/users/10830235/yowyow"}, "is_accepted": false, "score": 0, "last_activity_date": 1545685366, "last_edit_date": 1545685366, "creation_date": 1545684493, "answer_id": 53917576, "question_id": 53911304, "link": "https://stackoverflow.com/questions/53911304/visual-basic-topic/53917576#53917576", "title": "Visual Basic Topic", "body": "<p>Your problem is that you are shuffling millions of megabytes of memory. At the halfway point your code is copying 5.7 MBytes from one memory location to another each time through the inner loop. A total off 5,700 Gigabytes over the entire program.</p>\n\n<p>The rules are join small strings together then join the smaller strings at the end of the concatenation. To make the smaller strings no larger than say 4000 bytes then join those files at the end.</p>\n\n<p>Modern languages have a string builder object, VBA has one too it's just not called that.</p>\n\n<p>In VBA there is the <code>Mid</code> function and the <code>Mid</code> statement. They do opposite things. So you create your final sting first. Then using the <code>Mid</code> <em>statement</em> pop your substrings into the first string. This avoids all the 100s of megabytes of shuffling. Use <code>Rtrim</code> to lop off any excess spaces at the end. If you Dim the Output to 6 million spaces then it will fit in your example, and use about 12 MBytes compared to thousands of Gigabytes.</p>\n\n<p>Here is a small example.</p>\n\n<pre><code>Private Sub Form_Load()\nOutPut = Space(1500)\n\nFor x = 1 To 500\n    Offset = Offset + Len(CStr(x))\n    Mid(OutPut, Offset) = CStr(x)\nNext\nMsgBox OutPut\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/29596432/pointers-needed-for-speeding-up-nested-loop-macro-in-vba/29597193#29597193\">Pointers needed for speeding up nested loop macro in VBA</a></p>\n"}], "owner": {"reputation": 21, "user_id": 10646554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d8a2a13a93da78c9dc1873d3d119b7?s=128&d=identicon&r=PG&f=1", "display_name": "JuanDoe1337", "link": "https://stackoverflow.com/users/10646554/juandoe1337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1545685366, "creation_date": 1545642205, "last_edit_date": 1545642442, "question_id": 53911304, "link": "https://stackoverflow.com/questions/53911304/visual-basic-topic", "title": "Visual Basic Topic", "body": "<p>My intended title fo this post:\nVB6 (VBA) Loop Code Optimization (Sorry for any troubles)</p>\n\n<p>So I have been using this code in my VB6 (VBA) program:</p>\n\n<pre><code>Public Sub Form_Load()\n    Dim Output As String\n    For i = 1 To 990\n        For i2 = 1 To 990\n            Output = Output &amp; i * i2\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>And am having trouble with the for loops being extremely slow, and takes a few hours to execute in extreme cases. Any tips to optimize my code?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1545639892, "post_id": 53910886, "comment_id": 94665898, "body": "Have you tried anything so far? Could you show us some code? A hint could be to use a dictionary for that."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1545639920, "post_id": 53910886, "comment_id": 94665908, "body": "I&#39;m sure in SO there&#39;s plenty of examples concerning your very issue: search for them, make your trial and error work and if you got stuck come back with your code and its issues"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 3, "creation_date": 1545640104, "post_id": 53910886, "comment_id": 94665954, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48406176/dependent-dictionaries-excel-vba\">dependent dictionaries excel vba</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "edited": false, "score": 0, "creation_date": 1545667211, "post_id": 53912171, "comment_id": 94674004, "body": "Thanks all for your great ideas..I still not clear on how to manage large set of data.    Until now what I have tried was created two list boxes in VBA, for the first one edited rowSource reference to the two cells letters and numbers as sheet1!C11:D11,  and the second list box, i do not know how to get the relevent data filtered based on the first choice"}, {"owner": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "edited": false, "score": 0, "creation_date": 1545731969, "post_id": 53912171, "comment_id": 94684537, "body": "Hi Harassed,I tried this video as you explained in your answer.  <a href=\"https://www.youtube.com/watch?v=YIEt_S65GrU\" rel=\"nofollow noreferrer\">youtube.com/watch?v=YIEt_S65GrU</a>"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1545647283, "creation_date": 1545647283, "answer_id": 53912171, "question_id": 53910886, "link": "https://stackoverflow.com/questions/53910886/making-dependant-list-box-in-vba/53912171#53912171", "title": "Making dependant list box in VBA", "body": "<p>Assume listboxes are called  LstChoice and LstOptions. Assume the table is in the range(\"a1:B5\")  In the After_update event of lstChoice put this</p>\n\n<pre><code> Private Sub LstChoice_AfterUpdate()\n\nDim x As Long\nMe.LstOptions.Clear\nSelect Case LstChoice.ListIndex\n\n      Case 0\n          'Letters\n\n          For x = 0 To 4\n              Me.LstOptions.AddItem Cells(1, 1).Offset(x, 0)\n          Next x\n      Case 1\n              'numbers\n               For x = 0 To 4\n                       Me.LstOptions.AddItem Cells(1, 2).Offset(x, 0)\n                 Next x\nEnd Select\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 15, "user_id": 5468100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3a6057b7472eba2c105a83a0c230f0?s=128&d=identicon&r=PG&f=1", "display_name": "h pavi", "link": "https://stackoverflow.com/users/5468100/h-pavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545647283, "creation_date": 1545639473, "question_id": 53910886, "link": "https://stackoverflow.com/questions/53910886/making-dependant-list-box-in-vba", "title": "Making dependant list box in VBA", "body": "<p>I want to visialize a dependant list box from VBA list box.</p>\n\n<p>I have an excel table as as\nLetters A B C D E\nNumbers 1 2 3 4 5</p>\n\n<p>And I have VBA userform with two list boxes.\nIn first one I want to select weather letters or numbers\nIn the second list box,I need to make the viewing list dependant based on the fist choice</p>\n\n<p>I made this with excel data validationand it is successfull, now i need to visulaize it from VBA form.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1545632826, "post_id": 53909803, "comment_id": 94664126, "body": "OK, I solved it with a Function. Put the Select Case in a Public Function which takes iDP as an argument. The in main code use <code>sFmt = FmatStr(iDP)</code> Then for the formatting <code>Format(Round(dTot, iDP), sFmt)</code>"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545632866, "post_id": 53909803, "comment_id": 94664131, "body": "Let us see the Function."}, {"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1545633267, "post_id": 53909803, "comment_id": 94664225, "body": "<code>Public Function FmatStr(i As Integer) As String     Select Case i         Case Is = 0: FmatStr = &quot;#,##0&quot;         Case Is = 1: FmatStr = &quot;#,##0.0&quot;         Case Is = 2: FmatStr = &quot;#,##0.00&quot;         Case Is = 3: FmatStr = &quot;#,##0.000&quot;         Case Is = 4: FmatStr = &quot;#,##0.0000&quot;         Case Is = 5: FmatStr = &quot;#,##0.00000&quot;         Case Is = 6: FmatStr = &quot;#,##0.000000&quot;     End Select End Function</code>"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545633608, "post_id": 53909803, "comment_id": 94664314, "body": "user10825204&#39;s formula is much shorter and covers more decimals."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1545635428, "post_id": 53909868, "comment_id": 94664752, "body": "Both those also return 0 for the values shown in my comment to user10825204&#39;s answer above."}, {"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1545636945, "post_id": 53909868, "comment_id": 94665139, "body": "See my comment above, your formulas also work when I change dTot."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545645354, "last_edit_date": 1545645354, "creation_date": 1545632391, "answer_id": 53909868, "question_id": 53909803, "link": "https://stackoverflow.com/questions/53909803/format-a-number-that-can-be-variably-rounded-with-thousand-separator/53909868#53909868", "title": "Format a number that can be variably rounded with thousand separator", "body": "<p><strong>EDIT: Added the brilliant '<code>&amp; IIF(iDP, \".\", \"\")</code>' used in the accepted answer by <a href=\"https://stackoverflow.com/users/10825204/user10825204\">user10825204</a>:</strong></p>\n\n<h1>WorksheetFunction.Rept vs Replace(Space)</h1>\n\n<h2>WorksheetFunction.Rept</h2>\n\n<pre><code>Format(Round(dTot, iDp), \"#,##0\" _\n    &amp; IIF(iDP, \".\", \"\") &amp; WorksheetFunction.Rept(\"0\", iDp))\n</code></pre>\n\n<h2>Replace(Space)</h2>\n\n<pre><code>Format(Round(dTot, iDp), \"#,##0\" _\n    &amp; IIF(iDP, \".\", \"\") &amp; Replace(Space(iDp), \" \", \"0\"))\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10825204"}, "edited": false, "score": 0, "creation_date": 1545632576, "post_id": 53909872, "comment_id": 94664068, "body": "btw, The Round function may be redundant since the format mask &#39;rounds&#39; the result to the specified decimals shown."}, {"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1545634665, "post_id": 53909872, "comment_id": 94664566, "body": "Thanks, user10825204, but using your formula, with iDP as 3 and dTot as 1569231622.7464 it returned 0 whereas my function returns 1,569,231,622.746 which is correct."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10825204"}, "reply_to_user": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1545635303, "post_id": 53909872, "comment_id": 94664717, "body": "I had original mistyped a <code>,</code> for a <code>.</code> in <code>IIF(iDP, &quot;.&quot;, &quot;&quot;)</code>. I resolved within minutes of posting the reply but I guess you missed the correction."}, {"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1545636832, "post_id": 53909872, "comment_id": 94665104, "body": "OOOps my bad, I used dTot as an example here but in my actual code I have dTot1 through to dTot6, I copied your formula directly into my code and did not change dTot. As soon as I saw the formula I thought &quot;That will work&quot;. Thanks for the reply!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10825204"}, "is_accepted": true, "score": 3, "last_activity_date": 1545635423, "last_edit_date": 1545635423, "creation_date": 1545632444, "answer_id": 53909872, "question_id": 53909803, "link": "https://stackoverflow.com/questions/53909803/format-a-number-that-can-be-variably-rounded-with-thousand-separator/53909872#53909872", "title": "Format a number that can be variably rounded with thousand separator", "body": "<p>Build the format mask string as needed.</p>\n\n<pre><code>Format(Round(dTot, iDP), \"#,##0\" &amp; IIF(iDP, \".\", \"\") &amp; string(iDP, \"0\"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2S763.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2S763.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53909872, "answer_count": 2, "score": 1, "last_activity_date": 1545645354, "creation_date": 1545631841, "last_edit_date": 1545635672, "question_id": 53909803, "link": "https://stackoverflow.com/questions/53909803/format-a-number-that-can-be-variably-rounded-with-thousand-separator", "title": "Format a number that can be variably rounded with thousand separator", "body": "<p>I have code that ends up with a variable \"dTot\" which will be a number with up to 5 decimal places.</p>\n\n<p>The user has an option to set the number of decimal places for rounding dTot, user selection is assigned to a variable \"iDP\", this can be anything between 0 and 5.</p>\n\n<p>dTot = Round(dTot, iDP)` works just fine.</p>\n\n<p>But, I also need to format the rounded number with thousand separator when adding to to another array.</p>\n\n<p><code>Format(Round(dTot, iDP), \"#,##0.00000\")</code></p>\n\n<p>works if iDP is 5, and</p>\n\n<p><code>Format(Round(dTot, iDP), \"#,##0.00\")</code></p>\n\n<p>if iDP is 2</p>\n\n<p>How can I get the format to follow the iDP value?</p>\n\n<p>I know I could use \"Select Case iDP\" and have 6 Cases, but since the formatting needs to be applied to up 6 expressions in each of 200 rows in the array I was hoping to find a way to avoid \"Select Case\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545631034, "post_id": 53909467, "comment_id": 94663757, "body": "Give us some code to see what you have tried so far. It doesn&#39;t matter if it doesn&#39;t work, just to get some inspiration. Even better, try to explain a simplified scenario to get an answer on which basis you could create the final solution."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1545647934, "creation_date": 1545647934, "answer_id": 53912280, "question_id": 53909467, "link": "https://stackoverflow.com/questions/53909467/excel-vba-hyperlink-to-another-workbook-and-enter-values-into-opened-workbook/53912280#53912280", "title": "Excel VBA hyperlink to another workbook and enter values into opened workbook", "body": "<p>The Worksheet_FollowHyperlink event fires after Excel has followed the hyperlink (and thus opened the workbook defined in the workbook. It follows that ActiveWorkbook is the workbook defined by the hyperlink. So you could use that. However if you want the actual name form the hyperlink</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\nDim x As Long\nDim s As String\nDim answer As String\nFor x = Len(Target.Address) To 1 Step -1\n     s = Mid(Target.Address, x, 1)\n     If s = \"\\\" Then Exit For\n     answer = s &amp; answer\nNext x\nMsgBox answer\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10737235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa63200d5951c2cde017c59c3374111?s=128&d=identicon&r=PG&f=1", "display_name": "Jlbnt", "link": "https://stackoverflow.com/users/10737235/jlbnt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545647934, "creation_date": 1545629250, "question_id": 53909467, "link": "https://stackoverflow.com/questions/53909467/excel-vba-hyperlink-to-another-workbook-and-enter-values-into-opened-workbook", "title": "Excel VBA hyperlink to another workbook and enter values into opened workbook", "body": "<p>I am trying to help my Dad put an order and job management 'system' into his manufacturing business. </p>\n\n<p>As part of this I have an 'Orders' workbook with one worksheet containing a table of customer orders where each row is a different order. Each row contains all the key information for each order (order number, qty, product, due date, hyperlink to open related job sheet).</p>\n\n<p>I have written 'job sheets' for all his main and regularly ordered products. These job sheets are contained in separate workbooks.</p>\n\n<p>I would like the user to be able to open the central orders list, click on the link to the job sheet they need to produce the product ordered and then that job sheet be automatically populated with the key order information contained in the target row of the hyperlink clicked. </p>\n\n<p>I have been trying unsuccessfully to write a private sub (using workbook_followHyperlink). I have been trying to use the hyperlinks.address method to capture the name of the workbook being opened and then use that address as the filename to direct where the order information should be entered.</p>\n\n<p>I'm getting better at writing VBA code but I still need a template or 'clue' to begin writing something of my own. I have done MUCH googling to find examples but the only examples I've come across know the name of the destination workbook, or alternatively refer to hyperlinks between sheets <em>within the same workbook</em>.</p>\n\n<p>I would really appreciate even just an outline of what I need to get started. </p>\n"}, {"tags": ["excel", "vba", "algorithm", "parsing"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545634396, "post_id": 53909184, "comment_id": 94664503, "body": "give an example of how you&#39;d substitute values"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545656859, "post_id": 53909184, "comment_id": 94670984, "body": "That&#39;s kind of immaterial to the question. The variables represent Boolean relational expressions. I can&#39;t evaluate them before I finish parsing down into its most basic form, though. Right now I&#39;m just trying to figure out how to programmatically do that expansion."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545657870, "post_id": 53909184, "comment_id": 94671319, "body": "<i>\u201d I can&#39;t evaluate them before I finish parsing down into its most basic form\u201c</i>, if you show an example I could check for a very simple way to make it"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545658355, "post_id": 53909184, "comment_id": 94671458, "body": "@DisplayName Ok, I added in the immediate step prior. All of those relational comparisons got simplified down into the variables A, B, C, D, E."}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545723489, "post_id": 53915751, "comment_id": 94682897, "body": "@SandPiper, any feedback?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1545842505, "post_id": 53915751, "comment_id": 94709533, "body": "@SandPiper, it&#39;d be nice of you giving feedback to anyone trying helping you"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1546895652, "post_id": 53915751, "comment_id": 94997249, "body": "Thanks @T.M. I wish I could get some feedback from SandPiper as well..."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1547663816, "post_id": 53915751, "comment_id": 95272469, "body": "@Sandpiper - as I&#39;m generally interested in parsing, I&#39;d like to hear, too if the above approach meets your needs and/or where you can localize a special issue (if so please describe it :-)"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1545674316, "last_edit_date": 1545674316, "creation_date": 1545668985, "answer_id": 53915751, "question_id": 53909184, "link": "https://stackoverflow.com/questions/53909184/parsing-and-expanding-algebraic-equations-that-have-variables-using-vba/53915751#53915751", "title": "Parsing and expanding algebraic equations that have variables using VBA", "body": "<p>assuming you have a string with your equation </p>\n\n<pre><code>equation = \"( ( 2 * 3 + 2.5 ) * ( -2.5 ) ) + 1.9\"\n</code></pre>\n\n<p>you can <code>Evaluate</code> it</p>\n\n<pre><code>MsgBox equation &amp; \" = \" &amp; Evaluate(Replace(equation, \",\", \".\"))\n</code></pre>\n\n<p>where the <code>Replace</code> is there to make sure you have the dot as decimal separator</p>\n\n<p>here's a working snippet, where a I used a <code>Dictionary</code> to keep track of name variables and their value:</p>\n\n<pre><code>Dim equation As String\nequation = \"( ( A * B + C ) * ( D ) ) + E\"\n\nDim varDict As Scripting.Dictionary\nSet varDict = New Scripting.Dictionary\n\nWith varDict\n    .Add \"A\", 2#    ' assigning variable \"A\" the value 2.0\n    .Add \"B\", 3     ' assigning variable \"B\" the value 3.0\n    .Add \"C\", 2.5   ' assigning variable \"C\" the value 2.5\n    .Add \"D\", -2.5  ' assigning variable \"D\" the value -2.5\n    .Add \"E\", 1.9   ' assigning variable \"E\" the value 1.9\nEnd With\n\nDim key As Variant\nFor Each key In varDict ' loop all variables\n    equation = Replace(Replace(equation, key, varDict(key)), \",\", \".\") ' replace each variable name within 'equation' string with its corresponding value, and make sure you use dots for decimal separator\nNext\n\nMsgBox equation &amp; \" = \" &amp; Evaluate(equation) ' show the result\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1578547248, "creation_date": 1545625726, "last_edit_date": 1578547248, "question_id": 53909184, "link": "https://stackoverflow.com/questions/53909184/parsing-and-expanding-algebraic-equations-that-have-variables-using-vba", "title": "Parsing and expanding algebraic equations that have variables using VBA", "body": "<p>I am working on a VBA script that is parsing down a user input string for later evaluation. I have managed to get it down to the following, where the letters are variables that contain strings, numbers, or other functions to evaluate later. They are being compared in AND/OR statements that have yet unspecified variables, so I can't just evaluate it ahead of time. Thus, I have simplified this:</p>\n\n<pre><code>( ( [$$FIELD_1] [$$REL_GREATER_THAN] [$$FUNC_ROUND_OPEN] 6000.25 \n[$$FUNC_ROUND_CLOSE] AND [$$FIELD_1] [$$REL_LESS_THAN] [$$FUNC_ABS_OPEN] \n[$$FUNC_FLOOR_OPEN] - 7000.99 [$$FUNC_FLOOR_CLOSE] [$$FUNC_ABS_CLOSE] OR \n[$$FIELD_1] [$$REL_LESS_THAN] [$$FIELD_3] ^ 2 + 8 ) AND ( [$$STRING_1] &amp; \n[$$STRING_2] &amp; [$$STRING_3] [$$REL_NOT_EQUAL] [$$FIELD_5] &amp; [$$STRING_4] &amp; \n[$$FIELD_4] ) ) OR [$$FIELD_6] [$$REL_EQUAL] [$$STRING_5]\n</code></pre>\n\n<p>by replacing the Booleans with variables, and I replaced AND with multiplication, OR with addition:</p>\n\n<pre><code>( ( A * B + C ) * ( D ) ) + E\n</code></pre>\n\n<p>What I need to do now is expand that out using the distributive property of algebra. The result would look something like</p>\n\n<pre><code>A*B*D + C*D + E\n</code></pre>\n\n<p>which I can then start substituting values back into.</p>\n\n<p>The order the terms are in doesn't really matter, it just has to be grouped down into multiplication or addition. It has become a much harder problem than I initially thought, because I need it to be robust enough to handle other equations, not just this one particular example.</p>\n\n<p>I have looked for something built into VBA that can do this naturally, but I haven't found anything yet. This is a similar question, but for Java and C: <a href=\"https://stackoverflow.com/questions/9844023/parse-non-standard-form-to-standard-form-in-java/9867303#9867303\">Parse non standard form to standard form in java</a>. Unfortunately, the only answer there essentially boiled down to, \"just parse it\"... which is the part I need help with.</p>\n\n<p>How can I programmatically figure out these distributive expansions? Is there an algorithm for this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545626263, "post_id": 53908713, "comment_id": 94662905, "body": "Where does this link point to?"}], "answers": [{"comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1545620957, "post_id": 53908787, "comment_id": 94662238, "body": "Good catch! I tested the code with value instead of variable and forgot to put variable here. So it would be <code>salesNo</code>."}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545622571, "post_id": 53908787, "comment_id": 94662419, "body": "I need to add the &quot;#&quot; in front of the hyperlink, is it possible to do so? Thanks in advance. To be more specific I need to add the &quot;#&quot; infront of the activesheet.name otherwise, that code will prompt me with a file explorer which i do not want"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 1, "creation_date": 1545622823, "post_id": 53908787, "comment_id": 94662446, "body": "@beginnercoder123 You can add but it will not work as hyperlink then. Can you explain why you need to add hash # symbol?"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545622890, "post_id": 53908787, "comment_id": 94662456, "body": "To add hash just use like <code>= &quot;=HYPERLINK(#&quot; &amp; \u2026..</code>"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545623059, "post_id": 53908787, "comment_id": 94662483, "body": "Why will it not work as hyperlink? I searched online on how to put hyperlink in formula in VBA it shows a &quot;#&quot; symbol in front of the sheet name. The code works but it will always open a file explorer stating UPDATE VALUES, which I want to avoid. Hope this clarifies your question"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545623113, "post_id": 53908787, "comment_id": 94662491, "body": "@beginnercoder123 then you can use <code>= &quot;=HYPERLINK(#&quot; &amp; \u2026..</code>"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545623218, "post_id": 53908787, "comment_id": 94662507, "body": "Yea I tried that by adding it front of the &quot; but it stills prompt me with application defined or object defined error, I really do not know what is the problem... Is something wrong with my variables or something? I alr set userMsheet at the top as worksheet already, I am out of ideas it seems"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545623431, "post_id": 53908787, "comment_id": 94662534, "body": "@beginnercoder123 when you manually create the hyperlink by typing <code>=HYPERLINK...</code> into the cell, does it work with the <code>#</code>? It doesn&#39;t look like it should according to the <a href=\"https://support.office.com/en-us/article/hyperlink-function-333c7ce6-c5ae-4164-9c47-7de9b76f577f\" rel=\"nofollow noreferrer\">documentation</a>"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545787761, "post_id": 53908787, "comment_id": 94694845, "body": "@BigBen Hi, yea. I tried creating a macro as well as searching up online. It seems to have a &quot;#&quot; symbol when trying to hyperlink to other sheets in the same workbook"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545620858, "last_edit_date": 1545620858, "creation_date": 1545620776, "answer_id": 53908787, "question_id": 53908713, "link": "https://stackoverflow.com/questions/53908713/how-to-fix-application-defined-or-object-defined-error-for-this-specific-line-of/53908787#53908787", "title": "How to fix Application Defined or Object Defined Error for this specific line of code?", "body": "<p>Try following</p>\n\n<pre><code>userMsheet.Cells(lastrow + 1, \"A\").Formula = \"=HYPERLINK(\" &amp; _\nActiveSheet.Name &amp; \"!\" &amp; Cells(salesNo - 1, 3).Address &amp; \",\" &amp; _\nChr(34) &amp; usernameComboBox.Value &amp; Chr(34) &amp; \")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545785656, "post_id": 53909511, "comment_id": 94694674, "body": "Thanks for the feedback! Will try the code now, could not get back to u earlier due to Christmas! Merry Christmas btw!"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545786516, "post_id": 53909511, "comment_id": 94694741, "body": "Code has an error stating Invalid procedure call or argument. Is it even possible to do a hyperlink in this case? I feel that it is impossible..."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545786849, "post_id": 53909511, "comment_id": 94694775, "body": "@beginnercoder123: I have double checked, it has to be working. Have you checked the variables and the worksheets? I&#39;ve edited the answer. So try this and if it works adjust your variables, worksheets etc."}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545787341, "post_id": 53909511, "comment_id": 94694809, "body": "With userMsheet      lastrow = userMsheet.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row       userMsheet.Hyperlinks.Add _       anchor:=userMsheet.Cells(lastrow + 1, &quot;A&quot;), _       Address:=&quot;&quot;, _       SubAddress:=&quot;&#39;&quot; &amp; ActiveSheet.Name &amp; &quot;&#39;!&quot; _           &amp; Cells(salesNo - 1, 3).Address, _       TextToDisplay:=usernameComboBox.Value           End With"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545787471, "post_id": 53909511, "comment_id": 94694825, "body": "Error is highlighted from userMsheet.hyperlinks.add ...... until TextToDisplay:= usernameCombo.Box. I have already defined all the necessary variables, can&#39;t seem to figure out the issue here"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545787792, "post_id": 53909511, "comment_id": 94694849, "body": "@beginnercoder123: Should work. Are you sure that salesNo is greater than 1?Does usernameComboBox exist i.e. that it isn&#39;t nothing? In any case you should try the &#39;Whatever&#39; code to prove if it is working on your computer. Just open a new workbook, put in the code and run it. You should get a hyperlink in A6 called Whatever and when clicking on it it will jump to C6."}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545789665, "post_id": 53909511, "comment_id": 94695095, "body": "Tried it on new workbook, code works. But I can&#39;t fine tuned it with variables like mine as intended. Yes, salesNo is greater than 1, and usernameComboBox exist in the userform. I really cannot seem to figure out the issue here.."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545790375, "post_id": 53909511, "comment_id": 94695178, "body": "@beginnercoder123: Maybe you have to use Userform1.UsernameComboBox or whatever the name of the  userform is."}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545791161, "post_id": 53909511, "comment_id": 94695286, "body": "It worked!!! Apparently, the issue was in front of the code, I had codes to clear each value of the inputs, for eg ComboBox.Text = &quot;&quot;, thus the hyperlink was deemed invalid. My mistake, thank you so much for your help!"}, {"owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "edited": false, "score": 0, "creation_date": 1545791337, "post_id": 53909511, "comment_id": 94695313, "body": "Is it also possible that if I delete the name on the activesheet, will the  name on the other sheet be deleted as well? Is there any function to make that possible?"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1545787626, "last_edit_date": 1545787626, "creation_date": 1545629602, "answer_id": 53909511, "question_id": 53908713, "link": "https://stackoverflow.com/questions/53908713/how-to-fix-application-defined-or-object-defined-error-for-this-specific-line-of/53909511#53909511", "title": "How to fix Application Defined or Object Defined Error for this specific line of code?", "body": "<h1>SubAddress Issue not feat. #</h1>\n\n<p>I don't think that what you two are trying to do is even possible. Therefore I would suggest you add the hyperlink directly into the cell i.e. if you want it to point to something.</p>\n\n<blockquote>\n<pre><code>  userMsheet.Hyperlinks.Add _\n      anchor:=userMsheet.Cells(lastrow + 1, \"A\"), _\n      Address:=\"\", _\n      SubAddress:=\"'\" &amp; ActiveSheet.Name &amp; \"'!\" _\n          &amp; Cells(salesNo - 1, 3).Address, _\n      TextToDisplay:=usernameComboBox.Value\n</code></pre>\n</blockquote>\n\n<p>EDIT: Here is what I'm using:</p>\n\n<pre><code>Sub whatever()\n\n  ActiveSheet.Hyperlinks.Add _\n      anchor:=Range(\"A6\"), _\n      Address:=\"\", _\n      SubAddress:=\"'\" &amp; ActiveSheet.Name &amp; \"'!\" &amp; Cells(6, 3).Address, _\n      TextToDisplay:=\"Whatever\"\n\nEnd Sub\n</code></pre>\n\n<p>Your Code:</p>\n\n<pre><code>With userMsheet\n  lastrow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  .Hyperlinks.Add _\n  anchor:=.Cells(lastrow + 1, \"A\"), _\n  Address:=\"\", _\n  SubAddress:=\"'\" &amp; ActiveSheet.Name &amp; \"'!\" _\n      &amp; Cells(salesNo - 1, 3).Address, _\n  TextToDisplay:=usernameComboBox.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10778515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63da38fcec154816e6534a3c1d4a169c?s=128&d=identicon&r=PG&f=1", "display_name": "beginnercoder123", "link": "https://stackoverflow.com/users/10778515/beginnercoder123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 53909511, "answer_count": 2, "score": 2, "last_activity_date": 1545787626, "creation_date": 1545619602, "last_edit_date": 1545620692, "question_id": 53908713, "link": "https://stackoverflow.com/questions/53908713/how-to-fix-application-defined-or-object-defined-error-for-this-specific-line-of", "title": "How to fix Application Defined or Object Defined Error for this specific line of code?", "body": "<p>Can't seem to make the code work despite using spacing and operators around the code, can't pinpoint exact where the problem lies</p>\n\n<p>Tried placing operators many times but still ended up with errors for example Expected: end of statement, as such this is the line of code that was highlighted:</p>\n\n<pre><code>userMsheet.Cells(lastrow + 1, \"A\").Formula = \"=HYPERLINK(\" &amp; \"#\" &amp; \nActiveSheet.Name &amp; \"!\" &amp; Cells(salesNo - 1, 3).Address &amp; \",\" &amp; \nusernameComboBox.Value &amp; \")\"\n</code></pre>\n\n<p>Expected Result: The code should create a hyperlink in another worksheet when this button in the userform is pressed</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545637380, "post_id": 53908664, "comment_id": 94665260, "body": "You really don&#39;t seem to need what you&#39;re asking for. In fact you already know in advance both the values (i.e.: &quot;Monday&quot;, &quot;Tuesday&quot;...) of the cells your variables are supposed to reference and their addresses (i.e.: &quot;I1&quot;, &quot;J1&quot;, ...) hence the searched <i>nominal</i> equivalence between your variables name (again: &quot;Monday&quot;, Tuesday&quot;...) and the values in the cells you already know they are in, isn&#39;t useful in any way. You may want to add some more explanation about why it would be."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545637783, "creation_date": 1545637783, "answer_id": 53910652, "question_id": 53908664, "link": "https://stackoverflow.com/questions/53908664/how-to-use-the-value-of-a-cell-as-variable-that-has-been-previously-stored/53910652#53910652", "title": "how to use the value of a cell as variable that has been previously stored", "body": "<p>In my opinion on option is to name the range for each day and get its sum afterwards.</p>\n\n<pre><code>Option Explicit\n\nSub dayweek()\n\n    Dim i As Long\n    Dim Monday As Range, Tuesday As Range, Wednesday As Range, Thursday As Range, Friday As Range\n    Dim Result As Double\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set Monday = .Range(Cells(2, i), Cells(2, i + 4))\n\n        Set Tuesday = .Range(Cells(2, i - 1), Cells(2, i + 3))\n\n        Set Wednesday = .Range(Cells(2, i - 2), Cells(2, i + 2))\n\n        Set Thursday = .Range(Cells(2, i - 3), Cells(2, i + 1))\n\n        Set Friday = .Range(Cells(2, i - 4), Cells(2, i))\n\n        Result = Application.WorksheetFunction.Sum(Monday)\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9904313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9904313", "link": "https://stackoverflow.com/users/9904313/user9904313"}, "edited": false, "score": 0, "creation_date": 1545661032, "post_id": 53910932, "comment_id": 94672243, "body": "Thank you. The resize function served me as inspiration. Anyway, do you know how to reference a variable from the value of a cell?  Eg: I have a value in cell A1 equals to var1, and i have defined var1 as for example range(&quot;b1&quot;,&quot;b4&quot;).select. How could i do an &quot;indirect&quot; of the cell A1 to select range(&quot;b1&quot;,&quot;b4&quot;)?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 9904313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9904313", "link": "https://stackoverflow.com/users/9904313/user9904313"}, "edited": false, "score": 0, "creation_date": 1545669122, "post_id": 53910932, "comment_id": 94674514, "body": "You are welcome. As for the <i>&quot;how to reference a variable from the value of a cell? &quot;</i>, I don&#39;t get you: you cannot set a variable to <code>range(&quot;b1&quot;,&quot;b4&quot;).select</code>, while you can assign it a value or set it to an object reference"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1545639769, "creation_date": 1545639769, "answer_id": 53910932, "question_id": 53908664, "link": "https://stackoverflow.com/questions/53908664/how-to-use-the-value-of-a-cell-as-variable-that-has-been-previously-stored/53910932#53910932", "title": "how to use the value of a cell as variable that has been previously stored", "body": "<p>Following my comment, I'd advise you to simply use an array to store the sum results and then write them in wanted cells:</p>\n\n<pre><code>Sub dayweek()\n    Dim startColumn As Long, nColumns As Long, jCol As Long\n\n    startColumn = 9\n    nColumns = 5\n\n    ReDim results(0 To nColumns - 1) As Long ' array storing the results\n\n    For jCol = 0 To nColumns - 1\n        results(jCol) = IIf(Application.WorksheetFunction.Sum(Cells(2, startColumn - jCol).Resize(, nColumns)) &lt; 2, 1, 0)\n    Next\n    Cells(2, startColumn).Resize(, nColumns).Value = results\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9904313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9904313", "link": "https://stackoverflow.com/users/9904313/user9904313"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53910932, "answer_count": 2, "score": 0, "last_activity_date": 1578544045, "creation_date": 1545618911, "last_edit_date": 1578544045, "question_id": 53908664, "link": "https://stackoverflow.com/questions/53908664/how-to-use-the-value-of-a-cell-as-variable-that-has-been-previously-stored", "title": "how to use the value of a cell as variable that has been previously stored", "body": "<p>Here is my problem:</p>\n\n<p>I have a cell, let\u00b4s say I1, with the property value equals to <code>Monday</code>.</p>\n\n<p>Previously i have stored <code>Monday=</code> as a sum of a range.</p>\n\n<p>I would need to reference the cell I1 and get the sum in order to compare the result with an if statement.</p>\n\n<p>I need the macro to fill a certain number of \"1s\" depending on the restriction for each day of the week if <code>Cells(2, i).Offset(-1, 0).Value &lt; 2 Then</code></p>\n\n<pre><code>Sub dayweek()\n\n    Dim i As Byte, Monday As Byte, Tuesday As Byte, Wednesday As Byte, Thursday As Byte, Friday As Byte\n    i = 9\n\n    Monday = Application.WorksheetFunction.Sum(Range(Cells(2, i), Cells(2, i + 4)))\n\n    Tuesday = Application.WorksheetFunction.Sum(Range(Cells(2, i - 1), Cells(2, i + 3)))\n\n    Wednesday = Application.WorksheetFunction.Sum(Range(Cells(2, i - 2), Cells(2, i + 2)))\n\n    Thursday = Application.WorksheetFunction.Sum(Range(Cells(2, i - 3), Cells(2, i + 1)))\n\n    Friday = Application.WorksheetFunction.Sum(Range(Cells(2, i - 4), Cells(2, i)))\n\n    Do While i &lt; 14\n        If Cells(2, i).Offset(-1, 0).Value &lt; 2 Then 'In this cell i have the value \"monday\",\"tuesday\", etc...\n\n            Cells(2, i).Value = 1\n            i = i + 1\n        Else\n            Cells(2, i).Value = 0\n            i = i + 1\n        End If\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "optimization"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1545619279, "post_id": 53908636, "comment_id": 94662028, "body": "seems like you should be able to combine these by putting the comma check if just after the previous if"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545619452, "post_id": 53908636, "comment_id": 94662043, "body": "The second If statement is easy, but can&#39;t you write the first one without FormulaR1C1? BTW I&#39;m on it. Can I use calculating last row for the second If statement?"}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545620265, "post_id": 53908636, "comment_id": 94662154, "body": "@VBasic2008 Thank you! Can definitely use calculating last row for the second if statement. The formula for the first one would just be A2 and C2, respectively instead of the RC statements."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545621963, "post_id": 53908875, "comment_id": 94662339, "body": "Thank you! I&#39;m not sure what you mean by simplification of the first code - can you please explain? The formula in the first code be simplified to just =get_areas(C2) if there was a way to set the range of cells to only be cells that are blank in column J and that start with &quot;Master&quot; in column A, and then put an IFERROR clause somewhere in the code to make those values blank."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545622354, "post_id": 53908875, "comment_id": 94662390, "body": "@VictoriaG: I meant getting rid of formulaR1C1. But ok, I guess you cannot so I&#39;ll try like that. Will need at least an hour."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545624355, "post_id": 53908875, "comment_id": 94662632, "body": "@VictoriaG: This might be it. Not sure what is happening in &#39;r.Text&#39;. I hope it&#39;ll work since I&#39;ve noticed you are suffering for days on this project."}, {"owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545625819, "post_id": 53908875, "comment_id": 94662834, "body": "THANK YOU!!! I tried the code for Sub FillEmptyEasy and received an error about an object not being defined, but the other code worked well. And months, not days :)"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "edited": false, "score": 0, "creation_date": 1545626774, "post_id": 53908875, "comment_id": 94663009, "body": "@VictoriaG: Both easy versions&#39; last line was wrong. Just remove &#39;Set&#39;. Sorry. I&#39;ve edited the answer."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 2, "last_activity_date": 1545626690, "last_edit_date": 1545626690, "creation_date": 1545621767, "answer_id": 53908875, "question_id": 53908636, "link": "https://stackoverflow.com/questions/53908636/speeding-up-vba-code-for-if-then-statement-with-formula/53908875#53908875", "title": "Speeding Up VBA Code for If Then Statement with Formula", "body": "<h1>Speedup: Arrays</h1>\n\n<h2>1. Code</h2>\n\n<p>It is unbelievable that you do not need formulaR1C1 to get a formula into the range when pasting from the array into range. But it's working on my computer. To conclude, the same principle from the second code is applied on the first: <strong>Range into Array, Loop and Array into Range</strong>. It doesn't get faster than this. The other idea for the first code was to create a range union and then paste the formula in one go.</p>\n\n<pre><code>Sub FillEmpty()\n\n  Const cCol As Variant = \"J\"      ' Column Letter/Number\n  Const cFirst As Long = 2         ' First Row\n\n  Dim vntFE As Variant             ' Range Array\n  Dim i As Long                    ' Range Array Rows Counter\n\n  ' Paste range into array.\n  vntFE = Cells(cFirst, cCol).Resize(Cells(Rows.Count, cCol) _\n      .End(xlUp).Row - cFirst + 1)\n\n  ' Loop through array and perform calculation.\n  For i = 1 To UBound(vntFE)\n    If vntFE(i, 1) = \"\" Then vntFE(i, 1) = \"=IFERROR((IF(LEFT(RC[-9],6)\" _\n        &amp; \"=\"\"master\"\", get_areas(RC[-7]), \"\"\"\")),\"\"\"\")\"\n  Next\n\n  ' Paste array into range.\n  Cells(cFirst, cCol).Resize(Cells(Rows.Count, cCol) _\n      .End(xlUp).Row - cFirst + 1) = vntFE\n\nEnd Sub\n\nSub FillEmptyEasy()\n\n  Const cCol As Variant = \"J\"      ' Column Letter/Number\n  Const cFirst As Long = 2         ' First Row\n\n  Dim rng As Range                 ' Range\n  Dim vntFE As Variant             ' Range Array\n  Dim LastRow As Long              ' Last Row\n  Dim i As Long                    ' Range Array Rows Counter\n\n  ' Calculate Last Row.\n  LastRow = Cells(Rows.Count, cCol).End(xlUp).Row\n  ' Calculate Range.\n  Set rng = Cells(cFirst, cCol).Resize(LastRow - cFirst + 1)\n  ' Paste range into array.\n  vntFE = rng\n\n  ' Loop through array and perform calculation.\n  For i = 1 To UBound(vntFE)\n    If vntFE(i, 1) = \"\" Then vntFE(i, 1) = \"=IFERROR((IF(LEFT(RC[-9],6)\" _\n        &amp; \"=\"\"master\"\", get_areas(RC[-7]), \"\"\"\")),\"\"\"\")\"\n  Next\n\n  ' Paste array into range.\n  rng = vntFE\n\nEnd Sub\n</code></pre>\n\n<h2>2. Code</h2>\n\n<pre><code>Sub NoComma()\n\n  Const cCol As Variant = \"J\"      ' Column Letter/Number\n  Const cFirst As Long = 2         ' First Row\n\n  Dim vntNoC As Variant            ' Range Array\n  Dim i As Long                    ' Range Array Rows Counter\n\n  ' Paste range into array.\n  vntNoC = Cells(cFirst, cCol).Resize(Cells(Rows.Count, cCol) _\n      .End(xlUp).Row - cFirst + 1)\n\n  ' Loop through array and perform calculation.\n  For i = 1 To UBound(vntNoC)\n    If Right(vntNoC(i, 1), 1) = \",\" Then _\n        vntNoC(i, 1) = Left(vntNoC(i, 1), Len(vntNoC(i, 1)) - 1)\n  Next\n\n  ' Paste array into range.\n  Cells(cFirst, cCol).Resize(Cells(Rows.Count, cCol) _\n      .End(xlUp).Row - cFirst + 1) = vntNoC\n\nEnd Sub\n\n\nSub NoCommaEasy()\n\n  Const cCol As Variant = \"J\"      ' Column Letter/Number\n  Const cFirst As Long = 2         ' First Row\n\n  Dim rng As Range                 ' Range\n  Dim vntNoC As Variant            ' Range Array\n  Dim lastrow As Long              ' Last Row\n  Dim i As Long                    ' Range Array Rows Counter\n\n  ' Calculate Last Row.\n  lastrow = Cells(Rows.Count, cCol).End(xlUp).Row\n  ' Calculate Range.\n  Set rng = Cells(cFirst, cCol).Resize(lastrow - cFirst + 1)\n  ' Paste range into array.\n  vntNoC = rng\n\n  ' Loop through array and perform calculation.\n  For i = 1 To UBound(vntNoC)\n    If Right(vntNoC(i, 1), 1) = \",\" Then _\n        vntNoC(i, 1) = Left(vntNoC(i, 1), Len(vntNoC(i, 1)) - 1)\n  Next\n\n  ' Paste array into range.\n  rng = vntNoC\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9881391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578717c049d664edc1614f1b585d7cb0?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria G", "link": "https://stackoverflow.com/users/9881391/victoria-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 53908875, "answer_count": 1, "score": 1, "last_activity_date": 1578544066, "creation_date": 1545618583, "last_edit_date": 1578544066, "question_id": 53908636, "link": "https://stackoverflow.com/questions/53908636/speeding-up-vba-code-for-if-then-statement-with-formula", "title": "Speeding Up VBA Code for If Then Statement with Formula", "body": "<p>I currently have two if then VBA codes, that are running extremely slow for my large data set and am looking for ways to optimize and speed them up. </p>\n\n<p>The first formula is looking in a range of cells in column J that have a value in column A, and if they are blank in J then entering in a formula that contains a user defined function. </p>\n\n<p>The second code is looking to see if any of the values in column J end in a <code>,</code> and if they do then remove that comma. Any help would be greatly appreciated! </p>\n\n<pre><code>Sub FillEmpty()\n    Dim r As Range, LastRow As Long\n    LastRow = Cells(Rows.Count, 1).End(xlUp).row\n    For Each r In Range(\"J2:J\" &amp; LastRow)\n        If r.Text = \"\" Then r.FormulaR1C1 = _\n           \"=IFERROR((IF(LEFT(RC[-9],6)=\"\"master\"\", get_areas(RC[-7]), \"\"\"\")),\"\"\"\")\"\n    Next r\nEnd Sub\n\nSub NoComma()\n    Dim c As Range\n    For Each c In Range(\"J:J\")\n        With c\n            If Right(.Value, 1) = \",\" Then .Value = Left(.Value, Len(.Value) - 1)\n        End With\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6913344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95ce970f14d7da25d5a9fd93327fde62?s=128&d=identicon&r=PG&f=1", "display_name": "StealthPython", "link": "https://stackoverflow.com/users/6913344/stealthpython"}, "edited": false, "score": 1, "creation_date": 1545610634, "post_id": 53908092, "comment_id": 94660871, "body": "Not sure why I didn&#39;t think of this, must be the eggnog kicking in. Thanks for the suggestion, definitely will help in keep it organized in the future too."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1545637126, "last_edit_date": 1545637126, "creation_date": 1545609745, "answer_id": 53908092, "question_id": 53907937, "link": "https://stackoverflow.com/questions/53907937/subtracting-month-values-in-a-table/53908092#53908092", "title": "Subtracting month values in a table", "body": "<p>Why not have your data as an Excel table and create a pivottable of it with month subtotal rows? I would have the date field as an actual date field but format to appear as you want. Also add month and year fields to assist with later grouping. You can use Year and Month functions applied to date field to create these additional columns. Setting up your data properly at the start makes this an easy to maintain format.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zHJvB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zHJvB.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then just add a button to the sheet associated with code to refresh the pivottable? Or just right click refresh if this is the only action required.</p>\n\n<pre><code>Worksheets(\"SheetName\").PivotTables(\"PivotTableName\").PivotCache.Refresh\n</code></pre>\n\n<p>You could even put inside a worksheet_change event.</p>\n"}], "owner": {"reputation": 113, "user_id": 6913344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95ce970f14d7da25d5a9fd93327fde62?s=128&d=identicon&r=PG&f=1", "display_name": "StealthPython", "link": "https://stackoverflow.com/users/6913344/stealthpython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 53908092, "answer_count": 1, "score": 0, "last_activity_date": 1545637126, "creation_date": 1545607728, "question_id": 53907937, "link": "https://stackoverflow.com/questions/53907937/subtracting-month-values-in-a-table", "title": "Subtracting month values in a table", "body": "<p>I have a 'summary' table, where the first column is the date the values were taken on, and subsequent columns just data. \nI'm trying to make it so that when I press a button, data is entered, but if there is a change in month, a 'total row' (aka just another row that i can set values to) is inserted. </p>\n\n<p>I can't figure out how to do the if statement month check. </p>\n\n<p>Tried googling everything, couldn't really find anything specific to this, only bunch of pieces that i can't figure out how to assemble.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim dtbl As ListObject\nDim ss As Worksheet\nDim newrow As ListRow\n\n\nSet ss = Worksheets(\"Summary\")\nSet dtbl = ss.ListObjects(\"Summary_Table\")\nDim last As Long\nDim slast As Long\n\nlast = dtbl.Range.Rows.Count\nslast = dtbl.Range.Rows.Count - 1\n\nWith dtbl\n    If Month(.Cells(last, 1)) - Month(.Cells(slast, 1)) = 0 Then\n        'do nothing\n    Else\n        Set newrow = tbl.ListRows.Add     'need to add above, not below\n            With newrow\n                .Range(1) = 1 'replace with desired values\n                .Range(2) = 2\n            End With\n    End If\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Summary Table:</p>\n\n<pre><code>December 5    data1    data2    data3\nDecember 7    data1    data2    data3\n...\nDecember 31   data1   data2   data3\nTOTAL         SUM(DATA1)   ...   ...\nJanuary 3    data1    data2   data3\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10825204"}, "is_accepted": true, "score": 1, "last_activity_date": 1545601299, "creation_date": 1545601299, "answer_id": 53907363, "question_id": 53907256, "link": "https://stackoverflow.com/questions/53907256/using-both-first-row-of-data-and-last-row-of-data-within-a-formula-e-g-match/53907363#53907363", "title": "Using both first row of data and last row of data within a formula e.g match", "body": "<p>You need to concatenate the first and last row vars into the string that represents your formula.</p>\n\n<pre><code>Dim alr As Long,  ast As Long\n\nalr = Range(\"D\" &amp; rows.count).End(xlUp).Row\nast = Range(\"D1\").End(xlDown).Row + 2\n\nrange(\"B\" &amp; ast &amp; \":B\" &amp; alr).FormulaR1C1 = _\n     \"=MATCH(RC[3], R\" &amp; ast &amp; \"C8:R\" &amp; alr &amp; \"C8, 0)\"\n</code></pre>\n\n<p>You can write the entire 'austofill' range of formulas at once.</p>\n"}], "owner": {"reputation": 33, "user_id": 10709814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XhzzY.png?s=128&g=1", "display_name": "Younis", "link": "https://stackoverflow.com/users/10709814/younis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53907363, "answer_count": 1, "score": 1, "last_activity_date": 1545667533, "creation_date": 1545600140, "last_edit_date": 1545667533, "question_id": 53907256, "link": "https://stackoverflow.com/questions/53907256/using-both-first-row-of-data-and-last-row-of-data-within-a-formula-e-g-match", "title": "Using both first row of data and last row of data within a formula e.g match", "body": "<p>I need Excel to identify the first row of data used and the last row of data used.</p>\n\n<p>I want to write a match formula in a cell next to my data and starting with the same row and auto fill/copy till last row.</p>\n\n<p>For example the first row was 30 and the last row was 50.</p>\n\n<p>My formula will be in Cell B30 and it will be =match(E30,$H$30:$H$50,0)\nthen auto fill B30 until B50</p>\n\n<pre><code>Dim alr As Long  (lastrow)  \nalr = Range(\"D50000\").End(xlUp).Row\n\n\nDim ast As Long (firstrow)\nast = Range(\"D1\").End(xlDown).Row + 2\n\n\nDim rng1 As String (austofill range)\nrng1 = \"B\" &amp; ast &amp; \":\" &amp; \"B\" &amp; alr\n\nRange(\"B\" &amp; ast).Select\nActiveCell.FormulaR1C1 = \"=MATCH(RC[3],RastC8:RalrC8,0)\"\nActiveCell.Copy\nRange(rng1).PasteSpecial\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1545607321, "post_id": 53907195, "comment_id": 94660385, "body": "If you use an if statement, it looks like an error with no end."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1545601145, "post_id": 53907277, "comment_id": 94659155, "body": "The problem is by splitting it up, the workbook that gets opened isn&#39;t the ActiveWorkbook so it gives me an error &quot;Run-time error &#39;13: Type mismatch&quot; when it gets to your second line. Suggestions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259118"}, "edited": false, "score": 0, "creation_date": 1545616571, "post_id": 53907277, "comment_id": 94661674, "body": "Do you have a Dim statement relating to galreqws earlier in your code?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1545600617, "last_edit_date": 1545600617, "creation_date": 1545600305, "answer_id": 53907277, "question_id": 53907195, "link": "https://stackoverflow.com/questions/53907195/setting-a-variable-to-the-result-of-workbooks-open/53907277#53907277", "title": "Setting a variable to the result of Workbooks.Open", "body": "<p>No <strong><em>space</em></strong> after <em>This</em>:</p>\n\n<pre><code>Sub qwerty()\n    Workbooks.Open Filename:=ThisWorkbook.Path &amp; \"\\qwerty.xlsm\"\n    Set galreqws = ActiveWorkbook\nEnd Sub\n</code></pre>\n\n<p>basically replace:</p>\n\n<pre><code>This workbook.Path\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>ThisWorkbook.Path\n</code></pre>\n\n<p><em>(I use two lines of code to avoid confusing myself)</em></p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1545602102, "post_id": 53907383, "comment_id": 94659357, "body": "user10825204 Used your first option but still came back with error &quot;Run-time error &#39;13: Type mismatch.&quot; Could that be caused by a Dim or Set somewhere else in my code or is something else causing it?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10825204"}, "is_accepted": true, "score": 1, "last_activity_date": 1545604094, "last_edit_date": 1545604094, "creation_date": 1545601596, "answer_id": 53907383, "question_id": 53907195, "link": "https://stackoverflow.com/questions/53907195/setting-a-variable-to-the-result-of-workbooks-open/53907383#53907383", "title": "Setting a variable to the result of Workbooks.Open", "body": "<p>If you are setting a var to the result of the Workbooks.Open method, bracket your parameters.</p>\n\n<pre><code>dim galreqws as workbook    'could also be dim galreqws as object\nSet galreqws = Workbooks.Open(FileName:=ThisWorkbook.Path &amp; \"\\galreq.xlsx\")\n\n'alternate\nwith  Workbooks.Open(FileName:=ThisWorkbook.Path &amp; \"\\galreq.xlsx\")\n    debug.print .name\n    debug.print .fullname\n    debug.print .worksheets(1).name\n    'work with galreq.xlsx here\nend with\n</code></pre>\n\n<p>If you are not setting an object var then leave the brackets out.</p>\n\n<pre><code>Workbooks.Open FileName:=ThisWorkbook.Path &amp; \"\\galreq.xlsx\"\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 53907383, "answer_count": 2, "score": 0, "last_activity_date": 1548373042, "creation_date": 1545599593, "last_edit_date": 1548373042, "question_id": 53907195, "link": "https://stackoverflow.com/questions/53907195/setting-a-variable-to-the-result-of-workbooks-open", "title": "Setting a variable to the result of Workbooks.Open", "body": "<p>Below is what I have but I get an error </p>\n\n<blockquote>\n  <p>Compile Error: Expected end of statement.</p>\n</blockquote>\n\n<pre><code>Set galreqws = Workbooks.Open FileName:=ThisWorkbook.Path &amp; \"\\galreq.xlsx\"\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1545598808, "post_id": 53907013, "comment_id": 94658693, "body": "You are correct, <code>Worksheet_Change</code> does not fire when a cell function recalculates. If you know what cells that function in <code>A1</code> depends on, then track changes in those cells instead. Otherwise handle the <code>Worksheet_Calculate</code> event."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6627604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eOkQT.jpg?s=128&g=1", "display_name": "aic5", "link": "https://stackoverflow.com/users/6627604/aic5"}, "is_accepted": false, "score": 0, "last_activity_date": 1545610525, "last_edit_date": 1545610525, "creation_date": 1545609448, "answer_id": 53908075, "question_id": 53907013, "link": "https://stackoverflow.com/questions/53907013/how-to-detect-the-change-of-the-value-of-a-given-cell-by-a-function/53908075#53908075", "title": "how to detect the change of the value of a given cell by a function", "body": "<p>One simple way is to create a function that takes the cells you would like to track as an argument. That way, changes to the cell values (arguments) would generate a call to the tracking function. </p>\n\n<p>Something like this will track how many times the function is called: </p>\n\n<pre><code>Dim i As Integer\nFunction tracker(c As Variant) As Integer\n    i = i + 1\n    tracker = i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10826941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91043e11bc9a72627dd26f86b8e80ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/10826941/yassine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545610525, "creation_date": 1545597734, "question_id": 53907013, "link": "https://stackoverflow.com/questions/53907013/how-to-detect-the-change-of-the-value-of-a-given-cell-by-a-function", "title": "how to detect the change of the value of a given cell by a function", "body": "<p>I like that you gave me a solution for the following problems:\nI have financial data that change randomly in a cell, saying A1, provided by a software of finance, I want to record these data one after one in a column, I already wrote this small code but it does not detect the change in the value of A1 because cell A1 contains a function given by the software</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Application.Intersect(Range(\"A1\"), Range(Target.Address)) Is Nothing Then\n    Call test\nEnd If\nEnd Sub\n\nSub test()\nStatic n As Integer\nn = Cells(1, 3).Value ' used for the faste verification of empty cells \n    While Not IsEmpty(Cells(n, 1))\n        n = n + 1\n    Wend\n    Cells(n, 1).Value = Cells(1, 1).Value\n    Cells(1, 3).Value = n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545759762, "post_id": 53906721, "comment_id": 94690481, "body": "<i>at the bottom</i>, <i>row UNDERNEATH</i> Isn&#39;t it the same thing?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545760281, "post_id": 53906721, "comment_id": 94690570, "body": "And it&#39;s not clear what is <i>table</i> for you. Is it a <code>Range</code> or <code>ListObject</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10826897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phAQE.jpg?s=128&g=1", "display_name": "Dan4ya", "link": "https://stackoverflow.com/users/10826897/dan4ya"}, "edited": false, "score": 0, "creation_date": 1545671857, "post_id": 53907912, "comment_id": 94675135, "body": "Thank you for your help, however this code is causing the same problem of moving the row from table 1 to the row underneath the last row of table 2.  I am pretty sure the code has to reference the table using List Object references or possibly a PasteSpecial command, but I am not familiar with using them."}, {"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "reply_to_user": {"reputation": 21, "user_id": 10826897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phAQE.jpg?s=128&g=1", "display_name": "Dan4ya", "link": "https://stackoverflow.com/users/10826897/dan4ya"}, "edited": false, "score": 0, "creation_date": 1545672058, "post_id": 53907912, "comment_id": 94675180, "body": "can you explain me if you want the data from last empty row or no...? Why i don&#39;t understand well what you want..."}, {"owner": {"reputation": 21, "user_id": 10826897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phAQE.jpg?s=128&g=1", "display_name": "Dan4ya", "link": "https://stackoverflow.com/users/10826897/dan4ya"}, "edited": false, "score": 0, "creation_date": 1545707541, "post_id": 53907912, "comment_id": 94680719, "body": "Yes I want the data in the last empty row of the table, which requires a new row of the table to be created and the data pasted into that new row.  That is where I am having trouble.  Everything I try pastes the data on the row below the entire table instead of pasting it to a row in the table... So for instance if my table row ends on row 80, I want the table to create a row in row 81 and paste the information in that row so it is part of the table.  I apologize if I am not as clear as I need to be, I am new to VBA and am teaching myself.  Thank you for your assistance with this!"}, {"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "reply_to_user": {"reputation": 21, "user_id": 10826897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phAQE.jpg?s=128&g=1", "display_name": "Dan4ya", "link": "https://stackoverflow.com/users/10826897/dan4ya"}, "edited": false, "score": 0, "creation_date": 1545735723, "post_id": 53907912, "comment_id": 94685331, "body": "@Dan4ya i have updated the post... Keep me updated...so i have understood your problem... :)"}], "tags": [], "owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "is_accepted": false, "score": 0, "last_activity_date": 1545735648, "last_edit_date": 1545735648, "creation_date": 1545607329, "answer_id": 53907912, "question_id": 53906721, "link": "https://stackoverflow.com/questions/53906721/transfer-data-row-from-table-to-table-on-different-sheet/53907912#53907912", "title": "Transfer Data Row from Table to Table on different sheet", "body": "<p>If i understood your question you can try this code:\nExecute the macro when you have the sheet1 active</p>\n\n<pre><code>Sub TRANSFER_DATA()\nDim lastrow, i As Long\nDim ADCell as Integer\n\nADCell=30 ' control the column AD\n'control how many data there are in column A. If you want count how many rows\n'with ColumnAD change 1 in 30 (lastrow = Cells(rows.count,30).End(xlUp).Row)\nlastrow = Cells(rows.count, 1).End(xlUp).Row \nFor i = 2 To lastrow\n    If Cells(i, ADCell) &gt; 0 Then\n        rows(i &amp; \":\" &amp; i).Select\n        Selection.Cut Worksheets(\"Sheet2\").Range(\"A\" &amp; rows.count).End(xlUp).Offset(1)\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>I tried the code and works.</p>\n\n<blockquote>\n  <p>UPDATED THE POST AFTER YOUR COMMENT</p>\n</blockquote>\n\n<pre><code>Sub TRANSFER_DATA()\nDim lastrow, i, ls As Long\nDim ADCell as Integer\n\nADCell=30 ' control the column AD\n'control how many data there are in column A. If you want count how many rows\n'with ColumnAD change 1 in 30 (lastrow = Cells(rows.count,30).End(xlUp).Row)\nlastrow = Cells(rows.count, 1).End(xlUp).Row \nFor i = 2 To lastrow\n    If Cells(i, ADCell) &gt; 0 Then\n        rows(i &amp; \":\" &amp; i).Select\n        Selection.Cut Worksheets(\"Sheet2\").Range(\"A\" &amp; rows.count).End(xlUp).Offset(1)\n    End If\nNext i\nWith Sheets(\"sheet2\")\n\n  ls = .Cells(.rows.count, ADCell).End(xlUp).Row\n  .ListObjects(\"TableName\").Resize Range(\"$A$1:$AD$\" &amp; ls)\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>the updated code have another variable, ls. This variable has the number of not empty rows of sheet2. ListObjects.(\"name of your table\") insert the new data (rows) into the table.</p>\n\n<p>I hope this helps</p>\n"}], "owner": {"reputation": 21, "user_id": 10826897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phAQE.jpg?s=128&g=1", "display_name": "Dan4ya", "link": "https://stackoverflow.com/users/10826897/dan4ya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1545735648, "creation_date": 1545594676, "question_id": 53906721, "link": "https://stackoverflow.com/questions/53906721/transfer-data-row-from-table-to-table-on-different-sheet", "title": "Transfer Data Row from Table to Table on different sheet", "body": "<p>I am a beginner with VBA and I am running into a problem with my Transfer Data code.  I am trying to trasfer automatically transfer a row of data from one table to a new row at the bottom of another table when a date is entered into the cell(Column \"AD\"), however when I try it the data is transferred to the the row UNDERNEATH the last row of the table. </p>\n\n<pre><code>Sub TRANSFER_DATA()\n\nFor Each Cell In Worksheets(\"Sheet1\").Range(\"AD2:AD1000\")\nIf Cell.Value &gt; 0 Then\n    matchRow = Cell.Row\n    Rows(matchRow &amp; \":\" &amp; matchRow).Select\n    Selection.Cut\n\n    Sheets(\"Sheet2\").Select\n    ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\nEnd If\nNext Cell\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated because i'm losing my mind!</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545593194, "post_id": 53906413, "comment_id": 94657530, "body": "<i>&quot;I have to use VBA because users could delete any formulas in cells.&quot;</i> - or you could just lock the cells that you don&#39;t want users to be able to change :)"}, {"owner": {"reputation": 11, "user_id": 10826808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce5855b0ef5bacc5884fdebe7156442b?s=128&d=identicon&r=PG&f=1", "display_name": "susezko", "link": "https://stackoverflow.com/users/10826808/susezko"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545596955, "post_id": 53906413, "comment_id": 94658371, "body": "Hi dwirony, unfortunately I cannot, because I didn&#39;t mention that there&#39;s second reason: in some cases users will write a data manually, so I cannot lock whole column."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545602512, "post_id": 53906413, "comment_id": 94659418, "body": "I didn&#39;t say lock a whole column, I said <i>cells</i>. :)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10826808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce5855b0ef5bacc5884fdebe7156442b?s=128&d=identicon&r=PG&f=1", "display_name": "susezko", "link": "https://stackoverflow.com/users/10826808/susezko"}, "edited": false, "score": 0, "creation_date": 1545604271, "post_id": 53907360, "comment_id": 94659762, "body": "Hi @VBasic2008, that is exactly what I need! Thank you so much!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1545666780, "post_id": 53907360, "comment_id": 94673860, "body": "Nice answer! Although it looks like you forgot to use <code>cString</code> :)"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1545669046, "post_id": 53907360, "comment_id": 94674496, "body": "@dwirony: Thanks very much. Corrected."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1545668966, "last_edit_date": 1545668966, "creation_date": 1545601256, "answer_id": 53907360, "question_id": 53906413, "link": "https://stackoverflow.com/questions/53906413/excel-vba-change-cell-value-depend-to-date-next-to/53907360#53907360", "title": "Excel VBA change cell value depend to date next to", "body": "<h1>Amateur Eventing</h1>\n\n<p>The title says it all. I'm not entirely satisfied with the result, but it should be something like this, but first...</p>\n\n<h2>Issues</h2>\n\n<p>It is not clear what to do if the date isn't greater than today, so you might want to edit the lines where I have chosen <code>\"\"</code> to be returned in those cases.</p>\n\n<p>The 'major player' is the <code>DateCalc</code> Sub which is running each time the sheet is being recalculated which would be enough if column <code>M</code> was containing formulas i.e. when you change data by 'manually' adding values into the cells of column <code>M</code>, the <strong>Calculate</strong> event isn't triggered so I had to add the <strong>Change</strong> event which will then change the value in column <code>L</code> accordingly. But the <code>Calculate</code> event triggers the <code>Change</code> event multiple times so it is suppressed more or less successfully using the <code>Calculation</code> property.</p>\n\n<h2>The Code</h2>\n\n<p><strong>ThisWorkbook</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n  Sheet1.DateCalc\nEnd Sub\n</code></pre>\n\n<p><strong>Sheet1</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Activate()\n  DateCalc\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n  DateCalc\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n  Const cSource As Variant = \"M\"       ' Column Letter/Number\n  Const cTarget As Variant = \"L\"       ' Column Letter/Number\n  Const cString As String = \"PASSED\"   ' Write String\n  Const cFirst As Long = 2             ' First Data Row\n\n  If Application.Calculation = xlCalculationManual Then Exit Sub\n\n  If Val(Application.Version) &gt;= 12 Then\n    If Selection.Cells.CountLarge &gt; 1 Then Exit Sub\n   Else\n    If Selection.Cells.Count &gt; 1 Then Exit Sub\n  End If\n\n  If Not Intersect(Target, Cells(cFirst, cSource) _\n      .Resize(Cells(Rows.Count, cSource).End(xlUp).Row)) Is Nothing Then\n    If Target &gt; Date Then\n      Target.Offset(0, -1) = cString\n     Else\n      Target.Offset(0, -1) = \"\"\n    End If\n  End If\n\nEnd Sub\n\nSub DateCalc()\n\n  Application.Calculation = xlCalculationManual\n\n  Const cSource As Variant = \"M\"       ' Column Letter/Number\n  Const cTarget As Variant = \"L\"       ' Column Letter/Number\n  Const cString As String = \"PASSED\"   ' Write String\n  Const cFirst As Long = 2             ' First Data Row\n\n  Dim i As Long\n\n  For i = cFirst To Cells(Rows.Count, cSource).End(xlUp).Row\n    If Cells(i, cSource) &gt; Date Then\n      Cells(i, cSource).Offset(0, -1) = cString\n     Else\n      Cells(i, cSource).Offset(0, -1) = \"\"\n    End If\n  Next\n\n  Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10826808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce5855b0ef5bacc5884fdebe7156442b?s=128&d=identicon&r=PG&f=1", "display_name": "susezko", "link": "https://stackoverflow.com/users/10826808/susezko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1545602520, "accepted_answer_id": 53907360, "answer_count": 1, "score": -1, "last_activity_date": 1578547274, "creation_date": 1545591988, "last_edit_date": 1578547274, "question_id": 53906413, "link": "https://stackoverflow.com/questions/53906413/excel-vba-change-cell-value-depend-to-date-next-to", "closed_reason": "Needs more focus", "title": "Excel VBA change cell value depend to date next to", "body": "<p>I would like to setup cell value to specific text if current date is greater than a date next to a cell which I want to set (using VBA only. For example todays date is greater than date in cell M15, so I would like to write \"PASSED\" to cell L15). And I need set it for whole column.\nI have to use VBA because users could delete any formulas in cells.</p>\n\n<p>I have no experience with VBA, I always try to find some code examples which I can edit for my purposes, but in this case I haven't found any.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3992, "user_id": 1330560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4869869f3ab6b5c0dd7d4affddf113?s=128&d=identicon&r=PG&f=1", "display_name": "Tedinoz", "link": "https://stackoverflow.com/users/1330560/tedinoz"}, "edited": false, "score": 0, "creation_date": 1545589126, "post_id": 53906006, "comment_id": 94656588, "body": "Welcome. You said that you are &quot;getting errors&quot;. It would be helpful to describe or display the error. Provide as much information as possible so that it makes it easy for someone to assist you. You should read the help section of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and update your question with more information"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1545589354, "post_id": 53906006, "comment_id": 94656651, "body": "probably remove the square brackets <code>[]</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.changelink#example\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545592954, "last_edit_date": 1545592954, "creation_date": 1545591155, "answer_id": 53906303, "question_id": 53906006, "link": "https://stackoverflow.com/questions/53906006/excel-vba-updating-links/53906303#53906303", "title": "Excel VBA updating links", "body": "<h1>Workbooks in Folder Treatment</h1>\n\n<blockquote>\n  <ul>\n  <li>Loops through all Excel files (workbooks) in a folder, opens each    one, changes a link from one document to another, saves the changes and closes the workbook.</li>\n  </ul>\n</blockquote>\n\n<ul>\n<li><code>xlLinkTypeExcelLinks</code> is the <strong>default</strong> parameter of the <code>Type</code>\nargument of the <code>ChangeLink</code> method and can therefore be omitted.</li>\n<li><code>.Close True</code> can be used in this way because <code>SaveChanges</code> is the\n<strong>first</strong> argument of the <code>Close</code> method.</li>\n</ul>\n\n<h2>The Code</h2>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Const strOld As String = \"C:\\Users\\XX\\Documents\\[Broadstreet.xlsx]\"\n  Const strNew As String = \"C:\\Users\\XX\\Documents\\[Broadstreet2.xlsx]\"\n  Const strPath As String = \"C:\\Users\\XX\\Documents1\"\n  Const strExt As String = \"*.xls*\"\n\n  Dim strName As String\n\n  With Application\n    .ScreenUpdating = False\n    .AskToUpdateLinks = False\n  End With\n\n  On Error GoTo ProcedureExit\n\n  strName = Dir(strPath &amp; \"\\\" &amp; strExt)\n\n  Do While strName &lt;&gt; \"\"\n    With Workbooks.Open(strPath &amp; \"\\\" &amp; strName)\n      .ChangeLink strOld, strNew\n      .Close True\n    End With\n    strName = Dir\n  Loop\n\nProcedureExit:\n  With Application\n    .AskToUpdateLinks = True\n    .ScreenUpdating = True\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10826689, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-43zrv2xKWTU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYUqvGg7Lgo0aQERzG_4Ncn9tiVxg/mo/photo.jpg?sz=128", "display_name": "user10826689", "link": "https://stackoverflow.com/users/10826689/user10826689"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545592954, "creation_date": 1545588800, "question_id": 53906006, "link": "https://stackoverflow.com/questions/53906006/excel-vba-updating-links", "title": "Excel VBA updating links", "body": "<p>I am trying to set up a VBA macro to update link paths in excel. I looked up some code online and tried to put it together, and am getting errors. I am wondering if i could get some direction here. Please note that i am not a programmer by profession, just trying to reduce some manual updating work.</p>\n\n<p>Cheers!</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<pre><code>Dim FolderPath As String\nDim FSO As Object\nDim bookname As String\nDim wbook As Workbook\nDim oldname As String\nDim newname As String\n\noldname = \"C:\\Users\\XX\\Documents\\[Broadstreet.xlsx]\"\n\nnewname = \"C:\\Users\\XX\\Documents\\[Broadstreet2.xlsx]\"\n\nFolderPath = \"C:\\Users\\XX\\Documents1\"\n\n\nWith Application\n    .ScreenUpdating = False\n    .AskToUpdateLinks = False\nEnd With\n\n\nFor Each Workbook In FSO.GetFolder(FolderPath).Files\n    bookname = Workbook.Name\n\n    MsgBox (bookname)\n\n    Set wb = Workbooks.Open(FolderPath &amp; \"\\\" &amp; bookname)\n\n   ActiveWorkbook.ChangeLink oldname1, newname1, xlLinkTypeExcelLinks\n\n\n   wb.Close SaveChanges:=True\n\nNext\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10238381, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3I_uVAuIqO4/AAAAAAAAAAI/AAAAAAAAAMM/Hp9hCPhMERw/photo.jpg?sz=128", "display_name": "shakeel ahmad", "link": "https://stackoverflow.com/users/10238381/shakeel-ahmad"}, "edited": false, "score": 0, "creation_date": 1545664760, "post_id": 53907853, "comment_id": 94673333, "body": "bro I am getting error &quot;Object did not support this property type&quot; Error Code &quot;Run Time Error 438&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3259118"}, "reply_to_user": {"reputation": 67, "user_id": 10238381, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3I_uVAuIqO4/AAAAAAAAAAI/AAAAAAAAAMM/Hp9hCPhMERw/photo.jpg?sz=128", "display_name": "shakeel ahmad", "link": "https://stackoverflow.com/users/10238381/shakeel-ahmad"}, "edited": false, "score": 0, "creation_date": 1545674494, "post_id": 53907853, "comment_id": 94675746, "body": "Which line of code is causing the problem?  Use the F8 key to step through the code until you find it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3259118"}, "is_accepted": false, "score": 0, "last_activity_date": 1545621912, "last_edit_date": 1545621912, "creation_date": 1545606657, "answer_id": 53907853, "question_id": 53905626, "link": "https://stackoverflow.com/questions/53905626/copy-data-from-one-sheet-to-another-on-the-next-empty-row/53907853#53907853", "title": "copy data from one sheet to another on the next empty row", "body": "<p>To help you with this, I\u2019ll need to make the following assumptions:</p>\n\n<p>1 You clear the data in the INPUT SHEET each time prior to adding new data to copy</p>\n\n<p>2 You want to copy the entire range from columns A through J from the INPUT SHEET (your existing code seems to indicate this)</p>\n\n<p>3 I\u2019m assuming you want the date from cell E1 in the INPUT SHEET to be copied to column A next to all new data pasted into the DATABASE sheet\nTry the code out with your existing data \u2013 if it doesn\u2019t work then adjust the code to suit as best you can.  The only way to learn is to try, try again\u2026</p>\n\n<pre><code>Option Explicit\n\nSub CopyToDatabase()\nDim LastInput As Long, PasteRow As Long, LastRow As Long\n\n'Find the last row of data to copy\nLastInput = Sheets(\"INPUT SHEET\").Range(\"A3\").End(xlDown).Row\n\n'Find the row to paste the new data to\nIf Sheets(\"DATABASE\").Range(\"A2\") &lt;&gt; \"\" Then\n    PasteRow = Sheets(\"DATABASE\").Range(\"A2\").End(xlDown).Row + 1\n    Else\n    PasteRow = 2\nEnd If\n\n'Copy the data\nSheets(\"INPUT SHEET\").Range(\"A3:J\" &amp; LastInput).Copy _\nSheets(\"DATABASE\").Range(\"B\" &amp; PasteRow)\n\n'Find the last row of newly copied data\nLastRow = Sheets(\"DATABASE\").Range(\"B2\").End(xlDown).Row\n\n'Put the date next to the newly copied data\nSheets(\"DATABASE\").Range(\"A\" &amp; PasteRow &amp; \":A\" &amp; LastRow).Value _\n= Sheets(\"INPUT SHEET\").Range(\"E1\").Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10238381, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3I_uVAuIqO4/AAAAAAAAAAI/AAAAAAAAAMM/Hp9hCPhMERw/photo.jpg?sz=128", "display_name": "shakeel ahmad", "link": "https://stackoverflow.com/users/10238381/shakeel-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545621912, "creation_date": 1545585546, "last_edit_date": 1545589855, "question_id": 53905626, "link": "https://stackoverflow.com/questions/53905626/copy-data-from-one-sheet-to-another-on-the-next-empty-row", "title": "copy data from one sheet to another on the next empty row", "body": "<p>Hy Experts, I am using two excel sheets. One is input and second is Database. In the input sheet, I want to copy the entire data once I click the button on the database sheet. The macro that I am using works good. but instead of pasting the data on the next empty row it start over write the existing data. that is toataly wrong concept. I am using this macro. </p>\n\n<pre><code>Sub copydate()\n'\n' copydate Macro\n'\n\n'\n    Range(\"E1:J1\").Select\n    Selection.Copy\n    Sheets(\"DATABASE\").Select\n    Range(\"A2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"A2\").Select\n    Application.CutCopyMode = False\n    Selection.NumberFormat = \"m/d/yyyy\"\n    Range(\"A2:A75\").Select\n    Selection.FillDown\n    Sheets(\"INPUT SHEET\").Select\n    Range(\"A3:J77\").Select\n    Selection.Copy\n    Sheets(\"DATABASE\").Select\n    Range(\"B2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Selection.Columns.AutoFit\n    Columns(\"B:B\").Select\n    Application.CutCopyMode = False\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>I am using these sheets. \n<img src=\"https://i.stack.imgur.com/Aa0YW.png\" alt=\"Input Sheet\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/IqY2P.png\" alt=\"Database Screen.\"></p>\n\n<p>How can i get fiexed this problem. Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "save", "conditional-statements"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545583937, "post_id": 53905219, "comment_id": 94655403, "body": "@Acott Holtzman thanks your answer. But my first code was exactly same as your version. But this code doesn&#39;t totally allow save my workbook. but I want to save workbook when I am working on Sheet 1 and don&#39;t care about condition. I want want to check condition when I am working on Staff Target Sheet not the Daily Target Sheet."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545589290, "post_id": 53905219, "comment_id": 94656629, "body": "@Khazar - I am sorry. I forgot that condition. Try now."}, {"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545591323, "post_id": 53905219, "comment_id": 94657065, "body": "@Acott Holtzman now the code works properly. Thanks a lot for your support."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1545589277, "last_edit_date": 1545589277, "creation_date": 1545582369, "answer_id": 53905219, "question_id": 53905152, "link": "https://stackoverflow.com/questions/53905152/dont-save-sheet-if-condition-not-met/53905219#53905219", "title": "Don&#39;t save sheet if condition not met", "body": "<p>Place this code into the <code>ThisWorkbook</code> module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim staffTargets As Worksheet\n    Set staffTargets = Worksheets(\"Staff Targets\")\n\n    With staffTargets\n\n        If ActiveSheet.Name = .name Then\n\n            If .Range(\"C\" &amp; .Rows.Count).End(xlUp) &lt;&gt; .Range(\"B4\") Then\n                MsgBox \"Workbook Not Saved. Total Staff Target Amount is not equal to Total Monthly Target!\", vbCritical, \"ERROR\"\n                Cancel = True\n            End If\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 53905219, "answer_count": 1, "score": 0, "last_activity_date": 1574375336, "creation_date": 1545581736, "last_edit_date": 1574375336, "question_id": 53905152, "link": "https://stackoverflow.com/questions/53905152/dont-save-sheet-if-condition-not-met", "title": "Don&#39;t save sheet if condition not met", "body": "<p>I have a workbook with two sheets named \"Daily Target\" and \"Staff Target\".</p>\n\n<p>I need code which allows saving the workbook if working on \"Daily Target\" Sheet, regardless of any condition.</p>\n\n<p>If working on the \"Staff Target\" sheet allow saving if the condition meets otherwise do not save. </p>\n\n<pre><code>Option Explicit\n\n'I wrote that code within \"Staff Target\" sheet.\n\nSub NotSave()\n    Dim WB As Workbook\n    Set WB = Workbooks(\"Target Sales Tmplate\")\n    Dim ST As Worksheet\n    Set ST = Worksheets(\"Staff Targets\")        \n    With ST\n        If ST.Range(\"C\" &amp; Rows.Count).End(xlUp) &lt;&gt; Range(\"B4\") Then\n            WB.Close SaveChanges:=False\n            MsgBox \"Total Staff Target Amount is not equal to Total Monthly Target!\", vbCritical, \"ERROR\"\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox", "dependencies", "userform"], "comments": [{"owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "edited": false, "score": 0, "creation_date": 1545579854, "post_id": 53904814, "comment_id": 94654444, "body": "I have found a way now but it is the long way as shown in code below:"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1545599271, "post_id": 53904814, "comment_id": 94658764, "body": "(If you have something that is broadly an answer, then please post as a self-answer, rather than merging it into the question. I&#39;ve moved it for you just now.)"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1545591720, "creation_date": 1545591720, "answer_id": 53906377, "question_id": 53904814, "link": "https://stackoverflow.com/questions/53904814/vba-userform-multiple-dependent-dynamic-combobox/53906377#53906377", "title": "VBA UserForm Multiple Dependent Dynamic ComboBox", "body": "<p>One way to shorten the code is to refactor it with better syntax and assign each lookup list to a named range. </p>\n\n<pre><code>Private Sub ComboBox2_Change()\n\n  Dim index As Integer\n\n  'list ComboBox2 and look for dependency\n   index = ComboBox2.ListIndex\n   ComboBox3.Clear\n\n  Dim whichName as String\n\n  Select Case index\n      Case \"A Class\": whichName = \"aClass\" 'assumed named range scoped to worksheet\n      Case \"B Class\": whichName = \"bClass\" 'assumed named range scoped to worksheet\n  End Select\n\n  ComboBox3.List = Worksheets(\"LookupLists\").Range(whichName).Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": true, "score": 0, "last_activity_date": 1545599220, "creation_date": 1545599220, "answer_id": 53907150, "question_id": 53904814, "link": "https://stackoverflow.com/questions/53904814/vba-userform-multiple-dependent-dynamic-combobox/53907150#53907150", "title": "VBA UserForm Multiple Dependent Dynamic ComboBox", "body": "<p><em>(Posted on behalf of the question author)</em>.</p>\n\n<p>I managed to resolve my own issue as shown in code below. If anyone has a shorter method, please feel free to share.</p>\n\n<pre><code>  Private Sub ComboBox2_Change()\n\n  Dim index As Integer\n\n  'list ComboBox2 and look for dependency\n   index = ComboBox2.ListIndex\n   ComboBox3.Clear\n\n   If Me.ComboBox2.Value = \"A Class\" Then\n   With Worksheets(\"LookupLists\")\n   ComboBox3.List = .Range(\"D2:D\" &amp; .Range(\"d\" &amp; \n   Rows.Count).End(xlUp).Row).Value\n\n   End With\n   End If\n\n   If Me.ComboBox2.Value = \"B Class\" Then\n    With Worksheets(\"LookupLists\")\n    ComboBox3.List = .Range(\"E2:E\" &amp; .Range(\"e\" &amp; \n    Rows.Count).End(xlUp).Row).Value\n\n    End With\n    End If\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1545611846, "creation_date": 1545611846, "answer_id": 53908230, "question_id": 53904814, "link": "https://stackoverflow.com/questions/53904814/vba-userform-multiple-dependent-dynamic-combobox/53908230#53908230", "title": "VBA UserForm Multiple Dependent Dynamic ComboBox", "body": "<p>Try</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim Ws As Worksheet\n    Set Ws = Worksheets(\"LookupList\")\n    With Ws\n        ComboBox1.List = .Range(\"A2:A\" &amp; .Range(\"a\" &amp; Rows.Count).End(xlUp).Row).Value\n    End With\nEnd Sub\nPrivate Sub ComboBox1_Change()\n    Dim Ws As Worksheet\n    Dim rngT As Range, rngHead As Range\n    Set Ws = Worksheets(\"LookupList\")\n    Set rngHead = Ws.Range(\"a1\", \"i1\")\n\n\n    ComboBox2.Clear\n    ComboBox3.Clear\n\n    Set rngT = rngHead.Find(ComboBox1.Value, LookIn:=xlValues, Lookat:=xlPart)\n    If Not rngT Is Nothing Then\n        ComboBox2.List = Ws.Range(rngT.Offset(1, 0), rngT.End(xlDown)).Value\n    End If\n\n\nEnd Sub\nPrivate Sub ComboBox2_Change()\n    Dim Ws As Worksheet\n    Dim rngT As Range, rngHead As Range\n    Set Ws = Worksheets(\"LookupList\")\n    Set rngHead = Ws.Range(\"a1\", \"i1\")\n\n    ComboBox3.Clear\n    If ComboBox2.Value &lt;&gt; \"\" Then\n        Set rngT = rngHead.Find(ComboBox2.Value, LookIn:=xlValues, Lookat:=xlPart)\n        If Not rngT Is Nothing Then\n            ComboBox3.List = Ws.Range(rngT.Offset(1, 0), rngT.End(xlDown)).Value\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7471381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NWJnpTOyx_A/AAAAAAAAAAI/AAAAAAAAAEQ/V3EYnRqwsMk/photo.jpg?sz=128", "display_name": "LinuxPingu", "link": "https://stackoverflow.com/users/7471381/linuxpingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1506, "favorite_count": 0, "accepted_answer_id": 53907150, "answer_count": 3, "score": 0, "last_activity_date": 1578544127, "creation_date": 1545578537, "last_edit_date": 1578544127, "question_id": 53904814, "link": "https://stackoverflow.com/questions/53904814/vba-userform-multiple-dependent-dynamic-combobox", "title": "VBA UserForm Multiple Dependent Dynamic ComboBox", "body": "<p>Basically I am trying to create multiple dependent dynamic Combo Boxes on a UserForm as it pulls the values from a LookupList Worksheet as seen below</p>\n\n<p><a href=\"https://i.stack.imgur.com/2nzPp.png\" rel=\"nofollow noreferrer\">LookupList Worksheet</a></p>\n\n<p>How it should work:</p>\n\n<pre><code>ComboBox1 would list the company\nComboBox2 is dependent on ComboBox1\nComboBox3 is dependent on ComboBox2\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>ComboBox1: Company = Mercedes\nComboBox2: Mercedes Model = A Class\nComboBox3: A Class Model = AMG\n</code></pre>\n\n<p>I have tried the code below but got stuck on ComboBox2</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n'dynamically call ComboBox1 when form initialize\nWith Worksheets(\"LookupList\")\nComboBox1.List = .Range(\"A2:A\" &amp; .Range(\"a\" &amp; .Rows.Count).End(xlUp).Row).Value\n\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub ComboBox1_Change()\nDim index As Integer\n\n'list ComboBox1 and look for dependency\nindex = ComboBox1.ListIndex\nComboBox2.Clear\nComboBox3.Clear\n\n'call values in ComboBox2\nSelect Case index\nCase Is = 0\n'Calls Mercedes Car Model contents dynamically\nWith Worksheets(\"LookupList\")\nComboBox2.List = .Range(\"C2:C\" &amp; .Range(\"c\" &amp; Rows.Count).End(xlUp).Row).Value\nEnd With\n\nCase Is = 1\n'Calls BMW Car Model contents dynamically\nWith Worksheets(\"LookupList\")\nComboBox2.List = .Range(\"G2:G\" &amp; .Range(\"g\" &amp; Rows.Count).End(xlUp).Row).Value\nEnd With\n\nEnd Select\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub ComboBox2_Change()\n\nDim index As Integer\nDim verify_data As Long\n\nindex = ComboBox2.ListIndex\n\nverify_data = ComboBox2.ListIndex\n\n'Calls values in ComboBox3\nSelect Case index\n\nIf verify_data = 0 Then\n'If Mercedes A Class Model is selected from ComboBox2, list A Class model types\nCase Is = 0\nWith Workseets(\"LookupList\")\nComboBox3.List = .Range(\"D2:D\" &amp; .Range(\"d\" &amp; Rows.Count).End(xlUp).Row).Value\nEnd With\n\nEnd If\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ui-automation", "microsoft-ui-automation"], "comments": [{"owner": {"reputation": 33, "user_id": 10811232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e6cdc7978a4e6e0b61512f70c585b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/10811232/jim"}, "edited": false, "score": 0, "creation_date": 1545579654, "post_id": 53904364, "comment_id": 94654395, "body": "What I actually want is that let both of the &#39;Main&#39; window and &#39;Save as &#39; window remain minimized throught out the whole course, is it possible?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10811232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e6cdc7978a4e6e0b61512f70c585b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/10811232/jim"}, "edited": false, "score": 0, "creation_date": 1545656439, "post_id": 53908352, "comment_id": 94670864, "body": "Thank you for your help, I will try it."}], "tags": [], "owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "is_accepted": true, "score": 0, "last_activity_date": 1545614182, "creation_date": 1545614182, "answer_id": 53908352, "question_id": 53904364, "link": "https://stackoverflow.com/questions/53904364/how-to-manipulate-a-window-which-is-in-off-screen-status-by-ui-automation/53908352#53908352", "title": "How to manipulate a window which is in Off Screen status by UI Automation", "body": "<p>There are two separate VBA commands - one for popping up the \"Save As\" window, one for doing the actual save.   If this is the work book you're saving, there's</p>\n\n<p>Application.GetSaveAsFilename  - pops up the Save As dialogue and returns the file name\nWorkbook.SaveAs  - method to do the actual save.</p>\n\n<p>So you need code that separates the two statements, and detects whether your \"main\" window is minimized or not before even showing the Save As dialogue.</p>\n"}], "owner": {"reputation": 33, "user_id": 10811232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e6cdc7978a4e6e0b61512f70c585b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/10811232/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53908352, "answer_count": 1, "score": 0, "last_activity_date": 1578544161, "creation_date": 1545574962, "last_edit_date": 1578544161, "question_id": 53904364, "link": "https://stackoverflow.com/questions/53904364/how-to-manipulate-a-window-which-is-in-off-screen-status-by-ui-automation", "title": "How to manipulate a window which is in Off Screen status by UI Automation", "body": "<p>I click on the \"save\" button from a window named 'Main', then a new window named 'Save As ..' will pop up. But actually, that 'Main' window is always in minimized status and its IsOffscreen property is True showed in Tool UISPY, so when it is minimized, the 'Save As ..' window will never pop up, is there some methods to continue my procedure with the 'main' window minimized?\nThank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1214, "user_id": 4309985, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d9a46a23b2bc57d11cf9c3adda670dea?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Fan", "link": "https://stackoverflow.com/users/4309985/andrew-fan"}, "edited": false, "score": 0, "creation_date": 1545575699, "post_id": 53904242, "comment_id": 94653496, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "reply_to_user": {"reputation": 1214, "user_id": 4309985, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/d9a46a23b2bc57d11cf9c3adda670dea?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Fan", "link": "https://stackoverflow.com/users/4309985/andrew-fan"}, "edited": false, "score": 0, "creation_date": 1545595007, "post_id": 53904242, "comment_id": 94657935, "body": "@AndrewFan I have edited my post and added my code. I would like to be able to save this code somewhere, so that I can use it whenever required. That is why I thought of saving it under personal.xlsb."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "edited": false, "score": 0, "creation_date": 1545595153, "post_id": 53904354, "comment_id": 94657975, "body": "I have edited my post and added some code. Where can I save my code to run it for any excel file, even for a brand new workbook that I have opened and not saved yet? Thanks!"}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": true, "score": 1, "last_activity_date": 1545574861, "creation_date": 1545574861, "answer_id": 53904354, "question_id": 53904242, "link": "https://stackoverflow.com/questions/53904242/worksheet-calculate-does-not-run-from-personal-xlsb/53904354#53904354", "title": "Worksheet Calculate does not run from personal.xlsb", "body": "<p>PERSONAL.XLSB is a hidden workbook that doesn't usually have formulas or anything else on its sheets.  No formulas so nothing to calculate and the event never fires.</p>\n"}], "owner": {"reputation": 15, "user_id": 10821962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300578989312edd1b10d752fd2bad26c?s=128&d=identicon&r=PG&f=1", "display_name": "rocka", "link": "https://stackoverflow.com/users/10821962/rocka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53904354, "answer_count": 1, "score": 0, "last_activity_date": 1545594909, "creation_date": 1545573843, "last_edit_date": 1545594909, "question_id": 53904242, "link": "https://stackoverflow.com/questions/53904242/worksheet-calculate-does-not-run-from-personal-xlsb", "title": "Worksheet Calculate does not run from personal.xlsb", "body": "<p>My Private Sub Worksheet_Calculate() runs when I place it into Sheet1(Sheet1) as a part of VBAProject (Book1) but it doesn't when I place it into Sheet1(Sheet1) as a part of VBAProject (PERSONAL.XLSB). </p>\n\n<p>Why is that the case? What shall I do to make it run?</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim LastRow As Long\n\nLastRow = Cells(Rows.Count, 2).End(xlUp).Row\n\nCells(LastRow, 2).Offset(1, 0) = Cells(2, 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1545649420, "creation_date": 1545649420, "answer_id": 53912573, "question_id": 53904061, "link": "https://stackoverflow.com/questions/53904061/loop-to-filter-pivot-table-based-on-values-in-another-sheet/53912573#53912573", "title": "Loop to filter Pivot Table based on values in another Sheet", "body": "<p>Some Useful guidelines:</p>\n\n<p>Raw Data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xSe0G.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xSe0G.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Select the data and create a pivot table named \"pvtTest\" in Shhet 5</p>\n\n<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim pvt As PivotTable\n    Dim Pf As PivotField\n    Dim strFilter As String\n\n    'Assign to variable \"pvt\" the pivot table to work with it\n    Set pvt = Worksheets(\"Sheet5\").PivotTables(\"pvtTest\")\n\n    'Assigh to \"strFilter\" the string to filter\n    strFilter = \"A\"\n\n    'Use column \"Shop\" as a filter of pivot table\n    pvt.PivotFields(\"Shop\").Orientation = xlPageField\n\n    'Assign by which column the pivot table will be filtered\n    Set Pf = Worksheets(\"Sheet5\").PivotTables(\"pvtTest\").PivotFields(\"Shop\")\n\n    'Clear filter previous choices\n    Pf.ClearAllFilters\n\n    'Select to filter the pivot table based on the value of \"strFilter\"\n    Pf.CurrentPage = strFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1651, "user_id": 1279373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829dc85d5fbf6152cc99cf65427071d5?s=128&d=identicon&r=PG", "display_name": "spioter", "link": "https://stackoverflow.com/users/1279373/spioter"}, "is_accepted": true, "score": 0, "last_activity_date": 1545679725, "creation_date": 1545679725, "answer_id": 53917099, "question_id": 53904061, "link": "https://stackoverflow.com/questions/53904061/loop-to-filter-pivot-table-based-on-values-in-another-sheet/53917099#53917099", "title": "Loop to filter Pivot Table based on values in another Sheet", "body": "<p>For filtering by value,  my preferred method is to add more columns to the data itself, set the values by formulae,  and add those columns to the pivot</p>\n\n<p>Eg column Scope boolean  added to pivot filter, filter on only true</p>\n\n<p>Adding 30/60/90 aging column,  add this to a pivot row to group by age</p>\n\n<p>Etc</p>\n\n<p>This lets you avoid needles complexity of combining two lesser known areas of expertise vba in general  and vba specifically for pivots </p>\n"}], "owner": {"reputation": 31, "user_id": 10227884, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nfhGeJ6rJiQ/AAAAAAAAAAI/AAAAAAAABsE/l8G7Q7Y8hqI/photo.jpg?sz=128", "display_name": "Jenita Kurlawala", "link": "https://stackoverflow.com/users/10227884/jenita-kurlawala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 53917099, "answer_count": 2, "score": 0, "last_activity_date": 1545696861, "creation_date": 1545572113, "last_edit_date": 1545696861, "question_id": 53904061, "link": "https://stackoverflow.com/questions/53904061/loop-to-filter-pivot-table-based-on-values-in-another-sheet", "title": "Loop to filter Pivot Table based on values in another Sheet", "body": "<p>My objective is to filter a pivot table using a range in another sheet.</p>\n\n<p>My pivot is in Worksheets(\"Aging Report\").</p>\n\n<p>My reference data using which I want to filter is in Columns A2 and onward in Worksheets(\"Instructions\").</p>\n\n<p>The below code worked on a table which did not have pivot table.</p>\n\n<p>I need to take value from A2 then filter on (\"Client ID\") and export in Excel and save and so on with values in A3, A4, A5.</p>\n\n<pre><code>Sub Pivotfilter()\n\nDim varItemsToReplace As Variant\nDim varItem As Variant\nDim wksSource As Worksheet\nDim wksDest As Worksheet\nDim rngSource As Range\nDim rngSource2 As Range\nDim rngCell As Range\n\nSet wksSource = Worksheets(\"Instructions\")\nSet wksDest = Worksheets(\"Aging Report\")\n\nWith wksSource\n    Set rngSource = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\nEnd With\n\nFor Each rngCell In rngSource\n    With wksDest\n        ActiveSheet.PivotTables(\"PivotTable40\").PivotFields (\"Client ID\")\n        .PivotFields(rngCell.Value).Visible = True\n        Dim wb As Workbook\n        Set wb = Workbooks.Add\n        Windows(\"XXXXXXX\").Activate\n        Sheets(\"Aging Report\").Select\n        Sheets(\"Aging Report\").Copy Before:=wb.Sheets(1)\n        wb.SaveAs \"C:\\Users\\XXX\\Desktop\\SOA\\\" &amp; .Range(\"B3\").Value &amp; \" - \" &amp; .Range(\"B4\").Value &amp; \".xlsx\"\n        wb.Close\n        Windows(\"XXXXXXX.xlsm\").Activate\n    End With\nNext rngCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1545571851, "post_id": 53903993, "comment_id": 94652678, "body": "You could first insert a blank row and the copy to it."}, {"owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1545572493, "post_id": 53903993, "comment_id": 94652799, "body": "Good thinking. Done. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1545576722, "creation_date": 1545576722, "answer_id": 53904582, "question_id": 53903993, "link": "https://stackoverflow.com/questions/53903993/vba-copy-insert-a-row/53904582#53904582", "title": "VBA - copy/insert a row", "body": "<h1>Insert Shift</h1>\n\n<h2>'Object References Not Allowed' Version</h2>\n\n<pre><code>Sub CopyHeader()\n\n  Const cSrc As String = \"OriginalFunding\"  ' Source Worksheet\n  Const cTgt As String = \"FundingReturn\"    ' Target Worksheet\n  Const cSrcRng As String = \"A:A\"           ' Source Range\n  Const cTgtRng As String = \"A1\"            ' Target Range\n  Const cSearch As String = \"Learner\"       ' Search String\n\n  With ThisWorkbook.Sheets(cSrc)\n    If Not .Range(cSrcRng).Find(What:=cSearch) Is Nothing Then\n      .Range(cSrcRng).Find(What:=cSearch).EntireRow.Copy\n      .Parent.Worksheets(cTgt).Range(cTgtRng).Insert (xlShiftDown)\n      Application.CutCopyMode = False\n     Else\n      MsgBox \"'\" &amp; cSearch &amp; \"' not found.\"\n    End If\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3637, "user_id": 1945363, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff79eea1e076a9e9f8fa3f300af722f4?s=128&d=identicon&r=PG", "display_name": "Wasteland", "link": "https://stackoverflow.com/users/1945363/wasteland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545576722, "creation_date": 1545571476, "question_id": 53903993, "link": "https://stackoverflow.com/questions/53903993/vba-copy-insert-a-row", "title": "VBA - copy/insert a row", "body": "<p>I'm trying to copy an entire row but I'd like to add it to the very top of another worksheet pushing the existing content one row down. I've merged the following code from some other questions in SO. It works find but, as one would expect, it replaces the content of the first row in the target worksheet. How would I insert it to the top of the target worksheet so it pushes everything else down.</p>\n\n<pre><code>Sub CopyHeader()\nDim sw As Worksheet: Set sw = ThisWorkbook.Sheets(\"OriginalFunding\") 'source worksheet\nDim tw As Worksheet: Set tw = ThisWorkbook.Sheets(\"FundingReturn\") 'target worksheet\nConst WHAT_TO_FIND As String = \"Learner\"\n\n            Set FoundCell = sw.Range(\"A:A\").Find(What:=WHAT_TO_FIND)\n            If Not FoundCell Is Nothing Then\n                sw.Rows(FoundCell.Row).EntireRow.Copy tw.Range(\"A1\")\n\n            Else\n                MsgBox (WHAT_TO_FIND &amp; \" not found\")\n            End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "text-to-column"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "edited": false, "score": 0, "creation_date": 1545583656, "post_id": 53904118, "comment_id": 94655329, "body": "Works great thanks! I&#39;m somewhat new to VBA and I&#39;m trying to not only make the code work, but to actually understand what&#39;s going on so i can replicate/adjust it if ever i need to. I&#39;m not quite sure I understand the last part of the code you put in. Would you mind explaining it for me step by step? This is the part I don&#39;t quite understand: v = Cells(i, 1).Value         If v &lt;&gt; &quot;&quot; Then             arr = Split(v, &quot;,&quot;)             u = UBound(arr) + 1             Range(Cells(i, 1), Cells(i, u)).Value = arr"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "edited": false, "score": 0, "creation_date": 1545584852, "post_id": 53904118, "comment_id": 94655632, "body": "@JoelBastien  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "edited": false, "score": 0, "creation_date": 1545591926, "post_id": 53904118, "comment_id": 94657210, "body": "Thanks a lot! One last question. When I&#39;m running my macro, it usually does a small portion of the data before stopping. Any idea why it does so? It&#39;ll do like 9 or so lines and then just move on to the next part of my macro for some reason. However, when i run it line by line with F8, it&#39;ll do all lines fine. Any idea?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "edited": false, "score": 0, "creation_date": 1545592383, "post_id": 53904118, "comment_id": 94657325, "body": "@JoelBastien  I am not sure."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1545693178, "post_id": 53904118, "comment_id": 94679292, "body": "There&#39;s a Lesson (VBA): Imagine that I thought, even claimed that you can paste (deposit) an array into a range only if the array was 2D usually looping through the 1D array and copying to the 2D starting with e.g. Redim arr2D(1 to UBound(arr1D) + 1,1 To 1) to later be able to write rng = arr2D. And the cherry on top is that this is an array transposed into the range (rows into columns). Huge lesson. Thx."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1545584827, "last_edit_date": 1545584827, "creation_date": 1545572743, "answer_id": 53904118, "question_id": 53903885, "link": "https://stackoverflow.com/questions/53903885/how-to-have-the-last-column-inputted-in-your-array-for-text-to-column/53904118#53904118", "title": "How to have the last column inputted in your array for text to column?", "body": "<p>We can use the <code>Split()</code> function to parse each record.  Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Q2sB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Q2sB.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code:</p>\n\n<pre><code>Sub Parse()\n    Dim i As Long, N As Long, v As String, u As Long\n    N = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 1 To N\n        v = Cells(i, 1).Value\n        If v &lt;&gt; \"\" Then\n            arr = Split(v, \",\")\n            u = UBound(arr) + 1\n            Range(Cells(i, 1), Cells(i, u)).Value = arr\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CBnPF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CBnPF.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE:</strong></p>\n\n<p>You can get similar results with formulas only <em>(no VBA)</em>.  For example, with data in column <strong>A</strong>, in <strong>B1</strong> enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,\",\",REPT(\" \",999)),COLUMNS($A:A)*999-998,999))\n</code></pre>\n\n<p>and copy both across and downward.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<ol>\n<li>the line with <code>Split()</code> takes the contents of a single cell and separates it into an array of items</li>\n<li>the line with <code>u</code> figures out how many items are in the array</li>\n<li>the line with <code>Range()</code> deposits the array into a set of cells in the row. </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1545580031, "last_edit_date": 1545580031, "creation_date": 1545578640, "answer_id": 53904823, "question_id": 53903885, "link": "https://stackoverflow.com/questions/53903885/how-to-have-the-last-column-inputted-in-your-array-for-text-to-column/53904823#53904823", "title": "How to have the last column inputted in your array for text to column?", "body": "<h1>TextToColumns feat. Field Info</h1>\n\n<p>You don't have to care about this argument and its parameter. The rest of the arguments missing had default values. Just shorten e.g. like this:</p>\n\n<pre><code>Sub TextToColumnsFieldInfo()\n\n  Const cColumn As Variant = \"A\"     ' Source Column Letter/Number\n  Const cFirst As Long = 1           ' Source First Row\n  Const cTarget As String = \"B1\"     ' Target Cell\n\n'  ' To suppress the following message:\n'  ' \"Do you want to replace the contents of the destination cells?\"\n'  Application.DisplayAlerts = False\n'  On Error GoTo ProcedureExit\n\n  Cells(cFirst, cColumn).Resize(Cells(Rows.Count, cColumn) _\n      .End(xlUp).Row - cFirst + 1).TextToColumns _\n      Destination:=Range(cTarget), Tab:=True, Comma:=True, _\n      TrailingMinusNumbers:=True\n\n'ProcedureExit:\n'  Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<h2>Remarks</h2>\n\n<blockquote>\n  <ul>\n  <li>This code is pasting into the B-column. Adjust the cTarget's parameter to fit your needs.</li>\n  <li>The Cells object is preferred because you can enter the column as    letter or as number.</li>\n  <li>With the Resize method we adjust to the needed range.</li>\n  <li>The last row of data in column A is calculated to not apply TextToColumns    to the whole column.</li>\n  <li>If you don't want to see the message that appears when overwriting       data while using TextToColumns, uncomment the commented lines in the code.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1578544179, "creation_date": 1545570603, "last_edit_date": 1578544179, "question_id": 53903885, "link": "https://stackoverflow.com/questions/53903885/how-to-have-the-last-column-inputted-in-your-array-for-text-to-column", "title": "How to have the last column inputted in your array for text to column?", "body": "<p>So essentially I have a large amount of data all in 1 cell seperated by commas. I have multiple rows of this data and with different amounts of data in each cell. Ex: first row may have data seperated by 3 commas, so it will become 3 columns. However, the 2nd row may have data seperated by 10 commas, which will become 10 columns. When I record the macro of transferring my text into columns, I get this code: </p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n\n'\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n        Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _\n        ), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), Array(19, 1), Array _\n        (20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), Array(25, 1), Array(26, 1)) _\n        , TrailingMinusNumbers:=True\nEnd Sub\n</code></pre>\n\n<p>Now, as I've mentioned the amount of data varies per row, and the data set will always change. Is there a way to have the array set so it becomes Array(last column, 1) ? Without having to actually enter them all manually to make sure it captures the whole data?</p>\n"}, {"tags": ["javascript", "excel", "vba", "selenium-webdriver", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545603344, "post_id": 53903482, "comment_id": 94659593, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/185695/discussion-between-qharr-and-yasserkhalil\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545603882, "last_edit_date": 1545603882, "creation_date": 1545566753, "answer_id": 53903482, "question_id": 53903402, "link": "https://stackoverflow.com/questions/53903402/javascript-link-doesnt-respond-in-selenium-excel-vba/53903482#53903482", "title": "Javascript link doesn&#39;t respond in selenium excel vba", "body": "<p>Try the following at the top</p>\n\n<pre><code> Const JS_WAIT_CLICKABLE = _\n    \"var target = this, endtime = Date.now() + arguments[0];\" &amp; _\n    \"(function check_clickable() {\" &amp; _\n    \"  var r = target.getBoundingClientRect(), x = r.left+r.width/2, y = r.top+r.height/2;\" &amp; _\n    \"  for (var e = document.elementFromPoint(x , y); e; e = e.parentElement)\" &amp; _\n    \"    if (e === target){ callback(target); return; }\" &amp; _\n    \"  if (Date.now() &gt; endtime) { callback(target); return; }\" &amp; _\n    \"  setTimeout(check_clickable, 60);\" &amp; _\n    \"})();\"                                      'by @florentbr\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>With .FindElementById(\"ctl00_ContentPlaceHolder1_LinkButton4\")\n    .ExecuteAsyncScript(JS_WAIT_CLICKABLE, 10000) _\n    .Click\nEnd With\n</code></pre>\n\n<hr>\n\n<p>You could also try to execute direct</p>\n\n<pre><code>.ExecuteScript \"javascript:__doPostBack('ctl00$ContentPlaceHolder1$LinkButton4','');\"\n</code></pre>\n\n<hr>\n\n<p>Clear cache and navigate back (as button is in shadow-root you need to use <code>/deep/</code> combinator)</p>\n\n<pre><code>d.get \"chrome://settings/clearBrowserData\"\nDim button As Object\nd.FindElementByCss(\"* /deep/ #clearBrowsingDataConfirm\").Click\nSet button = d.FindElementByCss(\"* /deep/ #clearBrowsingDataConfirm\")\n\nConst MAX_WAIT_SEC As Long = 15\nDim t As Date\nt = Timer\nDo\n    DoEvents\n    If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\nLoop Until button Is Nothing\n\nd.ExecuteScript \"window.history.go(-2);\"\n</code></pre>\n\n<p>Or potentially,</p>\n\n<pre><code>d.GoBack\n</code></pre>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1545603882, "creation_date": 1545566147, "last_edit_date": 1545592106, "question_id": 53903402, "link": "https://stackoverflow.com/questions/53903402/javascript-link-doesnt-respond-in-selenium-excel-vba", "title": "Javascript link doesn&#39;t respond in selenium excel vba", "body": "<p>I am trying to do such a line that clicks on a javascript link</p>\n\n<pre><code>.FindElementById(\"ctl00_ContentPlaceHolder1_LinkButton4\").WaitDisplayed(True, 3000).Click\n</code></pre>\n\n<p>There's no any errors at this line but sometimes it doesn't work .. I say sometimes not always.. sometimes work and sometimes stopped and I don't know the reason\nI have to restart the code to start new bot (driver) and at some cases I have to restart so many times till this link worked</p>\n\n<p>Here's the html part of this javascript link</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a id=\"ctl00_ContentPlaceHolder1_LinkButton4\" href=\"javascript:__doPostBack('ctl00$ContentPlaceHolder1$LinkButton4','')\" style=\"display:inline-block;width:280px;text-decoration:none;height:22px;font-weight:bold;font-size:11pt;color:Maroon;border-width:1px;border-style:Dashed;border-color:#404040;background-color:#FFFFC0;vertical-align: middle; text-align: center; cursor: hand;\"&gt;Some Text Removed For Privacy&lt;/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>How can I make this link work ... or is there a workaround to make it work ..? \nI tried to solve that point but I didn't find any clue at all</p>\n\n<p>This is the html part for a responsive one (I don't see any difference)</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a id=\"ctl00_ContentPlaceHolder1_LinkButton4\" href=\"javascript:__doPostBack('ctl00$ContentPlaceHolder1$LinkButton4','')\" style=\"display:inline-block;width:280px;text-decoration:none;height:22px;font-weight:bold;font-size:11pt;color:Maroon;border-width:1px;border-style:Dashed;border-color:#404040;background-color:#FFFFC0;vertical-align: middle; text-align: center; cursor: hand;\"&gt;Some Text Removed For Privacy/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here's a snapshot of the error after executing this line</p>\n\n<pre><code>.ExecuteScript \"javascript:__doPostBack('ctl00$ContentPlaceHolder1$LinkButton4'\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VYo9T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VYo9T.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is Network snapshot (may be useful) >> I see 302 (which I think there should be newer cache ..) so is there a way to clear the cache of the bot?\n<a href=\"https://i.stack.imgur.com/7kOAF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7kOAF.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "excel", "vba", "vb.net"], "comments": [{"owner": {"reputation": 183, "user_id": 7162907, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BYQMoQipln4/AAAAAAAAAAI/AAAAAAAAACI/SlkqFiU9IS8/photo.jpg?sz=128", "display_name": "Farhad Mortezapour", "link": "https://stackoverflow.com/users/7162907/farhad-mortezapour"}, "edited": false, "score": 0, "creation_date": 1545560366, "post_id": 53902724, "comment_id": 94650441, "body": "You can use Microsoft.Office.Interop.Excel namespace"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1545578129, "post_id": 53902724, "comment_id": 94654042, "body": "So, what&#39;s your problem?"}, {"owner": {"reputation": 13, "user_id": 10825500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b797a3fa6f332c744781d4c5258a3b?s=128&d=identicon&r=PG&f=1", "display_name": "shekhar", "link": "https://stackoverflow.com/users/10825500/shekhar"}, "edited": false, "score": 0, "creation_date": 1545584393, "post_id": 53902724, "comment_id": 94655528, "body": "Its getting one student&#39;s data only.Need for other students too.Please help with how to put loop here and export the values in another excel"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1545601059, "post_id": 53902724, "comment_id": 94659139, "body": "c#, vb.net or vba? Not all three at once."}, {"owner": {"reputation": 13, "user_id": 10825500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b797a3fa6f332c744781d4c5258a3b?s=128&d=identicon&r=PG&f=1", "display_name": "shekhar", "link": "https://stackoverflow.com/users/10825500/shekhar"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1545624759, "post_id": 53902724, "comment_id": 94662682, "body": "@AJD i have written code in vb.net console application that is mentioned in the question."}], "answers": [{"comments": [{"owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "edited": false, "score": 0, "creation_date": 1545866511, "post_id": 53938136, "comment_id": 94716326, "body": "PS this code is assuming the data format stay the same throughout the document, and that there is only 1 favorite subject per student.  If that isn&#39;t the case let me know and I can update."}, {"owner": {"reputation": 13, "user_id": 10825500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b797a3fa6f332c744781d4c5258a3b?s=128&d=identicon&r=PG&f=1", "display_name": "shekhar", "link": "https://stackoverflow.com/users/10825500/shekhar"}, "edited": false, "score": 0, "creation_date": 1546261887, "post_id": 53938136, "comment_id": 94812981, "body": "Thank u very much for the help Jane."}], "tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 0, "last_activity_date": 1545866151, "creation_date": 1545866151, "answer_id": 53938136, "question_id": 53902724, "link": "https://stackoverflow.com/questions/53902724/iterate-through-particular-cells-of-excel-and-export-using-vb-code/53938136#53938136", "title": "Iterate through particular cells of Excel and export using vb code", "body": "<pre><code>Sub macro1()\nDim ws1 As Worksheet, ws2 As Worksheet\nDim xrow As Long, q As Long\n\n\nSet ws1 = Workbooks(\"StudentData\").Worksheets(\"Sheet1\")\nSet ws2 = Workbooks(\"NewWorkbook\").Worksheets(\"Sheet1\")\n\nws2.Cells(1, 2).Value = \"Favourite Subjects\"\nws2.Cells(1, 1).Value = \"Roll no.\"\nxrow = 2\n\nFor x = 200 To 300\n    If ws1.Cells(x, 1).Value = \"Favourite Subjects\" Then\n        q = x + 1\n        ws1.Cells(q, 1).Value = ws2.Cells(xrow, 2).Value\n        xrow = xrow + 1\n    Else:\n    End If\nNext x\n\nxrow = 2\n\nFor y = 200 To 300\n    If ws1.Cells(y, 2).Value = \"Roll no.\" Then\n         ws1.Cells(y, 3).Value = ws2.Cells(y, 1).Value\n         xrow = xrow + 1\n    Else:\n    End If\nNext y\n\nEnd Sub\n</code></pre>\n\n<p>Just change the names of the workbooks and worksheets and This should get the job done.  If you get an error then its probably the syntax for using ws1 and ws2 because excel doesn't like transferring data between workbooks.  You can fix this by changing the code to:</p>\n\n<pre><code>Sub macro1()\nDim xrow As Long, q As Long\n\nxrow = 2\n\nFor x = 200 To 300\n    If Cells(x, 1).Value = \"Favourite Subjects\" Then\n        q = x + 1\n        Cells(q, 1).Value = Cells(xrow, 6).Value\n        xrow = xrow + 1\n    Else:\n    End If\nNext x\n\nxrow = 2\n\nFor y = 200 To 300\n    If Cells(y, 2).Value = \"Roll no.\" Then\n         Cells(y, 3).Value = Cells(y, 5).Value\n         xrow = xrow + 1\n    Else:\n    End If\nNext y\n\nEnd Sub\n</code></pre>\n\n<p>Then copying the D and E columns and pasting them into a new WB.</p>\n"}], "owner": {"reputation": 13, "user_id": 10825500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b797a3fa6f332c744781d4c5258a3b?s=128&d=identicon&r=PG&f=1", "display_name": "shekhar", "link": "https://stackoverflow.com/users/10825500/shekhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578544213, "creation_date": 1545559819, "last_edit_date": 1578544213, "question_id": 53902724, "link": "https://stackoverflow.com/questions/53902724/iterate-through-particular-cells-of-excel-and-export-using-vb-code", "title": "Iterate through particular cells of Excel and export using vb code", "body": "<p>I have an Excel sheet as attached below as a drive link. I need a C# or vb code which will read the excel, pick only roll numbers (i.e. 301) and favorite subjects (i.e. Maths) of every student in the excel sheet and export in other Excel (in columns A and B) like:</p>\n\n<pre><code>301   Maths\n302   English\n303   Science\n... and so on.\n</code></pre>\n\n<p>Please note the records which I have to pick starts from Row number 200. Rest above this need not to be picked.</p>\n\n<p>I have this code which gets Harry's data only.Need for other students too.</p>\n\n<pre><code>Dim appXL As Excel.Application\nDim wbXL As Excel.Workbook\nDim wbsXL As Excel.Workbooks\nDim shXL As Excel.Worksheet\nDim Checker, Checker1 As Integer\nappXL = CreateObject(\"excel.application\")\nappXL.Visible = True\nwbsXL = appXL.Workbooks\nwbXL = wbsXL.Open(\"C:\\Users\\Pashupati\\Desktop\\excel.xlsx\")\nshXL = wbXL.ActiveSheet\nDim rng, rng1 As Excel.Range\nrng = CType(shXL.Cells(200, 3), Excel.Range)\nrng1 = CType(shXL.Cells(208, 1), Excel.Range)\nChecker = rng.Value.ToString()\nChecker1 = rng1.Value.ToString()\nEnd Sub()\n</code></pre>\n\n<p>Will appreciate the coordination.</p>\n\n<p><a href=\"https://drive.google.com/open?id=1zlfdhxE_pNsr0gmbMdwInxReELZwtMKJ\" rel=\"nofollow noreferrer\">Click here to view source Excel File</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545560491, "post_id": 53902597, "comment_id": 94650470, "body": "thanks for your corrections. But still I get same debug, and error highlight this part. <code>If .Range(&quot;D1&quot;) &gt; CDate(.Cells(i, &quot;F&quot;).Value) And Len(.Cells(i, &quot;F&quot;).Value2) &gt; 0 Then</code>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545560893, "post_id": 53902597, "comment_id": 94650546, "body": "what are the values of <code>.Range(&quot;D1&quot;)</code>, <code>.Cells(i, &quot;F&quot;).Value</code> and <code>.Cells(i, &quot;F&quot;).Value2</code> upon hitting the error?"}, {"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545561371, "post_id": 53902597, "comment_id": 94650634, "body": "<code>.Range(&quot;D1&quot;)</code> contains today formula. <code>.Cells(i, &quot;F&quot;).value</code> shows dates for transaction. <code>.Cells(i, &quot;F&quot;).value2</code> also relate to dates."}, {"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1545562335, "post_id": 53902597, "comment_id": 94650810, "body": "<code>If .Range(&quot;D1&quot;) &gt; Range(&quot;F&quot; &amp; i).Value And Len(.Cells(i, &quot;F&quot;).Value2) &gt; 0 Then</code> I changed previous into this one. Now it works properly. I really appreciate your help @DisplayName. Just one more question. What do you think this code is enough good for handle 1000 or 2000 rows of data and check the all lines properly?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 1, "creation_date": 1545562694, "post_id": 53902597, "comment_id": 94650865, "body": "As for speed issue, accessing worksheet cells is always slowing down things, and you should make a test to see if it&#39;s sufficient for your purposes . A faster way is dumping data in and writing them back out of arrays. Finally, marking answer as accepted is an appreciated way to show real appreciation. Thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1545558347, "creation_date": 1545558347, "answer_id": 53902597, "question_id": 53902568, "link": "https://stackoverflow.com/questions/53902568/add-new-line-into-the-excel-table-if-condition-meet/53902597#53902597", "title": "Add new line into the Excel Table if Condition meet", "body": "<p>you're using <code>With Worksheets(\"DB\")</code> but then you're not referencing all range objects to <code>Worksheets(\"DB\")</code> object since you're not using dots...</p>\n\n<pre><code>Dim i As Long\n\nWith Worksheets(\"DB\")\n    For i = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 4 Step -1\n        'make sure it's not an \"old entry\"\n        If .Cells(i, \"A\").Value2 &lt;&gt; .Cells(i + 1, \"A\").Value2 Then\n            'if today occurs after \"end date\" then\n            If .Range(\"D1\") &gt; CDate(.Cells(i, \"F\").Value) And Len(.Cells(i, \"F\").Value2) &gt; 0 Then\n                'insert row\n                .Rows(i + 1).Insert Shift:=xlShiftDown\n\n                'copy row down\n                'Rows(i + 1).Value = Rows(i).Value\n\n                'update dates\n                .Cells(i + 1, \"A\").Value = .Cells(i, \"A\").Value\n                .Cells(i + 1, \"B\").Value = .Cells(i, \"B\").Value\n                .Cells(i + 1, \"C\").Value = .Cells(i, \"C\").Value\n                .Cells(i + 1, \"D\").Value = .Cells(i, \"D\").Value\n                .Cells(i + 1, \"E\").Value = .Cells(i, \"F\").Value\n                .Cells(i + 1, \"F\").Value = DateAdd(\"yyyy\", 1, CDate(.Cells(i + 1, \"E\").Value))\n                .Cells(i + 1, \"G\").Value = .Cells(i, \"M\").Value\n                .Cells(i + 1, \"H\").Value = .Cells(i, \"H\").Value\n                .Cells(i + 1, \"I\").Value = .Cells(i, \"I\").Value\n                .Cells(i + 1, \"J\").Value = .Cells(i, \"J\").Value\n\n                Application.CutCopyMode = False\n\n            End If\n        End If\n    Next\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53902597, "answer_count": 1, "score": 1, "last_activity_date": 1545565025, "creation_date": 1545558008, "last_edit_date": 1545565025, "question_id": 53902568, "link": "https://stackoverflow.com/questions/53902568/add-new-line-into-the-excel-table-if-condition-meet", "title": "Add new line into the Excel Table if Condition meet", "body": "<p>I have a Excel Table in which I'd like to add new line if condition meet. Actually my code is working partly. It adds lines but when the work finish Debug appears (Run-time error 13, type mismatch).\nI am in trouble if sometimes unexpected error happens. So please help me make my code more advance and work properly.</p>\n\n<pre><code>Sub AddWorkingYearLine2()\n\n    Dim i As Long\n\n    With Worksheets(\"DB\")\n        For i = Cells(Rows.Count, \"A\").End(xlUp).Row To 4 Step -1\n            'make sure it's not an \"old entry\"\n            If Cells(i, \"A\").Value2 &lt;&gt; Cells(i + 1, \"A\").Value2 Then\n                'if today occurs after \"end date\" then\n                If Range(\"D1\") &gt; CDate(Cells(i, \"F\").Value) And Len(Cells(i, \"F\").Value2) &gt; 0 Then\n                    'insert row\n                    Rows(i + 1).Insert Shift:=xlShiftDown\n\n                    'copy row down\n                    'Rows(i + 1).Value = Rows(i).Value\n\n                    'update dates\n                    Cells(i + 1, \"A\").Value = Cells(i, \"A\").Value\n                    Cells(i + 1, \"B\").Value = Cells(i, \"B\").Value\n                    Cells(i + 1, \"C\").Value = Cells(i, \"C\").Value\n                    Cells(i + 1, \"D\").Value = Cells(i, \"D\").Value\n                    Cells(i + 1, \"E\").Value = Cells(i, \"F\").Value\n                    Cells(i + 1, \"F\").Value = DateAdd(\"yyyy\", 1, CDate(Cells(i + 1, \"E\").Value))\n                    Cells(i + 1, \"G\").Value = Cells(i, \"M\").Value\n                    Cells(i + 1, \"H\").Value = Cells(i, \"H\").Value\n                    Cells(i + 1, \"I\").Value = Cells(i, \"I\").Value\n                    Cells(i + 1, \"J\").Value = Cells(i, \"J\").Value\n\n                    Application.CutCopyMode = False\n\n                End If\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium-webdriver", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545559030, "post_id": 53902233, "comment_id": 94650222, "body": "Thanks a lot. I have tested both codes suggested but doesn&#39;t work properly"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545559095, "post_id": 53902233, "comment_id": 94650232, "body": "Headless means no browser visible. Set size can be used along with set position to place where you need. Otherwise, you know python which I think has a window minimize method."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1545559231, "post_id": 53902233, "comment_id": 94650258, "body": "I tested again the headless part and it is OK now. Thanks a lot"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1545559270, "post_id": 53902233, "comment_id": 94650264, "body": "That argument has to be at the start. :-)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1545559592, "last_edit_date": 1545559592, "creation_date": 1545553668, "answer_id": 53902233, "question_id": 53902049, "link": "https://stackoverflow.com/questions/53902049/minimize-window-driver-selenium-excel-vba/53902233#53902233", "title": "minimize window driver selenium excel vba", "body": "<p>AFAIK there is no method for this in VBA implementation (there is in Python for example). There are a number of ways to manipulate size and position e.g.</p>\n\n<pre><code>bot.Window.SetSize 0, 0\n</code></pre>\n\n<p>Or you can run headless</p>\n\n<pre><code>bot.AddArgument \"--headless\"\n</code></pre>\n\n<p>You might also try to:</p>\n\n<p>1) Emulate Windows Key + Down</p>\n\n<p>2) Write a javscript function that performs window.minimize() and async execute off the parent window</p>\n\n<p>3) Capture your target co-ordinates by generating a <a href=\"http://www.vbforums.com/showthread.php?67260-API-Help-GetWindowPlacement\" rel=\"nofollow noreferrer\">GetWindowPlacement</a> call along with implementing your own WINDOWPLACEMENT struct. Looks like gets ugly fast. </p>\n\n<p>See also:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4396109/getting-the-size-of-a-minimized-window\">Getting the size of a minimized window</a></p>\n"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "accepted_answer_id": 53902233, "answer_count": 1, "score": 1, "last_activity_date": 1545559592, "creation_date": 1545551409, "last_edit_date": 1545559305, "question_id": 53902049, "link": "https://stackoverflow.com/questions/53902049/minimize-window-driver-selenium-excel-vba", "title": "minimize window driver selenium excel vba", "body": "<p>I have searched a lot for a way to minimize the window of the driver in selenium for excel vba. I have found ways for Java and python and tried to adopt them but all my tries failed\nI just found a way to maximize the window using</p>\n\n<pre><code>bot.Window.Maximize\n</code></pre>\n\n<p>But when trying to use Minimize I got an error</p>\n\n<p>Again I am searching for excel vba as for selenium ...\nThanks advanced for help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545547226, "post_id": 53901735, "comment_id": 94648476, "body": "this is superh handy in that it has a pop up box allowing you to specify the directory of the child workbooks to loop through."}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545549341, "post_id": 53901735, "comment_id": 94648751, "body": "[949.xlsx][1] [activepl][2] [Master file: A-8][3]     [1]: <a href=\"https://i.stack.imgur.com/itRT5.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/itRT5.png</a>   [2]: <a href=\"https://i.stack.imgur.com/f2KRg.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/f2KRg.png</a>   [3]: <a href=\"https://i.stack.imgur.com/68aQD.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/68aQD.png</a>  I am trying to update the sheets in the Master file A-8 with the data in the 3 seperate workbooks; without the headers. For example 949.xlsx would go to sheet 949 in A-8."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545723228, "post_id": 53904537, "comment_id": 94682859, "body": "Hi! Thanks for your help!"}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545725326, "post_id": 53904537, "comment_id": 94683209, "body": "The code works beautifully. May I ask how to could modify the code clear the existing cells under the headers in the masterWB before copying over? RIght now it pastes the new data below the existing instead of overwriting  Thanks!!"}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545726159, "post_id": 53904537, "comment_id": 94683366, "body": "Oh, what if for activepl  I need to paste into b2 (offset first row and A column)? Would I create 2 arrays, with activepl in the second?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545729365, "post_id": 53904537, "comment_id": 94683986, "body": "@Raja, <b>Master.Sheets(vName(i)).UsedRange.Offset(1).Clear</b>   I  edited answer."}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545751489, "post_id": 53904537, "comment_id": 94688854, "body": "Thank you so much for your time, I really appreciate it!. Sorry for being unclear, I meant that 949 and div would be pasted into A2 like the original code; but activepl would be going into B2"}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545751593, "post_id": 53904537, "comment_id": 94688874, "body": "Does this mix of code make sense? I can&#39;t quite get this to work  vName = Array(&quot;949&quot;, &quot;div&quot;, &quot;activepl&quot;) vName2 = Array(&quot;activepl&quot;) vNameall = Array(vName, vName2)               Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)                 vDB = wb.ActiveSheet.UsedRange.Offset(1)                 Master.Sheets(vNameall(i)).UsedRange.Offset(1).Clear"}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545751596, "post_id": 53904537, "comment_id": 94688875, "body": "Set Target = Master.Sheets(vName(i)).Range(&quot;a&quot; &amp; Rows.Count).End(xlUp)(2)                  Target.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB Set Target = Master.Sheets(vName2(i)).Range(&quot;b&quot; &amp; Rows.Count).End(xlUp)(2)                  Target.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB"}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545805482, "post_id": 53904537, "comment_id": 94697583, "body": "Hi! The condition works for activepl, but for some reason on pasting, the entire of column A, (except cell A1) has lost its formatting and fill.   Is this due to the line:  Set Target = Master.Sheets(vName(i)).Range(&quot;b&quot; &amp; Rows.Count).End(xlUp)(2) &#39;&lt;~~ column b                 Target.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB  would you be so kind to explain the logic of that code so I may learn from you and can make future changes? Thank you!"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545814915, "post_id": 53904537, "comment_id": 94700201, "body": "@Raja,  Use  ClearContent  instead  &#199;lear.  <b>Master.Sheets(vName(i)).UsedRange.Offset(1, 1).ClearContent</b>"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1545816599, "post_id": 53904537, "comment_id": 94700813, "body": "@Raja, Above example use variant array to get  value. You have to  copy method for  formatting and the other."}, {"owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "edited": false, "score": 0, "creation_date": 1552804240, "post_id": 53904537, "comment_id": 97145387, "body": "How do I adapt this code where I am only picking out specific sheets from the child workbooks? 949.xlsx has sheets: &#39;Sheet 1&#39; and &#39;949 report&#39; ; i want to copy out 949 report and paste in to 949 report sheet in Master"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 0, "last_activity_date": 1545777261, "last_edit_date": 1545777261, "creation_date": 1545576272, "answer_id": 53904537, "question_id": 53901735, "link": "https://stackoverflow.com/questions/53901735/update-master-workbook-via-multiple-independent-sheets-from-other-workbooks/53904537#53904537", "title": "Update Master Workbook via multiple independent sheets from other workbooks", "body": "<p>Try</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n    Dim wb As Workbook\n    Dim myPath As String\n    Dim myFile As String\n    Dim myExtension As String\n    Dim FldrPicker As FileDialog\n    Dim vName As Variant, vDB As Variant\n    Dim Master As Workbook, Target As Range\n    Dim i As Integer\n\n    Set Master = ThisWorkbook\n\n    vName = Array(\"949\", \"div\", \"activepl\")\n    'Optimize Macro Speed\n      Application.ScreenUpdating = False\n      Application.EnableEvents = False\n      Application.Calculation = xlCalculationManual\n\n    'Retrieve Target Folder Path From User\n      Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n        With FldrPicker\n          .Title = \"Select A Target Folder\"\n          .AllowMultiSelect = False\n            If .Show &lt;&gt; -1 Then GoTo NextCode\n            myPath = .SelectedItems(1) &amp; \"\\\"\n        End With\n\n    'In Case of Cancel\nNextCode:\n      myPath = myPath\n      If myPath = \"\" Then GoTo ResetSettings\n\n    'Target File Extension (must include wildcard \"*\")\n      myExtension = \"*.xls*\"\n\n    'Target Path with Ending Extention\n      myFile = Dir(myPath &amp; myExtension)\n\n    'Loop through each Excel file in folder\n      Do While myFile &lt;&gt; \"\"\n        For i = 0 To 2\n            If InStr(myFile, vName(i)) Then\n\n\n            'Set variable equal to opened workbook\n              Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n                vDB = wb.ActiveSheet.UsedRange.Offset(1)\n                Master.Sheets(vName(i)).UsedRange.Offset(1).Clear '&lt;~~ Clear cells except head\n                Set Target = Master.Sheets(vName(i)).Range(\"b\" &amp; Rows.Count).End(xlUp)(2) '&lt;~~ column b\n                Target.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n            'Ensure Workbook has opened before moving on to next line of code\n              DoEvents\n\n\n            'Save and Close Workbook\n              wb.Close SaveChanges:=True\n\n            'Ensure Workbook has closed before moving on to next line of code\n              DoEvents\n            End If\n        Next i\n            'Get next file name\n              myFile = Dir\n      Loop\n\n    'Message Box when tasks are completed\n      MsgBox \"Task Complete!\"\n\nResetSettings:\n      'Reset Macro Optimization Settings\n        Application.EnableEvents = True\n        Application.Calculation = xlCalculationAutomatic\n        Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>You can change the position by giving the condition according to the sheet name.</p>\n\n<pre><code>        If vName(i) = \"activepl\" Then\n            Master.Sheets(vName(i)).UsedRange.Offset(1, 1).Clear '&lt;~~ Clear cells except head\n            Set Target = Master.Sheets(vName(i)).Range(\"b\" &amp; Rows.Count).End(xlUp)(2) '&lt;~~ column b\n        Else\n            Master.Sheets(vName(i)).UsedRange.Offset(1).Clear '&lt;~~ Clear cells except head\n            Set Target = Master.Sheets(vName(i)).Range(\"a\" &amp; Rows.Count).End(xlUp)(2) '&lt;~~ column b\n        End If\n</code></pre>\n\n<p>Edition</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n    Dim wb As Workbook\n    Dim myPath As String\n    Dim myFile As String\n    Dim myExtension As String\n    Dim FldrPicker As FileDialog\n    Dim vName As Variant, vDB As Variant\n    Dim Master As Workbook, Target As Range\n    Dim i As Integer\n\n    Set Master = ThisWorkbook\n\n    vName = Array(\"949\", \"div\", \"activepl\")\n    'Optimize Macro Speed\n      Application.ScreenUpdating = False\n      Application.EnableEvents = False\n      Application.Calculation = xlCalculationManual\n\n    'Retrieve Target Folder Path From User\n      Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n        With FldrPicker\n          .Title = \"Select A Target Folder\"\n          .AllowMultiSelect = False\n            If .Show &lt;&gt; -1 Then GoTo NextCode\n            myPath = .SelectedItems(1) &amp; \"\\\"\n        End With\n\n    'In Case of Cancel\nNextCode:\n      myPath = myPath\n      If myPath = \"\" Then GoTo ResetSettings\n\n    'Target File Extension (must include wildcard \"*\")\n      myExtension = \"*.xls*\"\n\n    'Target Path with Ending Extention\n      myFile = Dir(myPath &amp; myExtension)\n\n    'Loop through each Excel file in folder\n      Do While myFile &lt;&gt; \"\"\n        For i = 0 To 2\n            If InStr(myFile, vName(i)) Then\n\n            'Set variable equal to opened workbook\n              Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n                vDB = wb.ActiveSheet.UsedRange.Offset(1)\n\n                If vName(i) = \"activepl\" Then\n                    Master.Sheets(vName(i)).UsedRange.Offset(1, 1).Clear '&lt;~~ Clear cells except head\n                    Set Target = Master.Sheets(vName(i)).Range(\"b\" &amp; Rows.Count).End(xlUp)(2) '&lt;~~ column b\n                Else\n                    Master.Sheets(vName(i)).UsedRange.Offset(1).Clear '&lt;~~ Clear cells except head\n                    Set Target = Master.Sheets(vName(i)).Range(\"a\" &amp; Rows.Count).End(xlUp)(2) '&lt;~~ column b\n                End If\n                Target.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n            'Ensure Workbook has opened before moving on to next line of code\n              DoEvents\n\n\n            'Save and Close Workbook\n              wb.Close SaveChanges:=True\n\n            'Ensure Workbook has closed before moving on to next line of code\n              DoEvents\n            End If\n        Next i\n            'Get next file name\n              myFile = Dir\n      Loop\n\n    'Message Box when tasks are completed\n      MsgBox \"Task Complete!\"\n\nResetSettings:\n      'Reset Macro Optimization Settings\n        Application.EnableEvents = True\n        Application.Calculation = xlCalculationAutomatic\n        Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10825162, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_kNHhx5l72M/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbHQ9JC5_JZ6Y18U5AWqSF0_lJmmA/mo/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/10825162/raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 53904537, "answer_count": 1, "score": 0, "last_activity_date": 1549754291, "creation_date": 1545547158, "last_edit_date": 1549754291, "question_id": 53901735, "link": "https://stackoverflow.com/questions/53901735/update-master-workbook-via-multiple-independent-sheets-from-other-workbooks", "title": "Update Master Workbook via multiple independent sheets from other workbooks", "body": "<p>I have a Master Workbook with several labelled sheets. I am trying to update sheets in this workbooks named: 949, div and active pl.</p>\n\n<p>The data for each of these 3 sheets would be pulled from 3 child workbooks, named accordingly as 949.xlsx, div.xlsx and activepl.xlsx. These workbooks have only 1 sheet in each of them.</p>\n\n<p>How do I clear existing data except the header row then copy all the data from each of the child workbooks (disregarding the first row which is the header), into the respectively named sheets in the Master Workbook?</p>\n\n<p>The macro I have so far:</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Ensure Workbook has opened before moving on to next line of code\n      DoEvents\n\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1545557879, "post_id": 53901629, "comment_id": 94650056, "body": "I did a similar thing with groups of 5 questions for a 5 question quiz. Each question came from a random selection of one of the 5 questions in a group. No sorting of the groups required as the choice was made by a random number between 1 and 5."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 1537873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dff0dd4eacf0873537e8045cbb1ee019?s=128&d=identicon&r=PG", "display_name": "ome", "link": "https://stackoverflow.com/users/1537873/ome"}, "edited": false, "score": 0, "creation_date": 1545738007, "post_id": 53907043, "comment_id": 94685886, "body": "This is amazing, @spiralrain! It DID do what I needed, ticking all of the boxes. THANK YOU! I am studying the code now and applying some minor edits to make it more flexible for other applications."}], "tags": [], "owner": {"reputation": 16, "user_id": 8699308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f04bc6ad1bcdc090065132cb05a1abb4?s=128&d=identicon&r=PG&f=1", "display_name": "spiralrain", "link": "https://stackoverflow.com/users/8699308/spiralrain"}, "is_accepted": true, "score": 0, "last_activity_date": 1545597985, "creation_date": 1545597985, "answer_id": 53907043, "question_id": 53901629, "link": "https://stackoverflow.com/questions/53901629/randomly-shuffle-rows-based-on-a-column-value/53907043#53907043", "title": "Randomly Shuffle Rows Based on a Column value", "body": "<p>This macro should work for you:</p>\n\n<pre><code>&lt;code&gt;Sub Shuffle()\nDim Lrow As Long\nDim AR1() As Variant\nDim AR2() As Variant\nDim R1 As Range\nDim Num As Long\nDim AA As Integer\nDim BB As Long\nDim CC As Integer\nDim DD As Integer\nLrow = ActiveSheet.Range(\"A200000\").End(xlUp).Row\nSet R1 = ActiveSheet.Range(\"A2:H\" &amp; Lrow)\nReDim AR1(1 To (Lrow - 1), 1 To 8)\nReDim AR2(1 To (Lrow - 1), 1 To 8)\nAR1 = R1\nFor BB = LBound(AR1, 1) To UBound(AR1, 1)\n    AA = 1\n    If AR1(BB, 3) = \"Yes\" Then\n        Num = BB\n        Do Until Num = 0\n            Num = Num + 1\n            If Num &gt; UBound(AR1, 1) Then\n                Num = 0\n            Else\n                If AR1(Num, 3) = \"No\" Then\n                    Num = 0\n                Else\n                    AA = AA + 1\n                End If\n            End If\n        Loop\n        Do Until Num &lt;&gt; 0\n            Num = Int((UBound(AR1, 1) - LBound(AR1, 1) + 1) * Rnd + LBound(AR1, 1))\n            For CC = 1 To AA\n                If (Num + CC - 1) &gt; UBound(AR1, 1) Then\n                    Num = 0\n                    Exit For\n                Else\n                    If AR2(Num + CC - 1, 3) &lt;&gt; \"\" Then\n                        Num = 0\n                        Exit For\n                    End If\n                End If\n            Next CC\n        Loop\n        For CC = 1 To AA\n            For DD = 1 To 8\n                AR2(Num + CC - 1, DD) = AR1(BB + CC - 1, DD)\n            Next DD\n            AR1(BB + CC - 1, 3) = \"\"\n        Next CC\n    End If\nNext BB\nFor BB = LBound(AR1, 1) To UBound(AR1, 1)\n    If AR1(BB, 3) &lt;&gt; \"\" Then\n        AA = 0\n        Num = 0\n        Do Until Num &lt;&gt; 0\n            Num = Int((UBound(AR1, 1) - LBound(AR1, 1) + 1) * Rnd + LBound(AR1, 1))\n            If AR2(Num, 3) = \"\" Then\n                For DD = 1 To 8\n                    AR2(Num, DD) = AR1(BB, DD)\n                Next DD\n                AR1(BB, 3) = \"\"\n            Else\n                Num = 0\n                AA = AA + 1\n            End If\n            If AA &gt; 10 Then\n                For CC = LBound(AR1, 1) To UBound(AR1, 1)\n                    If AR2(CC, 3) = \"\" Then\n                        For DD = 1 To 8\n                            AR2(CC, DD) = AR1(BB, DD)\n                        Next DD\n                        AR1(BB, 3) = \"\"\n                        Num = CC\n                        Exit For\n                    End If\n                Next CC\n            End If\n        Loop\n    End If\nNext BB\nR1 = AR2\nEnd Sub\n&lt;/code&gt;\n</code></pre>\n\n<p>good luck</p>\n"}], "owner": {"reputation": 45, "user_id": 1537873, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dff0dd4eacf0873537e8045cbb1ee019?s=128&d=identicon&r=PG", "display_name": "ome", "link": "https://stackoverflow.com/users/1537873/ome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 53907043, "answer_count": 1, "score": -2, "last_activity_date": 1578544238, "creation_date": 1545545704, "last_edit_date": 1578544238, "question_id": 53901629, "link": "https://stackoverflow.com/questions/53901629/randomly-shuffle-rows-based-on-a-column-value", "title": "Randomly Shuffle Rows Based on a Column value", "body": "<p>I have a worksheet with 8 columns and about 300 rows. One of the columns (\"D\") is labeled \"Grouped\" which has either a \"Yes\" or \"No\" value. \"Grouped\" rows, i.e., those rows with a \"Yes\" value on the \"Grouped\" column, usually are composed of 2-5 rows, and appears in between the \"No\" rows. Using VBA, I wish to shuffle the order of rows starting from Row 2 up to the last used Row but following these conditions:</p>\n\n<ol>\n<li>Grouped rows cannot be shuffled.</li>\n<li>The position of Grouped rows may change, e.g. Grouped rows at Row 50-53 can be moved to Row 1-4, and Grouped rows Row 100-103 can be moved to Row 150-153.</li>\n</ol>\n\n<p>Before:\n<img src=\"https://i.imgur.com/zPB4dZk.png\" alt=\"Before sort\"></p>\n\n<p>After:\n<img src=\"https://i.imgur.com/vcTt2ZQ.png\" alt=\"After sort\"></p>\n\n<p>I tried assigning a random value to a row in a new column and apply a sort based on that new column, but I cannot meet the conditions. I've tried row swapping using selections, i.e., \"filtered out\" the Grouped rows, but they still end up being shuffled.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1545552520, "post_id": 53901532, "comment_id": 94649230, "body": "and what&#39;s the problem you&#39;re facing?"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1545553220, "creation_date": 1545553220, "answer_id": 53902193, "question_id": 53901532, "link": "https://stackoverflow.com/questions/53901532/copy-specific-columns-from-multiple-sheets-into-one-sheet/53902193#53902193", "title": "Copy specific columns from multiple sheets into one sheet", "body": "<p><code>.Offset(\"B\")</code> isn't a valid syntax</p>\n\n<p>to shift one column to the right you want <code>.Offset(, 1)</code></p>\n\n<pre><code>Dim ws As Worksheet\nDim wsDest As Worksheet\n\nSet wsDest = Sheets(\"Combined\")\n\nFor Each ws In ActiveWorkbook.Sheets\n    If ws.Name &lt;&gt; wsDest.Name Then\n        ws.Range(\"B1\", ws.Range(\"B1\").End(xlToRight).End(xlDown)).Copy\n        wsDest.Cells(1, Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial xlPasteValues\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10824856, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214108600684550/picture?type=large", "display_name": "Luthfi TryWando", "link": "https://stackoverflow.com/users/10824856/luthfi-trywando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 53902193, "answer_count": 1, "score": 0, "last_activity_date": 1582085147, "creation_date": 1545544445, "last_edit_date": 1582085147, "question_id": 53901532, "link": "https://stackoverflow.com/questions/53901532/copy-specific-columns-from-multiple-sheets-into-one-sheet", "title": "Copy specific columns from multiple sheets into one sheet", "body": "<p>I want to copy all columns from \"B\" until the end of the sheet into a new sheet named \"combined\". The Header table in sheets \"Combined\" is the same of every sheets (\"A\").</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Combine()\n\n   ' Sheets(1).Select\n   ' Worksheets.Add ' add a sheet in first place\n    Sheets(1).Name = \"Combined\"\n\n    ' copy headings\n    Sheets(2).Activate\n    Range(\"A1\").EntireColumn.Select\n    Selection.Copy Destination:=Sheets(1).Range(\"A1\")\n\n    Dim ws As Worksheet\n    Dim wsDest As Worksheet\n\n    Set wsDest = Sheets(\"Combined\")\n\n    For Each ws In ActiveWorkbook.Sheets\n        If ws.Name &lt;&gt; wsDest.Name Then\n            ws.Range(\"B1\", ws.Range(\"B1\").End(xlToRight).End(xlDown)).Copy\n            wsDest.Cells(1, Columns.Count).End(xlToLeft).Offset(\"B\").PasteSpecial xlPasteValues\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1545543049, "post_id": 53901304, "comment_id": 94647997, "body": "So just to make sure I understand correctly what this is supposed to do - it&#39;s finding common values among 3 ranges? Note - I don&#39;t see the point in multiplying the values by 1.  If you took that out, you&#39;d cut your traffic to the worksheet by a 3 orders of magnitude."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 4, "creation_date": 1545543166, "post_id": 53901304, "comment_id": 94648007, "body": "If you have working code that you&#39;re looking to improve, your question should be asked on <a href=\"https://codereview.stackexchange.com\">Code Review</a> instead."}, {"owner": {"reputation": 3, "user_id": 10825035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CosKNkgm6uU/AAAAAAAAAAI/AAAAAAAAABY/rXu-5E-DCQ8/photo.jpg?sz=128", "display_name": "Brandon Q", "link": "https://stackoverflow.com/users/10825035/brandon-q"}, "edited": false, "score": 0, "creation_date": 1545614206, "post_id": 53901304, "comment_id": 94661347, "body": "So basically the values saved one of the files are stored as text. I am multiplying the values by 1 to make them numbers so it matches. And thank you for letting me know the correct place to post this."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10825035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CosKNkgm6uU/AAAAAAAAAAI/AAAAAAAAABY/rXu-5E-DCQ8/photo.jpg?sz=128", "display_name": "Brandon Q", "link": "https://stackoverflow.com/users/10825035/brandon-q"}, "edited": false, "score": 0, "creation_date": 1545614843, "post_id": 53902247, "comment_id": 94661437, "body": "Fantastic thank you. This works wonderfully. I couldn&#39;t seem to figure out how to do this, it kept giving me an error when i tried to consolidate the for loop. probably because I am not experienced at all with VBA. I did not know about find or the Is Nothing part. Thank you. I works the same and is light speed now. :) Thanks DisplayName."}, {"owner": {"reputation": 3, "user_id": 10825035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CosKNkgm6uU/AAAAAAAAAAI/AAAAAAAAABY/rXu-5E-DCQ8/photo.jpg?sz=128", "display_name": "Brandon Q", "link": "https://stackoverflow.com/users/10825035/brandon-q"}, "edited": false, "score": 0, "creation_date": 1545615884, "post_id": 53902247, "comment_id": 94661575, "body": "Yeah I literally just saw that check mark there. It has been checked."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1545553868, "creation_date": 1545553868, "answer_id": 53902247, "question_id": 53901304, "link": "https://stackoverflow.com/questions/53901304/how-do-i-make-my-vba-code-more-efficient-using-for-each-loops-for-three-differen/53902247#53902247", "title": "How do I make my VBA code more efficient using For each loops for three different ranges?", "body": "<p>since you'r checking against matches of <code>WorkRng2</code> range values in <code>WorkRng1</code> and <code>WorkRng3</code>, you could loop through <code>WorkRng2</code> cells only</p>\n\n<p>and use <code>Find()</code> method of <code>Range</code> object to locate any possible match:</p>\n\n<pre><code>Dim WorkRng1 As Range, WorkRng2 As Range, WorkRng3 As Range, Rng2 As Range\nDim xTitleId As String\n\nxTitleId = \"KutoolsforExcel\"\n\nSet WorkRng1 = Application.InputBox(\"Range For List:\", xTitleId, \"A2:A1254\", Type:=8)\nSet WorkRng2 = Application.InputBox(\"Range For Floorscan:\", xTitleId, Type:=8)\nSet WorkRng3 = Application.InputBox(\"Range For RSVP:\", xTitleId, Type:=8)\n\n\nFor Each Rng2 In WorkRng2\n    If Not WorkRng1.Find(what:=Rng2.Value, LookIn:=xlValues, lookat:=xlWhole) Is Nothing Then Rng2.EntireRow.Interior.Color = VBA.RGB(125, 244, 66)\n    If Not WorkRng3.Find(what:=Rng2.Value, LookIn:=xlValues, lookat:=xlWhole) Is Nothing Then Rng2.EntireRow.Interior.Color = VBA.RGB(247, 113, 113)\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10825035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CosKNkgm6uU/AAAAAAAAAAI/AAAAAAAAABY/rXu-5E-DCQ8/photo.jpg?sz=128", "display_name": "Brandon Q", "link": "https://stackoverflow.com/users/10825035/brandon-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53902247, "answer_count": 1, "score": 0, "last_activity_date": 1545553868, "creation_date": 1545541004, "last_edit_date": 1545542731, "question_id": 53901304, "link": "https://stackoverflow.com/questions/53901304/how-do-i-make-my-vba-code-more-efficient-using-for-each-loops-for-three-differen", "title": "How do I make my VBA code more efficient using For each loops for three different ranges?", "body": "<p>Basically I have this code that finds matches over three ranges and colors accordingly. It is very slow and I need to figure out how to make it faster. </p>\n\n<p>Here is the code</p>\n\n<pre><code>Private Sub Search_Find_Match_Click()\n    Dim WorkRng1 As Range, WorkRng2 As Range, WorkRng3 As Range, _\n    Rng1 As Range, Rng2 As Range, Rng3 As Range\n\n    xTitleId = \"KutoolsforExcel\"\n\n    Set WorkRng1 = Application.InputBox(\"Range For List:\", xTitleId, \"A2:A1254\", Type:=8)\n    Set WorkRng2 = Application.InputBox(\"Range For Floorscan:\", xTitleId, Type:=8)\n    Set WorkRng3 = Application.InputBox(\"Range For RSVP:\", xTitleId, Type:=8)\n\n    For Each Rng1 In WorkRng1\n        rng1Value = Rng1.Value * 1\n        For Each Rng2 In WorkRng2\n            If Not IsEmpty(Rng2.Value) And Rng2.Value &lt;&gt; \"\" Then\n                Rng2.Value = Rng2.Value * 1\n            End If\n            If rng1Value = Rng2.Value Then\n                Rng2.EntireRow.Interior.Color = VBA.RGB(125, 244, 66)\n            End If\n            For Each Rng3 In WorkRng3\n                If Not IsEmpty(Rng3.Value) And Rng3.Value &lt;&gt; \"\" Then\n                    rng3Value = Rng3.Value * 1\n                End If\n                If rng3Value = Rng2.Value Then\n                    Rng2.EntireRow.Interior.Color = VBA.RGB(247, 113, 113)\n                    Exit For\n                End If\n            Next\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>Actual results are just what I want, but it is just so slow and I need help finding a more efficient way to do it</p>\n"}, {"tags": ["excel", "vba", "python-3.x", "pivot-table", "win32com"], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "edited": false, "score": 2, "creation_date": 1545597730, "post_id": 53901208, "comment_id": 94658495, "body": "Thank you for your guidance. I needed to go <code>PivotTable.CalculatedFields().Add(&quot;OC_GrossPct&quot;, &quot;= OoCUnits &#47; GrossUnits&quot;)</code> for it to work, with the extra ()."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1545598293, "last_edit_date": 1545598293, "creation_date": 1545539406, "answer_id": 53901208, "question_id": 53900913, "link": "https://stackoverflow.com/questions/53900913/how-to-add-calculated-member-to-pivot-table-via-python-win32/53901208#53901208", "title": "How to add Calculated Member to Pivot Table via Python win32", "body": "<p>Actually, the method is <code>PivotTable.CalculatedFields().Add()</code> according to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.calculatedfields.add\" rel=\"nofollow noreferrer\">docs</a>. Consider placing below at bottom:</p>\n\n<pre><code>CalcField = PivotTable.CalculatedFields().Add(\"OC_GrossPct\", \"= OoCUnits / GrossUnits\")\n\nPivotTable.PivotFields(\"OC_GrossPct\").Orientation = win32c.xlDataField\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 7632230, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00cb86bcdac89513f0207284280d5db7?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Cottrill", "link": "https://stackoverflow.com/users/7632230/matt-cottrill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 53901208, "answer_count": 1, "score": 1, "last_activity_date": 1545598293, "creation_date": 1545534319, "last_edit_date": 1545597850, "question_id": 53900913, "link": "https://stackoverflow.com/questions/53900913/how-to-add-calculated-member-to-pivot-table-via-python-win32", "title": "How to add Calculated Member to Pivot Table via Python win32", "body": "<p>I'm trying to add a calculated column into this pivot table that is being generated via a python script with <code>import win32com.client</code>.</p>\n\n<p>Code is posted below that is generating the pivot table. I'm not sure how to add a column. In VBA it would be <code>wb.PivotTable.CalculatedField.Add</code> but that didn't work (at least the syntax I tried).</p>\n\n<p>I'm trying to calculate <code>[OoCUnits] / [GrossUnits]</code></p>\n\n<pre><code>#Make Pivot version with four weeks data\nExcel = win32com.client.gencache.EnsureDispatch('Excel.Application')\nwin32c = win32com.client.constants\nwb = Excel.Workbooks.Open(filename)\nws3 = wb.Worksheets('Dataset')\n\ncl1 = ws3.Cells(1,1)\ncl2 = ws3.Cells(max_row,max_col)\nPivotSourceRange = ws3.Range(cl1,cl2)\nws3.Activate()\nPivotSourceRange.Select()\nwb.Sheets.Add (After=wb.Sheets(3))\nws4 = wb.Worksheets(4)\nws4.Name = 'Pivot'\n\ncl3 = ws4.Cells(4,1)\nPivotTargetRange = ws4.Range(cl3,cl3)\nPivotTableName = 'OoCPivot'\n\n#Make Pivot Table\nPivotCache = wb.PivotCaches().Create(SourceType=win32c.xlDatabase, SourceData=PivotSourceRange, Version=win32c.xlPivotTableVersion14)\nPivotTable = PivotCache.CreatePivotTable(TableDestination=PivotTargetRange, TableName=PivotTableName, DefaultVersion=win32c.xlPivotTableVersion14)\n\nPivotTable.PivotFields('Product Name').Orientation = win32c.xlRowField\nPivotTable.PivotFields('Product Name').Position = 1\nPivotTable.PivotFields('Customer Number').Orientation = win32c.xlPageField\nPivotTable.PivotFields('Customer Number').Position = 1\nPivotTable.PivotFields('Customer Name').Orientation = win32c.xlPageField\nPivotTable.PivotFields('Customer Name').Position = 2\nPivotTable.PivotFields('Week Ending Date').Orientation = win32c.xlColumnField\nPivotTable.PivotFields('Week Ending Date').Position = 1\nDataField = PivotTable.AddDataField(PivotTable.PivotFields('GrossUnits'))\nDataField.NumberFormat = '#0.00'\nDataField = PivotTable.AddDataField(PivotTable.PivotFields('OoCUnits'))\nDataField.NumberFormat = '#0.00'\n</code></pre>\n\n<p>I'm inserting the values with the <code>DataField</code>. The script is not presenting any issues as is.</p>\n\n<p>EDIT: The exact code I implemented to solve. The last two lines are just formatting. I'm including in case it helps someone else.</p>\n\n<pre><code>CalcField = PivotTable.CalculatedFields().Add('OoC Unit %','= OoCUnits / GrossUnits')\nDataField = PivotTable.AddDataField(PivotTable.PivotFields('OoC Unit %'))\nDataField.NumberFormat = '#%'\nPivotTable.DisplayErrorString = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545529624, "post_id": 53900555, "comment_id": 94646699, "body": "What do you mean by &quot;the reference cell has an #N/A value, but the written formula doesn&#39;t have that problem?&quot;"}, {"owner": {"reputation": 3286, "user_id": 7619676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7e32a3b0f08448f8e6099681622dd8?s=128&d=identicon&r=PG&f=1", "display_name": "ZaxR", "link": "https://stackoverflow.com/users/7619676/zaxr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545529701, "post_id": 53900555, "comment_id": 94646705, "body": "The cell D19 evaluates to #N/A. When I use Formula1:=&quot;=INDIRECT($D19)&quot;, the VBA can handle the fact that D19 is #N/A perfectly fine (it just has a dropdown with no options). When i use Formula1:=&quot;=INDIRECT($D&quot; &amp; CStr(r) &amp; &quot;)&quot;, I get a 400 error."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545529765, "post_id": 53900555, "comment_id": 94646710, "body": "I&#39;m confused - why are you trying to use <code>INDIRECT</code> on a cell that evaluates to <code>#N&#47;A</code>?"}, {"owner": {"reputation": 3286, "user_id": 7619676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7e32a3b0f08448f8e6099681622dd8?s=128&d=identicon&r=PG&f=1", "display_name": "ZaxR", "link": "https://stackoverflow.com/users/7619676/zaxr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545529811, "post_id": 53900555, "comment_id": 94646716, "body": "It usually doesn&#39;t evaluate to that - it just temporarily does because the formula in D is referencing a blank cell after the row insertion (code in the ...)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545530008, "post_id": 53900555, "comment_id": 94646736, "body": "Trying to replicate this: when the cell in column D evaluates to <code>#N&#47;A</code> - I just used <code>=NA()</code> as a test - the whole thing throws a 1004 run-time error whether you use an entire formula, e.g. <code>&quot;=INDIRECT($D19)&quot;</code>, or concatenate <code>r</code> in."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545530429, "post_id": 53900555, "comment_id": 94646786, "body": "What formula are you using in <code>D19</code>?"}, {"owner": {"reputation": 3286, "user_id": 7619676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7e32a3b0f08448f8e6099681622dd8?s=128&d=identicon&r=PG&f=1", "display_name": "ZaxR", "link": "https://stackoverflow.com/users/7619676/zaxr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545530469, "post_id": 53900555, "comment_id": 94646787, "body": "=&quot;Ref!$G$&quot;&amp;INDEX(Ref!$J:$J, MATCH($B19, Ref!$I:$I, 0))&amp;&quot;:G$&quot;&amp;INDEX(Ref!K:K, MATCH($B19, Ref!I:I, 0))"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545531827, "post_id": 53900555, "comment_id": 94646954, "body": "Replicating that exact formula, if the formula evaluates successfully, I can add the validation with either <code>&quot;=INDIRECT($D19)&quot;</code> or <code>&quot;=INDIRECT($D&quot; &amp; r &amp; &quot;)&quot;</code>. I get a run-time error if the formula is <code>#N&#47;A</code>, which makes me think you need to fix that first before trying to add validation."}, {"owner": {"reputation": 3286, "user_id": 7619676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7e32a3b0f08448f8e6099681622dd8?s=128&d=identicon&r=PG&f=1", "display_name": "ZaxR", "link": "https://stackoverflow.com/users/7619676/zaxr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1545532027, "post_id": 53900555, "comment_id": 94646978, "body": "I am only getting an error with the latter of those two options, which is strange...  The challenge is, there&#39;s a blank cell requiring the user to select a value from a dropdown that will inform the formula in D. I want it to start as blank. I&#39;d rather not create a fake or arbitrary default selection just so that formula looks like what it normally will. Any other ideas?"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 12304267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9bbf0b418a5e56863ed204615b49fdb?s=128&d=identicon&r=PG&f=1", "display_name": "ProfessorPorcupine", "link": "https://stackoverflow.com/users/12304267/professorporcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1572554913, "creation_date": 1572554913, "answer_id": 58650977, "question_id": 53900555, "link": "https://stackoverflow.com/questions/53900555/list-validation-for-a-cell/58650977#58650977", "title": "List validation for a cell", "body": "<p>You do not need to use the INDIRECT function in VBA to create a formula or cell reference from text.  Just do this:</p>\n\n<pre><code>Formula1:=\"=$D\" &amp; CStr(r)\n</code></pre>\n"}], "owner": {"reputation": 3286, "user_id": 7619676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7e32a3b0f08448f8e6099681622dd8?s=128&d=identicon&r=PG&f=1", "display_name": "ZaxR", "link": "https://stackoverflow.com/users/7619676/zaxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575790455, "creation_date": 1545528860, "last_edit_date": 1575790455, "question_id": 53900555, "link": "https://stackoverflow.com/questions/53900555/list-validation-for-a-cell", "title": "List validation for a cell", "body": "<p>I am trying to set list validation for a cell via VBA.</p>\n\n<p>I use a Formula1:= when the formula is a string.</p>\n\n<p>When I try to use &amp; to combine variables, it is giving me a 400 error.</p>\n\n<p>The issue with the version of Formula1 with concatenated variables seems to be that the reference cell has an #N/A value. The written formula doesn't have that problem.</p>\n\n<pre><code>Sub InsertRow()\n\n    r = Worksheets(\"Kickoff Schedule\").UsedRange.Rows.Count + Worksheets(\"Kickoff Schedule\").UsedRange.Rows(1).Row - 1\n    ...\n\n    With Range(\"E\" &amp; r).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n            Formula1:=\"=INDIRECT($D\" &amp; CStr(r) &amp; \")\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Full list of things I've tried and if they have/haven't worked:</p>\n\n<pre><code>' Works:\nFormula1:=\"=INDIRECT($D19)\"\n\n' Works:\nMsgBox \"=INDIRECT($D\" &amp; CStr(r) &amp; \")\"\n' MsgBox shows =INDIRECT($D19) , as expected\n\n' Doesn't work:\nFormula1:=\"=INDIRECT($D\" &amp; CStr(r) &amp; \")\"\n\n' Doesn't work:\nFormula1:=\"=INDIRECT(\"\"\" &amp; Range(\"D\" &amp; r).Address(False, False) &amp; \"\"\")\"\n\n' Shows one option with a string of the right formula, as expected:\nFormula1:=\"INDIRECT($D\" &amp; CStr(r) &amp; \")\"\n</code></pre>\n\n<p>I have already read <a href=\"https://stackoverflow.com/questions/31455822/using-indirect-function-in-data-validation-through-vba\">Using Indirect function in Data Validation through VBA</a></p>\n"}]