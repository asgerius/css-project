[{"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511395232, "post_id": 47445521, "comment_id": 81846622, "body": "&quot;not working&quot; is not a good description of your problem"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1511398026, "post_id": 47445521, "comment_id": 81847287, "body": "As @TimWilliams says, this leaves us with insufficient information. Your query has several columns that aren&#39;t used and has <code>dbo_</code> prefixes which makes me think you&#39;re reading a linked table to a SQL Server database. I also note that you omit the recordset type which most likely defaults to <code>dbOpenDynaset</code> when <code>dbOpenForwardOnly</code> would likely suffice. You also said you cannot do it with primary key. Is the primary key by any chance a <code>bigint</code>? If you open the linked table, do you see data?"}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511413764, "post_id": 47445521, "comment_id": 81850986, "body": "Thanks for the responses! I am home for the holiday but will try to shed some light. Yes, I am reading linked tables in a SQL Azure database. &#39;not working&#39; means I am getting the dbSeeChanges error even though I plugged in that option. The primary key is just a five digit number. I will try dbOpenForwardOnly when I am back at the office on Monday. I have only been using VBA for 2 months so I apologize if I&#39;m not sharing enough info."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511413890, "post_id": 47445521, "comment_id": 81851028, "body": "And yes, data does populate in the linked table when I open it. Perhaps on Monday I will show you the code in the loop that does work and that will allow you to spot the difference."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1511463813, "post_id": 47445521, "comment_id": 81878644, "body": "Hi, @this, just an update. I changed the type parameter to dbOpenForwardOnly and got a new error message, too few parameters, expected 1."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511463912, "post_id": 47445521, "comment_id": 81878673, "body": "Last thing...I know I I&#39;m referencing way too many columns in the SQL statement, but I tired to shorten it and received the same error..."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1511472061, "post_id": 47445521, "comment_id": 81881523, "body": "That error is a generic error which can be thrown whenever there are references to identifiers that don&#39;t exist. DAO will treat unresolved identifiers as a parameter, which is why you get that error. Double check your spelling of all columns &amp; table names."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1511473725, "post_id": 47445521, "comment_id": 81882038, "body": "Thanks @this. So, this code is pulled directly from the Access query design builder, which, when run, fetches the records I&#39;m looking for. So I know that it&#39;s not spelling or syntax. What I can tell you is that I have another loop through a recordset that does work. In my next two comments, I will post, first, a recordset that does work, and second, the recordset that does not work. Hopefully, with your skilled eye, you can spot a difference between the two that will point me in the right direction. My gut is that it has to do with the &quot;Like&quot; or criteria part of the statement."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511473748, "post_id": 47445521, "comment_id": 81882042, "body": "This is a recordset that can be looped through &quot;SELECT dbo_event_musician.name, musicians.[Email Address] FROM musicians INNER JOIN (dbo_event INNER JOIN dbo_event_musician ON dbo_event.job_number = dbo_event_musician.job_number) ON musicians.name = dbo_event_musician.name WHERE (((dbo_event.date) &gt; Now())) GROUP BY dbo_event_musician.name, musicians.[Email Address];&quot;"}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511473818, "post_id": 47445521, "comment_id": 81882060, "body": "Here is the recordset that I am having trouble with. SELECT dbo_event_musician.event_musician_id, dbo_sub_event.sub_event_id FROM dbo_sub_event LEFT JOIN dbo_event_musician ON dbo_sub_event.sub_event_id = dbo_event_musician.sub_event_id WHERE (((dbo_sub_event.sub_event_id) Like [Forms]![event_scheduling]![sub_event_selector]));"}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511473973, "post_id": 47445521, "comment_id": 81882105, "body": "The fundamental difference between the two is that the one that does work has a WHERE clause that is just based on the date, and the second one has a WHERE clause that is based on a selection in a listbox (yes, I made sure that something is selected in the listbox). I bet that has something do with it, but I don&#39;t know what!!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511494681, "post_id": 47465595, "comment_id": 81886583, "body": "Fascinating! Thanks for the thorough explanation. I thought that DAO was part of the ACE engine that Access uses to evaluate expressions, but now I understand that that&#39;s not the case. Now that I understand the problem, I think I will rewrite the query to avoid the problem expression."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511495286, "post_id": 47465595, "comment_id": 81886718, "body": "Oh wait, if I want to try your workaround Eval(), I need to rewrite the SQL Query as an expression, right? Eval() takes an expression, not a query. Can you help me with that @this? I&#39;m a drag and drop guy and don&#39;t know the syntax well enough to figure this out on my own."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "reply_to_user": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511501420, "post_id": 47465595, "comment_id": 81888215, "body": "No, you simply wrap the expressions like <code>Forms!MyForm!MyControl</code> inside the <code>Eval()</code> <i>inside</i> the SQL query statement, similar to this snippet.... <code>... dbo_event_musician.sub_event_id) Like Eval([Forms]![event_scheduling]!     [sub_event_selector]) ...</code>. Then it will work whenever you open it from UI or running it in the code with <code>Database.OpenRecordset</code>"}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511548368, "post_id": 47465595, "comment_id": 81911771, "body": "Eureka! The problem is solved :) Right now I&#39;m using the Eval() as a place holder until I can reverse engineer the code with QueryDef.Parameters."}, {"owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "edited": false, "score": 0, "creation_date": 1511548407, "post_id": 47465595, "comment_id": 81911785, "body": "would you be willing to provide me with your email address so that I can reach out to you directly with any issues/freelance work? You were so incredibly responsive and helpful...i&#39;d like to keep up this relationship!"}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 2, "last_activity_date": 1511490918, "creation_date": 1511490918, "answer_id": 47465595, "question_id": 47445521, "link": "https://stackoverflow.com/questions/47445521/open-recordset-with-obdc-tables-dbseechanges-not-working/47465595#47465595", "title": "Open recordset with OBDC tables, dbSeeChanges not working", "body": "<p>From your comments, it's actually not the <code>dbSeeChanges</code> that's the problem. Rather, it's that you are using Database.OpenRecordset, but it contains expression <code>[Forms]![event_scheduling]![sub_event_selector]</code>, which is foreign to DAO. </p>\n\n<p>See, it works in Access because you are going through the Access layer and Access recognizes those expressions and resolve them for you. But when you're using DAO directly (e.g. <code>Database.Execute</code> or <code>Database.OpenRecordset</code>), you are in fact bypassing Access and thus not getting those expression resolved. DAO correctly recognizes those as unresolved identifier and gives you the \"too few parameters\" error.</p>\n\n<p>One way to resolve this is to make use of <code>QueryDef.Parameters</code>, then perform an <code>OpenRecordset</code>.</p>\n\n<p>Here's a sample untested aircode to illustrate the point.</p>\n\n<pre><code>Dim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim rs As DAO.Recordset\n\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef\nqdf.SQL = \"PARAMETERS [MyFirstParameter] TEXT, [MySecondParameter] LONG; SELECT a, b, c FROM myTable WHERE a = [MyFirstParameter] AND b = [MySecondParameter];\"\nqdf.Parameters(\"MyFirstParameter\").Value = \"abc\"\nqdf.Parameters(\"MySecondParameter\").Value = 2\nSet rs = qdf.OpenRecordset(dbOpenDynaset, dbSeeChanges)\n</code></pre>\n\n<p>You can consult MSDN for more documentation <a href=\"https://msdn.microsoft.com/en-us/library/office/ff845640.aspx\" rel=\"nofollow noreferrer\">here</a>. The advantage of that approach is that you can specify what will be parameterized and how it should be resolved, then directly assign the value from where you were originally reading. That way you can avoid using fragile expressions like <code>Forms!MyForm!MyControl</code> which won't be validated until runtime and could give unexpected results. </p>\n\n<p>The alternative is to wrap the expression in an <code>Eval()</code> which will allow it to work in both contexts but I really do not like that because it basically allows arbitrary code execution in SQL and I'd prefer to avoid that.</p>\n"}], "owner": {"reputation": 1, "user_id": 2362865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af1c633e4fc72d99a7facb03ea8c3c2?s=128&d=identicon&r=PG", "display_name": "user2362865", "link": "https://stackoverflow.com/users/2362865/user2362865"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511490918, "creation_date": 1511394395, "last_edit_date": 1511422225, "question_id": 47445521, "link": "https://stackoverflow.com/questions/47445521/open-recordset-with-obdc-tables-dbseechanges-not-working", "title": "Open recordset with OBDC tables, dbSeeChanges not working", "body": "<p>I have been struggling all day with running a loop through a recordset in MS Access 2010. I've been able to do this before, but never when the recordset is referencing the primary key. I've resolved the dbSeeChanges error, but it's still not working. Thanks for any advice, and happy Thanksgiving!</p>\n\n<pre><code>Private Sub Command26_Click()\n\n    Dim Query As String\n    Dim db As Database\n    Dim rs As Recordset\n    Dim url1 As String\n    Dim url3 As String\n    Dim fullurl As String\n\n    url1 = \"http://arlenmusic.azurewebsites.net/access-event-musicians.php?\n    event_musician_id=\"\n    url3 = \"&amp;action=add\"\n    Query = \"SELECT dbo_event_musician.job_number, \n    dbo_event_musician.event_musician_id, dbo_event_musician.sub_event_id, \n    dbo_event_musician.name, dbo_event_musician.instrument_key, \n    dbo_event_musician.set_up_time, dbo_event_musician.start_time, \n    dbo_event_musician.booked_until, dbo_event_musician.special_songs, \n    dbo_event_musician.attire, dbo_event_musician.include_status, \n    dbo_event_musician.sub, dbo_event_musician.status, dbo_event_musician.notes, \n    dbo_event_musician.date_entered from dbo_event_musician WHERE   \n    (((dbo_event_musician.sub_event_id) Like [Forms]![event_scheduling]!\n    [sub_event_selector])) ORDER BY dbo_event_musician.instrument_key;\"\n\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(Query, , dbSeeChanges)\n    Do Until rs.EOF\n        fullurl = url1 + rs!event_musician_id + url3    \n        Application.FollowHyperlink (fullurl)         \n        rs.MoveNext     \n    Loop     \n\n    rs.Close\n    Set rs = Nothing \n    Set db = Nothing    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pdf", "powerpoint"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511391939, "post_id": 47445063, "comment_id": 81845688, "body": "Unless you have a reference to the Powerpoint library, you will need to give values to all the constants such as <code>ppFixedFormatTypePDF</code>.  Put <code>Option Explicit</code> as the first line of your code module and it will complain about anything that isn&#39;t defined."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511392036, "post_id": 47445063, "comment_id": 81845735, "body": "Re &quot;After I fix this problem ...&quot; - After the current issue is fixed, raise another question.  Trying to solve multiple issues in one questions just ends up getting the question closed as &quot;too broad&quot;."}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511397774, "post_id": 47445063, "comment_id": 81847240, "body": "I have not coded much .  I tried putting it in after Sub CreatePDFfiles_4() and it woudn&#39;t take it.  Where should I put Option Explicit?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511397849, "post_id": 47445063, "comment_id": 81847256, "body": "<code>Option Explicit</code> should be the <b>first</b> line of your code module - i.e. before any other line of code.  Go to the very top of the code (possibly your <code>Sub</code> statement, possibly something else), insert a line <b>before</b> it, enter <code>Option Explicit</code>."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1511399332, "post_id": 47445063, "comment_id": 81847578, "body": "Other than those PPT constants, you should also have issue with <code>ActivePresentation</code> inside Excel VBA. Where does <code>cor_file_name</code> come from? You don&#39;t seem to have pasted all the code for that Sub?"}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "edited": false, "score": 0, "creation_date": 1511400343, "post_id": 47445063, "comment_id": 81847798, "body": "I figured out where to put Option Explicit but how should I define ppFIxed FormatType PDF.  I tried string and it didn&#39;t work"}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "edited": false, "score": 0, "creation_date": 1511400462, "post_id": 47445063, "comment_id": 81847818, "body": "I added cor_file_name as string and used  PPPres.ExportAsFixedFormat invpath &amp; cor_file_name &amp; &quot;.pdf&quot;, ppFixedFormatTypePDF, ppFixedFormatIntentPrint but that didn&#39;t work and tried replacing PPPres with ACtivePresentation and that didn&#39;t work"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511401873, "post_id": 47445063, "comment_id": 81848092, "body": "Define <code>ppFixedFormatTypePDF</code> as a <code>Long</code> with a value of <code>2</code>. <code>ppFixedFormatIntentPrint</code> also is meant to have a value of <code>2</code>. (You can find the values of the constants by opening PowerPoint, going into the VBE, going to Object Browser, and searching for them.)  If you don&#39;t want to write the <code>Const ppFixedFormatTypePDF As Long = 2</code>, etc, statements you could just write the line as <code>PPPres.ExportAsFixedFormat PPPres.path &amp; &quot;\\&quot; &amp; cor_file_name &amp; &quot;.pdf&quot;, 2, 2</code>.  (But I would recommend you create the constants.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1511402081, "post_id": 47445063, "comment_id": 81848140, "body": "@PatricK The first time I read the code I couldn&#39;t see <code>cor_file_name</code> either.  It&#39;s not declared, so was defaulting to a <code>Variant&#47;String</code> variable, but it is actually set - <code>cor_file_name = ActiveCell.Value</code>."}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "edited": false, "score": 0, "creation_date": 1511404362, "post_id": 47445063, "comment_id": 81848652, "body": "Now I get a type mismatch on the line.  I defined the two constants are you suggested.  Is the problem the PPPres as the object?  thank you for all your help - clearly in over my head!"}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "edited": false, "score": 0, "creation_date": 1511988658, "post_id": 47445063, "comment_id": 82080856, "body": "I still haven&#39;t been able to figure this out .  STill get the type mismatch error on the"}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "edited": false, "score": 0, "creation_date": 1511989119, "post_id": 47445063, "comment_id": 82081088, "body": "I still haven&#39;t been able to figure this out.  I still get the type mistmatch error on PPPres.ExportAsFixedFormat PPPres.path &amp; &quot;\\&quot; &amp; cor_file_name &amp; &quot;.pdf&quot;, 2, 2"}, {"owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "edited": false, "score": 0, "creation_date": 1511989601, "post_id": 47445063, "comment_id": 82081347, "body": "I even got rid of the filename reference to make sure it wasn&#39;t that and still got the type mismatch error.     PPPres.ExportAsFixedFormat PPPres.path &amp; &quot;\\&quot; &amp; &quot;test.pdf&quot;, 2, 2"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8690328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pHIAffdVs-o/AAAAAAAAAAI/AAAAAAAAA0I/knhSEWrs9LU/photo.jpg?sz=128", "display_name": "LCCJR", "link": "https://stackoverflow.com/users/8690328/lccjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1585397890, "creation_date": 1585397890, "answer_id": 60901028, "question_id": 47445063, "link": "https://stackoverflow.com/questions/47445063/save-powerpoint-presentation-as-as-a-pdf-in-vba/60901028#60901028", "title": "Save powerpoint presentation as as a pdf in vba", "body": "<p>None of that worked for me. it was as simple as:</p>\n\n<pre><code>file_name = (path and name of the file you want to open)\nPath = (where you want to save it)\nPdfFileNm = (name of the file)\n\nSet PPT = CreateObject(\"PowerPoint.Application\")\nSet Pres = PPT.presentations.Open(file_name)\nPPT.ActivePresentation.SaveAs Path &amp; PdfFileNm &amp; \".pdf\", 32\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3194519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5629730d149083609494735daef81d2c?s=128&d=identicon&r=PG&f=1", "display_name": "user3194519", "link": "https://stackoverflow.com/users/3194519/user3194519"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2024, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593677543, "creation_date": 1511391046, "last_edit_date": 1593677543, "question_id": 47445063, "link": "https://stackoverflow.com/questions/47445063/save-powerpoint-presentation-as-as-a-pdf-in-vba", "title": "Save powerpoint presentation as as a pdf in vba", "body": "<p>I have looked at a lot of answers to this question but can't figure out what I have done wrong.  I am trying to create a pdf file.  I get my data from an excel file and copy it into powerpoint.  I then try to save as pdf but it keeps giving me an error (object required) at the saving pdf section of the macro (see below).  I tried changing it multiple times but still can't get it to work.  Have attached code below.  After I fix this problem, I need to be able to change the size of the object I pasted in - how do I do that.</p>\n\n<pre><code>Sub CreatePDFfiles_4()\n\n\nDim PPapp As Object\nDim PPPres As Object\nDim first_file As Boolean\nDim investorname As String\nDim path As String\n\n\nSheets(\"printing\").Select\nRange(\"g2\").Select\nfile1 = ActiveCell.Value\nRange(\"g3\").Select\npath = ActiveCell.Value\nRange(\"g8\").Select\ninvestorname = ActiveCell.Value\nRange(\"i8\").Select\ncor_file_name = ActiveCell.Value\nDestinationPPT = \"C:\\Users\\name\\Documents\\company\\Investment Model\\printing macro\\template.pptx\"\n\n\nWhile investorname &lt;&gt; \"end\"\n    ActiveCell.Offset(0, -1).Select\n    print_data = ActiveCell.Value\n    If print_data = \"Yes\" Then\n\n        ' Initialize PowerPoint Object Library\n        Set PPapp = CreateObject(\"Powerpoint.Application\")\n        PPapp.Visible = True\n\n        ' Open presentation\n        Set PPPres = PPapp.Presentations.Open(DestinationPPT)\n\n        'Copy excel file data\n        Windows(file1).Activate\n        Sheets(investorname).Select\n        Range(\"b1:r46\").Select\n        Selection.Copy\n\n        'Paste into existing powerpoint template slide that is open\n        PPPres.slides(1).Shapes.Paste\n\n        'Save as pdf\n        PPPres.ExportAsFixedFormat ActivePresentation.path &amp; \"\\\" &amp; cor_file_name &amp; \".pdf\", ppFixedFormatTypePDF, ppFixedFormatIntentPrint\n\n\n\n        PPapp.Quit\n        Set PPapp = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511390630, "post_id": 47444875, "comment_id": 81845289, "body": "Which sheet is the <code>Worksheet_Change</code> event on? Sheet 1? or Sheet 2?  The <code>Change</code> event only fires when a cell is changed, not when it is recalculated to be a different number, so I assume it is in Sheet 2 (as that is where you say you are changing the numbers).  What are the formulas in column B of Sheet 1? (It doesn&#39;t sound like the Match portion is being based on column A.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1511396141, "post_id": 47444875, "comment_id": 81846844, "body": "You&#39;re writing values back to the worksheet that was triggered without disabling events. This is going to run on top of itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1511396254, "post_id": 47444875, "comment_id": 81846878, "body": "Don&#39;t try and set .Value2; set .Value from another cell&#39;s .Value2."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511417491, "post_id": 47444875, "comment_id": 81852280, "body": "@YowE3K 1) Yes, the event handler is in <code>Sheet2</code>. 2) There is no formula in <code>B:B</code>. It is set in the event handler. 3) I presume the match formula is based on other, undisclosed columns."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "edited": false, "score": 1, "creation_date": 1511419195, "post_id": 47444875, "comment_id": 81853081, "body": "@Jeeped 1) Yes, the script as it was originally posted (before I swapped it for the correct version), would have <i>safely</i> caused exactly one extra triggering of the change event every time. The correct version doesn&#39;t need events disabled as it only updates <code>Sheet1</code> from the <code>Sheet2</code> event handler.  2) Can you tell me what detrimental effects or issues are caused by setting <code>.Value2</code>? I switched to using <code>.Value2</code> for setting so that sets and gets were consistent and I wouldn&#39;t accidentally use <code>.Value</code> for getting. I haven&#39;t noticed any problems since doing so."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511443109, "post_id": 47447013, "comment_id": 81867307, "body": "I&#39;ve put that in but i don&#39;t seem to be getting any results from counter of each value in sheet 1 when I change the values in sheet 2.."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511443313, "post_id": 47447013, "comment_id": 81867425, "body": "What are the formulas you have in <code>Sheet1!A:A</code> and <code>Sheet1!C:C</code>?"}, {"owner": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511444196, "post_id": 47447013, "comment_id": 81868011, "body": "Sheet 1 A:A grabs values from Sheet 2 A:A. Im not using column C at all"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511444341, "post_id": 47447013, "comment_id": 81868104, "body": "@Anna <b>Read my answer carefully,</b> <b><i>especially the first sentence.</i></b>"}, {"owner": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511445553, "post_id": 47447013, "comment_id": 81868932, "body": "I still don&#39;t understand where I&#39;m going wrong. Can you show me the formula for one of the cells in row A:A C:C pls"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511446436, "post_id": 47447013, "comment_id": 81869470, "body": "@Anna Like my first sentence says: I don&#39;t have any useful formulae. <i>You</i> said you were using an <code>INDEX-MATCH</code> formula in <code>Sheet1!A:A</code> that was resulting in a reduced set of values in that column. <i>That</i> is the formula I asked you for. Like the first sentence also says, the formula in <code>Sheet1!C:C</code> is the <code>MATCH</code> part of that formula. If you post your formula (i.e. whatever you have in <code>Sheet1!A:A</code> that &quot;grabs&quot; the values from <code>Sheet2!A:A</code>), I can show you how to break it up into the two columns. (I&#39;m testing with hardcoded values in <code>C:C</code> and a simple <code>INDEX</code> in <code>A:A</code>.)"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511446979, "post_id": 47447013, "comment_id": 81869785, "body": "@Anna So if you <i>really</i> want my testing formula, enter <code>=INDEX(Sheet2!A:A,C1)</code> in <code>A1</code> and fill it down to <code>A3</code>. Also enter <code>1,2,5</code> in <code>C:C</code> like in my screenshot."}, {"owner": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511447158, "post_id": 47447013, "comment_id": 81869899, "body": "OK I&#39;m trying to replicate my problem into a smaller spreadsheet. So I&#39;ve incorporated a numbering in  column A:A (1-6) that&#39;s how I grab my numbers from sheet 2. Formulae : {=INDEX(Sheet2!B:B,MATCH(Sheet1A1!, Sheet2!A:A,0))}"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511448364, "post_id": 47447013, "comment_id": 81870661, "body": "@Anna I&#39;m sorry, but that formula doesn&#39;t make any sense. Which cell(s) does it go in? Neither array-entering it in <code>Sheet1!A1</code> and then filling down, nor array entering it in <code>Sheet1!A1:A6</code> does anything except result in <code>0</code>s. It seems to have a self-reference. I presume the typo <code>Sheet1A1!</code> should be <code>Sheet1!A1</code>?"}, {"owner": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511453241, "post_id": 47447013, "comment_id": 81873607, "body": "It goes in the value I&#39;m trying to look for, in this case it&#39;s 20, 12 etc. It worked for my however I had to slightly tweak the code a little thank you! I promise this is the last issue I&#39;m having. What if I have my values in a different column for sheet2. Say I have my values in column C instead of B and I want my results to be pasted into Column D (Sheet1)."}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "edited": false, "score": 0, "creation_date": 1511454078, "post_id": 47447013, "comment_id": 81874062, "body": "@Anna That&#39;s why I have the list of constants at the top of the code. <code>s_InputColumn</code>  is the &quot;input column&quot; for <code>Sheet2</code>. <code>s_CountColumn</code> is the &quot;count column&quot; for <code>Sheet1</code>. Just change their values to the required columns, and the code will automatically adjust."}], "tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": true, "score": 1, "last_activity_date": 1511421300, "last_edit_date": 1511421300, "creation_date": 1511407067, "answer_id": 47447013, "question_id": 47444875, "link": "https://stackoverflow.com/questions/47444875/counter-script-results-in-unaligned-values/47447013#47447013", "title": "Counter script results in unaligned values", "body": "<p>The simplest way to modify the existing code so it works with the new requirement (i.e. rows in <code>Sheet1</code> no longer need to correspond to the same numbered rows in <code>Sheet2</code>), is to use an extra column in <code>Sheet1</code>, say column <code>C</code>, whose formula is the <code>MATCH</code> part of the <code>INDEX-MATCH</code> formula in column <code>A</code>. </p>\n\n<p>For your supplied example, the two sheets would then initially look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eTYTa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eTYTa.png\" alt=\"Sheet1 Initial\"></a> <a href=\"https://i.stack.imgur.com/PzmAG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PzmAG.png\" alt=\"Sheet2 Initial\"></a></p>\n\n<p>The row numbers in <code>Sheet1!C:C</code> can then be used to find the row in <code>Sheet1</code> corresponding to the changed cell in <code>Sheet2!A:A</code> (by looking up the changed cell's row in the row numbers). Incrementing <em>that</em> row's <code>B</code> column keeps the counts correctly aligned:</p>\n\n<pre><code>'============================================================================================\n' Module     : &lt;The appropriate sheet module&gt;\n' Version    : 1.0.2\n' Part       : 1 of 1\n' References : N/A\n' Source     : https://stackoverflow.com/a/47447013/1961728\n'============================================================================================\nOption Explicit\n\nPrivate Enum e_MatchType\n  GreaterThan = -1\n  ExactMatch\n  LessThan\nEnd Enum\n\nPrivate Sub Worksheet_Change _\n            ( _\n                       ByVal Target As Range _\n            )\n\n  Const s_LogSheetName As String = \"Sheet1\"\n  Const s_CheckColumn As String = \"A:A\"\n  Const s_CountColumn As String = \"B:B\"\n  Const s_MatchColumn As String = \"C:C\"\n  Const s_InputColumn As String = \"A:A\"\n  Const l_Error As String = \"Error\"\n\n  If Intersect(Target, Range(s_InputColumn)) Is Nothing Then Exit Sub\n\n  With Worksheets(s_LogSheetName)\n    Dim rngCell As Range\n    For Each rngCell In Intersect(Target, Range(s_InputColumn))\n      Dim varMatchingLogRow As Variant\n      varMatchingLogRow = Application.Match(rngCell.Row, .Range(s_MatchColumn), e_MatchType.ExactMatch)\n      If TypeName(varMatchingLogRow) &lt;&gt; l_Error Then\n        If .Range(s_MatchColumn).Cells(varMatchingLogRow) = rngCell.Row Then\n          With .Range(s_CountColumn).Cells(varMatchingLogRow)\n            .Value2 = IIf(.Value2 &lt;&gt; vbNullString, .Value2 + 1, IIf(rngCell.Value2 &lt;&gt; vbNullString, 0, vbNullString))\n          End With\n        End If\n      End If\n    Next rngCell\n  End With\n\nEnd Sub\n</code></pre>\n\n<p><br>\n<strong>Note:</strong>\n<br>\nIf either the values in <code>Sheet2!A:A</code> are <strong><em>guaranteed</em></strong> to be unique, or it's acceptable to track identical <code>Sheet2!A:A</code> value changes in the <strong><em>first</em></strong> matching <code>Sheet1!A:A</code> row, then it <em>is</em> possible to get away without using an extra column in <code>Sheet1</code>. </p>\n"}], "owner": {"reputation": 37, "user_id": 5417544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255238a6b68e1d9fa6cb0b89eb881156?s=128&d=identicon&r=PG&f=1", "display_name": "Axa", "link": "https://stackoverflow.com/users/5417544/axa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47447013, "answer_count": 1, "score": 1, "last_activity_date": 1511421300, "creation_date": 1511389896, "last_edit_date": 1511416619, "question_id": 47444875, "link": "https://stackoverflow.com/questions/47444875/counter-script-results-in-unaligned-values", "title": "Counter script results in unaligned values", "body": "<p>I'm currently having trouble aligning the results set by a VBA script.</p>\n\n<p><code>Sheet2</code> is where the data is entered/modified. <code>Sheet1</code> is just the interface and grabs the data from <code>Sheet2</code> and shows the count. <code>Sheet2</code>'s <code>Worksheet_Change</code> event handler is where the script updates the counts in <code>Sheet1!B:B</code> with the number of times the values in <code>Sheet2!A:A</code> have been changed.</p>\n\n<p>At the moment, the script works correctly when the formula in <code>Sheet1!A:A</code> copies the value from the corresponding row of <code>Sheet2!A:A</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iLrBa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iLrBa.png\" alt=\"Sheet1 A\"></a> <a href=\"https://i.stack.imgur.com/vmcwi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vmcwi.png\" alt=\"Sheet2 A\"></a> \u27a1 <a href=\"https://i.stack.imgur.com/5rUK3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5rUK3.png\" alt=\"Sheet1 B\"></a> <a href=\"https://i.stack.imgur.com/cKQYV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cKQYV.png\" alt=\"Sheet2 B\"></a></p>\n\n<p>The first set of images shows the initial state after some values have first been entered into <code>Sheet2</code>. The second set shows the result after changing <code>Sheet2!A2</code> and <code>Sheet2!A5</code>.</p>\n\n<p>This is the script:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change _\n            ( _\n                       ByVal Target As Range _\n            )\n\n  Const s_CheckColumn As String = \"A:A\"\n  Const s_CountColumn As String = \"B:B\"\n\n  If Intersect(Target, Range(s_CheckColumn)) Is Nothing Then Exit Sub\n\n  Dim rngCell As Range\n  For Each rngCell In Intersect(Target, Range(s_CheckColumn))\n    With Worksheets(\"Sheet1\").Range(s_CountColumn).Cells(rngCell.Row)\n      .Value2 = IIf(.Value2 &lt;&gt; vbNullString, .Value2 + 1, IIf(rngCell.Value2 &lt;&gt; vbNullString, 0, vbNullString))\n    End With\n  Next rngCell\n\nEnd Sub\n</code></pre>\n\n<p><br>\nNow, however, I want to grab the values from <code>Sheet2</code> using an Index-Match formula in <code>Sheet1!A:A</code>. This results in some rows being skipped. Unfortunately, this causes some of the counts to be misaligned:</p>\n\n<p><a href=\"https://i.stack.imgur.com/de1oK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/de1oK.png\" alt=\"Sheet1 C\"></a> <a href=\"https://i.stack.imgur.com/hXvEn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hXvEn.png\" alt=\"Sheet2 C\"></a> \u27a1 <a href=\"https://i.stack.imgur.com/8BlNZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8BlNZ.png\" alt=\"Sheet1 D\"></a> <a href=\"https://i.stack.imgur.com/W6GPG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W6GPG.png\" alt=\"Sheet2 D\"></a></p>\n\n<p>As you can see, when <code>Sheet2!A5</code> is changed, the count in <code>Sheet1!B5</code> is updated instead of the count in <code>Sheet1!B3</code>.</p>\n\n<p>How would I go about making the script correctly line up the counts with the values in <code>Sheet1</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1511386872, "post_id": 47444213, "comment_id": 81843796, "body": "There is nothing in that code that would cause <code>Application.ScreenUpdating</code> to be set back to <code>True</code>.  Are you sure you don&#39;t have a <code>Worksheet_Change</code> event that is being fired when N10 or N11 is modified, and <b>that</b> code is switching <code>ScreenUpdating</code> back on?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511387008, "post_id": 47444213, "comment_id": 81843853, "body": "Also remember that single-stepping through your code will effectively treat <code>ScreenUpdating</code> as being <code>True</code>, so if that was how you narrowed it down to this piece of code it doesn&#39;t mean anything."}, {"owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511387419, "post_id": 47444213, "comment_id": 81844023, "body": "This sub does get called from a Worksheet_Change event.  But that is supposed to only trigger from a change in a different cell. (<code>If Target.Cells.count &gt; 1 Or IsEmpty(Target) Then Exit Sub  If Not Intersect(Me.Range(&quot;Table[Name]&quot;), Target) Is Nothing Then</code>"}, {"owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511387546, "post_id": 47444213, "comment_id": 81844081, "body": "It&#39;s weird because if I <code>debug.print</code> from anywhere else in the code it returns <code>False</code>.  It&#39;s only when it&#39;s inside the Select Case statement that it&#39;s <code>True</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1511387602, "post_id": 47444213, "comment_id": 81844102, "body": "Please post the worksheet change event.  if the Application.ScreenUpdating is reset to true before exiting that sub any time a change is made on the worksheet it will turn it back on."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1511388351, "post_id": 47444213, "comment_id": 81844421, "body": "As I stated.  Since the <code>Application.ScreenUpdating = True</code> is outside the <code>If...Then</code> it will fire every time a cell on that sheet is changed.  And since you change things with your code above, the screen updating is turned back on.  move the <code>Application.ScreenUpdating = True</code> before the <code>End If</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1511388475, "post_id": 47444213, "comment_id": 81844484, "body": "Or set <code>Application.EnableEvents = False</code> prior to making changes to the cells, and switch it back to <code>True</code> after you finish making the changes - that will prevent the <code>Worksheet_Change</code> event being fired again half-way through your code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511388525, "post_id": 47444213, "comment_id": 81844504, "body": "Or just leave the <code>Application.ScreenUpdating = True</code> out completely.  It Automatically turns back on after the code finishes."}, {"owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "edited": false, "score": 0, "creation_date": 1511388984, "post_id": 47444213, "comment_id": 81844666, "body": "I see!  I&#39;m still new to all this but now it makes perfect sense.  Thank you that worked great."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1511391709, "post_id": 47444213, "comment_id": 81845605, "body": "Scott: Sometimes it inexplicably doesn&#39;t turn back on at the end of the routine in some of my projects. I always turn it on again just in case."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1511404087, "creation_date": 1511404087, "answer_id": 47446660, "question_id": 47444213, "link": "https://stackoverflow.com/questions/47444213/select-case-statement-is-turning-application-screenupdating-back-on/47446660#47446660", "title": "Select Case statement is turning Application.ScreenUpdating back on", "body": "<p>What is happening is that your changes to cells N10 and N11 are re-firing the <code>Worksheet_Change</code> event, and the last line of that event is setting <code>Application.ScreenUpdating = True</code>.</p>\n\n<p>It is usually best to disable events while processing an event (unless you really, <strong>really</strong> need to recursively call it for some reason).  Disabling events is achieved using</p>\n\n<pre><code>Application.EnableEvents = False\n</code></pre>\n\n<p><em>Note: Be very careful that you always re-enable events when you finish, or else you will spend hours scratching your head wondering why your <code>Change</code> (etc) events are no longer being fired.</em></p>\n\n<p>So your code would be better written as:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Cells.count &gt; 1 Or IsEmpty(Target) Then Exit Sub\n\n    If Intersect(Me.Range(\"Table[Name]\"), Target) Is Nothing Then Exit Sub\n\n    Application.ScreenUpdating = False\n    'On Error statements are often more trouble than they are worth - but this is one\n    '  occasion where it is dangerous not to use one.  You can't afford not to go\n    '  through the statement re-enabling events.\n    On Error GoTo ReEnableEvents\n    Application.EnableEvents = False\n    '...\n    If count &gt; 1 Then\n        Select Case count\n            Case 2\n                Range(\"N10\") = arrSkills(1)\n            Case 3\n                Range(\"N10\") = arrSkills(1)\n                Range(\"N11\") = arrSkills(2)\n            Case 4\n                Range(\"N10\") = arrSkills(1) &amp; \" \" &amp; arrSkills(2)\n                Range(\"N11\") = arrSkills(3)\n            Case 5\n                Range(\"N10\") = arrSkills(1) &amp; \" \" &amp; arrSkills(2)\n                Range(\"N11\") = arrSkills(3) &amp; \" \" &amp; arrSkills(4)\n            Case Else\n                MsgBox \"Make room for more Skills\"\n        End Select\n    Else\n        '...\n    End If\n    '...\n    Application.ScreenUpdating = True\nReEnableEvents:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 4439563, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2d3a7462cfde9fb73869c40db702f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "bigbucky", "link": "https://stackoverflow.com/users/4439563/bigbucky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511404087, "creation_date": 1511386527, "last_edit_date": 1511388839, "question_id": 47444213, "link": "https://stackoverflow.com/questions/47444213/select-case-statement-is-turning-application-screenupdating-back-on", "title": "Select Case statement is turning Application.ScreenUpdating back on", "body": "<p>I keep getting Screen.Updating turned back on when running this sub.  Narrowed it down to this Select Case statement.  The code works it just keeps turning the updating back on.  </p>\n\n<pre><code>If count &gt; 1 Then\nSelect Case count\n    Case 2\n        Range(\"N10\") = arrSkills(1)\n    Case 3\n        Range(\"N10\") = arrSkills(1)\n        Range(\"N11\") = arrSkills(2)\n    Case 4\n        Range(\"N10\") = arrSkills(1) &amp; \" \" &amp; arrSkills(2)\n        Range(\"N11\") = arrSkills(3)\n    Case 5\n        Range(\"N10\") = arrSkills(1) &amp; \" \" &amp; arrSkills(2)\n        Range(\"N11\") = arrSkills(3) &amp; \" \" &amp; arrSkills(4)\n    Case Else\n        MsgBox \"Make room for more Skills\"\nEnd Select\n\nElse\n\nEnd If\n</code></pre>\n\n<p>Here's the Worksheet_Change event</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\nIf Target.Cells.count &gt; 1 Or IsEmpty(Target) Then Exit Sub\n\nIf Not Intersect(Me.Range(\"Table[Name]\"), Target) Is Nothing Then\n\nApplication.ScreenUpdating = False\n\n'Code where the Select Case Statement is called\n\nEnd If\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1511386518, "post_id": 47444125, "comment_id": 81843650, "body": "<code>Global</code> keyword has been deprecated over 20 years ago. <code>Public</code> does exactly the same thing. If you have projects A and B, and you need project A to use code in project B, then you need project A to have a <i>reference</i> to project B. But really, consider reading/writing the configuration settings in some file instead."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1511386519, "post_id": 47444125, "comment_id": 81843652, "body": "If this is Access, wouldn&#39;t it make more sense to have a <b>table</b> called <code>APP_TABLES_TO_BACKUP</code> in each individual database to specify that information?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511386558, "post_id": 47444125, "comment_id": 81843666, "body": "@YowE3K gosh I always miss the Access tag lol"}, {"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511389083, "post_id": 47444125, "comment_id": 81844710, "body": "@Mat&#39;s Mug - Yeah, it should read <code>Public</code> vs. <code>Global</code>... and I probably should use the <code>TempVars</code> collection.... or a table like @YowE3K metntions (though I&#39;d rather not add that to the app since it&#39;s only used when I&#39;m doing versioning). Hmmm..."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1511425765, "last_edit_date": 1511425765, "creation_date": 1511423416, "answer_id": 47450122, "question_id": 47444125, "link": "https://stackoverflow.com/questions/47444125/how-to-set-a-vba-global-variable-in-one-project-use-in-another-project/47450122#47450122", "title": "How to set a VBA global variable in one project &amp; use in another project?", "body": "<p>You can add a reference to an external database in your VCS database.</p>\n\n<p>How? See <a href=\"https://stackoverflow.com/a/47099976/7296893\">this answer</a>.</p>\n\n<p>Make sure your module and function names between the two databases don't conflict. Then you can just reference your const by using <code>MyModule.APP_TABLES_TO_BACKUP</code>, or if you have multiple projects with the same module and constant name, <code>MyProject.MyModule.APP_TABLES_TO_BACKUP</code></p>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "is_accepted": true, "score": 0, "last_activity_date": 1511564678, "creation_date": 1511564678, "answer_id": 47481028, "question_id": 47444125, "link": "https://stackoverflow.com/questions/47444125/how-to-set-a-vba-global-variable-in-one-project-use-in-another-project/47481028#47481028", "title": "How to set a VBA global variable in one project &amp; use in another project?", "body": "<p>Since my earlier post apparently didn't come through a couple days ago...</p>\n\n<p>After searching a bit further I came across <a href=\"http://allenbrowne.com/ser-09.html\" rel=\"nofollow noreferrer\">Paul Murray's custom database properties</a> which work nicely.</p>\n\n<p>With some tweaks I created a module that includes generic property add, remove methods.</p>\n\n<pre><code>' ---------------------------------\n' FUNCTION:     AddDbProperty\n' Description:  add custom properties to a database application\n' ---------------------------------\nPublic Function AddDbProperty(DbProperty As String, _\n                    DbPropertyValue As String, _\n                    Optional DbPropertyType As Long = DB_TEXT, _\n                    Optional DbFilename As String = \"Current\")\nOn Error GoTo Err_Handler\n\n    Dim db As DAO.Database\n    Dim prop As Property\n\n    If DbFilename = \"Current\" Then\n        Set db = DBEngine(0)(0)\n    Else\n        Set db = OpenDatabase(DbFilename)\n    End If\n\n    'add the property\n    Set prop = db.CreateProperty(DbProperty, DbPropertyType, DbPropertyValue)\n    db.Properties.Append prop\n\nExit_Handler:\n    db.Close\n    Set db = Nothing\n    Exit Function\n\nErr_Handler:\n    Select Case Err.Number\n      Case Else\n        MsgBox \"Error #\" &amp; Err.Number &amp; \": \" &amp; Err.description, vbCritical, _\n            \"Error encountered (#\" &amp; Err.Number &amp; \" - AddDbProperty[mod_Dev_Properties])\"\n    End Select\n    Resume Exit_Handler\nEnd Function\n\n' ---------------------------------\n' FUNCTION:     RemoveDbProperty\n' Description:  remove custom properties from a database applciation\n' ---------------------------------\nPublic Function RemoveDbProperty(DbProperty As String, _\n                    Optional DbFilename As String = \"Current\")\nOn Error GoTo Err_Handler\n\n    Dim db As DAO.Database\n\n    If DbFilename = \"Current\" Then\n        Set db = DBEngine(0)(0)\n    Else\n        Set db = OpenDatabase(DbFilename)\n    End If\n\n    'remove the property\n    db.Properties.Delete DbProperty\n\nExit_Handler:\n    db.Close\n    Set db = Nothing\n    Exit Function\n\nErr_Handler:\n    Select Case Err.Number\n      Case Else\n        MsgBox \"Error #\" &amp; Err.Number &amp; \": \" &amp; Err.description, vbCritical, _\n            \"Error encountered (#\" &amp; Err.Number &amp; \" - RemoveDbProperty[mod_Dev_Properties])\"\n    End Select\n    Resume Exit_Handler\nEnd Function\n\n' ---------------------------------\n' FUNCTION:     UpdateDbProperty\n' Description:  add custom properties to a database application\n' ---------------------------------\nPublic Function UpdateDbProperty(DbProperty As String, _\n                    DbPropertyValue As String, _\n                    Optional DbFilename As String = \"Current\")\nOn Error GoTo Err_Handler\n\n    Dim db As DAO.Database\n\n    If DbFilename = \"Current\" Then\n        Set db = DBEngine(0)(0)\n    Else\n        Set db = OpenDatabase(DbFilename)\n    End If\n\n    'add the property\n    db.Properties(DbProperty) = DbPropertyValue\n\nExit_Handler:\n    db.Close\n    Set db = Nothing\n    Exit Function\n\nErr_Handler:\n    Select Case Err.Number\n      Case Else\n        MsgBox \"Error #\" &amp; Err.Number &amp; \": \" &amp; Err.description, vbCritical, _\n            \"Error encountered (#\" &amp; Err.Number &amp; \" - UpdateDbProperty[mod_Dev_Properties])\"\n    End Select\n    Resume Exit_Handler\nEnd Function\n</code></pre>\n\n<p>Using the IDE immediate window properties can be added/updated/removed.</p>\n\n<p>For example:</p>\n\n<p><code>?AddDbProperty(\"My Property Name\",\"My Property value\")</code></p>\n\n<p>Retrieving the property is readily done via vba</p>\n\n<p><code>CurrentDb.Properties(\"My Property Name\")</code></p>\n\n<p>Thanks all for the also viable inputs!</p>\n"}], "owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 47481028, "answer_count": 2, "score": 1, "last_activity_date": 1594638761, "creation_date": 1511386106, "last_edit_date": 1594638761, "question_id": 47444125, "link": "https://stackoverflow.com/questions/47444125/how-to-set-a-vba-global-variable-in-one-project-use-in-another-project", "title": "How to set a VBA global variable in one project &amp; use in another project?", "body": "<p><strong>Background</strong></p>\n\n<p>A version control database called VCS (project name = VCS) is used for a variety of version control tasks.</p>\n\n<p>Various other application databases have VCS set up as a reference.</p>\n\n<p>In these app databases a global variable is set to identify which tables within them to backup:</p>\n\n<p><code>Global Const APP_TABLES_TO_BACKUP = \"tbl1, tbl2, tbl5\"</code></p>\n\n<p><strong>Problem</strong></p>\n\n<p>The question is, how to reference this <code>APP_TABLES_TO_BACKUP</code>constant from the VCS project?</p>\n\n<p>Because each app has its own setting for this value, it makes sense to set the value in a module of the app and call that value from the VCS database project.</p>\n\n<p>Any ideas on how to do that?</p>\n\n<p><strong>So far...</strong></p>\n\n<p>I've searched and found Chip Pearson's <a href=\"http://www.cpearson.com/excel/scope.aspx\" rel=\"nofollow noreferrer\">Understanding Scope</a>, but not quite gotten how to set and reference the global variable.</p>\n\n<p>In the immediate window of the app I can type <code>?APP_TABLES_TO_BACKUP</code> and retrieve the tables, but I can't seem to see how to reference that same variable from the VCS database so it can be used in a subroutine there.</p>\n\n<p><em>Any ideas?</em></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "edited": false, "score": 1, "creation_date": 1511885131, "post_id": 47444787, "comment_id": 82028694, "body": "Thx PatricK for the correction, definitely more useful that way!"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 2, "last_activity_date": 1511389460, "creation_date": 1511389460, "answer_id": 47444787, "question_id": 47443844, "link": "https://stackoverflow.com/questions/47443844/find-column-name-of-active-cell-within-listobject-in-excel/47444787#47444787", "title": "Find column name of active cell within ListObject in Excel", "body": "<p>Possible issue with your method occurs when the ListObject doesn't start from Column A.</p>\n\n<p>Con: Fixed to the table \"tMain\" only, cannot use on any other tables.</p>\n\n<p>You can try this (if Target is more than 1 cell, only the top left cell is used):</p>\n\n<pre><code>Option Explicit\n\nFunction ColumnName(ByRef Target As Range) As String\n    If Not Target.ListObject Is Nothing Then\n        ColumnName = Intersect(Target.ListObject.HeaderRowRange, Target.EntireColumn).Value\n    Else\n        ColumnName = \"\"\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 7269695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYV8e.png?s=128&g=1", "display_name": "Firefighter1017", "link": "https://stackoverflow.com/users/7269695/firefighter1017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2524, "favorite_count": 0, "accepted_answer_id": 47444787, "answer_count": 1, "score": 1, "last_activity_date": 1511389460, "creation_date": 1511384598, "last_edit_date": 1511386001, "question_id": 47443844, "link": "https://stackoverflow.com/questions/47443844/find-column-name-of-active-cell-within-listobject-in-excel", "title": "Find column name of active cell within ListObject in Excel", "body": "<p>I have a table defined in Excel as a ListObject:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eAekk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eAekk.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In VbA, I can access rows and columns using <code>ListObject(\"table1\").ListRows</code> or <code>ListObject(\"table1\").ListColumns</code></p>\n\n<p>In one of my subs, I wan't to know the active cell's column name.  And because the columns could be moved around, I want this to be dynamic.</p>\n\n<p>For example, in the previous image, let's say I clicked on a cell of the third column.\nI'd like to have a function that tells me the column name associated with that cell in the current ListObject.</p>\n\n<p>In this case it would return <code>Line Desc.</code></p>\n\n<p>I tried to use a spy to find an object path that would allow me to figure out the column name, but I couldn't find any.</p>\n\n<p>Before I start building a function that will do just that, I wanted to make sure I didn't miss anything in VbA objects repository.</p>\n\n<p>Any idea if there is a built-in way to find the active cell's column name?</p>\n\n<p>Thanks</p>\n\n<p>Note: If I run out of time and create a function, I will post it here.</p>\n\n<p><strong>EDIT</strong>\n<em>Here's what I have found so far:</em></p>\n\n<pre><code>Function ColumnName(byVal Target as Range)\n    If Sheets(\"Equipements\").Listobjects(\"tMain\").Active then\n        ColumnName = ListObjects(\"tMain\").HeaderRowRange.Cells(1, Target.Column).Value\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1511384274, "post_id": 47443752, "comment_id": 81842612, "body": "A string is not a boolean.  (VBA code is compiled, then run.  You can&#39;t &quot;write code&quot; into a string variable at run time and then just use that string variable instead of code.)"}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511384488, "post_id": 47443752, "comment_id": 81842701, "body": "is that any other way i can use? because i have some hundred of condition @YowE3K"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511384623, "post_id": 47443752, "comment_id": 81842761, "body": "You could write code that creates VBA code from your strings, puts that code into a module, then calls it.  (I think!)  Definitely not recommended for someone not <b>very</b> familiar with VBA.  (I wouldn&#39;t even attempt it myself unless I was desperate and had a lot of time to spare to play around with it.)"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1511384637, "post_id": 47443752, "comment_id": 81842769, "body": "IF a is what?  Non-empty?  What is that line trying to say?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511384723, "post_id": 47443752, "comment_id": 81842800, "body": "Try: <code>IF Application.Evaluate(a) Then</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511384729, "post_id": 47443752, "comment_id": 81842806, "body": "@mooseman It&#39;s trying to say <code>If Trim(Mid(&quot;061001 00100 0002017001 001.00 00004001 61A00 000000000&quot;,1,3)) = &quot;061&quot; Then</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511384790, "post_id": 47443752, "comment_id": 81842835, "body": "Scott&#39;s suggestion of using <code>Evaluate</code> will probably work, <b>providing</b> you stick to Excel functions in your string and don&#39;t try to use VBA functions."}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "edited": false, "score": 0, "creation_date": 1511385012, "post_id": 47443752, "comment_id": 81842947, "body": "IF Application.Evaluate(a) Then is not working"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511386075, "post_id": 47443752, "comment_id": 81843467, "body": "<code>If Application.Evaluate(a) Then</code> works for me for that specific example.  What is the value of <code>a</code> when it doesn&#39;t work for you?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511416248, "post_id": 47443752, "comment_id": 81851781, "body": "@mooseman, <code>if a then</code> is a valid statement. it checks if <code>a</code> is <code>true</code>    ... the OP did not use it correctly here"}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "edited": false, "score": 0, "creation_date": 1511799796, "post_id": 47443752, "comment_id": 81986715, "body": "it is not working. anyway thank you for your help."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511882702, "post_id": 47443752, "comment_id": 82026959, "body": "@jsotola, I was mostly asking what that statement was supposed to check for."}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 1, "last_activity_date": 1511385081, "creation_date": 1511385081, "answer_id": 47443940, "question_id": 47443752, "link": "https://stackoverflow.com/questions/47443752/if-condition-not-working-using-variable/47443940#47443940", "title": "If Condition Not Working using variable", "body": "<p>This should work for you;</p>\n\n<blockquote>\n  <p>a = Application.WorksheetFunction.Trim(Mid(sNextLine, TextBox5.value,\n  TextBox6.value))</p>\n  \n  <p>If a = TextBox8 Then</p>\n  \n  <p>a = b</p>\n  \n  <p>End If</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1511410594, "answer_count": 1, "score": -1, "last_activity_date": 1511399404, "creation_date": 1511384160, "last_edit_date": 1531164843, "question_id": 47443752, "link": "https://stackoverflow.com/questions/47443752/if-condition-not-working-using-variable", "closed_reason": "Needs details or clarity", "title": "If Condition Not Working using variable", "body": "<p>I have assigned all condition to a variable(a) and using the same variable in condition, but is is not working, when we copy all the criteria given to the variable and use it directly in the condition it is working.</p>\n\n<pre><code>a = \"Trim(Mid(\"\"\" &amp; sNextLine &amp; \"\"\",\" &amp; UserForm1.TextBox5.Text &amp; \",\" &amp; UserForm1.TextBox6.Text &amp; \")) \" &amp; con &amp; \" \" &amp; \"\"\"\" &amp; UserForm1.TextBox8.Text &amp; \"\"\"\"\nIf a Then\n  a = b  \nend if\nwhere sNextLine =\"061001    00100 0002017001    001.00 00004001  61A00     000000000\", UserForm1.TextBox5.Text=1, UserForm1.TextBox6.Text=3,con =\"=\", UserForm1.TextBox8.Text=\"061\"\n</code></pre>\n\n<p>Please Help me with this. if any problem in the question or code please ignore. i'm new here.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511379264, "post_id": 47442508, "comment_id": 81840223, "body": "Is the worksheet&#39;s page setup already set to be &quot;Fit to 1 pages wide by 1 tall&quot;?  Sorry, I only scrolled down to where you are doing the print - I didn&#39;t see that you are changing it to that after you print it.  Why don&#39;t you set it to 1 page tall <b>before</b> you print it?"}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511379436, "post_id": 47442508, "comment_id": 81840315, "body": "Yes, Tall=1 and Wide=False, like its shown on the code"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511379472, "post_id": 47442508, "comment_id": 81840337, "body": "Try doing that <b>before</b> you print to the PDF file."}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511379489, "post_id": 47442508, "comment_id": 81840345, "body": "I will try, thank you!"}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511380289, "post_id": 47442508, "comment_id": 81840729, "body": "Still not working.... I really don&#39;t understand why in my computer works and not on the others"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511381542, "post_id": 47442508, "comment_id": 81841287, "body": "Are you testing it all on the same version of Excel, Adobe and Windows?"}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 0, "creation_date": 1511381833, "post_id": 47442508, "comment_id": 81841423, "body": "The idea is that it should have the same output regardless of version of Excel, Windows or PDF viewer... but yes, Excel was the same version but Windows version and PDF viewers were different"}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1511382931, "post_id": 47442508, "comment_id": 81841953, "body": "One thing I notice, off the top of my head, is that you aren&#39;t setting your variable <code>myRange</code>, which defines the print area. Try defining it and see if it has an impact."}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 1, "creation_date": 1511387360, "post_id": 47442508, "comment_id": 81844001, "body": "You mean select the cells that are included in the range? Isn&#39;t it done with the command wsQUOTE.PageSetup.PrintArea = myRange?"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 4, "last_activity_date": 1511555227, "creation_date": 1511555227, "answer_id": 47479614, "question_id": 47442508, "link": "https://stackoverflow.com/questions/47442508/how-to-set-fixed-margins-on-excel-vba-code-pdf-is-printing-in-2-pages-instead-o/47479614#47479614", "title": "How to set fixed margins on Excel VBA code (PDF is printing in 2 pages instead of 1)", "body": "<p>In order to have the procedure <code>Excel_Export_Proposal</code> including the <code>PrintingArea</code> in one page always the following adjustments should be applied:</p>\n\n<ol>\n<li><p>Set the printing area correctly:<br>\nThis line sets the printing area:   <code>wsQUOTE.PageSetup.PrintArea = myRange</code><br>\nHowever no value is assigned to the variable <code>myRange</code> before this line, therefore the <code>PrintArea</code> is set to <code>\"\"</code> which is equivalent to setting it to the entire <code>UsedRange</code> of the <code>wsQUOTE</code> sheet.</p></li>\n<li><p>To ensure that the entire <code>PrintArea</code> is printed in one page the <code>FitToPagesTall</code> and <code>FitToPagesWide</code> must be set to 1<br>\nReplace <code>.FitToPagesWide = False</code> with <code>.FitToPagesWide = 1</code><br>\nAnd remove <code>.Zoom = False</code> as it has not effect after setting <code>FitToPagesTall</code> and <code>FitToPagesWide</code> to 1</p></li>\n<li><p>To ensure that the <code>ExportAsFixedFormat</code> method uses the print areas as defined in the target excel file set the <code>IgnorePrintAreas</code> parameter to <code>False</code>.<br>\nReplace this line <code>IgnorePrintAreas:=True, _</code> with this line <code>IgnorePrintAreas:=False, _</code></p></li>\n</ol>\n\n<p>Below is the revised procedure:</p>\n\n<pre><code>    Sub Excel_Export_Proposal_Revised()\n    Dim wb As Workbook, wsQuote As Worksheet\n    Dim myRange As String, Proposalname As String, FolderPath As String\n    Dim iVis As XlSheetVisibility\n\n        Set wb = ThisWorkbook\n        Set wsQuote = wb.Sheets(\"QUOTE\")\n        FolderPath = wb.Path &amp; \"\\\"\n        Proposalname = \"Quote for \" &amp; wsQuote.Range(\"B2\").Value2\n\n        'Update myRange with the address of the range to be printed\n        myRange = \"$B$2:$O$58\"  'Change as required\n\n        Application.ScreenUpdating = False\n\n        With wsQuote.PageSetup\n            .PrintArea = myRange\n            .FitToPagesTall = 1\n            .FitToPagesWide = 1     'Set FitToPagesWide to 1\n            .LeftMargin = Application.InchesToPoints(0.7)\n            .RightMargin = Application.InchesToPoints(0.4)\n            .TopMargin = Application.InchesToPoints(0.75)\n            .BottomMargin = Application.InchesToPoints(0.75)\n        End With\n\n        'Proposal\n        wb.Unprotect\n        With wsQuote\n            iVis = .Visible\n            .Visible = xlSheetVisible\n            .Activate\n            .ExportAsFixedFormat Type:=xlTypePDF, _\n                Filename:=FolderPath &amp; Proposalname &amp; \".pdf\", _\n                Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, OpenAfterPublish:=True\n            .Visible = iVis\n        End With\n        wb.Protect\n\n        Application.ScreenUpdating = True\n\n        End Sub\n</code></pre>\n\n<p>See following pages for additional information on the resources used:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/VBA/excel-vba/articles/worksheet-exportasfixedformat-method-excel\" rel=\"nofollow noreferrer\">Worksheet.ExportAsFixedFormat Method (Excel)</a><br>\n<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pagesetup-object-excel\" rel=\"nofollow noreferrer\">PageSetup Object (Excel)</a></p>\n"}], "owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7243, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511555227, "creation_date": 1511378957, "last_edit_date": 1511381036, "question_id": 47442508, "link": "https://stackoverflow.com/questions/47442508/how-to-set-fixed-margins-on-excel-vba-code-pdf-is-printing-in-2-pages-instead-o", "title": "How to set fixed margins on Excel VBA code (PDF is printing in 2 pages instead of 1)", "body": "<p>I have an Excel file which has a button \"Generate PDF\" that runs a macro to print a certain sheet (lets call it \"QUOTE\") into a PDF. This sheet is shown to be well limited in margins and in my computer the created PDF has the perfect structure: everything is well included in 1 page. However, in some other computers, when the PDF is created, everything does not fit into 1 page and a 2nd page is created with a bit of content. Here is the code (including the attempts to fix this problem by limiting the margins):</p>\n\n<pre><code>Sub Excel_Export_Proposal()\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim wsCOTIZACION As Worksheet\nDim Proposalname As String\nDim iVis As XlSheetVisibility\nDim xlName As Excel.Name\nDim FolderPath As String\nDim myRange As String\n\nSet wsQUOTE = ThisWorkbook.Sheets(\"QUOTE\")\n\nFolderPath = ActiveWorkbook.Path &amp; \"\\\"\n\n\nProposalname = \"Quote for \" &amp; CStr(Range(\"B2\").Value)\n\nwsQUOTE.PageSetup.PrintArea = myRange\nWith wsQUOTE.PageSetup\n.FitToPagesTall = 1\n.FitToPagesWide = False\n.Zoom = False\n.LeftMargin = Application.InchesToPoints(0.7)\n.RightMargin = Application.InchesToPoints(0.4)\n.BottomMargin = Application.InchesToPoints(0.75)\n.TopMargin = Application.InchesToPoints(0.75)\n\n\nEnd With\n\n'Proposal\nApplication.ScreenUpdating = False\nwb.Unprotect\nWith wsQUOTE\niVis = .Visible\n.Visible = xlSheetVisible\n.ExportAsFixedFormat Type:=xlTypePDF, _\n                     Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; Proposalname &amp; \".pdf\", _\n                     Quality:=xlQualityStandard, _\n                     IncludeDocProperties:=True, _\n                     IgnorePrintAreas:=True, _\n                     OpenAfterPublish:=True\n\n\n.Visible = iVis\n\nwsQUOTE.Activate\n\n\nEnd With\n\n\n\nwb.Protect \nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Can somebody help me fixing this problem? I would like that the sheet would we printed perfectly regardless of the computer or software in which is generated...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3325, "user_id": 4941166, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/c2c1101a15e12b67c110510ec6641128?s=128&d=identicon&r=PG&f=1", "display_name": "WNG", "link": "https://stackoverflow.com/users/4941166/wng"}, "edited": false, "score": 0, "creation_date": 1511376730, "post_id": 47441925, "comment_id": 81838926, "body": "Why do you want to avoid &quot;select&quot; ?  What have you tried ? Where are you stuck?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511376791, "post_id": 47441925, "comment_id": 81838965, "body": "see: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8972515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qSwYg.jpg?s=128&g=1", "display_name": "MarcM", "link": "https://stackoverflow.com/users/8972515/marcm"}, "edited": false, "score": 0, "creation_date": 1511376852, "post_id": 47441925, "comment_id": 81839000, "body": "I haven&#39;t tried anything yet. But I just need to have some of the sheets hidden."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1511377459, "post_id": 47441925, "comment_id": 81839347, "body": "You&#39;re using Application.Screenupdating incorrectly. At the start, you want to set it to FALSE. (For some reason you have it commented out). At the end you want to set it to TRUE. This will probably speed up your code faster than ditching the Selects."}], "answers": [{"comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511377932, "post_id": 47442003, "comment_id": 81839578, "body": "@maldred My bad, I pasted the selected code twice and thought I edited the second one, but for whatever reason it didn&#39;t seem to take. I edited it for the original intent."}], "tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": false, "score": 0, "last_activity_date": 1511377885, "last_edit_date": 1511377885, "creation_date": 1511376935, "answer_id": 47442003, "question_id": 47441925, "link": "https://stackoverflow.com/questions/47441925/how-do-i-avoid-the-select-in-vba-need-to-to-have-main-as-visible-and-other-shee/47442003#47442003", "title": "How do I avoid the select in VBA. Need to to have Main as visible and other sheets hidden", "body": "<p>Simply refer to the worksheets/ranges directly, eg, instead of:</p>\n\n<pre><code>Sheets(\"CMSRaw\").Select\nRange(\"A2:BX1500\").Select\nSelection.ClearContents\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>Worksheets(\"CMSRaw\").Range(\"A2:BX1500\").ClearContents\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8972515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qSwYg.jpg?s=128&g=1", "display_name": "MarcM", "link": "https://stackoverflow.com/users/8972515/marcm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "closed_date": 1511377279, "answer_count": 1, "score": -2, "last_activity_date": 1511701339, "creation_date": 1511376615, "last_edit_date": 1531161705, "question_id": 47441925, "link": "https://stackoverflow.com/questions/47441925/how-do-i-avoid-the-select-in-vba-need-to-to-have-main-as-visible-and-other-shee", "closed_reason": "Duplicate", "title": "How do I avoid the select in VBA. Need to to have Main as visible and other sheets hidden", "body": "<p>How do I avoid the select in VBA. Need to to have Main as visible and other sheets hidden. Below are the codes I am currently using:</p>\n\n<pre><code>    Sub Run_Historical()\n\n'Application.ScreenUpdating = False\nDim skillit As String\nDim nowsever As String\nDim CMSReport As String\nDim username As String\nDim pword As String\nDim setdate As String\nDim reportlocation As String\n\n'Clear Data\n\nSheets(\"CMSRaw\").Select\nRange(\"A2:BX1500\").Select\nSelection.ClearContents\n\n\nSheets(\"Reference\").Select\nskillit = Range(\"B6\").Value\nRange(\"B6\").Select\nDo While Not IsEmpty(ActiveCell.Value)\n    nrow = ActiveCell.Row\n    skillit = ActiveCell.Value\n    nowserver = Range(\"C\" &amp; nrow).Value\n    reportlocation = Range(\"H\" &amp; nrow).Value\n</code></pre>\n\n<p>Remaining of the codes are still having select sheets and cells which slows my PC as I am running a lot of application.</p>\n\n<pre><code>CMSReport = Range(\"D\" &amp; nrow).Value\n    setdate = Range(\"G\" &amp; nrow).Value\n    reportit = Range(\"D\" &amp; nrow).Value\n    originaladdress = ActiveCell.Address\n\n'Function CMSConn(sUserID As String, sPassword As String, sServerIP As String, sSkill As String, sDate As String, sReport)\n\n        Call CSSConn2(username, pword, Range(\"C\" &amp; nrow).Value, skillit, setdate, reportit, reportlocation)\n        originalsheets = ActiveSheet.Name\n        pastecell = Range(\"F\" &amp; nrow).Value\n        Sheets(Range(\"E\" &amp; nrow).Value).Select\n        Range(pastecell).Select\n\n        ActiveSheet.Paste\n        Sheets(originalsheets).Select\n        Range(originaladdress).Select\n        Range(\"A\" &amp; nrow).Value = Now()\n        ActiveCell.Offset(1, 0).Select\n\n\n    If ActiveCell.Value = \"\" Then\n    MsgBox \"Done\"\n    ThisWorkbook.Activate\n    Sheets(\"MainPage\").Select\n    Range(\"A1\").Select\n    Exit Sub\n    End If\nLoop\n'MsgBox \"CMS data has been extracted\", vbOKOnly\n\nApplication.ScreenUpdating = False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1511374678, "post_id": 47441403, "comment_id": 81837867, "body": "Hello Nelo - Please edit your post with the code from the picture you provided."}, {"owner": {"reputation": 1688, "user_id": 773479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8jx7Z.jpg?s=128&g=1", "display_name": "John Veldboom", "link": "https://stackoverflow.com/users/773479/john-veldboom"}, "edited": false, "score": 0, "creation_date": 1511374722, "post_id": 47441403, "comment_id": 81837898, "body": "Welcome to StackOverflow! In order for us to help you better, can you please update your question so that it shows your relevant code in a <b><a href=\"http://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a></b>. It would also be helpful if you could let us know what you have <b><a href=\"http://meta.stackoverflow.com/questions/261592\">tried so far</a></b> to solve your problem. For further information, please refer to the help article regarding <b><a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a></b>, and take the <b><a href=\"http://stackoverflow.com/tour\">tour of the site</a></b>"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1511375003, "post_id": 47441403, "comment_id": 81838040, "body": "Add a helper column on your Origen workbook. Add it in the first column of your table and have it be =Fecha&amp;Data1 to concatenate those. Then, in Destino do a Vlookup <code>=VLookUp(A1&amp;B1,{sourceData},4,False)</code>. No VBA needed."}, {"owner": {"reputation": 1, "user_id": 8992582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a17aa332a9055eff452aeb4351fbd77?s=128&d=identicon&r=PG&f=1", "display_name": "Nelo Caballero", "link": "https://stackoverflow.com/users/8992582/nelo-caballero"}, "edited": false, "score": 0, "creation_date": 1511376980, "post_id": 47441403, "comment_id": 81839075, "body": "Thanks, now what I would like to do is in the vba vary A1 &amp; B1 with a for (A1 &amp; B1, A2 &amp; B2, A2 &amp; B2, ...),  <code>Sub Macro() With Sheets(&quot;Hoja1&quot;) For i = 1 To 3 a = i + 1 With .Range(&quot;C&quot; &amp; a) n = &quot;A&quot; &amp; a &amp; &quot;&amp;B&quot; &amp; a .Formula = &quot;=IFERROR(vlookup(n,&#39;C:\\Users\\fcaballero\\Desktop\\Nueva carpeta\\[Origen.xlsx]Hoja1&#39;!$A$2:$D$10,4,FALSE),&quot;&quot;No&quot;&quot;)&quot; .Value = .Value End With Next End With End Sub</code>"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1511379791, "post_id": 47441403, "comment_id": 81840492, "body": "Why do you need VBA?  isn&#39;t this what you want? <a href=\"https://www.get-digital-help.com/2009/06/27/how-to-create-a-unique-distinct-list-where-other-columns-meet-two-criteria/\" rel=\"nofollow noreferrer\">How to create a unique distinct list where other columns meet two criteria</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511383128, "post_id": 47441403, "comment_id": 81842046, "body": "I may be wrong but a UDF that grabs a value from another workbook will be fine when the other workbook is available but when it is not, and the function recalculates e.g. on workbook open/refresh, you may be left with an error message.  Better to use non vba or a procedure."}, {"owner": {"reputation": 1, "user_id": 8992582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a17aa332a9055eff452aeb4351fbd77?s=128&d=identicon&r=PG&f=1", "display_name": "Nelo Caballero", "link": "https://stackoverflow.com/users/8992582/nelo-caballero"}, "edited": false, "score": 0, "creation_date": 1511394374, "post_id": 47441403, "comment_id": 81846395, "body": "Thanks to all, I could solve it"}, {"owner": {"reputation": 1, "user_id": 8992582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a17aa332a9055eff452aeb4351fbd77?s=128&d=identicon&r=PG&f=1", "display_name": "Nelo Caballero", "link": "https://stackoverflow.com/users/8992582/nelo-caballero"}, "edited": false, "score": 0, "creation_date": 1511394494, "post_id": 47441403, "comment_id": 81846423, "body": "Thanks to Fernando J. Rivera who gave me the basic idea, what he did not want is to edit the origen file"}, {"owner": {"reputation": 1, "user_id": 8992582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a17aa332a9055eff452aeb4351fbd77?s=128&d=identicon&r=PG&f=1", "display_name": "Nelo Caballero", "link": "https://stackoverflow.com/users/8992582/nelo-caballero"}, "edited": false, "score": 0, "creation_date": 1511394711, "post_id": 47441403, "comment_id": 81846484, "body": "Profex the code that you teach to me seems very useful when you do not have knowledge if there are repeated data and this generates me the list with the given conditions. But in my case it is to find a single data with the given conditions even if they are repeated since it emphasizes that something is wrong with the Origen file."}, {"owner": {"reputation": 1, "user_id": 8992582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a17aa332a9055eff452aeb4351fbd77?s=128&d=identicon&r=PG&f=1", "display_name": "Nelo Caballero", "link": "https://stackoverflow.com/users/8992582/nelo-caballero"}, "edited": false, "score": 0, "creation_date": 1511394799, "post_id": 47441403, "comment_id": 81846509, "body": "QHarr, What I do not want is that you have to open the origen file. thankyou"}], "owner": {"reputation": 1, "user_id": 8992582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a17aa332a9055eff452aeb4351fbd77?s=128&d=identicon&r=PG&f=1", "display_name": "Nelo Caballero", "link": "https://stackoverflow.com/users/8992582/nelo-caballero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511375038, "creation_date": 1511374504, "last_edit_date": 1592644375, "question_id": 47441403, "link": "https://stackoverflow.com/questions/47441403/how-create-a-function-that-finds-a-value-contained-in-another-excel-file-with-tw", "title": "How create a function that finds a value contained in another excel file with two conditions", "body": "<p>I briefly comment on my problem to solve, what I want is to create a function that gives you two conditions and I find a value but in another excel file (Workbook) that meets these 2 conditions.</p>\n<p>In an Origen.xlsx file where the data I want to obtain, there are 3 columns [Fecha, Data1 and Data2]:</p>\n<p><a href=\"https://i.stack.imgur.com/m5Jcn.png\" rel=\"nofollow noreferrer\">Origen.xlsx</a></p>\n<p>It is a Destino.xlsm file where I put two conditions [Fecha and Data1] and below the result cell I want to use the function to create that finds from the Data2 column of the source.xlsx file the value that meets the two conditions:</p>\n<p><a href=\"https://i.stack.imgur.com/YVX97.png\" rel=\"nofollow noreferrer\">Destino.xlsm</a></p>\n<p>Here I send you an idea of \u200b\u200bwhat I have of code, I get the data but only if it meets a condition and I can not put it as a function for which the cells are fixed.</p>\n<p><a href=\"https://i.stack.imgur.com/B97Pc.png\" rel=\"nofollow noreferrer\">Code</a></p>\n<pre><code>Sub Macro()\n    With Sheets(&quot;Hoja1&quot;)\n        With .Range(&quot;C2&quot;)\n            .Formula = &quot;=IFERROR(vlookup(A2,'C:\\Users\\fcaballero\\Desktop\\Nueva carpeta\\[Origen.xlsx]Hoja1'!$A$2:$C$10,3,FALSE),&quot;&quot;No&quot;&quot;)&quot;\n            .Value = .Value\n        End With\n    End With\nEnd Sub\n</code></pre>\n<p>I would greatly appreciate your support, greetings in advance.\nI attached the files in a zip.\n<a href=\"http://excelgali.mejorforo.net/download.forum?id=621\" rel=\"nofollow noreferrer\">http://excelgali.mejorforo.net/download.forum?id=621</a></p>\n"}, {"tags": ["vba", "checkbox", "ms-access-2010"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 1, "creation_date": 1511371874, "post_id": 47440564, "comment_id": 81836373, "body": "Either your message box is wrong or your logic is wrong. <code>iX</code> counts the number of checkboxes that are <i>not</i> checked. So when <code>iX = 0</code>, that means all checkboxes <i>are</i> checked and yet: <code>MsgBox &quot;No checkbox Selected.&quot;</code>"}, {"owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1511375589, "post_id": 47440564, "comment_id": 81838329, "body": "@MoondogsMaDawg Bravooooooooo, I did not even notice this logic error. |  Big Up for you. | it solved the problem entirely !!"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "edited": false, "score": 0, "creation_date": 1511371897, "post_id": 47440586, "comment_id": 81836382, "body": "Well @Vityata, I tried your solution but I got this error message: #access reserved error 3201"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "edited": false, "score": 0, "creation_date": 1511371935, "post_id": 47440586, "comment_id": 81836402, "body": "@HoucineAdsens - where?"}, {"owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "edited": false, "score": 0, "creation_date": 1511372433, "post_id": 47440586, "comment_id": 81836681, "body": "when I click on the button of my form to execute the code #Reserved error (-3201) There is no message for this error and that closes the form completely !!!!"}, {"owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "edited": false, "score": 0, "creation_date": 1511372526, "post_id": 47440586, "comment_id": 81836730, "body": "@ Vityata: I think I&#39;m going to rebuild my form."}, {"owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "edited": false, "score": 1, "creation_date": 1511372744, "post_id": 47440586, "comment_id": 81836836, "body": "@ Vityata:  Thank you very Much"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1511371630, "last_edit_date": 1511371630, "creation_date": 1511371305, "answer_id": 47440586, "question_id": 47440564, "link": "https://stackoverflow.com/questions/47440564/access-vba-check-if-all-checkboxes-are-false/47440586#47440586", "title": "Access VBA Check if all Checkboxes are FALSE", "body": "<p>Try to do it like this:</p>\n\n<pre><code>For Each ctl In Me.Controls\n    If TypeName(ctl) = \"CheckBox\" Then\n        If ctl.Value = False Then\n             iX = iX + 1\n        End If\n    End If\nNext ctl\n</code></pre>\n\n<p>The reason is that VBA does not support <strong>short-circuit evaluation</strong> -\n <a href=\"https://stackoverflow.com/questions/7015471/does-the-vba-and-operator-evaluate-the-second-argument-when-the-first-is-false\">Does the VBA &quot;And&quot; operator evaluate the second argument when the first is false?</a></p>\n\n<p>Thus, even that your first condition is <code>False</code> it nicely goes and checks for your second condition. And if it is not a <code>CheckBox</code> control, then it throws an error, because it does not have a <code>.Value</code> property.</p>\n"}], "owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 993, "favorite_count": 0, "accepted_answer_id": 47440586, "answer_count": 1, "score": 1, "last_activity_date": 1511371630, "creation_date": 1511371233, "last_edit_date": 1511371585, "question_id": 47440564, "link": "https://stackoverflow.com/questions/47440564/access-vba-check-if-all-checkboxes-are-false", "title": "Access VBA Check if all Checkboxes are FALSE", "body": "<p>Good afternoon all</p>\n\n<p>I have this piece of code to check if the checkboxes of my form are not checked, but each time I have this error message:\nruntime error '438'</p>\n\n<pre><code>Private Sub Btn_Send_Click()\nDim ctl As Control\nDim iX As Integer\n\n    For Each ctl In Me.Controls\n        If TypeName(ctl) = \"CheckBox\" And ctl.Value = False Then iX = iX + 1\n    Next ctl\n\nIf iX = 0 Then MsgBox \"No checkBox Selected\", vbExclamation, \"Title\"\n\nEnd Sub\n</code></pre>\n\n<p>Debbuging error :</p>\n\n<pre><code>If TypeName(ctl) = \"CheckBox\" And ctl.Value = False Then\n</code></pre>\n\n<blockquote>\n  <p>Run-Time Error #438: Object doesn't support this property or method</p>\n</blockquote>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1511372084, "post_id": 47440511, "comment_id": 81836484, "body": "What does your data look like and what part is not working when you say it works &quot;to a degree&quot;?"}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1511372576, "post_id": 47440511, "comment_id": 81836753, "body": "@FernandoJ.Rivera It works - the degree part is that it only updates with a comment after I input a value within the cell. Picture all that data filled with variations of integers and sometimes integers with letters. 1, 2, A1, B1, etc... Each letter corresponds to an activity type which is what I want to go inside the comments. The code works perfectly if I input manually. What we normally do is copy a large section and paste it one over each week so I&#39;m not looking to manually input each cell, I need it to refresh the entire Range after click the Update Button placed at the top of the sheet"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511373751, "post_id": 47440511, "comment_id": 81837337, "body": "When you update multiple cells at once (as in a copy/paste or when using Ctrl-Enter) then <code>Target</code> is not a single cell but a Range containing multiple cells.  Any Worksheet_Change event handler has to account for that possibility."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511374550, "post_id": 47440511, "comment_id": 81837800, "body": "@TimWilliams to a small degree I understand what you mean, I don&#39;t however, have the technical understanding of this language to know how to apply what you are saying."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511376317, "post_id": 47441423, "comment_id": 81838701, "body": "It works really well, but not through the entire sheet and not multiple times. I&#39;m assuming it has something to do with the part where you give me room to adjust. What do 10 and 3 represent? When I hit the button again, it gives me a 1004 error."}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "reply_to_user": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511383609, "post_id": 47441423, "comment_id": 81842306, "body": "It&#39;s giving you an error because it&#39;s trying to add a comment on a cell that already has one. add <code>.Cells(10, 3).Offset(i, j).clearcomments</code> before adding and it should work as intended, even after multiple uses."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511386030, "post_id": 47441423, "comment_id": 81843452, "body": "So close Fernando! Works well tested changing the same cell multiple times. However, only works on the first half of the table. For some reason it doesn&#39;t do the whole range we set?"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "reply_to_user": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511390057, "post_id": 47441423, "comment_id": 81845068, "body": "I had a typo, I had <code>For j = i</code>, where it should have read <code>For j = 1</code>. It should work as expected now."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511798972, "post_id": 47441423, "comment_id": 81986167, "body": "Thanks a lot. Works! Any idea why Run-time error 9 subscript out of range pops up? When I debug, <code>If arr(i, j) = cell.Value Then </code> is highlighted. It still works throughout the entire sheet perfectly this error just comes up after."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511799399, "post_id": 47441423, "comment_id": 81986455, "body": "<b>Update:</b> Because of this error I think it&#39;s not allowing the script to clear old comments on cells that no longer have a value in them"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "reply_to_user": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511800098, "post_id": 47441423, "comment_id": 81986921, "body": "That happens because of the lines where I use <code>Cells.SpecialCells(xlCellTypeLastCell)</code>. You probably have an used range that goes beyond the `D11:CY148^ range. Since I don&#39;t know what your data looks like, I can&#39;t do much there. Try looking on this forum for methods to define the last row and column of your table and see which one works for you."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511801021, "post_id": 47441423, "comment_id": 81987515, "body": "So picture a giant calendar and the range is the days within the calendar where each day has a value depending on the work going on in that area. D11:CY148 is all the days. I&#39;m not understanding why I have to define the last columns &amp; rows if I have a range where the code needs to work within?"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "reply_to_user": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511801738, "post_id": 47441423, "comment_id": 81987983, "body": "Change to <code>rwLast = 148</code> and <code>clLast =103</code> then"}], "tags": [], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "is_accepted": true, "score": 0, "last_activity_date": 1511389734, "last_edit_date": 1511389734, "creation_date": 1511374588, "answer_id": 47441423, "question_id": 47440511, "link": "https://stackoverflow.com/questions/47440511/excel-vba-large-table-add-comments-vlookup-after-hitting-command-button/47441423#47441423", "title": "Excel VBA Large Table, Add Comments Vlookup, After Hitting Command Button", "body": "<p>Untested, but this will take all the values in <code>Range(D11:CY148)</code> and add a comment based on a lookup from Sheet \"list\".</p>\n\n<pre><code>Sub testy()\n    Dim arr As Variant, element As Variant\n    Dim i As Long, j As Long, listItems As Long, rwLast As Long, clLast As Long\n    Dim comm As String\n    Dim rng As Range, cell As Range\n\n    listItems = Sheets(\"list\").Range(\"A1\").End(xlDown).Row\n    rwLast = Cells.SpecialCells(xlCellTypeLastCell).Row ' Adjust to fit your needs\n    clLast = Cells.SpecialCells(xlCellTypeLastCell).Column 'Idem\n\n    Set rng = Sheets(\"list\").Range(\"A1:A\" &amp; listItems)\n    arr = Range(\"D11:CY148\").Value\n\n    With Worksheets(\"Finish Matrix\")\n    For i = 1 To rwLast - 10 'Adjust to make it more general, this is pretty rough\n        For j = 1 To clLast - 3 'Idem\n        If i = 3 Then\n        End If\n            comm = \"\"\n            For Each cell In rng\n                If arr(i, j) = cell.Value Then\n                    comm = comm &amp; Chr(13) &amp; cell.Offset(0, 1).Value\n                End If\n            Next cell\n            If Not (comm = \"\") Then\n                .Cells(10, 3).Offset(i, j).ClearComments\n                .Cells(10, 3).Offset(i, j).AddComment\n                .Cells(10, 3).Offset(i, j).Comment.Text Text:=comm\n\n            End If\n        Next j\n    Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "edited": false, "score": 0, "creation_date": 1511375571, "post_id": 47441468, "comment_id": 81838322, "body": "Removed <code>If sValue = vbNullString Then cell.ClearComments</code> in favor of just <code>Target.ClearComments</code> at the start, because it wasn&#39;t clearing the existing comments, like you&#39;ll want it to."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511386154, "post_id": 47441468, "comment_id": 81843502, "body": "Thanks for your efforts, how exactly do I use them? I tried introducing it in the sheet within the command button code and nothing happened. Tried making them modules but I&#39;m not technical enough to know how to get them to work together?"}, {"owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "reply_to_user": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511678923, "post_id": 47441468, "comment_id": 81942490, "body": "Just paste it into to module for that sheet that you are going to be pasting your data into...everything else is automatic...<code>Worksheet_Change</code> will get triggered when you change any value on the sheet, i.e. paste your data."}], "tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 1, "last_activity_date": 1511375392, "last_edit_date": 1511375392, "creation_date": 1511374769, "answer_id": 47441468, "question_id": 47440511, "link": "https://stackoverflow.com/questions/47440511/excel-vba-large-table-add-comments-vlookup-after-hitting-command-button/47441468#47441468", "title": "Excel VBA Large Table, Add Comments Vlookup, After Hitting Command Button", "body": "<p>You are basically missing the <code>For Each Cell in Target</code> part...</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim wsMain As Worksheet, wsList As Worksheet\nDim cell As Range\nDim vCommentList As Variant\nDim i As Long, lLastRow As Long\nDim sValue As String\n\n    On Error GoTo ErrHandler\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Set wsMain = Target.Parent\n    Set Target = Intersect(Target, wsMain.Range(\"D11:CY148\"))\n    If Target Is Nothing Then Exit Sub\n    Set wsList = wsMain.Parent.Sheets(\"list\")\n    lLastRow = LastRow(1, wsList)\n    ' Read Comment List into Variant (for speed)\n    vCommentList = wsList.Range(\"A1:B\" &amp; lLastRow)\n\n    Target.ClearComments\n    ' This...For each Cell in Target...is what you were missing.\n    For Each cell In Target\n        sValue = cell\n        For i = 1 To UBound(vCommentList)\n            If sValue = vCommentList(i, 1) Then\n                AddComment cell, CStr(vCommentList(i, 2))\n                Exit For\n            End If\n        Next\n    Next\n\nErrHandler:\n    If Err.Number &lt;&gt; 0 Then Debug.Print Err.Description\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Proper way to find last row ...</p>\n\n<pre><code>Public Function LastRow(Optional Col As Integer = 1, Optional Sheet As Excel.Worksheet) As Long\n    If Sheet Is Nothing Then Set Sheet = Application.ActiveSheet\n    LastRow = Sheet.Cells(Sheet.Rows.Count, Col).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>Add Comment Sub the allows appending is needed...</p>\n\n<pre><code>Public Sub AddComment(Target As Range, Text As String)\n    If Target.Count = 1 Then\n        If Target.Comment Is Nothing Then\n            Target.AddComment Text\n        Else\n            Target.Comment.Text Target.Comment.Text &amp; vbLf &amp; Text\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 47441423, "answer_count": 2, "score": 0, "last_activity_date": 1511389734, "creation_date": 1511371057, "last_edit_date": 1511371143, "question_id": 47440511, "link": "https://stackoverflow.com/questions/47440511/excel-vba-large-table-add-comments-vlookup-after-hitting-command-button", "title": "Excel VBA Large Table, Add Comments Vlookup, After Hitting Command Button", "body": "<p>I have a large table and the information I'm wanting to add comments to falls within <code>Range(D11:CY148)</code>. I have two tabs - \"Finish Matrix\" (main) and \"list\" (hidden - has 2 columns).</p>\n\n<p>I have two issues.</p>\n\n<p>First issue - Code works to a degree, after I type my values within a cell it automatically adds comments based off info in another sheet. The problem is there is too many cells to be manually typing into and if I copy and paste the code doesn't run. I created a CommandButton and wanted it to refresh the entire table with comments depending if the cells had the values that fall within \"list\". I tried to create a call out to Worksheet_Change but to no avail. (I'm a beginner so it'll help if you explain)</p>\n\n<p>Second issue - I'm assuming it'll get fixed with whatever suggestion that works. Occasionally after typing into a cell I would get an error. Can't remember the error name but it is one of the common ones, atm the error isn't popping up but surely it'll come back since I didn't do anything different to the code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Columns(\"A:CX\")) Is Nothing Then _\nIf Intersect(Target, Columns(\"CY\")) Is Nothing Then Exit Sub\n\nDim lRow As Integer\n\nlRow = Sheets(\"list\").Range(\"A1\").End(xlDown).Row\n\nIf Target.Value = vbNullString Then Target.ClearComments\n\nFor Each cell In Sheets(\"list\").Range(\"A1:A\" &amp; lRow)\n    If cell.Value = Target.Value Then\n        Target.AddComment\n        Target.Comment.Text Text:=cell.Offset(0, 1).Value\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any and all help!</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1511374158, "post_id": 47440383, "comment_id": 81837554, "body": "Delete <code>With ie.Document</code> and <code>End With</code>. The error is being raised by this with block. The <code>With</code> block isn&#39;t being utilized at all from what I can see so you should just get rid of it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1511376106, "post_id": 47440383, "comment_id": 81838593, "body": "@MoondogsMaDawg - The <code>With</code> block is superfluous but it should not cause error as written."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511376309, "post_id": 47440383, "comment_id": 81838698, "body": "@ScottHoltzman Is it being caused by the mix of early and late bindings? <code>Dim ie As New InternetExplorer</code> &amp; <code>Set ie = CreateObject(&quot;InternetExplorer.Application&quot;)</code>?"}], "owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511370883, "creation_date": 1511370637, "last_edit_date": 1511370883, "question_id": 47440383, "link": "https://stackoverflow.com/questions/47440383/error-when-pressing-ie-button-object-variable-or-with-block-variable-not-set", "title": "Error when pressing IE button Object Variable or With block variable not set", "body": "<p>I know there are other questions that are similar to mine, but I am quite new to this, and a lot of them don't make sense to me.</p>\n\n<p>That being said, I have researched this error and it says I need to Declare an Object Variable, Set the Object and then use With at the correct points, I have as far as I am aware tried that, but still get the error</p>\n\n<blockquote>\n  <p>Object variable or With block variable not set</p>\n</blockquote>\n\n<p>My Code is</p>\n\n<pre><code>Public Sub a()\n\nDim Button4 As Object\nDim ie As New InternetExplorer\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nie.navigate \"https://reporting.med.siemens.com/sap(bD1lbiZjPTEwMSZkPW1pbg==)/bc/bsp/sie/med_cm/start.htm\"\nie.Visible = True\n\nDo While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE Or ie.Busy: DoEvents: Loop\n\n\nWith ie.Document\n\nSet Button4 = ie.Document.getElementById(\"seite-itm-2\")\nButton4.Click\n\nEnd With    \n MsgBox \"complete\"\nEnd Sub\n</code></pre>\n\n<p>What I am trying to do is press the below \"Button\" on an internet page,</p>\n\n<pre><code>&lt;TD onclick=\"return htmlbSL(this,7,'seite:sel_tab_2','','3','sel_tab_2')\" id=seite-itm-2 class=urTbsLabelOff onkeydown=\"if (sapUrMapi_checkKey(event,'keydown',new Array('32'))){return htmlbSL(this,7,'seite:sel_tab_2','','3','sel_tab_2')};sapUrMapi_TabStrip_keySelect('seite',2,4,event);\" noWrap&gt;&lt;SPAN id=seite-itm-2-txt title=\"Bookmarks     \" class=urTbsTxtOff&gt;Bookmarks &lt;/SPAN&gt;&lt;/TD&gt;\n</code></pre>\n\n<p>Can some one please help?</p>\n\n<p>Thank You</p>\n"}, {"tags": ["vba", "vlookup", "conditional-formatting"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511386968, "post_id": 47440381, "comment_id": 81843841, "body": "Do you really mean to apply for all rows from row 2 to bottom of sheet? This seems excessive? And are you only highlighting row where Not VA Student is found?"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511387994, "post_id": 47440381, "comment_id": 81844280, "body": "Yes, I am only trying to highlight rows where Not VA Student is found."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511388055, "post_id": 47440381, "comment_id": 81844303, "body": "try code as per answer i posted. Chage sheet name as appropriate. Place in standard module."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1511388612, "last_edit_date": 1511388612, "creation_date": 1511387215, "answer_id": 47444355, "question_id": 47440381, "link": "https://stackoverflow.com/questions/47440381/conditional-format-row-based-on-iferror-vlookup-result/47444355#47444355", "title": "Conditional Format Row based on IFERROR VLOOKUP result", "body": "<p>It is unclear to me what you meant by your IFERROR VLOOKUP as i can't see this in your code. </p>\n\n<p>I think you are wanting to only highlight rows where \"Not VA Student\" is found in the stipulated range. Your current code does this for individual cells. </p>\n\n<p>I think the range selected is likely excessive in that you select to the bottom of the sheet within the specified column limits.</p>\n\n<p>Try the following. I have made minor amendments to existing code, credits to <a href=\"http://&#39;https://stackoverflow.com/questions/41506700/finding-occurrences-in-order-vba\" rel=\"nofollow noreferrer\">user3598756</a> </p>\n\n<pre><code>Private Sub HighlightRows()\n\n        Dim wb As Workbook\n        Dim ws As Worksheet\n        Dim FoundCell As Range\n        Dim rng As Range\n        Dim FirstFound As String\n        Set wb = ThisWorkbook\n        Set ws = wb.Worksheets(\"Sheet1\") ' change as appropriate\n\n        Const fnd As String = \"Not VA Student\"\n\n        With ws.Range(\"A2:AH\" &amp; ws.Range(\"AH2\").End(xlDown).Row) '&lt;--| reference the range to search into ''@qharr: this seems excessive to me\n\n            Set FoundCell = .Find(what:=fnd, after:=.Cells(.Cells.Count))  '&lt;--| find the first cell\n\n            If Not FoundCell Is Nothing Then 'Test to see if anything was found\n\n                FirstFound = FoundCell.Address ' &lt;--| store the first found cell address\n                Set rng = FoundCell '&lt;--| initialize the range collecting found cells. this to prevent first 'Union()' statement from failing due to 'rng' being 'Nothing'\n\n                Do\n\n                    Set rng = Union(rng, FoundCell)  'Add found cell to rng range variable\n\n                    'Find next cell with fnd value\n                    Set FoundCell = .FindNext(after:=FoundCell)\n                Loop While FoundCell.Address &lt;&gt; FirstFound 'Loop until cycled through all finds\n\n            End If\n\n        End With\n\n      If Not rng Is Nothing Then rng.EntireRow.Interior.Color = 65535\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 47444355, "answer_count": 1, "score": 0, "last_activity_date": 1511388612, "creation_date": 1511370605, "question_id": 47440381, "link": "https://stackoverflow.com/questions/47440381/conditional-format-row-based-on-iferror-vlookup-result", "title": "Conditional Format Row based on IFERROR VLOOKUP result", "body": "<p>I am trying to conditinally format every row that fails my IFERROR VLOOKUP formula in column A. I have gotten to where I can get the IFERROR cell to highlight, but not the entire now. Please help. This is what I have so far:</p>\n\n<pre><code>Range(\"A2:AH2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n    Formula1:=\"=\"\"Not VA Student\"\"\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n"}, {"tags": ["excel", "combobox", "max", "unique", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "edited": false, "score": 0, "creation_date": 1511372781, "post_id": 47440552, "comment_id": 81836855, "body": "Thank you for the response!  Forgive me, but I&#39;m unclear on some of it though.  vData = Range(&quot;A1&quot;).CurrentRegion.Value - The Name is the first range I&#39;m interrogating.  I haven&#39;t used CurrentRegion.Value to do anything yet, so I&#39;m unclear how that factors in.  Also, the UBound(vData,1) snippet...What is the UBound doing?  I assume that the 1 is the column count?  Finally, I don&#39;t see where I&#39;m declaring the EnteredDate as a Range.  Is that what the vData(r,2) is doing?  Apologies for what probably seem like silly questions."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "edited": false, "score": 0, "creation_date": 1511373009, "post_id": 47440552, "comment_id": 81836956, "body": "There&#39;s plenty of help online for Scripting Dictionaries, e.g. <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a> It is probably better than a Collection. If you have specific queries post back."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "edited": false, "score": 0, "creation_date": 1511373092, "post_id": 47440552, "comment_id": 81836991, "body": "Ok, didn&#39;t see your questions. I&#39;ll come back to later if nobody else has provided another answer in the meantime."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "edited": false, "score": 0, "creation_date": 1511446669, "post_id": 47440552, "comment_id": 81869595, "body": "Perhaps the example is not that useful. It demonstrates how to select the name and max date only - this is added to a dictionary (rather than a collection) and you can then loop through it to add items to the combobox. vData is just turning the range into an array for quicker processing so vData(r,1) is in effect the column A entries (name) and vData(r,2) is column B (date). The date is only added to the dictionary if it is greater than the existing item. If you want to pursue this approach, there are examples online of these various things, give it a try and come back with specific questions."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1511371182, "creation_date": 1511371182, "answer_id": 47440552, "question_id": 47440320, "link": "https://stackoverflow.com/questions/47440320/unique-values-in-combobox-leveraging-max-date-from-another-range/47440552#47440552", "title": "Unique Values in Combobox, Leveraging Max Date from Another Range", "body": "<p>Not an exact answer to your question, but an illustration of how you might go about it. This uses a Dictionary. You add a key and item pair and update the item if the new value in B is higher than the existing item.</p>\n\n<pre><code>Sub x()\n\nDim vData, r As Long\n\nvData = Range(\"A1\").CurrentRegion.Value\n\nWith CreateObject(\"Scripting.Dictionary\")\n    For r = 1 To UBound(vData, 1)\n        If vData(r, 2) &gt; .Item(vData(r, 1)) Then\n            .Item(vData(r, 1)) = vData(r, 2)\n        End If\n    Next r\n    Range(\"D1\").Resize(.Count) = Application.Transpose(.keys)\n    Range(\"E1\").Resize(.Count) = Application.Transpose(.items)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/piIu0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/piIu0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "is_accepted": false, "score": 0, "last_activity_date": 1514379763, "creation_date": 1514379763, "answer_id": 47992696, "question_id": 47440320, "link": "https://stackoverflow.com/questions/47440320/unique-values-in-combobox-leveraging-max-date-from-another-range/47992696#47992696", "title": "Unique Values in Combobox, Leveraging Max Date from Another Range", "body": "<p>I'll be posting a new question in a separate thread, but realized that I never marked this one as answered.  Here is the code that solved my problem:</p>\n\n<pre><code>Set coboDict = CreateObject(\"Scripting.Dictionary\")\nWith coboDict\nFor Each cStatsClientID In ws1.Range(\"StatsClientID\")\n    If Not .exists(cStatsClientID.Value) Then\n        .Add cStatsClientID.Value, cStatsClientID.Row\n    Else\n        If CLng(cStatsClientID.Offset(, -2).Value) &gt; CLng(ws1.Range(\"B\" &amp; .Item(cStatsClientID.Value))) Then\n        .Item(cStatsClientID.Value) = cStatsClientID.Row\n        End If\n    End If\nNext cStatsClientID\nMe.cobo_ClientID.List = Application.Transpose(.keys)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1514379763, "creation_date": 1511370403, "last_edit_date": 1531161705, "question_id": 47440320, "link": "https://stackoverflow.com/questions/47440320/unique-values-in-combobox-leveraging-max-date-from-another-range", "title": "Unique Values in Combobox, Leveraging Max Date from Another Range", "body": "<p>I'm trying to teach myself VBA (primarily in Excel 2010) and I'm stuck on some code.  I've leveraged sites such as Mr. Excel, Excel is Fun, and just about everywhere else that Google takes me, but I'm not having luck finding guidance that makes sense to me.  </p>\n\n<p>Challenge:  I have a userform that has a combobox reading a range.  The issue is, the sheet that the range exists on can have multiple duplicate values, but I only want to see unique values.  To make it more challenging (to me), when the User selects a value in the combobox, I want that data set to flow back to the form.  </p>\n\n<p>I've managed to get data back on the form, but I'm having difficulty getting the MAX \"Entered Date\" record.  So, if there are 5 instances of the name \"Tom\", with \"Entered Dates\" of 5/1/17, 6/1/17, 7/1/17, 8/17/17, 12/1/17; I want to see the record from 12/1/17.</p>\n\n<p>It appears that I need to do something with a collection to get the unique value in the combobox, but I'm not understanding how it works.  I also have no clue how to tie it all to the MAX \"Entered Date\".  Here's the code that I have so far:</p>\n\n<pre><code>Private Sub cmd_Submit_Click()\n\nDim ws1 As Worksheet\n\nSet ws1 = ThisWorkbook.Sheets(\"Client Measurements\")\n\nLastRow = ws1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n\nws1.Range(\"B\" &amp; LastRow) = Me.txt_Updated\nws1.Range(\"C\" &amp; LastRow) = Me.txt_First\nws1.Range(\"D\" &amp; LastRow) = Me.txt_Last\nws1.Range(\"E\" &amp; LastRow) = Me.txt_Suffix\nws1.Range(\"F\" &amp; LastRow) = Me.cobo_Name\nws1.Range(\"G\" &amp; LastRow) = Me.txt_EntryType\nws1.Range(\"H\" &amp; LastRow) = Me.txt_Height\nws1.Range(\"I\" &amp; LastRow) = Me.txt_Weight\nws1.Range(\"J\" &amp; LastRow) = Me.txt_Chest\nws1.Range(\"K\" &amp; LastRow) = Me.txt_Hips\nws1.Range(\"L\" &amp; LastRow) = Me.txt_Waist\nws1.Range(\"M\" &amp; LastRow) = Me.txt_BicepL\nws1.Range(\"N\" &amp; LastRow) = Me.txt_BicepR\nws1.Range(\"O\" &amp; LastRow) = Me.txt_ThighL\nws1.Range(\"P\" &amp; LastRow) = Me.txt_ThighR\nws1.Range(\"Q\" &amp; LastRow) = Me.txt_CalfL\nws1.Range(\"R\" &amp; LastRow) = Me.txt_CalfR\n\n\nEnd Sub\nPrivate Sub cobo_Name_DropButtonClick()\n\nDim i As Long\nDim coll As Collection\nDim ws1 As Worksheet\n\nSet ws1 = ThisWorkbook.Sheets(\"Client Measurements\")\n\nLastRow = Sheets(\"Client Measurements\").Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To LastRow\n\nIf Sheets(\"Client Measurements\").Cells(i, \"F\").Value = (Me.cobo_Name) Or _\nSheets(\"Client Measurements\").Cells(i, \"F\").Value = Val(Me.cobo_Name) Then\n    Me.txt_First = Sheets(\"Client Measurements\").Cells(i, \"C\").Value\n    Me.txt_Last = Sheets(\"Client Measurements\").Cells(i, \"D\").Value\n    Me.txt_Suffix = Sheets(\"Client Measurements\").Cells(i, \"E\").Value\n    Me.txt_Height = Sheets(\"Client Measurements\").Cells(i, \"H\").Value\n    Me.txt_Weight = Sheets(\"Client Measurements\").Cells(i, \"I\").Value\n    Me.txt_Chest = Sheets(\"Client Measurements\").Cells(i, \"J\").Value\n    Me.txt_Hips = Sheets(\"Client Measurements\").Cells(i, \"K\").Value\n    Me.txt_Waist = Sheets(\"Client Measurements\").Cells(i, \"L\").Value\n    Me.txt_BicepL = Sheets(\"Client Measurements\").Cells(i, \"M\").Value\n    Me.txt_BicepR = Sheets(\"Client Measurements\").Cells(i, \"N\").Value\n    Me.txt_ThighL = Sheets(\"Client Measurements\").Cells(i, \"O\").Value\n    Me.txt_ThighR = Sheets(\"Client Measurements\").Cells(i, \"P\").Value\n    Me.txt_CalfL = Sheets(\"Client Measurements\").Cells(i, \"Q\").Value\n    Me.txt_CalfR = Sheets(\"Client Measurements\").Cells(i, \"R\").Value\n\n\nEnd If\nNext\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nDim ws1 As Worksheet\nDim cCMName As Range\n\nSet ws1 = ThisWorkbook.Sheets(\"Client Measurements\")\n\nFor Each cCMName In ws1.Range(\"CMName\")\n    With Me.cobo_Name\n        .AddItem cCMName.Value\n    End With\nNext cCMName\n\ntxt_EntryType = \"Check In\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "position"], "comments": [{"owner": {"reputation": 31, "user_id": 3447757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5649594a3e4578efd83eaf316abacdc3?s=128&d=identicon&r=PG&f=1", "display_name": "HalfWit", "link": "https://stackoverflow.com/users/3447757/halfwit"}, "edited": false, "score": 0, "creation_date": 1511370534, "post_id": 47440251, "comment_id": 81835560, "body": "It works if I use specific names of the sheets, but not sheets(1) and sheets (2)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3447757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5649594a3e4578efd83eaf316abacdc3?s=128&d=identicon&r=PG&f=1", "display_name": "HalfWit", "link": "https://stackoverflow.com/users/3447757/halfwit"}, "edited": false, "score": 0, "creation_date": 1511377157, "post_id": 47440485, "comment_id": 81839177, "body": "I have a hidden sheet that fills the allows me to put in a quantity and it generates the $$ for the qty listed. However I don&#39;t need the formulas copied, I only need the data. Basically I&#39;m generating an invoice for every progress payment breakdown."}, {"owner": {"reputation": 31, "user_id": 3447757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5649594a3e4578efd83eaf316abacdc3?s=128&d=identicon&r=PG&f=1", "display_name": "HalfWit", "link": "https://stackoverflow.com/users/3447757/halfwit"}, "edited": false, "score": 0, "creation_date": 1511377752, "post_id": 47440485, "comment_id": 81839497, "body": "That code worked perfectly. I will have to look at it closer and see how it works. It&#39;s much more efficient than what I have been using. Thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 31, "user_id": 3447757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5649594a3e4578efd83eaf316abacdc3?s=128&d=identicon&r=PG&f=1", "display_name": "HalfWit", "link": "https://stackoverflow.com/users/3447757/halfwit"}, "edited": false, "score": 0, "creation_date": 1511378835, "post_id": 47440485, "comment_id": 81840001, "body": "Them main thing is when you&#39;re only copy-pasting values it&#39;s much faster to just assign the values directly.  Also not selecting things is a big improvement: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1511370965, "creation_date": 1511370965, "answer_id": 47440485, "question_id": 47440251, "link": "https://stackoverflow.com/questions/47440251/vba-macro-for-copying-a-sheet-then-copying-some-info-from-another-sheet-into-th/47440485#47440485", "title": "vba macro for copying a sheet, then copying some info from another sheet into the copied sheet", "body": "<p>Do you have any hidden sheets or non-worksheet sheets (chart sheets for example)?</p>\n\n<p>You generally don't need select/activate:</p>\n\n<pre><code>Sub GenerateInvoice()\n     Sheets(2).Copy Before:=Sheets(1)\n     With Sheets(2).Range(\"H2:N2\")\n         Sheets(1).Range(\"E11\").Resize(1, .Columns.Count).Value = .Value\n     End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3447757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5649594a3e4578efd83eaf316abacdc3?s=128&d=identicon&r=PG&f=1", "display_name": "HalfWit", "link": "https://stackoverflow.com/users/3447757/halfwit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511370965, "creation_date": 1511370167, "question_id": 47440251, "link": "https://stackoverflow.com/questions/47440251/vba-macro-for-copying-a-sheet-then-copying-some-info-from-another-sheet-into-th", "title": "vba macro for copying a sheet, then copying some info from another sheet into the copied sheet", "body": "<p>I'm having problems getting this to work. I just want to copy the second sheet from the left before the first sheet. Then copy info from what just became the second sheet to the new left most sheet. I get an error on SELECTION.Copy stating there is an expected variable missing.</p>\n\n<pre><code>Sub GenerateInvoice()\n     Sheets(2).Select\n     Sheets(2).Copy Before:=Sheets(1)\n     Sheets(2).Select\n     Range(\"H2:N2\").Select\n     SELECTION.Copy\n     Sheets(1).Select\n     Range(\"E11\").Select\n     SELECTION.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1511369495, "post_id": 47439981, "comment_id": 81834868, "body": "you never initialize the collection losses. you need <code>set losses = New Collection</code>"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1511369732, "post_id": 47439981, "comment_id": 81835034, "body": "@Sorceri I&#39;m sorry, I do. It doesn&#39;t occur in <code>Private Sub Class_Initialize()</code>, but in <code>calculateLosses</code>. Edited the question."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1511370161, "post_id": 47439981, "comment_id": 81835315, "body": "@Ans So it sounds like the loop runs once through fine, but it&#39;s on the next iteration that your error occurs? What is the value of <code>simulation</code>? Where does that come from?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1511370850, "post_id": 47439981, "comment_id": 81835767, "body": "There&#39;s not enough information for  me to reproduce the problem. If no one else can help, I suggest you read Help for <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>, and edit your question appropriately.  Best would be if you could upload a workbook (with sensitive information removed) that reproduces the problem, and post a link here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511371325, "post_id": 47439981, "comment_id": 81836048, "body": "Set your VBA error handling option (Tools&gt;&gt;Options&gt;&gt;General) to &quot;Break in Class Module&quot; and see if the error is in your class."}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511369663, "creation_date": 1511369289, "last_edit_date": 1511369663, "question_id": 47439981, "link": "https://stackoverflow.com/questions/47439981/excel-vba-object-variable-or-with-block-variable-not-set-getting-class-collect", "title": "Excel vba: object variable or with block variable not set, getting class collection", "body": "<p>I have a <code>Client</code> class that contains a <code>losses Collection</code>. I use that collection later in a program, retrieving its elements. However, now I get the <code>object variable or with block variable not set</code> error, when trying to retrieve an element (after minor changes in code):</p>\n\n<p>These are the insides of a <code>Client</code> class:</p>\n\n<pre><code>Public Property Let setSumLosses(value As Collection)\n    Set sumLosses = value\nEnd Property\n\n\nPrivate Sub Class_Initialize()\n    Set sumLosses = New Collection\nEnd Sub\n\nPrivate losses As Collection\nPrivate sumLosses As Collection\n\nPublic Property Get getLosses()\n    Set getLosses = losses\nEnd Property\n</code></pre>\n\n<p>This function is used in a main sub:</p>\n\n<pre><code>Function calculateSumLosses(clientsColl As Collection)\n    Dim clientCopy As client\n\n    For Each clientCopy In clientsColl\n         MsgBox (\"here: \" &amp; clientCopy.getLosses.Item(simulation)) 'msgBoxes fine\n\n         ...\n    Next\n\n    ...\nEnd Function\n</code></pre>\n\n<p><strong>EDIT:</strong>\nThe <code>calculateLosses</code> function, inside <code>Client</code> class:</p>\n\n<pre><code>Public Sub calculateLosses()\n    Set losses = New Collection\n\n    Dim i As Long\n    For i = 1 To outcomes.Count\n        If outcomes(i) = 1 Then\n            losses.Add totalLoss\n        ElseIf outcomes(i) = 0 Then\n            losses.Add 0\n        Else\n            losses.Add Null\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>The main sub:</p>\n\n<pre><code>clientCopy.calculateLosses        \nclientCopy.setSumLosses = calculateSumLosses(clientsDividedColl)\n</code></pre>\n\n<p>The thing is, while the error appears on <code>MsgBox</code> line, the \"here\" part and the element itself still get printed out fine and only after I click \"OK\" on <code>MsgBox</code> the error on that line appears. What could possible cause it?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511367857, "post_id": 47439448, "comment_id": 81833749, "body": "Won&#39;t that turn <code>=Sheet2!A1</code> into <code>=Sheet2!A1+1</code>?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511367974, "post_id": 47439448, "comment_id": 81833845, "body": "@SJR - yup, this is exactly what it returns. But it is not manual."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511368065, "post_id": 47439448, "comment_id": 81833902, "body": "Doesn&#39;t the OP want <code>=Sheet2!A2</code> instead, i.e. 1 added to the row number?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1511368350, "post_id": 47439448, "comment_id": 81834093, "body": "@SJR - that&#39;s an option as well and probably you are right. Edited the answer."}, {"owner": {"reputation": 71, "user_id": 8895098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abd2156c730b4896bbe85e153728881b?s=128&d=identicon&r=PG&f=1", "display_name": "steveybo", "link": "https://stackoverflow.com/users/8895098/steveybo"}, "edited": false, "score": 0, "creation_date": 1512403533, "post_id": 47439448, "comment_id": 82232784, "body": "Hi Again! That worked a treat thank you! I can&#39;t seem to figure out how would i be able to update the reference addresses for the following code? if it&#39;s possible           =IF(ISBLANK(IDdata!$A$2),&quot;&quot;,IDdata!$A$2)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71, "user_id": 8895098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abd2156c730b4896bbe85e153728881b?s=128&d=identicon&r=PG&f=1", "display_name": "steveybo", "link": "https://stackoverflow.com/users/8895098/steveybo"}, "edited": false, "score": 0, "creation_date": 1512417493, "post_id": 47439448, "comment_id": 82240413, "body": "@steveybo - try to pass the formula as a string. E.g. <code>.LocalFormula = &quot;=IF(ISBLANK(IDdata!$A$2),&quot;&quot;,IDdata!$A$2)&quot;</code> Then <code>.LocalFormula = &quot;=IF(ISBLANK(IDdata!$A$2),&quot;&quot;,IDdata!$A$&quot; &amp; something_here &amp; &quot;)&quot;</code>. It is not very easy, thus give it a try a bit (it will not happen in the first 1 hour), thus try harder."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1511368314, "last_edit_date": 1511368314, "creation_date": 1511367646, "answer_id": 47439448, "question_id": 47439405, "link": "https://stackoverflow.com/questions/47439405/increment-excel-formula-by-1/47439448#47439448", "title": "Increment excel formula by 1", "body": "<p>Select the cells you want and run the following in VBA:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myCell  As Range\n\n    For Each myCell In Selection\n        If myCell.HasFormula Then myCell.Formula = myCell.Formula &amp; \"+1\"\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you press it too many times, this is how to remove it the last <code>+1</code>:</p>\n\n<pre><code>Public Sub UnTestMe()\n\n    Dim myCell As Range\n\n    For Each myCell In Selection\n        If myCell.HasFormula Then myCell.Formula = Left(myCell.Formula, _\n                                                Len(myCell.Formula) - 2)\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Concerning the comment of @SJR, if you want to change the <strong>reference address</strong> of the cell, this is one possible workaround:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim myCell As Range\n\n    For Each myCell In Selection\n        If myCell.HasFormula Then myCell.Formula = Left(myCell.Formula, _\n                                                Len(myCell.Formula) - 1) &amp; 2\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>Simply change the <code>&amp;2</code> to the number you want to refer to.</p>\n"}, {"tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": false, "score": 0, "last_activity_date": 1511368138, "creation_date": 1511368138, "answer_id": 47439607, "question_id": 47439405, "link": "https://stackoverflow.com/questions/47439405/increment-excel-formula-by-1/47439607#47439607", "title": "Increment excel formula by 1", "body": "<p>A math trick.</p>\n\n<p><code>=INDIRECT(\"Sheet2!A\"&amp;INT(ROW()/4)-*offset*)</code></p>\n\n<p>Addjust <em>offset</em> first and then you can copy and paste it down as you wish.</p>\n\n<p>The <code>ROW()</code> returns the row number where the formula located. For example, if the formula you type is in cell <code>A20</code>, <code>ROW()</code> returns 20. i.e. if you need to show <code>Sheet2!A1</code> in <code>A20</code>, the offset should be 4. The formula becomes <code>=INDIRECT(\"Sheet2!A\"INT(ROW()/4)-4)</code></p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 8958383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74735c1e2375cb9ca948310e7a7d2136?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Callahan", "link": "https://stackoverflow.com/users/8958383/evan-callahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1511368719, "creation_date": 1511368719, "answer_id": 47439797, "question_id": 47439405, "link": "https://stackoverflow.com/questions/47439405/increment-excel-formula-by-1/47439797#47439797", "title": "Increment excel formula by 1", "body": "<pre><code>ThisWorkbook.Sheets(\"Your_Sheet_Name\").Range(\"A99999\").End(xlUp).Offset(1, 0) \n</code></pre>\n\n<p>Modify the above code.  What this is doing is selecting cell A99999 and then using the Ctrl and up arrow command to select the last row with a value and offsetting by one so it actually selects the cell below that.  You can then paste whatever you want into that cell.</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 11900863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00645daaad6b4b2b6a092f58536f0895?s=128&d=identicon&r=PG&f=1", "display_name": "TheLinkedOne", "link": "https://stackoverflow.com/users/11900863/thelinkedone"}, "is_accepted": false, "score": 0, "last_activity_date": 1576661056, "creation_date": 1576661056, "answer_id": 59388921, "question_id": 47439405, "link": "https://stackoverflow.com/questions/47439405/increment-excel-formula-by-1/59388921#59388921", "title": "Increment excel formula by 1", "body": "<p>Here's some Code I've Written for myself. It's fairly simple to edit with changeable increments and Row spacings.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MakeFormulas()\n    Dim sh As Worksheet: Set sh = ActiveWorkbook.Sheets(\"YourWorksheet\")\n    Dim field As String\n    Dim formula As String\n    Dim i As Integer: i = 2 'Every x Line you want to Paste your Formula to\n    Dim a As Integer: a = 7 'Starting Row Number of Data on the Sheet you want to fetch\n    Do While i &lt; 1000 'How many Rows down you wan't to paste it to\n        field = \"C\" + CStr(i) 'Column where you paste to + The Row Number\n        formula = \"=Switches!A\" + CStr(a) 'The Reference Column + Row Number which gets incremented.\n        sh.Range(field) = formula\n\n        a = a + 1 'By which Number your FOrmula should get incremented\n        i = i + 2 'Every i (Second) row gets the Formula Pasted.\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8895098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abd2156c730b4896bbe85e153728881b?s=128&d=identicon&r=PG&f=1", "display_name": "steveybo", "link": "https://stackoverflow.com/users/8895098/steveybo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 47439448, "answer_count": 4, "score": 4, "last_activity_date": 1576661056, "creation_date": 1511367545, "last_edit_date": 1518795723, "question_id": 47439405, "link": "https://stackoverflow.com/questions/47439405/increment-excel-formula-by-1", "title": "Increment excel formula by 1", "body": "<p>I'm trying to copy and paste a few cells keeping the format and them ebing linked to a table.</p>\n\n<p>Currently i have a table but i am referencing it from another sheet\ne.g:</p>\n\n<pre><code>=Sheet2!A1  =Sheet2!B1  =Sheet2!C1\n=Sheet2!D1  =Sheet2!E1  \n</code></pre>\n\n<p>I'm trying to copy it down 4 lines at a time and paste multiple times, the values keep going to the current cell ID but i'm wanting to increment them by 1 each time, e.g. when i paste i would like them to be:</p>\n\n<pre><code>=Sheet2!A2  =Sheet2!B2  =Sheet2!C2\n=Sheet2!D2  =Sheet2!E2\n</code></pre>\n\n<p>Is there any quicker way than manually changing all of the cell ids to +1?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1511366919, "creation_date": 1511366919, "answer_id": 47439198, "question_id": 47439119, "link": "https://stackoverflow.com/questions/47439119/store-row-number-as-a-variable/47439198#47439198", "title": "Store row number as a variable", "body": "<p>Use <code>Application.WorkSheetFunction.Match()</code> and  <code>Application.WorkSheetFunction.Max()</code></p>\n\n<pre><code>With Application.WorksheetFunction    \n    rowMax = .Match(.Max(ActiveSheet.Range(\"A:A\")),ActiveSheet.Range(\"A:A\"),0)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8991674, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210911263961064/picture?type=large", "display_name": "Jose Diaz", "link": "https://stackoverflow.com/users/8991674/jose-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519052913, "creation_date": 1511366692, "last_edit_date": 1511367257, "question_id": 47439119, "link": "https://stackoverflow.com/questions/47439119/store-row-number-as-a-variable", "title": "Store row number as a variable", "body": "<p>I have to apply a formula to a column from row number 1 to the row where the max value is located. So if in column A the max value is at row number 8, I need to apply the formula to A1:A8. </p>\n\n<p>I have created a variable range that works, but I dont know how to create the variable rowMax which is the row number of the max value in the column. Any ideas?? Thanks</p>\n\n<pre><code>Dim rowMax As Long\nrowMax = ??????    \nDim TMaxRange As Range\nSet TMaxRange = Range(\"A1:A\" &amp; rowMax)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511367337, "post_id": 47439115, "comment_id": 81833376, "body": "There is also an error where several lines should read  Application.WorksheetFunction.IsFormula"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511367396, "post_id": 47439115, "comment_id": 81833428, "body": "I believe there is also an IsFormula function within VBE? It has worked for me with no issue. If there was no built in function it would have error-ed. Or am I missing something?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511367531, "post_id": 47439115, "comment_id": 81833514, "body": "Ok. Gave error for me in 2016."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1511367617, "post_id": 47439115, "comment_id": 81833579, "body": "@QHarr - seems to be an Office365 addition."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511367748, "post_id": 47439115, "comment_id": 81833674, "body": "So you are using the Workbook sheet deactivate event? Use the sheet event instead or add an If to your workbook code to specify sheet(s)."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511367951, "post_id": 47439115, "comment_id": 81833828, "body": "I&#39;m referring to worksheet deactivate events. So it goes like this: Current sheet -&gt; Click on another sheet -&gt; Deactivate event of current sheet runs -&gt; The current sheet code will open <code>Worksheets(&quot;Payroll - Extra&quot;)</code> -&gt; If the clicked sheet is not <code>Worksheets(&quot;Payroll - Extra&quot;)</code> and has an event it may activate -&gt; Go back to the clicked sheet -&gt; Repeat"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511368180, "post_id": 47439115, "comment_id": 81833979, "body": "It&#39;s impossible to answer properly with the vague information you have given. You just have to make sure you only activate the code when the appropriate sheet(s) is activated or deactivated."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511368400, "post_id": 47439115, "comment_id": 81834118, "body": "It is quite hard to explain. I will add a flowchart in the main post"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1511371463, "post_id": 47439115, "comment_id": 81836147, "body": "It would help to show exactly how the code is triggered. Also, your code would be much easier to read and maintain if you used some variables for your worksheets and other items.  There&#39;s a large amount of repetition here."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511371584, "post_id": 47439115, "comment_id": 81836212, "body": "I did think about that although since it&#39;s a worksheet event it&#39;s too much code. It&#39;ll flood the entire page. I&#39;ll add in my variable declarations. The issue is that the effect of the code activation as a whole instead of specifically in the code which makes it hard to explain clearly"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511371949, "post_id": 47439115, "comment_id": 81836408, "body": "For instance, when I press a worksheet with a deactivate event it will have a different effect than when I press a worksheet with a worksheet change event or a worksheet with no event activations"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511372275, "post_id": 47439115, "comment_id": 81836582, "body": "Any code which runs as the result of an activate/deactivate event shouldn&#39;t be performing any worksheet selections itself (or if it does, it should first suspend event handling)"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511372428, "post_id": 47439115, "comment_id": 81836677, "body": "How to suspend event handling though? That may work"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511373029, "post_id": 47439115, "comment_id": 81836967, "body": "<code>Application.EnableEvents = False</code> but you must be sure to set it back to True when done or none of your events will fire."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511373187, "post_id": 47439115, "comment_id": 81837036, "body": "Thanks I believe this will work unless the current event procedure being run gets halted altogether when that line activates."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511373865, "post_id": 47439115, "comment_id": 81837395, "body": "<code>EnableEvents</code> doesn&#39;t affect running code - only subsequent events"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1511374050, "post_id": 47439115, "comment_id": 81837490, "body": "Great I believe it would work. Thanks"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511371818, "creation_date": 1511366652, "last_edit_date": 1511371818, "question_id": 47439115, "link": "https://stackoverflow.com/questions/47439115/how-to-workaround-this-excel-vba-issue-with-regards-to-code-prioritization", "title": "How to workaround this Excel VBA issue with regards to code prioritization?", "body": "<p>I have a deactivate event on one of my worksheet that activates this code:</p>\n\n<pre><code>Dim Total_rows_DTR As Long\nDim Total_rows_PU As Long\nDim Total_rows_PR As Long\nDim Total_rows_PTS As Long\nDim Total_Columns4 As Long\nDim Total_rows_EX4 As Long\nDim Sum As Long\nDim j As Long\nDim w As Long\nDim h As Long\nDim e As Long\nDim q As Long\n\nTotal_rows_DTR = Workbooks(\"Revised-Payroll (VBA Copy).xlsm\").Worksheets(\"DTR\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nTotal_rows_PU = Workbooks(\"Revised-Payroll (VBA Copy).xlsm\").Worksheets(\"Payroll Update\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nTotal_rows_PR = Workbooks(\"Revised-Payroll (VBA Copy).xlsm\").Worksheets(\"Payroll - Regular\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor j = 2 To Total_rows_PU\n    If Application.WorksheetFunction.Index(Worksheets(\"Payroll Tables and Settings\").Range(\"D2:D1048576\"), Application.WorksheetFunction.Match(Worksheets(\"Payroll Update\").Cells(j, 1), Worksheets(\"Payroll Tables and Settings\").Range(\"A2:A1048576\"), 0)) &lt;&gt; Worksheets(\"Payroll Update\").Cells(j, 5) _\n    And IsEmpty(Worksheets(\"Payroll Update\").Cells(j, 5)) = False Then\n        If Application.WorksheetFunction.Index(Worksheets(\"Payroll Tables and Settings\").Range(\"D2:D1048576\"), Application.WorksheetFunction.Match(Worksheets(\"Payroll Update\").Cells(j, 1), Worksheets(\"Payroll Tables and Settings\").Range(\"A2:A1048576\"), 0)) = \"Extra\" Then\n            For h = 3 To Total_Columns4\n                If Worksheets(\"Payroll - Extra\").Cells(1, h) = Worksheets(\"Payroll Update\").Cells(j, 1) Then\n                    For q = 2 To Total_rows_EX4\n                        If Worksheets(\"Payroll - Extra\").Cells(q, 2) &lt; Worksheets(\"Payroll Update\").Cells(j, 2) And IsFormula(Worksheets(\"Payroll - Extra\").Cells(q, h)) = True Then\n                            Worksheets(\"Payroll - Extra\").Cells(q, h).Copy\n                            Worksheets(\"Payroll - Extra\").Cells(q, h).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                            :=False, Transpose:=False\n                        End If\n                        If Worksheets(\"Payroll - Extra\").Cells(q, 2) &gt;= Worksheets(\"Payroll Update\").Cells(j, 2) And Worksheets(\"Payroll - Extra\").Cells(q, 1) &gt;= Worksheets(\"Payroll Update\").Cells(j, 2) Then\n                            Worksheets(\"Payroll - Extra\").Cells(q, h).Clear\n                        ElseIf Worksheets(\"Payroll - Extra\").Cells(q, 2) &gt;= Worksheets(\"Payroll Update\").Cells(j, 2) And Worksheets(\"Payroll - Extra\").Cells(q, 1) &lt; Worksheets(\"Payroll Update\").Cells(j, 2) Then\n                            Sum = 0\n                            For e = 2 To Total_rows_DTR\n                                If Worksheets(\"DTR\").Cells(e, 3) &gt;= Worksheets(\"Payroll - Extra\").Cells(q, 1) And Worksheets(\"DTR\").Cells(e, 3) &lt; Worksheets(\"Payroll Update\").Cells(j, 2) And Worksheets(\"DTR\").Cells(e, 2) = Worksheets(\"Payroll Update\").Cells(j, 1) Then\n                                    Sum = Sum + Worksheets(\"DTR\").Cells(e, 28)\n                                End If\n                            Next e\n                            If Worksheets(\"Payroll - Extra\").Cells(q, h) &lt;&gt; Sum And IsFormula(Worksheets(\"Payroll - Extra\").Cells(q, h)) = True Then\n                                Worksheets(\"Payroll - Extra\").Cells(q, h) = Worksheets(\"Payroll - Extra\").Cells(q, h) + Worksheets(\"DTR\").Cells(e, 28)\n                            End If\n                        End If\n                    Next q\n                End If\n            Next h\n        End If\n        For w = 2 To Total_rows_PTS\n            If Worksheets(\"Payroll Tables and Settings\").Cells(w, 1) = Worksheets(\"Payroll Update\").Cells(j, 1) Then\n                Worksheets(\"Payroll Tables and Settings\").Cells(w, 4) = Worksheets(\"Payroll Update\").Cells(j, 5)\n            End If\n        Next w   \n    End If\nNext j\n</code></pre>\n\n<p>However, my problem is that when I click another worksheet, the deactivate event runs, and keeps switching from the worksheet I clicked on and with the worksheet that is written in the code, which is <code>Worksheets(\"Payroll - Extra\")</code>. This is a problem because every time the worksheet switches the events of the worksheet I clicked on may also trigger. Such example is when I click a worksheet with an activate or deactivate event. This caused my code to error at some point. How do I get by this?</p>\n\n<p>Below is a flowchart in attempt to make it more clear with regards to the problem:\n<a href=\"https://i.stack.imgur.com/t8S8e.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t8S8e.jpg\" alt=\"Flowchart\"></a></p>\n"}, {"tags": ["mysql", "ms-access", "vba", "odbc"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1511366767, "post_id": 47438242, "comment_id": 81832979, "body": "see <a href=\"https://stackoverflow.com/a/26224418/3820271\">stackoverflow.com/a/26224418/3820271</a> to find the root cause of the error."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1511366896, "post_id": 47438242, "comment_id": 81833077, "body": "or <a href=\"https://stackoverflow.com/questions/730414/determine-real-cause-of-odbc-failure-error-3146-with-ms-access\" title=\"determine real cause of odbc failure error 3146 with ms access\">stackoverflow.com/questions/730414/&hellip;</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1511368333, "post_id": 47438242, "comment_id": 81834081, "body": "If you want help troubleshooting a specific query, please provide that query (the query causing the error). See <a href=\"https://stackoverflow.com/questions/418960/managing-and-debugging-sql-queries-in-ms-access/1099570#1099570\">how to debug dynamic sql</a>"}], "owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2465, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511364008, "creation_date": 1511364008, "question_id": 47438242, "link": "https://stackoverflow.com/questions/47438242/runtime-error-3146-odbc-call-failed-when-insert-data-through-loop-into-mysql-db", "title": "Runtime error 3146: ODBC call failed when insert data through loop into mysql db", "body": "<p>With this procedure I'm trying to insert value into a server database but it insert only one row with the loop and show <code>error 3146 odbc call failed</code>. On the other hand it works fine, if I connected this my local machine like below:</p>\n\n<pre><code>blnSuccess = AttachDSNLessTable(\"tbl_agreement\", \"tbl_agreement\", \"127.0.0.1\", \"tenant_db\", \"******\", \"******\")\nblnSuccess = AttachDSNLessTable(\"tbl_agreement_years\", \"tbl_agreement_years\", \"127.0.0.1\", \"tenant_db\", \"******\", \"******\")\n</code></pre>\n\n<p>Don't know what I missed actually, any help would much appreciated.</p>\n\n<pre><code>Private Sub cmdUpdate_Click()\n    Dim t_id, ag_id, rate, incr_rate As Integer\n    Dim stDate, nxstDate, nxenDate, nxyrDate, enDate As Date\n    Dim exp_date As Date\n    Dim StrSqL As String\n\nIf IsNull(Me.tenant_id) Or Me.tenant_id = \"\" Then\n    MsgBox \"You must select a Tenant to create new agreement\", vbInformation, \"Tenant\"\n    Me.tenant_id.SetFocus\n    Me.tenant_id.Dropdown\nElse\n    t_id = Me.tenant_id\n    ag_id = Me.id\n    stDate = Me.startdate\n    enDate = Me.enddate\n    rate = Me.initial_rate\n    incr_rate = Me.increase_rate\n\n    nxyrDate = stDate\n    Do While nxyrDate &lt; enDate\n        nxstDate = nxyrDate\n        nxyrDate = DateAdd(\"yyyy\", 1, nxstDate)\n        nxenDate = DateAdd(\"d\", -1, nxyrDate)\n\n        'Debug.Print t_id, ag_id, nxstDate, nxenDate, rate\n        StrSqL = \"INSERT INTO tbl_agreement_years(tenant_id, ag_id, interval_start, interval_end, rate)\" &amp; _\n            \"VALUES (\" &amp; t_id &amp; \",\" &amp; ag_id &amp; \",#\" &amp; Format(nxstDate, \"mm/dd/yyyy\") &amp; \"#,#\" &amp; Format(nxenDate, \"mm/dd/yyyy\") &amp; \"#,\" &amp; rate &amp; \")\"\n        CurrentDb.Execute StrSqL, dbFailOnError\n        rate = rate + incr_rate\n    Loop\n    Me.Refresh\n    MsgBox \"Saved successfully\", vbInformation, \"Save\"\nEnd If\n</code></pre>\n\n<p><strong>Onload Connection:</strong></p>\n\n<pre><code>Public Function InitApplication()\nDim blnSuccess As Boolean\n   \"tbl_tenant_basic_info\", \"192.168.20.2\", \"tenant_db\", \"admin\", \"1DBServer\")\n    blnSuccess = AttachDSNLessTable(\"tbl_agreement\", \"tbl_agreement\", \"192.168.20.2\", \"tenant_db\", \"******\", \"******\")\n    blnSuccess = AttachDSNLessTable(\"tbl_agreement_years\", \"tbl_agreement_years\", \"192.168.20.2\", \"tenant_db\", \"******\", \"******\")\n\n\n\n    If blnSuccess Then\n        DoCmd.OpenForm \"frmTenant_basic_info\"\n    Else\n        MsgBox \"Boohoo, could not refresh the links to the database. Call a programmer\", vbCritical\n    End If\nEnd Function\n</code></pre>\n\n<p><strong>AttachDSNLessTable Function:</strong></p>\n\n<pre><code>Function AttachDSNLessTable(stLocalTableName As String, stRemoteTableName As String, stServer As String, stDatabase As String, Optional stUsername As String, Optional stPassword As String)\nOn Error GoTo AttachDSNLessTable_Err\nDim td As TableDef\nDim stConnect As String\n\nFor Each td In CurrentDb.TableDefs\n    If td.name = stLocalTableName Then\n        CurrentDb.TableDefs.Delete stLocalTableName\n    End If\nNext\n\nIf Len(stUsername) = 0 Then\n    '//Use trusted authentication if stUsername is not supplied.\n    stConnect = \"ODBC;DRIVER={MySQL ODBC 5.2 Unicode Driver};SERVER=\" &amp; stServer &amp; \";DATABASE=\" &amp; stDatabase &amp; \";Trusted_Connection=Yes\"\nElse\n    '//WARNING: This will save the username and the password with the linked table information.\n    stConnect = \"ODBC;DRIVER={MySQL ODBC 5.2 Unicode Driver};Server=\" &amp; stServer &amp; \";Database=\" &amp; stDatabase &amp; \";Uid=\" &amp; stUsername &amp; \";Pwd=\" &amp; stPassword &amp; \";Option= 3\"\nEnd If\nSet td = CurrentDb.CreateTableDef(stLocalTableName, dbAttachSavePWD, stRemoteTableName, stConnect)\nCurrentDb.TableDefs.Append td\nAttachDSNLessTable = True\nExit Function\n\nAttachDSNLessTable_Err:\n\n    AttachDSNLessTable = False\n    MsgBox \"AttachDSNLessTable encountered an unexpected error: \" &amp; Err.Description\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "worksheet"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511363716, "post_id": 47438076, "comment_id": 81830699, "body": "<code>Set SrchRange = Sheets(&quot;Data&quot;).Range(Sheets(&quot;Data&quot;).Cells(1, 1), Sheets(&quot;Data&quot;).Cells(LastRow, 7))</code>"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511365625, "post_id": 47438076, "comment_id": 81832177, "body": "SrchRange will refer to the sheet &quot;DATA&quot; after you activate it.  Not sure how you are getting it to still refer to the &quot;MAIN&quot; sheet.  But your approach is using activesheet, which is never a good thing to use.    Try top directly reference your sheets as others have advised."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511366516, "post_id": 47438076, "comment_id": 81832805, "body": "In my opinion, if you called the marco from &quot;MAIN&quot; sheet, the default mother-set of <code>Range</code> and <code>Cells</code> collection will be &quot;MAIN&quot; sheet even if you have activated &quot;DATA&quot; sheet first."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511366932, "post_id": 47438076, "comment_id": 81833108, "body": "I already tested that code and it set activesheet to DATA and the Range and Cells defaulted to activesheet.  What does the sheet your are calling the macro from have to do with the activesheet, once DATA is activated?"}, {"owner": {"reputation": 13, "user_id": 8990640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa79c0c7ff42f4929621c7e5eab9b70b?s=128&d=identicon&r=PG&f=1", "display_name": "JonasJ", "link": "https://stackoverflow.com/users/8990640/jonasj"}, "edited": false, "score": 0, "creation_date": 1511422562, "post_id": 47438076, "comment_id": 81854562, "body": "Button which contains the code is placed on the &quot;MAIN&quot; sheet. I once again tested the code and without ActiveSheet in the LastRow statement it will return number 3 which is the number of rows on the &quot;Main&quot; Sheet even if Worksheet &quot;Data&quot; is activated and selected. If Activesheet. or Shees(&quot;Data&quot;). is added to the LastRow statement then it will give number 513 which is number of the rows in the &quot;Data&quot; sheet."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 3, "creation_date": 1511364733, "post_id": 47438307, "comment_id": 81831506, "body": "<code>ws1</code> is a variant in your code, <code>ws2</code> is a worksheet.  It should be <code>Dim ws1 As Worksheet, ws2 As Worksheet</code>."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1511365103, "post_id": 47438307, "comment_id": 81831772, "body": "Thanks for the comment. So I always used the wrong way coding :/"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511366612, "post_id": 47438307, "comment_id": 81832867, "body": "@newacc2240 yup. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (an OSS VBIDE add-in project I manage) can probably help you with other bad habits too =)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511366797, "post_id": 47438307, "comment_id": 81833000, "body": "@Mat&#39;sMug Still trying to get work to authorise installing Rubberduck.  I might have to get sneaky and ask IT early in the morning before they&#39;ve worken up."}, {"owner": {"reputation": 13, "user_id": 8990640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa79c0c7ff42f4929621c7e5eab9b70b?s=128&d=identicon&r=PG&f=1", "display_name": "JonasJ", "link": "https://stackoverflow.com/users/8990640/jonasj"}, "edited": false, "score": 0, "creation_date": 1511439385, "post_id": 47438307, "comment_id": 81865003, "body": "If I define both range and Cells to be under sheets(&quot;Data&quot;) it will still give me a runtime error."}], "tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": false, "score": 2, "last_activity_date": 1511431228, "last_edit_date": 1511431228, "creation_date": 1511364238, "answer_id": 47438307, "question_id": 47438076, "link": "https://stackoverflow.com/questions/47438076/how-to-set-range-from-activesheet-or-any-other/47438307#47438307", "title": "How to set Range from activesheet (or any other)", "body": "<p>It is confusing using <code>ActiveSheet</code> when dealing with 2 or more worksheet at the same time. It is better to set a worksheet to a variable such as code below:</p>\n\n<pre><code>Dim ws1 as Worksheet, ws2 As Worksheet\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\n</code></pre>\n\n<p>Then do your stuff with these two variable pointed to a worksheet. In addition, using a <code>With</code> block would make the code clearer to tell which worksheet your are dealing. Therefore the code you given can be re-written as below:</p>\n\n<pre><code>Dim wsData As Worksheet\nSet wsData = Worksheets(\"Data\")\nWith wsData\n    LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Dim SrchRange As Range\n    Set SrchRange = .Range(.Cells(1, 1), .Cells(LastRow, 7))\nEnd With\n</code></pre>\n\n<p>I gave some testings for <code>ActiveSheet</code> and calling collection without specifying certain reference. Say I have a <code>Workbook</code> with 2 <code>Worksheets</code>, one named <code>SheetA</code> and another is <code>SheetB</code>. The code below is put in <code>SheetA</code>.</p>\n\n<pre><code>Private Sub test()\n    Worksheets(\"B\").Activate\n    MsgBox Range(\"A1\").Parent.Name\n    MsgBox ActiveSheet.Range(\"A1\").Parent.Name\nEnd Sub\n</code></pre>\n\n<p>Result is that the first <code>MsgBox</code> gives <code>SheetA</code>, and the second one gives <code>SheetB</code>. Therefore I assume that if you called a collection without specifying reference, the default is the one where the marco is called.</p>\n\n<p>I then put the code in a module. This time both <code>MsgBox</code> gives the same result <code>SheetB</code> no matter which worksheet is active before executing the code. So here is my conclusion.</p>\n\n<ol>\n<li>Calling a collection without specifying reference, the default is where the code belongs to.</li>\n<li>When in a module level, the default is the active sheet currently.</li>\n<li>Specifying the reference is a good manner and can avoid some unpredictable errors. Note it's better to specify even the <code>Workbook</code> when dealing with several workbooks at the same time.</li>\n</ol>\n\n<p>Let's take a look at these three lines you asked:</p>\n\n<ol>\n<li><code>Set SrchRange = Range(Cells(1, 1), Cells(LastRow, 7))</code></li>\n</ol>\n\n<p>All three collections, i.e. <code>Range</code>, <code>Cells</code> and <code>Cells</code>. are from the same parent, the code belongs to or the activesheet, depends on where the code is. So it will always pass the compiler, but not always giving you the correct result.</p>\n\n<ol start=\"2\">\n<li><code>Set SrchRange = Sheets(\"Data\").Range(Cells(1, 1), Cells(LastRow, 7))</code></li>\n</ol>\n\n<p>The <code>Range</code> collection is from <code>Sheets(\"Data\")</code>, but both <code>Cells</code> may come from another sheet, so sometimes it gives an error.</p>\n\n<ol start=\"3\">\n<li><code>Set SrchRange = Range(Sheets(\"Data\").Cells(1, 1), Sheets(\"Data\").Cells(LastRow, 7))</code></li>\n</ol>\n\n<p>Both <code>Cells</code> are from the same sheet, however the parent of <code>Range</code> depends. So it is the same as [2], sometimes it pass, and sometimes it fail.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 8367709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oOAMI.jpg?s=128&g=1", "display_name": "Kwakkers", "link": "https://stackoverflow.com/users/8367709/kwakkers"}, "is_accepted": false, "score": 0, "last_activity_date": 1511413296, "creation_date": 1511413296, "answer_id": 47447871, "question_id": 47438076, "link": "https://stackoverflow.com/questions/47438076/how-to-set-range-from-activesheet-or-any-other/47447871#47447871", "title": "How to set Range from activesheet (or any other)", "body": "<p>If all the worksheets are in the workbook that contains the vba code, you can use the worksheet code name and not have to set to individual variables.</p>\n\n<p>Example I would change the code name of worksheet \"Data\" to cnData and use this...</p>\n\n<pre><code>With cnData\n    LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Dim SrchRange As Range\n    Set SrchRange = .Range(.Cells(1, 1), .Cells(LastRow, 7))\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511431759, "post_id": 47451839, "comment_id": 81860296, "body": "<code>Range</code> is a subset of <code>Worksheet</code>, however <code>LastRow</code> is a <code>Variable</code> which is <b>not</b> an object. The purpose of adding <code>Sheets(&quot;Data&quot;)</code> is to tell excel which sheet it should look into."}, {"owner": {"reputation": 13, "user_id": 8990640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa79c0c7ff42f4929621c7e5eab9b70b?s=128&d=identicon&r=PG&f=1", "display_name": "JonasJ", "link": "https://stackoverflow.com/users/8990640/jonasj"}, "reply_to_user": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511439733, "post_id": 47451839, "comment_id": 81865230, "body": "I thought that <code>Range(Cells(1, 1), Cells(LastRow, 7))</code> and <code>Sheets(&quot;Data&quot;).Range(Cells(1, 1), Cells(LastRow, 7))</code> would both be ranges and therefore possible to put in the SrchRange as it is defined as range. This clearly is not the case and I try to figure out why is that."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511439913, "post_id": 47451839, "comment_id": 81865348, "body": "The later one is actually <code>Sheets(&quot;Data&quot;).Range(Sheets(&quot;Unknown&quot;).Cells(1,1),Sheets(&quot;Un&zwnj;&#8203;known&quot;).Cells(LastRo&zwnj;&#8203;w, 7))</code>"}], "tags": [], "owner": {"reputation": 13, "user_id": 8990640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa79c0c7ff42f4929621c7e5eab9b70b?s=128&d=identicon&r=PG&f=1", "display_name": "JonasJ", "link": "https://stackoverflow.com/users/8990640/jonasj"}, "is_accepted": false, "score": 0, "last_activity_date": 1511429194, "creation_date": 1511429194, "answer_id": 47451839, "question_id": 47438076, "link": "https://stackoverflow.com/questions/47438076/how-to-set-range-from-activesheet-or-any-other/47451839#47451839", "title": "How to set Range from activesheet (or any other)", "body": "<p>Thanks for the quick replies. Two previous answers seems to do the trick. I got the code working by defining Worksheets as variables and manipulating them via with block.</p>\n\n<p>I'm still quite puzzled how this all works. Could somebody give some insight on how these different statements are different?</p>\n\n<pre><code>LastRow = Cells(Rows.Count, 1).End(xlUp).Row\nLastRow = Sheets(\"Data\").Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>Those both seem to work ok. First one is fetching the value from \"Main\" sheet even if the \"Data\" sheet is activated. Second one will give lastrow of \"Data\" sheet. Altogether they both work even if the result is different.</p>\n\n<pre><code>Set SrchRange = Range(Cells(1, 1), Cells(LastRow, 7))\nSet SrchRange = Sheets(\"Data\").Range(Cells(1, 1), Cells(LastRow, 7))\nSet SrchRange = Range(Sheets(\"Data\").Cells(1, 1), Sheets(\"Data\").Cells(LastRow, 7))\n</code></pre>\n\n<p>But for these three only first one works but others will give runtime error. I also tried without Set and without predefining the variable to be As Range like the LastRow is. </p>\n\n<p>I think the issue is that a statement is no longer range if for example Sheets(\"Data\"). is added. My variable should probably be something else then? How the LastRow variable seems to work even if Sheets(\"Data\"). is added?  </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14029264, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ca56b20e4a50909c4fe11ef7ed9dad1f?s=128&d=identicon&r=PG", "display_name": "Travis", "link": "https://stackoverflow.com/users/14029264/travis"}, "is_accepted": false, "score": 1, "last_activity_date": 1596241157, "last_edit_date": 1596241157, "creation_date": 1596208482, "answer_id": 63194563, "question_id": 47438076, "link": "https://stackoverflow.com/questions/47438076/how-to-set-range-from-activesheet-or-any-other/63194563#63194563", "title": "How to set Range from activesheet (or any other)", "body": "<p>I had this problem myself. The reason is because the <code>.End()</code> method only works on the active sheet.</p>\n<p>Per <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\">Microsoft's documentation</a> the <code>.End()</code> is equivalent to pressing <kbd>end</kbd>+<kbd>\u2191</kbd>, <kbd>end</kbd>+<kbd>\u2193</kbd>, <kbd>end</kbd>+<kbd>\u2190</kbd> or <kbd>end</kbd>+<kbd>\u2192</kbd>. Read-only Range object. This is why setting a range with <code>Set Range1 = Sheets(&quot;Data&quot;).Range((&quot;A1&quot;),Range(&quot;A1&quot;).End(Xldown))</code> only works if data is currently selected.</p>\n<p>As a workaround use the <code>.Activate</code> method on your data sheet to set the range.</p>\n"}], "owner": {"reputation": 13, "user_id": 8990640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa79c0c7ff42f4929621c7e5eab9b70b?s=128&d=identicon&r=PG&f=1", "display_name": "JonasJ", "link": "https://stackoverflow.com/users/8990640/jonasj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5372, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1596241157, "creation_date": 1511363517, "question_id": 47438076, "link": "https://stackoverflow.com/questions/47438076/how-to-set-range-from-activesheet-or-any-other", "title": "How to set Range from activesheet (or any other)", "body": "<p>I'm confused about how VBA handles Range in different situations..</p>\n\n<p>I have 2 sheets \"Main\" and \"Data\". There is button on the sheet \"Main\" which includes following code:</p>\n\n<pre><code>Worksheets(\"Data\").Activate\nWorksheets(\"Data\").Select\nLastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row    \nDim SrchRange As Range\nSet SrchRange = Range(Cells(1, 1), Cells(LastRow, 7))\n</code></pre>\n\n<p>As it is SrchRange will refer to the sheet \"Main\" even if the \"Data\" sheet is activated and selected. For the \"LastRow\" I found this workaround to put it as ActiveSheet.Cells(... but for \"SrchRange\" I can't find the way to do it.\nI have tried at least:</p>\n\n<pre><code>Set SrchRange = ActiveSheet.Range(Cells(1, 1), Cells(LastRow, 7))\nSet SrchRange = Sheets(\"Data\").Range(Cells(1, 1), Cells(LastRow, 7))\nSet SrchRange = Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(LastRow, 7))\n</code></pre>\n\n<p>All of them will give me a runtime error '1004'. I don't understand how the situation changes if Range is described in more detail. Shouldn't it still be range even with the Sheets and ActiveSheet? How should I accomplish this?  </p>\n\n<p>I managed to circumvent the issue by not using the Range variable at all.\nHere is the section where the SrchRange variable is used.</p>\n\n<pre><code>For Each HeaderMatch In SrchRange\nIf HeaderMatch Like HeaderKeyWord Then\n</code></pre>\n\n<p>Which I replaced with this:</p>\n\n<pre><code>For Each HeaderMatch In ActiveSheet.Range(ActiveSheet.Cells(1, 1), \nActiveSheet.Cells(LastRow, 7))\nIf HeaderMatch Like HeaderKeyWord Then\n</code></pre>\n\n<p>I would prefer the first one as it is little bit more clear and out of principle I want to get it work as I intended because I know it is possible but I don't know how.</p>\n\n<p>I'm not quite getting the concept of ActiveSheet and selecting the sheets. What is the point of activating the sheet if I still need to refer to it as ActiveSheet? Why not to use just Sheets() to select specific sheet if you anyways need to alway use the reference. And to stir it even more what is the use of Select? </p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1511364886, "post_id": 47437882, "comment_id": 81831602, "body": "Possibly a bug in PPT 2016.  I can&#39;t repro this here in PPT 2016 (aka 365) 32-bit, Insider Fast running under Win7/64."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1511366782, "post_id": 47437882, "comment_id": 81832989, "body": "FWIW this appears to actually be a bug in the VBIDE, somehow holding on to a reference to the <code>VBProject</code> or one or more of its <code>VBComponent</code>. Similar &quot;ghost project&quot; issues have been encountered at various points in the development of <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>. Nothing much to do, other than making sure all objects involved are explicitly cleaned up."}, {"owner": {"reputation": 1, "user_id": 8990842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a8aa8cab95482e8c5897b943c5a793?s=128&d=identicon&r=PG&f=1", "display_name": "KH-KH", "link": "https://stackoverflow.com/users/8990842/kh-kh"}, "edited": false, "score": 0, "creation_date": 1511367097, "post_id": 47437882, "comment_id": 81833230, "body": "Thank you. This also happens, if i run similar code using .NET interop (clientprofile/4).I just tried to do a &quot;pure vba/no addins/everything to out-of-the-box&quot; approach to confirm it."}, {"owner": {"reputation": 1, "user_id": 8990842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a8aa8cab95482e8c5897b943c5a793?s=128&d=identicon&r=PG&f=1", "display_name": "KH-KH", "link": "https://stackoverflow.com/users/8990842/kh-kh"}, "edited": false, "score": 0, "creation_date": 1516717547, "post_id": 47437882, "comment_id": 83796374, "body": "Please note the edited text above; it seems i found a &quot;solution&quot; (more like a workaround) for avoiding this behavior; and as far as i can tell i found the condition for this behavior."}], "owner": {"reputation": 1, "user_id": 8990842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a8aa8cab95482e8c5897b943c5a793?s=128&d=identicon&r=PG&f=1", "display_name": "KH-KH", "link": "https://stackoverflow.com/users/8990842/kh-kh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516788403, "creation_date": 1511362997, "last_edit_date": 1516788403, "question_id": 47437882, "link": "https://stackoverflow.com/questions/47437882/powerpoint-2016-presentation-close-does-not-remove-entry-from-application-presen", "title": "PowerPoint 2016 Presentation.Close does NOT remove entry from Application.Presentations", "body": "<h2>Settings</h2>\n\n<ul>\n<li>PowerPoint 2016</li>\n<li>.NET com-addin (CP 4) with \n\n<ul>\n<li>WindowActivate DISPID(2009)</li>\n<li>for test purposes changed to just \"do nothing but the necessities\" </li>\n</ul></li>\n<li>Windows 10</li>\n<li>Create an empty file in a folder using windows explorer (no slides\ninside said file).</li>\n</ul>\n\n<h2>Problem description</h2>\n\n<p>Using integrated VBA i ran this code three times  </p>\n\n<pre><code>Option Explicit    \nSub test()\n    Dim objPresentation As PowerPoint.Presentation\n    Set objPresentation = Application.Presentations.Open(\"c:\\test\\folder\\file.pptx\")\n    objPresentation.Close\n    Set objPresentation = Nothing\n    Debug.Print Presentations.Count\n    For Each objPresentation In Presentations\n        Debug.Print objPresentation.FullName, vbTab, objPresentation.Windows.Count\n    Next\nEnd Sub\n</code></pre>\n\n<p>Please find result below</p>\n\n<pre><code> 2 \nC:\\Users\\admin\\Desktop\\kh_tests.pptm                     1 \nc:\\test\\folder\\file.pptx                   0 \n 3 \nC:\\Users\\admin\\Desktop\\kh_tests.pptm                     1 \nc:\\test\\folder\\file.pptx                   0 \nc:\\test\\folder\\file.pptx                   0 \n 4 \nC:\\Users\\admin\\Desktop\\kh_tests.pptm                     1 \nc:\\test\\folder\\file.pptx                   0 \nc:\\test\\folder\\file.pptx                   0 \nc:\\test\\folder\\file.pptx                   0 \n</code></pre>\n\n<p>It confuses not only my addin (is a presentation open or not), it seems not to be intentional since one could expect ppt would at least <em>reuse</em> the entry it left behind last time, but the entry seems to be corrupt.</p>\n\n<p>I've encountered this behavior on several systems with PPT2016.</p>\n\n<p>PPT2010 does <em>not</em> show this behavior.\nThank you for reading\nKH</p>\n\n<h2>Explanation/Hypothesis</h2>\n\n<p>I <em>think</em> i came closer to the reason (sorry for the time it took but you know how it is some times); i came to the believe that \"someone\" is still pointing to that particular presentation so it might not close; so i decided to have another go for it.</p>\n\n<p>I narrowed it down by selective disabling everything in my com-addin, but to no result: even doing <em>nothing</em> (just \"return\") the behavior remains the same; but if i did not connect my connection-point (<strong>WindowActivate</strong>, DISPID 2009) in the first place it suddenly worked and all went well. According to my logfile the event has always been processed after the close, not interfering with anything, but who knows. I tried to force things with DoEvents, but to no avail.</p>\n\n<p>Hypothesis:\nThe presence of WindowActivate event sinks will keep PowerPoint2016 from discarding the presentation <em>WHICH HAS BEEN ACTIVE</em> at that time, even if closing <em>this</em> presentation is the reason for the event in the first place.</p>\n\n<p>Test:\nUnfortunately i found no easy way to have an vba/inapp test. Any ideas?</p>\n\n<p>But with my fully fledged com addin present (okay, still much deactivated, by sink connected), i tested this:  </p>\n\n<pre><code>Option Explicit\n\nDim objCloak As PowerPoint.Presentation\n\nSub test()\n    Dim objPresentation As PowerPoint.Presentation\n    Set objPresentation = Application.Presentations.Open(\"C:\\test\\folder\\file.pptx\")\n\n    If objCloak Is Nothing Then\n        Set objCloak = Presentations.Add ' change to the intermediate presentation\n    End If\n\n    DoEvents                         ' relic from previous tests\n    objCloak.Windows(1).Activate '   ' be paranoid\n\n    DoEvents                         ' relic from previous tests\n    objPresentation.Close\n    DoEvents                         ' relic from previous tests\n\n    If (Not (Nothing Is objCloak)) Then\n        objCloak.Saved = True\n        objCloak.Close\n    End If\n    Set objCloak = Nothing\n\n    For Each objPresentation In Presentations\n        Debug.Print objPresentation.FullName, vbTab, objPresentation.Windows.Count\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>And the result is  </p>\n\n<pre><code>C:\\Users\\admin\\Desktop\\kh_tests.pptm                     1 \nC:\\Users\\admin\\Desktop\\kh_tests.pptm                     1 \nC:\\Users\\admin\\Desktop\\kh_tests.pptm                     1 \n</code></pre>\n\n<p>Switch back and force between the two variants yields the results as described above. So i think there's something here.</p>\n\n<p>Note: the PowerPoint Task now closes without any problems.</p>\n"}, {"tags": ["excel", "vba", "format"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1511360546, "post_id": 47436955, "comment_id": 81828289, "body": "ThisWorkbook.Worksheets(1).Cells(i, 5).NumberFormat = &quot;[$\u20ac-x-euro2] #,##0.00&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1511360748, "post_id": 47436955, "comment_id": 81828424, "body": "Note that you can use the macro recorder whilst doing format cells currency and selecting the appropriate currency format to get the correct code, particularly if you want a different kind of euro/euro layout."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1511361078, "creation_date": 1511361078, "answer_id": 47437206, "question_id": 47436955, "link": "https://stackoverflow.com/questions/47436955/utilization-of-monetize-format/47437206#47437206", "title": "Utilization of monetize format", "body": "<p>Assuming that you are from France, as noted on your profile, probably this is the best solution for you:</p>\n\n<pre><code>ThisWorkbook.Worksheets(1).Cells(i, 5).Style = \"Currency\"\n</code></pre>\n\n<p>It would use the automatic currency format, which is exactly what you need - 2 numbers after the thousand's separator and the EUR sign.</p>\n"}], "owner": {"reputation": 11, "user_id": 8433413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f1f85fefde7190a6015338afd683f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ghita", "link": "https://stackoverflow.com/users/8433413/ghita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511365082, "creation_date": 1511360320, "last_edit_date": 1511365082, "question_id": 47436955, "link": "https://stackoverflow.com/questions/47436955/utilization-of-monetize-format", "title": "Utilization of monetize format", "body": "<p>I have a problem with the VBA monetize format. \nI have this code (which is a small part of a long long one) : </p>\n\n<pre><code>For i = 2 To (k + 1)\nThisWorkbook.Worksheets(1).Cells(i, 5) = Format(ThisWorkbook.Worksheets(1).Cells(i, 5), \" #,##0 \u20ac\")\nFor j = 7 To 11\nThisWorkbook.Worksheets(1).Cells(i, j) = Format(ThisWorkbook.Worksheets(1).Cells(i, j), \" #,###0 \u20ac\")\nNext\nNext\nThisWorkbook.Worksheets(1).Cells(k + 1, 12) = Format(ThisWorkbook.Worksheets(1).Cells(k + 1, 12), \" 0#,##0 \u20ac\")\nThisWorkbook.Worksheets(1).Columns(\"A:M\").AutoFit \n</code></pre>\n\n<p>Each time my value is smaller than 1000, the code displays just the value and without the \u20ac sign, but when it's bigger than 1000, I have no problem. I can't understand why. I tried to change my format (\"#,##0.0 for example, but I doesn't display what I want ..)</p>\n\n<p>Any suggestions ?\nThank you :)</p>\n"}, {"tags": ["excel", "vba", "locale", "formula"], "comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1511359232, "post_id": 47436439, "comment_id": 81827401, "body": "is there any change in the sheets, like is any sheet hidden in your colleagues sys ?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 2, "creation_date": 1511359245, "post_id": 47436439, "comment_id": 81827407, "body": "Why are you using <code>systemListSeparator</code> there? The <code>Range.Formula</code> is <b>always</b> in en_US format, means: english function names, comma as parameter separator, dot as decimal separator. Only <code>Range.FormulaLocal</code> would be in locale format and would need to take care about system list separators and so on."}, {"owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1511360017, "post_id": 47436439, "comment_id": 81827895, "body": "@pnuts No, I did not try &quot;.FormulaLocal&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1511360071, "post_id": 47436439, "comment_id": 81827931, "body": "@NicolasC. - with <code>FormulaLocal</code> you will score own goal. Do not try it."}, {"owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1511360074, "post_id": 47436439, "comment_id": 81827934, "body": "@AxelRichter Well, that&#39;s what I initially thought as well. I am just being careful with that and I guess it does not harm anyway, right?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1511360230, "post_id": 47436439, "comment_id": 81828042, "body": "If your <code>systemListSeparator</code>is something other than comma, then it will harm since <code>Range.Formula</code> needs comma as the parameter separator."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1511360403, "post_id": 47436439, "comment_id": 81828186, "body": "@NicolasC. - just make sure that <code>systemListSeparator</code> is set to <code>,</code> in every case and the <code>.Formula</code> should work. I suppose that it is a variable, which is getting its value from <code>Application.ThousandSeparator</code> or similar. It should not be like that."}, {"owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1511360681, "post_id": 47436439, "comment_id": 81828376, "body": "@AxelRichter Oooooh, so what I actually thought was being careful with list separator could in the end doing the things wrong. So I should write instead: formulaString = &quot;=IF(NOT(ISERROR(VLOOKUP(C&quot; &amp; CStr(counter + 2) &amp; &quot;,DataSet2!$A$2:$A$&quot; &amp; CStr(2 + totalDirectReportsCount) &amp; &quot;,1,0))),&quot;&quot;Direct Report&quot;&quot;,&quot;&quot;Team member of direct report&quot;&quot;)&quot; (if I have not messed in between :)). Right?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1511361214, "post_id": 47436439, "comment_id": 81828773, "body": "It was all said about what <code>Range.Formula</code> needs. But if I read &quot;throws an error 400&quot; then I don&#39;t believe that the problem comes from the formula. This error is usally thrown if VBA-References are wrong."}, {"owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "edited": false, "score": 0, "creation_date": 1511361968, "post_id": 47436439, "comment_id": 81829329, "body": "Yes indeed... which is why I have been struggling that much to find the root cause. Ultimately, I finally decided to catch the error and write in that cell the Err.Number and Err.Description to see what was really the error. So Excel throws 400 bluntly, but in reality, it has nothing to do with the Error 400."}, {"owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1511362065, "post_id": 47436439, "comment_id": 81829404, "body": "@AxelRichter Can you please post an answer with your first comment because it was actually the root cause. Fetching the list separator and building up my formula that way was wrong. I&#39;ve replaced my systemListSeparator variable by a simple comma and it did work. I&#39;d be pleased to flag your answer as a solution. :)"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1511366322, "post_id": 47436439, "comment_id": 81832666, "body": "Glad I could help you. But this is mainly the same as @Vityata has answered already. <code>Range.Formula</code> and <code>Range.FormulaR1C1</code> is working locale independent since it always expects formulas in the format of en_US locale. Maybe @Vityata could mention that yet in his answer."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1511371803, "post_id": 47436439, "comment_id": 81836327, "body": "@AxelRichter - check :) (feel free to edit it)"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "edited": false, "score": 0, "creation_date": 1511360524, "post_id": 47436770, "comment_id": 81828272, "body": "Thank you. I will take control of my end-user&#39;s laptop in Finland, input the formula manually in the cell and then try what you suggest to see what Excel brings. Thanks for the tip!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "edited": false, "score": 0, "creation_date": 1511360559, "post_id": 47436770, "comment_id": 81828303, "body": "@NicolasC. - simply write <code>systemListSeparator = &quot;,&quot;</code> in the line before the formula and it should work."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1511440796, "last_edit_date": 1511440796, "creation_date": 1511359707, "answer_id": 47436770, "question_id": 47436439, "link": "https://stackoverflow.com/questions/47436439/writing-a-formula-from-vba-not-working-on-every-end-users-pc/47436770#47436770", "title": "Writing a formula from VBA not working on every end-user&#39;s PC", "body": "<p>This is really a tricky point, but fortunately VBA provides an excellent solution.</p>\n\n<p>Simply write the formula in Excel, select the cell and run the following code:</p>\n\n<pre><code>Public Sub TestMe()\n\n    With ActiveCell\n        Debug.Print .Formula\n        Debug.Print .FormulaLocal\n        Debug.Print .FormulaR1C1\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>In German Excel, this is what you would get:</p>\n\n<pre><code>=SUM(C1+D1)\n=SUMME(C1+D1)\n=SUM(RC[2]+RC[3])\n</code></pre>\n\n<p>Then rebuild your formulas, using only <code>.Formula</code> or <code>.FormulaR1C1</code> and the result from the immediate window. Thus your colleagues from all over the world would be really happy. As noted in the 3 examples, the first and the third one always give the same answer, following the <strong>en_US format</strong>.</p>\n\n<hr>\n\n<p>Another option is that Excel and VBA do not like your formula, because of the decimal separator in Finland, being different from the decimal separator in the USA. See <a href=\"https://stackoverflow.com/questions/46905279/how-to-add-hardcoded-float-number-values-to-the-formula-using-vba/46905350#46905350\">How to add hardcoded float number values to the formula using VBA</a> to change it a bit.</p>\n\n<p><strong>Solution</strong>\nNicolas C. edit: All the above comments and hereby answer have helped me solving my issue. Thank you very much guys for your prompt reaction and feedback. You really saved my day. So the root cause was indeed that I had tried to capture the end-user's system preferences on his/her locale and regional settings and making use of his/her list separator (which was ; actually) within the VBA script which was a bad move since, as mentioned by @AxelRichter and @Vityata, within a VBA script, .Formula needs always to be written in the en_US format, that is english function names, commas, etc.</p>\n\n<p>I have now removed my user related list separator and replaced it with traditional commas and it solved my issue.</p>\n"}], "owner": {"reputation": 225, "user_id": 917312, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ebdbbddaba5b7a292c9330f36a594815?s=128&d=identicon&r=PG", "display_name": "Nicolas C.", "link": "https://stackoverflow.com/users/917312/nicolas-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 47436770, "answer_count": 1, "score": 0, "last_activity_date": 1511440796, "creation_date": 1511358769, "last_edit_date": 1511361581, "question_id": 47436439, "link": "https://stackoverflow.com/questions/47436439/writing-a-formula-from-vba-not-working-on-every-end-users-pc", "title": "Writing a formula from VBA not working on every end-user&#39;s PC", "body": "<p>I hope someone will be able to help me sort this one out because I've been crawling the Internet for some time now and could not find any obvious reason why the behavior of my macro under Excel works for some users (including me of course) and does not work on some other users' laptops.</p>\n\n<p><strong>My objective:</strong></p>\n\n<p>Write from a VBA SubRoutine a vlookup formula in one cell. Based on that vlookup, either it finds something and it displays a text A or the vlookup throws an error and it then displays a text B.</p>\n\n<p><strong>The situation</strong></p>\n\n<p>Here is the formula if we were writing it directly in the sheet from the end-user's perspective: <code>=IF(NOT(ISERROR(VLOOKUP(C2,DataSet2!$A$2:$A$12,1,0))),\"Direct Report\",\"Team member of direct report\")</code></p>\n\n<p>When we copy/paste that formula on a PC where the macro fails directly in the spreadsheet. It works.\nWhen we run the macro actually trying to incorporate that formula in that exact same cell, it fails and throws an error 400.</p>\n\n<p>Here is now the VBA code attempting to write the above formula in the cell:</p>\n\n<pre><code>formulaString = \"=IF(NOT(ISERROR(VLOOKUP(C\" &amp; CStr(counter + 2) &amp; systemListSeparator &amp; \"DataSet2!$A$2:$A$\" &amp; CStr(2 + totalDirectReportsCount) &amp; systemListSeparator &amp; \"1\" &amp; systemListSeparator &amp; \"0)))\" &amp; systemListSeparator &amp; \"\"\"Direct Report\"\"\" &amp; systemListSeparator &amp; \"\"\"Team member of direct report\"\")\"\nSelection.Offset(counter, 0).Formula = formulaString\n</code></pre>\n\n<p>So the above 2 statements, as you'll have understood probably, are included in a loop and for every single row I have, I want to add that formula in the first cell from the currently selected cell.</p>\n\n<p>What drives me crazy is that: it works fine on my PC, it works fine on my colleague's PC who is in Finland, but on another colleague's PC also in Finland, it does not. I have Windows 10 and Office 2016, she has Windows 10 and office 2016 as well...</p>\n\n<p>So I am really wondering if there could be some regional settings or Excel settings or System Settings which could make HER Excel not interpret my \"formulaString\" as viable for her laptop. I have made sure to fetch the list separator to avoid those usual regional settings easy traps but would there be other similar traps I am not aware of?</p>\n\n<p>Thanks a lot for any hints I could follow to progress on my investigations.\nKind regards,\nNicolas C.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1511421533, "post_id": 47436580, "comment_id": 81854120, "body": "<code>Dim ie As New InternetExplorer</code>     <code>ie.Visible = True</code> does work"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511424724, "post_id": 47436580, "comment_id": 81855677, "body": "@jsotola with which library?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1511759240, "post_id": 47436580, "comment_id": 81964286, "body": "win7 ... <code>Microsoft Internet Controls</code> ... c:\\windows\\syswow64\\ieframe.dll"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1511773496, "last_edit_date": 1511773496, "creation_date": 1511359173, "answer_id": 47436580, "question_id": 47436404, "link": "https://stackoverflow.com/questions/47436404/vba-button-pressing-on-ie-explanation/47436580#47436580", "title": "VBA Button pressing on IE explanation", "body": "<p>You are trying to do early binding of IE in VBA. Thus, you need to do it like this:</p>\n\n<p><code>Dim ie As SHDocVw.InternetExplorer</code> or <code>Dim IE As New InternetExplorer</code>, after adding the \"Microsoft Internet Controls\" library to the project (c:\\windows\\syswow64\\ieframe.dll).</p>\n\n<p>In general, if you want to do late binding, you should do it like this:</p>\n\n<pre><code>Dim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/10580/what-is-the-difference-between-early-and-late-binding\">What is the difference between Early and Late Binding?</a> and <a href=\"https://www.vitoshacademy.com/vba-early-and-late-binding/\" rel=\"nofollow noreferrer\">my understanding about late and early binding</a></p>\n"}], "owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 47436580, "answer_count": 1, "score": 1, "last_activity_date": 1511773496, "creation_date": 1511358655, "last_edit_date": 1511358750, "question_id": 47436404, "link": "https://stackoverflow.com/questions/47436404/vba-button-pressing-on-ie-explanation", "title": "VBA Button pressing on IE explanation", "body": "<p>I have managed to get my code to work, but only by searching the internet and finding something that worked, I don't actually understand why.</p>\n\n<p>Could someone please explain why when I used</p>\n\n<pre><code>Dim IE As New InternetExplorer\n</code></pre>\n\n<p>trying to press a button gave me the error</p>\n\n<blockquote>\n  <p>Object invoked has disconnected from clients</p>\n</blockquote>\n\n<p>but using</p>\n\n<pre><code>Dim ie As SHDocVw.InternetExplorer\n</code></pre>\n\n<p>has worked?</p>\n\n<p>Thank You</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1511362455, "post_id": 47436294, "comment_id": 81829693, "body": "Please read about creating <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and edit your question accordingly."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511362556, "post_id": 47436294, "comment_id": 81829785, "body": "Can you clarify your question/what you are trying to achieve? I am struggling to understand your question. Are you wanting to loop sheets adding the data in them as new series to your &quot;master chart&quot; only if not already found?  Also, is all that code necessary?"}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1511443001, "post_id": 47436294, "comment_id": 81867238, "body": "thanks for the feedback, I tried to clarify the problems better now, the code works, its just so slow when I have to replot every series every time a new series is added, instead of just adding it to existing plot"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511564344, "post_id": 47436294, "comment_id": 81916767, "body": "How is your data laid out in each new sheet so one can understand how that data can be pulled into a chart? It sounds like you may want to loop all sheets, populate a table from that and have an associated pivotchart or a dynamic range based chart. You could empty and re-populate the table each time you run an experiment. Might not be the most efficient way. Depends if there is a reliable way to identify sheets with experiments you want to remove/include again (struggling a little to visualize that bit of the process at the moment)."}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1511785340, "post_id": 47436294, "comment_id": 81977371, "body": "Each sheet just have 5 columns where I use column B for x axis and E for y axis, wouldnt  empty and re-populate the table each time you run an experiment be very time consuminng when we have 100+ sheets with 1000+ rows?"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511442805, "creation_date": 1511358335, "last_edit_date": 1531164843, "question_id": 47436294, "link": "https://stackoverflow.com/questions/47436294/vba-only-add-new-series-to-the-chart-if-it-does-not-exist", "title": "vba only add new series to the chart if it does not exist", "body": "<p>I have several sheets in my workbook which contains data to plot, every time I run a new analysis a new sheet is generated.</p>\n\n<p>On my first sheet I plot all the data in the same graph, so to avoid re plotting all the series every time I append a new sheet I would like to just add a new series.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8BVcv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8BVcv.png\" alt=\"enter image description here\"></a></p>\n\n<p>I thought that should be simple, but it is not for two reasons: When I first create the chart it adds somewhere between 1 and 9 series automatically:</p>\n\n<pre><code> Set myChart = ws.Shapes.AddChart.Chart\n myChart.ChartType = xlXYScatterLinesNoMarkers\n</code></pre>\n\n<p>why does this generate any random series?</p>\n\n<p>also if I delete the graph because I want to rerun one analysis, the graph will then be called 2 and so on...  So I tried to give it a name and refer to its name instead, however that does not work:</p>\n\n<pre><code>Set myChart = ws.ChartObjects(ws.Name)\n</code></pre>\n\n<p>So in the first sheet(Orginal) I plot all data in the workbook, and in the rest I just plot the data for the current sheet as seen below. I use the same code function for both cases, where i just pass the argument all as true(orginal sheet) or false(sheet 1.....300)</p>\n\n<p><a href=\"https://i.stack.imgur.com/sqZjv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sqZjv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Below is the code:</p>\n\n<pre><code>Sub createChart(ws As Worksheet, Optional all As Boolean = False)\nDim lastRow As Long\nDim myChart As Chart\nDim temp As Integer\nDim n As Integer\n\n\nOn Error Resume Next\n' Delete the charts, just in case\nIf ws.ChartObjects.Count &gt; 0 Then ' And Not all Then\n    ws.ChartObjects.Delete\nEnd If\n\n'If ws.ChartObjects.Count = 0 Then\n    Set myChart = ws.Shapes.AddChart.Chart\n    myChart.Name = ws.Name\n'Else\n    'Set myChart = ws.ChartObjects(ws.Name) '''Fails why commented out\n'End If\n\n\n\nmyChart.ChartType = xlXYScatterLinesNoMarkers\nmyChart.SetElement (msoElementPrimaryCategoryGridLinesMinor)\nmyChart.SetElement (msoElementPrimaryValueGridLinesMinorMajor)\nmyChart.SetElement (msoElementLegendBottom)\nmyChart.SetElement (msoElementChartTitleCenteredOverlay)\n\nmyChart.Parent.width = 800  ' px width graph\nmyChart.Parent.height = 500 ' px height graph\n\n' it adds mysterious sometimes several random series, so we need to delete those that does not match sheet name\nFor n = myChart.SeriesCollection.Count To 0 Step -1\n    If Not SheetExists(myChart.SeriesCollection(n).Name) Then\n        myChart.SeriesCollection(n).Delete\n    End If\nNext n\n\n\n'*******************************************************************\n'**************** FIRST PAGE CHART *********************************\n'*******************************************************************\nIf all Then\n    Dim wsOther As Worksheet\n    Dim i As Integer\n    Dim fixRange As Boolean\n    Dim skipGraph As Boolean\n\n    fixRange = True\n\n    myChart.HasLegend = True\n    myChart.Legend.Position = xlLegendPositionRight\n    myChart.Parent.Top = 120\n    myChart.Parent.Left = 450\n\n\n    For Each wsOther In ThisWorkbook.Worksheets\n        If wsOther.Name &lt;&gt; ws.Name Then\n            lastRow = getLastRow(wsOther, 1)\n            skipGraph = False\n            '******* we only add graphs if it is not before ******************\n            If myChart.SeriesCollection.Count &gt; 0 Then\n                For n = myChart.SeriesCollection.Count To 1 Step -1\n                    If myChart.SeriesCollection(n).Name = wsOther.Name Then\n                        skipGraph = True\n                        Exit For\n                    End If\n                Next n\n            End If\n\n            If Not skipGraph Then\n                With myChart.SeriesCollection.NewSeries\n                    .Values = \"=\" &amp; wsOther.Name &amp; \"!$E$2:$E$\" &amp; lastRow\n                    .Name = wsOther.Name\n                    .XValues = \"=\" &amp; wsOther.Name &amp; \"!$B$2:$B$\" &amp; lastRow\n                End With\n           End If\n            If fixRange Then\n                ' Range on axis\n                myChart.Axes(xlPrimary).MinimumScale = CDate(Application.WorksheetFunction.Min(Range(wsOther.Name &amp; \"!$B$2:$B$\" &amp; lastRow).Value2))\n                myChart.Axes(xlPrimary).MaximumScale = CDate(Application.WorksheetFunction.Max(Range(wsOther.Name &amp; \"!$B$2:$B$\" &amp; lastRow).Value2))\n\n                myChart.Axes(xlValue, xlPrimary).ScaleType = xlLogarithmic\n                fixRange = False\n            End If\n\n        End If\n    Next\n\n\n'*******************************************************************************************************\n'****************** SINGLE CHART ***********************************************************************\n'*******************************************************************************************************\nElse\n    myChart.HasLegend = False\n    myChart.Parent.Top = 40\n    myChart.Parent.Left = 300\n\n\n    lastRow = getLastRow(ws, 1)\n\n    With myChart.SeriesCollection.NewSeries\n        .Values = \"=\" &amp; ws.Name &amp; \"!$E$2:$E$\" &amp; lastRow\n        .XValues = \"=\" &amp; ws.Name &amp; \"!$B$2:$B$\" &amp; lastRow\n    End With\n\n    ' Range on axis\n    myChart.Axes(xlPrimary).MinimumScale = CDate(Application.WorksheetFunction.Min(Range(ws.Name &amp; \"!$B$2:$B$\" &amp; lastRow).Value2))\n    myChart.Axes(xlPrimary).MaximumScale = CDate(Application.WorksheetFunction.Max(Range(ws.Name &amp; \"!$B$2:$B$\" &amp; lastRow).Value2))\nEnd If\n\n' *********************************************************************\n' ******************* Sizing ******************************************\n' *********************************************************************\n\nWith myChart.PlotArea\n    temp = .Top\n    temp = .height\n    .Top = 70\n    .height = 420\nEnd With\n\n'really dirty and crappy formatting of title\nmyChart.ChartTitle.Text = \"Faraday Torr\"\n\n'X axis name\nmyChart.Axes(xlCategory, xlPrimary).HasTitle = True\nmyChart.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Time [s]\"\n\n\n'y-axis name\nmyChart.Axes(xlValue, xlPrimary).HasTitle = True\nmyChart.Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Pressure[Torr]\"\n\n\n\n\nSet myChart = Nothing\nSet wsOther = Nothing\n\nws.Select\nws.Range(\"A1\").Select\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "before-save"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 2, "creation_date": 1511357458, "post_id": 47435950, "comment_id": 81826151, "body": "I&#39;m not sure if <code>Date</code> contains special characters that can not be contained in a file name."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1511357496, "post_id": 47435950, "comment_id": 81826183, "body": "are you missing a little comma <code>,</code> before the <code>FileFormat:=52</code> ?"}, {"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1511358027, "post_id": 47435950, "comment_id": 81826527, "body": "@ David - Date does not cause problem. Excel crashes even without it."}, {"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1511358066, "post_id": 47435950, "comment_id": 81826545, "body": "@ Shai, thanks for comment, but again problem persists."}, {"owner": {"reputation": 732, "user_id": 3025905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2fa2b33fcfe80d872becd5026ebb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "PankajKushwaha", "link": "https://stackoverflow.com/users/3025905/pankajkushwaha"}, "edited": false, "score": 0, "creation_date": 1511358326, "post_id": 47435950, "comment_id": 81826748, "body": "Are opening a workbook on disk or creating new excel file from start menu or , opening it from email or other source besides your disk ?  If the file is not already on disk Activeworkbook.path will not return anything."}, {"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1511358452, "post_id": 47435950, "comment_id": 81826848, "body": "@ Pankaj, file is on my drive."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "edited": false, "score": 0, "creation_date": 1511373020, "post_id": 47436522, "comment_id": 81836961, "body": "Thank you for help! I think I will use your solution)"}], "tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": true, "score": 0, "last_activity_date": 1511361548, "last_edit_date": 1511361548, "creation_date": 1511359007, "answer_id": 47436522, "question_id": 47435950, "link": "https://stackoverflow.com/questions/47435950/saveas-inside-beforesave-excel-vba/47436522#47436522", "title": "SaveAs inside BeforeSave (Excel, VBA)", "body": "<p>Edit: I found the reason. <code>SaveAs</code> will close the original workbook without saving, and open the new one automatically. Therefore excel can't execute the origin saving script.</p>\n\n<p>Instead, using <code>SaveCopyAs</code> could build a copy in background, thus the origin file is still alive in your window.</p>\n\n<p>Try this:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    ActiveWorkbook.SaveCopyAs Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; \"BackUp_\" &amp; Format(Date, \"YYYYMMDD\") &amp; \"_\" &amp; ActiveWorkbook.Name\nEnd Sub\n</code></pre>\n\n<p>Note: Calling <code>Date</code> directly could be like <code>2017/11/22</code> which contains <code>/</code> ,which is an invalid character, using a <code>Format</code> function can prevent an error.</p>\n"}], "owner": {"reputation": 49, "user_id": 4413217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100002791465286/picture?type=large", "display_name": "Oleksandr  Titorchuk", "link": "https://stackoverflow.com/users/4413217/oleksandr-titorchuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 47436522, "answer_count": 1, "score": 1, "last_activity_date": 1511361548, "creation_date": 1511357284, "last_edit_date": 1511357927, "question_id": 47435950, "link": "https://stackoverflow.com/questions/47435950/saveas-inside-beforesave-excel-vba", "title": "SaveAs inside BeforeSave (Excel, VBA)", "body": "<p>I want to program Excel to create back-up of my file before saving it.</p>\n\n<p>But each time I am trying to use it, Excel crashes.</p>\n\n<p>Can please some explain me why this happens even if I insert <code>Application.EnableEvents = False</code> to prevent infinite loop?</p>\n\n<p>The code I am using is below:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Application.EnableEvents = False\n    ActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; \"BackUp_\" &amp; Date &amp; \"_\" &amp; ActiveWorkbook.Name, FileFormat:=52\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for help!</p>\n"}, {"tags": ["vba", "autocad"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1511365214, "last_edit_date": 1511365214, "creation_date": 1511357734, "answer_id": 47436098, "question_id": 47435510, "link": "https://stackoverflow.com/questions/47435510/convert-dwg-to-pdf-on-autocad/47436098#47436098", "title": "Convert dwg to pdf on AutoCAD", "body": "<p>That last line should be a subroutine call, not a function call... it should look like this</p>\n\n<pre><code>ThisDrawing.Plot.PlotToFile plotFileName\n</code></pre>\n\n<p>You do not need the <code>result</code> variable. </p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1511361065, "post_id": 47436504, "comment_id": 81828658, "body": "Thanks but this gives me an &quot;invalid input&quot; error on line 4 of the code.<code>ThisDrawing.ActiveLayout.ConfigName = &quot;PDFCreator&quot;</code>"}, {"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "reply_to_user": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1511362392, "post_id": 47436504, "comment_id": 81829650, "body": "PDFCreator is the external application. Virtual PDF Plotter. I suppose You don&#39; have installed it. so You should use some other PDF plotter or &quot;pc3&quot; configuration file."}, {"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "reply_to_user": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 1, "creation_date": 1511439155, "post_id": 47436504, "comment_id": 81864871, "body": "In AutoCAD You have few build-in drivers to save to PDF like   &quot;DWG To PDF.pc3&quot;  &quot;AutoCad PDF (General Documentation).pc3&quot;  &quot;AutoCad PDF (High Quality Print).pc3&quot;  use one of them"}], "tags": [], "owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1511358943, "creation_date": 1511358943, "answer_id": 47436504, "question_id": 47435510, "link": "https://stackoverflow.com/questions/47435510/convert-dwg-to-pdf-on-autocad/47436504#47436504", "title": "Convert dwg to pdf on AutoCAD", "body": "<p>try this:</p>\n\n<pre><code>Public Sub VBAplot()\n    Dim currentplot As AcadPlot\n    Set currentplot = ThisDrawing.Plot\n\n    ThisDrawing.ActiveLayout.ConfigName = \"PDFCreator\" ' Your plot device.\n    ThisDrawing.ActiveLayout.CanonicalMediaName = \"A4\"\n\n    ThisDrawing.ActiveLayout.StandardScale = acScaleToFit\n    ThisDrawing.Application.ZoomExtents\n    currentplot.PlotToDevice\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1876, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511365214, "creation_date": 1511355961, "last_edit_date": 1511358124, "question_id": 47435510, "link": "https://stackoverflow.com/questions/47435510/convert-dwg-to-pdf-on-autocad", "title": "Convert dwg to pdf on AutoCAD", "body": "<p>Hi how can I Plot to Pdf my AutoCAD drawing using VBA? I Tried </p>\n\n<pre><code>Sub PlotToPdf()\nThisDrawing.ActiveLayout.ConfigName = \"DWF6 ePlot.pc3\"\nDim plotFileName As String\nplotFileName = \"Z:\\USERS\\KweziM\\PROJECT S\\MyPlot.pdf\"\n\nDim result As Boolean\n\nresult = ThisDrawing.Plot.PlotToFile(plotFileName)\nEnd Sub\n</code></pre>\n\n<p>But this does not work.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511356205, "post_id": 47435358, "comment_id": 81825231, "body": "Start with <code>For i = 2 to 79</code> , then use <code>Range(&quot;D&quot; &amp; i).Copy</code>, and so on..."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511356381, "post_id": 47435358, "comment_id": 81825357, "body": "In my opinion, assigning the value to another cell directly would be better than copy and paste."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 1, "last_activity_date": 1511355814, "creation_date": 1511355814, "answer_id": 47435454, "question_id": 47435358, "link": "https://stackoverflow.com/questions/47435358/looping-a-macro-for-copy-pasting-then-printing/47435454#47435454", "title": "Looping a macro for copy &amp; pasting then printing", "body": "<p>I will not provide you the code, but will give you some hints to achieve your goal.</p>\n\n<pre><code>Sub Site_No()\n'\n' Start your loop here from D1 to D79. I suggest to use Cells(Row, Column) notation.\n   Range(\"D2\").Select 'There is no need to select the cell\n   Selection.Copy 'Instead of Copy, you can use .Value\n   Sheets(\"Spray Sheet\").Select 'There is no need to select the Sheet\n   Range(\"F5:J6\").Select 'There is no need to select the cell\n   ActiveSheet.Paste 'You don't need to paste the value.\n 'End loop here if you need to print only once.\n\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=False\nEnd Sub\n</code></pre>\n\n<p>You can see this question for an example to \"copy/paste\" cell content using <code>.Value</code>.</p>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/47419906/copy-paste-loop-through-worksheets-to-consolidate/47420016?noredirect=1#comment81796073_47420016\">Copy/Paste Loop through worksheets to consolidate</a></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8990173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8cffb1476dad114d24e93e79442d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Ashmole", "link": "https://stackoverflow.com/users/8990173/oliver-ashmole"}, "edited": false, "score": 1, "creation_date": 1511356132, "post_id": 47435456, "comment_id": 81825198, "body": "Thank you guy&#39;s I appreciate the feedback / help"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 8990173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8cffb1476dad114d24e93e79442d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Ashmole", "link": "https://stackoverflow.com/users/8990173/oliver-ashmole"}, "edited": false, "score": 0, "creation_date": 1511357921, "post_id": 47435456, "comment_id": 81826465, "body": "@OliverAshmole - welcome. You may consider accepting an answer - <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1511355821, "creation_date": 1511355821, "answer_id": 47435456, "question_id": 47435358, "link": "https://stackoverflow.com/questions/47435358/looping-a-macro-for-copy-pasting-then-printing/47435456#47435456", "title": "Looping a macro for copy &amp; pasting then printing", "body": "<p>Something like this should be enough:</p>\n\n<pre><code>Public Sub TestMe()    \n    Dim lngRow      As Long        \n    For lngRow = 2 To 79\n        ActiveSheet.Cells(lngRow, \"D\") = Worksheets(\"Spray Sheet\").Cells(lngRow, \"F\")\n    Next lngRow    \nEnd Sub\n</code></pre>\n\n<p>Using <code>select</code> and <code>activate</code> is something that you should try to avoid as much as possible - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> (said by the guy who used <code>ActiveSheet</code> in his code).</p>\n"}], "owner": {"reputation": 1, "user_id": 8990173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8cffb1476dad114d24e93e79442d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Ashmole", "link": "https://stackoverflow.com/users/8990173/oliver-ashmole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511357748, "creation_date": 1511355466, "last_edit_date": 1511357748, "question_id": 47435358, "link": "https://stackoverflow.com/questions/47435358/looping-a-macro-for-copy-pasting-then-printing", "title": "Looping a macro for copy &amp; pasting then printing", "body": "<p>I need to create a loop for this macro:</p>\n\n<pre><code>Sub Site_No()\n'   Site_No Macro\n'   Keyboard Shortcut: Ctrl+Shift+J\n\n    Range(\"D2\").Select\n    Selection.Copy\n    Sheets(\"Spray Sheet\").Select\n    Range(\"F5:J6\").Select\n    ActiveSheet.Paste\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n        IgnorePrintAreas:=False\nEnd Sub\n</code></pre>\n\n<p>Ideally I'd like to loop it through from D2 - D79.</p>\n\n<p>If someone could show me where to place the loop i'd be very grateful</p>\n\n<p>Ollie</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1511358582, "post_id": 47435223, "comment_id": 81826932, "body": "would decreasing the font size help"}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1511360376, "post_id": 47435223, "comment_id": 81828166, "body": "Margins cannot be set for a particular selection. Instead, you can add a section break before and after the page in question, and change the page setup for the particular section. This way, the rest of the document would not be affected."}, {"owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "reply_to_user": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1511360980, "post_id": 47435223, "comment_id": 81828599, "body": "Can you give me a hint on how to move cursor to the specific section? Would work if I look for the specific bookmark in that section using this Selection.GoTo What:=wdGoToField, Name:=&quot;bmTable&quot; @Arul"}, {"owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "reply_to_user": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1511361351, "post_id": 47435223, "comment_id": 81828882, "body": "won&#39;t help @ApurvPawar"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1511362573, "post_id": 47435223, "comment_id": 81829796, "body": "Have you tried setting the table indent to a negative value? <code>.Tables(1).Rows.SetLeftIndent LeftIndent:=-50, RulerStyle:=wdAdjustNone</code>"}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 1, "creation_date": 1511415320, "post_id": 47435223, "comment_id": 81851457, "body": "@BogdanSorin, you can use <code>Selection.GoTo What:=wdGoToBookmark, Name:=&quot;YourBookmark&quot;</code> to go to the specific bookmark."}, {"owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "reply_to_user": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1511434424, "post_id": 47435223, "comment_id": 81862056, "body": "Tried what you said with sections, added new section and applied settings for that section. Now I encounter another problem. When I execute the macro I&#39;m getting this error 4198-Command failed. First a save file dialog pops than I&#39;m getting a message box with that error. @Arul"}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1511435484, "post_id": 47435223, "comment_id": 81862698, "body": "@BogdanSorin, at which line are you getting the error. Also, can you post the relevant code."}, {"owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "reply_to_user": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1511445409, "post_id": 47435223, "comment_id": 81868831, "body": "<code>Doc.ActiveWindow.View.SeekView = wdSeekFirstPageHeader</code>. this is the line where I&#39;m getting the error. @Arul"}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1511454978, "post_id": 47435223, "comment_id": 81874563, "body": "I&#39;m sorry @Bogdan. I don&#39;t think I can try without seeing your full code."}], "owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511375554, "creation_date": 1511355044, "last_edit_date": 1511375554, "question_id": 47435223, "link": "https://stackoverflow.com/questions/47435223/how-can-you-move-margins-to-a-single-word-page-with-visual-basic-application-7-1", "title": "How can you move margins to a single word page with Visual basic application 7.1?", "body": "<p>I have a <code>word document</code> with a <code>bookmark</code> where I have to load a table of contents.\nWhen running a <code>VBA macro(Microsoft visual basic for aplications 7.1)</code> and trying to load the table in the <code>bookmark</code> he stretches on a second page being too large. \nI need to change the margins of the page with the <code>bookmark</code>, not to the entire document, so the table fits in only one page.\nI've tried to select the <code>bookmark</code> text and then apply the changes to the selection, but it applies to the whole document.</p>\n\n<p>Here is the code I tried:</p>\n\n<pre><code> ActiveDocument.Bookmarks.Item(\"bmTable\").Select\n        With Selection.PageSetup\n            .TopMargin = CentimetersToPoints(-1)\n            .BottomMargin = CentimetersToPoints(0)\n            .RightMargin = CentimetersToPoints(1.5)\n            .HeaderDistance = CentimetersToPoints(0.5)\n        End With\n    End If\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "graph", "pane"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8989480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfbf5354a9a99b8f03b2b268f8da4bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Guray Guner", "link": "https://stackoverflow.com/users/8989480/guray-guner"}, "edited": false, "score": 0, "creation_date": 1511961931, "post_id": 47434533, "comment_id": 82064417, "body": "Thank you @Alok for quick reply.  I have seen the link you mentioned, but I could not get this code to work. It gives this error message: &quot;Method &#39;visible&#39; of object &#39;toolbar&#39; failed.&quot;  Also, I tried other methods mentioned in the link with no success. User JDido mentioned that the code <code>application.CommandBars(140).Enabled=True</code> worked for him/her but I was not able to get a result."}], "tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1511353038, "creation_date": 1511353038, "answer_id": 47434533, "question_id": 47434143, "link": "https://stackoverflow.com/questions/47434143/excel-graph-format-pane-missing/47434533#47434533", "title": "Excel graph format pane missing", "body": "<p>This should help you:\nCredits to Michael Fowler from Expert Exchange\nHere's the <a href=\"https://www.experts-exchange.com/questions/28608804/Formatting-window-menu-missing-in-Excel-2013.html#a40587626\" rel=\"nofollow noreferrer\">link</a>  </p>\n\n<pre><code>Sub ShowAllToolbars()\n       'loop variable\n       Dim i As Integer\n\n       ' Loop through the total number of toolbars.\n       For i = 1 To Application.Toolbars.Count\n\n           ' Show each toolbar.\n           Application.Toolbars(i).Visible = True\nApplication.CommandBars(140).Enabled=True\n       ' End of loop.\n       Next i\n\n   End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8989480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfbf5354a9a99b8f03b2b268f8da4bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Guray Guner", "link": "https://stackoverflow.com/users/8989480/guray-guner"}, "is_accepted": true, "score": 0, "last_activity_date": 1516876938, "creation_date": 1516876938, "answer_id": 48440917, "question_id": 47434143, "link": "https://stackoverflow.com/questions/47434143/excel-graph-format-pane-missing/48440917#48440917", "title": "Excel graph format pane missing", "body": "<p>I have finally solved  it.</p>\n\n<p>First, I have listed all the names of CommandBars in a sheet using the code below:</p>\n\n<pre><code>Dim i As Integer\nDim bar As CommandBar\ni = 0\n\nFor Each bar In Application.CommandBars\n  i = i + 1\n  Sheets(\"Sheet1\").Cells(i, 1) = bar.Name    \nNext\n</code></pre>\n\n<p>This was not necessary, I just wanted to learn the names of CommandBars.</p>\n\n<p>After some trial and error, I have found out that the code below does the job:</p>\n\n<pre><code>Application.CommandBars(\"Format Object\").Enabled = True\n</code></pre>\n\n<p>The code from the previous answer</p>\n\n<pre><code>Application.CommandBars(140).Enabled=True\n</code></pre>\n\n<p>probably does the same thing but I could not make it work.</p>\n"}], "owner": {"reputation": 1, "user_id": 8989480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfbf5354a9a99b8f03b2b268f8da4bfe?s=128&d=identicon&r=PG&f=1", "display_name": "Guray Guner", "link": "https://stackoverflow.com/users/8989480/guray-guner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 48440917, "answer_count": 2, "score": 0, "last_activity_date": 1516876938, "creation_date": 1511351863, "question_id": 47434143, "link": "https://stackoverflow.com/questions/47434143/excel-graph-format-pane-missing", "title": "Excel graph format pane missing", "body": "<p>Some time ago, I opened an old excel file with a macro. Then I lost many functionalities of excel, like context menus, pivot table field lists pane etc. I've solved many of them with vba codes, but I have not been able to solve this one yet:</p>\n\n<p>I cannot open graph format panes (the ones that appear on the right when you right click a chart element \"xxx\" and click format \"xxx\" ...).</p>\n\n<p>I've already tried excel options and found no solution there. Also, in my previous research to get context menus back, I've found a solution using vba codes. Therefore, I guess this will have a similar solution. The problem is that I could not find the right vba class, method or function to solve this.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "edited": false, "score": 2, "creation_date": 1511351676, "post_id": 47433944, "comment_id": 81822271, "body": "You are not closing the quote in <code>= &#39;&quot; &amp; [Forms!frm_Advisors_Stats-manager].[Position]</code> . Should be <code>= &#39;&quot; &amp; [Forms!frm_Advisors_Stats-manager].[Position] &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 2382, "user_id": 1682881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pqUuG.jpg?s=128&g=1", "display_name": "Flakes", "link": "https://stackoverflow.com/users/1682881/flakes"}, "edited": false, "score": 0, "creation_date": 1511351840, "post_id": 47433944, "comment_id": 81822389, "body": "Yeah I noticed that after I posted, I have closed it off but getting the same error"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1511352089, "post_id": 47434181, "comment_id": 81822548, "body": "Thank you - This has thrown out another error: Application-defined or object-defined error"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1511352164, "post_id": 47434181, "comment_id": 81822598, "body": "That sounds like you&#39;re either misspelling the form or form control name, or the form is not open."}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1511356601, "post_id": 47434181, "comment_id": 81825523, "body": "Just before the code runs I have this line:         DoCmd.OpenForm &quot;frm_Advisors_Stats-manager&quot;, acNormal  The code is also in a module would this impact it"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1511356658, "post_id": 47434181, "comment_id": 81825555, "body": "That doesn&#39;t prove you&#39;re not misspelling the form control name, but wouldn&#39;t influence it."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1511351969, "creation_date": 1511351969, "answer_id": 47434181, "question_id": 47433944, "link": "https://stackoverflow.com/questions/47433944/sql-getting-name-from-userform/47434181#47434181", "title": "SQL getting name from userform", "body": "<p>Since you're using string concatenation, your object notation needs to be valid for VBA. Since your object name contains a hyphen, you need to properly refer to it using the forms collection and without the bang operator.</p>\n\n<pre><code>\"WHERE [user] = '\" &amp; Forms(\"frm_Advisors_Stats-manager\").Position.Value &amp; \"'\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1511352069, "creation_date": 1511352069, "answer_id": 47434208, "question_id": 47433944, "link": "https://stackoverflow.com/questions/47433944/sql-getting-name-from-userform/47434208#47434208", "title": "SQL getting name from userform", "body": "<p>Or use correct bracketing:</p>\n\n<pre><code>[Forms]![frm_Advisors_Stats-manager]![Position]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511439208, "creation_date": 1511439208, "answer_id": 47455344, "question_id": 47433944, "link": "https://stackoverflow.com/questions/47433944/sql-getting-name-from-userform/47455344#47455344", "title": "SQL getting name from userform", "body": "<p>Another way to reference a control on a form that I used a lot is:</p>\n\n<pre><code>Form_Advisors_Stats-manager.Position\n</code></pre>\n\n<p>Therefore: </p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO _tbl_Structure \" &amp; _\n        \"SELECT * \" &amp; _\n        \"FROM [MS Access;pwd=\" &amp; strPassword &amp; \";database=\" &amp; DBpath &amp; \"\\\" &amp; DBname &amp; \"].[\" &amp; tblStructure &amp; \"] \" &amp; _\n        \"WHERE [user] = '\" &amp; Form_Advisors_Stats-manager.Position &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 47434208, "answer_count": 3, "score": 0, "last_activity_date": 1511439208, "creation_date": 1511351268, "question_id": 47433944, "link": "https://stackoverflow.com/questions/47433944/sql-getting-name-from-userform", "title": "SQL getting name from userform", "body": "<p>I am having a little trouble with my SQL in access</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO _tbl_Structure \" &amp; _\n            \"SELECT * \" &amp; _\n            \"FROM [MS Access;pwd=\" &amp; strPassword &amp; \";database=\" &amp; DBpath &amp; \"\\\" &amp; DBname &amp; \"].[\" &amp; tblStructure &amp; \"] \" &amp; _\n            \"WHERE [user] = '\" &amp; [Forms!frm_Advisors_Stats-manager].[Position]\n</code></pre>\n\n<p>The issue appears to be with</p>\n\n<blockquote>\n  <p>[Forms!frm_Advisors_Stats-manager].[Position]</p>\n</blockquote>\n\n<p>Any help on what I am doing wrong here? </p>\n\n<p>The position textbox shows if the person logged in is a manager or not. If they are a manager as stated on the userform is pulls all records the manager has on the team</p>\n\n<p>The error shown is:</p>\n\n<blockquote>\n  <p>External name not defined</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1511365413, "post_id": 47433374, "comment_id": 81831986, "body": "You need to get into the habit of naming your variables something meaningful. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1511350741, "creation_date": 1511350741, "answer_id": 47433767, "question_id": 47433374, "link": "https://stackoverflow.com/questions/47433374/why-is-my-macro-not-scraping-as-expected/47433767#47433767", "title": "Why is my macro not scraping as expected?", "body": "<p>You don't need application.wait in this loop;</p>\n\n<pre><code>Do While appIE.busy\n    DoEvents\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\nLoop\n</code></pre>\n\n<p>It will wait until site is fully loaded. As about your question, I guess that the website fires some scripts when your macro is doing the job. You can either add Do While appIE.busy Loop between your 'For Each entry' loop or just something  Application.Wait (Now + TimeValue(\"0:00:05\")). </p>\n"}, {"tags": [], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "is_accepted": false, "score": 0, "last_activity_date": 1511353786, "creation_date": 1511353786, "answer_id": 47434771, "question_id": 47433374, "link": "https://stackoverflow.com/questions/47433374/why-is-my-macro-not-scraping-as-expected/47434771#47434771", "title": "Why is my macro not scraping as expected?", "body": "<p>After much experimentation I found that putting:-\nApplication.Wait (Now + TimeValue(\"0:00:05\")) before the For each entry sorted the problem out1</p>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511365273, "creation_date": 1511349508, "last_edit_date": 1511365273, "question_id": 47433374, "link": "https://stackoverflow.com/questions/47433374/why-is-my-macro-not-scraping-as-expected", "title": "Why is my macro not scraping as expected?", "body": "<p>I am using the macro below to scrape a site. When I run through the macro using F8 it works fine but when I run it normally it skips out scraping the information at these lines:-</p>\n\n<pre><code>            Cells(r, 1).Value = entry.getAttribute(\"data-vehiclegroup\")\n           Cells(r, 2).Value = entry.getAttribute(\"data-vehicletransmission\")\n           Cells(r, 3).Value = entry.getAttribute(\"data-vehicletitle\")\n           Cells(r, 4).Value = entry.getAttribute(\"datstandardwaiverratefee\")\n           Cells(r, 5).Value = entry.getAttribute(\"data-superwaiverratefee\")\n           r = r + 1\n</code></pre>\n\n<p>The macro skips scraping the information when i = 1, 3 and 5. I do not understand why it is doing this or how to fix it. Any help would be appreciated.</p>\n\n<pre><code> Sub car()\n\n\n        Dim appIE As Object\n        Dim e As Object\n        Dim ws As Worksheet\n        Dim wb As Workbook\n        Dim o\n        Dim a As String\n        Dim b As String\n        Dim c As String\n        Dim d As String\n        Dim PickUp As Object\n        Dim iL As IHTMLElement\n        Dim f As IHTMLElementCollection\n        Dim post As Object\n        Dim Ret As Object\n        Dim entry As Object\n        Dim l As Object\n\n\n    r = 2\n\n        Set wb = Application.Workbooks(\"car3\")\n        Set ws = wb.Worksheets(\"Sheet1\")\n    'Open internet explorer\n    Set appIE = CreateObject(\"internetexplorer.application\")\n\n\n    'Navigate to site\n    With appIE\n    .Navigate \"https://www.car.co.za\"\n    .Visible = True\n\n    Do While appIE.busy\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:03\"))\n        Loop\n\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n      For i = 1 To 6\n\n\n        With ws\n    a = .Cells(i, 8)\n    d = .Cells(i, 9)\n    b = .Cells(i, 10)\n    c = .Cells(i, 11)\n    End With\n\n       Do While appIE.busy And e Is Nothing\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:01\"))\n        Loop\n\n     Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n    Set e = appIE.document.getElementById(\"PickupBranch_BranchID_id\")\n      For Each o In e.Options\n        If o.Value = a Then\n            o.Selected = True\n            Exit For\n        End If\n    Next\n\n    Do While appIE.busy And e Is Nothing\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:01\"))\n        Loop\n\n\n    Set e = appIE.document.getElementById(\"ReturnBranch_BranchID_id\")\n\n\n    For Each o In e.Options\n\n        If o.Value = d Then\n            o.Selected = True\n            Exit For\n        End If\n    Next\n\n    Do While appIE.busy And f Is Nothing\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:02\"))\n        Loop\n\n\n    Set f = appIE.document.getElementById(\"timepicker-pickup\").getElementsByTagName(\"li\")\n\n    For Each iL In f\n      If iL.innerText = \"09\" Then\n      iL.Click\n      Exit For\n      End If\n    Next iL\n\n    Do While appIE.busy And post Is Nothing\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:02\"))\n        Loop\n\n    Set post = appIE.document.getElementsByName(\"PickupDate\")\n\n    'Looping through multiple values:\n    For Each post In appIE.document.getElementsByName(\"PickupDate\")\n    post.Value = b\n    Next post\n\n    Do While appIE.busy And Ret Is Nothing\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:02\"))\n        Loop\n\n    Set Ret = appIE.document.getElementsByName(\"ReturnDate\")\n\n    'Looping through multiple values:\n    For Each Ret In appIE.document.getElementsByName(\"ReturnDate\")\n    Ret.Value = c\n    Next Ret\n\n    'Clicking Book now button\n    Do While appIE.busy And l Is Nothing\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:04\"))\n        Loop\n\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n    For Each l In appIE.document.getElementsByClassName(\"btn search-btn\")\n    If l.className = \"btn search-btn\" Then\n            l.Click\n            Exit For\n        End If\n        Next\n\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n        On Error Resume Next\n        Do While appIE.busy And entry Is Nothing\n        Application.Wait (Now + TimeValue(\"0:00:05\"))\n        DoEvents\n        Loop\n      'Scraping information\n\n\n\n    For Each entry In appIE.document.getElementsByClassName(\"filtered-vehicles\")(0).getElementsByClassName(\"vehicle box-shadow-dark-2\")\n\n\n        Cells(r, 6).Value = i\n        Cells(r, 1).Value = entry.getAttribute(\"data-vehiclegroup\")\n       Cells(r, 2).Value = entry.getAttribute(\"data-vehicletransmission\")\n       Cells(r, 3).Value = entry.getAttribute(\"data-vehicletitle\")\n       Cells(r, 4).Value = entry.getAttribute(\"data-standardwaiverratefee\")\n       Cells(r, 5).Value = entry.getAttribute(\"data-superwaiverratefee\")\n       r = r + 1\n\n    Next entry\n\n    .Navigate \"https://www.car.co.za\"\n    .Visible = True\n\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n    Do While appIE.busy\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:03\"))\n        Loop\n\n\n\n    r = r + 2\n\n\n    Next i\n\n    End With\n\n    appIE.Quit\n        Set appIE = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1511350790, "post_id": 47433378, "comment_id": 81821713, "body": "Never used the Inspector, however, you could code some things for compatibility with each version like: <code>#If VBA7 Then : Declare PtrSafe Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As LongPtr) : #Else : Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long) : #End If</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1511351652, "post_id": 47433378, "comment_id": 81822258, "body": "It might be just my opinion but: Saying &quot;<i>\u2026 make the whole Office (including Word) really slow/buggy on 2016 64bit, although the code does not chrash or lead to unexpected errors.</i>&quot; might be too general and broad to answer. What <b>exactly is</b> slow and buggy if there are no errors? I mean this would be hard to debug without seeing the code and not knowing what your AddIn does. Therfore you should already have an idea where in the code your issue is to ask a proper question here. Otherwise I see no chance that this question can be answered. (And I personally won&#39;t thrust the inspector.)"}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1511352020, "post_id": 47433378, "comment_id": 81822505, "body": "@danieltakeshi, I only uses one <code>Declare statement</code> (<code>Public Declare PtrSafe Function URLDownloadToFile Lib &quot;urlmon&quot; Alias &quot;URLDownloadToFileA&quot; (...)</code>), which is already PtrSafe according to this page <a href=\"http://www.jkp-ads.com/articles/apideclarations.asp\" rel=\"nofollow noreferrer\">this page</a>. The inspector find no problem with this declaration so my question was about the 724 other errors detected by the inspecor. I&#39;ll have a look anyway since this should be the only difference between 32 and 64bit and since looking at <a href=\"https://msdn.microsoft.com/en-us/library/ms775123(v=vs.85).aspx\" rel=\"nofollow noreferrer\">this page</a>, I have some doubts."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1511352356, "post_id": 47433378, "comment_id": 81822726, "body": "@danieltakeshi, + according to the answer to <a href=\"https://stackoverflow.com/questions/35336118/convert-code-for-32-bit-to-64-bit\">this question</a>, the <code>Long</code> pointers should have been transformed to <code>LongPtr</code>."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511352828, "post_id": 47433378, "comment_id": 81823007, "body": "@Peh. Any action in Word or Excel (having a Menu or Windows show up, running any Sub...) is slow or won&#39;t render at all. &quot;<i>Therfore you should already have an idea where in the code your issue is to ask a proper question here</i>&quot; : You realise this is exactly what I&#39;m trying when I&#39;m installing Windows &quot;code Inspector&quot; ? How could I possibly do so if I don&#39;t get any errors."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1511355329, "post_id": 47433378, "comment_id": 81824625, "body": "@tibo As I said if we even don&#39;t know what your code does, it&#39;s even hard to say anything about where the issue <b>could</b> be. An approach to locate the issues can be to remove not necessarily needed code parts from the AddIn and see if the error is still there. This way you find out if the issue is in the removed code part or in the code part you kept active. So hopefully you will come up with a smaller part of code then in which the issue must be. Locating such an issue can be really cumbersome so I always start narrowing down the issue to some code we finally can test and debug."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511385072, "post_id": 47433378, "comment_id": 81842980, "body": "@Peh, sure. That&#39;s why my post is actually about the inspector and not about my code. Debugging is all the more difficult when the problem appear randomly, on a single PC (the only on running 16.0 64 bit), won&#39;t show up for a whole day and is not VBA raising an error but Office have &quot;performance&quot; issue  (menu won&#39;t show up, screen will freeze, VBA will be very slow)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511426151, "post_id": 47433378, "comment_id": 81856544, "body": "@Tibo I doubt the inspector will solve your problem. Nor can anyone say if the inspector result is correct or not because we can&#39;t proof it on the code. Therefore I won&#39;t trust the inspector. You can now keep repeating yourself or start answering some of the points I mentioned in my comments above. But just in case I have some more points due to your last comment: If you say &quot;randomly&quot; means that it doesn&#39;t slow down every time? If this is the only PC you tested it on, Setup another (eg. a virtual box) to ensure it is your VBA and not a PC-Setup issue (I won&#39;t trust the result of a single PC)."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511455491, "post_id": 47433378, "comment_id": 81874814, "body": "@Peh, I had a PC installed today with Excel 2016 64bit. I tried on another one with Excel 2013 64bit and was unable to reproduce the problem. I went back on the PC (2016 64bit) when problems happens, tried anything possible to have the macro crash, with no luck. Went back to work, and 15 mins later, the user had Office bugging again. When I arrived, Task managers was showing <b>10 Excel process</b>, even after closing all Excel Windows and/or killing Excel from Task Manager. I think that&#39;s probably what makes Office unresponsive, but I don&#39;t understand why Excel opens so many instances..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511507823, "post_id": 47433378, "comment_id": 81890550, "body": "@tibo I don&#39;t know what your code does therefore I cannot help you."}], "owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511358223, "creation_date": 1511349488, "last_edit_date": 1511358223, "question_id": 47433378, "link": "https://stackoverflow.com/questions/47433378/vba-office-vba-compatibility-inspector-going-crazy", "title": "VBA : &#39;Office VBA Compatibility inspector&#39; going crazy?", "body": "<h2>Context</h2>\n\n<p>I have a <code>XLA AddIn</code> macro at work. It is use by 10+ people, thus on multiple PC and Excel versions :</p>\n\n<ul>\n<li>2010 / 2013 / 2016   (14.0 / 15.0 / 16.0)</li>\n<li>32bit / 64bit.</li>\n</ul>\n\n<p>The macro runs fine on 2010 / 2013 with 32bit, but make the whole Office (including Word) really slow/buggy on 2016 64bit, although the code does not chrash or lead to unexpected errors.</p>\n\n<h2>Where I'm lost</h2>\n\n<p>I thus had the <a href=\"https://technet.microsoft.com/en-us/library/ee833946(office.14).aspx\" rel=\"nofollow noreferrer\">Office Code Compatibility Inspector</a> installed and had it inspect my <code>XLA AddIn</code>. I'm very confused by the results :</p>\n\n<pre><code>Total lines scanned:        21788\nTotal items found:          724\nDeprecated items:           537\nRemoved items:          158\nChanged items:              29\nRedesigned items:           0\nDeclare statements:         0\nReferences Found:           0\n</code></pre>\n\n<p>That's a lot of found items, but what confused me is in the detailled report.</p>\n\n<p><strong>Example 1 :</strong></p>\n\n<pre><code>TYPE:       REMOVED\nITEM:       [mso]FileDialogFilter.Description\nURL:        http://go.microsoft.com/fwlink/?LinkID=215358\nCODE:       log_erreur \"prepare_onglet_donnees\", err.description, err.source\n</code></pre>\n\n<p>The inspector tell me that <code>[mso]FileDialogFilter.Description</code> was <code>removed</code>.\nThe problem is that the <code>Description</code> property  is not on a <code>FileDialogFilter</code> but an <code>err</code> object !</p>\n\n<p><strong>Example 2 :</strong></p>\n\n<pre><code>TYPE:       REMOVED\nITEM:       [mso]OfficeDataSourceObject.Columns\nURL:        http://go.microsoft.com/fwlink/?LinkID=215358\nCODE:       .columns(col_pcsid).cells.font.size = 10\n</code></pre>\n\n<p>Idem : the <code>Columns</code> object is not on a <code>OfficeDataSourceObject</code> but a <code>Sheet</code> object ! (since there is a <code>With wb_Donnees.Sheets(\"Donn\u00e9es\")</code> a few line above.</p>\n\n<p><strong>Example 3 :</strong></p>\n\n<pre><code>TYPE:       DEPRECATION\nITEM:       [mso]ChartFont.Bold\nURL:        http://go.microsoft.com/fwlink/?LinkID=215358\nCODE:       .cells(l, c).font.bold = true   \n</code></pre>\n\n<p>Idem : not <code>ChartFont</code> but <code>Cells</code>.</p>\n\n<p>And so on...</p>\n\n<h2>So... ? :</h2>\n\n<p>Do I not read the report correctly or is the Compatibility inspector going crazy ?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511346510, "post_id": 47432248, "comment_id": 81818807, "body": "I think the reason is that message window is not visible when you are triggering  <code>Sendkeys</code> action. Try to add 2-3 seconds waiting time just before that line."}, {"owner": {"reputation": 15, "user_id": 7758047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/513ae010d293f6fa98173ff1f9733a61?s=128&d=identicon&r=PG&f=1", "display_name": "Rouliente", "link": "https://stackoverflow.com/users/7758047/rouliente"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511347641, "post_id": 47432248, "comment_id": 81819613, "body": "Hello Jawor, yes i tried this before asking the question, i placed it after the .display, and after the End With too. That change nothing I have the same problem. Sometimes, the outlook is already open but the paste don&#39;t work"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511358385, "post_id": 47432248, "comment_id": 81826796, "body": "Never rely on <code>SendKeys</code> for anything. It is unreliable."}, {"owner": {"reputation": 15, "user_id": 7758047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/513ae010d293f6fa98173ff1f9733a61?s=128&d=identicon&r=PG&f=1", "display_name": "Rouliente", "link": "https://stackoverflow.com/users/7758047/rouliente"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511361038, "post_id": 47432248, "comment_id": 81828640, "body": "Hi @braX , yeah maybe this solution it&#39;s a little bit old ^^ What do you recommend to me ? I&#39;m on Outlook 2010"}], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": -1, "last_activity_date": 1511350250, "creation_date": 1511350250, "answer_id": 47433616, "question_id": 47432248, "link": "https://stackoverflow.com/questions/47432248/random-paste-in-my-outlook-object-with-a-copypicture/47433616#47433616", "title": "Random paste in my Outlook object with a CopyPicture", "body": "<p>Try using DoEvents after display</p>\n\n<pre><code>.Display\nDoEvents\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7758047, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/513ae010d293f6fa98173ff1f9733a61?s=128&d=identicon&r=PG&f=1", "display_name": "Rouliente", "link": "https://stackoverflow.com/users/7758047/rouliente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511350250, "creation_date": 1511346362, "question_id": 47432248, "link": "https://stackoverflow.com/questions/47432248/random-paste-in-my-outlook-object-with-a-copypicture", "title": "Random paste in my Outlook object with a CopyPicture", "body": "<p>I'm running everyday a script who send an email to many people, but i have a random issue on this script, there is two differents ways.</p>\n\n<p><strong>First</strong> : The picture is correctly pasted in my outlook object, so everything works fine.</p>\n\n<p><strong>Second</strong> : The picture is pasted in Excel and not Outlook, and the script is locked here, without error from the application.</p>\n\n<p>That's really disturbing because when it's me i relaunch and it's all ok, but if someone else want to do the manipulation and the bug appears, that's not good.</p>\n\n<p>I use CopyPicture and SendKeys \"^v\" to paste it in Outlook.</p>\n\n<p><strong>Here is my code :</strong></p>\n\n<pre><code>Dim OutApp As Object, OutMail As Object\nApplication.Wait Now + TimeValue(\"00:00:01\")\nIf colonne = 10 Then\nRange(\"A1:AA103\").CopyPicture xlScreen, xlBitmap\nElse\nRange(\"A1:AA97\").CopyPicture xlScreen, xlBitmap\nEnd If\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nWith OutMail\n            .To = \"\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"\"\n            .HTMLBody = \"\"\n\n  .display\n\nEnd With\nSendKeys \"^v\"\n</code></pre>\n\n<p>There is a HTMLBody and a Subject, but that's only text so i only put the important code here.</p>\n\n<p>I already looked every solution given before, but none respond to my random issue.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1511346227, "post_id": 47432145, "comment_id": 81818596, "body": "Great question. Just add where exactly do you receive the error."}, {"owner": {"reputation": 732, "user_id": 3025905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2fa2b33fcfe80d872becd5026ebb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "PankajKushwaha", "link": "https://stackoverflow.com/users/3025905/pankajkushwaha"}, "edited": false, "score": 0, "creation_date": 1511347786, "post_id": 47432145, "comment_id": 81819713, "body": "Change to Public Function ExtractParenthesis(strText As String) As object , while calling it do not forget to set it dim test1 as collections; set test1 = ExtractParenthesis(&quot;Test(and)tes&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1511513852, "post_id": 47432245, "comment_id": 81893489, "body": "I just want to add this worked by call it from another function/sub. Previously I was running it from the Immediate Window. Many thanks."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1511516285, "post_id": 47432245, "comment_id": 81894996, "body": "@BarryBlade - see the edit how to run it from the immediate window."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1511516273, "last_edit_date": 1511516273, "creation_date": 1511346360, "answer_id": 47432245, "question_id": 47432145, "link": "https://stackoverflow.com/questions/47432145/vba-run-time-error-450-from-function-returning-a-collection/47432245#47432245", "title": "VBA Run-time error 450 from function returning a collection", "body": "<p>It works exactly the way you want it for me:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim myColl  As New Collection\n\n    Set myColl = ExtractParenthesis(\"This {should} work. But {doesnt}.\")\n\n    Debug.Print myColl(1)\n    Debug.Print myColl(2)\n\nEnd Sub\n\nPublic Function ExtractParenthesis(strText As String) As Collection\n\n    Dim i As Long\n    Dim RegExp As Object\n    Dim Matches As Object\n    Dim Output As New Collection\n\n    Set Output = Nothing\n    Set RegExp = CreateObject(\"vbscript.regexp\")\n\n    RegExp.Pattern = \"{(.*?)}\"\n    RegExp.Global = True\n\n    Set Matches = RegExp.Execute(strText)\n\n    For i = 0 To (Matches.Count - 1)\n        Output.Add Matches(i).submatches(0)\n    Next i\n\n    Set ExtractParenthesis = Output\n\nEnd Function\n</code></pre>\n\n<p>I receive \"should\" and \"doesnt\" on the immediate window (<kbd>Ctrl</kbd>+<kbd>G</kbd>). Probably you are not aware that you are returning a collection. It should be used with the <code>Set</code> keyword.</p>\n\n<hr>\n\n<p>To run it from the immediate window, try like this:</p>\n\n<pre><code>?ExtractParenthesis(\"This {should} work. But {doesnt}.\")(1)\n?ExtractParenthesis(\"This {should} work. But {doesnt}.\")(2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1511513884, "post_id": 47433138, "comment_id": 81893507, "body": "Thanks Darren. Alas, no, I was trying to run it from another method but was calling it from the Immediate window whilst testing which seemed to screw things up."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1511348816, "creation_date": 1511348816, "answer_id": 47433138, "question_id": 47432145, "link": "https://stackoverflow.com/questions/47432145/vba-run-time-error-450-from-function-returning-a-collection/47433138#47433138", "title": "VBA Run-time error 450 from function returning a collection", "body": "<p>From what I understand of your comment to Vityatas answer you mean you want to run it as a worksheet function - <em>running it directly</em></p>\n\n<p>The changes I've made to your code will let you use it as a function:  </p>\n\n<p>In <code>A1:B1</code> this will work: <code>{=ExtractParenthesis(\"This {should} work. But {doesnt}.\")}</code><br>\nIn <code>A1:A2</code> use it like this: <code>{=TRANSPOSE(ExtractParenthesis(\"This {should} work. But {doesnt}.\"))}</code>  </p>\n\n<p><em>NB:</em> The curly brackets are added by Excel when you enter the formula using <em>Ctrl+Shift+Enter</em> rather than <em>Enter</em> on its own.  </p>\n\n<p>The one problem with the code is that you must select the correct number of cells first - if it should return three words, but you've only selected two then you'll only see the first two.</p>\n\n<pre><code>Public Function ExtractParenthesis(strText As String) As Variant\n\n    Dim i As Long\n    Dim RegExp As Object\n    Dim Matches As Object\n    Dim Output As Variant\n\n    Set Output = Nothing\n    Set RegExp = CreateObject(\"vbscript.regexp\")\n\n    RegExp.Pattern = \"{(.*?)}\"\n    RegExp.Global = True\n\n    Set Matches = RegExp.Execute(strText)\n\n    ReDim Output(1 To Matches.Count)\n    For i = 1 To (Matches.Count)\n        Output(i) = Matches(i - 1).submatches(0)\n    Next i\n\n    ExtractParenthesis = Output\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 47432245, "answer_count": 2, "score": 1, "last_activity_date": 1511516273, "creation_date": 1511346099, "last_edit_date": 1511358425, "question_id": 47432145, "link": "https://stackoverflow.com/questions/47432145/vba-run-time-error-450-from-function-returning-a-collection", "title": "VBA Run-time error 450 from function returning a collection", "body": "<p><strong>Context:</strong> I am writing a function which returns words/numbers present in a string which are enclosed by parenthesis.</p>\n\n<p><strong>Example:</strong> Calling <code>ExtractParenthesis(\"This {should} work. But {doesnt}.\")</code> should return a collection containing two items, <code>should</code> and <code>doesnt</code>.</p>\n\n<p><strong>Error:</strong> The error I receive from the code below is </p>\n\n<blockquote>\n  <p>Run-time error '450': Wrong number of arguments or invalid property\n  assignment</p>\n</blockquote>\n\n<p>It doesn't appear on a particular line and I just receive an error message with \"OK\" and \"Help\" as options.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Public Function ExtractParenthesis(strText As String) As Collection\n\n    Dim i As Long\n    Dim RegExp As Object\n    Dim Matches As Object\n    Dim Output As New Collection\n\n    Set Output = Nothing\n    Set RegExp = CreateObject(\"vbscript.regexp\")\n\n    RegExp.Pattern = \"{(.*?)}\"\n    RegExp.Global = True\n\n    Set Matches = RegExp.Execute(strText)\n\n    For i = 0 To (Matches.count - 1)\n        Output.Add Matches(i).submatches(0)\n    Next i\n\n    Set ExtractParenthesis = Output\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "edited": false, "score": 0, "creation_date": 1511354774, "post_id": 47434169, "comment_id": 81824251, "body": "Appreciate that. That was what I was looking for - almost. For some reason it runs, if part of the other code is in another module. If I just run your code by itself I get a &quot;Compile Error&quot; (Sub or Function not defined) for the &quot;SetChartSizeAndPosition Shp, 30, 120, 320, 240&quot; line. Any idea why that is?"}, {"owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "edited": false, "score": 0, "creation_date": 1511355077, "post_id": 47434169, "comment_id": 81824455, "body": "Figured it out. Just need the define sub above of course. Sorry, and thanks for the great answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1511351934, "creation_date": 1511351934, "answer_id": 47434169, "question_id": 47431958, "link": "https://stackoverflow.com/questions/47431958/combining-two-pieces-of-vba-code-used-in-ppt/47434169#47434169", "title": "Combining two pieces of VBA code, used in PPT", "body": "<p>Try the <strong>Merged</strong> <code>Sub</code> below, explanation inside the code's comments.</p>\n\n<pre><code>Option Explicit\n\nSub ProcessAllSlides()\n\nDim sld As Slide\nDim Shp As Shape\nDim oCht As Chart\nDim i As Long\nDim ChartIndex As Long\n\n' set the Active Slide\nSet sld = Application.ActiveWindow.View.Slide\n\nChartIndex = 1\n\n' --- loop through the Slide shapes and search for the Shape of type chart\nFor i = 1 To sld.Shapes.Count\n    If sld.Shapes(i).HasChart = msoTrue Then  ' if current shape is a chart\n        Set Shp = sld.Shapes(i)\n        Set oCht = Shp.Chart\n\n        If ChartIndex = 1 Then ' first chart\n            SetChartSizeAndPosition Shp, 30, 120, 320, 240\n            ChartIndex = ChartIndex + 1\n\n        ElseIf ChartIndex = 2 Then ' second chart\n            SetChartSizeAndPosition Shp, 370, 120, 320, 240\n        End If\n\n        With oCht.PlotArea\n            ' Edit these values as needed\n            ' Change the following lines to e.g. Msgbox .Left etc\n            ' to get the values of the chart you want to match others TO\n            .Left = 0\n            .Top = 0\n            .Height = 220\n            .Width = 300\n        End With\n\n        Set oCht = Nothing\n        Set Shp = Nothing\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 47434169, "answer_count": 1, "score": 1, "last_activity_date": 1511351984, "creation_date": 1511345600, "last_edit_date": 1511351984, "question_id": 47431958, "link": "https://stackoverflow.com/questions/47431958/combining-two-pieces-of-vba-code-used-in-ppt", "title": "Combining two pieces of VBA code, used in PPT", "body": "<p>I have found, corrected and tested to pieces of code for dealing with charts in Powerpoint. </p>\n\n<p>The first piece is make the plots the same size and position them correctly (assuming there are two plots on the slide) and goes like this:</p>\n\n<pre><code>Sub ProcessAllSlides()\n\nDim sld As Slide\nDim Shp As Shape\n\nFor Each sld In ActivePresentation.Slides\n    Call SetChartSizeAndPosition(sld.Shapes(1), 30, 120, 320, 240)\n    Call SetChartSizeAndPosition(sld.Shapes(2), 370, 120, 320, 240)\nNext\n\nEnd Sub\n\nSub SetChartSizeAndPosition(Shp As Shape, Left As Single, Top As Single, Width As Single, Height As Single)\n\nWith Shp\n    .Left = Left\n    .Top = Top\n    .Width = Width\n    .Height = Height\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This works on all slides in the presentation. I would like it to only function on the active slide.</p>\n\n<p>The second piece is supposed to format the plot area (and not the chart area). See below:</p>\n\n<pre><code>Sub SizePlotArea()\n\nDim oSld As Slide\nDim oCht As Chart\n\nSet oCht = ActiveWindow.Selection.ShapeRange(1).Chart\n\nWith oCht.PlotArea\n    ' Edit these values as needed\n    ' Change the following lines to e.g. Msgbox .Left etc\n    ' to get the values of the chart you want to match others TO\n    .Left = 0\n    .Top = 0\n    .Height = 220\n    .Width = 300\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Idealy I would like to combine the two such that they are done for all (two) charts on the active slide. </p>\n\n<p>Anyone with any tips?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 1, "creation_date": 1511455023, "post_id": 47431577, "comment_id": 81874582, "body": "Have you looked at <code>TLBINF32.DLL</code> yet?  I&#39;m not sure that its CHM Help download is available any more though, so &quot;you snooze you lose.&quot;"}, {"owner": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "edited": false, "score": 1, "creation_date": 1511456361, "post_id": 47431577, "comment_id": 81875289, "body": "What is the actual problem you&#39;re trying to solve? You want to &quot;determine at runtime whether those two objects implement the same interface&quot; but you also want to do it &quot;...without hard-coding the interfaces&#39; names&quot;. Those ideas are conflicting. You won&#39;t be able to know if your two object implement the same interface without hardcoding what the interface is."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "edited": false, "score": 0, "creation_date": 1511514352, "post_id": 47431577, "comment_id": 81893779, "body": "@PaoloGo I had a hunch that I might be asking the impossible. :D (As in the end, all classes seem to implement <code>IUnknown</code> for example, and possibly several more interfaces.) My problem was that I tried to adopt some code that contains a type-safe dictionary class. This dictonary was complaining when the LogManager tried to add a FileLogger, while it already contained a DebugLogger. As both loggers are only accessed via their common interface I thought it should be possible to detect that interface and allow them into that dictionary together."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "edited": false, "score": 0, "creation_date": 1511514567, "post_id": 47431577, "comment_id": 81893912, "body": "@PaoloGo I&#39;ve since worked around the issue by adding an <code>IgnoreTypeSafety</code> flag to the dict class, which is then enabled only in the instance used by the LogManager, as otherwise type safety seems to be useful to have."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1511514943, "post_id": 47431577, "comment_id": 81894136, "body": "@Bob77 I didn&#39;t know about <code>TLBINF32.DLL</code>. It also is not present on my system (due to the dll being only available in 32bit? Or maybe it was only shipped with old versions of Visual Studio?) From a brief research it doesn&#39;t seem clear to me whether the .dll would enable me to get information about types not formally registered (they are only existent in my project, not in a lib file or anything). If it does, that might be worth pursuing a little further. :)"}, {"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1511541790, "post_id": 47431577, "comment_id": 81909185, "body": "Don&#39;t use the [vb6] tag unless you are asking a VB6 question."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1511772323, "post_id": 47431577, "comment_id": 81969349, "body": "@Bob77 In my understanding my question is equally relevant to VBA and VB6. (I assumed an answer to my question would be applicable in both environments.) If this is not the case, please let me know - I&#39;ll then remove the VB6 label."}, {"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1511801860, "post_id": 47431577, "comment_id": 81988054, "body": "If you want an MS Office answer ask an MS Office question: don&#39;t add irrelevant tags or you&#39;ll get answers you can&#39;t use.  VBA is not VB but a subset used as a macro language.  The environments are completely different."}], "owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1511962993, "creation_date": 1511344656, "last_edit_date": 1511962993, "question_id": 47431577, "link": "https://stackoverflow.com/questions/47431577/obtaining-information-about-the-implemented-interface-of-a-class-at-runtime", "title": "Obtaining information about the implemented interface of a class at runtime", "body": "<p>How can I, for any two given objects, determine at runtime whether those two objects implement the same interface?</p>\n\n<p>Given an interface <code>IStackExchange</code> and the two classes <code>StackOverflow</code> and <code>CodeReviewSE</code> that both implement <code>IStackExchange</code>, I know I can do stuff like this:</p>\n\n<pre><code>Dim SO As IStackExchange\nDim CRSE As IStackExchange\nSet SO = New StackOverflow\nSet CRSE = New CodeReviewSE\n\nDebug.Print TypeName(SO)                    ' StackOverflow\nDebug.Print TypeOf SO Is IStackExchange     ' True\nDebug.Print TypeOf SO Is StackOverflow      ' True\nDebug.Print TypeOf SO Is CodeReviewSE       ' False\n\nDebug.Print TypeName(CRSE)                  ' CodeReviewSE\nDebug.Print TypeOf CRSE Is IStackExchange   ' True\nDebug.Print TypeOf CRSE Is StackOverflow    ' False\nDebug.Print TypeOf CRSE Is CodeReviewSE     ' True\n</code></pre>\n\n<p>So, if I know what interface to cast my objects to, I can verify they implement that specific interface. But VBA won't allow me to do things like <code>TypeOf SO Is TypeOf CRSE</code> or <code>Debug.Print TypeOf SO</code>. And <code>TypeName()</code> is not helpful when it comes to interfaces.</p>\n\n<p><strong>How can I obtain more information about an object's implemented interfaces without hard-coding the interfaces' names? Solutions involving additional libraries (as long as shipped with Windows >=7) are more than welcome.</strong></p>\n\n<hr>\n\n<p>I've seen <a href=\"https://stackoverflow.com/questions/36495738/when-are-two-objects-the-same-in-vba\">someone mention casting the objects to an <code>IUnknown</code> type</a>, but that only helps in determining whether two object variables internally reference the <em>same object</em> - it does not tell anything about the implemented interfaces.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1511355472, "post_id": 47431559, "comment_id": 81824739, "body": "That awkward moment when I realize why you have declared <code>Row</code> and <code>col</code> the way you have done it ... Been there, done that :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1511344926, "last_edit_date": 1511344926, "creation_date": 1511344594, "answer_id": 47431559, "question_id": 47431453, "link": "https://stackoverflow.com/questions/47431453/vba-loop-every-two-columns/47431559#47431559", "title": "VBA Loop every two columns", "body": "<p>Try <code>Step 2</code> in your <code>For</code> loop.</p>\n\n<pre><code>For i = 1 To Count Step 2\n    ActiveSheet.Range(\"Y\" &amp; i).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\nNext i\n</code></pre>\n\n<hr>\n\n<p>If you want to loop through columns, you need something like the code below:</p>\n\n<pre><code>Dim Row As Long\nDim col As Long\n\nFor col = 25 To Count Step 2\n     ActiveSheet.Cells(Row, col).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\nNext col\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1511344679, "creation_date": 1511344679, "answer_id": 47431586, "question_id": 47431453, "link": "https://stackoverflow.com/questions/47431453/vba-loop-every-two-columns/47431586#47431586", "title": "VBA Loop every two columns", "body": "<p>If you need to paste something in more than one column, try a nested loop, going through columns and rows:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim lngRow As Long\n    Dim lngCol As Long\n\n    For lngRow = 1 To 10\n        For lngCol = 25 To 29\n            With ActiveSheet\n                .Cells(lngRow, lngCol) = \"here we paste\"\n            End With\n        Next lngCol\n    Next lngRow\n\nEnd Sub\n</code></pre>\n\n<p>You would get something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kPrpm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kPrpm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1511344811, "creation_date": 1511344811, "answer_id": 47431645, "question_id": 47431453, "link": "https://stackoverflow.com/questions/47431453/vba-loop-every-two-columns/47431645#47431645", "title": "VBA Loop every two columns", "body": "<p>Switch to <code>Cells</code> rather than <code>Range</code> and add an outer loop with <code>Step 2</code>:</p>\n\n<pre><code>For j = 25 To 31 Step 2 ' Every other col from col Y to col ACC\n    For i = 1 To Count\n        ActiveSheet.Cells(i + 1, j).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Next i\nNext j\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1511345801, "creation_date": 1511345801, "answer_id": 47432044, "question_id": 47431453, "link": "https://stackoverflow.com/questions/47431453/vba-loop-every-two-columns/47432044#47432044", "title": "VBA Loop every two columns", "body": "<h1>You can skip every second column between <em>Y</em> and <em>AR</em> like this:</h1>\n\n<pre><code>Dim currCol As Integer, currRow As Integer\nrowsToLoop = 4\nFor currCol = Columns(\"Y\").Column To Columns(\"AR\").Column Step 2\n    For currRow = 1 To rowsToLoop \n        Debug.Print \"Current Cell: \" &amp; ActiveSheet.Cells(currRow + 1, currCol).Address\n        ActiveSheet.Cells(currRow + 1, currCol).PasteSpecial Paste:=xlPasteValues\n    Next currRow\nNext currCol\n</code></pre>\n\n<p>I gather you either manually or programmatically <strong>copy</strong> a cell or range before your code runs...  If you're doing it manually, note that there is a <code>Copy</code> range method.  For example to copy cell T5, you would use:</p>\n\n<pre><code>Range(\"T5\").Copy\n</code></pre>\n\n<p>Also note that I change the name of your variable for \"the number of rows to repeat\" from <code>Count</code> to <code>myCount</code> since <code>Count</code> is a reserved word and shouldn't be used as a variable name.</p>\n"}], "owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2571, "favorite_count": 0, "accepted_answer_id": 47431586, "answer_count": 4, "score": 1, "last_activity_date": 1511345801, "creation_date": 1511344302, "last_edit_date": 1531164843, "question_id": 47431453, "link": "https://stackoverflow.com/questions/47431453/vba-loop-every-two-columns", "title": "VBA Loop every two columns", "body": "<p>I have a fairly straight forward line of code which loops through the rows on a dataset. However I have realised that I am repeating this code within the loop 10 times because I need to do the same thing every other column.</p>\n\n<p>How can I loop through columns, so that this code works from Y to AA to AC columns etc rather than manually reapeating this for each column within the loop?</p>\n\n<pre><code>For i = 1 To Count\n    ActiveSheet.Range(\"Y\" &amp; i + 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 1, "creation_date": 1511343211, "post_id": 47430790, "comment_id": 81816656, "body": "It seems that this is the same as the previous question you asked, the path should be including the file name. However I&#39;m not familiar with sharepoint, not sure if this is the only problem."}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511343263, "post_id": 47430790, "comment_id": 81816679, "body": "Hi, I did included the file name this time <code>Call FileCopy(copyPath &amp; &quot;testing.xlsm&quot;, SharePointLib)</code> and I check the file does exist"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1511343338, "post_id": 47430790, "comment_id": 81816725, "body": "You are trying to copy to the SP URL, not to a folder. You either need to copy to the unc path of your SP&#39;s folder library like \\\\spserver\\lib\\files or use a SP Web service to upload the file"}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511343641, "post_id": 47430790, "comment_id": 81816923, "body": "The <code>SharePointLib</code> should include the filename, too."}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1511343685, "post_id": 47430790, "comment_id": 81816948, "body": "@LocEngineer Hi, I had update my question. Am I doing it wrngly? by copying the SP path from window explorer?"}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511343713, "post_id": 47430790, "comment_id": 81816962, "body": "@newacc2240 Hi, It does include the filename, just I did not show in the question"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1511344526, "post_id": 47430790, "comment_id": 81817494, "body": "You SP path in explorer is surely not <code>https:&#47;&#47;company.com&#47;sites&#47;</code>, is it? If it is mapped, it has a drive letter, let&#39;s say S:\\. Then you need to copy to `&quot;S:\\testing.xlsm&quot; - make sure to give a fuill path including filename as the copy destination."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1511344604, "post_id": 47430790, "comment_id": 81817550, "body": "@ChingChongPa &quot;<i>just I did not show in the question</i>&quot;: you should always keep your question up to date if you made changes so everybody can see the actual state."}, {"owner": {"reputation": 732, "user_id": 3025905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2fa2b33fcfe80d872becd5026ebb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "PankajKushwaha", "link": "https://stackoverflow.com/users/3025905/pankajkushwaha"}, "edited": false, "score": 0, "creation_date": 1511348094, "post_id": 47430790, "comment_id": 81819950, "body": "I had similar problem, Once I had to download attachments from outlook email and save it to One Drive folder, it won&#39;t let me do it. as once I put the file there it is not just pasted , it is synced."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1511361675, "post_id": 47430790, "comment_id": 81829122, "body": "I would use <code>ThisWorkbook</code>instead of <code>ActiveWorkbook</code>, to be safe"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1511361855, "post_id": 47430790, "comment_id": 81829254, "body": "your <code>copyPath</code> contains a double \\\\ in the middle"}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511395030, "post_id": 47430790, "comment_id": 81846573, "body": "@Peh, Hi sorry that was on purpose. However, the path format is the same, just the naming for the subfolders are different. @PatrickHonorez Thanks for the suggestion, I will change to <code>ThisWorkBook</code>. That double \\\\ was typo, I already double checked the codes."}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1511396569, "post_id": 47430790, "comment_id": 81846954, "body": "@LocEngineer I found <a href=\"https://www.youtube.com/watch?v=jpmQORJDy-U\" rel=\"nofollow noreferrer\">this regarding to mapping drive to sharepoint</a>. I think this is what you mean. I will change my path and try again"}], "answers": [{"tags": [], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "is_accepted": true, "score": 1, "last_activity_date": 1511398041, "creation_date": 1511398041, "answer_id": 47445978, "question_id": 47430790, "link": "https://stackoverflow.com/questions/47430790/vba-runtime-error-52/47445978#47445978", "title": "VBA - runtime error 52", "body": "<p>Holy moly, thanks for the help guys, @newacc2240 was right. I found out the problem after looking at this example. </p>\n\n<p><code>FileCopy \"C:\\Source\\test.txt\", \"C:\\Destination\\test.txt\"\n'Result: Copies file from \"C:\\Source\" to \"C:\\Destination\"</code></p>\n\n<p>So for my just need to add my file name to the <code>SharePointLib</code>. </p>\n\n<p>Previously I assumed that it would copy the file from the source to the destination with the file name attached, which cause me to stress up for hours.</p>\n"}], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5479, "favorite_count": 0, "accepted_answer_id": 47445978, "answer_count": 1, "score": 0, "last_activity_date": 1511398041, "creation_date": 1511342226, "last_edit_date": 1592644375, "question_id": 47430790, "link": "https://stackoverflow.com/questions/47430790/vba-runtime-error-52", "title": "VBA - runtime error 52", "body": "<p>I'm getting the error</p>\n<blockquote>\n<p>run time error 52, Bad file name or number</p>\n</blockquote>\n<p>while using <code>FileCopy</code> to copy local file to sharepoint.</p>\n<p>I follow the <a href=\"https://msdn.microsoft.com/en-us/library/aa231024(v=vs.60).aspx\" rel=\"nofollow noreferrer\">document from microsoft</a> and the file path and the file name several times but could find the error.</p>\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\n\nDim UploadToSharepoint As Boolean\n\nDim SharePointLib As String\nDim myPath As String\nDim folderPath As String\nDim objNet As Object\nDim FS As Object\nDim copyPath As String\nDim copyFilePath As String\n\nfolderPath = Application.ThisWorkbook.path\nmyPath = Application.ThisWorkbook.FullName\nMsgBox &quot;This is the folderPath&quot; &amp; folderPath 'C:\\Users\\username\\Desktop\nMsgBox &quot;This is the filepath&quot; + myPath 'C:\\Users\\username\\Desktop\\testing.xlsm\n\nSharePointLib = &quot;Z:\\Test Folder - New Format\\&quot;\ncopyPath = folderPath + &quot;\\copyPath\\&quot;\nMsgBox &quot;The copyPath is = &quot; &amp; copyPath 'C:\\Users\\username\\Desktop\\copyPath\\\n\nIf Not FolderExists(copyPath) Then\n    FolderCreate (copyPath)\nEnd If\n\nMsgBox &quot;The file will be uploaded to this address: &quot; + SharePointLib 'Z:\\Test Folder - New Format\\\n\nThisWorkbook.SaveCopyAs copyPath &amp; &quot;testing.xlsm&quot;\nCall FileCopy(copyPath &amp; &quot;testing.xlsm&quot;, SharePointLib)\n\nExit Sub\n\nloadFailed:\nUploadToSharepoint = False\n\nEnd Sub\n</code></pre>\n<p>I copy the path from window explorer after I map the drive to the SharePoint Site.</p>\n<p><a href=\"https://i.stack.imgur.com/0WkJF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0WkJF.png\" alt=\"drive\" /></a></p>\n<p><strong>Update</strong></p>\n<p>Map the drive and get the new Path <code>Z:\\Test Folder - New Format</code>, but still hit run time error 52</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1511342994, "post_id": 47430610, "comment_id": 81816503, "body": "in my opinion you are trying to delete file before it is in fact closed. Closing file and Excel app is a bit time consuming. Try to add any <code>Do...loop</code> waiting for few secs."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1511343266, "post_id": 47430610, "comment_id": 81816685, "body": "The code you posted terminates before you even get to to closing/deleting the file (<code>WScript.Quit</code>)."}, {"owner": {"reputation": 63, "user_id": 7591487, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10154042791992271/picture?type=large", "display_name": "Edwin Cheng", "link": "https://stackoverflow.com/users/7591487/edwin-cheng"}, "edited": false, "score": 0, "creation_date": 1511343887, "post_id": 47430610, "comment_id": 81817068, "body": "Hi Ansgar Wiechers: What does you means? Are you means delte WScript. Quit?"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1511357952, "post_id": 47430610, "comment_id": 81826489, "body": "Only if you want your code to actually close and delete the file."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1511360050, "post_id": 47430610, "comment_id": 81827919, "body": "The &quot;Permission Denied&quot; error must be <i>before</i> the line <code>WScript.Quit</code> -- hence it isn&#39;t the line that is trying to delete the Excel file which is triggering the error since that line is never actually encountered during runtime."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1511394154, "post_id": 47430610, "comment_id": 81846345, "body": "@AnsgarWiechers - Remember, this is <code>vbscript</code>. Not <code>VBA</code> so quitting Excel will not quit the script."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1511394162, "post_id": 47430610, "comment_id": 81846346, "body": "@JohnColeman - see my comment above"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1511398689, "post_id": 47430610, "comment_id": 81847431, "body": "@ScottHoltzman The line <code>WScript.Quit</code> (not <code>objExcel.Quit</code>) is what quits the script. From the documentation: &quot;Forces script execution to stop at any time&quot; ( <a href=\"https://msdn.microsoft.com/en-us/library/fw0fx1aw(v=vs.84).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/fw0fx1aw(v=vs.84).aspx</a> ) Having that line in the middle of the code like OP does is a bug."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1511400608, "post_id": 47430610, "comment_id": 81847846, "body": "@ScottHoltzman I&#39;m aware of that, but last time I checked <code>WScript.Quit</code> was still a plain VBScript statement."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1511435881, "post_id": 47430610, "comment_id": 81862927, "body": "@AnsgarWiechers - Apologies. I TOTALLY overlooked that line."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1511435894, "post_id": 47430610, "comment_id": 81862933, "body": "@JohnColeman - Apologies. I TOTALLY overlooked that line."}, {"owner": {"reputation": 63, "user_id": 7591487, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10154042791992271/picture?type=large", "display_name": "Edwin Cheng", "link": "https://stackoverflow.com/users/7591487/edwin-cheng"}, "edited": false, "score": 0, "creation_date": 1511490476, "post_id": 47430610, "comment_id": 81885761, "body": "The problem is sovled. I put  WScript.Quit as the end of the script.Thanks all."}], "owner": {"reputation": 63, "user_id": 7591487, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10154042791992271/picture?type=large", "display_name": "Edwin Cheng", "link": "https://stackoverflow.com/users/7591487/edwin-cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511359170, "creation_date": 1511341631, "last_edit_date": 1511359170, "question_id": 47430610, "link": "https://stackoverflow.com/questions/47430610/cannot-delete-file-in-vbscript-due-to-excel-file-opened", "title": "Cannot delete file in VBScript due to Excel file opened", "body": "<p>I have opened an Excel file and copy Excel content to Outlook to send a mail.\nAll of that functionality is working.\nBut when I want to close Excel and delete the Excel file, the action is failing. It shows the error code </p>\n\n<blockquote>\n  <p>Permission denied</p>\n</blockquote>\n\n<p>Apparently the Excel file still opened.</p>\n\n<p>Can anyone help to debug?</p>\n\n<p>The code is shown below:</p>\n\n<pre><code>Set outlook = CreateObject(\"Outlook.Application\")\nSet email = outlook.CreateItem(0)\n\nSet objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook =objExcel.Workbooks.Open(\"W:\\d\\PCCW\\realtime_MTR\\PUCCH_level.xlsx\")\nSet objWorksheet = objWorkbook.Worksheets(\"PUCCH\")\n\nDim sRangeValues\n\nLastRow = objWorksheet.UsedRange.Rows(objWorksheet.UsedRange.Rows.Count).Row\n\nSet r = objWorksheet.Range(\"A1:G\" &amp; LastRow)\nobjWorksheet.Activate\n\nFor i = 2 To r.Rows.Count\n    For j = 1 To r.Rows(i).Columns.Count\n        sRangeValues = sRangeValues &amp; r.Rows(i).Columns(j).Value &amp; \" | \"\n    Next\n    sRangeValues = sRangeValues &amp; \"&lt;br&gt;\"\nNext\nWith email\n    '.to=\"edwincheng@hk.chinamobile.com;\"\n    .To = \"edwincheng@hk.chinamobile.com;\"\n    .Subject = \"Houly MTR Alerter\"\n    .HTMLBody = \"PUCCH:&lt;br&gt;\" &amp; \"Date &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|Time&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|eNodeB|Plan_Site_Name|Cell Name|PUCCH(dBm)| &lt;br&gt;\" &amp; sRangeValues &amp; \"&lt;br&gt;\"\n    .Send\nEnd With\nWScript.Quit\n\nobjWorkbook.Save\nobjWorkbook.Close (False)\nobjExcel.Quit\n\nSet obj1 = CreateObject(\"Scripting.FileSystemObject\")\nobj1.DeleteFile(\"W:\\d\\PCCW\\realtime_MTR\\PUCCH_level.xlsx\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "chm"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1511345654, "post_id": 47430570, "comment_id": 81818202, "body": "Take a look here: <a href=\"https://file.org/extension/chm\" rel=\"nofollow noreferrer\">file.org/extension/chm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 8987556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f685c0b0c82cf338ada0962c8c2b44f?s=128&d=identicon&r=PG&f=1", "display_name": "Ecof", "link": "https://stackoverflow.com/users/8987556/ecof"}, "edited": false, "score": 1, "creation_date": 1511347779, "post_id": 47431989, "comment_id": 81819705, "body": "Thank you! In addition, of course you can replace  <code>&quot; -decompile D:\\Project\\Temp D:\\Project\\ddt.chm&quot;</code> with <code>&quot; - decompile &quot; &amp; sDestPath &amp; &quot; &quot; &amp; sFilePath</code> where <code>sDestPath = &quot;D:\\Project\\Temp&quot;: sFilePath = &quot;D:\\Project\\ddt.chm&quot;</code>"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 48, "user_id": 8987556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f685c0b0c82cf338ada0962c8c2b44f?s=128&d=identicon&r=PG&f=1", "display_name": "Ecof", "link": "https://stackoverflow.com/users/8987556/ecof"}, "edited": false, "score": 0, "creation_date": 1511349259, "post_id": 47431989, "comment_id": 81820671, "body": "Welcome; just to complete the theme, you could compile again via <code>Shell</code> using <code>hhc.exe</code>, but indicating the html help project file (*.hhp) as sole argument. You&#39;ll find a helpful site for some related VBA at <a href=\"http://www.help-info.de\" rel=\"nofollow noreferrer\">help-info.de</a>"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1511345675, "creation_date": 1511345675, "answer_id": 47431989, "question_id": 47430570, "link": "https://stackoverflow.com/questions/47430570/vba-excel-using-extracting-data-stored-in-chm-file/47431989#47431989", "title": "VBA Excel: Using/extracting data stored in CHM-file", "body": "<p>Assuming  you have hh.exe installed you can decompile as follows:</p>\n\n<p><strong>Arguments for hh.exe</strong></p>\n\n<blockquote>\n  <p>-decompile folder chm</p>\n</blockquote>\n\n<p><strong>Example Code</strong></p>\n\n<p>Set your own path Information instead of D:\\Project ...</p>\n\n<pre><code> Public Sub HTMLHelp_Decompile()\n ' Arguments for hh.exe: -decompile folder chm\n On Error Resume Next\n Shell \"\"\"hh.exe\"\"\" &amp; _\n       \" -decompile D:\\Project\\Temp D:\\Project\\ddt.chm\", vbNormalFocus\n If Err.Number &lt;&gt; 0 Then MsgBox Err.Number &amp; \" \" &amp; Err.Description, vbExclamation, \"Decompiling failed\"\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 8987556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f685c0b0c82cf338ada0962c8c2b44f?s=128&d=identicon&r=PG&f=1", "display_name": "Ecof", "link": "https://stackoverflow.com/users/8987556/ecof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 47431989, "answer_count": 1, "score": 2, "last_activity_date": 1511345675, "creation_date": 1511341528, "last_edit_date": 1511343387, "question_id": 47430570, "link": "https://stackoverflow.com/questions/47430570/vba-excel-using-extracting-data-stored-in-chm-file", "title": "VBA Excel: Using/extracting data stored in CHM-file", "body": "<p>I am trying to extract data from a chm-helpfile using VBA. The CHM-file was downloaded and contains important data (such as the possible values for a dropdown-list) that I want to use as criteria for my analysis vba-tool. I would like to extract these tables with possible values and be able to follow the hyperlinks mentioned in the file.\nAfter I manually unzip/extract the chm-file, I was able to use the htm-files, but it requires manual action, and I can't automate the unzip-action. </p>\n\n<p>Is there any way to open the file to use this data?</p>\n"}, {"tags": ["excel", "client-server", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1511426003, "post_id": 47438893, "comment_id": 81856436, "body": "I want to be clearer and reformulate how I understand the answer. By the way I use the Set statement as you write it. I want to prevent any other users to write the file whereas I use it by setting Read-only status. When setting Read Write, I want to be exclusive to write in the file whereas none user could write inside it. In both cases, the other users can only read the opened file."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1511434989, "post_id": 47438893, "comment_id": 81862396, "body": "You could examine the current login name as part of an IF statement and open the file as read only if the name isn&#39;t yours. The function (Environ$(&quot;Username&quot;)) returns the current user"}, {"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1511456826, "post_id": 47438893, "comment_id": 81875582, "body": "I know the function but is there a way to fetch the &quot;reader&quot; that have opened the file ? Thanks;"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1511365942, "creation_date": 1511365942, "answer_id": 47438893, "question_id": 47430274, "link": "https://stackoverflow.com/questions/47430274/excel-vba-read-only-status-explanation-when-a-workbook-set-to-this-value/47438893#47438893", "title": "Excel VBA read-only status explanation when a workbook set to this value", "body": "<p>If you set a file as Read-only in the operating system then it cannot be changed by any user. If you open a file then it is read-only to any other user, unless filesharing is explicitly enabled. If you open a file Read Only (by using code like </p>\n\n<pre><code>  Set wb = Workbooks.open(Filename:=myfile, ReadOnly:=True)\n</code></pre>\n\n<p>Then it is set to read-only for that user. None of this will prevent the user who opened it read-only from saving a copy of the file under a different name.</p>\n\n<p>Is that what you wanted to know?</p>\n"}], "owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511365942, "creation_date": 1511340536, "last_edit_date": 1531164843, "question_id": 47430274, "link": "https://stackoverflow.com/questions/47430274/excel-vba-read-only-status-explanation-when-a-workbook-set-to-this-value", "title": "Excel VBA read-only status explanation when a workbook set to this value", "body": "<p>I want to make sure that affecting a file with this value is for the other users attempting to write inside the file.</p>\n\n<p>My aim is to prevent my file (as a Server file) to be written by others on Windows Server whereas the Client file XLSM is using this Server file.</p>\n\n<p>Is that correct ? Right now I'm developping the Macros application in stand-alone mode at home office. I cannot test the interaction with other users.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Regards.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 35, "user_id": 5389168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1054337857929948/picture?type=large", "display_name": "Aj Mal", "link": "https://stackoverflow.com/users/5389168/aj-mal"}, "edited": false, "score": 0, "creation_date": 1511340317, "post_id": 47430159, "comment_id": 81814889, "body": "You&#39;re welcome :)  Of course, you could refer to the destination sheet other ways too, such as setting a <code>Worksheet</code> object somewhere else in the sub, or change it in the loop depending on cell value, etc"}, {"owner": {"reputation": 35, "user_id": 5389168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1054337857929948/picture?type=large", "display_name": "Aj Mal", "link": "https://stackoverflow.com/users/5389168/aj-mal"}, "edited": false, "score": 0, "creation_date": 1511340742, "post_id": 47430159, "comment_id": 81815091, "body": "Great, useful info.. Appreciate that very much.. *thumbs up"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 35, "user_id": 5389168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1054337857929948/picture?type=large", "display_name": "Aj Mal", "link": "https://stackoverflow.com/users/5389168/aj-mal"}, "edited": false, "score": 0, "creation_date": 1511344340, "post_id": 47430159, "comment_id": 81817377, "body": "@aj-mal - I&#39;m glad you got it working.  When an answer solves your issue, you can &quot;accept&quot; it by clicking the check mark on the left side of the answer (<a href=\"https://meta.stackexchange.com/a/5235/370758\">like tghus</a>) . . .  ;-)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 2, "last_activity_date": 1511340078, "creation_date": 1511340078, "answer_id": 47430159, "question_id": 47430009, "link": "https://stackoverflow.com/questions/47430009/copy-the-highlighted-green-to-another-worksheet/47430159#47430159", "title": "Copy the highlighted green to another worksheet", "body": "<p>Good job on figuring out how to copy only certain cells, that stumps a lot of people.</p>\n\n<p>Tiny change: add <code>Sheets(\"Sheet2\")</code> as below:</p>\n\n<pre><code>Sub copyHighlight()\n    Dim ws As Worksheet\n    Dim r As Long, i As Long, u As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With ws\n        lr = .Cells(Rows.Count, 1).End(xlUp).Row\n        If 2 &gt; lr Then Exit Sub\n\n        u = 2\n        For i = 2 To lr\n            If .Cells(i, 1).Interior.ColorIndex = 4 Then\n                .Cells(i, 1).Copy Sheets(\"Sheet2\").Cells(u, \"E\")\n                u = u + 1\n            End If\n        Next i\n    End With\n\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1511340103, "creation_date": 1511340103, "answer_id": 47430164, "question_id": 47430009, "link": "https://stackoverflow.com/questions/47430009/copy-the-highlighted-green-to-another-worksheet/47430164#47430164", "title": "Copy the highlighted green to another worksheet", "body": "<p>Your code is very good, to achieve what you want, you only need reference to some other sheet, like shown below (I copied your code and added parts to make it work).</p>\n\n<pre><code>Sub copyHighlight()\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim r As Long, i As Long, u As Long\n\nSet ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\n'here you set reference to another worksheet\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\nWith ws1\n    lr = .Cells(Rows.Count, 1).End(xlUp).Row\n    If 2 &gt; lr Then Exit Sub\n\n    u = 2\n    For i = 2 To lr\n        If .Cells(i, 1).Interior.ColorIndex = 4 Then\n            .Cells(i, 1).Copy ws2.Cells(u, \"E\") 'NOTE, that here we used reference to another worksheet\n            u = u + 1\n        End If\n    Next i\nEnd With\n\nSet ws1 = Nothing\nSet ws2 = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5389168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1054337857929948/picture?type=large", "display_name": "Aj Mal", "link": "https://stackoverflow.com/users/5389168/aj-mal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 47430159, "answer_count": 2, "score": 1, "last_activity_date": 1511340103, "creation_date": 1511339565, "last_edit_date": 1511339999, "question_id": 47430009, "link": "https://stackoverflow.com/questions/47430009/copy-the-highlighted-green-to-another-worksheet", "title": "Copy the highlighted green to another worksheet", "body": "<p>I managed to copy the cells in the same sheet. But that's not my primarily intention. I should be able to copy the highlighted cells to another worksheet like Sheet2 or Sheet3. How do I do that?</p>\n\n<p>Below is what I have done for copying in the same sheet\n<a href=\"https://i.stack.imgur.com/dzRyH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dzRyH.jpg\" alt=\"Click here to see image\"></a></p>\n\n<pre><code>Sub copyHighlight()\n    Dim ws As Worksheet\n    Dim lr As Long, i As Long, u As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With ws\n        lr = .Cells(Rows.Count, 1).End(xlUp).Row\n        If 2 &gt; lr Then Exit Sub\n\n        u = 2\n        For i = 2 To lr\n            If .Cells(i, 1).Interior.ColorIndex = 4 Then\n                .Cells(i, 1).Copy .Cells(u, \"E\")\n                u = u + 1\n            End If\n        Next i\n    End With\n\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1511339495, "post_id": 47429908, "comment_id": 81814414, "body": "Thank you. Easy mistake, didn&#39;t even notice, thought it&#39;s something more."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 9, "last_activity_date": 1511345873, "last_edit_date": 1511345873, "creation_date": 1511339171, "answer_id": 47429908, "question_id": 47429793, "link": "https://stackoverflow.com/questions/47429793/wrong-number-of-argument-or-invalid-property-assignment-collection-adding/47429908#47429908", "title": "Wrong number of argument or invalid property assignment collection adding", "body": "<p><code>sumLosses</code> is of type <code>Collection</code> therefore it is an object and has to be <code>Set</code> to another variable/function.</p>\n\n<p>With using <code>Set</code> it should work:</p>\n\n<pre><code>Public Property Get getSumLosses() As Collection\n    Set getSumLosses = sumLosses\nEnd Property\n</code></pre>\n\n<p>Also defining the property <code>As Collection</code> might be no bad idea (but this didn't cause the error).</p>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 5, "last_activity_date": 1511339388, "creation_date": 1511339388, "answer_id": 47429961, "question_id": 47429793, "link": "https://stackoverflow.com/questions/47429793/wrong-number-of-argument-or-invalid-property-assignment-collection-adding/47429961#47429961", "title": "Wrong number of argument or invalid property assignment collection adding", "body": "<p>You need to declare <code>Public Property Get getSumLosses()</code> as a <strong><code>Collection</code></strong> and use <code>Set</code> :  </p>\n\n<pre><code>Private sumLosses As Collection\n\nPrivate Sub Class_Initialize() \n    Set sumLosses = New Collection\nEnd Sub\n\nPublic Property Get getSumLosses() as Collection\n    Set getSumLosses = sumLosses\nEnd Property\n</code></pre>\n\n<p>:)</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1872, "favorite_count": 0, "accepted_answer_id": 47429908, "answer_count": 2, "score": 9, "last_activity_date": 1596694666, "creation_date": 1511338702, "last_edit_date": 1596694666, "question_id": 47429793, "link": "https://stackoverflow.com/questions/47429793/wrong-number-of-argument-or-invalid-property-assignment-collection-adding", "title": "Wrong number of argument or invalid property assignment collection adding", "body": "<p>I've been getting a </p>\n\n<blockquote>\n  <p>wrong number of argument or invalid property assignment collection</p>\n</blockquote>\n\n<p>error for a long time now, but can't figure out what's wrong. I have a class and a <code>Collection</code> inside that class and a <code>Sub</code> to add values to that collection.</p>\n\n<pre><code>Private sumLosses As Collection\n\nPrivate Sub Class_Initialize() \n    Set sumLosses = New Collection\nEnd Sub\n\nPublic Property Get getSumLosses()\n    getSumLosses = sumLosses\nEnd Property\n</code></pre>\n\n<p>Inside main module:</p>\n\n<pre><code>For Each clientCopy In clientsColl\n        clientCopy.getSumLosses.Add 200  'error\n        clientCopy.getSumLosses.Add (200) 'error\nNext\n</code></pre>\n\n<p>Why does this fail and how do I add the items to a class' collection?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1511337704, "post_id": 47429509, "comment_id": 81813447, "body": "Use the <code>IsNull</code> function?"}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1511338209, "post_id": 47429574, "comment_id": 81813760, "body": "Just as an elaboration on this: VBA cannot compare the unknown to anything (even when comparing it to the unknown itself). So, comparing the unkown (NULL) to something is simply not possible with an <code>=</code>. Hence, there is a special function for that. Maybe also noteworthy on this subject: put into cell <code>A1</code> the formula <code>=1&#47;0</code> and copy it over to cell <code>B1</code> and then check if <code>=A1=B1</code>. Once again you don&#39;t get the &quot;expected&quot; result because the cell yields an error and errors cannot be compared with an <code>=</code>. Once again a special function is required <code>=IsError()</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1511338653, "post_id": 47429574, "comment_id": 81813969, "body": "@Ralph In VBA, you can also check an error using <code>=</code>.  For instance, if A1 had the formula <code>=1&#47;0</code>, then VBA would return <code>True</code> for <code>Range(&quot;A1&quot;).Value = CVErr(xlErrDiv0)</code>.  The <code>IsError</code> function will check against <b>all</b> error types, but specific ones need to be tested by comparing to the specific code."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1511338817, "post_id": 47429574, "comment_id": 81814055, "body": "Thank you! I knew of the function <code>IsNull</code> but didn&#39;t think a simple <code>=</code> or <code>&lt;&gt;</code> wouldn&#39;t work as well. Caused a lot of pain."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 4, "last_activity_date": 1511337857, "creation_date": 1511337857, "answer_id": 47429574, "question_id": 47429509, "link": "https://stackoverflow.com/questions/47429509/excel-vba-check-if-number-is-null-doesnt-work-as-expected/47429574#47429574", "title": "Excel vba check if number is null: doesn&#39;t work as expected", "body": "<p>Testing anything against <code>Null</code> (including the equality test <code>Null = Null</code>) returns <code>Null</code>, not <code>True</code> or <code>False</code>.</p>\n\n<p>To check for a <code>Null</code>, use the <code>IsNull</code> function, e.g.</p>\n\n<pre><code>If IsNull(a) Then\n    MsgBox \"a is null\"\nElse\n    '...\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 47429574, "answer_count": 1, "score": 2, "last_activity_date": 1511337857, "creation_date": 1511337618, "question_id": 47429509, "link": "https://stackoverflow.com/questions/47429509/excel-vba-check-if-number-is-null-doesnt-work-as-expected", "title": "Excel vba check if number is null: doesn&#39;t work as expected", "body": "<p>So I have this sample program I've written to understand a similar issue in a bigger program. I have a <code>a As Variant</code> and <code>b As Double</code>. <code>a</code> gets equal to <code>Null</code>, while <code>b</code> gets equal to zero. Then I proceed to check if <code>a</code> or <code>b</code> is <code>Null</code>. </p>\n\n<pre><code>Sub testNull()\n    Dim a As Variant\n    Dim b As Double\n\n    a = Null\n    b = 0\n\n    If a = Null Then\n        MsgBox (a &amp; \"null\") 'doesn't print\n    ElseIf a &lt;&gt; Null Then\n        MsgBox (a &amp; \" not null\") 'doesn't print\n    Else\n        MsgBox (b &amp; \" don't know\") 'prints\n    End If\n\n    If b = Null Then\n        MsgBox (b &amp; \"null\") 'doesn't print\n    ElseIf b &lt;&gt; Null Then\n        MsgBox (b &amp; \" not null\") 'doesn't print\n    Else\n        MsgBox (b &amp; \" don't know\") 'prints\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The results show that while excel doesn't consider <code>a</code> or <code>b</code> to be <code>Null</code>, at the same time it doesn't consider any of those to <em>not</em> be <code>Null</code>.</p>\n\n<p>What is the correct way to make the check here? What causes the issues?</p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511337537, "post_id": 47429362, "comment_id": 81813329, "body": "You are trying to save the file using a name of <code>C:\\Users\\Jian.Chen2\\Desktop\\Copypath</code>, but that name is already in use by a directory that you created."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1511337602, "post_id": 47429470, "comment_id": 81813374, "body": "Should be <code>filename.xlsm</code> (due to it being a macro-enabled workbook) but, other than that, that should work nicely. :)"}], "tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": true, "score": 4, "last_activity_date": 1511337526, "creation_date": 1511337526, "answer_id": 47429470, "question_id": 47429362, "link": "https://stackoverflow.com/questions/47429362/vba-runtime-error-1004/47429470#47429470", "title": "VBA - Runtime error 1004", "body": "<p>Your <code>copyPath</code> is only a folder, but the argument of <code>SaveCopyAs</code> should be a full path with file name.</p>\n\n<p>Try this:\n<code>ThisWorkbook.SaveCopyAs copyPath &amp; \"\\filename.xlsx\"</code></p>\n"}], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 47429470, "answer_count": 1, "score": 1, "last_activity_date": 1511361522, "creation_date": 1511337105, "last_edit_date": 1511361522, "question_id": 47429362, "link": "https://stackoverflow.com/questions/47429362/vba-runtime-error-1004", "title": "VBA - Runtime error 1004", "body": "<p>I'm trying to upload a local xlsm file to SharePoint online using VBA. The file would auto upload to SharePoint after the user saves the file.\nThe concept is after the user saves the xlsm file, it would create a new folder with the copied file and upload the copied file in the folder to SharePoint. After upload, the folder would be deleted. </p>\n\n<p>However, I'm unable to save the file to the folder due to </p>\n\n<blockquote>\n  <p>Runtime error 1004</p>\n</blockquote>\n\n<p>I check the possible reasons, the file name/path do exist, the folder was successfully created. </p>\n\n<p>The file is not being used by another program, only excel runs the file.</p>\n\n<p>The folder is newly created, it an empty folder, does not contain a file with the same name.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7kAUk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7kAUk.png\" alt=\"enter image description here\"></a></p>\n\n<p>I did check all the paths and they are all correct.</p>\n\n<p>This is my code</p>\n\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\n\nDim UploadToSharepoint As Boolean\n\nDim SharePointLib As String\nDim myPath As String\nDim folderPath As String\nDim objNet As Object\nDim FS As Object\nDim copyPath As String\nDim copyFilePath As String\n\nfolderPath = Application.ActiveWorkbook.path\nmyPath = Application.ActiveWorkbook.FullName\nSharePointLib = \"https://company.com/folder/subfoler\"\ncopyPath = folderPath + \"\\copyPath\"\nMsgBox \"This is the folderPath = \" &amp; folderPath &amp; vbNewLine &amp; \"This is the filepath = \" &amp; myPath &amp; vbNewLine &amp; \"The copyPath is = \" &amp; copyPath\n\nIf Not FolderExists(copyPath) Then\n    FolderCreate (copyPath)\nEnd If\n\nSharePointLib = SharePointLib &amp; FileNameWithExt(myPath)\nThisWorkbook.SaveCopyAs (copyPath)\n\nExit Sub\n\nloadFailed:\nUploadToSharepoint = False\n\nEnd Sub\n</code></pre>\n\n<p>Any help and suggestions are appreciated. Thanks in advanced.</p>\n"}, {"tags": ["vba", "excel", "bubble-chart"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5494528, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8229a928f96b31058eb65a9acef2c3b2?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5494528/chris"}, "edited": false, "score": 0, "creation_date": 1511343062, "post_id": 47430992, "comment_id": 81816557, "body": "is it possible to set the size of the points of a scatter plot in vba, so it displays data similiar to the bubble chart?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 147, "user_id": 5494528, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8229a928f96b31058eb65a9acef2c3b2?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5494528/chris"}, "edited": false, "score": 1, "creation_date": 1511343707, "post_id": 47430992, "comment_id": 81816956, "body": "This is possible in spreadsheet, so it is is probably possible in VBA as well. Just record macro and watch the code."}, {"owner": {"reputation": 147, "user_id": 5494528, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8229a928f96b31058eb65a9acef2c3b2?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5494528/chris"}, "edited": false, "score": 0, "creation_date": 1511441143, "post_id": 47430992, "comment_id": 81866124, "body": "Solved the issue by not changing the markers but use different borderstyles. Thank you for your help!"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1511342895, "creation_date": 1511342895, "answer_id": 47430992, "question_id": 47429361, "link": "https://stackoverflow.com/questions/47429361/excel-bubblechart-markershape-wont-change/47430992#47430992", "title": "Excel BubbleChart MarkerShape won&#39;t Change", "body": "<p>Do you mean bubble chart? You cannot change shape of marker in bubble chart, as far as I know. You can do it with scatter plot however. If you meant scatter plot, set that in line: </p>\n\n<pre><code>srs.MarkerStyle = xlMarkerStyleDiamond\n</code></pre>\n\n<p>You set market style for the whole serie. If you want change style for single point, you should loop through srs.Points collection. </p>\n"}], "owner": {"reputation": 147, "user_id": 5494528, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8229a928f96b31058eb65a9acef2c3b2?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5494528/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511342895, "creation_date": 1511337097, "question_id": 47429361, "link": "https://stackoverflow.com/questions/47429361/excel-bubblechart-markershape-wont-change", "title": "Excel BubbleChart MarkerShape won&#39;t Change", "body": "<p>The following script checks for each point of a bubblechart if the value of the cell in column \"B\" is <code>A</code> or <code>P</code>.</p>\n\n<p>Then it should change the shape of the respective Marker to either a circle (same as before, for value <code>A</code>) or a diamond (for value <code>P</code>).\nIt partly works, because I get the right output in the direct window, but the shape of the marker still stays the same, why?</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/series-markerstyle-property-excel\" rel=\"nofollow noreferrer\">The Markerstyle property</a></p>\n\n<p>Code:</p>\n\n<pre><code>Sub format_chart()\nDim srs As Series\nDim cht As Chart\n\nSet cht = Sheets(\"Diagramme\").ChartObjects(\"Diagramm 1\").Chart\nFor Each srs In cht.SeriesCollection\n    If Range(\"B\" &amp; Application.WorksheetFunction.Match(srs.Name, Sheets(\"Diagrammdaten\").Range(\"a:a\"), 0)).Value = \"A\" Then\n         srs.MarkerStyle = xlMarkerStyleDiamond\n         Debug.Print \"Value is A\"\n    ElseIf Range(\"B\" &amp; Application.WorksheetFunction.Match(srs.Name, Sheets(\"Diagrammdaten\").Range(\"a:a\"), 0)).Value = \"P\" Then\n         srs.MarkerStyle = xlMarkerStyleCircle\n         Debug.Print \"Value is P\"\n    Else: Debug.Print \"You Failed!\"\n    End If\nNext srs\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1511334020, "post_id": 47428512, "comment_id": 81811484, "body": "show your complete code including variable declaration. In which line error pops up?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1511334022, "post_id": 47428512, "comment_id": 81811487, "body": "That kind of depends: we can&#39;t see what&#39;s on row 29, or any sample data for that matter!"}, {"owner": {"reputation": 361, "user_id": 6463709, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/70b2a236a6ac8fbd1297149fc9bd976c?s=128&d=identicon&r=PG&f=1", "display_name": "decemberrobot", "link": "https://stackoverflow.com/users/6463709/decemberrobot"}, "edited": false, "score": 0, "creation_date": 1511334200, "post_id": 47428512, "comment_id": 81811571, "body": "Updated the code. The error lies with the line -&gt; Worksheets(&quot;Sheet2&quot;).Cells(i, x + 1).Value = rowValue(x)"}, {"owner": {"reputation": 361, "user_id": 6463709, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/70b2a236a6ac8fbd1297149fc9bd976c?s=128&d=identicon&r=PG&f=1", "display_name": "decemberrobot", "link": "https://stackoverflow.com/users/6463709/decemberrobot"}, "edited": false, "score": 0, "creation_date": 1511334215, "post_id": 47428512, "comment_id": 81811578, "body": "Worksheet 2 is just an empty sheet."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 2, "creation_date": 1511334340, "post_id": 47428512, "comment_id": 81811629, "body": "I think the value in row 29 doesn&#39;t have a long string in which you have 13 words separated by space.When the code stops right click on rowValue and click on Add Watch and check how many values are there in array."}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "edited": false, "score": 0, "creation_date": 1511334411, "post_id": 47428512, "comment_id": 81811659, "body": "ensure the data before splitting- i thinking that  u may use data splitting option in excel"}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 4381453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6GMuA.png?s=128&g=1", "display_name": "Sujoy", "link": "https://stackoverflow.com/users/4381453/sujoy"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511335165, "post_id": 47428770, "comment_id": 81812074, "body": "It is fine, hiding an anticipated error, when the code itself is not factored well and no naming convention is followed."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511335312, "post_id": 47428770, "comment_id": 81812129, "body": "But the error <b>isn&#39;t</b> anticipated, otherwise the OP wouldn&#39;t be asking the question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1511336277, "post_id": 47428770, "comment_id": 81812615, "body": "&quot;Don&#39;t worry about the easily-fixable errors in your code&quot;"}], "tags": [], "owner": {"reputation": 585, "user_id": 4381453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6GMuA.png?s=128&g=1", "display_name": "Sujoy", "link": "https://stackoverflow.com/users/4381453/sujoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1511334593, "creation_date": 1511334593, "answer_id": 47428770, "question_id": 47428512, "link": "https://stackoverflow.com/questions/47428512/subscript-out-of-range-when-looping-through-array-excel-vba/47428770#47428770", "title": "Subscript out of range when looping through array excel VBA", "body": "<p>use <code>On Error Resume Next</code></p>\n\n<pre><code>Sub S1()\n\n    Dim Wb As Workbook\n    Dim rowValue() As String\n    Dim i As Variant\n\n    For i = 2 To 15500\n        With Worksheets(1)\n            Value2 = Worksheets(1).Cells(i, 1)\n            On Error Resume Next ' USE THIS\n            rowValue = Split(Worksheets(1).Cells(i, 1).Value, \" \")\n            rowValue(11) = rowValue(11) &amp; \" \" &amp; rowValue(12) &amp; \" \" &amp; rowValue(13)\n            arraySize = UBound(rowValue) - LBound(rowValue) + 1\n            If arraySize &gt; 3 Then\n                For x = 0 To arraySize\n                    'Place the split values into 1 column each\n                Worksheets(\"Sheet2\").Cells(i, x + 1).Value = rowValue(x)\n\n                Next x\n            Else\n                'do nothing\n            End If\n            On Error GoTo 0  ' USE THIS\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511334982, "post_id": 47428812, "comment_id": 81811962, "body": "Definitely will cause the error.  Now the big question is ... why doesn&#39;t it crash on row 2 ?!?  (Maybe rows 2 to 29 only contain 2 or fewer spaces??)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511335446, "post_id": 47428812, "comment_id": 81812213, "body": "No - it can&#39;t be less than 3 spaces, or else the line setting position 11 would crash."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1511335429, "last_edit_date": 1511335429, "creation_date": 1511334772, "answer_id": 47428812, "question_id": 47428512, "link": "https://stackoverflow.com/questions/47428512/subscript-out-of-range-when-looping-through-array-excel-vba/47428812#47428812", "title": "Subscript out of range when looping through array excel VBA", "body": "<p>This is a problem:</p>\n\n<pre><code>For x = 0 To arraySize\n</code></pre>\n\n<p>An array of size 10 (and lower bound=0) has an upper bound of 9, so there would be (eg) no rowValue(10)</p>\n\n<p>Reworked with bounds checking:</p>\n\n<pre><code>Sub S1()\n\n    Dim Wb As Workbook, rowValue, i As Long, ub As Long\n\n    For i = 2 To 15500\n\n        rowValue = Split(Worksheets(1).Cells(i, 1).Value, \" \")\n        ub = UBound(rowValue)\n\n        If ub &gt;= 13 Then\n            rowValue(11) = rowValue(11) &amp; \" \" &amp; rowValue(12) &amp; \" \" &amp; rowValue(13)\n        End If\n\n        If ub &gt; 2 Then\n            Worksheets(\"Sheet2\").Cells(i, 1).Resize(1, ub + 1).Value = rowValue\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1511335784, "post_id": 47429017, "comment_id": 81812377, "body": "what happened to <code>rowValue(11) = rowValue(11) &amp; &quot; &quot; &amp; rowValue(12) &amp; &quot; &quot; &amp; rowValue(13)</code>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1522618522, "post_id": 47429017, "comment_id": 86212896, "body": "@december  (Don&#39;t forget to <b>\u25b2 Upvote</b> answers that are helpful <b><i>and</i></b> to <b>\u2713\uff0b\u25b2 Accept <i>and</i> Upvote</b> an answer that helped you solve your problem!)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1511337510, "last_edit_date": 1511337510, "creation_date": 1511335714, "answer_id": 47429017, "question_id": 47428512, "link": "https://stackoverflow.com/questions/47428512/subscript-out-of-range-when-looping-through-array-excel-vba/47429017#47429017", "title": "Subscript out of range when looping through array excel VBA", "body": "<h1>Here is your new code:</h1>\n\n<pre><code>Sub S1()\n    Dim i As Integer, arr_Split() As String\n    For i = 2 To 15500\n        arr_Split = Split(Sheets(1).Cells(i, 1), \" \")\n        Range(Sheets(1).Cells(i, 2), Sheets(1).Cells(i, 2 + UBound(arr_Split))) = arr_Split\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Try in out in place of the entire sub.  Excel users often do things <strong>the hard way</strong> instead of checking if there are built-in features already created for the same task.</p>\n\n<h2>Some of the problems with your original subroutine:</h2>\n\n<ul>\n<li><p>You declare <code>Wb</code> as a Workbook but do not use it.</p></li>\n<li><p>You don't declare <code>Value2</code> but you use it.</p></li>\n<li><p>You don't declare <code>arraySize</code> but you use it.</p></li>\n<li><p>You don't declare <code>x</code> but you use it.</p></li>\n<li><p>You use a <code>With</code>/<code>End With</code> Statement for no reason (since you don't refer to <code>.</code> between <code>With</code> and <code>End With</code>).</p></li>\n<li><p>The <code>With</code>/<code>End With</code> Statement begins &amp; ends <strong>14,998 times</strong>. (See below.)</p></li>\n<li><p>You hard code 11,12,13, which can be a problem unless all original values are 9 <code>words</code> long.</p></li>\n<li><p>If (for example) your array has 5 items, <code>arraySize</code> will calculate as 3.   (If an array has 5 items, they are numbered 0 to 4, and your formula calculates <code>arraySize</code> as 4 minus 1.</p></li>\n<li><p>Your <code>If arraysize&gt;3</code> line will be incorrect due to errors above.</p></li>\n<li><p>You're using a Variant (<code>i</code>) to count strictly integers.</p></li>\n<li><p>The <code>For</code>/<code>Next</code> loop is using improper values for <code>x</code>.</p></li>\n<li><p><code>If X=0 then Cells(i, x + 1)</code> is incorrect since it starts writing at column 1 (replacing the source text).</p></li>\n<li><p><code>Else 'do nothing</code> is unneeded since <code>Else</code> statements are optional.</p></li>\n<li><p>Row numbers are hard coded, meaning that you will always process exactly 14,998 rows.</p></li>\n<li><p>There is no <code>End Sub</code>. (a copy/paste error I assume)</p></li>\n<li><p>You're not using <code>Option Explicit</code> (which is why you didn't notice undeclared variables).</p></li>\n<li><p>There was a couple more things which I am forgetting at the moment.\nGive me a moment to list all the things wrong with your code...  :)</p></li>\n</ul>\n\n<hr>\n\n<p><strong>I left out these lines</strong> since (without sample data) it's unclear what they do.  If I knew what they did, I am positive there's a better way to code the (possibly without hard-coded values).</p>\n\n<ul>\n<li><p><code>rowValue(11) = rowValue(11) &amp; \" \" &amp; rowValue(12) &amp; \" \" &amp; rowValue(13)</code></p></li>\n<li><p><code>If arraySize &gt; 3 Then</code></p></li>\n</ul>\n\n<p>Add them back in if needed, but make sure the variables are declared and that there is no way the hard-coded values will cause a problems can cause a problem with any possible data you have or will ever have.</p>\n"}], "owner": {"reputation": 361, "user_id": 6463709, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/70b2a236a6ac8fbd1297149fc9bd976c?s=128&d=identicon&r=PG&f=1", "display_name": "decemberrobot", "link": "https://stackoverflow.com/users/6463709/decemberrobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1511337510, "creation_date": 1511333652, "last_edit_date": 1511334120, "question_id": 47428512, "link": "https://stackoverflow.com/questions/47428512/subscript-out-of-range-when-looping-through-array-excel-vba", "title": "Subscript out of range when looping through array excel VBA", "body": "<p>I am trying to split a string in excel and then writing each element of the string into one column of another sheet but i cant seem to finish looping before it gets a subscript out of range error.</p>\n\n<pre><code>Sub S1()\n\nDim Wb As Workbook\nDim rowValue() As String\nDim i As Variant\n\nFor i = 2 To 15500\nWith Worksheets(1)\n    Value2 = Worksheets(1).Cells(i, 1)\n    rowValue = Split(Worksheets(1).Cells(i, 1).Value, \" \")\n    rowValue(11) = rowValue(11) &amp; \" \" &amp; rowValue(12) &amp; \" \" &amp; rowValue(13)\n    arraySize = UBound(rowValue) - LBound(rowValue) + 1\n    If arraySize &gt; 3 Then\n        For x = 0 To arraySize\n            'Place the split values into 1 column each\n        Worksheets(\"Sheet2\").Cells(i, x + 1).Value = rowValue(x)\n\n        Next x\n    Else\n        'do nothing\n    End If\nEnd With\nNext i\n</code></pre>\n\n<p>Above is my code, there are about 15500 rows in the first sheet. Everything works fine from rows 1-29 but after that I got the run-time error 9, subscript out of range.</p>\n\n<p>Anyone knows why the loop stops after 29 rows?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 7, "creation_date": 1511333719, "post_id": 47428511, "comment_id": 81811357, "body": "<code>If Left(items, 3) = &quot;APP&quot; Then</code>"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "edited": false, "score": 0, "creation_date": 1511333910, "post_id": 47428511, "comment_id": 81811437, "body": "i agree with using <code>left</code> funciton"}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1511334434, "post_id": 47428511, "comment_id": 81811671, "body": "Great it works!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 6, "creation_date": 1511334625, "post_id": 47428511, "comment_id": 81811790, "body": "Of course, you could just use the Excel <code>COUNTIF</code> function to achieve the same thing:  <code>=&quot;APP  &quot;&amp;COUNTIF(A1:A5,&quot;APP*&quot;)</code>"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 2, "creation_date": 1511335898, "post_id": 47428511, "comment_id": 81812429, "body": "You can use <code>Instr</code> function as well by slightly modifying the construct like <code>If InStr(items, &quot;APP&quot;) = 1 Then</code>. &quot;= 1&quot; part will check if it is in the first position or not."}, {"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1511337242, "post_id": 47428511, "comment_id": 81813150, "body": "ahhh got it. Thanks @ShrivallabhaRedij"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1511344119, "post_id": 47428511, "comment_id": 81817233, "body": "The other issue (may not necessarily be) that I see with the code posted is that it assumes all cells will be filled consecutively. e.g. if <code>A1,A2,A3,A5</code> cells had data and <code>A4</code> was blank then macro will stop at <code>A3</code> and will (possibly) give erroneous results."}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 0, "creation_date": 1512063476, "post_id": 47428511, "comment_id": 82115864, "body": "@Jonathan Can you please accept my answer by clicking the button below the up/down vote. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "edited": false, "score": 0, "creation_date": 1512096018, "post_id": 47429662, "comment_id": 82129376, "body": "how about if I want to search a specific word in a string. For example: I have a dog. I want to count the word have in every row."}], "tags": [], "owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "is_accepted": false, "score": 0, "last_activity_date": 1511338228, "creation_date": 1511338228, "answer_id": 47429662, "question_id": 47428511, "link": "https://stackoverflow.com/questions/47428511/excel-vba-count-an-item-if-the-first-3-character-of-a-string-matches-the-keywo/47429662#47429662", "title": "Excel VBA - count an item if the first 3 character of a string matches the keyword", "body": "<p>I'd recommend you use the <code>Left</code> function which can be used like this.</p>\n\n<blockquote>\n  <p>Left(yourString, length)</p>\n</blockquote>\n\n<p>This can be used to get the 3 first characters of the text in your case and then you'll be able to test these characters.</p>\n\n<p>In your code, it'd do something like that:</p>\n\n<pre><code>Public Sub TEST()\n\n    Dim a As String\n    Dim row_number As Long\n    Dim count_of_string As Long\n    Dim items As Variant\n\n    row_number = 0\n    count_of_string = 0\n\n    Do\n        row_number = row_number + 1\n        items = Sheets(\"Sheet1\").Range(\"A\" &amp; row_number)\n\n        'Check if the 3 first characters are APP\n        If (Left(items, 3) = \"APP\") Then\n            count_of_string = count_of_string + 1\n        End If\n    Loop Until items = \"\"\n\n    Range(\"A1\").Select\n\n    Selection.End(xlDown).Select\n    lastcell = ActiveCell.Address\n\n    ActiveCell.Offset(3, 0).Value = \"APP  \" &amp; count_of_string\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1511341823, "creation_date": 1511341823, "answer_id": 47430664, "question_id": 47428511, "link": "https://stackoverflow.com/questions/47428511/excel-vba-count-an-item-if-the-first-3-character-of-a-string-matches-the-keywo/47430664#47430664", "title": "Excel VBA - count an item if the first 3 character of a string matches the keyword", "body": "<p>If the case of APP (i.e. not app) is important then you can use <code>FIND</code>, otherwise the <code>COUNTIF</code> that @YowE3K suggests in his comment (should add it as an answer).<br>\nSaying that, someone's going to show how to do it with a formula that is case sensitive in a minute. </p>\n\n<pre><code>Public Sub Test()\n    Dim count_of_string As Long\n    Dim rItem As Range\n    Dim sFirstAdd As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\").Columns(1)\n\n        'Find the first occurrence in column A.\n        Set rItem = .Find(What:=\"APP*\", _\n                          LookIn:=xlValues, _\n                          LookAt:=xlWhole, _\n                          SearchDirection:=xlNext, _\n                          MatchCase:=True)\n        If Not rItem Is Nothing Then\n            sFirstAdd = rItem.Address\n            'Find the following occurrences until the code reaches the first instance again.\n            Do\n                count_of_string = count_of_string + 1\n                Set rItem = .FindNext(rItem)\n            Loop While rItem.Address &lt;&gt; sFirstAdd\n        End If\n\n        .Cells(.Rows.Count).End(xlUp).Offset(3) = \"APP \" &amp; count_of_string\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 8789482, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10207644192263165/picture?type=large", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/8789482/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1747, "favorite_count": 0, "accepted_answer_id": 47430664, "answer_count": 2, "score": 0, "last_activity_date": 1511341823, "creation_date": 1511333644, "question_id": 47428511, "link": "https://stackoverflow.com/questions/47428511/excel-vba-count-an-item-if-the-first-3-character-of-a-string-matches-the-keywo", "title": "Excel VBA - count an item if the first 3 character of a string matches the keyword", "body": "<p>I need to count an item if the first 3 character of a string if the first 3 characters are \"APP\" (for example).\nAs shown below, I am able to count the item if it has the \"APP\", but what I want is only counting if the item has \"APP\" as the 1st 3 characters of the string.\nI need a code like <code>if InStr(items, \"APP\") And take the 1st 3 character Then\n        count_of_string = count_of_string + 1</code></p>\n\n<p>I don't know how to write that in vba. I have seen something like <code>str2 = Left(str1,3)</code> but it's giving me 0 as results. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ad0Vn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ad0Vn.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my current code. Thank you.</p>\n\n<pre><code>Public Sub TEST()\nDim a As String\nDim row_number As Long\nDim count_of_string As Long\nDim items As Variant\n\n\nrow_number = 0\ncount_of_string = 0\nDo\n\nrow_number = row_number + 1 \nitems = Sheets(\"Sheet1\").Range(\"A\" &amp; row_number)\n    If InStr(items, \"APP\") Then\n        count_of_string = count_of_string + 1\n    End If\nLoop Until items = \"\"\n\nRange(\"A1\").Select\n\nSelection.End(xlDown).Select\nlastcell = ActiveCell.Address\n\nActiveCell.Offset(3, 0).Value = \"APP  \" &amp; count_of_string\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1511333222, "creation_date": 1511333222, "answer_id": 47428402, "question_id": 47428234, "link": "https://stackoverflow.com/questions/47428234/how-to-preserve-trailing-spaces-in-a-string-when-printing-it-onto-a-cell/47428402#47428402", "title": "How to preserve trailing spaces in a string when printing it onto a cell?", "body": "<p>Set the Text format to prevent autoconversion:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub stringspace()\n\n    stringg = \"23 \"\n    MsgBox Len(stringg) 'here it is 3\n    Cells(1, 1).NumberFormat = \"@\"\n    Cells(1, 1) = stringg\n    MsgBox Len(Cells(1, 1)) 'here it is 3\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 1890742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a6e4dd1927f88fa2d6589eec2c7c96c?s=128&d=identicon&r=PG", "display_name": "Mark Walsh", "link": "https://stackoverflow.com/users/1890742/mark-walsh"}, "edited": false, "score": 0, "creation_date": 1579890774, "post_id": 47428581, "comment_id": 105931068, "body": "This may be a correct answer (by adding the &#39;), but the method to check is not valid.  A cell might still trim the spaces, but the len function on the cell still will show the entire string length.  For example <code>Cells(1,1) = &quot;23 &quot;: Cells(1,2) = &quot;123&quot;: If Len(Cells(1,1)) = Len(Cells(1,2))</code> would evaluate to true.  [If the comment doesn&#39;t properly show it &quot;23 &quot; does indeed have a space in it]"}], "tags": [], "owner": {"reputation": 585, "user_id": 4381453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6GMuA.png?s=128&g=1", "display_name": "Sujoy", "link": "https://stackoverflow.com/users/4381453/sujoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1511333891, "creation_date": 1511333891, "answer_id": 47428581, "question_id": 47428234, "link": "https://stackoverflow.com/questions/47428234/how-to-preserve-trailing-spaces-in-a-string-when-printing-it-onto-a-cell/47428581#47428581", "title": "How to preserve trailing spaces in a string when printing it onto a cell?", "body": "<pre><code>Sub StringSpace_Modified()\n\n    Cells(2, 1) = \"'23 \"  ' Use a single quote at the beginning\n    Debug.Print Len(Cells(2, 1)) ' Displays 3 in immediate window\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8986327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7428d117a728721f7302aff86ba13365?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/8986327/surya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 47428402, "answer_count": 2, "score": 2, "last_activity_date": 1511333891, "creation_date": 1511332478, "question_id": 47428234, "link": "https://stackoverflow.com/questions/47428234/how-to-preserve-trailing-spaces-in-a-string-when-printing-it-onto-a-cell", "title": "How to preserve trailing spaces in a string when printing it onto a cell?", "body": "<p>When I am trying to print out strings with a trailing space, the trailing spaces are automatically truncated by excel. I want to preserve them.</p>\n\n<p>Sample:</p>\n\n<pre><code>Sub stringspace()\n\nstringg = \"23 \"\nMsgBox Len(stringg) 'here it is 3\nCells(1, 1) = stringg\nMsgBox Len(Cells(1, 1)) 'here it is 2\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1520643073, "post_id": 47426761, "comment_id": 85413839, "body": "Why not try www.pptxbuilder.com, it does something similar to what you are doing..."}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 1922959, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7c568527a3fe1c7c82a7332a206c6ada?s=128&d=identicon&r=PG", "display_name": "jerH", "link": "https://stackoverflow.com/users/1922959/jerh"}, "edited": false, "score": 0, "creation_date": 1511325961, "post_id": 47426927, "comment_id": 81808515, "body": "Duh!  Of course!  Thanks for that....and I&#39;m also kicking myself because I generally always use option explicit, but somehow failed to this time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 711, "user_id": 1922959, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7c568527a3fe1c7c82a7332a206c6ada?s=128&d=identicon&r=PG", "display_name": "jerH", "link": "https://stackoverflow.com/users/1922959/jerh"}, "edited": false, "score": 0, "creation_date": 1511327141, "post_id": 47426927, "comment_id": 81808842, "body": "@jerH there&#39;s an option in the VBE settings to &quot;require variable declaration&quot; - that will automatically add <code>Option Explicit</code> to every module in every project. Also you could use <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> to spot all undeclared identifiers (and other potential code issues)."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 4, "last_activity_date": 1511330826, "last_edit_date": 1511330826, "creation_date": 1511325640, "answer_id": 47426927, "question_id": 47426761, "link": "https://stackoverflow.com/questions/47426761/excel-powerpoint-vba-and-late-binding/47426927#47426927", "title": "Excel/PowerPoint VBA and late binding", "body": "<p>It seems that you've changed your declarations to late-binding, but you may still be using some of the PowerPoint constants (such as <code>ppPasteMetafilePicture</code>), which will no longer resolve to their early-bound values, and instead default to <code>0</code>.</p>\n\n<p>You'll need to define a local constant for <code>ppPasteMetafilePicture</code> in order for the value to be available.</p>\n\n<p>As an aside, you should always use <code>Option Explicit</code> and then the VBE will automatically spot usages of undeclared constants.</p>\n"}], "owner": {"reputation": 711, "user_id": 1922959, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7c568527a3fe1c7c82a7332a206c6ada?s=128&d=identicon&r=PG", "display_name": "jerH", "link": "https://stackoverflow.com/users/1922959/jerh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "accepted_answer_id": 47426927, "answer_count": 1, "score": 2, "last_activity_date": 1511330826, "creation_date": 1511324538, "last_edit_date": 1531164843, "question_id": 47426761, "link": "https://stackoverflow.com/questions/47426761/excel-powerpoint-vba-and-late-binding", "title": "Excel/PowerPoint VBA and late binding", "body": "<p>I've been building a tool to generate PowerPoint slides from data in an excel workbook.  I move back and forth between a computer at work and my computer at home.  The work computer has Excel 2013 while the home computer has 2016.  This generally isn't an issue...when I move from the home computer to the work computer I just have to change the reference from the v16 object library to the v15 object library.</p>\n\n<p>Earlier this week though I ran into an error I couldn't resolve...detailed <a href=\"https://stackoverflow.com/questions/47398530/excel-vba-missing-reference-and-error-in-loading-dll\">here</a> One of the suggestions to resolve it was to switch to late binding so I didn't need the reference.  That was a pretty easy switch, but it has led to an error in the resulting ppt slide...</p>\n\n<p>In the original (early binding) version I set things up like</p>\n\n<pre><code>Dim PPApp As PowerPoint.Application\nDim PPPres As PowerPoint.Presentation\nDim PPSlide As PowerPoint.Slide\nDim PPLayout As CustomLayout\nDim PPshape As Variant\nDim tBox As PowerPoint.Shape\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>Set PPApp = New PowerPoint.Application\nSet PPPres = PPApp.Presentations.Open(fileName, msoTrue, , msoFalse)\n</code></pre>\n\n<p>And then part of the slide was built with</p>\n\n<pre><code>wsGenerator.Activate\nwsGenerator.Range(\"B32:L37\").Select\nSelection.Copy\nWith PPSlide.Shapes.PasteSpecial(ppPasteMetafilePicture)\n     .Top = 450\n     .Left = 50\n     .Height = 100\n     .Width = 325\nEnd With\n</code></pre>\n\n<p>Part of the resulting slide looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/1xBv5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1xBv5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The table at the bottom is the part pasted by the above code.</p>\n\n<p>When I change to late binding, I simply make these changes</p>\n\n<pre><code>'Dim PPApp As PowerPoint.Application\nDim PPApp As Object\n\n'Dim PPPres As PowerPoint.Presentation\nDim PPPres As Object\n\n'Dim PPSlide As PowerPoint.Slide\nDim PPSlide As Object\n\n'Dim PPLayout As CustomLayout\nDim PPLayout As Object\n\n'Dim tBox As PowerPoint.Shape\nDim tBox As Object\n\nDim PPshape As Variant\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>'Set PPApp = New PowerPoint.Application\nSet PPApp = CreateObject(\"PowerPoint.Application\")\n</code></pre>\n\n<p>Everything else remains the same.  The resulting chart now looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/VkHXU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VkHXU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Note that it now extends off the bottom of the slide.  </p>\n\n<p>Any ideas as to what that's about?</p>\n"}, {"tags": ["xml", "vba", "onenote"], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1511757702, "last_edit_date": 1511757702, "creation_date": 1511731213, "answer_id": 47501133, "question_id": 47426666, "link": "https://stackoverflow.com/questions/47426666/using-vba-to-paste-excel-picture-into-onenote/47501133#47501133", "title": "Using VBA to Paste Excel Picture into OneNote", "body": "<p>i experimented with your code and came up with this</p>\n\n<p>it inserts an image at a specific location in oneNote</p>\n\n<p>the image has to be BASE64 encoded</p>\n\n<p>you will have to come up with code to do that</p>\n\n<p>here is an on-line encoder  <a href=\"https://www.base64-image.de/\" rel=\"nofollow noreferrer\">https://www.base64-image.de/</a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub InsertImageInOneNote()\n\n    ' Connect to OneNote 2010. OneNote will be started if it's not running.\n    Dim onApp As OneNote.Application\n    Set onApp = New OneNote.Application\n\n    Dim OpenedFile As String\n\n    'Open OneNote file and creates an output ID to call on the file (OpenedFile)\n    onApp.OpenHierarchy bstrPath:=\"C:\\test\\test.one\", _\n                      bstrRelativeToObjectID:=\"\", _\n                      pbstrObjectID:=OpenedFile\n\n    'Use the output ID from OpenHierarchy to open OneNote file\n    onApp.NavigateTo bstrHierarchyObjectID:=OpenedFile, _\n                        bstrObjectID:=\"\", _\n                        fNewWindow:=False\n\n    Dim XMLSectionFile As String\n    ' OneNote's GetHierarchy method allows you to get meta-data and data about the OneNote Notebooks.\n    ' Takes data and puts into XML output\n\n    onApp.GetHierarchy bstrStartNodeId:=OpenedFile, hsScope:=hsPages, pbstrHierarchyXMLOut:=XMLSectionFile\n\n    Dim secDoc As MSXML2.DOMDocument                                    ' Use the MSXML Library to parse the XML\n    Set secDoc = New MSXML2.DOMDocument\n\n    If secDoc.LoadXML(XMLSectionFile) Then\n\n        Dim pageNodes As MSXML2.IXMLDOMNodeList                         ' all page nodes\n        Set pageNodes = secDoc.DocumentElement.SelectNodes(\"//one:Page\")\n\n        Dim node As MSXML2.IXMLDOMNode\n        Dim pageName As String\n        Dim pageID As String\n\n        For Each node In pageNodes                                       ' Loop through each page to find the page that has the same title as \"ABC\" then paste picture\n            pageName = node.Attributes.getNamedItem(\"name\").Text\n\n            If pageName = \"ABC\" Then\n                pageID = node.Attributes.getNamedItem(\"ID\").Text         ' Get pageID and load page's XML output\n\n                Dim XMLPageFile As String\n                onApp.GetPageContent bstrPageID:=pageID, pbstrPageXMLout:=XMLPageFile\n\n                Dim pageDoc As MSXML2.DOMDocument\n                Set pageDoc = New MSXML2.DOMDocument\n\n                If pageDoc.LoadXML(XMLPageFile) Then\n\n                    Dim newElement As MSXML2.IXMLDOMElement\n                    Dim imageNode As MSXML2.IXMLDOMNode\n                    Dim pageNode As MSXML2.IXMLDOMNode\n                    Dim newNode As MSXML2.IXMLDOMNode\n                    Dim newAttribute As MSXML2.IXMLDOMAttribute\n\n                    Set pageNode = pageDoc.SelectSingleNode(\"//one:Page\")\n\n                '   &lt;one:Image format=\"png\"&gt;\n                '      &lt;one:Position x=\"36.0\" y=\"158.3999786376953\" z=\"2\"/&gt;\n                '      &lt;one:Size width=\"162.7296752929687\" height=\"48.74386596679687\"/&gt;\n                '      &lt;one:Data&gt;iVBORw0KGg........................2MiiWnAXg84I/9j6SjrduAAAAABJRU5ErkJggg==      BASE64 encoded binary file (image)\n                '      &lt;/one:Data&gt;\n                '   &lt;/one:Image&gt;\n\n                '   &lt;one:Image format=\"png\"&gt;\n                    Set newElement = pageDoc.createElement(\"one:Image\")\n                    Set imageNode = pageNode.appendChild(newElement)\n\n                    Set newAttribute = pageDoc.createAttribute(\"format\")\n                    newAttribute.Value = \"png\"\n                    imageNode.Attributes.setNamedItem newAttribute\n\n                '   &lt;one:Position x=\"36.0\" y=\"158.3999786376953\" z=\"2\"/&gt;\n                    Set newElement = pageDoc.createElement(\"one:Position\")\n                    Set newNode = imageNode.appendChild(newElement)\n\n                    Set newAttribute = pageDoc.createAttribute(\"x\")\n                    newAttribute.Value = \"36.0\"\n                    newNode.Attributes.setNamedItem newAttribute\n\n                    Set newAttribute = pageDoc.createAttribute(\"y\")\n                    newAttribute.Value = \"158.3999786376953\"\n                    newNode.Attributes.setNamedItem newAttribute\n\n                    Set newAttribute = pageDoc.createAttribute(\"z\")\n                    newAttribute.Value = \"2\"\n                    newNode.Attributes.setNamedItem newAttribute\n\n                '   &lt;one:Size width=\"162.7296752929687\" height=\"48.74386596679687\"/&gt;\n                    Set newElement = pageDoc.createElement(\"one:Size\")\n                    Set newNode = imageNode.appendChild(newElement)\n\n                    Set newAttribute = pageDoc.createAttribute(\"width\")\n                    newAttribute.Value = \"162.7296752929687\"\n                    newNode.Attributes.setNamedItem newAttribute\n\n                    Set newAttribute = pageDoc.createAttribute(\"height\")\n                    newAttribute.Value = \"48.74386596679687\"\n                    newNode.Attributes.setNamedItem newAttribute\n\n                '   &lt;one:Data&gt;iVBORw0KGg........................2MiiWnAXg84I/9j6SjrduAAAAABJRU5ErkJggg==      BASE64 encoded binary file (image)\n                    Set newElement = pageDoc.createElement(\"one:Data\")\n                    Set newNode = imageNode.appendChild(newElement)\n\n                    Dim pic As String     ' BASE64 encoded binary data (image) ... used this: https://www.base64-image.de/\n\n                    pic = \"iVBORw0KGgoAAAANSUhEUgAAANkAAABBCAYAAABciwFYAAAAA3NCSVQICAjb4U/gAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUr\"\n                    pic = pic &amp; \"DhsAAApqSURBVHhe7Z1PTB3VHsd/CpLGB5i4o4DmQoAuSDfEYGKMwuP5fKnWWAwLN00TCXZhajS2Llh2UWps0rhoGkxMN29BSo1V45/HA40xkTRsCAsK6SW1BXYkcok2\"\n                    pic = pic &amp; \"iH/OmTnDnTvn95uZM3MOtw2/TzLpnHu59zKX8z2/v2f60F8CYBjGGQ+rfxmGcQSLjGEcwyJjGMewyBjGMSwyhnEMi4xhHMMiYxjHsMgYxjEsMoZxDIuMYRzDImMYx7DI\"\n                    pic = pic &amp; \"GMYx+RqEix/D1v/+CfUjBfVAhKkzsHHimhoEdMOj338KB9rUMA/i8zefG4MdNQyo+2QZ6gfUgLn/KV2FV2auwIIaBgw+9Tmcb1KDB5jMluyPy6/Chpjgf6oxwzA4GUQ2\"\n                    pic = pic &amp; \"DVutHfDL2ei6wzAMhpnIpPvXOgLbasgwTDIGIhMWTIuvGIZJgrOLDOOYB1tkbW9A451leDxycGaRuZ9gS8YwjmGRMYxjEovR2+92wNaEGqSgdvRbaAyK02mK0WhBOWXB\"\n                    pic = pic &amp; \"OkcxWtb56DLEMai/MwZ1apSPuzD+3Uk4t6mGiu5Dl+CzzhY10llZOgUDi0U1krTB+30XYbhBDaOgBd2E10iIQrDEqBi8fgHab8yogaJ5FG719KKfUfHeRsVo/Pv0CD6P\"\n                    pic = pic &amp; \"QP9Ow/TB+NF3oF+NbFJFS7YC9450eAXtqEhAfN2/PieeO/Ix/KEesYVcNDYS63zXvFrgRuurcI/6m6SmBQYO6qvFQmlVneGslKIfXIQv1u+qc4Stn3WhND4LA5TApCiu\"\n                    pic = pic &amp; \"vwzthMAkkzfE8+JnXlmK+dwkCAHJ9z69rgYGTM8RApMiIQQ2PedfBy0wyQwMy+/j+ikYL6mHLFElkUmBvQC/zqshxfwY/PLutBrkx9Qq+2LPL7RC07PCNkdY/RHoK5uF\"\n                    pic = pic &amp; \"rxENxglzei1iRSQNrYA1vHmTLmp1YlhYPAntc7NqZMIdGJ+jRNwHL5q2TImFYRj9CqTFxq2QvFb8NRRFODdjV2hVEdn2WykEFjAxAltT6jwH0j00E1iAFNqZfAX4hqfh\"\n                    pic = pic &amp; \"pUZ1vssMfE2t5KU7cFOdVkAK8y7cQibF4EF9ZZcuk9mkU6yeNRfa6hXC6gianzF0zWbhNLEwdB96D3WJM1+rJ7QLMYugGVUQ2QLspBWYYvurvJc7Db/lagO7Bvcur6jz\"\n                    pic = pic &amp; \"LLRAOzIJbpZwN2xl/Qdi9b+NiglKP8EX2mRGLIWwBPEuUwJCaFlcPAxsAaCRcdhZmFSjCkQchse2s3Apz7WKRfBiHjc5RKLI6j4M6k+X0USATHSEa1S7SY8URF9bP6Se\"\n                    pic = pic &amp; \"iDLxTT5LUiyijcwyQRL+fHk8Nqo5dh471/+fKz7sP9inzsosrP0kHGcdPR4LKMLyljoNg8ZjT0RcRTFRb1IuonS3PodbR4NjFAbVM1Emb2RZ4WVSIfzeZq7iytIHxnEY\"\n                    pic = pic &amp; \"5Q3IZEr5Ov1j6hCeYaP+PqZULfFRkYVUSEHjQluCP/MsSsVlPbkydBnNQNaMfIoLbf5L+D3P79D0jD5xN39G/oh4PBYwuaa7bFg81n3w6UqRrU/gE7XxOEwdjWYge+G8\"\n                    pic = pic &amp; \"mHzjzWpYgekKH42X5HsbZPFKV+Ft1CLRcZgHtvAIq4dlSwudF3Ghbf4AUxZisyqJ7BgcICxeTSduSawjYr0NIqlSM/LWrtUuW7u8e+B64UVt0iJxGRWPBYjnK4WJxWNt\"\n                    pic = pic &amp; \"8FJTpQuFJkbkRO15DU2OSPp7cItmtMLHZTgTEXEYWV5IKE1gxMSVhc7Xd6+1bO0yfAZCdUQ29G+yBlXT3qnOwog4Lo8VoZBC81L1/lFOsPRDvXIfbbZoFRp0lUbjMjoe\"\n                    pic = pic &amp; \"U0StHxaPaRObsI7NrydMol44mXOF1yyqAZM36Dgs82ZOKTQvVe8f5RjTt95SXJnfm6AqIqvtjPna2zqgVp1aY4AWdZjtE2XBbbTmzCgiYKn8qFXQ4rHGtshrItYPc4ui\"\n                    pic = pic &amp; \"qXsqPkmRfEDLD1RsiNDVQBfcs5IqaYK55whBLdA/7GUUw1RFZA+3Z13bstIPdVRShSQoSFsUG5bKr7BMusUZ7HpPe03Y+mFuoDYJMSEKV7GjXp3GIQTbpU7DUJnRvWDy\"\n                    pic = pic &amp; \"5tUU7irmnicRFKTtiq1qiY+9pu5DPDuajC82G7U6vPsjZJk0iyOFoKf/y0VpLB7TM3crpdvqLMyTaFnhgWDzClxKUUqgYspkfLHZKldUQWTdUJsrgZAVGWd9C48eVkND\"\n                    pic = pic &amp; \"tk/YsWiFhifVWZkgY6jFYyq20tL/QVEajceiqfu8NEOHVkgPCz2OlNYyA1iWVUfGWZfgfeT3T0O2coXOvrFkPgU48KVMaGQRW96CtAKLFVTGUIvHgtiq/olIXOQXpbEk\"\n                    pic = pic &amp; \"CZZowISdnlVYRlL/3Q3GvphdVv+bsvWpBYaflwmNLGKzU5DeZyILCMRmJridJQsiw2IFL1uHxGNBbKXFRX7iQS9a66l7GqJ75L5D1sMwt68I55ZM2rwCsZkJLp3Fjmef\"\n                    pic = pic &amp; \"iixMWHAJolssWtkVoHd/CNGsY/GYOkWEObl2QU/LUzUpzRJKUmYIicyki6whhl8PI0oJqa1ZlLDgEkSn1SXN2V8i8+625afoN0nXzxcd2nkyv2xn6w0y6ScXI0XXiGC0\"\n                    pic = pic &amp; \"GtvqjF5DIrruqQxhmrgGr9tl6KDPQqgeFi4Wl0lhzYItPeKgt+z4okM7XNCuHDP2gcj8+0R64gptIE3qRUQ7Tw53QI06zQXalR8hIhi8XlUJXT8i0tmJloBosrWeXMGp\"\n                    pic = pic &amp; \"vB6Ta5iF00pY4S09SZ0qWLOAjWvNLTI7cYpLiBrZ/Bj8RqblV+D36/r6DcJlsSIyNJVfiSYYwhqVibcuWIOyZwnm6JrT9BzecTHYRbdiuaS/8zjq9urWjBBkbOr/Lkyt\"\n                    pic = pic &amp; \"IQsK5R0YYCCyAtRisUqkQ357ykXNPB91/zmmziqRHR6620hvKI3tVDEk3jJhqW9i4gQ0J+zPojogxMQb0HYD+5YA3YvVeBxO7oWriNHwGpxCrZm+zw5fVGRaHnMb6Vsa\"\n                    pic = pic &amp; \"2MiiWnAXg84I/9j6Sj18PzHwJpnM2Dn7wu7v7h/UhlK6qTkTcZaJSGCg7owieTL0wvmn8InnWYMZ5V55B9EzKKiWFQvArRmSam8aIpMZ3k7v3WuVB31Lg1Mx92FJi5El\"\n                    pic = pic &amp; \"e+RoUlQgsJSBs0sBDnx0JldPZO3omxk7RihiLBPhotDWL2XqvukdYvtKOuTNf2w3zxpDWLOFxYmINWuB4R5MkOnpPjQU7x2kxMiS1fzrSPJEtZWBs428EeonuNuYBLb3\"\n                    pic = pic &amp; \"zQaUS0MmMCjrR6XuEfp7qH1iCZA7kPee1NZMCPIz0nrHk3Q3MRPM3EUxUf9B7Bx+IBgYA2qHN4XcT+ZCYB5onBTXioS3OJkG51Jotwwmn7e/KuZWa3sOkZ3VrZlAWO+4\"\n                    pic = pic &amp; \"nd4Y8nptLijGMZncOUxO1MNn4DFr9yt0RbBXLE5s8r6PfnHa7S2/EdHEWiU8K0mn7mPwJp8QTx/lUpVvSVB1F1FDuIJd2CJBtUEFe8XixObueh/K9T9tMgyTiIXsIsMw\"\n                    pic = pic &amp; \"cbDIGMYxLDKGcQyLjGEcwyJjGMewyBjGMSwyhnEMi4xhHMMiYxjHsMgYxjEsMoZxDIuMYRzDImMYx7DIGMYxLDKGcQyLjGEcwyJjGKcA/A2KokblWzrduAAAAABJRU5E\"\n                    pic = pic &amp; \"rkJggg==\"\n\n                    newNode.Text = pic\n\n                    onApp.UpdatePageContent pageDoc.XML\n\n                End If\n            End If\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8985059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaef43d0b8871c461f88780a1548c251?s=128&d=identicon&r=PG&f=1", "display_name": "SueYung", "link": "https://stackoverflow.com/users/8985059/sueyung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1540, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511757702, "creation_date": 1511323891, "last_edit_date": 1511327465, "question_id": 47426666, "link": "https://stackoverflow.com/questions/47426666/using-vba-to-paste-excel-picture-into-onenote", "title": "Using VBA to Paste Excel Picture into OneNote", "body": "<p>I'm looking to use VBA via Excel to copy cells from a spreadsheet and paste it on as a picture on OneNote.  Is this possible?</p>\n\n<p>Below is the code I've been working on (it doesn't include the the excel cell copy portion) I have very little experience with XML and am unsure of what exactly I need to code in XML to have the image pasted from excel into the body of a OneNote page:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub PasteToOneNote()\n\n' Connect to OneNote 2010.\n' OneNote will be started if it's not running.\nDim oneNote As OneNote14.Application\nSet oneNote = New OneNote14.Application\n\nDim OpenedFile As String\n\n'Open OneNote file and creates an output ID to call on the file (OpenedFile)\noneNote.OpenHierarchy bstrPath:=\"File Path\", _\n                  bstrRelativeToObjectID:=\"\", _\n                  pbstrObjectID:=OpenedFile\n\n'Use the output ID from OpenHierarchy to open OneNote file\noneNote.NavigateTo bstrHierarchyObjectID:=OpenedFile, _\n                    bstrObjectID:=\"\", _\n                    fNewWindow:=False\n\nDim XMLSectionFile As String\n\n'OneNote's GetHierarchy method allows you to get meta-data and data about the OneNote Notebooks.\n'Takes data and puts into XML output\noneNote.GetHierarchy bstrStartNodeId:=OpenedFile, _\n                     hsScope:=hsPages, _\n                     pbstrHierarchyXMLOut:=XMLSectionFile\n\n'Use the MSXML Library to parse the XML\n\nDim secDoc As MSXML2.DOMDocument\nSet secDoc = New MSXML2.DOMDocument\n\nIf secDoc.LoadXML(XMLSectionFile) Then\n\n'Select all section nodes\nDim pageNodes As MSXML2.IXMLDOMNodeList\nSet pageNodes = secDoc.DocumentElement.SelectNodes(\"//one:Page\")\n\n'Loop through each page to find the page that has the same title as \"ABC\" then paste picture\n\nDim node As MSXML2.IXMLDOMNode\nDim pageName As String\nDim pageID As String\n\nFor Each node In pageNodes\n    pageName = node.Attributes.getNamedItem(\"name\").Text\n\n    If pageName = \"ABC\" Then\n        'Get pageID and load page's XML output\n        pageID = node.Attributes.getNamedItem(\"ID\").Text\n\n        Dim XMLPageFile As String\n\n        oneNote.GetPageContent bstrPageID:=pageID, _\n                               pbstrPageXMLout:=XMLPageFile\n\n        ' Load Page's XML into a MSXML2.DOMDocument object.\n\n        Dim pageDoc As MSXML2.DOMDocument\n        Set pageDoc = New MSXML2.DOMDocument\n\n        If pageDoc.LoadXML(XMLPageFile) Then\n            ' Get Page Node.\n            Dim pagenode2 As MSXML2.IXMLDOMNode\n            Set pagenode2 = pageDoc.SelectSingleNode(\"//one:Page\")\n\n            Dim newElement As MSXML2.IXMLDOMElement\n            Dim newNode As MSXML2.IXMLDOMNode\n\n            ' Create Outline node.\n            Set newElement = pageDoc.createElement(\"one:Outline\")\n            Set newNode = pagenode2.appendChild(newElement)\n\n            ' Create OEChildren.\n            Set newElement = pageDoc.createElement(\"one:OEChildren\")\n            Set newNode = newNode.appendChild(newElement)\n\n            ' Create OE.\n            Set newElement = pageDoc.createElement(\"one:OE\")\n            Set newNode = newNode.appendChild(newElement)\n\n            ' Create TE.\n            Set newElement = pageDoc.createElement(\"one:T\")\n            Set newNode = newNode.appendChild(newElement)\n\n            ' Add the image for the Page's content.\n            ?? \n\n            oneNote.UpdatePageContent pageDoc.XML\n\n\n        End If\n\n    End If        \n\nNext\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511322631, "post_id": 47426364, "comment_id": 81807716, "body": "I think you want the <code>?</code> wildcard (which matches a single character) rather than the <code>*</code> wildcard (which matches multiple characters).  I assume that, if <code>*</code> is permitted in a <code>Find</code>, <code>?</code> will be permitted too."}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1511323011, "post_id": 47426364, "comment_id": 81807811, "body": "Do this in a loop for every cell in the range <code>if cell.value like &quot;pie??&quot; then cell.Replace &quot;pie&quot;, &quot;hi&quot;, LookAt:=xlPart</code>. This should only replace text in a cell with &quot;pie&quot; followed by 2 characters and will only replace the &quot;pie&quot; part of the text. I think this is what you want?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511323827, "post_id": 47426364, "comment_id": 81808001, "body": "Well I just learned that if I accidentally triple click a comment&#39;s &quot;upvote&quot; then the upvote doesn&#39;t count and can <i>never</i> be up-voted again. &lt;sub&gt;(silly.)&lt;/sub&gt;  Anyhow, **+1++ to what @YowE3K said.  Your statement <code>sees the wildcard instead of just picking anything</code> is self-contradictory since <i>that&#39;s what wildcards do</i> but you indeed probably meant <code>?</code>.  Here are the basics on <a href=\"http://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/wildcard-characters-used-in-string-comparisons\" rel=\"nofollow noreferrer\">&quot;Wildcard Characters used in VBA String Comparisons&quot;</a>."}, {"owner": {"reputation": 11, "user_id": 8910431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf68ed8fbcf3e748ed63d7a0a321076?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleK", "link": "https://stackoverflow.com/users/8910431/simplek"}, "edited": false, "score": 0, "creation_date": 1511324902, "post_id": 47426364, "comment_id": 81808244, "body": "I tried replacing the &quot;*&quot; with a &quot;?&quot;. However, I still run into the same issue. Also, I&#39;m not to familiar with VBA to add the <code>if cell.value like &quot;pie??&quot; then cell.Replace &quot;pie&quot;, &quot;hi&quot;, LookAt:=xlPart</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8910431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf68ed8fbcf3e748ed63d7a0a321076?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleK", "link": "https://stackoverflow.com/users/8910431/simplek"}, "edited": false, "score": 0, "creation_date": 1511332926, "post_id": 47426940, "comment_id": 81810989, "body": "It worked! Thanks for the fix. I don&#39;t have enough comments/posts to up vote."}], "tags": [], "owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "is_accepted": false, "score": 2, "last_activity_date": 1511325714, "creation_date": 1511325714, "answer_id": 47426940, "question_id": 47426364, "link": "https://stackoverflow.com/questions/47426364/vba-replace-text-without-replacing-other-words-that-contain-similar-text/47426940#47426940", "title": "VBA replace text without replacing other words that contain similar text", "body": "<pre><code>For each cell in Range(\"F1\", Range(\"F1\").End(xlDown))\n    If cell.value like \"pie??\" then cell.Replace \"pie\", \"hi\", LookAt:=xlPart\nNext\n</code></pre>\n\n<p>This is untested</p>\n"}], "owner": {"reputation": 11, "user_id": 8910431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf68ed8fbcf3e748ed63d7a0a321076?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleK", "link": "https://stackoverflow.com/users/8910431/simplek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511325714, "creation_date": 1511321642, "last_edit_date": 1531164843, "question_id": 47426364, "link": "https://stackoverflow.com/questions/47426364/vba-replace-text-without-replacing-other-words-that-contain-similar-text", "title": "VBA replace text without replacing other words that contain similar text", "body": "<p>I'm trying to use \"*\" as a wildcard for data in Column F. All the data is in the same format and length as \"Pie**\" where each \"*\" represents (0-9)</p>\n\n<p>Example: Pie22, Pie71, Pie15, Hot22, Hot41, Hot98</p>\n\n<p>When I try the code below, I run into the issue where CoffeeXX is finding and replacing \"Hot\" in \"hotdog\" and it becomes \"chickendog\".</p>\n\n<p>Is there a was to fix this so that the .find sees the wildcard instead of just picking anything that contains the text?</p>\n\n<pre><code>Set PieXX = Columns(\"F\").Find(What:=\"Pie**\", Lookin:=xlvalues)\nIf not PieXX is nothing then\nColumns(\"F\").Replace What:\"Pie**\", replacement:=\"Hotdog\", _\nSearchOrder:=xlbyrows, Matchcase:=False, SearchFormat:=False, Replaceformat:=false\nEnd If\n\n    Set CoffeeXX = Columns(\"F\").Find(What:=\"Hot**\", Lookin:=xlvalues)\nIf not CoffeeXX is nothing then\nColumns(\"F\").Replace What:\"Hot**\", replacement:=\"Chicken\", _\nSearchOrder:=xlbyrows, Matchcase:=False, SearchFormat:=False, Replaceformat:=false\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 4, "creation_date": 1511311545, "post_id": 47424868, "comment_id": 81805117, "body": "Why not just use conditional formatting? Anyways, replace &#39;&amp;&#39; with &#39;And&#39; in your <code>If...Then</code> statement and see what that does. (Conditional Formatting is <i>much</i> faster than any macro)."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1511312014, "post_id": 47424868, "comment_id": 81805234, "body": "Also, you don&#39;t need any of those <code>.value</code> properties"}, {"owner": {"reputation": 2490, "user_id": 7512742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/muuJz.png?s=128&g=1", "display_name": "Adam Vincent", "link": "https://stackoverflow.com/users/7512742/adam-vincent"}, "edited": false, "score": 1, "creation_date": 1511312828, "post_id": 47424868, "comment_id": 81805479, "body": "You have lots of syntax issues.<code>If condition1 And condition2 Then</code>.. (&amp; is  concatenation).  Also, within your <code>With</code> block, you&#39;ll want to use <code>.Cells()</code> instead of <code>Cells()</code> You declare variable <code>c</code> and never use it. Lastly, you turn on <code>Application.ScreenUpdating</code>, but you&#39;re not setting it to <code>false</code> at any point in the function."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1511333369, "creation_date": 1511333369, "answer_id": 47428442, "question_id": 47424868, "link": "https://stackoverflow.com/questions/47424868/vba-program-not-running-correctly/47428442#47428442", "title": "VBA program not running correctly", "body": "<p>All the above comments were good, but I thought I'd put it all together.<br>\nYou need to change \"&amp;\" to \"And\".<br>\nRemove; the \"Dim c\" line, \"c = Cells\" line, and \"Application.ScreenUpdating\" line.<br>\nI'm running Excel 2010; your code works with the above changes, using either the \".Cells\" or \"Cells\" in the \"If\" statement.<br>\nI also removed \".Value\" from each Cell reference, it works with or without it.</p>\n\n<pre><code>Dim r As Integer\n'Dim c As Integer\n\n    With Worksheets(1)\n\n    For r = 1 To Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        'c = Cells(r, Columns.Count).End(xlToLeft).Column\n\n        If Cells(r, 3) = Cells(r, 6) And Cells(r, 4) = Cells(r, 7) Then\n            Cells(r, 13).Interior.ColorIndex = 46\n            'Application.ScreenUpdating = True\n\n        End If\n    Next r\n\n    End With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8983307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14fa68b43f3719672e39d7253b3ccabb?s=128&d=identicon&r=PG&f=1", "display_name": "The_Dawgz", "link": "https://stackoverflow.com/users/8983307/the-dawgz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 47428442, "answer_count": 1, "score": 0, "last_activity_date": 1511333369, "creation_date": 1511309760, "last_edit_date": 1531164843, "question_id": 47424868, "link": "https://stackoverflow.com/questions/47424868/vba-program-not-running-correctly", "title": "VBA program not running correctly", "body": "<p>I've set up a VBA program in excel that will highlight a cell in a row when the condition of several cells in a given row are equal to each other. (see code below) There are no errors appearing on the debugger, and the designated cell isn't getting highlighted. </p>\n\n<p>In my sample data below, the program would highlight a cell in Case 1's row (since 1=1) and (10=10). Any suggestions on how to get this working?</p>\n\n<pre><code>Sub x()\n\nDim r As Integer\nDim c As Integer\n\n\nWith Worksheets(1)\n\nFor r = 1 To .Range(\"B\" &amp; Rows.Count).End(xlUp).row\n    c = .Cells(r, Columns.Count).End(xlToLeft).Column\n\n    If Cells(r, 3).Value = Cells(r, 6).Value &amp; Cells(r, 4).Value = Cells(r, 7).Value Then\n        Cells(r, 13).Interior.ColorIndex = 46\n        Application.ScreenUpdating = True\n\n        End If\nNext r\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Sample Data: </p>\n\n<pre><code>Case_1   HT 1   10  STD 1   10  0.008893    0.02564 71  0.35    0.7297\nCase_2   HT 1   10  HT  1   15  -0.04434    0.02564 71  -1.73   0.0881\nCase_3  HT  1   10  STD 1   15  0.008893    0.02564 71  0.35    0.7297\n</code></pre>\n"}, {"tags": ["excel", "vba", "character-encoding", "vb6"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511307239, "post_id": 47424463, "comment_id": 81803852, "body": "How is the data in your database encoded?  If you replace &quot;special&quot; characters in your SQL will that cause problems?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1511307403, "post_id": 47424463, "comment_id": 81803912, "body": "The <code>\u2019</code> seems to be ChrW(8192)."}, {"owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 0, "creation_date": 1511309438, "post_id": 47424463, "comment_id": 81804508, "body": "You have a Unicode character &quot;PRIVATE USE TWO&quot; I don&#39;t know if this helps you, but more information can be found here: <a href=\"http://www.fileformat.info/info/unicode/char/92/index.htm\" rel=\"nofollow noreferrer\">fileformat.info/info/unicode/char/92/index.htm</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511320847, "post_id": 47424463, "comment_id": 81807334, "body": "Can you share an example of the Excel file, and of how it <b>should</b> look in SQL?  It&#39;s a lot easier to others to help out if they don&#39;t have to speculate what the start and end points look like.  What purpose do these &quot;invisible characters&quot; serve in SQL (that isn&#39;t necessary in Excel)?  Where did this &quot;weird&quot; Excel source file come from?  Another application?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511320932, "post_id": 47424463, "comment_id": 81807356, "body": "I&#39;ll bet @Jeeped didn&#39;t actually have that Unicode i.d. memorized.  I bet we can find out how he knew that if we Google it.  ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511322239, "post_id": 47424463, "comment_id": 81807632, "body": "@ashleedawg - in xl2013 or higher paste that <code>\u2019</code> character into A1 then in B1 use <code>=unicode(a1)</code>. I had copied the char directly from the OP&#39;s code block. <a href=\"https://stackoverflow.com/posts/47424463/edit\">edit</a> weird. I just redid it and now it shows 8217."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511323267, "post_id": 47424463, "comment_id": 81807877, "body": "@Jeeped - I hope you realize my comment was meant as a hint to the OP that some helpful exisiting hints &amp; answers are not hard to find at this point?  Kind of meant as a tongue-in-cheek silent +1.  :-)  I&#39;m experimenting with ways of politely pointing certain new-member Q&#39;s to existing A&#39;s. (I enjoy &quot;giving back&quot; by helping other newbies but I&#39;m now seeing a pattern that veterans such as yourself can become frustrated with at times...)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511323894, "post_id": 47424463, "comment_id": 81808019, "body": "@ashleedawg - sorry for stepping in it. I completely agree and have adopted a similar attitude myself."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511327135, "post_id": 47424463, "comment_id": 81808838, "body": "@Jeeped - np, you don&#39;t have to be sorry for stepping in when I&#39;m using your comment as my &quot;prop&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1511310857, "creation_date": 1511310857, "answer_id": 47425016, "question_id": 47424463, "link": "https://stackoverflow.com/questions/47424463/replace-weird-or-special-character-in-a-string/47425016#47425016", "title": "Replace weird or special character in a string", "body": "<p>Instead of trying to eliminate various junk characters, try to focus on keeping only the good ones.  Say we know valid characters are upper and lower case letters, numbers, and the underscore.  This code will keep only the good ones:</p>\n\n<pre><code>Public Function KeepOnlyGood(s As String) As String\n    Dim CH As String, L As Long, i As Long\n    KeepOnlyGood = \"\"\n    L = Len(s)\n        For i = 1 To L\n        CH = Mid(s, i, 1)\n        If CH Like \"[0-9a-zA-Z]\" Or CH = \"_\" Then\n            KeepOnlyGood = KeepOnlyGood &amp; CH\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/iZACJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iZACJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to replace junk with a <em>space</em>, the code can be modified to do just that.</p>\n"}], "owner": {"reputation": 21, "user_id": 8982725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4591468a102dd0028a6c522522142042?s=128&d=identicon&r=PG&f=1", "display_name": "Renaud Albert", "link": "https://stackoverflow.com/users/8982725/renaud-albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1592739870, "creation_date": 1511307026, "last_edit_date": 1592739870, "question_id": 47424463, "link": "https://stackoverflow.com/questions/47424463/replace-weird-or-special-character-in-a-string", "title": "Replace weird or special character in a string", "body": "<p>I'm trying to convert a Excel file into a SQL query. My problem is that there are special characters in the file I was given. I cant replace them CTRL+H because they dont show at all in the Excel file. When I write my query(either in utf8 or ANSI), they show. With Ultra-Edit, they show as HEX C2 92. With Notepad++ in utf8, they show as PU2. In ANSI, they show as \u00c2\u2019. I suspect it's an apostrophe. This is a french file by the way.</p>\n\n<p>So far I tried to put it in a string and do these operations, but nothing worked.</p>\n\n<pre><code>Dim Line as String\n\nLine = Wb.Worksheets(1).Cells(LineNo, ColNo)\n\nLine = Replace(Line, \"\u00c2\u2019\", \"''\")\nLine = Replace(Line, \"\u2019\", \"''\")\nLine = Replace(Line, \"\u00c2\", \"''\")\nLine = Replace(Line, Chr(194) &amp; Chr(146), \"''\") 'decimal value of C2 92\nLine = Replace(Line, Chr(146) &amp; Chr(194), \"''\") 'inverted decimal value of C2 92\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word", "save"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8982678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d43cce95d7a8b4ee01af4fdba9faa2?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8982678/patrick"}, "edited": false, "score": 0, "creation_date": 1511382261, "post_id": 47431592, "comment_id": 81841647, "body": "Variatus, Thank you very much for your help. Your code didn&#39;t work with the existing file but when I &quot;recreated&quot; the document (copy and pasted all content in the document and the code over to a new document) things worked much better (not sure why that would happen, and it makes me a little uneasy that whatever changed in the original file could change again at some point in the new file, but that&#39;s another matter)."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 13, "user_id": 8982678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d43cce95d7a8b4ee01af4fdba9faa2?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8982678/patrick"}, "edited": false, "score": 0, "creation_date": 1511399902, "post_id": 47431592, "comment_id": 81847709, "body": "I&#39;m pretty sure its the initialisation of the WdApp variable which caused the problem. You can always run the Document_Open proc, which initialises the variable, with F5. You can also test for WdApp being active by writing a little sub with, <code>Debug.Print WdApp Is Nothing</code> in the ThisDocument sheet and run it with F5. It will print False to the Immediate Window if the variable is initialised. Once it is, its events will fire for every document."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1511344702, "creation_date": 1511344702, "answer_id": 47431592, "question_id": 47424169, "link": "https://stackoverflow.com/questions/47424169/disable-save-as-but-not-save-in-word-2010/47431592#47431592", "title": "Disable Save As but not Save in Word 2010", "body": "<p>The Word application has a <code>DocumentBeforeSave</code> event. To enable application events I suggest to create a class module by the name of <code>ThisApplication</code> and paste the following code into it.</p>\n\n<pre><code>Option Explicit\n\n    Private WithEvents App As Application\n\nPrivate Sub Class_Initialize()\n    Set App = Word.Application\nEnd Sub\n\nPrivate Sub App_DocumentBeforeSave(ByVal Doc As Document, _\n                                   SaveAsUI As Boolean, _\n                                   Cancel As Boolean)\n    If SaveAsUI Then\n        MsgBox \"Please always use the \"\"Save\"\" command\" &amp; vbCr &amp; _\n               \"to save this file.\", _\n               vbExclamation, \"SaveAs is not allowed\"\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>Add the following code to your <code>ThisDocument</code> module.</p>\n\n<pre><code>    Dim WdApp As ThisApplication\n\nPrivate Sub Document_Open()\n    Set WdApp = New ThisApplication\nEnd Sub\n</code></pre>\n\n<p>You may add the <code>Set App = ...</code> line to your existing <code>Document_Open</code> procedure. After the WdApp variable has been initialised all application events will be received by the <code>ThisApplication</code> class where the <code>DocumentBeforeSave</code> event procedure is programmed not to allow <code>SaveAs</code>.</p>\n\n<p>Of course, this is a blanket refusal for all documents. Therefore you may wish to add code to the procedure to limit the restriction to certain documents only. The proc receives the entire document object with all its properties, including Name, Path, FullName and built-in as well as custom properties. You can identify the files you wish to be affected by any of these.</p>\n\n<p>Note that the <code>WdApp</code> variable will be erased in case of a program crash. If this happens the application events will no longer fire. It may be useful to know that application events occur before document events. This is if you wish to use the application's <code>DocumentOpen</code> event as well as or instead of the document's <code>Document_Open</code> event.</p>\n"}], "owner": {"reputation": 13, "user_id": 8982678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d43cce95d7a8b4ee01af4fdba9faa2?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8982678/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "accepted_answer_id": 47431592, "answer_count": 1, "score": 1, "last_activity_date": 1593889245, "creation_date": 1511305329, "last_edit_date": 1593889245, "question_id": 47424169, "link": "https://stackoverflow.com/questions/47424169/disable-save-as-but-not-save-in-word-2010", "title": "Disable Save As but not Save in Word 2010", "body": "<p>I am looking to disable Save As in a Word 2010 file but still allow save. In other words I want users to be able to update the existing file but not create copies. I realize that this is impossible to truly do for people who know workarounds but for the general user I have successfully done this in Excel but am pretty new to word VBA. </p>\n\n<p>When I add the following to a brand new document everything works as intended:</p>\n\n<pre><code>Sub FileSaveAs()\nMsgBox \"Copies of this file cannot be created. Please save changes in the original document.\" &amp; _\n, , \"Copy Cannot be Created\"\nEnd Sub\n</code></pre>\n\n<p>My document has other macros for various command buttons but none of them involve saving the document (under original name or save as). There is also a macro running on open but that is 1 line going to a bookmark. When I try to \"save as\" in this document I get the message box as intended. When I try to \"save\" though things get strange: I get the save as dialogue (problem 1). Whether I try to save either under same name or other name the dialogue behaves as it normally would except it doesn't save and the dialogue box opens again automatically essentially creating an endless loop until I hit cancel (problem 2). I also intermittently get a \"disk is full\" warning pop-up after trying to save which I can dismiss but appears a few minutes later as long as he file is open (perhaps related to autosave?) </p>\n\n<p>Since the macro works in the test file I assumed this strange behavior must be something elsewhere in my code but my document with the other macros saves normally as long as I don't include the save as code above so now I'm totally confused. Before I put up the rest of my code which is lengthy and for the reasons stated above I would not think impact things, I figured I'd ask this:<br>\n1. Is there any place other than my other command button macros that could be causing this behavior?<br>\n2. Is there a better method people recommend to achieve my ultimate goal of disabling save as but not save?</p>\n\n<p>Thanks in advance for any advice you can provide.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511303003, "post_id": 47423750, "comment_id": 81802322, "body": "Try <code>Summary.Cells(Rows.Count,1).End(xlUp).Offset(1)</code>. Plus what Scott said."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1511303655, "last_edit_date": 1511303655, "creation_date": 1511303315, "answer_id": 47423833, "question_id": 47423750, "link": "https://stackoverflow.com/questions/47423750/loop-not-inserting-values-on-to-a-summary-sheet/47423833#47423833", "title": "Loop not Inserting Values on to a Summary Sheet", "body": "<p>When assigning the values directly the ranges must be the same size. </p>\n\n<p>You are trying to equate a row number to an array.</p>\n\n<blockquote>\n  <p><code>Summary.Cells(Rows.Count,1).End(xlUp).Row+1</code></p>\n</blockquote>\n\n<p>returns a row number as a Long not a Range.</p>\n\n<p>To get the first cell we use, as per SJR's comment:</p>\n\n<pre><code>Summary.Cells(Rows.Count, 1).End(xlUp).Offset(1)\n</code></pre>\n\n<p>Then we need to resize that to the same size as the input range.</p>\n\n<pre><code>Summary.Cells(Rows.Count, 1).End(xlUp).Offset(1).Resize(11, 66).Value\n</code></pre>\n\n<p>use </p>\n\n<pre><code>Sub Compile()\n\nDim ws As Worksheet\nDim Summary As Worksheet\n\nSet Summary = ThisWorkbook.Sheets(\"Sheet1\") 'This does not match the skipped sheet name.\n\nFor Each ws In ThisWorkbook.Sheets\n    If Not ws.Name = \"Summary\" Then 'Should this be \"Sheet1\" or Summary.Name\n        Summary.Cells(Rows.Count, 1).End(xlUp).Offset(1).Resize(11, 66).Value = ws.Range(\"BB1:DO11\").Value\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1511303974, "post_id": 47423912, "comment_id": 81802739, "body": "Pish... let the OP decide which they like better, personally your approach is easier to read and maintain, besides I already maxed out today."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511304431, "post_id": 47423912, "comment_id": 81802950, "body": "@Scott Craner - ha, don&#39;t tell me there&#39;s a daily limit."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511304539, "post_id": 47423912, "comment_id": 81802981, "body": "yup, I am not certain of all the rules but after 300 you can only get points for correct answers.  The upvotes just stop adding to your score for that day."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511304814, "post_id": 47423912, "comment_id": 81803095, "body": "Ah ok. I doubt I will ever have that problem."}, {"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511362109, "post_id": 47423912, "comment_id": 81829430, "body": "@ScottCraner ,SJR Thank you both very much. Its really helpful to have such a responsive and generous community to help out. I swear I feel like everytime I understand something, I hit a situation where it feels like I&#39;m learning for the first time. Much appreciated!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1511303743, "creation_date": 1511303743, "answer_id": 47423912, "question_id": 47423750, "link": "https://stackoverflow.com/questions/47423750/loop-not-inserting-values-on-to-a-summary-sheet/47423912#47423912", "title": "Loop not Inserting Values on to a Summary Sheet", "body": "<p>This is virtually the same as Scott's answer so if you are good enough to accept one, please accept his, but just shows a slightly different way of resizing the range.</p>\n\n<pre><code>Sub Compile()\n\nDim ws As Worksheet\nDim Summary As Worksheet\n\nSet Summary = ThisWorkbook.Sheets(\"Sheet1\")\n\nFor Each ws In ThisWorkbook.Sheets\n    If Not ws.Name = \"Sheet1\" Then  'I think this is right but may need to be 'Summary'\n        With ws.Range(\"BB1:DO11\")\n            Summary.Cells(Rows.Count, 1).End(xlUp)(2).Resize(.Rows.Count, .Columns.Count).Value = .Value\n        End With\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 47423912, "answer_count": 2, "score": 0, "last_activity_date": 1511303743, "creation_date": 1511302901, "last_edit_date": 1531164843, "question_id": 47423750, "link": "https://stackoverflow.com/questions/47423750/loop-not-inserting-values-on-to-a-summary-sheet", "title": "Loop not Inserting Values on to a Summary Sheet", "body": "<p>Trying to compile one list from 300 worksheets that are identically formatted. I want to paste/insert the values on this summary sheet so that after each iteration of the loop, the new data is placed in the next empty row, so that there is one single \"Master List\". I'm getting a \"type mismatch\" error on the  \"Summary.Cells\" line, 4th from the bottom.</p>\n\n<pre><code>Sub Compile()\n\nDim ws as Worksheet\nDim Summary as Worksheet\n\nSet Summary = ThisWorkbook.Sheets(\"Sheet1\")\n\nFor Each ws in ThisWorkbook.Sheets\n\nIf Not ws.Name = \"Summary\" Then\n\nSummary.Cells(Rows.Count,1).End(xlUp).Row+1 = ws.Range(\"BB1:DO11\").Value\n\nEnd If\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated, thanks,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 5, "creation_date": 1511303940, "post_id": 47423692, "comment_id": 81802725, "body": "<i>Is there a better way</i> - <b>YES!!</b>. Instead of the spaghetti style <code>GoTo</code> statements, use functions and built-in VBA (and programming in general) methods to error check for you. For example, <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists/#6688482\">WorksheetExists</a> can solve your first couple of lines.  You can also  break the code into component procedures and have the flow control in one procedure. Your code would be a lot easier to read and maintain."}, {"owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511318077, "post_id": 47423692, "comment_id": 81806689, "body": "Sounds good. I&#39;m about 4 months into VBA and don&#39;t know a lot of the syntax  still but I will remember that WorksheetExists method. As for breaking it up into component procedures, what do you mean by that? Lastly, by spaghetti style, I assume that is meaning how it kind of jumps around? I will keep all of this in mind going forward, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "edited": false, "score": 0, "creation_date": 1511319074, "post_id": 47424055, "comment_id": 81806914, "body": "Thanks for the comment/answer/advice and excuse my ignorance but for the refactoring, how would be the best way to do that? Also you&#39;re saying all of my programming should fit into one screen? Or I should have a sub for each individual task and then one sub calling them? This is probably my infancy with programming and just not understanding the best way/logic to do things but thanks for the help, I&#39;ll keep everything you said in mind in the future."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "edited": false, "score": 0, "creation_date": 1511319402, "post_id": 47424055, "comment_id": 81806986, "body": "@Adije in general you want to name a procedure after its purpose: if it&#39;s hard to find a good name for a procedure, it&#39;s likely because that procedure has too many responsibilities. To know where to break procedures, you need to take the bigger problem and decompose it into smaller problems; each smaller problem has its own concerns, and these even-smaller problems could be more, smaller <code>Private</code> procedures. Do that and you&#39;ll quickly move from &quot;God-procedure&quot; to structured procedural code, and eventually to object-oriented. Enjoy the ride!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1511304612, "creation_date": 1511304612, "answer_id": 47424055, "question_id": 47423692, "link": "https://stackoverflow.com/questions/47423692/object-variable-or-with-block-variable-not-set-with-my-on-error-goto/47424055#47424055", "title": "Object variable or with block variable not set, with my On Error GoTo", "body": "<pre><code>PN_SO_NotFound:\nSheets(DataWS).Cells(x, DSupplySourcecol) = \"N/A\"\nGoTo Updated\n</code></pre>\n\n<p>This. You're in an error-handling subroutine - the VBA runtime is in an error state, and you're <code>GoTo</code>-jumping all over the place.</p>\n\n<p>When execution goes to the <code>Updated</code> label after hitting <code>PN_SO_NotFound</code>, VBA is <em>still in an error state</em> because you never reset it. So as far as it understands your code, the <code>Updated</code> label is just another part of your error-handling subroutine.</p>\n\n<p>And while it thinks it's still handling a runtime error, it's not going to heed any <code>On Error</code> statements it encounters, because <em>it's already in an error state</em>.</p>\n\n<p>Replace <code>GoTo Updated</code> with <code>Resume Updated</code> and, well, honestly, <em>fingers crossed</em>, it should \"work\".</p>\n\n<p>But definitely consider some SERIOUS refactoring here. Spaghetti code like this isn't getting any easier to debug anytime soon without a serious series of refactorings: you'll know you're done when there's a grand total of 0 <code>GoTo</code> jumps and all procedures fit into a single screen, each doing one single thing.</p>\n"}, {"tags": [], "owner": {"reputation": 585, "user_id": 4381453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6GMuA.png?s=128&g=1", "display_name": "Sujoy", "link": "https://stackoverflow.com/users/4381453/sujoy"}, "is_accepted": false, "score": 1, "last_activity_date": 1511334832, "creation_date": 1511334832, "answer_id": 47428828, "question_id": 47423692, "link": "https://stackoverflow.com/questions/47423692/object-variable-or-with-block-variable-not-set-with-my-on-error-goto/47428828#47428828", "title": "Object variable or with block variable not set, with my On Error GoTo", "body": "<p>Instead of using only <code>On Error GoTo 0</code> use the combination of <code>On Error GoTo 0 : On Error Goto -1</code> to reset both the exception handler and the error state.</p>\n"}], "owner": {"reputation": 15, "user_id": 7822605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bba9ce95764a550a695fda756e5447?s=128&d=identicon&r=PG&f=1", "display_name": "Adije", "link": "https://stackoverflow.com/users/7822605/adije"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 47424055, "answer_count": 2, "score": 1, "last_activity_date": 1511334832, "creation_date": 1511302670, "question_id": 47423692, "link": "https://stackoverflow.com/questions/47423692/object-variable-or-with-block-variable-not-set-with-my-on-error-goto", "title": "Object variable or with block variable not set, with my On Error GoTo", "body": "<p>So I have code that loops through every row on one sheet (DataWS) and uses other sheets to find strings, if the strings are not found then I want the code to go to wherever the On Error tells it to. So if the part is not found on a worksheet, then go to (somewhere).\nIf the strings are found on a worksheet then the DataWS is updated or the found variable is used later on in the code to reference the row it was found on in the other sheets.</p>\n\n<pre><code>Sub MM011_to_Data()\n\nDim Dlr As Long, Dlc As Long, x As Long\nDim DataWS As String, MMWS As String, OmitWS As String\n\n\n    On Error GoTo DataSheetInvalid\n        Sheets(\"Data\").Activate\n        DataWS = Sheets(\"Data\").Name\n    On Error GoTo 0\n\n    On Error GoTo MM011SheetInvalid\n        MMWS = Sheets(\"MM011\").Name\n    On Error GoTo 0\n\n    On Error GoTo OmitSheetInvalid\n        OmitWS = Sheets(\"Omit Parts\").Name\n    On Error GoTo 0\n\n'********************BELOW ARE VARIABLES IN THE DATA SHEET********************\n\nDim DStatuscol As Integer, DSupplySourcecol As Integer, DPOcol As Integer, DPOIcol As Integer, DPRcol As Integer\nDim DPLOcol As Integer, DWillShipcol As Integer, DSOLIcol As Integer, DRelPNcol As Integer\n\nDStatuscol = Sheets(DataWS).Rows(1).Find(\"Status\", lookat:=xlWhole).Column\nDSupplySourcecol = Sheets(DataWS).Rows(1).Find(\"Supply Source\", lookat:=xlWhole).Column\nDPOcol = Sheets(DataWS).Rows(1).Find(\"PO#\", lookat:=xlWhole).Column\nDPOIcol = Sheets(DataWS).Rows(1).Find(\"PO Item\", lookat:=xlWhole).Column\nDPRcol = Sheets(DataWS).Rows(1).Find(\"PR#\", lookat:=xlWhole).Column\nDPLOcol = Sheets(DataWS).Rows(1).Find(\"PLO\", lookat:=xlWhole).Column\nDWillShipcol = Sheets(DataWS).Rows(1).Find(\"Will Ship\", lookat:=xlWhole).Column\nDSOLIcol = Sheets(DataWS).Rows(1).Find(\"CC SO/LI\", lookat:=xlWhole).Column\nDRelPNcol = Sheets(DataWS).Rows(1).Find(\"RELEASED PN\", lookat:=xlWhole).Column\n\n\n'********************BELOW ARE VARIABLES IN THE MM011 SHEET********************\n\nDim MMSupplySourcecol As Integer, MMInvcol As Integer, MMPOcol As Integer, MMPOIcol As Integer, MMPLOcol As Integer, MMPRcol As Integer\nDim MMPOShipDatecol As Integer, MMStatuscol As Integer, MMPNConcatcol As Integer\n\nMMPNConcatcol = Sheets(MMWS).Rows(1).Find(\"PN Concatenate\", lookat:=xlWhole).Column\nMMSupplySourcecol = Sheets(MMWS).Rows(1).Find(\"Supply Source\", lookat:=xlWhole).Column\nMMInvcol = Sheets(MMWS).Rows(1).Find(\"Inventory Qty\", lookat:=xlWhole).Column\nMMPOcol = Sheets(MMWS).Rows(1).Find(\"PO Number\", lookat:=xlWhole).Column\nMMPOIcol = Sheets(MMWS).Rows(1).Find(\"PO Item\", lookat:=xlWhole).Column\nMMPLOcol = Sheets(MMWS).Rows(1).Find(\"Supply Work Order\", lookat:=xlWhole).Column\nMMPRcol = Sheets(MMWS).Rows(1).Find(\"Requisition Number\", lookat:=xlWhole).Column\nMMPOShipDatecol = Sheets(MMWS).Rows(1).Find(\"Supply Delivery Calendar Date\", lookat:=xlWhole).Column\n\n\n'********************BELOW ARE THE VARIABLES IN THE OMIT SHEET********************\n\nDim OPNcol As Integer, OPNrow As Long\n\nOPNcol = Sheets(OmitWS).Rows(1).Find(\"Part Number\", lookat:=xlWhole).Column\n\n'********************LOOP TO UPDATE THE DATA SHEET********************\n\nDim DConcatPNSO As String, MMConcatrow As String\nDim SupplySource As String, PO_Number As String, PO_Item As String, PLO_WO As String, Requisition_Number As String, Supply_Del_Date As String\nDim DPartNumber As String\n\nDlr = Sheets(DataWS).Cells(Rows.Count, 1).End(xlUp).Row\nDlc = Sheets(DataWS).Cells(1, Columns.Count).End(xlToLeft).Column\n\n\n    For x = 2 To Dlr\n\n'DConcatPNSO is the variable for the Data WS which concatenates the Released PN and the SO LI\n        DConcatPNSO = Sheets(DataWS).Cells(x, DRelPNcol) &amp; \" \" &amp; Sheets(DataWS).Cells(x, DSOLIcol)\n        DPartNumber = Sheets(DataWS).Cells(x, DRelPNcol)\n\n'If there is no sales order then skip and say no sales order (NSO)\n        If Sheets(DataWS).Cells(x, DSOLIcol) = \"\" Then\n            Sheets(DataWS).Cells(x, DSupplySourcecol) = \"NSO\"\n        GoTo Updated\n        End If\n\n'Checks to see if the part is on the Omit list\n    On Error GoTo NotOmit\n        OPNrow = Sheets(OmitWS).Columns(OPNcol).Find(What:=DPartNumber, lookat:=xlWhole).Row\n    On Error GoTo 0\n\n    If OPNrow &gt; 0 Then\n        Cells(x, DSupplySourcecol) = \"Omit\"\n    GoTo Updated\n    End If\n\nNotOmit:\n\n        On Error GoTo PN_SO_NotFound\n            MMConcatrow = Sheets(MMWS).Columns(MMPNConcatcol).Find(DConcatPNSO, lookat:=xlWhole).Row\n        On Error GoTo 0\n\n'Hold all of the info from cells into variables\n            SupplySource = Sheets(MMWS).Cells(MMConcatrow, MMSupplySourcecol)\n            PO_Number = Sheets(MMWS).Cells(MMConcatrow, MMPOcol)\n            PO_Item = Sheets(MMWS).Cells(MMConcatrow, MMPOIcol)\n            PLO_WO = Sheets(MMWS).Cells(MMConcatrow, MMPLOcol)\n            Requisition_Number = Sheets(MMWS).Cells(MMConcatrow, MMPRcol)\n            Supply_Del_Date = Format(Sheets(MMWS).Cells(MMConcatrow, MMPOShipDatecol), \"MM/DD/YYYY\")\n\n'If the Supply Source is PO then do the below\n                If SupplySource = \"PO\" Then\n                    Sheets(DataWS).Cells(x, DStatuscol) = SupplySource &amp; \" \" &amp; Sheets(MMWS).Cells(MMConcatrow, MMPOcol) _\n                    &amp; \" \" &amp; Sheets(MMWS).Cells(MMConcatrow, MMPOIcol) &amp; \" \" &amp; Format(Sheets(MMWS).Cells(MMConcatrow, MMPOShipDatecol), \"MM/DD/YYYY\")\n                    Sheets(DataWS).Cells(x, DSupplySourcecol) = SupplySource\n                    Sheets(DataWS).Cells(x, DPOcol) = Sheets(MMWS).Cells(MMConcatrow, MMPOcol)\n                    Sheets(DataWS).Cells(x, DPOIcol) = Sheets(MMWS).Cells(MMConcatrow, MMPOIcol)\n                    Sheets(DataWS).Cells(x, DWillShipcol) = Format(Sheets(MMWS).Cells(MMConcatrow, MMPOShipDatecol), \"MM/DD/YYYY\")\n                GoTo Updated\n                End If\n\n'If the Supply Source is PLO then do the below\n                If SupplySource = \"PLO\" Then\n                    Sheets(DataWS).Cells(x, DStatuscol) = SupplySource &amp; \" \" &amp; Sheets(MMWS).Cells(MMConcatrow, MMPLOcol)\n                    Sheets(DataWS).Cells(x, DSupplySourcecol) = SupplySource\n                    Sheets(DataWS).Cells(x, DPLOcol) = Sheets(MMWS).Cells(MMConcatrow, MMPLOcol)\n                GoTo Updated\n                End If\n\n'If the Supply Source is PR then do the below\n                If SupplySource = \"PR\" Then\n                    Sheets(DataWS).Cells(x, DStatuscol) = SupplySource &amp; \" \" &amp; Sheets(MMWS).Cells(MMConcatrow, MMPRcol)\n                    Sheets(DataWS).Cells(x, DSupplySourcecol) = SupplySource\n                    Sheets(DataWS).Cells(x, DPRcol) = Sheets(MMWS).Cells(MMConcatrow, MMPRcol)\n                GoTo Updated\n                End If\n\n'If the Supply Source is BPL then do the below\n                If SupplySource = \"BPL\" Then\n                    Sheets(DataWS).Cells(x, DStatuscol) = SupplySource &amp; \" \" &amp; \"Borrow Payback Loan\"\n                    Sheets(DataWS).Cells(x, DSupplySourcecol) = SupplySource\n                GoTo Updated\n                End If\n\n'If the Supply Source is QA then do the below\n                If SupplySource = \"QA\" Then\n                    Sheets(DataWS).Cells(x, DStatuscol) = SupplySource &amp; \", PO is \" &amp; Sheets(MMWS).Cells(MMConcatrow, MMPOcol) _\n                    &amp; \" \" &amp; Sheets(MMWS).Cells(MMConcatrow, MMPOIcol) &amp; \" \" &amp; Format(Sheets(MMWS).Cells(MMConcatrow, MMPOShipDatecol), \"MM/DD/YYYY\")\n                    Sheets(DataWS).Cells(x, DSupplySourcecol) = SupplySource\n                    Sheets(DataWS).Cells(x, DPRcol) = Sheets(MMWS).Cells(MMConcatrow, MMPRcol)\n                GoTo Updated\n                End If\n\n\nUpdated:\n\n    Next x\n\nExit Sub\n\n'****************ERROR HANDLING****************\n\nDataSheetInvalid:\nMsgBox \"The worksheet with the MS2 All Open Order Report should be titled \"\"Data\"\".\" &amp; vbCr &amp; vbCr &amp; \"Please rename the worksheet and restart this sub.\", vbCritical, \"Worksheet Name\"\nExit Sub\n\nMM011SheetInvalid:\nMsgBox \"The worksheet with Cognos (MM011) data should be titled \"\"MM011\"\".\" &amp; vbCr &amp; vbCr &amp; \"Please rename the worksheet and restart this sub.\", vbCritical, \"Worksheet Name\"\nExit Sub\n\nOmitSheetInvalid:\nMsgBox \"The worksheet with Omit Parts data should be titled \"\"Omit Parts\"\".\" &amp; vbCr &amp; vbCr &amp; \"Please rename the worksheet and restart this sub.\", vbCritical, \"Worksheet Name\"\nExit Sub\n\nPN_SO_NotFound:\nSheets(DataWS).Cells(x, DSupplySourcecol) = \"N/A\"\nGoTo Updated\n\nEnd Sub\n</code></pre>\n\n<p>So within this code, the part that keeps getting the Run-Time Error is either one of these On Error handlers:</p>\n\n<pre><code>'Checks to see if the part is on the Omit list\n    On Error GoTo NotOmit\n        OPNrow = Sheets(OmitWS).Columns(OPNcol).Find(What:=DPartNumber, lookat:=xlWhole).Row\n    On Error GoTo 0\n\n    If OPNrow &gt; 0 Then\n        Cells(x, DSupplySourcecol) = \"Omit\"\n    GoTo Updated\n    End If\n\nNotOmit:\n\n        On Error GoTo PN_SO_NotFound\n            MMConcatrow = Sheets(MMWS).Columns(MMPNConcatcol).Find(DConcatPNSO, lookat:=xlWhole).Row\n        On Error GoTo 0\n</code></pre>\n\n<p>On the first loop they both work, but when it comes to any loop afterwards, I get the error.</p>\n\n<p>To fix these errors I used this code:</p>\n\n<pre><code> Set OPNrng = Sheets(OmitWS).Columns(OPNcol).Find(What:=DPartNumber, lookat:=xlWhole)\n    If OPNrng Is Nothing Then\n        GoTo NotOmit\n    Else\n        OPNrow = OPNrng.Row\n    End If\n\nIf OPNrow &gt; 0 Then\n    Cells(x, DSupplySourcecol) = \"Omit\"\nGoTo Updated\nEnd If\n\nNotOmit:\n\n    Set MMConcatrng = Sheets(MMWS).Columns(MMPNConcatcol).Find(DConcatPNSO, lookat:=xlWhole)\n    If MMConcatrng Is Nothing Then\n    GoTo PN_SO_NotFound\n    Else\n    MMConcatrow = MMConcatrng.Row\n    End If\n</code></pre>\n\n<p>Is there a reason why the \"On Error GoTo\" syntax was not working?? I cannot figure out why.\nAlso, is there a better way to do it besides what I have??</p>\n\n<p>If I can explain anything else further please let me know, I tried to give you the whole picture as well as the code separated out where I am having these issues.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511303289, "post_id": 47423593, "comment_id": 81802455, "body": "Post the code you&#39;ve tried."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511320006, "post_id": 47423593, "comment_id": 81807128, "body": "@srj added code to example"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511332075, "post_id": 47423593, "comment_id": 81810616, "body": "Is there always a full set of repeated items in Column A? i.e. 600,700,800,900 or multiples thereof e.g. 600,700,800,900,600,700,800,900?"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511358078, "post_id": 47423593, "comment_id": 81826555, "body": "@Qharr  I essentially need every line on the right for every value in A..  So if there are 4 values in column a  and 10 values on the right, each value in a should appear with every value from the right. So there would be 40 rows total on the sheet  (4x10=40)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511358398, "post_id": 47423593, "comment_id": 81826804, "body": "Give my answer a try and i will update if there are cases where it doesn&#39;t quite do what was expected."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511359457, "post_id": 47423593, "comment_id": 81827553, "body": "@QHarr When I run the macro, nothing happens. Not sure if theres some setting I need to have. I am using excel 2016"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511360217, "post_id": 47423593, "comment_id": 81828035, "body": "No. You put it in a standard module and make sure to change this line to the right worksheet  Set wsSource = wb.Worksheets(&quot;Sheet1&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511360233, "post_id": 47423593, "comment_id": 81828045, "body": "It is based on your data being set up as shown in the image in the question"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511362358, "post_id": 47423593, "comment_id": 81829625, "body": "@Qharr Hi When i do i get a subscript out of range error"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1511362482, "post_id": 47423593, "comment_id": 81829722, "body": "It happens at the worksheet name part"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511362712, "post_id": 47423593, "comment_id": 81829901, "body": "Did you change to the worksheet containing your data? Maybe Set wsSource = wb.Worksheets(&quot;Store_Item_copy&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511362762, "post_id": 47423593, "comment_id": 81829946, "body": "And is all the raw data in one sheet?"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1511363040, "post_id": 47423593, "comment_id": 81830183, "body": "I changed it to Set wsSource = ActiveSheet   and it worked thanks!.  Not sure why the naming wasn&#39;t working"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1511342206, "last_edit_date": 1511342206, "creation_date": 1511337427, "answer_id": 47429441, "question_id": 47423593, "link": "https://stackoverflow.com/questions/47423593/macro-copy-and-paste-a-single-row-for-every-cell-in-another-column-multiple-tim/47429441#47429441", "title": "Macro- Copy and paste a single row for every cell in another column multiple times", "body": "<p>Here is one way to do it using arrays. </p>\n\n<pre><code>Option Explicit\n\nPublic Sub PopulateColumns()\n\n    Dim wb As Workbook\n    Dim wsSource As Worksheet\n\n    Set wb = ThisWorkbook\n    Set wsSource = wb.Worksheets(\"Sheet1\")       'Change as appropriate\n\n    Dim yearArr()\n\n    yearArr = wsSource.Range(\"E2:F\" &amp; wsSource.Cells(wsSource.Rows.Count, \"E\").End(xlUp).Row).Value\n\n    Dim storesArr()\n\n    storesArr = wsSource.Range(\"A2:C\" &amp; wsSource.Cells(wsSource.Rows.Count, \"A\").End(xlUp).Row).Value\n\n    Dim resultArr()\n    ReDim resultArr(1 To UBound(storesArr, 1) * UBound(yearArr, 1), 1 To 3)\n\n    Dim counter As Long\n    Dim counter2 As Long\n    Dim x As Long, y As Long\n\n    For x = 1 To UBound(yearArr, 1)\n\n        counter2 = counter2 + 1\n\n        For y = 1 To UBound(storesArr, 1)\n\n            counter = counter + 1\n\n            resultArr(counter, 1) = storesArr(y, 1)\n            resultArr(counter, 2) = yearArr(counter2, 1)\n            resultArr(counter, 3) = yearArr(counter2, 2)\n\n        Next y\n\n    Next x\n\n    wsSource.Range(\"A2\").Resize(UBound(resultArr, 1), UBound(resultArr, 2)).Value = resultArr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 1, "accepted_answer_id": 47429441, "answer_count": 1, "score": -2, "last_activity_date": 1511342206, "creation_date": 1511302206, "last_edit_date": 1511334404, "question_id": 47423593, "link": "https://stackoverflow.com/questions/47423593/macro-copy-and-paste-a-single-row-for-every-cell-in-another-column-multiple-tim", "title": "Macro- Copy and paste a single row for every cell in another column multiple times", "body": "<p>I need help to copy and paste a single row for every cell in another column multiple times starting in the second row.</p>\n\n<p>The raw data looks like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/EqIbS.jpg\" alt=\"Raw Data\"></p>\n\n<p>I need it to look like this<br>\n<img src=\"https://i.stack.imgur.com/ZJrf0.jpg\" alt=\"\">\n<br></p>\n\n<pre><code> ActiveWorkbook.Names.Add Name:=\"data1\", RefersToR1C1:=\"=Sheet2!R2C5:R2C7\" \n ActiveWorkbook.Names(\"data1\").Comment = \"\" Range(\"data1\").Copy \n Range(\"B1\").Select ActiveCell.Offset(1, 0).Select ActiveCell.PasteSpecial \n</code></pre>\n\n<p>Here is where I get lost. I am not sure how to loop it down and then keep it going and copy column a down and then the defined range again. </p>\n\n<p>I also tried this: </p>\n\n<pre><code>    Dim LastRow As Variant\n    Dim LastRowA As Variant\n    Dim Row As Range\n    Dim i As Integer\n\n    With Sheets(\"Store_Item_copy\")\n        LastRow = .Range(\"A2\" &amp; Row.Count).End(xlUp).Row\n    End With\n\n    Range(\"A2\" &amp; LastRow).Copy\n\n    For i = 2 To LastRow\n\n        i = i + 1\n\n        With Sheets(\"Store_Item_copy\")\n            LastRowA = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        End With\n\n        LastRowA.Offset(1, 0).Select\n        ActiveCell.PasteSpecial\n\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "subroutine"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1511299404, "post_id": 47422930, "comment_id": 81800528, "body": "Because you need <code>Sheets(&quot;Sheet 3&quot;).Activate</code> before that line. You can&#39;t target a cell with activate when you&#39;re not on the sheet - even when you explicitly refer to the sheet name. It&#39;s working with <code>Sheet4</code> probably because that&#39;s your <code>Activesheet</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1511299455, "post_id": 47422930, "comment_id": 81800561, "body": "1.  please put the code itself in the question as text not a photo, we cannot copy paste a photo. 2.  There are better methods of finding the first empty cell in a column, that does not use a loop, which is the slowest method.  See here:<a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\" title=\"error in finding last used cell in vba\">stackoverflow.com/questions/11169445/&hellip;</a> 3. avoid <code>.Activate</code> and <code>.Select</code>, again they slow down the code.  See Here: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511299655, "post_id": 47422930, "comment_id": 81800672, "body": "<code>Rowcount = Worksheets(&quot;Sheet 3&quot;).Cells(Worksheets(&quot;Sheet 3&quot;).Rows.Count,3).End(xlUp).Row+1</code> will return the row after the last row with data in column C."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1511302495, "post_id": 47422930, "comment_id": 81802058, "body": "Just an aside to this, that entire function (although it doesn&#39;t need to be a function as you aren&#39;t passing anything to or from it, it could just be a sub) can be done in one line: <code>rowcount = Sheets(&quot;Sheet 3&quot;).Range(&quot;C&quot; &amp; rows.count).end(xlup).row</code> This avoids looping and selecting which is always a good thing Also, make sure you define rowcount as a long, not an integer"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1511301968, "post_id": 47423533, "comment_id": 81801802, "body": "fwiw, I find it odd that you would intentionally rename your worksheet just to put a space between <i>sheet</i> and <i>3</i>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1511301923, "creation_date": 1511301923, "answer_id": 47423533, "question_id": 47422930, "link": "https://stackoverflow.com/questions/47422930/run-time-error-1004-in-vba-subroutine/47423533#47423533", "title": "Run-Time Error &#39;1004&#39; in VBA Subroutine", "body": "<p>If you insist on using .Select and .Activate to accomplish your goals then you must activate the worksheet before activating or selecting a cell or range of cells on that worksheet.</p>\n\n<pre><code>worksheets(\"sheet 3\").activate\nactivesheet.range(\"c4\").activate\n</code></pre>\n\n<p>If you wish to use some 'shorthand' to try and accomplish this in a single line of code then switch to the Application.GoTo method.</p>\n\n<pre><code>Application.Goto reference:=worksheets(\"sheet 3\").range(\"c4\")\n</code></pre>\n\n<p>In any event, you are best off avoiding the use of select and activate. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/28700020#28700020\">\nHow to avoid using Select in Excel VBA</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8868176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/618819645bdb8d7b20102b172d6fe474?s=128&d=identicon&r=PG&f=1", "display_name": "T. Price", "link": "https://stackoverflow.com/users/8868176/t-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3649, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1511301923, "creation_date": 1511299236, "last_edit_date": 1511300727, "question_id": 47422930, "link": "https://stackoverflow.com/questions/47422930/run-time-error-1004-in-vba-subroutine", "title": "Run-Time Error &#39;1004&#39; in VBA Subroutine", "body": "<p>There seems to be something wrong with one of my Excel Objects. Take a look at the below snippet. I created the subroutine Run_all(), and when I step through, it'll go up to the Function row_count() and start executing, however, when it gets to the first highlighted row, I get the error. </p>\n\n<p>**The Sheet that I'm referencing in the function is typed correctly. For example, if I run the bottom subroutine CA_Copy_Paste_, it works correctly and I get no errors.</p>\n\n<p>Why is Excel not recognizing \"Sheet 3\" in the function? For more context, it only works if I type \"Sheet4\". Does not work on \"Sheet1\" or \"Sheet2\" either.</p>\n\n<p><img src=\"https://i.stack.imgur.com/tbohL.png\" alt=\"This image shows the portion of my VBA in question. Since this is my first question, I cannot embed images, but have to use the below link\"></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1511298716, "post_id": 47422785, "comment_id": 81800118, "body": "See: <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1511298993, "post_id": 47422785, "comment_id": 81800264, "body": "re: <i>&#39;on their next booking I give that customer a permanent discount of $25 on all future bookings, once I add the discount against the customer, the pricing formulas recalculate all the formulas which could cause obvious accounting issues.&#39;</i> You&#39;re not doing it right."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1511299586, "post_id": 47422785, "comment_id": 81800631, "body": "@Jeeped Right??? Red flags!!!"}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511300000, "post_id": 47422785, "comment_id": 81800865, "body": "@Scott Craner! I have made sure to actually ask a question. The question doesn&#39;t ask how to implement a feature, and asks how to accomplish a programming task. I&#39;ve worded the question in a way that others may search for it. I&#39;ve clearly explained the scenario and broken down the problem and desired results into as many small steps as I can, and offered further info if I missed anything.  So in summary; it seems I&#39;ve asked a model question and don&#39;t see why you&#39;ve down voted the question or left this link, explain if you will."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511300117, "post_id": 47422785, "comment_id": 81800930, "body": "@Jeeped Im obviously not doing something write or I wouldn&#39;t be here asking for help, if you can&#39;t or don&#39;t want to help or have no constructive comments then feel free to jog right on."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511300204, "post_id": 47422785, "comment_id": 81800975, "body": "&quot;I know wrapping time and date stamps in an if statement can stop a similar issue occuring&quot;  - that is the answer if you really want to use only formulas and no VBA."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511300293, "post_id": 47422785, "comment_id": 81801026, "body": "It is right in your question <code>I guess I&#39;m wondering if someone could help me</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1511300425, "post_id": 47422785, "comment_id": 81801086, "body": "<i>&lt;sigh&gt;</i> - I was just turning my comment into a full answer when I noticed I had some replies. After reviewing yours @EsatK, I believe I&#39;ll <i>&#39;jog right on&#39;</i>. Good luck with your project."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511300617, "post_id": 47422785, "comment_id": 81801176, "body": "BTW: your answer is here: <a href=\"https://stackoverflow.com/questions/31013853/stop-excel-from-updating-formula-after-a-criteria-is-matched\" title=\"stop excel from updating formula after a criteria is matched\">stackoverflow.com/questions/31013853/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511304105, "post_id": 47422785, "comment_id": 81802802, "body": "@Tim Williams, this works with date and time stamps but where I have tried this with other data it seems not to. Hence the example in the question, once the discount is applied all previous jobs are recalculated also? I wonder if this is due to me not creating the circular reference referring back to the cell itself like I have with the dates which seem to no longer auto update? Any ideas?"}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511306560, "post_id": 47422785, "comment_id": 81803624, "body": "@Scott Craner Answer edited and as for your link, it just reaffirms my wish to go with a non-vba solution as my sheets and workbook are flooded with circular statement Ive purposefully allowed and that work reliably, an example of how I&#39;ve wrapped a date up =IF(A5=&quot;&quot;,&quot;&quot;,IF(F5=&quot;&quot;,TODAY(),F5)), once the condition is met, unless I click on the cell and hit enter but even then dragging an recopying the formula from the cell above or below fixes this and returns the date desired ie the date when the even occurred (when A5 was no longer &quot;&quot;)."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511306566, "post_id": 47422785, "comment_id": 81803625, "body": "However the formulas I am trying to update pull and combine data and generate a result, for example to price a job the formula is =IF(A9=&quot;&quot;,&quot;&quot;,(INDEX(Pricing!$A$3:$H$27,MATCH(D9,Pricing!$A$3&zwnj;&#8203;:$A$27,0),MATCH(G9,P&zwnj;&#8203;ricing!$A$2:$H$2,0))&zwnj;&#8203;)-INDEX(Pricing!$J$3&zwnj;&#8203;:$AI$32,MATCH(K9,Pri&zwnj;&#8203;cing!$J$3:$J$32,0),M&zwnj;&#8203;ATCH(D9,Pricing!$J$2&zwnj;&#8203;:$AI$2,0))), do you think the solution should be wrapping this all up in the circular IF statement?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511306752, "post_id": 47422785, "comment_id": 81803691, "body": "It is the only way with a formula to &quot;lock in&quot; the value.  Honestly I would use vba in a Worksheet_Change event, as it is more robust and easier to maintain."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511310524, "post_id": 47422785, "comment_id": 81804815, "body": "@Scott Craner seems like this may well be the case as I want to use a simlar solution on different formulas in different areas of the worksheet. So whilst it has got very complex and detailed, the solution should be something simple that helps turn the flexible result of a formula become anchored to the cell or even replace the formula would be ideal as once the data is there the formula is irrelevant and no longer required."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511310783, "post_id": 47422785, "comment_id": 81804891, "body": "Perhaps I will look into your linked answer earlier and test it, have you any other perhaps tried and tested solutions to this type of macro as the circular references (thousands of them) worry me as many seem to talk about unreliability and other issues when using macros on a sheet or workbook with enabled itterations and using circular refences?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511303565, "post_id": 47423019, "comment_id": 81802571, "body": "@ Issel... First option for the reason you stated is a no go, moveing and copying I don&#39;t see how it will solve the issue other than keep me copies prior and then goes back to the same issues as option one. However copying the cell and pasting its value is will give me the exact desired result but a macro automating this would be extremely useful, I was avoiding a macro as not as familiar with them but seems inevitable. If you could give any further help on this it would be hugely useful to me and I&#39;m sure others too"}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511303569, "post_id": 47423019, "comment_id": 81802574, "body": "Just as some further info also, I do have a master sheet where all this the sheets report to and create a huge spread with many columns to allow for the various data pulled from various sheets to be stored. This is compiled by an if statement initially IF(Sheet1!=&quot;&quot;,&quot;&quot; for example and this is also where I would like to use the same macro, that way I can be sure once the formulas calculate and provide results there is no risk of them being changed if other factors are changed."}, {"owner": {"reputation": 141, "user_id": 8953698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f338fbf095fbf95f85a5a5ba193f4e4c?s=128&d=identicon&r=PG&f=1", "display_name": "Issel", "link": "https://stackoverflow.com/users/8953698/issel"}, "reply_to_user": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511364765, "post_id": 47423019, "comment_id": 81831526, "body": "If you have new information to add that will change other information, it sounds like you could setup your spreadsheets better. Improving your spreadsheets and creating a macro sounds about 2-3 days of work, TBH, it&#39;s worth hiring someone to do this for you, and have a high qualtiy work tool is very much worth it."}], "tags": [], "owner": {"reputation": 141, "user_id": 8953698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f338fbf095fbf95f85a5a5ba193f4e4c?s=128&d=identicon&r=PG&f=1", "display_name": "Issel", "link": "https://stackoverflow.com/users/8953698/issel"}, "is_accepted": false, "score": 1, "last_activity_date": 1511299591, "creation_date": 1511299591, "answer_id": 47423019, "question_id": 47422785, "link": "https://stackoverflow.com/questions/47422785/how-to-make-formula-results-static/47423019#47423019", "title": "How to make formula results static", "body": "<p>There are 2 potential solutions: 1. You can go to your formula tab, to the calculation section, and select to \"manual calculation\" on/off. It's default is on. But if you turn it off, you can change anything and keep the values you have. However, you will have to hit \"calculate now\" every time you make a change and need it updated, this is very easy to forget to do.</p>\n\n<p>Secondly, you can right click on any of the work book tabs at the bottom and select \"Move or copy\", and you can make a copy to a blank workbook. You can then save that workbook as their invoice/book.</p>\n\n<p>Also, you can copy a cell, or range of cells, then right click and \"paste values\" in which the formulas are replaced with the values you are currently seeing. You wouldn't want to do this on your master workbook.</p>\n\n<p>Contact me if you think a macro automating this would be useful. Hopefully some or all of these ideas are useful to you! Please leave a comment if you need further explanation.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1511301141, "post_id": 47423296, "comment_id": 81801408, "body": "Something like <a href=\"https://i.stack.imgur.com/faAoK.png\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1511301229, "post_id": 47423296, "comment_id": 81801438, "body": "Yeah...like that but with Excel Tables :-)"}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511309924, "post_id": 47423296, "comment_id": 81804624, "body": "@ Jeffreyweir and @Jeeped: Firstly, I appreciate how difficult and vague my question appears, but I was unsure of exactly how much info or what to include, I can provide more if needed just let me know."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511309955, "post_id": 47423296, "comment_id": 81804630, "body": "However, this is exactly the method Im using to pull the data and calculate costs at the moment, the difference is you worked out if I add a further MATCH and include a date on the customer side this would solve the issue there, but what I didn&#39;t make as clear perhaps is the fact that I have the same need in other areas where a date wouldn&#39;t be relevant but I am looking to ensure the data remains unchanged after the initial formula event."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511309959, "post_id": 47423296, "comment_id": 81804631, "body": "for example each row on my master sheet is defined with a booking/job number, if something or someone changes something in one of the sheets I dont want the master sheet which pulls that data to recalculate after its initial event, that way the master data is always safe, does that make any sense?"}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511310159, "post_id": 47423296, "comment_id": 81804693, "body": "Does either of you or anyone else know if wrapping the formulas with a circular IF statement like =IF(A5=&quot;&quot;,&quot;&quot;,IF(F5=&quot;&quot;,TODAY(),F5)) would help, and if the reference at the end to F5 is basically treating the formula result from IF(F5=&quot;&quot;,TODAY(), portion as the result, again if that makes any sense?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 1, "creation_date": 1511310992, "post_id": 47423296, "comment_id": 81804952, "body": "Do not take an event-driven results-overwriting approach to this. See the stuff I&#39;ve added to my answer. Don&#39;t use circular references. Doing so will potentially mask other unintentional circular references and might result in values not updating. If you feel the need for these sort of approaches to &#39;fix&#39; what you have currently, then what you have currently is a very, very bad design. Redesign."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 1, "creation_date": 1511311341, "post_id": 47423296, "comment_id": 81805054, "body": "If this spreadsheet is integral to your business, I&#39;d consider either buying in the skills to build something simpler than your current approach, using a more database-centric design from the ground up (but still executed entirely in Excel). If I was doing this I would use Excel Tables (aka ListObjects), PivotTables, Data Validation and probably PowerQuery to mash the data together. There would likely be a few INDEX/MATCH combinations, and not a SUMIF or SUMPRODUCT in site. If most of this is gobbledegook to you, then your current skills probably aren&#39;t up to the task you&#39;ve set yourself."}, {"owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "edited": false, "score": 0, "creation_date": 1511315356, "post_id": 47423296, "comment_id": 81806049, "body": "Jeffrey, my skills are definitely and quite obviously not up to the task at hand, and what I have could well be a bad design, I could be explaining it very poorly and doing it an injustice also, and I don&#39;t have a budget to work with in order to buy in the skills, I&#39;ve looked at apps and platforms available and really what Ive put together does what I need quite nicely though I&#39;m sure could always be a million miles better... However, I&#39;m willing to put up a link to a wetransfer so you or anyone else can have a look if you feel you could help out"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1511315627, "post_id": 47423296, "comment_id": 81806112, "body": "Nothing that a little reasonably priced online training wouldn&#39;t help. If you&#39;ve got the time.  Given the quality of their free online offerings, you couldn&#39;t go wrong with any course from Chandoo, Excel Campus, Ablebits, etc. I have no financial interest in any of these, although Chandoo is a social friend of mine. Google will lead you to them."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 2, "last_activity_date": 1511314385, "last_edit_date": 1511314385, "creation_date": 1511300898, "answer_id": 47423296, "question_id": 47422785, "link": "https://stackoverflow.com/questions/47422785/how-to-make-formula-results-static/47423296#47423296", "title": "How to make formula results static", "body": "<p>It's hard to give you specific advise to implement a non-trivial change on a complex workbook-based pricing application that we have no knowledge of. But here goes...</p>\n\n<p>Make up a new table called CustomerDiscount. That table should have three columns: CustomerID, Date, and Discount. Then rewrite your formulas in your 'transactional' sheet where you are taking booking or whatever, so that they match the CustomerID and Date against the CustomerDiscount table and so pull out the relevant discount that applies after date x.</p>\n\n<p>You can likely find generic examples on Google. The concepts involved here are 'Approximate VLOOKUP' or 'Approximate INDEX/MATCH' so try those search terms in google, and perhaps add something like 'look up next highest date' or similar. I can't give you any more specific advice than that without you having a go at implementing this new 'CustomerDiscount' structure, having a crack at it yourself, and then posting back a much more specific question if you get stuck.</p>\n\n<p>Relying on some trigger to either calculate or not calculate a result is NOT the way to go, because you will always have a nagging fear that something might have been recalculated when it shouldn't have been, and vice versa. You need a audit trail. Without one, you're a sitting duck.</p>\n"}], "owner": {"reputation": 33, "user_id": 7702799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87e8b26071708a8f3250fdfa6af30839?s=128&d=identicon&r=PG&f=1", "display_name": "EsatK", "link": "https://stackoverflow.com/users/7702799/esatk"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "closed_date": 1511329838, "answer_count": 2, "score": -7, "last_activity_date": 1511314385, "creation_date": 1511298613, "last_edit_date": 1531161705, "question_id": 47422785, "link": "https://stackoverflow.com/questions/47422785/how-to-make-formula-results-static", "closed_reason": "Needs more focus", "title": "How to make formula results static", "body": "<p>Or perhaps another way to look at it would be how to make a formula result static...</p>\n\n<p>The problem: I have created an  invoicing/booking solution for my business using excel sheets, I have many sheets such as delivery addresses, client data and addresses, bookings, jobs, invoices and so on. There are many many formulas which do different things at different times, for example, if a client books a service for an address the sheet will auto calculate the cost of the service through a series of formulas and IF statements. But if I change any of the data a pricing formula relies on it will recalculate all formulas relating to that data change, an example a customer books today at $100, on their next booking I give that customer a permanent discount of $25 on all future bookings, once I add the discount against the customer, the pricing formulas recalculate all the formulas which could cause obvious accounting issues.</p>\n\n<p>I know wrapping time and date stamps in an if statement can stop a similar issue occuring and that their is also macros that can be written to time stamp on an event, can anything be done with the formulas or is there another workaround to this issue, ive almost got all the functionality I need without using any macros which in itself is an achievement but on the other hand if a macro is the only way, any options it would be great.</p>\n\n<p>In short can anyone offer any solutions to making formula results static to those cells, ie rewrite the formula with the result itself so the result is permanent and therefor only editable manually.</p>\n\n<p>I havent included any screenshots as I couldnt really see what would be relevant, but if there are any bits you'd like to see or have more info on to help answer feel free to ask</p>\n"}, {"tags": ["forms", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1511299410, "last_edit_date": 1511299410, "creation_date": 1511299045, "answer_id": 47422890, "question_id": 47422778, "link": "https://stackoverflow.com/questions/47422778/ms-access-call-application-run-procedure-stored-as-variable-not-working/47422890#47422890", "title": "MS Access Call/Application.Run Procedure stored as variable not working", "body": "<p>If you want to call a sub using <code>Application.Run</code>, you need to store it in a separate, <em>standard module</em> (.bas, not .cls). Move your subs to a separate module, and it will work.</p>\n\n<p>The <code>Call</code> keyword is deprecated, and doesn't call a function based on a string.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1511299647, "creation_date": 1511299647, "answer_id": 47423036, "question_id": 47422778, "link": "https://stackoverflow.com/questions/47422778/ms-access-call-application-run-procedure-stored-as-variable-not-working/47423036#47423036", "title": "MS Access Call/Application.Run Procedure stored as variable not working", "body": "<p>A form is a <em>class module</em>, its running instance is an <em>object</em>: <code>Application.Run</code> doesn't work off objects. If you want to invoke an object's methods, you need to use <code>CallByName</code> and specify the object instance, which would be <code>Me</code>... except you specifically can't pass <code>Me</code> directly to <code>CallByName</code>, so you could introduce a local variable to proxy the call:</p>\n\n<pre><code>Dim localMe As Object\nSet localMe = Me\nCallByName localMe, currSub, vbMethod ', arguments would go here\n</code></pre>\n\n<p>Or, move the procedures you want to invoke to a separate, <em>standard module</em>, as in <a href=\"https://stackoverflow.com/a/47422890/1188513\">Erik's answer</a>.</p>\n\n<p><code>Call DoSomething</code> is 100% identical to <code>DoSomething</code>: the former is the deprecated <em>explicit call syntax</em>, the latter is the more commonly used <em>implicit call syntax</em>. Both are compile-time validated, which means doing <code>Call NonExistingProcedure</code> will throw a compile error just like invoking <code>NonExistingProcedure</code> would.</p>\n"}], "owner": {"reputation": 13, "user_id": 6762734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb74912988bcfb94b0be87c018341b8?s=128&d=identicon&r=PG&f=1", "display_name": "user6762734", "link": "https://stackoverflow.com/users/6762734/user6762734"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "accepted_answer_id": 47422890, "answer_count": 2, "score": 1, "last_activity_date": 1511299647, "creation_date": 1511298574, "last_edit_date": 1511298653, "question_id": 47422778, "link": "https://stackoverflow.com/questions/47422778/ms-access-call-application-run-procedure-stored-as-variable-not-working", "title": "MS Access Call/Application.Run Procedure stored as variable not working", "body": "<p>I have a MS Access form with a listbox with list of procedures. The procedure codes are stored in the form. There's also a button. When clicking a button, I want it to loop through the listbox and run the procedures from the selected items. I'm calling the procedures using Call and Application.Run but both methods are giving errors.</p>\n\n<p>Call 'Compile Error: Expected Sub, Function, or Proeprty<br>\nApplication.Run 'MS Access cannot find the procedure 'Name of Procedure'</p>\n\n<pre><code>Private Sub button_Click()\n\nWith Me.listbox1\n    For Each varItem In .ItemsSelected\n        currSub = .ItemData(varItem)\n        If Not IsNull(varItem) Then\n            Call currSub 'Compile Error: Expected Sub, Function, or Proeprty                \n            Application.Run currSub 'MS Access cannot find the procedure 'Name of Procedure'\n        End If\n    Next\nEnd With\n\nSub NameOfcurrSub1()\n   'some code\nEnd Sub\n\nSub NameOfcurrSub2()\n   'some code\nEnd Sub\netc.\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511298818, "post_id": 47422660, "comment_id": 81800171, "body": "Could be because RmDir doesn&#39;t use parens.  Try RmDir &quot;MYDIR&quot; or RmDir sssFldr"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 2, "creation_date": 1511299279, "post_id": 47422660, "comment_id": 81800436, "body": "@mooseman the parens are merely forcing their contents to be evaluated as a value and force-passed <code>ByVal</code> to the invoked procedure; this (bad) habit of introducing extraneous parentheses everywhere can cause compile errors (when multiple arguments are specified), or run-time errors (when parameter is an object reference), but most of the time it has no effect whatsoever, other than that weird whitespace between the procedure identifier and its argument list. IOW, I doubt it&#39;s related to that."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1511313634, "post_id": 47424439, "comment_id": 81805669, "body": "Mon Ami! This is the answer i&#39;ve been looking for at least 2 days! Thank you very much. I&#39;m still new at VBA, so i still don&#39;t know how to use functions yet, only the basic commands as you can see. Again, thank you very much for your time! It&#39;s very appreciated."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1511306851, "creation_date": 1511306851, "answer_id": 47424439, "question_id": 47422660, "link": "https://stackoverflow.com/questions/47422660/triple-loop-to-delete-empty-folders/47424439#47424439", "title": "Triple Loop to delete Empty Folders", "body": "<p>Try below code, tested working (it will delete the root folder as well if it's empty afterwards. It can be mind blogging if you are to trace back the recursive code.</p>\n\n<p>Sample - only a blank text file in highlighted folder (all others has no files).<br>\n<a href=\"https://i.stack.imgur.com/NAuF6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NAuF6.png\" alt=\"SampleFolderStructure\"></a></p>\n\n<pre><code>Option Explicit\n\nPrivate oFSO As Object\n\nSub DeleteEmptyFolder()\n    Dim oRootFDR As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oRootFDR = oFSO.GetFolder(\"C:\\Test\\mount\") '&lt;--- Change to your root folder\n    If DeleteEmptyFolderOnly(oRootFDR) Then\n        oRootFDR.Delete\n    End If\n    Set oRootFDR = Nothing\n    Set oFSO = Nothing\nEnd Sub\n\nPrivate Function DeleteEmptyFolderOnly(ByRef oFDR As Object) As Boolean\n    Dim bDeleteFolder As Boolean, oSubFDR As Object\n    bDeleteFolder = False\n    ' Recurse into SubFolders\n    For Each oSubFDR In oFDR.SubFolders\n        If DeleteEmptyFolderOnly(oSubFDR) Then\n            Debug.Print \"Delete\", oSubFDR.Path ' Comment for production use\n            oSubFDR.Delete\n        End If\n    Next\n    ' Mark ok to delete when no files and subfolders\n    If oFDR.Files.Count = 0 And oFDR.SubFolders.Count = 0 Then\n        bDeleteFolder = True\n    End If\n    DeleteEmptyFolderOnly = bDeleteFolder\nEnd Function\n</code></pre>\n\n<p>After the code executed, Folders remained are:<br><a href=\"https://i.stack.imgur.com/SxXjU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SxXjU.png\" alt=\"FolderAfterwards\"></a>\n<br>And the immediate window shows the folders that are deleted:<br><a href=\"https://i.stack.imgur.com/9NwZ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9NwZ5.png\" alt=\"DebugPrintOutput\"></a></p>\n"}], "owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "accepted_answer_id": 47424439, "answer_count": 1, "score": 1, "last_activity_date": 1511306851, "creation_date": 1511298090, "last_edit_date": 1511298975, "question_id": 47422660, "link": "https://stackoverflow.com/questions/47422660/triple-loop-to-delete-empty-folders", "title": "Triple Loop to delete Empty Folders", "body": "<p>I'm trying to delete those folders that are empty with a triple loop.</p>\n\n<p>The order is:\n 1. Enter into the Main Folder.\n 2. Check the first encountered folder\n 3. Check the first subFolder of the main folder.\n 4. If that subFolder contains another folder, enter in this subSubFolder\n 5. If it is the last folder and doesn't contain anything, the program deletes it.\n 5.1 If the folder contains something (a file, excel, pdf, doesn't matter) just go to the next subSubFolder.\n 6. And goes on until there's no empty folders.</p>\n\n<p>Basically the code must leave untouched the folders that contains a File.</p>\n\n<p>But i don't know why the code doesn't continue and just stop without deleting the empty ones.</p>\n\n<p>This is the Folder Structure:\n<a href=\"https://i.stack.imgur.com/tWa6f.png\" rel=\"nofollow noreferrer\">Folder Path</a></p>\n\n<p>And this is the code i'm using.:</p>\n\n<pre><code>Sub recursiveDeleting()\n    Dim sFldr As Object\n    Dim ssFldr As Object\n    Dim sssFldr As Object\n    Dim fs\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    sFound = False\n    ssFound = False\n    sssFound = False\n\n    flPath = ActiveWorkbook.Path &amp; \"\\\"\n    YearPath = flPath &amp; \"2017\\\"\n    FARFIpath = YearPath &amp; \"\\FAR_FI\\\"\n\n    For Each sFldr In CreateObject(\"Scripting.FileSystemobject\").GetFolder(FARFIpath).SubFolders\n        For Each ssFldr In CreateObject(\"Scripting.FileSystemobject\").GetFolder(sFldr).SubFolders\n            For Each sssFldr In CreateObject(\"Scripting.FileSystemobject\").GetFolder(ssFldr).SubFolders\n                If Dir(sssFldr &amp; \"\\*.*\") = \"\" Then\n                    RmDir (sssFldr)\n                Else\n                    sssFound = True\n                End If\n\n                If sssFound = True Then\n                    Exit For\n                End If\n            Next sssFldr\n\n        If fs.FolderExists(ssFldr) = \"\" Then\n            RmDir (ssFldr)\n        Else\n            ssFound = True\n        End If\n        If ssFound = True Then\n            Exit For\n        End If\n        Next ssFldr\n    If Dir(sFldr, vbDirectory) = \"\" Then\n        RmDir (sFldr)\n        sFound = True\n    End If\n\n   If sFound = True Then\n      Exit For\n   End If\n Next sFldr\nEnd Sub\n</code></pre>\n\n<p>Thanks for your time and have a good day!</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1511297421, "post_id": 47422275, "comment_id": 81799385, "body": "Welcome to Stack Overflow! Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8981989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb90de14b3394d743a0f7028fb6e537?s=128&d=identicon&r=PG&f=1", "display_name": "Jose M. Soler", "link": "https://stackoverflow.com/users/8981989/jose-m-soler"}, "edited": false, "score": 0, "creation_date": 1511884320, "post_id": 47438766, "comment_id": 82028078, "body": "Thank you! I was not aware you could do that with VBA, R has something very similar. Appreciate it my friend!"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1511365567, "creation_date": 1511365567, "answer_id": 47438766, "question_id": 47422275, "link": "https://stackoverflow.com/questions/47422275/pulling-data-from-specific-workbooks-and-corresponding-worksheets-in-vba/47438766#47438766", "title": "Pulling data from specific workbooks and corresponding worksheets in VBA", "body": "<p>You can create \"PH Daily DT WK47.xls\" using something like:</p>\n\n<pre><code> filename = \"PH Daily DT WK\" &amp; weeknumber &amp;\".XLS\"\n</code></pre>\n\n<p>Where weeknumber is a variable</p>\n\n<p>You can loop weeknumber through a range of values using </p>\n\n<pre><code>  For WeekNumber = 1 to 52\n</code></pre>\n\n<p>Have a go writing your code using those two ideas and let us know when you get stuck:</p>\n"}], "owner": {"reputation": 1, "user_id": 8981989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb90de14b3394d743a0f7028fb6e537?s=128&d=identicon&r=PG&f=1", "display_name": "Jose M. Soler", "link": "https://stackoverflow.com/users/8981989/jose-m-soler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1511365567, "creation_date": 1511296744, "last_edit_date": 1511297298, "question_id": 47422275, "link": "https://stackoverflow.com/questions/47422275/pulling-data-from-specific-workbooks-and-corresponding-worksheets-in-vba", "title": "Pulling data from specific workbooks and corresponding worksheets in VBA", "body": "<p>I have a folder that I pull data from manually but would like to automate this task. One folder has a workbook for every week for the year</p>\n\n<p>PH Daily DT WK47.xls<br>\nPH Daily DT WK48.xls<br>\nPH Daily DT WK49.xls</p>\n\n<p>In this workbook, it has info that looks like this</p>\n\n<p>Date(col1)     Value (col2)</p>\n\n<p>Monday     #</p>\n\n<p>Tuesday    </p>\n\n<p>Wednesday#</p>\n\n<p>Thursday #</p>\n\n<p>Friday   #</p>\n\n<p>Saturday #</p>\n\n<p>Sunday   #</p>\n\n<p>If I wanted to pull a value from the cell corresponding to the day in week 47 until the next monday is reached - in this case  week 48 - to continue the process, how could I go about doing this? In my head this is what Im thinking</p>\n\n<p>Pull Monday Data from PH Daily DT WK47.xls<br>\n Pull Tuesday Data from PH Daily DT WK47.xls<br>\n*<br>\n*<br>\nPull Sunday Data from PH Daily DT WK47.xls<br>\nPull Monday Data from PH Daily DT WK(n+1).xls</p>\n\n<p>But obviously we cant put a formula in the middle of a destination folder. Thansk for your help! Please let me know if its not clear enough and I will try my best to explain in more depth</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 1, "creation_date": 1511295530, "post_id": 47421890, "comment_id": 81798337, "body": "I would look for the information in the do loop and check if the textline contains &quot;version.number&quot; then do some string manipulation to get from the = to the end of the line.  Then it doesn&#39;t matter the length."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1511296204, "post_id": 47421890, "comment_id": 81798724, "body": "@MichaelRusso yes you&#39;re right but could you please help me what is the code of &quot;get from the = to the end of the line&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1511296482, "post_id": 47422140, "comment_id": 81798891, "body": "Exactly what I was thinking.  I would change from Mid(textline, InStr(textline,&quot;=&quot;)+1,255) to Right(textline, Len(textline) - (InStr(textline,&quot;=&quot;)+1)) that way the size of the version never matters"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1511296482, "post_id": 47422140, "comment_id": 81798892, "body": "Hi Scott, thanks for your reply. Also is it possible to trim spaces after the numbers to the end of line (i want to  extract only numbers)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1511297567, "post_id": 47422140, "comment_id": 81799470, "body": "@MichaelRusso it gives an empty result at me :) do you add this to Scott&#39;s code ?"}, {"owner": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 0, "creation_date": 1511297948, "post_id": 47422140, "comment_id": 81799670, "body": "@Hakan, I just replaced the line in scott&#39;s code.  Make sure the &#39;text = &#39; portion is still there.  Tested and worked for me."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1511299260, "post_id": 47422140, "comment_id": 81800422, "body": "@Hakan - I wrapped the text set statement in the <code>TRIM</code> function which should clear out white space."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 442, "user_id": 6608395, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_eIfKNhOtws/AAAAAAAAAAI/AAAAAAAAAGc/zEA6sqmDJmE/photo.jpg?sz=128", "display_name": "Michael Russo", "link": "https://stackoverflow.com/users/6608395/michael-russo"}, "edited": false, "score": 1, "creation_date": 1511299339, "post_id": 47422140, "comment_id": 81800483, "body": "@MichaelRusso - <code>Mid(x,y,255)</code> will also ignore size of version. I assume it will never be more than 255 characters of course, but if it were, than your formula would be better yes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1511302934, "post_id": 47422140, "comment_id": 81802285, "body": "It may be prudent to note that VBA&#39;s Trim command will only remove spaces from the left and right of a padded string. If it is necessary to remove extraneous spaces from within the string (e.g. two or more spaces between words) then Application.Trim (which mimics the worksheet TRIM function) should be used."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1511299227, "last_edit_date": 1511299227, "creation_date": 1511296147, "answer_id": 47422140, "question_id": 47421890, "link": "https://stackoverflow.com/questions/47421890/how-to-get-specific-line-which-has-different-length-in-excel-vba/47422140#47422140", "title": "How to get specific line which has different length in Excel VBA", "body": "<p>Just tested the below code and it worked.</p>\n\n<pre><code>Option Explicit\n\nDim myFile As String\nDim text As String\nDim textline As String\n\nSub DetectModelVersion()\n\n    myFile = \"H:\\myfile.txt\"\n\n    Open myFile For Input As #1\n\n    Do Until EOF(1)\n        Line Input #1, textline\n        If InStr(textline, \"version.number\") Then\n            text = Trim(Mid(textline, InStr(textline, \"=\") + 1, 255))\n            Exit Do\n        End If\n    Loop\n\n    Close #1\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = text\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511299227, "creation_date": 1511295211, "last_edit_date": 1531161705, "question_id": 47421890, "link": "https://stackoverflow.com/questions/47421890/how-to-get-specific-line-which-has-different-length-in-excel-vba", "title": "How to get specific line which has different length in Excel VBA", "body": "<p>Hello guys i have text file like below and i saved it myfile.txt;</p>\n\n<pre><code>!File starts \nSome texts here\n\nversion.number = 12345\n\nSome texts here\n!File ends \n</code></pre>\n\n<p>And i used a code shown in below to get version number 12345, but sometimes the version number could be 5 or more digit. As an example how can i get 6 digit 123456 with my code.</p>\n\n<pre><code>Dim myFile As String\nDim text As String\nDim textline As String\nDim VersionInfo As Integer\n\nSub DetectModelVersion()\n\nmyFile = \"C:\\test\\myfile.txt\"\n\nOpen myFile For Input As #1\n\nDo Until EOF(1)\n    Line Input #1, textline\n    text = text &amp; textline\nLoop\n\nClose #1\n\nVersionInfo = InStr(text, \"version.number\")\n\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = Mid(text, VersionInfo + 17, 6)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511295709, "post_id": 47421835, "comment_id": 81798451, "body": "The first thing I would try would be to use <code>.Formula</code> instead of <code>.FormulaR1C1</code>"}, {"owner": {"reputation": 33, "user_id": 8981923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e469a5f64699314824a623050c0f0dcd?s=128&d=identicon&r=PG&f=1", "display_name": "James Winthrop", "link": "https://stackoverflow.com/users/8981923/james-winthrop"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511295943, "post_id": 47421835, "comment_id": 81798577, "body": "@braX I tried that, and now the macro just stops at that point. There is a yellow arrow pointing at line 4 in the above code"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511296070, "post_id": 47421835, "comment_id": 81798641, "body": "Sounds like a problem with your formula then. Carefully check your quotes and parenthesis."}, {"owner": {"reputation": 33, "user_id": 8981923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e469a5f64699314824a623050c0f0dcd?s=128&d=identicon&r=PG&f=1", "display_name": "James Winthrop", "link": "https://stackoverflow.com/users/8981923/james-winthrop"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511296171, "post_id": 47421835, "comment_id": 81798704, "body": "The formula works fine when pasted into any cell in the column I need it in (and also works when I auto-fill the column after pasting it in to the first row)"}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 1, "creation_date": 1511296421, "post_id": 47421835, "comment_id": 81798859, "body": "The end of the second line of your formula is <code>...&quot;&quot;General Mar</code> and the beginning of the 3rd line is <code>IF(ISNUMBER....</code> so the concatenation would be <code>....General MarIF(ISNUMBER....</code> which is not valid syntax i think?? Maybe you meant the end of the 2nd line to be <code>&quot;&quot;General Marketing&quot;&quot;,&quot; &amp; _</code> ??"}, {"owner": {"reputation": 33, "user_id": 8981923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e469a5f64699314824a623050c0f0dcd?s=128&d=identicon&r=PG&f=1", "display_name": "James Winthrop", "link": "https://stackoverflow.com/users/8981923/james-winthrop"}, "reply_to_user": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1511296638, "post_id": 47421835, "comment_id": 81798968, "body": "@garbb I didn&#39;t write it in VBA -- I recorded a macro of entering that formula in, and it did that itself. When I edit those lines to reflect the correct code, it gives me a syntax error, which is probably true since I don&#39;t know VBA"}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 1, "creation_date": 1511296991, "post_id": 47421835, "comment_id": 81799148, "body": "Maybe something goofy is happening with the record macro feature because it is a long formula? Just type in a formula to the cell manually, make sure it is working as you want, then paste it into some text editor, search and replace all <code>&quot;</code> with <code>&quot;&quot;</code> and then paste in into vba like this <code>ActiveCell.Formula = &quot;&lt;big long formula here&gt;&quot;</code> (it should be ok to have all on one line, you shouldn&#39;t need to split it into multiple lines.)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8981923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e469a5f64699314824a623050c0f0dcd?s=128&d=identicon&r=PG&f=1", "display_name": "James Winthrop", "link": "https://stackoverflow.com/users/8981923/james-winthrop"}, "edited": false, "score": 0, "creation_date": 1511297999, "post_id": 47422416, "comment_id": 81799695, "body": "To bring life full circle, I fixed everything, and now my personal macro workbook has disappeared entirely after saving. Well, at least I have part of it right here. It&#39;s just a macro away."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1511297221, "creation_date": 1511297221, "answer_id": 47422416, "question_id": 47421835, "link": "https://stackoverflow.com/questions/47421835/how-can-i-resolve-error-1004-application-defined-or-object-defined-error-with/47422416#47422416", "title": "How can I resolve error 1004 &quot;Application-defined or object-defined error&quot; with my macro?", "body": "<p>You should try it like this....</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IF(ISNUMBER(SEARCH(\"\"Nurture\"\",RC[-1])),\"\"New Producer Nurture\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"WB FU\"\",RC[-1])),\"\"Event Follow Up\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"WS FU\"\",RC[-1])),\"\"Event Follow Up\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"WS REM\"\",RC[-1])),\"\"Event Promotion\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"Marketing OB\"\",RC[-1])),\"\"General Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"Marketing Direct to Agent\"\",RC[-1])),\"\"Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"Info Email Response\"\",RC[-1])),\"\"General Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"Marketing IB\"\",RC[-1])),\"\"General Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"ZProgramsMatch\"\",RC[-1])),\"\"General Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"Registration Support\"\",RC[-1])),\"\"General Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"Web Contact Form Outreach\"\",RC[-1])),\"\"General Marketing\"\",\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"General Product Inquiry\"\",RC[-1])),\"\"General Marketing\"\"))))))))))))\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8981923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e469a5f64699314824a623050c0f0dcd?s=128&d=identicon&r=PG&f=1", "display_name": "James Winthrop", "link": "https://stackoverflow.com/users/8981923/james-winthrop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 47422416, "answer_count": 1, "score": 0, "last_activity_date": 1511297221, "creation_date": 1511295068, "last_edit_date": 1511295148, "question_id": 47421835, "link": "https://stackoverflow.com/questions/47421835/how-can-i-resolve-error-1004-application-defined-or-object-defined-error-with", "title": "How can I resolve error 1004 &quot;Application-defined or object-defined error&quot; with my macro?", "body": "<p>My macro keeps failing at this point in my macro, where I'm filling in all the cells in a particular column with a formula reference the column next to it. </p>\n\n<p>I have another nested IF formula in my macro that works fine. They do not rely on each other either. Any ideas? </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IF(ISNUMBER(SEARCH(\"\"Nurture\"\",RC[-1])),\"\"New Producer Nurture\"\",IF(ISNUMBER(SEARCH(\"\"WB FU\"\",RC[-1])),\"\"Event Follow Up\"\",IF(ISNUMBER(SEARCH(\"\"WS FU\"\",RC[-1])),\"\"Event Follow Up\"\",IF(ISNUMBER(SEARCH(\"\"WS REM\"\",RC[-1])),\"\"Event Promotion\"\",IF(ISNUMBER(SEARCH(\"\"Marketing OB\"\",RC[-1])),\"\"General Marketing\"\",IF(ISNUMBER(SEARCH(\"\"Marketing Direct to Agent\"\",RC[-1])),\"\"\" &amp; _\n    \"Marketing\"\",IF(ISNUMBER(SEARCH(\"\"Info Email Response\"\",RC[-1])),\"\"General Marketing\"\",IF(ISNUMBER(SEARCH(\"\"Marketing IB\"\",RC[-1])),\"\"General Marketing\"\",IF(ISNUMBER(SEARCH(\"\"ZProgramsMatch\"\",RC[-1])),\"\"General Marketing\"\",IF(ISNUMBER(SEARCH(\"\"Registration Support\"\",RC[-1])),\"\"General Marketing\"\",IF(ISNUMBER(SEARCH(\"\"Web Contact Form Outreach\"\",RC[-1])),\"\"General Mar\" &amp; _\n    \"IF(ISNUMBER(SEARCH(\"\"General Product Inquiry\"\",RC[-1])),\"\"General Marketing\"\"))))))))))))\"\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1411, "user_id": 616586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4655cf0a99590aa2e4936208d7faa8fd?s=128&d=identicon&r=PG", "display_name": "hetOrakel", "link": "https://stackoverflow.com/users/616586/hetorakel"}, "edited": false, "score": 1, "creation_date": 1511293209, "post_id": 47421223, "comment_id": 81796998, "body": "This can&#39;t possibly be the complete query, so &quot;what does it do? &quot; No-one can tell you... Neither there is an error. [For Report - Group Revision] Could be a form or report name...."}, {"owner": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 0, "creation_date": 1511293258, "post_id": 47421223, "comment_id": 81797034, "body": "Square brackets (<code>[</code>, <code>]</code>) are used to address fields with blanks."}, {"owner": {"reputation": 11986, "user_id": 812837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l9uC.jpg?s=128&g=1", "display_name": "Clockwork-Muse", "link": "https://stackoverflow.com/users/812837/clockwork-muse"}, "edited": false, "score": 1, "creation_date": 1511293287, "post_id": 47421223, "comment_id": 81797054, "body": "....why do people use <code>RIGHT JOIN</code>s?  Why not just use that table as the initial <code>FROM</code> reference, and <code>LEFT JOIN</code> the other...?"}, {"owner": {"reputation": 2832, "user_id": 3735873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K93GY.jpg?s=128&g=1", "display_name": "tonypdmtr", "link": "https://stackoverflow.com/users/3735873/tonypdmtr"}, "reply_to_user": {"reputation": 11986, "user_id": 812837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l9uC.jpg?s=128&g=1", "display_name": "Clockwork-Muse", "link": "https://stackoverflow.com/users/812837/clockwork-muse"}, "edited": false, "score": 0, "creation_date": 1511293366, "post_id": 47421223, "comment_id": 81797111, "body": "@Clockwork-Muse To make it difficult to run under SQLite3? :)"}, {"owner": {"reputation": 11986, "user_id": 812837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l9uC.jpg?s=128&g=1", "display_name": "Clockwork-Muse", "link": "https://stackoverflow.com/users/812837/clockwork-muse"}, "reply_to_user": {"reputation": 2832, "user_id": 3735873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K93GY.jpg?s=128&g=1", "display_name": "tonypdmtr", "link": "https://stackoverflow.com/users/3735873/tonypdmtr"}, "edited": false, "score": 0, "creation_date": 1511293503, "post_id": 47421223, "comment_id": 81797182, "body": "@tonypdmtr - probably something like that.  Or just making it hard to read, I guess - nothing like getting 20 <code>JOINS</code> down a query, only to find that the 21st is <code>RIGHT JOIN</code>ed, and nothing else was a guaranteed reference, :sigh:"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1511293532, "post_id": 47421223, "comment_id": 81797201, "body": "Thanks for adding more code, however you still don&#39;t show the <i>meat</i> of the query... Where is the &#39;SELECT...&quot;, etc. And what is the error???"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1511307021, "post_id": 47421223, "comment_id": 81803788, "body": "Somewhere following your code, the full SQL statement is assembled. Apply this: <a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a>. If you still need help, add the full, final SQL and the error to your question."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1511335450, "post_id": 47421223, "comment_id": 81812220, "body": "<i>we&#39;re now running into errors</i> - what errors?"}], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 8786602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VvBoB.jpg?s=128&g=1", "display_name": "Wellspring", "link": "https://stackoverflow.com/users/8786602/wellspring"}, "is_accepted": false, "score": 0, "last_activity_date": 1511292932, "creation_date": 1511292932, "answer_id": 47421271, "question_id": 47421223, "link": "https://stackoverflow.com/questions/47421223/what-does-the-following-sql-query-do/47421271#47421271", "title": "What does the following SQL query do?", "body": "<p>That is a table name or query name that includes spaces and/or non-alphanumeric characters, etc. The brackets serve only to surround the poorly named (my opinion) object.</p>\n"}, {"comments": [{"owner": {"reputation": 2832, "user_id": 3735873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K93GY.jpg?s=128&g=1", "display_name": "tonypdmtr", "link": "https://stackoverflow.com/users/3735873/tonypdmtr"}, "edited": false, "score": 0, "creation_date": 1511293300, "post_id": 47421338, "comment_id": 81797063, "body": "That is, square brackets, not angle."}], "tags": [], "owner": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "is_accepted": true, "score": 0, "last_activity_date": 1511293731, "last_edit_date": 1511293731, "creation_date": 1511293112, "answer_id": 47421338, "question_id": 47421223, "link": "https://stackoverflow.com/questions/47421223/what-does-the-following-sql-query-do/47421338#47421338", "title": "What does the following SQL query do?", "body": "<p>Square brackets are used for quoting entity names.  Standard SQL uses <code>\"</code>. </p>\n\n<p>In this context, <code>[For Report - Group Revision]</code> being to the left of the period refers to a table or table-like object such as a view, report or other data source.</p>\n"}, {"tags": [], "owner": {"reputation": 613, "user_id": 6576773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3cff1b4f83434fe5e592a453c328d4?s=128&d=identicon&r=PG&f=1", "display_name": "MRsa", "link": "https://stackoverflow.com/users/6576773/mrsa"}, "is_accepted": false, "score": 0, "last_activity_date": 1511293117, "creation_date": 1511293117, "answer_id": 47421339, "question_id": 47421223, "link": "https://stackoverflow.com/questions/47421223/what-does-the-following-sql-query-do/47421339#47421339", "title": "What does the following SQL query do?", "body": "<p>It is name of table or view (object) in database, after inner join comes table or a view:</p>\n\n<pre><code>Drawings INNER JOIN [For Report - Group Revision]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8981714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3309f9e9886f8a90c060c07bae94607?s=128&d=identicon&r=PG&f=1", "display_name": "alaina_IT", "link": "https://stackoverflow.com/users/8981714/alaina-it"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47421338, "answer_count": 3, "score": 0, "last_activity_date": 1594638773, "creation_date": 1511292792, "last_edit_date": 1594638773, "question_id": 47421223, "link": "https://stackoverflow.com/questions/47421223/what-does-the-following-sql-query-do", "title": "What does the following SQL query do?", "body": "<p>The drawing logs at that the company I work for use are written in MS Access VBA. The original code was written 15+ years ago by someone else, and we're now running into errors with the reporting functionality that we can't find a solution for.</p>\n\n<p>The query I'm having an issue with is the following:</p>\n\n<pre><code>Select Case Me.frameBaseType\n    Case 1  'All drawings\n        strFROM = \"FROM (Company RIGHT JOIN Drawings ON Company.ID = Drawings.Company) LEFT JOIN Revisions ON Drawings.ID = Revisions.DwgID \"\n\n    Case 2  'Most recent revision\n        strFROM = \"FROM Company RIGHT JOIN ((Drawings INNER JOIN [For Report - Group Revision] ON Drawings.ID = \"\n        strFROM = strFROM &amp; \"[For Report - Group Revision].CbnDwgID) INNER JOIN Revisions ON (Drawings.ID = Revisions.DwgID) AND \"\n        strFROM = strFROM &amp; \"([For Report - Group Revision].RecentRevision = Revisions.ESIRevision)\"\n        strFROM = strFROM &amp; \" AND ([For Report - Group Revision].RevDate = Revisions.RevDate)\"\n        strFROM = strFROM &amp; \") ON Company.ID = Drawings.Company \"\n\n    Case 3  'Due or late in routing\n        strFROM = \"FROM (Company RIGHT JOIN Drawings ON Company.ID = Drawings.Company) LEFT JOIN Revisions ON Drawings.ID = Revisions.DwgID \"\n        strWHERElate = \"WHERE (((Revisions.Due)=1 Or (Revisions.Due)=2)) \"\n        strWHERE = strWHERElate\n\n    Case 4  'Due or late from Vendor\n        strFROM = \"FROM (Company RIGHT JOIN Drawings ON Company.ID = Drawings.Company) LEFT JOIN Revisions ON Drawings.ID = Revisions.DwgID \"\n        strWHERElate = \"WHERE (((Revisions.Due)=3 Or (Revisions.Due)=4)) \"\n        strWHERE = strWHERElate\nEnd Select\n</code></pre>\n\n<p>Does anyone know what the notation <code>[For Report - Group Revision]</code> means in a SQL query?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1511292726, "post_id": 47421191, "comment_id": 81796723, "body": "Please include what the error is and on which line it occurs."}, {"owner": {"reputation": 1, "user_id": 8771652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5721383b93a659fff1c11d02a9ebbc11?s=128&d=identicon&r=PG&f=1", "display_name": "Heather N", "link": "https://stackoverflow.com/users/8771652/heather-n"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511293763, "post_id": 47421191, "comment_id": 81797334, "body": "If I change the j loop to the following:                                              pres1.Slides(j).Copy                  new_pres.Slides.Paste                 new_pres.Application.CommandBars.ExecuteMso &quot;PasteSourceFormatting&quot;)                              then it copies the 1st page in the powerpoint the number of times the powerpoint being copied has pages."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511294415, "post_id": 47421191, "comment_id": 81797685, "body": "what does &quot;copies that &quot; mean? For a single file what do you expect to see happen?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511294497, "post_id": 47421191, "comment_id": 81797729, "body": "if you are copying the files why are you opening them? Batch file copy them and Shell execute?"}, {"owner": {"reputation": 1, "user_id": 8771652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5721383b93a659fff1c11d02a9ebbc11?s=128&d=identicon&r=PG&f=1", "display_name": "Heather N", "link": "https://stackoverflow.com/users/8771652/heather-n"}, "edited": false, "score": 0, "creation_date": 1511294940, "post_id": 47421191, "comment_id": 81797983, "body": "that is beyond my skill level at this point,  do you have an example?  I am self taught and have just been doing this for 2 months."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511297911, "post_id": 47421191, "comment_id": 81799656, "body": "As @QHarr mentions, it isn&#39;t necessary to open these files. You can copy any file on your drive to any other location using a <a href=\"https://msdn.microsoft.com/en-us/library/aa265015(v=vs.60).aspx\" rel=\"nofollow noreferrer\"><code>filesystemobject</code></a>. You can easily find tutorials and sample code on how to use it. Also your variables are not being declared the way you (probably) think they are. If you separate variables with a comma, they all do not get assigned the same data type. You must put <code>Dim i As Integer, j As Integer</code> or else <code>i</code> will be a variant."}, {"owner": {"reputation": 1, "user_id": 8771652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5721383b93a659fff1c11d02a9ebbc11?s=128&d=identicon&r=PG&f=1", "display_name": "Heather N", "link": "https://stackoverflow.com/users/8771652/heather-n"}, "edited": false, "score": 0, "creation_date": 1511356126, "post_id": 47421191, "comment_id": 81825194, "body": "I don&#39;t want to move these.  I have about 30 powerpoint presentations that need to be merged.  each powerpoint presentation is likely to have different formatting.   Each has to maintain its original formatting.   I want to copy each presentation into a masterfile in order.  I have changed the code and now it takes the first slide in each presentation and copies it each time, instead of each slide."}, {"owner": {"reputation": 1, "user_id": 8771652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5721383b93a659fff1c11d02a9ebbc11?s=128&d=identicon&r=PG&f=1", "display_name": "Heather N", "link": "https://stackoverflow.com/users/8771652/heather-n"}, "edited": false, "score": 0, "creation_date": 1511356222, "post_id": 47421191, "comment_id": 81825237, "body": "Also I got it to work in powerpoint, but I am trying to make it more univerals (there are multiple weekly presentations that pull in from multiple sources).  Thus I am trying to do this in excel.  When I move the code to excel I am having issues."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8771652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5721383b93a659fff1c11d02a9ebbc11?s=128&d=identicon&r=PG&f=1", "display_name": "Heather N", "link": "https://stackoverflow.com/users/8771652/heather-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1511883627, "last_edit_date": 1511883627, "creation_date": 1511360378, "answer_id": 47436974, "question_id": 47421191, "link": "https://stackoverflow.com/questions/47421191/cant-get-the-excel-vba-to-copy-ppt-files/47436974#47436974", "title": "Can&#39;t get the Excel VBA to copy PPT files", "body": "<p>I got it to work,  it was the PasteSourceFormatting that I needed when running from powerpoint that wasn't needed when converting to excel.  This pulls every file from the list, opens, copies to a master powerpoint with formatting intact, and closes.  in the end I have a new master powerpoint that has all of the presentations that are on the list </p>\n\n<pre><code>Sub tmp()\n'Set a VBE reference to Microsoft PowerPoint Object Library\nApplication.CutCopyMode = False\n   On Error GoTo ErrorHandler\n\n    Dim PPApp As PowerPoint.Application\n    Dim i As Integer, j As Integer\n    Dim pres1 As PowerPoint.Presentation, new_pres As PowerPoint.Presentation\n    Dim oslide As PowerPoint.Slide, s As PowerPoint.Slide, oSld As PowerPoint.Slide\n    Dim oShape As PowerPoint.Shape, oSh As PowerPoint.Shape, oshp As PowerPoint.Shape\n    Dim PPShape As Object\n\n\n    Dim wb As Workbook\n    Dim list As Worksheet\n\n    Set PPApp = CreateObject(\"Powerpoint.Application\")\n    PPApp.Visible = True\n    Set new_pres = PPApp.Presentations.Add\n    Set wb = ThisWorkbook\n    Set list = wb.Worksheets(\"Powerpoint File List\")\n    LastRow = list.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    new_pres.PageSetup.SlideSize = ppSlideSizeOnScreen\n\n\n                 ' this is not working\n\n         k = 1\n        For i = 1 To LastRow\n            filepath = list.Range(\"A\" &amp; i).Value\n            Set pres1 = PPApp.Presentations.Open(filepath)\n\n            For j = 1 To pres1.Slides.Count\n                  pres1.Slides(j).Copy\n\n\n                 new_pres.Slides.Paste\n               ' new_pres.Slides.Paste\n\n               ' new_pres.Application.CommandBars.ExecuteMso (\"PasteSourceFormatting\")\n               k = k + 1\n            Next j\n\n            pres1.Close\n\n\n            Set pres1 = Nothing\n\n        Next i\n\n        For Each oSld In new_pres.Slides\n            oSld.HeadersFooters.Clear\n            oSld.HeadersFooters.SlideNumber.Visible = msoFalse\n            oSld.HeadersFooters.DateAndTime.Visible = msoFalse\n        Next oSld\n\n        With new_pres.SlideMaster.Shapes\n            Set oshp = .AddTextbox(msoTextOrientationHorizontal, 700, 520, 100, 50)\n            oshp.TextFrame.TextRange.Font.Name = \"Arial\"\n            oshp.TextFrame.TextRange.Font.Size = 7\n            oshp.TextFrame.TextRange.InsertSlideNumber\n        End With\n        'ActivePresentation.PageSetup.FirstSlideNumber = 0\n        new_pres.Slides(1).DisplayMasterShapes = msoTrue\n\n        Set oshp = Nothing\n\n        response = MsgBox(prompt:=\"Is this For Official Use Only?\", Buttons:=vbYesNo)\n        If response = vbYes Then\n            txt = \"For Official Use Only\"\n             ' If statement to check if the yes button was selected.\n        Else\n         ' The no button was selected.\n            MsgBox \"Then it is assumed this is a Boeing Proprietary presentation\"\n            txt = \"Boeing Proprietary\"\n        End If\n        With new_pres.SlideMaster.Shapes\n            Set oshp = .AddTextbox(msoTextOrientationHorizontal, 300, 520, 100, 50)\n            oshp.TextFrame.TextRange.Font.Name = \"Arial\"\n            oshp.TextFrame.TextRange.Font.Size = 7\n            oshp.TextFrame.TextRange.Text = txt\n        End With\n\n        injdate = InputBox(\"Please enter the date for the Stand Up\")\n\n        With new_pres.SlideMaster.Shapes\n            Set oshp = .AddTextbox(msoTextOrientationHorizontal, 10, 520, 100, 50)\n            oshp.TextFrame.TextRange.Font.Name = \"Arial\"\n            oshp.TextFrame.TextRange.Font.Size = 7\n            oshp.TextFrame.TextRange.Text = injdate\n        End With\n\n\n\n\n\n\n    Application.CutCopyMode = True\nNormalExit:\n Exit Sub\nErrorHandler:\n Call MsgBox(\"Error:\" &amp; vbCrLf &amp; Err.Number &amp; vbCrLf &amp; Err.Description, _\n vbOKOnly, \"Error inserting files\")\n Resume NormalExit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8771652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5721383b93a659fff1c11d02a9ebbc11?s=128&d=identicon&r=PG&f=1", "display_name": "Heather N", "link": "https://stackoverflow.com/users/8771652/heather-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511883627, "creation_date": 1511292644, "last_edit_date": 1531164843, "question_id": 47421191, "link": "https://stackoverflow.com/questions/47421191/cant-get-the-excel-vba-to-copy-ppt-files", "title": "Can&#39;t get the Excel VBA to copy PPT files", "body": "<p>I have the following code, I attempted to modify it so it loops through a list in excel, opens each ppt file in the list and copies that to a new ppt file.  But it is getting hung up and has an error during the loop. </p>\n\n<pre><code>Sub tmp()\n'Set a VBE reference to Microsoft PowerPoint Object Library\n   On Error GoTo ErrorHandler\n    Dim PPApp As PowerPoint.Application\n    Dim i, j As Integer\n    Dim pres1, new_pres As PowerPoint.Presentation\n    Dim oslide, s, oSld As PowerPoint.Slide\n    Dim oShape, oSh, oshp As PowerPoint.Shape\n\n    Dim wb As Workbook\n    Dim list As Worksheet\n\n    Set PPApp = CreateObject(\"Powerpoint.Application\")\n    PPApp.Visible = True\n    Set new_pres = PPApp.Presentations.Add\n    Set wb = ThisWorkbook\n    Set list = wb.Worksheets(\"Powerpoint File List\")\n    LastRow = list.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    new_pres.PageSetup.SlideSize = ppSlideSizeOnScreen\n\n\n                 ' this is not working\n       For i = 1 To 1 ' LastRow\n            filepath = list.Range(\"A\" &amp; i).Value\n            Set pres1 = PPApp.Presentations.Open(filepath)\n            For j = 1 To pres1.Slides.Count\n                pres1.Slides.shapes(j).Copy\n                 new_pres.Slides.Paste\n                new_pres.Application.CommandBars.ExecuteMso \"PasteSourceFormatting\")\n\n            Next j\n             pres1.Close\n             Set pres1 = Nothing\n        Next I\n\nNormalExit:\n Exit Sub\nErrorHandler:\n Call MsgBox(\"Error:\" &amp; vbCrLf &amp; Err.Number &amp; vbCrLf &amp; Err.Description, _\n vbOKOnly, \"Error inserting files\")\n Resume NormalExit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 2, "creation_date": 1511295357, "post_id": 47421149, "comment_id": 81798218, "body": "How about creating a query, do your calculation in the query and store it in a query field, and basing your form on the query? Normally you shouldn&#39;t store calculated values in a table."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1511315920, "post_id": 47421149, "comment_id": 81806187, "body": "Agree, saving calculated data is usually unnecessary and can be dangerous. Access tables now have a &#39;calculated&#39; field type that allows simple calculations to take place in table; however, if there is any chance of ever migrating to another db platform, this field type will cause issues. And yes, saving calculated data requires code - macro or VBA."}], "answers": [{"tags": [], "owner": {"reputation": 3448, "user_id": 1049569, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RHBO1.jpg?s=128&g=1", "display_name": "kiks73", "link": "https://stackoverflow.com/users/1049569/kiks73"}, "is_accepted": false, "score": 0, "last_activity_date": 1511346588, "creation_date": 1511346588, "answer_id": 47432323, "question_id": 47421149, "link": "https://stackoverflow.com/questions/47421149/how-add-a-a-field-obtained-in-a-form-to-a-table-in-access-how-can-i-use-vba/47432323#47432323", "title": "How add a a field obtained in a form to a table in access? How can I use VBA?", "body": "<p>Supposing that in your form you have the calculated field obtained by a simple formula, you should create a new query, add the fields that you need from the tables and copy the formula for the calculated field from your form.</p>\n\n<p>The query should be a 'create table query'</p>\n\n<p>Executing the query you will have the calculated field into the new table.</p>\n\n<p>If the form is more complex and you have VBA code to calculate fields, you should change the form to table view do a copy and paste to a new table with fields equals to the table view.</p>\n\n<p>These workarounds are manual actions, if you need a real export functionality, I think that you need some VBA code.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8981665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25517264196b73959810eb982a9ef52?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime Carcel Trullols", "link": "https://stackoverflow.com/users/8981665/jaime-carcel-trullols"}, "is_accepted": false, "score": 0, "last_activity_date": 1512495503, "creation_date": 1512495503, "answer_id": 47659533, "question_id": 47421149, "link": "https://stackoverflow.com/questions/47421149/how-add-a-a-field-obtained-in-a-form-to-a-table-in-access-how-can-i-use-vba/47659533#47659533", "title": "How add a a field obtained in a form to a table in access? How can I use VBA?", "body": "<p>Thanks everybody for helping me. I changed the whole database and arranged the formulas into queries and worked for me.\nThanks from a real newbie</p>\n"}], "owner": {"reputation": 1, "user_id": 8981665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25517264196b73959810eb982a9ef52?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime Carcel Trullols", "link": "https://stackoverflow.com/users/8981665/jaime-carcel-trullols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512495503, "creation_date": 1511292520, "last_edit_date": 1511306806, "question_id": 47421149, "link": "https://stackoverflow.com/questions/47421149/how-add-a-a-field-obtained-in-a-form-to-a-table-in-access-how-can-i-use-vba", "title": "How add a a field obtained in a form to a table in access? How can I use VBA?", "body": "<p>I am working on an access database and have several fields on a table and the same fields plus another calculated field, resulting from a calculation of different field values, in a form. I want to be able to export this new field from the form into a field in the table. How can I do that? Do I really need to use Visual Basic access?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1511291817, "post_id": 47420880, "comment_id": 81796165, "body": "This may be a sign you need to <a href=\"http://www.fmsinc.com/microsoftaccess/performance/decompile.asp\" rel=\"nofollow noreferrer\">De-Compile</a> your app. Do so in main frontend <code>.accdb</code> before re-creating <code>.accde</code>. At times this weird message can occur for no reason."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1511293057, "post_id": 47420880, "comment_id": 81796914, "body": "That didn&#39;t work unfortunately. I decompiled, went through and did the debug/compile process again, saved, compacted and repaired, and then made a new .accde file, and I am getting the same error."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1511293140, "post_id": 47420880, "comment_id": 81796957, "body": "Is there any other code behind that form? Check <code>Form_Close()</code>."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1511293493, "post_id": 47420880, "comment_id": 81797174, "body": "There is quite a bit of code, but nothing on the Form_Close event.  There is code on the Form_Open event that just locks certain controls depending on the access level of the user. the FromDate control is not a part of that section, and the error happens regardless of user&#39;s access level."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1511293550, "post_id": 47420880, "comment_id": 81797212, "body": "I use Load event to set focus to control without issue. However, I use dot instead of bang (!) when referencing controls: <code>Me.FromDate.SetFocus</code>. But I&#39;ve never used accde."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1511293714, "post_id": 47420880, "comment_id": 81797306, "body": "I&#39;ve tried both dot and bang. I had it originally as a dot, I changed it to bang just to see if it changed anything per chance."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1511299797, "post_id": 47420880, "comment_id": 81800766, "body": "I don&#39;t know if this would have anything to do with it, but I have a login form that opens when Access is opened. When the user enters their password, it opens the form that is throwing the error. The only code on the login is:"}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1511299959, "post_id": 47420880, "comment_id": 81800848, "body": "<code>code</code> If IsNull(Me.cboUser) Then     MsgBox &quot;Select a user&quot;, vbCritical     Me.cboUser.SetFocus Else     If Me.txtPassword = Me.cboUser.Column(2) Then         If Me.cboUser.Column(3) = True Then             DoCmd.OpenForm &quot;frmPasswordChange&quot;, , , &quot;[UserID] = &quot; &amp; Me.cboUser         End If         DoCmd.OpenForm &quot;frmDiversion_Review&quot;         Me.Visible = False     Else         MsgBox &quot;Password is incorrect&quot;, vbOKOnly Or vbExclamation         Me.txtPassword = Null         Me.txtPassword.SetFocus     End If End If End Sub <code>code</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1511294257, "post_id": 47421383, "comment_id": 81797589, "body": "I&#39;m hoping to figure it out as well. It seems like a very minor issue, but your solution will be a good temporary backup plan while I try to get some help troubleshooting it."}], "tags": [], "owner": {"reputation": 726, "user_id": 8786602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VvBoB.jpg?s=128&g=1", "display_name": "Wellspring", "link": "https://stackoverflow.com/users/8786602/wellspring"}, "is_accepted": false, "score": 0, "last_activity_date": 1511293309, "creation_date": 1511293309, "answer_id": 47421383, "question_id": 47420880, "link": "https://stackoverflow.com/questions/47420880/on-load-event-firing-when-closing-access-and-throwing-cant-move-the-focus-to-t/47421383#47421383", "title": "On Load event firing when closing Access and throwing &quot;can&#39;t move the focus to the control&quot; error", "body": "<p>A few weird scenarios may produce this (such as something relating to other forms being closed when you close out...) having references to this form that cause it to open. Hard to say from here.</p>\n\n<p>But there is an easy out... just add this line at the start of the routine</p>\n\n<p>On Error Resume Next</p>\n\n<p>This is safe provided you know there are no real errors in the routine ever, excepting this annoying one that doesn't actually mean anything. If real errors can occur, you will no longer see them if you add this easy-out.</p>\n\n<p>Personally, I'd prefer to find the cause and address it, not least because it seems other forms are trying to open this form while you're busy closing the app, which is an unsettling thought. But... when all else fails, it's a solution.</p>\n"}], "owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511293309, "creation_date": 1511291443, "last_edit_date": 1511291875, "question_id": 47420880, "link": "https://stackoverflow.com/questions/47420880/on-load-event-firing-when-closing-access-and-throwing-cant-move-the-focus-to-t", "title": "On Load event firing when closing Access and throwing &quot;can&#39;t move the focus to the control&quot; error", "body": "<p>I have an Access database where I have code on the On Load event of the main form to set focus to a textbox and load a 'new' record. The code is:</p>\n\n<pre><code>    Private Sub Form_Load()\n\n    'Makes it so that when frmDiversion_Review loads, it defaults to a new record\n           DoCmd.GoToRecord , , acNewRec\n           Me!FromDate.SetFocus\n\n    End Sub\n</code></pre>\n\n<p>FromDate is an unbound date field used in a search/filter section on the header of the form.</p>\n\n<p>I've split the database, and have an .accde file ready to go, but I've noticed that when I close Access when in the .accde file it gives me the following error: </p>\n\n<p>\"The expression On Load you entered as the event property setting produced the following error: </p>\n\n<blockquote>\n  <p>****NameOfDatabase**** can't move the focus to the control FromDate.\"</p>\n</blockquote>\n\n<p>It does not give an error number.</p>\n\n<p>The code is compiled, and I only get this error using the .accde file. I'm at a loss why the On Load event is even firing when I close Access. Any ideas?</p>\n"}, {"tags": ["regex", "vba", "outlook"], "comments": [{"owner": {"reputation": 743, "user_id": 4243191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aHcGJ.png?s=128&g=1", "display_name": "Andrii Pryimak", "link": "https://stackoverflow.com/users/4243191/andrii-pryimak"}, "edited": false, "score": 0, "creation_date": 1511291427, "post_id": 47420800, "comment_id": 81795912, "body": "Try this <code>(\\n|^).*?(?=\\n|$)</code>"}, {"owner": {"reputation": 743, "user_id": 4243191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aHcGJ.png?s=128&g=1", "display_name": "Andrii Pryimak", "link": "https://stackoverflow.com/users/4243191/andrii-pryimak"}, "edited": false, "score": 0, "creation_date": 1511291462, "post_id": 47420800, "comment_id": 81795928, "body": "Or this for only 1st paragraph <code>(^).*?(?=\\n|$)</code>"}, {"owner": {"reputation": 1029, "user_id": 8729103, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fbd4857a5525dc8930a313b7035a639b?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/8729103/harry"}, "edited": false, "score": 0, "creation_date": 1511291557, "post_id": 47420800, "comment_id": 81795992, "body": "You first need to find out what is separating the lines, is it only \\n or something like \\t\\r\\n or similar"}, {"owner": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "reply_to_user": {"reputation": 743, "user_id": 4243191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aHcGJ.png?s=128&g=1", "display_name": "Andrii Pryimak", "link": "https://stackoverflow.com/users/4243191/andrii-pryimak"}, "edited": false, "score": 0, "creation_date": 1511292907, "post_id": 47420800, "comment_id": 81796832, "body": "@AndriiPryimak : Both of these expressions give me &quot;Dear XYZ,&quot;"}, {"owner": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "reply_to_user": {"reputation": 1029, "user_id": 8729103, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fbd4857a5525dc8930a313b7035a639b?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/8729103/harry"}, "edited": false, "score": 0, "creation_date": 1511292946, "post_id": 47420800, "comment_id": 81796858, "body": "@Harry : Sorry for the novice question but how may I do that?"}, {"owner": {"reputation": 1029, "user_id": 8729103, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fbd4857a5525dc8930a313b7035a639b?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/8729103/harry"}, "edited": false, "score": 0, "creation_date": 1511294092, "post_id": 47420800, "comment_id": 81797514, "body": "That is not so easy to explain, i do this kind of stuff by dumping the message to a file and investigate using hex editor. It might not be neccessary tough. Please define a bit more about your input. E.g. your example shows the 3rd line as what you are looking for, so why do&#39;nt you just parse line by line and assume the 3rd line as paragraph?"}], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "edited": false, "score": 0, "creation_date": 1511296229, "post_id": 47421743, "comment_id": 81798743, "body": "I really appreciate the effort you are putting into this, regardless of the result I owe you a cold one :)"}, {"owner": {"reputation": 1029, "user_id": 8729103, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fbd4857a5525dc8930a313b7035a639b?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/8729103/harry"}, "reply_to_user": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "edited": false, "score": 0, "creation_date": 1511297389, "post_id": 47421743, "comment_id": 81799371, "body": "Hm i recognize i am too far away from vbscript, could help you in most other languages i guess. You&#39;d need to get out how to make the first part (.+?) match also any newline, so all your input text is parsed as it was one single line. Also vbscript is pretty picky about the array index access in case the arrays dont exist. Did you get my idea and can you deal with it? You can test it on <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">regex101.com</a> but check &quot;regex options&quot; single line and global..."}, {"owner": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "edited": false, "score": 0, "creation_date": 1511297417, "post_id": 47421743, "comment_id": 81799381, "body": "<code>For Each Item In ActiveExplorer.Selection</code>          &#39;Search_Email = Item.body&#39;          <code>With RegExp</code>             .<code>Global = True</code>             .<code>Pattern = Pattern</code>             .<code>IgnoreCase = True</code>             <code>Set Matches = RegExp.Execute(Search_Email)</code>         <code>End With</code>          <code>If Matches.Count &gt; 0 Then</code>            <code>Debug.Print Matches(1)</code>             <code>ali = Matches(1)</code>         <code>Else</code>             <code>Debug.Print &quot;Not Found &quot;</code>         <code>End If</code>      <code>Next</code>      <code>Set RegExp = Nothing</code>"}, {"owner": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "edited": false, "score": 0, "creation_date": 1511297608, "post_id": 47421743, "comment_id": 81799496, "body": "When I try to print the result it doesnot which means it isnt finding any matches. Yeah vba sucks, I only need it for this assignment and I do not understand the issue here."}, {"owner": {"reputation": 1029, "user_id": 8729103, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fbd4857a5525dc8930a313b7035a639b?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/8729103/harry"}, "reply_to_user": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "edited": false, "score": 0, "creation_date": 1511298756, "post_id": 47421743, "comment_id": 81800133, "body": "Sorted it out now, please try this pattern and add the multiline=true parameter. Despite the result, looking forward to the cold one ;-)"}], "tags": [], "owner": {"reputation": 1029, "user_id": 8729103, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fbd4857a5525dc8930a313b7035a639b?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/8729103/harry"}, "is_accepted": true, "score": 1, "last_activity_date": 1511299594, "last_edit_date": 1511299594, "creation_date": 1511294699, "answer_id": 47421743, "question_id": 47420800, "link": "https://stackoverflow.com/questions/47420800/regex-to-extract-text-and-number-in-outlook-vba/47421743#47421743", "title": "RegEx to extract text and number in outlook vba", "body": "<p>Basically you can or should do one regex instead, that will deliver matchgroups. </p>\n\n<p>In almost any other language it would look like this (using \"gs\" flag to ignore newline):</p>\n\n<pre><code>(.+?)CASE ID: (\\d+)\n</code></pre>\n\n<p>But for vbscript it we have something like this:</p>\n\n<pre><code>(.*?[^\\$]*)CASE ID: (\\d+)\n</code></pre>\n\n<p>Also you need to deal with matchgroups like this:</p>\n\n<pre><code>Dim RegEx : Set RegEx = New RegExp\nRegEx.Pattern = \"(.*?[^\\$]*)CASE ID: (\\d+)\"\nRegEx.Global  = True\nRegEx.MultiLine = True\nDim strTemp : strTemp = \"Lorem ipsum \" &amp; VbCrLf &amp; \"Cannot be translated to english \" &amp; VbCrLf &amp; \"CASE ID: 153\" \nWScript.Echo RegEx.Execute(strTemp)(0).SubMatches(0)\nWScript.Echo RegEx.Execute(strTemp)(0).SubMatches(1)\n</code></pre>\n\n<p>The thing is that this will only work if the constant string \"CASE ID: \" is contained in the message. In case the string is missing e.g. the newline after the \":\" it would not work</p>\n"}], "owner": {"reputation": 519, "user_id": 1073962, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f045e551fdff2a288d2a1ab56f14858?s=128&d=identicon&r=PG", "display_name": "Muhammad Ali Zia", "link": "https://stackoverflow.com/users/1073962/muhammad-ali-zia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 1, "accepted_answer_id": 47421743, "answer_count": 1, "score": 2, "last_activity_date": 1593328535, "creation_date": 1511291145, "last_edit_date": 1593328535, "question_id": 47420800, "link": "https://stackoverflow.com/questions/47420800/regex-to-extract-text-and-number-in-outlook-vba", "title": "RegEx to extract text and number in outlook vba", "body": "<p>I Have outgoing emails which go like:</p>\n\n<pre><code>Dear XYZ,\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\n\nCASE ID: 123654\n\nBest Regards,\nXYZ\n</code></pre>\n\n<p>The text could be one or two paragraphs. I want to make two regex. One should give me the text in paragraphs and the other should give me the number that is the CASE ID. The result should look like this:</p>\n\n<pre><code>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\n\n\n123654\n</code></pre>\n\n<p>I have managed to create a RegEx to get the case using <code>(CASE ID\\s*[:]+\\s*(\\w*)\\s*)</code>but I haven't been able to extract the paragraph. Any help will be much appreciated.</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 1090, "user_id": 3878638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UlH9h.png?s=128&g=1", "display_name": "wbrugato", "link": "https://stackoverflow.com/users/3878638/wbrugato"}, "edited": false, "score": 1, "creation_date": 1511289158, "post_id": 47420209, "comment_id": 81794645, "body": "I think istead of <code>.Paste</code> you use <code>.PasteSpecial</code>, see <a href=\"https://stackoverflow.com/questions/41725730/vba-paste-values-and-keep-source-formatting\" title=\"vba paste values and keep source formatting\">stackoverflow.com/questions/41725730/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "reply_to_user": {"reputation": 1090, "user_id": 3878638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UlH9h.png?s=128&g=1", "display_name": "wbrugato", "link": "https://stackoverflow.com/users/3878638/wbrugato"}, "edited": false, "score": 0, "creation_date": 1511290116, "post_id": 47420209, "comment_id": 81795153, "body": "I reviewed that same thread and thought that would work, but it did not. It pastes all the formatting, data, and cell borders but it does not copy over the conditional formatting. I have conditional formatting that highlights entire rows of the temporary spreadsheet based on an IFERROR statement in column A."}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1511291076, "post_id": 47420209, "comment_id": 81795704, "body": "I created two excel workbooks, created a cell with conditional formatting in one and successfully copied it to another workbook with <code>Workbooks(&quot;book1&quot;).Worksheets(&quot;sheet1&quot;).Range(&quot;a1&quot;).Copy Destination:=Workbooks(&quot;book2&quot;).Worksheets(&quot;sheet1&quot;).Range(&quot;&zwnj;&#8203;a1&quot;)</code>. The conditional formatting was copied over OK, so I would work from this and slowly change it to what you want and see when it stops working. Also what version of excel?"}, {"owner": {"reputation": 566, "user_id": 2806502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b32865a2b16e1ef490eb1ea9338bee?s=128&d=identicon&r=PG&f=1", "display_name": "garbb", "link": "https://stackoverflow.com/users/2806502/garbb"}, "edited": false, "score": 0, "creation_date": 1511291299, "post_id": 47420209, "comment_id": 81795831, "body": "Also what is going on with the line <code>Range(&quot;A2:AE2&quot; &amp; lastRow).Select Selection.Copy</code>? I don&#39;t think that the select method has any parameters?"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511291428, "post_id": 47420209, "comment_id": 81795913, "body": "I am using Excel 2010. That did not work. PasteSpecial does not paste any information into my master workbook."}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511291998, "post_id": 47420209, "comment_id": 81796276, "body": "I didn&#39;t copy my entire VBA code over because the macro is huge. The <code>Range(&quot;A2:AE2&quot; &amp; lastRow).Select Selection.Copy</code> is copying range A2 to AE2 to the last row on my temporary workbook."}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511292016, "post_id": 47420209, "comment_id": 81796291, "body": "<code>Dim lastRow As Long lastRow = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511291271, "post_id": 47420752, "comment_id": 81795810, "body": "When I try this method, it does not paste anything from my temporary workbook. Any idea why that is?"}, {"owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "reply_to_user": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511292115, "post_id": 47420752, "comment_id": 81796357, "body": "Probably an issue with using ActiveSheet. Either be sure to select the appropriate sheet first <code>Sheets(&#39;mySheet&#39;).Select</code> -- or, better yet, just reference the sheet you want to copy from <code>ThisWorkbook.Sheets(&#39;mySheet&#39;).Cells</code>"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511292342, "post_id": 47420752, "comment_id": 81796490, "body": "So, when I copy the data from my temporary workbook, how should I write the code to switch back to my master spreadsheet and activate it? Right now I do that by:  <code>Master.Activate ThisWorkbook.ActiveSheet.Cells(lastRow, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats,  Operation:=xlNone, SkipBlanks:=False, Transpose:=False</code>"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511292449, "post_id": 47420752, "comment_id": 81796556, "body": "Is the lastRow throwing it off? I don&#39;t believe it is, but I guess it could be possible."}, {"owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "reply_to_user": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511292847, "post_id": 47420752, "comment_id": 81796792, "body": "As good practice, you shouldn&#39;t look to use ActiveSheet and instead, always use direct references to whatever sheet you intend to work with. You need not select a sheet prior to interacting with it so long as you reference it directly.  If you want to switch back to your master sheet, then the same applies, select and activate it. <code>Sheets(&#39;myMasterSheet&#39;).Select</code> then <code>Sheets(&#39;myMasterSheet&#39;).Activate</code> --- keeping in mind you dont need to actually select or activate a sheet if you reference it directly. <code>ThisWorkbook.Sheets(&#39;myMasterSheet&#39;).Cells</code>"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511293016, "post_id": 47420752, "comment_id": 81796895, "body": "Okay, I&#39;ve made progress, but it&#39;s still not including the conditional formatting. This is what I have now:  ` Master.Activate ActiveWorkbook.Worksheets(&quot;Sheet1&quot;).Cells(lastRow, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False`"}, {"owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "reply_to_user": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511293036, "post_id": 47420752, "comment_id": 81796901, "body": "Yes, lastRow could be throwing it off. I would replace all references to active sheet, with whatever sheet you intend to perform actions against. <code>lastRow = Sheets(&#39;mySheet&#39;).Cells(Rows.Count, 2).End(xlUp).Row</code>"}, {"owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "reply_to_user": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511293101, "post_id": 47420752, "comment_id": 81796938, "body": "xlPasteValuesAndNumberFormats is not the same as xlPasteFormats."}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511293375, "post_id": 47420752, "comment_id": 81797116, "body": "Running into the issue where it is no longer pasting any data now. xlPasteFormats pastes nothing and xlPasteValuesAndNumberFormats pastes all data but no conditional formatting. This is extremely confusing."}, {"owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "reply_to_user": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511294028, "post_id": 47420752, "comment_id": 81797486, "body": "My apologies for the confusion. <code>xlPasteFormats</code> pastes only the formatting, which includes any conditional formatting. If you use it by itself, nothing will happen as there are no values to format. Trying pasting twice, first the values, then the formats."}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511295111, "post_id": 47420752, "comment_id": 81798067, "body": "Pastes the data, but still not the conditional formatting."}, {"owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "reply_to_user": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511296494, "post_id": 47420752, "comment_id": 81798894, "body": "Refer to this SO: <a href=\"https://stackoverflow.com/questions/25768023/excel-copy-conditional-formatting-remove-rules-keep-format\" title=\"excel copy conditional formatting remove rules keep format\">stackoverflow.com/questions/25768023/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "edited": false, "score": 0, "creation_date": 1511298273, "post_id": 47420752, "comment_id": 81799866, "body": "I think that will work, thank you. I just need to figure out how to integrate it into my macro."}], "tags": [], "owner": {"reputation": 1376, "user_id": 7300068, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/39c4b2315d364579d8618fb493847188?s=128&d=identicon&r=PG&f=1", "display_name": "Crayons", "link": "https://stackoverflow.com/users/7300068/crayons"}, "is_accepted": false, "score": 0, "last_activity_date": 1511290937, "creation_date": 1511290937, "answer_id": 47420752, "question_id": 47420209, "link": "https://stackoverflow.com/questions/47420209/copying-data-and-conditional-formatting-from-one-workbook-to-another-using-vba/47420752#47420752", "title": "Copying data and conditional formatting from one workbook to another using VBA", "body": "<p>Use <code>xlPasteFormats</code></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlpastetype.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlpastetype.aspx</a></p>\n\n<p><code>ThisWorkbook.ActiveSheet.Cells(lastRow, 1).PasteSpecial xlPasteFormats</code></p>\n\n<p>If that doesnt work, try pasting twice. First the values, then the formatting.</p>\n\n<pre><code>ThisWorkbook.ActiveSheet.Cells(lastRow, 1).PasteSpecial xlPasteValues\nThisWorkbook.ActiveSheet.Cells(lastRow, 1).PasteSpecial xlPasteFormats\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5141463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd2054fdf683a150d84549eb05117fd?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Robbins", "link": "https://stackoverflow.com/users/5141463/joshua-robbins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2683, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511290937, "creation_date": 1511288966, "question_id": 47420209, "link": "https://stackoverflow.com/questions/47420209/copying-data-and-conditional-formatting-from-one-workbook-to-another-using-vba", "title": "Copying data and conditional formatting from one workbook to another using VBA", "body": "<p>I am trying to copy data and conditional formatting from one workbook to another. I can get the data to transfer over to my primary workbook, but the conditional formatting is being removed. How do I copy the data and conditional formatting from one workbook to another?</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Dim Master As Workbook \nSet Master = ActiveWorkbook \nDim lastRow As Long \nlastRow = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row \nRange(\"A2:AE2\" &amp; lastRow).Select Selection.Copy \nMaster.Activate\nThisWorkbook.ActiveSheet.Cells(lastRow, 1).Paste\n</code></pre>\n\n<p>I have tried Paste Special and it does not work either.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1511288779, "post_id": 47420016, "comment_id": 81794420, "body": "I understand this as you wrote it, but I&#39;m not sure how to make the leap of having the values posted back on a summary sheet. I want to have one sheet where all these values (basically they&#39;re tables of the same format), but when I use copy/paste, it takes up too much memory to work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1511289584, "post_id": 47420016, "comment_id": 81794863, "body": "I modified the example defining a Summary sheet (you can modify the value) and using <code>.Value</code> to copy a value from other Sheet."}, {"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1511291678, "post_id": 47420016, "comment_id": 81796073, "body": "Thanks for the edit, that helps a lot. In my case, I need to have a single sheet where the values are pasted one after the other, whereas here they are overwritten. How/where would I incorporate a way to find the last row on the summary sheet after each iteration of the loop?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1511299517, "post_id": 47420016, "comment_id": 81800602, "body": "In this example you can find the last empty cell in Column A <code>Cells(Rows.Count, 1).End(xlUp).Row +1</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 2, "last_activity_date": 1511289520, "last_edit_date": 1511289520, "creation_date": 1511288261, "answer_id": 47420016, "question_id": 47419906, "link": "https://stackoverflow.com/questions/47419906/copy-paste-loop-through-worksheets-to-consolidate/47420016#47420016", "title": "Copy/Paste Loop through worksheets to consolidate", "body": "<p>This question is similar than:</p>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/47418078/simple-copy-paste-loop-not-working-on-each-worksheet/47418276?noredirect=1#comment81791153_47418276\">Simple Copy/Paste Loop not working on each worksheet</a></p>\n</blockquote>\n\n<p>This is the way you can use the <code>.Value</code></p>\n\n<pre><code>Sub WsLoop()\n\n    Dim ws As Worksheet\n    Dim Summary As Worksheet\n\n    Set Summary = ThisWorkbook.Sheets(\"Summary\")\n\n    For Each ws In ThisWorkbook.Sheets\n        If Not ws.Name = \"Summary\" Then 'This will skip Summary.\n            Summary.Range(\"A1\").Value = ws.Range(\"A1\").Value\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1598346855, "post_id": 63575393, "comment_id": 112421913, "body": "May I request you to please add some more context around your answer. Code-only answers are difficult to understand. It will help the asker and future readers both if you can add more information in your post. See also <a href=\"https://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">Explaining entirely code-based answers</a>."}], "tags": [], "owner": {"reputation": 1, "user_id": 11351735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mvDRMYKEzZs/AAAAAAAAAAI/AAAAAAAALSA/JpC1yoyyz2Q/photo.jpg?sz=128", "display_name": "Jagan Keshavan", "link": "https://stackoverflow.com/users/11351735/jagan-keshavan"}, "is_accepted": false, "score": 0, "last_activity_date": 1598346784, "last_edit_date": 1598346784, "creation_date": 1598345841, "answer_id": 63575393, "question_id": 47419906, "link": "https://stackoverflow.com/questions/47419906/copy-paste-loop-through-worksheets-to-consolidate/63575393#63575393", "title": "Copy/Paste Loop through worksheets to consolidate", "body": "<pre><code>Sub loop_through_all_worksheets_cpyPst()\n\nDim ws As Worksheet\nDim starting_ws As Worksheet\nSet starting_ws = Sheets(&quot;startAtSheet&quot;)\n\n'remember which worksheet is active in the beginning\n\n\nFor Each ws In ThisWorkbook.Worksheets\n    ws.Activate\n\nIf Not ws.Name = &quot;SheettoPasteTo_skipCopy&quot; Then 'This will skip Summary.\n           \n    Range(&quot;A2:I2&quot;).Select\n'my section range had only columns till i - edit the to last column \n\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(&quot;SheettoPasteTo_skipcopy&quot;).Select\n'edit this sheet name to copy to \n\n    Range(&quot;A1&quot;).Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(1, 0).Range(&quot;A1&quot;).Select\n    ActiveSheet.Paste\n    ActiveCell.Offset(1, 0).Range(&quot;A1&quot;).Select\n    Selection.End(xlDown).Select\n   \nEnd If\n       \n    ws.Cells(1, 1) = 1 'this sets cell A1 of each sheet to &quot;1&quot;\n   \nNext\n\nstarting_ws.Activate \n'activate the worksheet that was originally active\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2196, "favorite_count": 0, "accepted_answer_id": 47420016, "answer_count": 2, "score": 0, "last_activity_date": 1598346784, "creation_date": 1511287874, "last_edit_date": 1531164843, "question_id": 47419906, "link": "https://stackoverflow.com/questions/47419906/copy-paste-loop-through-worksheets-to-consolidate", "title": "Copy/Paste Loop through worksheets to consolidate", "body": "<p>I have a workbook which has approximately 300 worksheets. I'm trying to loop through each sheet, copy a specific range, and paste it on summary sheet. I need each successive paste to be put one row below the last used row. I'm newer to loops, but I think the amount of information being copied is excessive(causing an error), and I have come to understand that the .value method is much less memory intensive. </p>\n\n<p>How do I incorporate the .value method to accomplish this? Here is the code I tried to write (again, I'm new to coding,sorry). </p>\n\n<pre><code>Sub Consolidation()\n\nDim ws As Worksheet\n\nSheets(\"Summary\").Select\n\nFor Each ws InThisWorkbook.Sheets\n\nActiveSheet.Range(\"A\" &amp; Rows.Count).End(xLUp).Offset(1).Value =\"ws.Range(\"BB1\").End(xLToRight).End(xLDown).Select\"\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, is there a better way to do this? Meaning, is the .value method the way to tackle this issue? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1511287421, "post_id": 47419738, "comment_id": 81793668, "body": "just before the <code>End If</code> put <code>Exit For</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1511290043, "post_id": 47419738, "comment_id": 81795106, "body": "Where did you put the <code>Exit For</code>, for it to exit all loops? That&#39;s not what <code>Exit For</code> does - it only exits the loop body it&#39;s written in."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 1, "creation_date": 1511291958, "post_id": 47419738, "comment_id": 81796253, "body": "FWIW You will get a performance boost if you replace the loops with <code>.Find</code>"}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 8846001, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212384626583068/picture?type=large", "display_name": "Motta", "link": "https://stackoverflow.com/users/8846001/motta"}, "is_accepted": false, "score": 0, "last_activity_date": 1511294916, "creation_date": 1511294916, "answer_id": 47421800, "question_id": 47419738, "link": "https://stackoverflow.com/questions/47419738/exit-inner-for-loop/47421800#47421800", "title": "Exit Inner For Loop", "body": "<p>You need to exit the loop once you achieve what you want\nSo to force the beginning of the next loop ( <strong>j</strong> ), you need to use the <code>Exit for</code></p>\n\n<p>Try it:</p>\n\n<pre><code> For j = 2 to 264\n   For p =2 to 300\n     'If the item on the order matches the item on the material required sheet, then the variables are set and it starts the inner loop\n      If Sheets(\"OOR\").Cells(j, 5).Value = Sheets(\"BOM\").Cells(p, 1).Value then\n          FgScoQty = Sheets(\"OOR\").Cells(j, 10).Value\n          ItemScoop = Sheets(\"BOM\").Cells(p, 4).Value\n          FgItem = Sheets(\"BOM\").Cells(p, 1).Value \n          'If they match, it then looks on the sheet with the columns to put this information in the next blank row of the correct column\n\n          For x = 1 to 258\n              If ItemScoop = Sheets(\"Sheet5\").Cells(1, x).Value Then\n                  lastRow = Sheets(\"Sheets5\").Cells(Rows.Count, x).End(xlUp).Offset(1, 0).Row\n                  Sheets(\"Sheet5\").Cells(lastRow, x).Value = fgItem\n                  Sheets(\"Sheet5\").Cells(lastRow, x).Offset(0, 1).Value = fgScoQty\n              End If \n          Next x\n\n          'HERE YOU ESCAPE THE LOOP\n          Exit For\n\n     Else\n     End If \n   Next p\n Next j \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8827534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c31b8f7f56cfd8173627da8a24115a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Briggs", "link": "https://stackoverflow.com/users/8827534/jason-briggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511294916, "creation_date": 1511287315, "last_edit_date": 1511288396, "question_id": 47419738, "link": "https://stackoverflow.com/questions/47419738/exit-inner-for-loop", "title": "Exit Inner For Loop", "body": "<p>I am using Excel VBA for this project. The goal of the project is to have a worksheet that shows a number of columns. Each column is headed with an item code (for a scoop) and the quantity of the scoop in inventory. This part is created and functional.</p>\n\n<p>I then want the workbook to search through the list of open orders, get the item id needed to create the product on the open order, and put it in the column of items previously created. </p>\n\n<p>The following code is what I have so far </p>\n\n<pre><code> For j = 2 to 264\n   For p =2 to 300\n     'If the item on the order matches the item on the material required sheet, then the variables are set and it starts the inner loop\n      If Sheets(\"OOR\").Cells(j, 5).Value = Sheets(\"BOM\").Cells(p, 1).Value then\n          FgScoQty = Sheets(\"OOR\").Cells(j, 10).Value\n          ItemScoop = Sheets(\"BOM\").Cells(p, 4).Value\n          FgItem = Sheets(\"BOM\").Cells(p, 1).Value \n          'If they match, it then looks on the sheet with the columns to put this information in the next blank row of the correct column\n\n          For x = 1 to 258\n              If ItemScoop = Sheets(\"Sheet5\").Cells(1, x).Value Then\n                  lastRow = Sheets(\"Sheets5\").Cells(Rows.Count, x).End(xlUp).Offset(1, 0).Row\n                  Sheets(\"Sheet5\").Cells(lastRow, x).Value = fgItem\n                  Sheets(\"Sheet5\").Cells(lastRow, x).Offset(0, 1).Value = fgScoQty\n              End If \n          Next x \n     End If \n   Next p\n Next j \n</code></pre>\n\n<p>This works the first time perfectly</p>\n\n<p>After that I get an issue on the line</p>\n\n<pre><code> If ItemScoop = Sheets(\"Sheet5\").Cells(1, x).Value Then \n</code></pre>\n\n<p>I am not sure why. I believe I need to exit the inner loop (loop x) after the condition has been met. I've done a lot of searching on the net since this seemed like a fairly common problem, but I cannot find anything that works. </p>\n\n<p>When I try <code>Exit For</code> it seems to remove me from all my loops. </p>\n\n<p>I want it to fill in the cells with the variables, and then return to the beginning and look at the next j. </p>\n"}, {"tags": ["excel", "bubble-chart", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 6, "creation_date": 1511285851, "post_id": 47419269, "comment_id": 81792705, "body": "<code>DisplayFormat.Interior.Color</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1511329687, "creation_date": 1511329687, "answer_id": 47427637, "question_id": 47419269, "link": "https://stackoverflow.com/questions/47419269/get-conditional-formatted-color-with-vba-in-excel/47427637#47427637", "title": "get conditional formatted color with vba in excel", "body": "<p>You can use:</p>\n\n<pre><code>DisplayFormat.Interior.Color\n</code></pre>\n\n<p>to get the cell color.  Other CF properties are also accessible via <code>DisplayFormat</code></p>\n"}], "owner": {"reputation": 147, "user_id": 5494528, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8229a928f96b31058eb65a9acef2c3b2?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5494528/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2120, "favorite_count": 0, "accepted_answer_id": 47427637, "answer_count": 1, "score": 0, "last_activity_date": 1511329687, "creation_date": 1511285751, "last_edit_date": 1531161705, "question_id": 47419269, "link": "https://stackoverflow.com/questions/47419269/get-conditional-formatted-color-with-vba-in-excel", "title": "get conditional formatted color with vba in excel", "body": "<p><strong>Working:</strong>\nAn excel bubble chart, with circles in different sizes and colors.</p>\n\n<p><strong>Not Working:</strong>\nI get the colors by reading the color value with vba, however <code>Interior.Color</code> does not recognise the color set by conditional formatting.  </p>\n\n<p>Code in question:</p>\n\n<pre><code>Range(\"Z\" &amp; Application.WorksheetFunction.Match(srs.Name, Sheets(\"Diagrammdaten\").Range(\"a:a\"), 0)).Interior.Color\n</code></pre>\n\n<p>I can't find anything on a different selector than <code>Interior.Color</code>, but there surely has to be something like <code>Displayed.Color</code> in excel?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511285285, "post_id": 47419097, "comment_id": 81792346, "body": "look up the meaning of the word <code>throw</code> ... you used it incorrectly in the second sentence"}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511285947, "post_id": 47419097, "comment_id": 81792758, "body": "<code>Range.Row</code> return the row number of the range."}], "answers": [{"tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": false, "score": 1, "last_activity_date": 1511287620, "last_edit_date": 1511287620, "creation_date": 1511287140, "answer_id": 47419685, "question_id": 47419097, "link": "https://stackoverflow.com/questions/47419097/how-to-copy-specific-part-of-row-vba-excel-to-another-sheet/47419685#47419685", "title": "How to copy specific part of row VBA Excel to another sheet?", "body": "<p><code>Range.Find</code> method could find the key easily. </p>\n\n<pre><code>Dim critRem, listRem As Worksheet\nSet critRem = Worksheets(\"Enterprise - score\")\nSet listRem = Worksheets(\"Sheet1\")\n\nDim critRemID, listRemID, cell, matchedCell As Range\n\nWith critRem\n    Set critRemID = .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\nWith listRem\n    Set listRemID = .Range(.Cells(2, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\n\nFor Each cell In critRemID\n    Set matchedCell = listRemID.Find(cell.Value)\n    If matchedCell Is Nothing Then 'ID is not found\n        'Do nothing\n    Else 'ID is found, matchedCell is pointed to column A now\n        cell.Offset(0, 29).Resize(1, 10) = matchedCell.Offset(0, 89).Resize(1, 10)\n        'offset(0,29) means offsetting right 29 columns\n        'resize(0,10) means resizing the range with 1 row and 10 columns width\n        'feel free to change the number for your data\n    End If\nNext cell\n</code></pre>\n\n<p>Note: If you are confused about <code>offset().resize()</code>, there is another approach. <code>cell.Row</code> gives you the row that the data should be written into, and <code>matchedCell.Row</code> gives you the row that the ID matched. So you can access certain cell by something like <code>listRem.Range(\"D\" &amp; matchedCell.Row)</code></p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1511288171, "last_edit_date": 1511288171, "creation_date": 1511287663, "answer_id": 47419841, "question_id": 47419097, "link": "https://stackoverflow.com/questions/47419097/how-to-copy-specific-part-of-row-vba-excel-to-another-sheet/47419841#47419841", "title": "How to copy specific part of row VBA Excel to another sheet?", "body": "<p>If as you say both sheets have the same IDs, then why not use a Vlookup function to bring the data into Sheet1, then simply copy the results and paste as values so you get rid of the formula on them cells?</p>\n\n<p>Something like a loop running:</p>\n\n<pre><code>For i = 1 to LastRow\nSheet1.cells(i, YourColumnNumber).value = \"=VLOOKUP(RC[-1], Sheet2!R1:R1048576, 3, False)\"\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": false, "score": 1, "last_activity_date": 1511288138, "creation_date": 1511288138, "answer_id": 47419975, "question_id": 47419097, "link": "https://stackoverflow.com/questions/47419097/how-to-copy-specific-part-of-row-vba-excel-to-another-sheet/47419975#47419975", "title": "How to copy specific part of row VBA Excel to another sheet?", "body": "<pre><code>Tried to do it using the loop.\n\n    Sub Anser()\n\n        Dim critRemID           As Range\n        Dim listRemID           As Range\n        Dim critRemIDstart      As Range\n        Dim listRemIDstart      As Range\n\n'::::Change Sheet names and column numbers:::::\n        Set critRemID = Worksheets(\"Sheet1\").Cells(2, 1)\n        Set listRemID = Worksheets(\"Sheet2\").Cells(2, 1)\n        Set critRemIDstart = Worksheets(\"Sheet1\").Cells(2, 2)\n        Set listRemIDstart = Worksheets(\"Sheet2\").Cells(2, 2)\n\n        Dim i, j As Integer\n        i = 0\n        j = 0\n\n        Do\n        If critRemID.Offset(i, 0) = listRemID.Offset(j, 0) Then\n                critRemIDstart.Offset(i) = listRemIDstart.Offset(j)\n                i = i + 1\n                j = 0\n        Else\n                j = j + 1\n        End If\n\n        Loop While critRemID.Offset(i, 0) &lt;&gt; \"\"\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7174373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26e45a2364a1cffb286be65be5dcbc54?s=128&d=identicon&r=PG&f=1", "display_name": "InternGrant", "link": "https://stackoverflow.com/users/7174373/interngrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1511292537, "creation_date": 1511285168, "last_edit_date": 1511292455, "question_id": 47419097, "link": "https://stackoverflow.com/questions/47419097/how-to-copy-specific-part-of-row-vba-excel-to-another-sheet", "title": "How to copy specific part of row VBA Excel to another sheet?", "body": "<p>I solved it on my own. I added a for loop. Here is my working code. Thanks to everyone else for trying to help. </p>\n\n<pre><code>Sub runMatch()\n\nDim critRemID, listRemID, critRemIDstart, listRemIDstart As Range\n\nSet critRemID = Worksheets(\"Enterprise - score\").Cells(2, 1)\nSet listRemID = Worksheets(\"Sheet1\").Cells(2, 1)\nSet critRemIDstart = Worksheets(\"Enterprise - score\").Cells(2, 30)\nSet listRemIDstart = Worksheets(\"Sheet1\").Cells(2, 2)\n\nDim i, j, index As Integer\ni = 0\nj = 0\n\n    Do While critRemID.Offset(i, 0) &lt;&gt; \"\"\n    If critRemID.Offset(i, 0) = listRemID.Offset(j, 0) Then\n    For index = 0 To 84\n    critRemIDstart.Offset(i, index) = listRemIDstart.Offset(j, index).Value\n    Next index\n    i = i + 1\n    j = 0\n    index = 0\n    Else\n    If listRemID.Offset(j, 0) = \"\" Then\n    j = 0\n    i = i + 1\n    Else\n    j = j + 1\n    End If\n    End If\n\n    Loop\n\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>I have two sheets, they each have a the same IDs on each sheet but\n  different sets of data. </p>\n  \n  <p>I want to scan through the rows of data and if there is a match, copy\n  the entire row from a certain column to another certain column to the\n  end of one of the sheets. </p>\n  \n  <p>Sheet 1 is the sheet I want to copy info into, on the end I've created\n  the same headers for the data I want to bring over from sheet 2. </p>\n  \n  <p>the code below is what I have, I set a range up for the IDs and one\n  for where I want the copied cells to start</p>\n\n<pre><code>Dim critRemID, listRemID, critRemIDstart, listRemIDstart As Range\n\nSet critRemID = Worksheets(\"Enterprise - score\").Cells(2, 1)\nSet listRemID = Worksheets(\"Sheet1\").Cells(2, 1)\nSet critRemIDstart = Worksheets(\"Enterprise - score\").Cells(2, 30)\nSet listRemIDstart = Worksheets(\"Sheet1\").Cells(2, 90)\n\nDim i, j As Integer\ni = 0\nj = 0\n\n\nDo While critRemID.Offset(i, 0) &lt;&gt; \"\"\nIf critRemID.Offset(i, 0) = listRemID.Offset(j, 0) Then\ncritRemIDstart.Row(i) = listRemIDstart.Row(j).Value\ni = i + 1\nj = 0\nElse\nj = j + 1\nEnd If\n\nLoop\n</code></pre>\n  \n  <p>I keep getting this error</p>\n  \n  <blockquote>\n    <p>Wrong number of arguments or invalid property assignment</p>\n  </blockquote>\n  \n  <p>I tried going a different route but kept getting confused as shown\n  below. I was trying to have it copy each cell one by one and once it\n  reached an empty cell, it would move onto the next ID on the main\n  sheet and start over but this does nothing, I think it keeps\n  increasing both IDs on the sheet and never finds a match.  </p>\n\n<pre><code>If critRemID.Offset(i, 0) = listRemID.Offset(j, 0) Then\ncritRemIDstart.Offset(i, k) = listRemIDstart.Offset(j, l).Value\nk = k + 1\nl = l + 1\nElse\nIf listRemIDstart.Offset(j, l) = \"\" Then\n    j = j + 1\n    l = 0\n    i = i + 1\n    k = 0\nElse\nj = j + 1\ni = i + 1\nl = 0\nk = 0\nEnd If\nEnd if\n</code></pre>\n  \n  <p>any help is appreciated. Thanks.</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "edited": false, "score": 0, "creation_date": 1511286036, "post_id": 47419034, "comment_id": 81792811, "body": "What line is your code breaking on?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1511286191, "post_id": 47419034, "comment_id": 81792903, "body": "Most likely there is no space on which to split the values and as such splitvalues only has one item in the array.  Therefor there is no <code>splitValues(1)</code> only <code>splitValues(0)</code>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1511286718, "post_id": 47419034, "comment_id": 81793242, "body": "before you refer an index, ensure its availability by using <code>Ubound(splitValues)</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511287186, "post_id": 47419034, "comment_id": 81793523, "body": "It looks like you are not including the second argument in the <code>Split</code> function when setting <code>splitValues</code> like you are when you are setting <code>avarsplit</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1511287369, "post_id": 47419034, "comment_id": 81793639, "body": "@braX it defaults to space when not included. see: <a href=\"https://www.techonthenet.com/excel/formulas/split.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/split.php</a>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1511290084, "post_id": 47419034, "comment_id": 81795128, "body": "Try using some error handling, refer to <a href=\"https://stackoverflow.com/a/46856103/7690982\">this answer and see a function with Split and errorHandling</a>"}, {"owner": {"reputation": 3, "user_id": 8836578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1380530d1dbc223fe10b9d014457d885?s=128&d=identicon&r=PG&f=1", "display_name": "O.r.A.j.C", "link": "https://stackoverflow.com/users/8836578/o-r-a-j-c"}, "edited": false, "score": 0, "creation_date": 1511347905, "post_id": 47419034, "comment_id": 81819802, "body": "Thank you your comments made me realise there was an error in my test data rather than my code. However I am now looking to find out what value splitValues(1) would take if the split did not work. i.e. if the cell was &quot;TEST&quot; rather than &quot;TEST - 123&quot; as expected. Any ideas? As I am looking to make an if statement for what to do when the split fails"}], "owner": {"reputation": 3, "user_id": 8836578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1380530d1dbc223fe10b9d014457d885?s=128&d=identicon&r=PG&f=1", "display_name": "O.r.A.j.C", "link": "https://stackoverflow.com/users/8836578/o-r-a-j-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511348270, "creation_date": 1511284949, "last_edit_date": 1531164843, "question_id": 47419034, "link": "https://stackoverflow.com/questions/47419034/outputting-split-values", "title": "Outputting Split values", "body": "<p>I am having trouble with outputting values from my split code. It works in the if section of my code but not my else section. I keep getting </p>\n\n<blockquote>\n  <p>Runtime Error 9 - Subscript Out of Range</p>\n</blockquote>\n\n<p>when I run.</p>\n\n<pre><code>Dim SR As Integer\nDim z As Integer\nDim lastrow As Long\nDim str1() As String\nDim str2() As String\nDim avarsplit As Variant\nDim xRg As Range, yRg As Range, yRgD As Range, yRgE As Range, yRgF As Range, yRgG As Range, yRgH As Range, yRgI As Range\n    SR = 2\n    z = 1\n\nDo While Worksheets(\"AppendedData\").Cells(SR, 13) &lt;&gt; \"\"\n    If Worksheets(\"AppendedData\").Cells(SR, 13) = 1 And Worksheets(\"AppendedData\").Cells(SR, 12) = 0 Then\n        avarsplit = Split(Worksheets(\"AppendedData\").Cells(SR, 1).Value, \" - \")\n        splitValues = Split(Worksheets(\"AppendedData\").Cells(SR, 1).Value)\n\n        Worksheets(\"AppendedData\").Cells(SR, 27).Value = splitValues(0)\n        Worksheets(\"AppendedData\").Cells(SR, 26).Value = splitValues(1)\n\n    z = z + 1\n    SR = SR + 1\nElse:\n    Worksheets(\"AppendedData\").Select\n    Worksheets(\"AppendedData\").Cells(SR, 15).FormulaR1C1 = \"=3\"\n    Worksheets(\"AppendedData\").Cells(SR, 29).Value = \"Delete\"\n\n    avarsplit = Split(Worksheets(\"AppendedData\").Cells(SR, 1).Value, \" - \")\n    splitValues = Split(Worksheets(\"AppendedData\").Cells(SR, 1).Value)\n\n    Worksheets(\"AppendedData\").Cells(SR, 27).Value = splitValues(1) ' ERROR OCCURS HERE!\n\n        SR = SR + 1\n    End If\nLoop\n</code></pre>\n\n<p>Thank you your comments made me realise there was an error in my test data rather than my code. <br/> However I am now looking to find out what value splitValues(1) would take if the split did not work. i.e. if the cell was \"TEST\" rather than \"TEST - 123\" as expected. Any ideas? <br/>As I am looking to make an if statement for what to do when the split fails</p>\n"}, {"tags": ["vba", "ms-word", "readonly-attribute"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "is_accepted": false, "score": 3, "last_activity_date": 1511285040, "creation_date": 1511285040, "answer_id": 47419062, "question_id": 47419019, "link": "https://stackoverflow.com/questions/47419019/how-to-edit-a-word-document-that-opens-in-read-mode-in-vba/47419062#47419062", "title": "How to edit a Word document that opens in read-mode in VBA", "body": "<p>I spent a while searching for this one as I didn't know the view was called 'read-mode', so I thought it was worth sharing. My strategy was to 'toggle off read-mode' once I opened my document with this line:\n<code>ActiveDocument.ActiveWindow.View.ReadingLayout = False</code></p>\n\n<p>REF: <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/view-readinglayout-property-word\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/word-vba/articles/view-readinglayout-property-word</a></p>\n"}], "owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3793, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511285040, "creation_date": 1511284909, "question_id": 47419019, "link": "https://stackoverflow.com/questions/47419019/how-to-edit-a-word-document-that-opens-in-read-mode-in-vba", "title": "How to edit a Word document that opens in read-mode in VBA", "body": "<p>I am editing Word documents I get from clients with VBA, and the clients often give them to me in an 'uneditable view'. Thus, I would like to 'enable editing' in within my macro before doing my tasks.</p>\n\n<p>Note that I did not say the document is in 'read-only' as I do not think it is (I do not see the <code>[read only]</code> text in the document title bar when I open it manually). I have also tried setting <code>readOnly=false</code> as described in <a href=\"https://stackoverflow.com/questions/47360792/how-to-edit-a-read-only-word-document-vba\">this post</a>, but it did not make a difference to how the document opened. what I am seeing when I open the document manually is a '2-page view' with arrows on the sides to page forward/back, and when I try to edit the document I see a status message in the lower-left corner of the document's frame: <code>This modification is not allowed because this document is opened for viewing only.</code> I can manually make the document editable by going to <code>View &gt; Edit Document</code>.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1511283920, "post_id": 47418574, "comment_id": 81791470, "body": "Better get this in quick before the flurry from the rest of the community... Can you please provide the script that you have already so that we can point out the areas in your code that we believe could be changed to achieve this?"}, {"owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1511284340, "post_id": 47418574, "comment_id": 81791749, "body": "Here&#39;s what my script now &#39; &#39;Sub YTDTotal_Click()  &#39; Keyboard Shortcut: Ctrl+h &#39;  Dim mysheet As Worksheet  &#39; Sheets(&quot;YTDInfo&quot;).Select &#39; Cells.Clear   For Each mysheet In Worksheets mysheet.Select  If Left(mysheet.Name, Range(&quot;YTDInfo!K2&quot;)) = Range(&quot;YTDInfo!J2&quot;) Then ActiveSheet.Range(&quot;H22&quot;).Select Selection.Copy Sheets(&quot;YTDInfo&quot;).Select     Range(&quot;M2&quot;).Select     Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _         False, Transpose:=False   End If  Next mysheet Sheets(&quot;YTDInfo&quot;).Select &#39; ActiveSheet.Range(&quot;H22&quot;).Select   End Sub"}, {"owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1511284618, "post_id": 47418574, "comment_id": 81791943, "body": "On a single and manual search it works great, but the end just leaves me with the value in the M2 cell.  I would like this value to be moved or copied into the row where the request originated.  If I searched for the name that started in A42 then I would like for the YTD total to end up in F42 and not only in M2."}, {"owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1511284986, "post_id": 47418574, "comment_id": 81792154, "body": "Just had another thought... how about a &quot;vlookup&quot; in VBA that would match J2&#39;s value to column A and if it&#39;s a match then write M2 to Fn"}, {"owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1511286264, "post_id": 47418574, "comment_id": 81792941, "body": "I just added this and it worked... now how do I get this to lookup A and add M2 to F?  sheet_name = &quot;becerra&quot; Sal = Application.WorksheetFunction.VLookup(sheet_name, Sheet1.Range(&quot;J:M&quot;), 4, False) MsgBox &quot;Salary is : $ &quot; &amp; Sal"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511366347, "post_id": 47418574, "comment_id": 81832686, "body": "1) An image of your data, particularly the layout of the names and where you want the sums to go would really help     2)  Don&#39;t select each sheet! Check if the sheet.Name contains the substring &lt;Name of person&gt;, if yes, then use With statement to retrieve the required cell value. Store this value in a variable and add to it as you loop then write back to sheet at the end  3) Any reason why J2 cannot be populated using data validation ? Would allow you to chose names from a drop down list   4) How is location of sheet&#39;s &quot;amount paid&quot; cell determined? Same cell ref in each sheet?"}, {"owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "edited": false, "score": 0, "creation_date": 1511991542, "post_id": 47418574, "comment_id": 82082276, "body": "Thanks for your offer to help, QHarr. I found an answer by just working through it."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "is_accepted": false, "score": 0, "last_activity_date": 1511933297, "creation_date": 1511933297, "answer_id": 47545674, "question_id": 47418574, "link": "https://stackoverflow.com/questions/47418574/copy-one-static-cells-value-onto-a-second-dynamic-cell-with-specific-row-crite/47545674#47545674", "title": "Copy one static cell&#39;s value onto a second dynamic cell (with specific row criteria) based on a third cell&#39;s value", "body": "<p>I got it.  I searched and tried and cried and I DAMN GOT IT!! Thanks for the input, you guys.  I hope this helps somebody with a similar setup or requirement.  There are also probably much cleaner ways to accomplish this task, but I'm not an expert.  ...and I once heard that if the code works and doesn't generate errors then it's not really wrong.  It may take a little longer, but if it works... then... :o).</p>\n\n<pre><code>Sub YTDTotal_Click()\n'\n'\n'\nbeginScript:\n    If Sheets(\"YTDInfo\").Range(\"J2\") = 0 Then\n        MsgBox \"No More Names To Look Up\"\n        GoTo LastLine\n    Else\n\n\nDim mysheet As Worksheet\nDim sheet_name As String\n\nActiveSheet.Range(\"M2\").Clear\n\nFor Each mysheet In Worksheets\nmysheet.Select\n\nIf Left(mysheet.Name, Range(\"YTDInfo!K2\")) = Range(\"YTDInfo!J2\") Then\nActiveSheet.Range(\"H22\").Select\nSelection.Copy\nSheets(\"YTDInfo\").Select\nRange(\"M2\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _\n    False, Transpose:=False\n\nEnd If\n\nNext mysheet\nSheets(\"YTDInfo\").Select\nsheet_name = ActiveSheet.Range(\"J2\")\nZ = 200\nDo\nx = x + 1: y = y + 0\nIf Range(\"A\" &amp; x) = sheet_name Then Range(\"F\" &amp; x) = Range(\"M2\"): Range(\"B\" &amp; x) = \"a\"\n\nIf x = Z Then Exit Do\n' Use \"Exit Do\" for continuous operation\n' Use \"Exit Sub\" for a one time check\nLoop\nx = 0: y = 0\nEnd If\n\nGoTo beginScript\n\nLastLine:\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4443867, "user_type": "registered", "profile_image": "https://graph.facebook.com/1396124249/picture?type=large", "display_name": "Cymone Says", "link": "https://stackoverflow.com/users/4443867/cymone-says"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511933297, "creation_date": 1511283432, "last_edit_date": 1511328191, "question_id": 47418574, "link": "https://stackoverflow.com/questions/47418574/copy-one-static-cells-value-onto-a-second-dynamic-cell-with-specific-row-crite", "title": "Copy one static cell&#39;s value onto a second dynamic cell (with specific row criteria) based on a third cell&#39;s value", "body": "<p>I have a VBA script that starts by looking at <code>'YTDInfo'!$J$2</code> for a name.  Then it searches, from the beginning of the workbook, for a matching sheet name against the entry in <code>'YTDInfo'!$J$2</code>.  If the name is found then it looks at that sheet's \"amount paid\" cell and brings that value onto <code>'YTDInfo'!$M$2</code>.  </p>\n\n<p>The script moves onto the next matching sheet and so on, for over 100 sheets, adding all of the payments made to that one person.  It places the total summed value in cell <code>'YTDInfo'!$M$2</code>.</p>\n\n<p>I have a list of just over 100 names and I would like to automate a component of this process.  </p>\n\n<p>I already have: </p>\n\n<p><code>'YTDInfo'!A2</code> ~ <code>'YTDInfo'!A100</code>+ populated with all of the sheet names. </p>\n\n<p><code>'YTDInfo'!B2</code> with the Marlett font and I am using \"a\" (for a check mark).  </p>\n\n<p>When <code>'YTDInfo'!B2</code>=\"a\" (or B3 or B4... =\"a\") <code>'YTDInfo'!$J$2</code> populates with the next name on the list (name comes from A3, A4 or A5 - respectively).  </p>\n\n<p><code>$J$2</code> has an array CSE formula.  When <code>'YTDInfo'!$J$2</code> populates with the name I run the script and it builds up the total and puts it in <code>'YTDInfo'!$M$2</code>. </p>\n\n<p>I like this manual because I can track which name has the YTD info and I can follow any duplicates, or spelling mistakes, in the sheets.</p>\n\n<p>Here's the other manual part that I'd like to now automate...\nWhen <code>'YTDInfo'!$M$2</code> populates I need to place the value into the <code>'YTDInfo'!Fn</code> (n for row number) cell, but in the specific row that corresponds to where the name came from.</p>\n\n<p><strong>For example...</strong></p>\n\n<p>This is all done on the YTDInfo sheet, so I don't keep cluttering the text with that piece of info. ...and <code>$J$2</code> and <code>$M$2</code> are static cells being the only ones read and populated by the script.</p>\n\n<p>If <code>B11</code> is manually checked (<code>B11</code>=\"a\"), the <code>A12</code>'s name will pass onto <code>J2</code>.  That name can be John.  When I run the script all of the sheet names that have John and his amounts paid (<code>'john 10-17-2017'!AB17</code> + <code>'john 10-21-2017'!AB17</code> + so on and so on) will add up and show in <code>M2</code>.  </p>\n\n<p>Let's say it all equals... $12,000.  How do I then tell Excel that the value from <code>M2</code> ($12,000) can now be copied into John's YTD cell (onto <code>F12</code>) without having to copy and special paste values manually?</p>\n\n<p>Thank you so much for any help.  I know simple Excel stuff, but I can't figure out these pieces.  I am very willing to use formulas or VBA - without any fears, yikes!  I'm happy to donate a bit for your time and to be able to learn something from you.</p>\n\n<pre><code>Sub YTDTotal_Click() ' \n\n    Keyboard Shortcut: Ctrl+h \n\n    Dim mysheet As Worksheet ' \n    Sheets(\"YTDInfo\").Select ' \n    Cells.Clear \n\n    For Each mysheet In Worksheets \n\n         mysheet.Select \n\n         If Left(mysheet.Name, Range(\"YTDInfo!K2\")) = Range(\"YTDInfo!J2\") Then \n             ActiveSheet.Range(\"H22\").Select Selection.Copy \n             Sheets(\"YTDInfo\").Select \n             Range(\"M2\").Select Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _ False, Transpose:=False \n         End If \n\n    Next mysheet \n\n    Sheets(\"YTDInfo\").Select ' \n    ActiveSheet.Range(\"H22\").Select \n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511283443, "post_id": 47418478, "comment_id": 81791154, "body": "Welcome to SO, I could not find a clear question, can you modify your post and define a   question to solve? Please read&gt; [How to Ask](<a href=\"https://stackoverflow.com/help/how-\">stackoverflow.com/help/how-</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "edited": false, "score": 0, "creation_date": 1511289942, "post_id": 47419343, "comment_id": 81795052, "body": "Than you!!! Your code helped me a lot and I have one more question. I want A to J data in 1st row and if &quot;K&quot;=&quot;Yes&quot; then A,B,C,D,E,L,M,N,O,P in the 2nd row and If &quot;Q&quot;=&quot;Yes&quot; then A,B,C,D,E,R,S,T,U,V in the 3rd Row.  Is there any way to get the data in this way?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "edited": false, "score": 0, "creation_date": 1511342265, "post_id": 47419343, "comment_id": 81815972, "body": "@ram please have a look at the updated code, I think this will do what you want it to do... :)"}, {"owner": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "edited": false, "score": 0, "creation_date": 1511789309, "post_id": 47419343, "comment_id": 81979895, "body": "Hi!!! when I am using the updated code I am getting error as &quot;Run-time error &#39;424&#39;:  Object Required&quot;.... Error is Showing in &quot;LastRow = Sheet.Cells(Sheet.Rows.Count, &quot;A&quot;).End(xlUp).Row&quot; this line can you please help me with this. Thank you in advance"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "edited": false, "score": 0, "creation_date": 1511790150, "post_id": 47419343, "comment_id": 81980428, "body": "Where it says &quot;LastRow = Sheet&quot; you need to have the sheet number in there, if the main sheet is Sheet1, then it should read as &quot;LastRow =Sheet1.cells(Sheet1.rows.count, &quot;A&quot;).end(xlUp).Row"}, {"owner": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "edited": false, "score": 0, "creation_date": 1511793575, "post_id": 47419343, "comment_id": 81982689, "body": "One last question is there any way we can use the looping condition to the last column? Like In my Excel Sheet last data entered column is &quot;FB&quot; do I need to write the code up to &quot;Check = UCase(Sheet1.Cells(i, 202).Value)&quot; and the condition is for &quot;11&quot;= &quot;YES&quot; then print the value then next again &quot;(11+6=17)&quot;=&quot;yes&quot; print the values"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "edited": false, "score": 0, "creation_date": 1511793934, "post_id": 47419343, "comment_id": 81982901, "body": "I&#39;m not sure I understand what you mean, if what you want to do is include the checks for the value &quot;Yes&quot; on the column FB, the code should read &quot;Check = UCase(Sheet1.cells(i, 157).value"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1511360250, "last_edit_date": 1511360250, "creation_date": 1511286004, "answer_id": 47419343, "question_id": 47418478, "link": "https://stackoverflow.com/questions/47418478/get-the-data-from-one-sheet-to-another-sheet-by-applying-multiple-conditions/47419343#47419343", "title": "Get the Data from one sheet to another Sheet by applying multiple conditions", "body": "<p>The code below might do what you are asking:</p>\n\n<pre><code>Sub MyMacro()\nLastRow = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\nFor i = 2 To LastRow\n    emptyrow = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row + 1\n    Sheet2.Cells(emptyrow, 1).Value = Sheet1.Cells(i, 1).Value\n    Sheet2.Cells(emptyrow, 2).Value = Sheet1.Cells(i, 2).Value\n    Sheet2.Cells(emptyrow, 3).Value = Sheet1.Cells(i, 3).Value\n    Sheet2.Cells(emptyrow, 4).Value = Sheet1.Cells(i, 4).Value\n    Sheet2.Cells(emptyrow, 5).Value = Sheet1.Cells(i, 5).Value\n    Sheet2.Cells(emptyrow, 6).Value = Sheet1.Cells(i, 6).Value\n    Sheet2.Cells(emptyrow, 7).Value = Sheet1.Cells(i, 7).Value\n    Sheet2.Cells(emptyrow, 8).Value = Sheet1.Cells(i, 8).Value\n    Sheet2.Cells(emptyrow, 9).Value = Sheet1.Cells(i, 9).Value\n    Sheet2.Cells(emptyrow, 10).Value = Sheet1.Cells(i, 10).Value\nCheck = UCase(Sheet1.Cells(i, 11).Value)\n    If Check = \"YES\" Then\n        emptyrow = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row + 1\n        Sheet2.Cells(emptyrow, 1).Value = Sheet1.Cells(i, 1).Value\n        Sheet2.Cells(emptyrow, 2).Value = Sheet1.Cells(i, 2).Value\n        Sheet2.Cells(emptyrow, 3).Value = Sheet1.Cells(i, 3).Value\n        Sheet2.Cells(emptyrow, 4).Value = Sheet1.Cells(i, 4).Value\n        Sheet2.Cells(emptyrow, 5).Value = Sheet1.Cells(i, 5).Value\n        Sheet2.Cells(emptyrow, 6).Value = Sheet1.Cells(i, 12).Value\n        Sheet2.Cells(emptyrow, 7).Value = Sheet1.Cells(i, 13).Value\n        Sheet2.Cells(emptyrow, 8).Value = Sheet1.Cells(i, 14).Value\n        Sheet2.Cells(emptyrow, 9).Value = Sheet1.Cells(i, 15).Value\n        Sheet2.Cells(emptyrow, 10).Value = Sheet1.Cells(i, 16).Value\n    End If\nCheck = UCase(Sheet1.Cells(i, 17).Value)\n    If Check = \"YES\" Then\n        emptyrow = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row + 1\n        Sheet2.Cells(emptyrow, 1).Value = Sheet1.Cells(i, 1).Value\n        Sheet2.Cells(emptyrow, 2).Value = Sheet1.Cells(i, 2).Value\n        Sheet2.Cells(emptyrow, 3).Value = Sheet1.Cells(i, 3).Value\n        Sheet2.Cells(emptyrow, 4).Value = Sheet1.Cells(i, 4).Value\n        Sheet2.Cells(emptyrow, 5).Value = Sheet1.Cells(i, 5).Value\n        Sheet2.Cells(emptyrow, 6).Value = Sheet1.Cells(i, 18).Value\n        Sheet2.Cells(emptyrow, 7).Value = Sheet1.Cells(i, 19).Value\n        Sheet2.Cells(emptyrow, 8).Value = Sheet1.Cells(i, 20).Value\n        Sheet2.Cells(emptyrow, 9).Value = Sheet1.Cells(i, 21).Value\n        Sheet2.Cells(emptyrow, 10).Value = Sheet1.Cells(i, 22).Value\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>The output on Sheet2 would be like below:</p>\n\n<pre><code>Team    Team    Team    Member      Team Member\nJame    Rich    11      One of My   Great Teacher\nTar     Scott   98      Rockstar    Rockstar\nAsh     Mit     94      good team   Great!\nKate    Wilde   1       One of my   One of my \n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8980649, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb39dbf36c4298d7027adaf5276c0378?s=128&d=identicon&r=PG&f=1", "display_name": "ram", "link": "https://stackoverflow.com/users/8980649/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 47419343, "answer_count": 1, "score": -3, "last_activity_date": 1513320501, "creation_date": 1511283110, "last_edit_date": 1531164843, "question_id": 47418478, "link": "https://stackoverflow.com/questions/47418478/get-the-data-from-one-sheet-to-another-sheet-by-applying-multiple-conditions", "title": "Get the Data from one sheet to another Sheet by applying multiple conditions", "body": "<p>I am very new to this VBA Coding. Someone can help me with this please.\nI have some data in Sheet1 and I would like to copy the data to Sheet2 with the following conditions.\nIf \"K\"=\"yes\" then L,M,N,O,P should be in next row. In the same way if \"Q\"=\"Yes\" then R,S,T,U,V should be in the next row.  Here is the Sample Data <a href=\"https://i.stack.imgur.com/biQcy.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Output expected: \n<a href=\"https://i.stack.imgur.com/v3Rbq.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511284250, "post_id": 47418467, "comment_id": 81791687, "body": "On the first tab, is the drop down a combobox or just data validation?  You will need to show some code for the people here to give you a meaningful answer, since this isn&#39;t a code writing site.   <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 11, "user_id": 8980932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03deede8fe2011d05632c94762f89d02?s=128&d=identicon&r=PG&f=1", "display_name": "fatsattack", "link": "https://stackoverflow.com/users/8980932/fatsattack"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1511373360, "post_id": 47418467, "comment_id": 81837114, "body": "The drop down is just a data validation"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1511286065, "last_edit_date": 1511286065, "creation_date": 1511284545, "answer_id": 47418922, "question_id": 47418467, "link": "https://stackoverflow.com/questions/47418467/readjust-pivot-data-using-if-statement/47418922#47418922", "title": "Readjust Pivot data using if statement", "body": "<p>If the data in each of the month sheets have named ranges, you could use the following code once the month is selected on the first tab:</p>\n\n<pre><code>Sheet(\"YourPivotTableSheet\").PivotTables(\"PivotTable1\").changePivotcache \nActiveWorkbook.Pivotcaches\n  .create(SourceType:=xlDatabase, SourceData:=\"YourNewNamedRange\", Version:=6)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8980932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03deede8fe2011d05632c94762f89d02?s=128&d=identicon&r=PG&f=1", "display_name": "fatsattack", "link": "https://stackoverflow.com/users/8980932/fatsattack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1511286065, "creation_date": 1511283058, "last_edit_date": 1531164843, "question_id": 47418467, "link": "https://stackoverflow.com/questions/47418467/readjust-pivot-data-using-if-statement", "title": "Readjust Pivot data using if statement", "body": "<p>Currently have data for each month in a separate tab (eg. January data in Tab \"January\"...) Have pivot tables preformatted in last few tabs. First Tab has a drop down which has all the months. User chooses a month, VBA macro fills pivot table with data from selected month's tab. </p>\n\n<ul>\n<li>If \"January\" selected from drop down</li>\n<li>Then format pivot tables using \"January\" tab data</li>\n</ul>\n\n<p>Any assistance in how to structure the VBA code would be appreciated. Thank you.</p>\n"}, {"tags": ["vba", "excel", "loops", "comments"], "comments": [{"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511282920, "post_id": 47418302, "comment_id": 81790721, "body": "Are the values always an integer?"}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "reply_to_user": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1511284353, "post_id": 47418302, "comment_id": 81791761, "body": "@newacc2240 it&#39;s either an integer or a mix of alphabet letters with. 1, 2, 3, A1, B1,  C1, etc"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511284519, "post_id": 47418465, "comment_id": 81791883, "body": "Where do I add this within the code I already have or are you saying just on its own? How will the range be selected?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511285596, "post_id": 47418465, "comment_id": 81792549, "body": "Updated my answer with your code. You need to add your other case scenarios."}, {"owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "edited": false, "score": 0, "creation_date": 1511295152, "post_id": 47418465, "comment_id": 81798098, "body": "Thanks for your fast response, nothing is happening when I run the macro? Any suggestions as to why?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1511285568, "last_edit_date": 1511285568, "creation_date": 1511283057, "answer_id": 47418465, "question_id": 47418302, "link": "https://stackoverflow.com/questions/47418302/excel-vba-need-to-add-comments-to-multiple-cells-depending-on-their-value/47418465#47418465", "title": "Excel VBA Need to add comments to multiple cells depending on their value", "body": "<p>An alternative to what you are trying to do is to use Case Statement. An example:</p>\n\n<pre><code>Private Sub Update_Click()\n\n    Dim cell As Range\n    Dim rng As Range\n\n    Set rng = Range(\"D11:CY148\")\n\n    On Error Resume Next\n\n    For Each cell In rng\n\n        Select Case cell.Value\n           Case \"11\"\n               Target.AddComment\n               Target.Comment.Text Text:=\"ACT Grid\"\n           Case \"12\"\n               Target.AddComment\n               Target.Comment.Text Text:=\"Device &amp; Boarder Tile\"\n        End Select\n\n    Next cell\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8980885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500bae5059782c0021d74d8183d7baf?s=128&d=identicon&r=PG&f=1", "display_name": "Jamal Lewis", "link": "https://stackoverflow.com/users/8980885/jamal-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511285568, "creation_date": 1511282609, "last_edit_date": 1511285136, "question_id": 47418302, "link": "https://stackoverflow.com/questions/47418302/excel-vba-need-to-add-comments-to-multiple-cells-depending-on-their-value", "title": "Excel VBA Need to add comments to multiple cells depending on their value", "body": "<p>I have a decent sized table, each cell depending on their value I want VBA to add a comment with the text I choose to show for each value.\nFor example: If value is 11 - the comment will show ACT Grid. <strong>Note values are sometimes integers and sometimes a combination of letters and numbers (A1, B1, C1, 1, 2, 3, etc)</strong></p>\n\n<p>11  ACT Grid</p>\n\n<p>12  Device &amp; Boarder Tile</p>\n\n<p>13  CMHPII / USACE OH Sign-off</p>\n\n<p>14  Drop Ceiling Tile</p>\n\n<p>15  Trim Wall Devices</p>\n\n<p>16  Install Casework</p>\n\n<p>17  Install Flooring</p>\n\n<p>18  Install Doors &amp; Hardware</p>\n\n<p>These are just a sample of the values in the table. Right now I have a command button that I'd like to have pressed to update the sheet each time it's pressed, that means remove any previous comments and replace with new. There will be many cells without any values and I'd like to make sure those don't have any comments. Here's my code, I had originally used ActiveCell but that only worked for the cell that I had previously selected. I'm sure my code looks empty since it's my latest compilation of attempted code. I'm not at all proficient in this language and looking for some help. Thanks!</p>\n\n<pre><code>Private Sub Update_Click()\n\n    Dim cell As Range\n    Dim rng As Range\n\n    Set rng = Range(\"D11:CY148\")\n\n    On Error Resume Next\n\n    For Each cell In rng\n        If cell.Value = 50 Then\n            Target.AddComment\n            Target.Comment.Text Text:=\"test\"\n        End If\n\n    Next cell\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8543192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6527f0e5aebc5af310c7595e2832df1f?s=128&d=identicon&r=PG&f=1", "display_name": "Luiza", "link": "https://stackoverflow.com/users/8543192/luiza"}, "edited": false, "score": 0, "creation_date": 1511282827, "post_id": 47418303, "comment_id": 81790648, "body": "Doesnt work. My problem is the &quot;on click&quot; command. I mean, when the form is loaded, it will show the data correctly IF i click on the label itself. Thats not what i want. I need it to open already showing the correct information."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 55, "user_id": 8543192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6527f0e5aebc5af310c7595e2832df1f?s=128&d=identicon&r=PG&f=1", "display_name": "Luiza", "link": "https://stackoverflow.com/users/8543192/luiza"}, "edited": false, "score": 0, "creation_date": 1511283177, "post_id": 47418303, "comment_id": 81790931, "body": "Edited my answer. You should add that line in your <code>UserForm</code> Initialize event. Modify the name with your <code>UserForm</code> Name."}, {"owner": {"reputation": 55, "user_id": 8543192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6527f0e5aebc5af310c7595e2832df1f?s=128&d=identicon&r=PG&f=1", "display_name": "Luiza", "link": "https://stackoverflow.com/users/8543192/luiza"}, "edited": false, "score": 0, "creation_date": 1511283611, "post_id": 47418303, "comment_id": 81791264, "body": "Thanks!! That&#39;s exactly it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 1, "last_activity_date": 1511283125, "last_edit_date": 1511283125, "creation_date": 1511282612, "answer_id": 47418303, "question_id": 47418259, "link": "https://stackoverflow.com/questions/47418259/exporting-data-from-excel-to-display-on-userform/47418303#47418303", "title": "exporting data from excel to display on userform", "body": "<p>Try using:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Label3.Caption = Sheets(\"mysource\").Range(\"O3\").Value\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8543192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6527f0e5aebc5af310c7595e2832df1f?s=128&d=identicon&r=PG&f=1", "display_name": "Luiza", "link": "https://stackoverflow.com/users/8543192/luiza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 47418303, "answer_count": 1, "score": 1, "last_activity_date": 1511283125, "creation_date": 1511282493, "question_id": 47418259, "link": "https://stackoverflow.com/questions/47418259/exporting-data-from-excel-to-display-on-userform", "title": "exporting data from excel to display on userform", "body": "<p>I have a userform where I want to display data from a spreadsheet. The spread sheet is an input interface and the calculations will be displayed on my useform. My problem is to fetch the data. I have tried the code below, but what hapeens is that te correct data only appears if the user clicks on the label from the form. I need it to automatically load when i load the form. Where am I going wrong? </p>\n\n<pre><code>Private Sub Label3_Click()\n\nLabel3.Caption = Sheets(\"mysource\").Range(\"o3\")\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1511283366, "post_id": 47418159, "comment_id": 81791084, "body": "That&#39;s perfect. Much appreciated"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1511282200, "creation_date": 1511282200, "answer_id": 47418159, "question_id": 47418078, "link": "https://stackoverflow.com/questions/47418078/simple-copy-paste-loop-not-working-on-each-worksheet/47418159#47418159", "title": "Simple Copy/Paste Loop not working on each worksheet", "body": "<p>append the worksheet to each range:</p>\n\n<pre><code>Sub CleanUp()\n\nDim ws as Worksheet\n\nFor Each ws in ThisWorkbook.Sheets\n    ws.Range(\"BB2\").Copy ws.Range(\"A1\")\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511282683, "post_id": 47418276, "comment_id": 81790558, "body": "Most definitely quicker as it avoids the clipboard.  It may not be noticeable here, but is good advice and more robust."}, {"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1511283441, "post_id": 47418276, "comment_id": 81791153, "body": "I appreciate it. I&#39;m fairly new to coding and didn&#39;t realize this was the difference between the .value and the copying method."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511283499, "post_id": 47418276, "comment_id": 81791194, "body": "No problem, is a good practice to use the <code>.Value</code> property instead of Copy and Paste the values."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 2, "last_activity_date": 1511282520, "creation_date": 1511282520, "answer_id": 47418276, "question_id": 47418078, "link": "https://stackoverflow.com/questions/47418078/simple-copy-paste-loop-not-working-on-each-worksheet/47418276#47418276", "title": "Simple Copy/Paste Loop not working on each worksheet", "body": "<p>An alternative solution that could run faster:</p>\n\n<pre><code>Sub CleanUp()\n\nDim ws as Worksheet\n\nFor Each ws in ThisWorkbook.Sheets\n    ws.Range(\"A1\").Value = ws.Range(\"BB2\").Value\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 47418159, "answer_count": 2, "score": 0, "last_activity_date": 1511282520, "creation_date": 1511282004, "last_edit_date": 1531164843, "question_id": 47418078, "link": "https://stackoverflow.com/questions/47418078/simple-copy-paste-loop-not-working-on-each-worksheet", "title": "Simple Copy/Paste Loop not working on each worksheet", "body": "<p>I'm trying to loop through all the worksheets in my workbook. On each sheet, I'd like to copy a value from one cell, and paste the value on a different cell in that worksheet, and then continue on through the workbook. The code I've written loops through all the worksheets but only performs the copy paste on the sheet its on when the macro is run...</p>\n\n<pre><code>Sub CleanUp()\n\nDim ws as Worksheet\n\nFor Each ws in ThisWorkbook.Sheets\n    Range(\"BB2\").Copy Range(\"A1\")\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>In actuality, I want to run a more complicated series of alterations, but I can't even get this to work right.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511281616, "post_id": 47417888, "comment_id": 81789773, "body": "Look at using <code>enitrecolumn.delete</code> but before hand looping from <code>usedrange.columns.count</code> to 5 and checking using something like <code>countif</code> for your search string or even something like <code>if  ActiveSheet.columns(6).find(&quot;hello&quot;) is nothing then  ActiveSheet.columns(6).entirecolumn.delete</code> and have calcs set to manual"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1511285063, "post_id": 47417888, "comment_id": 81792204, "body": "[Please]don&#39;t[put][tags]in[titles]"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1511289907, "post_id": 47417888, "comment_id": 81795031, "body": "Please refer to <a href=\"https://stackoverflow.com/q/47261539/7690982\">How to increase the execution speed of my VBA macro code? (closed)</a>"}], "owner": {"reputation": 11, "user_id": 8980628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d8859cbb2f562bb66b23b6645642f43?s=128&d=identicon&r=PG&f=1", "display_name": "hoerenraph", "link": "https://stackoverflow.com/users/8980628/hoerenraph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1511288124, "creation_date": 1511281394, "last_edit_date": 1511288124, "question_id": 47417888, "link": "https://stackoverflow.com/questions/47417888/file-too-big-for-vba", "title": "File too big for VBA?", "body": "<p>This is my Situation:</p>\n\n<p>I got a big excel file (1 table, text only, about 55 MB, about 1000 rows, a lot of columns).</p>\n\n<p>I need to delete EVERYTHING BUT the following:</p>\n\n<ul>\n<li><p>Columns 1-5 from each row</p></li>\n<li><p>all cells containing a specific string (let it be \"hello\") this is not an exact search, the cell can contain more text, in that case the whole cell is important.</p></li>\n</ul>\n\n<p>Thanks to my superior google skills I found part of a solution:<br>\nDelete all cells with a grey background. So first I am colouring all cells grey, then manually switch colour for columns 1-5 and then with conditional formatting change colour for all cells containing \"hello\".</p>\n\n<p>This is the code to find the ColourCode:</p>\n\n<pre><code>Sub FindColor()\nMsgBox ActiveCell.Interior.ColorIndex\nEnd Sub\n</code></pre>\n\n<p>This is the code to empty all grey cells:</p>\n\n<pre><code>Sub ClearGrey()\nDim rng As Range \nFor Each rng In ActiveSheet.UsedRange\nIf rng.Interior.ColorIndex = 2 Then\nrng.ClearContents\nEnd If\nNext rng\nEnd Sub\n</code></pre>\n\n<p>So you probably see multiple mistakes already and i am open for a different approach.</p>\n\n<p>If you think my solution is usable I have the following problem:</p>\n\n<p>It works for small files; unfortunately in my file Excel kills itself after a few minutes without any work done.</p>\n\n<p>So here are my questions:</p>\n\n<ul>\n<li><p>How do I lighten the load for excel?</p></li>\n<li><p>Does my approach even make sense?</p></li>\n<li><p>Is there maybe a super easy way I just can't see?</p></li>\n</ul>\n\n<p>Thanks a lot already,</p>\n\n<p>Raphael</p>\n\n<p>I forgot to say that I am working on a Mac</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511281495, "post_id": 47417735, "comment_id": 81789693, "body": "you know that <code>.Offset(i, 0)</code> is moving down one row each time.  also you are including the space in your Instr search with the Right()  so <code>test</code> is actually ` test` with a space before."}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511281683, "post_id": 47417735, "comment_id": 81789824, "body": "Yeah, both factors would not cause a challenge, indeed I am moving backwards, if the space is included it is not a problem as the cell I am looking for would include the space. For some reason the second condition is not kicking in. Even when I do a message box and the while is broken, it comes up as instr(cell,&quot;%)&quot;) as zero, which makes no sense"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511281800, "post_id": 47417735, "comment_id": 81789902, "body": "Please show some test data, current output, and expected output.  It will help us find the error."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1511281144, "post_id": 47417786, "comment_id": 81789425, "body": "The <code>[]</code> makes the first and last optional, so he is using it correctly."}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 1, "creation_date": 1511281332, "post_id": 47417786, "comment_id": 81789578, "body": "Yeah, I do get confused with instr, and search (the formula), I did use msgboxs to make sure I was using it correctly. Thanks for the advice though"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 1, "last_activity_date": 1511281139, "last_edit_date": 1511281139, "creation_date": 1511281091, "answer_id": 47417786, "question_id": 47417735, "link": "https://stackoverflow.com/questions/47417735/do-while-loop-and-condition-not-working/47417786#47417786", "title": "Do while loop And condition not working", "body": "<p>You are not using the <code>InStr</code> function properly.</p>\n\n<blockquote>\n  <p>Syntax</p>\n</blockquote>\n\n<pre><code>InStr( [start], string, substring, [compare] )\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511281139, "creation_date": 1511280961, "last_edit_date": 1531164843, "question_id": 47417735, "link": "https://stackoverflow.com/questions/47417735/do-while-loop-and-condition-not-working", "title": "Do while loop And condition not working", "body": "<p>I am using a while loop and the AND condition is not working correctly</p>\n\n<pre><code>For Each y In ws.Range(\"C1:C\" &amp; ws.Range(\"A1000000\").End(xlUp).Row)\n    If InStr(y, \"Total\") &gt; 0 Then\n        i = -1\n        Do While (InStr(ws.Range(\"C\" &amp; y.Row).Offset(i, 0), Right(y, Len(y) - InStr(y, \" \"))) = 0 And InStr(ws.Range(\"C\" &amp; y.Row).Offset(i, 0), \"%)\") = 0)\n            i = i - 1\n        Loop\n    End If\nNext y\n</code></pre>\n\n<p>The second instr is not working and I am getting false positives. Basically, the code finds a word starting with total, then it takes the string after the \"Total \" and looks for that word, but the word should also have \"%)\" in it</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1511281063, "post_id": 47417647, "comment_id": 81789373, "body": "What is <code>Target.Address = &quot;$B18$1&quot;</code>? Also, which cell do you want to set to <code>1</code> and based on which criteria?"}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1511281168, "post_id": 47417647, "comment_id": 81789443, "body": "A mistake, already fixed it. If B18 is &quot;T&quot;, B20 should be &quot;1&quot; and locked!"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 0, "creation_date": 1511282917, "post_id": 47417860, "comment_id": 81790720, "body": "There is an error at the line &quot;If Target.Address = &quot;$B$18&quot; Then&quot; when running. What I want is to lock the cell B20 with the shown value of &quot;1&quot; if the selection of B18 is &quot;T&quot;"}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 0, "creation_date": 1511285592, "post_id": 47417860, "comment_id": 81792547, "body": "changed the offset to 2 rows, its working, thank you :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 0, "creation_date": 1511285719, "post_id": 47417860, "comment_id": 81792627, "body": "@EduardoRocha - I thought I adjusted the offset to 2 :). I must have only <i>thought</i> I did it :).  If it solves your problem, please mark as answered."}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 0, "creation_date": 1511359329, "post_id": 47417860, "comment_id": 81827468, "body": "Well I just found more problems ahahah but thank you for your help, I will update the question"}, {"owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "edited": false, "score": 0, "creation_date": 1511360038, "post_id": 47417860, "comment_id": 81827909, "body": "Actually it does not matter, it does what it matters, thank you very much :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1511285682, "last_edit_date": 1511285682, "creation_date": 1511281325, "answer_id": 47417860, "question_id": 47417647, "link": "https://stackoverflow.com/questions/47417647/excel-sheet-lock-cell-and-write-1-on-it-based-on-a-dropdown-option/47417860#47417860", "title": "Excel sheet: Lock cell and write &quot;1&quot; on it based on a dropdown option", "body": "<p>There is a bunch of code and text all saying different things in your question, so I based this code on your comment and the text of your question.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$B$18\" Then\n\n        ws.Unprotect\n\n        Application.EnableEvents = False\n\n        Target.Offset(2).Locked = Target.Value = \"T\"\n\n        If Target.Value = \"T\" Then\n            Target.Offset(2).Value = 1\n        Else\n            If Target.Offset(2).Value = 1 Then Target.Offset.Value = \"\"\n        End If\n\n        Application.EnableEvents = True\n\n        ws.Protect\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7124314, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1279783652087842/picture?type=large", "display_name": "Eduardo Rocha", "link": "https://stackoverflow.com/users/7124314/eduardo-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 47417860, "answer_count": 1, "score": 0, "last_activity_date": 1511285682, "creation_date": 1511280751, "last_edit_date": 1511284574, "question_id": 47417647, "link": "https://stackoverflow.com/questions/47417647/excel-sheet-lock-cell-and-write-1-on-it-based-on-a-dropdown-option", "title": "Excel sheet: Lock cell and write &quot;1&quot; on it based on a dropdown option", "body": "<p>I want to lock cell B20 and write \"1\" on it if I choose a certain option (\"T\") on the dropdown of B18. If I choose any other option, I want to be able to fill it normally without any limitations. Here is the best code I tried:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nIf Target.Address = \"$B$18\" Then\n\n    ws.Unprotect \n\n    Application.EnableEvents = False\n\n    Target.Offset(1).Locked = Target.Value = \"T\"\n\n    If Target.Value = \"T\" Then\n        Target.Offset(1).Value = 1\n    Else\n        If Target.Offset(1).Value = 1 Then Target.Offset.Value = \"\"\n    End If\n\n    Application.EnableEvents = True\n\n    ws.Protect \nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>This code is doing exactly what I want but its performing this on the cell B19 instead of B20.</p>\n\n<p>Can somebody help me please?</p>\n"}, {"tags": ["excel", "vba", "listbox", "height"], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1511285199, "last_edit_date": 1511285199, "creation_date": 1511284864, "answer_id": 47419008, "question_id": 47417589, "link": "https://stackoverflow.com/questions/47417589/adjust-listbox-height-problems/47419008#47419008", "title": "Adjust Listbox.Height problems", "body": "<p>This seems to be a not completely explored behaviour.</p>\n\n<ul>\n<li><p>In my experience just redefine some listbox arguments. </p></li>\n<li><p>Try the recommended sets of <code>.IntegralHeight</code> to False and True.</p></li>\n<li><p>Another possible measure can help in some cases: try to choose heights for your listbox that come close to the following multiplication:</p></li>\n</ul>\n\n<blockquote>\n  <p>listbox height =  (font size + 2 pts) * (maximum items per page)</p>\n</blockquote>\n\n<p>Insert the following code after <code>With ListBox1</code>:</p>\n\n<pre><code>  With ListBox1\n    .Top = 18                   ' &lt;&lt; redefine your starting Point\n    .Font.Size = 10             ' &lt;&lt; redefine your font size\n    .IntegralHeight = False     ' &lt;&lt; try the cited recommendation :-)\n</code></pre>\n\n<p>Insert the following code <strong>before</strong> <code>End With</code>:</p>\n\n<pre><code>    .Height = .Height + .Font.Size + 2\n    .IntegralHeight = True\n    End With\n</code></pre>\n\n<p>Hope that helps.</p>\n\n<p><strong>Link</strong></p>\n\n<p>See another faster approach to filter listboxes at <a href=\"https://stackoverflow.com/questions/46983374/how-to-speed-up-filling-of-listbox-values-on-userform-excel/47003993#47003993\">How to speed up filling of listbox values on userform excel</a></p>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1511366120, "post_id": 47437046, "comment_id": 81832510, "body": "Glad you could overcome an inadequately described listbox/checkbox behaviour."}], "tags": [], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "is_accepted": false, "score": 1, "last_activity_date": 1511360597, "creation_date": 1511360597, "answer_id": 47437046, "question_id": 47417589, "link": "https://stackoverflow.com/questions/47417589/adjust-listbox-height-problems/47437046#47437046", "title": "Adjust Listbox.Height problems", "body": "<p><strong>@T.M.:</strong> Thank you for your quick response and for your time. Your answer gave me exactly what I wanted and that's why I'm marking it as such. I'm posting this just for future reference.</p>\n\n<p><strong>What I finaly did to implement the plan.</strong></p>\n\n<ul>\n<li>First of all I inserted:</li>\n</ul>\n\n<p>this</p>\n\n<pre><code>With ListBox1\n    .Top = 18\n    .Font.Size = 10\n    .IntegralHeight = False\n</code></pre>\n\n<p>and this</p>\n\n<pre><code>    .Height = .Height + .Font.Size + 2\n    .IntegralHeight = True\nEnd With\n</code></pre>\n\n<p>and I linked <code>.Height</code> with <code>.Font.Size</code> as you suggested. As long as there was no need to assign absolute values to the height, there was no need to have a <code>Select Case</code> statement in my code.</p>\n\n<ul>\n<li><p>Moreover I realized that there was no need to change the height every time an item was added but only at the end of the process, so I took it out of the loop. </p></li>\n<li><p>Finally I added a piece of code that would make the list invisible when Textbox1 was empty. The code is now like this:</p></li>\n</ul>\n\n<p><strong>Final Userform code:</strong></p>\n\n<pre><code>Option Compare Text\nOption Explicit\n\nPrivate bsdel As Boolean 'indicates if backspace or delete keys have been hit.\n\n\nPrivate Sub ListBox1_Click()\n    Dim cell As Range\n    Dim maxRow As Integer\n\n    With ThisWorkbook.Worksheets(1)\n        maxRow = .Cells(.Rows.Count, 2).End(xlUp).Row\n        Set cell = .Range(\"A1:A\" &amp; maxRow).Find(UserForm11.ListBox1.Text, LookIn:=xlValues, lookat:=xlWhole)\n        If Not cell Is Nothing Then \n            cell.Select\n            'do other stuff also.\n        End If\n    End With\nEnd Sub\n\n\nPrivate Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    bsdel = False\n    If KeyCode = 8 Or KeyCode = 46 Then _\n        bsdel = True\nEnd Sub\n\nPrivate Sub TextBox1_Change()\n    Dim srchWord As String, firstAddress As String\n    Dim srchRng As Range, cell As Range\n    Dim maxRow As Integer\n\n    ListBox1.Clear\n    ListBox1.Visible = True\n    If bsdel And TextBox1.Value = \"\" Then\n        ListBox1.Visible = False\n        Me.Height = 130\n    Else\n        With ThisWorkbook.Worksheets(1)\n            maxRow = .Cells(.Rows.Count, 2).End(xlUp).Row\n            Set srchRng = .Range(\"A1:A\" &amp; maxRow)\n        End With\n        srchWord = TextBox1.Value\n        Set cell = srchRng.Find(srchWord, LookIn:=xlValues, lookat:=xlPart)\n\n        With ListBox1\n            '.Top = 84          'test made: deleting this made no difference.\n            '.Font.Size = 10    'test made: deleting this made no difference.\n            .IntegralHeight = False\n\n            If Not cell Is Nothing Then\n                firstAddress = cell.Address\n                Do\n                    If Not cell.Value Like \"*(*\" Then 'this range includes notes within parenthesis and I didn't need them.\n                        .AddItem (cell.Value)\n                    End If\n                    Set cell = srchRng.FindNext(cell)\n                Loop While Not cell.Address = firstAddress\n                If .ListCount &lt; 21 Then 'the size is adjusted.\n                    .Height = (.Font.Size + 2) * .ListCount\n                Else 'the size stays fixed at maximum.\n                    .Height = (.Font.Size + 2) * 20\n                End If\n            End If\n            Me.Height = .Height + 130\n\n            .Height = .Height + .Font.Size + 2 \n            .IntegralHeight = True\n        End With\n    End If\n    bsdel = False\nEnd Sub\n\n\nPrivate Sub UserForm_Activate()\n    TextBox1.SetFocus\nEnd Sub\n\n\nPrivate Sub UserForm_Initialize()\n    ListBox1.Visible = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 4037170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b377de247501ccb94ad5aebaf49f6aa9?s=128&d=identicon&r=PG&f=1", "display_name": "dimitris", "link": "https://stackoverflow.com/users/4037170/dimitris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8661, "favorite_count": 0, "accepted_answer_id": 47419008, "answer_count": 2, "score": 2, "last_activity_date": 1577726134, "creation_date": 1511280563, "last_edit_date": 1577726134, "question_id": 47417589, "link": "https://stackoverflow.com/questions/47417589/adjust-listbox-height-problems", "title": "Adjust Listbox.Height problems", "body": "<p>I have a userform with a textbox and a listbox with the following plan:</p>\n\n<ol>\n<li>Users input text in <code>Textbox1</code>.</li>\n<li>Every time <code>Textbox1.Text</code> changes, a search with the following features is performed:\n\n<ul>\n<li><code>Textbox1.Text</code> is searched in a specific range in a worksheet.</li>\n<li><code>Textbox1.Text</code> can be found more than once.</li>\n<li><code>Listbox1</code> is populated with the results of the search.</li>\n</ul></li>\n</ol>\n\n<p>So far so good. Due to having large set of data, the list can get many items. In this case the list reaches out of the screen and I had to limit <code>Listbox1.Height</code>. This is the code for the above:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    Dim srchWord As String, firstAddress As String\n    Dim srchRng As Range, cell As Range\n    Dim maxRow As Integer\n\n    ListBox1.Clear\n    If TextBox1.Value = \"\" Then\n        ListBox1.Height = 0\n    Else\n        With ThisWorkbook.Worksheets(1)\n            maxRow = .Cells(.Rows.Count, 2).End(xlUp).Row\n            Set srchRng = .Range(\"A2:A\" &amp; maxRow)\n        End With\n        srchWord = TextBox1.Value\n        Set cell = srchRng.Find(srchWord, LookIn:=xlValues, lookat:=xlPart)\n\n        With ListBox1\n        If Not cell Is Nothing Then\n            firstAddress = cell.Address\n            Do\n                If Not cell.Value Like \"*(*\" Then\n                    .AddItem (cell.Value)\n                    Select Case .ListCount\n                        Case Is &lt; 2\n                            .Height = 17\n                        Case Is &lt; 21\n                            .Height = 15 * .ListCount\n                        Case Else\n                            .Height = 272.5\n                    End Select\n                    Me.Height = 500\n                End If\n                Set cell = srchRng.FindNext(cell)\n            Loop While Not cell.Address = firstAddress\n        End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>The problem was in <code>Case Else</code> when scroll was enabled I couldn't reach the last item of the list. By searching on the net I found some potential solutions:</p>\n\n<ul>\n<li>set <code>Listbox1.IntegralHeight = False</code> set the height and then set again <code>Listbox1.IntegralHeight = True</code></li>\n<li>set <code>Listbox1.MultiSelect = fmMultiSelectSingle</code> and then set again <code>Listbox1.MultiSelect = fmMultiSelectExtended</code>.</li>\n<li>do both of the above.</li>\n<li><code>Application.Wait (Now + TimeValue(\"0:00:01\") * 0.5)</code> and then set the height.</li>\n</ul>\n\n<p>None of these worked.\nTo be able to scroll to the last item, this worked:</p>\n\n<pre><code>Listbox1.IntegralHeight = False\nListbox1.Height= x\nListbox1.IntegralHeight = False\nListbox1.Height= x\n</code></pre>\n\n<p>but this also set the Listbox1.Height to this of one single item. (with arrows at the right)</p>\n\n<p>Does anybody know how on earth am I going to control the Listbox1.Height without all this unwanted behaviour? Also if somebody can suggest another structure that could follow the plan mentioned at first, I 'm willing to discard the listbox.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511280391, "post_id": 47417431, "comment_id": 81788893, "body": "Did you tried debug your code step by step?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1511280824, "post_id": 47417431, "comment_id": 81789209, "body": "@DavidG. - Yes, But I am unsure of the exact issue."}], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1511281035, "post_id": 47417536, "comment_id": 81789353, "body": "That didn&#39;t work, it didn&#39;t even work for the second sheet. I had to change the line you changed to <code>Set wksNew = .Worksheets.Add(After:=Worksheets(Sheets.Count))</code>"}, {"owner": {"reputation": 11, "user_id": 8790519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BVzXsvy-vlU/AAAAAAAAAAI/AAAAAAAAACY/vjoa4xd9bJ8/photo.jpg?sz=128", "display_name": "Matthew Alger", "link": "https://stackoverflow.com/users/8790519/matthew-alger"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1511284301, "post_id": 47417536, "comment_id": 81791721, "body": "That makes sense, I forgot about adding the parentheses with the &quot;set&quot; statement. Did it still not work after the parentheses? If not, you might add a period between = and Worksheets and put a period before Sheets. I have had problems with that in the past, but it is inconsistent and depends greatly on the context.  <code>wksNew = .Worksheets.Add(After:=.Worksheets(.Sheets.Count))</code>"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1511284375, "post_id": 47417536, "comment_id": 81791781, "body": "It did not work still, yes.  The <code>.Worksheets</code> is need because it is a with statement"}], "tags": [], "owner": {"reputation": 11, "user_id": 8790519, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BVzXsvy-vlU/AAAAAAAAAAI/AAAAAAAAACY/vjoa4xd9bJ8/photo.jpg?sz=128", "display_name": "Matthew Alger", "link": "https://stackoverflow.com/users/8790519/matthew-alger"}, "is_accepted": false, "score": 0, "last_activity_date": 1511280414, "creation_date": 1511280414, "answer_id": 47417536, "question_id": 47417431, "link": "https://stackoverflow.com/questions/47417431/vba-creating-a-new-sheet-and-inserting-data/47417536#47417536", "title": "VBA - Creating a new sheet and inserting data", "body": "<p>If you change it like so, does it work? The change explicitly declares the worksheet to be worked on. I can't say that I know why the Count function gives you an incorrect value.</p>\n\n<pre><code>Dim wksNew as Excel.Worksheet    \n...    \n\nWith ThisWorkbook\n    If .Worksheets(.Sheets.Count).Range(\"A1\") = \"\" Then\n        .Worksheets(.Sheets.Count).Range(\"A1\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n    Else:\n        Set wksNew = .Worksheets.Add After:=Worksheets(Sheets.Count)\n        wksNew.Range(\"A1\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n    End If\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "is_accepted": true, "score": 0, "last_activity_date": 1511288624, "creation_date": 1511288624, "answer_id": 47420113, "question_id": 47417431, "link": "https://stackoverflow.com/questions/47417431/vba-creating-a-new-sheet-and-inserting-data/47420113#47420113", "title": "VBA - Creating a new sheet and inserting data", "body": "<p>I was able to solve it by denoting <code>Sheets.Count</code> as an integer.</p>\n\n<pre><code>Dim n as Double\nDim wksNew as Excel.Worksheet\n    With ThisWorkbook\n        If .Worksheets(.Sheets.Count).Range(\"A1\") = \"\" Then\n            .Worksheets(.Sheets.Count).Range(\"A1\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n        Else:\n            Set wksNew = .Worksheets.Add(After:=.Worksheets(.Sheets.Count))\n            n = .Sheets.Count\n            .Worksheets(n).Range(\"A1\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n        End If\n    End With\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5041, "favorite_count": 0, "accepted_answer_id": 47420113, "answer_count": 2, "score": 0, "last_activity_date": 1511288624, "creation_date": 1511280134, "question_id": 47417431, "link": "https://stackoverflow.com/questions/47417431/vba-creating-a-new-sheet-and-inserting-data", "title": "VBA - Creating a new sheet and inserting data", "body": "<p>I asked a question yesterday that was solved, however, my code only works for two sheets.  I am having an issue with pasting my data into a newly created sheet.  My code will create a second sheet and paste the data into into it.  However, when I try for a third sheet, it creates the sheet, but inserts the data into the second sheet.  Here is my code:</p>\n\n<pre><code>Sub ImportData()\n\n    Dim wkbCrntWorkBook As Workbook\n    Dim wkbSourceBook   As Workbook\n    Dim fNameAndPath As Variant\n\n    Set wkbCrntWorkBook = ActiveWorkbook\n    fNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel 2007, *.xls; *.xlsx; *.xlsm; *.xlsa\", Title:=\"Select File To Import\")\n    If fNameAndPath = False Then Exit Sub\n    Call ReadDataFromSourceFile(fNameAndPath)\n\n\n    Set wkbCrntWorkBook = Nothing\n    Set wkbSourceBook = Nothing\n\nEnd Sub\n\n\nSub ReadDataFromSourceFile(filePath As Variant)\n\n    Application.ScreenUpdating = False\n\n    Dim src As Workbook\n    Set src = Workbooks.Open(filePath, False, False)\n\n    ' COPY DATA FROM SOURCE (CLOSE WORKGROUP) TO THE DESTINATION WORKBOOK.\n    ' GET THE TOTAL ROWS FROM THE SOURCE WORKBOOK.\n    Dim srcRng As Range   ' last line from source\n    With src.Worksheets(\"Sheet1\")\n        Set srcRng = .Range(.Range(\"A1\"), .Range(\"A1\").End(xlDown).End(xlToRight))\n    End With\n\n    With ThisWorkbook\n        If .Worksheets(.Sheets.Count).Range(\"A1\") = \"\" Then\n            .Worksheets(.Sheets.Count).Range(\"A1\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n        Else:\n            .Worksheets.Add After:=Worksheets(Sheets.Count)\n            .Worksheets(Sheets.Count).Range(\"A1\").Resize(srcRng.Rows.Count, srcRng.Columns.Count).Value = srcRng.Value\n        End If\n    End With\n\n    ' CLOSE THE SOURCE FILE.\n    src.Close False             ' FALSE - DON'T SAVE THE SOURCE FILE.\n    Set src = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>So, in short, My code works for the first sheet, when I select the first file and for the second file.  However, when I go to insert the third file into the third sheet, it creates a new sheet and places the data in \"Sheet2\" instead of the newly created sheet.</p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511280220, "post_id": 47417351, "comment_id": 81788761, "body": "<a href=\"https://stackoverflow.com/questions/44932254/excel-vba-error-5-invalid-procedure-call-or-argument-with-power-operand\" title=\"excel vba error 5 invalid procedure call or argument with power operand\">stackoverflow.com/questions/44932254/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 7603952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8b37e8f6a650b24447f02add1871027?s=128&d=identicon&r=PG&f=1", "display_name": "A.david", "link": "https://stackoverflow.com/users/7603952/a-david"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511280899, "post_id": 47417351, "comment_id": 81789259, "body": "@braX , thanks for the comment, but while it is the same error, in the other post the issue is coming from a negative value but there is no negative number in my case. The work around worksheetfunction.power seems to work. I still have to check the numbers but I do not understand the issue in the first place"}, {"owner": {"reputation": 37, "user_id": 7603952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8b37e8f6a650b24447f02add1871027?s=128&d=identicon&r=PG&f=1", "display_name": "A.david", "link": "https://stackoverflow.com/users/7603952/a-david"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1511280971, "post_id": 47417351, "comment_id": 81789308, "body": "my bad stupid comment, of course I have negative values... sorry.  Your comment was the exact explanation to my problem."}], "owner": {"reputation": 37, "user_id": 7603952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8b37e8f6a650b24447f02add1871027?s=128&d=identicon&r=PG&f=1", "display_name": "A.david", "link": "https://stackoverflow.com/users/7603952/a-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511279952, "creation_date": 1511279920, "last_edit_date": 1511279952, "question_id": 47417351, "link": "https://stackoverflow.com/questions/47417351/floating-exponentiation-vba-mac-excel-2016", "title": "floating exponentiation vba mac excel 2016", "body": "<p>Sorry this is my second question today, but I encoutered a very weird behavior (at least to me) and do not understand what is going on. </p>\n\n<p>i have this very simple line of code: </p>\n\n<pre><code>res = 1 - (((beg - fin) / beg) ^ 2.5)\n</code></pre>\n\n<p>This causes an error : </p>\n\n<blockquote>\n  <p>Run time error '5' : Invalid procedure call or argument.</p>\n</blockquote>\n\n<p>If I replace the 2.5 by 2 then the error disappears. Eventually the 2.5 will also be a variable ( a very small one, around 0.001 ) but I changed with 2 when trying to identify the error.<br>\nDoes anyone understand where the error is coming from?</p>\n\n<p>Note : all variable are declared as double. I used a msgbox to retrieve the value of the variables and beg is around 79.01857 and fin is around 174.76</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["vba", "forms", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1511279952, "post_id": 47417222, "comment_id": 81788578, "body": "Make sure all references to worksheets/ranges are qualified using ThisWorkbook, not using ActiveWorkbook and not missing.  Other than that there are no obvious issues there.  It would be useful to know which line of code raises the error."}, {"owner": {"reputation": 1, "user_id": 8979742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a02ab4a124d2af3224fa7b7f1733beb?s=128&d=identicon&r=PG&f=1", "display_name": "peterj", "link": "https://stackoverflow.com/users/8979742/peterj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511280198, "post_id": 47417222, "comment_id": 81788746, "body": "Thank you for the quick response. I&#39;ll make the changes and see what happens. Once when the user hit debug it froze the computer. The only option was to restart. Haven&#39;t hit that button since."}, {"owner": {"reputation": 1, "user_id": 8979742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a02ab4a124d2af3224fa7b7f1733beb?s=128&d=identicon&r=PG&f=1", "display_name": "peterj", "link": "https://stackoverflow.com/users/8979742/peterj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511288369, "post_id": 47417222, "comment_id": 81794205, "body": "Made the changes. Can get the file open now. But when the spin button is clicked or when the or the submit button. Still crashes. Same Error. Hitting debug returns a &quot;recommend closing Excel&quot;"}, {"owner": {"reputation": 1, "user_id": 8979742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a02ab4a124d2af3224fa7b7f1733beb?s=128&d=identicon&r=PG&f=1", "display_name": "peterj", "link": "https://stackoverflow.com/users/8979742/peterj"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511288808, "post_id": 47417222, "comment_id": 81794441, "body": "Edited the code to reflect changes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511289214, "post_id": 47417222, "comment_id": 81794668, "body": "Since it only occurs for one user, this is difficult to debug.  You&#39;d need to figure out what is different about their environment compared to the users who are not having problems."}], "owner": {"reputation": 1, "user_id": 8979742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a02ab4a124d2af3224fa7b7f1733beb?s=128&d=identicon&r=PG&f=1", "display_name": "peterj", "link": "https://stackoverflow.com/users/8979742/peterj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511295896, "creation_date": 1511279586, "last_edit_date": 1511295896, "question_id": 47417222, "link": "https://stackoverflow.com/questions/47417222/vba-excel-run-time-error-2127417848-automation-error-the-object-invoked-has-d", "title": "VBA Excel : run-time error -2127417848 automation error the object invoked has disconnected from its client", "body": "<p>Backstory and pertinent info:</p>\n\n<p>I am not a professional coder. I used to do Oracle pl/sql a long, long, long time ago. Back then I would tinker with VB, I am by no means an expert. As far as Excel, this is my first attempt at using macros. I created this file/form so that myself and others can track issues/trends over time.</p>\n\n<p>This is a spreadsheet sitting on a network drive that many users will access. It has a macro data entry form that will open automatically when the file is opened. Also, the form can be manually opened (Ctrl+Shift+H) if the user happens to close the form without closing the file.</p>\n\n<p>The file was created using Excel 2010 and all users machines are running Excel 2010. All machines are Running Windows 7 Enterprise SP1.\nAll users can open and add/edit the file...except one (the main user that will use this form the most!) **Note: The machine in question has no issues opening ANY other Excel file...just this one.</p>\n\n<p>When the spreadsheet is opened, it is protected so that if the form is closed, the data cannot be accidentally deleted. Within the code right before the insert it is unprotected, activated, then inserted. After the insert it is protected again.</p>\n\n<p>There are two main errors.</p>\n\n<ol>\n<li>When clicking on the File itself from Explorer, Excel hangs, crashes, and attempts a restart.</li>\n<li>When opening Excel and clicking on repair the file, the spreadsheet will open, the form will show. The user will enter the data, Click the \"Record Entry\" button. The data is not inserted and the following message appears: </li>\n</ol>\n\n<blockquote>\n  <p>\"run-time error -2127417848 automation error the object invoked has\n  disconnected from its client\"</p>\n</blockquote>\n\n<p>Things that I have tried with no success (from ideas brought forth with other similar problems):</p>\n\n<p>I have added a blank module, added the \u201cActivate\u201d verbiage, and run the compatibility troubleshooter, with no success.</p>\n\n<p>I have supplied the code for the following:</p>\n\n<p>Microsoft Excel Objects : ThisWorkBook</p>\n\n<p>Forms : usrfrm_HC</p>\n\n<p>Modules : Module1 and Module2 </p>\n\n<hr>\n\n<p>ThisWorkBook Code:</p>\n\n<pre><code>    Private Sub Workbook_Open()\n\n    Dim wks As Worksheet\n\n    Set wks = ActiveSheet \n    ThisWorkbook.Activate \n\n    Set wks = ThisWorkbook.Worksheets(\"DATA\")\n\n    For Each wks In ThisWorkbook.Worksheets\n        wks.Protect , UserInterfaceOnly:=True\n        'wks.Unprotect\n    Next wks\n\n    usrfrm_HC.Show\n\n    End Sub\n</code></pre>\n\n<p>There is one Module1 that is empty</p>\n\n<p>Then I have the following in Module2</p>\n\n<pre><code>    Sub displayUserForm()\n        usrfrm_HC.Show\n    End Sub\n</code></pre>\n\n<p>Then I have a form called: usrfrm_HC  Here is the code:</p>\n\n<pre><code>    Private Sub cmd_CloseForm_Click()\n        Unload Me\n    End Sub\n    __________________________________________________________________\n    'ties the spin button control to the textbox, shows attempts number\n    Private Sub spb_Attempt_Change()\n        tbx_Attempt.Value = Me.spb_Attempt.Value\n    End Sub\n    ___________________________________________________________________\n    Private Sub UserForm_Initialize()\n\n    Dim cReset As Control\n    For Each cReset In Me.Controls\n        If TypeName(cReset) = \"CheckBox\" Then\n            With cReset\n                .Value = \"False\"\n            End With\n        End If\n    Next cReset\n\n    Dim tReset As Control\n    For Each tReset In Me.Controls\n        If TypeName(tReset) = \"TextBox\" Then\n            With tReset\n                .Text = \"\"\n            End With\n         End If\n    Next tReset\n\n    With Me\n        .tbx_Date.Text = Format(Date, \"mm/dd/yyyy\")\n        .tbx_TNumber.Text = \"\"\n        .tbx_LRate.Text = \"\"\n        .tbx_Attempt.Value = 0\n        .spb_Attempt.Value = 0\n        .cbx_PType.Text = \"Select Type\"\n        .cbx_PType.List = Array(\"Value1\", \"Value2\")\n        .chk_FA1.Value = False\n        .chk_FA2.Value = False\n        .chk_FA3.Value = False\n        .chk_FMA1.Value = False\n        .chk_FMA2.Value = False\n        .chk_FMA3.Value = False\n        .chk_CMA1.Value = False\n        .chk_CMA2.Value = False\n        .chk_CMA3.Value = False\n        .chk_AMA1.Value = False\n        .chk_AMA2.Value = False\n        .chk_AMA3.Value = False\n        .chk_AMA4.Value = False\n        .chk_AA1.Value = False\n        .chk_AA2.Value = False\n        .chk_AA3.Value = False\n    End With\n\n    End Sub\n    _______________________________________________________________________\n    Private Sub cmd_RecordEntry_Click()\n\n    Dim MyWorksheet As Worksheet\n    Dim myFirstBlankRow As Long\n\n    Set MyWorksheet = ActiveSheet\n    ThisWorkbook.Activate\n\n    Set MyWorksheet = ThisWorkbook.Worksheets(\"DATA\")\n\n    With MyWorksheet\n\n        'looks for first blank row\n        myFirstBlankRow = .Cells.Find(What:=\"*\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n\n        'ensures mandatory field entered or gives error\n        If (Me.tbx_Date.Value &lt;&gt; \"\") And (Me.tbx_TNumber.Value &lt;&gt; \"\") And (Me.cbx_PType.Text &lt;&gt; \"Select Type\") And (Me.tbx_Attempt.Value &gt; 0) And (Me.tbx_LRate.Value &lt;&gt; \"\") Then\n\n            MyWorksheet.Unprotect\n\n            .Cells(myFirstBlankRow, 1) = Me.tbx_Date.Value\n            .Cells(myFirstBlankRow, 2) = Me.tbx_TNumber.Value\n            .Cells(myFirstBlankRow, 3) = Me.cbx_PType.Value\n            .Cells(myFirstBlankRow, 4) = Me.tbx_Attempt.Value\n            .Cells(myFirstBlankRow, 5) = Me.tbx_LRate.Value\n\n            If Me.chk_FLHSWLink.Value = \"True\" Then .Cells(myFirstBlankRow, 6) = \"X\"\n            If Me.chk_FRHSWLink.Value = \"True\" Then .Cells(myFirstBlankRow, 7) = \"X\"\n            If Me.chk_FTROV.Value = \"True\" Then .Cells(myFirstBlankRow, 8) = \"X\"\n            If Me.chk_FPRV.Value = \"True\" Then .Cells(myFirstBlankRow, 9) = \"X\"\n            If Me.chk_FExtPBox.Value = \"True\" Then .Cells(myFirstBlankRow, 10) = \"X\"\n            If Me.chk_FEMED.Value = \"True\" Then .Cells(myFirstBlankRow, 13) = \"X\"\n            If Me.chk_FLHSCPnl.Value = \"True\" Then .Cells(myFirstBlankRow, 12) = \"X\"\n            If Me.chk_FRHSCPnl.Value = \"True\" Then .Cells(myFirstBlankRow, 11) = \"X\"\n            If Me.chk_FNWW.Value = \"True\" Then .Cells(myFirstBlankRow, 14) = \"X\"\n\n            If Me.chk_FA1.Value = \"True\" Then .Cells(myFirstBlankRow, 15) = Me.tbx_FA1.Value\n            If Me.chk_FA2.Value = \"True\" Then .Cells(myFirstBlankRow, 16) = Me.tbx_FA2.Value\n            If Me.chk_FA3.Value = \"True\" Then .Cells(myFirstBlankRow, 17) = Me.tbx_FA3.Value\n\n            If Me.chk_FMDHFthru.Value = \"True\" Then .Cells(myFirstBlankRow, 18) = \"X\"\n            If Me.chk_FMACDCPwrBox.Value = \"True\" Then .Cells(myFirstBlankRow, 19) = \"X\"\n            If Me.chk_FMDnuts.Value = \"True\" Then .Cells(myFirstBlankRow, 20) = \"X\"\n\n            If Me.chk_FMA1.Value = \"True\" Then .Cells(myFirstBlankRow, 21) = Me.tbx_FMA1.Value\n            If Me.chk_FMA2.Value = \"True\" Then .Cells(myFirstBlankRow, 22) = Me.tbx_FMA2.Value\n            If Me.chk_FMA3.Value = \"True\" Then .Cells(myFirstBlankRow, 23) = Me.tbx_FMA3.Value\n\n            If Me.chk_CMLHSMframes.Value = \"True\" Then .Cells(myFirstBlankRow, 24) = \"X\"\n            If Me.chk_CMRHSMframes.Value = \"True\" Then .Cells(myFirstBlankRow, 25) = \"X\"\n            If Me.chk_CMLHSMWW.Value = \"True\" Then .Cells(myFirstBlankRow, 26) = \"X\"\n            If Me.chk_CMRHSMWW.Value = \"True\" Then .Cells(myFirstBlankRow, 27) = \"X\"\n\n            If Me.chk_CMA1.Value = \"True\" Then .Cells(myFirstBlankRow, 28) = Me.tbx_CMA1.Value\n            If Me.chk_CMA2.Value = \"True\" Then .Cells(myFirstBlankRow, 29) = Me.tbx_CMA2.Value\n            If Me.chk_CMA3.Value = \"True\" Then .Cells(myFirstBlankRow, 30) = Me.tbx_CMA3.Value\n\n            If Me.chk_AMBB.Value = \"True\" Then .Cells(myFirstBlankRow, 31) = \"X\"\n            If Me.chk_AMFthru.Value = \"True\" Then .Cells(myFirstBlankRow, 32) = \"X\"\n            If Me.chk_AMDnuts.Value = \"True\" Then .Cells(myFirstBlankRow, 35) = \"X\"\n            If Me.chk_AMLHSFBrd.Value = \"True\" Then .Cells(myFirstBlankRow, 33) = \"X\"\n            If Me.chk_AMRHSFBrd.Value = \"True\" Then .Cells(myFirstBlankRow, 34) = \"X\"\n            If Me.chk_AMBDoor.Value = \"True\" Then .Cells(myFirstBlankRow, 36) = \"X\"\n            If Me.chk_AMWTBF22.Value = \"True\" Then .Cells(myFirstBlankRow, 37) = \"X\"\n            If Me.chk_AMO2SPnl.Value = \"True\" Then .Cells(myFirstBlankRow, 38) = \"X\"\n\n            If Me.chk_AMA1.Value = \"True\" Then .Cells(myFirstBlankRow, 39) = Me.tbx_AMA1.Value\n            If Me.chk_AMA2.Value = \"True\" Then .Cells(myFirstBlankRow, 40) = Me.tbx_AMA2.Value\n            If Me.chk_AMA3.Value = \"True\" Then .Cells(myFirstBlankRow, 41) = Me.tbx_AMA3.Value\n            If Me.chk_AMA4.Value = \"True\" Then .Cells(myFirstBlankRow, 42) = Me.tbx_AMA4.Value\n\n            If Me.chk_AA1.Value = \"True\" Then .Cells(myFirstBlankRow, 43) = Me.tbx_AA1.Value\n            If Me.chk_AA2.Value = \"True\" Then .Cells(myFirstBlankRow, 44) = Me.tbx_AA2.Value\n            If Me.chk_AA3.Value = \"True\" Then .Cells(myFirstBlankRow, 45) = Me.tbx_AA3.Value\n\n            If Me.tbx_Comments.Value &lt;&gt; \"\" Then .Cells(myFirstBlankRow, 46) = Me.tbx_Comments.Value\n\n            MyWorksheet.Protect , UserInterfaceOnly:=True\n\n            'reset color if there had been an error\n            Me.lbl_Date.ForeColor = RGB(0, 0, 0)\n            Me.lbl_AC.ForeColor = RGB(0, 0, 0)\n            Me.lbl_PType.ForeColor = RGB(0, 0, 0)\n            Me.lbl_Attempt.ForeColor = RGB(0, 0, 0)\n            Me.lbl_LRate.ForeColor = RGB(0, 0, 0)\n\n            'resets form after entry submit\n            UserForm_Initialize\n        Else\n            'displays red error if not filled out correctly\n            If (Me.tbx_Date.Text = \"\") Then Me.lbl_Date.ForeColor = RGB(255, 0, 0) Else Me.lbl_Date.ForeColor = RGB(0, 0, 0)\n\n            If (Me.tbx_TNumber.Text = \"\") Then Me.lbl_AC.ForeColor = RGB(255, 0, 0) Else Me.lbl_AC.ForeColor = RGB(0, 0, 0)\n\n            If (Me.cbx_PType.Text = \"Select Type\") Then Me.lbl_PType.ForeColor = RGB(255, 0, 0) Else Me.lbl_PType.ForeColor = RGB(0, 0, 0)\n\n            If (Me.tbx_Attempt.Value = 0) Then Me.lbl_Attempt.ForeColor = RGB(255, 0, 0) Else Me.lbl_Attempt.ForeColor = RGB(0, 0, 0)\n\n            If (Me.tbx_LRate.Text = \"\") Then Me.lbl_LRate.ForeColor = RGB(255, 0, 0) Else Me.lbl_LRate.ForeColor = RGB(0, 0, 0)\n        End If\n    End With\n\n    End Sub\n    ________________________________________________________________________\n    'checks the checkboxes if additional locations are added\n    Private Sub tbx_AA1_Change()\n        chk_AA1.Value = True\n    End Sub\n\n    Private Sub tbx_AA2_Change()\n        chk_AA2.Value = True\n    End Sub\n\n    Private Sub tbx_AA3_Change()\n        chk_AA3.Value = True\n    End Sub\n\n    Private Sub tbx_AMA1_Change()\n        chk_AMA1.Value = True\n    End Sub\n\n    Private Sub tbx_AMA2_Change()\n        chk_AMA2.Value = True\n    End Sub\n\n    Private Sub tbx_AMA3_Change()\n        chk_AMA3.Value = True\n    End Sub\n\n    Private Sub tbx_AMA4_Change()\n        chk_AMA4.Value = True\n    End Sub\n\n    Private Sub tbx_CMA1_Change()\n        chk_CMA1.Value = True\n    End Sub\n\n    Private Sub tbx_CMA2_Change()\n        chk_CMA2.Value = True\n    End Sub\n\n    Private Sub tbx_CMA3_Change()\n        chk_CMA3.Value = True\n    End Sub\n\n    Private Sub tbx_FMA1_Change()\n        chk_FMA1.Value = True\n    End Sub\n\n    Private Sub tbx_FMA2_Change()\n        chk_FMA2.Value = True\n    End Sub\n\n    Private Sub tbx_FMA3_Change()\n        chk_FMA3.Value = True\n    End Sub\n\n    Private Sub tbx_FA1_Change()\n        chk_FA1.Value = True\n    End Sub\n\n    Private Sub tbx_FA2_Change()\n        chk_FA2.Value = True\n    End Sub\n\n    Private Sub tbx_FA3_Change()\n        chk_FA3.Value = True\n    End Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "date", "ms-access", "filtered-lookup"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1511279267, "post_id": 47417006, "comment_id": 81788041, "body": "I believe the date format should be &quot;mm/dd/yyyy&quot;."}, {"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1511279558, "post_id": 47417006, "comment_id": 81788293, "body": "Fantastic thank you @Kostas K if you add it as an answer I will +1 it"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511293922, "creation_date": 1511278931, "last_edit_date": 1511293922, "question_id": 47417006, "link": "https://stackoverflow.com/questions/47417006/access-2016-vba-date-range-in-a-dlookup", "title": "Access 2016 VBA date range in a DLookUp", "body": "<p>I have a user from called Main_View.\nI have 2 fields (QFrom and QTo) to supply a date range to search a table. I want records that have a date between the date range supplied.</p>\n\n<p>QFROM = Textbox user puts the from date\nQTo = textbox user puts the to date</p>\n\n<p>Table to look in is called ICRELQA which contains a column that holds the date it was entered (ICRELPASEQ - Data Type = short Date) and a field with text (ICRELPAA- Short Text). Using the below DLookUp I want to get the record that is between the date range.</p>\n\n<p>My DLOOKUP IS:</p>\n\n<pre><code>A1_1 = DLookup(\"[ICRELPAA]\", \"ICRELQA\", \"[ICQAHREF] = 1 And [ICQAREF] = 1 And [ICRELQREL] = '\" &amp; Me.searchField &amp; \"' And [ICRELPASEQ] &gt;= #\" &amp; DFROM &amp; \"# AND [ICRELPASEQ] &lt;= #\" &amp; DTo &amp; \"#\")\n</code></pre>\n\n<p>I have tried using Me.DFrom and ME.DTo in the DLookUp but had the same issue.</p>\n\n<p>I have added the following code to make sure that the dates are in the correct format:</p>\n\n<pre><code>DFROM = Format(CDate(Me.QFrom), \"dd/mm/yyyy\")\n    DTo = Format(CDate(Me.QTo), \"dd/mm/yyyy\")\n</code></pre>\n\n<p>When I press the button to trigger the DLookUp I get a result that is also outside of the date range entered.</p>\n\n<p>How can I get the returned value to be JUST the record that is contained inside the date range?</p>\n"}, {"tags": ["excel", "combobox", "label", "userform", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511279837, "post_id": 47416680, "comment_id": 81788508, "body": "Do you know where Label6 is located? Maybe that control is hidden behind another."}, {"owner": {"reputation": 1, "user_id": 8980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c674fbf593399c66bd819b8e68de74aa?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8980490/dennis"}, "edited": false, "score": 0, "creation_date": 1511280064, "post_id": 47416680, "comment_id": 81788653, "body": "Thanks I&#39;ll check..."}, {"owner": {"reputation": 1, "user_id": 8980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c674fbf593399c66bd819b8e68de74aa?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8980490/dennis"}, "edited": false, "score": 0, "creation_date": 1511283785, "post_id": 47416680, "comment_id": 81791387, "body": "I don&#39;t see it hidden behind any other control.  I have about 4 different labels for CB6.  The others work except for the &quot;Select Length&quot; label and command.  Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511284172, "post_id": 47416680, "comment_id": 81791631, "body": "If the other label works, I suggest to look for <code>Label6</code> control in your <code>Properties</code> tab and see the position properties. I guess this control is hidden somewhere."}], "owner": {"reputation": 1, "user_id": 8980490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c674fbf593399c66bd819b8e68de74aa?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8980490/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511278031, "creation_date": 1511277977, "last_edit_date": 1531161705, "question_id": 47416680, "link": "https://stackoverflow.com/questions/47416680/labels-to-comboboxes-not-appearing-for-one-command-but-does-for-other-commands", "title": "labels to comboboxes not appearing for one command but does for other commands", "body": "<p>I'm trying to repair a project that my predecessor had written and I have fixed many of the problems up till now.  I have a user form that works well with many of the comboboxes but I have 6 comboboxes and I'm having trouble with combobox 6. It works well with other commands but there is one command that is not appearing when I choose the relative command in box 5.  Here are the codes:</p>\n\n<pre><code>If ComboBox5.Value = \"18in or LESS\" Then\n        ComboBox6.Clear\n        Me.Label6.Visible = True\n        Me.ComboBox6.Visible = True\n        ComboBox6.AddItem \"PAPER\"\n        ComboBox6.AddItem \"BOARD\"\n        Me.Label6 = \"PAPER/BOARD\"\nEnd If\n\nIf ComboBox5.Value = \"WIDTH&gt;46in\" Then\n        ComboBox6.Clear\n        Me.Label6.Visible = True\n        Me.ComboBox6.Visible = True\n        ComboBox6.AddItem \"LENGTH &gt; 60in\"\n        ComboBox6.AddItem \"60in &gt;= LENGTH &gt; 22in\"\n        ComboBox6.AddItem \"22in or LESS\"\n        Me.Label6 = \"SELECT LENGTH\"\nEnd If\n</code></pre>\n\n<p>Now the PAPER/BOARD works fine but when I choose cb 5 for a different set of commands the corresponding cb6 doesn't appear I just get \"label 6\" on the user form.  Any type of help would be greatly appreciated. Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511277972, "post_id": 47416194, "comment_id": 81787082, "body": "<a href=\"https://stackoverflow.com/questions/19940409/use-vba-macro-to-save-each-excel-worksheet-as-separate-workbook\" title=\"use vba macro to save each excel worksheet as separate workbook\">stackoverflow.com/questions/19940409/&hellip;</a>"}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511278418, "post_id": 47416194, "comment_id": 81787414, "body": "I&#39;ve checked this macro and it saves each workksheet seperatly but I want &quot;Copy Transposed(4)&quot; and &quot;Test1&quot;, &quot;Test2&quot;, &quot;Test3&quot;, &quot;Test4&quot;, &quot;Test5&quot; worksheets in 1 workbook"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511278475, "post_id": 47416194, "comment_id": 81787451, "body": "Then change this part <code>path &amp; ws.Name</code> to whatever you want."}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511278886, "post_id": 47416194, "comment_id": 81787754, "body": "I am not sure what I should change here."}], "answers": [{"tags": [], "owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "is_accepted": false, "score": 0, "last_activity_date": 1511279120, "creation_date": 1511279120, "answer_id": 47417062, "question_id": 47416194, "link": "https://stackoverflow.com/questions/47416194/divide-and-save-worksheets-as-separate-files/47417062#47417062", "title": "divide and save worksheets as separate files", "body": "<p>I spot-tested the below macro, and got it to work. This macro looks for any worksheet with the string \"Copy Transposed\", and creates a workbook with the sheet found and with the sheets \"Test1\" thru \"Test5\". I imagine there are more elegant ways to achieve what you're looking for, but this seemed to work.</p>\n\n<pre><code>Sub Test()\n\nDim WS As Worksheet\nDim WB As Workbook\nDim SearchStr As String\nDim ShtName As String\nDim FName As String\nDim FPath As String\nDim WBNew As Workbook\n\nSet WB = ActiveWorkbook\n\nSearchStr = \"Copy Transposed\"\nFPath = \"C:\\Users\\hwyr53e\\Desktop\\Test Output\\\"\n\n    For Each WS In WB.Sheets\n        ShtName = WS.Name\n        Set wshts = Sheets(Array(\"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\"))\n        If InStr(ShtName, SearchStr) &gt; 0 Then\n            FName = FPath &amp; ShtName &amp; \".xlsm\"\n            Set WBNew = Workbooks.Add\n            wshts.Copy before:=WBNew.Sheets(1)\n            WS.Copy before:=WBNew.Sheets(1)\n            With WBNew\n                .SaveAs FName, FileFormat:=52\n            End With\n            WBNew.Close\n            Set WBNew = Nothing\n        End If\n    Next WS\n\nEnd Sub\n</code></pre>\n\n<p>You will probably want to add a component to delete the sheets that populate with a new instance of Excel.</p>\n\n<p>Let me know if this accomplishes what you're trying to achieve.</p>\n"}], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511279120, "creation_date": 1511276456, "last_edit_date": 1511277554, "question_id": 47416194, "link": "https://stackoverflow.com/questions/47416194/divide-and-save-worksheets-as-separate-files", "title": "divide and save worksheets as separate files", "body": "<p>I have several the same worksheets named \"Copy Transposed\" (Copy Transposed, Copy Transposed(2),Copy Transposed(3) etc.) I'd like to write a macro that will copy one Copy Transposed* worksheet with \"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\". So if I have 5 copy transposed worksheets I want to have 5 seperate files with copy transposed and \"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\". The name of the file should be the same as the name of the active worksheet.\nFor instance I have 5 copy transposed worksheets so:</p>\n\n<ul>\n<li><p>File 1- Copy Transposed.xlsm contains of \"Copy Transposed\", \"Test1\",\n\"Test2\",  \"Test3\", \"Test4\", \"Test5\".</p></li>\n<li><p>File 2- Copy Transposed(2).xlsm contains of \"Copy Transposed(2)\",\n\"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\".</p></li>\n<li><p>File 3- Copy Transposed(3).xlsm contains of \"Copy Transposed(3)\",\n\"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\".</p></li>\n<li><p>File 4- Copy Transposed(4).xlsm contains of \"Copy Transposed(4)\",\n\"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\".</p></li>\n<li><p>File 5- Copy Transposed(5).xlsm contains of \"Copy Transposed(5)\",\n\"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\".</p></li>\n</ul>\n\n<p>The number of \"Copy Transposed\" worksheets is always different</p>\n\n<pre><code>Sub test_macro()\nDim Fname As String\nFname = Sheets(\"Copy Transposed\").Range(\"A1\").Value\nSheets(Array(\"Test1\", \"Test2\", \"Test3\", \"Test4\", \"Test5\")).copy\nWith ActiveWorkbook\nActiveWorkbook.SaveAs ThisWorkbook.path &amp; \"\\\" &amp; Fname &amp; \".xlsm\", FileFormat:=52\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "printing"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 5, "creation_date": 1511276288, "post_id": 47416088, "comment_id": 81785885, "body": "You just call each of the click subroutines in your main event."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1511286014, "last_edit_date": 1511286014, "creation_date": 1511278117, "answer_id": 47416728, "question_id": 47416088, "link": "https://stackoverflow.com/questions/47416088/how-can-i-make-my-excel-vba-macro-click-a-button/47416728#47416728", "title": "How can I make my excel-vba macro click a button?", "body": "<p>Call each subroutine from your main subroutine. Something like this as an example:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  MsgBox \"Button 1\"\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n  MsgBox \"Button 2\"\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\n  MsgBox \"Button 3\"\nEnd Sub\n\nPrivate Sub Main()\n  CommandButton1_Click\n  CommandButton2_Click\n  CommandButton3_Click\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8980266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540ab25a141b4ea37d31ba58d617227?s=128&d=identicon&r=PG&f=1", "display_name": "Ayssar Nasrallah", "link": "https://stackoverflow.com/users/8980266/ayssar-nasrallah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2213, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511286014, "creation_date": 1511276153, "last_edit_date": 1511276162, "question_id": 47416088, "link": "https://stackoverflow.com/questions/47416088/how-can-i-make-my-excel-vba-macro-click-a-button", "title": "How can I make my excel-vba macro click a button?", "body": "<p><strong>Here is the situation:</strong> \nI have several buttons in different worksheets (but in same workbook) and the only thing those buttons do is print the worksheet. So imagine 6 different worksheets that all have a print button that quickly selects the relevant information and sends it to the printer. </p>\n\n<p><strong>Here is what I want to accomplish:</strong>\nI now want to have a single button that will effectively click on all of the six buttons at the same time. So instead of clicking on the six buttons to send every indivudual worksheet to the printer, I would click one button and all of the worksheets would be sent to the printer</p>\n\n<p><strong>I would thus need help with creating a macro that essentially clicks on other macro-buttons which is what I am struggling with.</strong> </p>\n\n<p>Thank you for your help.\n<a href=\"https://i.stack.imgur.com/jQRp2.jpg\" rel=\"nofollow noreferrer\">My situation in image</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 6, "creation_date": 1511276002, "post_id": 47415982, "comment_id": 81785650, "body": "Remove the word <code>Set</code> - It is only used for <code>Object</code> variables. <code>.Text</code> returns a string."}, {"owner": {"reputation": 53, "user_id": 6572192, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3aacbe89414fd0a94cd073521a886b5e?s=128&d=identicon&r=PG&f=1", "display_name": "OscarRP", "link": "https://stackoverflow.com/users/6572192/oscarrp"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1511276484, "post_id": 47415982, "comment_id": 81786037, "body": "Thank you, now properly run."}], "owner": {"reputation": 53, "user_id": 6572192, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/3aacbe89414fd0a94cd073521a886b5e?s=128&d=identicon&r=PG&f=1", "display_name": "OscarRP", "link": "https://stackoverflow.com/users/6572192/oscarrp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 904, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511275872, "creation_date": 1511275872, "question_id": 47415982, "link": "https://stackoverflow.com/questions/47415982/range-text-vba-set-data-into-variable", "title": "Range.Text VBA, set data into variable", "body": "<p>I'm trying to get formatted data from an excel cell. This cell can contains special symbols like &amp;,',\",&lt;,>, LF (End of Line). All this text content will be set inside of a xml structure. For this reason I have to get all this text and parse all special symbols and transformed to a character entity </p>\n\n<pre><code>(&amp;amp; &amp;apos; &amp;quot; &amp;lt;....)\n</code></pre>\n\n<p>To do this, first I have to load the data from cell in my code, it looks like:</p>\n\n<pre><code>Set beforeTransformation = Sheets(langId).Range(\"A46\").Text\n</code></pre>\n\n<p>As official documentation says:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-text-property-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-text-property-excel</a></p>\n\n<p>It's a read only property, so when I execute the VBA macro, next error is outputted,</p>\n\n<blockquote>\n  <p>Compile error: Object required</p>\n</blockquote>\n\n<p>The question is, which is the best way to get data from a cell and set it into a variable for future transformation?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1511278868, "post_id": 47416692, "comment_id": 81787738, "body": "Thanks for helping me out mooseman!  This code fixes part of the problem I had, however it only works for the first sheet. For the remaining sheets it keeps on using the range from sheet 1 (without taking into consideration the ranges for the remaining sheets). Any idea how to fix this?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1511279402, "post_id": 47416692, "comment_id": 81788146, "body": "I edited the answer to directly reference the worksheet to get the range .  See the &quot;MyRange =&quot; line."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1511280240, "post_id": 47416692, "comment_id": 81788775, "body": "You are welcome.  Don&#39;t forget to mark it as answer and upvote, upvote, upvote.  :)"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1511279309, "last_edit_date": 1511279309, "creation_date": 1511278021, "answer_id": 47416692, "question_id": 47415782, "link": "https://stackoverflow.com/questions/47415782/import-multiple-excel-ranges-sheets-to-powerpoint/47416692#47416692", "title": "Import multiple excel ranges/sheets to powerpoint", "body": "<p>IF you want the values in cell A1 And A2, you can't put the variables in quotes when building your range.</p>\n\n<pre><code>Set Rng1 = ActiveSheet.Range(\"Cval1 : Cval2\")\n</code></pre>\n\n<p>Will give you a Rng1 as Cval1 : Cval2</p>\n\n<pre><code>Set Rng1 = ActiveSheet.Range(Cval1 &amp; \":\" &amp; Cval2)\n</code></pre>\n\n<p>Will give you (from your example)  Rng1 = B3:D12</p>\n\n<p>This should be all you need. I haven't tested it, so there may be some tweeking needed.</p>\n\n<pre><code>Sub PrintPPT()\n 'Step 1:  Declare variables\n      Dim pp As Object\n      Dim PPPres As Object\n      Dim PPSlide As Object\n      Dim xlwksht As Worksheet\n      Dim MyRange As String\n\n 'Step 2:  Open PowerPoint, add a new presentation and make visible\n      Set pp = CreateObject(\"PowerPoint.Application\")\n      Set PPPres = pp.Presentations.Add\n      pp.Visible = True\n'Step 3:  Start the loop through each worksheet\n      For Each xlwksht In ActiveWorkbook.Worksheets\n    MyRange = xlwksht.Range(\"A1\").Value &amp; \":\" &amp; xlwksht.Range(\"A2\").Value\n               xlwksht.Range(MyRange).Copy\n 'Step 4:  Count slides and add new blank slide as next available slide number\n '(the number 12 represents the enumeration for a Blank Slide)\n      SlideCount = PPPres.Slides.Count\n      Set PPSlide = PPPres.Slides.Add(SlideCount + 1, 12)\n      PPSlide.Select\n\n 'Step 5:  Paste the picture and adjust its position\n      PPPres.ApplyTemplate (\"C:\\Users\\Computer\\Documents\\Templates\\Template.potx\")\n          PPSlide.Shapes.Paste.Select\n          pp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n          pp.ActiveWindow.Selection.ShapeRange.Top = 80\n          pp.ActiveWindow.Selection.ShapeRange.Left = 7.2\n          pp.ActiveWindow.Selection.ShapeRange.Width = 600\n\n 'Step 6:  Add the title to the slide then move to next worksheet\n      Next xlwksht\n\n 'Step 7:  Memory Cleanup\n      pp.Activate\n      Set PPSlide = Nothing\n      Set PPPres = Nothing\n      Set pp = Nothing\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 47416692, "answer_count": 1, "score": 0, "last_activity_date": 1511279309, "creation_date": 1511275206, "question_id": 47415782, "link": "https://stackoverflow.com/questions/47415782/import-multiple-excel-ranges-sheets-to-powerpoint", "title": "Import multiple excel ranges/sheets to powerpoint", "body": "<p>I have an excel workbook with 20 sheets and I am trying to import these excel sheets into powerpoint using a VBA. I've been able to compose a piece of code which does almost exactly what I need to do, however I am unable to find the solution for the last part.. Hope you guys can help me out!</p>\n\n<p>From each sheet I need to select a different range (which is visible in cell A1 and A2 of each sheet). </p>\n\n<p>for example from excel sheet 1 I have in cell A1 \"B3\" and in cell A2 \"D12\", which means that for this sheet the VBA should copy range B3:D12.  </p>\n\n<p>In the next sheet exactly the same should happen, however it should adjust its range based on what I've given up in cell A1 and A2 of that sheet. </p>\n\n<p>My code so far is as follows:</p>\n\n<pre><code> Sub PrintPPT()\n\n 'Step 1:  Declare variables\n      Dim pp As Object\n      Dim PPPres As Object\n      Dim PPSlide As Object\n      Dim xlwksht As Worksheet\n      Dim MyRange As String\n      Dim Cval1 As Variant\n      Dim Cval2 As Variant\n      Dim Rng1 As Range\n\n 'Step 2:  Open PowerPoint, add a new presentation and make visible\n      Set pp = CreateObject(\"PowerPoint.Application\")\n      Set PPPres = pp.Presentations.Add\n      pp.Visible = True\n\n 'Step 3:  Set the ranges for the data\n      Cval1 = ActiveSheet.Range(\"A1\").Value\n      Cval2 = ActiveSheet.Range(\"A2\").Value\n      Set Rng1 = ActiveSheet.Range(\"Cval1 : Cval2\")\n      MyRange = \"Rng1\"\n\n 'Step 4:  Start the loop through each worksheet\n      For Each xlwksht In ActiveWorkbook.Worksheets\n      xlwksht.Select\n      Application.Wait (Now + TimeValue(\"0:00:1\"))\n\n 'Step 5:  Copy the range as picture\n      xlwksht.Range(MyRange).Copy\n\n 'Step 6:  Count slides and add new blank slide as next available slide number\n '(the number 12 represents the enumeration for a Blank Slide)\n      SlideCount = PPPres.Slides.Count\n      Set PPSlide = PPPres.Slides.Add(SlideCount + 1, 12)\n      PPSlide.Select\n\n 'Step 7:  Paste the picture and adjust its position\n      PPPres.ApplyTemplate (\"C:\\Users\\Computer\\Documents\\Templates\\Template.potx\")\n          PPSlide.Shapes.Paste.Select\n          pp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n          pp.ActiveWindow.Selection.ShapeRange.Top = 80\n          pp.ActiveWindow.Selection.ShapeRange.Left = 7.2\n          pp.ActiveWindow.Selection.ShapeRange.Width = 600\n\n 'Step 8:  Add the title to the slide then move to next worksheet\n      Next xlwksht\n\n 'Step 9:  Memory Cleanup\n      pp.Activate\n      Set PPSlide = Nothing\n      Set PPPres = Nothing\n      Set pp = Nothing\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "loops", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511275348, "post_id": 47415745, "comment_id": 81785164, "body": "one quick tip is remove <code>Range(&quot;A&quot; &amp; i).Select</code> and just write <code>If Range(&quot;A&quot;  &amp; i) = &quot;ELEVATION\\AZIMUTH&quot; Then</code> Also the cut operations and worksheet function call each time will slow things down."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1511276381, "creation_date": 1511276381, "answer_id": 47416166, "question_id": 47415745, "link": "https://stackoverflow.com/questions/47415745/how-to-make-specific-macro-run-faster/47416166#47416166", "title": "How to make specific macro run faster", "body": "<p>See my comments under your original question above and try this tested code. If there is anything I did in the code that you do not understand, please comment and I will clarify.</p>\n\n<pre><code>Option Explicit\n\nSub ConsolidateData()\n\n    With Sheet1 'code name for worksheet 1, change as needed\n\n        Dim lastRow As Long\n        lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        Dim rowCounter As Long\n        For rowCounter = lastRow To 1 Step -1\n\n            If .Cells(rowCounter, 1) = \"ELEVATION\\AZIMUTH\" Then\n\n                Dim i As Integer\n                For i = 1 To 3\n\n                    Dim CopyRange As Range\n                    Set CopyRange = .Range(.Cells(rowCounter + i, 1), .Cells(rowCounter + i, 1).End(xlToRight))\n\n                    Dim cols As Integer\n                    cols = CopyRange.Columns.Count\n\n                    .Cells(rowCounter, 1).End(xlToRight).Offset(, 1).Resize(1, cols).Value = CopyRange.Value\n\n                Next\n\n                Dim rngRemove As Range\n                If rngRemove Is Nothing Then\n                    Set rngRemove = .Cells(rowCounter + 1, 1).Resize(3, 1)\n                Else\n                    Set rngRemove = Union(rngRemove, .Cells(rowCounter + 1, 1).Resize(3, 1))\n                End If\n\n            End If\n\n        Next\n\n        rngRemove.EntireRow.Delete\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1511279422, "creation_date": 1511279422, "answer_id": 47417168, "question_id": 47415745, "link": "https://stackoverflow.com/questions/47415745/how-to-make-specific-macro-run-faster/47417168#47417168", "title": "How to make specific macro run faster", "body": "<p>The fastest way to do it is to do it in memory and write back the results. This could be sped up by reading everything into memory in one go / writing everything back in one go. But for now this does it line by line (Still should be faster). This will overwrite your source data so be sure to test this on a copy first.</p>\n\n<pre><code>Public Sub Example()\n    Dim i As Long, j As Long, r As Long\n    Dim Results As Variant, tmp As Variant\n\n    With ActiveSheet\n        For i = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 1 Step -1\n            If UCase(.Cells(i, 1).Value2) = \"ELEVATION\\AZIMUTH\" Then\n                With Range(.Cells(i, 1), .Cells(i, 1).Offset(3, 8))\n                    tmp = .Value2\n                    .ClearContents\n                End With\n                ReDim Results(LBound(tmp, 1) To UBound(tmp, 1) * UBound(tmp, 2))\n                For r = LBound(tmp, 1) To UBound(tmp, 1)\n                    j = LBound(tmp, 2)\n                    Do\n                        Results(j + IIf(r &gt; 1, UBound(tmp, 2) * (r - 1), 0)) = tmp(r, j)\n                        j = j + 1\n                    Loop While j &lt;= UBound(tmp, 2)\n                Next r\n\n                Range(.Cells(i, 1), .Cells(i, UBound(Results))) = Results\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7169798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-nmeTiVRV_ac/AAAAAAAAAAI/AAAAAAAAAKs/-hnZk1hR-W8/photo.jpg?sz=128", "display_name": "Skirmante Valentaite", "link": "https://stackoverflow.com/users/7169798/skirmante-valentaite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 47417168, "answer_count": 2, "score": 0, "last_activity_date": 1511279422, "creation_date": 1511275085, "last_edit_date": 1531164843, "question_id": 47415745, "link": "https://stackoverflow.com/questions/47415745/how-to-make-specific-macro-run-faster", "title": "How to make specific macro run faster", "body": "<p>Maybe anyone can help me with this part of macro?</p>\n\n<pre><code>Dim LastRow, DataCount, temp  As Double\n        i = 1\n        LastRow = 1\n' skaicius sumeta i viena eilute\n        Do While LastRow &lt;&gt; 0\n            Range(\"A\" &amp; i).Select\n            If ActiveCell.Value = \"ELEVATION\\AZIMUTH\" Then\n                'Cut all three row and paste\n                DataCount = Application.WorksheetFunction.CountA(Range(i &amp; \":\" &amp; i))\n                Range(\"A\" &amp; ActiveCell.row + 1, \"I\" &amp; ActiveCell.row + 1).Cut ActiveCell.Offset(0, DataCount)\n                Range(\"A\" &amp; ActiveCell.row + 2, \"I\" &amp; ActiveCell.row + 2).Cut ActiveCell.Offset(0, DataCount * 2)\n                Range(\"A\" &amp; ActiveCell.row + 3, \"I\" &amp; ActiveCell.row + 3).Cut ActiveCell.Offset(0, DataCount * 3)\n\n            Else\n                LastRow = Application.WorksheetFunction.CountA(Range(\"A\" &amp; i, \"A\" &amp; i + 10))\n            End If\n            i = i + 1\n        Loop\n</code></pre>\n\n<p>If i understand correct the loop going row by row, but i have more then 5000 rows, so it is take a long time to be finish..</p>\n\n<p>macro finding one cell with text \"ELEVATION\\AZIMUTH\" and cutting tree rows after it and combining into one row. I can show how it looks before and after.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UokIP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UokIP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks</p>\n"}]