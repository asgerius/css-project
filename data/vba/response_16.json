[{"tags": ["excel", "vba", "loops", "row", "listobject"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430352796, "post_id": 29956580, "comment_id": 48034314, "body": "What&#39;s the problem?  Is there one?"}, {"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430353262, "post_id": 29956580, "comment_id": 48034465, "body": "@Tim Williams yeah it breaks down when i try to set tblSearchTable= Client.Name, and I&#39;ve tried messing around by changing tblSearchTable to a range instead of a list object. I think the errors mainly have to do with the slightly different properties available to list objects."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430353635, "post_id": 29956580, "comment_id": 48034569, "body": "If the listobject has the same name as the worksheet do you really need to check that?  You can just use <code>Client.ListObjects(1)</code> (<i>without</i> activating the worksheet) as long as there&#39;s just one listobject."}, {"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430425648, "post_id": 29956580, "comment_id": 48073902, "body": "@Tim Williams ok got that part working, I was using a faulty demo workbook. it breaks down at   If ActiveSheet.ListObject.ListRows(i, 1).Value = varTickerToFind _then. I think it has to do with .value not being a property of ListRows, but is there another that I could use to isolate that value in the first column of the table?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1430427025, "post_id": 29977342, "comment_id": 48074643, "body": "Thanks! that works perfectly. Just because I am still new to VBA, what does the Boolean/bFound variable do?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1430427165, "post_id": 29977342, "comment_id": 48074714, "body": "It&#39;s used as a &quot;flag&quot; to capture the fact that the row was found and deleted.  In your original code (absent the other issues) you would have seen a message for every table row until the ticker was located."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1430426229, "creation_date": 1430426229, "answer_id": 29977342, "question_id": 29956580, "link": "https://stackoverflow.com/questions/29956580/loop-to-delete-table-rows-through-numerous-worksheets-based-on-a-cell-value/29977342#29977342", "title": "loop to delete table rows through numerous worksheets based on a cell value", "body": "<p>Tested:</p>\n\n<pre><code>Sub RemoveTickerFromAccounts()\n\nDim Client As Worksheet\nDim varTickerToFind As String\nDim tblSearch As ListObject\nDim bFound As Boolean, i As Long\n\n    varTickerToFind = Worksheets(\"Entry\").Cells(5, 1).Value\n\n    For Each Client In ActiveWorkbook.Worksheets\n\n        If Client.Name Like \"Client_*\" Then\n\n            Set tblSearch = Client.ListObjects(1)\n\n            For i = 1 To tblSearch.ListRows.Count\n                If tblSearch.ListRows(i).Range.Cells(1).Value = varTickerToFind Then\n                    tblSearch.ListRows(i).Delete\n                    bFound = True\n                    Exit For\n                End If\n            Next i\n\n            If Not bFound Then \n                MsgBox \"Unable to Find Ticker '\" &amp; varTickerToFind &amp; \"'\"\n            End If\n        End If\n\n     Next Client\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 29977342, "answer_count": 1, "score": 0, "last_activity_date": 1430426229, "creation_date": 1430351156, "last_edit_date": 1430352822, "question_id": 29956580, "link": "https://stackoverflow.com/questions/29956580/loop-to-delete-table-rows-through-numerous-worksheets-based-on-a-cell-value", "title": "loop to delete table rows through numerous worksheets based on a cell value", "body": "<p>working on a loop to delete stock info from numerous worksheets in a workbook. Each sheet is named, \"Client_ClientFirstName\", and each table in each worksheet is the same as the worksheet name. here is the code ive come up with so far, any and all advice is appreciated. </p>\n\n<pre><code>Sub RemoveTickerFromAccounts()\n\nDim Client As Worksheet\nDim varTickerToFind As String\nvarTickerToFind = Worksheets(\"Entry\").Cells(5, 1)\n\n\nDim tblSearchTable As Range\n\nFor Each Client In ActiveWorkbook.Worksheets\n\n        If InStr(1, Client.Name, \"Client_\", vbTextCompare) Then\n            'ws.Range(\"B30\").Select\n            Worksheets(Client.Name).Activate\n            'tblSearchTable = ActiveSheet.ListObjects(1)\n\n            ActiveSheet.Range(\"b30\").Select\n            If Selection.ListObject.Name = Client.Name Then\n            'tblSearchTable = \"Table14\"\n\n\n            'tblSearchTable = ActiveSheet.ListObjects(Client.Name).Select\n\n        For i = 1 To ActiveSheet.ListObjects(Client.Name).ListRows.Count\n            If ActiveSheet.ListObject.ListRows(i, 1).Value = varTickerToFind _\n                Then\n                tblSearchTable.ListRows(i).Delete\n\n                Exit For\n            Else\n                MsgBox \"Unable to Find Ticker\"\n                Exit For\n            End If\n\n        Next i\n        End If\n    End If\n Next Client\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 1, "creation_date": 1430348010, "post_id": 29955912, "comment_id": 48032760, "body": "<a href=\"http://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">5 ways to find the last row</a> and <a href=\"http://stackoverflow.com/q/10714251/4002530\">How to avoid using select</a> are worth reading and will help you."}, {"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "reply_to_user": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1430349447, "post_id": 29955912, "comment_id": 48033324, "body": "I looked at these awhile back. It makes sense to me...I&#39;m just not sure how to implement it. When I put something like &quot; LastRow = sht.Cells(sht.Rows.Count, &quot;A&quot;).End(xlUp).Row&quot; inside the For Next statement I get an error. I&#39;ve tried countless ways of putting something like that in it. So I just had to ask the question on here."}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1430349809, "post_id": 29955912, "comment_id": 48033418, "body": "Did you define a <code>worksheet</code> object? e.g. <code>dim sht as Worksheet</code>, then <code>set sht = worksheets(&quot;Sheet1&quot;)</code>. You can then use <code>sht</code> in place of <code>If Worksheets(&quot;Sheet1&quot;)...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1430351714, "post_id": 29956458, "comment_id": 48033988, "body": "I&#39;m sorry I can&#39;t provide any real data! It&#39;s for my company. I can tell you that column N is text, M is a due date, and L is text. The spreadsheet is setup so that data begins on row 3 on each sheet. I need to clear the contents of the copied row and also move all the data up. It will never go past row 3 though so I think it should be okay if I delete it ya?  I&#39;m gonna play with this and get back to you. Thank you for being so helpful!"}, {"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1430352298, "post_id": 29956458, "comment_id": 48034160, "body": "Also, there will be lots of data left so I don&#39;t need to clear the sheet. Just move the old data over."}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "reply_to_user": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1430352356, "post_id": 29956458, "comment_id": 48034181, "body": "That&#39;s fine; just be sure to debug the code and make sure the loop is still working and selecting the correct row after the delete."}, {"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1430352910, "post_id": 29956458, "comment_id": 48034354, "body": "Okay so that works. Now it&#39;s only finding two rows and ending the macro even though other rows met the requirements. Is that what you were talking about? Cause now I think I understand what you are saying. Is it possible to move everything after the For Next statement? Or direct it back to the 3rd row on sheet one?"}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "reply_to_user": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1430353481, "post_id": 29956458, "comment_id": 48034533, "body": "I&#39;ve updated the code to include a <code>rowCount</code> variable that starts at 3, but will not increment if a row is deleted. That way it will re-check row 3 if the previous iteration of the loop deleted that row."}, {"owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "edited": false, "score": 0, "creation_date": 1430357657, "post_id": 29956458, "comment_id": 48035729, "body": "Awesome! Definitely learned a lot from you. I just need to iron out some kinks that I&#39;m determined to do by myself, and I&#39;ll be good to go. Thanks again. Thanks for helping out this novice."}], "tags": [], "owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "is_accepted": true, "score": 0, "last_activity_date": 1430353432, "last_edit_date": 1430353432, "creation_date": 1430350424, "answer_id": 29956458, "question_id": 29955912, "link": "https://stackoverflow.com/questions/29955912/need-to-find-the-last-row-in-a-spreadsheet-before-copying-and-pasting-data-from/29956458#29956458", "title": "Need to find the last row in a spreadsheet before copying and pasting data from Sheet 1 to Sheet 2", "body": "<p>Here I've taken your code and changed it to use <code>worksheet</code> objects. I've not tested this on any data as you haven't provided any to use, but it gives you an idea of how to implement it.</p>\n\n<p>Also, in your code you weren't finding the last row of <code>Sheet2</code>, you were putting the data in row <code>i</code>, which starts at 3. </p>\n\n<p>You also need to watch out when you delete the row of data from sheet1, as this shifts the rest of the data up, so the next iteration of the loop may not find the next row of data/ skip a row of data.</p>\n\n<pre><code>Sub archive()\n\nDim LastRow As Long\nDim LastRowSht2 As Long\nDim i As Long\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim rowCount As Long\n\nSet sht1 = Worksheets(\"Sheet1\")\nSet sht2 = Worksheets(\"Sheet2\")\n\nLastRow = sht1.Range(\"M\" &amp; Rows.Count).End(xlUp).Row\nrowCount = 3\n\nFor i = 3 To LastRow\n\n    If sht1.Range(\"M\" &amp; rowCount) - Date &lt;= -4 And sht1.Range(\"N\" &amp; rowCount).Value = \"DONE\" Then\n\n        LastRowSht2 = sht2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1  '+1 so it doesn't overwrite the last row\n        sht2.Range(\"A\" &amp; LastRowSht2).EntireRow.Value = sht1.Range(\"M\" &amp; rowCount).EntireRow.Value\n\n        sht1.Range(\"M\" &amp; rowCount).EntireRow.Delete\n    Else\n        rowCount = rowCount + 1\n    End If\n\n    If sht1.Range(\"L\" &amp; rowCount) = \"\" Then\n        Exit For\n    End If\n\nNext i\n\n' clean up\nset sht1 = nothing\nset sht2 = nothing \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4848470, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10153239800741250/picture?type=large", "display_name": "Micah Lankford", "link": "https://stackoverflow.com/users/4848470/micah-lankford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "accepted_answer_id": 29956458, "answer_count": 1, "score": 2, "last_activity_date": 1430353432, "creation_date": 1430347524, "last_edit_date": 1531164843, "question_id": 29955912, "link": "https://stackoverflow.com/questions/29955912/need-to-find-the-last-row-in-a-spreadsheet-before-copying-and-pasting-data-from", "title": "Need to find the last row in a spreadsheet before copying and pasting data from Sheet 1 to Sheet 2", "body": "<p>This site has helped me immensely with VBA for a while now, so thanks for that! But I just can't seem to get this code to work and I've look at so many examples. What's happening is that I'm archiving data on another sheet once the current date is 4 days ahead of the due date. Everything works like it should, but every time the macro executes, the data on sheet2 is erased and copied over. I need my code to find the last row on sheet2 and copy the data from sheet1 to sheet2 so all the data is there. Thanks!</p>\n\n<pre><code>Sub archive()\n\nDim LastRow As Long\nDim i As Long\nLastRow = Range(\"M\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 3 To LastRow\n\nIf Worksheets(\"Sheet1\").Range(\"M\" &amp; i) - Date &lt;= -4 And Worksheets(\"Sheet1\").Range(\"N\" &amp; i).Value = \"DONE\" Then\nSheet2.Select\n\nRange(\"A\" &amp; i).EntireRow.Value = Sheet1.Range(\"M\" &amp; i).EntireRow.Value\nSheet1.Range(\"M\" &amp; i).EntireRow.Delete\nEnd If\n\nIf Worksheets(\"Sheet1\").Range(\"L\" &amp; i) = \"\" Then\nExit For\nEnd If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 1, "creation_date": 1430350767, "post_id": 29956447, "comment_id": 48033709, "body": "actually I already have done this index match thing, as you can see in my question update, but my problem is to count them and the <code>type1</code> is not always one row below the <code>code1</code>."}, {"owner": {"reputation": 176, "user_id": 4383324, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/kqRCR.jpg?s=128&g=1", "display_name": "Per76", "link": "https://stackoverflow.com/users/4383324/per76"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 1, "creation_date": 1430381369, "post_id": 29956447, "comment_id": 48044923, "body": "Sorry. I was wrong. But I learned a lot. Good look @Mpondomise. Have a nice day!"}], "tags": [], "owner": {"reputation": 176, "user_id": 4383324, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/kqRCR.jpg?s=128&g=1", "display_name": "Per76", "link": "https://stackoverflow.com/users/4383324/per76"}, "is_accepted": false, "score": -1, "last_activity_date": 1430381337, "last_edit_date": 1430381337, "creation_date": 1430350351, "answer_id": 29956447, "question_id": 29955801, "link": "https://stackoverflow.com/questions/29955801/countifs-with-floating-criteria-matching-the-next-value-in-a-column/29956447#29956447", "title": "COUNTIFS with floating criteria matching the next value in a column", "body": "<p>I'm not a pro at Excel but I think you can solve this with INDEX(). </p>\n\n<ul>\n<li><a href=\"http://www.randomwok.com/excel/how-to-use-index-match/\" rel=\"nofollow\">http://www.randomwok.com/excel/how-to-use-index-match/</a></li>\n<li><a href=\"https://support.office.com/en-us/article/INDEX-function-b61bc266-fe02-4852-aad9-77bf8ca3c036\" rel=\"nofollow\">https://support.office.com/en-us/article/INDEX-function-b61bc266-fe02-4852-aad9-77bf8ca3c036</a></li>\n<li><a href=\"http://www.techonthenet.com/excel/formulas/index_function.php\" rel=\"nofollow\">http://www.techonthenet.com/excel/formulas/index_function.php</a></li>\n</ul>\n\n<p>Or if you go into Range.FindNext Method</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff196143.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff196143.aspx</a></p>\n\n<p>Hope some if this will help you.</p>\n\n<p><strong>EDIT:</strong> sorry. I was wrong. But learned a lot.</p>\n"}, {"comments": [{"owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1430385139, "post_id": 29958120, "comment_id": 48047412, "body": "thank you so much. This is a great idea to do this using a helper column. But as you might have guessed from my previous question, I am dealing with a very complex data set, and I am not allowed to have helper columns. Do you know any other way to achieve this using a formula? if not, I think I need to add vba to the tags so that we could find a solution using a vba code, but I am trying to avoid this because of many reasons."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 1, "creation_date": 1430385409, "post_id": 29958120, "comment_id": 48047588, "body": "It is marginally doable with an array formula but <i>very</i> doable with a VBA User Defined Function (aka UDF). The reason I chose the helper column approach is that the array formula&#39;s cal;culation laod would have been prohibitive for anything more than 1K rows."}, {"owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1430387900, "post_id": 29958120, "comment_id": 48049286, "body": "could you please help me the array formula that you are talking about? cal load is not a problem at all."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 1, "creation_date": 1430392956, "post_id": 29958120, "comment_id": 48052423, "body": "@Mpondomise - I&#39;ve given it a couple of attempts ad it always seems to be just one more level of array processing that I cannot wrap into it."}, {"owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1430393853, "post_id": 29958120, "comment_id": 48053012, "body": "I appreciate your attempts to answer this question using formula. If you think it is not possible to do it using a formula, then how can we do it using a vba code? a UDF that we can use in the countifs formula or instead of it? i edited the tags."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 1, "creation_date": 1430397863, "post_id": 29958120, "comment_id": 48055693, "body": "@Mpondomise - see addendum above"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 1, "creation_date": 1430399858, "post_id": 29958120, "comment_id": 48057177, "body": "@Mpondomise - BTW, due to the nested If statements, that function will run faster if the rarest matches are put first. If A:A matches 50% of the time and B:B matches 10% of the time, use B:B as the first column and  criteria. It will kick out to the next row without processing any further on no match so the rarest set of column and criteria should be first."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1430397839, "last_edit_date": 1430397839, "creation_date": 1430361759, "answer_id": 29958120, "question_id": 29955801, "link": "https://stackoverflow.com/questions/29955801/countifs-with-floating-criteria-matching-the-next-value-in-a-column/29958120#29958120", "title": "COUNTIFS with floating criteria matching the next value in a column", "body": "<p>Overly complex array formulas chew calculation resources up quickly and looking for the first non-blank entry in an offsetting range comes into this category. Sometimes it is simply easier to introduce a <em>helper column</em> with a portion of the information necessary to arrive at an expedient result.</p>\n\n<p>In an unused column to the right use this standard formula in row 2.</p>\n\n<pre><code>=IF(LEN($D2), INDEX($C2:$C$999, MATCH(\"*\", $C2:$C$999, 0)), \"\")\n</code></pre>\n\n<p>Edit the <em>999</em> ending row if you need more rows. It can be left alone if you have less. As a standard formula this is entered normally. Fill down as necessary to catch all of the returns.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/xlYb4.png\" alt=\"Helper Columns for COUNT\"></p>\n\n<p>The <code>MATCH(\"*\", $C2:$C$999, 0)</code> could also be <code>MATCH(\"Type*\", $C2:$C$999, 0)</code> is you need more specific lookups.</p>\n\n<p>Now you can use a conventional (and efficient) <a href=\"https://support.office.com/en-us/article/COUNTIFS-function-53C4DC8E-0E5B-4E32-93DF-9CA5E7DA89ED\" rel=\"nofollow noreferrer\">COUNTIFS function</a> to achieve your results.</p>\n\n<p><strong>Addendum:</strong> UDF alternative</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/8chBc.png\" alt=\"UDF for condition floating range COUNT\"></p>\n\n<p>The code for the UDF is:</p>\n\n<pre><code>Function udf_CountIf_Next_Item(rR1 As Range, sS1 As String, _\n    rR2 As Range, sS2 As String, rR3 As Range, sS3 As String, _\n    rR4 As Range, sS4 As String, Optional sS5 As String = \"\")\n\n    Dim rw As Long, rws As Long, n As Long\n    With Intersect(rR1.Parent.UsedRange, rR1)\n        rws = .Rows.Count\n    End With\n    For rw = 1 To rws\n        If LCase(rR1(rw).Value2) = LCase(sS1) Then\n            If LCase(rR2(rw).Value2) = LCase(sS2) Then\n                If LCase(rR3(rw).Value2) = LCase(sS3) Then\n                    If Not IsError(Application.Match(sS5 &amp; Chr(42), rR4(rw).Resize(999, 1), 0)) Then\n                        If LCase(Application.Index(rR4(rw).Resize(999, 1), _\n                          Application.Match(sS5 &amp; Chr(42), rR4(rw).Resize(999, 1), 0))) = LCase(sS4) Then\n                            n = n + 1\n                        End If\n                    End If\n                End If\n            End If\n        End If\n    Next rw\n\n    udf_CountIf_Next_Item = n\n\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>syntax:<br/>\u00a0<br/>udf_CountIf_Next_Item(<em>&lt;1<sup>st</sup> column&gt;, &lt;1<sup>st</sup> criteria&gt;, &lt;2<sup>nd</sup> column&gt;, &lt;2<sup>nd</sup> criteria&gt;, &lt;3<sup>rd</sup> column&gt;, &lt;3<sup>rd</sup> criteria&gt;,  &lt;special floating column&gt;, &lt;4<sup>th</sup> criteria&gt;, [optional]&lt;partial floating criteria&gt;</em>)</p>\n</blockquote>\n\n<p>The formula in J7 of the above sample image is:</p>\n\n<pre><code>=udf_CountIf_Next_Item($A:$A, $F7,$B:$B, $G7,$D:$D, $I7,$C:$C, $H7, \"Type\")\n</code></pre>\n\n<p>Full column references shouldn't be a problem as the UDF truncates them to the boundaries of the worksheet's UsedRange property. Partial column references like A2:A99 can still be used.</p>\n"}], "owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 29958120, "answer_count": 2, "score": 2, "last_activity_date": 1430398060, "creation_date": 1430347055, "last_edit_date": 1430398060, "question_id": 29955801, "link": "https://stackoverflow.com/questions/29955801/countifs-with-floating-criteria-matching-the-next-value-in-a-column", "title": "COUNTIFS with floating criteria matching the next value in a column", "body": "<p>I have the following example data with four <strong>columns</strong> <strong>Class</strong>, <strong>ID</strong>, <strong>Type</strong> and <strong>Code</strong>:\n<br></p>\n\n<pre><code>Class   ID  Type    Code\nClass1  ID1         Code1\nClass1  ID1 Type1   \nClass1  ID1 Type2   \nClass1  ID1     \nClass1  ID1         Code1\nClass1  ID1     \nClass1  ID1 Type1   \nClass1  ID1         Code1\nClass1  ID1 Type2   \nClass1  ID1     \nClass1  ID1         Code1\nClass1  ID1     \nClass1  ID1 Type2   \nClass1  ID1 Type1   \nClass1  ID1         Code1\nClass1  ID1 Type2   \nClass1  ID1 Type2   \nClass1  ID1 Type2   \n</code></pre>\n\n<p>I have the following formula:</p>\n\n<pre><code>=COUNTIFS($A:$A;\"Class1\";$B:$B;\"ID1\";$D:$D;\"code1\")\n</code></pre>\n\n<p><strong>BUT</strong> I want to achieve a <code>countifs</code> formula with an additional condition:<br>\n<em>count only those <code>code1</code>s that have <code>type1</code> as the next occurence in column <strong>TYPE</em></strong>\n<br>\nSo I will have:\nby maintaining the above conditions in the formula and adding the additional condition:\nthe <code>count</code> of <strong>code1</strong> with <strong>type1</strong> as the next occurrence will be <strong>2</strong>. And similarly, the <code>count</code> of <strong>code1</strong> with <strong>type2</strong> as the next occurrence in <code>TYPE column</code> will be <strong>3</strong>.</p>\n\n<p><strong>Edit:</strong>\nActually I know how to find my nth match using:</p>\n\n<pre><code>SMALL(IF($C$1:$C$51=\"type1\";ROW($C$1:$C$51);\"\");1)\n</code></pre>\n\n<p>but I don't know how to merge these two formulas.</p>\n\n<p>Acually, I can already locate my <code>code1</code> and then in relation to its cell reference locate my <code>type1</code> in the previous column <strong>one row</strong> below, but it is not always one row below, sometimes it is two or three or more.</p>\n\n<pre><code>=OFFSET(INDEX($D:$D;MATCH(1;(D:D=\"code1\")*(A:A=\"class1\");0);1);1;-1;1;1)\n</code></pre>\n\n<p><br>I feel that it has something to do with <code>sumproduct</code> and <code>offset</code> or <code>index/match</code>, but I cannot find my way through it.</p>\n\n<p><br>\n**P.S. ** I also tried the following, but still no result:</p>\n\n<pre><code>=MMULT(($A:$A=\"Class1\")*($B:$B=\"ID1\")*($D:$D=\"code1\");N(OFFSET(INDEX($D:$D;MATCH(1;(D:D=\"code1\")*(A:A=\"class1\");0);1);1;-1;1;1)=\"type1\"))\n</code></pre>\n\n<h2>UPDATE</h2>\n\n<p>Since it seems a bit of problem achieving this, I am adding this update to see how we can achieve this using a UDF?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1430348242, "creation_date": 1430348242, "answer_id": 29956062, "question_id": 29955676, "link": "https://stackoverflow.com/questions/29955676/specialcellsxlcelltypevisible-error-when-autofilter-returns-zero-rows/29956062#29956062", "title": "SpecialCells(xlCellTypeVisible) - Error when Autofilter returns zero rows", "body": "<p>You can ignore the error if there are no visible cells:</p>\n\n<pre><code>Dim rngVis as Range\n\nWith rRange \n\n    .AutoFilter Field:=2, Criteria1:=projectID \n    .AutoFilter Field:=3, Criteria1:=\"Open\"\n\n     'ignore error if no visible cells\n     On Error Resume Next\n     Set rngVis = .SpecialCells(xlCellTypeVisible)\n     On Error Goto 0\n\n     If Not rngVis Is Nothing then\n\n         'work with rngVis \n\n     End If 'any visible cells\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3255246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53cd483c152d26710280d2412b8346ef?s=128&d=identicon&r=PG&f=1", "display_name": "user3255246", "link": "https://stackoverflow.com/users/3255246/user3255246"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "accepted_answer_id": 29956062, "answer_count": 1, "score": 0, "last_activity_date": 1430352667, "creation_date": 1430346411, "last_edit_date": 1531164843, "question_id": 29955676, "link": "https://stackoverflow.com/questions/29955676/specialcellsxlcelltypevisible-error-when-autofilter-returns-zero-rows", "title": "SpecialCells(xlCellTypeVisible) - Error when Autofilter returns zero rows", "body": "<p>Below is a portion of my code. My code will throw an error when the Autofilter for the criteria returns Zero rows. I tried the row.count but does not help. Is there a way to workaround this scenario?</p>\n\n<p>The first line is where it is failing. Appreciate any help!</p>\n\n<pre><code>With rRange\n    .AutoFilter Field:=2, Criteria1:=projectID\n    .AutoFilter Field:=3, Criteria1:=\"Open\"\n    'RangeCellcount = .SpecialCells(xlCellTypeVisible).EntireRow.Count\n\n\n\n\n               For Each rActiveCell In .SpecialCells(xlCellTypeVisible)\n\n                    If arrayCol = 12 Then\n                       arrayRow = arrayRow + 1\n                       arrayCol = 0\n                    End If\n                    If arrayRow = 3 Then\n                       Exit For\n                    End If\n\n                    MyArray(arrayRow, arrayCol) = rActiveCell.Value\n\n                    arrayCol = arrayCol + 1\n\n                Next rActiveCell\n\n          End With\n</code></pre>\n"}, {"tags": ["jquery", "html", "vba", "excel", "internet-explorer-10"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1430347938, "post_id": 29955157, "comment_id": 48032737, "body": "There are no choices in the select you posted the HTML for, so it looks like they&#39;re being loaded dynamically.  Instead of using &quot;view source&quot; to get the HTML it might be more useful to use the IE Developer tools (F12) to try to get the actual source (ie. not the source as delivered from the server, but the HTML after it has been updated by the script on the page) Use the &quot;magnifying glass&quot; tool to view the HTML for the select list - if it has choices then you should be able to see the underlying HTML."}, {"owner": {"reputation": 11, "user_id": 4602014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c08bd1d76dad1860f34f9d5d1df8a730?s=128&d=identicon&r=PG&f=1", "display_name": "jcfranks87", "link": "https://stackoverflow.com/users/4602014/jcfranks87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430401013, "post_id": 29955157, "comment_id": 48058033, "body": "Wow, thanks Tim! Using F12 let me get into the code and see the actual options! Will update if I have any more issues, but I seem to be able to now properly fill the menus."}, {"owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1529413735, "post_id": 29955157, "comment_id": 88857354, "body": "@TimWilliams Hi Tim, can you please take a look at my issue with VBE IE (I have tried few things already but no luck - please see Questions section on my profile). Much obliged"}], "owner": {"reputation": 11, "user_id": 4602014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c08bd1d76dad1860f34f9d5d1df8a730?s=128&d=identicon&r=PG&f=1", "display_name": "jcfranks87", "link": "https://stackoverflow.com/users/4602014/jcfranks87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 993, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1430343902, "creation_date": 1430343902, "question_id": 29955157, "link": "https://stackoverflow.com/questions/29955157/navigating-ie-dynamic-drop-down-boxes-with-vba-excel", "title": "Navigating IE Dynamic Drop Down Boxes with VBA (Excel)", "body": "<p>I'm currently working on a project to automate some data collection that's currently being done manually.</p>\n\n<p>The data is collected from a website with a simple ctrl + a -> ctrl + c -> ctrl + v series of commands to paste it into an excel document. I've already done a lot of work to automate validations via Excel, but I've run into a hiccup trying to automate the data collection.</p>\n\n<p>At this point I can open up IE, navigate to the webpage, login and then open the correct page from there. My issue is that there are then 6 drop down menus that must be filled before the data can be pulled. Three of the menus are no issue as they have set variables; the issue is with the other three which contain dynamic lists. Here is some of the source code for these menus:</p>\n\n<pre><code>*other menus*\n                        &lt;td align=\"right\" nowrap=\"nowrap\" class=\"filterItemName\"&gt;&amp;nbsp;FG BA:&amp;nbsp;&amp;nbsp;&lt;/td&gt;\n                    &lt;td&gt;\n                        &lt;select name=\"CAId\" onchange=\"ChangeFG(); return false;\" class=\"blacksmallnormal\"&gt;\n                            &lt;option value='-1'&gt;Please wait...&lt;/option&gt;\n                        &lt;/select&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n                    &lt;/td&gt;\n                    &lt;td colspan=\"2\"&gt;&amp;nbsp;&lt;/td&gt;\n*other menus*\n</code></pre>\n\n<p>Now, I have basically zero experience with website code (html? java? no clue) and honestly only a few weeks with VBA, so I have pretty much no clue what this means. I tried to grab what's relevant but there's a lot of code. I'm guessing that it has something to do with this function, though:</p>\n\n<pre><code>    function ChangeFG()\n{\n    var objSC = document.getElementById(\"SCId\");\n    var objCA = document.getElementById(\"CAId\");\n\n    if (objSC &amp;&amp; objCA) {\n        var Arr = new Array();\n        Arr[\"SC\"] = objSC[objSC.selectedIndex].value;\n        Arr[\"CA\"] = objCA[objCA.selectedIndex].value;\n        if(Arr[\"CA\"] == \"-1\")\n        {\n            alert(\"Please choose BA\");\n            return;\n        }\n        Arr[\"GetJustFG\"] = 1;\n        UpdateJustDropDown(\"&lt;option value='-1'&gt;Please wait...&lt;/option&gt;\", \"FG\");\n        var url = \".....\";\n        SendAJAXCommand('UPDT_FLG', url, UpdateFGWithData, \"FG\", true, Arr);\n    }\n</code></pre>\n\n<p>First, I have no clue how to view the dynamic lists for these menus aside from clicking on them myself; I'm not sure how to determine which is the option I need. Secondly, when I have just stuck a value in for the list the menu ends up blank.</p>\n\n<p>Here is some code of what I've been trying:</p>\n\n<pre><code>Private Sub RetrieveData_Click()\n\nDim appIE As Object\nDim website As String\nDim UsNa As Object\nDim PsWd As Object\nDim ElementCol As Object\nDim btnInput As Object\n\nApplication.ScreenUpdating = False\n\nSet appIE = CreateObject(\"internetexplorer.application\")\nappIE.Visible = True\n\nwebsite = \"https://www....\"\n\nWith appIE\n    .Navigate website\n    .Visible = True\nEnd With\n\nDo While appIE.Busy\nLoop\n\n*Login here*\n\n'navigate to actual page to get data from\nappIE.Navigate (\"https://www...\")\n\nDo While appIE.Busy\nLoop\n\nDoEvents\n\nSet ElementCol = appIE.Document.getElementsByTagName(\"select\")\n\nFor Each btnInput In ElementCol\n    If btnInput.Name = \"SCId\" Then\n        btnInput.Value = \"8\"\n        Exit For\n    End If\nNext\n\nDo While appIE.Busy\nLoop\n\nSet ElementCol = appIE.Document.getElementsByTagName(\"select\")\n\nFor Each btnInput In ElementCol\n    If btnInput.Name = \"Direction\" Then\n        btnInput.Value = \"0\"\n    Exit For\n    End If\nNext\n\nDo While appIE.Busy\nLoop\n\nFor Each btnInput In ElementCol\n    If btnInput.Name = \"FG\" Then\n        btnInput.FireEvent (\"onChange\")\n        btnInput.Value = \"6009\"\n    Exit For\n    End If\nNext\n</code></pre>\n\n<p>I know it's messy code and whatnot; the plan is to clean it up after I figure out how to make it work. It's certainly gotten messier as I kept iterating on this issue.</p>\n\n<p>Anyway, any insight on how to make this work would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1430343013, "post_id": 29954615, "comment_id": 48030616, "body": "You cant have two BeforeSave Events. Combine them."}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1430353431, "post_id": 29954615, "comment_id": 48034513, "body": "If I may ask, why is this being downvoted? The OP includes the code, describes the problem, includes the actual error message -- what makes this not an ideal question? How could it be improved?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4848217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f06ff3e6c25884fb65e653ef3540f18?s=128&d=identicon&r=PG&f=1", "display_name": "gmaganlal", "link": "https://stackoverflow.com/users/4848217/gmaganlal"}, "edited": false, "score": 0, "creation_date": 1430488500, "post_id": 29955084, "comment_id": 48095593, "body": "Thank you. Now I get a different error, variable not defined."}, {"owner": {"reputation": 11, "user_id": 4848217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f06ff3e6c25884fb65e653ef3540f18?s=128&d=identicon&r=PG&f=1", "display_name": "gmaganlal", "link": "https://stackoverflow.com/users/4848217/gmaganlal"}, "edited": false, "score": 0, "creation_date": 1430489212, "post_id": 29955084, "comment_id": 48096046, "body": "Hi, now I get a compile error: variable not defined. I followed instructions per <a href=\"http://123sharepoint.ch/archives/176\" rel=\"nofollow noreferrer\">123sharepoint.ch/archives/176</a>"}, {"owner": {"reputation": 11, "user_id": 4848217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f06ff3e6c25884fb65e653ef3540f18?s=128&d=identicon&r=PG&f=1", "display_name": "gmaganlal", "link": "https://stackoverflow.com/users/4848217/gmaganlal"}, "edited": false, "score": 0, "creation_date": 1430489319, "post_id": 29955084, "comment_id": 48096117, "body": "Would really appreciate a fix. Have been struggling with this for weeks! Thanks a lot."}], "tags": [], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "is_accepted": false, "score": 1, "last_activity_date": 1430343619, "creation_date": 1430343619, "answer_id": 29955084, "question_id": 29954615, "link": "https://stackoverflow.com/questions/29954615/excel-vba-ambiguous-name-prompt/29955084#29955084", "title": "Excel VBA - Ambiguous Name Prompt", "body": "<p>Copy all the code in one event (that is, everything after the <code>Private Sub</code> line and before the <code>End Sub</code> line) and paste it into the other event, either right after the <code>Private Sub</code> or right before the <code>End Sub</code>. Then remove the whole event you copied from.</p>\n"}], "owner": {"reputation": 11, "user_id": 4848217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f06ff3e6c25884fb65e653ef3540f18?s=128&d=identicon&r=PG&f=1", "display_name": "gmaganlal", "link": "https://stackoverflow.com/users/4848217/gmaganlal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1430343619, "creation_date": 1430341763, "last_edit_date": 1531164843, "question_id": 29954615, "link": "https://stackoverflow.com/questions/29954615/excel-vba-ambiguous-name-prompt", "title": "Excel VBA - Ambiguous Name Prompt", "body": "<p>I get the ambiguous name prompt with this excel vba: </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUi As Boolean, Cancel As Boolean)\n    ActiveWorkbook.CustomDocumentProperties(\u201cDepartmentCode\u201d).value = Range(\u201cDepartmentCode\u201d)\n    ActiveWorkbook.ContentTypeProperties(\u201cDepartmentCode\u201d).value = Range(\u201cDepartmentCode\u201d)\nEnd Sub\n</code></pre>\n\n<p>There is another Public Sub Workbook_BeforeSave event in the same workbook which is also required. How do I work around this.</p>\n\n<p>I have no knowledge of VBA. I found the string above on google. I am basically trying to synchronize data in excel with columns in SharePoint.</p>\n\n<p>Would appreciate help on this.</p>\n\n<p>How can I work around it? Sorry, I have no knowledge of vba. Just copied from google</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1430340393, "post_id": 29953580, "comment_id": 48029129, "body": "A good start (to avoid your question getting closed) would be to show your existing code."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4848082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24cdb16c52753baf8d3687337d41bc98?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4848082/matt"}, "edited": false, "score": 0, "creation_date": 1431886006, "post_id": 29954322, "comment_id": 48677380, "body": "Im getting there with my code, but want to use regex to find actual 6 digit numbers only, my code so far is below:-"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1430340784, "creation_date": 1430340784, "answer_id": 29954322, "question_id": 29953580, "link": "https://stackoverflow.com/questions/29953580/outlook-vba-code-to-search-inbox/29954322#29954322", "title": "Outlook VBA code to search inbox", "body": "<p>Looping through all items in the folder is a time-consuming task which can take a lot of time. I'd suggest using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Find</a>/<a href=\"https://msdn.microsoft.com/en-us/library/office/ff862482.aspx\" rel=\"nofollow\">FindNext</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/aa210275(v=office.11).aspx\" rel=\"nofollow\">Restrict</a> methods to get items that correspond to your condition.  </p>\n\n<p>You may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful.</p>\n"}], "owner": {"reputation": 11, "user_id": 4848082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24cdb16c52753baf8d3687337d41bc98?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4848082/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593248507, "creation_date": 1430338234, "last_edit_date": 1593248507, "question_id": 29953580, "link": "https://stackoverflow.com/questions/29953580/outlook-vba-code-to-search-inbox", "title": "Outlook VBA code to search inbox", "body": "<p>I'm trying to write an Outlook macro that will cycle through my inbox and search each email Subject line for text containing a six digit integer (job number) e.g. <code>102296</code> and then move any emails with that job number in the subject line to a sub folder named by the job number. There could be any number of job folders, all named starting with a unique 6 digit job number, followed by a job title e.g. <code>102296-energy</code> report. I've written code that searches the emails for a manually imputed job number, but want to automate the process further.</p>\n"}, {"tags": ["ms-access", "vba", "metadata"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1430338537, "post_id": 29953367, "comment_id": 48028047, "body": "Do you want any information other than table names? Should those include linked tables or only the native Access tables contained in the target MDB?"}, {"owner": {"reputation": 2297, "user_id": 977711, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/27803d664ebc229861d2ba5e95e0b286?s=128&d=identicon&r=PG", "display_name": "Mustapha George", "link": "https://stackoverflow.com/users/977711/mustapha-george"}, "edited": false, "score": 0, "creation_date": 1430347956, "post_id": 29953367, "comment_id": 48032748, "body": "This is interesting post.  Hans, do you have answer to either?"}, {"owner": {"reputation": 43, "user_id": 4438357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ea586b558021f6350632399b7697c0?s=128&d=identicon&r=PG&f=1", "display_name": "itp", "link": "https://stackoverflow.com/users/4438357/itp"}, "edited": false, "score": 0, "creation_date": 1430394444, "post_id": 29953367, "comment_id": 48053413, "body": "both native Access tables and ODBC (Oracle and IBM DB2)."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1430405795, "last_edit_date": 1430405795, "creation_date": 1430401280, "answer_id": 29969358, "question_id": 29953367, "link": "https://stackoverflow.com/questions/29953367/iterate-through-a-directory-of-mdb-and-extract-meta-data/29969358#29969358", "title": "iterate through a directory of MDB and extract meta data", "body": "<p>You can use the ADO <code>OpenSchema</code> method to list the tables in an Access database.   </p>\n\n<p>That method requires an ADO <code>Connection</code> to the target database, which means a lock file (<em>.ldb</em> for your <em>.mdb</em> file) will be created/updated.  But if that database includes an <em>AutoExec</em> macro, the macro will not run.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub ListTables(ByVal pFullPath As String)\n    Const adSchemaTables As Long = 20\n    Dim cn As Object ' ADODB.Connection\n    Dim rs As Object ' ADODB.Recordset\n    Dim strConnect As String\n    Dim strProvider As String\n\n    strProvider = CurrentProject.Connection.Provider\n    strConnect = \"Provider=\" &amp; strProvider &amp; \";\" &amp; _\n        \"Data Source=\" &amp; pFullPath &amp; \";\"\n    Set cn = CreateObject(\"ADODB.Connection\")\n    cn.Open strConnect\n\n    Set rs = cn.OpenSchema(adSchemaTables)\n    With rs\n        Do While Not .EOF\n            If !TABLE_TYPE &lt;&gt; \"VIEW\" Then\n                Debug.Print !TABLE_NAME\n            End If\n            .MoveNext\n        Loop\n        .Close\n    End With\n    cn.Close\n    Set rs = Nothing\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>If you also want to see whether each of those items is linked table or a local table, change the <code>Debug.Print</code> line to this ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print !TABLE_NAME, !TABLE_TYPE\n</code></pre>\n\n<p>More information is available at <a href=\"http://support.microsoft.com/kb/186246\" rel=\"nofollow\">How To Use the ADO OpenSchema Method in Visual Basic</a></p>\n"}], "owner": {"reputation": 43, "user_id": 4438357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ea586b558021f6350632399b7697c0?s=128&d=identicon&r=PG&f=1", "display_name": "itp", "link": "https://stackoverflow.com/users/4438357/itp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430868893, "creation_date": 1430337616, "last_edit_date": 1430868893, "question_id": 29953367, "link": "https://stackoverflow.com/questions/29953367/iterate-through-a-directory-of-mdb-and-extract-meta-data", "title": "iterate through a directory of MDB and extract meta data", "body": "<p>With the code below, we can extract table data from Access file. </p>\n\n<p>Building on this, is it possible to iterate through a directory of MDBs and extract this information 1) without opening each one, or 2) opening each one but not running auto-execute macros.</p>\n\n<pre><code>Function dmwListAllTables() As String\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nDim tbl As AccessObject, db As Object\nDim strMsg As String\n\nOn Error GoTo Error_Handler\n\nSet dB = Application.CurrentData\nFor Each tbl In db.AllTables\nDebug.Print tbl.Name\nNext tbl\n\nstrMsg = \" -- Tables listing complete -- \"\n\nProcedure_Done:\ndmwListAllTables = strMsg\nExit Function\n\nError_Handler:\nstrMsg = Err.Number &amp; \" \" &amp; Err.Description\nResume Procedure_Done\n\nEnd Function\n</code></pre>\n\n<p>souce: <a href=\"http://www.consultdmw.com/access-VBA-list-objects.htm\" rel=\"nofollow\">http://www.consultdmw.com/access-VBA-list-objects.htm</a></p>\n\n<p>BTW. The \"loop through\" part is not a problem:</p>\n\n<pre><code> Sub REadThroughFiles()\n    Dim MyObj As Object, MySource As Object, file As Variant\n   file = Dir(\"c:\\myfolder\\\")\n   While (file &lt;&gt; \"\")\n      If InStr(file, \"myprefix\") &gt; 0 Then\n        // do something here...\n      End If\n     file = Dir\n  Wend\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "styles"], "comments": [{"owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430838761, "post_id": 29953322, "comment_id": 48228356, "body": "Are you certain that all of these text strings actually exist in your document? You&#39;re not checking whether or not they were found before you apply a style."}, {"owner": {"reputation": 23, "user_id": 4848042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81378701da97cf712e2fb1df9e4ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "DP7", "link": "https://stackoverflow.com/users/4848042/dp7"}, "reply_to_user": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430840537, "post_id": 29953322, "comment_id": 48229736, "body": "Hi Christina.  Thanks for your reply. If you mean that those 3.2* numbers exist int he doc, then yes they do. As I said, I am very new to this programming thing. ;).  Essentially, I am trying to pick out the numbers that are always in these docs, and then formatting them to a tiered heading style, leaving the text within the sections alone.  Do I have to tell the program to select the whole document to search? Any info you could provide would be helpful."}, {"owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430920127, "post_id": 29953322, "comment_id": 48270788, "body": "Does each number only appear once, and do they appear on their own lines?"}, {"owner": {"reputation": 23, "user_id": 4848042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81378701da97cf712e2fb1df9e4ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "DP7", "link": "https://stackoverflow.com/users/4848042/dp7"}, "reply_to_user": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430924955, "post_id": 29953322, "comment_id": 48274562, "body": "Yes, each number would appear only once and on their own lines. However, there may be numbers in the body of the document that may appear as 3.2 on their own.  To get around that issue, I could add the verbal title to the associated section.  For example, &quot;3.2 Method&quot;. Those titles would also not change from document to document.  The content under each Heading could be radically different and vary in length."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4848042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81378701da97cf712e2fb1df9e4ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "DP7", "link": "https://stackoverflow.com/users/4848042/dp7"}, "edited": false, "score": 0, "creation_date": 1430939537, "post_id": 30082806, "comment_id": 48284199, "body": "Thanks for the help Christina.  I will be trying this code very soon.  I will post what happens when I run it.  This is great! I have been using the Macro recorder, pausing and running it and just running it as I record what I am doing.  It got pretty messy the first time around, but I do see the value in doing it.  Again, thanks for your time."}, {"owner": {"reputation": 23, "user_id": 4848042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81378701da97cf712e2fb1df9e4ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "DP7", "link": "https://stackoverflow.com/users/4848042/dp7"}, "edited": false, "score": 1, "creation_date": 1430940776, "post_id": 30082806, "comment_id": 48284978, "body": "Wow! Amazing. This worked like a charm!  This will do nicely!  I would be interested in the looping aspect, but I can learn that a bit later.  There was one thing that I had to make sure of which was ensuring that there was no space after the number in the document.  I found this out afterwards when I ran the script the first time.  Some Headings changed, but most did not.  Once I fixed that, the script ran flawlessly.  I cannot thank you enough.  With the code that you have generated, I have learned so much already.  Thanks for the lesson!"}, {"owner": {"reputation": 834, "user_id": 3079037, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DY854.jpg?s=128&g=1", "display_name": "David A. Gray", "link": "https://stackoverflow.com/users/3079037/david-a-gray"}, "edited": false, "score": 0, "creation_date": 1592197242, "post_id": 30082806, "comment_id": 110327448, "body": "I came in search of the secret sauce to apply a built-in style to a selection in a Microsoft Outlook message. I found that, along with the answer to my next question, in the form of a variation on the ClearFormatting method."}], "tags": [], "owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "is_accepted": true, "score": 4, "last_activity_date": 1430930773, "creation_date": 1430930773, "answer_id": 30082806, "question_id": 29953322, "link": "https://stackoverflow.com/questions/29953322/changing-styles-in-word/30082806#30082806", "title": "Changing styles in Word", "body": "<p>So, there are a few ways to make your code more expandable or reusable. You could use wildcard searches to minimize the actual number of searches required. Or you could put your text strings into an array that you loop through to keep the actual code to a minimum. For your purposes, and to make this as clear as possible, I haven't done that. This just takes your searches and makes them actual search and replaces so that changes are only made when the text is found. In order to limit your searches to text on its own line, I've added the special \"^p\" find sequence. This searches for your text followed by a paragraph break. That's not perfect, but it should be closer to what you're looking for. If you're still seeing only Heading 2 applied after you run this, it might be necessary to include a portion of the text of your document in your question to clarify exactly what it looks like.</p>\n\n<pre><code>Sub QOS_Headings()\nDim objDoc As Document\nDim head1 As Style, head2 As Style, head3 As Style, head4 As Style\n'\n' QOS_Headings Macro\n\n' Converts section headings in eCTD to usable navigation headings in Word.\n\n'\n\n' Using variables here just simplifies the typing further on, and allows\n' you to easily change, for instance, \"Heading 4\" to \"My Personal Heading 4\"\n' if you were creating your own styles.\n\nSet objDoc = ActiveDocument\n' This code does *NOT* protect against the possibility that these styles don't\n' appear in the document. That's probably not a concern with built-in styles,\n' but be aware of that if you want to expand upon this for other uses.\nSet head1 = ActiveDocument.Styles(\"Heading 1\")\nSet head2 = ActiveDocument.Styles(\"Heading 2\")\nSet head3 = ActiveDocument.Styles(\"Heading 3\")\nSet head4 = ActiveDocument.Styles(\"Heading 4\")\n\n' This searches the entire document (not including foot/endnotes, headers, or footers)\n' for your text string. Putting \"^p\" at the end of the string limits it to text strings\n' that fall at the end of a paragraph, which is likely the case as your headings sit on\n' their own line. You might want to experiment with that. Note that putting ^p at the\n' beginning of the text will NOT work; that will apply your style to the previous\n' paragraph as well.\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head1\n    End With\n    ' Here we do the actual replacement. Based on your requirements, this only replaces the\n    ' first instance it finds. You could also change this to Replace:=wdReplaceAll to catch\n    ' all of them.\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\n\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head2\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.1^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.2^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.3^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.4^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.4.1^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.4.2^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.4.3^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.4.4^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.4.5^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.6^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.S.7^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head2\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.1^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.2^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.3^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.4^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5.1^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5.2^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5.3^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5.4^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5.5^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.5.6^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head4\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.6^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.7^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.P.8^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.A^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head2\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.A.1^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.A.2^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.A.3^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head3\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nWith objDoc.Content.Find\n    .ClearFormatting\n    .Text = \"3.2.R^p\"\n    With .Replacement\n    .ClearFormatting\n    .Style = head2\n    End With\n    .Execute Wrap:=wdFindContinue, Format:=True, Replace:=wdReplaceOne\nEnd With\nEnd Sub\n</code></pre>\n\n<p>One final suggestion: one way to get started with VBA programming is to use the macro recorder. It's not perfect, but it will give you the basic structure of, for instance, a search and replace if you record yourself doing one.</p>\n"}], "owner": {"reputation": 23, "user_id": 4848042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d81378701da97cf712e2fb1df9e4ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "DP7", "link": "https://stackoverflow.com/users/4848042/dp7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18630, "favorite_count": 2, "accepted_answer_id": 30082806, "answer_count": 1, "score": 2, "last_activity_date": 1594068466, "creation_date": 1430337458, "last_edit_date": 1594068466, "question_id": 29953322, "link": "https://stackoverflow.com/questions/29953322/changing-styles-in-word", "title": "Changing styles in Word", "body": "<p>I am very new to programming, so forgive my ignorance.  </p>\n\n<p>I am trying to create specific headings in a document that does not have any or has different heading styles assigned.  What precedes the text in the headings are numbers.  The numbers are specific and essentially represent the content of the material below the heading and thus are not going to change.  I am looking for a way to run a macro that would reformat the numeric headings along with the text beside it.  This will aid in navigating through the document.  When I typed in the code, I got no errors, but the Headings are formatted with the \"Heading 2\" style only, even though multiple heading styles are used.  Any help in this area would be appreciated very much. The code is listed below:</p>\n\n<pre><code>Sub QOS_Headings()_\n\n'\n' QOS_Headings Macro\n\n' Converts section headings in eCTD to usable navigation headings in Word.\n\n'\nSelection.Find.Text = (\"3.2\")_\n\nSelection.Style = ActiveDocument.Styles(\"Heading 1\")\nSelection.Find.Text = (\"3.2.S\")\nSelection.Style = ActiveDocument.Styles(\"Heading 2\")\nSelection.Find.Text = (\"3.2.S.1\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.S.2\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.S.3\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.S.4\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.S.4.1\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.S.4.2\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.S.4.3\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.S.4.4\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.S.4.5\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.S.6\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.S.7\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P\")\nSelection.Style = ActiveDocument.Styles(\"Heading 2\")\nSelection.Find.Text = (\"3.2.P.1\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.2\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.3\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.4\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.5\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.5.1\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.P.5.2\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.P.5.3\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.P.5.4\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.P.5.5\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.P.5.6\")\nSelection.Style = ActiveDocument.Styles(\"Heading 4\")\nSelection.Find.Text = (\"3.2.P.6\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.7\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.P.8\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.A\")\nSelection.Style = ActiveDocument.Styles(\"Heading 2\")\nSelection.Find.Text = (\"3.2.A.1\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.A.2\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.A.3\")\nSelection.Style = ActiveDocument.Styles(\"Heading 3\")\nSelection.Find.Text = (\"3.2.R\")\nSelection.Style = ActiveDocument.Styles(\"Heading 2\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1430337047, "creation_date": 1430337047, "answer_id": 29953221, "question_id": 29952710, "link": "https://stackoverflow.com/questions/29952710/how-do-you-loop-through-multi-array-using-vba/29953221#29953221", "title": "How do you loop through multi array using VBA?", "body": "<p>Say we begin with:</p>\n\n<p><img src=\"https://i.stack.imgur.com/MKkPz.png\" alt=\"enter image description here\"></p>\n\n<p>and we want an output as in your post.  Running this:</p>\n\n<pre><code>Sub Macro1()\n\n    Range(\"A2:A22\").Copy Range(\"E1\")\n    ActiveSheet.Range(\"$E$1:$E$21\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n    For Each r In Range(\"E1:E22\")\n        v = r.Value\n        If v = \"\" Then Exit Sub\n        For Each rr In Range(\"A2:A22\")\n            vv = rr.Value\n            If v = vv Then\n                If r.Offset(0, 1).Value = \"\" Then\n                    r.Offset(0, 1).Value = rr.Offset(0, 1).Value\n                Else\n                    r.Offset(0, 1).Value = r.Offset(0, 1).Value &amp; \",\" &amp; rr.Offset(0, 1).Value\n                End If\n            End If\n        Next rr\n    Next r\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><img src=\"https://i.stack.imgur.com/G3uSz.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1430692305, "last_edit_date": 1430692305, "creation_date": 1430360463, "answer_id": 29957947, "question_id": 29952710, "link": "https://stackoverflow.com/questions/29952710/how-do-you-loop-through-multi-array-using-vba/29957947#29957947", "title": "How do you loop through multi array using VBA?", "body": "<p>I'll post my version which uses <code>Dictionary</code>.</p>\n\n<pre><code>Sub Test()\n    Dim sh As Worksheet: Set sh = Sheets(\"Sheet1\") ' I try to always be explicit\n\n    With sh\n        Dim lr As Long, RawArr\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        RawArr = .Range(\"A2:C\" &amp; lr) ' pass to array\n    End With\n\n    Dim i As Long, idkey As String, itm As String\n    ' Use Dictionary to handle duplicates and concatenate values\n    With CreateObject(\"Scripting.Dictionary\")\n        For i = LBound(RawArr, 1) To UBound(RawArr, 1)\n            idkey = RawArr(i, 1): itm = RawArr(i, 2)\n            If Not .Exists(idkey) Then\n                .Add idkey, idkey &amp; \" - \" &amp; itm\n            Else\n                .Item(idkey) = .Item(idkey) &amp; \", \" &amp; itm\n            End If\n        Next\n        ' Return values to worksheet\n        ' Use below if you're working on small data set\n        ' If not, replace below with a loop - also posted\n        sh.Range(\"E1:E\" &amp; .Count) = Application.Transpose(.Items)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Above is pretty straight forward with the output exactly as you described.<br>\nAt the last part, we used <code>Application.Transpose</code> to transfer the values back to the worksheet.<bR>\nTake note that it has limitations as to how large it can handle like 65k rows.<br>\nAs long as your data does not go near that value, then you should be ok.<br>\nIf however you have a lot of data, then you'll have to use another loop to get the values (like manually transposing your data).</p>\n\n<pre><code>Dim key, fArr, n As Long: n = 1\nReDim fArr(1 To .Count, 1 To 2) ' use a 2D array\nFor Each key In .Keys\n    fArr(n, 1) = .Item(key)\n    n = n + 1\nNext\nsh.Range(\"E1:E\" &amp; .Count) = fArr\n</code></pre>\n\n<p><strong>Note:</strong> I assumed that your ID's are strings (e.g.<code>01</code>) and not numbers formatted as <code>\"00\"</code>. If that is the case, then you'll need to format it first before you use it as <code>idkey</code> like below to get your desired output.</p>\n\n<pre><code>idkey = Format(RawArr(i, 1), \"00\")\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 1169172, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bc540bcc5bb4a084d26b2ab96f399587?s=128&d=identicon&r=PG", "display_name": "dmuk", "link": "https://stackoverflow.com/users/1169172/dmuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1430692305, "creation_date": 1430335290, "last_edit_date": 1430361259, "question_id": 29952710, "link": "https://stackoverflow.com/questions/29952710/how-do-you-loop-through-multi-array-using-vba", "title": "How do you loop through multi array using VBA?", "body": "<p>I have the below table in Excel (TABLE).</p>\n\n<p>I am trying to cycle through the table and story in an array (CODE).</p>\n\n<p>Then cycle through the array and produce a unique output based on ID (OUTPUT).</p>\n\n<p>I have provided the code I have but am having trouble determine the best way to loop through the array where the ID is the same - ie I want to group array outputs by ID.</p>\n\n<p>TABLE</p>\n\n<pre><code>| ID | Name | Value |\n---------------------\n| 01 | John | Value |\n| 01 | Sam  | Value |\n| 02 | Luke | Value |\n| 03 | Jack | Value |\n| 04 | Rob  | Value |\n| 04 | Bob  | Value |\n</code></pre>\n\n<p>OUTPUT</p>\n\n<pre><code>01 - John, Sam\n02 - Luke\n03 - Jack\n04 - Rob, Bob\n</code></pre>\n\n<p>CODE</p>\n\n<pre><code>'Store Array\nFor row = 2 to 6\n   MyArray(i,0) = Cells(row,1).value\n   MyArray(i,1) = Cells(row,2).value\n   MyArray(i,2) = Cells(row,3).calue\nnext row\n\n'Output Array\nFor a = Lbound(MyArray) to Ubound(MyArray)\n    ???\nNext a\n</code></pre>\n\n<p>I do not know whether I use if/then/else statements or another loop to achieve this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430334233, "post_id": 29952276, "comment_id": 48025559, "body": "@FreeMan I like that you are just looking at charts in the tab that OP cares about. I&#39;m just carelessly looking at all of them with this."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430334474, "post_id": 29952276, "comment_id": 48025706, "body": "I basically copied that code from a project I&#39;m currently working on, then stuck his chart creation bits in there..."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 3, "last_activity_date": 1430333929, "creation_date": 1430333929, "answer_id": 29952276, "question_id": 29952091, "link": "https://stackoverflow.com/questions/29952091/how-to-check-if-chart-was-already-created/29952276#29952276", "title": "How to check if chart was already created", "body": "<p>You could look at all the charts in the workbook to see if a chart with that name already exists when the sheet opens with:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim testChart As ChartObject\n\n    For Each testChart In ThisWorkbook.Charts\n        If testChart.Name = \"MeasurementVisualization\" Then\n            'Chart exists, so do something or not or whatever or what have you\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 4, "last_activity_date": 1430334013, "creation_date": 1430334013, "answer_id": 29952303, "question_id": 29952091, "link": "https://stackoverflow.com/questions/29952091/how-to-check-if-chart-was-already-created/29952303#29952303", "title": "How to check if chart was already created", "body": "<pre><code>Dim CsvVisualization As ChartObject\nDim MyChartName as string\nDim CreateChart as Boolean\n\nMyChartName = \"MeasurementVisualization\"\nCreateChart = True\n\nIf ThisWorkbook.Sheets(\"\u00dcbersicht\").ChartObjects.Count = 0 Then\n  For Each CsvVisualization in ThisWorkbook.Sheets(\"\u00dcbersicht\").ChartObjects\n    If CsvVisualization.name = MyChartName then\n      CreateChart = False\n    End If\n  Next\nEnd if\n\nIf CreateChart then\n  Set ChartSizePosition = Range(\"B8:I25\")\n  Set CsvVisualization = ThisWorkbook.Sheets(\"\u00dcbersicht\").ChartObjects.Add(ChartSizePosition.Left, ChartSizePosition.Top, ChartSizePosition.Width, ChartSizePosition.Height)\nCsvVisualization.Name = \"MeasurementVisualization\"\n  With CsvVisualization.Chart\n    .ChartType = xlXYScatterSmoothNoMarkers\n...\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1430334796, "creation_date": 1430334796, "answer_id": 29952555, "question_id": 29952091, "link": "https://stackoverflow.com/questions/29952091/how-to-check-if-chart-was-already-created/29952555#29952555", "title": "How to check if chart was already created", "body": "<p>You can try if you would get an error by referencing the object  </p>\n\n<pre><code>On Error Resume Next\nSet CurrentChart = thisworkbook.sheets(\"\u00dcbersicht\").ChartObjects(\"MeasurementVisualization\")\nOn Error GoTo 0\n\nIf IsEmpty(CurrentChart) Then\nMsgBox \"Not found\"\nElse\nCurrentChart.Activate\nEnd If\n</code></pre>\n\n<p>you can replace my codes inside the If with creating the chart....</p>\n"}], "owner": {"reputation": 327, "user_id": 3470049, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/1053002291/picture?type=large", "display_name": "user3470049", "link": "https://stackoverflow.com/users/3470049/user3470049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15121, "favorite_count": 0, "accepted_answer_id": 29952276, "answer_count": 3, "score": 3, "last_activity_date": 1430334796, "creation_date": 1430333374, "last_edit_date": 1531164843, "question_id": 29952091, "link": "https://stackoverflow.com/questions/29952091/how-to-check-if-chart-was-already-created", "title": "How to check if chart was already created", "body": "<p>I'm adding a chart via vba with the following commands:</p>\n\n<pre><code>Dim CsvVisualization As ChartObject\nSet ChartSizePosition = Range(\"B8:I25\")\nSet CsvVisualization = ThisWorkbook.Sheets(\"\u00dcbersicht\").ChartObjects.Add(ChartSizePosition.Left, ChartSizePosition.Top, ChartSizePosition.Width, ChartSizePosition.Height)\nCsvVisualization.Name = \"MeasurementVisualization\"\nWith CsvVisualization.Chart\n    .ChartType = xlXYScatterSmoothNoMarkers\n...\n</code></pre>\n\n<p>How could I proofe if this chart was already created when the excel file is reopened? I tried something like:</p>\n\n<pre><code>If CsvVisualization Is Nothing Then\n</code></pre>\n\n<p>But CsvVisualization won't hold it's value when the file is closed and opened again.</p>\n\n<p>Thank you for help!</p>\n"}, {"tags": ["vba", "excel", "onerror"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 5, "last_activity_date": 1430332324, "creation_date": 1430332324, "answer_id": 29951756, "question_id": 29951610, "link": "https://stackoverflow.com/questions/29951610/on-error-goto-only-working-once-for-analyzing-input-box-value/29951756#29951756", "title": "On Error GoTo only working once for analyzing input box value", "body": "<p>Rather than using the error handler, I would use a <code>Loop</code> that would break only when the condition is met. For example: </p>\n\n<p><em>Ask the first time:</em></p>\n\n<pre><code>tm = UCase(Application.InputBox(\"What time was the CFP file sent?\"))\nDim inputOK As Boolean\n</code></pre>\n\n<p><em>Keep on asking until the user enters wrong values:</em></p>\n\n<pre><code>inputOK = checkMyInput(tm) '&lt;-- is the input \"tm\" ok or not?\nDo While inputOK = False '&lt;-- if it's not ok, keep on asking\n    MsgBox \"Please enter a valid input\"\n    tm = UCase(Application.InputBox(\"What time was the CFP file sent?\"))   \n    inputOK = checkMyInput(tm) '&lt;-- and checking it again...\nLoop\n</code></pre>\n\n<p>where <code>checkMyInput(tm)</code> would be a custom function returning <code>True</code> or <code>False</code> if your input is ok or not:</p>\n\n<pre><code>Function checkMyInput(ByVal tm As Variant) As Boolean\n    If tm =\"BLANK\" Or tm = \"HOLIDAY\" Or tm = \"SKIP\" Or IsDate(tm) Then\n        checkMyInput = True\n    Else\n        checkMyInput = False\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1430333477, "post_id": 29951965, "comment_id": 48025079, "body": "This explains perfectly your problem."}, {"owner": {"reputation": 23, "user_id": 4847725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b032384345e71e3297d7d9d6b3fd2ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kendra", "link": "https://stackoverflow.com/users/4847725/kendra"}, "edited": false, "score": 0, "creation_date": 1430432808, "post_id": 29951965, "comment_id": 48077263, "body": "Thank you both!!  I ended up using the error handler, but since I have to do the input box step repeatedly for different files, I decided to pass the name of each file to sub(fileName).  Then the time for that file is entered in an input box and then run through an error handler.  Thanks Again!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1430332968, "last_edit_date": 1495540691, "creation_date": 1430332968, "answer_id": 29951965, "question_id": 29951610, "link": "https://stackoverflow.com/questions/29951610/on-error-goto-only-working-once-for-analyzing-input-box-value/29951965#29951965", "title": "On Error GoTo only working once for analyzing input box value", "body": "<p>Error handlers go <em>below</em> the procedure they're handling errors for:</p>\n\n<pre><code>Public Sub DoSomething\n    On Error GoTo ErrHandler\n\n    'code here\n\nCleanup:\n    'cleanup code here\n    Exit Sub\n\nErrHandler:\n    'error-handling code here\n    Resume Cleanup\nEnd Sub\n</code></pre>\n\n<p>What's happening is that once the first error is raised, <em>because the error handler label is at the top</em>, instead of jumping <em>down</em> into the error handler, the code jumps <em>up</em> back to the top, and VBA understands the rest of the procedure to be the error-handling subroutine... which never returns to the actual procedure body, because it <em>is</em> the procedure's body.</p>\n\n<p>You're using the wrong control flow structure for the job, see <a href=\"https://stackoverflow.com/a/29951756/1188513\">@Matteo's answer</a> for what you need.</p>\n"}], "owner": {"reputation": 23, "user_id": 4847725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b032384345e71e3297d7d9d6b3fd2ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kendra", "link": "https://stackoverflow.com/users/4847725/kendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 1, "accepted_answer_id": 29951965, "answer_count": 2, "score": 2, "last_activity_date": 1432753589, "creation_date": 1430331880, "last_edit_date": 1432753589, "question_id": 29951610, "link": "https://stackoverflow.com/questions/29951610/on-error-goto-only-working-once-for-analyzing-input-box-value", "title": "On Error GoTo only working once for analyzing input box value", "body": "<p>I have a spreadsheet that tracks the time various files are sent.  For each file I have an input box that asks for the time the file sent, and there are a few other options that can be put in that input box.  </p>\n\n<p>If the person does not enter a valid entry, I would like to send them back to the input box so they can try again.  </p>\n\n<p>This is my code, which works for the first error, but if someone enters the wrong value a second time, they just get the standard 'Type Mismatch' error.  I am creating this for people who don't have any knowledge of VBA and would like to make it as easy as possible.  </p>\n\n<p>There are multiple instances of the following code, each for a different file time.  Thanks in advance!</p>\n\n<pre><code>CFP:\nIf Err Then MsgBox Error &amp; \" Invalid value.  Please enter only 'blank', 'holiday', 'skip' or time value.\"\nErr.Clear\ntm = UCase(Application.InputBox(\"What time was the CFP file sent?\"))\n\nOn Error GoTo CFP\nIf tm = \"BLANK\" Then\n    ActiveCell.Value = \"Blank\"\nElseIf tm = \"HOLIDAY\" Then\n    ActiveCell.Value = \"Holiday\"\nElseIf tm = \"SKIP\" Then\n        ActiveCell.Value = \"Skipped\"\nElse\n    ActiveCell.Value = TimeValue(tm)\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1430331529, "post_id": 29951305, "comment_id": 48023857, "body": "Do the datasets have a column in common? Some sort of universal ID (examples: employee number, username, email address)"}, {"owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1430332031, "post_id": 29951305, "comment_id": 48024177, "body": "Other than the names, there is no common factor I can tie it to. Other information in the sets is only randomly available, and what is in one may not be in the other. Good idea though!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1430339467, "post_id": 29951305, "comment_id": 48028607, "body": "For Excel 2007 and later, MS has a free <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=15011&amp;751be11f-ede8-5a0c-058c-2ee190a24fa6=True\" rel=\"nofollow noreferrer\">Fuzzy Lookup Add-In for Excel</a> that should help you accomplish your task"}, {"owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "edited": false, "score": 0, "creation_date": 1430339641, "post_id": 29951305, "comment_id": 48028699, "body": "Hi Ron, I&#39;m actually using excel for Mac, so i&#39;m not sure if there is an equivalent app I could use."}], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "edited": false, "score": 0, "creation_date": 1431027713, "post_id": 29954695, "comment_id": 48331305, "body": "From what I understand, i think its possible to do a decent job of comparing names w/ out using the Levenshtein algorithm. If you isolate the first 2-3 letters of the first name and use the last name, and compare that to the range, it does a good job of flagging duplicates. I can do that with formulas, but I&#39;m not sure about how to code that in VBA. i&#39;ve updated my original question w/ that."}], "tags": [], "owner": {"reputation": 1826, "user_id": 2448686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/991a398aed0585cf284c5ef427b322be?s=128&d=identicon&r=PG", "display_name": "ashareef", "link": "https://stackoverflow.com/users/2448686/ashareef"}, "is_accepted": false, "score": 0, "last_activity_date": 1430342391, "last_edit_date": 1495542112, "creation_date": 1430342036, "answer_id": 29954695, "question_id": 29951305, "link": "https://stackoverflow.com/questions/29951305/for-every-cell-in-a-column-search-the-rest-of-the-column-for-a-duplicate/29954695#29954695", "title": "For every cell in a column, search the rest of the column for a duplicate", "body": "<p>This might be a complex problem to solve \"correctly\" for a total beginner.  What you're looking for can be found here.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3329297/finding-groups-of-similar-strings-in-a-large-set-of-strings\">Finding groups of similar strings in a large set of strings</a></p>\n\n<p>VLOOKUP in excel also has a fuzzy search of sorts but I'm not sure of the quality of the matching.</p>\n"}], "owner": {"reputation": 339, "user_id": 4709889, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9271519b66b415611910b055302699a4?s=128&d=identicon&r=PG&f=1", "display_name": "FrenchConnections", "link": "https://stackoverflow.com/users/4709889/frenchconnections"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431025843, "creation_date": 1430330977, "last_edit_date": 1431025843, "question_id": 29951305, "link": "https://stackoverflow.com/questions/29951305/for-every-cell-in-a-column-search-the-rest-of-the-column-for-a-duplicate", "title": "For every cell in a column, search the rest of the column for a duplicate", "body": "<p>I have two large databases of names that I compare to each other for a variety of criteria. However, the names are not always spelled the same, so I end up with a lot of duplicate errors. Examples are Joe Smith in one dataset, Joseph Smith in another, Chris Parker in set 1, Christopher Parker in set 2 etc. All of the errors are collected into one column, so I end up with something that looks like this:</p>\n\n<p>Comparing Data set 1 to Data set 2</p>\n\n<pre><code>Column A\nJoe Smith in set 1 || not in set 2\nJoseph Smith in set 2 || not in set 1\nNicholas Chun no errors\nAlex Conrad in set 2 || not in set 1\nAlexander Conrad in set 1 || not in set 2\n</code></pre>\n\n<p>What I think I need to do is take the first five characters of the last name, and count the number of times that it occurs in the column, then highlight all cells for which the counter >=2. The counter should equal 1 if there is no duplicate, as there will always be the one cell with the string.</p>\n\n<p>I'm not sure how to go about programming this in VBA, since I am a beginner. Any ideas, advice or examples would be welcome.</p>\n\n<p>Update: I've been able to do something like this with formulas. I use this formula to extract the first two letters and the second word from the string:</p>\n\n<p>LEFT(A1,2)&amp;\" \"&amp;MID(MID(MID(SUBSTITUTE(A1,\" \",\"^\",1),1,256),FIND(\"^\",SUBSTITUTE(A1,\" \",\"^\",1)),256),2,FIND(\" \",MID(MID(SUBSTITUTE(A1,\" \",\"^\",1),1,256),FIND(\"^\",SUBSTITUTE(A1,\" \",\"^\",1)),256))-2)</p>\n\n<p>Then I use a countif statement to see how many times that string appears in the new column, and if countif>=2, I flag it as a possible error. However, I'm struggling to translate this into code, without adding any columns to the spreadsheet. I think the right approach is to declare the range as an array, and run the comparison on every cell in the array. Here is what I've got so far:</p>\n\n<pre><code>Function WordExtract(Source As String, Position As Integer)\nDim arr() As String\narr = VBA.Split(Source, \" \")\nIf xcount &lt; 1 Or (Position - 1) &gt; xcount Or Position &lt; 0 Then\nWordExtract = \"\"\nElse\nWordExtract = arr(Position - 1)\nEnd If\nEnd Function\n\nSub NameEnhancer()\n\nDim arr As Variant\nDim LastRowReport As Long\nDim i As Long\nDim j As Long\nDim ws As Worksheet\n\nSet ws = Sheets(\"Sheet2\")\n\nLastRowReport = ws.Cells(Rows.Count, \"AA\").End(xlUp).Row\n\narr = ws.Range(\"AA4:AA\" &amp; LastRowReport).Value\nFor i = 1 To UBound(arr)\narr = LEFT(RC[-1],2)&amp;\" \"&amp;WordExtract(i, 2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2293, "user_id": 294836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39669186deaaafaa691ac0605fb0b8ce?s=128&d=identicon&r=PG", "display_name": "WombatPM", "link": "https://stackoverflow.com/users/294836/wombatpm"}, "edited": false, "score": 0, "creation_date": 1430331068, "post_id": 29951086, "comment_id": 48023572, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6838437/how-to-check-whether-certain-sheets-exist-or-not-in-excel-vba\">How to check whether certain sheets exist or not in Excel-VBA?</a>"}, {"owner": {"reputation": 25, "user_id": 3981808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa060a2bdc6c3daf5956a68f25742d95?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3981808/rob"}, "reply_to_user": {"reputation": 2293, "user_id": 294836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39669186deaaafaa691ac0605fb0b8ce?s=128&d=identicon&r=PG", "display_name": "WombatPM", "link": "https://stackoverflow.com/users/294836/wombatpm"}, "edited": false, "score": 0, "creation_date": 1430333072, "post_id": 29951086, "comment_id": 48024815, "body": "this is not a duplicate of that question."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3981808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa060a2bdc6c3daf5956a68f25742d95?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3981808/rob"}, "edited": false, "score": 0, "creation_date": 1430332890, "post_id": 29951298, "comment_id": 48024682, "body": "Excellent! That was it.  I was suspecting that might be the case; but then I thought the selection was still valid at the Selection.copy line since I could see the cells were still selected after the macro completed.  Thank you!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 25, "user_id": 3981808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa060a2bdc6c3daf5956a68f25742d95?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3981808/rob"}, "edited": false, "score": 0, "creation_date": 1430333436, "post_id": 29951298, "comment_id": 48025046, "body": "@Rob ............when I do this type of task, I try to create two <b>Range</b> objects...........one for the Copy source and one for the Copy destination."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1430331801, "last_edit_date": 1430331801, "creation_date": 1430330960, "answer_id": 29951298, "question_id": 29951086, "link": "https://stackoverflow.com/questions/29951086/excel-vba-check-if-worksheet-exists-copy-paste-to-new-worksheet-paste-fails/29951298#29951298", "title": "Excel VBA: Check if worksheet exists; Copy/Paste to new worksheet - Paste fails", "body": "<p>When you do the <strong>Add,</strong> the activesheet becomes the new worksheet and your previous <em>Selection</em> is lost...............you must \"remember\" it before the <strong>Add</strong>:</p>\n\n<pre><code>Sub Copy2sheet()\n    Application.ScreenUpdating = False\n    Dim copySheet As Worksheet\n    Dim pasteSheet As Worksheet\n    Dim mySheetName As String, mySheetNameTest As String\n    mySheetName = \"Notes\"\n    Dim RtoCopy As Range\n    Set RtoCopy = Selection\n\n    'create worksheet at end of workbook if it does not exist\n    On Error Resume Next\n        mySheetNameTest = Worksheets(mySheetName).Name\n    If Err.Number = 0 Then\n        GoTo CopyPasteSelection\n    Else\n        Err.Clear\n        Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = mySheetName\n    End If\n\n    'copy/paste selection to Notes worksheet\nCopyPasteSelection:\n    Set copySheet = Worksheets(\"Sheet1\")\n    Set pasteSheet = Worksheets(\"Notes\")\n    RtoCopy.Copy\n    pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(2, 0).PasteSpecial xlPasteAll\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><em>Pay attention to the three lines referencing <strong>RtoCopy</strong> .</em></p>\n"}, {"tags": [], "owner": {"reputation": 2293, "user_id": 294836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39669186deaaafaa691ac0605fb0b8ce?s=128&d=identicon&r=PG", "display_name": "WombatPM", "link": "https://stackoverflow.com/users/294836/wombatpm"}, "is_accepted": false, "score": 0, "last_activity_date": 1430330985, "last_edit_date": 1495535046, "creation_date": 1430330985, "answer_id": 29951306, "question_id": 29951086, "link": "https://stackoverflow.com/questions/29951086/excel-vba-check-if-worksheet-exists-copy-paste-to-new-worksheet-paste-fails/29951306#29951306", "title": "Excel VBA: Check if worksheet exists; Copy/Paste to new worksheet - Paste fails", "body": "<p>You have On Error Resume Next in your code. First time through it goes on its merry way.  The second time through the Error check triggers the creation of the new tab.</p>\n\n<p>On Error Resume Next is bad.  Don't use it.</p>\n\n<p>See this question for more information on solving your problem <a href=\"https://stackoverflow.com/questions/6838437/how-to-check-whether-certain-sheets-exist-or-not-in-excel-vba\">How to check whether certain sheets exist or not in Excel-VBA?</a> </p>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "is_accepted": false, "score": 0, "last_activity_date": 1430331117, "creation_date": 1430331117, "answer_id": 29951355, "question_id": 29951086, "link": "https://stackoverflow.com/questions/29951086/excel-vba-check-if-worksheet-exists-copy-paste-to-new-worksheet-paste-fails/29951355#29951355", "title": "Excel VBA: Check if worksheet exists; Copy/Paste to new worksheet - Paste fails", "body": "<p>You should first activate and select the sheet and range to be copied. This works.</p>\n\n<pre><code>CopyPasteSelection:\nSet copySheet = Worksheets(\"Sheet1\")\nSet pasteSheet = Worksheets(\"Notes\")\n\nWorksheets(\"Sheet1\").Activate 'Activete \"Sheet1\"\nWorksheets(\"Sheet1\").Range(\"A1\").Select 'Select the range to be copied\n'Then copy selection\nSelection.Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(2, 0).PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1430379034, "creation_date": 1430379034, "answer_id": 29961655, "question_id": 29951086, "link": "https://stackoverflow.com/questions/29951086/excel-vba-check-if-worksheet-exists-copy-paste-to-new-worksheet-paste-fails/29961655#29961655", "title": "Excel VBA: Check if worksheet exists; Copy/Paste to new worksheet - Paste fails", "body": "<p>I suggest using <code>Function</code> for more re-usability:</p>\n\n<ol>\n<li>A dirty and fast way:</li>\n</ol>\n\n<p>\n\n<pre><code>Function isWorksheetValid(wsName As String)\n    ON Error Goto ErrHndl\n    Dim ws as Worksheet\n    Set ws = Sheets(wsName)\n    isWorksheetValid = True\n    Exit Function\nErrHndl:\n    isWorksheetValid = False \nEnd Function\n</code></pre>\n\n<ol start=\"2\">\n<li>A correct but a bit slower way:</li>\n</ol>\n\n<p>\n\n<pre><code>Function isWorksheetValid(wsName As String)\n    ON Error Goto ErrHndl\n    Dim ws as Worksheet\n    For Each ws in Sheets\n        If (UCASE(ws.Name) = UCASE(wsName)) Then\n            isWorksheetValid = True\n            Exit Function\n        End If\n    Next\nErrHndl:\n    isWorksheetValid = False \nEnd Function\n</code></pre>\n\n<p>Now you need just use it like this:</p>\n\n<pre><code>If (isWorksheetValid(mySheetName) Then\n    ' Add your code here\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3981808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa060a2bdc6c3daf5956a68f25742d95?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3981808/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1986, "favorite_count": 0, "accepted_answer_id": 29951298, "answer_count": 4, "score": 1, "last_activity_date": 1430379034, "creation_date": 1430330255, "last_edit_date": 1430378463, "question_id": 29951086, "link": "https://stackoverflow.com/questions/29951086/excel-vba-check-if-worksheet-exists-copy-paste-to-new-worksheet-paste-fails", "title": "Excel VBA: Check if worksheet exists; Copy/Paste to new worksheet - Paste fails", "body": "<p>I have a macro that copy/pastes a selection from one worksheet (<code>Sheet1</code>), to another worksheet (<code>Notes</code>). It works well. Now I want to first check if that worksheet exists. If it does not exist, I want to create it, then continue with the copy/pasting the selection.  </p>\n\n<p>When the \"<code>Notes</code>\" worksheet exists, the copy/paste works fine.\nIf the worksheet does not exist, it creates it, but the paste operation doesn't work.  I don't get any errors.  I have to rerun the macro and then the paste works (since the worksheet has already been created).  Any ideas on what I missed?  </p>\n\n<pre><code>Sub Copy2sheet()\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim mySheetName As String, mySheetNameTest As String\nmySheetName = \"Notes\"\n\n'create worksheet at end of workbook if it does not exist\nOn Error Resume Next\nmySheetNameTest = Worksheets(mySheetName).Name\nIf Err.Number = 0 Then\n    GoTo CopyPasteSelection\nElse\n    Err.Clear\n    Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = mySheetName\nEnd If\n\n'copy/paste selection to Notes worksheet\nCopyPasteSelection:\nSet copySheet = Worksheets(\"Sheet1\")\nSet pasteSheet = Worksheets(\"Notes\")\nSelection.Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(2, 0).PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "random", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1430329684, "post_id": 29950638, "comment_id": 48022695, "body": "What is <code>Check = T</code> supposed to do?  Is <code>T</code> defined somewhere?"}, {"owner": {"reputation": 1772, "user_id": 764474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34756b91f4b5d25d26578fc2a9962c9?s=128&d=identicon&r=PG", "display_name": "jeffrey_t_b", "link": "https://stackoverflow.com/users/764474/jeffrey-t-b"}, "edited": false, "score": 0, "creation_date": 1430329953, "post_id": 29950638, "comment_id": 48022874, "body": "Why the loop with an If/ElseIf structure that does something unique for each loop index?  I suppose that is a stylistic question, but it makes the code much longer than it needs to be."}, {"owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430331005, "post_id": 29950638, "comment_id": 48023534, "body": "The most honest answer I can give you is &quot;I don&#39;t know. I didn&#39;t write it.&quot; I am just trying to fix the random number issue without recreating the wheel. If it needs to be changed I will change it but I don&#39;t feel the need to do so for style reasons."}, {"owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430331158, "post_id": 29950638, "comment_id": 48023623, "body": "Check is defined as a string and initialized to T and then in the last part of the loop it is equal to F. Again I guess this was just a style preference. That aspect of it works it is just that the numbers sometimes duplicate within the ten that are being displayed."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1430409827, "post_id": 29950638, "comment_id": 48064891, "body": "Can you share a copy of your database?"}, {"owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430504910, "post_id": 29950638, "comment_id": 48104951, "body": "Thanks but no I cannot"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430331006, "post_id": 29951059, "comment_id": 48023535, "body": "Thanks Jeff - I tried that and it still does not work."}, {"owner": {"reputation": 1772, "user_id": 764474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34756b91f4b5d25d26578fc2a9962c9?s=128&d=identicon&r=PG", "display_name": "jeffrey_t_b", "link": "https://stackoverflow.com/users/764474/jeffrey-t-b"}, "reply_to_user": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430353080, "post_id": 29951059, "comment_id": 48034405, "body": "Hmm... How many are duplicated per run?  There is always a good chance of <i>some</i> duplication, as Rnd does not provide uniqueness (and this is especially clear when you multiply by a smallish number of rows and truncate to an integer).  Do you need to randomly select without replacement (like shuffling a deck of cards), rather than doing what you are doing now (which is like selecting a card, replacing it in the deck, and drawing again)?"}, {"owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430396197, "post_id": 29951059, "comment_id": 48054590, "body": "I do need to randomly select without replacement. But only for each run. The next time the button is clicked a number can be chosen again."}], "tags": [], "owner": {"reputation": 1772, "user_id": 764474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34756b91f4b5d25d26578fc2a9962c9?s=128&d=identicon&r=PG", "display_name": "jeffrey_t_b", "link": "https://stackoverflow.com/users/764474/jeffrey-t-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1430330169, "creation_date": 1430330169, "answer_id": 29951059, "question_id": 29950638, "link": "https://stackoverflow.com/questions/29950638/create-random-number-without-duplicating/29951059#29951059", "title": "Create random number without duplicating", "body": "<p>Note that the Randomize VBA function re-initializes the random number generator seed.  Without arugments, it uses the system timer as the seed. </p>\n\n<p>You are re-initializing it every loop iteration, before each call to Rnd.  Given that there might not be very much time between calls to Randomize, you might be restarting the random number generator over and over again at the same point, thus leading to repeated numbers.</p>\n\n<p>Try calling Randomize once at the top of your code.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "edited": false, "score": 0, "creation_date": 1430505062, "post_id": 29966004, "comment_id": 48105034, "body": "Since the data is written to the table each time through the loop I am wondering how I would go about having it check the column to see if the new assigned value already exists before writing it to the table."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1430391726, "creation_date": 1430391726, "answer_id": 29966004, "question_id": 29950638, "link": "https://stackoverflow.com/questions/29950638/create-random-number-without-duplicating/29966004#29966004", "title": "Create random number without duplicating", "body": "<p>Generating random number is not an issue. Generating random unique number is not an issue either. However, choosing a random number from a range, that has not been chosen already requires track of used numbers. The issue is when it comes to performance especially if you want to read/update values from a table and check if the ID has been used already.</p>\n\n<p>You have two options. (maybe more that i can't think of right now)</p>\n\n<ul>\n<li>If you are using VBA to update your table. You can create a public function with public array contains list of used and unused numbers.</li>\n<li>If you are using SQL query to update your table again you can use a public function to get a random number but instead of arrays you will perform random choice with where condition ID not already used in the new table.</li>\n</ul>\n\n<p>first method would look like this:\nYou send min and max values from your range and get a value back which is not used yet. An array or holder will be used to keep track of your used and unused numbers. I used dictionary but you can use arrays or arrays with dictionary.</p>\n\n<pre><code>    Option Compare Database\nOption Explicit\n\nPrivate mNumbers As Object\nPrivate mSession_ID As Long\n\nPublic Function FN_GET_RANDOM_NO(iMin As Long, iMax As Long) As Long\n    FN_GET_RANDOM_NO = Int((iMax - iMin + 1) * Rnd + iMin)\nEnd Function\n\nPublic Function FN_RANDOM_INIT_COLLECTION(iSession_id As Long, iMin As Long, iMax As Long) As Object\n    Set mNumbers = CreateObject(\"Scripting.Dictionary\")\n    Dim i, J As Long\n    mSession_ID = iSession_id\n    J = 0\n    For i = iMin To iMax\n        J = J + 1\n        mNumbers.Add J, i\n    Next i\nEnd Function\n\nPublic Function FN_RANDOM_READ_UNUSED_NO() As Long\n    Dim ID As Long\n    ID = FN_GET_RANDOM_NO(1, mNumbers.count)\n    FN_RANDOM_READ_UNUSED_NO = mNumbers(ID)\n    If mNumbers.exists(ID) Then mNumbers.Remove ID\n\n    Dim tmpDic As Object\n    Set tmpDic = CreateObject(\"Scripting.Dictionary\")\n\n    Dim item As Variant\n    Dim i As Long\n    i = 0\n    For Each item In mNumbers\n        i = i + 1\n        tmpDic.Add i, mNumbers(item)\n    Next item\n\n    Set mNumbers = tmpDic\n\nEnd Function\nPublic Function FN_GET_UNUSED_NO(iSession_id As Long, iMin As Long, iMax As Long) As Long\n    If mSession_ID = iSession_id Then\n        If Not mNumbers Is Nothing Then\nREAD_AFTER:\n            FN_GET_UNUSED_NO = FN_RANDOM_READ_UNUSED_NO\n        Else\nINIT:\n            'initialize the table\n            FN_RANDOM_INIT_COLLECTION iSession_id, iMin, iMax\n            GoTo READ_AFTER:\n        End If\n    Else\n        'new session reload the used number collection\n        Set mNumbers = Nothing\n        GoTo INIT\n    End If\nEnd Function\n</code></pre>\n\n<p>get a random unique id form your range simply by:</p>\n\n<pre><code>FN_GET_UNUSED_NO(1,10, 50)\n</code></pre>\n\n<p>session_id is there to identify you are accessing the collection within one session. Different id would re initialize the unused table. Expand the code if you want to manage more than one collection. Maybe with an array.</p>\n\n<p>it will return 0 if there aren't anymore numbers to return.</p>\n\n<p>result will look like this:</p>\n\n<pre><code>?FN_GET_UNUSED_NO(1,10, 50)\n 0 \n 10 \n 50 \n 11 \n 16 \n 40 \n 18 \n 25 \n 22 \n 33 \n 30 \n 14 \n 26 \n 49 \n 45 \n 39 \n 20 \n 35 \n 17 \n 15 \n 38 \n 27 \n 48 \n 12 \n 43 \n 24 \n 46 \n 37 \n 41 \n 28 \n 31 \n 34 \n 19 \n 47 \n 29 \n 13 \n 21 \n 44 \n 36 \n 32 \n 23 \n 42 \n</code></pre>\n\n<p>second method is fairly simple you just retrieve a random value, check if the value is already assigned in the new table.</p>\n"}], "owner": {"reputation": 113, "user_id": 1596194, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce8787916cc170d9325e6af52980de0a?s=128&d=identicon&r=PG", "display_name": "Scottdg", "link": "https://stackoverflow.com/users/1596194/scottdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2243, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1430681062, "creation_date": 1430328717, "last_edit_date": 1430681062, "question_id": 29950638, "link": "https://stackoverflow.com/questions/29950638/create-random-number-without-duplicating", "title": "Create random number without duplicating", "body": "<p>I am trying to troubleshoot an existing Access database application that is supposed to generate a random number between 1 and the number of records in the table. This is done for 2o different tables with a varying amount of records. The tables with less records are displaying duplicate numbers of the 10 that it is supposed to display and write to a separate table. I assume the same would happen with the larger tables but with more numbers to choose from I was just unable to duplicate the issue.</p>\n\n<p>Here is a sampling of the code with error handling removed:</p>\n\n<pre><code>    Dim db As DAO.Database\nDim rstRecords As DAO.Recordset\nDim rs As DAO.Recordset\nDim tdfNew As TableDef\nDim fldNew As Field\nDim i As Integer\nDim K As Integer\nDim Check As String\n\nSet db = CurrentDb\nSet rstRecords = db.OpenRecordset(\"customer_table\")\n\n     rstRecords.MoveLast\n     FindRecordCount = rstRecords.RecordCount\n     i = rstRecords.RecordCount\nDoCmd.DeleteObject acTable, \"Unique_numbers\"\n\n'--- create the table\nSet tdfNew = db.CreateTableDef(\"Unique_numbers\")\n'--- add text field (length 20)\nSet fldNew = tdfNew.CreateField(\"customer_table\", dbLong)\n'--- save the new field\ntdfNew.Fields.Append fldNew\n\n'--- save the new table design\ndb.TableDefs.Append tdfNew\n\n'---Initialize your recordset\nSet rs = CurrentDb.OpenRecordset(\"Unique_numbers\", dbOpenDynaset)\n\n\n'Dim i As Integer\n'Dim K As Integer\n'Dim Check As String\n\n'i = TxtInput\n  TxtInput = i\n  K = 0\n  Check = T\n\nDo\n  Do While K &lt; 11\n    'K = K + 1\n        Randomize\n          If K = 0 Then\n            TxtOutput = Fix(i * Rnd) + 1\n            rs.AddNew\n            rs.Fields(0).Value = TxtOutput\n            rs.Update\n            K = K + 1\n          ElseIf K = 1 Then\n            TxtOutput2 = Fix(i * Rnd) + 1\n            rs.AddNew\n            rs.Fields(0).Value = TxtOutput2\n            rs.Update\n            K = K + 1\n          ElseIf K = 2 Then\n             TxtOutput3 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput3\n             rs.Update\n             K = K + 1\n          ElseIf K = 3 Then\n             TxtOutput4 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput4\n             rs.Update\n             K = K + 1\n          ElseIf K = 4 Then\n             TxtOutput5 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput5\n             rs.Update\n             K = K + 1\n          ElseIf K = 5 Then\n             TxtOutput6 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput6\n             rs.Update\n             K = K + 1\n          ElseIf K = 6 Then\n             TxtOutput7 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput7\n             rs.Update\n             K = K + 1\n          ElseIf K = 7 Then\n             TxtOutput8 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput8\n             rs.Update\n             K = K + 1\n           ElseIf K = 8 Then\n             TxtOutput9 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput9\n             rs.Update\n             K = K + 1\n           ElseIf K = 9 Then\n             TxtOutput10 = Fix(i * Rnd) + 1\n             rs.AddNew\n             rs.Fields(0).Value = TxtOutput10\n             rs.Update\n             K = K + 1\n             Check = f\n            Exit Do\n          End If\n    Loop\nLoop Until Check = f\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "criteria"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430328515, "post_id": 29950439, "comment_id": 48022011, "body": "You could just use a <code>VLOOKUP</code> with a compound key."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430330127, "post_id": 29950439, "comment_id": 48022977, "body": "You have a lot of <code>Range()</code> in there which do not have a specific sheet qualifier: without that they will by default refer to the active sheet, and that may not always be what you want.  It&#39;s tricky to tell what really going on in your code since there&#39;s some amount of context missing."}, {"owner": {"reputation": 15, "user_id": 4696253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3d879b43cad590534c3bd9ed30f14e?s=128&d=identicon&r=PG&f=1", "display_name": "maxthefox", "link": "https://stackoverflow.com/users/4696253/maxthefox"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430331072, "post_id": 29950439, "comment_id": 48023575, "body": "@TimWilliams I activate the relevant sheet just before, so that shouldn&#39;t be the issue. Following jbarker&#39;s advice, I have reduced the criteria to 1 column. However, I have noticed that the issue lies with the piece of code that loops for x: it returns the first entirely blank row, instead of the one that answers to my criteria. Do you know why that might be the case?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430332910, "post_id": 29950439, "comment_id": 48024700, "body": "<code>Range(&quot;A&quot; &amp; x) = &quot;Theo Caliber&quot;</code> should never be satisfied by a blank row, so there&#39;s some other issue there."}, {"owner": {"reputation": 15, "user_id": 4696253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3d879b43cad590534c3bd9ed30f14e?s=128&d=identicon&r=PG&f=1", "display_name": "maxthefox", "link": "https://stackoverflow.com/users/4696253/maxthefox"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430357760, "post_id": 29950439, "comment_id": 48035763, "body": "@TimWilliams I figured it out, thanks anyways"}], "owner": {"reputation": 15, "user_id": 4696253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d3d879b43cad590534c3bd9ed30f14e?s=128&d=identicon&r=PG&f=1", "display_name": "maxthefox", "link": "https://stackoverflow.com/users/4696253/maxthefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1430328037, "creation_date": 1430328037, "question_id": 29950439, "link": "https://stackoverflow.com/questions/29950439/loop-through-two-columns-on-one-sheet-find-corresponding-unique-row-on-another", "title": "Loop through two columns on one sheet, find corresponding unique row on another sheet, and return value in third column", "body": "<p>I have columns A and B in a sheet (\"Reference\") which contain certain criteria. I want my macro to loop through these criteria, look through columns A and B in another sheet (\"Pages\"), find the unique corresponding row, and return the value in the third column of that sheet if it's not blank.</p>\n\n<p>Below is what I have tried so far, but it doesn't return any value:</p>\n\n<pre><code>    For Each i In sheetrng\n       For Each j In proprng\n\n         Dim x As Long, LR As Long, Flag As Boolean\n         LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n         For x = 3 To LR\n             If Range(\"A\" &amp; x) = \"Theo Caliber\" And Range(\"B\" &amp; x) = i And Range(\"C\" &amp; x) = j And Not IsEmpty(Range(\"D\" &amp; x)) Then\n                 Flag = True\n                 Exit For\n             End If\n         Next x\n\n         Dim y As Integer\n         y = Rows(2).Find(what:=\"Total Marketing\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False).Column\n\n         Dim z As Variant\n         Set z = Cells(x, y)\n\n\n         ThisWorkbook.Activate\n         Sheets(\"Total Rated\").Range(\"B67\").Value = 6\n         Sheets(\"Total Rated\").ExportAsFixedFormat Type:=xlTypePDF, _\n         FileName:=\"C:\\Users\\mercolani\\Desktop\\2015\\By Department\\\" &amp; z &amp; \".pdf\", _\n         OpenAfterPublish:=False\n\n       Next j\n    Next i\n</code></pre>\n\n<p>Any good soul out there that knows what I am doing wrong?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["html", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4800336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712b56ff767cf107e41e379f51973476?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/4800336/mahesh"}, "edited": false, "score": 0, "creation_date": 1431445610, "post_id": 29951121, "comment_id": 48496513, "body": "My code is working till that show more feature . After then not able to automate the show more option. as its onmouseup thing and not a button to perform click option. I tried using the id as you told it is not working. Will you be able to provide me a code to click the show more option after clicking the link: &quot;<a href=\"http://discovery.ariba.com/rfx/3796429\" rel=\"nofollow noreferrer\">discovery.ariba.com/rfx/3796429</a>&quot;. It will helpful to me to embed the code into my code."}, {"owner": {"reputation": 1, "user_id": 4800336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712b56ff767cf107e41e379f51973476?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/4800336/mahesh"}, "edited": false, "score": 0, "creation_date": 1431772962, "post_id": 29951121, "comment_id": 48648112, "body": "please help me with this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 4800336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712b56ff767cf107e41e379f51973476?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/4800336/mahesh"}, "edited": false, "score": 0, "creation_date": 1431807400, "post_id": 29951121, "comment_id": 48658852, "body": "I did take a look at that page, and was unable to activate the link.  I have no idea why not."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1430330359, "creation_date": 1430330359, "answer_id": 29951121, "question_id": 29950379, "link": "https://stackoverflow.com/questions/29950379/vba-in-html-need-to-onmouseup-login-which-is-not-a-button/29951121#29951121", "title": "vba in html- Need to onmouseup login which is not a button", "body": "<pre><code>ie.document.getElementById(\"_sbsyf\").click \n</code></pre>\n\n<p>should do it</p>\n"}], "owner": {"reputation": 1, "user_id": 4800336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712b56ff767cf107e41e379f51973476?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/4800336/mahesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430330359, "creation_date": 1430327836, "question_id": 29950379, "link": "https://stackoverflow.com/questions/29950379/vba-in-html-need-to-onmouseup-login-which-is-not-a-button", "title": "vba in html- Need to onmouseup login which is not a button", "body": "<p>Is it possible to automate a login page using vba which has a mousedown and mouseup clicks . When i click a login button it has a mousedown click as it doesn't have any button in order to automate using vba.</p>\n\n<p>Please let me know if its possible to do so in vba using some functions</p>\n\n<p>Please copy the URL and paste in internet tab: \"<a href=\"http://discovery.ariba.com/rfx/3796429\" rel=\"nofollow\">http://discovery.ariba.com/rfx/3796429</a>\". After clicking the URL you will enter to Ariba Discovery site and there you have this Ship to Service location field. In that ship to service location field there are multiple locations and we need to click on \"Show more\". To click show more if we see the html code it's not a button in order to automate the click. It's awmouseup and aw is the page name i guess. I would recommend you yo use google chrome and try inspecting the html code. I need to automate the click using VBA code.</p>\n"}, {"tags": ["arrays", "vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1430335212, "post_id": 29950243, "comment_id": 48026125, "body": "This should work.  Simple examples work on my end even of fairly large size.  What does <code>MyArray</code> look like if you debug it?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1430372939, "post_id": 29950243, "comment_id": 48040312, "body": "AFAIK, that will not work. Pivot Table source range or cache accepts only Tables or Range or a Named Range. No a named constant or array."}, {"owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "edited": false, "score": 0, "creation_date": 1430395510, "post_id": 29950243, "comment_id": 48054110, "body": "thanks, i didn t know that."}], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 621, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430372412, "creation_date": 1430327420, "last_edit_date": 1430372412, "question_id": 29950243, "link": "https://stackoverflow.com/questions/29950243/build-a-pivot-out-of-an-array-built-and-named-in-vba", "title": "Build a pivot out of an array built and named in VBA", "body": "<p>I'm trying to reference the source data of my pivot to a name. I have the following code:</p>\n\n<pre><code>Set rng1 = Sheets(\"CALA current credit usage\").Range(\"A1:L235\")\nSet rng2 = Sheets(\"CALA forecast credit usage\").Range(\"A2:L235\")\n\nDim MyArray()\nTotalRows = rng1.Rows.Count + rng2.Rows.Count + 1\nReDim Preserve MyArray(1 To TotalRows, 1 To rng1.Columns.Count)\n\nFor i = 1 To rng1.Columns.Count\n    For j = 1 To rng1.Rows.Count\n        MyArray(j, i) = rng1.Cells(j, i)\n    Next j\nNext i\n\nj = j - 1\n ''''''\nFor h = 1 To rng2.Columns.Count\n    For w = 1 To rng2.Rows.Count\n        MyArray(w + j, h) = rng2.Cells(w, h)\n    Next w\nNext h\n\nActiveWorkbook.Names.Add Name:=\"ResultingRange\", RefersTo:=MyArray\n</code></pre>\n\n<p>But when I linked the pivot to <em>ResultingRange</em> I got:</p>\n\n<blockquote>\n  <p>Data source reference not valid. </p>\n</blockquote>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1430328022, "post_id": 29949297, "comment_id": 48021698, "body": "You can run the subs from another workbook with <code>Application.Run(&quot;my_addin.xla!MySub&quot;)</code>"}, {"owner": {"reputation": 355, "user_id": 3486991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66aabfbf711444de543ac382f08ca7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3486991", "link": "https://stackoverflow.com/users/3486991/user3486991"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1430329870, "post_id": 29949297, "comment_id": 48022818, "body": "@ja72 My question is not one of running subs, but rather how a public variable in the addin can be read/written inside the active workbook. Those public variables seem only to be global inside the addin.xla. I&#39;ll edit my question with a specific example"}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1430342456, "creation_date": 1430342456, "answer_id": 29954809, "question_id": 29949297, "link": "https://stackoverflow.com/questions/29949297/reference-add-in-global-variables-from-worksheet-code/29954809#29954809", "title": "Reference add in global variables from worksheet code", "body": "<p>I've solved similar problems to this before by not only copying worksheets into the new workbook (with each sheet's accompanying support code), but also by importing VBA modules into the new workbook. Clearly, the VBA modules can define any publically global variables and have them exist for that workbook. This is important when the add-in has been installed for a workbook and you want those public variables \"local\" to the add-in enabled workbook.</p>\n\n<p>At some point, you'll have to export your VBA module to a text file:</p>\n\n\n\n<pre><code>Sub ExportAllModulesAndClasses()\n    On Error GoTo Err_ExportAllModulesAndClasses\n    'Purpose:   Connects to the current project and exports each of the VBA\n    '           components to an external, text-based file. File extensions\n    '           are automatically selected based on the type of the component.\n    'Return:    n/a\n    'Author:    PeterT\n    Dim i As Integer\n    Dim sourceCode As Object\n    Dim filename As String\n\n    i = 0\n    For Each sourceCode In Application.VBE.ActiveVBProject.VBComponents\n        filename = CHOOSE_YOUR_DIRECTORY_PATH_HERE &amp; sourceCode.name &amp; GetFileExtension(sourceCode)\n        Debug.Print \"Exported: \" &amp; filename\n        sourceCode.Export filename\n        i = i + 1\n    Next\n    Debug.Print \"Export complete: \" &amp; i &amp; \" source code files created from this application\"\n\nExit_ExportAllModulesAndClasses:\n    Exit Sub\n\nErr_ExportAllModulesAndClasses:\n    MsgBox \"In ExportAllModulesAndClasses: \" &amp; Err.Number &amp; \" - \" &amp; Err.Description, vbOKOnly\n    Resume Exit_ExportAllModulesAndClasses\nEnd Sub\n\nPublic Function GetFileExtension(vbComp As Object) As String\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' This returns the appropriate file extension based on the Type of\n' the VBComponent.\n' based on: http://www.cpearson.com/excel/vbe.aspx\n'\n' Type property constants:\n' vbext_ct_StdModule       =   1  Standard Module\n' vbext_ct_ClassModule     =   2  Class Module\n' vbext_ct_MSForm          =   3  Microsoft Form\n' vbext_ct_ActiveXDesigner =  11  ActiveX Designer\n' vbext_ct_Document        = 100  Document Module\n'\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Select Case vbComp.Type\n        Case 2                        'class\n            GetFileExtension = \".cls\"\n        Case 100                      'document\n            GetFileExtension = \".cls\"\n        Case 3                        'form\n            GetFileExtension = \".frm\"\n        Case 1                        'standard module\n            GetFileExtension = \".bas\"\n        Case Else\n            GetFileExtension = \".bas\"\n    End Select\nEnd Function\n</code></pre>\n\n<p>And then when your add-in installs, you can import your module into the new workbook:</p>\n\n\n\n<pre><code>Sub ImportVBAProjectFiles()\nOn Error GoTo Err_ImportVBAProjectFiles\n    'Purpose:   Uses the constants defined above to access a specific\n    '           directory. All files within that directory will be added as\n    '           a module, class, form, etc to this application project.\n    'Return:    n/a\n    'Author:    PeterT\n    Dim i As Integer\n    Dim name As Variant\n    Dim filenames As New Collection\n\n    '--- build up an array of all the files (modules, forms, classes, etc)\n    '    that will be imported\n    Call FillDir(filenames, CHOOSE_YOUR_DIRECTORY_PATH_HERE , \"*.*\", False)\n\n    '--- add each item to this project\n    i = 0\n    For Each name In filenames\n        Application.VBE.ActiveVBProject.VBComponents.Import CStr(name)\n        Debug.Print \"Imported: \" &amp; name\n        i = i + 1\n    Next\n\nExit_ImportVBAProjectFiles:\n    Exit Sub\n\nErr_ImportVBAProjectFiles:\n    MsgBox \"In ImportVBAProjectFiles: \" &amp; Err.Number &amp; \" - \" &amp; Err.Description, vbOKOnly\n    Resume Exit_ImportVBAProjectFiles\nEnd Sub\n\nPrivate Function FillDir(colDirList As Collection, ByVal strFolder As String, _\n                         strFileSpec As String, bIncludeSubfolders As Boolean)\n    'Build up a list of files, and then add add to this list, any additional folders\n    'from:      http://allenbrowne.com/ser-59.html\n    Dim strTemp As String\n    Dim colFolders As New Collection\n    Dim vFolderName As Variant\n\n    'Add the files to the folder.\n    strFolder = TrailingSlash(strFolder)\n    strTemp = Dir(strFolder &amp; strFileSpec)\n    Do While strTemp &lt;&gt; vbNullString\n        colDirList.Add strFolder &amp; strTemp\n        strTemp = Dir\n    Loop\n\n    If bIncludeSubfolders Then\n        'Build collection of additional subfolders.\n        strTemp = Dir(strFolder, vbDirectory)\n        Do While strTemp &lt;&gt; vbNullString\n            If (strTemp &lt;&gt; \".\") And (strTemp &lt;&gt; \"..\") Then\n                If (GetAttr(strFolder &amp; strTemp) And vbDirectory) &lt;&gt; 0&amp; Then\n                    colFolders.Add strTemp\n                End If\n            End If\n            strTemp = Dir\n        Loop\n        'Call function recursively for each subfolder.\n        For Each vFolderName In colFolders\n            Call FillDir(colDirList, strFolder &amp; TrailingSlash(vFolderName), strFileSpec, True)\n        Next vFolderName\n    End If\nEnd Function\n\nPublic Function TrailingSlash(varIn As Variant) As String\n    'from:      http://allenbrowne.com/ser-59.html\n    If Len(varIn) &gt; 0&amp; Then\n        If Right(varIn, 1&amp;) = \"\\\" Then\n            TrailingSlash = varIn\n        Else\n            TrailingSlash = varIn &amp; \"\\\"\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 3486991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66aabfbf711444de543ac382f08ca7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3486991", "link": "https://stackoverflow.com/users/3486991/user3486991"}, "edited": false, "score": 0, "creation_date": 1430407043, "post_id": 29965467, "comment_id": 48062674, "body": "Thanks, that looks easiest! In this light I see what @ja72 was talking about  as well."}], "tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": true, "score": 3, "last_activity_date": 1430390137, "creation_date": 1430390137, "answer_id": 29965467, "question_id": 29949297, "link": "https://stackoverflow.com/questions/29949297/reference-add-in-global-variables-from-worksheet-code/29965467#29965467", "title": "Reference add in global variables from worksheet code", "body": "<p>Can you not do the following?</p>\n\n<ol>\n<li><p>Create an addin that has fields declared in a module.</p>\n\n<p>public TestMe as integer</p></li>\n<li><p>Also declare a public function in the same addin module to get the field value.</p>\n\n<p>public Function GetTestMe() as integer\nGetTestMe = TestMe\nend Function</p></li>\n<li><p>Now in any other workbook in the same Excel application, late bound the call to get the value.</p>\n\n<p>public Sub TestAddinCall()\nDim x as Integer\nx = Application.run(\"GetTestMe\")\nEnd Sub</p></li>\n</ol>\n\n<p>This will obviously be late bound, but is probably the simplest way.</p>\n"}], "owner": {"reputation": 355, "user_id": 3486991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66aabfbf711444de543ac382f08ca7f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3486991", "link": "https://stackoverflow.com/users/3486991/user3486991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 29965467, "answer_count": 2, "score": 3, "last_activity_date": 1430390137, "creation_date": 1430324376, "last_edit_date": 1531161705, "question_id": 29949297, "link": "https://stackoverflow.com/questions/29949297/reference-add-in-global-variables-from-worksheet-code", "title": "Reference add in global variables from worksheet code", "body": "<p>I'm building an Excel Addin, which declares some Public variables in a sub. When the Addin is first used, it copies some worksheets from the Addin (ThisWorkBook)\nto the user's workbook (ActiveWorkBook). Those worksheets have some worksheet event subs in them.</p>\n\n<p>Question: The ActiveWorkBook worksheet event subs need to reference the public variables defined in ThisWorkBoook, but can't seem to find them. I suppose because they're in a different workbook. But in this add-in situation, surely there must be some way of doing that?</p>\n\n<p>Specific example: GlobalAddin.xlam in module Module1  declares </p>\n\n<pre><code>Option Explicit\nPublic TestMe As Integer\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>Public Sub RunSub()\nTestMe = 10\nMsgBox \"The Addin says that TestMe is \" &amp; TestMe\nEnd Sub\n</code></pre>\n\n<p>and RunSub is called from the ThisWorkBook._Open() event.</p>\n\n<p>GlobalAddin.xlam is made an active addin. Now in another workbook Book2.xlm in Sheet1 we hasve</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nMsgBox \"The Worksheet says TestMe is \" &amp; TestMe\nEnd Sub\n</code></pre>\n\n<p>Now open Book2.xlm. A dialog box reports a value of 10 for TestMe (this from the xlam workbook_open even calling RunSub.) But then clicking on Sheet1 in Book2 causes an variable not defined error, saying TestMe is not defined.</p>\n\n<p>So this makes sense, but how is it that I <em>can</em> access the value of TestMe inside a worksheet event in Book2?</p>\n\n<p>(Edit: I suppose I could pass variables via a (hidden) sheet in ActiveWorkBook, but that seems kind of clumsy. Is there a better way?)</p>\n"}, {"tags": ["excel", "calendar", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1430330289, "post_id": 29949211, "comment_id": 48023075, "body": "Not sure do you have linked cells? to the textbox"}], "owner": {"reputation": 21, "user_id": 4793036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bef71b3c3212b2644bfb073ffadcfc5?s=128&d=identicon&r=PG&f=1", "display_name": "brandeetercek", "link": "https://stackoverflow.com/users/4793036/brandeetercek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430325977, "creation_date": 1430324071, "last_edit_date": 1531161705, "question_id": 29949211, "link": "https://stackoverflow.com/questions/29949211/sub-userform-calendar-populating-on-spreadsheet-cell-instead-of-on-userform", "title": "Sub Userform calendar populating on spreadsheet cell instead of on userform", "body": "<p>I have run across the problem of using DTpicker for dates.  So I have added my own calendar popup and now when I am in the usereform and click on the box or button for the calendar it populates the date on the original spreadsheet (it looks like in the last selected cell) instead of into my userform - TextBox8.  I am at a loss, Sometimes it works like I intended and other times it doesn't and does the previous.</p>\n\n<pre><code>Private Sub Date_Button_1_Click()\nUserForm1.TextBox8 = ActiveCell\n'this is the first calendar button &amp; box\nfrmCalendar.Show_Cal\nUserForm1.TextBox8.Value = g_sDate\nEnd Sub\n\nPrivate Sub TextBox8_Enter()\nUserForm1.TextBox8 = ActiveCell\ng_bForm = True\nfrmCalendar.Show_Cal\nUserForm1.TextBox8.Value = g_sDate\nEnd Sub\n</code></pre>\n\n<p>I am sure it is staring me in the face.  Any assistance would be great.  Thanks.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 411, "user_id": 4847112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07737fa67af173239496defc10b908b7?s=128&d=identicon&r=PG&f=1", "display_name": "RogB", "link": "https://stackoverflow.com/users/4847112/rogb"}, "is_accepted": true, "score": 1, "last_activity_date": 1430326124, "creation_date": 1430326124, "answer_id": 29949854, "question_id": 29949192, "link": "https://stackoverflow.com/questions/29949192/copy-a-range-from-one-sheet-to-the-first-empty-row-from-another-sheet/29949854#29949854", "title": "Copy a range from one sheet to the first empty row from another sheet", "body": "<p>Would this work?</p>\n\n<pre><code>Sub Button1_Click()\n\n    'This will select the whole range of cells starting in A17\n    Sheets(\"ORDEN DE COMPRA\").Select\n    Range(Range(\"A17\"), Range(\"A17\").End(xlDown).End(xlToRight)).Copy\n\n    'Now we need to find the first free row in the next sheet, assuming all rows have something on column A\n    Sheets(\"ITEMS CONTROL\").Select\n    Range(\"A1\").End(xlDown).Offset(1, 0).Select\n    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n            False, Transpose:=False\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4426, "user_id": 2665223, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wa6Sc.jpg?s=128&g=1", "display_name": "mvasco", "link": "https://stackoverflow.com/users/2665223/mvasco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3324, "favorite_count": 0, "accepted_answer_id": 29949854, "answer_count": 1, "score": 0, "last_activity_date": 1430326124, "creation_date": 1430324009, "last_edit_date": 1531161705, "question_id": 29949192, "link": "https://stackoverflow.com/questions/29949192/copy-a-range-from-one-sheet-to-the-first-empty-row-from-another-sheet", "title": "Copy a range from one sheet to the first empty row from another sheet", "body": "<p>In an Excel Sheet I have inserted a button that executes a Macro. This is the code for the Macro:</p>\n\n<pre><code>Sub Button1_Click()\n'\n' Button1_Click Macro\n'\n' Keyboard Shortcut: Option+Cmd+y\n'\n    Range(\"A17:I34\").Select\n    Selection.Copy\n    Sheets(\"ITEMS CONTROL\").Select\n    Range(\"A7\").Select\n    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=False\n    Range(\"A3:I9\").Select\nEnd Sub\n</code></pre>\n\n<p>The source sheet is \"ORDEN DE COMPRA\" and the sheet where I want to copy the selected range is \"ITEMS CONTROL\".</p>\n\n<p>What I need is to copy the not empty rows from the selected range to the first empty row from the end sheet, and not to the range I have in my current code.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1430322890, "post_id": 29948704, "comment_id": 48018357, "body": "Use <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/w8k3cys2.aspx\" rel=\"nofollow noreferrer\">ReDim Preserve</a> to build your array as you feed it values. For an example you could refer to my answer here: <a href=\"http://stackoverflow.com/questions/29930523/erase-empty-cells-in-an-array/29931503#29931503\">Erase empty cells in an array</a>."}, {"owner": {"reputation": 630, "user_id": 1172412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3c75a1f9d4ab98bff7c279c49c242913?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/1172412/steven"}, "edited": false, "score": 2, "creation_date": 1430323017, "post_id": 29948704, "comment_id": 48018456, "body": "Could you show your code?"}], "answers": [{"comments": [{"owner": {"reputation": 2901, "user_id": 619493, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e90d55a00ea556834a09949b6db2a547?s=128&d=identicon&r=PG", "display_name": "Amir Gonnen", "link": "https://stackoverflow.com/users/619493/amir-gonnen"}, "edited": false, "score": 0, "creation_date": 1430372469, "post_id": 29949864, "comment_id": 48040084, "body": "Perfect. All I needed was <code>Application.Caller.Rows.Count</code>."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1430326161, "creation_date": 1430326161, "answer_id": 29949864, "question_id": 29948704, "link": "https://stackoverflow.com/questions/29948704/custom-user-function-udf-and-dynamic-ranges/29949864#29949864", "title": "Custom User Function (UDF) and Dynamic Ranges", "body": "<p>Here is a pretty dumb example......a UDF to return the first <strong>7</strong> primes in column form:</p>\n\n<pre><code>Public Function Primes()\n'\n'   Array UDF to return the first 7 primes\n'\n    Dim rN As Long, ary(1 To 7) As Long\n    Dim tdim As Long, i As Long\n    Dim wf As WorksheetFunction\n    Set wf = Application.WorksheetFunction\n\n    rN = Application.Caller.Rows.Count\n    tdim = wf.Max(rN, 7)\n    ReDim bry(1 To tdim, 1 To 1)\n\n    ary(1) = 1\n    ary(2) = 3\n    ary(3) = 5\n    ary(4) = 7\n    ary(5) = 11\n    ary(6) = 13\n    ary(7) = 17\n\n    For i = 1 To 7\n        bry(i, 1) = ary(i)\n    Next i\n\n    If tdim &gt; 7 Then\n        For i = 8 To tdim\n            bry(i, 1) = \"\"\n        Next i\n    End If\n    Primes = bry\nEnd Function\n</code></pre>\n\n<p>The UDF detects how many cells it has to fill and if that value exceeds <strong>7</strong>, the balance is filled with blanks.</p>\n"}], "owner": {"reputation": 2901, "user_id": 619493, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e90d55a00ea556834a09949b6db2a547?s=128&d=identicon&r=PG", "display_name": "Amir Gonnen", "link": "https://stackoverflow.com/users/619493/amir-gonnen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 29949864, "answer_count": 1, "score": 0, "last_activity_date": 1430326161, "creation_date": 1430322638, "last_edit_date": 1430326046, "question_id": 29948704, "link": "https://stackoverflow.com/questions/29948704/custom-user-function-udf-and-dynamic-ranges", "title": "Custom User Function (UDF) and Dynamic Ranges", "body": "<p>I have a Custom User Function (UDF) that returns an array. I use it in an Array Formula on a large range of cells.<br>\nThe length of the returned array is dependent on the function parameters.\nThis works great except one thing: When the length of the returned array is smaller than the range defined for the array-formula, the \"out-of-range\" entries are all set to <code>#N/A</code>.  </p>\n\n<p>Is there a way to either obtain the array-formula range inside the custom user function (so, if needed, I could prepare a larger array to return), or alternatively return some kind of an iterator (instead of the array) which is not limited in size and would return <code>\"\"</code> in case of out-of-range?</p>\n"}, {"tags": ["parsing", "excel", "replace", "split", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1430322848, "post_id": 29948699, "comment_id": 48018323, "body": "On which line are you receiving the error?"}, {"owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1430323181, "post_id": 29948699, "comment_id": 48018580, "body": "<code>Columns(i).Cells(4) = SplitString(B3, &quot;,&quot;, 4)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430324018, "post_id": 29948699, "comment_id": 48019130, "body": "Is it reasonable to assume that the <b>NOM(LSL,USL)</b> text is not the same throughout all of the rows?"}, {"owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 0, "creation_date": 1430324758, "post_id": 29948699, "comment_id": 48019583, "body": "@Jeeped, It is the same across all columns"}], "answers": [{"comments": [{"owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 0, "creation_date": 1430324881, "post_id": 29949029, "comment_id": 48019652, "body": "When passing arguments to <code>SplitString</code> It is going to be looking for column by letter?  Can I modifiy that function to us <code>rLastCell.Column</code> as it is?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 0, "creation_date": 1430325165, "post_id": 29949029, "comment_id": 48019805, "body": "Ah. Another strange thing here then. Your call to SplitString sends variable Col3 which is not declared and never set. So... the bit I mentioned above will cause an error, once you fix the problem with <code>Col3</code> variable. What is <code>Col3</code> supposed to be?"}, {"owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 0, "creation_date": 1430325176, "post_id": 29949029, "comment_id": 48019814, "body": "Col needs too update to the current column so that is parses the correct data."}, {"owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 0, "creation_date": 1430325254, "post_id": 29949029, "comment_id": 48019860, "body": "I think that I am calling it incorrectly. In this case Col3 = B3, but Col needs to update to the correct column for the loop."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 1, "creation_date": 1430325399, "post_id": 29949029, "comment_id": 48019976, "body": "But you don&#39;t want to pass &quot;B3&quot; as a string down to the SplitString function. You want to send the String that is in RANGE <code>B3</code>. <code>B</code> being the column you are iterating through, right? So before you call <code>SplitString</code> put the line <code>Col3=ws.cells(3,i).value</code>  Now <code>Col3</code> which has to be a string according to the <code>splitstring</code> function parameters, is now properly set to the big string you are wanting to parse.  Then you can get rid of the Column Letter logic since it&#39;s not needed here."}, {"owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 0, "creation_date": 1430327774, "post_id": 29949029, "comment_id": 48021548, "body": "I have a bug, As it runs it is trimming off digits. Trailling zeros. Is there a way to prevent this?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "edited": false, "score": 1, "creation_date": 1430328764, "post_id": 29949029, "comment_id": 48022155, "body": "That&#39;s Excel&#39;s &quot;friendly&quot; front end guessing that these are numbers, not text.  Change the return type of <code>splitstring</code> to <code>STRING</code> instead of <code>VARIANT</code>, then, before you call it, set the cell format to <code>text</code>. So before <code>Columns(i).Cells(4) = SplitString(Col3, &quot;,&quot;, 4)</code> use a line like <code>Columns(i).Cells(4).NumberFormat = &quot;@&quot;</code>. It might also help to do a chant, encantation, or rain dance afterwards too, as Excel really likes to change formats."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1430323561, "creation_date": 1430323561, "answer_id": 29949029, "question_id": 29948699, "link": "https://stackoverflow.com/questions/29948699/vba-parse-string-place-values-to-new-columns/29949029#29949029", "title": "VBA parse string Place values to new columns", "body": "<p>You declare <code>Col</code> to be a range here:</p>\n\n<pre><code>Dim Col As Range\n</code></pre>\n\n<p>You then try to set <code>Col</code> to a string here:</p>\n\n<pre><code>Col = ColLett(rLastCell.Column)\n</code></pre>\n\n<p>When you set a range you have to set it to a range. Furthermore, you have to use the <code>SET</code> keyword to do so:</p>\n\n<pre><code>Set Col = &lt;a range&gt;\n</code></pre>\n\n<p>When you set that <code>Col</code> you set it only to the <code>rLastCell.Column</code> repeatedly in each loop of your <code>For</code>. If you just need that column letter for the last column, then do it before entering your for loop.</p>\n\n<p>All of that is pointless anyway. At no point do you use the Column letter that you went through the trouble retrieving in your function. And really, for what you are doing you don't need the Column Letter. Column Letters are for humans; the column number is what is important in VBA any how. </p>\n"}], "owner": {"reputation": 296, "user_id": 4730412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/mJwfF.png?s=128&g=1", "display_name": "Tom Ruh", "link": "https://stackoverflow.com/users/4730412/tom-ruh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 29949029, "answer_count": 1, "score": 0, "last_activity_date": 1430325027, "creation_date": 1430322612, "last_edit_date": 1531161705, "question_id": 29948699, "link": "https://stackoverflow.com/questions/29948699/vba-parse-string-place-values-to-new-columns", "title": "VBA parse string Place values to new columns", "body": "<p>I have a sheets with the rows of data like.</p>\n\n<pre><code>NOM(LSL,USL)=207.3980(206.1990,208.5970)    NOM(LSL,USL)=207.3980(206.1990,208.5970)    NOM(LSL,USL)=18.8200(18.4400,19.2100)\n</code></pre>\n\n<p>I would like to just grab the Values and place them in their own cells like</p>\n\n<pre><code>207.3980    207.3980    18.8200\n206.1990    206.1990    18.4400\n208.5970    208.5970    19.2100\n</code></pre>\n\n<p>I continue to recieve \"ByRef Argument Mismatch\" errors. I believe relating to how I am defining the reference cell.</p>\n\n<pre><code>Sub Parse_Replace()\n        Dim i As Double\n        Dim ws As Worksheet\n            Set ws = ThisWorkbook.ActiveSheet\n        Dim Col As Range\n        Dim rLastCell As Range\n            Set rLastCell = ws.Cells.Find(What:=\"*\", After:=ws.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n            xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False)\n    For i = rLastCell.Column To 1 Step -1\n        Col = ColLett(rLastCell.Column)\n        Columns(i).Cells(4) = SplitString(Col3, \",\", 4)\n        Columns(i).Cells(5) = SplitString(Col3, \",\", 5)\n        Columns(i).Cells(6) = SplitString(Col3, \",\", 6)\n    Next i\n\n    End Sub\n\nFunction ColLett(Col As Integer) As String\n\n    If Col &gt; 26 Then\n        ColLett = ColLett((Col - (Col Mod 26)) / 26) + Chr(Col Mod 26 + 64)\n    Else\n        ColLett = Chr(Col + 64)\n    End If\n\n    End Function\n\nFunction SplitString(pValue As String, pChar As String, pIndex As Integer) As Variant\n    Dim YString As Variant\n\n        YString = Replace(Replace(Replace(Replace(pValue, \" \", \"\"), \"=\", \"\"), \"(\", \",\"), \")\", \",\")\n        SplitString = Split(YString, pChar)(pIndex - 1)\n\n    End Function\n</code></pre>\n\n<p><strong>Process</strong></p>\n\n<ul>\n<li>Establish number of Columns with Data</li>\n<li><p>Loop through each column</p>\n\n<ul>\n<li><p>Convert column index to Column with <code>ColLett</code></p></li>\n<li><p>Set cell value with <code>SplitString</code></p></li>\n</ul></li>\n<li><p>Loop </p></li>\n</ul>\n\n<p>Thank You</p>\n\n<p><strong>EDIT :</strong> replaced <code>SplitString</code> value with inteded.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430322450, "post_id": 29948414, "comment_id": 48018041, "body": "Instead of doing Selection.exportasfixedformat. Could you not change that to application.exportasfixedFormat and then use the To and From to select the pages you need?"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430322790, "post_id": 29948414, "comment_id": 48018298, "body": "Or workbook.exportasfixedformat..."}, {"owner": {"reputation": 411, "user_id": 4847112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07737fa67af173239496defc10b908b7?s=128&d=identicon&r=PG&f=1", "display_name": "RogB", "link": "https://stackoverflow.com/users/4847112/rogb"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430324381, "post_id": 29948414, "comment_id": 48019348, "body": "Thanks, but neither of these would work I believe. Remember, I need to select specific areas from each sheet."}], "answers": [{"comments": [{"owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "edited": false, "score": 0, "creation_date": 1565790778, "post_id": 29966557, "comment_id": 101461985, "body": "Thanks for this, this issue was haunting me for couple of weeks."}], "tags": [], "owner": {"reputation": 411, "user_id": 4847112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07737fa67af173239496defc10b908b7?s=128&d=identicon&r=PG&f=1", "display_name": "RogB", "link": "https://stackoverflow.com/users/4847112/rogb"}, "is_accepted": true, "score": 6, "last_activity_date": 1430393405, "creation_date": 1430393405, "answer_id": 29966557, "question_id": 29948414, "link": "https://stackoverflow.com/questions/29948414/create-pdf-from-different-ranges-in-multiple-excel-sheets-with-vba/29966557#29966557", "title": "Create PDF from different ranges in multiple Excel sheets with VBA", "body": "<p>Ok, I solved it. If I don't select any ranges on the specific pages it will automatically get the Print_Area range of each sheet.</p>\n\n<pre><code>Sub CreatePDF()\n\n    ThisWorkbook.Sheets(Array(\"ReportPage1\", \"ReportPage2\", \"ReportPage3\")).Select\n\n    Sheets(\"ReportPage1\").Activate\n\n    ActiveSheet.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            FileName:=\"C:\\temp\\temp.pdf\", _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=True\n\n    Sheets(\"ReportPage1\").Select\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 4847112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07737fa67af173239496defc10b908b7?s=128&d=identicon&r=PG&f=1", "display_name": "RogB", "link": "https://stackoverflow.com/users/4847112/rogb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9916, "favorite_count": 0, "accepted_answer_id": 29966557, "answer_count": 1, "score": 2, "last_activity_date": 1510124853, "creation_date": 1430321839, "question_id": 29948414, "link": "https://stackoverflow.com/questions/29948414/create-pdf-from-different-ranges-in-multiple-excel-sheets-with-vba", "title": "Create PDF from different ranges in multiple Excel sheets with VBA", "body": "<p>I need to export several Excel sheets into one PDF file. I am currently using the following:</p>\n\n<pre><code>Sub CreatePDF()\n\n    Sheets(\"ReportPage1\").Select\n    Range(\"Print_Area\").Select\n    Sheets(\"ReportPage2\").Select\n    Range(\"Print_Area\").Select\n    Sheets(\"ReportPage3\").Select\n    Range(\"Print_Area\").Select\n\n        ThisWorkbook.Sheets(Array(\"ReportPage1\", \"ReportPage2\", \"ReportPage3\")).Select\n        Selection.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            FileName:=\"C:\\temp\\temp.pdf\", _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=True\n\n    Sheets(\"ReportPage1\").Select\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that all print areas are different. The PDF that is generated is using the range address of print area from ReportPage1 for all the pages. </p>\n\n<p>I tried in Excel itself, outside of VBA, and when I have selected, for example, ReportPage1!A1:E30 and ReportPage2!A1:F70, when I select both sheets it will change the selected ranges to ReportPage1!A1:E30 and ReportPage2!A1:E30.</p>\n\n<p>Any ideas how to solve this?</p>\n\n<p>Any help will be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430321365, "post_id": 29947950, "comment_id": 48017322, "body": "Is the conditional formatting simple? I was thinking of rather than copy the colour. Check to see if the value would satisfy the condtional formatting, if it does then change rngPaste colour to be that colour"}], "answers": [{"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1430322649, "last_edit_date": 1495541910, "creation_date": 1430321062, "answer_id": 29948107, "question_id": 29947950, "link": "https://stackoverflow.com/questions/29947950/copy-cell-background-color-and-paste-it-to-corresponding-cell-of-another-sheet/29948107#29948107", "title": "Copy cell background color and paste it to corresponding cell of another sheet", "body": "<p>.Interior.Color gets the actual colour of the cell rather than the conditionally formatted colour (the one you see). So you can't copy/paste this red colour in your example in this way.</p>\n\n<p>I believe that the only way to get the conditionally formatted colour you see would be to recompute whatever formula you've used in your conditionally formatting criteria. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/996384/excel-2007-conditional-formatting-how-to-get-cell-color\">Excel 2007 conditional formatting - how to get cell color?</a></p>\n\n<p><strong><em>Edit</em></strong></p>\n\n<p>While @JeffK627 was giving an elegant solution, I was knocking up some rough vba code to recompute what I gather your conditional formatting does. I've done this over range A1:A20 on sheet 2. At the moment it colours the cell that contains the value itself, but only requires a little tweak to colour the equivalent cell on another sheet.</p>\n\n<pre><code>Sub ColouringIn()\n\n    Dim intColIndex As Integer\n    Dim dblMax As Double\n    Dim dblMin As Double\n    Dim rngCell As Range\n\n    'RGB(255, 255, 255) = white\n    'RGB(255, 0, 0) = red\n    'so need to extrapolate between\n\n    dblMax = Application.WorksheetFunction.Max(Sheet2.Range(\"A1:A20\"))\n    dblMin = Application.WorksheetFunction.Min(Sheet2.Range(\"A1:A20\"))\n\n    For Each rngCell In Sheet2.Range(\"A1:A20\")\n        If IsNumeric(rngCell.Value) And rngCell.Value &lt;&gt; \"\" Then\n            intColIndex = (rngCell.Value - dblMin) / (dblMax - dblMin) * 255\n            rngCell.Interior.Color = RGB(255, intColIndex, intColIndex)\n        End If\n    Next rngCell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "edited": false, "score": 0, "creation_date": 1430322207, "post_id": 29948326, "comment_id": 48017853, "body": "To prevent potential issues with link rot, you should reproduce the steps in the link (in addition to posting the link) in your answer."}], "tags": [], "owner": {"reputation": 195, "user_id": 4690714, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/498d91afae713f28d7866f8afa9be5d2?s=128&d=identicon&r=PG&f=1", "display_name": "JeffK627", "link": "https://stackoverflow.com/users/4690714/jeffk627"}, "is_accepted": false, "score": 3, "last_activity_date": 1430321619, "last_edit_date": 1495535252, "creation_date": 1430321619, "answer_id": 29948326, "question_id": 29947950, "link": "https://stackoverflow.com/questions/29947950/copy-cell-background-color-and-paste-it-to-corresponding-cell-of-another-sheet/29948326#29948326", "title": "Copy cell background color and paste it to corresponding cell of another sheet", "body": "<p>Simplest would be to apply the same conditional formatting to Sheet2, but use the values from Sheet1 as your criteria. So if Sheet1 Cell A1 has the value that makes it red, add formatting to Sheet2 that turns Sheet2 Cell A1 red as well.</p>\n\n<p>There's a good explanation of how to achieve this <a href=\"https://stackoverflow.com/questions/451297/format-cell-color-based-on-value-in-another-sheet-and-cell\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "edited": false, "score": 0, "creation_date": 1430900403, "post_id": 29948943, "comment_id": 48256405, "body": "dear ,your solution is correct and its working .could you please give me a more explanation or code for select the whole range ,example from 1st row to last row and last column .Thanks in advance .@shagans"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "reply_to_user": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "edited": false, "score": 0, "creation_date": 1430921037, "post_id": 29948943, "comment_id": 48271476, "body": "I updated my answer with a complete example to avoid confusion. I also realized that in order to preserve the location of the color on the paste sheet, these for loops would work better than the original idea I had suggested. Just making sure: This will NOT copy the value of the source cell, just the currently displayed color format."}], "tags": [], "owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "is_accepted": true, "score": 3, "last_activity_date": 1430920895, "last_edit_date": 1430920895, "creation_date": 1430323297, "answer_id": 29948943, "question_id": 29947950, "link": "https://stackoverflow.com/questions/29947950/copy-cell-background-color-and-paste-it-to-corresponding-cell-of-another-sheet/29948943#29948943", "title": "Copy cell background color and paste it to corresponding cell of another sheet", "body": "<pre><code>rngPaste.Interior.Color = rngCopy.DisplayFormat.Interior.Color\n</code></pre>\n\n<p>Seems to work for me. Keep in mind that DisplayFormat is read-only and is not allowed to return value outside of the function it's used in. Also it is only available in Excel 2010 + </p>\n\n<p>I was editing my answer to include the other stuff you mentioned and realized it was getting confusing to explain it all in separate chunks. Here's a recommended approach to achieve what you're saying. </p>\n\n<pre><code>Public Sub CopyColor()\nDim SourceSht As Worksheet\nDim TargetSht As Worksheet\nDim rngCopy As Range\nDim rngPaste As Range\nDim LastCopyRow As Long\nDim LastCopyColumn As Long\n\n'Define what our source sheet and target sheet are\nSet SourceSht = ThisWorkbook.Worksheets(\"Sheet1\")\nSet TargetSht = ThisWorkbook.Worksheets(\"Sheet2\")\n\n'Find our used space on the source sheet\nLastCopyRow = SourceSht.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastCopyColumn = SourceSht.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Setup our ranges so we can be sure we don't loop through unused space\nSet rngCopy = SourceSht.Range(\"A1:\" &amp; SourceSht.Cells(LastCopyRow, LastCopyColumn).Address)\nSet rngPaste = TargetSht.Range(\"A1:\" &amp; TargetSht.Cells(LastCopyRow, LastCopyColumn).Address)\n\n'Loop through each row of each column.\n' This will go through each cell in column 1, then move on to column 2\nFor Col = 1 To LastCopyColumn\n    For cel = 1 To LastCopyRow\n        ' If the string value of our current cell is not empty.\n        If rngCopy.Cells(cel, Col).Value &lt;&gt; \"\" Then\n            'Copy the source cell displayed color and paste it in the target cell\n            rngPaste.Cells(cel, Col).Interior.Color = rngCopy.Cells(cel, Col).DisplayFormat.Interior.Color\n        End If\n    Next cel\nNext Col\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 971, "user_id": 1132062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19da0652371ee5881adff136ef755372?s=128&d=identicon&r=PG", "display_name": "ReturnVoid", "link": "https://stackoverflow.com/users/1132062/returnvoid"}, "is_accepted": false, "score": 0, "last_activity_date": 1544255336, "creation_date": 1544255336, "answer_id": 53680615, "question_id": 29947950, "link": "https://stackoverflow.com/questions/29947950/copy-cell-background-color-and-paste-it-to-corresponding-cell-of-another-sheet/53680615#53680615", "title": "Copy cell background color and paste it to corresponding cell of another sheet", "body": "<p>Adding following example as alternative solution, as I needed something dynamic/active where color IS a required condition of data &amp; not reliant on any other trigger.</p>\n\n<p>Option1:</p>\n\n<pre><code>Dim rngPrev2Update As Range\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim cellbox As Range\n    Dim rngDest As Range\n\n    If Not rngPrev2Update Is Nothing Then\n    For Each cellbox In rngPrev2Update.Cells\n        Worksheets(\"Sheet2\").Range(cellbox.Address).Interior.ColorIndex = cellbox.Interior.ColorIndex\n    Next cellbox\n    End If\n    Set rngPrev2Update = Target\n\nEnd Sub\n</code></pre>\n\n<p>This will update destination cells when cursor is next moved to another cell.</p>\n\n<p>Option2:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\n    Dim cellbox As Range\n    Dim rngCells As Range\n    Set rngCells = Range(\"B1:B10\")\n\n    For Each cellbox In rngCells.Cells\n        Range(cellbox.Address).Interior.ColorIndex = Worksheets(\"Sheet2\").Range(cellbox.Address).Interior.ColorIndex\n    Next cellbox\n\nEnd Sub\n</code></pre>\n\n<p>Will update relevant cells on sheet load.</p>\n\n<p><em>Note: If you have very large data set you may want to put this into a macro button &amp;/or filter this further for only the cells you need, otherwise this may slow your spreadsheet down.</em></p>\n"}, {"comments": [{"owner": {"reputation": 767, "user_id": 656988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e94ad3a9c30ec3290b9600018e8c73?s=128&d=identicon&r=PG", "display_name": "AntoineL", "link": "https://stackoverflow.com/users/656988/antoinel"}, "edited": false, "score": 0, "creation_date": 1582052977, "post_id": 60287356, "comment_id": 106641665, "body": "-1 This is not an answer; rather you are asking your own question, slightly different.  And <code>|</code> won&#39;t work, neither with Excel nor in VBA."}], "tags": [], "owner": {"reputation": 1, "user_id": 12255958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee23ccabad712de6a00cec5e57be2ce?s=128&d=identicon&r=PG&f=1", "display_name": "Jilbo", "link": "https://stackoverflow.com/users/12255958/jilbo"}, "is_accepted": false, "score": -1, "last_activity_date": 1582050738, "creation_date": 1582050738, "answer_id": 60287356, "question_id": 29947950, "link": "https://stackoverflow.com/questions/29947950/copy-cell-background-color-and-paste-it-to-corresponding-cell-of-another-sheet/60287356#60287356", "title": "Copy cell background color and paste it to corresponding cell of another sheet", "body": "<p>Appreciating this was some time ago. I would like to do a similar thing however would like to append the Interior Color Reference ie. 255 to the cells value.</p>\n\n<p>so if cell A1 has Hello in the cell and is Colored Red I'd want in the other worksheet cell A1: Hello | 255</p>\n\n<p>Just used | as a delimiter but anything sensible...</p>\n"}], "owner": {"reputation": 129, "user_id": 4651719, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58e3cd661adc7756f3a3ef22c4bc2074?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Abdur Rahim", "link": "https://stackoverflow.com/users/4651719/md-abdur-rahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19635, "favorite_count": 1, "accepted_answer_id": 29948943, "answer_count": 5, "score": 3, "last_activity_date": 1598882240, "creation_date": 1430320672, "last_edit_date": 1544319598, "question_id": 29947950, "link": "https://stackoverflow.com/questions/29947950/copy-cell-background-color-and-paste-it-to-corresponding-cell-of-another-sheet", "title": "Copy cell background color and paste it to corresponding cell of another sheet", "body": "<p>I have values on Sheet 1 and I gave the background color using conditional formatting.</p>\n\n<p>I want to copy only the color and paste it to the corresponding cell of  sheet 2 without pasting the value.</p>\n\n<p>Example if sheet 1 cell A1 has red color for specific value, transfer the color to sheet 2 A1.</p>\n\n<p>I use two colors, red and white. Red is for higher value and white is for lower value.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tKrs4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tKrs4.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub copycolor()\n    Dim intRow As Integer\n    Dim rngCopy As Range\n    Dim rngPaste As Range\n\n    For intRow = 1 To 20\n\n        Set rngCopy = Sheet1.Range(\"A\" &amp; intRow + 0)\n        Set rngPaste = Sheet2.Range(\"b\" &amp; intRow)\n\n        'Test to see if rows 500+ have a value\n        If rngCopy.Value &lt;&gt; \"\" Then\n\n            'Since it has a value, copy the value and color\n            rngPaste.Value = rngCopy.Value\n            rngPaste.Interior.Color = rngCopy.Interior.Color\n\n        End If\n    Next intRow\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "if-statement", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430321399, "post_id": 29947902, "comment_id": 48017339, "body": "When you set a variable of type &quot;Date&quot; equal to a Range, you&#39;re accessing the value property so you don&#39;t need to specify &quot;.value&quot; (it might be just for elegance purpose). Moreover, if there&#39;s a date in the range, it&#39;s not by converting it in string that the equality is going to be reached, the values keep on being different anyway."}, {"owner": {"reputation": 3, "user_id": 4846949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5IAeJDGLd3Q/AAAAAAAAAAI/AAAAAAAAAgU/Hvo7HC9krwU/photo.jpg?sz=128", "display_name": "Jeff Sandler", "link": "https://stackoverflow.com/users/4846949/jeff-sandler"}, "edited": false, "score": 0, "creation_date": 1430321895, "post_id": 29947902, "comment_id": 48017645, "body": "Yeah I tried both and still stuck on that. I&#39;ve dim(med) dates before and had them work so I&#39;m not sure what I necessarily did differently this time. Appreciate the answer though!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1430320564, "creation_date": 1430320564, "answer_id": 29947902, "question_id": 29947821, "link": "https://stackoverflow.com/questions/29947821/sheet-to-sheet-multiple-cell-comparison/29947902#29947902", "title": "Sheet to sheet multiple cell comparison", "body": "<p>I think it might be because you are comparing two ranges.  Try changing date1 and date2 to <code>Sheets(\"Sheet\").Range(\"B\" $ i).value</code> (add '.value' at the end).  That might help.  If not, then change the declarations for date1 and date2 to String, instead of Date.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4846949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5IAeJDGLd3Q/AAAAAAAAAAI/AAAAAAAAAgU/Hvo7HC9krwU/photo.jpg?sz=128", "display_name": "Jeff Sandler", "link": "https://stackoverflow.com/users/4846949/jeff-sandler"}, "edited": false, "score": 0, "creation_date": 1430322706, "post_id": 29948438, "comment_id": 48018230, "body": "That got past the first problem however it still runs and doesn&#39;t do anything, it seems that it&#39;s not even performing an iteration within the for loop"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1430321903, "creation_date": 1430321903, "answer_id": 29948438, "question_id": 29947821, "link": "https://stackoverflow.com/questions/29947821/sheet-to-sheet-multiple-cell-comparison/29948438#29948438", "title": "Sheet to sheet multiple cell comparison", "body": "<p>The reason why you get that error is that you're trying to access a <code>Range</code> that doesn't exist. Basically:</p>\n\n<pre><code>Dim i As Integer, j As Integer\n</code></pre>\n\n<p>will declare <code>i</code> and <code>j</code> as Integer and assign them the default value of <code>0</code>. Some lines after, you do: </p>\n\n<pre><code>date1 = Sheets(\"Sheet8\").Range(\"A\" &amp; i)\ndate2 = Sheets(\"Sheet7\").Range(\"A\" &amp; j)\n</code></pre>\n\n<p>Being <code>i</code> and <code>j</code> equal to <code>0</code>, you're trying to access the <code>Range(\"A0\")</code> of the two sheets. This object doesn't exist, so you get an <code>Application-defined or object-defined error</code>. If the values are in the ranges <code>Range(\"A1\")</code> of the two sheets, consider assigning correctly the two values of <code>i = 1</code> and <code>j=1</code> before running the <code>date1</code> and <code>date2</code> statements. This will solve your <code>1004 error</code>. As for the effectiveness of the rest of the code, you will need to debug basing on your own data to figure out where the coding inconsistency lies. </p>\n"}], "owner": {"reputation": 3, "user_id": 4846949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5IAeJDGLd3Q/AAAAAAAAAAI/AAAAAAAAAgU/Hvo7HC9krwU/photo.jpg?sz=128", "display_name": "Jeff Sandler", "link": "https://stackoverflow.com/users/4846949/jeff-sandler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 29948438, "answer_count": 2, "score": 0, "last_activity_date": 1430326233, "creation_date": 1430320360, "last_edit_date": 1430326233, "question_id": 29947821, "link": "https://stackoverflow.com/questions/29947821/sheet-to-sheet-multiple-cell-comparison", "title": "Sheet to sheet multiple cell comparison", "body": "<p>I'm trying to create a code that will compare the first column (Dates) on sheet8 with the first column (Dates) on sheet7. In addition, I have to compare the 2nd columns on each sheet (Shift). Once the program hits the correct shift and date, I need to copy and paste some certain data located on sheet7 to sheet8. I've searched quite a bit on it and can't seem to find the correct answer. (Note: somewhat new to vba and self taught so forgive me for any mistakes in code). </p>\n\n<pre><code>enter code here\nOption Explicit\nSub GrabKPI()\nDim i As Integer, j As Integer\nDim date1 As Date, date2 As Date\nDim shift1 As Integer, shift2 As Integer\ndate1 = Sheets(\"Sheet8\").Range(\"A\" &amp; i)\ndate2 = Sheets(\"Sheet7\").Range(\"A\" &amp; j)\nshift1 = Sheets(\"Sheet8\").Range(\"B\" &amp; i)\nshift2 = Sheets(\"Sheet7\").Range(\"B\" &amp; j)\n\nFor i = 2 To 1697\nIf date1 = date2 Then\n    If shift1 = shift2 Then\n        Sheets(\"Sheet7\").Activate\n        Range(\"C\" &amp; j, \"F\" &amp; j).Select\n        Selection.Copy\n        Sheets(\"Sheet8\").Activate\n        Range(\"I\" &amp; i).PasteSpecial xlPasteAll\n        j = j + 1\n    Else: j = j + 1\n    End If\nElse: j = j + 1\nEnd If\ni = i + 1\nNext i\nEnd Sub\n</code></pre>\n\n<p>Right now, I get the error \"Application-defined or object-defined error\" referring to the date1 and date2 statements. However I tried using this general code with a different set up and it would run but nothing would happen.</p>\n"}, {"tags": ["vba", "reporting-services", "jagged-arrays"], "comments": [{"owner": {"reputation": 19, "user_id": 351121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f2f21b79403ca3324a17c7de2e50b1?s=128&d=identicon&r=PG", "display_name": "tcarper", "link": "https://stackoverflow.com/users/351121/tcarper"}, "reply_to_user": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 0, "creation_date": 1430320458, "post_id": 29947709, "comment_id": 48016638, "body": "SQL Server 2012. I mean... I could throw it into a loop in SQL but... I really dislike RBAR and it would add a lot of overhead to the query to do. This may end up having to be though, as when you only have a hammer everything looks like a nail."}, {"owner": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 1, "creation_date": 1430321002, "post_id": 29947709, "comment_id": 48017046, "body": "In tsql <code>PERCENTILE_CONT</code> function for the median <a href=\"https://msdn.microsoft.com/en-us/library/hh231473(v=sql.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/hh231473(v=sql.110).aspx</a>"}, {"owner": {"reputation": 19, "user_id": 351121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f2f21b79403ca3324a17c7de2e50b1?s=128&d=identicon&r=PG", "display_name": "tcarper", "link": "https://stackoverflow.com/users/351121/tcarper"}, "reply_to_user": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 0, "creation_date": 1430322197, "post_id": 29947709, "comment_id": 48017845, "body": "Yes, it looks like this will work! Thank goodness for built-in SQL functions!"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 351121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f2f21b79403ca3324a17c7de2e50b1?s=128&d=identicon&r=PG", "display_name": "tcarper", "link": "https://stackoverflow.com/users/351121/tcarper"}, "is_accepted": false, "score": 0, "last_activity_date": 1430321494, "creation_date": 1430321494, "answer_id": 29948269, "question_id": 29947709, "link": "https://stackoverflow.com/questions/29947709/ssrs-median-by-group-jagged-array/29948269#29948269", "title": "SSRS - Median by Group - Jagged Array?", "body": "<p>I think I have a SQL solution that doesn't utilize a loop.</p>\n\n<pre><code>;WITH Counts AS\n(\n   SELECT SalesPerson, c = COUNT(*)\n   FROM dbo.Sales\n   GROUP BY SalesPerson\n)\nSELECT a.SalesPerson, Median = AVG(0.+Amount)\nFROM Counts a\nCROSS APPLY\n(\n   SELECT TOP (((a.c - 1) / 2) + (1 + (1 - a.c % 2)))\n      b.Amount, r = ROW_NUMBER() OVER (ORDER BY b.Amount)\n   FROM dbo.Sales b\n   WHERE a.SalesPerson = b.SalesPerson\n   ORDER BY b.Amount\n) p\nWHERE r BETWEEN ((a.c - 1) / 2) + 1 AND (((a.c - 1) / 2) + (1 + (1 - a.c % 2)))\nGROUP BY a.SalesPerson;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 351121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f2f21b79403ca3324a17c7de2e50b1?s=128&d=identicon&r=PG", "display_name": "tcarper", "link": "https://stackoverflow.com/users/351121/tcarper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430321494, "creation_date": 1430320083, "question_id": 29947709, "link": "https://stackoverflow.com/questions/29947709/ssrs-median-by-group-jagged-array", "title": "SSRS - Median by Group - Jagged Array?", "body": "<p>I'm faced with a challenge in two parts. I've been requested to replace 3 columns in a Matrix that aggregates on Name in the row group. The 3 columns are outside of the Column group.</p>\n\n<p>Challenge 1 - Matrices want to summarize the Data pane. There seems to be no way to show the Raw Data (and then hide it, in order for these rows during runtime to populate an array).</p>\n\n<p>Challenge 2 - I need to calculate the median BY name. This means either, during runtime, I need to calculate one median for each name at a time, reset the array, and start fresh for the next name value, OR, I need a multi-dimensional array where each ordinal is itself an array corresponding to a name.</p>\n\n<p>I'm also a total code monkey at VB.</p>\n\n<p>Here's what I've currently borrowed from an online post about calculating Median in SSRS.</p>\n\n<pre><code>    Dim values As System.Collections.ArrayList\n\n    Function AddValue(ByVal newValue As Decimal)\n        If (values Is Nothing) Then\n            values = New System.Collections.ArrayList()\n        End If\n        values.Add(newValue)\n    End Function\n\n    Function GetMedian() As Decimal\n        Dim count As Integer = values.Count\n        If (count &gt; 0) Then\n            values.Sort()\n            GetMedian = values(count / 2)\n        End If\n    End Function\n</code></pre>\n"}, {"tags": ["regex", "excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1430319915, "post_id": 29947508, "comment_id": 48016180, "body": "Just a thought but maybe (since there seems to be no real consistent formatting to the DOC number) highlight the cells and use Text to Columns with a space delimiter.  From your example that&#39;ll at least extract them."}, {"owner": {"reputation": 83, "user_id": 1284891, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/13f383cfacfacb6b8d43f092a440f7c9?s=128&d=identicon&r=PG", "display_name": "L.P.", "link": "https://stackoverflow.com/users/1284891/l-p"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1430320264, "post_id": 29947508, "comment_id": 48016474, "body": "Would love to, as that would make it super simple. However you can not enter more that a single character for a delimiter in Text-to-cols, and there are too many &quot;#&quot;s and &quot;-&quot;s that I can&#39;t reliably use those singularly."}, {"owner": {"reputation": 83, "user_id": 1284891, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/13f383cfacfacb6b8d43f092a440f7c9?s=128&d=identicon&r=PG", "display_name": "L.P.", "link": "https://stackoverflow.com/users/1284891/l-p"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1430320553, "post_id": 29947508, "comment_id": 48016695, "body": "Oh! Find &quot;DOC#-&quot;, Replace &quot;@DOC#-&quot;. Now I can Text to Col. Then some formula to remove the trailing text. Guess thanks after all Mrbungle"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1430320584, "post_id": 29947508, "comment_id": 48016722, "body": "I used your example and used the Space delimiter and it extracted the &quot;DOC#-12351-2432-1b&quot; and &quot;DOC#-2342-RTF-DD-09,&quot; into separate cells. From there you can at least do something with it."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1430320684, "post_id": 29947508, "comment_id": 48016791, "body": "There ya go, no problem :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430320710, "post_id": 29947508, "comment_id": 48016814, "body": "Where do you want to put the document numbers once you have them?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 1284891, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/13f383cfacfacb6b8d43f092a440f7c9?s=128&d=identicon&r=PG", "display_name": "L.P.", "link": "https://stackoverflow.com/users/1284891/l-p"}, "edited": false, "score": 0, "creation_date": 1430321551, "post_id": 29948132, "comment_id": 48017441, "body": "Keep this anyway. Less steps. Thank you."}, {"owner": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 0, "creation_date": 1430321602, "post_id": 29948132, "comment_id": 48017466, "body": "Great answer, although would love to see array formula based answer."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 1, "creation_date": 1430321721, "post_id": 29948132, "comment_id": 48017530, "body": "@zx8754 It is MUCH more difficult for me to construct formulas than write VBA."}, {"owner": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 0, "creation_date": 1430321879, "post_id": 29948132, "comment_id": 48017639, "body": "@Gary&#39;sStudent for me the opposite :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1430321142, "creation_date": 1430321142, "answer_id": 29948132, "question_id": 29947508, "link": "https://stackoverflow.com/questions/29947508/extracting-several-strings-from-a-range-of-cells/29948132#29948132", "title": "Extracting several strings from a range of cells", "body": "<p>Select the cells you wish to process and run this small macro:</p>\n\n<pre><code>Sub qwerty()\n    Dim i As Long, V As String, K As Long\n    For Each r In Selection\n        V = Replace(r.Value, \",\", \" \")\n        ary = Split(V, \"DOC#-\")\n        K = 1\n        For i = 1 To UBound(ary)\n            bry = Split(ary(i), \" \")\n            bry(0) = \"DOC#-\" &amp; bry(0)\n            r.Offset(0, K).Value = bry(0)\n            K = K + 1\n        Next i\n    Next r\nEnd Sub\n</code></pre>\n\n<p>It will look for either a <strong>space</strong> or a <strong>comma</strong> to terminate the document number.  Here is an example of input/output:</p>\n\n<p><img src=\"https://i.stack.imgur.com/KwFrJ.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1430455773, "creation_date": 1430455773, "answer_id": 29981745, "question_id": 29947508, "link": "https://stackoverflow.com/questions/29947508/extracting-several-strings-from-a-range-of-cells/29981745#29981745", "title": "Extracting several strings from a range of cells", "body": "<p>A variant array/regexp approach for speed</p>\n\n<pre><code>Sub GetDoc()\nDim X\nDim objRegex As Object\nDim objRegexMC As Object\nDim objRegexM As Object\nDim lngCnt As Long\nDim lngCnt2 As Long\n\nX = Range([a1], Cells(Rows.Count, \"A\").End(xlUp))\nReDim Preserve X(1 To UBound(X, 1), 1 To 100)\n\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Global = True\n    .ignorecase = True\n    .Pattern = \"DOC#[-\\w]+\"\nFor lngCnt = 1 To UBound(X)\n    If .test(X(lngCnt, 1)) Then\n    lngCnt2 = 2\n        Set objRegexMC = .Execute(X(lngCnt, 1))\n            For Each objRegexM In objRegexMC\n                X(lngCnt, lngCnt2) = objRegexM\n            lngCnt2 = lngCnt2 + 1\n            Next\n    End If\nNext\nEnd With\n\n[a1].Resize(UBound(X, 1), UBound(X, 2)) = X\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 1284891, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/13f383cfacfacb6b8d43f092a440f7c9?s=128&d=identicon&r=PG", "display_name": "L.P.", "link": "https://stackoverflow.com/users/1284891/l-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 29948132, "answer_count": 2, "score": 1, "last_activity_date": 1430455773, "creation_date": 1430319618, "last_edit_date": 1531161705, "question_id": 29947508, "link": "https://stackoverflow.com/questions/29947508/extracting-several-strings-from-a-range-of-cells", "title": "Extracting several strings from a range of cells", "body": "<p>I have couple thousand of cell which I need to extract document numbers out from. Cells have no format what so ever, but every Document Number starts with \"Doc#-\"\nSo for example</p>\n\n<p>B2:</p>\n\n<pre><code>This is an example cell showing a doc number DOC#-12351-2432-1b and a second document DOC#-2342-RTF-DD-09, there may be several more or only one.\n</code></pre>\n\n<p>I am looking for a way to extract all the document numbers as individual numbers, into separate cells, line, etc. What would the best way to go about this?</p>\n\n<p>Current I have some extremely rough Formula.</p>\n\n<pre><code>=MID($B2,find(\"DOC#-\",$b2,1),FIND(\" \",$b2,find(\"DOC#-\",$b2,1))-find(\"Doc#-\",$b2,1)\n</code></pre>\n\n<p>Which: Finds the first doc, find a space after it, returns the number with MID.</p>\n\n<p>Thinking VBA is likely the way to solve this, but I'm stumped on how.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 0, "creation_date": 1430321219, "post_id": 29947333, "comment_id": 48017217, "body": "Wow, just...Wow!  Was it really that easy?"}], "tags": [], "owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "is_accepted": true, "score": 1, "last_activity_date": 1430319222, "creation_date": 1430319222, "answer_id": 29947333, "question_id": 29947244, "link": "https://stackoverflow.com/questions/29947244/how-do-i-get-vba-loop-result-to-populate-a-combobox/29947333#29947333", "title": "How do I get vba loop result to populate a combobox?", "body": "<p>Try this</p>\n\n<pre><code>Do\n    findNum = findNum + 1\n\n    addressStr = addressStr &amp; .Name\n    ComboBox1.AddItem addressStr 'replace ComboBox1 with your ComboBox name\n    addressStr = addressStr &amp; vbCrLf ' if you still want to add the Line feed                            \n\n    Set rngFind = .Columns(41).FindNext(rngFind)\n\nLoop While Not rngFind Is Nothing And rngFind.Address &lt;&gt; firstAddress\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "is_accepted": false, "score": 0, "last_activity_date": 1432051082, "creation_date": 1432051082, "answer_id": 30330531, "question_id": 29947244, "link": "https://stackoverflow.com/questions/29947244/how-do-i-get-vba-loop-result-to-populate-a-combobox/30330531#30330531", "title": "How do I get vba loop result to populate a combobox?", "body": "<p>Got it.  Here's the final working code.  Slight changes in where the variables pass to, based on additional steps not included in original question.</p>\n\n<pre><code>Private Sub CboReviewWeek_Change()\n'search all worksheets for matching date and return worksheet names to combobox\n\nDim ws As Worksheet\nDim rngFind As Range\nDim myDate As Date\nDim firstAddress As String\nDim StrTab As String\n\n  'Sets the variable equal to date selected\n  myDate = CboReviewWeek.Value\n\n  'object to operate on\n  For Each ws In ActiveWorkbook.Worksheets\n\n    'Exclude the following sheets from search\n    With ws\n        If ws.Name = \"CM Chapters\" Then GoTo myNext\n        If ws.Name = \"CM Codes\" Then GoTo myNext\n        If ws.Name = \"PCS Categories\" Then GoTo myNext\n        If ws.Name = \"PCS Chapters\" Then GoTo myNext\n        If ws.Name = \"PCS Code\" Then GoTo myNext\n\n    'Run Find command on defined range and save result to range variable\n    Set rngFind = .Columns(40).Find(what:=myDate, LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n\n        'If cell is populated, then pass said value to string variable\n        If Not rngFind Is Nothing Then\n        firstAddress = rngFind.Address\n\n    Do  'do this thing\n\n        'set string variable equal to name of worksheet\n        StrTab = .Name\n\n        'Add string variable value to Combobox\n        Me.CboReviewModule.AddItem StrTab\n\n        Loop While rngFind.Address &lt;&gt; firstAddress And Not rngFind Is Nothing\n\n        'Reset the range to next worksheet and run find again\n        Set rngFind = .Columns(40).FindNext(rngFind)\n\n        End If\n    End With\n\nmyNext:\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 29947333, "answer_count": 2, "score": 0, "last_activity_date": 1432051213, "creation_date": 1430319017, "last_edit_date": 1432051213, "question_id": 29947244, "link": "https://stackoverflow.com/questions/29947244/how-do-i-get-vba-loop-result-to-populate-a-combobox", "title": "How do I get vba loop result to populate a combobox?", "body": "<p>Problem:  I need to search a list of worksheets in the active workbook and return the name of every worksheet that has a cell whose value matches a search input.  The names of these worksheets need to then populate a userform combobox with duplicates.</p>\n\n<p>Partial Solution:  I've been able to reverse-engineer a piece of code that does most of the above.  However, the worksheet names currently populate a msgbox with duplication.  How would I make this result populate a combobox instead?</p>\n\n<p>I've been experimenting with outputting to a collection as well as writing results to a new worksheet, but these option are still in the conceptual phase, so I have no code to post.</p>\n\n<p>UPDATE (some code):</p>\n\n<pre><code>Public Sub FindDate()\n'find date data on all sheets\n\nDim ws As Worksheet\nDim rngFind As Range\nDim myDate As String\nDim firstAddress As String\nDim addressStr As String\nDim findNum As Integer\nDim sheetArray(299) As Integer\nDim arrayIndex As Integer\n\nmyDate = InputBox(\"Enter date to find\")\n\nIf myDate = \"\" Then Exit Sub\n\nFor Each ws In ActiveWorkbook.Worksheets\n    'Do not search the following sheets\n    With ws\n        If ws.Name = \"CM Chapters\" Then GoTo myNext\n        If ws.Name = \"CM Codes\" Then GoTo myNext\n        If ws.Name = \"PCS Categories\" Then GoTo myNext\n        If ws.Name = \"PCS Chapters\" Then GoTo myNext\n        If ws.Name = \"PCS Code\" Then GoTo myNext\n\n    Set rngFind = .Columns(41).Find(what:=myDate, LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n\n        If Not rngFind Is Nothing Then\n        firstAddress = rngFind.Address\n\n    Do\n        findNum = findNum + 1\n        addressStr = addressStr &amp; .Name &amp; vbCrLf\n\n''''Original working code    \n'            addressStr = addressStr &amp; .Name &amp; \" \" &amp; rngFind.Address &amp; vbCrLf\n''''Modified to remove excess text                              \n\nSet rngFind = .Columns(41).FindNext(rngFind)\n\n    Loop While Not rngFind Is Nothing And rngFind.Address &lt;&gt; firstAddress\nEnd If\n\nmyNext:\n    End With\n\n    Next ws\n\n        If Len(addressStr) Then\n''''    Original working code\n'                MsgBox \"Found: \"\" &amp; myDate &amp; \"\" \" &amp; findNum &amp; \" times.\" &amp; vbCr &amp; _\n'                addressStr, vbOKOnly, myDate &amp; \" found in these cells\"\n''''    Modified to to remove excess text\n\n            MsgBox vbCr &amp; addressStr\n        Else:\n            MsgBox \"Unable to find \" &amp; myDate &amp; \" in this workbook.\", vbExclamation\n        End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3863303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jLhvC.png?s=128&g=1", "display_name": "Andreas Kruhlmann", "link": "https://stackoverflow.com/users/3863303/andreas-kruhlmann"}, "edited": false, "score": 0, "creation_date": 1430321655, "post_id": 29947539, "comment_id": 48017494, "body": "Thank you, I think remaking the e-mail body in HTML was the best choice. It is working as intended."}], "tags": [], "owner": {"reputation": 628, "user_id": 3271518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ae0b952fd5fb102faca04b6ab6eab773?s=128&d=identicon&r=PG&f=1", "display_name": "user3271518", "link": "https://stackoverflow.com/users/3271518/user3271518"}, "is_accepted": true, "score": 1, "last_activity_date": 1430319689, "creation_date": 1430319689, "answer_id": 29947539, "question_id": 29947205, "link": "https://stackoverflow.com/questions/29947205/how-do-i-send-a-non-http-hyperlink-in-an-email-message-generated-by-excel-macros/29947539#29947539", "title": "How do I send a non-http hyperlink in an email message generated by Excel macros?", "body": "<p>This is how I have done emails in Excel before.</p>\n\n<pre><code>Email = \"Hello, &lt;br&gt;&lt;br&gt;\" &amp; _\n                \"this is something:\" &amp; _\n                   \"&lt;br&gt;&lt;br&gt; Thank you.\" &amp; _\n                   \"&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;a href='elodms://12345'&gt;CLICK HERE&lt;/a&gt;\"\n    With OutMail\n        .To = \"you@me.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"SUBJECT\"\n        .HTMLBody = Email\n\n        .send\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1430320304, "creation_date": 1430320304, "answer_id": 29947799, "question_id": 29947205, "link": "https://stackoverflow.com/questions/29947205/how-do-i-send-a-non-http-hyperlink-in-an-email-message-generated-by-excel-macros/29947799#29947799", "title": "How do I send a non-http hyperlink in an email message generated by Excel macros?", "body": "<blockquote>\n  <p>Is it possible to force outlook to view it as a hyperlink?</p>\n</blockquote>\n\n<p>You can use the HTMLBody property of the MailItem class. It looks like you just need to insert the hyperlink to the body. To get this working you need to find the  tag and insert anywhere before the closing tag the following string:</p>\n\n<pre><code> &lt;a href=\"elodms:// followed by an ID\"&gt;link text goes here&lt;/a&gt;\n</code></pre>\n\n<blockquote>\n  <p>And can it be done through VBA Excel macros?</p>\n</blockquote>\n\n<p>Yes, it can be done from Excel. See <a href=\"https://support.microsoft.com/en-nz/kb/201096?wa=wsignin1.0\" rel=\"nofollow\">How to automate Outlook from another program</a>.</p>\n"}], "owner": {"reputation": 151, "user_id": 3863303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jLhvC.png?s=128&g=1", "display_name": "Andreas Kruhlmann", "link": "https://stackoverflow.com/users/3863303/andreas-kruhlmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 29947539, "answer_count": 2, "score": 1, "last_activity_date": 1430320304, "creation_date": 1430318945, "question_id": 29947205, "link": "https://stackoverflow.com/questions/29947205/how-do-i-send-a-non-http-hyperlink-in-an-email-message-generated-by-excel-macros", "title": "How do I send a non-http hyperlink in an email message generated by Excel macros?", "body": "<p>I am using Excel macros to send an email, where the content is kept in cells. I need to send a non-http link which looks like this</p>\n\n<p><code>elodms://</code> followed by an ID</p>\n\n<p>I'm assuming outlook doesn't know this form of link and it doesn't present it as a clickable link when the email is sent, like it does when inserting an email address. </p>\n\n<p>Is it possible to force outlook to view it as a hyperlink? And can it be done through VBA Excel macros?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 4756029, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101298604493376/picture?type=large", "display_name": "Catherine Combs", "link": "https://stackoverflow.com/users/4756029/catherine-combs"}, "edited": false, "score": 0, "creation_date": 1430399091, "post_id": 29946845, "comment_id": 48056587, "body": "Thanks, I suspected as much, but I really appreciate the confirmation!"}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1430318118, "creation_date": 1430318118, "answer_id": 29946845, "question_id": 29946694, "link": "https://stackoverflow.com/questions/29946694/macro-removal-when-submitting-documents/29946845#29946845", "title": "Macro Removal When Submitting Documents", "body": "<p>Unless they are leaving anything in your Word document, something like \"Was done via vba\" or anything like that. Then creating a new Word Document with just the text copied and pasted will not copy over the macros. </p>\n\n<p>You could use the macros to do this as well. Just have them open a new Document and copy and paste into it. Macros will not get copied over unless you create code to do it.</p>\n"}], "owner": {"reputation": 36, "user_id": 4756029, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101298604493376/picture?type=large", "display_name": "Catherine Combs", "link": "https://stackoverflow.com/users/4756029/catherine-combs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 29946845, "answer_count": 1, "score": -1, "last_activity_date": 1430321375, "creation_date": 1430317733, "last_edit_date": 1430321375, "question_id": 29946694, "link": "https://stackoverflow.com/questions/29946694/macro-removal-when-submitting-documents", "title": "Macro Removal When Submitting Documents", "body": "<p>I edit and format large proposals and recently started working with macros to speed up the process. However, occasionally my proposal submissions have to be electronic. I am worried the file may be rejected if there are macros attached. </p>\n\n<p>If I copy and paste all the text into a new Word Document after using the macros, will this remove any trace of them? All my macros are stored in a Word Template and not in normal.dot.</p>\n"}, {"tags": ["excel", "unicode", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1430317821, "post_id": 29946639, "comment_id": 48014365, "body": "There are many examples of VBA Find &amp; Replace on <code>xlPart</code> but you will want to search for <code>what:=ChrW(8479)</code> and replace with <code>replacement:=&quot;Replace&quot; &amp; Chr(10)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "edited": false, "score": 0, "creation_date": 1430319835, "post_id": 29947130, "comment_id": 48016105, "body": "Worked perfectly.  Thanks for your help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1430318749, "creation_date": 1430318749, "answer_id": 29947130, "question_id": 29946639, "link": "https://stackoverflow.com/questions/29946639/find-and-replace-a-special-unicode-character/29947130#29947130", "title": "Find and replace a special unicode character", "body": "<p>You will want to search for <code>what:=ChrW(8479)</code> and replace with <code>replacement:=\"Replace\" &amp; Chr(10)</code>.</p>\n\n<p>This quick code will make your Unichar-to-Text replacement across the active worksheet.</p>\n\n<pre><code>Sub replace_Response()\n    Dim fnd As Range\n    With ActiveSheet\n        .Cells.Replace what:=ChrW(8479), replacement:=\"Response\" &amp; Chr(10), lookat:=xlPart\n    End With\nEnd Sub\n</code></pre>\n\n<p>The range of replacements can be pared down to a column, row or any selected group of cells.</p>\n"}], "owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4518, "favorite_count": 0, "accepted_answer_id": 29947130, "answer_count": 1, "score": 1, "last_activity_date": 1430318749, "creation_date": 1430317590, "last_edit_date": 1531164843, "question_id": 29946639, "link": "https://stackoverflow.com/questions/29946639/find-and-replace-a-special-unicode-character", "title": "Find and replace a special unicode character", "body": "<p>I have a particular column that has multiple occurrences in multiple rows of a special character.  It's the \"Response\" character.  It's a capital R with a slash through it.  It's represented as Unistring 211F.  It can also be represented in HTML as &amp;#8479.</p>\n\n<p>I'd like to use VBA to search for the \"Response\" character and replace it with \"Response\" and the line feed ASC(10).</p>\n\n<p>How can I search and replace this special character?</p>\n"}, {"tags": ["vba", "vb6", "odbc", "oledb"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430318195, "post_id": 29946622, "comment_id": 48014745, "body": "When I change it that way I start getting the automation error again. Run-time error &#39;430&#39;: Class does not support Automation or does not support expected interface"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430318335, "post_id": 29946622, "comment_id": 48014858, "body": "are you running it in excel? Is it in a standard module or Class module?"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430318469, "post_id": 29946622, "comment_id": 48014975, "body": "Also do you have any references in VBA which is missing or to a certain file?"}, {"owner": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430318588, "post_id": 29946622, "comment_id": 48015079, "body": "I&#39;m running it in a standard module in excel. There are references within the excel file that point to other excel files. But for now I&#39;m just running this individual sub. It should simply pull some data from the recordset and paste it into sheet1"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430318817, "post_id": 29946622, "comment_id": 48015249, "body": "Try change &quot;sqloledb&quot; in the connection string to &quot;SQLNCLI11&quot; You may have to see if it is installed though. As it is using the SQL Server Native Client 11 to connect. Trying to replicate your problem but so far works fine on mine. WIll keep trying though"}, {"owner": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430319321, "post_id": 29946622, "comment_id": 48015640, "body": "That resolved the Automation error and I see data being copied to the sheet. Do you know what the (10) subset represented on the record set?"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "edited": false, "score": 0, "creation_date": 1430319416, "post_id": 29946622, "comment_id": 48015744, "body": "I havent seen it before and didnt actually notice it to start with. But I am guessing that it might of been an array of recordsets. Then it was trying to get the 11th element of the array into the recordset. However that could be totally wrong. Just my educated guess at this point"}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1430319205, "last_edit_date": 1430319205, "creation_date": 1430317559, "answer_id": 29946622, "question_id": 29946445, "link": "https://stackoverflow.com/questions/29946445/switching-from-odbc-to-oledb-and-getting-object-required/29946622#29946622", "title": "Switching from ODBC to OLEDB and getting &quot;Object Required&quot;", "body": "<p>From you code ReturnData is not being created or anything, unless you are declaring it to be global variable else where. I imagine you are doing this in Excel. In which case replace <code>ReturnData.Range(\"A1\").CopyFromRecordset tableRecords(10)</code>\nwith something like</p>\n\n<pre><code>activeworkbook.sheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset tableRecords(10)\n</code></pre>\n\n<p>EDIT. Managed to replicate it and then fixed it. Try this.</p>\n\n<p>replace <code>ReturnData.Range(\"A1\").CopyFromRecordset tableRecords(10)</code>\nwith something like</p>\n\n<pre><code>activeworkbook.sheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset tableRecords\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3938287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d6407e371198cfa61ffdc6e2b6c92977?s=128&d=identicon&r=PG&f=1", "display_name": "JaReg", "link": "https://stackoverflow.com/users/3938287/jareg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 29946622, "answer_count": 1, "score": 1, "last_activity_date": 1430319205, "creation_date": 1430317130, "question_id": 29946445, "link": "https://stackoverflow.com/questions/29946445/switching-from-odbc-to-oledb-and-getting-object-required", "title": "Switching from ODBC to OLEDB and getting &quot;Object Required&quot;", "body": "<p>I have been tasked with modifying some VBA code to switch from using an ODBC connection to using an OLEDB connection so we can just code a username and password into a subroutine.</p>\n\n<p>I'm certainly not experienced with this but I think I'm managed to get the proper connection string for the new OLEDB connection.</p>\n\n<p>I've tested the connection string in a standalone test sub and it worked fine.</p>\n\n<p>I'm attempting to replace the previous ODBC connection strings in the code but I'm starting to get \"Run-time error '424' Object required\"</p>\n\n<p>Here is the sub I am currently trying to get to work:</p>\n\n<pre><code>Sub getdata()\nDim tableName As String\nDim tableRecords As New ADODB.Recordset\nDim Cnxn2 As ADODB.Connection \n\ntableName = \"TABLE_NAME\"\n\nSet Cnxn2 = New ADODB.Connection\n\n'Old Connection String Using ODBC\n'Cnxn2.ConnectionString = \"Data Source='DATASOURCE';\" '&amp; \"Integrated Security = SSPI;\"\n\n'New Connection String Using OLEDB\nCnxn2.ConnectionString = \"Provider=sqloledb;Data Source=SERVER\\INSTANCE;User ID=USER;Password=PASSWORD;\"\n\nCnxn2.ConnectionTimeout = 30\nCnxn2.Open\ntableRecords.Open tableName, Cnxn2, adUseClient, adLockOptimistic, adCmdTable\n\nWith tableRecords\nReturnData.Range(\"A1\").CopyFromRecordset tableRecords(10)\n\n.Close\nEnd With\n        Cnxn2.Close\n\n        Set Cnxn2 = Nothing\n        Set tableRecords = Nothing\n    End Sub\n</code></pre>\n\n<p>The error is highlighting the line stating \"ReturnData.Range(\"A1\").CopyFromRecordset tableRecords(1)</p>\n\n<p>Why am I getting Object Required errors when I only changed the connection string?</p>\n\n<p>Note: There was a very similar sub in the code in another location and I simply deleted the \"ReturnData.\" from the previously mentioned line and it seemed to start working. If I do that here though I get this:\nRun-time error '430': Class does not support Automation or does not support expected interface</p>\n\n<p>Any help into why switching to OLEDB is breaking this sub is much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1430316135, "post_id": 29945872, "comment_id": 48012909, "body": "Replace <code>oApp.Workbooks.Close</code> with <code>wb.close</code>. You can also use <code>oApp.Quit</code> to quit the excel application."}], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1430317730, "creation_date": 1430317730, "answer_id": 29946692, "question_id": 29945872, "link": "https://stackoverflow.com/questions/29945872/vba-need-to-close-window-only-can-close-workbook/29946692#29946692", "title": "VBA: need to close window, only can close workbook", "body": "<p>You are only closing the workbook in your code.</p>\n\n<pre><code>oApp.Workbooks.Close\n</code></pre>\n\n<p>Will just close the workbook and leave the window open.</p>\n\n<p>Add <code>oApp.quit</code> after closing the workbook</p>\n"}], "owner": {"reputation": 33, "user_id": 4837976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ffed00fe09b88186698d1c5ffd3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Lind", "link": "https://stackoverflow.com/users/4837976/lind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 0, "accepted_answer_id": 29946692, "answer_count": 1, "score": 3, "last_activity_date": 1430317730, "creation_date": 1430315702, "question_id": 29945872, "link": "https://stackoverflow.com/questions/29945872/vba-need-to-close-window-only-can-close-workbook", "title": "VBA: need to close window, only can close workbook", "body": "<p>I've set up some VBA to filter a specific type of file and return the filtered data (with only 3 columns shown) in a new worksheet. I have two buttons in that worksheet - one to simply select the file path, and the other to run the filter on the file in that path (which is in cell F7). </p>\n\n<p>My issue is that I haven't been able to read the selected file without opening it. This is fine, since it's a very quick process, but my command to close that file only closes the workbook, and it leaves an empty Excel window open. The only workbook I want open it the one where I'm executing the commands, which is also the one where the filtered results paste to. Any suggestions? I'm fine with figuring out a way to get that window to close, or execute this process without that window actually needing to open in the first place (this would be ideal). </p>\n\n<pre><code>Public Sub CommandButton2_Click()\nb = Application.GetOpenFilename()\n\nIf b = False Then\n    MsgBox (\" You have not selected a file!\")\nElse\n    ThisWorkbook.Worksheets(\"SelectUpdateFile\").Cells(7, 6).Value = b\n    MsgBox (\"Your file has been selected. Click the Filter button below to generate MOVED nodes.\")\n\n\nEnd If\n\nEnd Sub\n\nSub AutoFilter()\n    Dim s As String\n    Dim oApp As Object\n    Dim wb As Object\n    Dim ws As Object\n\n\n    Set oApp = CreateObject(\"Excel.Application\")\n    oApp.Visible = True\n\n\n    On Error Resume Next\n\n    Set wb = oApp.Workbooks.Open(Filename:=Cells(7, 6))\n\n    On Error GoTo 0\n\n\n    If Not wb Is Nothing Then\n        'specify worksheet name\n        Set ws = wb.Worksheets(1)\n        s = \"AB\"\n        With ws\n            'disable all previous filters\n            .AutoFilterMode = False\n            'apply new filter\n            .Range(\"$A$2:$K$100000\").AutoFilter Field:=1, Criteria1:=\"=*MOVE*\", _\n            Operator:=xlAnd\n            .Range(\"$A$2:$K$100000\").AutoFilter Field:=7, Criteria1:=\"=*%3e*\", _\n        Operator:=xlAnd\n        'Copy\n            .Range(\"a2:a100000\").Copy\n            Sheets(\"MovedNodes\").Range(\"a1\").PasteSpecial xlPasteValues\n\n            .Range(\"b2:b100000\").Copy\n            Sheets(\"MovedNodes\").Range(\"b1\").PasteSpecial xlPasteValues\n\n            .Range(\"g2:g100000\").Copy\n            Sheets(\"MovedNodes\").Range(\"c1\").PasteSpecial xlPasteValues\n            'Paste to Sheet2\n\n            End With\n\n\nEnd If\noApp.DisplayAlerts = False\noApp.Workbooks.Close\n    MsgBox (\"Done! Click OK to view the moved nodes.\")\n\nApplication.ScreenUpdating = True\nSheets(\"MovedNodes\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 6481, "user_id": 848841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e26d050149199473393bafed79491d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Subramanian", "link": "https://stackoverflow.com/users/848841/vignesh-subramanian"}, "is_accepted": false, "score": 0, "last_activity_date": 1430316102, "creation_date": 1430316102, "answer_id": 29946051, "question_id": 29945701, "link": "https://stackoverflow.com/questions/29945701/cell-value-change-not-getting-captured-in-vba-macro/29946051#29946051", "title": "cell value change not getting captured in vba macro", "body": "<p>I found out the reason</p>\n\n<p>I placed the macro in wrong place i.e in a different module</p>\n\n<p>For the <code>Private Sub Worksheet_Change</code> to work, \nwe need to place it in the sheet which needs that detection\nI followed the below steps</p>\n\n<ol>\n<li>We need to go to Excel VBA editor by pressing ALT + F11</li>\n<li>Double click on sheet which contains our target cell e.g. Sheet1</li>\n<li>Add the below code to the sheet</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": true, "score": 1, "last_activity_date": 1430316284, "creation_date": 1430316284, "answer_id": 29946125, "question_id": 29945701, "link": "https://stackoverflow.com/questions/29945701/cell-value-change-not-getting-captured-in-vba-macro/29946125#29946125", "title": "cell value change not getting captured in vba macro", "body": "<p><code>Worksheet_Change</code> takes a single parameter <code>Target</code> of type <code>Range</code>.  To check if you have changed the range you are interested in you can compare the target to that range, in your case:</p>\n\n<pre><code>If Target = Range(\"A2\") Then\n    'Do something\nEnd If\n</code></pre>\n\n<p>This lets you compare a <code>Range</code> object with another <code>Range</code> object with minimal fuss.</p>\n\n<p>And also put it in the correct sheet.... :P</p>\n"}], "owner": {"reputation": 6481, "user_id": 848841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e26d050149199473393bafed79491d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Subramanian", "link": "https://stackoverflow.com/users/848841/vignesh-subramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 29946125, "answer_count": 2, "score": 0, "last_activity_date": 1430316284, "creation_date": 1430315250, "last_edit_date": 1430316193, "question_id": 29945701, "link": "https://stackoverflow.com/questions/29945701/cell-value-change-not-getting-captured-in-vba-macro", "title": "cell value change not getting captured in vba macro", "body": "<p>I want to capture when value changes in the cell <code>A2</code> </p>\n\n<p>I tried the below code but it is not working</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"H5\")) Is Nothing Then Macro\nEnd Sub\n</code></pre>\n\n<p>I have a breakpoint inside the macro but its not coming till there\nI also tried the below, but no luck</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    MsgBox (Target.Column)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430323449, "post_id": 29945170, "comment_id": 48018755, "body": "It seems like this clears the changes from the word. Is there more to the code? You might consider using the Compare Documents feature, which can be set to show changes at the word level rather than the character level."}, {"owner": {"reputation": 575, "user_id": 1387277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e0f41202b0b832417538ccb2d4e9f71c?s=128&d=identicon&r=PG", "display_name": "RSinohara", "link": "https://stackoverflow.com/users/1387277/rsinohara"}, "reply_to_user": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430329279, "post_id": 29945170, "comment_id": 48022463, "body": "No, that is the code. When a word has, lets say, 1 revised letter (one red letter according to display options), I want to make it all revised (red). So here I am replacing the whole word. That does the trick but makes the next word have a revision, even if it had none before. So the sentence gets revised until the end (not my intention).  I&#39;m not sure comparing documents would help."}, {"owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430335170, "post_id": 29945170, "comment_id": 48026095, "body": "Oh, I get it, you&#39;re turning on Track Changes first."}, {"owner": {"reputation": 575, "user_id": 1387277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e0f41202b0b832417538ccb2d4e9f71c?s=128&d=identicon&r=PG", "display_name": "RSinohara", "link": "https://stackoverflow.com/users/1387277/rsinohara"}, "reply_to_user": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1430335336, "post_id": 29945170, "comment_id": 48026211, "body": "Well, revisor are required to track changes. i&#39;m just working on processing them for QA forms."}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 1387277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e0f41202b0b832417538ccb2d4e9f71c?s=128&d=identicon&r=PG", "display_name": "RSinohara", "link": "https://stackoverflow.com/users/1387277/rsinohara"}, "edited": false, "score": 0, "creation_date": 1430333400, "post_id": 29952086, "comment_id": 48025027, "body": "I still think there is a better way to do it. If anyone can provide one, I&#39;ll accpept that answer. Include this in such answer if your answer only offers another strategy, as this here will fix the code I provided on the question."}], "tags": [], "owner": {"reputation": 575, "user_id": 1387277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e0f41202b0b832417538ccb2d4e9f71c?s=128&d=identicon&r=PG", "display_name": "RSinohara", "link": "https://stackoverflow.com/users/1387277/rsinohara"}, "is_accepted": true, "score": 0, "last_activity_date": 1430333714, "last_edit_date": 1430333714, "creation_date": 1430333360, "answer_id": 29952086, "question_id": 29945170, "link": "https://stackoverflow.com/questions/29945170/vba-word-extend-revision-to-the-whole-word/29952086#29952086", "title": "VBA-Word Extend Revision to the whole word", "body": "<p>I found a solution. One word flagged as revision were flagging the next one as revision because they include the trailing whiteaspace. I just shortened the range in this case, and now it works:</p>\n\n<pre><code>Dim wrdRange As Range\nFor Each wrd In ThisDocument.Words\n    Set wrdRange = wrd\n    If wrdRange.Revisions.Count &lt;&gt; 0 Then\n        If Mid(wrdRange.Text, Len(wrdRange.Text)) = \" \" Then\n            wrdRange.End = wrdRange.End - 1\n        End If\n\n        wrdRange.Text = wrdRange.Text\n    End If\nNext wrd\n</code></pre>\n\n<p>I'm not sure yet if this is reliable. I have the feeling that some situations might crash resizing the ranges as I did. I'll know once I run it on production. I will fix/comment here.</p>\n"}], "owner": {"reputation": 575, "user_id": 1387277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e0f41202b0b832417538ccb2d4e9f71c?s=128&d=identicon&r=PG", "display_name": "RSinohara", "link": "https://stackoverflow.com/users/1387277/rsinohara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 29952086, "answer_count": 1, "score": 0, "last_activity_date": 1430335395, "creation_date": 1430313935, "last_edit_date": 1430335395, "question_id": 29945170, "link": "https://stackoverflow.com/questions/29945170/vba-word-extend-revision-to-the-whole-word", "title": "VBA-Word Extend Revision to the whole word", "body": "<p>I'm analyzing revised documents. They all have change tracking enabled, and contain many revisions.</p>\n\n<p>These documents are required to have revision on the whole word, not part of it. As this revisions are used for QA, I cannot as well flag as revised any words that were not revised.\nSo I must make words that have revised letters into words fully revised, but cannot touch other words.</p>\n\n<p>I want to automate this. I figured I could do this:</p>\n\n<pre><code>dim wrdRange as Range\nFor Each wrd In ThisDocument.Words\n    Set wrdRange = wrd\n    If wrdRange.Revisions.Count &lt;&gt; 0 Then\n        wrdRange.Text = wrdRange.Text\n    End If\nNext wrd\n</code></pre>\n\n<p>It's working half way, but every time it encounters a revised word (partially or fully), it will make avery other word revised (there will be a revision count of 1 on them).</p>\n\n<p>So the question is how can I fix this.</p>\n\n<p>Also, I'm not at all sure this is the best way to perform the task. I feel like it isn't. If anyone can offer another direction, I'll gladly follow it (I do not like my approach - specially iterating through every word).</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 1, "creation_date": 1430312983, "post_id": 29944696, "comment_id": 48010207, "body": "I&#39;m confused; you check for the null path (<code>If fPath = vbNullString Then GoTo ErrorHandler</code>) before you assign the variable (<code>fPath = &quot;\\\\c\\s\\CAF1\\Dragon Mentor Group\\Dragon Scripts\\Current\\April 2015\\&quot;</code>).  Shouldn&#39;t those lines be swapped?  Also, you need an <code>Exit Sub</code> before the error handler, otherwise you&#39;ll always hit it after updating the list."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1430313222, "post_id": 29944696, "comment_id": 48010410, "body": "Your <code>If fPath = vbNullString Then GoTo ErrorHandler</code> is only checked once at that line. It doesn&#39;t continue to check if <code>fpath</code> is null throughout the execution of the code that follows it. It`s like saying &quot;If fpath is null at this very moment in the execution of this script, then goto label &#39;ErrorHandler&#39; otherwise continue on with the script&quot;"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "reply_to_user": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1430313232, "post_id": 29944696, "comment_id": 48010419, "body": "Hi @LittleBobbyTables, thank you for taking the time for replying. It is very possible that these lines are incorrect. I must admit, this is somehting that is a little new to me, so I&#39;m trying to work this out as I go along. Kind Regards. Chris"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1430313338, "post_id": 29944696, "comment_id": 48010508, "body": "I think you are getting this confused with a line like <code>On Error Goto ErrorHandler</code> which switches VBA&#39;s internal error handling to go to your label instead of just erroring out and ending the script. The difference is between <code>ON ERROR...</code> and <code>IF &lt;condition&gt;</code> The first changes how VBA executes, the second just tests for the <code>&lt;condition&gt;</code> at that line and continues on."}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1430313370, "post_id": 29944696, "comment_id": 48010541, "body": "I agree with swapping the lines around. The other thing is, the if statement only checks if the filepath supplied is null or not. This is not the same as checking whether the folder exists or not. you can use something like <code>If Not Dir(fpath, vbDirectory) = vbNullString Then</code>"}, {"owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "edited": false, "score": 0, "creation_date": 1430313500, "post_id": 29944696, "comment_id": 48010662, "body": "All, thank you for your comments. I&#39;ve updated my code as shown in my original post. The problem I have that the rest of the code is still running because I see the iMessage shown at the end of my script and I now &#39;Resume Next&#39; error? Kind regards"}, {"owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "edited": false, "score": 0, "creation_date": 1430319746, "post_id": 29944696, "comment_id": 48016033, "body": "Try adding a label after your error handling code block like <code>SKIP_ERR_HANDLING:</code> then end the sub and just before the error handling block put a <code>Go To SKIP_ERR_HANDLING</code>. Right now your code runs into the error handling block even when there are no errors (after it has executed all of the previous code)."}], "answers": [{"tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": false, "score": 0, "last_activity_date": 1430319126, "creation_date": 1430319126, "answer_id": 29947298, "question_id": 29944696, "link": "https://stackoverflow.com/questions/29944696/vba-error-handling-to-check-for-folder-existence/29947298#29947298", "title": "VBA Error Handling to check for folder existence", "body": "<p>I would tackle it like this</p>\n\n<pre><code>On Error GoTo ErrorHandler\n    fPath = \"\\\\c\\s\\CAF1\\Dragon Mentor Group\\Dragon Scripts\\Current\\April 2015\\\"\n\n    If Dir(fPath) &lt;&gt; \"\" Then\n    End If\n\nSet FSO = New Scripting.FileSystemObject\n        frm.prgStatus.Value = 15\n        If FSO.........\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "is_accepted": true, "score": 1, "last_activity_date": 1430388227, "creation_date": 1430388227, "answer_id": 29964757, "question_id": 29944696, "link": "https://stackoverflow.com/questions/29944696/vba-error-handling-to-check-for-folder-existence/29964757#29964757", "title": "VBA Error Handling to check for folder existence", "body": "<p>All, thank you for your help and guidance. I just wanted to let you know that with help from a work colleague, I've come up with the code as shown below. Many thanks and kind regards. Chris</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Dim j As Integer\n    Dim fPath As String\n\n    On Error GoTo errHandler:\n'Display the splash form non-modally.\n    Set frm = New frmSplash\n    With frm\n        .TaskDone = False\n        .prgStatus.Value = 0\n        .StartUpPosition = 0\n        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n        .Show False\n    End With\n\n    For j = 1 To 1000\n        DoEvents\n        Next j\n\n        iRow = 17\n        fPath = \"\\\\c\\s\\CAF1\\Dragon Mentor Group\\Dragon Scripts\\Current\\\"\n        If Dir(fPath) = \"\" Then\n            Set FSO = New Scripting.FileSystemObject\n            If FSO.FolderExists(fPath) = False Then\n'' Code will run here if folder does not exist\n                GoTo errHandler\n            Else\n                Set SourceFolder = FSO.GetFolder(fPath)\n                IsSubFolder = True\n                Call DeleteRows\n''''''''\n'' Get the max number of files in all the folders and subfolders\n''''''''\n                xCur = 1 'set start value for xCur here as will reset when recurssively calling ListFilesInFolder\n                xMax = SourceFolder.Files.Count\n                For Each SubFolder In SourceFolder.SubFolders\n                    xMax = xMax + SubFolder.Files.Count\n                    Next SubFolder\n''\n                    Call ListFilesInFolder(SourceFolder, IsSubFolder)\n''\n                    Call FormatCells\n                End If\n            End If\n\n            frm.TaskDone = True\n            Unload frm\n'The row below creates a 'On Screen' message telling the user that the workbook has been built.\n            MsgBox \"The list has now been been updated!\"\n            Exit Sub\n''\nerrHandler:\n            frm.TaskDone = True\n            Unload frm\n            MsgBox \"The file path doesn't exist, please contact the administrator\", , \"File Path Error\"\n''\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 1218, "user_id": 794000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5971a89ddf93af266741f99c66f5a4d6?s=128&d=identicon&r=PG", "display_name": "IRHM", "link": "https://stackoverflow.com/users/794000/irhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2071, "favorite_count": 0, "accepted_answer_id": 29964757, "answer_count": 2, "score": 0, "last_activity_date": 1430388227, "creation_date": 1430312805, "last_edit_date": 1531164843, "question_id": 29944696, "link": "https://stackoverflow.com/questions/29944696/vba-error-handling-to-check-for-folder-existence", "title": "VBA Error Handling to check for folder existence", "body": "<p>I'm trying to implement some 'Error Handling' into an existing script and I've put together the following:</p>\n\n<p><strong>Edited Code</strong></p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim j As Integer\n\nApplication.ScreenUpdating = False\n'Display the splash form non-modally.\nSet frm = New frmSplash\nWith frm\n    .TaskDone = False\n    .prgStatus.Value = 0\n    .StartUpPosition = 0\n    .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n    .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n    .Show False\nEnd With\n\nFor j = 1 To 1000\n    DoEvents\n    Next j\n\n    iRow = 17\n\n\n    fPath = \"\\\\c\\s\\CAF1\\Dragon Mentor Group\\Dragon Scripts\\Current\\April 2015\\\"\n    If fPath = vbNullString Then GoTo ErrorHandler\n    If Not Dir(fPath, vbDirectory) = vbNullString Then\n        On Error GoTo 0\n        Set FSO = New Scripting.FileSystemObject\n        frm.prgStatus.Value = 15\n        If FSO.FolderExists(fPath) &lt;&gt; False Then\n            frm.prgStatus.Value = 30\n            Set SourceFolder = FSO.GetFolder(fPath)\n            IsSubFolder = True\n            frm.prgStatus.Value = 45\n            Call DeleteRows\n            frm.prgStatus.Value = 60\n                Call ListFilesInFolder(SourceFolder, IsSubFolder)\n                frm.prgStatus.Value = 75\n            Call FormatCells\n            frm.prgStatus.Value = 100\n            Else\n        End If\n    End If\n    frm.TaskDone = True\n    Unload frm\n    iMessage = MsgBox(\"The list has now been been updated!\", vbOKOnly)\n\n    '******Error Handling******\n    ErrorHandler:\n          MsgBox \"The filepath does not exist, please contact the       administrator\"\n    Resume Next\n    End Sub\n</code></pre>\n\n<p>In the error handling, I'm trying to check whether the folder exists. If it doesn't, instigate the error message. If it does, run the rest of the script.</p>\n\n<p>The problem is that, even when the file path does exist, the error handler is activated but I'm not sure why despite looking at quite a number of tutorials.</p>\n\n<p>I just wondered whether someone could look at this please and let me know where I've gone wrong.</p>\n"}, {"tags": ["vba", "checkbox", "pivot-table"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430313320, "post_id": 29944227, "comment_id": 48010492, "body": "If you want to get rid of the cannot insert object error look at <a href=\"https://support.microsoft.com/en-gb/kb/3025036\" rel=\"nofollow noreferrer\">support.microsoft.com/en-gb/kb/3025036</a> it will show you how to fix it"}, {"owner": {"reputation": 732, "user_id": 4815601, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7AqQI.png?s=128&g=1", "display_name": "Mateusz Konopelski", "link": "https://stackoverflow.com/users/4815601/mateusz-konopelski"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430313763, "post_id": 29944227, "comment_id": 48010892, "body": "Dear Sam, unfortunately I am not allowed to install any fix and I need to wait until it will be done on corporate level."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430314320, "post_id": 29944227, "comment_id": 48011331, "body": "There is a manual desciption of what to do on that link. It involves closes all instances of excel and deleting certain files in temp folders and app data"}, {"owner": {"reputation": 732, "user_id": 4815601, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7AqQI.png?s=128&g=1", "display_name": "Mateusz Konopelski", "link": "https://stackoverflow.com/users/4815601/mateusz-konopelski"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430318199, "post_id": 29944227, "comment_id": 48014749, "body": "I just asked my boss and he didn&#39;t let me to do that. anyway, my initial question is still same. I am also working on it so maybe I will be able to do by myself."}], "answers": [{"tags": [], "owner": {"reputation": 732, "user_id": 4815601, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7AqQI.png?s=128&g=1", "display_name": "Mateusz Konopelski", "link": "https://stackoverflow.com/users/4815601/mateusz-konopelski"}, "is_accepted": false, "score": 1, "last_activity_date": 1430324478, "last_edit_date": 1430324478, "creation_date": 1430323788, "answer_id": 29949112, "question_id": 29944227, "link": "https://stackoverflow.com/questions/29944227/vba-multiple-checkboxes-to-control-multiple-pivot-tables/29949112#29949112", "title": "VBA multiple checkboxes to control multiple pivot tables", "body": "<p>I worked on it and found such a solution:</p>\n\n<pre><code>Sub checkbox1()\nDim choice1, choice2, choice3, choice4, choice5, choice6, choice7\nDim oPI As PivotItem\nDim pt As PivotTable, wks As Worksheet\n\nIf Sheets(\"Hidden\").Range(\"B6\").Value = \"True\" Then\n    choice1 = \"Definite\"\nEnd If\nIf Sheets(\"Hidden\").Range(\"B7\").Value = \"True\" Then\n    choice2 = \"Tentative\"\nEnd If\nIf Sheets(\"Hidden\").Range(\"B8\").Value = \"True\" Then\n    choice3 = \"Hold/Option\"\nEnd If\nIf Sheets(\"Hidden\").Range(\"B9\").Value = \"True\" Then\n    choice4 = \"Pending\"\nEnd If\nIf Sheets(\"Hidden\").Range(\"B10\").Value = \"True\" Then\n    choice5 = \"Waitlist\"\nIf Sheets(\"Hidden\").Range(\"B11\").Value = \"True\" Then\n    choice6 = \"Lost\"\nEnd If\nIf Sheets(\"Hidden\").Range(\"B12\").Value = \"True\" Then\n    choice7 = \"Cancelled\"\nEnd If\nSheets(\"Hidden_pivot1\").PivotTables(\"Hidden_1\").PivotFields(\"SalesStatus\").ClearAllFilters\nSheets(\"Hidden_pivot1\").PivotTables(\"Hidden_3\").PivotFields(\"SalesStatus\").ClearAllFilters\nSheets(\"Hidden_pivot2\").PivotTables(\"Hidden_2\").PivotFields(\"SalesStatus\").ClearAllFilters\nSheets(\"Hidden_pivot2\").PivotTables(\"Hidden_4\").PivotFields(\"SalesStatus\").ClearAllFilters\n\nFor Each wks In ActiveWorkbook.Worksheets\n    For Each pt In wks.PivotTables\n             With pt\n                If .Name = \"Hidden_1\" Or .Name = \"Hidden_2\" Or .Name = \"Hidden_3\" Or .Name = \"Hidden_4\" Then\n                    For Each oPI In pt.PivotFields(\"SalesStatus\").PivotItems\n                        Select Case oPI.Name\n                                 Case choice1, choice2, choice3, choice4, choice5, choice6, choice7\n                                 Case Else\n                                oPI.Visible = False\n                        End Select\n                    Next\n                End If\n            End With\n     Next pt\nNext wks\nEnd Sub\n</code></pre>\n\n<p>This work but is so slow. It would be better if the macro could add and delete those items, instead of re-creating the entire choice.</p>\n"}], "owner": {"reputation": 732, "user_id": 4815601, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7AqQI.png?s=128&g=1", "display_name": "Mateusz Konopelski", "link": "https://stackoverflow.com/users/4815601/mateusz-konopelski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1430324478, "creation_date": 1430311723, "question_id": 29944227, "link": "https://stackoverflow.com/questions/29944227/vba-multiple-checkboxes-to-control-multiple-pivot-tables", "title": "VBA multiple checkboxes to control multiple pivot tables", "body": "<p>again I need little help which I will greatly appreciate. </p>\n\n<p>Basically, on my dashboard page I have couple of checkboxes that control numerous of pivot tables in the background. </p>\n\n<p>I have checkboxes that are called \"definite\", \"tentative\", \"pending,\", ... and also corresponds to values in pivot fields.</p>\n\n<p>and I have numerous of pivot tables called: \"Hidden_1\" or \"Hidden_2\" in different sheets but all with the same structure. </p>\n\n<p>My idea was that If someone checked \"definite\", it will be selected in all pivot pivot tables in fields called \"Status\". If someone \"unchecked\" this checkbox, the pivots will react.</p>\n\n<p>To do so I used a code that I create before and it was working well:</p>\n\n<pre><code>    Sub checkbox1()\nApplication.ScreenUpdating = False\nOn Error Resume Next  \nDim pt As PivotTable, wks As Worksheet\nFor Each wks In ActiveWorkbook.Worksheets\n    For Each pt In wks.PivotTables\n        With pt\n            If .Name = \"Hidden_1\" Or .Name = \"Hidden_2\" Then\n                .PivotFields(\"Status\").CurrentPage = \"definite\"\n            End If\n        End With\n    Next pt\nNext wks \nApplication.ScreenUpdating = True \nEnd Sub\n</code></pre>\n\n<p>However, this code selects only one value, so I can't have selected both \"definite\" and \"pending\" if someone checked those boxes. Right now all checkboxes has a separate code assigned where only .CurrentPage = \"checkboxname\" was changed..</p>\n\n<p>I have two questions:</p>\n\n<p>1) what is the best way to select multiple values. E.g. if checked boxes \"definite\" and \"pending\" are checked, pivot tables should have selected two values \"definite\" and \"pending\" selected in the \"Status\" field</p>\n\n<p>2) what is the best way to \"dis-select\" the value? Right now, my procedure checkbox1 is running everytime that the checkbox is clicked. And I want it to run only when I am \"checking\" it. \nRight now I am trying to link the checkbox with cell, e.g. \"definite\" has H10, so my code starts with the line:</p>\n\n<pre><code>If Range(\"H10\").Value = True Then\n'code to select the value in \"Status\" field\nElse\n'code to unselect the value in \"Status\" field\nEnd If\n</code></pre>\n\n<p>I should also noted that I couldn't use ActiveX Checkbox because I had error: \"cannot insert object\" and I used form controls. I read that this error is somehow connected with a patch that I have installed. </p>\n\n<p>Thank you all for your help,\nMatt</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 4, "creation_date": 1430311343, "post_id": 29944029, "comment_id": 48008861, "body": "Welcome to SO! <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask a good question</a> will be a great place for you to start. Significantly, this isn&#39;t a code-writing service, so you&#39;ll need to give it a shot, then we&#39;ll be more than happy to help you fix what you&#39;ve got."}, {"owner": {"reputation": 223, "user_id": 4846344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b68420bc412b2dedee19883a66190a2?s=128&d=identicon&r=PG&f=1", "display_name": "Bertsector", "link": "https://stackoverflow.com/users/4846344/bertsector"}, "edited": false, "score": 0, "creation_date": 1430311594, "post_id": 29944029, "comment_id": 48009081, "body": "I&#39;ve tried with a .Find wasn&#39;t successful, I&#39;ve looked up everywhere and just can&#39;t seem to get what I need done"}, {"owner": {"reputation": 223, "user_id": 4846344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b68420bc412b2dedee19883a66190a2?s=128&d=identicon&r=PG&f=1", "display_name": "Bertsector", "link": "https://stackoverflow.com/users/4846344/bertsector"}, "edited": false, "score": 0, "creation_date": 1430312235, "post_id": 29944029, "comment_id": 48009579, "body": "Maybe something like this I would assume: Dim ws As Worksheet  If ws.Range(&quot;N3:WI900&quot;).Value = 1 Then ActiveCell.Select Selction.Copy  Set r = ws.Rows(L)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1430313025, "post_id": 29944029, "comment_id": 48010237, "body": "Please see: <a href=\"http://stackoverflow.com/questions/28679758/trying-to-concatenate-top-row-cells-if-column-below-has-1-in-excel-2013/28680713#28680713\">Concatenate top row cells if column below has 1</a>"}, {"owner": {"reputation": 223, "user_id": 4846344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b68420bc412b2dedee19883a66190a2?s=128&d=identicon&r=PG&f=1", "display_name": "Bertsector", "link": "https://stackoverflow.com/users/4846344/bertsector"}, "edited": false, "score": 0, "creation_date": 1430313657, "post_id": 29944029, "comment_id": 48010819, "body": "@Jeeped Thanks for your quick reply! that worked perfectly!"}], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "is_accepted": false, "score": 1, "last_activity_date": 1446549538, "creation_date": 1446549538, "answer_id": 33497811, "question_id": 29944029, "link": "https://stackoverflow.com/questions/29944029/excel-vba-find-data-that-is-not-equal-to-0-and-copy-row-header/33497811#33497811", "title": "Excel VBA Find data that is not equal to 0 and copy Row header", "body": "<p>Do it old school like this \u2193\u2193\u2193 or use range.findnext(previousfind)    </p>\n\n<pre><code>Sub FruitSorter()\n        Dim xrow As Long\n        Dim xcolumn As Long\n        Dim lastcolumn As Long\n        'dont forget to use cleaner - (desired)range.ClearContents before running this\n        xrow = 4 'seen in example edit this\n        xcolumn = 1 'seen in example edit this\n        lastcolumn = 4 'your last column where you want the fruit to be written into\n\n        Do 'loop for rows\n            Do 'loop for columns\n                Select Case Cells(xrow, xcolumn).Value 'checks if cell contains 1\n                    Case 1 'if one do below\n                        If Cells(xrow, lastcolumn) = \"\" Then 'if it is first time the cell is modified then\n                            Cells(xrow, lastcolumn) = Cells(3, xcolumn).Value 'write data\n                        Else 'if the cell already contains fruit then\n                            Cells(xrow, lastcolumn) = Cells(xrow, lastcolumn) &amp; \", \" &amp; Cells(3, xcolumn).Value 'insert value thet already is in the cell plus the new one\n                        End If\n                    Case 0 'nothing happens\n                End Select\n                xrow = xrow + 1 'move one row forward\n            Loop Until Cells(xrow, xcolumn) = \"\" 'will loop until cell under your table is empty you can set any other specified condition like row number(until xrow=200)\n            xcolumn = xcolumn + 1  'move one column forward\n            xrow = 4 'move back to the beginning\n        Loop Until xcolumn = lastcolumn 'will loop until xcolumn reaches the last column where fruit is being written\n    End Sub\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 223, "user_id": 4846344, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2b68420bc412b2dedee19883a66190a2?s=128&d=identicon&r=PG&f=1", "display_name": "Bertsector", "link": "https://stackoverflow.com/users/4846344/bertsector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1516, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1446549538, "creation_date": 1430311213, "last_edit_date": 1430311461, "question_id": 29944029, "link": "https://stackoverflow.com/questions/29944029/excel-vba-find-data-that-is-not-equal-to-0-and-copy-row-header", "title": "Excel VBA Find data that is not equal to 0 and copy Row header", "body": "<p>I have a spreadsheet that I would need to create a macro for and I need you guys help.</p>\n\n<p>The big picture, I want to find a cell in a range that is not equal to 0 (Its either 0 or 1 in that cell range) \nAnd copy the title of that column and paste it in the L Cell of the same row it found the 1.</p>\n\n<p>So it goes like this:</p>\n\n<p>Row N2 to WI2 has the titles of the columns,\nRange N3 to WI9000 is the location of the cells with either 1 or 0 --- 1 if the value exist and 0 if its not found</p>\n\n<p>EX:</p>\n\n<pre><code>3   Apples Bananas Tomatoes\n4        1       1        0\n5        0       0        1\n6        1       0        0\n</code></pre>\n\n<p>And when it sees the 1's or not equal to 0:</p>\n\n<ul>\n<li>Number 4 in Cell L4 would output like this (Apples, Bananas)</li>\n<li>Number 5 in Cell L5 would output like this (Tomatoes)</li>\n<li>Number 6 in Cell L6 would output like this (Apples)</li>\n</ul>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430311051, "post_id": 29943795, "comment_id": 48008628, "body": "1) add a screen shot of your <code>Data</code> worksheet. (Blank out actual values, leaving just column headers, if the information is sensitive).  2) What do you mean by <i>it is not showing the last column(&quot;Days late&quot;) in the Field list</i>? Maybe show a screen shot of that, too."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1430335358, "post_id": 29943991, "comment_id": 48026220, "body": "So I tried this, but before I tried, I thought that the order has nothing to do with it, since the data that should be the source of pivot is not showing Days Late as one of the fields, so the order won&#39;t matter anyways. Am I thinking right?"}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1430380626, "post_id": 29943991, "comment_id": 48044486, "body": "I&#39;m not too good at reading R1C1 style references, but I think the source of that particular issue is that its stopping at column 16, so you&#39;d need to tweak it to &quot;Data!R1C1:R1000C17&quot;  Alternatively, you could write it as &#39;SourceData:=Range(&quot;A1:Q1000&quot;) - but if the sheet changes dynamically, you could count rows etc."}, {"owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "edited": false, "score": 0, "creation_date": 1430480672, "post_id": 29943991, "comment_id": 48091629, "body": "you are absolutely right, that is exactly what is happening. I have modified it and it works fine. I cannot believe it was such a small mistake that I had overlooked, but I guess it happens. :)"}], "tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": false, "score": 0, "last_activity_date": 1430311093, "creation_date": 1430311093, "answer_id": 29943991, "question_id": 29943795, "link": "https://stackoverflow.com/questions/29943795/pivot-table-creation-has-an-unusual-activity-when-done-manually-vs-vba/29943991#29943991", "title": "Pivot table creation has an unusual activity when done manually vs. VBA", "body": "<p>This is an issue I have come across before and is caused by the order of the events. When the macro recorder does its thing - its very literal, and that's why it doesn't work when it 'plays it back'</p>\n\n<p>I would look at re-ordering the events (the with statements) to see if this helps</p>\n"}], "owner": {"reputation": 27, "user_id": 4734825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153181645727878/picture?type=large", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/4734825/ankit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430313181, "creation_date": 1430310576, "last_edit_date": 1531164843, "question_id": 29943795, "link": "https://stackoverflow.com/questions/29943795/pivot-table-creation-has-an-unusual-activity-when-done-manually-vs-vba", "title": "Pivot table creation has an unusual activity when done manually vs. VBA", "body": "<p>Okay, so I recorded a macro to create a pivot table. The problem is very simple and is very annoying. I am selecting(using vba) all my columns and rows with data in them on one sheet named \"Data\" and making pivot table on another sheet named \"Pivot\". But when I run the macro, it is not showing the last column(\"Days late\") in the Field list, whereas when I select the same thing manually and insert a pivot table, it shows all the fields.\nWhat could I be doing wrong with such a simple step, I have no idea?</p>\n\n<pre><code>Sheets(\"Pivot\").Select\n\nRange(\"A:R\").Delete\n\nSheets(\"Data\").Select\n\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Data!R1C1:R1000C16\", Version:=xlPivotTableVersion15).CreatePivotTable _\n    TableDestination:=\"Pivot!R2C1\", TableName:=\"PivotTable1\", DefaultVersion _\n    :=xlPivotTableVersion15\n\nSheets(\"Pivot\").Select\nCells(1, 1).Select\n\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Vendor Name\")\n\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Planner\")\n    .Orientation = xlRowField\n    .Position = 2\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Part Number\")\n    .Orientation = xlRowField\n    .Position = 3\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Reason Code\")\n    .Orientation = xlRowField\n    .Position = 4\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Comments\")\n    .Orientation = xlRowField\n    .Position = 5\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Quantity Outstanding\")\n    .Orientation = xlRowField\n    .Position = 6\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Need By Date\")\n    .Orientation = xlRowField\n    .Position = 7\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Days Late\")\n    .Orientation = xlRowField\n    .Position = 8\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Release Number\")\n    .Orientation = xlRowField\n    .Position = 9\nEnd With\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/2AnCs.png\" alt=\"Data Sheet\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/DaD0w.png\" alt=\"Pivot Fields List\"></p>\n"}, {"tags": ["excel", "vba", "file"], "comments": [{"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "edited": false, "score": 0, "creation_date": 1430314029, "post_id": 29943606, "comment_id": 48011099, "body": "It was shoing errors in the line Set         myfile = appxl.Windows(vFile)       but now with the new code below its working perfectly."}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 3952630, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56c03a6ca7cf5183653132c118cf40a6?s=128&d=identicon&r=PG&f=1", "display_name": "branden", "link": "https://stackoverflow.com/users/3952630/branden"}, "is_accepted": true, "score": 0, "last_activity_date": 1430313158, "creation_date": 1430313158, "answer_id": 29944833, "question_id": 29943606, "link": "https://stackoverflow.com/questions/29943606/copying-data-from-another-workbook/29944833#29944833", "title": "copying data from another workbook", "body": "<p>This is not the prettiest of codes but it works just as you asked!</p>\n\n<pre><code>Sub newdata()\n\nDim myfile As Window\nDim currentSheet As Worksheet\nDim lastRow As Double\nDim sourceFileName As String\nDim sourcefileworksheet As String\nDim destinationwb As String\nDim destinationwksheet As String\n'set destination worksheet as open workbook when you run macro\n\ndestinationwb = ActiveWorkbook.Name\ndestinationwksheet = ActiveSheet.Name\n\n'Select source file\nDim fNameAndPath As Variant, wb As Workbook\n    fNameAndPath = Application.GetOpenFilename(Title:=\"Select File To Be Opened\")\n ' cancel macro if nothing selected\n        If fNameAndPath = False Then\n        MsgBox (\"Nothing Selected, Macro Cancelled\")\n        Exit Sub\n        End If\n\n'Open Source File.xlsx\nWorkbooks.Open (fNameAndPath)\n\n'set source names\nsourceFileName = ActiveWorkbook.Name\nsourcefileworksheet = ActiveSheet.Name\n\n'Determine last row of source\nlastRow = Workbooks(sourceFileName).Worksheets(sourcefileworksheet).Range(\"A1\").End(xlDown).Row\n\n'Past the table in my current Excel file - Note that you should change the range of destination to A1:Q if you want all copied\nWorkbooks(destinationwb).Worksheets(destinationwksheet).Range(\"A1:E\" &amp; lastRow) = Workbooks(sourceFileName).Worksheets(sourcefileworksheet).Range(\"A1:Q\" &amp; lastRow).Value\n\n'Close Source File.xlsx\nWorkbooks(sourceFileName).Close\n\n'Confirm complete\nMsgBox (\"Complete!\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 29944833, "answer_count": 1, "score": 0, "last_activity_date": 1442282295, "creation_date": 1430310059, "last_edit_date": 1442282295, "question_id": 29943606, "link": "https://stackoverflow.com/questions/29943606/copying-data-from-another-workbook", "title": "copying data from another workbook", "body": "<p>i am trying to replace the current data in my file with the data in any another selected file which have same attributes. i want to replace the data from A1:Q in the current file from any other selected file. I tried writing the code but its showing errors .</p>\n\n<pre><code>Sub newdata()\n\n\n\nSet appxl = CreateObject(\"Excel.application\")\nDim myfile As Window\nDim currentSheet As Worksheet\nDim lastRow As Double\nDim sourceFileName As String\n\n\n'Open Source File.xlsx\nWith appxl\n\n    vFile = Application.GetOpenFilename(Title:=\"Select File To Be Opened\")\n    If vFile = False Then Exit Sub  'if the user didn't select a file, exit sub\n   ' Set myfile = Workbooks.Open(vFile)\n\n\n    .Visible = False\nEnd With\n\n'Get first sheet data\nSet myfile = appxl.Windows(vFile)\nmyfile.Activate\nSet currentSheet = myfile.Sheets(1)\n\n'Past the table in my current Excel file\nlastRow = currentSheet.Range(\"A1\").End(xlDown).Row\nSheets(\"Data retrieval\").Range(\"A1:E\" &amp; lastRow) = currentSheet.Range(\"A1:Q\" &amp; lastRow).Value\n\n'Close Source File.xlsx\nappxl.Workbooks(vFile).Close\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1430309203, "post_id": 29943204, "comment_id": 48007108, "body": "What is <code>z</code> defined as? A bit more of your code would be useful please. Apart from that, are you experiencing a specific issue?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1430309378, "post_id": 29943204, "comment_id": 48007243, "body": "That&#39;s fine to test for a cell that contains no text (A cell value will never be NULL)"}, {"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "edited": false, "score": 0, "creation_date": 1430309444, "post_id": 29943204, "comment_id": 48007292, "body": "Sorry for the inconvenience ,Z is defined as integer ."}, {"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1430309584, "post_id": 29943204, "comment_id": 48007423, "body": "@Gareth after giving this specific statement ,My loop is still running ,So a bit confused.."}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1430309653, "post_id": 29943204, "comment_id": 48007486, "body": "Update your question with the piece of code including the loop and we&#39;ll take a look."}, {"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1430309936, "post_id": 29943204, "comment_id": 48007724, "body": "Done @Gareth .PLease look into it.Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "edited": false, "score": 0, "creation_date": 1430309521, "post_id": 29943285, "comment_id": 48007341, "body": "Do i have to use VBNullString  or &quot; &quot; is fine?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "edited": false, "score": 1, "creation_date": 1430309640, "post_id": 29943285, "comment_id": 48007471, "body": "Either use &quot;&quot; or vbnullstring, they&#39;ll achieve the same result. Don&#39;t use &quot; &quot; (Note the space)"}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 4, "last_activity_date": 1430309233, "creation_date": 1430309233, "answer_id": 29943285, "question_id": 29943204, "link": "https://stackoverflow.com/questions/29943204/not-null-in-vba/29943285#29943285", "title": "Not Null in VBA", "body": "<p>That works for checking if the cell(Row z+1, Column A) on the DealComparison sheet is null or not, you could also use <code>VBNullString</code></p>\n\n<p>Such as:</p>\n\n<pre><code>If Sheets(\"DealComparison\").Cells(z + 1, 1) &lt;&gt; VBNullString Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "edited": false, "score": 0, "creation_date": 1430310069, "post_id": 29943323, "comment_id": 48007846, "body": "Sorry @Jelovac , i have no idea who has down voted it ."}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1430310273, "post_id": 29943323, "comment_id": 48008007, "body": "That was me. I am sorry. Accidentally clicked down vote (Poor aiming skill :) ). I corrected it though."}], "tags": [], "owner": {"reputation": 118, "user_id": 3876757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea7c97ef63404dcf8bd9b60801b32649?s=128&d=identicon&r=PG&f=1", "display_name": "Jelovac", "link": "https://stackoverflow.com/users/3876757/jelovac"}, "is_accepted": false, "score": 1, "last_activity_date": 1430309347, "creation_date": 1430309347, "answer_id": 29943323, "question_id": 29943204, "link": "https://stackoverflow.com/questions/29943204/not-null-in-vba/29943323#29943323", "title": "Not Null in VBA", "body": "<p>Yes as long as \"Z\" is long integer. Hehe, funny sentence.</p>\n"}, {"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 3, "last_activity_date": 1430309419, "creation_date": 1430309419, "answer_id": 29943362, "question_id": 29943204, "link": "https://stackoverflow.com/questions/29943204/not-null-in-vba/29943362#29943362", "title": "Not Null in VBA", "body": "<p>Because you can have spaces in your cell sometimes those do not evaluate in the above statement. hence i always use the TRIM function as well..</p>\n\n<p><code>If TRIM(Sheets(\"DealComparison\").Cells(z + 1, 1)) &lt;&gt; \"\" Then</code></p>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": true, "score": 2, "last_activity_date": 1430310865, "last_edit_date": 1430310865, "creation_date": 1430310213, "answer_id": 29943654, "question_id": 29943204, "link": "https://stackoverflow.com/questions/29943204/not-null-in-vba/29943654#29943654", "title": "Not Null in VBA", "body": "<p>If you wish to determine if any object is NULL you should use the <code>IsNull</code> function:</p>\n\n<pre><code>Debug.Print IsNull(Sheets(\"DealComparison\").Cells(z + 1, 1))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Debug.Print IsNull(Sheets(\"DealComparison\"))\n</code></pre>\n\n<p>to test if a particular sheet is NULL, as your question asks.</p>\n\n<p>If you want to test for a zero length string it is more efficient to test using <code>Len(string) = 0</code> than <code>string = \"\"</code> as strings are stored in memory with the number of characters first, followed by that number of characters and a null terminated character.  This makes the string length more readily available than testing the characters and avoids the memory allocation operations that would be involved.</p>\n\n<pre><code>    If Len(Trim(Sheets(\"DealComparison\").Cells(z + 1, 1))) = 0 Then\n        Myarray(z) = Sheets(\"DealComparison\").Cells(z + 1, 1)\n\n        Debug.Print Myarray(z)\n    End If\n</code></pre>\n\n<p>There's an interesting review of how strings are stored in VB6/VBA <a href=\"http://www.codeguru.com/vb/gen/vb_misc/algorithms/article.php/c7495/How-Visual-Basic-6-Stores-Data.htm\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1971, "favorite_count": 0, "accepted_answer_id": 29943654, "answer_count": 4, "score": 1, "last_activity_date": 1430311023, "creation_date": 1430309046, "last_edit_date": 1430311023, "question_id": 29943204, "link": "https://stackoverflow.com/questions/29943204/not-null-in-vba", "title": "Not Null in VBA", "body": "<pre><code>If Sheets(\"DealComparison\").Cells(z + 1, 1) &lt;&gt; \"\" Then\n</code></pre>\n\n<p>Is this statement right?\nI want to check if the particular sheet is not equal to NULL in VBA</p>\n\n<pre><code>Dim x As Integer\n\n    x = 2\n\nDim z As Long\nDim Myarray(1 To 9) As String\n\n    For z = 1 To 9\n        If Trim(Sheets(\"DealComparison\").Cells(z + 1, 1)) &lt;&gt; \"\" Then\n            Myarray(z) = Sheets(\"DealComparison\").Cells(z + 1, 1)\n\n            Debug.Print Myarray(z)\n        End If\n    Next z\n</code></pre>\n\n<p>This is the full code guys,</p>\n\n<p>Now what i want is,I want to Check if it is empty and if it is not empty I hav to pass it .</p>\n\n<p>So whaat should i mention in else statement so that it would be fine .. </p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1430310996, "post_id": 29943004, "comment_id": 48008578, "body": "A <i>Runtime error 9: Subscript out of range</i> is usually pretty specific. Essentially it means that you are referencing like a worksheet that doesn&#39;t exist or you are trying to stuff more elements into an array than the array&#39;s dimensions can handle. What line are you receiving the error on?"}, {"owner": {"reputation": 133, "user_id": 3317862, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b75efd37c659d90341a43d40a4117872?s=128&d=identicon&r=PG&f=1", "display_name": "masuka", "link": "https://stackoverflow.com/users/3317862/masuka"}, "edited": false, "score": 0, "creation_date": 1430318591, "post_id": 29943004, "comment_id": 48015083, "body": "OrigString1 = Range(&quot;A2:A&quot; &amp; Range(&quot;A&quot; @Jeeped"}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1430319372, "post_id": 29943004, "comment_id": 48015691, "body": "This is weird. If you want to assign an array -which is created from a range by assigning- to another range, vba does this but can not be got an element by index from the same array. Dont use a variant array; use a string array and get the values for assigning the array by looping cells of the range. Code is seen right."}, {"owner": {"reputation": 133, "user_id": 3317862, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b75efd37c659d90341a43d40a4117872?s=128&d=identicon&r=PG&f=1", "display_name": "masuka", "link": "https://stackoverflow.com/users/3317862/masuka"}, "reply_to_user": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1430319753, "post_id": 29943004, "comment_id": 48016039, "body": "@kitap mitap can you suggest an update on the code? I&#39;m a very beginner in VBA having tough time getting through this"}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1430320320, "post_id": 29943004, "comment_id": 48016525, "body": "I has written an answer."}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1430320772, "post_id": 29943004, "comment_id": 48016865, "body": "I have edited ReDim statements."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3317862, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b75efd37c659d90341a43d40a4117872?s=128&d=identicon&r=PG&f=1", "display_name": "masuka", "link": "https://stackoverflow.com/users/3317862/masuka"}, "edited": false, "score": 0, "creation_date": 1430311693, "post_id": 29943305, "comment_id": 48009162, "body": "It returns same error even if my data has semi-colon @Jeanno"}, {"owner": {"reputation": 133, "user_id": 3317862, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b75efd37c659d90341a43d40a4117872?s=128&d=identicon&r=PG&f=1", "display_name": "masuka", "link": "https://stackoverflow.com/users/3317862/masuka"}, "edited": false, "score": 0, "creation_date": 1430317224, "post_id": 29943305, "comment_id": 48013837, "body": "Any more suggestions? @Jeanno"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1430309287, "creation_date": 1430309287, "answer_id": 29943305, "question_id": 29943004, "link": "https://stackoverflow.com/questions/29943004/subscript-out-of-range-error-during-cartesian-product/29943305#29943305", "title": "Subscript out of range error during Cartesian product", "body": "<p>The first row contains commas and not semi-colons, that is messing up the dimensionality of the vector </p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 3317862, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b75efd37c659d90341a43d40a4117872?s=128&d=identicon&r=PG&f=1", "display_name": "masuka", "link": "https://stackoverflow.com/users/3317862/masuka"}, "edited": false, "score": 0, "creation_date": 1430319576, "post_id": 29947407, "comment_id": 48015877, "body": "@Jeeped I updated my code accordingly but it still has the same error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430319944, "post_id": 29947407, "comment_id": 48016201, "body": "Put this line just above the first in the set. <code>Debug.Print Range(&quot;A2:A&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row).Address(0, 0, external:=true)</code>. When it crashes, go to the VBE and tap Ctrl+G to open the Immediate window and see what it says."}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1430321949, "post_id": 29947407, "comment_id": 48017688, "body": "@Jeeped It says <code>[mmm.xlsm]Sheet1!A2:A3</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1430319413, "creation_date": 1430319413, "answer_id": 29947407, "question_id": 29943004, "link": "https://stackoverflow.com/questions/29943004/subscript-out-of-range-error-during-cartesian-product/29947407#29947407", "title": "Subscript out of range error during Cartesian product", "body": "<p>When you are stuffing a block of cells' values into a variant array it is best not to rely upon the default property being <code>.Value</code>. Explicitly state that you want the value from the cells. In fact, use <code>.Value2</code> to get the base values from the cells.</p>\n\n<pre><code>OrigString1 = Range(\"A2:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value2\nOrigString2 = Range(\"B2:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value2\nOrigString3 = Range(\"C2:C\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value2\nOrigString4 = Range(\"D2:D\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value2\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553.aspx\" rel=\"nofollow\">Range.Value2 Property</a> for more information on <code>.Value2</code>. Specific minor properties of Currency and Date value types are not important when trying to bulk process in memory; only when the raw values get passed back to the worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "is_accepted": true, "score": 2, "last_activity_date": 1430320579, "last_edit_date": 1430320579, "creation_date": 1430320230, "answer_id": 29947763, "question_id": 29943004, "link": "https://stackoverflow.com/questions/29943004/subscript-out-of-range-error-during-cartesian-product/29947763#29947763", "title": "Subscript out of range error during Cartesian product", "body": "<p>Something like this works. I could not find a more elegant solution.</p>\n\n<pre><code>Sub Cartesian()\n    Dim MyStr1() As String\n    Dim MyStr2() As String\n    Dim MyStr3() As String\n    Dim MyStr4() As String\n    Dim X As Long\n    Dim OrigString1() As String\n    Dim OrigString2() As String\n    Dim OrigString3() As String\n    Dim OrigString4() As String\n    Dim Y As Long\n\n    Dim sht As Worksheet\n    Set sht = Worksheets(\"Sheet1\")\n\n    ReDim OrigString1(1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1)\n\n    For Y = 1 To UBound(OrigString1)\n        OrigString1(Y) = CStr(Range(\"A\" &amp; CStr(Y + 1)).Value)\n    Next\n\n    ReDim OrigString2(1 To Range(\"B\" &amp; Rows.Count).End(xlUp).Row - 1)\n\n    For Y = 1 To UBound(OrigString2)\n        OrigString2(Y) = CStr(Range(\"B\" &amp; CStr(Y + 1)).Value)\n    Next\n\n    ReDim OrigString3(1 To Range(\"C\" &amp; Rows.Count).End(xlUp).Row - 1)\n\n    For Y = 1 To UBound(OrigString3)\n        OrigString3(Y) = CStr(Range(\"C\" &amp; CStr(Y + 1)).Value)\n    Next\n\n    ReDim OrigString4(1 To Range(\"D\" &amp; Rows.Count).End(xlUp).Row - 1)\n\n    For Y = 1 To UBound(OrigString4)\n        OrigString4(Y) = CStr(Range(\"D\" &amp; CStr(Y + 1)).Value)\n    Next\n\n    X = 2\n\n    For Y = LBound(OrigString1) To UBound(OrigString1)\n\n        MyStr1() = Split(OrigString1(Y), \";\")\n        MyStr2() = Split(OrigString2(Y), \";\")\n        MyStr3() = Split(OrigString3(Y), \";\")\n        MyStr4() = Split(OrigString4(Y), \";\")\n\n        For Each Str1 In MyStr1\n            For Each Str2 In MyStr2\n                For Each Str3 In MyStr3\n                    For Each Str4 In MyStr4\n                        Range(\"A\" &amp; X).Formula = Str1\n                        Range(\"B\" &amp; X).Formula = Str2\n                        Range(\"C\" &amp; X).Formula = Str3\n                        Range(\"D\" &amp; X).Formula = Str4\n                        X = X + 1\n                    Next\n                Next\n            Next\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 3317862, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b75efd37c659d90341a43d40a4117872?s=128&d=identicon&r=PG&f=1", "display_name": "masuka", "link": "https://stackoverflow.com/users/3317862/masuka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 29947763, "answer_count": 3, "score": 3, "last_activity_date": 1430320579, "creation_date": 1430308568, "last_edit_date": 1430319915, "question_id": 29943004, "link": "https://stackoverflow.com/questions/29943004/subscript-out-of-range-error-during-cartesian-product", "title": "Subscript out of range error during Cartesian product", "body": "<p>I'm trying to find the Cartesian product of 4 columns which have data separated by delimiter </p>\n\n<p>Example</p>\n\n<pre><code>ID                     ID2                         String           String2 \n1234   33423,43222,442224,213432    Sample;repeat;example;multiple second; possible;delimiter\n2345 12354; 55633; 343534;65443;121121 data;set;sample;find     answer;combination;by\n</code></pre>\n\n<p>and I get an error Subscript out of range with the below code. Can anyone help with where it is going wrong?</p>\n\n<pre><code>Sub Cartesian()\n    Dim MyStr1 As Variant, MyStr2 As Variant, MyStr3 As Variant, MyStr4 As Variant, _\n    Str1 As Variant, Str2 As Variant, Str3 As Variant, Str4 As Variant, X As Long, _\n    OrigString1 As Variant, OrigString2 As Variant, OrigString3 As Variant, _\n    OrigString4 As Variant, Y As Long\n\n    OrigString1 = Range(\"A2:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n    OrigString2 = Range(\"B2:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n    OrigString3 = Range(\"C2:C\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n    OrigString4 = Range(\"D2:D\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\n    X = 2\n\n    For Y = LBound(OrigString1) To UBound(OrigString1)\n\n        MyStr1 = Split(OrigString1(Y), \";\")\n        MyStr2 = Split(OrigString2(Y), \";\")\n        MyStr3 = Split(OrigString3(Y), \";\")\n        MyStr4 = Split(OrigString4(Y), \";\")\n\n        For Each Str1 In MyStr1\n            For Each Str2 In MyStr2\n                For Each Str3 In MyStr3\n                    For Each Str4 In MyStr4\n                        Range(\"A\" &amp; X).Formula = Str1\n                        Range(\"B\" &amp; X).Formula = Str2\n                        Range(\"C\" &amp; X).Formula = Str3\n                        Range(\"D\" &amp; X).Formula = Str4\n                        X = X + 1\n                    Next\n                Next\n            Next\n        Next\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>Or is there a better way to deal with this using sql? Or any better way to achieve the Cartesian product of every row using VBA?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1430309382, "creation_date": 1430309382, "answer_id": 29943342, "question_id": 29942923, "link": "https://stackoverflow.com/questions/29942923/how-to-autofit-row-using-a-variable/29943342#29943342", "title": "How to autofit row using a variable", "body": "<p>You were very close:</p>\n\n<pre><code>Sub test1()\n  Dim intYellowRow As Integer \n    intYellowRow = 18\n    Rows(intYellowRow).EntireRow.AutoFit \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4815036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d6adccb27895be64411ff693fe8cad?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy Hebb", "link": "https://stackoverflow.com/users/4815036/tommy-hebb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 29943342, "answer_count": 1, "score": 0, "last_activity_date": 1430311858, "creation_date": 1430308331, "last_edit_date": 1531164843, "question_id": 29942923, "link": "https://stackoverflow.com/questions/29942923/how-to-autofit-row-using-a-variable", "title": "How to autofit row using a variable", "body": "<p>I'm trying to use vba in excel to autofit a row that is beforehand stored in a variable, but can't get it to work. Anybody have any ideas?</p>\n\n<pre><code>Sub test1()\n\nDim intYellowRow As Integer\nintYellowRow = 18\n\nWith Rows(intYellowRow &amp; \":\" &amp; intYellowRow).EntireRow\n    .AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7331, "user_id": 2296199, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/nJpLu.jpg?s=128&g=1", "display_name": "SaintLike", "link": "https://stackoverflow.com/users/2296199/saintlike"}, "edited": false, "score": 0, "creation_date": 1430308422, "post_id": 29942874, "comment_id": 48006557, "body": "Edit your post and add some code to show us what you&#39;ve done so far"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1430308463, "post_id": 29942874, "comment_id": 48006582, "body": "Sorry SO is not a code writing service. Please consider doing a research first and then posting your questions/issues together with your findings."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1430312572, "post_id": 29942874, "comment_id": 48009874, "body": "Hint. Record a macro with the operations you want and look at the code."}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": false, "score": 0, "last_activity_date": 1430310718, "creation_date": 1430310718, "answer_id": 29943853, "question_id": 29942874, "link": "https://stackoverflow.com/questions/29942874/trying-to-add-an-element-to-an-cell/29943853#29943853", "title": "Trying to add an element to an cell", "body": "<pre><code>Sub searchnFind()\nDim searchResult As Range\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ActiveWorkbook\nSet ws = wb.ActiveSheet\n\nSet searchResult = ws.Range(\"A:A\").Find(What:=ws.Range(\"G1\").Value, _\n    LookIn:=xlValues, _\n    LookAt:=xlWhole, _\n    SearchOrder:=xlByRows, _\n    SearchDirection:=xlNext, _\n    MatchCase:=False)\n\nIf Not searchResult Is Nothing Then\nsearchResult.Select\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4846214, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153013485028705/picture?type=large", "display_name": "Simon Riley", "link": "https://stackoverflow.com/users/4846214/simon-riley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1449752259, "creation_date": 1430308202, "last_edit_date": 1531164843, "question_id": 29942874, "link": "https://stackoverflow.com/questions/29942874/trying-to-add-an-element-to-an-cell", "title": "Trying to add an element to an cell", "body": "<p>I have trying to find a code that will look at the contents of a cell <code>G1</code> and then search column A for a match and select that cell.</p>\n\n<p>This is part of a longer code, but this is the only bit I can't find out how to do.</p>\n"}, {"tags": ["excel", "multidimensional-array", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "edited": false, "score": 0, "creation_date": 1430315861, "post_id": 29943100, "comment_id": 48012653, "body": "I see your point that SQL is more appropriate for such large data set operations, but wouldn&#39;t this solution require that I have or set up a SQL server that I can upload the data to, run the SQL query and download it back again to the Excel file?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "edited": false, "score": 0, "creation_date": 1430315973, "post_id": 29943100, "comment_id": 48012759, "body": "Nope. Its an internal native excel feature. No need of installing or configuring anything"}, {"owner": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "edited": false, "score": 0, "creation_date": 1430402653, "post_id": 29943100, "comment_id": 48059370, "body": "I got this to work and it&#39;s a pretty elegant solution! More so than my own below. Thanks!"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "edited": false, "score": 0, "creation_date": 1430480226, "post_id": 29943100, "comment_id": 48091432, "body": "No problem. Ole DB is much quicker than any VBA you should find. Not to mention less testing and less error prone (less code less errors)"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 0, "last_activity_date": 1430309117, "last_edit_date": 1430309117, "creation_date": 1430308798, "answer_id": 29943100, "question_id": 29941574, "link": "https://stackoverflow.com/questions/29941574/collect-and-subtotal-duplicate-rows-in-a-variant-2d-array/29943100#29943100", "title": "Collect and subtotal duplicate rows in a Variant 2D array", "body": "<p><strong>Use Microsoft Query (SQL) in Excel:</strong></p>\n\n<p>Such data manipulation operations are ideal for SQL queries. No need of going through the data line by line using VBA: </p>\n\n<pre><code>SELECT S1.Param1, S1.Param2, S1.Param18, SUM(S1.Quantity), SUM(S1.Weight) \nFROM [Sheet1$] AS S1 GROUP BY Param1, Param2,Param18\n</code></pre>\n\n<p><strong>This is guaranteed to run quickly and efficiently via OLE DB</strong>. Whatever VBA code will be much less efficient.</p>\n\n<p><strong>To refresh the query</strong> at any time simply run the following code from VBA:</p>\n\n<pre><code>Set ws = ActiveSheet\nws.QueryTables(1).Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>Where <strong>ws</strong> is the worksheet where you locate the query table.</p>\n\n<p>Either use the <strong>Microsoft Query</strong> from <strong>Data->From other sources->From Microsoft Query</strong> or feel free to use my Add-In: <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow\">http://www.analystcave.com/excel-tools/excel-sql-add-in-free/</a></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "edited": false, "score": 0, "creation_date": 1430402782, "post_id": 29943169, "comment_id": 48059473, "body": "Thanks for your answer, much appreciated.I have to admit this was a bit too complex for me, mostly due to the fact I haven&#39;t used the Scripting.Dictionary object before, so I unfortunately can&#39;t deliver the timed results you requested."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1430308977, "last_edit_date": 1592644375, "creation_date": 1430308977, "answer_id": 29943169, "question_id": 29941574, "link": "https://stackoverflow.com/questions/29941574/collect-and-subtotal-duplicate-rows-in-a-variant-2d-array/29943169#29943169", "title": "Collect and subtotal duplicate rows in a Variant 2D array", "body": "<p>See if you can F8 through this. You will need to go into the VBE's Tools \u25ba References and add <em>Microsoft Scripting Runtime</em> for the use of the Scripting.Dictionary object.</p>\n<pre><code>Sub Stack_Dupes()\n    Dim r As Long, c As Long, v As Long, k As Long\n    Dim vKEYs As Variant, vITMs As Variant, vTMP1 As Variant, vTMP2 As Variant\n    Dim sKEY As String, sITM As String\n    Dim dITMs As New Scripting.dictionary\n    \n    With ActiveSheet\n        With .Cells(1, 1).CurrentRegion\n            .Rows(1).Cells.Copy _\n              Destination:=.Cells(.Rows.Count + 3, 1)\n            With .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n                vKEYs = .Cells.Resize(.Rows.Count, .Columns.Count - 2).Value2\n                vITMs = .Cells.Offset(0, .Columns.Count - 2).Resize(.Rows.Count, 2).Value2\n                For r = LBound(vKEYs, 1) To UBound(vKEYs, 1)\n                    sKEY = Join(Application.Index(vKEYs, r, 0), ChrW(8203))\n                    sITM = Join(Application.Index(vITMs, r, 0), ChrW(8203))\n                    If dITMs.Exists(sKEY) Then\n                        vTMP1 = Split(dITMs.Item(sKEY), ChrW(8203))\n                        vTMP2 = Split(sITM, ChrW(8203))\n                        vTMP1(0) = CDbl(vTMP1(0)) + CDbl(vTMP2(0))\n                        vTMP1(1) = CDbl(vTMP1(1)) + CDbl(vTMP2(1))\n                        sITM = Join(vTMP1, ChrW(8203))\n                        dITMs.Item(sKEY) = sITM\n                    Else\n                        dITMs.Add Key:=sKEY, Item:=sITM\n                    End If\n                Next r\n                ReDim vKEYs(1 To (.Columns.Count - 2), 1 To dITMs.Count)\n                ReDim vITMs(1 To 2, 1 To dITMs.Count)\n                For Each vTMP1 In dITMs.Keys\n                    k = k + 1\n                    vTMP2 = Split(vTMP1, ChrW(8203))\n                    For v = LBound(vTMP2) To UBound(vTMP2)\n                        vKEYs(v + 1, k) = vTMP2(v)\n                    Next v\n                    vTMP2 = Split(dITMs.Item(vTMP1), ChrW(8203))\n                    For v = LBound(vTMP2) To UBound(vTMP2)\n                        vITMs(v + 1, k) = vTMP2(v)\n                    Next v\n                Next vTMP1\n                .Cells.Offset(.Rows.Count + 3, 0).Resize(UBound(vKEYs, 2), .Columns.Count - 2) = Application.Transpose(vKEYs)\n                .Cells.Offset(.Rows.Count + 3, .Columns.Count - 2).Resize(UBound(vITMs, 2), 2) = Application.Transpose(vITMs)\n            End With\n        End With\n    End With\n    dITMs.RemoveAll: Set dITMs = Nothing\nEnd Sub\n</code></pre>\n<p>Results are written underneath the sample data as follows:</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/PeE4D.png\" alt=\"Collate and reorder in Variant Array\" /></p>\n<p>I would be interested in the timed results on larger data sets if you find time to post them back here.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "is_accepted": false, "score": 0, "last_activity_date": 1430402477, "creation_date": 1430402477, "answer_id": 29969840, "question_id": 29941574, "link": "https://stackoverflow.com/questions/29941574/collect-and-subtotal-duplicate-rows-in-a-variant-2d-array/29969840#29969840", "title": "Collect and subtotal duplicate rows in a Variant 2D array", "body": "<p>I found this article (<a href=\"http://sitestory.dk/excel_vba/arrays-and-ranges.htm\" rel=\"nofollow\">http://sitestory.dk/excel_vba/arrays-and-ranges.htm</a>, go to middle of the page) on how to delete identical rows that I built some code on. It doesn't solve my original question 100% since it doesn't compare entire rows in the array but rather each column separately in each row, but it turned out to have quite good performance nonetheless.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>'I couldn't get the final step of pasting the output array into the new sheet working properly without declaring this option, otherwise the data would be pasted one cell to the right and below where I wanted it.\nOption Base 1\n\nDim r, i, c, LastRow, DeletedRows As Integer\nDim input_array, output_array As Variant\nDim identical As Boolean\nDim s As Worksheet\nDim NewRange As Range\n\nLastRow = Cells(65536, 2).End(xlUp).Row\n\n'Load the data set into memory, consisting of 20 columns of data and a 21th column with no data that is used for marking rows for deletion.\ninput_array = Sheets(\"1.1\").Range(Sheets(\"1.1\").Cells(2, 1), Sheets(\"1.1\").Cells(LastRow, 21)).Value\n\nDeletedRows = 0\n\n'Run through the data set from bottom to top comparing rows one at a time, copy Quantity and Weight values and mark rows for deletion\nFor r = UBound(input_array) To 2 Step -1\n    For i = r - 1 To 2 Step -1\n\n        'Assume row r and i are identical\n        identical = True\n\n        'Run through columns of r and i, flag if non-identical value is found and stop the loop (col 18 is ignored, since this is the \"Quantity\" column, while col 20 is the \"Weight\" column)\n        For c = 1 To 18\n            If input_array(r, c) &lt;&gt; input_array(i, c) And c &lt;&gt; 18 Then\n                identical = False\n                Exit For\n            End If\n        Next c\n\n        ' If no non-identical columns were found, add \"Quantity\" and \"Weight\" from row r to row i and mark row r for deletion\n        If identical Then\n            input_array(i, 18) = input_array(i, 18) + input_array(r, 18)\n            input_array(i, 20) = input_array(i, 20) + input_array(r, 20)\n            input_array(r, 21) = \"_DELETE_\"\n            DeletedRows = DeletedRows + 1\n            Exit For\n        End If\n\n    Next i\nNext r\n\n' Resize the new array to the size of the old array minus the number of deleted rows\nReDim output_array(UBound(input_array) - DeletedRows, 20)\n\n' Copy rows not marked as deleted from old array to new array\ni = 1\nFor r = 1 To UBound(input_array)\n    If input_array(r, 21) &lt;&gt; \"_DELETE_\" Then\n        For c = 1 To 20\n            output_array(i, c) = input_array(r, c)\n        Next c\n        i = i + 1\n    End If\nNext r\n\n' Create new sheet and \nSet s = Sheets.Add\nSet NewRange = s.Range(\"A2\").Resize(UBound(output_array), 20)\nNewRange = output_array\n</code></pre>\n\n<p>The macro takes about 30 seconds to reduce 20,000 rows to 3,000 on my computer, which I think is quite good considering the large amounts of data.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 7507208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CWODdquYWjk/AAAAAAAAAAI/AAAAAAAAAoE/AWJOhtQ1ygg/photo.jpg?sz=128", "display_name": "Gregg Burns", "link": "https://stackoverflow.com/users/7507208/gregg-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1552527477, "last_edit_date": 1552527477, "creation_date": 1552524009, "answer_id": 55153219, "question_id": 29941574, "link": "https://stackoverflow.com/questions/29941574/collect-and-subtotal-duplicate-rows-in-a-variant-2d-array/55153219#55153219", "title": "Collect and subtotal duplicate rows in a Variant 2D array", "body": "<p>This can be done in milliseconds, not seconds. I'm also using arrays and dictionary object. However showing in simpler and more thoughtful implementation. It's faster than using sql against sheet. It can compare any number of columns, just make sure they are included in the KeyIn variable as concatenated string. I also simplify the function by assuming my value to sum is in column 4. You can adjust code for multiple values in other columns. I'm writing from 1 array to another (InAy to OutAy), the dictionary determines if row already existed. The magic happens in the dictionary's Item property. I assign the item property value to the row (r) when a new OutAy row is written. Then when it exists already, I retrieve the row (r) where it was written to OutAy using the item key: d.item(KeyIn) I can then update that value in OutAy(r, 4) with a sum of existing value and new value 'KeyVal'.</p>\n\n<p>This solves the same as sql query aggregate: \"Select a, b, c, sum(d) from data group by a, b, c\"</p>\n\n<p>Note: add a tools->reference to Microsoft Scripting runtime</p>\n\n<pre><code>    sub somesub()\n     ...\n     data = Range(\"WhereYourDataIs\") 'create data array\n     Range(\"WhereYourDataIs\").clear 'assumes you'll output to same location\n     data = RemoveDupes(data) 'removedupes and sum values\n     Range(\"A2\").Resize(UBound(data), UBound(data, 2)) = data 'A2 assumes your data headers begin in row 1, column 1\n     ...\n    End Sub\n\nFunction RemoveDupes(InAy As Variant) As Variant\n    Dim d As Scripting.Dictionary\n    Set d = New Scripting.Dictionary\n    ReDim OutAy(1 To UBound(InAy), 1 To 4)\n    r = 1\n\n    For i = 1 To UBound(InAy)\n        KeyIn = \"\"\n        KeyVal = InAy(i, 4) 'the value field to sum/aggregate if exists\n        For c = 1 To 3 'a, b, c metadata to roll up\n            KeyIn = KeyIn &amp; InAy(i, c)\n        Next c\n        If d.Exists(KeyIn) Then\n            OutAy(d.item(KeyIn), 4) = OutAy(d.item(KeyIn), 4) + KeyVal 'd.item(KeyIn) is r, set when OutAy row was added. Same as OutAy(r,4)=OutAy(r,4) + KeyVal \n            Else:\n            d.Add KeyIn, r 'r is set as the item value referencing the row of the OutAy when it was first added. The reference is used when .Exists is true\n            For c = 1 To 4\n                OutAy(r, c) = InAy(i, c)\n            Next c\n            r = r + 1\n        End If\n    Next\n    RemoveDupes = OutAy\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4845456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76fd38d7ba25ab3b1862c5f3f4d3ee6?s=128&d=identicon&r=PG&f=1", "display_name": "user4845456", "link": "https://stackoverflow.com/users/4845456/user4845456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 29943100, "answer_count": 4, "score": 1, "last_activity_date": 1552527477, "creation_date": 1430304746, "last_edit_date": 1531164843, "question_id": 29941574, "link": "https://stackoverflow.com/questions/29941574/collect-and-subtotal-duplicate-rows-in-a-variant-2d-array", "title": "Collect and subtotal duplicate rows in a Variant 2D array", "body": "<p>I have a dataset in Excel consisting of 20 columns and a varying number of rows, ranging from 20,000 - 50,000.</p>\n\n<p>Each row is a collection of items with one column denoting the quantity of items in the collection and another column denoting the total combined weight of the collection.\nSome of these rows are completely identical in all columns, while some are identical in all but quantity and weight.</p>\n\n<p>I want to create a macro that runs through the dataset and \"stacks\" rows that are duplicate on all other parameters than quantity and weight, and sums these two up.</p>\n\n<p>In other words, a macro that converts this:</p>\n\n<pre><code>|Param1|Param2|...|Param18|Quantity|Weight|\n| A    | 1    |...| C     | 5      | 12.5 |\n| A    | 1    |...| C     | 2      |  5.0 |\n| A    | 1    |...| C     | 3      |  7.5 |\n| B    | 2    |...| C     | 1      |  2.3 |\n| B    | 2    |...| C     | 2      |  4.6 |\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>|Param1|Param2|...|Param18|Quantity|Weight|\n| A    | 1    |...| C     | 10     | 25.0 |\n| B    | 2    |...| C     | 3      |  6.9 |\n</code></pre>\n\n<p>I know this is possible to do in a simple pivot table, but for a number of reasons this is not viable in this case.</p>\n\n<p>Since I'm dealing with a large dataset, I want to load it all into memory at once rather than reading and writing line by line to speed up performance (as suggested in tip #13 in this great article <a href=\"http://www.databison.com/how-to-speed-up-calculation-and-improve-performance-of-excel-and-vba/\" rel=\"nofollow\">http://www.databison.com/how-to-speed-up-calculation-and-improve-performance-of-excel-and-vba/</a>). However I'm stuck as to how to make the row operations on the data stored in memory.</p>\n\n<p>So far my code looks like this:</p>\n\n<pre><code>Dim r, c, LastRow As Integer\nDim temp_range As Variant\n\nLastRow = Cells(65536, 2).End(xlUp).Row\n\n'Load the data set into memory\ntemp_range = Sheets(\"1.1\").Range(Sheets(\"1.1\").Cells(2, 1), Sheets(\"1.1\").Cells(LastRow, 20)).Value\n\n'Run through the data set from bottom to top and bulk identical rows together\nFor r = UBound(temp_range) To LBound(temp_range)\n    For i = r - 1 To LBound(temp_range)\n\n        'PSEUDO CODE START HERE\n        If row temp_range(r) = row temp_range(i) Then\n            temp_range(i,19) = temp_range(r,19) + temp_range(i,19)\n            temp_range(i,20) = temp_range(r,19) + temp_range(i,20)\n            Delete row temp_range(r)\n            Exit For\n        End if\n\n        'PSEUDO CODE END HERE\n\n    Next i\nNext r\n</code></pre>\n\n<p>I'm stuck at the Pseudo-code section highligted in the code. I simply don't know how to compare the rows, copy quantity and weight from one row to another and then delete the duplicate row in the variant holding the range in memory.</p>\n"}, {"tags": ["excel", "pivot", "datasource", "vba"], "comments": [{"owner": {"reputation": 1982, "user_id": 1332078, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7eeaff72ee14c09d90a1e2dead4c6f96?s=128&d=identicon&r=PG", "display_name": "Dion V.", "link": "https://stackoverflow.com/users/1332078/dion-v"}, "edited": false, "score": 0, "creation_date": 1430305284, "post_id": 29941420, "comment_id": 48004248, "body": "What do you mean with &quot;doesn&#39;t get accepted&quot;?"}, {"owner": {"reputation": 1, "user_id": 4845959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f727be271d57e494c357df09b2889e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phips", "link": "https://stackoverflow.com/users/4845959/phips"}, "reply_to_user": {"reputation": 1982, "user_id": 1332078, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7eeaff72ee14c09d90a1e2dead4c6f96?s=128&d=identicon&r=PG", "display_name": "Dion V.", "link": "https://stackoverflow.com/users/1332078/dion-v"}, "edited": false, "score": 0, "creation_date": 1430306248, "post_id": 29941420, "comment_id": 48004915, "body": "I get a runtime error saying that &quot;Method &#39;CreatePivotTable&#39; of Object &#39;PivotCache&#39; failed&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1430310501, "creation_date": 1430310501, "answer_id": 29943755, "question_id": 29941420, "link": "https://stackoverflow.com/questions/29941420/excel-vba-create-pivot-table/29943755#29943755", "title": "excel vba create pivot table", "body": "<p>You're trying to create a pivot table with a data area of a single cell. If you walk backwards through your code to eliminate the <code>.Select</code>s, you'll see that you've got:</p>\n\n<pre><code>DataArea = \"Sheet1!R1C1:R\" &amp; Range(\"A5\").Rows.Count &amp; \"C\" &amp; Range(\"A5\").Columns.Count\n</code></pre>\n\n<p>Which translates to </p>\n\n<pre><code>DataArea = \"Sheet1!R1C1:R\" &amp; \"1\" &amp; \"C\" &amp; \"1\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>DataArea = \"Sheet1!R1C1:R1C1\"\n</code></pre>\n\n<p>If your data runs through \"A5\", then you'll want:</p>\n\n<pre><code>DataArea = \"Sheet1!R1C1:R5C1\"\n</code></pre>\n\n<p>but a single column of data doesn't give Excel much to pivot on...</p>\n"}], "owner": {"reputation": 1, "user_id": 4845959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f727be271d57e494c357df09b2889e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phips", "link": "https://stackoverflow.com/users/4845959/phips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1433605741, "creation_date": 1430304332, "last_edit_date": 1531164843, "question_id": 29941420, "link": "https://stackoverflow.com/questions/29941420/excel-vba-create-pivot-table", "title": "excel vba create pivot table", "body": "<p>I'm trying to create a pivot table in excel vba and fail to do so.</p>\n\n<pre><code>Range(\"A5\").Select\nSheets.Add\n\nRange(\"A5\").Select\nSelection.CurrentRegion.Select\n\nDataArea = \"Sheet1!R1C1:R\" &amp; Selection.Rows.Count &amp; \"C\" &amp; Selection.Columns.Count\n\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=DataArea, _\n    Version:=xlPivotTableVersion10).CreatePivotTable _\n    TableDestination:=\"Sheet2!R3C1\", TableName:=\"PivotTable2\", DefaultVersion _\n    :=xlPivotTableVersion10\n</code></pre>\n\n<p>Somehow my DataArea doesn't get accepted, any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1430382463, "post_id": 29941654, "comment_id": 48045586, "body": "Thanks - after some further trial and error I am not certain it is the actual loop / writing to the cells which takes the most time, but actually fetching the workbooks from the server. I am not sure there is a lot that can be done about that, though."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1430384603, "post_id": 29941654, "comment_id": 48047061, "body": "Within the macro you could open the workbooks, write the formula, and then close them. Links between workbooks resolve faster when the destimation workbook is open."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1430384735, "post_id": 29941654, "comment_id": 48047151, "body": "Yeah, that&#39;s what I am currently doing. Still not ideal, but a bit better."}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 1, "last_activity_date": 1430305287, "last_edit_date": 1430305287, "creation_date": 1430304970, "answer_id": 29941654, "question_id": 29941361, "link": "https://stackoverflow.com/questions/29941361/performance-issues-when-automatically-putting-a-large-amount-of-links-in-spreads/29941654#29941654", "title": "Performance issues when automatically putting a large amount of links in spreadsheet", "body": "<p>I can imagine it would be quite slow, your for loop is entering cell values individual in 10 columns for 741 iterations, so around 7.4k cell entries done individually.</p>\n\n<p>You could either create the cell values in an array and then paste that array into the workbook, or more simply enter the expected formulae in the top row and fill down as appropriate.</p>\n\n<p>As an example you could replace:</p>\n\n<pre><code>  For i = 0 To 740\n    Loktider.Range(\"C4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C6\"\n    Loktider.Range(\"D4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C5\"\n    Loktider.Range(\"E4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C16\"\n    Loktider.Range(\"F4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C15\"\n    Loktider.Range(\"G4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C6\"\n    Loktider.Range(\"H4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C5\"\n    Loktider.Range(\"I4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C16\"\n    Loktider.Range(\"J4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C15\"\n  Next\n</code></pre>\n\n<p>With:</p>\n\n<p><strong>Edit -- R1C1 reference system seems to use absolute values, standard cell reference added instead</strong></p>\n\n<pre><code>with Loktider\n    .Range(\"C4\") = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!F11\"\n    .Range(\"D4\") = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!E11\"\n    .Range(\"E4\") = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!P11\"\n    .Range(\"F4\") = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!O11\"\n    .Range(\"G4\") = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!F11\"\n    .Range(\"H4\") = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!E11\"\n    .Range(\"I4\") = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!P11\"\n    .Range(\"J4\") = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!O11\"\nRange(.Cells(4,3),.Cells(744,10)).FillDown\nEnd With\n</code></pre>\n\n<p>This is on a few assumptions, that <code>Loktider</code> is a <code>worksheet</code> variable you've created, and that you'll be using that specific range as you hardcoded your loop counter.</p>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430305287, "creation_date": 1430304134, "last_edit_date": 1531161705, "question_id": 29941361, "link": "https://stackoverflow.com/questions/29941361/performance-issues-when-automatically-putting-a-large-amount-of-links-in-spreads", "title": "Performance issues when automatically putting a large amount of links in spreadsheet", "body": "<p>I am using this code snippet to place links to another workbook into my own:</p>\n\n<pre><code>Sub legg_inn_lekkjer()\n  Dim i As Long\n\n  Call deaktiver\n\n  For i = 0 To 740\n    Loktider.Range(\"C4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C6\"\n    Loktider.Range(\"D4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C5\"\n    Loktider.Range(\"E4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C16\"\n    Loktider.Range(\"F4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 3 28h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C15\"\n    Loktider.Range(\"G4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C6\"\n    Loktider.Range(\"H4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C5\"\n    Loktider.Range(\"I4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C16\"\n    Loktider.Range(\"J4\").Offset(i, 0) = \"='[Simulering Arbeidsplan Ovn 4 30h.xls]Lokklegging'!R\" &amp; CStr(11 + i) &amp; \"C15\"\n  Next\n\n  Call reaktiver\nEnd Sub\n\nSub deaktiver()\n  Application.EnableEvents = False\n  Application.ScreenUpdating = False\n  Application.DisplayStatusBar = False\n  Application.Calculation = xlCalculationManual\n  ' ActiveSheet.DisplayPageBreaks = True 'note this is a sheet-level setting\nEnd Sub\n\nSub reaktiver()\n  Application.EnableEvents = True\n  Application.ScreenUpdating = True\n  Application.DisplayStatusBar = True\n  Application.Calculation = xlCalculationAutomatic\n  ' ActiveSheet.DisplayPageBreaks = True 'note this is a sheet-level setting\nEnd Sub\n</code></pre>\n\n<p>It works correctly, but takes quite a while to run. It probably won't be a problem, as I won't need to update the link-addresses very often, but still I wondered if there is a more efficient way to do this, using some kind of relative reference to input the addresses for each column all at once for instance? Quite a lot of googling indicates \"no\", but I figured it wouldn't hurt to ask.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1430303602, "post_id": 29940996, "comment_id": 48003031, "body": "Take one of the worksheets or add a new one and make it <code>.Visible = xlVeryHidden</code>. Give A1 on this worksheet a value of false. Check that value before running <code>Open1.Show</code> and set it to True after running it. You could even use <code>Environ(&quot;USERNAME&quot;)</code> in B1 so it only ran once per user."}, {"owner": {"reputation": 123, "user_id": 4845825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7ac3e544eb224fde468dea423e6db47?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4845825/matt"}, "edited": false, "score": 0, "creation_date": 1430303820, "post_id": 29940996, "comment_id": 48003177, "body": "Yeah, that sounds like it should cover the problem. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1430305413, "post_id": 29941337, "comment_id": 48004339, "body": "DoCmd is used within Access VBA, but not in Excel!"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 2, "last_activity_date": 1430332403, "last_edit_date": 1430332403, "creation_date": 1430304076, "answer_id": 29941337, "question_id": 29940996, "link": "https://stackoverflow.com/questions/29940996/how-can-i-run-a-macro-as-a-workbook-opens-for-the-first-time-only/29941337#29941337", "title": "How can I run a macro as a workbook opens for the first time only?", "body": "<p>You could use a dummy module which gets deleted the first time you open the spreadsheet...</p>\n\n<p>Something like:</p>\n\n<pre><code>If ModuleExists(\"DummyModule\") Then\n    Open1.Show\n    DoCmd.DeleteObject acModule, \"DummyModule\"\nEnd If\n\nFunction ModuleExists(strModuleName As String) As Boolean\n    Dim mdl As Object\n    For Each mdl In CurrentProject.AllModules\n        If mdl.Name = strModuleName Then\n            ModuleExists = True\n            Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Update: as stated, DoCmd isn't used in excel vba. That will teach me to write code without testing it!\nThe following updated code will work, but in order to access the VB environment, excel needs to be trusted.</p>\n\n<p>There is a setting in the Trust Center>Macro Settings that you can tick for this code to work under Developer Macro Settings</p>\n\n<p>As such, this may not be the way to go as it opens up the possibility of security issues...</p>\n\n<pre><code>Sub RemoveModule()\n    If ModuleExists(\"DummyModule\") Then\n        Open1.Show\n        Dim vbCom As Object: Set vbCom = Application.VBE.ActiveVBProject.VBComponents\n        vbCom.Remove VBComponent:=vbCom.Item(\"DummyModule\")\n    End If\nEnd Sub\n\nFunction ModuleExists(strModuleName As String) As Boolean\n    Dim mdl As Object\n    For Each mdl In Application.VBE.ActiveVBProject.VBComponents\n        If mdl.Name = strModuleName Then\n            ModuleExists = True\n            Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 245, "user_id": 3813538, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1da8b3ecb8dd6bed2fb98a23e88c8dac?s=128&d=identicon&r=PG&f=1", "display_name": "WltrRpo", "link": "https://stackoverflow.com/users/3813538/wltrrpo"}, "is_accepted": false, "score": 0, "last_activity_date": 1430315176, "creation_date": 1430315176, "answer_id": 29945664, "question_id": 29940996, "link": "https://stackoverflow.com/questions/29940996/how-can-i-run-a-macro-as-a-workbook-opens-for-the-first-time-only/29945664#29945664", "title": "How can I run a macro as a workbook opens for the first time only?", "body": "<p>Try this:</p>\n\n<pre><code>If Sheets(\"Hide\").Cells(1,1) = \"1\" Then\n    Open1.Show\n    Sheets(\"Hide\").Cells(1,1) = \"0\"\nEnd if\n</code></pre>\n\n<p>You must create the sheet Hide, and give the cell A1 the value 1, in that case the form will be shown.</p>\n\n<p>After you create the sheet, hide it with this</p>\n\n<pre><code>Sheets(\"Hide\").Visible = xlVeryHidden\n</code></pre>\n\n<p>And show it with this</p>\n\n<pre><code>Sheets(\"Hide\").Visible = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": 0, "last_activity_date": 1430318619, "last_edit_date": 1430318619, "creation_date": 1430318336, "answer_id": 29946946, "question_id": 29940996, "link": "https://stackoverflow.com/questions/29940996/how-can-i-run-a-macro-as-a-workbook-opens-for-the-first-time-only/29946946#29946946", "title": "How can I run a macro as a workbook opens for the first time only?", "body": "<p>Here's an alternative bit of code that will persist between saves and allow you to reset it. No need to create a hidden sheet.\nPut this in a module (invoke the DisplayFormIfFirstTime from your Workbook_Open event handler....)</p>\n\n<pre><code>Option Explicit\n\nPrivate Const cMoniker As String = \"FormHasBeenDisplayed\"\n\nPrivate Sub DisplayFormIfFirstTime()\nIf HasBeenOpened = False Then DisplayForm\nEnd Sub\n\nPublic Sub DisplayForm()\nMsgBox \"Ok, its not a form but a dialog box...\", vbInformation\nEnd Sub\n\nPublic Function HasBeenOpened() As Boolean\n\nDim oName As Name\nOn Error Resume Next\nSet oName = Application.Names(cMoniker)\nOn Error GoTo 0\n\nIf Not oName Is Nothing Then\n    HasBeenOpened = True\nElse\n    Call Application.Names.Add(cMoniker, True, False)\nEnd If\n\nEnd Function\n\n'Call this to remove the flag...\nPublic Sub ResetOpenOnce()\nOn Error Resume Next\nApplication.Names(cMoniker).Delete\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1430338881, "creation_date": 1430338881, "answer_id": 29953777, "question_id": 29940996, "link": "https://stackoverflow.com/questions/29940996/how-can-i-run-a-macro-as-a-workbook-opens-for-the-first-time-only/29953777#29953777", "title": "How can I run a macro as a workbook opens for the first time only?", "body": "<p>Based on the idea supplied by PaulG, I have coded an upgrade that will check for the name and if not found run a function, add the name and save the workbook for a more seemless approach to this problem...</p>\n\n<p>Placed in ThisWorkbook</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Run \"RunOnce\"\nEnd Sub\n</code></pre>\n\n<p>Placed in a module</p>\n\n<pre><code>Sub RunOnce()\n    Dim Flag As Boolean: Flag = False\n    For Each Item In Application.Names\n        If Item.Name = \"FunctionHasRun\" Then Flag = True\n    Next\n    If Flag = False Then\n        Call Application.Names.Add(\"FunctionHasRun\", True, False)\n        Application.DisplayAlerts = False\n            ActiveWorkbook.Save\n        Application.DisplayAlerts = True\n        Call RunOnceFunction\n    End If\nEnd Sub\n\nPrivate Function RunOnceFunction()\n    Open1.Show\nEnd Function\n\nSub ResetRunOnce()\n    For Each Item In Application.Names\n        If Item.Name = \"FunctionHasRun\" Then\n            Application.Names.Item(\"FunctionHasRun\").Delete\n            Application.DisplayAlerts = False\n                ActiveWorkbook.Save\n            Application.DisplayAlerts = True\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4845825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7ac3e544eb224fde468dea423e6db47?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4845825/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2075, "favorite_count": 0, "accepted_answer_id": 29941337, "answer_count": 4, "score": 2, "last_activity_date": 1430338881, "creation_date": 1430303231, "last_edit_date": 1430311655, "question_id": 29940996, "link": "https://stackoverflow.com/questions/29940996/how-can-i-run-a-macro-as-a-workbook-opens-for-the-first-time-only", "title": "How can I run a macro as a workbook opens for the first time only?", "body": "<p>I've got a workbook which runs a macro to show the userform Open1 as it opens, using the (very basic) code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Open1.Show\n\nEnd Sub\n</code></pre>\n\n<p>This does its job fine - each time I open the workbook, the userform pops up and runs perfectly.</p>\n\n<p>But, I want the userform to appear the first time the workbook is opened <em>only</em>. Is there a way to allow this to happen?</p>\n"}, {"tags": ["forms", "vba", "ms-word"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1430303251, "post_id": 29940536, "comment_id": 48002775, "body": "Which program are using ? Excel ? Access ? Please tag accordingly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430303255, "post_id": 29940536, "comment_id": 48002782, "body": "The dimmed <i>trans</i> in <code>UserForm_Initialize</code> cannot be &#39;seen&#39; in <code>txtPartNum_AfterUpdate</code> without passing it as a parameter (unlikely) or as a public/private var to that module."}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 0, "last_activity_date": 1430303724, "last_edit_date": 1430303724, "creation_date": 1430303205, "answer_id": 29940987, "question_id": 29940536, "link": "https://stackoverflow.com/questions/29940536/class-object-update-using-a-form/29940987#29940987", "title": "Class Object update using a form", "body": "<p>The problem seems to be in the scope of your declaration. By doing this: </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n(...)\n\nDim trans As New clsTransaction '&lt;-- declaration + assignment\n\nEnd Sub\n</code></pre>\n\n<p>you are declaring <code>trans</code> in the scope of <code>UserForm_Initialize()</code>. Hence, when you then try to do something with it into another scope: </p>\n\n<pre><code>Private Sub txtPartNum_AfterUpdate()\n\n(...)\ntrans.PartNum = strPartNum\n\nEnd Sub\n</code></pre>\n\n<p>the object <code>trans</code> doesn't exist anymore because it's out of scope (so it has already been collected by the garbage collector) and you get an \"object required error\". You need to declare <code>trans</code> at global level, this is the idea:</p>\n\n<pre><code>Dim trans as yourClass '&lt;-- global declaration: the object trans will keep on existing into all scopes\nPrivate Sub UserForm_Initialize()\n    Set trans = New yourClass '&lt;-- new instance of the object\nEnd Sub\nPrivate Sub txtPartNum_AfterUpdate()\n    'use the instance here\n    trans.PartNum = strPartNum\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4682924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340443b40e9e41247246f2a158b25db6?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/4682924/fabien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 29940987, "answer_count": 1, "score": -1, "last_activity_date": 1430310859, "creation_date": 1430302012, "last_edit_date": 1430310859, "question_id": 29940536, "link": "https://stackoverflow.com/questions/29940536/class-object-update-using-a-form", "title": "Class Object update using a form", "body": "<p>I am creating a tool in VBA to create labels with information about transactions.</p>\n\n<p>I would like the user to use a form to give all the information and the labels will be automatically created.</p>\n\n<p>To do so I have created a transaction class called <code>clsTransaction</code>.</p>\n\n<pre><code>Public PartNum As String\nPrivate Sub Class_Initialize()\n    MsgBox \"initialized!\"\nEnd Sub\n</code></pre>\n\n<p>At the initilalisation of the form a new object is created</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    (...)\n\n    Dim trans As New clsTransaction\n\nEnd Sub\n</code></pre>\n\n<p>Then when a textbox is updated, I want to update the object property</p>\n\n<pre><code>Private Sub txtPartNum_AfterUpdate()\n\n    Dim strPartNum As String\n    strPartNum = txtPartNum.Value\n    MsgBox (strPartNum)\n    trans.PartNum = strPartNum\n\nEnd Sub\n</code></pre>\n\n<p>I get the following error message</p>\n\n<blockquote>\n  <p>Run-time error '424':\n  Object required</p>\n</blockquote>\n\n<p>My understanding is I need to declare the obect. I have tried to add:</p>\n\n<pre><code>dim trans as object\n</code></pre>\n\n<p>but I get an other error message:</p>\n\n<blockquote>\n  <p>Run time error '91':\n  object variable or With block variable not set</p>\n</blockquote>\n\n<p>Could someone help me to update the object through the form?</p>\n"}, {"tags": ["vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4845787, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205143672044366/picture?type=large", "display_name": "Yael Zur", "link": "https://stackoverflow.com/users/4845787/yael-zur"}, "is_accepted": false, "score": 0, "last_activity_date": 1430311062, "creation_date": 1430311062, "answer_id": 29943982, "question_id": 29940429, "link": "https://stackoverflow.com/questions/29940429/vba-code-to-show-selected-data-from-combobox/29943982#29943982", "title": "Vba code to show selected data from combobox", "body": "<p>well I did it with recordset.\nif someone know a simpler solution, I will be glad to lrn.\nthis is my code:</p>\n\n<pre><code>Dim dbs As ADODB.Connection\nDim id As String    \n\nSet dbs = CurrentProject.AccessConnection \nSet rsRep = New ADODB.Recordset \nSet rsRep.ActiveConnection = dbs \n\nrsRep.Open \"tblRep\" \n\nid = Me.cbPrvFirstName\nrsRep.MoveFirst\nrsRep.Find \"RepId=\" &amp; id\n\nMe.txtPrvLastName = rsRep.Fields(2)\nrsRep.Close      \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 0, "last_activity_date": 1430378419, "last_edit_date": 1430378419, "creation_date": 1430378021, "answer_id": 29961295, "question_id": 29940429, "link": "https://stackoverflow.com/questions/29940429/vba-code-to-show-selected-data-from-combobox/29961295#29961295", "title": "Vba code to show selected data from combobox", "body": "<p>You can pull in the value from another column within the combo box using the below code. By default <code>combo.value</code> will always give the value from the first column even if hidden.</p>\n\n<p>try\n<code>text=combo.column(x)</code></p>\n\n<p>in your case to retrieve <code>last name</code> it would be\n<code>text=combo.column(2)</code></p>\n\n<blockquote>\n  <p>where x is a NUMBER of the column you want to retrieve 0 being the first column</p>\n</blockquote>\n\n<p>You could also try an <strong>alternative</strong> - This works like a VLookup in excel if you are familiar with that.\n(Not as simple as the first option ;) )</p>\n\n<p><code>text=Dlookup(\"[last name]\",\"tblRep\",\"RepId=\" &amp; combo.value)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4845787, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205143672044366/picture?type=large", "display_name": "Yael Zur", "link": "https://stackoverflow.com/users/4845787/yael-zur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 989, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1430378419, "creation_date": 1430301771, "last_edit_date": 1430305162, "question_id": 29940429, "link": "https://stackoverflow.com/questions/29940429/vba-code-to-show-selected-data-from-combobox", "title": "Vba code to show selected data from combobox", "body": "<p>I have an Access 2010 form which has a combobox listing three columns:</p>\n\n<ol>\n<li>ID</li>\n<li>first name</li>\n<li>last name</li>\n</ol>\n\n<p>The combo box is bound to a table containing this data. The ID column in the combo box is hidden, it only shows the first and last name.</p>\n\n<p>When the user selects a row only the the first name is shown. in the property section, I chose:</p>\n\n<ul>\n<li>Column Count: 3</li>\n<li>Column widths:0;3,3</li>\n<li>Bound Column: 1</li>\n</ul>\n\n<p>I made another text field and in the combobox I wrote the following vbcode:</p>\n\n<pre><code>text=combo.value\n</code></pre>\n\n<p>that shows in the text field the chosen ID.</p>\n\n<p>I want to show in another field (text\\combo?) the last name.\nHow can I do that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1430300376, "post_id": 29939770, "comment_id": 48000624, "body": "You get this error when the value is not found."}, {"owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1430300702, "post_id": 29939770, "comment_id": 48000874, "body": "What wrong with the code ? There is data in the policydetails sheet.  @GSerg"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1430300756, "post_id": 29939770, "comment_id": 48000921, "body": "Then the first column of that data does not contain what you currently have in <code>policynum</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430301314, "post_id": 29939770, "comment_id": 48001310, "body": "The simplest error control on avoiding that error (the equivalent of #N/A on a worksheet) is to put this one line above it <code>if cbool(application.countif(lookup_num.columns(1), policynum)) then _</code> If you wanted to do something more than just skip over it, you could even write an <code>Else</code> that sent the error to the immediate window or a msgbox."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1430305063, "post_id": 29939770, "comment_id": 48004061, "body": "I made a dummy sheet, and copied your code, the code worked fine. Try to copy column &quot;A&quot; from your &quot;PolicyDetails&quot; sheet into Column &quot;C&quot; in your Active sheet, then run the code to test if it works."}, {"owner": {"reputation": 1482, "user_id": 1627841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783cfd946ca2ba7c4f6a76926a2582e7?s=128&d=identicon&r=PG&f=1", "display_name": "The_Barman", "link": "https://stackoverflow.com/users/1627841/the-barman"}, "edited": false, "score": 0, "creation_date": 1430308609, "post_id": 29939770, "comment_id": 48006694, "body": "Are the policy numbers stored in the sheet as text... if the value in the cell looks like a number it will be converted to one... then you are vlookup a number to text... try &#39;Dim policynum As String&#39;."}, {"owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "edited": false, "score": 0, "creation_date": 1430356111, "post_id": 29939770, "comment_id": 48035263, "body": "@jeeped I never come across such error control line before."}, {"owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1430356123, "post_id": 29939770, "comment_id": 48035264, "body": "@Davesexcel i want to take from column C in the policydetails sheet."}, {"owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "reply_to_user": {"reputation": 1482, "user_id": 1627841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783cfd946ca2ba7c4f6a76926a2582e7?s=128&d=identicon&r=PG&f=1", "display_name": "The_Barman", "link": "https://stackoverflow.com/users/1627841/the-barman"}, "edited": false, "score": 0, "creation_date": 1430356127, "post_id": 29939770, "comment_id": 48035265, "body": "@The_Barman it is all numbers."}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1430318580, "creation_date": 1430318580, "answer_id": 29947049, "question_id": 29939770, "link": "https://stackoverflow.com/questions/29939770/unable-to-get-the-vlookup-to-work/29947049#29947049", "title": "Unable to get the vlookup to work", "body": "<p>There appears to be nothing wrong with your code.  You are seeing the result of what happens when you use the <code>WorksheetFunction</code> version of functions and no result is returned.  Specifically, they throw an error and interrupt execution of the VBA.  In this case, if you tried the same formula in the workbook instead of in VBA, you would get some form of error (<code>#N/A</code> or <code>#VALUE!</code> possibly).</p>\n\n<p>If you want to prevent this from happening, the easiest thing to do is to change to using <code>Application.VLookup</code> instead of <code>Application.WorksheetFunction.VLookup</code>.  Although there is no Intellisense to help with this function it behaves the same as the other except for error handling.  If the non-<code>WorksheetFunction</code> version of a function has an error, it will return the error instead of throwing it.  This allows you to check for an error and then carry on with your code.</p>\n\n<p>If you think you should be finding a value with <code>VLOOKUP</code> here then you can start checking for mismatches between text/numbers and other things like that.  I would check with formulas and not in VBA though.</p>\n\n<p>Here is an example of using the other functional form and trapping the error.</p>\n\n<pre><code>Sub LinkPolicyNum()\n    Dim r As Integer\n    Dim policynum As Variant\n    Dim lookup_num As Range\n    Dim policybox As Variant\n\n    r = ActiveCell.Row\n    'Row number of the Selected Cell\n\n    policynum = ActiveSheet.Cells(r, 3).Value\n\n    Set lookup_num = ThisWorkbook.Sheets(\"PolicyDetails\").Range(\"a1:z5000\")\n\n    policybox = Application.VLookup(policynum, lookup_num, 3, False)\n    'to match the policy number to the policy details\n\n    If IsError(policybox) Then\n        'possibly do something with the \"not found\" case\n    Else\n        MsgBox policynum\n        MsgBox policybox\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Reference on this issue: <a href=\"http://dailydoseofexcel.com/archives/2004/09/24/the-worksheetfunction-method/\" rel=\"nofollow\">http://dailydoseofexcel.com/archives/2004/09/24/the-worksheetfunction-method/</a></p>\n"}], "owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 29947049, "answer_count": 1, "score": 3, "last_activity_date": 1430318580, "creation_date": 1430300178, "last_edit_date": 1531164843, "question_id": 29939770, "link": "https://stackoverflow.com/questions/29939770/unable-to-get-the-vlookup-to-work", "title": "Unable to get the vlookup to work", "body": "<p>I run this set of codes and it returns an error: </p>\n\n<p>Run-time error '1004' Unable to get the Vlookup property of the WorksheetFunction class. </p>\n\n<p>I already have one vlookup in another sub routine. \nIs there anything wrong with this code ? I debug and the error appears at the policybox there. </p>\n\n<pre><code>Sub LinkPolicyNum()\nDim r As Integer\nDim policynum As Variant\nDim lookup_num As Range\nDim policybox As Variant\n\n\n    r = ActiveCell.Row\n    'Row number of the Selected Cell\n\n    policynum = ActiveSheet.Cells(r, 3).Value\n\n    Set lookup_num = ThisWorkbook.Sheets(\"PolicyDetails\").Range(\"a1:z5000\")\n\n    policybox = Application.WorksheetFunction.VLookup(policynum, lookup_num, 3, False)\n    'to match the policy number to the policy details\n\n    MsgBox policynum\n    MsgBox policybox\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 37, "user_id": 4841120, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3867fc60e9d348cc4265102b4377b6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Haider", "link": "https://stackoverflow.com/users/4841120/haider"}, "edited": false, "score": 0, "creation_date": 1431168204, "post_id": 29939606, "comment_id": 48386824, "body": "@Haider, you&#39;re very welcome. Can you accept my answer as a solution? Cheers, Maciej"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1430299776, "creation_date": 1430299776, "answer_id": 29939606, "question_id": 29939092, "link": "https://stackoverflow.com/questions/29939092/loop-through-user-defined-sheets-in-a-workbook/29939606#29939606", "title": "Loop through user defined Sheets in a workbook", "body": "<p>Try this:</p>\n\n<pre><code>Dim wshSrc As Worksheet, wshDst As Worksheet\nDim i As Integer, wshName As String\n\nOn Error Resume Next\n\nSet wshSrc = ThisWorkbook.Worksheets(\"Master\")\nFor i = 7 to 18\n    wshName = wshSrc.Range(\"O\" &amp; i)\n    Set wshDst = ThisWorkbook.Worksheets(wshName)\n    If Err.Number = 9 'worksheet does not exists (NA)\n        Err.Clear()\n        Goto SkipNext\n    End If\n    'here code to copy id's\nSkipNext:    '\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 4841120, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3867fc60e9d348cc4265102b4377b6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Haider", "link": "https://stackoverflow.com/users/4841120/haider"}, "is_accepted": true, "score": 0, "last_activity_date": 1431164948, "creation_date": 1431164948, "answer_id": 30138442, "question_id": 29939092, "link": "https://stackoverflow.com/questions/29939092/loop-through-user-defined-sheets-in-a-workbook/30138442#30138442", "title": "Loop through user defined Sheets in a workbook", "body": "<p>This worked better according to my case. </p>\n\n<pre><code>Sub Copyd()\nSheets(\"Master\").Select\nDim apr As String\nDim may As String\n\n    'Similarly for all the months till mar'\n\napr = Cells(4, 56).Value\nmay = Cells(5, 56).Value\n\n    'Assigned cell value for all the month till mar(Cell contains values\n    'like: apr,jan,NA) which are user defined\n\nDim i As Long\nFor i = 3 To 13\nWith Sheets(i).Activate\n\nIf ActiveSheet.Name = apr Then\nCall test\nActiveSheet.Name = apr\nThisWorkbook.Activate\nElse\nOn Error Resume Next\nEnd If\n\nIf ActiveSheet.Name = may Then\nCall test\nActiveSheet.Name = may\nThisWorkbook.Activate\nElse\nOn Error Resume Next\nEnd If\n\n   'Similarly for all the months till mar'\n\nEnd With\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4841120, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3867fc60e9d348cc4265102b4377b6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Haider", "link": "https://stackoverflow.com/users/4841120/haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 30138442, "answer_count": 2, "score": 0, "last_activity_date": 1431164948, "creation_date": 1430298459, "question_id": 29939092, "link": "https://stackoverflow.com/questions/29939092/loop-through-user-defined-sheets-in-a-workbook", "title": "Loop through user defined Sheets in a workbook", "body": "<p>Please check my problem...</p>\n\n<p>About the workbook: It has 13 sheets Sheet1 is \"Master\" and the rest 12 are named as month \"Apr\",\"May\"...etc...till \"Mar\".....</p>\n\n<p>In the \"master\" sheet user can defined the month he wants to format..User can defined values like(\"Apr\",\"NA\",\"Mar\")... the code should read this values enter by user and format the Sheets ONLY that match month name and skip NA.</p>\n\n<p>What the Code Should do:</p>\n\n<p>1) VBA should check the values in cells O7 to O18 which are user defined values like (Apr,Mar,Jan,NA)</p>\n\n<p>2) The code should then go to the worksheet with names apr to mar and skip NA..</p>\n\n<pre><code>Sub Copyd()\nDim apr As String\nDim may As String\n    'Similarly for all the months till mar'\napr = Cells(7, 15).Value\nmay = Cells(8, 15).Value\n    'Assigned cell value for all the month till mar(Cell contains values\n     'like (Ex: apr,jan,NA) which are user defined\nDim Months As Variant\nDim Month As Variant\nMonths = Array(jan, feb, mar, apr, may, jun, jul, _\n     aug, sep, oct, nov, dec)\nActiveSheet.Name = Months\nFor Each Month In Months\n   'formatting code here\nNext Month\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430297064, "post_id": 29938357, "comment_id": 47998350, "body": "Where is the OnTime call in your code?"}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430297403, "post_id": 29938357, "comment_id": 47998571, "body": "It is in the ThisWorkbook &#39;Sheet&#39; with code Private Sub Workbook_Open()  Application.OnTime TimeValue(&quot;09:20:30&quot;), &quot;Importer&quot;  End Sub"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430298031, "post_id": 29938357, "comment_id": 47998970, "body": "Importer expects a parameter that you&#39;re not passing into your call."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430298789, "post_id": 29938357, "comment_id": 47999439, "body": "Could you explain further?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430298982, "post_id": 29938357, "comment_id": 47999571, "body": "In your code you wrote: <code>Private Sub Importer(ByRef sDate As String)</code>. Which means, the Sub Importer has to start with a parameter called <code>sDate</code>. However, your OnTime call is <code>Application.OnTime TimeValue(&quot;09:20:30&quot;), &quot;Importer&quot;</code>. The parameter <code>sDate</code> is not passed in this call, so the run fails with message <code>Argument not optional</code>."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430299167, "post_id": 29938357, "comment_id": 47999702, "body": "Ahhh I see, completely missed that. What I have done is altered the shape of the macro midway through coding it and not changer the &quot;Importer&quot; on the ontime back to &quot;Main&quot;. Thank you for your help!"}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430299716, "post_id": 29938357, "comment_id": 48000086, "body": "well my question got answered so..."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1430300101, "post_id": 29938357, "comment_id": 48000404, "body": "No problem. To make it an mcve (as the question could anyway help other people), as @pnuts suggests, please remove all the code and let only the relevant parts (i.e. the Application On Time call on a side, and the Private Sub declaration on the other side). Then you might add your answer to the post so that anyone having the same problem of your in the future will find this thread helpful."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430300139, "post_id": 29938357, "comment_id": 48000428, "body": "I don&#39;t see why you&#39;re saying it isn&#39;t an mcve post. Everything required of an mcve post is in there. Downvoting someone on their first post which instantly got answered seems like a bit of a dickish thing to do tbh"}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430300196, "post_id": 29938357, "comment_id": 48000473, "body": "Obviously the question won&#39;t help others, it wasn&#39;t a problem with the code, it was me being retarded and calling the wrong macro. That&#39;s not going to help anyone"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1430300837, "post_id": 29938357, "comment_id": 48000981, "body": "It&#39;s not about you, it&#39;s about the content. @pnuts doesn&#39;t know you, but knows the community standards and is just suggesting to follow the &quot;M&quot; (minimal) part of the mcve definition to comply with those standards. Don&#39;t get upset (and please don&#39;t be offensive to other users), SO is a source of info for all developers so your question might definitely be helpful because many developers make the Application On Time call wrong because not passing a compulsory parameter. Please edit your question accordingly and add your answer, I&#39;m sure who gave you the downvote will revoke it."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430301175, "post_id": 29938357, "comment_id": 48001212, "body": "I don&#39;t think suggesting that someone was being dickish is offensive. I just think its a bit unfair, unfortunately I&#39;ve lost my log in for my other account as it was on a previous companies email but I had asked many many questions exactly like this before and not been persecuted. I asked a question and it got answered very quickly and it&#39;s obvious what the problem was. I posted alot of code because on this community people get mad at you if you don&#39;t. Absurd that I&#39;m being downvoted for it frankly. I&#39;ll post the answer but saying &#39;I was calling the wrong macro&#39; isn&#39;t going to help"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1430301361, "post_id": 29938357, "comment_id": 48001359, "body": "I think you really take it too much on the personal side. That&#39;s fine you&#39;ve solved your problem. The only thing I was trying to do is to make the post helpful to others in the spirit of SO"}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430301399, "post_id": 29938357, "comment_id": 48001380, "body": "I&#39;m only taking it personally because I&#39;m being downvoted. I couldn&#39;t care less otherwise"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430301435, "post_id": 29938357, "comment_id": 48001402, "body": "Your question is getting downvoted, not you. Never mind, the important thing is that your problem is solved now. I&#39;m going to make the edit to your question, if you don&#39;t like it just revert it pleae."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430301483, "post_id": 29938357, "comment_id": 48001442, "body": "Indeed, thank you very much for helping me solve it"}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1430301951, "post_id": 29940244, "comment_id": 48001801, "body": "This isn&#39;t the answer though, the answer was that I was trying to call the Importer directly rather than calling the &#39;Main&#39; sub first which in turn calls the Importer, if you looked at the code the paramater is passed in the call. By deleting my code you&#39;ve completely taken away the context."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430302058, "post_id": 29940244, "comment_id": 48001873, "body": "Ok, I give up. I&#39;ve reverted all."}], "tags": [], "owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "is_accepted": false, "score": 0, "last_activity_date": 1430302047, "last_edit_date": 1430302047, "creation_date": 1430301276, "answer_id": 29940244, "question_id": 29938357, "link": "https://stackoverflow.com/questions/29938357/macro-will-not-run-when-using-application-on-time-method/29940244#29940244", "title": "Macro will not run when using application.on time method", "body": "<p>It happened that upon redesigning my code, I hadn't changed the application.ontime upon opening the workbook to call a different macro. I changed the macro it called and now it works</p>\n"}], "owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 876, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1430302047, "creation_date": 1430296340, "last_edit_date": 1430302030, "question_id": 29938357, "link": "https://stackoverflow.com/questions/29938357/macro-will-not-run-when-using-application-on-time-method", "title": "Macro will not run when using application.on time method", "body": "<p>I'm trying to run a macro automatically overnight for my company using the task scheduler on windows and application.ontime method. When I run the macro by myself it works perfectly but it will not work for some reason if it is called via the application.ontime function. </p>\n\n<p>Quite annoying as it is making a fully automated process not automated. Could someone help me out? See where there is problems in the code? </p>\n\n<p>The problem before was that it was not passing the <code>sDate</code> variables over to the <code>Importer Sub</code> so I tried to change that but now I am getting an argument not optional error message instead. Any ideas?</p>\n\n<pre><code>Option Explicit\nPublic wb1 As Workbook\nPublic wb2 As Workbook\nPublic r As Range\nPublic CSVPath As String\nPublic sProduct As Worksheet\nPublic sPivot As Worksheet\nPublic sCSVSheet As Worksheet\nPublic sAccount As Worksheet\nPublic sButton As Worksheet\nPublic sMainSheet As Worksheet\nPublic sRawData As Worksheet\nPublic sFileNames As Worksheet\nPublic sFrontSheet As Worksheet\nPublic sBankHolidays As Worksheet\nPublic sMATrades As Worksheet\nPublic sMAOverview As Worksheet\nPublic sMarketData As Worksheet\nPublic sMAFXEffect As Worksheet\nPublic sDate As String\nPublic rDate As Double\nPublic lastRunDate As Date\nPublic LRow As Integer\nPublic LRow2 As Integer\nPublic ARow As Integer\nPublic sRange As Range\nPublic Abr As String\nPublic FixingName As String\nPublic FixingReport As String\nPublic X As Variant\nPublic Y As Double\nPublic i As Integer\nPublic k As Integer\nPublic p As Integer\nPublic Ccy As String\nPublic sYear As Long\nPublic sMonth As Long\nPublic sDay As Long\nPublic pt As PivotTable\nPublic ws As Worksheet\nPublic wb As Workbook\nPublic Text As String\nPublic ActualDate As Long\nPublic Col As Long\n\nSub Main()\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nSetSheets\n\nsCSVSheet.Visible = True\nsPivot.Visible = True\nsFileNames.Visible = True\nsBankHolidays.Visible = True\n\nIf sButton.Range(\"ManualDateYesNo\").Value = \"Yes\" Then\n\nsDate = sButton.Range(\"ManualDate\").Value\nrDate = sButton.Range(\"ManualDate\").Value\n\nDataDeleter\n\nDo While rDate &lt;&gt; DateValue(Date)\nIf Weekday(sDate) &lt;&gt; 1 And Weekday(sDate) &lt;&gt; 7 And Not IsNumeric(Application.Match(rDate, sBankHolidays.Columns(\"A:A\"), 0)) Then\n\nImporter (sDate)\n\nEnd If\n\nrDate = rDate + 1\nsDate = Format(DateSerial(Year(rDate), Month(rDate), Day(rDate)), \"dd/MM/yyyy\")\nLoop\n\nsButton.Range(\"ManualDateYesNo\").Value = \"No\"\n\nElse\n\nIf Weekday(Date) = 2 Then\nsDate = Date - 3\nElse\nsDate = Date - 1\nEnd If\n\nIf Weekday(Date) = 1 Or Weekday(Date) = 7 Then ThisWorkbook.Close False\n\nLRow = sBankHolidays.Range(\"A1048576\").End(xlUp).Row\n\nFor Each r In sBankHolidays.Range(\"A2:A\" &amp; LRow)\nIf Weekday(Date) = 2 Then\n    If r + 3 = Date Then ThisWorkbook.Close False\nElse\n    If r + 1 = Date Then ThisWorkbook.Close False\nEnd If\nNext\n\nDataDeleter\n\nImporter (sDate)\n\nEnd If\n\nRefreshPivots\n\nsMainSheet.Columns(\"C:C\").NumberFormat = \"m/d/yyyy\"\nsRawData.Columns(\"E:E\").NumberFormat = \"m/d/yyyy\"\nsProduct.Columns(\"C:C\").NumberFormat = \"m/d/yyyy\"\nsAccount.Columns(\"D:D\").NumberFormat = \"m/d/yyyy\"\n\nCalculate\n\nsCSVSheet.Visible = False\nsPivot.Visible = False\nsFileNames.Visible = False\nsBankHolidays.Visible = False\nsFrontSheet.Activate\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nApplication.Quit\n\nEnd Sub\n\nPrivate Sub Importer(ByRef sDate As String)\n\n'On Error GoTo ErrorHandler\n\nSetSheets\n\nsYear = Year(sDate)\nsMonth = Month(sDate)\nsDay = Day(sDate)\n\nlastRunDate = sPivot.Range(\"A1000000\").End(xlUp).Value\n\nsDate = Format(DateSerial(sYear, sMonth, sDay), \"yyyyMMdd\")\nrDate = DateValue(Format(DateSerial(sYear, sMonth, sDay), \"dd/MM/yyyy\"))\n\nLRow = sFileNames.Range(\"A1048576\").End(xlUp).Row\n\nFor Each sRange In sFileNames.Range(\"A2:A\" &amp; LRow)\n\nAbr = sRange.Offset(0, 1).Value\nFixingName = sRange.Offset(0, 2).Value\n\nFixingReport = \"P:\\Systemfiles\\SharedDocs\\\" &amp; Abr &amp; \"\\Fixing Files\\\" &amp; sDate &amp; \" \" &amp; FixingName &amp; \".xls\"\n\nWorkbooks.Open Filename:=FixingReport, ReadOnly:=True\n\nSetSheets2\n\nsMAOverview.Range(\"D9:D43\").Copy\n\nWith sProduct\nLRow = .Range(\"A1048576\").End(xlUp).Row + 1\n\n.Range(\"E\" &amp; LRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n.Range(\"C\" &amp; LRow).Value = rDate\n.Range(\"B\" &amp; LRow).Value = sRange\n.Activate\n.Range(\"A\" &amp; LRow - 1).AutoFill Destination:=Range(\"A\" &amp; LRow - 1 &amp; \":A\" &amp; LRow)\nEnd With\n\nRefreshPivots\n\nEnd If\n\nNext\n\nLRow = sPivot.Range(\"A1048576\").End(xlUp).Row\n\nLRow = sMAFXEffect.Columns(\"B:B\").Find(\"DBIN\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row + 1\nLRow2 = sMAFXEffect.Range(\"B65000\").End(xlUp).Row\n\nk = LRow\n\nFor Each r In sMAFXEffect.Range(\"B\" &amp; LRow &amp; \":B\" &amp; LRow2)\nsMAFXEffect.Activate\nsMAFXEffect.Range(Cells(k, 3), Cells(k, 11)).Copy\n\nWith sAccount\nLRow = .Range(\"A1048576\").End(xlUp).Row + 1\n.Activate\n.Range(\"E\" &amp; LRow).PasteSpecial Paste:=xlPasteValues\nCcy = .Range(\"M\" &amp; LRow).Value\nARow = sMAFXEffect.Columns(\"B:B\").Find(Ccy, searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n.Range(\"O\" &amp; LRow).Value = sMAFXEffect.Cells(ARow, 11).Value\n.Range(\"D\" &amp; LRow).Value = rDate\n.Range(\"C\" &amp; LRow).Value = r\n.Range(\"Q\" &amp; LRow).Value = sRange\n.Activate\n.Range(\"A\" &amp; LRow - 1 &amp; \":B\" &amp; LRow - 1).AutoFill Destination:=Range(\"A\" &amp; LRow - 1 &amp; \":B\" &amp; LRow)\n.Range(\"P\" &amp; LRow - 1).AutoFill Destination:=Range(\"P\" &amp; LRow - 1 &amp; \":P\" &amp; LRow)\n.Range(\"N\" &amp; LRow - 1).AutoFill Destination:=Range(\"N\" &amp; LRow - 1 &amp; \":N\" &amp; LRow)\n'.Range(\"N\" &amp; LRow).Value = .Range(\"E\" &amp; LRow).Value * .Range(\"O\" &amp; LRow).Value\nk = k + 1\nEnd With\nNext\n\nwb2.Close False\n\nNext\n\nFor Each pt In sPivot.PivotTables\n    pt.PivotCache.Refresh\nNext\n\nWith sPivot\nLRow = .Range(\"A1048576\").End(xlUp).Row\nrDate = .Range(\"A\" &amp; LRow).Value\nLRow = .Range(\"I1048576\").End(xlUp).Row\nEnd With\n\nFor Each r In sPivot.Range(\"I3:I\" &amp; LRow)\nWith sRawData\n.Activate\nLRow = .Range(\"A1048576\").End(xlUp).Row + 1\n.Range(\"D\" &amp; LRow).Value = r\n.Range(\"C\" &amp; LRow).Value = r.Offset(0, 1).Value\n.Range(\"E\" &amp; LRow).Value = rDate\n.Range(\"A\" &amp; LRow - 1).AutoFill Destination:=Range(\"A\" &amp; LRow - 1 &amp; \":A\" &amp; LRow)\n.Range(\"B\" &amp; LRow - 1).AutoFill Destination:=Range(\"B\" &amp; LRow - 1 &amp; \":B\" &amp; LRow)\n.Range(\"F\" &amp; LRow - 1 &amp; \":CB\" &amp; LRow - 1).AutoFill Destination:=Range(\"F\" &amp; LRow - 1 &amp; \":CB\" &amp; LRow)\nIf .Range(\"K\" &amp; LRow).Value = 0 Then .Range(\"K\" &amp; LRow).EntireRow.Delete\n\nIf .Range(\"J\" &amp; LRow).Value = \"True\" Then\nText = .Range(\"C\" &amp; LRow).Text &amp; .Range(\"D\" &amp; LRow).Text &amp; CDbl(.Range(\"F\" &amp; LRow).Value)\nX = Application.Match(Text, .Columns(\"A:A\"), 0)\n.Range(\"S\" &amp; LRow).GoalSeek Goal:=0, ChangingCell:=Range(\"AK\" &amp; X)\nEnd If\n\nEnd With\nNext\n\nLRow = sPivot.Range(\"L1048576\").End(xlUp).Row\n\nFor Each r In sPivot.Range(\"L3:L\" &amp; LRow)\nWith sMainSheet\n.Activate\nLRow = .Range(\"A1048576\").End(xlUp).Row + 1\n.Range(\"B\" &amp; LRow).Value = r\n.Range(\"C\" &amp; LRow).Value = rDate\n.Range(\"A\" &amp; LRow - 1).AutoFill Destination:=Range(\"A\" &amp; LRow - 1 &amp; \":A\" &amp; LRow)\n.Range(\"D\" &amp; LRow - 1 &amp; \":BP\" &amp; LRow - 1).AutoFill Destination:=Range(\"D\" &amp; LRow - 1 &amp; \":BP\" &amp; LRow)\n.Range(\"BB\" &amp; LRow).ClearContents\n.Range(\"BB\" &amp; LRow).Value = .Range(\"AW\" &amp; LRow).Value\nEnd With\nNext\n\nsButton.Range(\"LastRun\").Value = rDate\n\nExit Sub\n\nErrorHandler:\n\nFor Each wb In Workbooks\nIf wb.Name &lt;&gt; ThisWorkbook.Name Then wb.Close False\nNext\n\nMsgBox Err.Description &amp; Err.Source\n\nEnd Sub\n\nPublic Sub DataDeleter()\n\nFor Each ws In wb1.Worksheets\nOn Error Resume Next\nIf ws.Name = \"Main Sheet\" Or ws.Name = \"Raw Data\" Or ws.Name = \"Product\" Or ws.Name = \"Account\" Then\nCol = Sheets(ws.Name).Rows(\"1:1\").Find(\"Date\", lookat:=xlWhole, searchorder:=xlByColumns, searchdirection:=xlPrevious).Column\nX = Application.Match(rDate, Sheets(ws.Name).Columns(Col), 0)\nLRow = Sheets(ws.Name).Range(\"A1048576\").End(xlUp).Row\nSheets(ws.Name).Rows(X &amp; \":\" &amp; LRow).EntireRow.Delete\nEnd If\nOn Error GoTo 0\nNext\n\nEnd Sub\n\nPublic Sub RefreshPivots()\n\nFor Each ws In Worksheets\n    For Each pt In ws.PivotTables\n        pt.PivotCache.Refresh\n    Next\nNext\n\nEnd Sub\n\nPublic Sub SetSheets()\n\nSet wb1 = ThisWorkbook\n\nSet sProduct = wb1.Sheets(\"Product\")\nSet sPivot = wb1.Sheets(\"Pivot\")\nSet sCSVSheet = wb1.Sheets(\"CSVSheet\")\nSet sAccount = wb1.Sheets(\"Account\")\nSet sButton = wb1.Sheets(\"Button Sheet\")\nSet sRawData = wb1.Sheets(\"Raw Data\")\nSet sMainSheet = wb1.Sheets(\"Main Sheet\")\nSet sFileNames = wb1.Sheets(\"File Names\")\nSet sFrontSheet = wb1.Sheets(\"Front Sheet\")\nSet sBankHolidays = wb1.Sheets(\"Bank Holidays\")\n\nEnd Sub\nPublic Sub SetSheets2()\n\nSet wb2 = ActiveWorkbook\n\nSet sMATrades = wb2.Sheets(\"MA Trades\")\nSet sMAOverview = wb2.Sheets(\"MA Overview\")\nSet sMarketData = wb2.Sheets(\"Market Data\")\nSet sMAFXEffect = wb2.Sheets(\"MA FX Effect\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1430340016, "post_id": 29952734, "comment_id": 48028896, "body": "Fantastic piece of work Mr. Toomey.. Thank you..  I will make sure this lesson learned stays with me!!!"}, {"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1430370272, "post_id": 29952734, "comment_id": 48039240, "body": "Mr. Toomey, i found the optimal solution. In the end I had to use the column function, not the itemdata function."}, {"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1430370438, "post_id": 29952734, "comment_id": 48039306, "body": "One question if you have a second.  Why am i frequently having to change the syntax of references to forms from using the brackets (e.g. [forms]![frmStaticDataDepartments]![cboTeams] to the syntax mentioned in the answer i posted??   In the previously mentioned syntax, i often find myself getting error messages."}, {"owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "reply_to_user": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 1, "creation_date": 1430411218, "post_id": 29952734, "comment_id": 48065822, "body": "My suggestion is to get away from the bracket syntax (Microsoft calls it &quot;expression syntax&quot;) and use the dot notation instead in code. I think the expression syntax is a holdover from the old versions of Access. The only time you need to use it is in the property pages and in the query designer, but in code it&#39;s better to use the dot syntax, which also gives you intellisense/autocomplete. P.S. Did my answer on the subform question about setting focus help too, I hope?"}], "tags": [], "owner": {"reputation": 5111, "user_id": 1359088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f4ffb15d50db85cc68143626a8e0046?s=128&d=identicon&r=PG", "display_name": "James Toomey", "link": "https://stackoverflow.com/users/1359088/james-toomey"}, "is_accepted": true, "score": 2, "last_activity_date": 1430335358, "creation_date": 1430335358, "answer_id": 29952734, "question_id": 29938282, "link": "https://stackoverflow.com/questions/29938282/returning-multiple-values-from-a-combo-box-reference/29952734#29952734", "title": "Returning multiple values from a combo box reference", "body": "<p>It sounds like your combo box has 2 columns, like this:\n<img src=\"https://i.stack.imgur.com/6it2p.png\" alt=\"enter image description here\"></p>\n\n<p>with the column count set to 2:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8qDIp.png\" alt=\"enter image description here\"></p>\n\n<p>and the bound column is set to the 2nd column (or whatever column has text value):</p>\n\n<p><img src=\"https://i.stack.imgur.com/w3qKU.png\" alt=\"enter image description here\"></p>\n\n<p>When you use <code>.Value</code>, it will get the value of the bound column only. To get the value of a different column, you can use <code>.ItemData(colNum)</code>, like this:</p>\n\n<pre><code>st_Sql = \"UPDATE tblStaticDataDepartments01 SET tblStaticDataDepartments01.IDMacroProcesso = \" &amp; Forms(\"frmStaticDataDepartments01\").cboTeams.ItemData(0) &amp; \" WHERE (((tblStaticDataDepartments01.MacroProcesso) is null))\"\n</code></pre>\n\n<p>The columns are zero-based, so to retrieve the first column you use <code>ItemData(0)</code>, second column use <code>ItemData(1)</code>, and so on. This is kind of confusing because the property page of the \"Column Count\" setting is 1-based.</p>\n\n<p>Microsoft's examples make it look like you can use the ItemData function using expression syntax like this, but this did NOT work for me in my copy of Access 2003. However, the code I gave you should work fine.</p>\n\n<pre><code>st_Sql = \"UPDATE tblStaticDataDepartments01 SET tblStaticDataDepartments01.IDMacroProcesso = [Forms]![frmStaticDataDepartments01]![cboTeams].[ItemData](0) WHERE (((tblStaticDataDepartments01.MacroProcesso) is null))\"\n</code></pre>\n\n<p>You can retrieve the value of ANY column and row (not just the selected row) using the Column function, in case you ever have that need. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192660.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff192660.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1430416074, "post_id": 29959404, "comment_id": 48068688, "body": "Thanks again Mr. Toomey. That was quite a useful bit to take in.  This weekend I will respond on the setting focus question (thanks in advance for the answer).  I need to test it in my database."}], "tags": [], "owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "is_accepted": false, "score": 0, "last_activity_date": 1430370298, "creation_date": 1430370298, "answer_id": 29959404, "question_id": 29938282, "link": "https://stackoverflow.com/questions/29938282/returning-multiple-values-from-a-combo-box-reference/29959404#29959404", "title": "Returning multiple values from a combo box reference", "body": "<pre><code>st_Sql = \"UPDATE tblStaticDataDepartments01 SET tblStaticDataDepartments01.IDMacroProcesso = '\" &amp; Form_frmStaticDataDepartments01.cboTeams.Column(1) &amp; \"' WHERE (((tblStaticDataDepartments01.MacroProcesso) is null))\"\n</code></pre>\n\n<p>Application.DoCmd.RunSQL (st_Sql)</p>\n"}], "owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 29952734, "answer_count": 2, "score": 0, "last_activity_date": 1594644806, "creation_date": 1430296129, "last_edit_date": 1594644806, "question_id": 29938282, "link": "https://stackoverflow.com/questions/29938282/returning-multiple-values-from-a-combo-box-reference", "title": "Returning multiple values from a combo box reference", "body": "<p>I have a combo box which shows two bits of data, a name and it's unique ID number.  I have set it up so there are two columns displayed when the user clicks on it prior to selecting the record.  I am trying to source the value in the combo box to use in an update query. The below string works fine to source the name (text) and make an update but what I cant effectively do is source the unique ID number.  I have tried by putting '.value in front put id does not help.</p>\n\n<p>This works fine to update the text value of the control 'cboTeams':</p>\n\n<pre><code>st_Sql = \"UPDATE tblStaticDataDepartments01 SET tblStaticDataDepartments01.MacroProcesso = [Forms]![frmStaticDataDepartments01]![cboTeams] WHERE (((tblStaticDataDepartments01.MacroProcesso)is null))\"\n</code></pre>\n\n<p>Application.DoCmd.RunSQL (st_Sql)</p>\n\n<p>This DOES not work when trying to retrieve the numerical value:</p>\n\n<pre><code>st_Sql = \"UPDATE tblStaticDataDepartments01 SET tblStaticDataDepartments01.IDMacroProcesso = [Forms]![frmStaticDataDepartments01]![cboTeams].[Value] WHERE (((tblStaticDataDepartments01.MacroProcesso)is null))\"\n</code></pre>\n\n<p>Application.DoCmd.RunSQL (st_Sql)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430296878, "post_id": 29938191, "comment_id": 47998229, "body": "a) try <code>If Round(wsPlany.Cells(k, 1).value2, 0) = Round(datu, 0)</code> to remove floating point errors from consideration and b) try <code>If CLng(wsPlany.Cells(k, 1).value2) = CLng(datu)</code> to remove text that look like numbers from consideration (e.g. <i>&quot;1&quot;</i> \u2260 <i>1</i>)."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1430297155, "post_id": 29938191, "comment_id": 47998395, "body": "But I mean if it works for 2...n, it should logically work for 1 too as they are all just simply written values in a cells (the 1 is no different from 2 apart from being 1 and not 2). I will, however, try this."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1430297337, "post_id": 29938191, "comment_id": 47998531, "body": "What datatypes are used for <code>k</code> and <code>datu</code>?"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 1, "creation_date": 1430297733, "post_id": 29938191, "comment_id": 47998775, "body": "I have actually figured out the problem... I was wrong - the &quot;1&quot; is stored as string, the other ones as integer and have solved it now =)."}], "answers": [{"tags": [], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "is_accepted": true, "score": 2, "last_activity_date": 1430299579, "creation_date": 1430299579, "answer_id": 29939521, "question_id": 29938191, "link": "https://stackoverflow.com/questions/29938191/true-for-all-values-but-1-cannot-figure-out-why-vba/29939521#29939521", "title": "True for all values but 1, cannot figure out why (VBA)", "body": "<p>A simple addition of 1 line where I turn the values to <code>Integers</code> no matter what data type they were before solved the problem.</p>\n\n<pre><code>For k = 7 To wsPlany.UsedRange.Rows.Count\n    'turns the values to integers first\n    wsPlany.Cells(k, 1).Value = CInt(wsPlany.Cells(k,1))\n\n    If wsPlany.Cells(k, 1) = datu Then\n        'code here\n    End If\nNext k\n</code></pre>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 29939521, "answer_count": 1, "score": 0, "last_activity_date": 1430299579, "creation_date": 1430295902, "question_id": 29938191, "link": "https://stackoverflow.com/questions/29938191/true-for-all-values-but-1-cannot-figure-out-why-vba", "title": "True for all values but 1, cannot figure out why (VBA)", "body": "<p>My loop goes over a range of cells and compares the values:</p>\n\n<pre><code>For k = 7 To wsPlany.UsedRange.Rows.Count\n    If wsPlany.Cells(k, 1) = datu Then\n        'code here\n    End If\nNext k\n</code></pre>\n\n<p>Basically the cells are cells with numbers, <code>1, 2, 3 ...</code> and the <code>datu</code>is a number too. It all works but for the value 1 and I cannot figure out why.</p>\n\n<p>Even debug.printing something like: wsPlany.Cells(k, 1), datu and comparing them into next line confirms that if value is 2 or higher, it will return true for that line, if it is 1 exactly, it returns false as if it were comparing with other number (but I see they are the same as they are side by side in debug.print).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1430296381, "creation_date": 1430296381, "answer_id": 29938378, "question_id": 29938071, "link": "https://stackoverflow.com/questions/29938071/listobject-table-row-count/29938378#29938378", "title": "ListObject Table Row Count", "body": "<p>The ListObject property you are looking for is the <code>.DataBodyRange</code>.</p>\n\n<pre><code>    Dim myWorkSheet As Worksheet, myTable As ListObject, countRows As Long\n    Set myWorkSheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n    Set myTable = myWorkSheet.ListObjects(\"Table1\")\n    countRows = myTable.DataBodyRange.Rows.Count\n    Debug.Print countRows\n</code></pre>\n\n<p>A comprehensive list of the ListObject properties is available at: <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.listobject.aspx\" rel=\"nofollow\">ListObject Interface</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8571026, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f73befd61de7264a0a6dfecddf647480?s=128&d=identicon&r=PG", "display_name": "TomO-2043", "link": "https://stackoverflow.com/users/8571026/tomo-2043"}, "is_accepted": false, "score": 2, "last_activity_date": 1504726783, "last_edit_date": 1504726783, "creation_date": 1504726448, "answer_id": 46083044, "question_id": 29938071, "link": "https://stackoverflow.com/questions/29938071/listobject-table-row-count/46083044#46083044", "title": "ListObject Table Row Count", "body": "<p>Responding late in-case Google search brings user here:\nI found this problem as well. DataBodyRange object does not exist unless there are two rows of data. Not just two empty rows, but two rows of data in at least one column.\nWhat I have found to work reliably is to test if DataBodyRange exists:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>If Not TableListObject.DataBodyRange is Nothing Then\r\n  Debug.Print \"Data Rows Count=\", TableListObject.DataBodyRange.Rows.Count\r\n Else\r\n  Debug.Print \"No Data in Table detected\"\r\nEnd if</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 303, "user_id": 4693151, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/68067bad908acb1ca2d6c4595ae556da?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/4693151/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12402, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1504726783, "creation_date": 1430295558, "last_edit_date": 1531161705, "question_id": 29938071, "link": "https://stackoverflow.com/questions/29938071/listobject-table-row-count", "title": "ListObject Table Row Count", "body": "<p>I have an excel table with one header row and one data body row. I want to count the data body rows. When I'm trying to check how many rows my table has with</p>\n\n<pre><code>Set myWorkSheet= ActiveWorkbook.Worksheets(\"Sheet1\")\nSet myTable= myWorkSheet.ListObjects(\"Table1\")\ncountrows = myTable.ListRows.Count\n</code></pre>\n\n<p><code>countrows</code> contains <code>0</code>. If the has 2 or more rows, it gives the right row number. Why does it say 0 for one row ans is it the best way to count the rows or are there better ones?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Found out whats causing the problem. I use this lines to clear the table before i fill it again:</p>\n\n<pre><code>If tblChart.ListRows.Count &gt;= 1 Then\n    myTable.DataBodyRange.Delete\nEnd If\n</code></pre>\n\n<p>After that operation the table looks like I described it. Without it and modifying the table to look like I described the table it worked. But why is it causing this problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1430294905, "post_id": 29937811, "comment_id": 47997083, "body": "I&#39;d guess that you forgot to write the array back to the range at the end."}, {"owner": {"reputation": 693, "user_id": 4478535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cac7e1c914834ce39a218d4837cbd90?s=128&d=identicon&r=PG&f=1", "display_name": "hc91", "link": "https://stackoverflow.com/users/4478535/hc91"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1430294981, "post_id": 29937811, "comment_id": 47997124, "body": "oh, okay, thanks. Would i need to write the array within each <code>if</code> and <code>end if</code>?"}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 1, "creation_date": 1430295793, "post_id": 29937811, "comment_id": 47997565, "body": "Yaou can write the array in one go to the range after the calculaton been completed.. like <code>range(&quot;XX:XX&quot;) = valsf</code>."}, {"owner": {"reputation": 693, "user_id": 4478535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cac7e1c914834ce39a218d4837cbd90?s=128&d=identicon&r=PG&f=1", "display_name": "hc91", "link": "https://stackoverflow.com/users/4478535/hc91"}, "reply_to_user": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1430301156, "post_id": 29937811, "comment_id": 48001200, "body": "That&#39;s great, thanks @kitapmitap."}], "owner": {"reputation": 693, "user_id": 4478535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cac7e1c914834ce39a218d4837cbd90?s=128&d=identicon&r=PG&f=1", "display_name": "hc91", "link": "https://stackoverflow.com/users/4478535/hc91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430300340, "creation_date": 1430294809, "last_edit_date": 1531164843, "question_id": 29937811, "link": "https://stackoverflow.com/questions/29937811/storing-and-processing-range-values-in-an-array", "title": "Storing and processing range values in an array", "body": "<p>While storing range values as a variant and looping through them i'm having trouble actually changing the value of, for example, </p>\n\n<pre><code>valsf(i, h) = (valsf(i - 1, h) + valsf(i + 1, h)) / 2 \n</code></pre>\n\n<p>It will only change when I make it </p>\n\n<pre><code>Cells(i, h) = (valsf(i - 1, h) + valsf(i + 1, h)) / 2\n</code></pre>\n\n<p>Why is this?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1430297435, "post_id": 29937622, "comment_id": 47998595, "body": "you can use the bookmark to get the current position and do the refresh and set the bookmark again."}, {"owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1430299444, "post_id": 29937622, "comment_id": 47999890, "body": "Could you provide an example of how this works? I&#39;ve tried storing the <code>.Form.Bookmark</code> in a variant before calling <code>Requery</code>, but I get a &#39;Not a valid bookmark&#39; error when I try to set it again"}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1430299978, "post_id": 29937622, "comment_id": 48000302, "body": "I assuming you do mean &quot;Form&quot; wherever you wrote &quot;Report&quot; in your question, as reports in Access are not editable at all. - Please edit the question, that it will be properly indexed for searching."}, {"owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "edited": false, "score": 0, "creation_date": 1430309548, "post_id": 29937622, "comment_id": 48007378, "body": "Yes, you were correct, and I have now edited my question"}], "answers": [{"comments": [{"owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "edited": false, "score": 0, "creation_date": 1430309582, "post_id": 29939663, "comment_id": 48007421, "body": "That&#39;s exactly what I was looking for. Many thanks for your help"}], "tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 2, "last_activity_date": 1430299907, "creation_date": 1430299907, "answer_id": 29939663, "question_id": 29937622, "link": "https://stackoverflow.com/questions/29937622/reselect-active-cell-in-access-subform-following-requery/29939663#29939663", "title": "Reselect active cell in Access subform following requery", "body": "<p>You can set the focus to the previously selected control of a form by extending your VBA code as follows.</p>\n\n<pre><code>Private Sub Form_AfterUpdate()\n\n    Dim lngCurrentPos As Long\n    Dim strControlName as String\n\n    With Form_frmMain.subfrm_Results_Review\n        strControlName = .Form.ActiveControl.Name\n        lngCurrentPos = .Form.Recordset.AbsolutePosition\n        .Requery\n        .Form.Recordset.AbsolutePosition = lngCurrentPos\n        .Form.Controls(strControlName).SetFocus\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1461, "user_id": 1337396, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad03d8f041b3705744145d1226803713?s=128&d=identicon&r=PG", "display_name": "Niall", "link": "https://stackoverflow.com/users/1337396/niall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 29939663, "answer_count": 1, "score": 1, "last_activity_date": 1430309305, "creation_date": 1430294198, "last_edit_date": 1430309305, "question_id": 29937622, "link": "https://stackoverflow.com/questions/29937622/reselect-active-cell-in-access-subform-following-requery", "title": "Reselect active cell in Access subform following requery", "body": "<p>I have a subform displaying a data set containing up to 200 rows and up to 35 columns. When a user selects a cell a part of the UI is enabled allowing them to add/edit records, following which the subform needs to refresh so the user can see the effect of their changes, which is triggered by the <code>AfterUpdate</code> event.</p>\n\n<p>The issue I have is that when the subform is refreshed, by calling <code>Requery</code>, the focus is shifted to the top left of the subform, meaning that not only can the user not see the effect of their change, but they have also lost their place.</p>\n\n<p>I have managed to get the subform to reselect the current record by capturing and setting the <code>Form.Recordset.AbsolutePosition</code> property, but can't find any way to set the focus to the column that the user was in previously.</p>\n\n<p>The code I have currently is:</p>\n\n<pre><code>Private Sub Form_AfterUpdate()\n\n    Dim lngCurrentPos As Long\n\n    With Form_frmMain.subfrm_Results_Review\n        lngCurrentPos = .Form.Recordset.AbsolutePosition\n        .Requery\n        .Form.Recordset.AbsolutePosition = lngCurrentPos\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>But is there anyway to set focus back to a specific cell? It seems there should be a way as this must be a common problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1430295026, "post_id": 29937513, "comment_id": 47997150, "body": "I am a little bit confused, aren&#39;t you already saving it? maybe you can change <code>ActiveWorkbook.Save</code> to <code>y.Save</code>"}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "reply_to_user": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1430295408, "post_id": 29937513, "comment_id": 47997345, "body": "I wrote the activeWorkbook.Save trying to save but it didnt work. I have also tried your suggestion now but it is still not working"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1430296171, "post_id": 29937513, "comment_id": 47997799, "body": "seems a little strange that you&#39;re closing thisworkbook and then trying to save &#39;y&#39;. try swapping the lines around, so x.close is the very last thing you do?"}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430296531, "post_id": 29937513, "comment_id": 47998010, "body": "thank you, i deleted this line(its not importat to close x) and tried the following to save.. but it didnt work y.Sheets(&quot;endofdaydividends&quot;).save fileName:=&quot;T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv&quot;, FileFormat:=xlCSV, CreateBackup:=False"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1430298627, "post_id": 29937513, "comment_id": 47999345, "body": "try <code>y.SaveAs Filename:=&quot;T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv&quot;, FileFormat:=xlCSV, CreateBackup:=False</code>we might have to do something further to ensure it overwrites the current file completely (maybe delete current file first or turn off alerts)."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1430320679, "post_id": 29937513, "comment_id": 48016788, "body": "Hint: Look at <a href=\"http://stackoverflow.com/a/5798392/380384\">stackoverflow.com/a/5798392/380384</a> and use a <code>FileSystemObject</code> for fast file operations."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430295968, "post_id": 29938126, "comment_id": 47997673, "body": "it does not work. The code runs, but when i check the folder it still appears the file from yesterday"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430301863, "post_id": 29938126, "comment_id": 48001730, "body": "I have updated the answer with small code to delete previous file. Lets give it a try."}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430301903, "post_id": 29938126, "comment_id": 48001766, "body": "is this going to delete the macro file or only close? because i will need it after"}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430302450, "post_id": 29938126, "comment_id": 48002139, "body": "i can not delete my first file, because it has the macro and i will need it after"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430304758, "post_id": 29938126, "comment_id": 48003836, "body": "this will delete the CSV file. Is your macro in the CSV file or in the source file?"}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430304954, "post_id": 29938126, "comment_id": 48003973, "body": "yes, it deleted the CSV file. but the problem is that when i run the macro, it does not recognize the &quot;endofdaydividends&quot; because it was already deleted.. do you know how to insert a code to create this csv file? Then the macro will recognize and save it"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430309376, "post_id": 29938126, "comment_id": 48007241, "body": "I have updated the code, now I update all the code you need and put some explanations. I do not have an excel right now that is why I could not test it. If you let me know about the result I will see what I can do."}, {"owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430312301, "post_id": 29938126, "comment_id": 48009631, "body": "Thanks for your patience. The code runs, but still does not save the y file in the specified folder"}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1430313402, "post_id": 29938126, "comment_id": 48010562, "body": "I have made some final tuning in the code, it had some problems. This may work fine now. I finally had the chance to try it out and working. If it is working you can accept the answer :)"}], "tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": false, "score": 0, "last_activity_date": 1430313331, "last_edit_date": 1430313331, "creation_date": 1430295706, "answer_id": 29938126, "question_id": 29937513, "link": "https://stackoverflow.com/questions/29937513/how-to-save-a-file-in-a-specific-folder/29938126#29938126", "title": "how to save a file in a specific folder", "body": "<p>Can you please try following?</p>\n\n<p>Code to delete your previous file, need to add to beginning of your function before pasting the new value:</p>\n\n<pre><code>SetAttr \"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\", vbNormal\nKill \"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\"\n</code></pre>\n\n<p>Code to save the new file:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=\"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\", FileFormat:=xlCSV, CreateBackup:=False\n</code></pre>\n\n<p>UPDATED CODE: Your Code should look like this. What we do here, we first delete existing CSV file then, create a new file and rename the active sheet to what you desire then paste required values and save the new created workbook as new CSV.</p>\n\n<pre><code>Sub move_to_csvfile()\nDim x As Workbook\nDim y As Workbook\nDim strPath As String\nDim fileName As String\nDim dd As String\n\nSet x = ThisWorkbook\n    On Error Resume Next\n    SetAttr \"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\", vbNormal\n    Kill \"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\"\n    On Error GoTo 0\nSet y = Workbooks.Add\n    y.ActiveSheet.Name = \"endofdaydividends\"\n    Application.DisplayAlerts = False\n    x.Sheets(\"Code\").Range(\"A:F\").EntireColumn.Copy\n    Application.DisplayAlerts = True\n    Application.DisplayAlerts = False\n    y.Sheets(\"endofdaydividends\").Range(\"A1\").PasteSpecial\n    Application.DisplayAlerts = True\n    y.SaveAs fileName:=\"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\", FileFormat:=xlCSV, CreateBackup:=False\n    x.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1632, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430313331, "creation_date": 1430293908, "last_edit_date": 1531164843, "question_id": 29937513, "link": "https://stackoverflow.com/questions/29937513/how-to-save-a-file-in-a-specific-folder", "title": "how to save a file in a specific folder", "body": "<p>I have been working in a code to paste the data from the vba file to another file. The name of the file which i paste the data is always \"endofdaydividends\" and i need to save this file everyday in the same place and replace the old one. I would like to save in my desktop. </p>\n\n<pre><code>Sub move_to_csvfile()\nDim x As Workbook\nDim y As Workbook\nDim strPath As String\nDim fileName As String\nDim dd As String\n\nSet x = ThisWorkbook\nSet y = Workbooks.Open(\"T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv\")\n    Application.DisplayAlerts = False\n    x.Sheets(\"Code\").Range(\"A:F\").EntireColumn.Copy\n    Application.DisplayAlerts = True\n    Application.DisplayAlerts = False\n    y.Sheets(\"endofdaydividends\").Range(\"A1\").PasteSpecial\n    Application.DisplayAlerts = True\n    x.Close False\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>With this code, i close the macro file and leave opened only the \"endofdaydividends\" file. Does anyone know how to add a command to save it on my folder? I need to save in this address \n<code>T:\\CTG\\EDM\\Current EDM LDN\\MacroEODDividend\\endofdaydividends.csv</code></p>\n"}, {"tags": ["excel", "password-protection", "sendkeys", "vbe", "vba"], "comments": [{"owner": {"reputation": 193, "user_id": 1586303, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/42736209bde3ef40c23d29827309c2bb?s=128&d=identicon&r=PG", "display_name": "Chuck", "link": "https://stackoverflow.com/users/1586303/chuck"}, "edited": false, "score": 0, "creation_date": 1435328226, "post_id": 29937422, "comment_id": 50169522, "body": "I would like to hear the answer to this, too. I am trying to unlock the VBA code for a Word document from within Excel VBA code, then update the code in the Word doc, then lock it back up again. Using examples like this, I end up inserting the password into the Excel code (not what I wanted). I tried putting a <code>Public Sub</code> into the Word doc and running that from Excel, but it seems to get quite confused. Any thoughts???"}], "owner": {"reputation": 11, "user_id": 4845135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21503120c1d4dbcae98e1e265e045147?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/4845135/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1009, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1430293649, "creation_date": 1430293649, "last_edit_date": 1531161705, "question_id": 29937422, "link": "https://stackoverflow.com/questions/29937422/excel-vba-how-to-set-a-password-to-another-vbproject-programmaticaly", "title": "EXCEL VBA: How to set a password to another VBProject programmaticaly", "body": "<p>I have created a vba code that creates a new .xlms file, adding some code to that file and then my problem is that i cannot protect the VBPoject of that new file. Instead, i wrongly password protect the current VBProject (not the new one, that i want).\nHere is my code:</p>\n\n<pre><code>Sub Create_xlsm_File()\n\nDim VBProj As VBIDE.VBProject\nDim VBComp As VBIDE.VBComponent\nDim CodeMod As VBIDE.CodeModule\nDim LineNum As Long\nDim ModuleName As String\nDim NewProcAsString As String\nDim myDir1 As String\nDim FileName1 As String\nDim FolderPath1 As String\nDim FilePath1 As String\nDim Pass1 As String\nDim SheetName1FileName1 As String\nDim MasterName As String\nDim NoOfSheets As Integer\nDim Newbook1 As Workbook\n\nMasterName = Environ(\"UserName\")\nmyDir1 = \"C:\\Users\\\" &amp; MasterName &amp; \"\\Desktop\"\nFileName1 = \"LockedVBAProject\"\nPass1 = \"123\"\nNoOfSheets = 1\nSheetName1FileName1 = \"Sh1\"\nModuleName = \"Module1\"\n'----Creating and Save File-------------------------------------------\nSet Newbook1 = Workbooks.Add\nNewbook1.Activate\nFilePath1 = myDir1 &amp; \"\\\" &amp; FileName1\nApplication.SheetsInNewWorkbook = NoOfSheets\nActiveWorkbook.Sheets(1).Name = SheetName1FileName1\nNewbook1.SaveAs Filename:=FilePath1, FileFormat:=xlOpenXMLWorkbookMacroEnabled, Password:=Pass1\nWorkbooks(FileName1).Close False\n'----Add the VBA code to the File-------------------------------------\nApplication.Workbooks.Open (FilePath1), Password:=Pass1\nWorkbooks(FileName1).Activate\n'=====================================================================\n'This part is the problem. the SendKeys applied to current project and\n' not to the desired \"LockedVBAProject\"\n'=====================================================================\nWith Application\n      '//execute the controls to lock the project\\\\\n      .VBE.CommandBars(\"Menu Bar\").Controls(\"Tools\") _\n                  .Controls(\"VBAProject Properties...\").Execute\n\n      '//activate 'protection'\\\\\n      .SendKeys \"^{TAB}\", True\n\n      '//CAUTION: this either checks OR UNchecks the\\\\\n      '//\"Lock Project for Viewing\" checkbox, if it's already\\\\\n      '//been locked for viewing, then this will UNlock it\\\\\n      .SendKeys \"{ }\", True\n\n      '//enter password (password is 123 in this example)\\\\\n      .SendKeys \"{TAB}\" &amp; \"123\", True\n\n      '//confirm password\\\\\n      .SendKeys \"{TAB}\" &amp; \"123\", True\n\n      '//scroll down to OK key\\\\\n      .SendKeys \"{TAB}\", True\n\n      '//click OK key\\\\\n      .SendKeys \"{ENTER}\", True\n\n      'the project is now locked - this takes effect\n      'the very next time the book's opened...\nEnd With\n'=====================================================================\n'=====================================================================\n'=====================================================================\n\nSet VBProj = ActiveWorkbook.VBProject\nSet VBComp = VBProj.VBComponents.Add(vbext_ct_StdModule)\nVBComp.Name = ModuleName\nSet VBComp = VBProj.VBComponents(\"ThisWorkbook\")\nSet CodeMod = VBComp.CodeModule\n\nWith CodeMod\n    LineNum = .CreateEventProc(\"Open\", \"Workbook\")\n    LineNum = LineNum + 2\n    NewProcAsString = \"MsgBox \"\"Hola !!!\"\"\"\n    CodeMod.InsertLines LineNum, NewProcAsString\nEnd With\n\nWorkbooks(FileName1).Save\nWorkbooks(FileName1).Close False\n\n\nThisWorkbook.Activate\n\nEnd Sub\n</code></pre>\n\n<p>Can you please help me to select and password protect the desired new \"LockedVBAProject\" file?\nAny other suggestions?\nThanks in advance for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1430293467, "post_id": 29937292, "comment_id": 47996252, "body": "You are using <i>name</i> as a string type variable but assigning it the row number value. Thi9s means that <i>name</i> is <i>&quot;2&quot;</i> and not <i>2</i> and cannot be used when a number is required."}, {"owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "edited": false, "score": 0, "creation_date": 1430294004, "post_id": 29937292, "comment_id": 47996588, "body": "okay i have fixed that but when i debug going line by line, it just totally skips the for loop. @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430294899, "post_id": 29937292, "comment_id": 47997078, "body": "I&#39;m unclear on whether my code modifications below have resolved the problem or not. If you still require some debugging help could you add any changes to your question with an edit?"}, {"owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "edited": false, "score": 0, "creation_date": 1430296248, "post_id": 29937292, "comment_id": 47997854, "body": "@jeeped i solved it ! Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1430382152, "last_edit_date": 1430382152, "creation_date": 1430294107, "answer_id": 29937585, "question_id": 29937292, "link": "https://stackoverflow.com/questions/29937292/for-loop-doesnt-run-in-worksheet/29937585#29937585", "title": "For loop doesn&#39;t run in worksheet", "body": "<p>You loop is going from <code>1</code> to the row count, but using <code>i</code> with a step of <code>-1</code>  which means you are counting backwards, never getting to <code>...Rows.Count</code>. </p>\n\n<p>Change the order of your loop, going from <code>Rows.Count</code> to <code>1</code> if you want to use a step like that or use <code>Step 1</code> to count up by one (the default).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1430381559, "last_edit_date": 1430381559, "creation_date": 1430294140, "answer_id": 29937602, "question_id": 29937292, "link": "https://stackoverflow.com/questions/29937292/for-loop-doesnt-run-in-worksheet/29937602#29937602", "title": "For loop doesn&#39;t run in worksheet", "body": "<ol>\n<li>You are using name as a string type variable but assigning it the row number value. This means that name is <code>\"2\"</code> and not <code>2</code> and cannot be used when a number is required. It is also never a good idea to call your variables the same as reserved words like VBA's <code>.Name</code>.</li>\n<li>You are using <em>Step -1</em> but starting at <em>1</em> which means it will never go anywhere.</li>\n</ol>\n\n<p>That should be enough to get the loop going.</p>\n\n<pre><code>Sub LinkName()\n\n    Dim i As Long\n    Dim ShtUsedRange, ShtUsedRangeCol\n    Dim rw As Long\n    Dim lu As Variant\n    Dim lookup_range As Range\n    Dim box As Variant\n\n\n    'Count the used rows in the Activesheet\n    ShtUsedRange = ActiveSheet.UsedRange.Rows.Count\n\n    'Count the used Column in the Activesheet\n    ShtUsedRangeCol = ActiveSheet.UsedRange.Columns.Count\n\n    'Row of the Selected Cell\n    rw = ActiveCell.Row\n\n    'name of the row selected\n    lu = ActiveSheet.Cells(rw, 1).Value\n\n    'MsgBox lu\n\n    'set the range of the Policy details to search from\n    Set lookup_range = ThisWorkbook.Sheets(\"PolicyDetails\").Range(\"a1:z5000\")\n\n    'there is no error control here if there is no match\n    'to match the name to the policy details\n    box = Application.WorksheetFunction.VLookup(lu, lookup_range, 1, False)\n\n    MsgBox box\n\n    For i = 1 To ThisWorkbook.Sheets(\"PolicyComponents\").Rows.Count Step 1\n        If ThisWorkbook.Sheets(\"PolicyComponents\").Cells(i, 1).Value = box Then\n            ThisWorkbook.Sheets(\"Policy Viewer\").Cells(16, 2) = _\n              ThisWorkbook.Sheets(\"PolicyComponents\").Cells(i, 4).Value\n            'probably best to exit hte loop here unless you want to try and catch other matches\n            'Exit For\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I renamed two of your variables. I didn't know the nature of the value (number/text/date) you were actually trying to look up so I left it as a variant.</p>\n"}], "owner": {"reputation": 129, "user_id": 4828121, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-D9dLGexUfKs/AAAAAAAAAAI/AAAAAAAAAHU/eJ1A4lL_4mk/photo.jpg?sz=128", "display_name": "Sherry Kong", "link": "https://stackoverflow.com/users/4828121/sherry-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 29937602, "answer_count": 2, "score": 2, "last_activity_date": 1471195695, "creation_date": 1430293270, "last_edit_date": 1531164843, "question_id": 29937292, "link": "https://stackoverflow.com/questions/29937292/for-loop-doesnt-run-in-worksheet", "title": "For loop doesn&#39;t run in worksheet", "body": "<p>I tried to link the common columns together but when I click a cell in PolicyComponents Sheet, the for loop doesn't run - it just exits the sub. </p>\n\n<p><strong>Code Snippet:</strong></p>\n\n<pre><code>Sub LinkName()\n\nDim i As Long\nDim ShtUsedRange, ShtUsedRangeCol\nDim name As String\nDim name1 As String\nDim lookup_range As Range\nDim box\n\n\nShtUsedRange = ActiveSheet.UsedRange.Rows.Count\n'Count the used rows in the Activesheet\nShtUsedRangeCol = ActiveSheet.UsedRange.Columns.Count\n'Count the used Column in the Activesheet\n\nname = ActiveCell.Row\n'Row of the Selected Cell\n\nname1 = ActiveSheet.Cells(name, 1).Value\n'name of the row selected\n\n'MsgBox name1\n\nSet lookup_range = ThisWorkbook.Sheets(\"PolicyDetails\").Range(\"a1:z5000\")\n'set the range of the Policy details to search from\n\nbox = Application.WorksheetFunction.VLookup(name1, lookup_range, 1, False)\n'to match the name to the policy details\n\nMsgBox box\n\nFor i = 1 To ThisWorkbook.Sheets(\"PolicyComponents\").Rows.Count Step -1\n\nIf ThisWorkbook.Sheets(\"PolicyComponents\").Cells(i, 1).Value = box Then\n ThisWorkbook.Sheets(\"Policy Viewer\").Cells(16, 2).Value = ThisWorkbook.Sheets(\"PolicyComponents\").Cells(i, 4).Value\n\nEnd If    \nNext i    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "html-lists", "element", "google-search"], "answers": [{"tags": [], "owner": {"reputation": 4434, "user_id": 138469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aogBK.jpg?s=128&g=1", "display_name": "Vincent De Smet", "link": "https://stackoverflow.com/users/138469/vincent-de-smet"}, "is_accepted": false, "score": 0, "last_activity_date": 1430296847, "last_edit_date": 1430296847, "creation_date": 1430295613, "answer_id": 29938094, "question_id": 29937191, "link": "https://stackoverflow.com/questions/29937191/strip-multiple-li-elements-from-google-with-vba/29938094#29938094", "title": "Strip multiple li elements from google with VBA", "body": "<p>You need to iterate the collections returned to you by your <code>getelementsbytagname</code> call instead of returning only the first element with the array index <code>(0)</code></p>\n\n<p>I had a similar project, below are some tips &amp; my approach for your reference, it might assist you in working &amp; maintaining the code in the future:</p>\n\n<p>First, Instead of using <code>CreateObject</code> I prefer to reference the Object Libraries that expose the COM objects, this gives me the ability to browse the functions and properties of each object <code>F2</code> and gives me code completion (speed &amp; less bugs) within VBA editor (<code>F7</code> takes you back to code view).</p>\n\n<p><img src=\"https://i.stack.imgur.com/pfdMS.png\" alt=\"Add Reference Dialog\"></p>\n\n<p>Giving me documentation and code completion:\n<img src=\"https://i.stack.imgur.com/iOWNb.png\" alt=\"Code completion\"></p>\n\n<p>Also, use these const for clarity</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'see ready state : https://msdn.microsoft.com/en-us/library/ie/ms534361(v=vs.85).aspx\nConst READYSTATE_UNINITIALIZED = 0\nConst READYSTATE_LOADING = 1\nConst READYSTATE_LOADED = 2\nConst READYSTATE_INTERACTIVE = 3\nConst READYSTATE_COMPLETE = 4\n</code></pre>\n\n<p>Finally, using <code>DOMDocument60</code> to parse the XML into a Document Object Model in memory.</p>\n\n<p>and <code>MSHTML.HTMLDocument</code> to parse the HTML document and iterate the table rows.</p>\n\n<p>Below is code where I iterate all returned rows from a table within a html document embedded in the initial XML document returned by the webserver:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim xmlDoc As DOMDocument60\nSet xmlDoc = GetXMLDocument(\"http://www.nbg.ge/rss.php\")\n\n'extract publication date\nDebug.Print xmlDoc.getElementsByTagName(\"pubDate\")(0).Text\n\n'unwrap html document from CDATA in \"//item/description\" element\nDim htmlDoc As New MSHTML.HTMLDocument\nhtmlDoc.body.innerHTML = xmlDoc.SelectNodes(\"//item/description\")(0).Text\n\n'extract table data from html document\nDim tr As IHTMLElement, td As IHTMLElement\nFor Each tr In htmlDoc.getElementsByTagName(\"tr\")\n    For Each td In tr.Children\n        'each cell in current row\n        Debug.Print \"  \" &amp; td.innerHTML\n    Next td\n    'next row\n    Debug.Print \"-----\"\nNext tr\n</code></pre>\n\n<p>Sample Data returned by webservice I was calling:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;rss version=\"2.0\"&gt;\n&lt;channel&gt;\n&lt;title&gt;RSS NBG Currency Rates&lt;/title&gt;\n&lt;link&gt;https://www.nbg.gov.ge/index.php?m=236&amp;lang=geo&lt;/link&gt;\n&lt;description&gt;Currency Rates&lt;/description&gt;\n&lt;language&gt;geo&lt;/language&gt;\n&lt;copyright&gt;Copyright 2015, NBG&lt;/copyright&gt;\n&lt;pubDate&gt;Wed, 29 Apr 2015 12:39:50 +0400&lt;/pubDate&gt;\n&lt;lastBuildDate&gt;Wed, 29 Apr 2015 12:39:50 +0400&lt;/lastBuildDate&gt;\n&lt;managingEditor&gt;alex@proservice.ge&lt;/managingEditor&gt;\n&lt;webMaster&gt;alex@proservice.ge&lt;/webMaster&gt;\n&lt;item&gt;\n&lt;title&gt;Currency Rates 2015-04-29&lt;/title&gt;\n&lt;link&gt;https://www.nbg.gov.ge/index.php?m=236&amp;lang=geo&lt;/link&gt;\n&lt;description&gt;\n&lt;![CDATA[\n&lt;table border=\"0\"&gt;\n    &lt;tr&gt; \n        &lt;td&gt;AED&lt;/td&gt; \n        &lt;td&gt;10 \u10d0\u10e0\u10d0\u10d1\u10d4\u10d7\u10d8\u10e1 \u10d2\u10d0\u10d4\u10e0\u10d7\u10d8\u10d0\u10dc\u10d4\u10d1\u10e3\u10da\u10d8 \u10e1\u10d0\u10d0\u10db\u10d8\u10e0\u10dd\u10d4\u10d1\u10d8\u10e1 \u10d3\u10d8\u10e0\u10f0\u10d0\u10db\u10d8&lt;/td&gt; \n        &lt;td&gt;6.2858&lt;/td&gt; \n        &lt;td&gt;&lt;img src=\"https://www.nbg.gov.ge/images/green.gif\"&gt;&lt;/td&gt; \n        &lt;td&gt;0.0640&lt;/td&gt; &lt;/tr&gt;&lt;tr&gt; &lt;td&gt;AMD&lt;/td&gt; &lt;td&gt;1000 \u10e1\u10dd\u10db\u10ee\u10e3\u10e0\u10d8 \u10d3\u10e0\u10d0\u10db\u10d8&lt;/td&gt; \n        &lt;td&gt;4.8676&lt;/td&gt; \n        &lt;td&gt;&lt;img src=\"https://www.nbg.gov.ge/images/green.gif\"&gt;&lt;/td&gt; \n        &lt;td&gt;0.0414&lt;/td&gt; \n    &lt;/tr&gt;\n   &lt;/table&gt;\n]]&gt;\n&lt;/description&gt;\n&lt;pubDate&gt;Wed, 29 Apr 2015 12:39:50 +0400&lt;/pubDate&gt;\n&lt;guid&gt;\nhttps://www.nbg.gov.ge/index.php?m=236&amp;lang=geo&amp;date=2015-04-29\n&lt;/guid&gt;\n&lt;/item&gt;\n&lt;/channel&gt;\n&lt;/rss&gt;\n</code></pre>\n\n<p>and the function that actually gets the document from the webserver (only works if you added the references as shown in above pictures)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function GetXMLDocument(url As String) As MSXML2.DOMDocument60\n    Dim xhr As New XMLHTTP60\n    Dim doc As New DOMDocument60\n    Dim msg As String\n\n    With xhr\n        .Open bstrMethod:=\"GET\", bstrUrl:=url, varAsync:=False\n\n        On Error GoTo SendError\n        .send\n        On Error GoTo 0\n\n        'http status codes - http://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n        '200 = SUCCESS - OK\n        If .readyState = READYSTATE_COMPLETE And .Status = 200 Then\n            'Debug.Print .responseText\n            doc.LoadXML (.responseText)\n        Else\n            msg = \"Error\" &amp; vbNewLine &amp; \"Ready state: \" &amp; .readyState &amp; _\n                vbNewLine &amp; \"HTTP request status: \" &amp; .Status\n            GoTo Error\n        End If\n\n    End With\n\n    Set GetXMLDocument = doc\nExit Function\n\nSendError:\n    'by default access to data source accross internet dissabled\n    'go to internet options &amp; under security&gt;custom level&gt;Misc&gt;access data sources accross domains&gt; enable\n    'see: http://stackoverflow.com/a/17402920\n    MsgBox \"Make sure access data sources accross domains is enabled under internet options&gt;security&gt;custom\", vbOKOnly, \"Could not send request to server\"\n\nError:\n    MsgBox msg, vbOKOnly, \"Unexpected Error\"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4845155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd2a0edb28b6595ec450f6e2efc06376?s=128&d=identicon&r=PG&f=1", "display_name": "Jbv", "link": "https://stackoverflow.com/users/4845155/jbv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1430296847, "creation_date": 1430292929, "question_id": 29937191, "link": "https://stackoverflow.com/questions/29937191/strip-multiple-li-elements-from-google-with-vba", "title": "Strip multiple li elements from google with VBA", "body": "<p>My goal is to strip all Google search results from page 1 with VBA to Excel. Until so far I managed to strip the first result. The head, link and date are stored in cells 4, 5, 6. I now have to make a loop for the other li's, but I can't get it straight. Also the function that stores the date isn't very optimal coded I think. Anyone who knows the answer?</p>\n\n<pre><code>Sub XMLHTTP()\n\nDim url As String, lastRow As Long\nDim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object, link As Object, Objdatum As Object, Ddatum As Object\nDim start_time As Date\nDim end_time As Date\n\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDim cookie As String\nDim result_cookie As String\n\nstart_time = Time\nDebug.Print \"start_time:\" &amp; start_time\n\nFor i = 2 To lastRow\n\n    url = \"https://www.google.co.in/search?q=\" &amp; Cells(i, 3) &amp; \"Skipr\" &amp; \"&amp;rnd=\" &amp; WorksheetFunction.RandBetween(1, 10000)\n\n    Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n    XMLHTTP.Open \"GET\", url, False\n    XMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n    XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n    XMLHTTP.send\n\n        Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = XMLHTTP.ResponseText\n    Set objResultDiv = html.getelementbyid(\"rso\")\n\n    Set objH3 = objResultDiv.getelementsbytagname(\"H3\")(0)\n    Set link = objH3.getelementsbytagname(\"a\")(0)\n    Set Objdatum = objResultDiv.getelementsbytagname(\"span\")(2)\n\n    str_text = Replace(link.innerHTML, \"&lt;EM&gt;\", \"\")\n    str_text = Replace(str_text, \"&lt;/EM&gt;\", \"\")\n\n    dat_text = Objdatum.innerHTML\n\n    Cells(i, 4) = str_text\n    Cells(i, 5) = link.href\n    Cells(i, 6) = dat_text\n\n    DoEvents\nNext\n\nend_time = Time\nDebug.Print \"end_time:\" &amp; end_time\n\nDebug.Print \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\nMsgBox \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "office-interop", "powerpoint-2013"], "answers": [{"comments": [{"owner": {"reputation": 5337, "user_id": 1832951, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7e5c583b9d8881ca7ac73d8f149be12a?s=128&d=identicon&r=PG", "display_name": "chipbk10", "link": "https://stackoverflow.com/users/1832951/chipbk10"}, "edited": false, "score": 0, "creation_date": 1430384336, "post_id": 29947939, "comment_id": 48046904, "body": "Thanks for your answer. I do the same as your approach, but still cannot save the presentation. More in details: I check on font &quot;Gills Sans Light&quot;, and this font in code is embeddable, but it still prevents from saving, and ends up showing that the &quot;Gills Sans Light&quot; is not true type as you saw in the picture. It seems to be a bug from Powerpoint itself when PowerPoint cannot detect this font as &quot;not embeddable&quot;"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 5337, "user_id": 1832951, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7e5c583b9d8881ca7ac73d8f149be12a?s=128&d=identicon&r=PG", "display_name": "chipbk10", "link": "https://stackoverflow.com/users/1832951/chipbk10"}, "edited": false, "score": 0, "creation_date": 1430408141, "post_id": 29947939, "comment_id": 48063557, "body": "Do you have multiple versions of Gill Sans Light on the system, perhaps?  It&#39;s supplied by several different font foundries in several different formats. Multiple versions might cause problems.  Or suppose I use Gill Sans Light in one non-embeddable format from Adobe, for example. I send you the file, you&#39;ve got Gill Sans Light in TT format so Windows substitutes that, but when it comes to saving, PPT&#39;s unable to embed the actual used font because it&#39;s not on the system.  Or t&#39;other way around; the substituted font is PS, which can&#39;t be embedded."}, {"owner": {"reputation": 5337, "user_id": 1832951, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7e5c583b9d8881ca7ac73d8f149be12a?s=128&d=identicon&r=PG", "display_name": "chipbk10", "link": "https://stackoverflow.com/users/1832951/chipbk10"}, "edited": false, "score": 0, "creation_date": 1430728301, "post_id": 29947939, "comment_id": 48168493, "body": "So, what do I have to do?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 5337, "user_id": 1832951, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7e5c583b9d8881ca7ac73d8f149be12a?s=128&d=identicon&r=PG", "display_name": "chipbk10", "link": "https://stackoverflow.com/users/1832951/chipbk10"}, "edited": false, "score": 0, "creation_date": 1430747687, "post_id": 29947939, "comment_id": 48180119, "body": "If the presentation has to be distributed to other people, use only install-embeddable fonts or better, use only fonts that will be common to all systems so you don&#39;t need to embed fonts at all."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1430320644, "creation_date": 1430320644, "answer_id": 29947939, "question_id": 29936998, "link": "https://stackoverflow.com/questions/29936998/how-to-check-whether-the-presentation-contains-some-non-standard-font/29947939#29947939", "title": "How to check whether the presentation contains some non-standard font?", "body": "<p>Nothing's preventing you from saving the presentation as such; the message is telling you that because the presentation uses fonts that are not embeddable, you cannot save the presentation with the fonts embedded.</p>\n\n<p>You can look at the presentation's .Fonts collection and determine for each font whether it's embeddable or not:</p>\n\n<pre><code>Sub FontList()\n    Dim x As Long\n    With ActivePresentation.Fonts\n        For x = 1 To .Count\n            Debug.Print .Item(x).Name &amp; vbTab &amp; .Item(x).Embeddable\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>If you find unembeddable fonts, you could opt to save the presentation w/o embedding fonts (third parameter to SaveAs set to False rather than True).</p>\n\n<p>Or probably more practically, use the .Fonts.Replace to substitute a different font (one that IS embeddable).  I expect you'd have to create your own replacement table for this; if the font's not present on your system, Windows will have substituted another font, but PPT won't tell you what font it is.</p>\n"}], "owner": {"reputation": 5337, "user_id": 1832951, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7e5c583b9d8881ca7ac73d8f149be12a?s=128&d=identicon&r=PG", "display_name": "chipbk10", "link": "https://stackoverflow.com/users/1832951/chipbk10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2099, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593763365, "creation_date": 1430292398, "last_edit_date": 1593763365, "question_id": 29936998, "link": "https://stackoverflow.com/questions/29936998/how-to-check-whether-the-presentation-contains-some-non-standard-font", "title": "How to check whether the presentation contains some non-standard font?", "body": "<p>I am writing an AddIn PowerPoint. I am using PowerPoint 2013, C#, Visual Studio 2013.</p>\n\n<p>When I open an existing presentation which is created and modified on another computer (e.g., Mac or Linux), some texts in non-standard true type fonts prevent me from saving the presentation.</p>\n\n<p><img src=\"https://i.stack.imgur.com/scyl6.png\" alt=\"error\"></p>\n\n<p>So my question is</p>\n\n<p>1) Is it possible to catch and handle this error in code?</p>\n\n<p>2) Or is there any way to check whether a presentation contains some non-standard font?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word", "ribbon", "word-2013"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2348535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355b84be3a7de0d7f49dd72d0d5f6ea5?s=128&d=identicon&r=PG", "display_name": "user2348535", "link": "https://stackoverflow.com/users/2348535/user2348535"}, "edited": false, "score": 0, "creation_date": 1430294802, "post_id": 29936544, "comment_id": 47997019, "body": "Thanks, Eugene for your comment. I will check this out. I would make the assumption that different XML markups would cause two different tabs to appear?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1, "user_id": 2348535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355b84be3a7de0d7f49dd72d0d5f6ea5?s=128&d=identicon&r=PG", "display_name": "user2348535", "link": "https://stackoverflow.com/users/2348535/user2348535"}, "edited": false, "score": 0, "creation_date": 1430309174, "post_id": 29936544, "comment_id": 48007084, "body": "Yes, most probably you have got two different tabs defined."}, {"owner": {"reputation": 1, "user_id": 2348535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355b84be3a7de0d7f49dd72d0d5f6ea5?s=128&d=identicon&r=PG", "display_name": "user2348535", "link": "https://stackoverflow.com/users/2348535/user2348535"}, "edited": false, "score": 0, "creation_date": 1430309743, "post_id": 29936544, "comment_id": 48007569, "body": "I&#39;ve checked both templates and both have the same XML schema markup: &lt;customUI  \tonLoad=&quot;Ribbon_OnLoad&quot; \txmlns=&quot;<a href=\"http://schemas.microsoft.com/office/2006/01/customui\" rel=\"nofollow noreferrer\">schemas.microsoft.com/office/2006/01/customui</a>&quot;&gt;"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1, "user_id": 2348535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355b84be3a7de0d7f49dd72d0d5f6ea5?s=128&d=identicon&r=PG", "display_name": "user2348535", "link": "https://stackoverflow.com/users/2348535/user2348535"}, "edited": false, "score": 0, "creation_date": 1430310049, "post_id": 29936544, "comment_id": 48007834, "body": "Did you have a chance to compare the content?"}, {"owner": {"reputation": 1, "user_id": 2348535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355b84be3a7de0d7f49dd72d0d5f6ea5?s=128&d=identicon&r=PG", "display_name": "user2348535", "link": "https://stackoverflow.com/users/2348535/user2348535"}, "edited": false, "score": 0, "creation_date": 1430311844, "post_id": 29936544, "comment_id": 48009280, "body": "Yes, I have checked that the XML is exactly the same in both templates. There is something I&#39;m missing and I can&#39;t spot it. I don&#39;t know where to look next!"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1430291109, "creation_date": 1430291109, "answer_id": 29936544, "question_id": 29936410, "link": "https://stackoverflow.com/questions/29936410/template-ribbon-bar-in-word-2010-and-2013/29936544#29936544", "title": "Template Ribbon Bar in Word 2010 and 2013", "body": "<p>It is not clear what XML markup you use for Word 2010 and 2013 templates. Are they different? Why do you need to have different custom UI?</p>\n\n<p>You can read about the Fluent UI (aka Ribbon UI) in the following series of articles in MSDN:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa338202(v=office.12).aspx\" rel=\"nofollow\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa338199(v=office.12).aspx\" rel=\"nofollow\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3)</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa722523(v=office.12).aspx\" rel=\"nofollow\">Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3)</a></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 2348535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/355b84be3a7de0d7f49dd72d0d5f6ea5?s=128&d=identicon&r=PG", "display_name": "user2348535", "link": "https://stackoverflow.com/users/2348535/user2348535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 741, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430291109, "creation_date": 1430290651, "last_edit_date": 1430290714, "question_id": 29936410, "link": "https://stackoverflow.com/questions/29936410/template-ribbon-bar-in-word-2010-and-2013", "title": "Template Ribbon Bar in Word 2010 and 2013", "body": "<p>Two years ago, a client, using Word 2010, asked me to create a template with an extra tab  for the Ribbon Bar containing some special buttons linked to the template's VBA.</p>\n\n<p>They are now moving over to Word 2013 and want me to update their template to 2013 (i.e. removing the Compatibility Mode as well as adding a couple of extra buttons to their specialized tab. At this stage I have only updated their template to 2013 and not added any more buttons to their Ribbon tab. I have also put their updated template in the correct folder where all the templates are kept in my system.</p>\n\n<p>I asked them to send me a document created in their 2010 version of the template, opened it in my 2013 version and found that TWO specialized tabs are added to the Ribbon Bar: one from their 2010 version and the other one from the 2013 version.</p>\n\n<p>Can anyone advise me, please, whether they are stuck with two specialized tabs whenever they open documents created earlier in Word 2010 or is there something I can do in the 2013 version to prevent this?</p>\n\n<p>By the way, I use the Office Custom UI Editor for the XML work.</p>\n"}, {"tags": ["vba", "ms-access", "validationrule"], "comments": [{"owner": {"reputation": 4434, "user_id": 138469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aogBK.jpg?s=128&g=1", "display_name": "Vincent De Smet", "link": "https://stackoverflow.com/users/138469/vincent-de-smet"}, "edited": false, "score": 0, "creation_date": 1430292818, "post_id": 29934526, "comment_id": 47995841, "body": "are you using access forms to enter the data? how is the data entered?"}, {"owner": {"reputation": 259, "user_id": 2654245, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/351f0b3ad208c35829acaf6489debd5e?s=128&d=identicon&r=PG", "display_name": "Thor My", "link": "https://stackoverflow.com/users/2654245/thor-my"}, "reply_to_user": {"reputation": 4434, "user_id": 138469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aogBK.jpg?s=128&g=1", "display_name": "Vincent De Smet", "link": "https://stackoverflow.com/users/138469/vincent-de-smet"}, "edited": false, "score": 0, "creation_date": 1430338408, "post_id": 29934526, "comment_id": 48027969, "body": "yes, I&#39;m using Access form. the data is entered via bound form. the validation rules are saved in the form&#39;s source table, not in the form&#39;s controls."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 2654245, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/351f0b3ad208c35829acaf6489debd5e?s=128&d=identicon&r=PG", "display_name": "Thor My", "link": "https://stackoverflow.com/users/2654245/thor-my"}, "edited": false, "score": 1, "creation_date": 1430338457, "post_id": 29938723, "comment_id": 48028000, "body": "yes but, how to test the validation rules programmatically? eg:                  if ( TestValidationRule(control.Value, recordset.ValidationRule) ) then recordset.Update                                                                                           notice that I refer to the recordset&#39;s validation rule, not the control&#39;s one."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 259, "user_id": 2654245, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/351f0b3ad208c35829acaf6489debd5e?s=128&d=identicon&r=PG", "display_name": "Thor My", "link": "https://stackoverflow.com/users/2654245/thor-my"}, "edited": false, "score": 0, "creation_date": 1430374124, "post_id": 29938723, "comment_id": 48040881, "body": "You can in the control properties replicate the validation rule for the field ans also specify a message. However, it far more flexible to use the BeforeUpdate and/or BeforeInsert events. Set Cancel = True in case of a validation error."}, {"owner": {"reputation": 259, "user_id": 2654245, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/351f0b3ad208c35829acaf6489debd5e?s=128&d=identicon&r=PG", "display_name": "Thor My", "link": "https://stackoverflow.com/users/2654245/thor-my"}, "edited": false, "score": 1, "creation_date": 1430392874, "post_id": 29938723, "comment_id": 48052378, "body": "hi Gustav. thanks for you assistance. I got it without replicating the validation rule. I&#39;m still working on the code so I didn&#39;t post it here yet. I access the table&#39;s field validation rule via recordset properties and test it programmatically. if the test returns true, I save the changes done in the recordset (recordset.Update). if it returns false, I run a message box showing the validation text also got thru the recordset (recordset.Fields(control.RecordSource).ValidationText). it is working fine for me."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": -1, "last_activity_date": 1430297366, "creation_date": 1430297366, "answer_id": 29938723, "question_id": 29934526, "link": "https://stackoverflow.com/questions/29934526/how-to-test-validation-rule-programmatically-in-vba-access/29938723#29938723", "title": "How to Test Validation Rule Programmatically in VBA/Access", "body": "<p>Use a form to enter the data.</p>\n\n<p>Then use the same validation rules in the BeforeInsert and BeforeUpdate events of the form.</p>\n"}], "owner": {"reputation": 259, "user_id": 2654245, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/351f0b3ad208c35829acaf6489debd5e?s=128&d=identicon&r=PG", "display_name": "Thor My", "link": "https://stackoverflow.com/users/2654245/thor-my"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 765, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1430297366, "creation_date": 1430282560, "question_id": 29934526, "link": "https://stackoverflow.com/questions/29934526/how-to-test-validation-rule-programmatically-in-vba-access", "title": "How to Test Validation Rule Programmatically in VBA/Access", "body": "<p>I have the validation rules set in the design table and I want to test it before I save the changes done in the recordset.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 1777, "user_id": 1638627, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f213b690f66c98dc13cc41f1431b9c8?s=128&d=identicon&r=PG", "display_name": "tmoore82", "link": "https://stackoverflow.com/users/1638627/tmoore82"}, "edited": false, "score": 0, "creation_date": 1430279103, "post_id": 29933841, "comment_id": 47990015, "body": "What is the error and on what line does it occur?"}, {"owner": {"reputation": 945, "user_id": 4778565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcc04d46859697213ac612773d64673?s=128&d=identicon&r=PG&f=1", "display_name": "mock_blatt", "link": "https://stackoverflow.com/users/4778565/mock-blatt"}, "edited": false, "score": 0, "creation_date": 1430279740, "post_id": 29933841, "comment_id": 47990207, "body": "I think Mark has the answer for you. One interesting note, I was figuring at first you had a problem with the array, because arrays usually start at 0. VBA provides the option to base them off 1 by default, or specify any bounds you want, but the default is 0. However, I tested, and it looks like VBA lets you iterate  the array in your example as either 1 to 8 or 0 to 7, and can figure out what you&#39;re doing on the fly. However, I&#39;d say it&#39;s dangerous to rely on it interpreting for you."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430288733, "post_id": 29933841, "comment_id": 47993520, "body": "it&#39;s run time error 13, occurring on the line intTotal = a(1) * 9 ........"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1430302841, "post_id": 29933841, "comment_id": 48002443, "body": "You can&#39;t get 8 digits out of a 7 digit number.  IntNumber will need to be an 8 digit number for your code to work.  And the code seems to work OK here with <code>intNumber = GenerateRandomNumber(10000000, 99999999)</code> where that function generates a random number between those two values."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430279634, "post_id": 29933993, "comment_id": 47990175, "body": "- Mark Wickett Is there a way to fix this?? I&#39;m not really sure what other functions can be used to replace Mid() though. Thanks for your help!"}, {"owner": {"reputation": 945, "user_id": 4778565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcc04d46859697213ac612773d64673?s=128&d=identicon&r=PG&f=1", "display_name": "mock_blatt", "link": "https://stackoverflow.com/users/4778565/mock-blatt"}, "edited": false, "score": 0, "creation_date": 1430280369, "post_id": 29933993, "comment_id": 47990401, "body": "If you wanted to follow your current approach, just make the numbers be 8 digits, so GenerateRandomNumber(10000000, 999999999) - You could also just pick 8 random integers between 0 and 9."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430287997, "post_id": 29933993, "comment_id": 47993174, "body": "It doesn&#39;t work when the numbers is at 8 digits.. I think its due to what Mark said, as i used the Mid() function, it only works when a total of odd number digits used. Is there another function that I can use to replace Mid()?"}], "tags": [], "owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "is_accepted": false, "score": 2, "last_activity_date": 1430279418, "creation_date": 1430279418, "answer_id": 29933993, "question_id": 29933841, "link": "https://stackoverflow.com/questions/29933841/vba-excel-array-error/29933993#29933993", "title": "VBA Excel array error", "body": "<p>I'm assuming that <code>GenerateRandomnNumber</code> will return a numeric in the specified range - in this case, a seven digit number between 1000000 and 9999999.</p>\n\n<p>So when selecting the <code>i</code>th digit in the statement <code>a(i) = Mid(intNumber, i, 1)</code>, there are no issues when <code>i</code> is 1 to 7 - however, when it's 8 - there is no eighth digit, so the code will fail. </p>\n"}], "owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1430279418, "creation_date": 1430278379, "last_edit_date": 1430278394, "question_id": 29933841, "link": "https://stackoverflow.com/questions/29933841/vba-excel-array-error", "title": "VBA Excel array error", "body": "<p>I have to generate an ID using a macro and I'm facing some problems when there are 8 numeric values required.\nThe ID has to include numeric values for the 1st-8th charactera and the 9th must be alphabetic. From the 10th character onwards it has to be spaces.\nThese are my codes and I'm certain that there are no issues with the formula</p>\n\n<pre><code>Function GenerateRB()\n\nstrLastCharSelections = \"X,W,M,L,K,J,E,D,C,B,A\"\n\nintNumber = GenerateRandomNumber(1000000, 9999999)\n\nReDim a(8)\nFor i = 1 To 8\na(i) = Mid(intNumber, i, 1)\nNext\n\nintTotal = a(1) * 9 + a(2) * 8 + a(3) * 7 + a(4) * 6 + a(5) * 5 + a(6) * 4 + a(7) * 3 + a(8) * 2\n\n\nintRemainder = intTotal Mod 11\n\narrstrSplitLastCharSelections = Split(strLastCharSelections, \",\")\nstrLastChar = arrstrSplitLastCharSelections(intRemainder)\nGenerateRB = intNumber &amp; strLastChar\nEnd Function\n</code></pre>\n\n<p>The code works when its</p>\n\n<pre><code>    ReDim a(7)\nFor i = 1 To 7\na(i) = Mid(intNumber, i, 1)\nNext\n\nintTotal = a(1) * 9 + a(2) * 8 + a(3) * 7 + a(4) * 6 + a(5) * 5 + a(6) * 4 + a(7) * 3\n</code></pre>\n\n<p>Any help will be appreciated as I'm very new to this, Thank you!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 1727657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d59bae4da5a21b40b26a2cbcfd3314fe?s=128&d=identicon&r=PG", "display_name": "OutThere", "link": "https://stackoverflow.com/users/1727657/outthere"}, "edited": false, "score": 0, "creation_date": 1430311208, "post_id": 29933743, "comment_id": 48008752, "body": "Thanks.  Your answer was definitely helpful.  But I think it&#39;s led me to believe I need to try a different way of going about this.  So I&#39;ll post another question."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1430278105, "last_edit_date": 1430278105, "creation_date": 1430277743, "answer_id": 29933743, "question_id": 29933593, "link": "https://stackoverflow.com/questions/29933593/how-to-pass-a-date-as-an-argument-in-an-excel-vba-function/29933743#29933743", "title": "How to pass a date as an argument in an Excel VBA function", "body": "<p>The last argument in the <code>Match</code> function allows for returning an approximate match. If you require an <em>exact</em> match, then you should use the last argument of <code>0</code> to require an exact match.  Otherwise, using the arguments <code>1</code> or <code>-1</code> will return approximate match and assume also that the data is sorted ascending.</p>\n\n<pre><code>Position = Application.WorksheetFunction.Match(EffDate, PymtEffDateRange, 0)\n</code></pre>\n\n<p>The <code>Match</code> function will error if the <code>effDate</code> value is not found in the lookup array, so you may need error handling logic to account for that possibility. I would probably use the <code>Application.Match</code> function which can accept an error type, where the <code>Match</code> function in the Worksheet class will only accept long/integer values and will raise an error if the value isn't found:</p>\n\n<pre><code>Dim Position as Variant\nPosition = Application.Match(EffDate, PymtEffDateRange, 0)\nIf IsError(Position) Then\n    MsgBox EffDate &amp; \" not found!\", vbInformation\n\n    Exit Function\n    '   -- OR --\n    '  assign some other return value for the function, etc.\nEnd If\n</code></pre>\n\n<p>Some functions also have difficulty working with date values, so let me know if that doesn't solve the issue.</p>\n\n<p>VBA also doesn't play well with various system locales, if you're expecting \"8/1/2000\" to be anything other than August 1, 2000, you may have more problems since VBA will interpret that by the US date format, not the system locale (e.g., in the UK that date would be 8 January, 2000).  In that case, it may be best to treat the date as text and do a match based on text rather than date.</p>\n"}], "owner": {"reputation": 449, "user_id": 1727657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d59bae4da5a21b40b26a2cbcfd3314fe?s=128&d=identicon&r=PG", "display_name": "OutThere", "link": "https://stackoverflow.com/users/1727657/outthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5361, "favorite_count": 0, "accepted_answer_id": 29933743, "answer_count": 1, "score": 3, "last_activity_date": 1430278105, "creation_date": 1430276615, "question_id": 29933593, "link": "https://stackoverflow.com/questions/29933593/how-to-pass-a-date-as-an-argument-in-an-excel-vba-function", "title": "How to pass a date as an argument in an Excel VBA function", "body": "<p>I'm trying to make a function that will take a date in a cell as an argument, then use that date to lookup a value.  The date to be passed will be in the variable EffDate.  Then the function should go to the worksheet RateChgs, check the NewPymtEffDateRange for the EffDate, and, upon finding it, go to the EscrowPymtAmtRange (one column wide) and return the value on the same row there.</p>\n\n<p>I've only gotten to the point of testing it in the immediate window by typing GetEscrowPymt(8/1/2000) (or some other date).  From the value of the Position variable, I can tell that the function isn't finding the date even though it's there.  Is this a problem with how I'm passing the date?  </p>\n\n<pre><code>Function GetEscrowPymt(EffDate As Date)\nDim PymtEffDateRange As Range \nDim EscrowPymtAmtRange As Range \nDim Position As Integer \n\nSet PymtEffDateRange = Worksheets(\"RateChgs\").Range(\"NewPymtEffDate\")\nSet EscrowPymtAmtRange = Worksheets(\"RateChgs\").Range(\"EscrowPymt\")\n\nPosition = Application.WorksheetFunction.Match(EffDate, PymtEffDateRange, 1)\nMsgBox (Position)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 109, "user_id": 4842900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5fc5251ff762857293143ee02c9fc265?s=128&d=identicon&r=PG&f=1", "display_name": "diego", "link": "https://stackoverflow.com/users/4842900/diego"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1430278034, "post_id": 29933577, "comment_id": 47989684, "body": "my mistake, it was macros"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1430409675, "creation_date": 1430409675, "answer_id": 29972532, "question_id": 29933577, "link": "https://stackoverflow.com/questions/29933577/after-pasting-an-array-i-want-to-paste-a-new-array-next-to-the-first-one/29972532#29972532", "title": "After pasting an array, I want to paste a new array next to the first one", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim i As Long, n As Long, Dim j As Long, m As Long\n    Dim arrmatrix() As Variant, Dim arrmatrix1() As Variant\n If Not Intersect(Target, Range(\"A:A, L:L\")) Is Nothing Then\n    ' On Error GoTo F\u00ecn 'Commented to find out which line your error actually is - Uncomment once fixed\n    Application.EnableEvents = False\n\n    For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n        If Cells(i, 12).Value = \"Pi emitida\" Then\n            n = n + 1\n            ReDim Preserve arrmatrix(1 To 1, 1 To n)\n            arrmatrix(1, n) = Cells(i, 1).Value\n        End If\n\n        If (Cells(i, 12).Value = \"Pi emitida\" Or Cells(i, 12).Value = \"PI firmada\" Or Cells(i, 12).Value = \"Carta credito L/c\" Or Cells(i, 12).Value = \"Con booking\") and DateDiff(d, Cells(i, 17).Value, Today) &gt; 0 Then\n            m = m + 1\n            ReDim Preserve arrmatrix1(1 To 1, 1 To m)\n            arrmatrix1(1, m) = Cells(i, 1).Value\n        End If\n    Next i\n    With Worksheets(\"Inicio\")\n        .Range(\"G4:G\" &amp; Rows.Count).ClearContents\n        .Range(\"G4\").Resize(UBound(arrmatrix, 2), 1) = Application.Transpose(arrmatrix)\n        .Range(\"H4:H\" &amp; Rows.Count).ClearContents\n        .Range(\"H4\").Resize(UBound(arrmatrix1, 2), 1) = Application.Transpose(arrmatrix1)\n    End With\nEnd If\n\n F\u00ecn:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4842900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5fc5251ff762857293143ee02c9fc265?s=128&d=identicon&r=PG&f=1", "display_name": "diego", "link": "https://stackoverflow.com/users/4842900/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430409675, "creation_date": 1430276537, "last_edit_date": 1531161705, "question_id": 29933577, "link": "https://stackoverflow.com/questions/29933577/after-pasting-an-array-i-want-to-paste-a-new-array-next-to-the-first-one", "title": "After pasting an array, I want to paste a new array next to the first one", "body": "<p>I have this automatic procedure that works great</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"A:A, L:L\")) Is Nothing Then\n    On Error GoTo F\u00ecn\n    Application.EnableEvents = False\n    Dim i As Long, n As Long\n    Dim arrmatrix As Variant\n    ReDim arrmatrix(1 To 1, 1 To 1)\n    For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n        If Cells(i, 12).Value = \"Pi emitida\" Then\n            n = n + 1\n            ReDim Preserve arrmatrix(1 To 1, 1 To n)\n            arrmatrix(1, n) = Cells(i, 1).Value\n        End If\n    Next i\n    With Worksheets(\"Inicio\")\n        .Range(\"G4:G\" &amp; Rows.Count).ClearContents\n        .Range(\"G4\").Resize(UBound(arrmatrix, 2), 1) =      Application.Transpose(arrmatrix)\n    End With\nEnd If\nF\u00ecn:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>My problem now is that I want to do the same and paste a different array in the colum next to the first one, the array must do the same but if these conditions are achieved:</p>\n\n<pre><code>dim hoy as date\nhoy=date\nIf Cells(j, 12).Value = \"Pi emitida\" Or Cells(j, 12).Value = \"PI firmada\" Or       Cells(j, 12).Value = \"Carta credito L/c\" Or Cells(j, 12).Value = \"Con booking\" And hoy - Cells(j, 12).Value &gt;= 0 \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1430299743, "post_id": 29932554, "comment_id": 48000111, "body": "This is not possible since this feature is not thought for such approach. Let the first &quot;col1&quot; in your data, delete the next three. Then rename the next &quot;col1&quot; to &quot;col2&quot; and delete the following. Now you should see how it is thought. You could concatenate column1 and column2 in a helper column and use this helper column as axis label range."}, {"owner": {"reputation": 476, "user_id": 4372726, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ec989c1c7fec5f584fd2037fb63322bf?s=128&d=identicon&r=PG&f=1", "display_name": "Hubvill", "link": "https://stackoverflow.com/users/4372726/hubvill"}, "edited": false, "score": 0, "creation_date": 1430314902, "post_id": 29932554, "comment_id": 48011831, "body": "Thanks for the help! Making a helper column and concatenating work just great. Why didn&#39;t I think of that..."}], "owner": {"reputation": 476, "user_id": 4372726, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ec989c1c7fec5f584fd2037fb63322bf?s=128&d=identicon&r=PG&f=1", "display_name": "Hubvill", "link": "https://stackoverflow.com/users/4372726/hubvill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430269100, "creation_date": 1430269100, "last_edit_date": 1531161705, "question_id": 29932554, "link": "https://stackoverflow.com/questions/29932554/bar-chart-category-text-direction", "title": "Bar Chart Category Text Direction", "body": "<p>I have data as follows in a table bellow:</p>\n\n<p><img src=\"https://i.stack.imgur.com/9bRO5.png\" alt=\"enter image description here\"></p>\n\n<p>I would like to create a bar chart with column1 and colum2 as category's. When I do this column1's text direction on the chart becomes vertical. See image bellow. I can change column2's text direction from vertical to horizontal, but the first column stays vertical. How do I change column1's text direction to horizontal? Is there an option that I am over looking or a VBA approach that can fix this?</p>\n\n<p><img src=\"https://i.stack.imgur.com/GumK5.png\" alt=\"enter image description here\"></p>\n\n<p>Any help is very much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430268337, "post_id": 29932415, "comment_id": 47987116, "body": "Seeing the code would help.  Is the custom button in an add-in, or in each workbook?"}, {"owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1430283649, "post_id": 29932415, "comment_id": 47991446, "body": "So your macro includes opening that file and then running some commands in it? Consider placing all of these workbooks in the same folder and have VBA open the most recently saved (= newest) one."}, {"owner": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "edited": false, "score": 0, "creation_date": 1430290034, "post_id": 29932415, "comment_id": 47994182, "body": "Yes, the button in the quick access ribbon runs the short bit of code which opens a userform. The userform can then run other macros. The workbooks are saved in the same folder, I just want the code to open the userform in the active workbook and not in a previously saved one."}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "edited": false, "score": 0, "creation_date": 1430291733, "post_id": 29932415, "comment_id": 47995182, "body": "hello, just as a suggestion, can you put a button in the worksheet and assign the macro to that button instead of ribbon? :)"}, {"owner": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "edited": false, "score": 0, "creation_date": 1430294761, "post_id": 29932415, "comment_id": 47997003, "body": "That is what I have been doing, but to clean up the workspace and make the code accessible from every sheet I prefer to run the macro from an icon in the quick access toolbar."}], "answers": [{"comments": [{"owner": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "edited": false, "score": 0, "creation_date": 1430294685, "post_id": 29937058, "comment_id": 47996965, "body": "Dubison thanks for the suggestion, but I have never seen a file called PERSONAL.XLSB. I only see ms excel objects, Forms, Modules and Class Modules in my VB editor. Can you give me some more directions?"}, {"owner": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "edited": false, "score": 0, "creation_date": 1430304373, "post_id": 29937058, "comment_id": 48003582, "body": "Thanks Dubison, but I get a Run-time error &#39;1004&#39; .....the macro may not be available in that workbook or all macros may be disabled."}, {"owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "reply_to_user": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "edited": false, "score": 0, "creation_date": 1430304690, "post_id": 29937058, "comment_id": 48003796, "body": "the macro I have provided should be in PERSONAL.XLSB and your button should be linking to that one. Beside your original macro should be in your userform file. Beside that you may need to restart excel so it will probably ask if you want to enable macros or not."}, {"owner": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "edited": false, "score": 0, "creation_date": 1430953249, "post_id": 29937058, "comment_id": 48291239, "body": "your method works but I decided to simply create a backup each day instead of saving as a new file with a new name. That way the path to the macro shouldn&#39;t change."}], "tags": [], "owner": {"reputation": 720, "user_id": 4462199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207bfe17a53f44de4205356ebb873b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dubison", "link": "https://stackoverflow.com/users/4462199/dubison"}, "is_accepted": true, "score": 0, "last_activity_date": 1430295288, "last_edit_date": 1430295288, "creation_date": 1430292537, "answer_id": 29937058, "question_id": 29932415, "link": "https://stackoverflow.com/questions/29932415/excel-quick-access-toolbar-run-macro-from-active-instead-of-previous-workbook/29937058#29937058", "title": "Excel quick access toolbar - run macro from active instead of previous workbook", "body": "<p>I will try to guide you through this, I hope it helps.</p>\n\n<p>What we need to do is we need to call <code>OPEN_DATA_USERFORM()</code> from our \"PERSONAL.XLSB\" file. In VB editor screen, in the project explorer you will find a file called \"PERSONAL.XLSB\", you need to add an \"Module\" to that and add following code:</p>\n\n<pre><code>Sub KickOff()\n    Call Application.Run(Excel.ActiveWorkbook.Name &amp; \"!OPEN_DATA_USERFORM\")\nEnd Sub\n</code></pre>\n\n<p>By this we will be able to call the userform.show function from our PERSONAL.XLSB which is always running in the background when you open the excel.</p>\n\n<p>PS: I am assuming your <code>OPEN_DATA_USERFORM()</code> is coded in your daily workbook.</p>\n\n<p>UPDATE: PERSONAL.XLSB\nYour file should be visible in your project explorer like below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8k2Mz.jpg\" alt=\"enter image description here\"></p>\n\n<p>If it is not there record a dummy macro and select your personal file like below then it should appear in your project explorer in VBA screen:</p>\n\n<p><img src=\"https://i.stack.imgur.com/lsOER.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1248, "user_id": 3314925, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LX1JL.jpg?s=128&g=1", "display_name": "Zeus", "link": "https://stackoverflow.com/users/3314925/zeus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1654, "favorite_count": 0, "accepted_answer_id": 29937058, "answer_count": 1, "score": 0, "last_activity_date": 1430295288, "creation_date": 1430268177, "last_edit_date": 1430269205, "question_id": 29932415, "link": "https://stackoverflow.com/questions/29932415/excel-quick-access-toolbar-run-macro-from-active-instead-of-previous-workbook", "title": "Excel quick access toolbar - run macro from active instead of previous workbook", "body": "<p>I have a custom button (not an add-in, just a \"shortcut\" button) in Excel's quick access toolbar to run a macro in the active workbook. The workbook is modified and saved daily with a new filename. When the link is first created in the active workbook (call it Version 1) the macro runs fine. However the following day (filename now Version 2) clicking on the macro button opens workbook Version 1 and runs the macro saved in Version 1.</p>\n\n<p>Is there a simple way to break the link and run the macro in the most recent active workbook?</p>\n\n<p>The code is basic - it just opens up a userform and is saved in \"ThisWorkbook\"</p>\n\n<pre><code>Sub OPEN_DATA_USERFORM()\n\nufDATA.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5315, "user_id": 3689364, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/1wGCo.jpg?s=128&g=1", "display_name": "EliteRaceElephant", "link": "https://stackoverflow.com/users/3689364/eliteraceelephant"}, "is_accepted": true, "score": 0, "last_activity_date": 1430270471, "creation_date": 1430270471, "answer_id": 29932764, "question_id": 29932367, "link": "https://stackoverflow.com/questions/29932367/using-an-expression-in-a-numeric-form-control/29932764#29932764", "title": "Using an expression in a numeric form control", "body": "<p>For me your code looks fine but you might put it in the wrong place.</p>\n\n<p>Like you said Acess is giving you this error because the textbox is bound to the currency-field. So it will never accept non-numerical values because the value-checking code fires even before the before_update-event.</p>\n\n<p>I think the best solution would be to hide your bound text box using <code>Me.tbxTotal_Paid.Visible = False</code> and creating a surrogate textbox which is not bound. You put your code in the beforeUpdate-Event or Change-Event of your surrogate. At the end you should check your final result with <code>IsNumeric()</code>. That way your surrogate textbox writes only correct values to your bound hidden textbox and only numbers arrive at your table.</p>\n\n<p>An alternative would be to change the currency column to a string-field but this would not be wise because of potential wrong data in your database.</p>\n"}], "owner": {"reputation": 43, "user_id": 4844161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ce730fec5b5c5455dccc15fee2cae6?s=128&d=identicon&r=PG&f=1", "display_name": "Writex", "link": "https://stackoverflow.com/users/4844161/writex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 29932764, "answer_count": 1, "score": 0, "last_activity_date": 1430681082, "creation_date": 1430267830, "last_edit_date": 1430681082, "question_id": 29932367, "link": "https://stackoverflow.com/questions/29932367/using-an-expression-in-a-numeric-form-control", "title": "Using an expression in a numeric form control", "body": "<p>I have an Access form with a textbox bound to a currency field in a table. As expected, anything other than a numerical entry generates an error. Occasionally, users need to enter several amounts and have those added together and the result entered into the currency field.</p>\n\n<p>To accomplish this, I would like users to enter an equal sign followed by a valid arithmetical string which would evaluate to a number exactly as they would in an Excel cell. For example, if a user enters \"=5.31+2\" I want the field to evaluate to \"7.31\" and use that as the value passed to the table when the record is updated or saved. The current workaround is to use the Calculator application but that isn't the ideal solution.</p>\n\n<p>I tried the following code and applied it to both the BeforeUpdate and OnLostFocus events of the textbox (named \"tbxTotal_Paid\") but neither worked. I simply got \"The value you entered is not valid for this field\" error.</p>\n\n<pre><code>Dim charCt As Integer\nDim evalStr As String\n\nIf Left(tbxTotal_Paid, 1) = \"=\" Then\n    charCt = Len(tbxTotal_Paid)\n    evalStr = Right(tbxTotal_Paid, charCt - 1)\n    Me.tbxTotal_Paid = CCur(evalStr)\nEnd If\n</code></pre>\n\n<p>Is this simply applying the code to the incorrect event or is this a coding issue? Any assistance is appreciated.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430267499, "post_id": 29932210, "comment_id": 47986866, "body": "You need to exit the loop once you hit the employee id in question, but why not instead include the employee id in your SQL?  Also, your <code>MoveNext</code> needs to be before the <code>Loop</code>"}, {"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 0, "creation_date": 1430273303, "post_id": 29932210, "comment_id": 47988454, "body": "a side note: do they now allow <code>&#47;&#47;</code> comments in VBA?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1430277978, "creation_date": 1430277978, "answer_id": 29933778, "question_id": 29932210, "link": "https://stackoverflow.com/questions/29932210/validating-records-in-one-table-based-on-data-in-another-table/29933778#29933778", "title": "Validating records in one table based on data in another table", "body": "<p>You don't need to loop over all of the records to find a match: the database can handle that.</p>\n\n<pre><code>Public Function validEmployee(EmpID as String)\n\n    Dim rs As DAO.recordset\n    Dim sqlString as String\n\n    'add single-quotes around EmpID if it's not a numeric field\n    sqlString = \"SELECT count([EmployeeID]) as num FROM [MASTER] \" &amp; _\n                \" WHERE [EmployeeStatus] = 'Terminated' and \" &amp; _\n                \" [EmployeeID] = \" &amp; EmpID\n\n    set rs = CurrentDb.OpenRecordset(sqlString)\n    validEmployee = rs.Fields(\"num\").Value&gt;0\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 3718812, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/458654dc70ed906f1104ec9ae2b676ea?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3718812/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 762, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644777, "creation_date": 1430266839, "last_edit_date": 1594644777, "question_id": 29932210, "link": "https://stackoverflow.com/questions/29932210/validating-records-in-one-table-based-on-data-in-another-table", "title": "Validating records in one table based on data in another table", "body": "<p>This question is an offshoot of <a href=\"https://stackoverflow.com/questions/29908122/inline-sql-statement-in-access-vba-returning-only-duplicate-first-record-in-reco\">this question</a> here. Using an loop to loop through the recordset based on the Master table, I was able to get all the records returned by my inline Sql statement to show. However, when I actually put the validation code in the loop, valid employees are being reported as invalid and vice versa. </p>\n\n<pre><code>Public Function validEmployee(EmpID as String)\n\nDim Dbs As DAO.database\nDim rs As DAO.recordset\nDim sqlString as String\nset dbs = CurrentDb\n\nsqlString = \"SELECT [EmployeeID] FROM [MASTER] WHERE [EmployeeStatus] = 'Terminated'\"\n\nset rs = dbs.OpenRecordset(sqlString)\nrs.MoveLast\nrs.MoveFirst // obtain accurate count of records in recordset\n\nIf Not (rs.BOF and rs.EOF) Then // Verify recordset is not empty\n    Do Until rs.EOF\n        If InStr(1, rs.fields(\"EmployeeID\"), EmpID, vbTextCompare) = 0\n            validEmployee = \"Valid employee\"\n        Else\n            validEmployee = \"Employee\" &amp; EmpID &amp; \"is invalid\"\n            Exit Do\n        End If\n    Loop\n    rs.moveNext\nEnd If\n</code></pre>\n\n<p>Some of the steps I have tried include: </p>\n\n<ul>\n<li>checking for leading or trailing spaces in field names</li>\n<li>validating the values of EmpID and rs.fields(\"EmployeeID\") via debug.print</li>\n<li>Checking for syntax errors both in SQL and in VBA</li>\n<li>Quotation / escaping of string literals in SQL statement</li>\n</ul>\n\n<p>I feel the problem could be in the way I wrote my InStr() comparison.\nComparison using just a single record without the loop works fine.</p>\n"}, {"tags": ["vba", "email", "hyperlink", "gmail", "attachment"], "answers": [{"tags": [], "owner": {"reputation": 23873, "user_id": 1595451, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/08TCi.jpg?s=128&g=1", "display_name": "Rub&#233;n", "link": "https://stackoverflow.com/users/1595451/rub%c3%a9n"}, "is_accepted": false, "score": 0, "last_activity_date": 1492694955, "creation_date": 1492694955, "answer_id": 43520970, "question_id": 29931614, "link": "https://stackoverflow.com/questions/29931614/url-to-compose-a-message-in-gmail-with-attached-files/43520970#43520970", "title": "URL to compose a message in Gmail with attached files", "body": "<p>I don't think that there is an URL to do that, instead use <a href=\"/questions/tagged/gmail-api\" class=\"post-tag\" title=\"show questions tagged &#39;gmail-api&#39;\" rel=\"tag\"><img src=\"https://i.stack.imgur.com/z4O38.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">gmail-api</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 4844109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8188b50aa85fed611233cd951ec7c662?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisSH", "link": "https://stackoverflow.com/users/4844109/chrissh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1003, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1492694955, "creation_date": 1430263178, "last_edit_date": 1430265224, "question_id": 29931614, "link": "https://stackoverflow.com/questions/29931614/url-to-compose-a-message-in-gmail-with-attached-files", "title": "URL to compose a message in Gmail with attached files", "body": "<p>I'm writing a VBA program to send an Excel file to Gmail through Chrome. </p>\n\n<p>I don't use a CDO command because, since the last year, you need to activate \"Less secure apps\" on your gmail account. The users will not agreed to that.</p>\n\n<p>Thus, I try to open Chrome, and write an email, using this:</p>\n\n<pre><code>https://mail.google.com/mail/?view=cm&amp;fs=1&amp;to=someone@example.com&amp;su=SUBJECT&amp;body=BODY&amp;bcc=someone.else@example.com\n</code></pre>\n\n<p>How do I add a file with that method?</p>\n"}, {"tags": ["loops", "excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1430266565, "post_id": 29931430, "comment_id": 47986580, "body": "The best way I can think to do this is to put your Textbox controls into a control array.  Then you can just grab an array or range of the same dimensions and loop over the rows and columns to assign values.  See <a href=\"http://stackoverflow.com/a/3422829/4088852\">this answer</a> and <a href=\"http://stackoverflow.com/a/10131002/4088852\">this one if you need event handlers</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1430381221, "last_edit_date": 1430381221, "creation_date": 1430343387, "answer_id": 29955037, "question_id": 29931430, "link": "https://stackoverflow.com/questions/29931430/looping-to-get-data-row-by-row-to-the-userform-rows/29955037#29955037", "title": "Looping to get data row by row to the userform rows", "body": "<p>Cominterm is correct, \u201cyou need to put your Textbox controls into a control array\u201d.  Unfortunately, I don\u2019t find his suggested links particularly helpful.</p>\n\n<p>I have not needed to access form controls by number for many years so I was rusty.  I tackled this answer in the way I would have done for myself: isolate the functionality I don\u2019t know and write macros to explore that functionality.  I remembered the Controls collection but not how to access the type of a control so I looked that up.</p>\n\n<p>The details of every control on a form are recorded in the Controls collection just as the details of every worksheet are recorded in the Worksheets collection.  If <code>txtName1</code> is the 6th control you can access its properties as <code>Controls(5)</code>since controls are numbered from zero.  For example, instead of <code>txtName1.Text = \"xxxxxx\"</code>, you can write <code>Controls(5) .Text = \"xxxxxx\"</code>.</p>\n\n<p>I created a user form and filled it with one or two of every type of control.  I then added three rows in the format you want to give:</p>\n\n<p><img src=\"https://i.stack.imgur.com/0kjyO.png\" alt=\"Design view of form\"></p>\n\n<p>I created a module containing:</p>\n\n<pre><code>Option Explicit\nSub Test1()\n\n  Load UserForm1\n  UserForm1.Show vbModal\n\nEnd Sub\n</code></pre>\n\n<p>I wrote the following code within the form:</p>\n\n<pre><code>Private Type TypeCtrl\n  Height As Single\n  Left As Single\n  Name As String\n  Parent As String\n  Top As Single\n  TypeName As String\n  Width As Single\nEnd Type\nDim CtrlDtl() As TypeCtrl\nPrivate Sub cmdExit_Click()\n\n  Unload Me\n\nEnd Sub\nPrivate Sub UserForm_Initialize()\n\n  Dim InxCtrl As Long\n  Dim NameLenMax As Long\n  Dim ParentLenMax As Long\n  Dim TypeNameLenMax As Long\n\n  ReDim CtrlDtl(0 To Controls.Count - 1)\n\n  For InxCtrl = 0 To Controls.Count - 1\n\n    CtrlDtl(InxCtrl).Name = Controls(InxCtrl).Name\n    CtrlDtl(InxCtrl).Top = Controls(InxCtrl).Top\n    CtrlDtl(InxCtrl).Left = Controls(InxCtrl).Left\n    CtrlDtl(InxCtrl).Width = Controls(InxCtrl).Width\n    CtrlDtl(InxCtrl).Height = Controls(InxCtrl).Height\n    CtrlDtl(InxCtrl).Parent = Controls(InxCtrl).Parent.Name\n    CtrlDtl(InxCtrl).TypeName = TypeName(Controls(InxCtrl))\n\n    If NameLenMax &lt; Len(CtrlDtl(InxCtrl).Name) Then\n      NameLenMax = Len(CtrlDtl(InxCtrl).Name)\n    End If\n\n    If ParentLenMax &lt; Len(CtrlDtl(InxCtrl).Parent) Then\n      ParentLenMax = Len(CtrlDtl(InxCtrl).Parent)\n    End If\n\n    If TypeNameLenMax &lt; Len(CtrlDtl(InxCtrl).TypeName) Then\n      TypeNameLenMax = Len(CtrlDtl(InxCtrl).TypeName)\n    End If\n\n  Next\n\n    If NameLenMax &lt; Len(\"Name\") Then\n      NameLenMax = Len(\"Name\")\n    End If\n\n    If ParentLenMax &lt; Len(\"Parent\") Then\n      ParentLenMax = Len(\"Parent\")\n    End If\n\n  Debug.Print \"Inx  Name\" &amp; Space(NameLenMax - 2) &amp; _\n              \"     Top      Left    Height     Width  Parent\" &amp; _\n              Space(ParentLenMax - 6) &amp; \"  Type name\"\n  For InxCtrl = 0 To UBound(CtrlDtl)\n    With CtrlDtl(InxCtrl)\n      Debug.Print Right(\"  \" &amp; InxCtrl, 3) &amp; \"  \" &amp; _\n                  Left(.Name &amp; Space(NameLenMax), NameLenMax) &amp; \"  \" &amp; _\n                  Right(Space(8) &amp; Format(.Top, \"#,###.00\"), 8) &amp; \"  \" &amp; _\n                  Right(Space(8) &amp; Format(.Left, \"#,###.00\"), 8) &amp; \"  \" &amp; _\n                  Right(Space(8) &amp; Format(.Height, \"#,###.00\"), 8) &amp; \"  \" &amp; _\n                  Right(Space(8) &amp; Format(.Width, \"#,###.00\"), 8) &amp; \"  \" &amp; _\n                  Left(.Parent &amp; Space(ParentLenMax), ParentLenMax) &amp; \"  \" &amp; _\n                  .TypeName\n    End With\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>The first block of code reads down the Controls collection, extracts the values of selected properties and stores then in an array of type <code>TypeCtrl</code> which I have specified to hold the selected properties.  The second block outputs the values from the array to the Immediate Windows to give:</p>\n\n<pre><code>Inx  Name                 Top      Left    Height     Width  Parent     Type name\n  0  Label1             12.00     24.00     18.00     72.00  UserForm1  Label\n  1  Label2             12.00    114.00     18.00     72.00  UserForm1  Label\n  2  TextBox1           12.00    210.00     18.00     72.00  UserForm1  TextBox\n  3  TextBox2           12.00    294.00     18.00     72.00  UserForm1  TextBox\n  4  ComboBox1          12.00    390.00     18.00     72.00  UserForm1  ComboBox\n  5  ComboBox2          48.15     24.00     18.00     72.00  UserForm1  ComboBox\n  6  ListBox1           42.00    120.00     72.00     72.00  UserForm1  ListBox\n  7  CheckBox1          48.00    294.00     18.00    108.00  UserForm1  CheckBox\n  8  OptionButton1     138.00     12.00     18.00    108.00  UserForm1  OptionButton\n  9  ListBox2           42.00    204.00     72.00     72.00  UserForm1  ListBox\n 10  CheckBox2          72.00    294.00     18.00    108.00  UserForm1  CheckBox\n 11  OptionButton2     162.00     12.00     18.00    108.00  UserForm1  OptionButton\n 12  ToggleButton1     132.00    144.00     40.00     36.00  UserForm1  ToggleButton\n 13  ToggleButton2     132.00    192.00     40.00     36.00  UserForm1  ToggleButton\n 14  Frame1            120.00    246.00     42.00     66.00  UserForm1  Frame\n 15  Frame2            120.00    324.00     54.00     72.00  UserForm1  Frame\n 16  Label3             18.00     12.00     18.00     48.00  Frame2     Label\n 17  cmdExit           126.00    414.00     24.00     72.00  UserForm1  CommandButton\n 18  CommandButton2    162.00    414.00     24.00     72.00  UserForm1  CommandButton\n 19  TabStrip1         192.00     18.00     54.00     90.00  UserForm1  TabStrip\n 20  TabStrip2         198.00    120.00     48.00     66.00  UserForm1  TabStrip\n 21  MultiPage1        198.00    186.00     66.00    102.00  UserForm1  MultiPage\n 22  MultiPage2        204.00    306.00     60.00     72.00  UserForm1  MultiPage\n 23  ScrollBar1        204.00    390.00     63.80     12.75  UserForm1  ScrollBar\n 24  SpinButton1       204.00    462.00     25.50     12.75  UserForm1  SpinButton\n 25  Image1            270.00     18.00     72.00     72.00  UserForm1  Image\n 26  SpinButton2       204.00    486.00     25.50     12.75  UserForm1  SpinButton\n 27  ScrollBar2        204.00    414.00     63.80     12.75  UserForm1  ScrollBar\n 28  txtName1          282.00    108.00     18.00     42.00  UserForm1  TextBox\n 29  txtStreet1        282.00    156.00     18.00     42.00  UserForm1  TextBox\n 30  txtTown1          282.00    204.00     18.00     42.00  UserForm1  TextBox\n 31  txtCounty1        282.00    252.00     18.00     42.00  UserForm1  TextBox\n 32  txtPostcode1      282.00    300.00     18.00     42.00  UserForm1  TextBox\n 33  txtName2          306.00    108.00     18.00     42.00  UserForm1  TextBox\n 34  txtStreet2        306.00    156.00     18.00     42.00  UserForm1  TextBox\n 35  txtTown2          306.00    204.00     18.00     42.00  UserForm1  TextBox\n 36  txtCounty2        306.00    252.00     18.00     42.00  UserForm1  TextBox\n 37  txtPostcode2      306.00    300.00     18.00     42.00  UserForm1  TextBox\n 38  txtName3          330.00    108.00     18.00     42.00  UserForm1  TextBox\n 39  txtStreet3        330.00    156.00     18.00     42.00  UserForm1  TextBox\n 40  txtTown3          330.00    204.00     18.00     42.00  UserForm1  TextBox\n 41  txtCounty3        330.00    252.00     18.00     42.00  UserForm1  TextBox\n 42  txtPostcode3      330.00    300.00     18.00     42.00  UserForm1  TextBox\n</code></pre>\n\n<p>I believe you only need to access the name but coding this refreshed my memory of what is possible.  This is the sort of macro I would have written for myself when I first needed to know about the Control collection and I recommend this approach.  I have carefully selected properties that exist for every type of control.  However, by checking the type, I could have accessed properties that are restricted to particular types.</p>\n\n<p>Having refreshed my memory, I was ready to code a macro that matches your requirement.</p>\n\n<p>You do not name all five of your columns so I made up five names of my own.  I have only defined three rows which was enough to demonstrate the approach.  You can see them at the bottom of the list above.</p>\n\n<p>I create a worksheet \u201cData\u201d and placed some data within it:</p>\n\n<p><img src=\"https://i.stack.imgur.com/lULAB.png\" alt=\"Sample data\"></p>\n\n<p>I do not know if your data in fixed or movable but for my demonstration I have made it fixed and have defined its location with constants.  You can replace the values of my constants or replace my constants with variables as necessary.</p>\n\n<p>I discarded the original code for the form and replaced it with:</p>\n\n<pre><code>Option Explicit\n\n  Const WshtName     As String = \"Data\"\n  Const RowDataTop   As Long = 3\n  Const ColDataLeft  As Long = 2\n  Const RowDataBot   As Long = 5\n  Const ColDataRight As Long = 6\n\nDim CtrlForAddressElement(1 To ColDataRight - ColDataLeft + 1, _\n                          1 To RowDataBot - RowDataTop + 1) As Long\nPrivate Sub cmdExit_Click()\n\n  Unload Me\n\nEnd Sub\nPrivate Sub UserForm_Initialize()\n\n  Dim ColDataCrnt As Long\n  Dim ColFormCrnt As Long\n  Dim InxCtrl As Long\n  Dim RowDataCrnt As Long\n  Dim RowFormCrnt As Long\n\n  ReDim CtrlDtl(0 To Controls.Count - 1)\n\n  ' Store index number for each control of the address block\n  For InxCtrl = 0 To Controls.Count - 1\n    If Left(Controls(InxCtrl).Name, 7) = \"txtName\" Then\n      RowFormCrnt = Val(Mid(Controls(InxCtrl).Name, 8))\n      CtrlForAddressElement(1, RowFormCrnt) = InxCtrl\n    ElseIf Left(Controls(InxCtrl).Name, 9) = \"txtStreet\" Then\n      RowFormCrnt = Val(Mid(Controls(InxCtrl).Name, 10))\n      CtrlForAddressElement(2, RowFormCrnt) = InxCtrl\n    ElseIf Left(Controls(InxCtrl).Name, 7) = \"txtTown\" Then\n      RowFormCrnt = Val(Mid(Controls(InxCtrl).Name, 8))\n      CtrlForAddressElement(3, RowFormCrnt) = InxCtrl\n    ElseIf Left(Controls(InxCtrl).Name, 9) = \"txtCounty\" Then\n      RowFormCrnt = Val(Mid(Controls(InxCtrl).Name, 10))\n      CtrlForAddressElement(4, RowFormCrnt) = InxCtrl\n    ElseIf Left(Controls(InxCtrl).Name, 11) = \"txtPostcode\" Then\n      RowFormCrnt = Val(Mid(Controls(InxCtrl).Name, 12))\n      CtrlForAddressElement(5, RowFormCrnt) = InxCtrl\n    End If\n  Next\n\n  ' Move data from worksheet to form\n  With Worksheets(WshtName)\n    For RowDataCrnt = RowDataTop To RowDataBot\n      RowFormCrnt = RowDataCrnt - RowDataTop + 1\n      For ColDataCrnt = ColDataLeft To ColDataRight\n        ColFormCrnt = ColDataCrnt - ColDataLeft + 1\n        InxCtrl = CtrlForAddressElement(ColFormCrnt, RowFormCrnt)\n        Controls(InxCtrl).Text = .Cells(RowDataCrnt, ColDataCrnt).Value\n      Next\n    Next\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>I have a global array <code>CtrlForAddressElement</code> which I size as necessary to handle the range defined by the constants.</p>\n\n<p>The first block of code loads that array with the indices into the Controls collection for the 15 text boxes.</p>\n\n<p>The second block of code uses this array to move data from the worksheet to the form to give:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wuJjF.png\" alt=\"Form loaded with values from the worksheet\"></p>\n\n<p>The second block of code should be readily adaptable to your requirement.</p>\n"}], "owner": {"reputation": 13, "user_id": 4833008, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206017378941088/picture?type=large", "display_name": "Ralph Severns III", "link": "https://stackoverflow.com/users/4833008/ralph-severns-iii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1271, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430381221, "creation_date": 1430262067, "last_edit_date": 1531164843, "question_id": 29931430, "link": "https://stackoverflow.com/questions/29931430/looping-to-get-data-row-by-row-to-the-userform-rows", "title": "Looping to get data row by row to the userform rows", "body": "<p>I am using VBS Excel 2010, I am trying to write a loop to transfer cells in 17 rows, 5 columns from a WS to a my userform which also has 17 rows, 5 columns of textboxes.  </p>\n\n<p>Each row of textboxes are indexed for the row they are in. eg. <code>txt.Name1</code>, <code>txt.City1</code>...<code>txt,County1</code>.  Then the next row of textboxes is <code>txt.Name2</code>, <code>txt.City2</code>...<code>txt,County2</code>...</p>\n\n<p>How can I loop through each row and transfer it to an awaiting row of textboxes with out writing code for every row? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1966, "user_id": 2388077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQuzC.jpg?s=128&g=1", "display_name": "Ben Lyall", "link": "https://stackoverflow.com/users/2388077/ben-lyall"}, "edited": false, "score": 0, "creation_date": 1430263858, "post_id": 29930874, "comment_id": 47985740, "body": "It would help others if you could post some code that you have already tried, where in the code the issue is, and what, if any, error message you&#39;re getting when you run the code."}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 1, "last_activity_date": 1430259554, "creation_date": 1430259554, "answer_id": 29930957, "question_id": 29930874, "link": "https://stackoverflow.com/questions/29930874/posting-a-date-column-in-excel-vba/29930957#29930957", "title": "Posting a date column in Excel VBA", "body": "<p>You could programmatically do this in vb to detect the bottom row with a value in, though it sounds as though you might be after a more straight forwards working solution.</p>\n\n<p>Type a value in the top row, and with the cell selected you should see a square in the bottom right of the cell, double click it to fill to the end of the used range.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1430260040, "creation_date": 1430260040, "answer_id": 29931052, "question_id": 29930874, "link": "https://stackoverflow.com/questions/29930874/posting-a-date-column-in-excel-vba/29931052#29931052", "title": "Posting a date column in Excel VBA", "body": "<pre><code>Sub Tester()\n\n    With ActiveSheet\n        .Range(.Range(\"E1\"), _\n               .Cells(Rows.Count, \"E\").End(xlUp)).Offset(0, 1).Value = Date\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1430260115, "creation_date": 1430260115, "answer_id": 29931071, "question_id": 29930874, "link": "https://stackoverflow.com/questions/29930874/posting-a-date-column-in-excel-vba/29931071#29931071", "title": "Posting a date column in Excel VBA", "body": "<p>In VBA you would typically look from the bottom up to find the last non-blank cell in a column. With this, you can get the <code>.Row</code> to concatenate into a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> definition. Example:</p>\n\n<pre><code>with activesheet\n    .range(\"F1:F\" &amp; .cells(rows.count, 5).end(xlup).row) = Format(Now, \"dd-mmm-yyyy  hh:mm\")\nend with\n</code></pre>\n\n<p>This will fill column F from the first row to the cell in column F that is next to the last non-blank value in column E.</p>\n"}], "owner": {"reputation": 3, "user_id": 4843976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8451056e450d5c8f777cceb5ccbb7a5c?s=128&d=identicon&r=PG&f=1", "display_name": "masonpi", "link": "https://stackoverflow.com/users/4843976/masonpi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 29931071, "answer_count": 3, "score": 0, "last_activity_date": 1430260115, "creation_date": 1430259092, "question_id": 29930874, "link": "https://stackoverflow.com/questions/29930874/posting-a-date-column-in-excel-vba", "title": "Posting a date column in Excel VBA", "body": "<p>I'm stuck on what should be a very simple question, which is frustrating me greatly.</p>\n\n<p>Essentially, I'm sorting through many files and manipulating them, but am stuck on this: how do I add in a column with something like the date in every cell down to the end of where the other columns have data?</p>\n\n<p>Say that there are 5 other columns with length of 20 each. What code would I use to make column 6 have a certain value with a length of 20? The length varies with each sheet I work on, and this has been the problem.</p>\n\n<p>In a program like MATLAB, I could just denote this by putting something like F1:end, but finding the answer for Excel is driving me crazy!</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1430258760, "post_id": 29930754, "comment_id": 47983868, "body": "<code>xValue = Left(Rng1.Value, 4)</code>"}, {"owner": {"reputation": 61, "user_id": 4843651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c150b550c38a36a520c9bbd0b734821?s=128&d=identicon&r=PG&f=1", "display_name": "GeneralS", "link": "https://stackoverflow.com/users/4843651/generals"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430259783, "post_id": 29930754, "comment_id": 47984318, "body": "Thank you very much, that&#39;s it :)."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4843651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c150b550c38a36a520c9bbd0b734821?s=128&d=identicon&r=PG&f=1", "display_name": "GeneralS", "link": "https://stackoverflow.com/users/4843651/generals"}, "edited": false, "score": 0, "creation_date": 1430683440, "post_id": 29937548, "comment_id": 48154880, "body": "Thank you very much for your detailed explanation. It is very helpful."}], "tags": [], "owner": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "is_accepted": false, "score": 0, "last_activity_date": 1430294723, "last_edit_date": 1430294723, "creation_date": 1430294003, "answer_id": 29937548, "question_id": 29930754, "link": "https://stackoverflow.com/questions/29930754/compare-two-columns-but-only-first-4-letters-vba-excel/29937548#29937548", "title": "Compare two columns, but only first 4 letters - vba excel", "body": "<p>The function that you need is the following:</p>\n\n<pre><code>test = Left(\"YOURVALUE\",4)\n</code></pre>\n\n<p>Of course there is also the opposite function:</p>\n\n<pre><code>test = Right(\"YOURVALUE\",5)\n</code></pre>\n\n<p>In firts case the result in test is \"YOUR\" and in second case is \"VALUE\"</p>\n\n<p>To copy value in colum C you can use two strategy:</p>\n\n<pre><code>ActiveSheet.Range(\"C\" &amp; x).Cells(row_index, column_index)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ActiveSheet.Range(\"C\" &amp; x).PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4843651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c150b550c38a36a520c9bbd0b734821?s=128&d=identicon&r=PG&f=1", "display_name": "GeneralS", "link": "https://stackoverflow.com/users/4843651/generals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2261, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1430294723, "creation_date": 1430258556, "question_id": 29930754, "link": "https://stackoverflow.com/questions/29930754/compare-two-columns-but-only-first-4-letters-vba-excel", "title": "Compare two columns, but only first 4 letters - vba excel", "body": "<p>I have 2 columns - Column A and Column B, filled with different items. Column B is always shorter (it has less items than column A). I need a VBA formula in Excel 2007 to do the following: </p>\n\n<p>1) Compare first 4 letters of items in column B to first 4 letters of items column A </p>\n\n<p>2) Find a match in column A and copy the whole content of the cell in column A to Column C, next to the item in column B that matched.</p>\n\n<p>Here's what I've made so far:</p>\n\n<pre><code>    Sub Compare()\nDim Range1 As Range, Range2 As Range, Rng1 As Range, Rng2 As Range\nDim x As Long\nxTitleId = \"Compare\"\nSet Range1 = Application.Selection\nSet Range1 = Application.InputBox(\"Range1 :\", xTitleId, Range1.Address, Type:=8)\nSet Range2 = Application.InputBox(\"Range2:\", xTitleId, Type:=8)\nApplication.ScreenUpdating = False\nFor Each Rng1 In Range1\n    xValue = Rng1.Value\n\n    For Each Rng2 In Range2\n    x = Rng2.Row\n        If xValue = Rng2.Value Then\n            Rng1.Copy\n            ActiveSheet.Range(\"C\" &amp; x).PasteSpecial\n        End If\n    Next\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This code does the job, but it compares whole words and I need just first 4 letters. I know of the function Left, but I don't know how to implement it here. Can anyone help me?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430258535, "post_id": 29930523, "comment_id": 47983743, "body": "It&#39;s not clear to me what you are trying to accomplish nor why you need a <code>Worksheet_Change</code> event macro for this. Could you elaborate your description to include what you are trying to do and possibly <i>why</i> you want to do it?"}, {"owner": {"reputation": 2707, "user_id": 2417833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a7Rh6.jpg?s=128&g=1", "display_name": "scraaappy", "link": "https://stackoverflow.com/users/2417833/scraaappy"}, "edited": false, "score": 0, "creation_date": 1430258892, "post_id": 29930523, "comment_id": 47983946, "body": "if you really don&#39;t want empty value, you can check if Range(&quot;A2&quot;).Cells(i, 1).Value &lt;&gt; &quot;&quot; before doing arrmatrix(i, 1) = Range(&quot;A2&quot;).Cells(i, 1).Value. Declare a new Long and increment it each time the condition is fulfilled to redim arrmatrix at the end of the loop"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 109, "user_id": 4842900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5fc5251ff762857293143ee02c9fc265?s=128&d=identicon&r=PG&f=1", "display_name": "diego", "link": "https://stackoverflow.com/users/4842900/diego"}, "edited": false, "score": 0, "creation_date": 1430281374, "post_id": 29931503, "comment_id": 47990700, "body": "I&#39;m afraid that I cannot make sense of the conditions you&#39;ve added. <i>Pi emitida</i> comes into the new conditions as well as the original conditions and I cannot determine the hierarchy for the final <i>And hoy - Cells(j, 12).Value &gt;= 0</i> since in all other situations Cells(j, 12) is text. It would be best if you edited your original question to include these and offer what you&#39;ve done to add these new situations yourself."}, {"owner": {"reputation": 109, "user_id": 4842900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5fc5251ff762857293143ee02c9fc265?s=128&d=identicon&r=PG&f=1", "display_name": "diego", "link": "https://stackoverflow.com/users/4842900/diego"}, "edited": false, "score": 0, "creation_date": 1430339586, "post_id": 29931503, "comment_id": 48028670, "body": "I made a new question with my problem, to make it simpler"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1430262551, "creation_date": 1430262551, "answer_id": 29931503, "question_id": 29930523, "link": "https://stackoverflow.com/questions/29930523/erase-empty-cells-in-an-array/29931503#29931503", "title": "Erase empty cells in an array", "body": "<p>There are a few problems with your sample code.</p>\n\n<ol>\n<li>Hopefully, this is on the <strong>Info</strong> worksheet's code sheet. You should not be attempting to <code>.Activate</code> another worksheet from the <code>Worksheet_Change</code> event macro.</li>\n<li>It isn't clear why you need this in a <code>Worksheet_Change</code> event macro. As-is, this will run any time a value anywhere in the worksheet is added/modified/deleted. That sounds like overkill since the only two columns that determine the outcome are columns A and L.</li>\n<li>The <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/w8k3cys2%28v=vs.110%29.aspx\" rel=\"nofollow\">ReDim statement</a> can be used with <em>Preserve</em> to expand the array but it can only redimension the last rank.</li>\n</ol>\n\n<p>This modification does not rely on selecting or activating the worksheet(s) before processing them. The <em>arrmatrix</em> array is expanded as needed so you do not end up with blank values in the array.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A:A, L:L\")) Is Nothing Then\n        On Error GoTo F\u00ecn\n        Application.EnableEvents = False\n        Dim i As Long, n As Long\n        Dim arrmatrix As Variant\n        ReDim arrmatrix(1 To 1, 1 To 1)\n        For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n            If Cells(i, 12).Value = \"Pi emitida\" Then\n                n = n + 1\n                ReDim Preserve arrmatrix(1 To 1, 1 To n)\n                arrmatrix(1, n) = Cells(i, 1).Value\n            End If\n        Next i\n        With Worksheets(\"Inicio\")\n            .Range(\"G4:G\" &amp; Rows.Count).ClearContents\n            .Range(\"G4\").Resize(UBound(arrmatrix, 2), 1) = Application.Transpose(arrmatrix)\n        End With\n    End If\n\nF\u00ecn:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This will only run when a value in column A or column L is added/changed/deleted.</p>\n\n<p>Since I've been expanding and populating the last rank, I used <code>Application.Transpose</code> to reorient the data before I stuffed it back into the <strong>Inicio</strong> worksheet.</p>\n"}], "owner": {"reputation": 109, "user_id": 4842900, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5fc5251ff762857293143ee02c9fc265?s=128&d=identicon&r=PG&f=1", "display_name": "diego", "link": "https://stackoverflow.com/users/4842900/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 29931503, "answer_count": 1, "score": 2, "last_activity_date": 1430262551, "creation_date": 1430257609, "last_edit_date": 1531161705, "question_id": 29930523, "link": "https://stackoverflow.com/questions/29930523/erase-empty-cells-in-an-array", "title": "Erase empty cells in an array", "body": "<p>I paste an array in a column, the problem is that it leaves some cells in the column empty. How can I erase those cells in the column?</p>\n\n<p>This is what I have:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Worksheets(\"Info\").Range(\"A1\").Select\n    Dim i As Integer\n    Dim iLastRow As Long\n    iLastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n    Dim arrmatrix() As String\n\n     ReDim arrmatrix(1 To iLastRow, 1 To 1)\n    For i = 1 To iLastRow\n    Range(\"A2\").Cells(i, 1).Select\n    If Selection.Offset(0, 11) = \"Pi emitida\" Then\n    arrmatrix(i, 1) = Range(\"A2\").Cells(i, 1).Value\n    End If\n    Next i\n    Worksheets(\"Inicio\").Range(\"G4:G1000000\").ClearContents\n\n    Worksheets(\"Inicio\").Range(\"G4\").Resize(UBound(arrmatrix, 1)).Value =     arrmatrix()\n\nend sub\n</code></pre>\n"}, {"tags": ["excel", "powershell", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1430259197, "post_id": 29930490, "comment_id": 47984079, "body": "<a href=\"http://blogs.technet.com/b/heyscriptingguy/archive/2006/09/08/how-can-i-use-windows-powershell-to-automate-microsoft-excel.aspx\" rel=\"nofollow noreferrer\">blogs.technet.com/b/heyscriptingguy/archive/2006/09/08/&hellip;</a>"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 2, "creation_date": 1430292505, "post_id": 29930490, "comment_id": 47995638, "body": "<a href=\"http://sdb.planetcobalt.net/vba2psh.shtml\" rel=\"nofollow noreferrer\">sdb.planetcobalt.net/vba2psh.shtml</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 621390, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/dtnU9.jpg?s=128&g=1", "display_name": "Jeno Laszlo", "link": "https://stackoverflow.com/users/621390/jeno-laszlo"}, "is_accepted": false, "score": 2, "last_activity_date": 1432201231, "last_edit_date": 1432201231, "creation_date": 1432116125, "answer_id": 30346420, "question_id": 29930490, "link": "https://stackoverflow.com/questions/29930490/convert-code-from-excel-macro-to-powershell/30346420#30346420", "title": "Convert code from Excel Macro to PowerShell", "body": "<p>You could write something like this: </p>\n\n<pre><code>$objExcel = New-Object -ComObject Excel.Application\n\n$objExcel.Visible = $true\n$objExcel.DisplayAlerts = $false\n\n$filePath = \"c:\\logs\\2015-04-23.csv\"\n\n$xlsFilePath = Get-Item -Path $filePath | % { Join-Path (Split-Path $_ -Parent) \"$($_.BaseName).xls\" } \n\n$workBook = $objExcel.Workbooks.Open($filePath)\n$workSheet = $WorkBook.sheets | select -First 1\n\n$xlup = -4162\n\n$lrow = $workSheet.cells.Range(\"G\" + $workSheet.Rows.Count).End($xlup).Row\n\n$workSheet.cells.Range(\"G2:G\" + $lrow) | % { \n    $value = $_.Text\n    if($value.ToUpper() -eq \"TRUE\"){\n       $_.Interior.ColorIndex = 3 \n    }\n}\n\n$WorkBook.SaveAs($xlsFilePath, 18) \n$objExcel.Quit()\n</code></pre>\n\n<p>If you have a very large file, it is faster to search values using powershell then updating the Excel sheet. The following example looks a bit funny but executes much faster. </p>\n\n<pre><code>$filePath = \"c:\\logs\\2015-04-23.csv\"\n\n$rowAliases = 97..122 | foreach { ([char]$_).ToString().ToUpper() }\n$selectedRow = \"G\"\n$selectedName = (Get-Content $filePath -ReadCount 1 -TotalCount 1).Split(\",\")[$rowAliases.IndexOf($selectedRow)]\n$startRow = 2\n$rowCount = 1;\n\n$objExcel = New-Object -ComObject Excel.Application\n\n$objExcel.Visible = $true\n$objExcel.DisplayAlerts = $false\n\n$xlsFilePath = Get-Item -Path $filePath | % { Join-Path (Split-Path $_ -Parent) \"$($_.BaseName).xls\" } \n\n$workBook = $objExcel.Workbooks.Open($filePath)\n$workSheet = $WorkBook.sheets | select -First 1\n\nImport-Csv -Path $filePath | % {\n\n    if($rowCount -ge $startRow){\n        [string]$value = $_ | select -ExpandProperty $selectedName\n\n        if($value.ToUpper() -eq \"TRUE\"){\n            $workSheet.cells.Item($rowCount + 1, $selectedIndex + 1).Interior.ColorIndex = 3 \n        }\n    }\n\n    $rowCount ++\n}\n\n$WorkBook.SaveAs($xlsFilePath, 18) \n$objExcel.Quit()\n</code></pre>\n"}], "owner": {"reputation": 14375, "user_id": 344669, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8JOSf.gif?s=128&g=1", "display_name": "sfgroups", "link": "https://stackoverflow.com/users/344669/sfgroups"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1852, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1432201231, "creation_date": 1430257464, "last_edit_date": 1531164843, "question_id": 29930490, "link": "https://stackoverflow.com/questions/29930490/convert-code-from-excel-macro-to-powershell", "title": "Convert code from Excel Macro to PowerShell", "body": "<p>I open a CSV file in Excel and run this macro to change the background color. I am trying to convert this part of code to PowerShell.</p>\n\n<pre><code>   lrow = Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n    Set MR = Range(\"G2:G\" &amp; lrow)\n    For Each cell In MR\n        If UCase(Trim(cell.Value)) = \"FALSE\" Then\n            cell.Interior.ColorIndex = 3\n        End If\n    Next\n</code></pre>\n\n<p>Any help converting this code to PowerShell.</p>\n\n<p>Thanks\nSR</p>\n"}, {"tags": ["vba", "excel", "cookies", "soap"], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 4807661, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/52988a9e8b5c67060718b0de863bd041?s=128&d=identicon&r=PG", "display_name": "Trigger", "link": "https://stackoverflow.com/users/4807661/trigger"}, "is_accepted": false, "score": 0, "last_activity_date": 1430258331, "creation_date": 1430258331, "answer_id": 29930700, "question_id": 29930461, "link": "https://stackoverflow.com/questions/29930461/soap-through-vba/29930700#29930700", "title": "SOAP through VBA", "body": "<p>You are not error checking. Adapt the following error checking to your code. <code>err.number, err.description, err.source, file.status, file.statustext, file.getallresponseheaders</code>.</p>\n\n<p>The URL has to be 100% correct. Unlike a browser there is no code to fix urls.</p>\n\n<p>The purpose of my program is to get error details.</p>\n\n<p>How I get a correct URL is to type my url in a browser, navigate, and the correct URL is often in the address bar. The other way is to use Properties of a link etc to get the URL.</p>\n\n<p>Also Microsoft.XMLHTTP maps to Microsoft.XMLHTTP.1.0. HKEY_CLASSES_ROOT\\Msxml2.XMLHTTP maps to Msxml2.XMLHTTP.3.0. Try a later one</p>\n\n<p>Try this way using xmlhttp. Edit the url's etc. If it seems to work comment out the if / end if to dump info even if seeming to work. It's vbscript but vbscript works in vb6. </p>\n\n<pre><code> On Error Resume Next\n Set File = WScript.CreateObject(\"Microsoft.XMLHTTP\")\n File.Open \"GET\", \"http://www.microsoft.com/en-au/default.aspx\", False\n 'This is IE 8 headers\n File.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30618; .NET4.0C; .NET4.0E; BCD2000; BCD2000)\"\n File.Send\n If err.number &lt;&gt; 0 then \n    line =\"\"\n    Line  = Line &amp;  vbcrlf &amp; \"\" \n    Line  = Line &amp;  vbcrlf &amp; \"Error getting file\" \n    Line  = Line &amp;  vbcrlf &amp; \"==================\" \n    Line  = Line &amp;  vbcrlf &amp; \"\" \n    Line  = Line &amp;  vbcrlf &amp; \"Error \" &amp; err.number &amp; \"(0x\" &amp; hex(err.number) &amp; \") \" &amp; err.description \n    Line  = Line &amp;  vbcrlf &amp; \"Source \" &amp; err.source \n    Line  = Line &amp;  vbcrlf &amp; \"\" \n    Line  = Line &amp;  vbcrlf &amp; \"HTTP Error \" &amp; File.Status &amp; \" \" &amp; File.StatusText\n    Line  = Line &amp;  vbcrlf &amp;  File.getAllResponseHeaders\n    wscript.echo Line\n    Err.clear\n    wscript.quit\n End If\n\nOn Error Goto 0\n\n Set BS = CreateObject(\"ADODB.Stream\")\n BS.type = 1\n BS.open\n BS.Write File.ResponseBody\n BS.SaveToFile \"c:\\users\\test.txt\", 2\n</code></pre>\n\n<p>Also see if these other objects work.</p>\n\n<pre><code>C:\\Users&gt;reg query hkcr /f xmlhttp\n\nHKEY_CLASSES_ROOT\\Microsoft.XMLHTTP\nHKEY_CLASSES_ROOT\\Microsoft.XMLHTTP.1.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.3.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.4.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.5.0\nHKEY_CLASSES_ROOT\\Msxml2.ServerXMLHTTP.6.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.3.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.4.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.5.0\nHKEY_CLASSES_ROOT\\Msxml2.XMLHTTP.6.0\nEnd of search: 12 match(es) found.\n</code></pre>\n\n<p>Also be aware there is a limit on how many times you can call any particular XMLHTTP object before a lockout occurs. If that happens, and it does when debugging code, just change to a different xmlhttp object</p>\n\n<p>I get this running your code.</p>\n\n<pre><code>---------------------------\nWindows Script Host\n---------------------------\n\n\nError 0(0x0) \n\nSource \n\n\n\nHTTP Error 200 OK\n\nDate: Tue, 28 Apr 2015 21:56:46 GMT\n\nServer: Microsoft-IIS/7.5\n\nCache-Control: private, max-age=0\n\nContent-Type: text/xml; charset=utf-8\n\nX-AspNet-Version: 2.0.50727\n\nX-Powered-By: ASP.NET\n\nAccess-Control-Allow-Origin: *\n\nKeep-Alive: timeout=5, max=100\n\nConnection: Keep-Alive\n\n\n\n\n---------------------------\nOK   \n---------------------------\n</code></pre>\n\n<p>Then I msgbox out responsebody and I have data sending cat rather than what's in your spreadsheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 4843889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b09690c1674f015124782bcf3d08d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/4843889/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1858, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1430258331, "creation_date": 1430257327, "question_id": 29930461, "link": "https://stackoverflow.com/questions/29930461/soap-through-vba", "title": "SOAP through VBA", "body": "<p>I am attempting to pull the info that the following site pulls: <a href=\"http://gis.calhouncounty.org/ParcelViewer/index.html\" rel=\"nofollow\">http://gis.calhouncounty.org/ParcelViewer/index.html</a>.  If you type in PPIN 66078 and then click Property Taxes, it will bring up data.  I am attempting to recreate this SOAP request in VBA, but unsuccessfully.  It calls the service, but all data in the response is blank.  I got so frustrated that I even recreated the full header set, to no avail.  Maybe there is a cookie issue, but the cookies on my computer don't seem to expire quickly.  Here's what I have in the extract:</p>\n\n<pre><code>URL = \"http://gis.calhouncounty.org/wsCalhounParcel2/Inquiry.asmx?WSDL\"\n\nmethod = \"getTaxBill\"\nparcel = Range(\"A\" &amp; currentrow).Value\n\n\nSoapRequest = SoapRequest &amp; \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?&gt;&lt;soap:Envelope xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\" xmlns:xsd=\"\"http://www.w3.org/2001/XMLSchema\"\" xmlns:xsi=\"\"http://www.w3.org/2001/XMLSchema-instance\"\"&gt; \"\nSoapRequest = SoapRequest &amp; \"&lt;soap:Body&gt;\"\n\nSoapRequest = SoapRequest &amp; \"&lt;tns:\" &amp; method &amp; \" xmlns:tns=\"\"http://gis.calhouncounty.org\"\"&gt;\"\nSoapRequest = SoapRequest &amp; \"&lt;tns:PPIN&gt;\" &amp; parcel &amp; \"&lt;/tns:PPIN&gt;\"\nSoapRequest = SoapRequest &amp; \"&lt;/tns:\" &amp; method &amp; \"&gt;\"\n\nSoapRequest = SoapRequest &amp; \"&lt;/soap:Body&gt;\"\nSoapRequest = SoapRequest &amp; \"&lt;/soap:Envelope&gt;\"\n\n\nSet objHTTP = CreateObject(\"Msxml2.XMLHTTP\") \nobjHTTP.Open \"POST\", URL, False \nobjHTTP.setRequestHeader \"Host\", \"gis.calhouncounty.org\"\nobjHTTP.setRequestHeader \"Connection\", \"keep-alive\"\nobjHTTP.setRequestHeader \"Content-Length\", SoapRequestLen\nobjHTTP.setRequestHeader \"Origin\", \"http://gis.calhouncounty.org\"\nobjHTTP.setRequestHeader \"X-Requested-With\", \"ShockwaveFlash/17.0.0.169\"\nobjHTTP.setRequestHeader \"SOAPAction\", \"http://gis.calhouncounty.org/\" &amp; method\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36\"\nobjHTTP.setRequestHeader \"Content-Type\", \"text/xml; charset=utf-8\"\nobjHTTP.setRequestHeader \"Accept\", \"*/*\"\nobjHTTP.setRequestHeader \"Referer\", \"http://gis.calhouncounty.org/ParcelViewer\"\nobjHTTP.setRequestHeader \"Accept-Encoding\", \"gzip, deflate\"\nobjHTTP.setRequestHeader \"Accept-Language\", \"en-US,en;q=0.8\"\n\nobjHTTP.setRequestHeader \"Cookie\", \"ASPSESSIONIDAABARSAB=DIIJLAGCFJKDFKBCDNMMLEIB; ASPSESSIONIDAAACQSBA=BKAJPFCDCAJLBAKFFBACBMGC; ASPSESSIONIDCCCBRTBA=DKJPBAPDNLIFBOJGCPEDMAHG; __utma=262294995.1570768928.1429018531.1429018531.1430173329.2; __utmc=262294995; __utmz=262294995.1430173329.2.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); ASPSESSIONIDAQTRATAB=OHCBMBMCNALFKOCODDMIAHIA; _ga=GA1.2.90452212.1429018592; __utmt=1; __utma=167846455.90452212.1429018592.1430173349.1430248358.4; __utmb=167846455.1.10.1430248358; __utmc=167846455; __utmz=167846455.1430173349.3.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)\"\n\nobjHTTP.send SoapRequest\n</code></pre>\n\n<p>Any help is incredibly appreciated!\n-Andy</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 386, "user_id": 1715021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/J9gSA.jpg?s=128&g=1", "display_name": "Arijit Kanrar", "link": "https://stackoverflow.com/users/1715021/arijit-kanrar"}, "edited": false, "score": 1, "creation_date": 1430262156, "post_id": 29930746, "comment_id": 47985216, "body": "That was a mind-numbingly simple solution to a frustrating problem. Yes excel is bizarre! In a ideal object-oriented world, Excel should just be calling a function inside the Range object and asking it for the right address and the Range object should handle the single cell on its own. But its not an ideal world after all. Thanks a million Zerk. I wish I could upvote your answer a thousand times but I don&#39;t have enough reputation to do so!"}, {"owner": {"reputation": 134, "user_id": 10986879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ELEICvXMOBY/AAAAAAAAAAI/AAAAAAAAAZg/k3_D_aVqziU/photo.jpg?sz=128", "display_name": "Alex M", "link": "https://stackoverflow.com/users/10986879/alex-m"}, "reply_to_user": {"reputation": 386, "user_id": 1715021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/J9gSA.jpg?s=128&g=1", "display_name": "Arijit Kanrar", "link": "https://stackoverflow.com/users/1715021/arijit-kanrar"}, "edited": false, "score": 0, "creation_date": 1569006565, "post_id": 29930746, "comment_id": 102470022, "body": "@ArijitKanrar I mean, you could upvote it <i>once</i>. You could also have accepted it."}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": true, "score": 2, "last_activity_date": 1430258527, "creation_date": 1430258527, "answer_id": 29930746, "question_id": 29930337, "link": "https://stackoverflow.com/questions/29930337/vba-adding-cell-validation-failing-for-single-cell-range/29930746#29930746", "title": "VBA adding cell validation failing for single cell range", "body": "<p>The solution to this shows how bizarre Excel can be.</p>\n\n<p>Firstly, look at what is being fed into the <code>formula1</code> parameter.</p>\n\n<p>If a single cell is selected:</p>\n\n<pre><code>$G$2\n</code></pre>\n\n<p>If a range of cells is selected:</p>\n\n<pre><code>$G$2:$G$3\n</code></pre>\n\n<p>Infuriatingly, Excel is expecting a start and an end to your range.</p>\n\n<p>The solution is to check the range size, here is an example piece of code based on yours that I used for testing that you can adjust to your needs.</p>\n\n<pre><code>Sub add_validation()\n\nDim rng As Range\nSet rng = Selection\n\n\nWith Cells(1, 1).Validation\n    .Delete\n    If Selection.Count = 1 Then\n        .Add Type:=xlValidateList, Formula1:=\"=\" &amp; ActiveSheet.Name &amp; \"!\" &amp; rng.Address &amp; \":\" &amp; rng.Address\n    ElseIf Selection.Count &gt; 1 Then\n        .Add Type:=xlValidateList, Formula1:=\"=\" &amp; ActiveSheet.Name &amp; \"!\" &amp; rng.Address\n    End If\n    .InCellDropdown = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And your code with the size check implemented:</p>\n\n<pre><code>With Cells(c.Row, colResource).Validation\n    .Delete\n    If resrng.Count = 1 Then\n        .Add Type:=xlValidateList, Formula1:=\"=\" &amp; Sheets(sheetResources).Name &amp; \"!\" &amp; resrng.Address &amp; \":\" &amp; resrng.Address\n    ElseIf resrng.Count &gt; 1 Then\n        .Add Type:=xlValidateList, Formula1:=\"=\" &amp; Sheets(sheetResources).Name &amp; \"!\" &amp; resrng.Address\n    End If\n    .InCellDropdown = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 386, "user_id": 1715021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/J9gSA.jpg?s=128&g=1", "display_name": "Arijit Kanrar", "link": "https://stackoverflow.com/users/1715021/arijit-kanrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 29930746, "answer_count": 1, "score": 2, "last_activity_date": 1430258527, "creation_date": 1430256855, "last_edit_date": 1531164843, "question_id": 29930337, "link": "https://stackoverflow.com/questions/29930337/vba-adding-cell-validation-failing-for-single-cell-range", "title": "VBA adding cell validation failing for single cell range", "body": "<p>I have a VBA macro which gets data from another sheet as a Range object and uses that Range object to add a validation on a cell on the current sheet like this</p>\n\n<pre><code>With Cells(c.Row, colResource).Validation\n    .Delete\n    .Add Type:=xlValidateList, Formula1:=\"=\" &amp; Sheets(sheetResources).Name &amp; \"!\" &amp; resRng.Address\n    .InCellDropdown = True\nEnd With\n</code></pre>\n\n<p>This works fine except when <code>resRng</code> object has only one cell.\nWhat can cause a range with multiple cells to work but a single cell range to fail?</p>\n\n<p>Any help would be appreciated!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "lync-2013", "office-communicator"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430259070, "post_id": 29929842, "comment_id": 47984013, "body": "Apparently that API was deprecated in 2010 (though still supported) but is not included in 2013."}, {"owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430260169, "post_id": 29929842, "comment_id": 47984477, "body": "@TimWilliams do you have a source for that? I spent probably two hours today researching this and could not find anything meaningful."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1430261274, "post_id": 29929842, "comment_id": 47984906, "body": "Nothing too concrete - there is a link referenced here <a href=\"https://social.msdn.microsoft.com/Forums/en-US/222958e2-24f9-46bf-b79a-eb88a3feac72/lync-2013-client-ocs-2007-automation-api-compatibility?forum=communicatorsdk\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a> but I didn&#39;t read through it"}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1487234440, "post_id": 42119976, "comment_id": 71693855, "body": "<i>Is what you are hoping for to know if anyone already created such a wrapper?</i> I&#39;ve browsed the web and GitHub, I haven&#39;t seen anything like this yet. I took a look at the SDK directly and it seems that you can work with VB, it shouldn&#39;t be that far from VBA, but you&#39;ll have to construct quite a lot of functions if you don&#39;t have just a specific need!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487277655, "post_id": 42119976, "comment_id": 71725014, "body": "If something already existed it would have been ideal, but I think it&#39;s quite a specific need so probably not that much interest in creating one. Maybe if I get time I&#39;ll have a crack at it."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1487319496, "post_id": 42119976, "comment_id": 71740850, "body": "Yup, If you ever take a run at it, let me know, I&#39;ll try to contribute! ;)"}, {"owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "edited": false, "score": 0, "creation_date": 1497045631, "post_id": 42119976, "comment_id": 75931208, "body": "Would love to also know more about this"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1497046235, "post_id": 42119976, "comment_id": 75931388, "body": "I think I&#39;m going to write a wrapper for this in C#.NET and see if I can get it working."}, {"owner": {"reputation": 3121, "user_id": 235647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d07622242845326fc99d46fa63ec092e?s=128&d=identicon&r=PG", "display_name": "Nik Burns", "link": "https://stackoverflow.com/users/235647/nik-burns"}, "edited": false, "score": 0, "creation_date": 1566297839, "post_id": 42119976, "comment_id": 101604158, "body": "anyone have any luck with a wrapper for excel/lync? this is a stupid move from MS, makes users develop again from scratch."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3121, "user_id": 235647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d07622242845326fc99d46fa63ec092e?s=128&d=identicon&r=PG", "display_name": "Nik Burns", "link": "https://stackoverflow.com/users/235647/nik-burns"}, "edited": false, "score": 1, "creation_date": 1566298207, "post_id": 42119976, "comment_id": 101604348, "body": "@NikBurns I did plan on creating this but never actually had a need for it. I may look into it again over the next couple of months."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 4, "last_activity_date": 1486575471, "creation_date": 1486575471, "answer_id": 42119976, "question_id": 29929842, "link": "https://stackoverflow.com/questions/29929842/where-did-the-communicator-api-go-with-lync-2013-for-vba/42119976#42119976", "title": "Where did the communicator API go with Lync 2013 for VBA?", "body": "<p>I did award a bounty to this question - but have since read 2 posts on MSDN Social that suggest MS have stopped supporting the automation PI for Lync.</p>\n\n<p>The closest thing I could find is a quote from <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/87001106-2ba1-490d-bfa0-e9f2ccfd1379/vba-to-send-an-im-using-skype-for-business?forum=communicatorsdk\" rel=\"nofollow noreferrer\">this page</a></p>\n\n<blockquote>\n  <p>\"Lync 2013/SfB 2015 does not expose COM entry points that Excel can use.</p>\n  \n  <p>You can create a wrapper around the Lync 2013 SDK and expose some COM objects that could be used from Excel.\"</p>\n</blockquote>\n"}], "owner": {"reputation": 12273, "user_id": 1048539, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b2bfeca28ec73556f395bed4668f9e16?s=128&d=identicon&r=PG", "display_name": "enderland", "link": "https://stackoverflow.com/users/1048539/enderland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5278, "favorite_count": 1, "answer_count": 1, "score": 27, "last_activity_date": 1486575471, "creation_date": 1430254852, "last_edit_date": 1430256577, "question_id": 29929842, "link": "https://stackoverflow.com/questions/29929842/where-did-the-communicator-api-go-with-lync-2013-for-vba", "title": "Where did the communicator API go with Lync 2013 for VBA?", "body": "<p>Prior to Lync 2013, there was a reference you could use for connecting Lync/Communicator to VBA:</p>\n\n<p><code>Microsoft Office Communicator 2007 API Type Library</code></p>\n\n<p>This allowed you to write code such as:</p>\n\n<pre><code>Dim msgr As CommunicatorAPI.Messenger\nDim msg As CommunicatorAPI.IMessengerConversationWndAdvanced\n</code></pre>\n\n<p>You could then write code to manipulate Lync such as generating IMs, etc.</p>\n\n<p>I have recently \"updated\" Office to 2013. However, all code such as the above no longer works and it appears the required dll is not included in the Lync 2013 installation. VBA complains as the reference is not found.</p>\n\n<p>Downloading the <a href=\"https://www.microsoft.com/en-us/download/confirmation.aspx?id=10176\">Communicator 2007 SDK</a> does not allow me to load the reference. I <em>suspect</em> I could rewrite all that code to treat this as a standard dll (maybe?).</p>\n\n<p>What file do I need to reference with Lync 2013?</p>\n"}, {"tags": ["excel", "cell", "autofilter", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 1, "last_activity_date": 1430254216, "creation_date": 1430254216, "answer_id": 29929663, "question_id": 29929544, "link": "https://stackoverflow.com/questions/29929544/use-multiple-cell-values-in-autofilter-criteria/29929663#29929663", "title": "use multiple cell values in autofilter criteria", "body": "<p>I believe you should add a <code>Criteria2</code>, <code>Criteria3</code>, and <code>Criteria4</code>.</p>\n\n<p>I would update this line</p>\n\n<pre><code>ActiveSheet.Range(\"$Y$2:$Y$2999\").AutoFilter Field:=1,_\nCriteria1:=Array(a, b, c, d)\n</code></pre>\n\n<p>To be</p>\n\n<pre><code>ActiveSheet.Range(\"$Y$2:$Y$2999\").AutoFilter Field:=1, _\nCriteria1:=\"=\" &amp; a, _\n    Operator:=xlOr, _\nCriteria2:=\"=\" &amp; b, _\n    Operator:=xlOr, _\nCriteria3:=\"=\" &amp; c, _\n    Operator:=xlOr, _\nCriteria4:=\"=\" &amp; d\n</code></pre>\n\n<p>Or if you are going to do it like so:</p>\n\n<pre><code>ActiveSheet.Range(\"$Y$2:$Y$2999\").AutoFilter Field:=1,_\nCriteria1:=Array(a, b, c, d)\n</code></pre>\n\n<p>You should try adding the <code>xlFilterValues</code> operator so it would look like this:</p>\n\n<pre><code>ActiveSheet.Range(\"$Y$2:$Y$2999\").AutoFilter Field:=1, _\nCriteria1:=Array(a, b, c, d), _\nOperator:=xlFilterValues\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4841120, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3867fc60e9d348cc4265102b4377b6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Haider", "link": "https://stackoverflow.com/users/4841120/haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2299, "favorite_count": 0, "accepted_answer_id": 29929663, "answer_count": 1, "score": 0, "last_activity_date": 1430254216, "creation_date": 1430253842, "last_edit_date": 1531164843, "question_id": 29929544, "link": "https://stackoverflow.com/questions/29929544/use-multiple-cell-values-in-autofilter-criteria", "title": "use multiple cell values in autofilter criteria", "body": "<p>Please help me with this condition:</p>\n\n<p>1) The value present in cell P1,P2,P3,P4 is user defined words like \"F\",\"S\" and NA...</p>\n\n<p>2) Use the user defined value as criteria for filtering the data in range(Y2:Y2999)</p>\n\n<p>The thing I tried that didn't work is:</p>\n\n<pre><code>Sub c1()\nDim a As String\nDim b As String\nDim c As String\nDim d As String\na = Cells(1, 16).Value\nb = Cells(2, 16).Value\nc = Cells(3, 16).Value\nd = Cells(4, 16).Value\nActiveSheet.Range(\"$Y$2:$Y$2999\").AutoFilter Field:=1,_\nCriteria1:=Array(a, b, c, d)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "split"], "answers": [{"tags": [], "owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "is_accepted": false, "score": 0, "last_activity_date": 1430253092, "creation_date": 1430253092, "answer_id": 29929346, "question_id": 29928945, "link": "https://stackoverflow.com/questions/29928945/separate-characters-by-dashes-in-vba/29929346#29929346", "title": "Separate characters by dashes in vba", "body": "<p>You can split delimited text using the VBA <code>Split</code> function. Here is a basic example:</p>\n\n<pre><code>Sub test()\n\n    Dim MyArray() As String\n\n    ' use the VBA split function to split the string into array of strings\n    ' the second function parameter identifies the delimiter\n    MyArray() = Split(\"TOM-JAY-MOE-XRAY\", \"-\")\n\n    ' here I iterated the array and printed to the debug window.\n    For i = LBound(MyArray) To UBound(MyArray)\n        Debug.Print \"Word \" &amp; i &amp; \"=\" &amp; MyArray(i)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1430280311, "last_edit_date": 1430280311, "creation_date": 1430279361, "answer_id": 29933988, "question_id": 29928945, "link": "https://stackoverflow.com/questions/29928945/separate-characters-by-dashes-in-vba/29933988#29933988", "title": "Separate characters by dashes in vba", "body": "<p>You can do this like this:</p>\n\n<pre><code>With Sheets(\"SheetName\")\n    Dim lr As Long\n    lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    .Range(\"A1:A\" &amp; lr).TextToColumns Destination:=.Range(\"B1\") _\n        , DataType:=xlDelimited, Other:=True, OtherChar:=\"-\"\nEnd With\n</code></pre>\n\n<p>There is a built-in functionality in Excel to separate a delimited text, <code>TextToColumns</code>.<br>\nWhat we need is to just use that to separate the string especially if you only have 1 delimiter.</p>\n\n<p>Actually, if you want all data in Column A to be evaluated, you don't need to check the last row with value. So below will work just fine.</p>\n\n<pre><code>With Sheets(\"SheetName\")\n    .Range(\"A:A\").TextToColumns Destination:=.Range(\"B1\") _\n        , DataType:=xlDelimited, Other:=True, OtherChar:=\"-\"\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1430285513, "creation_date": 1430285513, "answer_id": 29935108, "question_id": 29928945, "link": "https://stackoverflow.com/questions/29928945/separate-characters-by-dashes-in-vba/29935108#29935108", "title": "Separate characters by dashes in vba", "body": "<p>This will do it in one go (Even from the debug window) and is not restricted to being 4 columns (which is what you asked for in your post) but rather just takes up as many columns as it needs to based on how many - will split the string</p>\n\n<pre><code>Range(\"B9\").Resize(1,ubound(Split(Range(\"A9\").Text,\"-\"))+1) = Split(Range(\"A9\").Text,\"-\")\n</code></pre>\n\n<p>My Test data was in row 9 column A, easy enough to drop this into a loop if you need to.</p>\n\n<p>Note: This is provided as an alternative to other answers, I am not in any way saying this is the only or the best way to do it, if you are doing multiple rows you are best off using Excels inbuilt text to columns function as posted by @L42</p>\n"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 0, "accepted_answer_id": 29933988, "answer_count": 3, "score": 2, "last_activity_date": 1430285513, "creation_date": 1430251753, "last_edit_date": 1430278514, "question_id": 29928945, "link": "https://stackoverflow.com/questions/29928945/separate-characters-by-dashes-in-vba", "title": "Separate characters by dashes in vba", "body": "<p>I am trying to separate characters by (-)dashes in VBA, then paste it to column B. So in my Column A I have TOM-JAY-MOE-XRAY. Now if I want to split it and paste into 4 different column like column B=TOM, C=JAY,so on. Here is my code and image to understand better.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zLhYY.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>Sub x()\n    Dim sheet As Worksheet\n    Set sheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n    For x = 1 To sheet.Range(\"A\" &amp; sheet.Rows.Count).End(xlUp).Row\n        sheet.Range(\"A\", \"B\", \"C\", \"D\" &amp; x) = InStr(1, sheet.Cells(x, 1), \"-\")\n    Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1430251809, "post_id": 29928781, "comment_id": 47979890, "body": "You never actually strip off the trailing <code>AND</code> in your query.  You set a variable equal to the length (<code>lngLen = Len(strWhere) - 5</code>), but never update your <code>strWhere</code> variable.  Simply checking your <code>Debug.Print strWhere</code> should have confirmed this.  Voting to close as a typo."}, {"owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "reply_to_user": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1430251870, "post_id": 29928781, "comment_id": 47979930, "body": "It is indeed always ending with &quot; AND &quot;. The piece of code     lngLen = Len(strWhere) - 5     If lngLen &lt;= 0 Then         MsgBox &quot;No criteria&quot;, vbInformation, &quot;Nothing to do.&quot;     Else Is supposed to get rid of that tail"}, {"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 2, "creation_date": 1430252004, "post_id": 29928781, "comment_id": 47980027, "body": "I don&#39;t think you understand the code you wrote.  <code>lngLen = Len(strWhere) - 5</code> simply sets the variable <code>lngLen</code> equal to the length of the <code>strWhere</code> variable, minus 5.  At no point do you strip off the trailing <code>AND</code> clause from <code>strWhere</code>, which is the cause of your problem."}, {"owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "reply_to_user": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 1, "creation_date": 1430252156, "post_id": 29928781, "comment_id": 47980128, "body": "How should it look like ? If I would understand this error, do you think I would be here asking ? ;-)"}, {"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 1, "creation_date": 1430252431, "post_id": 29928781, "comment_id": 47980331, "body": "Third time:  strip off the trailing <code>AND</code> in your query; <a href=\"https://msdn.microsoft.com/en-us/library/ms188047.aspx\" rel=\"nofollow noreferrer\">it&#39;s your basic SQL <code>WHERE</code> clause</a>.  You even check for it here:  <code>lngLen = Len(strWhere) - 5</code>.  Just take the <code>LEFT</code> of <code>strWhere</code>, using <code>lngLen</code>.  Your entire query makes you vulnerable to SQL injection, though; you&#39;re better off using a parameterized query."}, {"owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "reply_to_user": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1430252962, "post_id": 29928781, "comment_id": 47980667, "body": "All right, Here is what I tried Me.Sub_Desi_Schedule.Form.Filter = Len(strWhere) - 5  and  Me.Sub_Desi_Schedule.Form.Filter = lngLen  in both cases, the error is gone. However no filters are applied.  Regarding SQL INjection, this is NOT a public database and it&#39;s using a MS Access front end."}, {"owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "reply_to_user": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1430254175, "post_id": 29928781, "comment_id": 47981416, "body": "The string &quot;lngLen = Len(strWhere) - 5&quot; is there to remove the trailing AND. But obviously it does not do it. I hope someone can help me with this. I am stuck."}], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1430254903, "post_id": 29929792, "comment_id": 47981816, "body": "@AndreArsenault If you encounter any more problems with this, please show us what <code>Debug.Print strWhere</code> shows you when you get that 3075 error."}, {"owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "edited": false, "score": 0, "creation_date": 1430256297, "post_id": 29929792, "comment_id": 47982617, "body": "HandsUp, Here is the debug result with the &quot;strWhere = LEFT(strWhere, lngLen)&quot; : ([PNum] = 19239) AND ([PPro] =  0) AND"}, {"owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "edited": false, "score": 0, "creation_date": 1430257300, "post_id": 29929792, "comment_id": 47983103, "body": "I got it to work with strWhere = LEFT(strWhere, lngLen)  Thanks for the patronizing help..............."}], "tags": [], "owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "is_accepted": true, "score": 2, "last_activity_date": 1430254904, "last_edit_date": 1430254904, "creation_date": 1430254624, "answer_id": 29929792, "question_id": 29928781, "link": "https://stackoverflow.com/questions/29928781/run-time-error-3075/29929792#29929792", "title": "Run-time error 3075", "body": "<p>Okay, I feel compelled to answer this because it seems like you're fundamentally not getting something, or more than one thing, and I'm not getting through with my comments.  </p>\n\n<p>I don't know if you're just copying and pasting code without understanding it, or in such a rush that you aren't taking the time to understand it.</p>\n\n<p>Let's start with:</p>\n\n<blockquote>\n  <p>The piece of code <code>lngLen = Len(strWhere) - 5 If lngLen &lt;= 0 Then MsgBox \"No criteria\", vbInformation, \"Nothing to do.\" Else</code> Is supposed to get rid of that tail</p>\n</blockquote>\n\n<p>No, it's not.  </p>\n\n<pre><code>lngLen = Len(strWhere) - 5\nIf lngLen &lt;= 0 Then\n    MsgBox \"No criteria\", vbInformation, \"Nothing to do.\"\nElse\n    Debug.Print strWhere\n\n    Me.Sub_Desi_Schedule.Form.Filter = strWhere\n    Me.Sub_Desi_Schedule.Form.FilterOn = True\nEnd If\n</code></pre>\n\n<p>does two things.  It sets <code>lngLen</code> equal to the length of your <code>strWhere</code> variable, minus 5.  It then checks to see if the length is less than or equal to 0.  </p>\n\n<p>If your <code>strWhere</code> statement was...</p>\n\n<pre><code> ([PNum] = 27) AND \n</code></pre>\n\n<p>... you would set <code>lngLen</code> equal to 13.</p>\n\n<p>Since 13 is not less than or equal to zero, we move into your <code>ELSE</code> statement, and set the filter.</p>\n\n<pre><code>Me.Sub_Desi_Schedule.Form.Filter = strWhere\n</code></pre>\n\n<p>Which becomes</p>\n\n<pre><code>Me.Sub_Desi_Schedule.Form.Filter = \"([PNum] = 27) AND \"\n</code></pre>\n\n<p>See?  You've <em>still</em> got your trailing <code>AND</code> because you never update your <code>strWhere</code> variable.</p>\n\n<blockquote>\n  <p>Here is what I tried <code>Me.Sub_Desi_Schedule.Form.Filter = Len(strWhere) - 5</code> and <code>Me.Sub_Desi_Schedule.Form.Filter = lngLen</code> in both cases, the error is gone. However no filters are applied. </p>\n</blockquote>\n\n<p>So now you're just doing </p>\n\n<pre><code>Me.Sub_Desi_Schedule.Form.Filter = Len(strWhere) - 5`\n</code></pre>\n\n<p>which is the equivalent of</p>\n\n<pre><code>Me.Sub_Desi_Schedule.Form.Filter = 13\n</code></pre>\n\n<p>That doesn't accomplish anything.  You're setting the filter equal to the length of the variable, not the actual <code>strWhere</code> variable.  This should have been apparent if you put any break points in your code.</p>\n\n<p>I recommended using <code>LEFT</code> to trim down your string, like this:</p>\n\n<pre><code>strWhere = LEFT(strWhere, lngLen)\n</code></pre>\n\n<p>That's all there is to it.</p>\n"}], "owner": {"reputation": 15, "user_id": 1947166, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MCAFV.jpg?s=128&g=1", "display_name": "Art Systems", "link": "https://stackoverflow.com/users/1947166/art-systems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 29929792, "answer_count": 1, "score": -2, "last_activity_date": 1430254904, "creation_date": 1430251241, "last_edit_date": 1430254573, "question_id": 29928781, "link": "https://stackoverflow.com/questions/29928781/run-time-error-3075", "title": "Run-time error 3075", "body": "<p>I do wish to create a multiple filter function in VBA to sort a subform from controls on the main form. </p>\n\n<p>Here is my code</p>\n\n<pre><code>Dim strWhere As String\nDim lngLen As Long\nConst conJetDate = \"\\#dd\\/mm\\/yyyy\\#\"\n\nIf Not IsNull(Me.PerPNum) Then\n    strWhere = \"([PNum] = \" &amp; Me.PerPNum &amp; \") AND \"\nEnd If\n\nIf Not IsNull(Me.PerPPro) Then\n    strWhere = strWhere &amp; \"([PPro] =  \" &amp; Me.PerPPro &amp; \") AND \"\nEnd If\n\nIf Not IsNull(Me.PerPRev) Then\n    strWhere = strWhere &amp; \"([PRev] = \" &amp; Me.PerPRev &amp; \") AND \"\nEnd If\n\nIf Not IsNull(Me.DateStart) Then\n    strWhere = strWhere &amp; \"([TaskStart] &gt;= \" &amp; Format(Me.DateStart, conJetDate) &amp; \") AND \"\nEnd If\n\nIf Not IsNull(Me.DateEnd) Then\n    strWhere = strWhere &amp; \"([TaskEnd] &lt; \" &amp; Format(Me.DateEnd + 1, conJetDate) &amp; \") AND \"\nEnd If\n\nIf Not IsNull(Me.PerDesi) Then\n    strWhere = strWhere &amp; \"([UInit] = \" &amp; Me.PerDesi &amp; \") AND \"\nEnd If\n\nlngLen = Len(strWhere) - 5\nIf lngLen &lt;= 0 Then\n    MsgBox \"No criteria\", vbInformation, \"Nothing to do.\"\nElse\n\nDebug.Print strWhere\n\n    Me.Sub_Desi_Schedule.Form.Filter = strWhere\n    Me.Sub_Desi_Schedule.Form.FilterOn = True\nEnd If\n</code></pre>\n\n<p>However I keep getting a run-time error 3075 (Syntax error (missing operator) in query expression. </p>\n\n<p>I can see my variables in the error message though.</p>\n\n<p>I know it's my query expression that is malformed. But I can't figure what.</p>\n"}, {"tags": ["vba", "excel", "userform", "radio-button"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1430252764, "post_id": 29928886, "comment_id": 47980542, "body": "brilliant idea. Maybe I&#39;m just having trouble executing, but I&#39;m getting the following <code>Compile Error: &quot;Procedure declaration does not match description of event of procedure having the same name&quot;</code>. See update above for the code."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1430316995, "post_id": 29928886, "comment_id": 48013642, "body": "@AlexSilverman I believe you receive that error because the event method is not properly declared. The <code>MouseUp</code> event take a number of parameters. The declaration line should read as: <code>Private Sub OptionButton1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)</code>"}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1430337637, "post_id": 29928886, "comment_id": 48027558, "body": "Brilliant! Thanks so much. Sorry I can only upvote once"}, {"owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "edited": false, "score": 0, "creation_date": 1430930249, "post_id": 29928886, "comment_id": 48278315, "body": "See UPDATE 2, for new modified question!"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1430251603, "creation_date": 1430251603, "answer_id": 29928886, "question_id": 29928679, "link": "https://stackoverflow.com/questions/29928679/how-to-fire-click-event-on-already-selected-optionbutton-in-excel-userform/29928886#29928886", "title": "How to fire click event on already-selected OptionButton in Excel Userform", "body": "<p>You can use the <code>MouseUp</code> event to run whichever code you like. </p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 1393289, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HMTuA.jpg?s=128&g=1", "display_name": "pimgeek", "link": "https://stackoverflow.com/users/1393289/pimgeek"}, "edited": false, "score": 0, "creation_date": 1562072223, "post_id": 32210244, "comment_id": 100256040, "body": "Using this code for click event, the option button never enters selected state. :("}], "tags": [], "owner": {"reputation": 1, "user_id": 3396617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311ed625a5a9e2cb08b0e409044b64ba?s=128&d=identicon&r=PG&f=1", "display_name": "Alphonse68", "link": "https://stackoverflow.com/users/3396617/alphonse68"}, "is_accepted": false, "score": -1, "last_activity_date": 1440524150, "last_edit_date": 1440524150, "creation_date": 1440523172, "answer_id": 32210244, "question_id": 29928679, "link": "https://stackoverflow.com/questions/29928679/how-to-fire-click-event-on-already-selected-optionbutton-in-excel-userform/32210244#32210244", "title": "How to fire click event on already-selected OptionButton in Excel Userform", "body": "<p>Probably a little too late, but for Update 2, should you use something like</p>\n\n<pre><code>Controls(myOptionButton).Value = False\n</code></pre>\n\n<p>to change the value, therefore,</p>\n\n<pre><code>If myOptionButton.Value = True Then\n    Controls(myOptionButton).Value =  False\nElse\n    Controls(myOptionButton).Value = True\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 2205954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/efe66cca9650a1c6da5ef07d89fc67d9?s=128&d=identicon&r=PG", "display_name": "Alex Silverman", "link": "https://stackoverflow.com/users/2205954/alex-silverman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2408, "favorite_count": 1, "accepted_answer_id": 29928886, "answer_count": 2, "score": 2, "last_activity_date": 1440524150, "creation_date": 1430250904, "last_edit_date": 1430930163, "question_id": 29928679, "link": "https://stackoverflow.com/questions/29928679/how-to-fire-click-event-on-already-selected-optionbutton-in-excel-userform", "title": "How to fire click event on already-selected OptionButton in Excel Userform", "body": "<p>I read somewhere that once an option button (or radio button) is selected on a UserForm, click events are not registered. Is this true? </p>\n\n<p>If so, what are some good ways around this, aside from using checkboxes instead?</p>\n\n<p>Thanks!</p>\n\n<p>UPDATE: Per user3561813's suggestion, I tried the MouseUp event with the following code:</p>\n\n<p><code>Private Sub myOptionButton_MouseUp()\n    MyUserForm.Show\nEnd Sub</code></p>\n\n<p>I received this compile error: \"Procedure declaration does not match description of event or procedure having the same name\"</p>\n\n<p>UPDATE 2: This code does not work to allow unselection of already-selected radio button:</p>\n\n<p><code>Private Sub myOptionButton_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    If myOptionButton.Value = True Then\n        myOptionButton.Value =  False\n    Else\n        myOptionButton.Value = True\n    End If\nEnd Sub</code></p>\n\n<p>Oddly, if I step-through the code, it DOES work. But if I just run it through, it DOES NOT.</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2007"], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "is_accepted": false, "score": 1, "last_activity_date": 1430329379, "creation_date": 1430329379, "answer_id": 29950836, "question_id": 29928660, "link": "https://stackoverflow.com/questions/29928660/how-to-bypass-other-users-cannot-see-your-changes-window-when-closing-share/29950836#29950836", "title": "How to bypass &quot;Other users cannot see your changes...&quot; window when closing Sharepoint Excel document?", "body": "<p>The issue was resolved by setting <code>xlApp.Visible</code> to <code>False</code> immediately prior to closing the workbook, as follows:</p>\n\n<pre><code>xlApp.Visible = false;\nxlApp.DisplayAlerts = false;\nbk.Close(false);\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430329379, "creation_date": 1430250842, "question_id": 29928660, "link": "https://stackoverflow.com/questions/29928660/how-to-bypass-other-users-cannot-see-your-changes-window-when-closing-share", "title": "How to bypass &quot;Other users cannot see your changes...&quot; window when closing Sharepoint Excel document?", "body": "<p>I'm trying to open an Excel workbook in a Sharepoint document library, modify it, and close it without checking in the changes.</p>\n\n<p>This is the code I'm running:</p>\n\n<pre><code>Excel.Application xlApp = new Excel.Application();\nxlApp.DisplayAlerts = false;\nxlApp.Visible = true;\nExcel.Workbook bk = xlApp.Workbooks.Open(\"http://sharepointSite/\" + filename,false);\nExcel.Worksheet sht = bk.Sheets[\"Some Data\"];\nsht.Range[\"A1\"].Value= DateTime.Now.ToString();\nbk.Save();\nxlApp.EnableEvents = false;\nbk.Close(false);\nxlApp.EnableEvents = true;\nxlApp.DisplayAlerts = true;\nxlApp.Quit();\n</code></pre>\n\n<p>When I call `bk.Close(false), Excel shows a Yes/No/Cancel popup window with this message:</p>\n\n<pre><code>Other users cannot see your changes until you check in.  Do you want to check in now?\n</code></pre>\n\n<p>Since I don't want to check in yet, I click \"No\", and that works fine.  But I'd really like to automate this.  Is there a way to detect this popup and click \"No\", or better yet, bypass the window entirely?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1430250769, "post_id": 29928611, "comment_id": 47979215, "body": "Have you looked at CrossTab queries in Access?"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1430251668, "post_id": 29928611, "comment_id": 47979770, "body": "No I haven&#39;t seen those before but I&#39;m looking at them right now. I didn&#39;t even know what to look up for them, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1430251644, "post_id": 29928699, "comment_id": 47979753, "body": "I keep getting syntax error in FROM clause, can I name newTab whatever I want or does it need to be an existing table? What if I want to create a new table?"}, {"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "reply_to_user": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1430251956, "post_id": 29928699, "comment_id": 47979989, "body": "@hypetech you need to create your <code>newTab</code> first."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 2, "creation_date": 1430252083, "post_id": 29928699, "comment_id": 47980077, "body": "Also, in Access, these need to be run as 3 separate statements. i.e. only one of these lines can be in the query window at a time."}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1430252692, "post_id": 29928699, "comment_id": 47980496, "body": "Do I have to create 3 queries then, or can I write some VBA to do them all at once?"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1430253579, "post_id": 29928699, "comment_id": 47981052, "body": "Ok so I split this into three SQL statements and ran them in VBA, however only the first statement is actually inserting. I&#39;m still not getting the other column&#39;s data. This is the code I&#39;m using <code>Private Sub cmdUpdate_Click()  DoCmd.RunSQL &quot;INSERT INTO tblBldgElectricMtrs (Bldg, Meter) SELECT Bldg, Meter1 FROM qryElMetersSplit;&quot;, False DoCmd.RunSQL &quot;INSERT INTO tblBldgElectricMtrs (Bldg, Meter) SELECT Bldg, Meter2 FROM qryElMetersSplit;&quot;, False DoCmd.RunSQL &quot;INSERT INTO tblBldgElectricMtrs (Bldg, Meter) SELECT Bldg, Meter3 FROM qryElMetersSplit;&quot;, False  End Sub</code>"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1430257704, "post_id": 29928699, "comment_id": 47983296, "body": "Ok, the sql statements work at the same time if you have them run one after another in a vba statement. I just had to change things about the table I made, making the bldg not unique and making the meter required, and then I got exactly the table I was looking for. Thanks guys!"}], "tags": [], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "is_accepted": true, "score": 1, "last_activity_date": 1430250965, "creation_date": 1430250965, "answer_id": 29928699, "question_id": 29928611, "link": "https://stackoverflow.com/questions/29928611/normalizing-database-to-1nf/29928699#29928699", "title": "Normalizing Database to 1NF", "body": "<pre><code>INSERT INTO newTab (Bldg, Meter) SELECT Bldg, Meter1 FROM oldTab\nINSERT INTO newTab (Bldg, Meter) SELECT Bldg, Meter2 FROM oldTab\nINSERT INTO newTab (Bldg, Meter) SELECT Bldg, Meter3 FROM oldTab\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 29928699, "answer_count": 1, "score": 1, "last_activity_date": 1430250965, "creation_date": 1430250684, "question_id": 29928611, "link": "https://stackoverflow.com/questions/29928611/normalizing-database-to-1nf", "title": "Normalizing Database to 1NF", "body": "<p>Does anyone have code/ideas for changing a table formatted like </p>\n\n<pre><code>Bldg____Meter1___Meter2___Meter3\nBldg1___1________2________3_____\nBldg2___4________5________6_____\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Bldg____Meter\nBldg1___1____\nBldg1___2____\nBldg1___3____\nBldg2___4____\nBldg2___5____\nBldg2___6____\n</code></pre>\n\n<p>This is normalizing to 1NF right?</p>\n\n<p>Also anyway to do this through VBA or SQL is fine, just looking for any ideas.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430249312, "post_id": 29927919, "comment_id": 47978233, "body": "It sounds like a timing related issue (which makes no sense), try commenting out the <code>Application.ScreenUpdating = False</code> line and run it. That may slow it enough that it will work."}, {"owner": {"reputation": 211, "user_id": 1833998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a14f9a95f162e29f907e9465d2a0146?s=128&d=identicon&r=PG", "display_name": "bolilloBorracho", "link": "https://stackoverflow.com/users/1833998/bolilloborracho"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430264184, "post_id": 29927919, "comment_id": 47985854, "body": "Thanks but unfortunately it didn&#39;t work. It definitely feels like a timing issue because  when driven slowly it works perfect."}, {"owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "edited": false, "score": 1, "creation_date": 1430272389, "post_id": 29927919, "comment_id": 47988243, "body": "When you&#39;re using multiple worksheet you shouldn&#39;t use the implicit reference to a worksheet. Try adding the worksheet reference to your <code>Cells()</code> call out like <code>wks.Cells(......)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 1833998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a14f9a95f162e29f907e9465d2a0146?s=128&d=identicon&r=PG", "display_name": "bolilloBorracho", "link": "https://stackoverflow.com/users/1833998/bolilloborracho"}, "edited": false, "score": 0, "creation_date": 1430349316, "post_id": 29954938, "comment_id": 48033275, "body": "That was it! Not only that but it also fixed another annoyance where sometimes it would write to the wrong workbook. Thank you so much!"}], "tags": [], "owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "is_accepted": true, "score": 1, "last_activity_date": 1430342917, "creation_date": 1430342917, "answer_id": 29954938, "question_id": 29927919, "link": "https://stackoverflow.com/questions/29927919/macro-will-only-create-hyperlink-in-debug-mode/29954938#29954938", "title": "Macro will only create hyperlink in debug mode", "body": "<p>Try adding the worksheet reference to your <code>Cells()</code> call out like <code>wks.Cells(......)</code></p>\n"}], "owner": {"reputation": 211, "user_id": 1833998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a14f9a95f162e29f907e9465d2a0146?s=128&d=identicon&r=PG", "display_name": "bolilloBorracho", "link": "https://stackoverflow.com/users/1833998/bolilloborracho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 29954938, "answer_count": 1, "score": 1, "last_activity_date": 1430342917, "creation_date": 1430248311, "last_edit_date": 1430265437, "question_id": 29927919, "link": "https://stackoverflow.com/questions/29927919/macro-will-only-create-hyperlink-in-debug-mode", "title": "Macro will only create hyperlink in debug mode", "body": "<p>This is a macro that will search all cells in all worksheets in all of the workbooks contained in a single directory. Everything works as advertised except for the add hyperlink method, which does work if I repeatedly mash F8. </p>\n\n<p>How can I edit the macro so the hyperlink portion works?</p>\n\n<pre><code>'Search all workbooks in a folder for string\nSub SearchWorkbooks()\nDim fso As Object\nDim fld As Object\nDim strSearch As String\nDim strPath As String\nDim strFile As String\nDim wOut As Worksheet\nDim wbk As Workbook\nDim wks As Worksheet\nDim Lrow As Long\nDim rFound As Range\nDim strFirstAddress As String\n\nOn Error GoTo ErrHandler\nApplication.ScreenUpdating = False\n\nstrSearch = \"Capacitor\"\nstrPath = \"C:\\!Source\"\n\nSet wOut = Worksheets.Add\nLrow = 1\nWith wOut\n    .Name = \"Results\"\n    .Cells(Lrow, 1) = \"Workbook\"\n    .Cells(Lrow, 2) = \"Worksheet\"\n    .Cells(Lrow, 3) = \"Cell\"\n    .Cells(Lrow, 4) = \"Text in Cell\"\n    .Cells(Lrow, 5) = \"Link\"\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set fld = fso.GetFolder(strPath)\n\n    strFile = Dir(strPath &amp; \"\\*.xls*\")\n    Do While strFile &lt;&gt; \"\"\n        Set wbk = Workbooks.Open _\n          (Filename:=strPath &amp; \"\\\" &amp; strFile, _\n          UpdateLinks:=0, _\n          ReadOnly:=True, _\n          AddToMRU:=False)\n\n        For Each wks In wbk.Worksheets\n            Set rFound = wks.UsedRange.Find(strSearch)\n            If Not rFound Is Nothing Then\n                strFirstAddress = rFound.Address\n            End If\n            Do\n                If rFound Is Nothing Then\n                    Exit Do\n                Else\n                    Lrow = Lrow + 1\n                    .Cells(Lrow, 1) = wbk.Name\n                    .Cells(Lrow, 2) = wks.Name\n                    .Cells(Lrow, 3) = rFound.Address\n                    .Cells(Lrow, 4) = rFound.Value\n\n                    'This is the line that does not work\n                    'well it actually works in debug mode but not in real time\n                    wks.Hyperlinks.Add Anchor:=Cells(Lrow, 5), Address:=wbk.FullName, SubAddress:= _\n                                    wks.Name &amp; \"!\" &amp; rFound.Address, TextToDisplay:=\"Link\"\n\n                End If\n                Set rFound = wks.Cells.FindNext(After:=rFound)\n            Loop While strFirstAddress &lt;&gt; rFound.Address\n        Next\n\n        wbk.Close (False)\n        strFile = Dir\n    Loop\n    .Columns(\"A:D\").EntireColumn.AutoFit\nEnd With\n'MsgBox \"Done\"    \n\nExitHandler:\nSet wOut = Nothing\nSet wks = Nothing\nSet wbk = Nothing\nSet fld = Nothing\nSet fso = Nothing\nApplication.ScreenUpdating = True\nExit Sub\n\nErrHandler:\nMsgBox Err.Description, vbExclamation\nResume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "form-fields"], "answers": [{"comments": [{"owner": {"reputation": 2261, "user_id": 1160796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E5Np4.png?s=128&g=1", "display_name": "basher", "link": "https://stackoverflow.com/users/1160796/basher"}, "reply_to_user": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "edited": false, "score": 0, "creation_date": 1430249389, "post_id": 29928151, "comment_id": 47978281, "body": "@Mark no problem! Be sure to mark this as the <a href=\"http://meta.stackexchange.com/a/5235/212883\">accepted answer</a>."}], "tags": [], "owner": {"reputation": 2261, "user_id": 1160796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E5Np4.png?s=128&g=1", "display_name": "basher", "link": "https://stackoverflow.com/users/1160796/basher"}, "is_accepted": true, "score": 1, "last_activity_date": 1430249088, "creation_date": 1430249088, "answer_id": 29928151, "question_id": 29927788, "link": "https://stackoverflow.com/questions/29927788/ms-word-vba-for-formfields/29928151#29928151", "title": "MS Word VBA for formfields", "body": "<p>You should use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837885.aspx\" rel=\"nofollow\">FormFields.Result</a></p>\n\n<pre><code>Sub ScreenB()\n    Dim a As Double\n    If ActiveDocument.FormFields(\"Dropdown9\").Result = \"No\" Then\n        a = 1\n    Else\n        a = 2\n    End If\n    MsgBox a       \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 29928151, "answer_count": 1, "score": 0, "last_activity_date": 1430249312, "creation_date": 1430247865, "last_edit_date": 1430249312, "question_id": 29927788, "link": "https://stackoverflow.com/questions/29927788/ms-word-vba-for-formfields", "title": "MS Word VBA for formfields", "body": "<p>I am trying to assign a numeric value in VBA for a dropdown formfield. I have the Msgbox just to test functionality:</p>\n\n<pre><code>Sub ScreenB()\n    Dim a As Double\n    If ActiveDocument.FormFields(\"Dropdown9\").DropDown.Value = No Then\n        a = 1\n    Else\n        a = 2\n    End If\n    MsgBox a       \nEnd Sub\n</code></pre>\n\n<p>With this code, my Msgbox does not change (it reads \"2\"), even when I change the the dropdown from Yes to No, or vice-versa.  I also tried putting quotes around yes (\"Yes\") in the VBA code and got a Type Mismatch error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1430248271, "post_id": 29927730, "comment_id": 47977626, "body": "I don&#39;t understand where is your <code>Next</code> statement?"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4843434, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7202194477ddb50f0c1380d3c2778f71?s=128&d=identicon&r=PG&f=1", "display_name": "BROB1", "link": "https://stackoverflow.com/users/4843434/brob1"}, "edited": false, "score": 0, "creation_date": 1430332742, "post_id": 29927829, "comment_id": 48024574, "body": "appreciate the help but now i am getting compile errors. will do some more research on it. thanks again"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 103, "user_id": 4843434, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7202194477ddb50f0c1380d3c2778f71?s=128&d=identicon&r=PG&f=1", "display_name": "BROB1", "link": "https://stackoverflow.com/users/4843434/brob1"}, "edited": false, "score": 0, "creation_date": 1430334476, "post_id": 29927829, "comment_id": 48025708, "body": "Update your question to include your current, revised code and let me know which line is raising the compile error?"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1430247993, "creation_date": 1430247993, "answer_id": 29927829, "question_id": 29927730, "link": "https://stackoverflow.com/questions/29927730/moving-ranges-to-copy-and-paste-in-excel-vba/29927829#29927829", "title": "Moving ranges to copy and paste in Excel VBA", "body": "<p>You've got some loop iterator variables but you're not using them correctly.  Try this:</p>\n\n<pre><code>For I = 4 To 255\n    Y = I\n    X = I + 10\n\n    Sheets(\"QDATA\").Range(\"G\" &amp; Y &amp; \":G\" &amp; X).COPY _\n    Destination:=Sheets(\"R10\").Range(\"A\" &amp; Y+1)\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4843434, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/7202194477ddb50f0c1380d3c2778f71?s=128&d=identicon&r=PG&f=1", "display_name": "BROB1", "link": "https://stackoverflow.com/users/4843434/brob1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430248322, "creation_date": 1430247660, "last_edit_date": 1430248322, "question_id": 29927730, "link": "https://stackoverflow.com/questions/29927730/moving-ranges-to-copy-and-paste-in-excel-vba", "title": "Moving ranges to copy and paste in Excel VBA", "body": "<p>I am attempting to setup a macro to select data from a worksheet(1), paste that data in another worksheet(2), then take the result from the worksheet(2) and paste that information in worksheet(3). The problem I am having is getting the range move down to the next set of data to copy from worksheet(1) as well as getting the results from worksheet(2) to paste in the row below the last result in worksheet(3).  </p>\n\n<p>It seems that the code I have tried doesn't move to new data to copy and that it doesn't allow enough time to pass before copying the result of the equation in worksheet(2). Below is the code I have attempted which doesn't work:</p>\n\n<pre><code>Sub COPY_PASTE_MLR_10()\n\nApplication.ScreenUpdating = False\n\nDim Y As Integer, X As Integer, I As Integer\n\n\n'COPY DATA TO EQUATIONS\n\nFor I = 4 To 255\nY = I\nX = I + 10\n\nSheets(\"QDATA\").Range(\"G4:G14\").COPY _\nDestination:=Sheets(\"R10\").Range(\"A5\")\n\nSheets(\"QDATA\").Range(\"OI:OI+10\").COPY _\nDestination:=Sheets(\"R10\").Range(\"C5\")\n\nSheets(\"QDATA\").Range(\"WI:WI+10\").COPY _\nDestination:=Sheets(\"RLR10\").Range(\"D5\")\n\nSheets(\"QDATA\").Range(\"AC4:AC14\").COPY _\nDestination:=Sheets(\"R10\").Range(\"E5\")\n\nSheets(\"QDATA\").Range(\"AN4:AN14\").COPY _\nDestination:=Sheets(\"R10\").Range(\"F5\")\n\nSheets(\"QDATA\").Range(\"BA4:BA14\").COPY _\nDestination:=Sheets(\"R10\").Range(\"G5\")\n\nSheets(\"QDATA\").Range(\"BI4:BI14\").COPY _\nDestination:=Sheets(\"R10\").Range(\"H5\")\n\nSheets(\"QDATA\").Range(\"BQ4:BQ4\").COPY _\nDestination:=Sheets(\"R10\").Range(\"I5\")\n\n\n'COPY RESULTS TO '10 RESULTS'\n\nSheets(\"R10\").Range(\"J5:K5\").COPY\nSheets(\"10 RESULTS\").Range(\"B2:C2\").PasteSpecial Paste:=xlPasteValues\n\nSheets(\"R10\").Range(\"J6:K6\").COPY\nSheets(\"10 RESULTS\").Range(\"D2:E2\").PasteSpecial Paste:=xlPasteValues\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "type-mismatch", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1430267617, "post_id": 29926699, "comment_id": 47986903, "body": "You&#39;re likely getting a string that isn&#39;t numeric after chopping off at the last space.  Put <code>Debug.Print Cells(lastRow, 1).Value</code> above your <code>NewPC</code> assignment and see what&#39;s in the cell it returns. BTW, you should probably use <code>CLng</code> - there&#39;s also the possibility of getting an overflow error on <code>CInt</code>  (granted it will be a <i>lot</i> of PCs before that happens)."}, {"owner": {"reputation": 101, "user_id": 4763797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AGCzc.png?s=128&g=1", "display_name": "ckemmann", "link": "https://stackoverflow.com/users/4763797/ckemmann"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430310989, "post_id": 29926699, "comment_id": 48008572, "body": "@Comintern - see my comment to the accepted answer"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430267268, "post_id": 29926810, "comment_id": 47986800, "body": "CInt doesn&#39;t care about spaces: <code>Debug.Print CInt(&quot; 42&quot;)</code>"}], "tags": [], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "is_accepted": false, "score": 0, "last_activity_date": 1430244439, "creation_date": 1430244439, "answer_id": 29926810, "question_id": 29926699, "link": "https://stackoverflow.com/questions/29926699/mismatch-error-when-using-cintright/29926810#29926810", "title": "Mismatch Error when using CInt(Right())", "body": "<p>Looks like you're getting the space too. How about:</p>\n\n<pre><code>NewPC = CInt(Mid(Cells(lastRow, 1).Value, InStrRev(Cells(lastRow, 1).Value, \" \")))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4763797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AGCzc.png?s=128&g=1", "display_name": "ckemmann", "link": "https://stackoverflow.com/users/4763797/ckemmann"}, "edited": false, "score": 0, "creation_date": 1430310848, "post_id": 29933034, "comment_id": 48008452, "body": "@Comintern &amp; AnotherParker - You&#39;re right, I checked and noticed that lastRow is populated by &quot;PC #&quot;, hence the type-mismatch. My top row is frozen because it holds column headers and buttons to access userforms, but is included in <code>lastRow = Range(&quot;A65536&quot;).End(xlUp).Row</code>. Any good suggestions on how to change it so it doesn&#39;t call that first row? Dirty fix is to use &quot;PC 0&quot;, but that becomes something that can be deleted by another userform I have..."}, {"owner": {"reputation": 101, "user_id": 4763797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AGCzc.png?s=128&g=1", "display_name": "ckemmann", "link": "https://stackoverflow.com/users/4763797/ckemmann"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430313715, "post_id": 29933034, "comment_id": 48010864, "body": "@Comintern - Thanks!! That did it! I edited my question above to include the working code."}], "tags": [], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "is_accepted": true, "score": 1, "last_activity_date": 1430272644, "creation_date": 1430272644, "answer_id": 29933034, "question_id": 29926699, "link": "https://stackoverflow.com/questions/29926699/mismatch-error-when-using-cintright/29933034#29933034", "title": "Mismatch Error when using CInt(Right())", "body": "<p>Are you sure that what is actually in <code>Cells(lastRow, 1).Value</code> is interpretable as a <code>String</code>? If it is an error, it won't be valid to do string operations on it.</p>\n"}], "owner": {"reputation": 101, "user_id": 4763797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AGCzc.png?s=128&g=1", "display_name": "ckemmann", "link": "https://stackoverflow.com/users/4763797/ckemmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 29933034, "answer_count": 2, "score": 0, "last_activity_date": 1430315186, "creation_date": 1430244077, "last_edit_date": 1531164843, "question_id": 29926699, "link": "https://stackoverflow.com/questions/29926699/mismatch-error-when-using-cintright", "title": "Mismatch Error when using CInt(Right())", "body": "<p>I'm using the following code to identify the last populated row in a spreadsheet and the first empty row following, and using this information I figure out what to populate the first cell of the empty row with (PC 1, PC 2, PC 3, etc.). I keep getting a \"type-mismatch\" error when I try to run it however, and I'm not sure what I need to change to fix it. Below is the code in question, I've added a comment <em>just above</em> the line where the debugger stops.</p>\n\n<pre><code>    'Creates variable for the next empty row and for PC #.\n    Dim lastRow As Long\n    Dim emptyRow As Long\n    Dim NewPC As Long\n\n    'Determines last row.\n    lastRow = Range(\"A65536\").End(xlUp).Row\n\n    'Determines empty row.\n    emptyRow = Range(\"A65536\").End(xlUp).Row + 1\n\n    'Determines PC entry value  &lt;--- DEBUGGER STOPS ON FOLLOWING LINE OF CODE.\n    NewPC = CInt(Right(Cells(lastRow, 1).Value, Len(Cells(lastRow, 1).Value) - InStrRev(Cells(lastRow, 1).Value, \" \"))) + 1\n\n    'Makes PC Data Sheet active.\n    Sheet1.Activate\n\n    'Enters PC # data into first column.\n    Cells(emptyRow, 1).Value = \"PC\" &amp; \" \" &amp; NewPC\n</code></pre>\n\n<p>Got it! Here's the changed line:</p>\n\n<pre><code>    'Determines PC entry value\n    If lastRow = 1 Then\n        NewPC = 1\n    Else\n        NewPC = Right(Cells(lastRow, 1).Value, Len(Cells(lastRow, 1).Value) - InStrRev(Cells(lastRow, 1).Value, \" \")) + 1\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "anchor", "temp"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430244888, "post_id": 29926666, "comment_id": 47975608, "body": "What happened when you tried: <code>objIE.document.GetElementByID(&quot;tempID&quot;).Click</code> ?  That should work."}, {"owner": {"reputation": 2023, "user_id": 2761919, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/465666e277ab0e1f859b6fac0d726c0a?s=128&d=identicon&r=PG&f=1", "display_name": "MattB", "link": "https://stackoverflow.com/users/2761919/mattb"}, "edited": false, "score": 0, "creation_date": 1430245054, "post_id": 29926666, "comment_id": 47975711, "body": "You may want to try avoiding late binding.  I&#39;ve seen the more generic &quot;document.GetElementByID(&quot;&quot;)&quot; return some odd objects before.  You may want to add references to Microsoft Internet Controls and Microsoft HTML Object Library and rely on VBA to pick types for you a little less.  I can&#39;t promise that will fix it though, but it might give you more useful information."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1430249936, "post_id": 29926666, "comment_id": 47978655, "body": "<a href=\"http://www.teamviewer.com/\" rel=\"nofollow noreferrer\">TeamViewer</a> may allow you to help them directly."}], "owner": {"reputation": 21, "user_id": 4843186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HWiX2.jpg?s=128&g=1", "display_name": "corwax", "link": "https://stackoverflow.com/users/4843186/corwax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1430245045, "creation_date": 1430243979, "last_edit_date": 1430245045, "question_id": 29926666, "link": "https://stackoverflow.com/questions/29926666/macro-ie-controlling", "title": "Macro IE controlling", "body": "<p>Unfortunately my parents are not familiar with using the computer at all, and I have moved to another city, so I cannot help them directly. They need to log in every month to their telephone service provider, and print out the due invoice. I'm trying to make a macro to execute all this with \"only a click of a button\".</p>\n\n<p>So my code so far:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\nobjIE.Top = 0\nobjIE.Left = 0\nobjIE.Width = 1027\nobjIE.Height = 768\nobjIE.AddressBar = 0\nobjIE.StatusBar = 0\nobjIE.Toolbar = 0\nobjIE.Visible = True\n\nobjIE.Navigate (\"https://login.example.com\")\nDo\nDoEvents\nLoop Until objIE.ReadyState = 4\n\n    SendKeys \"{ENTER}\" 'security pop up, press enter\n\nDo\nDoEvents\nLoop Until objIE.ReadyState = 4\n\n'write in login name and password\n\n    objIE.document.GetElementByID(\"f_name_1\").Value = \"abababa\"\n    objIE.document.GetElementByID(\"password\").Value = \"cdc999\"\n\n'press enter, log in\n\n    SendKeys \"{ENTER}\"\n\nDo\nDoEvents\nLoop Until objIE.ReadyState = 4\n\n'and here I stuck\n\nEnd Sub\n</code></pre>\n\n<p>But at one point I got stuck. Unfortunately on the website when you log in, the navigation button's code looks something like this:</p>\n\n<pre><code>&lt;a class=\"cufon_w\" id=\"tempID\" href=\"fakt.do\"&gt;\n</code></pre>\n\n<p>I tried with:</p>\n\n<pre><code>objIE.document.GetElementByID(\"tempID\").Click\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>objIE.document.GetElementByClassName(\"cufon_w\").Click\n</code></pre>\n\n<p>but it does not work with either of them (with tempID I was supposing, but tried it anyway).</p>\n\n<p>Has anybody tried something similar, or know any solution?</p>\n"}, {"tags": ["excel", "vba", "autofill"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430244094, "post_id": 29926665, "comment_id": 47975089, "body": "What defines the size of the area to be filled?"}, {"owner": {"reputation": 1, "user_id": 4573184, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/150745e359ab44da340116418f574ac1?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4573184/john"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430244696, "post_id": 29926665, "comment_id": 47975489, "body": "The next cell in Column A with a value. I found this code with works for just the first section. Can it be modified to repeat varying sections?Range(&quot;A3&quot;).Select Selection.End(xlDown).Select ActiveCell.Offset(-1, 0).Select Range(Selection, Selection.End(xlUp)).Select Selection.FillDown"}, {"owner": {"reputation": 1, "user_id": 4573184, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/150745e359ab44da340116418f574ac1?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4573184/john"}, "edited": false, "score": 0, "creation_date": 1430246690, "post_id": 29926665, "comment_id": 47976690, "body": "No, not sure how that looks in code. Do you know of a way to get the code in the prior comment to repeat?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430247766, "post_id": 29926665, "comment_id": 47977342, "body": "<a href=\"http://stackoverflow.com/questions/29883803/fill-down-blank-cells-in-multiple-columns-in-specific-sheets\" title=\"fill down blank cells in multiple columns in specific sheets\">stackoverflow.com/questions/29883803/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1430247800, "creation_date": 1430247800, "answer_id": 29927770, "question_id": 29926665, "link": "https://stackoverflow.com/questions/29926665/auto-fill-multiple-sections-of-varying-length-in-vba-in-one-column/29927770#29927770", "title": "Auto fill multiple sections of varying length in VBA in one Column", "body": "<p>Please try:  </p>\n\n<pre><code>Sub FillDown()\nRange(\"B3\", Range(\"B3\").End(xlDown)).Offset(, -1).SpecialCells(xlCellTypeBlanks).Select\n    Selection.FormulaR1C1 = \"=R[-1]C\"\nEnd Sub  \n</code></pre>\n\n<p>Or in one line:  </p>\n\n<pre><code>Range(\"B3\", Range(\"B3\").End(xlDown)).Offset(, -1).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=R[-1]C\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4573184, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/150745e359ab44da340116418f574ac1?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4573184/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 680, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430247800, "creation_date": 1430243975, "question_id": 29926665, "link": "https://stackoverflow.com/questions/29926665/auto-fill-multiple-sections-of-varying-length-in-vba-in-one-column", "title": "Auto fill multiple sections of varying length in VBA in one Column", "body": "<p>I need some assistance in developing a macro to autofill text in sections of varying length in Column A. I am new to VBA and I've tried record macro but it defines the section to a specific range which could vary every time I run the macro. The first cell to auto fill down always begins in cell A3. There are relevant values in column B (they are dates). </p>\n\n<p>I cannot find anything like this scenario in the web. </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2003"], "comments": [{"owner": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "edited": false, "score": 0, "creation_date": 1430243728, "post_id": 29926550, "comment_id": 47974858, "body": "This is to print on 11X17 paper so looks like the line should be at 16.1"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "edited": false, "score": 0, "creation_date": 1430256309, "post_id": 29929048, "comment_id": 47982626, "body": "Not sure if I am following you? I cannot change the integer because there are fields hidden. Make sense?"}, {"owner": {"reputation": 108, "user_id": 4709383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7437c066ff5f236f4c9e00dcb41769e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Horner", "link": "https://stackoverflow.com/users/4709383/mark-horner"}, "reply_to_user": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "edited": false, "score": 0, "creation_date": 1430327456, "post_id": 29929048, "comment_id": 48021331, "body": "Err not really, can you post a screenshot or something of your layout and the code behind it plz? Struggling to visualise"}, {"owner": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "edited": false, "score": 0, "creation_date": 1430339765, "post_id": 29929048, "comment_id": 48028763, "body": "how do I post a screenshot here? I have 2 screenshots for you."}, {"owner": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "edited": false, "score": 0, "creation_date": 1431019949, "post_id": 29929048, "comment_id": 48326933, "body": "I figured this out...in a VERY HARD WAY Although very easy to do....Basically deleted the columns from the report and renamed the very last column by re-numbering from 10 to 8 (txt8, lbl8) and then in VB, update the integer from 0 to 7 to 0 to 8. Viola!"}, {"owner": {"reputation": 108, "user_id": 4709383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7437c066ff5f236f4c9e00dcb41769e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Horner", "link": "https://stackoverflow.com/users/4709383/mark-horner"}, "reply_to_user": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "edited": false, "score": 0, "creation_date": 1431114237, "post_id": 29929048, "comment_id": 48373369, "body": "Glad you got it sorted! :)"}], "tags": [], "owner": {"reputation": 108, "user_id": 4709383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7437c066ff5f236f4c9e00dcb41769e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Horner", "link": "https://stackoverflow.com/users/4709383/mark-horner"}, "is_accepted": false, "score": 0, "last_activity_date": 1430252085, "creation_date": 1430252085, "answer_id": 29929048, "question_id": 29926550, "link": "https://stackoverflow.com/questions/29926550/right-most-line-coding-needed/29929048#29929048", "title": "Right Most line coding needed", "body": "<p>Try for i = 0 to 7 step 1, I think the ctrls are 0 indexed?</p>\n"}], "owner": {"reputation": 93, "user_id": 2382407, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c58dbee51d044c3557a798bc84c278f7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Cathcart", "link": "https://stackoverflow.com/users/2382407/holly-cathcart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430681163, "creation_date": 1430243610, "last_edit_date": 1430681163, "question_id": 29926550, "link": "https://stackoverflow.com/questions/29926550/right-most-line-coding-needed", "title": "Right Most line coding needed", "body": "<p>Since I am learning Access VBA, I need the coding for the Right most line. This is what the code builder looks like in one of the databases I inherited from work for the letters I need to produce. </p>\n\n<p>All I know is that I had to reduce the integer from 1 to 10 to 1 to 7 to make the gridlines for the hidden fields disappear yet letter is missing the far right vertical line....I tried 1 to 8 for the integer but got an error.</p>\n\n<pre><code>Private Sub Detail_Print(Cancel As Integer, PrintCount As Integer)\n    Dim lDarkGray As Long: lDarkGray = 3355443\n    Dim lWidth As Long: lWidth = Me.Width\n    Dim lHeight As Long: lHeight = Me.Height\n'left most line\n    Me.Line (0, 0)-Step(0, lHeight), lDarkGray\n'the rest of the vertial lines\n    Dim i As Integer\n    For i = 1 To 7 Step 1\n        Me.Line ((Me(\"txt\" &amp; i).Left + Me(\"txt\" &amp; i).Width), 0)-Step(0, lHeight), lDarkGray\n    Next i\n'bottom lines\n    Me.Line (0, lHeight)-Step(lWidth, 0), lDarkGray\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "type-conversion"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1430243583, "post_id": 29926411, "comment_id": 47974757, "body": "Converting <code>&quot;00100&quot;</code> to a number converts it to <code>100</code>. Converting <code>100</code> to a string converts it to <code>&quot;100&quot;</code>. What made you expect anything else? You need to pad the string with zeroes if you want <code>&quot;00100&quot;</code>."}, {"owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1430243902, "post_id": 29926411, "comment_id": 47974961, "body": "Gee thanks, that really helped."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "edited": false, "score": 0, "creation_date": 1430244055, "post_id": 29926580, "comment_id": 47975065, "body": "Perfect, this is what I was hoping for!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1430244170, "last_edit_date": 1430244170, "creation_date": 1430243706, "answer_id": 29926580, "question_id": 29926411, "link": "https://stackoverflow.com/questions/29926411/preserving-leading-0s-in-string-number-string-conversion/29926580#29926580", "title": "Preserving leading 0&#39;s in string - number - string conversion", "body": "<p>Converting <code>\"00100\"</code> to a <code>Double</code> using <code>Val</code> turned it into <code>100</code>, so <code>CStr(100)</code> returns <code>\"100\"</code> as it should.</p>\n\n<p>You need to format the string to what you want it to look like:</p>\n\n<pre><code>defNCRFNum = NCRFNumAr(0) &amp; \"-\" &amp; Format(Val(NCRFNumAr(1)) + 1, \"00000\")\n</code></pre>\n\n<p>If you need to parameterize the length of the string, you can use the <code>String</code> function to generate the format string:</p>\n\n<pre><code>Const digits As Integer = 5\n\nDim formatString As String\nformatString = String(digits, \"0\")\n\ndefNCRFNum = NCRFNumAr(0) &amp; \"-\" &amp; Format(Val(NCRFNumAr(1)) + 1, formatString)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "is_accepted": false, "score": 0, "last_activity_date": 1430243809, "creation_date": 1430243809, "answer_id": 29926614, "question_id": 29926411, "link": "https://stackoverflow.com/questions/29926411/preserving-leading-0s-in-string-number-string-conversion/29926614#29926614", "title": "Preserving leading 0&#39;s in string - number - string conversion", "body": "<p>Here is that loop solution I mentioned above.  If anyone's got something better, I'm all ears!</p>\n\n<pre><code>prevNCRF = \"15-00100\"\nNCRFNumAr() = Split(prevNCRF, \"-\")\nzeroAdder = CStr(Val(NCRFNumAr(1)) + 1)\n\n'loop: everytime the zeroAdder string is not 5 characters long, \n'put a zero in front of it.\nDo Until Len(zeroAdder) = 5\n    zeroAdder = \"0\" &amp; zeroAdder\nLoop\n\ndefNCRFNum = NCRFNumAr(0) &amp; \"-\" &amp; zeroAdder\nMsgBox (defNCRFNum)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "is_accepted": false, "score": 0, "last_activity_date": 1430244367, "creation_date": 1430244367, "answer_id": 29926791, "question_id": 29926411, "link": "https://stackoverflow.com/questions/29926411/preserving-leading-0s-in-string-number-string-conversion/29926791#29926791", "title": "Preserving leading 0&#39;s in string - number - string conversion", "body": "<pre><code>defNCRFNum = NCRFNumAr(0) &amp; \"-\" &amp; Format(CStr(Val(NCRFNumAr(1)) + 1), String(Len(NCRFNumAr(1)), \"0\"))\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4371533, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/600f8003b79fba6e049c4006d0f08de7?s=128&d=identicon&r=PG&f=1", "display_name": "AnthonyJS", "link": "https://stackoverflow.com/users/4371533/anthonyjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 29926580, "answer_count": 3, "score": 3, "last_activity_date": 1430275578, "creation_date": 1430243131, "last_edit_date": 1430275578, "question_id": 29926411, "link": "https://stackoverflow.com/questions/29926411/preserving-leading-0s-in-string-number-string-conversion", "title": "Preserving leading 0&#39;s in string - number - string conversion", "body": "<p>I am working on a macro for a document-tracking sheet at work.  I use a button that prompts the user to enter in the document number and I'd like to specify a default number based on the following numbering convention.  The first two characters of the document number are the latter two year digits (15 in this case), then there is a \"-\" followed by a five digit serialization.</p>\n\n<p>My current code looks at the last-entered document and increments those last 5 characters, but chops off any leading zeroes, which I want to keep. This is an extraction of the code to generate this default number (assuming the variable \"prevNCRF\" is the previous document name found in the doc):</p>\n\n<pre><code>    Sub codeChunkTester()\n\n    Dim prevNCRF, defNCRFNum As String\n    Dim NCRFNumAr() As String\n\n    'pretend like we found this in the sheet.\n    prevNCRF = \"15-00100\"\n\n    'split the string into \"15\" and \"00100\" and throw those into an array.\n    NCRFNumAr() = Split(prevNCRF, \"-\")\n\n    'reconstruct the number by reusing the first part and dash, then converting\n    'the \"00100\" to a number with Val(), adding 1, then back to a string with CStr().\n    defNCRFNum = NCRFNumAr(0) &amp; \"-\" &amp; CStr(Val(NCRFNumAr(1)) + 1)\n\n    'message box shows \"15-101\" rather than \"15-00101\" as I had hoped.\n    MsgBox (defNCRFNum)\n\n    End Sub\n</code></pre>\n\n<p>So can anyone help me preserve those zeroes?  I suppose I could include a loop that checks the length of the string and adds a leading zero until there are 5 characters, but perhaps there's a better way...</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1430245505, "post_id": 29926204, "comment_id": 47975985, "body": "Any particular reason you&#39;re rolling your own solution using VBA instead of using Excel&#39;s built in data validation that does exactly this?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4843192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae92b73cc7f93fbbe89fcfbdfaa37f36?s=128&d=identicon&r=PG&f=1", "display_name": "Adrienne Perry", "link": "https://stackoverflow.com/users/4843192/adrienne-perry"}, "edited": false, "score": 0, "creation_date": 1430244368, "post_id": 29926615, "comment_id": 47975259, "body": "Thank you! A simple cut and paste works perfectly. Your logic makes perfect sense - now I just need to hunker down and figure out the code changes so I can learn something today. :) Thank you!"}], "tags": [], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "is_accepted": true, "score": 1, "last_activity_date": 1430243815, "creation_date": 1430243815, "answer_id": 29926615, "question_id": 29926204, "link": "https://stackoverflow.com/questions/29926204/run-time-error-13-only-when-fill-down-used/29926615#29926615", "title": "&quot;Run-time error &#39;13&#39; only when &quot;Fill down&quot; used?", "body": "<p>When They perform a fill Down, <code>Target</code> is a range with multiple cells.  So, <code>Target.Value Like \"1\"</code> fails because you are attempting to compare a variant array with a string.  What you need to do is process individual cells within the target range one at a time.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim cell As Range    'Added line\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlManual\n\n    If Not Intersect(Target, [A1:AE61]) Is Nothing Then\n        For Each cell In Intersect(Target, [A1:AE61])    'Added line\n            'Within this loop, I have replaced Target with cell\n            If (cell.Value Like \"1\") Then\n            ElseIf (cell.Value Like \"2\") Then\n            ElseIf (cell.Value Like \"3\") Then\n            ElseIf (Not cell.Value Like \"\") Then\n                MsgBox \"Please enter a rating of 1, 2 or 3.\"\n                Application.EnableEvents = False\n                Application.Undo\n\n                Application.EnableEvents = True\n\n            End If\n        Next cell    'Added line\n    End If\n\n    Application.Calculation = xlAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4843192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae92b73cc7f93fbbe89fcfbdfaa37f36?s=128&d=identicon&r=PG&f=1", "display_name": "Adrienne Perry", "link": "https://stackoverflow.com/users/4843192/adrienne-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 29926615, "answer_count": 1, "score": 2, "last_activity_date": 1430244414, "creation_date": 1430242527, "last_edit_date": 1430244414, "question_id": 29926204, "link": "https://stackoverflow.com/questions/29926204/run-time-error-13-only-when-fill-down-used", "title": "&quot;Run-time error &#39;13&#39; only when &quot;Fill down&quot; used?", "body": "<p>The following code is designed to only allow an entry of 1, 2 or 3 in the range of cells. If something else is entered, an error message pops up and the entry is undone. The code works perfectly unless the user fills down their response. At that point, a \"run-time error '13'\" comes up. I would like the users to be able to fill down their entries, is there a way around this error?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nApplication.ScreenUpdating = False\n    Application.Calculation = xlManual\n\n    If Not Intersect(Target, [T7:AE61]) Is Nothing Then\n    If (Target.Value Like \"1\") Then\n    ElseIf (Target.Value Like \"2\") Then\n    ElseIf (Target.Value Like \"3\") Then\n    ElseIf (Not Target.Value Like \"\") Then\n          MsgBox \"Please enter a rating of 1, 2 or 3.\"\n        Application.EnableEvents = False\n        Application.Undo\n\n        Application.EnableEvents = True\n\n    End If\n      End If\n\nApplication.Calculation = xlAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for any possible help!</p>\n"}, {"tags": ["excel", "vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430242560, "post_id": 29926201, "comment_id": 47974112, "body": "It saves to my desktop and has been working fine. I need to open it on my desktop. Is it possible?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430244396, "post_id": 29926201, "comment_id": 47975274, "body": "You can use code from here to open any document in its default application: <a href=\"http://stackoverflow.com/questions/18921168/how-can-excel-vba-open-file-using-default-application\" title=\"how can excel vba open file using default application\">stackoverflow.com/questions/18921168/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430247836, "post_id": 29926201, "comment_id": 47977375, "body": "Which one? Create object and then looking for tgtfile? How would I define the doc name - it would be different every time it gets downloaded."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430247953, "post_id": 29926201, "comment_id": 47977445, "body": "Yes - the <code>runit</code> answer with 5 votes.  Save the full file path to a variable and pass it to <code>runit</code>"}, {"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430248033, "post_id": 29926201, "comment_id": 47977486, "body": "would this be in excel or outlook? Not getting it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430248172, "post_id": 29926201, "comment_id": 47977562, "body": "If you need to post code, <i>edit your question</i> and add it: it&#39;s unreadable in a comment."}, {"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430334903, "post_id": 29926201, "comment_id": 48025942, "body": "Tim, any updates on the above code?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430244324, "post_id": 29926379, "comment_id": 47975232, "body": "Create application like excel.application?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430245153, "post_id": 29926379, "comment_id": 47975784, "body": "Yes, exactly. You need to create a new Excel Application instance and then load the file there."}, {"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430247535, "post_id": 29926379, "comment_id": 47977214, "body": "My file would be saved as different named file since it&#39;s date/time stamp would be different everytime."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430288969, "post_id": 29926379, "comment_id": 47993647, "body": "But you know the filename at runtime, so you can use it for opening the file in Excel."}, {"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430334889, "post_id": 29926379, "comment_id": 48025933, "body": "Due to the change in date everytime the file will be saved in different name. How would I call it for different file everytime?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1430243047, "creation_date": 1430243047, "answer_id": 29926379, "question_id": 29926201, "link": "https://stackoverflow.com/questions/29926201/code-to-download-attachment-from-outlook-save-it-on-desktop-and-open-it/29926379#29926379", "title": "Code to download attachment from Outlook, save it on desktop and open it", "body": "<p>Yes, it is possible. If you know exactly that you need to open Excel files you may use the Excel object model to get the job done. See <a href=\"https://support.microsoft.com/en-us/kb/219151?wa=wsignin1.0\" rel=\"nofollow\">How to automate Microsoft Excel from Visual Basic</a> for more information. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Open</a> method of the Workbooks class opens a workbook.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430338790, "post_id": 29952877, "comment_id": 48028206, "body": "first time I tried it kicked me out and operation failed..Next trial, it worked.although doesn&#39;t run the &quot;runit&quot; code. Since I can set up 1 rule for the incoming emails.. I don&#39;t think there&#39;s a way to create multiple rules. is there?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430340214, "post_id": 29952877, "comment_id": 48029031, "body": "There was an error in your original code which I hadn&#39;t spotted (adding an additional backslash onto <code>saveFolder</code>, which already had a trailing backslash).  Try it with the fix."}, {"owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430342555, "post_id": 29952877, "comment_id": 48030379, "body": "So the code does work with the additional backslash but unfortunately it opens the wrong attachment :) For example I&#39;ve attached an excel file but it opens an image on the desktop. Haven&#39;t seen that before."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "edited": false, "score": 0, "creation_date": 1430346612, "post_id": 29952877, "comment_id": 48032159, "body": "If your mail item has embedded images then those will also be saved and opened.  If you don&#39;t want that then you&#39;ll need to add some code to filter them out, perhaps by looking at the filename and checking the extension."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1430346621, "last_edit_date": 1430346621, "creation_date": 1430335865, "answer_id": 29952877, "question_id": 29926201, "link": "https://stackoverflow.com/questions/29926201/code-to-download-attachment-from-outlook-save-it-on-desktop-and-open-it/29952877#29952877", "title": "Code to download attachment from Outlook, save it on desktop and open it", "body": "<p>Try this:</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n\n    Dim objAtt As Outlook.Attachment\n    Dim saveFolder As String\n    Dim dateFormat, FilePath As String\n\n    dateFormat = Format(Now, \"yyyy-mm-dd H-mm\")\n    saveFolder = \"c:\\Users\\abc1\\Desktop\" '&lt;&lt;EDIT removed trailing \\\n    For Each objAtt In itm.Attachments\n      FilePath = saveFolder &amp; \"\\\" &amp; dateFormat &amp; _\n                  \" \" &amp; objAtt.DisplayName\n      objAtt.SaveAsFile FilePath\n      runit FilePath\n    Next\n\nEnd Sub\n\nSub runit(FilePath as String)\n   Dim Shex As Object\n   Set Shex = CreateObject(\"Shell.Application\")\n   Shex.Open (FilePath)\nEnd Sub\n\n'Edit: I used this to test the code, since I'm not running\n'      it from a rule\nSub Tester()\n\n    Dim Msg As MailItem\n\n    Set Msg = Application.ActiveInspector.CurrentItem\n\n    saveAttachtoDisk Msg\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4843194, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/647fa375d4aecdb2637a95d3d1aec797?s=128&d=identicon&r=PG&f=1", "display_name": "D K", "link": "https://stackoverflow.com/users/4843194/d-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4207, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1593475742, "creation_date": 1430242519, "last_edit_date": 1593475742, "question_id": 29926201, "link": "https://stackoverflow.com/questions/29926201/code-to-download-attachment-from-outlook-save-it-on-desktop-and-open-it", "title": "Code to download attachment from Outlook, save it on desktop and open it", "body": "<p>This is the code in Outlook that sets the rules in Outlook automatically to save the attachment (Excel) with date stamp:  </p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nDim dateFormat\n\n    dateFormat = Format(Now, \"yyyy-mm-dd H-mm\")\n    saveFolder = \"c:\\Users\\abc1\\Desktop\\\"\n   For Each objAtt In itm.Attachments\n      objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; objAtt.DisplayName\n      Set objAtt = Nothing\n Next\n\nEnd Sub\n</code></pre>\n\n<p>Next step I want is to open the attachment once it's saved. Is that possible?</p>\n\n<p>How about this one?</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n  Dim objAtt As Outlook.Attachment\n  Dim saveFolder As String\n  Dim dateFormat\n\n      dateFormat = Format(Now, \"yyyy-mm-dd H-mm\")\n      saveFolder = \"c:\\Users\\abc1\\Desktop\\\"\n     For Each objAtt In itm.Attachments\n        objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; objAtt.DisplayName\n        Set objAtt = Nothing\n   Next\n\n\nDim Shex As Object\n   Set Shex = CreateObject(\"Shell.Application\")\n   tgtfile = \"objatt\"\n   Shex.Open (tgtfile)\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 2, "creation_date": 1430241909, "post_id": 29925956, "comment_id": 47973694, "body": "You need to explain what specifically isn&#39;t working right for you."}, {"owner": {"reputation": 11, "user_id": 4843042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e66pJYPDevY/AAAAAAAAAAI/AAAAAAAAAYw/Wr1j6mCpKxA/photo.jpg?sz=128", "display_name": "Darin Sharpley", "link": "https://stackoverflow.com/users/4843042/darin-sharpley"}, "reply_to_user": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1430276508, "post_id": 29925956, "comment_id": 47989238, "body": "specifically, the copy and past functions don&#39;t work. I can pick me he file and open the tab, but nothing copies from the tab I pick to the open worksheet.  The name of the source (copy) data changes, but the name of the destination tab (paste) will stay the same. This is why I need to be able to pick a workbook and worksheet name."}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1431445080, "post_id": 29925956, "comment_id": 48496080, "body": "I thought you&#39;d have been helped by now, but seeing this is still unanswered I found some time to take a look at it. I see a copy command though strangely written, and no Paste/PasteSpecial command. You would usually use copy on the object you are copying, and paste on the object you&#39;re copying to, so: <i>wbk2.Sheets(1).Cells.Copy</i> as one command and _wbk1.Worksheets(&quot;Sheet2&quot;).Cells(1, 1).PasteSpecial&#39; as the other (with maybe some parameters as needed)."}], "owner": {"reputation": 11, "user_id": 4843042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e66pJYPDevY/AAAAAAAAAAI/AAAAAAAAAYw/Wr1j6mCpKxA/photo.jpg?sz=128", "display_name": "Darin Sharpley", "link": "https://stackoverflow.com/users/4843042/darin-sharpley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1003, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430244050, "creation_date": 1430241714, "last_edit_date": 1430244050, "question_id": 29925956, "link": "https://stackoverflow.com/questions/29925956/macro-to-prompt-for-worksheet-and-copy-chosen-worksheet-to-open-workbook", "title": "Macro to prompt for worksheet and copy chosen worksheet to open workbook", "body": "<p>I am trying to get the macro to run thus: opening a window and asking a file to choose; then type the name of the tab in a window; copy the contents of the tab; and finally paste the contents into the existing tab in the workbook I have open. (The one that contains the button for the macro.)</p>\n\n<pre><code>Public Sub frm_File_Name_Click()\n\nDim cFileLocation As Variant\nDim cFileName As Variant\nDim cFileSource As Variant\nDim i As Integer\nDim iRow As Long\nDim cSheetTab As Variant\nDim ws As Worksheet\nDim Msg, Style, Title, Help, Ctxt, Response, MyString\n\nDim Check, Counter\nCheck = True: Counter = 0 ' Initialize variables.\n\n\nOn Error Resume Next\n\n'Msg = \"Is there more tabs in this workbook that need to bt entered ?\"    ' Define message.\nStyle = vbYesNo + vbCritical + vbDefaultButton2    ' Define buttons.\nTitle = \"MsgBox Demonstration\"    ' Define title.\nHelp = \"DEMO.HLP\"    ' Define Help file.\nCtxt = 1000    ' Define topic\n\nSet ws = Worksheets(\"worksheet\")\n\n'Open Windows folder and select workbook\n NewFN = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xls) or (*.xlsx), *.xls\", Title:=\"Please select log file\")\n    If NewFN = False Then ' On Cancel\n        MsgBox \"Stopping because you did not select a file\"\n        Exit Sub\n\n    Else\n\n        Workbooks.Open Filename:=NewFN 'Open selected workbook Request form\n     End If\n cFileSource = ActiveWorkbook.Name 'store open workbook Request form as cFilterSource\n  Workbooks.Open cFileSource\n'Do\n    Workbooks(cFileSource).Activate\n    'cSheetTab = InputBox(\"Sheet Tab?\", \"Tab Name\") 'Get workbook sheet name\n 'Application.ScreenUpdating = True\n Dim x As Integer\n    Sheets(cSheetTab).Activate\n    i = 0\n        Do\n            i = i + 1\n            If (Err.Number = 9) Then\n                On Error Resume Next\n                cSheetTab = InputBox(\"Please enter a Tab label. If after 3 entries of a non-existant tab label, this macro will end. Please enter a correct tab label now\", \"Tab label Entry Try #\" &amp; i)\n                Sheets(cSheetTab).Activate\n\n            End If\n               If i = 3 Then\n               Check = False\n               NewFN = MsgBox(\"You have not entered a correct tab for 3 times, this macro will end\", vbOKOnly + vbCritical, \"This macro is ending\")\n               Workbooks(cFileSource).Close SaveChanges:=False\n               Exit Sub\n             End If\n        Loop Until (Err.Number &lt;&gt; 9 Or Check = False) 'check to see if you have a good sheet name or if a wrong tab name has been entered more than three times,(error out of range 9)\n\n Application.ScreenUpdating = False\n\n\n        fileStr = Application.GetOpenFilename()\nWorksheets(\"Sheet1\").TextBox1.Value = fileStr\n\n\nDim wbk1 As Workbook, wbk2 As Workbook\n\nSet wbk1 = ActiveWorkbook\nSet wbk2 = Workbooks.Add(fileStr)\n\nwbk2.Sheets(1).Cells.Copy wbk1.Worksheets(\"Sheet2\").Cells(1, 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "textbox", "null"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430241936, "post_id": 29925738, "comment_id": 47973710, "body": "In which case is returning <code>&quot;&quot;</code>? When it&#39;s not a <code>TextBox</code> or always?"}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430244401, "post_id": 29925738, "comment_id": 47975277, "body": "The function seems to always trigger with the <code>if</code> and not the <code>else</code>.  In the debugger, the values are empty - that is, there&#39;s no value.  I can&#39;t tell if it is returning &quot;&quot; or null.  This is with textboxes.  I&#39;d have to search for an example for a combobox or something else, but right now I&#39;d like to solve for a textbox."}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430244503, "post_id": 29925738, "comment_id": 47975357, "body": "It seems like <code>Me.controlname</code> is not being properly gotten."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430245031, "post_id": 29925738, "comment_id": 47975687, "body": "Have you tried returning the CDbl(whatbox.Text)?"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1430246286, "post_id": 29925738, "comment_id": 47976456, "body": "What&#39;s the purpose of the <code>SetFocus</code>?"}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1430246384, "post_id": 29925738, "comment_id": 47976503, "body": "I think I have to use <code>SetFocus</code> because I am calling the function from inside the code.  I seem to remember something to do with it not fetching the values unless it setfocus first."}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430246448, "post_id": 29925738, "comment_id": 47976541, "body": "@MatteoNNZ What is <code>CDbl</code> ?"}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1430246775, "post_id": 29925738, "comment_id": 47976749, "body": "If I use msgbox(whatbox.text) it gives me a blank messagebox."}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1430252033, "post_id": 29925738, "comment_id": 47980045, "body": "<code>CDbl</code> is VBA&#39;s built-in conversion function for converting something to a <code>Double</code> value. It&#39;s only worth using if you&#39;re sure what you&#39;re converting hsa something representable as a <code>Double</code>."}, {"owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "edited": false, "score": 0, "creation_date": 1430252377, "post_id": 29925738, "comment_id": 47980296, "body": "Well, I&#39;m still not sure why it doesn&#39;t work.  I fixed the tables though so they always provide values and <i>THEN</i> everything works.  But I can&#39;t get it to not break if any of the values are empty."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1430257871, "post_id": 29925738, "comment_id": 47983390, "body": "@BGM actually, reading better the question, no conversion is worth if you already get the MsgBox empty. Here it&#39;s all about debugging. What I would suggest is: 1) Are you sure you want to pass the argument by reference and not by value (i.e. <code>ByVal whatbox As Control</code>)? Maybe you expect it to be filled but you&#39;re actually emptying it  in some other parts of your code; 2) Whatever the control is, what you see it&#39;s the property <code>.Text</code>; the property <code>.Value</code> might be equal to text, or may be not. 3) Have you added a watch to the input control to make sure the name is the one you want?"}], "owner": {"reputation": 5811, "user_id": 1038866, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-6zydemrOVos/AAAAAAAAAAI/AAAAAAAAABE/J4ZvWM6D2Ts/photo.jpg?sz=128", "display_name": "bgmCoder", "link": "https://stackoverflow.com/users/1038866/bgmcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1430247314, "creation_date": 1430240958, "last_edit_date": 1430247314, "question_id": 29925738, "link": "https://stackoverflow.com/questions/29925738/getting-value-from-textbox-with-variant-in-vba", "title": "Getting value from textbox with variant in VBA", "body": "<p>In my project I am trying to use a function that will return the text or value from any control.  I have this in the code of the actual form.</p>\n\n<pre><code>Function GetVar(whatbox As Control) As Variant\n    'get value from textbox or checkbox\n    whatbox.SetFocus\n    If whatbox.ControlType = acTextBox Then\n        GetVar = whatbox.Text\n    Else\n        GetVar = whatbox.Value\n    End If\nEnd Function\n</code></pre>\n\n<p>Now, I call it like this:</p>\n\n<pre><code>vIssuesPerMonth = GetVar(Me.NumberofCopies)\nvCostIssuePrint = GetVar(Me.CostIssuePrint)\nvCostIssueMail = GetVar(Me.CostIssueMail)\nvSurcharge = GetVar(Me.Surcharge)\nvSurchargeNonMember = GetVar(Me.SurchargeNonMember)\n</code></pre>\n\n<p>Then I do some math with the values.</p>\n\n<pre><code>vAvCostPerPrint = vCostIssuePrint / vIssuesPerMonth\nvAvCostPerMail = vCostIssueMail / vIssuesPerMonth\n</code></pre>\n\n<p>My problem is that the <code>GetVar</code> isn't working and it returns \"\" and so the math fails with a \"type mismatch\" error.</p>\n\n<p>If I look at the values during debug, it says <code>whatbox</code> is null, even though I've sent the right name of the control.  It seems like <code>me.controlname</code> isn't being passed properly.</p>\n\n<p>What am I doing wrong?</p>\n"}]